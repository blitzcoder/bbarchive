<!DOCTYPE html><html lang="en" ><head ><title >Refresh a TreeView?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Refresh a TreeView?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >Refresh a TreeView?</a><br><br>
<a name="712909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How can I force a TreeView to refresh or update? Currently, I open up my window with a treeview and start adding nodes with the right click menus, but they're completely invisible because the root node is closed and there is no check mark next it so the user cannot expand it. If I click on the area it would be if there was one, it expands, but that's not suitable for a professional app. I could also force the nodes open in that situation too, but that's not professional either. I just want to see the little "expand me" icon appear as soon as the node has child nodes to expand. I can't seem to find anything like a RefreshTreeView command though. <br><br></td></tr></table><br>
<a name="712910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Expand/CollapseTreeViewNode should do the trick. <br><br></td></tr></table><br>
<a name="712930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, I'm afraid that won't do it either, unless there's a command to tell me whether the node is currently expanded or collapsed. For the same reason that it's not very professional to go around opening nodes which were closed, it's not very professional to close nodes which were open.<br><br>The only other command I can find for TreeViewNodes is SelectTreeViewNode, which appears to be undocumented ( or the hotlink is just broken ) but I guess that's not what I need. <br><br></td></tr></table><br>
<a name="712951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It may well be a bug. I would never have considered coders closing the rootnode, users certainly can't. <br><br></td></tr></table><br>
<a name="712954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, when I said "root node" I meant my own root node, which is parented to the actual root node. I don't use the actual root node for anything at all. The same thing is true of all nodes all the way down the chain. If you create child nodes for them in code while the treeview is displayed, they are not updated to indicate that they can be opened. You can click on them, and they are opened, but there is nothing visible until you do that, at which point they are updated. <br><br></td></tr></table><br>
<a name="712972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gotcha, sorry for the confusion. Will look more into it but best fix I can come up with for now which doesn't seem to glitch and shouldn't slow things down but feels a bit like kickin old bill in the ribs:<br><br>brl.mod/win32maxgui.mod/win32gui.bmx[783]:<br><pre class=code>
	Method InsertNode:TGadget(index,label$,icon)
		Local	parenthandle,nodehandle
		Local	node:TGadget
		parenthandle=handle
		If class=GADGET_TREEVIEW parenthandle=bbTreeViewRoot(handle)
		nodehandle=bbInsertTreeViewNode(index,Localize(label),parenthandle,icon)
		node=Create(GADGET_NODE,nodehandle,Self)
		node.name=label		
		If handle=parenthandle
			If CountKids()=1 
				bbExpandTreeViewNode handle
				bbCollapseTreeViewNode handle
			EndIf
		EndIf
		Return node
	End Method
</pre> <br><br></td></tr></table><br>
<a name="713222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. Unfortunately, I can't get Win32MaxGUI to compile ( not because of this change, it wouldn't compile before either. )<br><br>It complains of a redefinition of struct IHTMLFramesCollection2 in mshtml.h : 461 and points to line 478 with the same error in the same file for IHTMLWindow2.<br><br>These both occur trying to compile win32htmlview.cpp<br><br>I'm not sure if another module is conflicting, but if so, it's definitely not one of mine.<br><br>EDIT: On closer inspection, the errors seems to be because MinGW's headers have already defined these structs. Am I using an incorrect version of MinGW to build modules? What's the recommended version for that now? I think I'm using 3.4.2 as older versions couldn't be used to compile my TV3D wrapper. <br><br></td></tr></table><br>
<a name="713236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> win32htmlview.cpp needs one extra pair of #ifndef #endif for later releases of mingw, i'm not sure which constant to base it from, the ones in there now is I think due to me erroneously thinking you could use struct names with an #ifndef...<br><br>for now, I would try remming out from line 35 or so down until you stop getting errors with a /* */ pair. <br><br></td></tr></table><br>
<a name="713244"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Recommended version for MingW is 3.1(.0.1) <br><br></td></tr></table><br>
<a name="713249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Recommended version for MingW is 3.1(.0.1)  <br></div><br>I still have that installed ( but not pointed to in Environment Variables ) but I just tried it, and it won't compile TV3D, so I can't go back to that.<br><br><div class="quote"> win32htmlview.cpp needs one extra pair of #ifndef #endif for later releases of mingw, i'm not sure which constant to base it from, the ones in there now is I think due to me erroneously thinking you could use struct names with an #ifndef... <br></div><br><br>Ahhh, got it. Thanks. <br><br>EDIT: Nope, I thought I had it, but I don't. I got it compiling just fine, but now it won't link.<br><br><pre class=code>
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(group.cpp.debug.win32.x86.o)(.text+0x322):group.cpp: undefined reference to `std::_List_node_base::hook(std::_List_node_base*)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(group.cpp.debug.win32.x86.o)(.text$_ZNSt4listIP8BBGadgetSaIS1_EE5eraseESt14_List_iteratorIS1_E+0xc):group.cpp: undefined reference to `std::_List_node_base::unhook()'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(treeview.cpp.debug.win32.x86.o)(.text+0x379):treeview.cpp: undefined reference to `std::_List_node_base::hook(std::_List_node_base*)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(treeview.cpp.debug.win32.x86.o)(.text+0x3d3):treeview.cpp: undefined reference to `std::_List_node_base::hook(std::_List_node_base*)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(treeview.cpp.debug.win32.x86.o)(.text$_ZNSt4listIP14BBTreeViewNodeSaIS1_EE6removeERKS1_+0x2a):treeview.cpp: undefined reference to `std::_List_node_base::unhook()'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(win32hwnd.cpp.debug.win32.x86.o)(.text$_ZNSt8_Rb_treeIP6HWND__St4pairIKS1_P9Win32HwndESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE5eraseESt17_Rb_tree_iteratorIS6_ESE_+0x45):win32hwnd.cpp: undefined reference to `std::_Rb_tree_increment(std::_Rb_tree_node_base*)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(win32hwnd.cpp.debug.win32.x86.o)(.text$_ZNSt8_Rb_treeIP6HWND__St4pairIKS1_P9Win32HwndESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE5eraseESt17_Rb_tree_iteratorIS6_ESE_+0x54):win32hwnd.cpp: undefined reference to `std::_Rb_tree_rebalance_for_erase(std::_Rb_tree_node_base*, std::_Rb_tree_node_base&amp;)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(win32hwnd.cpp.debug.win32.x86.o)(.text$_ZNSt8_Rb_treeIP6HWND__St4pairIKS1_P9Win32HwndESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE5eraseERS3_+0x46):win32hwnd.cpp: undefined reference to `std::_Rb_tree_increment(std::_Rb_tree_node_base*)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(win32hwnd.cpp.debug.win32.x86.o)(.text$_ZNSt8_Rb_treeIP6HWND__St4pairIKS1_P9Win32HwndESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE9_M_insertEPSt18_Rb_tree_node_baseSE_RKS6_+0x4e):win32hwnd.cpp: undefined reference to `std::_Rb_tree_insert_and_rebalance(bool, std::_Rb_tree_node_base*, std::_Rb_tree_node_base*, std::_Rb_tree_node_base&amp;)'
C:/Program Files/BlitzMax/mod/brl.mod/win32maxgui.mod/win32maxgui.debug.win32.x86.a(win32hwnd.cpp.debug.win32.x86.o)(.text$_ZNSt8_Rb_treeIP6HWND__St4pairIKS1_P9Win32HwndESt10_Select1stIS6_ESt4lessIS1_ESaIS6_EE13insert_uniqueERKS6_+0x63):win32hwnd.cpp: undefined reference to `std::_Rb_tree_decrement(std::_Rb_tree_node_base*)'
Build Error: Failed to link C:/My Dev/BlitzMax/My Games/Blah/Blah.debug.exe
Process complete
</pre> <br><br></td></tr></table><br>
<a name="713258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that means you need to rebuild win32maxgui entirely easiest is to kill it's .bmx folder or Rebuild Modules. <br><br></td></tr></table><br>
<a name="713268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've rebuilt both Win32MaxGUI separately and all modules together twice each, but I'm still getting the same errors. <br><br></td></tr></table><br>
<a name="713310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> And maybe re/move the blitzmax/lib folder as that may be contributing conflicting GCC3 libs to your GCC4 environment. <br><br></td></tr></table><br>
<a name="714115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> bump <br><br></td></tr></table><br>
<a name="714145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> No change. It still doesn't compile with the same errors, even  after putting back several libs without which the program doesn't compile at all. <br><br></td></tr></table><br>
<a name="715141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Defoc8</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> gab you simply cannot use a more modern version of<br>mingw, trust me - ive tried. I also tried out skids tips a while<br>back, but seems despite the corrections, the code simply<br>wont link correctly.. incompatible objects types or some such<br>nonesense.. so basically, your kinda screwed unless mark<br>makes some changes to the compiler...or so it would<br>seem....hope something happens with this, cuz its kinda<br>annoying.. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
