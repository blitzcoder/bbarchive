<!DOCTYPE html><html lang="en" ><head ><title >2 add. functions for the textarea control(win32)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >2 add. functions for the textarea control(win32)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >2 add. functions for the textarea control(win32)</a><br><br>
<a name="733104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I have currently started a new IDE for BMax.<br>The main target is the cross compatibility for all Versions.<br>To handle the enormous speed lag in every highlighting code (mainly on windows, but also on every other OS) I've done some <br>researching how to determine the first and last visible line of a textarea control.<br>As I only own a windows system I wasn't able to get these functions for Linux and Mac. Maybe some of our linux and mac cracks could find them out to have some (in my opinion very important functions) cross platform functions.<br><br>Here is the actual windows version:<br><pre class=code>
Type TRect
	Field _Left:Int
	Field _Top:Int
	Field _Right:Int
	Field _Bottom:Int
End Type

Type TPoint
	Field X:Int
	Field Y:Int
End Type

Function TextAreaFirstVisibleLine(textarea:TGadget)
	Local hwnd=QueryGadget(textarea,QUERY_HWND)
	If hwnd Return SendMessageA(hwnd,EM_GETFIRSTVISIBLELINE,0,0)
End Function



Function GetLastVisibleLine:Int(Edit:TGadget)
	Local r:TRect
	Local i:Int
	
	Local hwnd=QueryGadget(Edit,QUERY_HWND)
	If hwnd 
		SendMessageA(hwnd,EM_GETRECT,0,Int(Byte Ptr r))
	Else
		Return Null
	EndIf
    Local pt:TPoint = New TPOINT
	pt.x = Long(r._right)
	pt.y = Long(r._bottom)
	i = SendMessageA(hwnd,EM_CHARFROMPOS,0,Int(Byte Ptr pt))
	
	Return i
End Function
</pre><br><br>Thx klepto2<br><br>PS: it is important that these functions are font independent. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
