<!DOCTYPE html><html lang="en" ><head ><title >Is this windows style possible?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is this windows style possible?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >Is this windows style possible?</a><br><br>
<a name="702258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know what it is, but I really like this look.  Is it possible with MaxGUI?:<br><img src="http://www.leadwerks.com/post/crafty.jpg"> <br><br></td></tr></table><br>
<a name="702261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do a search on the forum for manifest files.  I can't recall how to do it exactly, but it's possible to make things look more like XP... <br><br></td></tr></table><br>
<a name="702274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The yourapp.exe.manifest solution doesn't do anything to the menus. <br><br></td></tr></table><br>
<a name="702280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Neither does any Windows XP skins ;)<br><br>Those menus are "owner drawn", eg application specific. <br><br></td></tr></table><br>
<a name="702390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barnabius</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Owner drawn menus are relatively easy to do but there's the problem of making them platform independent. In Windows one has to set the menu property to "owner drawn" and than respond to messages like WM_DRAWITME and WM_MEASUREITEM. I am sure Macintosh is using something similar but differently so that owner drawn menus would require separate code for each platform.<br><br>Also, note that menus can also be drawn as toolboxes on rebar, which is technique used in MS Office, but even then one has to use owner drawn technique to get the looks one wants.<br><br>Barney <br><br></td></tr></table><br>
<a name="702428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> looks to me like its using the winapi SetMenuItemBitmaps() <br><br></td></tr></table><br>
<a name="702450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barnabius</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes. You can use SetMenuItemBitmaps but then you have to create absolutely everything and in any case you have to look for the windows messages I've mentioned.<br><br>Barney <br><br></td></tr></table><br>
<a name="702492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmmm...for some reason I am having problems with LoadBitmap().  I tried both lpBitmapName$ and lpBitmapName$z:<br><br>Extern "Win32"<br>	Function LoadBitmap:Int(hInstance,lpBitmapName$)="LoadBitmapA@8"<br>	Function SetMenuItemBitmaps:Int(hMenu,uPosition,uFlags,hBitmapUnchecked,hBitmapChecked)="SetMenuItemBitmaps@20"<br>EndExtern<br><br>I am trying to load a 16x16 bitmap.  It always returns 0. <br><br></td></tr></table><br>
<a name="702498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I was able to load it with LoadImageA...not sure why LoadBitmap doesn't work.<br><br>Still no visible effect when I try to set the menu image.<br><br>	root=WindowMenu(window)<br>	menu:TGadget=CreateMenu("File",0,root)<br>	submenu:TGadget=CreateMenu("Open...",MENU_OPEN,menu,KEY_O,MODIFIER_CONTROL)<br>	hmenu=QueryGadget(menu,QUERY_HWND)<br>	hbitmap=LoadImageA(Null,AppDir$+"\gfx\icon_new.bmp",0,0,0,$10)<br>	Notify SetMenuItemBitmaps(hmenu,0,1024,hbitmap,hbitmap) <br><br></td></tr></table><br>
<a name="702504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's an example.  I can only get the menu handle by querying the root menu.  I can load the bitmap successfully.  However, SetMenuItemBitmaps always fails.  Everything I have read indicates that this should work, unless Blitz is doing something weird internally:<br><br><pre class=code>Extern "Win32"
	Function LoadImageA:Int(hInst%,filename$z,typ%,desiredX%,desiredY%,fuLoad%)
	Function LoadBitmap:Int(hInstance,lpBitmapName$)="LoadBitmapA@8"
	Function SetMenuItemBitmaps:Int(hMenu,uPosition,uFlags,hBitmapUnchecked,hBitmapChecked)="SetMenuItemBitmaps@20"
EndExtern

w=400
h=300
style=WINDOW_TITLEBAR+WINDOW_RESIZABLE+WINDOW_STATUS+WINDOW_MENU
window:tgadget=CreateWindow("Menu Icons",(ClientWidth(Desktop())-w)/2,(ClientHeight(Desktop())-h)/2,w,h,Null,style)

root:TGadget=WindowMenu(window)
menu:TGadget=CreateMenu("File",0,root)
menuitem:TGadget=CreateMenu("Open...",69,menu)

UpdateWindowMenu window

hbitmap=LoadImageA(Null,AppDir$+"\test.bmp",0,0,0,$10)

If hbitmap
	hmenu=QueryGadget(root,QUERY_HWND)
	If hmenu
		result=SetMenuItemBitmaps(hmenu,1,1024,hbitmap,hbitmap)
		If Not result Notify "SetMenuItemBitmaps() failed."
	Else
		Notify "Failed to retrieve menu handle."
	EndIf
Else
	Notify "LoadImageA() failed."
EndIf


Repeat
	Select WaitEvent()
		Case EVENT_WINDOWCLOSE
			End
	EndSelect
Forever</pre> <br><br></td></tr></table><br>
<a name="702551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Birdie</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can try win32 { GetMenu( hwnd ) } on a window Query(QUERY_HWND) to get the root menu.<br><br>eg<br>Local mainmenu=GetMenu(WindowMenu(window).query(QUERY_HWND))<br><br>The demo below works so shouldnt be to hard to change to suit multiple images etc<br><br>The only problem is when you later come to UncheckMenu/CheckMenu. You'll loose the image totally so really its a little dodgey doing it this way.<br><br><br><br><pre class=code>'checkmenu image change
'by Birdie


Strict

Extern "win32"
	Function LoadImage_( hInst, fName$z, uType, dx, dy, fuLoad ) = "LoadImageA@24"
	Function SetMenuItemBitmaps( hMenu, uPosition, uFlags, hBitUnChecked, hBitChecked ) = "SetMenuItemBitmaps@20"
	Function GetMenu( hWnd ) = "GetMenu@4"
	Function GetSubMenu( hMenu, pos ) = "GetSubMenu@8"
EndExtern


Local window:TGadget = CreateWindow("Test",0,0,640,480,Desktop(),WINDOW_MENU|WINDOW_TITLEBAR|WINDOW_STATUS)


Local file:TGadget = CreateMenu("&amp;File",1,WindowMenu(window))
Local open:TGadget = CreateMenu("Open",101,file)
						CreateMenu("Save",102,file)
						CreateMenu("Exit",199,file)

Local edit:TGadget = CreateMenu("Edit",201,WindowMenu(window))
						CreateMenu("Paste",202,edit)
						
UpdateWindowMenu WindowMenu(window)
Local bi = loadimage_( 0,CurrentDir()+"/logo.bmp",0,0,0,$10 )
Local mainmenu=GetMenu(WindowMenu(window).query(QUERY_HWND))

AddImage mainmenu, bi

While WaitEvent()
	Select EventID()
		Case EVENT_WINDOWCLOSE
			End
	EndSelect
Wend

Function AddImage( root_menu, bitmap )
	Local INDEX=0
	Local sub_menu
	Local done = 0
	Repeat
		sub_menu = GetSubMenu( root_menu, index )
		If sub_menu
			AddImage sub_menu,bitmap
		EndIf
		If SetMenuItemBitmaps( root_menu, index, MF_BYPOSITION, bitmap, bitmap ) = 0
			done = True
		EndIf
		index :+1
	Until done
EndFunction


</pre> <br><br></td></tr></table><br>
<a name="702557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks.<br><br>The only problem now is that the menu items need to be spaced out more, because they are way too crowded with the icons. <br><br></td></tr></table><br>
<a name="702702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> try using GetSystemMetrics(SM_CXMENUCHECK) for loading images the correct size. <br><br></td></tr></table><br>
<a name="702772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any program that has icons in the menus has more spacing around the menu items.  Looking at Paint Shop Pro, the icons they use are the same as standard toolbar icons (16x16).  So you still need to space out the menus a bit. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
