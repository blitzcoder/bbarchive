<!DOCTYPE html><html lang="en" ><head ><title >Vista Look?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Vista Look?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >Vista Look?</a><br><br>
<a name="799270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know adding a manifest file to MaxGUI can give all the buttons etc the XP look, but how can I give the buttons the Vista look (when running on vista ofc)? <br><br></td></tr></table><br>
<a name="799336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> In <i>exactly the same way</i>, just add the same manifest file or import a manifest object file. It will give the EXE the theme layout for either OS. <br><br></td></tr></table><br>
<a name="799337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> hum.. well i tired that but no vista look, buttons were different (similar to classic) from XP and classic buttons so something happened but they were not normal vista buttons.<br><br>My vista is 32but Home Premium.<br><br><pre class=code>
&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"&gt;
&lt;assemblyIdentity
version="1.0.0.0"
processorArchitecture="X86"
name="Application"
type="win32"
/&gt;
&lt;description&gt;Program Description&lt;/description&gt;
&lt;dependency&gt;
&lt;dependentAssembly&gt;
&lt;assemblyIdentity
type="win32"
name="Microsoft.Windows.Common-Controls"
version="6.0.0.0"
processorArchitecture="X86"
publicKeyToken="6595b64144ccf1df"
language="*"
/&gt;
&lt;/dependentAssembly&gt;
&lt;/dependency&gt;
&lt;/assembly&gt;
</pre> <br><br></td></tr></table><br>
<a name="799339"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Instead of using a separate manifest file, try importing the following .o file into your source: (removed) (just under any framework/module importing) - I managed to get XP <b>and</b> Vista theme buttons this way. And you don't need an additional manifest file for it to work. :-) <br><br></td></tr></table><br>
<a name="799342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thankyou.... that worked =D <br><br></td></tr></table><br>
<a name="799347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> No probs - just to clarify, the <i>xpmanifest.o</i> file is just a manifest file that I converted using a MinGW tool into an object file. This means you can get BlitzMax to store the manifest file information inside your EXE. Also, it means that it should still work even if you rename your EXE. <br><br></td></tr></table><br>
<a name="799816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can someone post some Vista shots to show what this file does? <br><br></td></tr></table><br>
<a name="799953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have another problem: I'm already importing an .o file for displaying a window/exe icon. It seems bmx has a problem with importing 2 different .o files the same time. Only one works at a time? Any ideas how to solve this issue? <br><br></td></tr></table><br>
<a name="800018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You'll have to remake the object file with both the manifest and your icon set - I needed to do this for my project which is a bit inconvenient, but once it's set up, it's done. <br><br></td></tr></table><br>
<a name="800031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> That was my guess. But how do I do that? <br><br></td></tr></table><br>
<a name="801535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone? *bump <br><br></td></tr></table><br>
<a name="801572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lol Grisu, I'm on holiday at the moment and went online to check my e-mail... Anyway, I've only just got your message.<br><br>After having done this for my project *ages ago*, I'd have thought I would have kept the original resource file, but I didn't. So I've gone searching for how I did it, and I think I've remembered. Here we go:<br><br><b>Steps To Creating an All-In-One Object Resource</b>:<br><br>Including:<br><br>&gt; Icons<br>&gt; XP/Vista Manifest<br>&gt; EXE Description<br><br>1. Copy your icon and manifest file into a new folder using filenames of less than 8 characters (probably not needed but best to be safe). You said that you had some problems with the manifest above, so I've provided the one that I used to compile the object file above (you can change the description in italics to suit your own program):<br><br><pre class=code>&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;
&lt;assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"&gt;
&lt;assemblyIdentity
version="1.0.0.0"
processorArchitecture="X86"
name="Application"
type="win32"
/&gt;
&lt;description&gt;<i>This description is shown when the mouse hovers over the EXE icon etc.</i>&lt;/description&gt;
&lt;dependency&gt;
&lt;dependentAssembly&gt;
&lt;assemblyIdentity
type="win32"
name="Microsoft.Windows.Common-Controls"
version="6.0.0.0"
processorArchitecture="X86"
publicKeyToken="6595b64144ccf1df"
language="*"
/&gt;
&lt;/dependentAssembly&gt;
&lt;/dependency&gt;
&lt;/assembly&gt;</pre>2. Paste the following text into Windows Notepad (to remove formatting) and save as <i>resource.rc</i> in the same folder used above. Obviously, change the italic string literals to suit your needs. <br><br><pre class=code>1 24 "<i>mygame.exe.manifest</i>"
101 ICON "<i>icon.ico</i>"

1 VERSIONINFO 
FILEVERSION 1,0,0,0 
PRODUCTVERSION 1,0,0,0 
FILEOS 0x40004
FILETYPE 0x1
{ 
BLOCK "StringFileInfo" 
{ 
 BLOCK "040904b0" 
 { 
  VALUE "Comments", "<i>This is the product description.</i>"
  VALUE "CompanyName", "<i>My New Company</i>" 
  VALUE "FileVersion", "<i>1.0.0.0</i>" 
  VALUE "FileDescription", "<i>This is the file description.</i>" 
  VALUE "InternalName", "<i>This is the internal name.</i>" 
  VALUE "LegalCopyright", "<i>Any info relating to copyright</i>" 
  VALUE "LegalTrademarks", "<i>Legal stuff</i>" 
  VALUE "OriginalFilename", "<i>MyApp.exe</i>" 
  VALUE "ProductName", "<i>My Application</i>" 
  VALUE "ProductVersion", "<i>1.0.0.0</i>" 
 } 
}
BLOCK "VarFileInfo"
{
  VALUE "Translation", 0x0409, 0
}
}
</pre>3. Providing you have MinGW set up and fully working with BlitzMax, open up the command prompt, and type: (Again, you will need to substitute in the actual path you used.)<br><br><pre class=code>windres -i "<i>C:\My\Path\resource.rc</i>" -o "<i>C:\My\Path\myobject.o</i>"</pre>4. After executing the above line, a new file called <i>myobject.o</i> will be created which you can then import into your BlitzMax app. You shouldn't need to distribute any icons or manifest files with your EXE ever again!<br><br>If you found it works fine, let me know, and I'll add it to the BlitzMax Tutorials section.<br><br>Seb <br><br></td></tr></table><br>
<a name="801590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a lot! It seems to work. Can't test it under Vista though...<br><br>For Step 3 I needed to write a small app, as the compiler didn't start itself:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Print "Executing Windres to create Object file"
Local objfilename:String = "dfaobject"+ ".o"
Local command:String = "windres -i ~q" + "resource.rc" + "~q -o ~q" + objfilename + "~q"

Print command

If system_(command)=0 Then
	Print "Created " + objfilename
	Print "Add "
	Print "Import ~q" + objfilename + "~q" 
	Print "to your BMX project to link in icon"
End If
</textarea><br><br>Please add this to the code archives!<br><br>P.s.: Do you know the language value for "German" or is "English (USA)" the default one for executables made with bmx? <br><br></td></tr></table><br>
<a name="801592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure why it wouldn't start by itself as your app does exactly the same thing, but anyway...<br><br>You can specify the language of the EXE in the resource file under the <a href="http://msdn2.microsoft.com/en-us/library/aa381057.aspx" target="_blank"><b>VARFILEINFO</b></a> and <a href="http://msdn2.microsoft.com/en-us/library/aa381049.aspx" target="_blank"><b>STRINGFILEINFO</b></a> blocks at the bottom of the code you copied and pasted. German is 0x0407 (as oppose to US English which is 0x0409) so just substitute the values and recompile the object .o file.<br><br>NB: The number quoted under <a href="http://msdn2.microsoft.com/en-us/library/aa381049.aspx" target="_blank"><b>STRINGFILEINFO</b></a> is comprised of the lanuguage id and the character set id, one after the other (scroll down the MSDN page for character set info).<br><br>Grisu: If you want me to test it on Vista for you, then just e-mail it to me and I'll let you know. <br><br></td></tr></table><br>
<a name="801594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks again!<br><br>Well, I don't know how good your German is, cause the app texts are in German. ;)<br><br>~5,8 MB Inno Setup installer in the basic version. <br><br></td></tr></table><br>
<a name="801597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Well, I don't know how good your German is, cause the app texts are in German. ;)<br><br>~5,8 MB Inno Setup installer in the basic version.  <br></div><br>Lol, it's up to you - my German is non-existent (I chose to study French at school instead) but I could probably guess what to do for the installation - the 'Next' button for Inno Setups are likely to be in the same place no matter what language is used. As long as it doesn't format my hard-drive, I don't mind. ;-) I suppose I could use Google Translate if I got really stuck. <br><br></td></tr></table><br>
<a name="801601"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I hated our teacher for french, so I took latin instead. :)<br>Bad choice. - Less girls in the class. But that was a long time ago.<br><br>Anyway, you've got mail. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
