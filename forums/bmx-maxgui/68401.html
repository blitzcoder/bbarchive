<!DOCTYPE html><html lang="en" ><head ><title >Complicated app architecture</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Complicated app architecture</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >Complicated app architecture</a><br><br>
<a name="764297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been making extensive use of hooks and emitted events in BlitzMax.<br><br>For example, every window in my program has an EmitEventHook.  This evaluates all events that are relevant to that window or groups of gadgets.  I find this approach much easier to break events up this way, because otherwise my event evaluation source file gets way too big.  It also makes it very easy to mix and match various GUI elements.  For example, I could include a new browser control in my main program with one source file, without having to modify the main source:<br><pre class=code>Function MainWindowHook:Object(id,data:Object,context:Object)
	Local editorviewport:TEditorViewport
	Local event:TEvent=TEvent(data)
	If Not event Return data
	Select event.id
		Case EVENT_WINDOWCLOSE
			Select event.source
				Case MainWindow
					EmitEvent CreateEvent(EVENT_MENUACTION,Null,MENU_EXIT)
					Return Null
			EndSelect
		Case EVENT_MENUACTION
			Select event.data
				Case MENU_EXIT
					HideGadget MainWindow
					StopEngine()
					End
					Return Null
			EndSelect
	EndSelect
	Return data
EndFunction</pre><br><br>The other interesting thing I have been doing is replacing redundant event evalaluation with an EmitEvent() call.  For example in the above code, both the menu action and the window close will end the program.  When the window is closed, I just emit a menu event that makes the program think the Exit menu was pressed.  This makes it so I only have to write the code to process that event once.<br><br>My main program loop then looks like this:<br><br>Repeat<br>WaitEvent()<br>Forever<br><br>Everything is handled in callbacks!  This approach is very different than what I am used to, but it seems to work well, and it compartmentalizes the code very easily.<br><br>Are there any potential problems with this approach? <br><br></td></tr></table><br>
<a name="764359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I find debugging can be a little bit harder when doing this (but not much) - it's a little bit harder to trace through the code in a procedural manner to identify the problem.  But equally, because you can bew sure (well, as sure as you can be in your own code) that common code is used wherever possible, once you find the problem, it's often easier to fix.<br><br>One problem that may occur in the future would arise with threading.  If 'max were multi-threaded, you might find that the emitted event code is executed before the code that is emitting the event finishes.  It depends on how the threading / event handler works, and should be avoidable (or manageable), and is pretty much a moot point given 'max doesn't have threads. <br><br></td></tr></table><br>
<a name="764370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Are there any potential problems with this approach? <br></div>Apart from callbacks not being typesafe (aka. delegates), no there's nothing wrong with that. In fact it's generally the "preferred" method of doing things in any event-driven SPOT language. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
