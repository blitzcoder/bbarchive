<!DOCTYPE html><html lang="en" ><head ><title >TextArea on OSX</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TextArea on OSX</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >TextArea on OSX</a><br><br>
<a name="1219100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a fairly complex suite of programs written using MaxGUI which are used to create and upload newsletters and webpages as well as maintaining database entries (via server-side php-sql called from my application). Everything is now complete and running perfectly on windows.<br><br>I have now been advised that one of the users who will be responsible for using the programs is a Mac only user - and am therefore in the process of creating a Mac version of each one. Unfortunately, I appear to have fallen at the first hurdle...<br><br>The text editors rely on CTRL-C/X/V for copying and pasting text in a TextArea - as well as CTRL-Z/Y for undo and redo (all handled via a filter). However, non of this code works on OSX - all I get when I press CMD-C/V/X/Y/Z is the Apple "fart" sound. Also - single and double quotes are transformed into strange characters when the text is saved to a file, which are then magically stripped out when the file is reloaded (all via the same code which works fine on Win32).<br><br>This is my first attempt to program on a Mac - any advice on what I need to change to make my code OSX compatible would be very welcome. <br><br></td></tr></table><br>
<a name="1219118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't say if you have changed your code from ctrl key checking to cmd key checking. <br><br>You may want to study the MaxIDE source code if it's behaviour is what you are after. <br><br></td></tr></table><br>
<a name="1219158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was (event.mods=8) but have finally realised that event.data returns ASCII values on Mac, which is why 26 ("Z" key) didn't work. After changing the Case statements (e.g. to 90,122) the filter works as expected.<br><br>However, the problem with quotes (single and double) remains. DebugLog shows the value returned in event.data for single/double quotes as 39/34 respectively.<br><br>My function for saving the Textareatext is:<br><pre class=code>Function DOC_Save()
	Local FileO:TStream=WriteFile(AppDir+"/notes.txt")
	Local TextOut:String=TextAreaText(txtContent)
	Local Content:String[]=TextOut.Split("~n")
	
	If FileO Then
		WriteLine FileO,"Content="+Content[0]
		For Local k:Long=1 To Content.Length-1
			WriteLine FileO,Content[k]
		Next 
		CloseFile FileO
	EndIf
EndFunction</pre><br>This works fine on PC - but these are getting stripped out during the write on Mac (i.e. after saving, file notes.txt contains everything except ASCII 34 and 39 characters). Could it be that the Textarea is actually substituting other characters? For example, if I type "hello" (including quotes), the 2nd double quote definitely looks different to the 1st despite my typing the same character twice. Maybe I need to intercept this via the filter and force a Chr(34) instead of whatever it's inserting? <br><br></td></tr></table><br>
<a name="1219164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep - the TextArea was changing the characters. I trapped the Chr(34/39) keypresses in the filter and manually inserted the required characters using:<br><br><pre class=code>Function TXT_Filter:Int(event:TEvent,context:Object)
	Select event.id
		Case EVENT_KEYCHAR
			Select event.data
			Case 34,39
				SetTextAreaText(txtContent,Chr(event.data),TextAreaCursor(txtContent),0)
				SelectTextAreaText(txtcontent,TextAreaCursor(txtContent)+1,0)
				RedrawGadget txtContent
				Return 0
			EndSelect
		EndSelect
End Function</pre><br><br>and all is well - everything now saves and loads correctly.<br><br>I do have to question why the gadget behaves that way? Surely if the user presses a Chr(34) the TextArea should insert a Chr(34) - like it does on Windows? <br><br></td></tr></table><br>
<a name="1219173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I do have to question why the gadget behaves that way? <br></div><br>The TextArea *should* perform the same on ALL platforms. If it doesn't consider it a bug.<br>Writing cross-platform GUI libraries which work the same on all platforms is difficult. Other alternatives do exist - like Qt and wxWidgets, which also aim to provide an identical service across platforms - they have the advantage of more than just Skid working on it.<br><br>You should *never* have to hack basic functionality for multiple platforms, if the intention of the library you are using is that it works the same on all - it just makes *your* job a nightmare.<br>Hence I consider these things are bugs. <br><br></td></tr></table><br>
<a name="1219319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I kind of like the way MacOS turns double quotes into matching 66 99 quotes, it certainly looks better on a printed page. <br><br>MaxGUI was never intended to dumb all platforms down to the same level, only allow easy access in a uniform manner so simple desktop gadget based apps could be easily created with BlitzMax. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
