<!DOCTYPE html><html lang="en" ><head ><title >Help with system beep on listbox</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Help with system beep on listbox</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >Help with system beep on listbox</a><br><br>
<a name="1022257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Problem: on windows (but not on mac) when you click on an item in a listbox in my current project the system plays it's beep sound. If you click in the listbox in the empty space with no items there's no beep. Doesn't happen on mac. Isn't caused by any of my code in EVENT_GADGETSELECT (I've commented the whole event out to confirm). And nothing seems to be going wrong (everything functions as it should despite the mystery beep). Logging un-captured events has nothing I don't expect to see.<br><br>I've tried to make a test app but I can't create the problem again so I know it's something I'm doing SOMEWHERE but I can't figure out where it could possibly be coming from.<br><br>Any ideas on where else I can look? I've tried to duplicate anything I thought could be affecting it in my test app (gadgets have an extra object attached, matched all font styles, added a canvas incase it was related to a draw of some kind...) but it won't beep on me.<br><br>Of note, the tooltips for the listbox items on my project are yellow and flat, where as the tooltips on listbox items in my non beeping test app are matching the system tooltip style (beveled and grey blue). <br><br></td></tr></table><br>
<a name="1022268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> My first guess would be to check to see if any event <u>hooks</u> are catching the <b>EVENT_GADGETSELECT</b>s generated for listboxes.  If so, maybe try changing them over to event <u>queue</u> logic.<br><br>Does the <b>CreateListbox()</b> example beep too? <br><br></td></tr></table><br>
<a name="1022278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Example does not beep, just like my attempts to recreate the beep.<br><br>I tried not attaching my event hook at all so nothing was being hook, and there is no specific hook for gadgetselect.<br><br>I suspect it has something to do with the fact that the tooltips look different, that would imply to me that it's using something different at a maxgui driver level perhaps... I am using setting the graphics driver to OpenGL on windows, but doing that on my test resulted in no beep and no change in tooltip style...<br><br>Any ideas why the tooltips might look different? maybe that will direct me to something I'm setting weird somewhere else that I'm overlooking. <br><br></td></tr></table><br>
<a name="1022454"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Any ideas why the tooltips might look different? maybe that will direct me to something I'm setting weird somewhere else that I'm overlooking. <br></div><br>I haven't seen this appear in MaxGUI for ages, not since I first compiled my Max'dGUI project with the then development version of the Windows driver.<br><br>Do you have Process Monitor installed?  Can you report how many active handles and objects your process has open when the listbox tooltip fonts go mangled? <br><br></td></tr></table><br>
<a name="1022468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, just to check, make sure that you are only calling MaxGUI commands from the main-thread.  Manipulating Windows controls from other threads may have undesired effects, and might cause such behavior that you are describing. <br><br></td></tr></table><br>
<a name="1022472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> emailed you some screen snippets to show what they look like.<br><br>Don't have process monitor installed but I just tried my test app having it load an absolute minimum to get up and running (no user content, etc. just minimum gui graphics) and it doesn't affect it.<br><br>I know it's something I'm doing in my setup because if it was just maxgui and my system it would happen in the test, so it's something app specific that I'm doing to cause maxgui to get a little mad... but I still have no idea what it could be. Could it be related to graphics calls specifically? a background image attached to a panel that's not related to the list box? too many canvases with GLShareContext enabled? I've tried the test with 1 canvas, but I didn't put it through any draw commands... <br><br></td></tr></table><br>
<a name="1022475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> emailed you some screen snippets to show what they look like. <br></div><br>Kk, cool - btw, which e-mail address are you using? I just checked now and I haven't received this one, or the one you sent a few days ago either.  <br><br>Edit: Ok, that's worrying - my Blitz e-mail address doesn't appear to be receiving any mail, and hasn't done for a while.  Try my personal address:  &lt;removed&gt; . <br><br></td></tr></table><br>
<a name="1022479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> eep, hosting trouble? it hasn't bounced back to me, perhaps they're getting stuck in a que on the server waiting to be delivered.<br><br>re-sent to gmail <br><br></td></tr></table><br>
<a name="1022481"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool - got it. Thanks.  Hmmm...  As you can imagine, it's pretty hard to debug without having the code to test against.  Ermmm... How many ancestors does the broken listbox have?<br><br>Also, this is a shot in the dark, but it might give us a few ideas.  Can you comment out line 4363 of <i>maxgui.mod/win32maxguiex.mod/win32maxguiex.bmx</i>:<br><pre class=code>						PostGuiEvent EVENT_GADGETPAINT</pre>...build modules, and then tell me whether the listbox tooltip fonts are still strange.<br><br>Remember to change it back though once you've tested, otherwise none of your canvases will know to update. :-) <br><br></td></tr></table><br>
<a name="1022488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You got mail! :-) <br><br></td></tr></table><br>
<a name="1022489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> the listbox is inside a panel, that is inside a split panel pane, that is inside the window. I didn't do much testing on windows before I put the split panel in, but I'm 99% sure it was doing the same beeping and tooltip before I added it. Can probably dig up an older copy of the source to test if you think it's worth it. The test app list box is inside a panel as well to try to simulate the same conditions.<br><br>Apologies for a lack of code to post. Basically I'd have to post my whole program to reproduce it at this point and that's just too much and I can't share some of the code... That's why I was trying to make a test app to reproduce it but the tests all work fine.<br><br>I'll try the gadget paint hack and report back. <br><br></td></tr></table><br>
<a name="1022510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Issue is resolved thanks to Seb via email.<br><br>Long story short it was the custom icon causing windows to mess itself. check <a href="/posts.php?topic=71485#801572" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=71485#801572</a> for details on how to fix/prevent. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
