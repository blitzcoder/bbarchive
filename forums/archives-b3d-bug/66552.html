<!DOCTYPE html><html lang="en" ><head ><title >Request: Get Brush Properties</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Request: Get Brush Properties</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=50" >Blitz3D Bug Reports</a>/<a href="#bottom" >Request: Get Brush Properties</a><br><br>
<a name="743534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This isn't a bug report by definition, but I currently can't find a work around for this IMHO important functionality.<br><br>While there is GetSurfaceBrush, GetBrushTexture and TextureName$, I urgently need to determine the flags and all other properties, of brushes as well as of textures. As Long as I canot determine them, I simply cannot save these meshes correctly. Ok, I can write a loader that will determine these properties, but a Brush that is created at runtime, eg. by GetSurfaceBrush, won't allow this, while GetSurfaceBrush is actually required to save the mesh after using AddMesh.<br><br>I already tried to use hacking solutions, peeking on offsets of handles etc. While some things still work (blendmode, fx etc.) Texture flags unfort. don't work anymore with the latest Blitz update.<br><br>So, if threre will ever be a further Blitz3D version after V1.98, then please (on knees) please add these functions, Get Property for all properties that may be stored in a B3D file, in the BRUSH and TEXS chunks (and cannot already determined somehow), thank you!<br><br>If there's an other solution, then please let me know. <br><br></td></tr></table><br>
<a name="743545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> *gets down on knees*<br><br>oh wait, what exactly are we begging for again?<br><br>new functions? <br><br></td></tr></table><br>
<a name="743557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> GetBrushNumberOfTextures(brush)<br>GetBrushName$(brush) <br>GetBrushRed(brush)<br>GetBrushGreen(brush)<br>GetBrushBlue(brush)<br>GetBrushAlpha(brush)<br>GetBrushShininess(brush)<br>GetBrushBlendmode(brush)<br>GetBrushFX(brush)<br><br>(GetBrushTexture and GetTextureName$ already exists.)<br><br>GetTextureFlags(tex)<br>GetTextureBlendmode(tex)<br>GetTextureX(tex)<br>GetTextureY(tex)<br>GetTextureScaleX(tex)<br>GetTextureScaleY(tex)<br>GetTextureRotation(tex)<br>GetTextureCoordset(tex)<br><br>EDIT<br>BTW I wouldn't mind if it wasn't organized in seperate functions, to keep the number of new functions low. I think something like <br><br>EG: GetProp$(TextureScaleX%,handle%) would work well too. handle could be a brush or texture handle. TextureScaleX% is a individual integer ID for this property. Return value may be string. I know, not that elegant, but it doesn't matter that much cause in most cases this has not to be fast. <br><br></td></tr></table><br>
<a name="743639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok right now I'm using Tomspeeds MemoryLib.dll: <a href="http://tomspeed.com/memorylib/." target="_blank">http://tomspeed.com/memorylib/.</a> It works, as long as the texture is not DDS, unfortunately.<br><br>EDIT to obtain texture scale U/V and TexCoordsSet you need to use further work-arounds, as described here:<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=66551" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=66551</a><br>(scroll down to my conclusion) <br><br></td></tr></table><br>
<a name="838868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shodan</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @jfk<br>It comes a little bit late, but try this:<br><pre class=code>
Global hackbank1,hackbank2
hackbank1=createbank(4)
hackbank2=createbank(4)
Dim scan(16,4)

Function GetBrushAlpha#(brush)
 Local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+32
 RtlMoveMemory1(hackbank2,adr,4)
 return PeekFloat(hackbank2,0)
End Function

Function GetBrushShininess#(brush)
 Local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+28
 RtlMoveMemory1(hackbank2,adr,4)
 return PeekFloat(hackbank2,0)
End Function

Function GetBrushRED(brush)
 local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+16
 RtlMoveMemory1(hackbank2,adr,4)
 Return PeekFloat(hackbank2,0)*255
End Function

Function GetBrushGREEN(brush)
 Local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+20
 RtlMoveMemory1(hackbank2,adr,4)
 Return PeekFloat(hackbank2,0)*255
End Function

Function GetBrushBLUE(brush)
 local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+24
 RtlMoveMemory1(hackbank2,adr,4)
 Return PeekFloat(hackbank2,0)*255
End Function

Function GetBrushBLEND(brush)
 local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+4
 RtlMoveMemory1(hackbank2,adr,4)
 Return Peekbyte(hackbank2,0)
End Function

Function GetBrushFX(brush)
 local adr
 RtlMoveMemory1(hackbank1,brush,4)
 adr=PeekInt(hackbank1,0)+40
 RtlMoveMemory1(hackbank2,adr,4)
 Return Peekbyte(hackbank2,0)
End Function

Function GetTextureBlend(tex)
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 adr=PeekInt(hackbank1,0)+24
 RtlMoveMemory1(hackbank2,adr,4)
 Return Peekbyte(hackbank2,0)
End Function

Function GetTextureScaleX#(tex)
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 adr=PeekInt(hackbank1,0)+36
 RtlMoveMemory1(hackbank2,adr,4)
 Return (1.0/Peekfloat(hackbank2,0))
End Function

Function GetTextureScaleY#(tex)
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 adr=PeekInt(hackbank1,0)+40
 RtlMoveMemory1(hackbank2,adr,4)
 Return (1.0/Peekfloat(hackbank2,0))
End Function

Function GetTexturePosX#(tex)
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 adr=PeekInt(hackbank1,0)+44
 RtlMoveMemory1(hackbank2,adr,4)
 Return ((-1.0)*Peekfloat(hackbank2,0))
End Function

Function GetTexturePosY#(tex)
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 adr=PeekInt(hackbank1,0)+48
 RtlMoveMemory1(hackbank2,adr,4)
 Return ((-1.0)*Peekfloat(hackbank2,0))
End Function

Function GetTextureFlags(tex,mode=2)
; Mode=0 for Createtexture()
 ; Mode=1 for Loadtexture()
 ; Mode=2 for GetBrushTexture() does not work proper!
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 Select mode
  Case 0
   offset=140
  Case 1
   offset=228
  Case 2
   offset=196
  Default
   offset=196
 End select
 adr=PeekInt(hackbank1,0)+offset
 RtlMoveMemory1(hackbank2,adr,4)
 Return Peekshort(hackbank2,0)
End Function

Function GetTextureRotation#(tex)
 local adr
 RtlMoveMemory1(hackbank1,tex,4)
 adr=PeekInt(hackbank1,0)+52
 RtlMoveMemory1(hackbank2,adr,4)
 Return (360.0/(pi*2))*(Peekfloat(hackbank2,0))*(-1.0)
End Function
</pre><br>You need the following .decls<br><pre class=code>
.lib "kernel32.dll"

RtlMoveMemory1%(Destination*,Source,Length) : "RtlMoveMemory" 
</pre><br>I´m sorry, that GetTextureFlags() does not work properly. I can´t find flags proper position inside the memory, when texture-handle was received with GetBrushTexture().<br>Any Ideas?<br><br>Please can you mail me tomspeeds memorylib.dll.<br>Can´t find a valid Link to download.<br><br>thanks Shodan<br><br>mail: heinz-helge@... <br><br></td></tr></table><br>
<a name="839345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> See the other thread, it's inside the saveB3D_2007a (or similar).zip <br><br></td></tr></table><br>
<a name="839820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shodan</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks jfk EO-11110 <br> <br><br>I will test it. Seems to be very helpful. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
