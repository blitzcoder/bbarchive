<!DOCTYPE html><html lang="en" ><head ><title >Really wierd keyboard and mouse bug</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Really wierd keyboard and mouse bug</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=50" >Blitz3D Bug Reports</a>/<a href="#bottom" >Really wierd keyboard and mouse bug</a><br><br>
<a name="541879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gburgess</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having real trouble figuring this out, and it's a tricky one to reproduce.<br><br>This bug has so far only appeared when Blitz3D is running <i>some</i> software fullscreen. The software that falls into that "some" category <i>seems</i> to be the more graphically intense stuff. Not <i>really</i> intense, just basically stuff that involves a screenful of 3d.<br><br>Basically, what happens is the controls "lock" for a half-second or so. By "controls" I mean Keyboard and Mouse. If, for example, I hold down a key, sometimes when I release it the software behaves as though I'm still holding it down for a half second. Similarly, when I press a key, there may be a half-second delay before things actually happen. For the mouse, the pointer will just lock up for a half-second and then carry on.<br><br>The really odd part is that none of this affects frame rate. So the software itself doesn't freeze.<br><br>I don't think this is a programming error on my part because:<br><br>1) I can't think of any circumstance where the controls would "lock" like that but the game keep running. The controls are checked every time the game loops, and that does not change at all.<br>2) This bug appeared in two unrelated programs at the same time.<br><br>This MAY be a fault with my system, for latter of those two reasons.<br><br>However, I have a feeling I may have uncovered a bug in Blitz somewhere because:<br><br>1) I have thoroughly checked my system for any rogue services or startup programs that may be causing this problem.<br>2) This has yet to occur in any other games, or in Windows.<br><br>The bug does not happen in Blitz3d's Debug mode. It also does not happen all the time, but it seems fairly frequent.<br><br>I have ruled out:<br>1) External DLLs.<br>2) Software running in the background.<br><br>Anyone ever experienced anything like this before? I'm using Blitz3d 1.90 on a GeForce 6600, Windows XP, 1Gb RAM. <br><br></td></tr></table><br>
<a name="541910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gburgess</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I think I may have found something.<br><br>This is going to sound very strange, but if I put a "Delay 10" command in the loop, the problem seems to disappear.<br><br>Also, I've not been able to reproduce this effect on anyone else's computer.<br><br>Soo... tentative conclusion... maybe reading the mouse and keyboard too often causes the buffers to lock up for a short period?<br><br>I sorta pulled that out my backside, I know, but does it sound plausible?<br><br>This is the code I'm calling each cycle to check the mouse:<br><pre class=code>	mx%=MouseX()
	my%=MouseY()
	mp1%=MouseHit(1)
	md1%=MouseDown(1)
	md2%=MouseDown(2)
	mxs=MouseXSpeed()
	mys=MouseYSpeed()</pre><br><br>It does not change between affected and unaffected Blitz3d programs.<br><br>Switching from a PS2 to a USB mouse had no effect. <br><br></td></tr></table><br>
<a name="542349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suspect a piece of your code is stalling things by taking too long to execute. Common causes of this are loading stuff in the main loop and using more VRAM than you physically have, causing things to get swapped in and out of main mem. Thus, the problem may not show on another computer with better specs.<br><br>I know you said the FPS doesn't change but sometimes the reported FPS can lie, depending on how you're calculating it. Can you actually <i>see</i> other stuff moving when the mouse stalls, etc?<br><br>Also, try putting FlushKeys and FlushMouse after reading your input into variables. <br><br></td></tr></table><br>
<a name="542375"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Off the top of my head, the MouseX/MouseXSpeed commands /could/ be conflicting with each other, same with the Y equivalents.<br><br>There is a (unofficial?) command to switch between using DirectInput or WinAPI (or somesuch) for input - there's a keyword something like<br>DisableDirectInput True/False ... or...<br>DirectInputOn True/False<br>...  might be worthwhile digging for something like that and testing to see if it makes a differance... <br><br></td></tr></table><br>
<a name="542498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HappyCat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glenny-boy, I used to get the same thing, but I had it all the time (with Debug on or off) when running my game in windowed mode (but not fullscreen) on my laptop (but not on any other PC I tried it on).<br><br>I wasn't using MouseXSpeed() and switching to DirectInput (as Hotcakes suggests) didn't help.<br><br>However it went away after I upgraded my video drivers (for an unrelated reason, ie. Half-Life 2). Has never happened again. <br><br></td></tr></table><br>
<a name="542612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gburgess</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> To answer y'all:<br><br>big10p: I am 100% certain no frames are dropped. I test this by loading the editor for my game, holding down an arrow key to keep the camera moving, and moving the mouse pointer with my other hand. It's very clear that the mouse freezes for half-second perionds while the camera continues to move smoothly. In the editor, <i>nothing</i> is being loaded with selecting something, and in it's base state puts very little strain on a graphics card. The mouse lockups coincide with keyboard lockups. I will try Flushing the buffers more often, it could well be as simple as that.<br><br>Hotcakes: Good tip, I'll give it a shot.<br><br>HappyCat: This has been happening for three different video driver revisions and two graphics cards (I got Battlefield 2 recently, and it didn't like my GeForce 4200, even after I upgraded the drivers. So I got a new card. And some even newer drivers came out, etc etc, this problem started before I bought BF2). I've also upgraded all the drivers on my nForce2 motherboard. Still no change.<br><br>Thanks for the thoughts, guys, I'll give them a roll. This one's got me tearing my hair out. I'd reinstall my system, but whenever I have a problem I can't solve (rare ;) ) and I do this, the problem always comes back. So I've learned my lesson, if I don't find the cause of a problem, it'll never go away. :D <br><br></td></tr></table><br>
<a name="542619"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HappyCat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Was just a thought - but also an example of how something completely unrelated to your code can cause these kinds of problems. <br><br></td></tr></table><br>
<a name="542743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gburgess</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh yeah, totally, wasn't a bad suggestion by any means. <br><br></td></tr></table><br>
<a name="544392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tue</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dear all who has discussed this little mouse/keyboard delay issue:<br>A couple of years ago, I programmed a small DirectX engine in C++, discovering the exact same problem. Now, I think it may be a problem with Direct3D versus DirectInput (at least that was what I found out back then). Using OpenGL and DirectInput doesnt create this problem, while D3D and DInput makes it all go BAD. A really weird problem.<br><br>To me there doesnt seem to be any obvious solution. Originally it was a fullscreen only problem that could be solved by using windowed mode. I recently reinstalled my OS, and now it큦 the other way around. It큦 only a problem in Windoed mode, not in fullscreen.<br>So, in other words: It큦 a Microsoft bug, not a Blitz bug.<br><br>A simple solution could be to enable your game to run in both windowed and fullscreen mode. Since there is no clear reason why and when it will happen, this is the only thing I can think of.<br><br>Tue <br><br></td></tr></table><br>
<a name="544393"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tue</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dear all who has discussed this little mouse/keyboard delay issue:<br>A couple of years ago, I programmed a small DirectX engine in C++, discovering the exact same problem. Now, I think it may be a problem with Direct3D versus DirectInput (at least that was what I found out back then). Using OpenGL and DirectInput doesnt create this problem, while D3D and DInput makes it all go BAD. A really weird problem.<br><br>To me there doesnt seem to be any obvious solution. Originally it was a fullscreen only problem that could be solved by using windowed mode. I recently reinstalled my OS, and now it큦 the other way around. It큦 only a problem in Windoed mode, not in fullscreen.<br>So, in other words: It큦 a Microsoft bug, not a Blitz bug.<br><br>A simple solution could be to enable your game to run in both windowed and fullscreen mode. Since there is no clear reason why and when it will happen, this is the only thing I can think of.<br><br>Tue <br><br></td></tr></table><br>
<a name="544411"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gburgess</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Tue, interesting stuff there. Bit of a bummer.<br><br>I don't even get the problem all the time, I'd say it's only 50% of the time. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
