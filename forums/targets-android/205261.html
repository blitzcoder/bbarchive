<!DOCTYPE html><html lang="en" ><head ><title >Android Image.WritePixels()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Android Image.WritePixels()</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Android Image.WritePixels()</a><br><br>
<a name="2058252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HokaMonstret</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br><br>I'm new to Monkey and have found that Image.WritePixels() is terribly slow on android. I want to recreate some old Amiga stuff I did back in the day. Is there any good info on how Monkey gets translated to android or how to integrate native code. Manipulating the pixelsarrays is fast. It runs at 60 fps as long as I don't call WritePixels(). What I can tell most drawing is handled by 3d hardware. Am I wrong? <br><br></td></tr></table><br>
<a name="2058278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know really.  I would have imagined that WritePixels() would be no slower than loading an image.  If anything I would have thought that ReadPixels() might be slow because data is going 'the wrong way'. <br><br></td></tr></table><br>
<a name="2058310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> how are you using WritePixel? you could try to write bulk pixels once every 10 frames or something. Behind the scenes it looks like Android is rebinding the texture, so you probably don't want to do this every frame. <br><br></td></tr></table><br>
<a name="2058323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HokaMonstret</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm calling it every frame since I'm applying a scroll and blur operation on the argb data. This seems to be a bottleneck on android:( The pixelarray is displaywidth+32, height 38. <br><br></td></tr></table><br>
<a name="2058325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HokaMonstret</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a new android Bitmap Object being created each frame and the old one garbagecollected perhaps?? <br><br></td></tr></table><br>
<a name="2058332"></a>

<a name="2058333"></a>

<a name="2058334"></a>

<a name="2058335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> its opengl, so android is binding and uploading the data per frame.<br><br>Also, looking at mojo, looks like each texture Bind() call mojo is padding non-powers of two textures, and on top of that converts the image to the proper RGB format and pre-multiplies, which <strike>probably isn't needed after the first time</strike> could be done on our side.<br><br>So i'd say mojo may need a little tweaking, you may want to mention this to Mr.Sibly and see if he can throw something in there that doesn't re-do that byte shifting if we're using WritePixel() for RGBA8888.<br><br>In the meantime, make sure your image is powers-of-two size (32x64 should work) and use GetImage() to clip it. <br><br></td></tr></table><br>
<a name="2058415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HokaMonstret</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think opengl uses 16bit textures. Where do you find this mojostuff? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
