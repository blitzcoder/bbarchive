<!DOCTYPE html><html lang="en" ><head ><title >Building to 3.2 not 4.2?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Building to 3.2 not 4.2?</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Building to 3.2 not 4.2?</a><br><br>
<a name="2050909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyloman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Monkey says its building for 3.2 is there a way to change it to build to 4.2 android? <br><br></td></tr></table><br>
<a name="2050916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ironstorm</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You've to set the "targetSDKversion" in the AndroidManifest.xml to 17. <br><br></td></tr></table><br>
<a name="2050917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyloman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Still says <br>[gettarget] Project Target:   Android 3.2 <br><br></td></tr></table><br>
<a name="2050922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ironstorm</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm currently not on my PC. Are you sure, you've changed the right AndroidManifest.xml? In the build dir there are two of them. In "android/Layouts/" is the right one. Monkey overrides the other one while compiling. <br><br></td></tr></table><br>
<a name="2050928"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyloman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahhh yep i changed the wrong one. cheers <br><br></td></tr></table><br>
<a name="2051000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> What about this "targetSDKversion"? By default mark set it to 7. <br>Now I have some questions. Maybe you can help me?<br><br>Do I have to expect any problems with installations on older smart phones (2.3) when I change the value to 17?<br><br>Do I have to download any updates of the android SDK to do this? <br><br>There is no folder "android/Layouts/" in my build folder? And I thought I have to change the manifest in "android/templates/" permanent? <br><br></td></tr></table><br>
<a name="2051012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ironstorm</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I said, I wasn't at my PC. Of course, the folder could be "templates". <br>You've two values. "targetSDKversion" is the Android version which you (the developer) tested. Any newer Android Version can install your app, but you doesn't guarantee that your app work properly. <br>The second value is "minSDKversion". This is the minimum Android version which your app will work on. <br><br>And on devices with honycomb (android 3.x) or newer your app automatically get this software menu button, which cause your screen resolution will be smaller. Because newer smartphones hasn't those hardware menu buttons anymore.<br>But if you set your targetSDKversion to Android 4.x, it just shown up when you create a context menu. And as I understand, there isn't any other way to deactivate this software menu button than set your targetSDKversion higher. <br><br>And yeah, you've to install the target SDK through the Sdk tool. <br><br></td></tr></table><br>
<a name="2051006"></a>

<a name="2051009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyloman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Changed them and still says target is 3.2 in log. <br><br></td></tr></table><br>
<a name="2051057"></a>

<a name="2051058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DGuy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Two ways:<br><br>For all projects:<br>In the file "/targets/android/project.properties", change "target=android-13" to "target=android-17"<br><br>NOTE: The "&lt;appname&gt;.build/android" directory will need to be deleted for this change to take affect.<br><br><br>For a single project:<br>In the file "&lt;appname&gt;.build/android/ant.properties", add "target=android-17" <br><br></td></tr></table><br>
<a name="2051172"></a>

<a name="2051183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ironstorm, thank you a lot for this additional informations. I'm not very firm in Android things.... and always unsure, what will be the side effects, when changing my running system.<br><br>So in general it makes sense to update now the SDK to version 17 and set the parameters in monkey permanant to 17.<br><br>From this moment Monkey would compile with the SDK 17. And it has no negative effects on older (2.3) smartphones... OK...<br><br>*** EDIT ***<br><br>Ok, I tried to fetch the SDK 17 with the Android SDK Manager. But after actualizing at the beginning the manager only offers me 3 downloads in the SDK 17 area:<br><br>Intel X86...<br>Mips System..<br>Google Apis...<br><br>The older SDKs always contain also "SDK Platform API xx" and Samples and Documentation. <br><br>And when I try to start these 3 downloads the SDK manager informs me about dependencies to the missing "SDK Platform API 17"<br><br>But the Manager does not offer me the download of this. What do I do wrong? <br><br></td></tr></table><br>
<a name="2051188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ironstorm</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try to check "Force <a href="https://..." target="_blank">https://...</a> sources to be fetched using http://..." in Tools-&gt;Options. After that install the previous SDK "API 16". Maybe you've to install this at first. <br><br></td></tr></table><br>
<a name="2051194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh! Nice! This https.. worked! Thank you<br><br>SDK API 16 was already installed.<br><br>Suddenly the manager detects 13 updates. Now I will update all and hope, that afterwards my monkey still compiles to android target. keep fingers crossed... as a pessimist I don't like updates <br><br></td></tr></table><br>
<a name="2051370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the tip about versions.  My current project can live with the soft menu, but I have another where I'd really like the option of killing it.<br><br>It really hurts a lot of landscape-mode games.  How many times have you accidentally hit soft-back in Fruit Ninja, for example?  Terrible decision by google to not have a way to escape it (there could be a special gesture to force it back if apps go bad).  <br><br>[And even more annoying to read Googlebots on forums telling us why hard keys are bad.] <br><br></td></tr></table><br>
<a name="2052836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, I have changed all things as you told me. But the result is still a build with this lines in ANDROID.MANIFEST:<br><br><pre class=code>...	&lt;uses-sdk 
		android:minSdkVersion="3"
		android:targetSdkVersion="7" /&gt;
...</pre><br><br>That's like before! What would be the corrrect value? ="17"?<br><br>And the apps are not running on Android 4.2.<br><br>When I build the protocoll shows this:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">"C:/MonkeyPro66/bin/trans_winnt" -target=android -config=Release -run "C:/Monkey/NotenSpiel/TestAndroid42.monkey"
TRANS monkey compiler V1.42
Parsing...
Semanting...
Translating...
Building...
Buildfile: C:\Monkey\NotenSpiel\TestAndroid42.build\android\build.xml

-check-env:
 [checkenv] Android SDK Tools Revision 21.1.0
 [checkenv] Installed at C:\Programme\Android\android-sdk

-setup:
     [echo] Project Name: MonkeyGame
  [gettype] Project Type: Application

-pre-clean:

clean:
[getlibpath] Library dependencies:
[getlibpath] No Libraries
   [subant] No sub-builds to iterate on

BUILD SUCCESSFUL
Total time: 0 seconds
Buildfile: C:\Monkey\NotenSpiel\TestAndroid42.build\android\build.xml

-set-mode-check:

-set-debug-files:

-check-env:
 [checkenv] Android SDK Tools Revision 21.1.0
 [checkenv] Installed at C:\Programme\Android\android-sdk

-setup:
     [echo] Project Name: MonkeyGame
  [gettype] Project Type: Application

-set-debug-mode:

-debug-obfuscation-check:

-pre-build:

-build-setup:
     [echo] Resolving Build Target for MonkeyGame...
[gettarget] Project Target:   Android 4.2.2
[gettarget] API level:        17
     [echo] ----------
     [echo] Creating output directories if needed...
    [mkdir] Created dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\libs
    [mkdir] Created dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin
    [mkdir] Created dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res
    [mkdir] Created dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\gen
    [mkdir] Created dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\classes
    [mkdir] Created dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\dexedLibs
     [echo] ----------
     [echo] Resolving Dependencies for MonkeyGame...
[dependency] Library dependencies:
[dependency] No Libraries
     [echo] ----------
     [echo] Building Libraries with 'debug'...
   [subant] No sub-builds to iterate on

-code-gen:
[mergemanifest] Merging AndroidManifest files into one.
[mergemanifest] Manifest merger disabled. Using project manifest only.
     [echo] Handling aidl files...
     [aidl] No AIDL files to compile.
     [echo] ----------
     [echo] Handling RenderScript files...
[renderscript] No RenderScript files to compile.
     [echo] ----------
     [echo] Handling Resources...
     [aapt] Generating resource IDs...
     [echo] ----------
     [echo] Handling BuildConfig class...
[buildconfig] Generating BuildConfig class.

-pre-compile:

-compile:
    [javac] Compiling 3 source files to C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\classes
    [javac] Note: C:\Monkey\NotenSpiel\TestAndroid42.build\android\src\com\monkey\MonkeyGame.java uses or overrides a deprecated API.
    [javac] Note: Recompile with -Xlint:deprecation for details.
    [javac] Note: C:\Monkey\NotenSpiel\TestAndroid42.build\android\src\com\monkey\MonkeyGame.java uses unchecked or unsafe operations.
    [javac] Note: Recompile with -Xlint:unchecked for details.

-post-compile:

-obfuscate:

-dex:
      [dex] input: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\classes
      [dex] Converting compiled files and external libraries into C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\classes.dex...

-crunch:
   [crunch] Crunching PNG Files in source dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\res
   [crunch] To destination dir: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res
   [crunch] Processing image to cache: C:\Monkey\NotenSpiel\TestAndroid42.build\android\res\drawable-hdpi\icon.png =&gt; C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res\drawable-hdpi\icon.png
   [crunch]   (processed image to cache entry C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res\drawable-hdpi\icon.png: 0% size of source)
   [crunch] Processing image to cache: C:\Monkey\NotenSpiel\TestAndroid42.build\android\res\drawable-ldpi\icon.png =&gt; C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res\drawable-ldpi\icon.png
   [crunch]   (processed image to cache entry C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res\drawable-ldpi\icon.png: 0% size of source)
   [crunch] Processing image to cache: C:\Monkey\NotenSpiel\TestAndroid42.build\android\res\drawable-mdpi\icon.png =&gt; C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res\drawable-mdpi\icon.png
   [crunch]   (processed image to cache entry C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\res\drawable-mdpi\icon.png: 0% size of source)
   [crunch] Crunched 3 PNG files to update cache

-package-resources:
     [aapt] Creating full resource package...

-package:
[apkbuilder] Current build type is different than previous build: forced apkbuilder run.
[apkbuilder] Creating MonkeyGame-debug-unaligned.apk and signing it with a debug key...

-post-package:

-do-debug:
 [zipalign] Running zip align on final apk...
     [echo] Debug Package: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\MonkeyGame-debug.apk
[propertyfile] Creating new property file: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\build.prop
[propertyfile] Updating property file: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\build.prop
[propertyfile] Updating property file: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\build.prop
[propertyfile] Updating property file: C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\build.prop

-post-build:

debug:

install:
     [echo] Installing C:\Monkey\NotenSpiel\TestAndroid42.build\android\bin\MonkeyGame-debug.apk onto default emulator or device...
Done.</textarea> <br><br>Could it be, that I additional have to set the targetSdkVersion in the ANDROID.MANIFEST manually? Or should (can) I change this in...<br><br><pre class=code>C:\MonkeyPro66\targets\android\templates\android.manifest</pre><br>???<br><br>An what about Monkey V69? There is no file "/targets/android/project.properties" any more. Where can I set the SDK version now? <br><br><br>Is this bug message still valid? Do I have to do this fix? Or is it already solved in V66?:<br><br><a href="http://www.monkeycoder.co.nz/Community/post.php?topic=4138&amp;post=44418" target="_blank">http://www.monkeycoder.co.nz/Community/post.php?topic=4138&amp;post=44418</a><br><pre class=code>buf.position( 0 ); 
GLES11.glTexImage2D</pre><br><br>Please help me... <br><br></td></tr></table><br>
<a name="2052835"></a>

<a name="2052834"></a>

<a name="2052979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could somebody please run this code and the corresponding apk on a android 4.2 target. <br><br>All users that reported problems with this test-app had a Nexus 4.2 tablet, and I do'nt know whether this is a only "nexus" problem. They tell me,the app does not "crash", but ends immediately.<br><br>sample:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
Import mojo

Class Game Extends App

	Field Timer%
	Method OnCreate%()
		SetUpdateRate 15
		Timer=Millisecs()+13000
		Return 0
	End	

	Method OnUpdate%()
		'If KeyHit(KEY_ESCAPE) Then Error ""
		Return 0
	End	

	Method OnRender%()
		Cls 255,255,0
		SetColor 255,0,0
		Scale 5,5
		DrawText (Timer-Millisecs()),10,10
		If Timer&lt;Millisecs()
			Error ""
		endif
		Return 0
	End	
	
End

Function Main%()
	New Game
	Return 0
End
</textarea><br><br>here is the compiled apk. Done with Monkey V66 and SDK 21<br><br><a href="http://www.midimaster.de/temp/monkeygameD.apk" target="_blank">http://www.midimaster.de/temp/monkeygameD.apk</a><br><br>Strange, but this code would run on 4.2:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
Import mojo

Class Game Extends App

	Method OnCreate%()
		SetUpdateRate 15
		Return 0
	End	

	Method OnUpdate%()
		If KeyHit(KEY_ESCAPE) Then Error ""
		Return 0
	End	

	Method OnRender%()
		Cls 255,255,0
		Return 0
	End	
	
End

Function Main%()
	New Game
	Return 0
End</textarea> <br><br></td></tr></table><br>
<a name="2053002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> hello.<br>I tried to download your .apk and it didn't even start.<br>If i compile the code, install it and then run it its fine.<br>I would suspect it's something to do with whats installed on your pc.<br>I tried it on a SGS2 with 4.1 and nexus 10 with 4.2 <br><br></td></tr></table><br>
<a name="2053155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> What monkey version do you use? What SDK?<br><br>I don't have problems on all android 4.x version, but 4.2. At first I thoung about a problem in my code. But because I can reduce it to this above, I am sure too, it has to be a problem with the files of building...<br><br>I will now download monkey V69 and compile it. Could somebody please test this on a 4.2 smartphone?<br><br>This time the filename ends with an "E" and the testscreen has blue color:<br><br><a href="http://www.midimaster.de/temp/monkeygameE.apk" target="_blank">http://www.midimaster.de/temp/monkeygameE.apk</a><br><br>I have some new lines in the protocol. I saw nver before:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">BUILD SUCCESSFUL
Total time: 12 seconds
--------- beginning of /dev/log/main
--------- beginning of /dev/log/system
E/AndroidRuntime( 2405): feature code ==&gt; cannot open file
E/SensorManager( 2430): registerListener :: handle = 0  name= K2DM delay= 20000 Listener= com.monkey.BBMonkeyGame@405232b0
E/SensorManager( 2430): =======&gt;&gt;&gt;Sensor Thread RUNNING &lt;&lt;&lt;========
E/SensorManager( 2430): reg :: handle = 0
E/        ( 2430): Creating OpenGL 1.1 Session
E/InputDispatcher( 1470): ~ Consumer closed input channel or an error occurred.  events=0x8
E/InputDispatcher( 1470): ~ Channel is unrecoverably broken and will be disposed!
E/SensorService( 1470): dropping 1 events on the floor (Broken pipe)
E/Launcher( 1557): setWindowOpaque()
E/Launcher( 1557): setWindowOpaque()
E/PowerManagerService( 1470): CurLock p:3 mPS:1
Done.</textarea><br>and the "red button" on TED does not stop. Is this normal? <br><br></td></tr></table><br>
<a name="2053212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have SDK 21.1 rc3.<br>Monkey 67f.<br>Apache ant 1.9.0.<br>Java 32 1.7.0.17.<br>I remember having the missing dependencies error before.<br>What i did was to uninstall java, uninstall the sdk, uninstall apache ant.<br>Download the right version from the web, after that i updated and installed nearly every package from the sdk manager.<br>You probably already tried all of this , but that's what i did. <br><br></td></tr></table><br>
<a name="2053214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> can you please test this build on a android 4.2:<br><br><a href="http://www.midimaster.de/temp/monkeygameE.apk" target="_blank">http://www.midimaster.de/temp/monkeygameE.apk</a><br><br>It is the same test app like yesterday. This time the file name ends with an "E" and the testscreen should show blue color.<br><br>thank you <br><br></td></tr></table><br>
<a name="2053259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works on a nexus 10 4.2.<br>But the screen isn't blue its purple. <br><br></td></tr></table><br>
<a name="2053292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh! nice to hear!!! thanks a lot. Maybe it was really a problem of the V66....<br><br>You'r right: it was purple.. 225,0,255<br><br>So I would start another test. Would you help me again? <br><br>I try to compile my main app "Score-Trainer" with V69 and will put it on my server. Then you could install an run it for only testing, whether it starts or not. I know you have not much time at the moment, so a test about "it's starting" is sufficient.<br><br>I will be ready in about 7 hours and check back in... <br><br></td></tr></table><br>
<a name="2053315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't worry i am happy to help for a change.<br>Usually it's me asking for it :P <br><br></td></tr></table><br>
<a name="2053404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for the delay. When I changed my app to monkey V69 the builder found so many bug, that I needed a whole further night to remove them.<br><br>Now it seems, that I can show it to the world...<br><br>Would you please have a look on it. I'm only interested, whether it runs or not on Android 4.2. You can also check on 4.1. Advanced tests are not necessary yet.<br><br>Here is the file:<br><br><a href="http://www.midimaster.de/temp/score.apk" target="_blank">http://www.midimaster.de/temp/score.apk</a> <br><br></td></tr></table><br>
<a name="2053460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> On both of my devices the app install, start but as soon as you see the first screen it freezes and it says "Unfortunately blabla has stopped".<br>That means the new version doesn't run on 4.0.4 and on 4.2. <br><br></td></tr></table><br>
<a name="2053464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> that are no good news, because the last stabil version...<br><br><a href="https://play.google.com/store/apps/details?id=com.midimaster.scoretrainer" target="_blank">https://play.google.com/store/apps/details?id=com.midimaster.scoretrainer</a><br><br>.... made with V66 runs on 4.0 and 4.1 as far as I know!<br><br>Could please somebody confirm, that the app store version runs with android 4.0 and 4.1?<br><br><br>Now I only can hope, that this is only a small bug in my code and not a fundamental monkey error.<br><br>"first screen" means you saw the picture of "two hand on an piano". Or did you already see the main screen? <br><br></td></tr></table><br>
<a name="2053467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok... I updated... <br>ant to 1.9.0  <br>java to 1.7.17<br>Monkey is V69<br>Android SDK 17<br><br>With this I builded a new version of my score-trainer:<br><br><a href="http://www.midimaster.de/temp/scoreb.apk" target="_blank">http://www.midimaster.de/temp/scoreb.apk</a> <br><br>Can someone please test this on any Android 4? <br><br></td></tr></table><br>
<a name="2053512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes it stops on the 2 hands on the piano.<br>And latest version stops on all my devices. <br><br></td></tr></table><br>
<a name="2053622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank you,..<br><br>to get any results I now devided the code. I hope to surround the bug this way. <br><br>This part of today contains all OnCreate() stuff, but nearly no OnUpdate() stuff. The OnRender() stuff is reduced to only show the hands and the manual. As a proof that it's still running you will see the Millisecs() on the screen.<br><br>Would you please test the code agin on both Android 4 devices?<br><br>here is the app:<br><br><a href="http://www.midimaster.de/temp/scoreD.apk" target="_blank">http://www.midimaster.de/temp/scoreD.apk</a><br><br><br>With the help of JIM I think now the MNET module could cause the problems. So I have isolated the MNET to a small test app.<br><br><a href="http://www.midimaster.de/temp/TestMnet.apk" target="_blank">http://www.midimaster.de/temp/TestMnet.apk</a><br><br>it should contact my server and send you back a phrase. Please check if the Millisecs() keep on running after a break of 3 seconds.<br><br>Here is the code. Only if the app above crashes you could test the code for me. The code needs the MNET module.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
Import mojo
Import mnet

Class Game Extends App

	Field Timer%, Result$, Wait%
	
	Method OnCreate%()
			SetUpdateRate 15
			Timer=Millisecs()+13000
			Komm.Server = New Http()
	
			Return 0
	End	



	Method OnUpdate%()
			If KeyHit(KEY_ESCAPE) Then Error ""
			If Wait=2
					Result=Komm.Sende("123")
					Wait=3
			Endif
			
			If TouchHit(0) Then
					Result="wait..."
					Wait=1
			Endif
	
			Return 0
	End	



	Method OnRender%()
			Cls 0,0,255
			SetColor 255,0,0
			Scale 2,2
			DrawText (Timer-Millisecs()),10,10
			DrawText "Touch to test Mnet",10,30
			
			If Wait&gt;0
				Wait=Wait+1
				DrawText Result,10,70
			Endif
			If Timer&lt;Millisecs()
				Error ""
			endif
	
			Return 0
	End	
End



Function Main%()
	New Game
	Return 0
End



Class Komm
	Global Server:Http = Null
	Global Adresse$, Result$
	
	Function Sende$(Anfrage$)
			Print "send"
			#If TARGET="android"
					Adresse="http://www.midimaster.de/temp/score.php?" ' für endversion
			#Else
					Adresse="http://localhost/score.php?" ' für lokales http	
			#Endif
			
			Result= Server.Get( Adresse + Anfrage, 3000 )
	
			Return Result		
	End
End	
</textarea><br><br>My MNET module has a single workaround in mnet.android.java. It prevents from crashing monkey if there is no internet connecection:<br><br><pre class=code>....
  public String convertStreamToString( InputStream is )
  {
	// this line is added by MIDIMASTER:
	if (is == null) return "ERROR no Connection";
    StringBuilder sb = new StringBuilder();
    try
    {
....
</pre> <br><br></td></tr></table><br>
<a name="2053620"></a>

<a name="2053621"></a>

<a name="2053614"></a>

<a name="2053615"></a>

<a name="2053618"></a>

<a name="2053619"></a>

<a name="2053659"></a>

<a name="2053660"></a>

<a name="2053661"></a>

<a name="2053665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi there! I tested both. scoreD.apk works fine. TestMNet works fine until I tap the screen and the crash looks the same: Apparently MNet Get is having an issue.<br><br>(probably a stupid question) Did you request internet permissions in the manifest?<br><br>This looks like MNet needs an update. Took a look into ZygoteInit.java and mnet.android.java and at first glance it looks ok, but I think there might be changes to the way http requests are made in 4.2.<br><br>EDIT: Herp derp. Took a closer look at the log. I knew something is different with http requests in 4 or 4.x;<br><br>android.os.NetworkOnMainThread exception. Apparently the request must be threaded. This should be made as an update to MNet. Or as an alternative try to find another library for the http requests. <br><br></td></tr></table><br>
<a name="2053664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, both permissions are integraded:<br><pre class=code>	&lt;uses-permission android:name="android.permission.INTERNET" /&gt;
	&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;
</pre><br>...and I know, it runs perfect on 2.3 to 4.0.<br><br><br><br>ScoreD.apk is without MNET, and TestNmet.apk is without MNET until you Touch(). Then it tries to use the Http request. I did sent also the source code of TestNmet.apk. (see post #28 above...)<br><br><br>What I would like to know is now, whether MY system builded a buggy code, or whether the MNET module has bugs also, if somebody else build the sample code on his computer.<br><br>Would you please also test the source code of the post #28?<br><br>I feel, we are closed to the target...<br><br><br>thank you so much <br><br></td></tr></table><br>
<a name="2053666"></a>

<a name="2053667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> I added another edit as you replied :)<br><br>MNet must be modified to work in ASync mode. This is a good practice anyway since it won't freeze your app while you do the request.<br><br>EDIT: And another edit! MNet already supports this, yay!<br><br>Don't use Get! Use AGet(...) and GetResult()<br><br>You will have to check and make sure it's not "" or starts with "ERR". <br><br></td></tr></table><br>
<a name="2053670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks a lot, you are the best...I will test this and reply tomorrow <br><br></td></tr></table><br>
<a name="2053674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry i couldn't test anything cause i am actually on holiday.far from work and far from a pc (but not from a smartphone...)hopefully you will sort the problem.it seems you are near! <br><br></td></tr></table><br>
<a name="2053750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi JIM<br><br>I exchanged MNET on android with Mark's new HttpRequest() on hope it will work on Android 4.<br><br>The code looks a little bit confusing, because I still need http requests on HTML5 too. So now it works on both targets. But I'm only interested in your test on Android 4.<br><br>Could you please check this test:<br><br>After starting you should see Millisecs() countdown. Touch the display. Now you should see "wait", then it should change to server's respond.<br><br><pre class=code>Strict
Import mojo
Import mnet
#If TARGET="android"
	Import brl.httprequest
#Endif

Class Game Extends App 
	Field Timer%, Result$, Wait%, Server:Komm
	
	Method OnCreate%()
			SetUpdateRate 15
			Timer=Millisecs()+13000
			Server=Komm.StartUp()
	
			Return 0
	End	



	Method OnUpdate%()
			If KeyHit(KEY_ESCAPE) Then Error ""
			If Wait=2
					Server.Sende("L=123456")
					Wait=3
			Endif
			
			If TouchHit(0) Then
					Result="wait..."
					Wait=1
			Endif
			UpdateAsyncEvents
			Return 0
	End	



	Method OnRender%()
			Cls 0,0,255
			SetColor 255,0,0
			Scale 2,2
			DrawText (Timer-Millisecs()),10,5
			DrawText "Touch: Test Http-Get",10,20
			DrawText " V02",10,50
			
			If Wait&gt;0
				Wait=Wait+1
				DrawText Server.Receive(),10,35
			Endif
			If Timer&lt;Millisecs()
				Error ""
			endif
	
			Return 0
	End	
End



Function Main%()
	New Game
	Return 0
End



Class Komm

	#If TARGET="android"
		Field SubServer:AndroidServer
	#Else
		Field  SubServer:Http
	#Endif

	Field Adresse$,Result$

	Function StartUp:Komm()
		Local loc:Komm = New Komm
		#If TARGET="android"
			loc.SubServer=New AndroidServer
		#Else
			loc.SubServer = New Http()
		#Endif	
		Return loc
	End
	
	
	Method Sende:Void(Anfrage$)
			Print "send"
			#If TARGET="android"
					Adresse="http://www.midimaster.de/temp/score.php?" ' für endversion
					SubServer.LastResponse="wait"
					SubServer.Get Adresse+Anfrage
			#Else
					Adresse="http://localhost/temp/score.php?" ' für lokales http	
					Result= SubServer.Get( Adresse + Anfrage, 3000) 
			#Endif
	End	
	
	Method Receive$()
		#If TARGET="android"
			Result= SubServer.LastResponse
			Return Result
		#Else
			Return Result				
		#Endif
	End
End



Class AndroidServer Implements IOnHttpRequestComplete

	Field Request:HttpRequest=New HttpRequest
	
	Field LastResponse$=""

	Method Get:Void(Adresse$)
		Request.Open "GET", Adresse, Self
		Request.Send
	End
	
	
	
	Method OnHttpRequestComplete:Void( req:HttpRequest )
		Print "Http GET complete!"

		Print "Status="+req.Status()
		LastResponse =req.ResponseText()
		Print "ResponseText="+req.ResponseText()
	End
End
</pre><br><br><br>and here is my apk for a second check:<br><br><a href="http://www.midimaster.de/temp/TestMnetB.apk" target="_blank">http://www.midimaster.de/temp/TestMnetB.apk</a> <br><br></td></tr></table><br>
<a name="2053747"></a>

<a name="2053787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, the APK works as expected. It says "wait" then "THANK YOU" <br><br></td></tr></table><br>
<a name="2053837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank you JIM. That are good news. Now I want to add it to the main program. Also thank you to mteo77. I hope I can contact you both again, if a new problem appears. <br><br></td></tr></table><br>
<a name="2053844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, if I happen to not stumble upon a thread around here, my email is in my profile :) <br><br></td></tr></table><br>
<a name="2053936"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I did a lot of changes in my app to perhaps get it running also on Android 4.1 and 4.2. The reason for the problems is, that Android 4.x no longer seems to accept synchronous http requests. They have to be asynchron now.<br><br>Mark's new function does this! But not on HTML5 device, which I also need. So I created a network module which serves both targets... <br><br>perhaps... <br><br>The problem is: I cannot test it... I have no Android 4 device...<br><br>Could somebody please test this app on "running or not"? The test is OK, if you are able to anser the notes on the piano:<br><br><a href="http://www.midimaster.de/temp/scoreF.apk" target="_blank">http://www.midimaster.de/temp/scoreF.apk</a> <br><br></td></tr></table><br>
<a name="2053943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> it runs on my sgs2 with 4.0.4 but i cant test it with the nexus 10 cause i left it at home :P <br><br></td></tr></table><br>
<a name="2053945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok... 4.0! This are good news. Thank you<br><br>But 4.1 and 4.2 have been much more problematic...  Perhaps somebody else can check this? This time it is very important for me... <br><br></td></tr></table><br>
<a name="2053965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems to run over here. No crash but no confirmation that there was a http request either. (4.1.1 btw) <br><br></td></tr></table><br>
<a name="2053964"></a>

<a name="2053967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok... 4.1! This are the next good news. Jim, did you tell me, you have the chance to test also on a 4.2 device?<br><br>There are 2 http request, when the app is starting, but it falls back to internal memory, when there is no connection. The old version already crashed here. <br><br>If you want to test a http request you can touch the settings symbol in the upper right corner and enter a teachers 6-digit code. On Return it checks, whether this account exists. <br><br></td></tr></table><br>
<a name="2053995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >c.k.</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Midimaster, I can run this on my Nexus 4 phone, which is running 4.2.2.<br><br>I entered a random teacher number and it tried to verify it. It gave me no error/warning/confirm after the test though, so I don't know if it was successful. <br><br></td></tr></table><br>
<a name="2054413"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> @C.K.<br><i>&gt;"... It looks like it restarts every time the orientation changes. I get the start-up screen each time, then it connects to the server each time..."</i><br><br>Did forget to ask you, which of your devices your are talking about.<br><br>Can somebody else please test a orientation change problem on his 4.xx device? contact me on info@... <br><br></td></tr></table><br>
<a name="2054422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >c.k.</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tested on Nexus 4 with 4.2.2. <br><br></td></tr></table><br>
<a name="2054631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> *** solved ****<br><br>see <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=4946#54630" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=4946#54630</a> <br><br></td></tr></table><br>
<a name="2054511"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
