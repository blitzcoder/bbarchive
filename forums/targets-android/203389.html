<!DOCTYPE html><html lang="en" ><head ><title >Flickering with OnRender()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Flickering with OnRender()</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Flickering with OnRender()</a><br><br>
<a name="2035426"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Because I'm writing a "not game"-app there is no need of rendering as often, 15 or 30 would be enough. But because of music timing I would like to use a high Update-Rate of 120 or 200. <br><br>In this content I noticed, that the OnRender is as often called as I select in in SetUpdateRate(). Even if nothing happenend on the screen, the OnRender() tries to fullfill the Rate and stresses the device. Not till the stress is to much, the OnRender()-rate will find an end, because of performance problems. So I tried to save some OnRender() by jumping them. <br><br>Now I noticed, that the device seems to have two buffers and if you try to jump some of the OnRender()-Events you will get a heavy flickering. This is not on the html5 target, but on only on the Android.<br><br>So I did some test and this code demonstrates, what is happening:<br><br>[monkeycode]Import mojo<br><br>Class MyExample Extends App<br>	Global Flicker%, CountUpdate%, CountRender%,X%<br>	<br>	Method OnCreate()<br>		SetUpdateRate 30<br>	End<br><br>	Method OnUpdate()<br>		If KeyHit(KEY_ESCAPE) Then Error ""<br>		Flicker=(Flicker+1) Mod 10<br>		CountUpdate=CountUpdate+1<br>	End<br>	<br>	Method OnRender()<br>		CountRender=CountRender+1<br>		If Flicker=0<br>			X=X+1<br>			Cls 0,0,255		<br>			SetColor 0,255,0<br>			DrawRect 5+X,5,230,310 <br>			SetColor 255,0,0<br>			DrawRect 25+3*X,25+3*X,130,110 <br>			SetColor 255,255,255<br>			Scale 2,2<br>			DrawText "Update=" +CountUpdate,10,130<br>			DrawText "Render=" +CountRender,10,150<br>		Endif<br>	End<br>End<br><br>Function Main()<br>	New MyExample<br>End[/monkeycode]<br><br>Now my questions:<br><br>Isn't it an error, that OnRender() is not event driven, but seems to come as often as OnUpdate()? Is'nt this very stressfull an energy wasting?<br><br><br>Isn't it an error, that each 2nd OnRender() jumps always back to the very first backscreen? You can see this in the sample: the flickering picture is the very first one. All the following OnRender() seems to change always only the second backbuffer.<br><br>With a little change in the test code you can see, that two following OnRender() will change both buffers:<br><br>[monkeycode]....<br>	Method OnRender()<br>		CountRender=CountRender+1<br>		If Flicker&lt;2<br>....<br>[/monkeycode]<br><br><br>Workaround: A odd number of jumping will cause not so much flickering:<br><br>[monkeycode]....<br>	Method OnUpdate()<br>		If KeyHit(KEY_ESCAPE) Then Error ""<br>		Flicker=(Flicker+1) Mod 9<br>		CountUpdate=CountUpdate+1<br>	End<br>	<br>	Method OnRender()<br>		CountRender=CountRender+1<br>		If Flicker=0<br>....<br>[/monkeycode]<br><br>Is there a better solution of Updating with 200fps and Rendering with 15fps? <br><br></td></tr></table><br>
<a name="2035405"></a>

<a name="2035406"></a>

<a name="2035429"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Music timing on Android, eh? Have fun with that one. :) <br><br></td></tr></table><br>
<a name="2035432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes! at the moment the  channel timing sound good enough. I had only short problems when the mobile is moved and the orientation changes. <br><br>so this is not my problem at the moment.... <br><br></td></tr></table><br>
<a name="2035445"></a>

<a name="2035446"></a>

<a name="2035447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you have to modify mojo.  For Java the function you need to change seems to be gxtkTimer.Run().  <br><br>I haven't tested it but that seems to be where the decision to render is made.<br><br>You can probably add some variable that it checks, and alter that on the fly to change behaviour. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
