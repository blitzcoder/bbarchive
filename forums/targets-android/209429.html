<!DOCTYPE html><html lang="en" ><head ><title >Help With Notifications-System</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Help With Notifications-System</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Help With Notifications-System</a><br><br>
<a name="2097886"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Guys,<br><br>I could need some help.<br><br>I'd like to have a function for sending a notification to the Android System. (Similar to WhatsApp Notifies, when something new Happend).<br>My App shall send at least once a day a notify. And best would be, if the User can enter the App by Clicking on the Notification.<br><br>I have never coded with native Code in Monkey. Does anybody here has some experiances for something like that?<br><br>Well within the AVD-Emulator i Found "ApiDemos/src/com/example/android/apis/app/IncomingMessage.java" this could fit my needs.<br>Just start the AVD -&gt; start a virtual device. goto Apps, start API Demos, search App, click on it then search for Notification and start IncomingMessage. Thats how it should look like in Monkey.<br><br>Thank You.<br><br>Stephan D <br><br></td></tr></table><br>
<a name="2099721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sygem</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something like <a href="https://github.com/sygem/notify" target="_blank">this</a>? <br><br></td></tr></table><br>
<a name="2099728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just watched your source, will test it tomorrow and tell you how it works. But as i think i understand the source, it could fit my needs :). Thank you very much for sharing anyway <br><br></td></tr></table><br>
<a name="2099734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sygem</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> No problem - it's still a work-in-progress module, not tested in a real app. Let me know how you get on, and if there are any improvements I could make to the API. <br><br></td></tr></table><br>
<a name="2099783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> On my Andoird Emulator the: Schedule part doesn't work :(<br>[Code]<br> Local localn:LocalNotification = New LocalNotification()<br>localn.SetBody("Take a Picture")            ' Will appear in the notification<br>localn.AddExtra("monkey rules", "data")     ' optional, can be retrieved later<br>localn.SetID(0)                             ' a unique id - use this to cancel notifications<br>localn.ScheduleAfter(60)                    ' number of seconds to wait before firing<br>[/Code]<br>Maybe it's just an emulator issue, my Akku is empty, so i can't test it on my Phone right now, maybe in 2 hours.<br>If it should Schedule my Console prints:<br>E/dalvikvm( 1212): Could not find class 'com.sygem.monkey.notify.AlarmNotification', referenced from method de.dukegames.noty.NativeLocalNotification.NativeScheduleAfter<br><br>This works perfectly.<br>[Code]<br>Local localn:LocalNotification = New LocalNotification()<br>localn.SetBody("App has been suspended")            ' Will appear in the notification<br>localn.Schedule()<br>[/Code]<br><br>Another question:<br>Is it possible to set a notification at a special time, like 8:00 am ?<br>if not, i will think of a function that will calculate the difference between OnSuspend to a specific time and schedule it.<br><br>Edit:<br>Just found:<br>#ANDROID_MANIFEST_APPLICATION+="&lt;receiver android:name=~qcom.sygem.monkey.notify.AlarmNotification~q /&gt;"<br> within your localnotification.monkey. shall i change it to my App name?<br><br>Edit2:<br>I've changed, but doesn't run either.<br>Maybe, if it helps here my whole App:<br>[Codebox]<br>Import mojo<br>Import brl<br>Import notify<br><br>#GLFW_WINDOW_TITLE="Notify"<br>#GLFW_WINDOW_WIDTH=1900<br>#GLFW_WINDOW_HEIGHT=1080<br>#GLFW_WINDOW_FULLSCREEN=False   <br> <br>#rem <br>	##### ANDROID PREPROCESSOR DIRECTIVES  ####<br>#end <br>#ANDROID_APP_LABEL="Notificator"<br>#ANDROID_APP_PACKAGE="de.dukegames.noty"<br>#ANDROID_SCREEN_ORIENTATION="portrait"					'"user", "portrait", "landscape"<br>#ANDROID_GAMEPAD_ENABLED=False<br>#ANDROID_VERSION_CODE="1"<br>#ANDROID_VERSION_NAME="0.1"<br>#ANDROID_KEY_STORE="../../release-key.keystore"<br>#ANDROID_KEY_ALIAS="release-key-alias"<br>#ANDROID_KEY_STORE_PASSWORD="password"<br>#ANDROID_KEY_ALIAS_PASSWORD="password"<br>#ANDROID_SIGN_APP=False<br>#ANDROID_NATIVE_GL_ENABLED=False<br><br>#OPENGL_GLES20_ENABLED=False<br>#OPENGL_GLES20_ENABLED=false<br>#OPENGL_DEPTH_BUFFER_ENABLED=false<br><br>#MOJO_AUTO_SUSPEND_ENABLED=True<br>#MOJO_IMAGE_FILTERING_ENABLED=false<br><br>#TEXT_FILES="*.txt|*.xml|*.json"<br>#IMAGE_FILES="*.png|*.jpg|*.gif|*.bmp"<br>#SOUND_FILES="*.wav|*.ogg|*.mp3|*.m4a"<br>#MUSIC_FILES="*.wav|*.ogg|*.mp3|*.m4a"<br>#BINARY_FILES="*.bin|*.dat|*.map"<br><br>'##########################   HAUPTFUNKTION DER APPLIKATION   #########################################<br>Function Main:Int()<br>	New Game				<br>End Function<br><br>Global DW:Float,DH:Float<br><br>Class Game Extends App<br><br>	Method OnCreate:Int()<br>		SetUpdateRate 60  <br>		<br>		Return True<br>	End Method<br>	<br>	Method OnUpdate:Int()<br>		DW = DeviceWidth()<br>		DH = DeviceHeight()<br><br>		If TouchHit()<br>                    'Works fine<br>			'Local localn:LocalNotification = New LocalNotification()<br>			'localn.SetBody("Touch hit")            ' Will appear in the notification<br>			'localn.Schedule()                           ' Will be raised immediately<br>		Endif <br>	End Method<br>	<br><br>	Method OnRender:Int()<br>		Cls <br>		DrawText "NOTIFY",50,50<br><br>		Return True<br>	End Method<br>	<br>	'When app will be suspended<br>	Method OnSuspend:Int()<br>            'Error on Console<br>            'E/dalvikvm( 1287): Could not find class 'com.sygem.monkey.notify.AlarmNotification', referenced from method de.dukegames.noty.NativeLocalNotification.NativeScheduleAfter<br>	    Local localn:LocalNotification = New LocalNotification()<br>	    localn.SetBody("Take a Picture")            ' Will appear in the notification<br>	    localn.AddExtra("monkey rules", "data")     ' optional, can be retrieved later<br>	    localn.SetID(0)                             ' a unique id - use this to cancel notifications<br>	    localn.ScheduleAfter(5)                    ' number of seconds to wait before firing<br>		<br>          'if its uncommented it works ....<br>		'Local localn:LocalNotification = New LocalNotification()<br>		'localn.SetBody("App has been suspended")            ' Will appear in the notification<br>		'localn.Schedule()<br>    	Return 0<br>	End<br>		<br>	Method OnClose:Int()<br>	    Local localn:LocalNotification = New LocalNotification()<br>	    localn.SetBody("On Close")            ' Will appear in the notification<br>	    localn.AddExtra("monkey rules", "data")     ' optional, can be retrieved later<br>	    localn.SetID(0)                             ' a unique id - use this to cancel notifications<br>	    localn.ScheduleAfter(5)                    ' number of seconds to wait before firing<br>	    EndApp()<br>	    Return 0<br>	End Method <br>End Class<br>[/Codebox] <br><br></td></tr></table><br>
<a name="2099781"></a>

<a name="2099782"></a>

<a name="2099780"></a>

<a name="2099790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sygem</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you make sure that the alarmreceiver.jar is copied into your project? It is in the localn/native/android directory, and should be copied to the 'libs' directory of your build.<br><br>You need to keep the manifest line intact - BroadcastReceivers in Java need to be public classes, which for Monkey means they need to be in a separate java file. I have packaged this up into a jar file to keep things simple (I'll add the source for the alarmreceiver at some point).<br><br>I tried your test, and it works on my phone.<br><br>I have thought about scheduling at a given time. Monkey doesn't have a Date class, so expressing the time would be a little tricky. <br><br></td></tr></table><br>
<a name="2099794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you, will try it.<br><br>At the moment I'm think of the Time Problem:<br>This will give you the parts of the Date/Time<br><br>Edit:<br>[Code]<br>Local date:=GetDate()<br>Print "Day: " + date[2]<br>Print "Month: " + date[1]<br>Print "Yeahr: " + date[0]<br>Print "Hour: " + date[3]<br>Print "Min: " + date[4]<br>Print "Sec: " + date[6]<br> <br>[/Code]<br><br>next would be, to write a function that can calculate the difference of two dates in Seconds. <br><br></td></tr></table><br>
<a name="2099792"></a>

<a name="2099793"></a>

<a name="2099791"></a>

<a name="2099795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> and yes, both, the alarmreciever and the android-support-v4.jar are in my libs folder, and it doesn't work <br><br></td></tr></table><br>
<a name="2099796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe, because i use Android Api3 Build ?<br>When i use Api 10 it says: BUILD FAILED<br>C:\Android\android-sdk\tools\ant\build.xml:541: Unable to resolve project target 'android-19'<br>I'll look up whats the reason, maybe i get it fixed <br><br></td></tr></table><br>
<a name="2099799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duke87</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok it now works fine here as well. I just had to update my SDK. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
