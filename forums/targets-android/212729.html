<!DOCTYPE html><html lang="en" ><head ><title >Android NDK target?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Android NDK target?</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Android NDK target?</a><br><br>
<a name="2125202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nullterm</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Working on a project that uses Box2D, and it flies at a steady 60fps on my iPhone and my older iPad. But on Android, it struggles to maintain 30fps on even my decent Galaxy S5.  And I'm guessing this is a Java related performance issue.  I have minimized realtime new's so I'm not hitting the allocator or garbage collector.<br><br>The next step would be investigating switching from the Android target (Java based) to a NDK one that uses C++.  I've seen some mention in the MX1 source code about it, but it doesn't appear in Ted.<br><br>So anyone know anything about the MX1 NDK target? Or is there a NDK target floating around that I could take up the baton on? <br><br></td></tr></table><br>
<a name="2125253"></a>

<a name="2125254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Simonsuuri</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> hello, i really dont know anything about Box2D nor NDK and so but.. <br><br>i had an issue with usin mojo2 with android... i made half year ago mojo2 version of my game, tought it would make it run better and look cooler since opengl stuff. <br>but game ran a lot slower with mojo2 than mojo1... <br>what i found out when searching was that apparently usin opengl stuff with Android (in monkeyX 1 ) has/had some sort problems...<br>i tought it might be your problem there? <br><br></td></tr></table><br>
<a name="2125255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> As far as I remember, Mark had this NDK target once within Monkey 1 but removed it again. I never got to working state actually. So I guess you have to live with that or move on to Monkey 2. <br><br></td></tr></table><br>
<a name="2125259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nullterm</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simonsuuri, I'm using direct OpenGL ES2 (well through Monkey). But I'll poke around and see if it's spending more CPU time in the update or render.  Don't care which it is, as long as there's something I can do about it.  I know Java can be slower on Android, but 5x slower seems like something is wrong.<br><br>Xaron, Monkey2 doesn't have iOS yet and sounds like Android isn't complete. From what I have tested that is working it does look great though.  So that's on the horizon, but not immediate. <br><br></td></tr></table><br>
<a name="2126403"></a>

<a name="2126404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nullterm</td><td align="right"><font class=tiny>(Posted 2017)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I built a C++ based build system that works with Android and OpenGL ES (and also builds Mac, Windows, soon iOS, Apple TV, it's SDL2 based). I tested it with a quick "crunch" test I did with Box2D and OpenGL and it easily runs faster than Monkey/Android/Java.  I can add 10x the number of b2Body's, do physics and rendering and my S5 doesn't even break a sweat at stays at 60fps.<br><br>Luckily the game was still half way built, in the prototype stage, so I'm gonna reimplement in C++ rather than trying to force Monkey/Java to do things it wasn't suited for. <br><br>Doh, was hoping to make it work in Monkey X, but the native C++ route has far less speed bumps, and Monkey X (1) seems like a dwindling option with development shifted to Monkey 2. <br><br></td></tr></table><br>
<a name="2126836"></a>

<a name="2126837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Boulderdash</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im test building on an iPhone and also Android the Android is 15 FPS while the iPhone blazes along at full frame rate. Im using writepixels to an image for 2D unfortunately the Android is not happening ? Has anyone got any ideas how to speed it up ? <br><br></td></tr></table><br>
<a name="2126838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> What version of monkey are you using? <br><br></td></tr></table><br>
<a name="2126916"></a>

<a name="2126917"></a>

<a name="2126928"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nullterm</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't have any advice to offer, just experience. iOS boils down to native C++ code so it's going to run the most efficient. Android is translated into Java and run as JIT  byte code, which will not run as fast. Often it's enough as long as you using the GPU to do all your rendering.  But if you are drawing individual pixels every frame (or in my case physics and lots of drawing) then it's going to really struggle.  On Android with Monkey, it seems like moving data from CPU to GPU is a real performance bottleneck.  If you can, use sprites not pixels.  It is way faster to draw 16 16x16 sprites than say equivalent 4096 pixels separately.  Or even 256 individual pixels. <br><br></td></tr></table><br>
<a name="2126924"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you optimising your Monkey code a bit to help Java out - e.g. object pooling, 1D arrays etc.?  Java is obviously slow compared to C++, but it doesn't have to be terrible.  I'd be surprised if moving data from CPU to GPU is intrinsically slower, unless Mark has implemented it some way that could be improved.<br><br>My apologies if I'm teaching Grandma how to suck eggs here! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
