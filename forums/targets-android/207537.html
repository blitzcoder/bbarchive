<!DOCTYPE html><html lang="en" ><head ><title >IAP Headaches.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >IAP Headaches.</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >IAP Headaches.</a><br><br>
<a name="2072784"></a>

<a name="2072789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >caffeinekid</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got IAP working on OUYA previously with two games but trying to do a vanilla Android games with it now and it doesn't seem to want to play. Are there any big differences in the code I have to make? It looks like it's not even getting hold of the store for some reason.<br><br>E/Volley  (22361): [2759] BasicNetwork.performRequest: Unexpected response code 500 for <a href="https://android.clients.google.com/fdfe/bulkDetails" target="_blank">https://android.clients.google.com/fdfe/bulkDetails</a><br>I/[Monkey](26825): OpenStoreComplete, result=-1<br>E/AndroidRuntime(26825): FATAL EXCEPTION: main<br><br>E/AndroidRuntime(13901): FATAL EXCEPTION: main<br>E/AndroidRuntime(13901): Process: com.tcksoft.stoplightpuzzle, PID: 13901<br>E/AndroidRuntime(13901): java.lang.RuntimeException: Store unavailable<br><br>It's probably a rookie error and someone will make me look silly for overlooking something.<br><br>I'm including all the stuff I think you need:-<br><br>Import mojo<br>Import brl.json<br>Import brl.filestream<br>Import brl.monkeystore<br><br>I've copied all the needed methods from the iaptest banana.<br><br>Thanks in advance.<br><br>I know that OUYA needs a keyfile to reach the store correctly, but Android doesn't? <br><br></td></tr></table><br>
<a name="2072785"></a>

<a name="2072788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >caffeinekid</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone? I have an almost finished game here but can't even test it now because I've broken it by adding the store etc.<br><br>I have all the various sdks installed - ant, android, etc.<br><br>It just seems to be dying at the opening of the store.<br><br>I've uploaded the apk to google play, as recommended too.<br><br>I'm lost... <br><br></td></tr></table><br>
<a name="2072823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm... maybe that's too obvious but the Manifest has at least these lines?<br><br>&lt;uses-permission android:name="android.permission.INTERNET" /&gt;<br>&lt;uses-permission android:name="com.android.vending.BILLING" /&gt; <br><br></td></tr></table><br>
<a name="2072824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >caffeinekid</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers for the reply I thought I was just yelling at myself. lol.<br><br>The manifest seems fine - to my knowledge. It has the right permissions - as they are automatically added(?) by Monkey when you import the code to your project for IAP/billing. I've used it for OUYA without problems but Google Play/vanilla Android is not playing ball and just crashing out when it tries to access the store. <br><br>The game runs for a second or two but then just goes boom. :( <br><br></td></tr></table><br>
<a name="2072825"></a>

<a name="2072826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah well it goes boom? In that case could you just post the log please?<br><br>Edit: Uh dear you did... sorry. Let's see... <br><br></td></tr></table><br>
<a name="2072827"></a>

<a name="2072828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you setup your google account as a test account?<br><br><a href="http://developer.android.com/google/play/billing/billing_admin.html#billing-testing-setup" target="_blank">http://developer.android.com/google/play/billing/billing_admin.html#billing-testing-setup</a><br><br>Edit: Oh and it MAY NOT be the same account as your merchant account as you can't buy stuff from yourself (unfortunately) <br><br></td></tr></table><br>
<a name="2072831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >caffeinekid</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does IAP on Android need licensing too to work?<br><br>I've read that link and it just goes on about license keys etc.<br><br>As far as I'm aware Monkey doesn't support Google Play licensing - is that the problem?<br><br>I tried putting my tablet in airplane mode out of interest to see if it ran and it still crashes on trying to open the store even though you would think it would realise there was no connection and just continue without being able to access the store. <br><br></td></tr></table><br>
<a name="2072837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >caffeinekid</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Surely there must be someone here who has used IAP in Google Play and can offer advice, or who has come across this problem? :/ <br><br></td></tr></table><br>
<a name="2087527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> caffeinekid did you ever figure out what was wrong??<br><br>I had iap working just fine on android and purchased several test items and then all of a sudden it stopped working and I am getting the same error you were. <br><br></td></tr></table><br>
<a name="2088579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >caffeinekid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I gave it up as a bad job :( <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
