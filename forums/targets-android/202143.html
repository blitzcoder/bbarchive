<!DOCTYPE html><html lang="en" ><head ><title >Int vs Float</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Int vs Float</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Int vs Float</a><br><br>
<a name="2020609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grover</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is probably not Android specific, but I was wondering if anyone had a good understanding of the underlying benefits between the two on a Android platform. Many of the hardware architectures do perform many times better using Int. However, does the vm take care of this for us? Is there a cost/benefit?<br><br>Im going to run some trials myself over the next few days just to determine whether the impacts are large/small, but I'd be keen to hear from peoples own experience on this issue.<br><br>I think (based on previous gamedev GBA/DS/Nokia/SE exp) that there is probably good value in a simple Int math lib or similar to help increase general Android performance (Id expect you would get IOS boost too). FPU's generally are power consuming, and slow on most embedded systems (the GBA and DS didnt even have one!). <br><br>Thanks,<br>Dave <br><br></td></tr></table><br>
<a name="2020613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are no such differences on modern hardware (like smartphones have) anymore. <br><br></td></tr></table><br>
<a name="2020614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grover</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really? Even PC's are still around 40x faster in Int math than float - unless doing vectorized (ie 4 lots of 32bit/64bit float - then SIMD is going to improve things), which is only around 10x faster.<br><br>Id be very surprised if the ARM chips had large and good FPU's onboard with the high clocks they are running. As I said even recent NDS's (game handhelds) dont have _any_ FPU's at all.<br><br>Hence why I suspected there would be benefit in this. Will do some digging.<br>&lt;edit&gt;I found this: <a href="http://pandorawiki.org/Floating_Point_Optimization" target="_blank">http://pandorawiki.org/Floating_Point_Optimization</a><br>Which seems to confirm my suspicions (many costs involved). Will run some tests, I have an old GBA ARM Int math lib here I'll try out. See if there is much benefit. <br><br>Cheers,<br>Dave <br><br></td></tr></table><br>
<a name="2020631"></a>

<a name="2020632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> From my experience there have been 3 basic generations of ARM chips. No FPU, FPU as copro and FPU integrated.<br><br>Older Apple hardware prior to iPhone3GS falls into middle category and will die badly if you compile float code in thumb mode but perform excellently in ARM mode where copro calls don't get hit with huge cycle penalty. <br><br>Cheaper android kit with specs below the 600mHz would I guess fall into first category, emulated FP and no integer divide instruction.<br><br>Float usage on GPU is even muddier, where geometry buffers will work faster using fixed point formats and others prefer float. Android itself has introduced known issues with floating point buffers so there is no clear rules here either.<br><br>For this reason I always assumed it would be best Monkey support the Canvas interface for graphics where it's implementation could be expected to be tuned to perform on whatever that native implementation of the GPU. Fat chance. Sadly canvas was only GPU enabled in recent Android releases and only in certain situations.<br><br><div class="quote"> Even PC's are still around 40x faster in Int math than float <br></div><br><br>That sounds like an extreme corner case to me. <br><br></td></tr></table><br>
<a name="2020926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grover</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Having done games and sims for the last twenty years from fixed platforms to PC there are _alot_ of things people assume without actually testing. Another classic is the use of the stl libs - these are _very_ performance detrimental, but they are convenient. And PC's are still slower on the Float side vs Int for general purpose use (GPU is quite diff story, but hard to use). Its much like the above ARM, where 20cycles for a float operation setup can be a pretty drastic cost when switching/changing int to float math. PS3, Xbox and others all suffer similar conditions. Most development works in "streaming data blocks" to reduce context switching and so on - which helps the FPU's as a whole.<br><br>From previous games and simulators written on PC, it has always been the case to have our own "Float &lt;-&gt; Int" conversion at the very least (this can cost pipeline flushes, and potentially hundreds of cycles). Also, previous performance of changing math critical portions of an app to fixed _did_ result in a 40x increase in performance (this was using VTune for profiling). That was about 2 yrs ago. And I have doubts compilers and CPU's have dramatically improved their internals. <br><br>What is the biggest change, and most likely to push away all this sort of discussion, is the implementation of JIT hardware modules in the CPU's. The above mentioned ARM has one for Java built in and so this chip is far more favorable to just running pure bytecode than even assembled code. This is where MS is going with its .NET series - Intel hw running JIT .NET bytecode.. this will push everyone up a level of api :) about time...<br><br>I currently have some test apps almost complete. So I will know the answers to the questions soon anyway. I'll do a secondary CPP test as well to see where that currently stands on modern hardware. My suspicion for targeting baseline (low performing phones) it will improve perf substantially - on the more modern ARM chips it probably will be limited.<br><br>The test app is going to be float/math intensive - Box2DLite. So there should be good data from it. <br><br>Cheers,<br>Dave <br><br></td></tr></table><br>
<a name="2020930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll take an int version of Box2D, yes please. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
