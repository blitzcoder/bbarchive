<!DOCTYPE html><html lang="en" ><head ><title >Performance with Box2D</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Performance with Box2D</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Performance with Box2D</a><br><br>
<a name="2034256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FelipeA</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I was wondering if anyone has made a game for android using  monkey-box2D. I've been doing some tests on a Samsung Galaxy S2 and it runs very choppy. Sometimes the FPS goes from 60 to 20 and then it stays at 25-35 for a while.<br><br>I am running this test which runs good on my pc(html5, flash and glfw): <a href="http://shin.cl/b2d/" target="_blank">http://shin.cl/b2d/</a> , but on android it just runs very very slow.<br><br>What have your performance tests been like with box2d on android, and what do you recomend to improve speed.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="2034257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to run a profile to see where the time is going. I don't see 30fps as "very slow" to be honest but equally your example doesn't look much of a physics processing strain for a reasonably powerful device.<br><br>Profiling your HTML5 build did point out something a little odd: 13% of the processing time was going to SetPosition. That seems to come from this bit of your update:<br><br>var t_=bb_main_world.f_entities.m_ObjectEnumerator();<br>while(t_.m_HasNext()){<br>    var t_e=t_.m_NextObject();<br>    var t_pos=t_e.f_body.m_GetPosition();<br>    t_pos.f_x=t_pos.f_x-this.f_offset.f_x;<br>    t_pos.f_y=t_pos.f_y-this.f_offset.f_y;<br>    t_e.f_body.m_SetPosition(t_pos);<br>}<br><br>Are you repositioning every object in the world on every update? <br><br></td></tr></table><br>
<a name="2034283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FelipeA</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I am, i am doing this to give the camera effect. If there is a better way for this could you point me how or where to find a reference?? This is my first time working with box2D.<br>Thanks <br><br></td></tr></table><br>
<a name="2034285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just have a camera object and offset the rendering rather than moving objects in the world. Every time you move an object in box2d it has to recalculate a bunch of stuff to do with collisions etc. <br><br></td></tr></table><br>
<a name="2034286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FelipeA</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ooh, yeah that sounds a lot smarter, I'm actually not handling the render, I am using CopperCircle's box2dframework so I'll have to "hack it". I'll see  how it works after doing all this.<br>Thanks <br><br></td></tr></table><br>
<a name="2034289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can probably just use mojo's translate matrix function to shift everything to centre on the player before you call the render loop. <br><br></td></tr></table><br>
<a name="2034329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FelipeA</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks  a lot, that was really a preformance boost. Now the demo runs at 60fps on all targets.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="2034872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi do you have an example of the translate matrix scrolling? did you get it to work with my framework? <br><br></td></tr></table><br>
<a name="2034910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >golomp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> +1 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
