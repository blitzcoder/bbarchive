<!DOCTYPE html><html lang="en" ><head ><title >Async Image Loading - Speed Test</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Async Image Loading - Speed Test</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=502" >Android</a>/<a href="#bottom" >Async Image Loading - Speed Test</a><br><br>
<a name="2043974"></a>

<a name="2043975"></a>

<a name="2043976"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rus</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya guys! I've been trying to implement LoadImageAsync for the different targets. I've been getting good results with GLFW, and reasonable results with iOS. But Android doesn't seem to be loading asynchronously at all. <br><br>Here's the code that I'm using:<br><br>[monkeycode]<br>Strict<br>Import mojo<br><br>Class Game Extends App<br><br>	Global streamedImage:StreamedImage<br><br>	Method OnCreate:Int()<br>		SetUpdateRate(60)<br>		streamedImage = New StreamedImage( "large_image.jpg", 0, 0 )<br>		Return 0<br>	End<br><br>	Method OnUpdate:Int()<br>		UpdateAsyncEvents()<br>		Return 0<br>	End<br><br>	Method OnRender:Int()<br>		Cls<br><br>		If streamedImage.image &lt;&gt; Null<br>			DrawImage( streamedImage.image, 0, 0 )	<br>		EndIf			<br><br>		DrawText( "ms: " + Millisecs(), 0, 0 )<br>		Return 0<br>	End<br><br>End<br><br>Function Main:Int()<br>	New Game<br>	Return 0<br>End<br><br><br>Class StreamedImage Implements IOnLoadImageComplete<br><br>	Field image:Image<br>	<br>	Method New( path:String, x:Int, y:Int )<br>		LoadImageAsync( path, 1, Image.DefaultFlags, Self )	<br>	End<br>	<br>	Method OnLoadImageComplete:Void( image:Image,path:String,source:IAsyncEventSource )<br>		Self.image = image<br>	End<br><br>End<br>[/monkeycode]<br><br>The ms text is a Millisecs() print out that I use to see if the Update and Render calls are happening while the loading is going on in the background. For GLFW it's smooth all the time, for iOS it's great unless you try to load something huge! But Android stops dead to load then starts again once loading is complete.<br><br>Replace large_image.jpg with a large image file. Mine is a 2048x2048 6MB jpg.<br><br>If I could get descriptions of how the code works from anyone building for android, as well as information about your devices, that would be great. Also, if anyone would like to optimize or correct my code, please do! I'd appreciate it. There's very little discussion on this on the forums and it would be great to get more examples of how people are using this. <br><br></td></tr></table><br>
<a name="2043973"></a>

<a name="2044013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried using custom AsyncLoaders for buffers with MonkeyV66 and found a lot of bugs.<br><br>But your problem sounds like Android is not threading the LoadSurface() call properly. I can try to test this later. <br><br></td></tr></table><br>
<a name="2044060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rus</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> @AdamRedwoods:<br>Thanks for the feedback. <br><br>I'm looking at integrating Async loading with a larger framework that I use for my games. I guess it still doesn't work as expected across all platforms. <br><br>I wonder if the Android loading is a symptom of a bug in the Monkey generated code or an attribute of Android.<br><br>Any test results would be great! Cheers! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
