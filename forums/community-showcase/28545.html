<!DOCTYPE html><html lang="en" ><head ><title >TREEmagik news</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TREEmagik news</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >TREEmagik news</a><br><br>
<a name="300458"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://www.aliencodec.com/products/treemagik_plus/tmplus_trans.gif"><br><br>TREEmagik and TREEmagik Exotic is now known as TREEmagik PLUS. I've combinded the two packages into a single disturbution set for the same low price of the original TREEmagik.<br><br>ALl previous users of treemagik and everyone purchasing treemagik from here out will be entitled to TREEmagik PRO when it is released later next year - at no additional charge..<br><br>TRREmagik PLUS <a href="http://www.aliencodec.com" target="_blank">http://www.aliencodec.com</a> <br><br></td></tr></table><br>
<a name="300466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yehhooooo!<br><br>Thanks <br><br>IPete2. <br><br></td></tr></table><br>
<a name="300486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sigi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Woooow, Thank you.<br>Great news. <br><br></td></tr></table><br>
<a name="300511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skitchy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gonna have to get this when it comes out :) <br><br></td></tr></table><br>
<a name="300514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> woohoo, thanks :) <br><br></td></tr></table><br>
<a name="300842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sabata,<br><br>Tried the demo, Loved it! Extremely User Friendly. Just a tad too pricy for me. I would be more inclined to purchase  models made with this tool. <br><br></td></tr></table><br>
<a name="301468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sabata, <br><br>Is there any chance that other payment methods for the product could be set up such as Share-It?<br><br>Thanks.<br><br>Regards,<br>Daz. <br><br></td></tr></table><br>
<a name="301680"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Daz, I'm looking into starting up a new ShareIT account as we speak, i'll post more later.. <br><br></td></tr></table><br>
<a name="301701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvisibleKid</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> ShareIt would be great i'll definately by it then...... <br><br></td></tr></table><br>
<a name="301739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really despise SHAREit, I feel they are a piss-poor ran company.. they offer little help (when its needed the most). I've been tring to get my billing data changed with them for 3 months now... No luck yet.<br><br>Ive recently emailed a suppervisor there so as soon as this is straightened out i'll post note of it.. Sorry for the delay.<br><br>PS anyone know of alternative services besides shareit or paypal?<br><br><br>thanks. <br><br></td></tr></table><br>
<a name="301754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers Sabata for the info.  Keep me updated and as soon has you find an alternative. <br><br>I have bought some software in the past through regsoft.  Have a look at <a href="http://www.regsoft.com/index.shtml" target="_blank">http://www.regsoft.com/index.shtml</a><br><br>How good they are from a sellers point of view I am not sure - but you could always give these a try. <br><br>Hope that helps.<br><br>Daz. <br><br></td></tr></table><br>
<a name="301775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.bmtmicro.com" target="_blank">BMTmicro</a> are reputable.  I use them. <br><br></td></tr></table><br>
<a name="301821"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, checking into these links now... <br><br></td></tr></table><br>
<a name="301871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok got setup with RegSoft, the product should become active with them within 24hrs. I've linked my website but it won't connect until the product becomes active via RegSoft.<br><br>Working on a 3rd alternate plan with BMTMicro atm. <br><br></td></tr></table><br>
<a name="301873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent news Sabata.  I will check your site tomorrow morning and place my order then.<br><br>Thanks for all the help. <br><br></td></tr></table><br>
<a name="301882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, PayPal was the reason i didn't buy treemagik :) <br><br></td></tr></table><br>
<a name="301895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> BMTmicro is a nice e-purchase option... I have successfully setup an account with these guys and been approved. They are fast, they have already activated the product, whoa took ages with paypal. Added the link to the Treemagik order form (secure). Thanks for the link MasterBeaker.<br><br><a href="http://www.bmtmicro.com/BMTCatalog/win/treemagikplus.html" target="_blank">http://www.bmtmicro.com/BMTCatalog/win/treemagikplus.html</a> <br><br></td></tr></table><br>
<a name="302584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> $24.99 USD / 24.3306 EUR / 15.5924 GBP <br></div><br><br>Are you sure you that the € and £ prices are accurate enough? ;P <br><br></td></tr></table><br>
<a name="304824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you have any interest in writing an exporter for .csm prefabs?  I could link you on the CShop site if your program could instantly export a prefab for CShop users. <br><br></td></tr></table><br>
<a name="304828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can sure give it a try, got a format/sdk sheet for your format avialable? <br><br></td></tr></table><br>
<a name="305499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's code for a 3ds&gt;CSM converter.  If you need any more help, ask.<br><br><pre class=code>
If Not Windowed3D() RuntimeError "You must change your desktop depth to 16-bit color to run this program."

Include "progs\functions\appendbyte.bb"
Include "progs\functions\appendint.bb"
Include "progs\functions\appendfloat.bb"
Include "progs\functions\appendshort.bb"
Include "progs\functions\appendstring.bb"
Include "progs\functions\pokestring.bb"
Include "light_progs\updatenormals.bb"

Const FLAG_SELECTED=0
Const FLAG_POLYGON=1
Const FLAG_NOSCALE=2
Const FLAG_AUTOMAP=3
Const FLAG_LIGHTMAPS=4
Const FLAG_VERTEXLIGHTS=5
Const FLAG_CASTLIGHTMAPSHADOWS=6
Const FLAG_CASTVERTEXSHADOWS=7

AppTitle "Cartography Shop model converter"
;file$=CommandLine()
;file=Remove(file,Chr(34))
;If file="" file$=RequestFile_("",CurrentDir(),"X or 3DS Model|*.*",0,0,0)
;If file="" End

patternposition=4

.loop

file$=getopenfile("Make prefab","","3D Studio file (*.3ds)|*.3ds|Microsoft DirectX Model (*.x)|*.x|Cartography Shop 3 map (*.csm)|*.csm|Blitz3D Model (*.b3d)|*.b3d|All files|*.*",patternposition)
If file="" End
patternposition=SelectedPattern()
If Lower(FileExtension(file))="csm"
	convertcsm file
	Else
	convertmesh file
	EndIf
If proceed("Convert more files?") Goto loop

End

Graphics3D 400,300,16,2

progpath$=CurrentDir()

ChangeDir progpath+"prefabs"

d=ReadDir(CurrentDir())
Repeat
	file$=NextFile(d)
	DebugLog file
	Select FileType(file)
		Case 0
			Exit
		Case 1
		Case 2
			If file&lt;&gt;"." And file&lt;&gt;".."
				d2=ReadDir(file)
				Repeat
					file2$=NextFile(d2)
					If file2="" Exit
					DebugLog (file+"\"+file2)
					Select FileType(file+"\"+file2)
						Case 0
							Exit
						Case 1
							ext$=Lower(FileExtension(file2))
							If ext="3ds" Or ext="x" Or ext="b3d"
								convertmesh file+"\"+file2
								EndIf
						Case 2
						End Select
					Forever
				CloseDir d2
				EndIf
		End Select
	Forever
CloseDir d
End

ChangeDir progpath+"meshes"
d2=ReadDir(CurrentDir())
If d2
	Repeat
		file2$=NextFile(d2)
		If file2="" Exit
		DebugLog (file2)
		Select FileType(file2)
			Case 0
				Exit
			Case 1
				ext$=Lower(FileExtension(file2))
				If ext="3ds" Or ext="x" Or ext="b3d"
					convertmesh ".\"+file2
					EndIf
			Case 2
			End Select
		Forever
	CloseDir d2
	EndIf

Function convertcsm(file$)

f=ReadFile(file)
If Not f
	notify "Failed to load "+Chr(34)+file+Chr(34)+"."
	Return False
	EndIf
	
groupbank=CreateBank()
lightmapbank=CreateBank()
meshbank=CreateBank()
entitybank=CreateBank()

version=ReadInt(f)
If version=2 Or version=4
	notify Chr(34)+file+Chr(34)+" is not a Cartography Shop 3 map."
	Return False
	EndIf

SeekFile f,0

While Not Eof(f)

	tag$=""
	For n=0 To 3
		tag=tag+Chr(ReadByte(f))
		Next
	size=ReadInt(f)
	DebugLog "	Loading "+tag+" - "+size+" bytes..."
	endposition=size+FilePos(f)

	Select tag

		Case "LMAP"
			width=ReadInt(f)
			height=ReadInt(f)
			;t=CreateTexture(width,height)
			;TextureCoords t,1
			;SetBuffer TextureBuffer(t)
			;LockBuffer TextureBuffer(t)
			appendInt lightmapbank,width
			appendint lightmapbank,height
			For x#=0 To width-1
				For y#=0 To height-1
					hue=ReadInt(f)
					;appendbyte lightmapbank,Red(hue)
					;appendbyte lightmapbank,Green(hue)
					;appendbyte lightmapbank,Blue(hue)
					appendint lightmapbank,hue
					Next
				Next
			;UnlockBuffer TextureBuffer(t)
			;SetBuffer BackBuffer()
			clm=clm+1
			;SaveBuffer TextureBuffer(t),"maps\"+FileName(file,False)+"_LM"+clm+".bmp"
			
			;dynamicfile$="textures\specular\"+FileName(file,False)+clm+".bmp"
			;If FileType(dynamicfile$)=1
			;	t2=LoadTexture(dynamicfile$)
			;	TextureCoords t2,1
			;	TextureBlend t2,3
			;	EndIf
						
			;appendint lmapbank,t
;			t2=CreateTexture(2048,2048)
;			TextureBlend t2,2
			;If FileType(dynamicfile$)=1
			;	t2=LoadTexture(dynamicfile$)
			;	TextureBlend t2,0
			;	TextureCoords t2,1
			;	sh.shader=New shader
			;	sh\texture=t
			;	sh\parameter[2]=t2
			;	sh\class=SHADER_DYNAMICLIGHT
			;	sh\image2=LoadImage("maps\"+FileName(file,False)+"_LM"+clm+".bmp")
			;	EndIf
			;appendint addlmapbank,t2
			;t2=0
			
		Case "GRUP"
			group=ReadInt(f)
			r=ReadInt(f)
			g=ReadInt(f)
			b=ReadInt(f)
			cgr=cgr+1
			
		Case "BRUS"
			flags=ReadInt(f)
			hue=ReadInt(f)
			group=ReadInt(f)
			Properties$=ReadStringN(f)
			surfcount=ReadInt(f)
			
			appendint meshbank,(2^3+2^4+2^6+2^7)
			appendint meshbank,group
			appendstring meshbank,Properties$
			appendint meshbank,0
			appendint meshbank,0
			appendint meshbank,0
			appendfloat meshbank,0
			appendfloat meshbank,0
			appendfloat meshbank,0
			appendint meshbank,surfcount
			
			;mesh=CreateMesh(map)
			;NameEntity mesh,Properties
			;appendint entitybank,mesh

			For s=1 To surfcount
				nx#=ReadFloat(f)
				ny#=ReadFloat(f)
				nz#=ReadFloat(f)
				d#=ReadFloat(f)
				materialname$=readstringn(f)
				lightmap=ReadInt(f)
				uoffset#=ReadFloat(f)
				voffset#=ReadFloat(f)
				uscale#=ReadFloat(f)
				vscale#=ReadFloat(f)
				angle#=ReadFloat(f)
				vertcount=ReadInt(f)
				
				appendint meshbank,0
				appendstring meshbank,materialname
				appendint meshbank,lightmap
				appendfloat meshbank,0
				appendfloat meshbank,0
				appendfloat meshbank,1
				appendfloat meshbank,1
				appendfloat meshbank,0
				appendint meshbank,vertcount
				appendint meshbank,vertcount-2
				appendint meshbank,0
				
				;skipface=False
				;If Lower(FileName(materialname,False))="caulk" skipface=True
				;If Not skipface
				;	surf=CreateSurface(mesh)
				;	b=retrievematerial("textures\"+materialname)
				;	If lightmap
				;		t=PeekInt(lmapbank,(lightmap-1)*4)
				;		BrushTexture b,t,0,LAYER_LIGHTMAP
				;		EndIf
				;	PaintSurface surf,b
				;	If lightmap reloadmaterial b;Get rid of lightmap texture
				;	EndIf
				DebugLog vertcount
				For v=0 To vertcount-1
					x#=ReadFloat(f)
					y#=ReadFloat(f)
					z#=ReadFloat(f)
					nx#=ReadFloat(f)
					ny#=ReadFloat(f)
					nz#=ReadFloat(f)
					If nx&lt;&gt;0 RuntimeError nx
					u0#=ReadFloat(f)
					v0#=ReadFloat(f)
					u1#=ReadFloat(f)
					v1#=ReadFloat(f)
					
					appendfloat meshbank,x
					appendfloat meshbank,y
					appendfloat meshbank,z
					appendfloat meshbank,nx
					appendfloat meshbank,ny
					appendfloat meshbank,nz
					appendint meshbank,128
					appendint meshbank,128
					appendint meshbank,128
					appendfloat meshbank,u0
					appendfloat meshbank,v0
					appendfloat meshbank,0
					appendfloat meshbank,u1
					appendfloat meshbank,v1
					appendfloat meshbank,0
					
					;If Not skipface
					;	AddVertex surf,x,y,z,u0,v0
					;	VertexColor surf,v,255,255,255		
					;	VertexNormal surf,v,nx,ny,nz					
					;	VertexTexCoords surf,v,u1,v1,0,1
					;	If v&gt;1 AddTriangle surf,v,v-1,0
					;	EndIf
					
					Next
				
				;triscount=ReadInt(f)
				;DebugLog triscount

				For v=2 To vertcount-1
					appendint meshbank,v
					appendint meshbank,0
					appendint meshbank,v-1
					Next
				
				;appendint meshbank,0;no lines
			
				Next

			cmh=cmh+1
			;UpdateNormals_ mesh
		
		Case "ENTY"
			flags=ReadInt(f)
			x#=ReadFloat(f)
			y#=ReadFloat(f)
			z#=ReadFloat(f)
			Properties$=ReadStringN(f)
			group=ReadInt(f)
			r=ReadInt(f)
			g=ReadInt(f)
			b=ReadInt(f)
			width=ReadInt(f)
			heigth=ReadInt(f)
			
			cen=cen+1
			
			appendint entitybank,0
			appendint entitybank,0
			appendstring entitybank,Properties$
			appendfloat entitybank,x
			appendfloat entitybank,y
			appendfloat entitybank,z
			
			;entity=CreateMesh(map)
			;PositionEntity entity,x,y,z
			;NameEntity entity,Properties
			;appendint entitybank,entity

		Case "MESH"
			flags=ReadInt(f)
			hue=ReadInt(f)
			group=ReadInt(f)
			Properties$=ReadStringN(f)
			;If getproperty(Properties$,"classname")=""
			;	Properties$=Properties$+Chr(10)+Chr(34)+"classname"+Chr(34)+"="+Chr(34)+"staticmesh"+Chr(34)
			;	EndIf
			materialname$=ReadStringN(f)
			vertcount=ReadInt(f)
			
			appendint meshbank,(2^5+2^6+2^7)
			appendint meshbank,group
			appendstring meshbank,Properties$
			appendint meshbank,0
			appendint meshbank,0
			appendint meshbank,0
			appendfloat meshbank,0
			appendfloat meshbank,0
			appendfloat meshbank,0
			appendint meshbank,1; surface

			appendint meshbank,0
			appendstring meshbank,materialname
			appendint meshbank,0
			appendfloat meshbank,0
			appendfloat meshbank,0
			appendfloat meshbank,1
			appendfloat meshbank,1
			appendfloat meshbank,0
			appendint meshbank,vertcount
			pos=BankSize(meshbank)
			appendint meshbank,0
			appendint meshbank,0
						
			;mesh=CreateMesh(map)
			;NameEntity mesh,Properties
			;surf=CreateSurface(mesh)
			;appendint entitybank,mesh

			;b=retrievematerial("textures\"+materialname)
			;BrushShininess b,1
			;PaintSurface surf,b
			
			For v=0 To vertcount-1
				x#=ReadFloat(f)
				y#=ReadFloat(f)
				z#=ReadFloat(f)
				nx#=ReadFloat(f)
				ny#=ReadFloat(f)
				nz#=ReadFloat(f)
				u0#=ReadFloat(f)
				v0#=ReadFloat(f)
				u1#=ReadFloat(f)
				v1#=ReadFloat(f)
				hue=ReadInt(f)
				;AddVertex surf,x,y,z,u0,-v0
				;VertexColor surf,v,Red(hue),Green(hue),Blue(hue)				
				;VertexNormal surf,v,nx,ny,nz
				
				appendfloat meshbank,x
				appendfloat meshbank,y
				appendfloat meshbank,z
				appendfloat meshbank,nx
				appendfloat meshbank,ny
				appendfloat meshbank,nz
				appendint meshbank,128
				appendint meshbank,128
				appendint meshbank,128
				appendfloat meshbank,u0
				appendfloat meshbank,v0
				appendfloat meshbank,0
				appendfloat meshbank,u1
				appendfloat meshbank,v1
				appendfloat meshbank,0				
				
				Next

			triscount=ReadInt(f)
			PokeInt meshbank,pos,triscount
			
			For t=0 To triscount-1
				a=ReadInt(f)
				b=ReadInt(f)
				c=ReadInt(f)
					
				appendint meshbank,b
				appendint meshbank,a
				appendint meshbank,c
					
				Next
				
			;UpdateNormals_ mesh
			cmh=cmh+1

		Default
			DebugLog "	Unknown chunk."
		
		End Select
	SeekFile f,endposition			
	Wend
CloseFile f

f=WriteFile(FileDir(file)+FileName(file,0)+"_v4.csm")

WriteInt f,4
WriteInt f,0
WriteInt f,0;clm
;For n=0 To BankSize(lightmapbank)-1
;	WriteByte f,PeekByte(lightmapbank,n)
;	Next
WriteInt f,cmh
For n=0 To BankSize(meshbank)-1
	WriteByte f,PeekByte(meshbank,n)
	Next
WriteInt f,cen
For n=0 To BankSize(entitybank)-1
	WriteByte f,PeekByte(entitybank,n)
	Next
WriteFloat f,0
WriteFloat f,500
WriteFloat f,-500
WriteFloat f,-45
WriteFloat f,0

CloseFile f
Return True
End Function

Function convertmesh(file$)

m=LoadAnimMesh(file)
If Not m
	notify "Failed to load "+Chr(34)+file+Chr(34)
	Return False
	EndIf

outfile$=FileDir(file)+FileName(file,0)+".csm"
f=WriteFile(outfile)
If Not f
	notify "Failed to write "+Chr(34)+outfile+Chr(34)
	Return False
	EndIf

WriteInt f,4;version
WriteInt f,0;groups
WriteInt f,0;lightmaps
WriteInt f,1;meshes
WriteInt f,2+2^FLAG_CASTLIGHTMAPSHADOWS+2^FLAG_VERTEXLIGHTS+2^FLAG_CASTVERTEXSHADOWS;flags
WriteInt f,1;group
WriteByte f,0;properties
WriteInt f,255
WriteInt f,255
WriteInt f,255
WriteFloat f,0
WriteFloat f,0
WriteFloat f,0

pos=FilePos(f)
WriteInt f,0
sum=writemesh(m,f)

WriteInt f,0;entities

WriteFloat f,0;x
WriteFloat f,500;y
WriteFloat f,-500;z
WriteFloat f,-45;pitch
WriteFloat f,0;yaw

SeekFile f,pos
WriteInt f,sum


CloseFile f
Return True
End Function

Function writemesh(m,f)
UpdateNormals m
LightMesh m,220,220,220,1000000,1000,1000,1000
For s=1 To CountSurfaces(m)
	sum=sum+1
	surf=GetSurface(m,s)
	WriteInt f,0;flags
	WriteByte f,0;texture
	WriteInt f,0;lightmapindex
	WriteFloat f,0
	WriteFloat f,0
	WriteFloat f,1
	WriteFloat f,1
	WriteFloat f,0
	WriteInt f,CountVertices(surf)
	WriteInt f,CountTriangles(surf)
	WriteInt f,0;no lines
	For v=0 To CountVertices(surf)-1
		TFormPoint VertexX(surf,v),VertexY(surf,v),VertexZ(surf,v),m,0
		WriteFloat f,TFormedX()
		WriteFloat f,TFormedY()
		WriteFloat f,TFormedZ()
		TFormNormal VertexNX(surf,v),VertexNY(surf,v),VertexNZ(surf,v),m,0
		WriteFloat f,TFormedX()
		WriteFloat f,TFormedY()
		WriteFloat f,TFormedZ()
		r=VertexRed(surf,v)
		g=VertexGreen(surf,v)
		b=VertexBlue(surf,v)
		If r&lt;50 r=50
		If g&lt;50 g=50
		If b&lt;50 b=50
		WriteInt f,r
		WriteInt f,g
		WriteInt f,b
		WriteFloat f,VertexU(surf,v)
		WriteFloat f,-VertexV(surf,v)
		WriteFloat f,VertexW(surf,v)
		WriteFloat f,VertexU(surf,v,1)
		WriteFloat f,VertexV(surf,v,1)
		WriteFloat f,VertexW(surf,v,1)
		Next
	For t=0 To CountTriangles(surf)-1
		WriteInt f,TriangleVertex(surf,t,1)
		WriteInt f,TriangleVertex(surf,t,0)
		WriteInt f,TriangleVertex(surf,t,2)
		Next
	Next
For c=1 To CountChildren(m)
	sum=sum+writemesh(GetChild(m,c),f)
	Next
Return sum
End Function

Function ReadStringN$(f,maxlength=0)
Repeat
	ch=ReadByte(f)
	If ch=0 Return t$
	If maxlength
		If Len(t$)=maxlength Return t$+Chr(ch)
		EndIf
	t$=t$+Chr$(ch)
	Forever
End Function

Function GetOpenFile$(title$="",path$="",pattern$="All files|*.*",patternposition=0,multi=0)
Return RequestFile$(title$,path$,pattern$,patternposition,1,1)
End Function
</pre> <br><br></td></tr></table><br>
<a name="305634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, that should be more then enough help... all but for the "You must change your desktop depth to 16-bit color to run this program."<br><br>That could prove to be a problem requirement for an export option. <br><br></td></tr></table><br>
<a name="305646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SabataRH</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got it in, seems to be working although i've no real way of testing the exported file.<br><br>Halo, grab this and let me know if it loads in your cs4. Thanks.<br><br><a href="http://www.aliencodec.com/temp/test.csm" target="_blank">http://www.aliencodec.com/temp/test.csm</a> <br><br></td></tr></table><br>
<a name="305921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works.<br><br>I am emailing you to discuss this further. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
