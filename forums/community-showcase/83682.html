<!DOCTYPE html><html lang="en" ><head ><title >Basic Physics Engine.. WIP</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Basic Physics Engine.. WIP</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Basic Physics Engine.. WIP</a><br><br>
<a name="944042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>I made a little physics engine in bmax as a small first project and it turned out to be quite succesful!  It is still very much a WIP but I am improving on it daily.  Sorry there are no screenies ATM.  maybe I will post some tomorrow if I have time.  Please post how many boxes your comp can handle without significant slowdown.<br><br>controls:<br>arrows:move one of the starter verlets.. cant remember wich one<br>space bar: add a box!<br>mouse: click to grab the nearest verlet!<br><br>friction test: most recent linky<br><a href="http://naillproductions.synthasite.com/resources/NTG%20physics%20engine%20(2).zip" target="_blank">http://naillproductions.synthasite.com/resources/NTG%20physics%20engine%20(2).zip</a><br><br>edit: here is a screenie!<br><br><img src="http://naillproductions.synthasite.com/resources/Nathans_Junk/phys%20screenie.jpg"> <br><br></td></tr></table><br>
<a name="944087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> pretty good so far<br>I could add about 6 boxes with a 2.5ghz celeron <br><br></td></tr></table><br>
<a name="944116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> only 6 boxes?!? thats um.. a little lower than I expected...  I can get around 30 boxes <br><br></td></tr></table><br>
<a name="944126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Quite slow when spawning boxes here too. <br><br></td></tr></table><br>
<a name="944131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warpy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I started noticing some jitters fairly early too, at around 12 boxes. <br><br></td></tr></table><br>
<a name="944144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmm im not sure what the jitters are, I have noticed them too.  Maybe it is my inexperience with frame limiting in bmax?  I simply use graphics 800,600,0,60 and asume it does the rest.  Am I right to assume that or must I do something else?  If I am doing everything else right I might have accidentally made my engine unstable. :p<br><br>each box is 8 verlets and 14 constraints so that may also explain it. <br><br></td></tr></table><br>
<a name="944151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, you can't just set the graphics mode and hope it does the rest. You need a proper timing solution, and since you're doing verlet integration you'll need to have a fixed timestep. You probably already have a fixed timestep if you're doing nothing for timing, but you'll need to keep it when you integrate a timing solution. QuickSilva has a thread going on the subject in the BlitzMax beginners forum if you want to read up. <br><br></td></tr></table><br>
<a name="944168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks.. hmm for some reason I thought that blitz max somhow controled the frame rate with the flip command<br><br>Ill look into a timing solution.  Thanks Gabriel <br><br></td></tr></table><br>
<a name="944172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well if VSync is enabled, it kind of will, but it's dependant upon your code running fast enough for VSync to work. If your code isn't (always) done before the next VSync, it will jerk. Also, if someone happens to have VSync disabled, it's just not going to happen. <br><br></td></tr></table><br>
<a name="944192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I think I get it.  I have also rooted out the slowdown.  I had it on 25 iterations in the constraint loop! oops :p <br><br></td></tr></table><br>
<a name="944229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmm this is odd.. I have used waittimer for a quick way to mess around with fps and time steps but it seems even with waittimer my minimum fps is 11 and maximum fps is 111!  ah well looks like ill have to do some fps experimenting the hard way..  Also I will have to rely on keeping a constant fps and NOT on changing the timestep for the type of game I am doing... It has to do with time travel so you can go back in time and visit a previous self but you cant cause a paradox with the physics!  Thus changing the time step even by a small amount will cause a paradox :( its a paradoxical situation in itself :/<br><br>edit Minor Succes! Now I can have 80 boxes on screen. the only problem is as with all physics engines, it explodes because of the massive amount of weight on the bottom verlets.  At least it runs at a steady 30-32 fps!<br><br>new control:  press a to reset the min and max fps values for testing purposes.  Please post your stats at the upper left hand side of the screen(only after pressing a of course!)<br><br><a href="http://naillproductions.synthasite.com/resources/physicsenginetest%20(4).zip" target="_blank">http://naillproductions.synthasite.com/resources/physicsenginetest%20(4).zip</a> <br><br></td></tr></table><br>
<a name="944374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> last time it was 6 but this time it was about 22 <br><br></td></tr></table><br>
<a name="944431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xzider</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> noticed the slight lag at 20 - not bad physics <br><br></td></tr></table><br>
<a name="944438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sauer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey pretty cool stuff, I'm impressed.<br><br>I got very little lag, but I'm on an AlienWare here at school.  Once I put about 40 physics blocks in, it started freaking out.  The blocks were just flying everywhere.  It made me smile.<br><br>Cool stuff though, where is this project headed? <br><br></td></tr></table><br>
<a name="944440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Cool stuff though, where is this project headed? <br> <br></div><br><br>im not really sure where this project is headed.  Maybe something similar to fantastic contraption or maybe even a game called ParadoxodaraP?  anyway I am working on polygon collisions at the moment<br><br>I know the blocks expode but this wasnt meant for high stress and the time step is a bit high at the moment due to speed issues<br><br>Im glad its faster now! thanks for the feedback <br><br></td></tr></table><br>
<a name="944534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> WOW! I feel extrememly stupid.  I cant believe I didnt see it before. I just messed up when I was making one of my formulas (I like to make up my own because they get better every time) and it was leading to slow innacurate jittery physics! I fixed it and now I can have ~50 boxes before it starts to slow down and there are almost no jitters until it gets to ~90 boxes! now for the polygon collisions...<br><br>new download link!<br><a href="http://naillproductions.synthasite.com/resources/physicsenginetest%20(4).zip" target="_blank">http://naillproductions.synthasite.com/resources/physicsenginetest%20(4).zip</a><br><br>updated all links! <br><br></td></tr></table><br>
<a name="944627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> you should put a box counter on the screen,<br><br>I got about 34 this time <br><br></td></tr></table><br>
<a name="944689"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> you should put a box counter on the screen <br></div><br><br>oops I planned to do that last time.  will do for the next download<br><br><div class="quote"> I got about 34 this time <br></div><br><br>wow thats a great improvement from 6! Im glad to know my optimizations did that much! <br><br></td></tr></table><br>
<a name="944735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok I have some verlet-polygon collisons now! it should still be very fast! there is now a boxcounter for those of us too lazy to count how many times you hit the spacebar (myself included) please tell me how many boxes you can get without jitters or extended drops in frame rate.  (note: I cut the time step in half thus doubleing the updates per loop so be on the lookout for strange behaviour)<br><br>download:<br><a href="http://naillproductions.synthasite.com/resources/physicsenginetest%20(4).zip" target="_blank">http://naillproductions.synthasite.com/resources/physicsenginetest%20(4).zip</a> <br><br></td></tr></table><br>
<a name="944740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xzider</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was fine at 100-The physics went crazy at 111 (Guess they had nowhere else to go, started flying everywhere)-at 120 it started to slow down, and at 200 it was getting pretty laggy. <br><br></td></tr></table><br>
<a name="944745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok wow that sounds great! 100 boxes? or 100 verlets? or 100 constraints?<br>I have only tested up to 90 boxes <br><br></td></tr></table><br>
<a name="944773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> the FPS dropped to about 15 after 10-14 boxes <br><br></td></tr></table><br>
<a name="944775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> thats odd it seems it has dropped significantly... I am working on optimizations and cleaning up messy bits of code at the moment.  This has a long way to go.  Thanks for testing Jeremy Paxman! just a wee little question: you dont happen to be running any programs like IE or word when testing this do you?  When I open word my framerate also drops very low. <br><br></td></tr></table><br>
<a name="944780"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh yeah I will make sure I didnt have a youtube video in the background........<br>nope still 14 boxes, have you tried replacing lists with arrays? <br><br></td></tr></table><br>
<a name="944785"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Jeremy Paxman - no I havent.. are they significantly faster? <br><br></td></tr></table><br>
<a name="944787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep a lot faster i think, <br><br></td></tr></table><br>
<a name="944789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there a specific method for using arrays instead of lists <br><br></td></tr></table><br>
<a name="944843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you have some  nested loops like:<br><br>working on a list with only 300 things in it<br><br>for p:physicsobject=eachin objlist<br>for q:physicsobject=eachin objlist<br><br>then its 90,000 operations so that might be slow<br><br><br>but anyway...<br><br>I think you just put your objects in an array, <br><br></td></tr></table><br>
<a name="944860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh.. I see your point.  I had never thought about that.  So really it is phenomenal if any computer can get to say 75 boxes because thats 90,000 collision checks not counting the constraint loop.  Also can you explain how I would go about using arrays? or maybe a link? <br><br></td></tr></table><br>
<a name="944862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can't you do a quick distance check between 2 boxes?<br><br>If the widest part of the item+the widest part of the other item is less than the distance from centre to centre, then don't perform any more collision checks. <br><br></td></tr></table><br>
<a name="944872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ ross C - I just did that :) its working quite well but not as quickly as I would like.  It keeps track of the largest verlet and doubles that value.  If the verlets are not within that distance of eachother on the x and y axises, it doesnt even bother checking anything else.  overall I have gotten my box count to 60 on a dual core 2.4 ghz.<br><br>would it be more efficient and accurate enough to use a square root array to store all the sqareroots? <br><br></td></tr></table><br>
<a name="944886"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xzider</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> @My earlier post, I meant boxes.<br><br>This little project reminds me of Garrys Mod...Think I'll go play it. <br><br></td></tr></table><br>
<a name="944913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sauer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you using bitwise operations of multiplication and division?  You should see an increase in performance by using bit shifts, ands, and ors instead of multiplication, division (by powers of 2 that is) and mod.<br><br>Or does Blitz automatically convert division by base two numbers to bit shifts?  I believe Python does this... <br><br></td></tr></table><br>
<a name="944914"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ sauer - you lost me at bitwise.. so are you saying I should divide by 1/ a number rather than multiply? <br><br></td></tr></table><br>
<a name="944916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sauer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, you can use the commands SHR and SHL (bit shift right, bit shift left) which you can use in place of where you divide by a power of two.<br><br>If you've ever wondered why tile based games all have tiles that are a power of two (16,32,64 are common sizes) this is it.  Division takes about 11 cpu instructions to complete, whereas a binary shift takes one.  This can lead to great optimization.<br><br>Basically everywhere you would divide by a power of two, bit shift right, and whenever you want to multiply by a power of two, bit shift left.  Basically all it does it takes all the bits and puts them one 'bin' to the right or left.  I don't know how well your binary skills are but you can implement it without really knowing whats going on.  Here are some examples:<br><br>x/32  =  x&gt;&gt;5   ; we can shift x five bins right, dividing by 32 (2^5)<br>x/16  =  x&gt;&gt;4   ; same thing, 16=2^4, so we just shift right four times<br>x/2    =  x&gt;&gt;1   ; you can even bit shift when dividing by two<br><br>*note, &gt;&gt; would be SHR in blitz, in other languages it's actually an operator<br><br>You can do the same with multiplication, but instead of SHR use SHL.<br><br>I'm not sure how much MOD you are using, but if it's a lot and you are modding by a power of 2, there's a way to use bitwise OR to do that too, which I can also explain if needed.<br><br>Hopefully that made a bit of sense.   &lt;==EDIT Awesome unintentional pun by me. :) <br><br></td></tr></table><br>
<a name="944917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> To avoid doing checks between all boxes you could divide the screens up into squares and keep track of a list of boxes for each square. Then for collision detection you only do checks between boxes in adjacent squares. <br><br></td></tr></table><br>
<a name="944956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ foppy wouldnt that possibly be less efficient? I can see how that would work though.  Ill give it a go<br><br>nice pun sauer but I soon found out that you cant do bitwise operations on floating point variables :( and that is the only place I need it<br><br>Here is my code for checking collisions between verlets just so you can see what I am getting at.. the boxes are made up of 4 verlets each.<br><br><pre class=code>For Local v:verlet = EachIn verletlist
For Local vv:verlet = EachIn verletlist
	Local dx# = v.x - vv.x
	Local dy# = v.y - vv.y
	If Abs(dx) &lt; maxverlsiz And Abs(dy) &lt; maxverlsiz Then
		If v.id &lt;&gt; vv.id   ' If Not the same verlet Or group
			
			Local dist# = Sqr ( dx#*dx# + dy#*dy#)		
			Local totalr# = v.siz# + vv.siz#
			If dist# &lt; totalr# Then
				
				Local dmtr# = dist#-totalr#				
				Local Diffx# = ( dmtr# ) * ( dx# / dist# )
				Local Diffy# = ( dmtr# ) * ( dy# / dist# )
				If v.active = True Then
					v.x = v.x - Diffx# '* .5
					v.y = v.y - Diffy# '* .5
				EndIf
				
				If vv.active = True Then
					vv.x = vv.x + Diffx# '* .5
					vv.y = vv.y + Diffy# '* .5
				EndIf
				
			EndIf 				
		EndIf
	EndIf
Next
Next
</pre><br><br>Edit: I optimized this a lot with only a few lines of &lt; and &gt; statements!<br><br>Note: I took out the time step! It was an optimization but also because I am going for a different approach on verlet physics in which a time step messes everything up.  I know its a radical move but its worth a shot. now I get 80 boxes until it starts lagging... my goal 150! <br><br></td></tr></table><br>
<a name="944981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> wouldnt that possibly be less efficient? <br></div>Well, as the boxes move around there are extra operations to check if they go from one square into the next, and if so, a few operations to remove them from one list and add them to another.<br><br>However if there are a lot of objects I think the smaller amount of collision checks will outweigh the extra administration, because the number of potential collision checks increases quadratically while the administration costs increase linearly.<br><br>Maybe it's not as applicable to your physics engine as it is to my action games (or as easily applied). You would have to consider the size of those squares in relation to the maximum size of the objects: the algorithm relies on the fact that objects in non-adjacent square cannot touch each other.<br><br>You say you are already doing a quick distance check between the boxes, this means the relative profit from the above algorithm are smaller.<br><br>But still, perhaps an idea to keep in mind. <br><br></td></tr></table><br>
<a name="945002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But still, perhaps an idea to keep in mind. <br></div><br><br>ill definitely keep that in mind. it sounds like it could be just what I need but ill have to do some research and testing. <br><br></td></tr></table><br>
<a name="945042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can fill the screen ith boxes now, I get 110 boxes before the simulation explodes. <br><br></td></tr></table><br>
<a name="945106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> To avoid doing checks between all boxes you could divide the screens up into squares and keep track of a list of boxes for each square. Then for collision detection you only do checks between boxes in adjacent squares. <br></div><br>zoning... there are many different methods but they really do increase your collision efficiency.<br><br>[edit]below is the wrong solution![edit]<br>but for Nate's example above another type that you could be easily implemented is just making sure you never check a collision between the same 2 objects more than once.  ie, once you check the first one with all the other ones, the first one shouldn't be in any more checks... etc..  every object only has to check the objects below it in the list because the objects above have already done this check.  further more there is no reason to check the onbject against itself.<br><br><br><pre class=code>
SuperStrict

Type mytype
	Global list:TList = New TList
	Global gi:Int = 0
	
	Field i:Int

	Method New()
		i = gi
		gi:+1
		list.AddLast Self
	End Method

End Type


For Local i:Int = 0 To 3
	New mytype
Next

For Local t:mytype = EachIn mytype.list
	For Local tt:mytype = EachIn mytype.list
		Print t.i+" checking "+tt.i
	Next
Next

'as opposed to...

Print "~nonly check once"
Local l:TLink = mytype.list.FirstLink()
While l &lt;&gt; mytype.list.LastLink()
	Local ll:TLink = l._succ
	While ll._succ &lt;&gt; mytype.list.FirstLink()
		Print mytype(l._value).i+" checking "+mytype(ll._value).i
		ll = ll._succ
	Wend
	l = l._succ
Wend
l = Null
</pre><br><br>now I would use a singly linked list so the loop would look like this<br><pre class=code>
Local v:mytype = mytype.First()
While v
	Local vv = v.succ
	While vv
		Print v.i+" checking "+vv.i
		vv = vv.succ
	Wend
	v = v.succ
Wend
</pre> <br><br></td></tr></table><br>
<a name="945121"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Dmaz - great Idea! thanks. I never really thought about that but it does seem like it would work :) ill give it a go <br><br></td></tr></table><br>
<a name="945125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for all the help everyone (keep it coming) because I decided I will release this free with source code once I get it all fixed up.. keep in mind I made it for my own purposes so it may or maynot fulfill all of your requirements. and yes its superstrict :) I started it one day messing around to see if I could learn superstrict and types in bmax<br><br>if anyone has a list of features they want please post<br><br>so far there are<br><br>verlets!<br>constraints!<br>polygon segments (only to collide with ie. the polygons dont move they just sit there)<br>images attatched to constraints<br>gravity vector<br>a waterline with the following features<br><pre class=code>
Global Waterlevel:Int = 400		'Waterlevel in pixels
Global Waterdensity:Float = 10		'The depth at wich boyancy maxes out
Global BoyancyForce:Float = .1		'Best if close to gravity
Global WaterFriction:Float = .01	'Needs to be really low for a very subtle effect
</pre><br><br>soon to come (note: these may take a while because I'm very sick right now)<br><br>optimization - a must<br>images attatched to verlets<br>verlets attatched to the constraints! I know.. its backwards!<br><br>readablitlity! - this is the last thing I will do. Its already readable but Ill try to make it as user friendly as possible<br><br><br>edit @ dmaz - your idea is one that seems good in theory but doesnt work in real life.  I tried it and it actually does work a little but the system explodes with very few boxes.  I think those extra iterations simply stabalize it more. stability comes first <br><br></td></tr></table><br>
<a name="945163"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>edit @ dmaz - your idea is one that seems good in theory but doesnt work in real life. I tried it and it actually does work a little but the system explodes with very few boxes. I think those extra iterations simply stabalize it more. stability comes first<br> <br></div><br><br>well ya [hits self on head]. I wasn't thinking, in a physics sim you need to balance the collisions with all the other collisions in the local area because the collisions affect the result.  I was thinking in terms of a shooter where you only care about the interaction between the 2 colliding onjects... as foppy said, zoning would be your best bet then since you limit your collisions to the local area (the box it's in and the surrounding boxes) <br><br></td></tr></table><br>
<a name="945177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> well ya [hits self on head].  <br></div><br><br>[hits self on head as well]<br>haha I guess it was worth a shot because now I will know not to try it again<br><br>edit ok I have properly applied friction!<br>it should also be almost twice as efficient as it used to be<br>notice the upper left segment of the triangle has a very high friction while the right side has almost no friction<br><br>please test here<br><a href="http://naillproductions.synthasite.com/resources/NTG%20physics%20engine.zip" target="_blank">http://naillproductions.synthasite.com/resources/NTG%20physics%20engine.zip</a> <br><br></td></tr></table><br>
<a name="945500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok updated!<br><br>now it is much more stable and the speed has doubled for me.  I now get 130-140 boxes without any slowdown.  :) it is also much more stable.<br><br>please test and post how many boxes you can get as well as your specs<br><br>link<br><a href="http://naillproductions.synthasite.com/resources/NTG%20physics%20engine%20(2).zip" target="_blank">http://naillproductions.synthasite.com/resources/NTG%20physics%20engine%20(2).zip</a> <br><br></td></tr></table><br>
<a name="945510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> how about the ability to 'move the camera' to allow for worlds bigger than the screen<br><br>I got 130 boxes this time!<br><br>Ever thought about adding joints? <br><br></td></tr></table><br>
<a name="945525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for sticking with it Jeremy Paxman.  I got 130 with the old demo that you just tried too but I just upped it to 170 with another rampage through the code optimizing even more. :) it is quite unstable though.  I need to make it more stable now.<br><br>170 boxes = 680 verlets! and 1020 constraints! pretty good eh?<br><br>what do you mean by adding joints? I can make a ragdoll demo if you want me to for proof of concept of verlets and constraints. or do you mean something else? <br><br></td></tr></table><br>
<a name="945541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh I didnt realise constraints were like joints,<br>a ragdoll demo would be fun! <br><br></td></tr></table><br>
<a name="945544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I will put together an awesome ragdoll demo in a few days. hopefully tomorrow. but im really concerned as to how this is going to shape up as a full blown engine<br><br>edit by the way I got the camera stuff done, the demos just dont show it<br><br>edit - moved to here<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=83810" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=83810</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
