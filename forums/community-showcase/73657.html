<!DOCTYPE html><html lang="en" ><head ><title >test my aspect ratio keeper thingy.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >test my aspect ratio keeper thingy.</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >test my aspect ratio keeper thingy.</a><br><br>
<a name="823105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a widescreen monitor that by default streches any 4:3 display.. thats not good for making indie games, scretched games look ugly and you cannot ask a player to change their gfx settings.<br><br>So the only other way to do this is to scale the game to keep the 4:3 aspec but you will get black bar down the side which is better then a streched display.<br><br>Ok I believe what I have done is some kind of projection matrix but I realy dont know.<br><br>Heres the download, it includes the exe. and bmx. should you want to see the code, ignore most of it as its just a little game im working on and is very untidy.  But it shows that mouse corrds still work even on a scaled display.<br><br>Note this program should not blow up your monitor the 2 display modes it uses are either your desktop resolution or a 640x480 resolution.<br><br>So what will the program do? it will launch using your desktop resolution and will scale all gfx and mouse operations so that the game maintians it 4:3 aspect (640x480) the trade off is black bars either side.  the 2nd display is without scaling and will run the game in 640x480.<br><br>If you widescreen scretches normal 4:3 aspect you should see a 4:3 aspect on display 1 with black bars, the 2nd dosplay you should see your normal streched display.<br><br>heres the download: <a href="http://www.getperplexed.com/aspect_test.zip" target="_blank">http://www.getperplexed.com/aspect_test.zip</a><br><br>please report what display you have 4:3 12:10 12:9 and what happened on both display modes. <br><br></td></tr></table><br>
<a name="823107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Boiled Sweets</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>and you cannot ask a player to change their gfx<br> <br></div><br><br>Why not?  I detect their current desktop resolution and prompt them auto selecting the detected resolution so they just have to hit "GO" or they can change their resolution.<br><br>Sounds like you are over complicating things.  My last project supports 800 * 600, 1024 * 768, 1280 * 1024, 1440 * 900 and 1680 * 1050 (4:3, 5:4 and 16:10) resolutions (ratios) <br><br></td></tr></table><br>
<a name="823109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I mean go into their gfx card settings and set their monitor/card not to strech non-widscreen modes.<br><br>No offense but I dont think you know what im banging on about =S<br><br>I want my game to run in 640x480 but my widescreen streches the game to fill all the screen, this is ugly, so I have no choice other than to use a square pixle resolution such as 1400x900 but when I do that the game is tiny, so i have to scale the game to fill the height of the screen but im left with black bars on eitherside.. but at least its not scretched.<br><br>I can turn off streching in my gfx settings, but the average casual gamer wont have a clue or would want to do this, so I need a solution.<br><br>the idea is to show a user a test card the fist time the game starts, this is show a circle and a square I will ask 1 question "does the square and circle appear streched" if they say no then I know that either have a 4:3 display or a widescreen that does not strech 4:3 displays I can then simply run the game in 640x480, if they press yes I know they have a widescreen that streches 4:3 displays and I will offer the choice to use some aspect correction. <br><br></td></tr></table><br>
<a name="823376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> On my 1280x1024 display both modes did not fit the text fully on the screen.  The graphics looked much the same but the text did not fit on the screen (ran off the left and right hand sides). <br><br></td></tr></table><br>
<a name="823368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> On my non-widescreen display, your testapp prints the text incorrectly in 'stretched' mode.<br><br>The graphics all look identical (as expected), but the text starts outside of the left side of the screen, making it partially unreadable. <br><br></td></tr></table><br>
<a name="823390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ah yes the text will over run the screen.. should of mentioned that, but what your saying is on your non-widscreen displays both modes show as you would expect?<br><br>*EDIT* hold on your guys said text ran off the left side? even on on non-streched mode? where the game runs in 640x480 with no correction?<br><br>Now I just need a few people with widescreens to test it out. <br><br></td></tr></table><br>
<a name="823400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> *EDIT* hold on your guys said text ran off the left side? even on on non-streched mode? where the game runs in 640x480 with no correction <br></div><br><br>No -- in non-stretched mode it runs off the right side.<br><br>In stretched mode it runs off both sides.<br><br>The graphics look identical in both modes. <br><br></td></tr></table><br>
<a name="823444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It keeps the 4:3 aspect ratio in both modes on my non-widescreen monitor.<br><br>I was attempting something similar recently (again with the thought that a game written for 640 x 480 would look bad on a fixed-resolution/widescreen TFT display). Also, I'd fill in the black bars with a muted pattern, eg. pale blue checks like at the start of the 'Max RockOut sample. Yours looks a lot simpler though!<br><br>Substitute "boing.png" with your own image (fairly small, ie. &lt;= 256 x 256) -- not tested much! I just got the basics going:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

' -----------------------------------------------------------------------------
' Actual display size...
' -----------------------------------------------------------------------------

Local screenwidth:Int	= 1024
Local screenheight:Int	= 768
Local screendiv:Float	= Float (screenheight) / Float (screenwidth)

' -----------------------------------------------------------------------------
' Intended game size...
' -----------------------------------------------------------------------------

Local gamewidth:Int		= 640
Local gameheight:Int	= 400
Local gamediv:Float		= Float (gameheight) / Float (gamewidth)

Print "gamediv: " + gamediv
Print "screendiv: " + screendiv

' -----------------------------------------------------------------------------
' Scale for images, etc. TO DO: Need to adjust for game width/height...
' -----------------------------------------------------------------------------

Local ratio:Float = 1.0 / (Float (gamewidth) / Float (screenwidth))
Print ratio

Local ratio2:Float = 1.0 / (Float (gameheight) / Float (screenheight))
Print ratio2

' -----------------------------------------------------------------------------
' Get best fit...
' -----------------------------------------------------------------------------

If screendiv &lt;= gamediv
	gameheight = screenheight
	gamewidth = Int (gameheight / gamediv)
	Print gamewidth
Else
	gamewidth = screenwidth
	gameheight = Int (gamewidth * gamediv)
	Print gamewidth
EndIf

gamediv = Float (gameheight) / Float (gamewidth)
Print "New gamediv: " + gamediv

Print screenwidth + " " + screenheight
Print gamewidth + " " + gameheight

' -----------------------------------------------------------------------------
' Open display...
' -----------------------------------------------------------------------------

Graphics screenwidth, screenheight, 32

SetBlend ALPHABLEND

SetClsColor 64, 96, 128
SetMaskColor 255, 0, 255
AutoMidHandle True

Local rocket:TImage = LoadImage ("boing.png")

' -----------------------------------------------------------------------------
' Draw commands operate from inner viewport (game area)...
' -----------------------------------------------------------------------------

SetOrigin (screenwidth / 2) - (gamewidth / 2), (screenheight / 2) - (gameheight / 2)

Repeat

	' -------------------------------------------------------------------------
	' Outer viewport (display size)...
	' -------------------------------------------------------------------------
	
	SetViewport 0, 0, screenwidth, screenheight
	SetClsColor 32, 32, 128
	Cls
	
	' -------------------------------------------------------------------------
	' Inner viewport (game area)...
	' -------------------------------------------------------------------------
	
	SetViewport (screenwidth / 2) - (gamewidth / 2), (screenheight / 2) - (gameheight / 2), gamewidth, gameheight
	SetClsColor 128, 32, 32
	Cls
	
	SetScale 1, 1
	DrawText "Hello", 0, 0
	
	SetScale ratio, ratio
	DrawImage rocket, MouseX (), MouseY ()
	
	Flip
	
Until KeyHit (KEY_ESCAPE) Or MouseHit (1)

End
</textarea> <br><br></td></tr></table><br>
<a name="823657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure if this is supposed to work on widescreen... but... on my widescreen if i pick an actual screen of 1440x900 (widsecreen) it displays as 4:3 but its too big, seems the height doesnt scale correctly.<br><br>I am goona borrow my friends crap-tastic PC on the weekend has a 15" 4:3 and dated on board gfx, I need to see if scaling works correctly and more importantly if his onboard gfx wont have a slow down from a scaled display. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
