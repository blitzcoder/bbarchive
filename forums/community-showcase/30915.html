<!DOCTYPE html><html lang="en" ><head ><title >fake HDR lighting</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >fake HDR lighting</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >fake HDR lighting</a><br><br>
<a name="329534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've become obsessed in HDR lighting a few days ago... since then I have been trying to dublicate that effect in blitz. Without the pixel shaders it's hard to do any hardware blurring and software blurring is too slow. I managed to get some kind of hw blurring in it and it runs pretty fast on my radeon 9600.... this is the first working version. people with old gfx cards... don't even try this :)<br><br>www.kotiposti.net/naama/fakeHDR.zip<br><br>[EDIT]<br><br>a little update... now it's starting to look like the bloom effect I wanted... thanks to sswifts excellent texture blurring function. Same download.<br><br><img src="http://www.kotiposti.net/naama/glowscreen.jpg"> <br><br></td></tr></table><br>
<a name="329535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been thinking about HDR myself lately.<br><br>I don't really think this effect you have is really that similar to HDR though.  I know you reffered to it as "fake HDR" though.<br><br>You only have one texture...  I presume what you are doing is similar to the effect Halo 2 does, which is not really HDR lighting.  <br><br>I assume that you are copying the screen buffer to a texture, and then stretching a quad over the viewport, applying this texture to 2-4 texture channels with multiply blending to exponentially darken the dark areas of the image, and then setting the quad to additive blending to blend with the scene.<br><br>It's kind of like HDR, but I think that this method probably has a lot of problems with it.  You probably get a lot of color banding with less noisy textures, and it would be very difficult to draw textures that look the right brightness.<br><br><br>One thing I thought of which is more like real HDR rendering would be to render the same scene multiple times, reducing the brightness of the lights in each pass until all lights go below 255 in brightness in R, G, and B.  Each scene would be rendered over the last with additive blending.  Thus one could make lights which brighten surfaces up way more than is normally possible (I think... I haven't actually tested this) and control the "exposure" of the camera by adjusting the brightness of... well something else.  I haven't really thought this through completely.<br><br>The reason I ahven't thought it through completely is because having only dynamic lights for HDR is worthless to most people.  A way would need to be found to render lightmaps in this manner as well.  Also, one would obviously one would not want to render 10 passes of the same scene, so one would be limited to perhaps 4 passes, which means lights 4x brighter than normal... Hardly similar to the ability of true HDR lighting to model the brigthness of the sun.  Additionally, this alone would not simulate the blurring effect you have above.  You also have the problem of not being able to render the lighting in a first pass before rendering the textures, because to render the textures in a second pass one needs to use multiply blending which means the resulting image would have areas of pure black, and no areas lighter than the original texture color at that point. <br><br></td></tr></table><br>
<a name="329538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was after the prince of persia type of gloom effect... the hardest part of this all is to generate the blur... gaussian blur would be ideal i guess... but it looks nice after about 20 passes... and I find it difficult to come up with anything like it in hardware... my blur is kind of circular blend... i move the quad doing a full circle and constantly additive blend it with the last frame. works pretty nice but leaves some artifacts... <br><br>Yes... it would indeed be nice to be able to do real HDR lighting... but I'm happy with this kind of effect. This looks pretty nice when you don't render a whole scene with it, but you only render the glooming objects. <br><br></td></tr></table><br>
<a name="329539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look in the code archives for a hardware blur function I wrote.  It minimizes the artifacts.  You might be surprised to know that if you don't have a multiple of four passes, at angular offsets that are divsible by 4, that you will get all sorts of artifacts that reduce the quality of the blur.  Ie, 9 layers offset in a circle looks worse than 8.<br><br>It's not perfect though.  You get circular cutouts on the corners of things that are blurred.  I wonder if perhaps using an angular offset in each sucessive 4-layer pass would serve to combat this.<br><br>I imagine we won't have to wait too much longer before we have true HDR imaging rather than the hacks we use now.  We already have floating point texture formats on high end cards as far as I know.  I give it five years. <br><br></td></tr></table><br>
<a name="329565"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul "Taiphoz"</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I duno about you lot but that looks sweet.<br><br>Wouldnt mind seeing the code. <br><br></td></tr></table><br>
<a name="329567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lol :) <br><br></td></tr></table><br>
<a name="329587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >koekjesbaby</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> it reminds me of this: <a href="http://www.blitzbasic.com/Community/posts.php?topic=30216" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=30216</a> <br><br></td></tr></table><br>
<a name="329592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >napole0n</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, nice effect. Doesn't run too well on my work machine (nVidia Quadro2 Pro, a 'pro' edition of the GeForce2), but I guess my GeForce4 at home will have no problems with it. <br><br></td></tr></table><br>
<a name="329659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> koekjesbaby: Actually it's not at all the same... this is no feedback effect. <br><br></td></tr></table><br>
<a name="329684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrtricks</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Me too, I'd love to know how this was done, it looks great. <br><br></td></tr></table><br>
<a name="329787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >koekjesbaby</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> bouncer: i know, but it still reminds me of some effects than can be accomplished with feedback. ;) <br><br></td></tr></table><br>
<a name="329798"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is HDR lighting?  Mostly, what does HDR stand for? <br><br></td></tr></table><br>
<a name="329805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> it means - hey-dut-rocks - where do you live? :P just kiddin. it means: Human Development Reports  - no wait,  Harddisk Data Recovery . Uhm, no,  High Dynamic Range, or Heavy Service Drive Regional or maybe Hyper Dense Radiation ... grrrr darn TLAs! <br><br></td></tr></table><br>
<a name="329812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dustin</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> High Dynamic Range [Image].  While colors normaly range from 0-255 an HDR allows images outside that range to be incorporated.  Think of taking a series of pictures where the iris is stopped up and down and incorporating all of those images into one.  So when an image goes dark the colors don't simply clip into a sea of black.  Also, bright images don't simply clip into a sea of pure white.  It does make a significant difference and I can't wait to see what kind of magic Bouncer manages to come up with!!! <br><br></td></tr></table><br>
<a name="329832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HNPhan</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh nice effect :D<br><br>this is like glow, but faster <br><br></td></tr></table><br>
<a name="329857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> HDR means High Dynamic Range, like Dustin said. <br><br>It means that instead of 24 bit color, with R G and B having one byte each, you have 16 or 32 bit floating point values for R G and B.<br><br>If digital cameras supported HDR images, then when you took a picture of a sunset, you would be able to adjust the exposure in Photoshop without losing any details in areas which are too light or too dark.  <br><br>In other words, if you took a photo of someone standing in front of a bright source of light, like the sky, normally the sky wouldturn white in the final image and all detail would be lost.  But with HDR images, the data that is neccessary to correct those areas is still there.  It just gets clamped to white for display on your monitor.<br><br>HDR is also useful for computer graphics, because it allows you to place very bright light sources in a scene, and then blur the HDR image, and get a result that looks spectacular.<br><br>For example, you can have a single HDR pixel that is 10,000 times brighter than the surrounding pixels, and if you then blur the image and apply it back over the original with an add blend after bringing the brightness down a bit, you'll have a huge flare around that single point.  Normally, blurring a single white pixel would have little effect on it's surroundings.  The difference just isn't actually that great. <br><br></td></tr></table><br>
<a name="329897"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> update... it looks much better now... thanks sswift for you excellent blur function.<br><br>I will release source when I get this good enough to be usefull... <br><br></td></tr></table><br>
<a name="329902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dustin</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt; I will release source when I get this good enough to be usefull... <br><br>Can't wait!  Thanks Bouncer for another amazing creation. <br><br></td></tr></table><br>
<a name="329907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Btw the thing runs just fine on my Radeon 7200.  Do you don't need that high end a video card for this. <br><br></td></tr></table><br>
<a name="329909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> how do you do that? I want to know! It's a very interesting FX!!!<br>Congratulation <br><br></td></tr></table><br>
<a name="329911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dustin</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> @sswift:  It runs like crap on my laptop here at work (3fps).  But I'd expect it to: P3 850 w/ GeForce2Go-16meg.  That would measure up as extreme low end. <br><br></td></tr></table><br>
<a name="329915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> "how do you do that?"<br><br>I explained in the second post down. <br><br></td></tr></table><br>
<a name="329917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zenith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's amazing, perfect for non-hardcoded suns! :O <br><br></td></tr></table><br>
<a name="329930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HNPhan</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice to hear bouncer, thanks for your contribution :D <br><br></td></tr></table><br>
<a name="329943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get 30 FPS on my crappy Matrox g400 (+AMD1300). <br><br></td></tr></table><br>
<a name="329998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> sswift: I have trouble getting the final overlay to fit the scene perfectly. It seems that when you copy backbuffer to texture and use that texture again on a quad of the size of the screen there's some drift if you do multiple passes. If I for example use your blurring function many times in a row (1 pass each) the more blurs I do in a row ... the more the texture drifts. I haven't found a perfect fix for this yet.. it's really bugging me.<br><br>Do you have any ideas? or anyone? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
