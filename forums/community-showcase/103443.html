<!DOCTYPE html><html lang="en" ><head ><title >new render core</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >new render core</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >new render core</a><br><br>
<a name="1245707"></a>

<a name="1245709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, I've stopped work in the 3d editor to finish the renderer. Previously there was an issue with moire shadows.<br><br>I've been tinkering around and here is the result:<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-03-at-15-38-54.png"><br><br>Main features are Dirty Grain look, dynamic shadows, ambient occlusion (SSAO) and colour bleed.<br><br>More work to be done on full integration with everything else, but I'm beginning to be happy with the results.<br><br>The four deferred images are:<br>Shadows, RGB, Normals, FX <br><br></td></tr></table><br>
<a name="1245948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Adam,<br><br>The grainy effect looks good, with the shadows too.<br><br>Are the vertex colours indicative of the the vertex normals? Which deferred image refers to which phase of rendering - i can guess, but if I'm right then I think there might be something wrong somewhere. <br><br></td></tr></table><br>
<a name="1246018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> the deferred pics on the left are:<br>top: shadow buffer<br>middle top: diffuse<br>middle bottom: screen normals<br>bottom: fx<br><br>The normals are created within the shader and are screen based not model based - so look a bit weird. so when you move the view, the normals all change<br><br>Here's another shot with similar models, different colours though so I can check how the colour bleed is working:<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-05-at-14-40-49.png"><br><br>I'm also sacrificing accuracy for speed. as this is all realtime. <br><br></td></tr></table><br>
<a name="1246019"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice, wish I understood math :) <br><br></td></tr></table><br>
<a name="1246020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks great.<br><br><div class="quote"> wish I understood math :)  <br></div><br><br>You and me, both. <br><br></td></tr></table><br>
<a name="1246021"></a>

<a name="1246022"></a>

<a name="1246023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The normals are created within the shader <br></div><br><br>I feel like this is a stupid question, but how does that work? Don't normals require access to information from areas potentially quite far from the fragment position? Hence normally being precomputed vertex properties?<br><br><br>Engine looks fantastic, either way. <br><br></td></tr></table><br>
<a name="1246025"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That grained look reminds me on Cycles-Rendering with Blender.<br><br>Can have good results but is not useable for every game style ... casuals tend to want "polished" look.<br><br>Did you check how "grained" and "text without background" fit together? Maybe it makes readability a bit worse.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1246028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Yasha<br><div class="quote"> I feel like this is a stupid question, but how does that work? <br></div><br>Originally I created the normals myself per model and fed them into the shader (which is the usual way).<br>But there is a big overhead doing it (I found) on the CPU, so I looked at various ways for the GPU to do it. not quite as simple.<br>Then I stumbled upon this little GLSL shader beastie:<br><pre class=code>
Vertex code:
//get the actual vertx depth
	vertexDepth = gl_ModelViewProjectionMatrix * gl_Vertex;

Fragment code:
//get the automatic vertex normal
	vec3 X = dFdx(vertexDepth.xyz);
	vec3 Y = dFdy(vertexDepth.xyz);

	vec3 N = normalize(cross(X, Y));
	vertexNormal = vec4(N.xyz, 1);
</pre><br>It gives you screen normals. lighting can be a bugger though<br><br>@ EdzUP &amp; GaryV<br><div class="quote"> Nice, wish I understood math :) <br></div><br>Would you believe I have a problem with numbers and math? But... If I can draw it, I can come up with something to solve the problem. My brain doesn't process equations so I have notebooks full of 3d axis, drawings of models, how to solve angles, etc.<br>It's one reason there is a dirt look. I know how things should work - couldn't get them to work - and came up with something different. so nothing is quite as it should be...<br><br><br>@ Derron<br>I'm taking each step one at a time. So HUD/text etc is further down the road.<br><br>The next step (once i'm really happy with the renderer) is to take the current renderer:<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-01-at-10-36-31.png"><br><br>which has full material support, bump mapping, procedural stuff and add the deferred one <br><br></td></tr></table><br>
<a name="1246032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow... had no idea about the dFdx and dFdy functions - didn't realise it was at all possible for a fragment to use any information from other fragments on the same pass (I would have tried to do that the dumb way in two passes or something). Guess that explains the 2x2 basic block thing.<br><br>That's a pretty fundamental piece of GPU wisdom I learned today! Thanks! <br><br></td></tr></table><br>
<a name="1246041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did not want to sound as if I impatiently await your source code ... I just asked myself wether the grain could disturb text readability in certain scenarios (eg when you want "flat/polished" object surfaces but get that grain for free).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1246047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmmm. an interesting thought. I had to go into photoshop and do a quick test for you.<br>In essence any "thin' text would get disturbed. But if that was the case, you should really be using a different font or text method.<br><br>I checked with solid white and alpha text and it was fine.<br><br>A good way to make sure this wouldn't be too much of an issue would be to use a faded background of black, or outline, or shadow to the text.<br><br>Here is the above table with a (photoshopped) dirt render:<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-01-at-10-36-311.png"><br>Hopefully the real thing will be similar? <br><br></td></tr></table><br>
<a name="1246052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> think the above screen shot already shows that your axis-arrows might be a bit too faded/alphaed (blue is really hard to distinguish ... maybe it already needs that glow/shadow/outline you suggested for text).<br><br><br>That outline effects for text are natural if the background varies - so a dark outline is nearly not visible if the bg is already dark while on bright background it allows to distinguish a bright text from the bg.<br><br>Somehow I like that table... looks "rough" and "used" ... something on which you can catch a splinter.<br><br>Tiles of the floor look kind of "scaled to much" - of course there were big plates, but the gap between is about 2cm .. <br><br>But hmm ... is this even a table and not some kind of chair/stool? ... because the space between the planks is also a bit bigger than usual for a table... in that case ignore my critics on the floor plate.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1246057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> LOL No problem about the critique of the floor and table. it was a quick photoshop knockup - hence the faded axis arrow. (But you're correct about the blue not being easy to see)<br><br>Also the models are just me messing around with settings, materials to see the result. definitely not any final thing for getting critique about ;) <br><br></td></tr></table><br>
<a name="1246287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is the new tweaked render core with a proper table (not using the new material rendering) with just vertex colours.<br><br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-08-at-12-41-20.png"><br><br>I've still got problems with moire in the shadows, but it is much less now.<br><br>The shadows and AO are also being modulated depending on depth so closer objects have a brighter look.<br><br>The base plane was changed from grey to a near white, which accounts for the very stark base plane. <br><br></td></tr></table><br>
<a name="1246288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> if this is a proper table: middle panel is of lower height than the outer ones. There is no 90° rotated panel holding the wood :D. I like the brighter wood. The darker one fits better for "taverns" with less light.<br><br>For me it now looks like an inbetween shot during cycles renders (blender cycles).<br><br><br>It has something attracting but personally I more like the "polished" look. ... but at the end it might sum up to something visually attractive, time will show.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1246291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> no need to worry about what the models actually look like - i'm just test coding the render core. but yep - there are no cross beams etc on the table<br><br>So, just for you Derron (standard Rameses renderer):<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-08-at-14-24-04.png"><br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-08-at-14-23-15.png"><br>and finally:<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-08-at-14-23-35.png"><br><br>And the top planks are slightly off and angled differently for a rough look.<br>And only 2 objects used:<br>Plank and Leg! <br><br></td></tr></table><br>
<a name="1246298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> pattern on the table-plane looks a bit "skewed" - intention or somehting "wrong" ? <br><br>In the first shot - the bottom left plank side - seems to have some "repeating pattern" - issue? <br><br>shot 2: pay attention not to create clipping errors (the "cross beams" poking through the top planks :D).<br><br>You do not need to do a bunch of work just to satisfy someone criticising a bit here and there.<br><br><br>May I ask what kind of light source is used - ass there seems to be some kind of "sun" (equal light strength) but then eg in shot 3 the legs on the left side seem to look brighter than on the right side - which can only happen if the light is restricted somehow (more on the left side, object taking away light on the right side).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1246307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can ask about the lighting, but in some respects it wan't do a lot of good. It's based on a single point, but is then modulated through the scene depending on the surface parameters - again these are just test renders :) <br><br></td></tr></table><br>
<a name="1247200"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-14-at-08-38-41.png"><br>But the SSAO is now much better, no halo, and darker where it needs to be. <br><br></td></tr></table><br>
<a name="1247201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks way smoother (but also lost that "hard/used" look of the wood - did you change the material too?)<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1247209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep, the materials are not being used, just the rendercore.<br>So the only thing being used is the vertex colors. Much simpler to test things that way :) <br><br></td></tr></table><br>
<a name="1247210"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might look into things like "physical materials" ... so you could define how materials accept "shadows" ... or how "blurry" they make shadows. Same for reflections etc.<br><br><br>@Table<br>it looks kind of "displaced" ... intention or mistake? <br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1247234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> so you could define how materials accept "shadows" <br></div><br>Definitely a good idea there about the shadows/material and one i'll look into.<br><br>For now it's the shadows themselves and how I can give a better look. <br><br></td></tr></table><br>
<a name="1247238"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Subdivision surfaces might also be of interest (but in contrast to your "low poly look"):<br><br><a href="http://www.blendernation.com/2014/11/12/non-blender-animation-at-pixar-math-and-movies/" target="_blank">http://www.blendernation.com/2014/11/12/non-blender-animation-at-pixar-math-and-movies/</a><br><br><br>Very well explained by that old man.<br><br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1247343"></a>

<a name="1247344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent post there. I especially liked the way everything was explained through pictures - very easy to grasp :)<br>Thanks Derron<br><br>Quick update on this:<br>got the shadows to work the way I wanted them and also took the advice of materials with shadow properties.<br><br>RenderCore now has ability to blur shadows per object and also a global shadow/light variance parameter that modulates the resulting light and shadow from very bright (bright sunlight/polar) through to normal daylight and down to darkened muted light/shadows for night/dark areas. <br><br></td></tr></table><br>
<a name="1247841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a quick shot of RenderCore with some lighting thrown in. Lighting is not currently supported. I'm just running tests:<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-18-at-12-30-53.png"><br>5 lights with different parameters, colour, falloff etc.<br><br>And a quick one showing the soft shadows (which are controllable per object)<br><img src="https://vjointeractive.files.wordpress.com/2014/11/screen-shot-2014-11-15-at-11-58-39.png"> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
