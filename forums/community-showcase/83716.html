<!DOCTYPE html><html lang="en" ><head ><title >Mesh based particle lib</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Mesh based particle lib</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Mesh based particle lib</a><br><br>
<a name="944691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Still looking for a new job, so I have alot of time on my hands.. Started a new particle library to complement easybuilder maps/levels. <br><br>Its mesh based, using primitives and custom shapes for particles and using no textures at all.   Framerates on my test machine are very good and its a 1.6ghz laptop with integrated junk card.    I have alot to implement, but will post the library in the archives when its done.  <br><br>Heres a few test shots, everything aside form the scene is made and managed by the library, even event sounds and effect links.<br><br>aparently my webserver is down for some reason.. hopefully it will be back up soon. <br><br><br><a href="http://www.empowergames.com/meshparts.jpg?" target="_blank">http://www.empowergames.com/meshparts.jpg?</a> <br><br></td></tr></table><br>
<a name="944696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Screenshots don't work. Also, you're sure it's a 1.6mhz processor? <br><br></td></tr></table><br>
<a name="944697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> back up.. and yeah its a dual core 1.6ghz  each core or close to that.  and im pretty sure B3D uses just one core. <br><br></td></tr></table><br>
<a name="944736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks interesting, all the effects in Polymaniacs are mesh based with no textures.  I'm looking forward to having a butchers when you release to see if there's anything I could do better or pick up ideas from. <br><br></td></tr></table><br>
<a name="944749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I doubt you could improve yours based on mine Stevie, i've followed some of your work.  Your math skills alone make me green with envy.   Wich reminds me.. Could you write up a 3 point version of this code ?  Would be usefull for this lib in fact.  Thanks in advance .<br><br><pre class=code>
Function COLORinterpolate( t#, r1,g1,b1 , r2, g2, b2 , r3, g3, b3 , r4, g4, b4 )

	gR = r1 * (1-t)^3 + 3 * r2 * (1-t)^2 * t + 3 * r3 * (1-t) * t^2 + r4 * t^3 
	gG = g1 * (1-t)^3 + 3 * g2 * (1-t)^2 * t + 3 * g3 * (1-t) * t^2 + g4 * t^3 
	gB = b1 * (1-t)^3 + 3 * b2 * (1-t)^2 * t + 3 * b3 * (1-t) * t^2 + b4 * t^3 
	
End Function
</pre> <br><br></td></tr></table><br>
<a name="944753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Your math skills alone make me green with envy. Wich reminds me.. Could you write up a 3 point version of this code ? <br> <br></div><br><br>It helps that I studied Maths at uni, although that was a long time ago.  From 4 to 3 point bezier is quite simple as you can see:<br><br><pre class=code>
Function COLORinterpolate( t#, r1,g1,b1 , r2, g2, b2 , r3, g3, b3 )

	gR = r1 * (1-t)^3 + 3 * r2 * (1-t)^2 * t + 3 * r2 * (1-t) * t^2 + r3 * t^3 
	gG = g1 * (1-t)^3 + 3 * g2 * (1-t)^2 * t + 3 * g2 * (1-t) * t^2 + g3 * t^3 
	gB = b1 * (1-t)^3 + 3 * b2 * (1-t)^2 * t + 3 * b2 * (1-t) * t^2 + b3 * t^3 
	
End Function
</pre> <br><br></td></tr></table><br>
<a name="944788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you <br><br></td></tr></table><br>
<a name="944950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stevie, sorry to keep this up. But can you Interpolate 3 points and two points without using 4 steps ?   doing a 3 step like above  1, 2, 2, 3  means the second step lasts longer. <br><br>If not, thanks anyway ill use what you posted. <br><br></td></tr></table><br>
<a name="944985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Function COLORinterpolate( t#, r1,g1,b1 , r2, g2, b2 , r3, g3, b3 )

	gR = r1 * (1-t)^3 + 3 * r2 * (1-t)^2 * t + 3 * r2 * (1-t) * t^2 + r3 * t^3 
	gG = g1 * (1-t)^3 + 3 * g2 * (1-t)^2 * t + 3 * g2 * (1-t) * t^2 + g3 * t^3 
	gB = b1 * (1-t)^3 + 3 * b2 * (1-t)^2 * t + 3 * b2 * (1-t) * t^2 + b3 * t^3 
	
End Function
</pre><br><br>Just a hint: instead of computing this all the time, pre-compute 1-t, (1-t)^2, (1-t)^3, t^2... <br><br><pre class=code>
Function COLORinterpolate( t#, r1,g1,b1 , r2, g2, b2 , r3, g3, b3 )
Local t1=1-t
Local t12=(t1^2) * t
Local t13=t1^3
Local t3 = t^3
Local t2=t1 * (t^2)

	gR = r1 * t13 + 3 * r2 * t12 + 3 * r2 * t2 + r3 * t3 
        gG = g1 * t13 + 3 * g2 * t12 + 3 * g2 * t2 + g3 * t3 
	gB = b1 * t13 + 3 * b2 * t12 + 3 * b2 * t2 + b3 * t3 
	
End Function
</pre><br><br>Should be much faster ;) <br><br></td></tr></table><br>
<a name="945000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, im doing this already.  As well as removing the math from a functon and injecting it everywhere its needed in my particle loops , so not to get 100s of calls per loop, as shown here. I continue to do the same for other attributes as well such as scale ect.'<br><br><pre class=code>
TimeLeft#=(d\timeleft-gametimer)/d\lifetime#
SmallN#=1-timeleft#
Pslot1#=smalln^3 ;+ 3
Pslot2#=smalln^2 * timeleft; + 3
Pslot3#=smalln * timeleft^2
Pslot4#=timeleft^3

;alpha
d\cur_alpha= EmitterAlpha3(d\emitterid) * Pslot1 + 3 * EmitterAlpha2(d\emitterid) * Pslot2# + 3 * EmitterAlpha2(D\emitterid)* Pslot3# + EmitterAlpha(D\EmitterID) * Pslot4# 
If d\cur_alpha&lt;0 Then killflag=1
;color
d\cur_red  = EmitterRed3(d\emitterid) * Pslot1 + 3 * EmitterRed2(d\emitterid) * Pslot2 + 3 * EmitterRed2(D\emitterid) * Pslot3 + EmitterRed(D\EmitterID) * Pslot4 
d\cur_green= EmitterGreen3(d\emitterid) * Pslot1 + 3 * EmitterGreen2(d\emitterid) * Pslot2 + 3 * EmitterGreen2(D\emitterid) * Pslot3 + EmitterGreen(D\EmitterID) * Pslot4 
d\cur_blue = EmitterBlue3(d\emitterid) * Pslot1 + 3 * EmitterBlue2(d\emitterid) * Pslot3 + 3 * EmitterBlue2(D\emitterid) * Pslot3 + EmitterBlue(D\EmitterID) * Pslot4 
</pre> <br><br></td></tr></table><br>
<a name="945848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here it is revised wtih interpolation. Thanks for equation. StevieG<br>Below are the following codeboxes..  Tween include, particle values include, particle system include, and the main test code.  Ill upload a zip and link that as well wich will have the code and media used.<br><br>I know for a fact there are many improvemesnt to be made, this was flung together , but it works well.   If you make improvements please update me.<br><br>All in one zip.<br><a href="Http://www.empowergames.com/rifmeshpart.zip" target="_blank">Http://www.empowergames.com/rifmeshpart.zip</a><br>It has min documentation (flung together remember) so if you dont get how im doing somthing, just ask.<br><br>The test program simply shows some of the features such as.  Aligning particle effects to meet collision angles, parenting several emitters together, applying paths to emitters and objects that are parents to emitters, as well as showing the visual difference betwen parent and superparent flags. (superparent means every particle is also parented to emitter or main parent).  Sound management is integrated into the particle system so you dont have to worry about that at all, you just indicate sounds in the emitter presets<br><br>tween include<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80"> 
;tween.bb

;to use this as in include.. you must make youre main game loop in a function called updategame()
;so you call checktween() and inside checktween it calls updategame() for your game logic followed 
;by rederworld(frametween) and Flip

Global gameFPS = 50
Global Frameperiod,Frametime,frameticks
framePeriod = 1000 / gameFPS
frameTime = MilliSecs () - framePeriod

Function checktween()
    Repeat
	frameElapsed = MilliSecs () - frameTime
	Until frameElapsed
	frameTicks = frameElapsed / framePeriod
	frameTween# = Float (frameElapsed Mod framePeriod) / Float (framePeriod)
    If frameTicks&gt;7 Then frameTicks=7:frametime=MilliSecs() 
	For frameLimit = 1 To frameTicks
		UpdateWorld()
		Updategame()
		If frameLimit = frameTicks Then CaptureWorld()
		frameTime = frameTime + framePeriod
      Next
End Function
</textarea><br><br>particle values include. (preset particle effects and one path)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;ParticleValues.bb

;SOME TEST PARTICLE VALUES .. AT THE BOTTOM IS A TEST PATH (not a very good one)


;--test
Restore mytestpath
For i=1 To 16
Read Emitter_Pathx(i,1)
Read Emitter_Pathy(i,1)
Read Emitter_Pathz(i,1)

Read Emitter_Pathpitch(i,1)
Read Emitter_Pathyaw(i,1)
Read Emitter_Pathroll(i,1)
Next
emitter_pathpoints(1)=16
emitter_pathtraveltime(1)=1500

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(1)="redringout"
EmitterViewcheck(1)=1
EmitterX#(1)=0
EmitterY#(1)=0
EmitterZ#(1)=0
EmitterAreaX(1)=0
EmitterAreaY(1)=0
EmitterAreaZ(1)=0
EmitterStartDelay(1)=0
EmitterLifeTime(1)=100
EmitterSpawnRate#(1)=200
EmitterRotx(1)=0
EmitterRoty(1)=2
EmitterRotz(1)=0
EmitterRotX2#(1)=0
EmitterRotY2#(1)=-2
EmitterRotZ2#(1)=0
EmitterRotX3#(1)=0
EmitterRotY3#(1)=-2
EmitterRotZ3#(1)=0
EmitterPitchStart#(1)=0 
EmitterYawStart#(1)=0   
EmitterRollStart#(1)=0 
EmitterSnd1(1)=1
EmitterSnd2(1)=-1
EmitterSoundRepeat(1)=0
EmitterStartLink$(1)="yellowballout"
EmitterKillLink$(1)=""
EmitterMeshID(1)=4
EmitterFX(1)=-1
EmitterDirtLife(1)=1000
EmitterRed(1)=255
EmitterGreen(1)=85
EmitterBlue(1)=4
EmitterRed2(1)=159
EmitterGreen2(1)=20
EmitterBlue2(1)=17
EmitterRed3(1)=200
EmitterGreen3(1)=30
EmitterBlue3(1)=20
EmitterAlpha(1)=.001
Emitteralpha2#(1)=.7
Emitteralpha3#(1)=0
EmitterScalex(1)=.5
EmitterScaley(1)=50
EmitterScalez(1)=.5
EmitterScaleX2(1)=57
EmitterScaleY2(1)=25.0
EmitterScaleZ2(1)=57
EmitterScaleX3(1)=62
EmitterScaleY3(1)=.5
EmitterScaleZ3(1)=62.0
EmitterVelx(1)=0
Emittervely(1)=-.07
EmitterVelz(1)=0
EmitterVelx2(1)=0
Emittervely2(1)=-.06
EmitterVelz2(1)=0
EmitterVelocityDecay#(1)=.99
EmitterGravity#(1)=0
EmitterSuperParent(1)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(2)="yellowballout"
EmitterViewcheck(2)=1
EmitterX#(2)=0
EmitterY#(2)=3
EmitterZ#(2)=0
EmitterAreaX(2)=0
EmitterAreaY(2)=0
EmitterAreaZ(2)=0
EmitterStartDelay(2)=200
EmitterLifeTime(2)=100
EmitterSpawnRate#(2)=200
EmitterRotx(2)=0
EmitterRoty(2)=-5
EmitterRotz(2)=0
EmitterRotX2#(2)=0
EmitterRotY2#(2)=5
EmitterRotZ2#(2)=0
EmitterRotX3#(2)=0
EmitterRotY3#(2)=0
EmitterRotZ3#(2)=0
EmitterPitchStart#(2)=0 
EmitterYawStart#(2)=0   
EmitterRollStart#(2)=0 
EmitterSnd1(2)=-1
EmitterSnd2(2)=-1
EmitterSoundRepeat(2)=0
EmitterStartLink$(2)="smalldirtfly"
EmitterKillLink$(2)=""
EmitterMeshID(2)=1
EmitterFX(2)=-1
EmitterDirtLife(2)=900
EmitterRed(2)=178
EmitterGreen(2)=48
EmitterBlue(2)=14
EmitterRed2(2)=190
EmitterGreen2(2)=70
EmitterBlue2(2)=10
EmitterRed3(2)=200
EmitterGreen3(2)=90
EmitterBlue3(2)=20
Emitteralpha(2)=0
Emitteralpha2(2)=.7
Emitteralpha3#(2)=0
EmitterScalex(2)=.001
EmitterScaley(2)=.001
EmitterScalez(2)=.001
EmitterScaleX2(2)=25
EmitterScaleY2(2)=25
EmitterScaleZ2(2)=25
EmitterScaleX3(2)=50
EmitterScaleY3(2)=.1
EmitterScaleZ3(2)=50
EmitterVelx(2)=0
Emittervely(2)=0
EmitterVelz(2)=0
EmitterVelx2(2)=0
Emittervely2(2)=0
EmitterVelz2(2)=0
EmitterVelocityDecay#(2)=1
EmitterGravity#(2)=0
EmitterSuperParent(2)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(3)="smalldirtfly"
EmitterViewcheck(3)=1
EmitterX#(3)=0
EmitterY#(3)=0
EmitterZ#(3)=0
EmitterAreaX(3)=1
EmitterAreaY(3)=0
EmitterAreaZ(3)=1
EmitterStartDelay(3)=0
EmitterLifeTime(3)=250
EmitterSpawnRate#(3)=0
EmitterRotx(3)=0
EmitterRoty(3)=1
EmitterRotz(3)=0
EmitterRotX2#(3)=0
EmitterRotY2#(3)=2
EmitterRotZ2#(3)=0
EmitterRotX3#(3)=0
EmitterRotY3#(3)=1
EmitterRotZ3#(3)=0
EmitterPitchStart#(3)=0
EmitterYawStart#(3)=999   
EmitterRollStart#(3)=0 
EmitterSnd1(3)=-1
EmitterSnd2(3)=-1
EmitterSoundRepeat(3)=0
EmitterStartLink$(3)=""
EmitterKillLink$(3)=""
EmitterMeshID(3)=15
EmitterFX(3)=-1
EmitterDirtLife(3)=2500
EmitterRed(3)=25
EmitterGreen(3)=20
EmitterBlue(3)=14
EmitterRed2(3)=20
EmitterGreen2(3)=40
EmitterBlue2(3)=30
EmitterRed3(3)=100
EmitterGreen3(3)=100
EmitterBlue3(3)=0
EmitterAlpha(3)=.9
Emitteralpha2(3)=.4
Emitteralpha3#(3)=0
EmitterScalex(3)=10
EmitterScaley(3)=10
EmitterScalez(3)=10
EmitterScaleX2(3)=5
EmitterScaleY2(3)=5
EmitterScaleZ2(3)=5
EmitterScaleX3(3)=1
EmitterScaleY3(3)=1
EmitterScaleZ3(3)=1
EmitterVelx(3)=1.25
Emittervely(3)=.8
EmitterVelz(3)=1.25
EmitterVelx2(3)=-1.25
emittervely2(3)=.9
EmitterVelz2(3)=-1.25
EmitterVelocityDecay#(3)=.94
EmitterGravity#(3)=-.313
EmitterSuperParent(3)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(4)="waterfallfast_blue"
EmitterViewcheck(4)=0
EmitterX#(4)=0
EmitterY#(4)=0
EmitterZ#(4)=0
EmitterAreaX(4)=3
EmitterAreaY(4)=0
EmitterAreaZ(4)=.01
EmitterStartDelay(4)=0
EmitterLifeTime(4)=-1
EmitterSpawnRate#(4)=80
EmitterRotx(4)=0
EmitterRoty(4)=0
EmitterRotz(4)=.1
EmitterRotX2#(4)=0
EmitterRotY2#(4)=0
EmitterRotZ2#(4)=-.02
EmitterRotX3#(4)=0
EmitterRotY3#(4)=0
EmitterRotZ3#(4)=-.1
EmitterPitchStart#(4)=0 
EmitterYawStart#(4)=0   
EmitterRollStart#(4)=0 
EmitterSnd1(4)=0
EmitterSnd2(4)=-1
EmitterSoundRepeat(4)=0
EmitterStartLink$(4)=""
EmitterKillLink$(4)=""
EmitterMeshID(4)=8
EmitterFX(4)=-1
EmitterDirtLife(4)=2500
EmitterRed(4)=0
EmitterGreen(4)=292
EmitterBlue(4)=255

EmitterRed2(4)=99
EmitterGreen2(4)=106
EmitterBlue2(4)=153

EmitterRed3(4)=0
EmitterGreen3(4)=0
EmitterBlue3(4)=255
EmitterAlpha(4)=0
Emitteralpha2(4)=.3
Emitteralpha3#(4)=0
EmitterScalex(4)=10
EmitterScaley(4)=.001
EmitterScalez(4)=1
EmitterScaleX2(4)=15
EmitterScaleY2(4)=100
EmitterScaleZ2(4)=1.25
EmitterScaleX3(4)=20
EmitterScaleY3(4)=210
EmitterScaleZ3(4)=1.5
EmitterVelx(4)=0
Emittervely(4)=-.12
EmitterVelz(4)=-.002
EmitterVelx2(4)=0
emittervely2(4)=-.23
EmitterVelz2(4)=.002
EmitterVelocityDecay#(4)=1.001
EmitterGravity#(4)=-.5
EmitterSuperParent(4)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(5)="esparks"
EmitterViewcheck(5)=1
EmitterX#(5)=0
EmitterY#(5)=0
EmitterZ#(5)=0
EmitterAreaX(5)=0
EmitterAreaY(5)=0
EmitterAreaZ(5)=0
EmitterStartDelay(5)=0
EmitterLifeTime(5)=-1
EmitterSpawnRate#(5)=0
EmitterRotx(5)=2
EmitterRoty(5)=2
EmitterRotz(5)=2
EmitterRotX2#(5)=0
EmitterRotY2#(5)=0
EmitterRotZ2#(5)=0
EmitterRotX3#(5)=-2
EmitterRotY3#(5)=-2
EmitterRotZ3#(5)=-2
EmitterPitchStart#(5)=999
EmitterYawStart#(5)=999   
EmitterRollStart#(5)=999 
EmitterSnd1(5)=-1
EmitterSnd2(5)=-1
EmitterSoundRepeat(5)=0
EmitterStartLink$(5)="eglow"
EmitterKillLink$(5)=""
EmitterMeshID(5)=11
EmitterFX(5)=-1
EmitterDirtLife(5)=500
EmitterRed(5)=255
EmitterGreen(5)=255
EmitterBlue(5)=90
EmitterRed2(5)=255
EmitterGreen2(5)=255
EmitterBlue2(5)=25
EmitterRed3(5)=255
EmitterGreen3(5)=255
EmitterBlue3(4)=40
EmitterAlpha(5)=.5
Emitteralpha2(5)=.4
Emitteralpha3#(5)=0
EmitterScalex(5)=2.1;.1
EmitterScaley(5)=2.1;.1
EmitterScalez(5)=2.1;.1
EmitterScaleX2(5)=2
EmitterScaleY2(5)=2
EmitterScaleZ2(5)=2
EmitterScaleX3(5)=2.1;.1
EmitterScaleY3(5)=2.1;.1
EmitterScaleZ3(5)=2.1;.1
EmitterVelx(5)=0
Emittervely(5)=0
EmitterVelz(5)=0
EmitterVelx2(5)=0
emittervely2(5)=0
EmitterVelz2(5)=0
EmitterVelocityDecay#(5)=1
EmitterGravity#(5)=0
EmitterSuperParent(5)=1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(6)="rainbox"
EmitterViewcheck(6)=0
EmitterX#(6)=0
EmitterY#(6)=0
EmitterZ#(6)=0
EmitterAreaX(6)=5
EmitterAreaY(6)=6
EmitterAreaZ(6)=5
EmitterStartDelay(6)=0
EmitterLifeTime(6)=-1
EmitterSpawnRate#(6)=0
EmitterRotx(6)=0
EmitterRoty(6)=0
EmitterRotz(6)=0
EmitterRotX2#(6)=0
EmitterRotY2#(6)=0
EmitterRotZ2#(6)=0
EmitterRotX3#(6)=0
EmitterRotY3#(6)=0
EmitterRotZ3#(6)=0
EmitterPitchStart#(6)=0 
EmitterYawStart#(6)=0   
EmitterRollStart#(6)=0 
EmitterSnd1(6)=-1
EmitterSnd2(6)=-1
EmitterSoundRepeat(6)=0
EmitterStartLink$(6)=""
EmitterKillLink$(6)=""
EmitterMeshID(6)=8
EmitterFX(6)=-1
EmitterDirtLife(6)=2500
EmitterRed(6)=0
EmitterGreen(6)=20
EmitterBlue(6)=90
EmitterRed2(6)=1
EmitterGreen2(6)=250
EmitterBlue2(6)=250
EmitterRed3(6)=0
EmitterGreen3(6)=20
EmitterAlpha(6)=.5
Emitteralpha2(6)=.6
Emitteralpha3#(6)=.1
EmitterScalex(6)=.4
EmitterScaley(6)=.4
EmitterScalez(6)=.4
EmitterScaleX2(6)=.8
EmitterScaleY2(6)=2.5
EmitterScaleZ2(6)=.8
EmitterScaleX3(6)=1
EmitterScaleY3(6)=2
EmitterScaleZ3(6)=1
EmitterVelx(6)=.01
Emittervely(6)=0
EmitterVelz(6)=.01
EmitterVelx2(6)=-.01
emittervely2(6)=0
EmitterVelz2(6)=-.01
EmitterVelocityDecay#(6)=.999
EmitterGravity#(6)=-.6
EmitterSuperParent(6)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(7)="eglow"
EmitterViewcheck(7)=1
EmitterX#(7)=0
EmitterY#(7)=0
EmitterZ#(7)=0
EmitterAreaX(7)=0
EmitterAreaY(7)=0
EmitterAreaZ(7)=0
EmitterStartDelay(7)=0
EmitterLifeTime(7)=-1
EmitterSpawnRate#(7)=350
EmitterRotx(7)=0
EmitterRoty(7)=0
EmitterRotz(7)=0
EmitterRotX2#(7)=0
EmitterRotY2#(7)=0
EmitterRotZ2#(7)=0
EmitterRotX3#(7)=0
EmitterRotY3#(7)=0
EmitterRotZ3#(7)=0
EmitterPitchStart#(7)=999
EmitterYawStart#(7)=999   
EmitterRollStart#(7)=999 
EmitterSnd1(7)=-1
EmitterSnd2(7)=-1
EmitterSoundRepeat(7)=0
EmitterStartLink$(7)="ehull"
EmitterKillLink$(7)=""
EmitterMeshID(7)=1
EmitterFX(7)=-1
EmitterDirtLife(7)=700
EmitterRed(7)=255
EmitterGreen(7)=255
EmitterBlue(7)=90
EmitterRed2(7)=255
EmitterGreen2(7)=200
EmitterBlue2(7)=55
EmitterRed3(7)=255
EmitterGreen3(7)=255
EmitterBlue3(7)=0
EmitterAlpha(7)=0
Emitteralpha2(7)=.6
Emitteralpha3#(7)=0
EmitterScalex(7)=.5
EmitterScaley(7)=.5
EmitterScalez(7)=.5
EmitterScaleX2(7)=2
EmitterScaleY2(7)=2
EmitterScaleZ2(7)=2
EmitterScaleX3(7)=.5
EmitterScaleY3(7)=.5
EmitterScaleZ3(7)=.5
EmitterVelx(7)=0
Emittervely(7)=0
EmitterVelz(7)=0
EmitterVelx2(7)=0
emittervely2(7)=0
EmitterVelz2(7)=0
EmitterVelocityDecay#(7)=1
EmitterGravity#(7)=0
EmitterSuperParent(7)=1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(8)="rocketsmoke"
EmitterViewcheck(8)=1
EmitterX#(8)=0
EmitterY#(8)=0
EmitterZ#(8)=0
EmitterAreaX(8)=.5
EmitterAreaY(8)=.5
EmitterAreaZ(8)=.5
EmitterStartDelay(8)=0
EmitterLifeTime(8)=-1
EmitterSpawnRate#(8)=0
EmitterRotx(8)=.1
EmitterRoty(8)=2
EmitterRotz(8)=-.1
EmitterRotX2#(8)=-.1
EmitterRotY2#(8)=-2
EmitterRotZ2#(8)=.1
EmitterRotX3#(8)=-.1
EmitterRotY3#(8)=-2
EmitterRotZ3#(8)=.1
EmitterPitchStart#(8)=999 
EmitterYawStart#(8)=999   
EmitterRollStart#(8)=999 
EmitterSnd1(8)=4
EmitterSnd2(8)=-1
EmitterSoundRepeat(8)=1
EmitterStartLink$(8)=""
EmitterKillLink$(8)=""
EmitterMeshID(8)=9
EmitterFX(8)=-1
EmitterDirtLife(8)=800
EmitterRed(8)=2
EmitterGreen(8)=2
EmitterBlue(8)=2
EmitterRed2(8)=50
EmitterGreen2(8)=50
EmitterBlue2(8)=50
EmitterRed3(8)=255
EmitterGreen3(8)=255
EmitterBlue3(8)=255
EmitterAlpha(8)=0
Emitteralpha2(8)=.15
Emitteralpha3#(8)=0
EmitterScalex(8)=3
EmitterScaley(8)=3
EmitterScalez(8)=3
EmitterScaleX2(8)=8
EmitterScaleY2(8)=8
EmitterScaleZ2(8)=8
EmitterScaleX3(8)=.1
EmitterScaleY3(8)=.1
EmitterScaleZ3(8)=.1
EmitterVelx(8)=0
Emittervely(8)=.01
EmitterVelz(8)=0
EmitterVelx2(8)=0
emittervely2(8)=.02
EmitterVelz2(8)=0
EmitterVelocityDecay#(8)=.99
EmitterGravity#(8)=-.005
EmitterSuperParent(8)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(9)="scorchmark"
EmitterViewcheck(9)=0
EmitterX#(9)=0
EmitterY#(9)=0
EmitterZ#(9)=0
EmitterAreaX(9)=0
EmitterAreaY(9)=0
EmitterAreaZ(9)=0
EmitterStartDelay(9)=0
EmitterLifeTime(9)=500
EmitterSpawnRate#(9)=400
EmitterRotx(9)=0
EmitterRoty(9)=0
EmitterRotz(9)=0
EmitterRotX2#(9)=0
EmitterRotY2#(9)=0
EmitterRotZ2#(9)=0
EmitterRotX3#(9)=0
EmitterRotY3#(9)=0
EmitterRotZ3#(9)=0
EmitterPitchStart#(9)=0 
EmitterYawStart#(9)=999   
EmitterRollStart#(9)=0 
EmitterSnd1(9)=-1
EmitterSnd2(9)=-1
EmitterSoundRepeat(9)=0
EmitterStartLink$(9)=""
EmitterKillLink$(9)=""
EmitterMeshID(9)=10
EmitterFX(9)=-1
EmitterDirtLife(9)=2000
EmitterRed(9)=0
EmitterGreen(9)=0
EmitterBlue(9)=0
EmitterRed2(9)=2
EmitterGreen2(9)=2
EmitterBlue2(9)=2
EmitterRed3(9)=5
EmitterGreen3(9)=5
EmitterBlue3(9)=5
EmitterAlpha(9)=.4
Emitteralpha2(9)=.8
Emitteralpha3#(9)=0
EmitterScalex(9)=9
EmitterScaley(9)=1
EmitterScalez(9)=9
EmitterScaleX2(9)=9
EmitterScaleY2(9)=1
EmitterScaleZ2(9)=9
EmitterScaleX3(9)=5
EmitterScaleY3(9)=.2
EmitterScaleZ3(9)=5
EmitterVelx(9)=0
Emittervely(9)=0
EmitterVelz(9)=0
EmitterVelx2(9)=0
emittervely2(9)=0
EmitterVelz2(9)=0
EmitterVelocityDecay#(9)=0
EmitterGravity#(9)=0
EmitterSuperParent(9)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(10)="ehull"
EmitterViewcheck(10)=1
EmitterX#(10)=0
EmitterY#(10)=0
EmitterZ#(10)=0
EmitterAreaX(10)=0
EmitterAreaY(10)=0
EmitterAreaZ(10)=0
EmitterStartDelay(10)=0
EmitterLifeTime(10)=-1
EmitterSpawnRate#(10)=125
EmitterRotx(10)=2
EmitterRoty(10)=2
EmitterRotz(10)=2
EmitterRotX2#(10)=0
EmitterRotY2#(10)=0
EmitterRotZ2#(10)=0
EmitterRotX3#(10)=-2
EmitterRotY3#(10)=-2
EmitterRotZ3#(10)=-2
EmitterPitchStart#(10)=999
EmitterYawStart#(10)=999   
EmitterRollStart#(10)=999 
EmitterSnd1(10)=-1
EmitterSnd2(10)=-1
EmitterSoundRepeat(10)=0
EmitterStartLink$(10)=""
EmitterKillLink$(10)=""
EmitterMeshID(10)=1
EmitterFX(10)=-1
EmitterDirtLife(10)=800
EmitterRed(10)=255
EmitterGreen(10)=255
EmitterBlue(10)=90
EmitterRed2(10)=255
EmitterGreen2(10)=200
EmitterBlue2(10)=255
EmitterRed3(10)=255
EmitterGreen3(10)=255
EmitterBlue3(10)=200
EmitterAlpha(10)=0
Emitteralpha2(10)=.2
Emitteralpha3#(10)=0
EmitterScalex(10)=4
EmitterScaley(10)=4
EmitterScalez(10)=4
EmitterScaleX2(10)=2.5
EmitterScaleY2(10)=2.5
EmitterScaleZ2(10)=2.5
EmitterScaleX3(10)=4
EmitterScaleY3(10)=4
EmitterScaleZ3(10)=4
EmitterVelx(10)=0
Emittervely(10)=0
EmitterVelz(10)=0
EmitterVelx2(10)=0
emittervely2(10)=0
EmitterVelz2(10)=0
EmitterVelocityDecay#(10)=1
EmitterGravity#(10)=0
EmitterSuperParent(10)=1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(11)="torchflame"
EmitterViewcheck(11)=1
EmitterX#(11)=0
EmitterY#(11)=0
EmitterZ#(11)=0
EmitterAreaX(11)=.25
EmitterAreaY(11)=0
EmitterAreaZ(11)=.25
EmitterStartDelay(11)=0
EmitterLifeTime(11)=-1
EmitterSpawnRate#(11)=0
EmitterRotx(11)=-1
EmitterRoty(11)=-2
EmitterRotz(11)=1
EmitterRotX2#(11)=0
EmitterRotY2#(11)=2
EmitterRotZ2#(11)=0
EmitterRotX3#(11)=1
EmitterRotY3#(11)=2
EmitterRotZ3#(11)=-1
EmitterPitchStart#(11)=0
EmitterYawStart#(11)=999   
EmitterRollStart#(11)=0 
EmitterSnd1(11)=2
EmitterSnd2(11)=-1
EmitterSoundRepeat(11)=1
EmitterStartLink$(11)=""
EmitterKillLink$(11)=""
EmitterMeshID(11)=8
EmitterFX(11)=1
EmitterDirtLife(11)=1000
EmitterRed(11)=255
EmitterGreen(11)=255
EmitterBlue(11)=255
EmitterRed2(11)=255
EmitterGreen2(11)=100
EmitterBlue2(11)=10
EmitterRed3(11)=255
EmitterGreen3(11)=50
EmitterBlue3(11)=10
EmitterAlpha(11)=0
Emitteralpha2(11)=.45
Emitteralpha3#(11)=0
EmitterScalex(11)=3
EmitterScaley(11)=.5
EmitterScalez(11)=3
EmitterScaleX2(11)=5
EmitterScaleY2(11)=1
EmitterScaleZ2(11)=5
EmitterScaleX3(11)=1
EmitterScaleY3(11)=3
EmitterScaleZ3(11)=1
EmitterVelx(11)=0
Emittervely(11)=.07
EmitterVelz(11)=0
EmitterVelx2(11)=0
emittervely2(11)=.1
EmitterVelz2(11)=0
EmitterVelocityDecay#(11)=.99
EmitterGravity#(11)=-.015
EmitterSuperParent(11)=1
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(12)="rocketflame"
EmitterViewcheck(12)=1
EmitterX#(12)=0
EmitterY#(12)=0
EmitterZ#(12)=0
EmitterAreaX(12)=.1
EmitterAreaY(12)=0
EmitterAreaZ(12)=.1
EmitterStartDelay(12)=10
EmitterLifeTime(12)=-1
EmitterSpawnRate#(12)=0
EmitterRotx(12)=2.2
EmitterRoty(12)=-4
EmitterRotz(12)=-10
EmitterRotX2#(12)=10
EmitterRotY2#(12)=4
EmitterRotZ2#(12)=-.1
EmitterRotX3#(12)=10
EmitterRotY3#(12)=4
EmitterRotZ3#(12)=-.1
EmitterPitchStart#(12)=20
EmitterYawStart#(12)=999   
EmitterRollStart#(12)=5 
EmitterSnd1(12)=2
EmitterSnd2(12)=-1
EmitterSoundRepeat(12)=1
EmitterStartLink$(12)=""
EmitterKillLink$(12)=""
EmitterMeshID(12)=9
EmitterFX(12)=1
EmitterDirtLife(12)=350
EmitterRed(12)=255
EmitterGreen(12)=50
EmitterBlue(12)=10
EmitterRed2(12)=255
EmitterGreen2(12)=75
EmitterBlue2(12)=20
EmitterRed3(12)=255
EmitterGreen3(12)=200
EmitterBlue3(12)=70
EmitterAlpha(12)=.1
Emitteralpha2(12)=.4
Emitteralpha3#(12)=0
EmitterScalex(12)=4
EmitterScaley(12)=4
EmitterScalez(12)=4
EmitterScaleX2(12)=8
EmitterScaleY2(12)=8
EmitterScaleZ2(12)=8
EmitterScaleX3(12)=2
EmitterScaleY3(12)=2
EmitterScaleZ3(12)=2
EmitterVelx(12)=0
Emittervely(12)=.01
EmitterVelz(12)=0
EmitterVelx2(12)=0
emittervely2(12)=.03
EmitterVelz2(12)=0
EmitterVelocityDecay#(12)=.99
EmitterGravity#(12)=-.015
EmitterSuperParent(12)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(13)="lightning"
EmitterViewcheck(1)=0
EmitterX#(13)=0
EmitterY#(13)=0
EmitterZ#(13)=0
EmitterAreaX(13)=0
EmitterAreaY(13)=0
EmitterAreaZ(13)=0
EmitterStartDelay(13)=0
EmitterLifeTime(13)=110
EmitterSpawnRate#(13)=100
EmitterRotx(13)=0
EmitterRoty(13)=0
EmitterRotz(13)=0
EmitterRotX2#(13)=0
EmitterRotY2#(13)=0
EmitterRotZ2#(13)=0
EmitterRotX3#(13)=0
EmitterRotY3#(13)=0
EmitterRotZ3#(13)=0
EmitterPitchStart#(13)=0 
EmitterYawStart#(13)=0   
EmitterRollStart#(13)=999
EmitterSnd1(13)=-1
EmitterSnd2(13)=-1
EmitterSoundRepeat(13)=0
EmitterStartLink$(13)=""
EmitterKillLink$(13)=""
EmitterMeshID(13)=14
EmitterFX(13)=9
EmitterDirtLife(13)=400
EmitterRed(13)=255
EmitterGreen(13)=255
EmitterBlue(13)=0
EmitterRed2(13)=200
EmitterGreen2(13)=200
EmitterBlue2(13)=10
EmitterRed3(13)=190
EmitterGreen3(13)=190
EmitterBlue3(13)=15
EmitterAlpha(13)=.4
Emitteralpha2(13)=.6
Emitteralpha3#(13)=0
EmitterScalex(13)=80
EmitterScaley(13)=80
EmitterScalez(13)=80
EmitterScaleX2(13)=80
EmitterScaleY2(13)=80
EmitterScaleZ2(13)=80
EmitterScaleX3(13)=80
EmitterScaleY3(13)=80
EmitterScaleZ3(13)=80
EmitterVelx(13)=0
Emittervely(13)=0
EmitterVelz(13)=0
EmitterVelx2(13)=0
emittervely2(13)=0
EmitterVelz2(13)=0
EmitterVelocityDecay#(13)=0
EmitterGravity#(13)=0
EmitterSuperParent(13)=0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
EmitterName$(14)="watermist"
EmitterViewcheck(14)=1
EmitterX#(14)=0
EmitterY#(14)=0
EmitterZ#(14)=0
EmitterAreaX(14)=0
EmitterAreaY(14)=0
EmitterAreaZ(14)=0
EmitterStartDelay(14)=0
EmitterLifeTime(14)=-1
EmitterSpawnRate#(14)=0
EmitterRotx(14)=1
EmitterRoty(14)=2
EmitterRotz(14)=1
EmitterRotX2#(14)=-2
EmitterRotY2#(14)=-2
EmitterRotZ2#(14)=-2
EmitterRotX3#(14)=1
EmitterRotY3#(14)=-2
EmitterRotZ3#(14)=1
EmitterPitchStart#(14)=999 
EmitterYawStart#(14)=999   
EmitterRollStart#(14)=999 
EmitterSnd1(14)=1
EmitterSnd2(14)=-1
EmitterSoundRepeat(14)=0
EmitterStartLink$(14)=""
EmitterKillLink$(14)=""
EmitterMeshID(14)=15
EmitterFX(14)=-1
EmitterDirtLife(14)=1500
EmitterRed(14)=20
EmitterGreen(14)=85
EmitterBlue(14)=200
EmitterRed2(14)=15
EmitterGreen2(14)=60
EmitterBlue2(14)=220
EmitterRed3(14)=255
EmitterGreen3(14)=255
EmitterBlue3(14)=255
EmitterAlpha(14)=0
Emitteralpha2#(14)=.3
Emitteralpha3#(14)=0
EmitterScalex(14)=2
EmitterScaley(14)=2
EmitterScalez(14)=2
EmitterScaleX2(14)=10
EmitterScaleY2(14)=10
EmitterScaleZ2(14)=10
EmitterScaleX3(14)=15
EmitterScaleY3(14)=15
EmitterScaleZ3(14)=15
EmitterVelx(14)=.1
Emittervely(14)=.715
EmitterVelz(14)=-.1
EmitterVelx2(14)=-.04
Emittervely2(14)=.705
EmitterVelz2(14)=-.3
EmitterVelocityDecay#(14)=.97
EmitterGravity#(14)=-.8
EmitterSuperParent(14)=0


;TEST PARTICLE PATH.. sort of a jump thing
.mytestpath
;x,y,z,pitch,yaw,roll  = 16 points.  first point must equal final point for looping seamless

Data 0,0,0,0,0,0
Data 0,0,-5,0,0,0
Data  5, 0, 0,0,0,0
Data  5, 5, -5,0,0,0

Data  5, 10,-5,0,0,0
Data  0, 10,-5,0,0,0
Data -5,10, 5,0,0,0
Data -5,-5, 5,0,0,0

Data  -5, 0, 5,0,0,0
Data  -2, 0, 5,0,0,0
Data 0,0,0,0,0,0
Data 0,0,0,0,0,0

Data 0,0,0,0,0,0
Data 0,0,0,0,0,0
Data 0,0,0,0,0,0
Data 0,0,0,0,0,0
</textarea><br><br>MAIN PARTICLE AND PATH SYSTEM INCLUDE<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;MeshPart.bb

;Mesh based particle system, with real time managed sounds and paths. by Jeff Frazier A.k.a  Rifraf.
;Free to use, but thanks would be nice.  
;If you make improvements please update me Or blitzbasic.com archives.


;------emitter path variables
Global Maxpaths=100

Dim Emitter_Pathx#(16,maxpaths)
Dim Emitter_Pathy#(16,maxpaths)
Dim Emitter_Pathz#(16,maxpaths)
Dim Emitter_PathPitch#(16,maxpaths)
Dim Emitter_PathYaw#(16,maxpaths)
Dim Emitter_PathRoll#(16,maxpaths)
Dim Emitter_PathPoints(maxpaths)
Dim Emitter_PathTravelTime#(Maxpaths)

Type EmitterPath
 Field Ent
 Field x#[16]
 Field y#[16]
 Field z#[16]
 Field Pitch#[16]
 Field Yaw#[16]
 Field Roll#[16]
 Field MaxPoints 
 Field endmethod ;0=repeat 1=ping pong 2=kill emitter
 Field oldplacement,placement
 Field Timer#
 Field traveltime#
 Field globalflag%,movingentity
 Field originalx#,Originaly#,Originalz#
 Field originalpitch#,originalyaw#,originalroll#
 Field PingPongCount   ;RECALIBRATE :  0=NONE , 1=XYZ , 2=PITCH,YAW,ROLL , 3=XYZ &amp; PITCH,YAW,ROLL
 Field ReCalibrate     ;This Flag tells the path system if it should record and 
                       ;recalibrate xyz and pitch,yaw,roll of the entity after each cycle.  
                       ;it defaults to 3.  Somtimes you may not want this to happen depending on
                       ;other things effecting the entity. 
End Type
;--------end declarations for emitter paths.

Global DirtCount=0
Global MaxEmitters=100
Global MaxDirtDraw=2500    ;reduce this for slow systems. 
Global Part_Distance=950   ;reduce this for slow systems.
Global Part_ViewAngle=90   ;cone in front of camera to draw particles (dirt)
Dim EmitterName$(MaxEmitters)
Dim EmitterViewCheck(MaxEmitters)
Dim EmitterX#(MaxEmitters)
Dim EmitterY#(MaxEmitters)
Dim EmitterZ#(MaxEmitters)
Dim EmitterAreaX#(MaxEmitters)
Dim EmitterAreaY#(MaxEmitters)
Dim EmitterAreaZ#(MaxEmitters)
Dim EmitterStartDelay(MaxEmitters)
Dim EmitterLifeTime(MaxEmitters)
Dim EmitterSpawnRate#(MaxEmitters)
Dim EmitterRotx#(MaxEmitters)
Dim EmitterRoty#(MaxEmitters)
Dim EmitterRotz#(MaxEmitters)
Dim EmitterRotx2#(MaxEmitters)
Dim EmitterRoty2#(MaxEmitters)
Dim EmitterRotz2#(MaxEmitters)
Dim EmitterRotx3#(MaxEmitters)
Dim EmitterRoty3#(MaxEmitters)
Dim EmitterRotz3#(MaxEmitters)
Dim EmitterPitchStart#(Maxemitters); 999 for random
Dim EmitterYawStart#(MaxEmitters)  ; 999 for random
Dim EmitterRollStart#(Maxemitters) ; 999 for random
Dim EmitterSnd1(MaxEmitters)
Dim EmitterSnd2(MaxEmitters)
Dim EmitterSoundRepeat(MaxEmitters)
Dim EmitterStartLink$(MaxEmitters) ;Spawn another emitter when this one is created (Do not call same emitter from itself)
Dim EmitterKillLink$(MaxEmitters)  ;Spawn another emitter after this one expires (Do not call same emitter from itself)
Dim EmitterMeshID(MaxEmitters)
Dim EmitterFX(MaxEmitters)
Dim EmitterDirtLife(MaxEmitters)
Dim EmitterRed(MaxEmitters)
Dim EmitterGreen(MaxEmitters)
Dim EmitterBlue(MaxEmitters)
Dim EmitterRed2(MaxEmitters)
Dim EmitterGreen2(MaxEmitters)
Dim EmitterBlue2(MaxEmitters)
Dim EmitterRed3(MaxEmitters)
Dim EmitterBlue3(MaxEmitters)
Dim EmitterGreen3(MaxEmitters)
Dim EmitterAlpha#(MaxEmitters)
Dim EmitterAlpha2#(MaxEmitters)
Dim Emitteralpha3#(MaxEmitters)
Dim EmitterScaleX#(MaxEmitters)
Dim EmitterScaleY#(MaxEmitters)
Dim EmitterScaleZ#(MaxEmitters)
Dim EmitterScaleX2#(MaxEmitters)
Dim EmitterScaleY2#(MaxEmitters)
Dim EmitterScaleZ2#(MaxEmitters)
Dim EmitterScaleX3#(MaxEmitters)
Dim EmitterScaleY3#(MaxEmitters)
Dim EmitterScaleZ3#(MaxEmitters)
Dim EmitterVelx#(MaxEmitters)
Dim EmitterVely#(MaxEmitters)
Dim EmitterVelz#(MaxEmitters)
Dim EmitterVelX2#(MaxEmitters)
Dim EmitterVelY2#(MaxEmitters)
Dim EmitterVelZ2#(MaxEmitters)
Dim EmitterVelocityDecay#(MaxEmitters)
Dim EmitterGravity#(MaxEmitters)
Dim EmitterSuperParent(MaxEmitters)

 
Dim Part_primitive(20) ; adjust this for your needs .. See LoadparticlePrimitives()
Dim Part_Sound(25)     ; adjust this for your needs .. See LoadParticleSounds()
 
Type EmitterKillSound
Field Channel
End Type
 
 
Type DirtParent
Field ent
End Type
 
 
Type Emitter
Field name$
Field creationstate
Field EmitterID
Field EnT
Field SoundChannel
Field TimeLeft#
Field active
Field Parent
Field SpawnRATE#
Field SpawnTimer#
Field StartDelay#
Field Lifetime#
Field SuperParent
Field link1.emitter
Field PitchStart#,YawStart#,Rollstart#

;velocities need to be present in order to modify per emitter from normal 
;to superparent.  Some things like rocket trails will need preset velocities in 
;superparent mode to create the trail, while in normal mode the velocities would be 
;close to nothing, and the movement alone of the parent would create the particle trail
;having these here will prevent users from having to make several near identical
;emitter class DIMs for superparent and normal modes
; See Emitter_SetVelocities()
; SpawnEmitterFast() has a field for superparent 0,1
Field Velx#,Vely#,Velz#
Field Velx2#,Vely2#,Velz2#
Field velocitydecay#
End Type
 
 
Type Dirt
Field ent
Field EmitterID
Field TimeLeft#
Field Lifetime#
Field Cur_red,Cur_Blue,Cur_Green
Field cur_alpha#
Field Cur_Rotx#,Cur_Roty#,Cur_Rotz#
Field Cur_Scalex#,Cur_Scaley#,Cur_Scalez#
Field Cur_Velx#,Cur_Vely#,Cur_Velz#
Field VelocityDecay#
Field Gravity#
End Type
 
 
 
 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


Function Emitter_ScaleEntity(Ent,sx#,sy#,sz#)
Local C,ent2
Local CC=CountChildren(Ent)
ScaleEntity ent,sx,sy,sz
For c=1 To cc
 ent2=GetChild(Ent,c)
 If EntityClass$(ent2)="Pivot" Then ScaleEntity ent2,sx#,sy#,sz#,0
Next
End Function 

Function Emitter_SetVelocities(e.emitter,x#,y#,z#,x2#,y2#,z2#,decay#)
e\velx=x
e\vely=y
e\velz=z
e\velx2=x2
e\vely2=y2
e\velz2=z2
e\velocitydecay#=decay#
End Function 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function Emitter_AddwaitTime(e.emitter,timewait#)
e\startdelay#=E\startdelay+timewait
End Function
 

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function Emitter_ModifyLife(e.emitter,timeadd#)
E\TimeLeft#=E\lifetime#+Timeadd#
End Function 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function Emitter_Rotatexyz(e.emitter,x#,y#,z#)
Local ee.emitter
Linked=True
While linked=True
     RotateEntity E\ent,x,y,z,0
     E\pitchstart=x
     E\yawstart=y
     E\rollstart=z
     If e\link1.emitter&lt;&gt;Null Then
          ee.emitter=e\link1.emitter
          e.emitter=ee.emitter
          Else
          linked=False
     EndIf
Wend
End Function
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function Emitter_Positionxyz(e.emitter,x#,y#,z#)
Local ee.emitter
Linked=True
While linked=True
     PositionEntity E\ent,x,y,z,0
     If e\link1.emitter&lt;&gt;Null Then
          ee.emitter=e\link1.emitter
          e.emitter=ee.emitter
          Else
          linked=False
     EndIf
Wend
End Function
 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function Emitter_AlignToEntity(e.emitter,source)
Local ee.emitter
Linked=True
While linked=True
     e\parent=0
     EntityParent e\ent,0
     PositionEntity e\ent,EntityX(source,1),EntityY(source,1),EntityZ(source,1)
     RotateEntity e\ent,EntityPitch(source,1),EntityYaw(source,1),EntityRoll(source,1)
     e\SUPERPARENT=0
     If e\link1.emitter&lt;&gt;Null Then
          ee.emitter=e\link1.emitter
          e.emitter=ee.emitter
          Else
          linked=False
     EndIf
Wend
End Function


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function SpawnEmitterFast.emitter(name$,x#,y#,z#,parent=0,Superparent=-1,active=1)
Local GameTimer#=MilliSecs()
Local e.emitter
EmitterID=FindEmitterByname(name$)
If EmitterID=-1 Then Return
If x=0 Then x=EmitterX(EmitterID)
If y=0 Then y=EmitterY(EmitterID)
If z=0 Then Z=EmitterZ(EmitterID)
e.emitter=New emitter
If superparent&lt;&gt;-1 Then e\superparent=superparent Else e\SuperParent=EmitterSuperParent(EmitterID)
E\emitterID=EmitterID
E\ENT=CreatePivot()
e\pitchstart=EMITTERPitchstart(EmitterID)
e\rollstart=EmitterRollstart(EmitterID)
e\yawstart=EMitteryawstart(EmitterID)
e\name$=name$
e\parent=parent
e\velx =EmitterVelx(EmitterID)
e\vely =EmitterVely(EmitterID)
e\velz =EmitterVelz(EmitterID)
e\velx2=EmitterVelx2(EmitterID)
e\vely2=EmitterVely2(EmitterID)
e\velz2=EmitterVelz2(EmitterID)
e\velocitydecay#=EmitterVelocityDecay(EmitterID)
If parent&gt;0 Then
     EntityParent e\ent,parent,0
     PositionEntity e\ent,x,y,Z,0
     Else
     PositionEntity e\ent,x,y,z
EndIf
e\lifetime=EmitterLifeTime(EmitterID)
e\active=active
e\startdelay#=MilliSecs()+EmitterStartDelay(EmitterID)
If EmitterStartDelay(EmitterID)&gt;0 Then e\active=-1
e\timeleft#=GameTimer#+EmitterLifeTime(EmitterID)
e\spawnrate#=EmitterSpawnRate(EmitterID)
e\spawntimer#=GameTimer#
If EmitterSnd1(E\EmitterID) &lt;&gt; -1  And e\soundchannel=0 Then
     e\SoundChannel=EmitSound(Part_Sound(EmitterSnd1(E\EmitterID)),e\ent)
EndIf
If EmitterStartLink$(E\EmitterID)&lt;&gt;"" Then
     LinkID=FindEmitterbyname(EmitterStartLink$(E\EmitterID))
     If LinkID&lt;&gt;-1 Then e\link1.emitter=SpawnEmitterFast(EmitterStartLink$(E\EmitterID),x#,y#,z#,parent,superparent)
EndIf
e\creationstate=0
Return e.emitter
End Function

 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function SpawnDirt(E.emitter)
Local KD.DIRT
Local D.DIRT
Local gametimer#=MilliSecs()

;make sure we dont spawn more than the set max amount
;of particles.. if we go over that, we remove the oldest
;particle to allow the newest one to be created.
Dirtcount=DirtCount+1
If DirtCount&gt;MaxDirtDraw Then 
 KD.DIRT=First DIRT
 Dirtcount=Dirtcount-1
 FreeEntity Kd\ent
 Delete Kd
EndIf

D.dirt=New dirt
D\emitterID=E\EmitterID
D\ent=CopyEntity(part_primitive(EmitterMeshID(e\EmitterID)))
D\Cur_Scalex=EmitterScalex(E\EmitterID)
D\Cur_ScaleY=EmitterScaley(E\EmitterID)
D\Cur_ScaleZ=EmitterScalez(E\EmitterID)
If EmitterFX(e\emitterid)&gt;-1 Then EntityFX(D\ENT,EmitterFX(e\emitterid))
If e\superparent Then
     ;we are superparented.. disregard any parent and parent to emitter entity with local flag
     ;superparent will assume the emitter is already parented to any other main entity parent.
     EntityParent d\ent,e\ent,0
     PositionEntity d\ent,Rnd(-EmitterAreaX(e\emitterid),EmitterAreaX(e\emitterid)),Rnd(-EmitterAreaY(e\emitterid),EmitterAreaY(e\emitterid)),Rnd(-EmitterAreaZ(e\emitterid),EmitterAreaZ(e\emitterid)),0
	Else
  If e\parent=0 Then
          ;we are not superparented, and have no parent.. default parent to emitter entity.
          EntityParent d\ent,e\ent,0
          PositionEntity d\ent,Rnd(-EmitterAreaX(e\emitterid),EmitterAreaX(e\emitterid)),Rnd(-EmitterAreaY(e\emitterid),EmitterAreaY(e\emitterid)),Rnd(-EmitterAreaZ(e\emitterid),EmitterAreaZ(e\emitterid)),0
          Else
          ;we have a parent and are not superparented.. we just place the particle on the parent location 
          PositionEntity d\ent,EntityX(E\ent,1)+Rnd(-EmitterAreaX(e\emitterid),EmitterAreaX(e\emitterid)),EntityY(E\ent,1)+Rnd(-EmitterAreaY(e\emitterid),EmitterAreaY(e\emitterid)),EntityZ(E\ent,1)+Rnd(-EmitterAreaZ(e\emitterid),EmitterAreaZ(e\emitterid)),1
	      EndIf 
   
EndIf
D\Cur_Alpha#    =EmitterAlpha(E\EmitterID)
EntityAlpha D\ent,D\cur_alpha#
D\Cur_Red=EmitterRed(e\emitterid)
D\Cur_Green=EmitterGreen(e\emitterid)
D\Cur_Blue=EmitterBlue(e\emitterid)
EntityColor D\ent,d\cur_red,d\cur_green,d\cur_blue

ScaleEntity d\ent,d\cur_scalex,d\cur_scaley,d\Cur_Scalez
D\Cur_VelX=Rnd(E\velx,E\Velx2)
D\Cur_Vely=Rnd(E\vely,E\Vely2)
D\Cur_Velz=Rnd(E\velz,E\Velz2)
D\VelocityDecay#=E\VelocityDecay
D\TimeLeft#=gametimer+EmitterDirtLife(E\EmitterId)
D\lifetime=EmitterDirtLife(E\EmitterId) 
If EmitterPitchStart(E\EmitterID)=999 Then orientx#=Rand(-180,180) Else orientx#=E\PitchStart
If EmitterYawStart(E\EmitterID)=999 Then orienty#=Rand(-180,180)   Else orienty#=E\YawStart
If EmitterRollStart(E\EmitterID)=999 Then orientz#=Rand(-180,180)  Else orientz#=E\RollStart
RotateEntity d\ent,orientx,orienty,orientz
End Function
 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function UpdateEmitters(cament)
Local eks.emitterkillsound
Local e.emitter
Local killflag
Local dirtp.dirtparent

For eks.emitterkillsound=Each emitterkillsound
     If Not ChannelPlaying(eks\channel) Then Delete eks
Next
Local gametimer#=MilliSecs()
For e.emitter=Each emitter
     If e\creationstate=0 Then
          e\timeleft#=Gametimer#+EmitterLifeTime(e\EmitterID)
          e\creationstate=1
     EndIf
     If EmitterStartDelay(e\EmitterID)&gt;0 And E\ACTIVE=-1 Then
          If GAMETIMER#&gt;E\STARTDELAY Then
               E\ACTIVE=1
               e\timeleft#=GameTimer#+EmitterLifeTime(E\EmitterID)
          EndIf
     EndIf
     Killflag=0
     If e\active&gt;-1 Then
          If E\Lifetime&gt;0 And E\TimeLeft#&lt;gametimer#  Then KillFlag=1
          If EmitterSnd1(E\EmitterID)&lt;&gt;-1 And e\soundchannel&lt;&gt;0 And EmitterSoundRepeat(E\EmitterID) &gt;0 Then
               If Not ChannelPlaying(e\soundchannel) Then
                    e\SoundChannel=EmitSound(Part_Sound(EmitterSnd1(E\emitterID)),e\ent)
               EndIf
          EndIf
          If E\SpawnTimer#&lt;gametimer#  Then
               dy#=DeltaYaw(cament,e\ent)
               dp#=DeltaPitch(cament,e\ent)
               If EmitterViewCheck(E\EmitterID)=0 Or ( Abs(dy+dp)&lt;Part_ViewAngle And EntityDistance(cament,e\ent)&lt;part_distance) Then
                    e\spawntimer#=gametimer+e\spawnrate
                    SpawnDirt(E.emitter)
               EndIf
          EndIf
          If e\parent Then
               If GetParent(e\ent)=0 Then Killflag=1
          EndIf
     EndIf
     If Killflag=1 Then KillEmitter(E.emitter)
Next
For dirtp.dirtparent=Each dirtparent
     If CountChildren(dirtp\ent) = 0 Then
          FreeEntity dirtp\ent
          Delete dirtp
     EndIf
Next
End Function
 

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function UpdateDirt()
Local GameTimer#=MilliSecs()
Local d.dirt
Local killflag
Local Pslot1#,Pslot2#,Pslot3#,Pslot4#
Local TimeLeft#,SmallN#
For D.Dirt=Each Dirt
     killflag=0
     If d\timeleft&lt;gametimer Then killflag=1
     TimeLeft#=(d\timeleft-gametimer)/d\lifetime#
     SmallN#=1-timeleft#
     Pslot1#=smalln^3 ;+ 3
     Pslot2#=smalln^2 * timeleft; + 3
     Pslot3#=smalln * timeleft^2
     Pslot4#=timeleft^3
     d\cur_alpha= EmitterAlpha3(d\emitterid) * Pslot1 + 3 * EmitterAlpha2(d\emitterid) * Pslot2# + 3 * EmitterAlpha2(D\emitterid)* Pslot3# + EmitterAlpha(D\EmitterID) * Pslot4#
     d\cur_red  = EmitterRed3(d\emitterid) * Pslot1 + 3 * EmitterRed2(d\emitterid) * Pslot2 + 3 * EmitterRed2(D\emitterid) * Pslot3 + EmitterRed(D\EmitterID) * Pslot4
     d\cur_green= EmitterGreen3(d\emitterid) * Pslot1 + 3 * EmitterGreen2(d\emitterid) * Pslot2 + 3 * EmitterGreen2(D\emitterid) * Pslot3 + EmitterGreen(D\EmitterID) * Pslot4
     d\cur_blue = EmitterBlue3(d\emitterid) * Pslot1 + 3 * EmitterBlue2(d\emitterid) * Pslot3 + 3 * EmitterBlue2(D\emitterid) * Pslot3 + EmitterBlue(D\EmitterID) * Pslot4
     d\cur_rotx#=EmitterRotX3(d\emitterid) * Pslot1 + 3 * EmitterRotX2(d\emitterid) * Pslot2 + 3 * EmitterRotX2(D\emitterid) * Pslot3 + EmitterRotX(D\EmitterID) * Pslot4
     d\cur_roty#=EmitterRotY3(d\emitterid) * Pslot1 + 3 * EmitterRotY2(d\emitterid) * Pslot2 + 3 * EmitterRotY2(D\emitterid) * Pslot3 + EmitterRotY(D\EmitterID) * Pslot4
     d\cur_rotz#=EmitterRotZ3(d\emitterid) * Pslot1 + 3 * EmitterRotZ2(d\emitterid) * Pslot2 + 3 * EmitterRotZ2(D\emitterid) * Pslot3 + EmitterRotZ(D\EmitterID) * Pslot4
     d\cur_scalex=EmitterScaleX3(d\emitterid) * Pslot1 + 3 * EmitterScaleX2(d\emitterid) * Pslot2 + 3 * EmitterScaleX2(D\emitterid) * Pslot3 + EmitterScaleX(D\EmitterID) * Pslot4
     d\cur_scaley=EmitterScaleY3(d\emitterid) * Pslot1 + 3 * EmitterScaleY2(d\emitterid) * Pslot2 + 3 * EmitterScaleY2(D\emitterid) * Pslot3 + EmitterScaleY(D\EmitterID) * Pslot4
     d\cur_scalez=EmitterScaleZ3(d\emitterid) * Pslot1 + 3 * EmitterScaleZ2(d\emitterid) * Pslot2 + 3 * EmitterScaleZ2(D\emitterid) * Pslot3 + EmitterScaleZ(D\EmitterID) * Pslot4
     d\cur_velx#=d\cur_velx#*d\velocitydecay#
     d\cur_vely#=d\cur_vely#*d\velocitydecay#
     d\cur_velz#=d\cur_velz#*d\velocitydecay#
     TurnEntity d\ent,d\cur_rotx,d\Cur_roty,d\cur_rotz
     TranslateEntity d\ent,d\cur_velx,d\cur_vely,d\cur_velz
     TranslateEntity d\ent,0,Emittergravity(d\emitterid),0,1
     EntityAlpha d\ent,d\cur_alpha
     EntityColor d\ent,d\cur_red,d\cur_green,d\cur_blue
     ScaleEntity d\ent,d\cur_scalex,d\cur_scaley,d\cur_scalez
     If killflag=1 Then
          Dirtcount=Dirtcount-1
          FreeEntity d\ent
          Delete d
     EndIf
Next
End Function
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function KillEmitter(ee.emitter)
Local Eks.Emitterkillsound
Local Dirtp.dirtparent
If EmitterSnd2(EE\EmitterID)&lt;&gt;-1 Then
     EKS.EMITTERKILLSOUND=New EMITTERKILLSOUND
     EKS\channel=EmitSound(part_sound(EmitterSnd2(ee\EmitterID)),ee\ent)
EndIf
EntityParent ee\ent,0
ee\parent=0;GetParent(ee\ent)
If EmitterKillLink$(EE\EmitterID)&lt;&gt;"" Then
     SpawnEmitterFast(EmitterKillLink$(EE\EmitterID),EntityX(ee\Ent),EntityY(ee\ent),EntityZ(ee\ent),ee\parent,ee\superparent)
EndIf
;check to see if a path exists for this emitter, and kill it.
killpath ee\ent
If CountChildren(ee\ent) Then
     dirtp.dirtparent=New dirtparent
     dirtp\ent=ee\ent
     Else
   
     FreeEntity ee\ent
EndIf
Delete ee
End Function

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function LoadParticlePrimitives(path$="..\media\particles\")
part_primitive(1)=CreateSphere(3)
part_primitive(2)=CreateCube()
part_primitive(3)=CreateCone(3,True)
PArt_primitive(5)=LoadMesh(path$+"torus_med.3ds")
part_primitive(6)=LoadMesh(path$+"torus_thin.3ds")
part_primitive(4)=LoadMesh(path$+"Torus_fat.3ds")
part_Primitive(7)=LoadMesh(path$+"cylinder.3ds")
part_Primitive(8)=LoadMesh(path$+"shrap.3ds")
part_Primitive(9)=LoadMesh(path$+"puff.3ds")
part_Primitive(10)=LoadMesh(path$+"drop.3ds")
part_Primitive(11)=LoadMesh(path$+"stardec.3ds")
part_Primitive(12)=LoadMesh(path$+"rounddec.3ds")
part_Primitive(13)=LoadMesh(path$+"Log.3ds")
part_Primitive(14)=LoadMesh(path$+"LightN.3ds")
part_Primitive(15)=LoadMesh(path$+"ManyTri.3ds")
part_Primitive(16)=LoadMesh(path$+"ManyRnd.3ds")
For I=1 To 20
     If part_primitive(i) Then
          FitMesh(part_primitive(i),-.5,-.5,-.5,1,1,1,True)
          HideEntity part_primitive(i)
     EndIf
Next
End Function
 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function LoadParticleSounds()
Part_Sound(1)=Load3DSound("..\media\sounds\bigboom.wav")
Part_Sound(2)=Load3DSound("..\media\sounds\fire.wav")
Part_Sound(3)=Load3DSound("..\media\sounds\waterfall.wav")
Part_Sound(4)=Load3DSound("..\media\sounds\RocketFly.wav")
End Function
 
 
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function FindEmitterByname(name$)
For I=1 To MaxEmitters
     If Emittername$(i)=name$ Then Return I
Next
Return -1
End Function


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function FindActiveEmitter.emitter(ent)
Local e.emitter
For e.emitter=Each emitter
    If  E\ent=ent Then Return e.emitter
Next
Return Null
End Function


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;   E M I T T E R     P A T H S           ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

Function ApplyPathToEntity(Ent,pathid,endmethod=0,recalib=3,movingentity=0,DupeCheck=True)
;Local ep.emitterpath
Local i
If dupecheck Then 
	For ep.emitterpath=Each emitterpath
		If ep\ent=ent Then Return -1
	Next
EndIf
ep.emitterpath=New emitterpath
ep\ent=ent
ep\recalibrate=recalib
ep\movingentity=movingentity
;record entities state prior to path execution. we can then recalibrate the entity
;after every path cycle so that we dont slowly wobble off coarse ect.
If GetParent(ENT)&lt;&gt;0 Then ep\GLOBALFLAG=0 Else ep\GLOBALFLAG=1

If ep\globalflag=1 Then  
ep\originalx#=EntityX(ent,ep\Globalflag)
ep\originalY#=EntityY(ent,ep\Globalflag)
ep\originalZ#=EntityZ(ent,ep\GLOBALFLAG)
ep\originalPitch#=EntityPitch(ent,ep\GLOBALFLAG)
ep\originalYaw#=EntityYaw(ent,ep\GLOBALFLAG)
ep\originalRoll#=EntityRoll(ent,ep\GLOBALFLAG)
Else
EndIf
ep\pingpongcount=0
For I=1 To 16
 ep\x#[i]     =emitter_pathx(i,pathid)
 ep\y#[i]     =emitter_pathy(i,pathid)
 ep\z#[i]     =emitter_pathz(i,pathid)
 ep\pitch#[i] =emitter_pathpitch(i,pathid)
 ep\yaw#[i]   =emitter_pathyaw(i,pathid)
 ep\roll#[i]  =emitter_pathroll(i,pathid)
 ep\maxpoints =emitter_pathpoints(pathid)
 ep\endmethod =endmethod
 ep\placement=1
 ep\oldplacement=0
 ep\traveltime#=emitter_pathtraveltime#(pathid)
Next                                       
End Function 

Function KillPath(Ent)
Local p.emitterpath
For p.emitterpath=Each emitterpath
	If p\ent=ent Delete p
Next
End Function 

Function Updatepaths()
;Paths by Jeff Frazier, aka Rifraf. AGAIN a thanks to StevieG for pointing out some basic interpolate math.

;Simple Path for any entity.  You must make sure you free a path when you destroy entities that have a path
;assigned to them. See Killpath() 
;Paths do Not check For entity existing Before they try to work it out. so you can MAV If 
;you dont manage entity deletion where paths are concerned.

Local gametimer#=MilliSecs()
Local TimeLeft#,SmallN#,Pslot1#,Pslot2#,Pslot3#,Pslot4#
Local curx#,cury#,curz#,curpitch#,curyaw#,curroll#
Local i,startp,index

;--
For P.emitterpath=Each emitterpath

;--
	If p\placement&lt;&gt;p\oldplacement Then
    	p\timer#=gametimer#+p\traveltime
		p\oldplacement=p\placement
    EndIf
;--
     TimeLeft#=((p\timer-gametimer)/p\traveltime#) 
     
     SmallN#=1-timeleft#                                                ;if max movement points is not a multiple of 4 you will
     Pslot1#=smalln^3 ;                                                 ;get odd timing results. 
     Pslot2#=smalln^2 * timeleft 
     Pslot3#=smalln * timeleft^2
     Pslot4#=timeleft^3
     ;determine wich path mark we are on
     curx#= p\x[p\placement+3] * Pslot1 + 3 * p\x[p\placement+2] * Pslot2# + 3 * p\x[p\placement+1]* Pslot3# + p\x[p\placement] * Pslot4#
     cury#= p\y[p\placement+3] * Pslot1 + 3 * p\y[p\placement+2] * Pslot2# + 3 * p\y[p\placement+1]* Pslot3# + p\y[p\placement] * Pslot4#
     curz#= p\z[p\placement+3] * Pslot1 + 3 * p\z[p\placement+2] * Pslot2# + 3 * p\z[p\placement+1]* Pslot3# + p\z[p\placement] * Pslot4#
     curpitch#= p\pitch[p\placement+3] * Pslot1 + 3 * p\pitch[p\placement+2] * Pslot2# + 3 * p\pitch[p\placement+1]* Pslot3# + p\pitch[p\placement] * Pslot4#
     curyaw#  = p\yaw[p\placement+3] *   Pslot1 + 3 * p\yaw[p\placement+2] * Pslot2# + 3 * p\yaw[p\placement+1]* Pslot3# + p\yaw[p\placement] * Pslot4#
     curroll# = p\roll[p\placement+3] *  Pslot1 + 3 * p\roll[p\placement+2] * Pslot2# + 3 * p\roll[p\placement+1]* Pslot3# + p\roll[p\placement] * Pslot4#
     
 
   If p\movingentity Then 
      If p\globalflag=0 Then 
   		   	PositionEntity p\ent,Curx,cury,curz,0 
   			Else
     		TranslateEntity p\ent,curx*.2,cury*.2,curz*.2 
        EndIf
   Else                                             
		If p\globalflag=0 Then 
   		   	PositionEntity p\ent,Curx,cury,curz,0
   			Else
   			PositionEntity p\ent,p\originalx+Curx,p\originaly+cury,p\originalz+curz,0
   		EndIf 
  EndIf
        TurnEntity P\ent,Curpitch,curyaw,curroll,0
		If timeleft#=&lt;.01 Then 
			
		p\placement=p\placement + 3
			If p\placement&gt;=p\maxpoints Then
			P\placement=1
			Select p\endmethod
				Case 0 ;REPEAT
				If p\recalibrate &gt;=1 Then PositionEntity P\ent,p\originalx,p\originaly,p\originalz,globalflag
				If p\recalibrate =&gt;2 Then RotateEntity p\ent,p\originalpitch,p\originalyaw,p\originalroll,globalflag
				Case 1 ;Ping Pong
				Path_Reverse(P.emitterPath)
				p\pingpongcount=p\pingpongcount+1
				;if we are on our way back to the origin, we want to calibrate the states of the entity
				If p\pingpongcount=2 Then 
					p\pingpongcount=0
					If p\recalibrate &gt;=1 Then PositionEntity P\ent,p\originalx,p\originaly,p\originalz,globalflag
					If p\recalibrate =&gt;2 Then RotateEntity p\ent,p\originalpitch,p\originalyaw,p\originalroll,globalflag
				EndIf     
				Case 2 ;kill emitter,
				 pk.emitter=FindActiveEmitter(pk\ent)
                 If pk&lt;&gt;Null Then Killemitter(pk.emitter)
			End Select
			EndIf
		EndIf
     Next  


End Function


Function Path_Reverse(p.emitterpath)
; note to self: - update later
; im sure theres a better way to do this. but this will work for now.
Local tempa#,Tempb,i
Tempb=p\maxpoints
oldp=p\y[2]
For I=1 To p\maxpoints/2
tempa#=p\x[i]
p\x[i]=p\x[tempb]
p\x[tempb]=tempa#
;
tempa#=p\y[i]
p\y[i]=p\y[tempb]
p\y[tempb]=tempa#
;
tempa#=p\z[i]
p\z[i]=p\z[tempb]
p\z[tempb]=tempa#
;
tempa#=p\pitch[i]
p\pitch[i]=p\pitch[tempb]
p\pitch[tempb]=tempa#
;
tempa#=p\yaw[i]
p\yaw[i]=p\yaw[tempb]
p\yaw[tempb]=tempa#
;
tempa#=p\roll[i]
p\roll[i]=p\roll[tempb]
p\roll[tempb]=tempa#
;
tempb=tempb-1
Next
neww=p\y[2]
End Function 
</textarea><br><br><br>CODE TO TEST IT ALL<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;test Mesh Particles, and paths sytem.  

Graphics3D 1024,768
Include "meshpart.bb"
Include "tween.bb"
Include "particlevalues.bb"
LoadParticlePrimitives()
LoadParticleSounds()

; --------------------------------------------
; TEST MESH BASED PARTICLE SYSTEM BY RIFRAF
;--------------------------------------------
Global Lightning_FlashTimer#

Const Rocket_col=1
Const Land_col=2
Collisions Rocket_col,Land_Col,2,2

Global RocketStartPiv=CreatePivot()
Type Rocket
 Field Parent ; we need an extra parent so we can apply a path to the cannon ball entity/mesh.
 Field Ent    ;if the mesh were the main parent, the path would interfere with the trajectory
 Field Power
 Field Velocity#
 Field lifetimer#
End Type

TestLight=CreateLight()
AmbientLight 90,90,90
RotateEntity TestLight,0,0,30
LightColor TestLight,155,155,155

Global cam=CreateCamera()

Mic=CreateListener (Cam,.5,5,.5)

CameraClsColor cam , 10,20,20
PositionEntity cam,53,13,-103
EntityType cam,rocket_col
CameraZoom cam,1.0
EntityRadius cam,5
CameraFogMode cam,False
CameraFogRange cam,100,225
CameraFogColor cam,25,100,160

spawnemitterfast("waterfallfast_blue",-10,105,31.8)
spawnemitterfast("watermist",-10,101,32.5)
spawnemitterfast("torchflame",-163.5,2,-20.5)
spawnemitterfast("torchflame",-163.5,2,12)

;simple parent/path connections. Will turn with parent pivot
;and also move with the path
Global SparkPivot=CreatePivot()

;parent for spark and one flame emitter.
PositionEntity SparkPivot,34.24,2,-66.4
;apply a path to this parent
applypathtoentity(sparkpivot,1,0,0,0)
;now apply some emitters to the parent as well
;this flame is NOT superparented.  Notice how it trails.
fl2.emitter=spawnemitterfast("torchflame",0,1,0,SparkPivot,0) ;notice when we call aparent we use local offsets.
spark.emitter=spawnemitterfast("esparks",0,0,5,SparkPivot,1)
applypathtoentity(sparkpivot,1,0,0,0)


;another flame.. This one is superparent so you can see the differnce
fl.emitter=spawnemitterfast("torchflame" ,34.24, 2,-99.9,0,1)
applypathtoentity(fl\ent,1,0,1)

Global rain1.emitter=spawnemitterfast("rainbox",0,0,0)


;load the test scene
scene=LoadMesh("..\media\particles\test_scene.3ds")
EntityType scene,Land_Col

;-- TEST VALUES


While Not KeyDown(1)
    Checktween()
    RenderWorld(frametween)
    Text 10,10,"Mesh Particles = "+dirtcount 
    Text 10,90,"Press Space to fire"
    Flip
Wend



Function updategame()
;camera gravity
TranslateEntity cam,0,-1,0
;Simple pivot parent on the spark effect.. turn pivot
;notice the spark effect does not create a "trail" like the
;smoke and fire on the rockets as it moves. This is because the
;spark effect has the superparent flag set to 1.  Wich makes the
;individual particles locally spawn with the parent.
TurnEntity SparkPivot,0,1.6,0
;PointEntity cam,sparkpivot
mouselook(cam)
;randomly spawn the lightning emitter in the sky
If Rand(1,200)&lt;2 Then
    spawnemitterfast("lightning",Rand(-120,300),Rand(200,240),Rand(-50,200))
    renewlflash
EndIf
;put rainbox emitter just in front of camera
PositionEntity rain1\ent,EntityX(Cam),EntityY(cam)+4,EntityZ(cam)
RotateEntity rain1\ent,0,EntityYaw(cam),0:MoveEntity rain1\ent,0,0,6
;random mountain rocket.. no path
If Rand(0,500)&lt;2 Then
    r.rocket=TurretFire(-10,120,33,Rand(-45,-60)-20,Rand(-180,180),0,2.5)
 	rflame.emitter=spawnemitterfast("rocketflame",0,0,0,r\ent,0)
	rsmoke.emitter=spawnemitterfast("rocketsmoke",0,0,0,r\ent,0)
EndIf
;fire rocket add path
If KeyHit(57) Then  
    r.rocket=TurretFire(EntityX(Cam),EntityY(cam),EntityZ(Cam),EntityPitch(cam)-20,EntityYaw(cam),EntityRoll(cam),4)
	rflame.emitter=spawnemitterfast("rocketflame",0,0,0,r\ent,0)
	rsmoke.emitter=spawnemitterfast("rocketsmoke",0,0,0,r\ent,0)
    applypathtoentity(r\ent,1,1,1,1)
EndIf
updatelflash()
updatepaths()
updateemitters(cam)
updatedirt()
updaterockets()
End Function 


Function Updaterockets()
For r.rocket=Each rocket
Cc=CountCollisions(r\parent)
	MoveEntity r\parent,0,0,r\Velocity
    TranslateEntity r\parent,0,-.9,0,0 ; was -.9
   TurnEntity r\parent,.5,0,0
    r\velocity=r\velocity*.99
    If r\velocity&lt;.05 Then r\velocity=.05
    If EntityY(r\parent)&lt;-100 Then 
     For cc= CountChildren(r\parent) To 1 Step -1
	 	EntityParent (GetChild (r\parent,cc),0)
     Next  
     killpath(r\ent)
     FreeEntity r\parent
     Delete r
    EndIf


   If cc &gt;0 Then   
     nxx#=CollisionNX(r\parent,1)
     nyy#=CollisionNY(r\parent,1)
     nzz#=CollisionNZ(r\parent,1)
;we have two options. we can use a pivot and copy its alignment for the emitter. or we
;can use the rocket parent entity itself and copy its alignment.  If your emitter is a superparent type
;then you wont want to use the rocket itself because when you rotate it to the ground impact.. the entire
;emitter will rotate including all particles and velocities.. so you only would want to use the parent as
;the reference if it had the superparent flag set to 0
     PositionEntity rocketstartpiv,EntityX(r\parent),EntityY(r\parent),EntityZ(r\parent),0
  	 AlignToVector rocketstartpiv,nxx#,nyy#,nzz#,2,1
;rocket explosions show how to align effects with a vector or entity orientation
     e1.emitter=spawnemitterfast("redringout",EntityX(r\parent),EntityY(r\parent),EntityZ(r\parent),r\parent,0)
     e2.emitter=spawnemitterfast("scorchmark",EntityX(r\parent),EntityY(r\parent),EntityZ(r\parent),r\parent,0)
     Emitter_AlignToEntity(e1.emitter,rocketstartpiv);EntityPitch(r\ent),EntityYaw(r\ent),EntityRoll(r\ent)) 
     Emitter_AlignToEntity(e2.emitter,rocketstartpiv);EntityPitch(r\ent),EntityYaw(r\ent),EntityRoll(r\ent))  
;anytime you use an entity for a parent to an emitter. you must remove all its children in reverse when
;you destroy the entity, this will allow the particle system to know the parent is gone.
     ;detach the children of the cannonball entity so the emitters will see the parent is gone.
  
     For cc= CountChildren(r\ent) To 1 Step -1
	 	EntityParent (GetChild (r\ent,cc),0)
     Next  
     killpath(r\ent)
     FreeEntity r\parent
     Delete r
     EndIf

Next
End Function 




;Control
;Camera position, angle values
Global cam_x#,cam_z#,cam_pitch#,cam_yaw#,cam_speed#=.5		; Current
Global dest_cam_x#,dest_cam_z#,dest_cam_pitch#,dest_cam_yaw#	; Destination
Global ent_x#,ent_z#,ent_pitch#,ent_yaw#,ent_speed#=.5		; Current
Global dest_ent_x#,dest_ent_z#,dest_ent_pitch#,dest_ent_yaw#	; Destination
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;         F U N C T I O N          ;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function mouselook(camera)

If MouseDown(1) Then MoveEntity camera,0,0,.505
If MouseDown(2) Then MoveEntity camera,0,0,-.505
; Mouse look
; ----------
; Mouse x and y speed
mxs#=MouseXSpeed()
mys#=MouseYSpeed()
If Abs(mxs)&gt;30 Or Abs(mys)&gt;30 Then
     mxs=5
     mys=5
     EndIf
; Destination camera angle x and y values
dest_cam_yaw#=dest_cam_yaw#-mxs
dest_cam_pitch#=dest_cam_pitch#+mys
; Current camera angle x and y values
cam_yaw=cam_yaw+((dest_cam_yaw-cam_yaw)/5)
cam_pitch=cam_pitch+((dest_cam_pitch-cam_pitch)/5)
RotateEntity camera,cam_pitch#,cam_yaw#,0
;RotateEntity camera,mxs,mys,0
; Rest mouse position to centre of screen
MoveMouse 512,375
; Move camera using movement values
MoveEntity camera,x#,y#,z#
End Function

Function TurretFire.rocket(px#,py#,pz#,pit#,yaw#,roll#,power#=5)
;THIS SHOULD BE CALLED WHEN NET COMMAND IS RECEIVED FROM SERVER. not at keypress
;local fire press should send fire data to server only.  
r.rocket=New rocket
;need to add mesh determination and velocity by tanks weapon type : later
r\velocity=power
r\ent=CreateSphere(4)
r\parent=CreatePivot()
EntityParent r\ent,r\parent
EntityRadius r\parent,2
EntityColor r\ent,0,0,0
PositionEntity r\parent,px,py,pz,1
RotateEntity r\parent,pit,yaw,roll,1
EntityType r\parent,rocket_col
EntityType r\ent,0
Return R.ROCKET
End Function 


Function RenewLFlash()
If Lightning_Flashtimer#&lt;MilliSecs() Then Lightning_FlashTimer#=MilliSecs()+200
End Function 

Function UpdateLFlash()
     TimeLeft#=Lightning_FlashTimer#-MilliSecs()
     SmallN#=1-timeleft#
     Pslot1#=smalln^3 ;+ 3
     Pslot2#=smalln^2 * timeleft; + 3
     Pslot3#=smalln * timeleft^2
     Pslot4#=timeleft^3
     cur_amb =100 * Pslot1 + 3 * 155 * Pslot2# + 3 * 200* Pslot3# + 255 * Pslot4#
     If cur_amb&lt;90 Then cur_amb=90
     AmbientLight cur_amb,cur_amb,cur_amb 
End Function 
</textarea> <br><br></td></tr></table><br>
<a name="945945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice. I like the waterfall effect.  Will need to check out the code when I get the chance. <br><br></td></tr></table><br>
<a name="945960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Woa!!. Very very nice. Thx<br>The perfect complement to this<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1095" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1095</a><br><br>JP <br><br></td></tr></table><br>
<a name="945994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. <br><br>  I have to confess I didnt spend much time or effort on setting up elaborate or visually impressive effects, instead its all just test data for the sytems proper function..   ill try to make a few more presets to show off some better visuals if I can get the energy to do that.<br><br>It really needs a preset edtior. <br><br></td></tr></table><br>
<a name="946758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do not worry. The examples are easy to understand. Thx again ;-)<br><br>JP <br><br></td></tr></table><br>
<a name="946824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> RifRaf, very interesting lib, I liked the look of the projectiles in your initial imagery. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
