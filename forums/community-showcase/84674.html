<!DOCTYPE html><html lang="en" ><head ><title >a small fluid engine demo/test</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >a small fluid engine demo/test</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >a small fluid engine demo/test</a><br><br>
<a name="956839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br><br>I decided to experiment a little with fluid dynamics just to keep my creative juices flowing before I start on my fluid engine so here is a little demo.  :) enjoy<br><br>Controls:<br>LMB - create water particles (limit of 1,000)<br>RMB - attract particles to mouse (use short taps to keep system from getting over entergetic and exploding)<br>V - show velocity vector and turn off light blended particle mode<br><br><a href="http://nathansfiles.synthasite.com/resources/fluid%20test.zip" target="_blank">DOWNLOAD HERE</a><br><br>screenshot:<br><br><img src="http://nathansfiles.synthasite.com/resources/fluidenginesc.png"><br><br>--------------------------------------------------------- <br><br></td></tr></table><br>
<a name="956858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wiebo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Behaves cool but doesn't look like a fluid at all. How are you going to solve that? <br><br></td></tr></table><br>
<a name="956862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What Wiebo said.. It doesn't behave much like a fluid. <br><br></td></tr></table><br>
<a name="956884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @wiebo in what way?  It behaves pretty fluidy to me... I do have the 'stickyness' factor pretty high though<br><br>This is NOT the engine, just something I threw together completely seperately.<br><br>Oh were yall talking about the rendering of it?  that is just a bunch of light blended sprites.  The rendering is going to be up to the user. <br><br></td></tr></table><br>
<a name="956987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> For a real fluid feel to things, do some research on Navier-Stokes.<br><br>edit: removed example. <br><br></td></tr></table><br>
<a name="956991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Oh were yall talking about the rendering of it? that is just a bunch of light blended sprites. The rendering is going to be up to the user. <br></div>Somewhat, but not really what I was referring to. <br><br></td></tr></table><br>
<a name="957009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok so whats wrong with it?  I really dont understand... and pongo I am going for a position-verlet based not grid based but thanks for that anyway it is certainly very interesting.  I have posted on other forums and they really love it and say it is really realistic and all and I just don't get what yall think is wrong with it.  Please be more specific about the problems and ill change it, but from watching vids on youtube, it looks like mine is about like a lot of the particle based ones on there although it is not as fast yet.<br><br>when I am in velocity vector view mode, I see all the things a fluid actually does, pressure waves, rolling, spirals and vortecies when waves crash, etc... maybe it is my crappy fluid rendering skills that make people on this forum dislike it?  I am not attacking anyone, I just dont get why this post was so negative... how about a fresh start on this...<br><br>so what exactly doesnt look realistic about how the fluid acts?  I am not talking about the rendering. here <br><br></td></tr></table><br>
<a name="957013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's not enough surface tension. It explodes far too readily - particles seemed to fly straight apart when colliding, and don't look like they stick together unless they have to. I don't know anything about whether this is accurate behaviour, but it doesn't <i>look</i> accurate. Probably if there were more, smaller, particles, the model would be correct, but the big particles make the apparent lack of surface tension stand out. It also looks like the particles move through each other or at least are able to move straight through large masses without being stopped - I would have thought there should be some kind of interaction with the surface? <br><br></td></tr></table><br>
<a name="957015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok thanks Yasha.  I'll try to add a bit of surface tension <br><br></td></tr></table><br>
<a name="957017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Probably if there were more, smaller, particles, the model would be correct, but the big particles make the apparent lack of surface tension stand out. <br></div>Aye. The particle image used in the demo kind of cloud the feel of it.<br><br>Once you get that small it really needs to have some sort of render-merging to make it look like a proper liquid. I would also note that it doesn't seem like the fluid groups together - or even tries.<br><br>This is a prime example:<br><a href="http://www.youtube.com/watch?v=9EbsMtEv2CE" target="_blank">http://www.youtube.com/watch?v=9EbsMtEv2CE</a> <br><br></td></tr></table><br>
<a name="957021"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Aye. The particle image used in the demo kind of cloud the feel of it.<br><br>Once you get that small it really needs to have some sort of render-merging to make it look like a proper liquid. I would also note that it doesn't seem like the fluid groups together - or even tries.<br><br> <br></div><br><br>thanks. yeah I just thought that was the best image... I have no idea how to do any other type of rendering and I just increased the surface tension and it sticks together now very well I might add, but it makes it a bit less stable.. ill try to mess around with the attraction/repulsion settings.. maybe I should have 2 different types of fluid to demonstrate some of the surface tension that is hard to see in this demo?  anyway this has a long way to go so thanks for the constructive criticism<br><br>That youtube vid is amazing but they must be using GPU acceleration which blitz max can't do unfortunately... can it?<br><br><div class="quote"> It also looks like the particles move through each other or at least are able to move straight through large masses without being stopped - I would have thought there should be some kind of interaction with the surface? <br> <br></div><br><br>this test is based solely on particles, and is not surface-based so if a particle is moving too fast, it will go straight over a few particles and end up on the wrong side of the next, accelerating it.. so just don't have high speed water in a game? lol but I see what your saying and it is a problem with any particle-based fluids moving at high speeds <br><br></td></tr></table><br>
<a name="957023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> That youtube vid is amazing but they must be using GPU acceleration which blitz max can't do unfortunately... can it? <br></div>Anything is possible - if any C based language can do it, Max certainly can (but don't expect it to be easy).<br><br>I believe the game in the video is for the PS3. <br><br></td></tr></table><br>
<a name="957024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm maybe ill post in the blitz max section about GPU acceleration... maybe it is built in to the threading?<br><br>that reminds me!  I need to get around to threading this! <br><br></td></tr></table><br>
<a name="957025"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> hmm maybe ill post in the blitz max section about GPU acceleration... maybe it is built in to the threading? <br></div>I doubt that. <br><br></td></tr></table><br>
<a name="957027"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't be too put off by the criticism,... it's just that it still needs to have some stuff done before it will start to look convincing.<br><br>Here are a few things I would suggest.<br>- It's all really "floaty". This may be a personal thing, but almost all physics engines seem to operate in low gravity, and this certainly does that as well.<br><br>- The rendering of the particles isn't working in that it is all soft and mushy. You may want to run a threshold filter over everything so that you get a metaballs feel to everything. That will help hold things together a bit better and shapes will appear to absorb into each other better.<br><br>- More particles, smaller particles. Obviously you'll run out of CPU at some point, but it needs more IMO. <br><br></td></tr></table><br>
<a name="957030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Don't be too put off by the criticism,... it's just that it still needs to have some stuff done before it will start to look convincing.<br> <br></div><br><br>I tried to imply that it is far from complete. I guess I wasnt successful. :)<br><br>about the floatyness. well if that seems to be the case for all physics engines, I dont see a problem. :) I think its because high gravity in a physics environment tends to be hard to deal with, ie particles get too much energy from too hard a fall and go through everything in the scene<br><br>for the second dash - I dont know how to make a threshold filter... ill google it but from one or two I have seen, they look nice but can be really slow for such a big screen size<br><br><br>I definitely agree more particles and smaller particles but I have run out of cpu cuz my cpu right now is really slow and 1000 is all it can handle. <br><br>again thanks for the suggestions <br><br></td></tr></table><br>
<a name="957051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> By threshold, I simply mean to check the pixel values if they are above/below a value, and use that to generate a new image. Example in this thread. <a href="http://www.blitzbasic.com/Community/posts.php?topic=79767#895707" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=79767#895707</a><br><br>As for the physics being wrong and acceptable because everyone is doing it,... let me step on a soap box for a second here.<br><br>Why? ,... why accept something that does not look right when you have the power to fix it? Following along with the floaty stuff makes you the same as everyone else, including a ton of large developers. The thing is though, it's still wrong. If you take the extra time to get it right, it will stand out as being correct in a sea of mediocre simulations.<br><br>I don't mean to be all preachy here, I'm just trying to get you to push yourself harder. You say that 1000 particles is all you can do, but I challenge you to find out why it is that low. Is it the draw-time? In that case, calculate more particles, but come up with a more efficient way of displaying them. Is it the physics calculations? Try better algorithms that don't have to calculate as much.<br><br>When I first built my particle engine, I was getting slowdowns at around 500 particles, but after re-coding to a single-surface system, I was able to move up to about 20,000 particles with the same performance.  That's a huge increase in performance for very little work. If I would have settled with the 500 particles, I would have been selling my game short by a large margin. <br><br></td></tr></table><br>
<a name="957053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> pongo I was just kidding about not seeing a problem.  it was sarcasm!  ahh the downfall of forums as opposed to real life.  of course I plan to make better gravity<br><br>I really love this project I am working with though and it is made in bmax so I dont think I can do that single surface stuff but I will still look into optimizing stuff.<br><br>how on earth did you get 20,000 particles in blitz 3d!?! (rhetorical question) edit: was this a physics engine or just a particle system?<br><br>I am multithreading it right now and seeing pretty nice although minor increases in speed.  maybe if I can harness the GPU by interfacing with c?<br><br>thanks for the link! I remember that conversation now! it was sooo long ago though I had forgotten, but I'll have to experiment with it's speed for a while before I can know if it is fast enough to use. <br><br></td></tr></table><br>
<a name="957057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok so I racked it up almost double! to 1800! on a dual core.. anyone have a quad core to test it on?  and I forgot to implement a shifted grid too.. oops.. maybe once I do that, I can get ~4000 :)  I have still yet to try using some kind of threshold renderer.. I may upload it tomorrow <br><br></td></tr></table><br>
<a name="957059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh,... well in that case you forgot the :)<br><br>20,000 particles,... just dumb particles,... no physics on those, but I was able to transform (rotate/scale/move) each individually and maintain framerate. They were also drawn quite small on the screen to achieve this, but it was really a stress test only. As they got larger, fill rate issues begin to cause trouble. Real game use rarely exceeded 4-5000 particles at any one time.<br><br>Anyways, the point was that optimizations can go pretty far with some of this stuff. If you are limited to 1000 physics particles, then I would try to have those particles drive the motion of "dumb" particles.<br><br>And yea, the threshold thing is pretty slow. I don't use BMax, but I would guess it's faster than b3d for that though. <br><br></td></tr></table><br>
<a name="957065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was gunna say if you got 20,000 physics particles thats simply unbelievable! 20,000 dumb particles is still quite an accomplishment.  I never had a use for that many so I never single surfaced any of my particle systems... come to think of it, I probably should go back and do that. :) later<br><br>What do you mean they drive the motion of dumb particles?<br><br>and rendering is the least of my worries... perhaps I will leave it out of further demos to prevent dissapointment? lol <br><br></td></tr></table><br>
<a name="957068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I mean by "smart" or "dumb" particles is this.<br><br>The smart ones have a full physics applied to them, the dumb ones simply grab the calculated values from a nearby smart one and go with the flow. It's just a way to cut down actual calculations.<br><br>I would probably try to do this by setting up an array of vectors, as big (detailed) as I could get away with. Then I would just have the particles refer to the vector field to figure out how they should move. <br><br></td></tr></table><br>
<a name="957072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh I see.. so you are talking about a grid-particle hybrid? nice idea ill have to test it... I think GPU acceleration will be enough that optimizations like that will have no effect but GPU acceleration isnt cross platform so I'm not sure about using it for the final engine.  I'll definitely give your idea a try. perhaps I could have two arrays.. one for smart and one for dumb.. and they would alternate every frame? <br><br></td></tr></table><br>
<a name="957073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I think GPU acceleration will be enough that optimizations like that will have no effect <br></div>Keep in mind that you probably can't just use Cuda, OpenCL or such right out of the box - it may only work on certain cards. <br><br></td></tr></table><br>
<a name="957076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Keep in mind that you probably can't just use Cuda, OpenCL or such right out of the box - it may only work on certain cards. <br> <br></div><br><br>keep reading after where you quoted me<br><br><div class="quote"> but GPU acceleration isnt cross platform so I'm not sure about using it for the final engine <br></div><br><br>so I will try it out but its not likely that it will work out, in fact I just found out Cuda doesnt work on my machine so I'll just leave GPU acceleration alone for now <br><br></td></tr></table><br>
<a name="957077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> keep reading after where you quoted me <br></div>You did not say anything about using the GPU for calculations might not work pertaining to a particular card, but only that it is not cross-platform. <br><br></td></tr></table><br>
<a name="957090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xzider</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool effect.<br><br>Remind me of a flood fill game made in flash...Anyone have a link to one? <br><br></td></tr></table><br>
<a name="957159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks xzider<br><br>@plash - ok well I guess I wasnt being clear enough.  I wont use GPU because its not cross platform and it depends on the GPU <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
