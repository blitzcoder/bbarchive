<!DOCTYPE html><html lang="en" ><head ><title >Blob monster code</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Blob monster code</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Blob monster code</a><br><br>
<a name="1058319"></a>

<a name="1058402"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've made a little code tutorial about animating stuff using trig. I've put it on my blog here: <a href="http://www.charliesgames.com/wordpress/?p=441" target="_blank">http://www.charliesgames.com/wordpress/?p=441</a><br><br>Full blitzmax code is included. I'm kind of hoping for some feedback on whether people find it interesting. If so i'll do some more.<br><br>Cheers<br>Charlie<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1058335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Absolutely amazing effect with such a compact piece of code. Thank you for sharing this! I will learn a lot from playing around in there. <br><br></td></tr></table><br>
<a name="1058351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very impressive. <br><br></td></tr></table><br>
<a name="1058381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers! Good stuff, thanks for sharing. <br><br></td></tr></table><br>
<a name="1058382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The enemies in Irukandji are sumptuous and this a great example of how you achieved such a compelling style. I am actually amazed it's all done with a single image. An excellent use of procedural animation. Thanks for sharing. <br><br></td></tr></table><br>
<a name="1058400"></a>

<a name="1058401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks chaps! I guess i'll have to think of some other stuff to write about now!<br><br>Also, for the more adventurous among you, this post contains the draw method for the crab boss in Irukandji. You'll probably need to edit it a bit, and add some more fields, but it shouldn't be too tricky to get working...<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=88064#1000285" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=88064#1000285</a> <br><br>Cheers<br>Charlie<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1058406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brilliant! <br><br></td></tr></table><br>
<a name="1058529"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> really nice Charlie. Thanks for taking time  and provide such a nice demo to learn from. <br><br></td></tr></table><br>
<a name="1058698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> fantastic, thanks!  nice job on the code commenting too. <br><br></td></tr></table><br>
<a name="1058710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is simply.. awesome! <br><br></td></tr></table><br>
<a name="1058729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rs22</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, that's brilliant! <br><br></td></tr></table><br>
<a name="1058744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Panno</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> like it a lot ! thx <br><br></td></tr></table><br>
<a name="1058752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is really special....made me dust off the old BMAX and gave much inspiration! THanks <br><br></td></tr></table><br>
<a name="1058769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gorgeous! Trig really can be a lot of fun. :) <br><br></td></tr></table><br>
<a name="1058778"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >smilertoo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice effect. <br><br></td></tr></table><br>
<a name="1058782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is really cool. <br><br></td></tr></table><br>
<a name="1058784"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh thanks alot now I'm totally distracted playing with this LOL<br><br>I'll post what I've done soon ;) <br><br></td></tr></table><br>
<a name="1058786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Skully, looking forward to seeing your blob monster!<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1058844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >smilertoo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> jkrankie: are you using normal sprites or some quad system? thats a lot of glowey things flying around. <br><br></td></tr></table><br>
<a name="1058884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Normal max2d sprites. The source code is in a zip file available from the link above.<br><br>It's also been ported to flash now as well!<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1058908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FreakForFreedom</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is awesome! Thanks a lot :) <br><br></td></tr></table><br>
<a name="1059079"></a>

<a name="1059081"></a>

<a name="1059083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I didn't mess with the general creature I just added a minor AI (its still a little buggy) and made it so you could spawn multiple monsters. Three points on the monsters back represent how much food and pleasure the creature has and the red dot is how much pain its in.<br><br>The AI just looks around for food (green dots) and pleasure (blue dots) and should avoid pain from red dots... if it gets too much pain it dies, if it starts to starve it causes pain which would in turn cause it to die.  Once its full it looks for pleasure (treats) and when it's had enough of those it looks for a mate.  When 2 monsters are close for long enough a new monster is born.  Red dots emit food every 1000 game iterations.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

'How to make an Irukandji style blob monster.
'By Charlie Knight, 2009/2010
'http://www.charliesgames.com
'
'This code is public domain. Feel free to use as you please.
'If you use the code as a basis for your own blob monsters, let me know! I'd love to
'see what you came up with!
'
'The code is written using the Blitzmax language, but it should be fairly easy to port
'to C++/Java/Whatever with a suitable graphics library.
'
'the image blob.png can be found at <img src="http://www.charliesgames.com/wpimages/blob.png">
'
'Cheers
'Charlie

' Modified by Skully Nov 2010 Same as above.

SuperStrict

AppTitle=("Charlie's Blob Monster! Skully Mod One")

'open a graphics window
Graphics 640, 480, 0, 60

'load the image
Global blob:TImage = LoadImage("blob.png")
Global time:Float = 0

'speed, try changing it
Global speed:Float = 1
Global monsters:TList=new TList

SeedRnd MilliSecs() 

'simple class (type in Blitzmax) to hold a 2d coordinate
Type point
	Field x:Float, y:Float
	Field vx:Float,vy:Float
End Type

Global food:TList=New TList
Global danger:TList=New TList
Global treat:TList=New TList

'here's the blob monster type
Type blobMonster
	
	'x and y coords
	Field x:Float, y:Float	

	'number of nodes along the body, try changing it to 100
	Field segments:Float = 10
	
	'array to hold the points along the body
	Field tail:point[segments]
	
	Field smellDist:Int=60
	Field feelDist:Int=40
	Field touchDist:Int=20
	Field myspeed:Float=1

	Field belly:Float=5			' how much food is in the belly 
	Field bellyfull:Float=10

	Field pain:Float=0			' how much pain is the creature in?
	Field PainHeal:Float=0.999	' how quickly pain disappears
	Field maxpain:Float=100

	Field pleasure:Float=0	' how much pleasure the creature has had
	Field neediness:Float=0.99
	Field MaxPleasure:Float=100	' most satisfied
	
	Field seekx:Float=Rnd(0,640)
	Field seeky:Float=Rnd(0,480)
	Field findmate:Int=False
		
	Method AI()
		Local painPoints:TList=New TList
		Local foodPoints:TList=New TList
		Local pleasurePoints:TList=New TList
		
		Local p:point
		If belly&gt;0 belly:-0.001
		pain:*PainHeal
		pleasure:*neediness
		
		For p=EachIn food
			If Self.DistTo(p.x,p.y)&lt;touchDist And Self.belly&lt;Self.bellyfull
				' eat it!
				If belly&lt;bellyfull belly:+1
				If pleasure&lt;MaxPleasure pleasure:+1
				food.Remove(p)
			Else
				If Self.DistTo(p.x,p.y)&lt;smellDist foodPoints.AddLast(p)
			End If
		Next
		For p=EachIn danger
			If Self.DistTo(p.x,p.y)&lt;touchDist
				If Self.pain&lt;Self.maxpain
					Self.pain:+1
				Else
					monsters.Remove(Self)
					' dies.. not doing that yet
				End If
			EndIf
			If Self.DistTo(p.x,p.y)&lt;smellDist painPoints.AddLast(p)
		Next

		For p=EachIn treat
			If Self.DistTo(p.x,p.y)&lt;feelDist Or Self.DistTo(p.x,p.y)&lt;smellDist
				If Self.DistTo(p.x,p.y)&lt;feelDist And pleasure&lt;100 pleasure:+1
				pleasurePoints.AddLast(p)
			EndIf
		Next
		
		' ok now that we are aware of our environment
		Local foodweight:Float=1.0-(Self.belly/Self.bellyfull)
		Local painweight:Float=Self.pain/Self.maxpain
		Local pleasureweight:Float=Self.pleasure/maxpleasure 

		If painweight &gt; foodweight
			Self.GoAwayFromPain(painPoints)
		ElseIf foodweight&gt;0.7
			GoForFood(foodPoints)
		Else
			If pleasureweight&gt;0.8 findmate=True
			GoForPleasure(pleasurePoints)
		EndIf
	End Method

	Method AngTo:Float(x:Float,y:Float)
		Return ATan2(y-Self.tail[0].y,x-Self.tail[0].x)
	End Method
	
	Method GoAwayFromPain(ps:TList)
		Local fd:point
		For Local p:point=EachIn ps
			If fd
				If Self.DistTo(p.x,p.y)&lt;Self.DistTo(fd.x,fd.y) fd=p
			Else
				fd=p
			End If
		Next
		If fd
			MoveAway(fd.x,fd.y)
		End If		
	End Method

	Method FindAMate()
		Local bm:blobMonster=blobMonster(monsters.First())
		If bm
			For Local b:blobMonster=EachIn monsters
				If b&lt;&gt;Self And b&lt;&gt;bm
					Local dt:Float=DistTo(b.x,b.y)
				 	If dt&lt;DistTo(bm.x,bm.y)
						If dt&lt;touchDist
							findmate:+1			' rubbing
							If findmate&gt;100		' 100 rubs and boing
								Local test:blobMonster = New blobMonster.Create(x, y)
								pleasure=0
								belly=Min(belly-33,2)
								findmate=False
								' go back to normal
							End If
						End If
					bm=b
					EndIf
				End If
			Next
			MoveToward(bm.x,bm.y)
		EndIf
	End Method
	
	
	Method GoForPleasure(ps:TList)
		If findmate
			FindAMate()
			Return
		End If
	
		Local fd:point
		For Local p:point=EachIn ps
			If fd
				If Self.DistTo(p.x,p.y)&lt;Self.DistTo(fd.x,fd.y) fd=p
			Else
				fd=p
			End If
		Next
		If fd
			MoveToward(fd.x,fd.y)
		Else
			Wander() 'sleep
		End If
	End Method

	Method GoForFood(ps:TList)
		Local fd:point
		For Local p:point=EachIn ps
			If fd
				If Self.DistTo(p.x,p.y)&lt;Self.DistTo(fd.x,fd.y) fd=p
			Else
				fd=p
			End If
		Next
		If fd
			MoveToward(fd.x,fd.y)
		Else
			Wander()
		End If
		
	End Method
	
	Method Wander()
		MoveToward(seekx,seeky)
		If DistTo(seekx,seeky)&lt;touchDist
			seekx=Rnd(0,640)
			seeky=Rnd(0,480)
		End If
	End Method
	
	Method MoveAway(x:Float,y:Float,percent:Float=1)
		Local ang:Float=Self.AngTo(x,y)+180
		tail[0].x:+Cos(ang)*myspeed*percent
		tail[0].y:+Sin(ang)*myspeed*percent
		x=tail[0].x
		y=tail[0].y
	End Method

	Method MoveToward(x:Float,y:Float,percent:Float=1)
		Local ang:Float=Self.AngTo(x,y)
		tail[0].x:+Cos(ang)*myspeed*percent
		tail[0].y:+Sin(ang)*myspeed*percent
		x=tail[0].x
		y=tail[0].y
	End Method

	Method DistTo:Float(x:Float,y:Float)
		Local x1:Float=Self.tail[0].x
		Local y1:Float=Self.tail[0].y
		Return Sqr((x-x1)^2+(y-y1)^2)
	End Method
	
	'function that returns a new blob monster object. Blitzmax equivalent (kind of)
	'of a constructor in C++/Java
	Function Create:blobMonster(inX:Float, iny:Float)
		Local n:blobMonster = New blobMonster
		'starting point of the blob monster
		n.x = inX
		n.y = iny
		'give the tail some coordinates, just make them the same as the main x and y for now
		For Local i:Int = 0 To n.segments - 1
			n.tail[i] = New point
			n.tail[i].x = inX
			n.tail[i].y = iny
		
		Next
		
		monsters.AddLast(n)
		Return n
	End Function
	
	Method Update:Int()
		AI()
		If belly&lt;2 And pain&lt;maxpain pain:+1
		'time is a bit misleading, it's used for all sorts of things
		
		'here the x and y coordinates are updated.
		'this uses the following as a basic rule for moving things
		'around a point in 2d space:
		'x=radius*cos(angle)+xOrigin
		'y=raduis*sin(angle)+yOrigin
		'this basically is the basis for anything that moves in this example
		'
		'the 2 lines of code below make the monster move around, but
		'you can change this to anything you like, try setting x and y to the mouse
		'coordinates for example
		
		'put the head of the tail at x,y coords
		'tail[0].x = x
		'tail[0].y = y
	
		'update the tail
		'basically, the points don't move unless they're further that 7 pixels 
		'from the previous point. this gives the kind of springy effect as the 
		'body stretches
		For Local i:Int = 1 To segments - 1
   				'calculate distance between the current point and the previous
		    	Local distX:Float = (tail[i - 1].x - tail[i].x)
        		Local distY:Float = (tail[i - 1].y - tail[i].y)
				Local dist:Float = Sqr(distX * distX + distY * distY)
      			'move if too far away
         		If dist &gt; 7 Then
					'the (distX*0.2) bit makes the point move 
					'just 20% of the distance. this makes the 
					'movement smoother, and the point decelerate
					'as it gets closer to the target point.
					'try changing it to 1 (i.e 100%) to see what happens
					tail[i].x = tail[i].x + (distX * (0.3))
            		tail[i].y = tail[i].y + (distY * (0.3))
         		EndIf
			
		Next
	
		Return False
	End Method
	
	Method Draw()
		'time to draw stuff!
		
		'this sets the blend mode to LIGHTBLEND, or additive blending, which makes
		'the images progressively more bright as they overlap
		SetBlend LIGHTBLEND
		SetColor 0, 200, 150
		
		
		'###########
		'draw the main bit of the body
		'start by setting the images handle (i.e the origin of the image) to it's center
		MidHandleImage blob
		
		'begin looping through the segments of the body
		For Local i:Int = 0 To segments - 1
			'set the alpha transparency vaue to 0.15, pretty transparent
			SetAlpha 0.15
			'the  (0.5*sin(i*35)) bit basically bulges the size of the images being
			'drawn as it gets closer to the center of the monsters body, and tapers off in size as it gets 
			'to the end. try changing the 0.5 to a higher number to see the effect.
			
			Local sc:Float=1.0 + (0.5 * Sin(i * 35.0))
			SetScale sc,sc
						
			'draw the image
			DrawImage blob, tail[i].x, tail[i].y

			sc=0.1
			Select i
				Case 2
					sc:+(belly/bellyfull)/2.0
					SetColor 100,255,100
				Case 5
					sc:+(pain/maxpain)/2.0
					SetColor 255,100,100
				Case 7
					sc:+(pleasure/MaxPleasure)/2.0
					SetColor 100,100,255
				Default
					SetColor 0, 200, 150
			End Select

			'this next chunk just draws smaller dots in the center of each segment of the body
			SetAlpha 0.8
			SetScale sc, sc
			DrawImage blob, tail[i].x, tail[i].y
		Next
		
		'#########################
		'draw little spikes on tail
		SetColor 255, 255, 255
		'note that the x and y scales are different
		SetScale 0.6, 0.1
		
		'move the image handle to halfway down the left edge, this'll make the image
		'appear to the side of the coordinate it is drawn too, rather than the 
		'center as we had for the body sections
		SetImageHandle blob, 0, ImageHeight(blob) / 2
		
		'rotate the 1st tail image. basically, we're calculating the angle between
		'the last 2 points of the tail, and then adding an extra wobble (the 10*sin(time*10) bit)
		'to make the pincer type effect.
		SetRotation 10 * Sin(time * 10) + calculateAngle(tail[segments - 1].x, tail[segments - 1].y, tail[segments - 5].x, tail[segments - 5].y) + 90
		DrawImage blob, tail[segments - 1].x, tail[segments - 1].y
		
		'second tail image uses negative time to make it move in the opposite direction
		SetRotation 10 * Sin(-time * 10) + calculateAngle(tail[segments - 1].x, tail[segments - 1].y, tail[segments - 5].x, tail[segments - 5].y) + 90
		DrawImage blob, tail[segments - 1].x, tail[segments - 1].y

		
		
		'#####################
		'draw little fins/arms
		SetAlpha 1
		
		'begin looping through the body sections again. Note that we don't want fins
		'on the first and last section because we want other things at those coords.
		For Local i:Int = 1 To segments - 2
			'like the bulging body, we want the fins to grow larger in the center, and smaller
			'at the end, so the same sort of thing is used here.
			SetScale 0.1 + (0.6 * Sin(i * 30)), 0.05
			
			'rotate the image. We want the fins to stick out sideways from the body (the calculateangle() bit)
			'and also to move a little on their own. the 33 * Sin(time * 5 + i * 30) makes the 
			'fin rotate based in the i index variable, so that all the fins look like they're moving 
			'one after the other.
			SetRotation 33 * Sin(time * 5 + i * 30) + calculateAngle(tail[i].x, tail[i].y, tail[i - 1].x, tail[i - 1].y)
			DrawImage blob, tail[i].x, tail[i].y
			
			'rotate the opposte fin, note that the signs have changes (-time and -i*30)
			'to reflect the rotations of the other fin
			SetRotation 33 * Sin(-time * 5 - i * 30) + calculateAngle(tail[i].x, tail[i].y, tail[i - 1].x, tail[i - 1].y) + 180
			DrawImage blob, tail[i].x, tail[i].y
			
		Next
		
		
		'###################
		'center the image handle
		MidHandleImage blob
		'Draw the eyes. These are just at 90 degrees to the head of the tail.
		SetColor 255, 0, 0
		SetScale 0.6, 0.6
		SetAlpha 0.3
		Local ang:Float = calculateangle(tail[0].x, tail[0].y, tail[1].x, tail[1].y)
		
		Local x:Float=tail[0].x
		Local y:Float=tail[0].y
		
		DrawImage blob, x + (7 * Cos(ang + 50)), y + (7 * Sin(ang + 50))
		DrawImage blob, x + (7 * Cos(ang + 140)), y + (7 * Sin(ang + 140))
		SetColor 255, 255, 255
		SetScale 0.1, 0.1
		SetAlpha 0.5
		DrawImage blob, x + (7 * Cos(ang + 50)), y + (7 * Sin(ang + 50))
		DrawImage blob, x + (7 * Cos(ang + 140)), y + (7 * Sin(ang + 140))
	
		'draw beaky thing
		SetColor 0, 200, 155
		SetScale 0.3, 0.1
		SetAlpha 0.8
		SetImageHandle blob, 0, ImageWidth(blob) / 2
		SetRotation ang + 95
		DrawImage blob, x, y
		
		'yellow light
		MidHandleImage blob
		SetColor 255, 255, 0
		SetAlpha 0.2
		SetScale 4, 4
		DrawImage blob, x, y
	
'		SetScale 3,3
'		DrawImage blob,seekx,seeky
			
		'Finished!
	End Method

	Function UpdateAll()
		For Local b:blobMonster=EachIn monsters
			b.Update()
		Next
	End Function
		
	Function DrawAll()
		For Local b:blobMonster=EachIn monsters
			b.Draw()		
		Next
	End Function
EndType

'This function calculates and returns the angle between two 2d coordinates
Function calculateAngle:Float(x1:Float,y1:Float,x2:Float,y2:Float)
	Local theX:Float=x1-x2
	Local theY:Float=y1-y2
	Local theAngle:Float=-ATan2(theX,theY)
	Return theAngle
End Function

'create a blobMonster object
Local test:blobMonster = New blobMonster.Create(10, 10)
Local test2:blobMonster=New blobMonster.Create(50,50)
test.myspeed=2

For Local ct:Int=0 To 20
	Local p:point=New point
	p.x=Rnd(10,630)
	p.y=Rnd(10,470)
	food.AddLast(p)

	p=New point
	p.x=Rnd(10,630)
	p.y=Rnd(10,470)
	danger.AddLast(p)

	p=New point
	p.x=Rnd(10,630)
	p.y=Rnd(10,470)
	treat.AddLast(p)
Next

Global oscRate:Int=5

'main loop
While Not KeyHit(KEY_ESCAPE)
	'update and draw the blobmonster
	Local y:Float = (15 * Cos(time * -6)) + (240 + (180 * Sin(time * 1.3)))
	Local x:Float = (15 * Sin(time * -6)) + (320 + (200 * Cos(time / 1.5)))
	Local y1:Float = (15 * Cos(time * -4)) + (240 + (180 * Sin(time * 1.3)))
	Local x1:Float = (15 * Sin(time * -4)) + (320 + (200 * Cos(time / 1.5)))
	
	time:+1
	
	For Local p:point=EachIn food
		p.x:+p.vx
		p.y:+p.vy
		p.vx:*0.99
		p.vy:*0.99
		SetScale 0.2 + (0.1 * Sin(time * oscRate)), 0.2 + (0.1 * Sin(time * oscRate))
		SetColor 100,255,100
		DrawImage blob,p.x,p.y
	Next
	
	For Local p:point=EachIn danger
		p.vx:+1
		If p.vx&gt;1000
			p.vx=0
			Local pp:point=New point
			pp.x=p.x
			pp.y=p.y
			pp.vx=Rnd(-1,1)
			pp.vy=Rnd(-1,1)
			food.AddLast(pp)
		End If
		SetScale 0.4 + (0.3 * Sin(time * oscRate)), 0.4 + (0.3 * Sin(time * oscRate))
		SetColor 255,100,100
		DrawImage blob,p.x,p.y
	Next
	
	For Local p:point=EachIn treat
		SetScale 0.2 + (0.1 * Sin(time * oscRate)), 0.2 + (0.1 * Sin(time * oscRate))
		SetColor 100,100,255
		DrawImage blob,p.x,p.y
	Next
	
	blobMonster.UpdateAll()
	blobMonster.DrawAll()
	
	SetScale 1,1
	SetAlpha 1
	SetRotation 0
		
	Flip;Cls
Wend

EndGraphics()
End
'Finished!
</textarea><br><br>Thanks jkrankie, this was a fun diversion.  Time to get back on the job of my current project... still throwing this into the samples package though!<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1059164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's really good!<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1077679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I Monkified it! <a href="http://www.charliesgames.com/wordpress/?p=543" target="_blank">http://www.charliesgames.com/wordpress/?p=543</a><br><br>Can't figure out how to re-colour images in Monkey though?<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1077737"></a>

<a name="1077738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >taumel</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sadly that doesn't work, it's not supposed to work. I also miss this.<br><br>*snip*<br>Sets the current color.<br><br>The current color is used by all drawing operations except Cls and DrawImage.<br>*snap*<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1077746"></a>

<a name="1077747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steve Elliott</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's cool, thanks for sharing. Good tutorial and well commented, clear code.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1077826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> That demo is gorgeous.  Thanks for posting. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
