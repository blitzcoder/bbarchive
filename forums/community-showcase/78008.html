<!DOCTYPE html><html lang="en" ><head ><title >Particle engine...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Particle engine...</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Particle engine...</a><br><br>
<a name="874179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, just as a side experiment to help learn C++, I revamped my older 2d particle system with some C++ routines for extra speed, and extra functions.<br><br>The engine features:<br><br>-C++ routines for extra speed<br>-simple Emit particle function to drop a particle<br>-Particles can be automaticaly faded away/rotatated to their direction<br>-Can render multible layers of particles, by setting a Z parameter on a partical at creation.<br>-Can offset a particle/group of particles<br>-Can add a force to a particle, in otherwords, like the offset but it changes direction slowly (showing momentum ect.) this is what is used in this demo to create a gravity effect.<br>-Built in convince functions like ParticleExplosion, or ParticleCount.<br>-Can clear all the particles with a single call, or only certain layers.<br><br><br>Anyways, here's the module / a demonstration of it:<br><br><a href="http://www.yahfree.com/OtherFiles/particlemodule.zip" target="_blank"> link </a><br><br>hold the LMB to do a rapid particle explosion, and the RMB to do a particle fountain.<br><br>Let me know what you guys think. I was going to go with arrays, but the complication is not worth the better preformance. <br><br></td></tr></table><br>
<a name="874183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pretty good, there is a major slow-down when holding LMB though.<br><br>Sometimes complication is best :P<br><br>EDIT: Wow.. If I run the program in a separate desktop (using dapp) it runs at a constant 60-62 fps while holding RMB and LMB. <br><br></td></tr></table><br>
<a name="874192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >6</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, thats good work.  Quite mesmerizing. <br><br></td></tr></table><br>
<a name="874195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abrexxes</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice,no problems here. (IntelDualCore/Intel3100/XPsp3+Vista) <br><br></td></tr></table><br>
<a name="874204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Moraldi</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good work!. Which lib did you use? <br><br></td></tr></table><br>
<a name="874205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Good work!. Which lib did you use?  <br></div>His own?<br><br>Notice:<br><div class="quote"> I revamped my older 2d particle system <br></div> <br><br></td></tr></table><br>
<a name="874217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vilu</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very smooth. I'd love to see how many particles it could handle before slowing down. I'm getting no slowdown at all on my 5-year old IBM T40 lappy with both mouse buttons down and 1000+ particles on screen. <br><br></td></tr></table><br>
<a name="874278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for the feedback guys, the full module is up on the same link now, and the source/exe for that demo aswell. <br><br></td></tr></table><br>
<a name="874405"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nornal rendering speed on my test boxes, once again, it's not the CPU speed, but the GPU speed that is always the bottleneck. <br><br></td></tr></table><br>
<a name="874430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> fixed a little bug with compiling the module, one of the source files was the wrong name...<br><br>JGOware, how do you give some of the processing job to the CPU? Are you just its all on the GPU? Because i've never messed with that stuff before, sounds interesting <br><br></td></tr></table><br>
<a name="874431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> fixed a little bug with compiling the module, one of the source files was the wrong name... <br></div>I was going to mention that, but I couldn't remember if the main mod source had to be named the same as the module.<br><br>EDIT: I never tried to compile it :o <br><br></td></tr></table><br>
<a name="874566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see the slowdown too. I wonder if its related to the creation/ destruction that happens in runtime.<br>Perhaps a better method is to create a large pool initially and simply turn them off rather than delete them. When creating a new particle, find the first one disabled and re-use it. Moving from a list to an array will speed  thing up as well. <br><br></td></tr></table><br>
<a name="874576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been using C++ for a few months now.  I really like it!  I'd be very interested to learn how you got the c++ code into blitz.  Can you explain the process required? <br><br></td></tr></table><br>
<a name="874703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> GW:<br><br>Thats the idea of arrays, and it won't be that hard to implement, I just have to figure out how, I did make an attempt, but it didnt agree with the C++ routines, causing some nasty pointer glitches.<br><br>Craig H. Nisbet:<br><br>This is the first time i've used C++ to help speed things up. With bmax its pretty straight forward, with B3D you have to do some DLL hattery.<br><br>Heres a 101:<br><br><br>You need to create your function in C++, in this case, it returns the int '2', for blitzmax to reconize it, you need to place a extern function around it, and name it "C" or anything i think :<br><br><pre class=code>
extern "C" {
       
       
       int MyFunction() {
           return 2;
       }
       
       
       
}
</pre><br><br>Now in blitzmax you do the following:<br><br>1. import the C++ file<br>2. define the function(s) you want to use (use extern function)<br><br><pre class=code>
Import "myfile.cpp"

'define function
Extern "C"
 Function MyFunction:Int()
End Extern

Print MyFunction()

End
</pre><br><br>should print '2'<br><br>that concludes the 101. <br><br></td></tr></table><br>
<a name="874898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice, i had no slowdon whatsoever at over 1.2k particles! <br><br></td></tr></table><br>
<a name="874947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, now back to work on the game that's actually using this <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
