<!DOCTYPE html><html lang="en" ><head ><title >Stunt Car Racing multiplayer</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Stunt Car Racing multiplayer</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Stunt Car Racing multiplayer</a><br><br>
<a name="581704"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hooray, it works!!!!<br><br>However I could do with a little advice about Tokamak and networks, so if you can help please answer this thread - <a href="http://www.blitzbasic.com/Community/posts.php?topic=52106" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=52106</a><br><br><img src="http://www.jameskett.dsl.pipex.com/SCR_multi.jpg"> <br><br></td></tr></table><br>
<a name="581712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bruZard</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hurra!<br><br>:) <br><br></td></tr></table><br>
<a name="581744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> NICE!!!! :D <br><br></td></tr></table><br>
<a name="581754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> HOLY COW VorderMAN! :)<br><br>Hehe.. My code im testing at the moment would probrably have worked for this ^.^ Neat. I wanna go home to play!<br><br>[edit]<br>When DO we get to play? lol. <br><br></td></tr></table><br>
<a name="581768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wouldn't know much about physics, but I can offer some insight to multiplayer on race games as i've done it twice now.  You may take or leave this and to some extent it probably depends on how you program, but I shall dissect that part of my brain and let you know what i've found for myself:<br><br>The most important packet is the one that tells the other clients new information they didn't already have. Such as the first packet after a car has changed direction.<br><br>Using standard networking systems that send packets every 250ms or so this can result in a quarter of a second delay when that important packet is sent, with latency it could be half a second before it arrives at all the clients, this is bad.<br><br>Interval timed packets are good as a backup in case an important packet didn't arrive, but they are not good for sending the important packets.<br><br>I structure my network code to use internvalled timing but I reset the timer whenever there is a change in the state of the controller like if the accelerator is pressed when it wasnt previously.  I then send a new packet strait away with x,z mommentum and the control being pressed.<br><br>My remote clients continue to process the controls that I am pressing in a hacked version of my main control function.<br><br>So far for race games i've found this is by far the best system to use of all those i've tried and results in the client machines showing other racers very true to their real positions. <br><br></td></tr></table><br>
<a name="581776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Becky:<br>At the risk of hijacking the thread, just a quick one:  so you're saying you send packets every 250ms or so, but to supplement that you send an 'important' packet whenever something changes (ie accelerate, turn, brake etc)?  Are your 'important' messages the ones you send as 'reliable' packets, supplemented by the 'unreliable' ones every 250ms after that?<br><br>Vorderman:<br>After the furore of the last preview, and with the news that you've added multiplayer successfully... well, just... brace yourself.  :o)<br><br>I'm not going to be so crass as to ask for a demo soon (everyone else can do that!), but a lil bit of video to get us frothing at the mouth would be an excellent hype-inflater.  :oD <br><br></td></tr></table><br>
<a name="581778"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a note Vorderman,<br><br>Ive used a technique like Beckys above.<br><br>Its not good with Physics. Certainly didnt work for more than a few seconds with the racer- So perhps send a global position update every now and then to keep it all smooth. <br><br></td></tr></table><br>
<a name="581794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> LineOf7s i'll email a reply to that so we dont totally hijack the thread. <br><br></td></tr></table><br>
<a name="581807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Becky:  So considerate.  Ta.  :o) <br><br></td></tr></table><br>
<a name="581840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> LineOf7s i'll email a reply to that so we dont totally hijack the thread. <br></div><br><br>No no, please do hijack the thread - I really could do with reading everything about multiplayer networking that others have done or are doing, it's something I've never tried before.<br><br><div class="quote"> and with the news that you've added multiplayer successfully <br></div><br>Well, I wouldn't say "added successfully" - certainly I now have 2 (or more :) ) cars running under full physics in the game, but as yet no way to control the cars over a network...I was rather surprised that just spawning a new car actually resulted in another car appearing and working, rather than something daft happening that I'd overlooked.<br><br>I could get it working split-screen in a few minutes, but networking is what I really wanted and that'll take longer.<br><br>I quite like the idea of putting the rear view mirror back in, then adding spotlights to the front of the cars that the player can flash on and off....it was always fun to do this in Need For Speed, trying to put the other player off. Perhaps a horn also...? <br><br></td></tr></table><br>
<a name="581895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> No no, please do hijack the thread <br></div><br>lol, in that case here is the email I sent to LineOf7's<br><br><div class="quote"> <br>"you're saying you send packets every 250ms or so, but to supplement that you send an 'important' packet whenever something changes"<br>Most people send packets every 200-250ms or so when writting a network game, I send a network packet when the players control state changes or an event (such as a tyre failure) happens.  This is a workable system, but far from ideal as when a player brakes or turns the wheel they can be out of sync by half a second or more - which is quite bad for a race game where tenths of a second matter.<br> <br>To counteract this I send my packets when the state of the players controls change.  If I start braking I send a packet, if I start turning I send a packet (with analogue controls it's best to use a window to test against, ie: if abs(currentBraking-breakingInLastNetPackage)&lt;0.2).<br> <br>Unfortunately network games do sometimes drop a packet, although it doesn't happen often.  However if the player is going down a long strait and misses the packet that is sent as they enter the strait then other players may show them in the barrier for a good 10-15 seconds or so, to counter this and incase of dropout I still use the timed interval system.  In practice it can usually be set to even less frequent than 200-250ms as packets getting dropped are quite a rare event usually, but provided a safety net is there to let other players know you are not link dead and incase of packet drop then you should be fine.<br> <br>"Are your 'important' messages the ones you send as 'reliable' packets, supplemented by the 'unreliable' ones every 250ms after that?"<br> <br>I dont really have reliable and unreliable packets, a packet is a packet it is just a question of when to send them and the info contained in them.  I dont use any form of error detection and correction in my network games.  I usually use TCP/IP as although the header size is more than UDP it costs less bandwidth to use TCPIP then sending back a single byte verification.<br> <br>Rather than flaff around detecting an error I would rather just send the repair packet anyway by virtue of getting the next packet when it arrives.  It's rare that a single packet drop is such a major issue anyway.<br><br>The other issue in network games is what information to send.  I always send the state of the controls being pressed, depending on the game this is usually in some form of binary system:<br> <br>1 accelerate<br>2 brake<br>4 gear up<br>etc..<br> <br>This then allows the remote clients to process my position using the same mathematics which causes less of a "jump" when the next packet arrives with the correct x and z position.<br> <br>Some people like to gradually smooth out any innacuracies by comparing the distance between the current x and z position of a remote entity and the corrected position and gradually applying the difference over time.  I find that sending the control being pressed pretty much addresses this anyway and the only ocassional "jumps" are fixing the odd drop out - and i'd rather the unit jumped to it's correct position rather than drove sideways.<br> <br></div> <br><br></td></tr></table><br>
<a name="582234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nawi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Half-life sends packet every 50milliseconds as default, and usually people change it to send to every 10milliseconds. But its first person shooter and uses UDP so its different thing. I'd suggest just sending the position and direction &amp; speed like every 200ms, and make it adjustable for LAN etc. <br><br></td></tr></table><br>
<a name="582640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> It would be nice to have a kind of option to set how many packets are sent.<br><br>Means: <br>       56K Modem   - few<br>       1 MBit/ DSL - more<br>       2 MBit      - more than more<br>       T1 / Lan    - many<br><br>Btw: I got my joypad, "saitek 2600 rumble" :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
