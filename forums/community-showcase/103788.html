<!DOCTYPE html><html lang="en" ><head ><title >SnowFall and SnowAccumulation demo winter 2014</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >SnowFall and SnowAccumulation demo winter 2014</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >SnowFall and SnowAccumulation demo winter 2014</a><br><br>
<a name="1252648"></a>

<a name="1252649"></a>

<a name="1252650"></a>

<a name="1252651"></a>

<a name="1252858"></a>

<a name="1265220"></a>

<a name="1297078"></a>

<a name="1301489"></a>

<a name="1301492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello,<br><br>This is a demo that i have made these past few days.<br><br>This demo is about snow fall (with falling snowflakes) and snow accumulation (with melted snowflakes)<br><br>Here is a screenshot of the scene before/after :<br><img src="http://rd-stuff.fr/SnowFall-and-SnowAccumulation-demo-201412252033.png"><br><br>Here is a link to the demo if you want to try :<br>(see post#23)<br><br>Controls :<br>Mouse X axis -&gt; look turn left right<br>Mouse Y axis -&gt; look up down<br>z -&gt; move forward<br>s -&gt; move back<br>q -&gt; move left<br>d -&gt; move right<br><br>Tab -&gt; change the interactionmode (allows you to either control the camera and to turn move in the scene or to "free" the cursor if you want to do something else while the snowflakes are falling and accumulating)<br><br>If the window "loses focus", the graphics will not update correctly, to prevent that, you can click on the window bar and drag it a little, this will put the focus on the window and the graphics will update correctly.<br><br>The demo will run slow if your cpu or your gpu are too low end/old because at the end there will be a lot of tris !<br><br>Some interesting things about this demo :<br>-&gt;the texture of the snowflake and of the meltedsnowflake has been made by capturing a filtered texel of the same size than those of the terrain so that they look the same.<br>-&gt;the falling snowflakes are copies (copyentity) of one mesh with one texture<br>-&gt;the melted snowflakes are merged in a few surfaces in one mesh with one texture<br>-&gt;i had to define the entityorder of the terrain to draw it first (behind) because there was some zfighting or rather "pixel alpha zfighting" between the melted snowflakes and the layer of the terrain where i draw the texels of the melted snow.<br><br>That's it. I hope that you like it. The graphics are low tris and with only a few colors but i like this kind of render. <br>(finally the blitzresearch's fairylights are lighting and glowing !) <br><br></td></tr></table><br>
<a name="1252672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pingus</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Crashing here... black screen at start, sorry (Win XP) <br><br></td></tr></table><br>
<a name="1252685"></a>

<a name="1252686"></a>

<a name="1252687"></a>

<a name="1252688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean by "crashing" ?<br>There may be a mav at renderworld if your gpu is too low end/old because there are up to 32000 vertices and 32000 triangles per surface, but some graphics cards apparently don't support that !<br><br>The other graphics problem (graphics not updated correctly) may happen because the windows loses the focus, i will have to find a solution to this... For now the only solution to prevent this is to click on the window bar and to drag it a little. <br><br></td></tr></table><br>
<a name="1252702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi RemiD. Very nice! Running pretty smooth here. But such a beautiful piece and no source? Shame on you.. Santa and his reindeers will not be pleased. ;-)<br><br>Ho-ho-ho, Merry X-mas indeed! <br><br></td></tr></table><br>
<a name="1252707"></a>

<a name="1252708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for your comments. :)<br><br><div class="quote"> <br>no source?<br> <br></div><br>I can explain how i have made something if you want to understand, and even provide a simplified code example to demonstrate how something works, but because i plan to reuse some procedures functions, i don't want to post the full source. (this may become a game in the future...) <br><br></td></tr></table><br>
<a name="1252733"></a>

<a name="1252734"></a>

<a name="1252735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have to *shake* the window several times to get a steady snow production of about 1460 SnowflakesOnAirCount - otherwise production ends after 5 seconds and SnowflakesOnAirCount is down to 0 - 1<br><br>Anyway. nice demo - reminds me at GameStudio A8 Snowdemo <br><br></td></tr></table><br>
<a name="1252739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I have to *shake* the window several times to get a steady snow production of about 1460 SnowflakesOnAirCount - otherwise production ends after 5 seconds and SnowflakesOnAirCount is down to 0 - 1<br> <br></div><br>RGR&gt;&gt;Oh... very strange. Can you please post the specifications of your os and of your computer ?<br>Also can you tell me what is the value of "SC" when this problem happens ?<br><br>Thanks for your comments. <br><br></td></tr></table><br>
<a name="1252822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahah.. Game on the way. Good for you. I do have some snowy code already for a certain game idea(s) I have, not of the accumulating type though and just never hurts to look at someone's code, especially if is running smoothly. I guess low poly is the key to what you're doing? So, yes interested in your explanation. :-) <br><br></td></tr></table><br>
<a name="1252831"></a>

<a name="1252833"></a>

<a name="1252834"></a>

<a name="1252835"></a>

<a name="1252836"></a>

<a name="1252837"></a>

<a name="1252838"></a>

<a name="1252840"></a>

<a name="1252841"></a>

<a name="1252842"></a>

<a name="1252844"></a>

<a name="1270630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Rick&gt;&gt;<br>For the falling snowflakes, they are just copies (with copyentity) of one quad mesh with one texture.<br><br>The target position of the snow accumulation of a falling snowflake is determined with a linepick from up to down.<br><br>For the snow accumulation on the terrain, it is a texture with 8x8 texels per 1x1 unit, see : <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3093" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3093</a><br><br>For the snow accumulation on the things (blitz3d sculpture, happy new year card, rocks, pine trees, wild lettuces) it is one mesh with the minimum of surfaces possible with a maximum of 32000 vertices and 32000 triangles per surface and one texture.<br><br>The maximum of 32000 vertices and 32000 triangles per surface is to prevent a mav at renderworld on some graphics cards.<br><br>In this demo there is a maximum of 100 000 meltedsnowflakes, each meltedsnowflake is a quad mesh, it has 4 vertices and 2 triangles, so in order to merge all these meltedsnowflakes, you need (100 000 * 4 / 32000 = 12.5) 13 surfaces.<br><br>You need a variable (SurfaceId%) to know in which surface to put the next meltedsnowflake, so you start at SurfaceId = 1 and before adding a new meltedsnowflake to the surface, you need to check if the current surface has less than 32000 vertices and less than 32000 triangles.<br>if yes<br> you add this meltedsnowflake to the current surface<br>if no<br> you increase the SurfaceId (SurfaceId = SurfaceId + 1)<br> you add this meltedsnowflake to this surface<br><br>Here is an example on how to add a surface to another :<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=102895" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=102895</a><br><br>This should give you a good start...<br>But keep in mind that this is only a demo, maybe this effect can work on a 128x128units terrain but not on a bigger terrain or it will be really slow...<br><br>Another approach would be to "texels fill" and "uv map" the meshes of the things (blitz3d sculpture, happy new year card, rocks, pine trees, wild lettuces) so that the texel size has the same size than the texel size on the terrain, and then color the texel on the texture at the picked position... A good "texels filler" "uv mapper" allows you to display a grid to see the texel size, you may manage to do this manually. (with Wings3d for example) <br><br></td></tr></table><br>
<a name="1252846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was afraid for that. Probably wont work on large terrains. But nice effect nevertheless.this would be nice in a snowball like this:<br><a href="http://www.blitzbasic.com/Community/post.php?topic=101692&amp;post=1249861" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=101692&amp;post=1249861</a><br><br>Add a nice admospheric town with lights from buildings, streetlights and a camera fly through and you have the perfect demo. <br><br></td></tr></table><br>
<a name="1252848"></a>

<a name="1252849"></a>

<a name="1252851"></a>

<a name="1252852"></a>

<a name="1252853"></a>

<a name="1252865"></a>

<a name="1254321"></a>

<a name="1254322"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD OK ...<br>When I start the program<br>FPS = 415<br>SC = 0,035<br><br>SnowFlakesOnAir = 20<br>after 5 Seconds SnowFlakesOnAir = 0<br><br>Then I grab the Window several times and move it slightly aside<br>Each time the SnowFlakesOnAir get higher - up to 1460 <br>Then FPS = 156<br>SC = 0,09 to 0,1<br>MainLoopTime = 7<br><br>[ADDED] After 10 Minutes: SnowFlakesOnAirCount = 1280<br><br><br>Specs:<br>Prozessor x64 Intel(R) QuadCore(TM) i7-2600K CPU @ 3.40GHz, 3401 MHz, 8 logic Processors<br>8 GB Memory<br>Windows 7 Pro<br>NVIDIA GeForce GTX 770 4096 MB <br>Monitor1 1920x1080 <br>Monitor2 1920x1080<br>3DVision<br>DirectX-Version DirectX 10<br>Creative Soundblaster Z SB 1500<br>1 TB SSD<br>500 GB SSD <br><br></td></tr></table><br>
<a name="1252857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> RGR&gt;&gt;Thanks for the report, if you have some time, please test the new version (i have just added a flip(true) to limit the fps to 60). Maybe this will work because your computer seems very fast ! <br><br></td></tr></table><br>
<a name="1252859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Working Well here RemiD:<br><br><img src="http://www.wishingwellsoftware.co.uk/b3dremi.png"> <br><br></td></tr></table><br>
<a name="1252864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitzplotter&gt;&gt;Thanks for the test! <br><br></td></tr></table><br>
<a name="1252866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD<br>Now it's ok. Reaches SnowFlakesOnAirCount = 1480 in part of a second - no grabbing the window needed anymore. <br><br></td></tr></table><br>
<a name="1252869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> No problem RemiD, happy to test - its a great showcase of what is capable with Blitz3D, Happy New Year ;) <br><br></td></tr></table><br>
<a name="1252870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RGR&gt;&gt;Good to know... Thanks for the test !<br>So it seems that a FPS limiter is required if you want an app/game to run well on fast computers. I take note. <br><br></td></tr></table><br>
<a name="1252874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So it seems that a FPS limiter is required if you want an app/game to run well on fast computers. I take note. <br></div><br>The better way could be to take a look into the logic of your code again.<br>Actually it should work the same - no matter how high the FPS are. Maybe you have to multiply the adding of snow particles with a faktor which is calculated considering the frame rate. <br><br></td></tr></table><br>
<a name="1252877"></a>

<a name="1252878"></a>

<a name="1252880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Maybe you have to multiply the adding of snow particles with a faktor which is calculated considering the frame rate. <br> <br></div><br>That's what i already do but it does not seem to work with a too high fps...<br><br><pre class=code>
;at the start of the mainloop (before any code)
MainLoopStart% = millisecs()

;at the end of the mainloop (after the flip())
MainLoopTime% = millisecs() - MainLoopStart
If(MainLoopTime &lt; 1)
 MainLoopTime = 1
endif

SC# = Float(15) / 1000.0 * Float(MainLoopTime) ;(15 represents the minimum acceptable FPS so i define the value of the turns moves assuming the game will run at least at 15FPS...)

;every turn move is multiplied by SC
turnentity(PlayerRoot,0,-1*SC,0)
moveentity(PlayerRoot,0,0,0.1*SC)

;to create snowflakes i also multiply by SC :
For i% = 1 To 10*1*SC Step 1

next
</pre><br><br>Now it works well on your fast computer and it works well on 5 others computers (old and recent) that i have here, so i think that's good enough.<br><br>I use this :<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2916" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2916</a> <br><br></td></tr></table><br>
<a name="1252946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really nice. Now if only it would snow for real, like say a meter or 2 so wouldn't have to go to work tomorrow. ;-) <br><br></td></tr></table><br>
<a name="1252947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's snowing where i live, but not much, only a few centimeters on the ground... <br><br></td></tr></table><br>
<a name="1253097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's not nearly enough. I want it to be so high I would need to dig a tunnel to the supermarket down the street. Ah, wishful thinking.. <br><br></td></tr></table><br>
<a name="1297077"></a>

<a name="1301490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Slight corrections + one version with bilinear filtering and one version without bilinear filtering, just to see the differences in the renders...<br><img src="http://rd-stuff.fr/SnowFall-and-SnowAccumulation-demo-20160226-with-without.png"><br><br>(not sure what i have done with the blendmode of the texture of the snowflake with bilinear filtering but it is less white...)<br><br><a href="http://rd-stuff.fr/SnowFall-and-SnowAccumulation-demo-20160226EXE.zip" target="_blank">http://rd-stuff.fr/SnowFall-and-SnowAccumulation-demo-20160226EXE.zip</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
