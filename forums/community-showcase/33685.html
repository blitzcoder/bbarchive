<!DOCTYPE html><html lang="en" ><head ><title >KBS Beta : Key Binding System like commercial game</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >KBS Beta : Key Binding System like commercial game</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >KBS Beta : Key Binding System like commercial game</a><br><br>
<a name="362637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br>  <br>   After BCF 3.0 (with Filax), this is another production, the KBS. It's libray that help you to manage binding key / mouse / joystick, finish to choice between mousehit or keyhit ...<br><br>You will be able to create control setting like commercial game ...<br><br>- Unlimited action<br>- 2 binding associations by action<br>- Multi system binding keyboad / Mouse / Joystick<br>- Filter / Dead Zone for Joystick<br>- Load / Save Setting in INI file<br><br>Code exemple: <br> ; Create a bind without INI file<br> KBS_AddAction( "cam turn ", KBS_Joy_X )<br> <br><br> ; Use a key/button bind<br>  If KBS_Action( "forward" ) Then<br>    MoveEntity Player,0,0,25<br>  Else If KBS_Action( "backward" ) Then<br>    MoveEntity Player,0,0,-25<br>  end if <br><br> ; Use an Axis binding<br> key = KBS_Action( "cam turn" )<br> If key  Then<br>   If KBS_TypeACtion( "cam turn" , key ) = KBS_JoystickAxis Then<br>     value# = KBS_ActionValue#( "cam turn right" )<br>     TurnEntity CamAxis,0,Value# * 100,0<br>    EndIf<br>  endif<br>etc ...<br><br><br>to download the demo :<br><br><a href="http://www.3dgametool.com/kbs1.0/KBS_Demo.zip" target="_blank">http://www.3dgametool.com/kbs1.0/KBS_Demo.zip</a><br><br><br><br><img src="http://www.3dgametool.com/kbs1.0/KBS_screen1.jpg"> <br><br></td></tr></table><br>
<a name="362656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Erm, you 'll sell it? <br><br></td></tr></table><br>
<a name="362665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Propably ... <br><br></td></tr></table><br>
<a name="362671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, may I suggest you pack it with other utils (don't ask me which ones) so that it looks actually worth buying?It seems a bit "light" right now, to say the least. I mean, you can't compare this to something like the BCF.<br>Maybe other people will be greatly interested and prove me wrong, but it looks like something that decently couldn't be sold unless it's very cheap, and the once share it or whatver system you use has taken its part you're left with nothing...<br>So IMHO you should really consider including it in some more consequent project.<br>Just my 2 cents. <br><br></td></tr></table><br>
<a name="362684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> WOW, that'll save at least 20 minutes of codeing, I'm with Koriolis. <br><br></td></tr></table><br>
<a name="362685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no compare with BCF, I just say after my work on BCF ...<br><br>And if you don't want to use it ok is you choice ... <br><br></td></tr></table><br>
<a name="362688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> And When i say probably it's not sure<br><br>Ebuisness, so do it I'm waitting :-) <br><br></td></tr></table><br>
<a name="362692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> And if you don't want to use it ok is you choice ...  <br></div>Indeed, but you miss the point. When I refer to the BCF, it's only to have some reference. The price of the BCF is in a good range. Your lib does *a lot* less, so if there's some logic here this lib should be really cheap, making it hard to be sellable online (given the money spent just handling the transaction). <br><br></td></tr></table><br>
<a name="362706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, here is what I came up with in a hurry, I guess it will be sufficient for 9/10 games.<pre class=code>Dim ids(1,15)
Function hit(id)
	If ids(0,id)=0 Then
		Return KeyHit(ids(1,id))
	Else If ids(0,id)=1 Then
		Return MouseHit(ids(1,id))
	End If
End Function
Function down(id)
	If ids(0,id)=0 Then
		Return KeyDown(ids(1,id))
	Else If ids(0,id)=1 Then
		Return MouseDown(ids(1,id))
	End If
End Function
Function idsconfigure(id)
	Repeat
		For a=0 To 255
			If KeyDown(a) Then
				ids(0,id)=0
				ids(1,id)=a
				Return
			End If
		Next
		For a=1 To 3
			If MouseDown(a) Then
				ids(0,id)=1
				ids(1,id)=a
				Return
			End If
		Next
	Forever
End Function</pre> <br><br></td></tr></table><br>
<a name="362804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eole: I would hate to say this but this is the same sort of thing that was included in my EdzUpUCS.bb ages ago, basically mine was a console system (like Q3 etc) that uses the /bind key +action thing (this was also given away free). <br><br></td></tr></table><br>
<a name="362823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok Ebuissnees, It's not the same system ... With your we can know if a key ou mouse hit, and where are mouse and Joystick axis .... <br><br>But I post here a demo ok. You don't like my work I understand<br><br>So you win, I keep my work ... <br><br></td></tr></table><br>
<a name="362825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The text for the left and right click are reversed in the binding window of the demo. You might want to make sure it shows the right buttons/keys so people don't think that it doesn't work. <br><br></td></tr></table><br>
<a name="362828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> EXplpain me ?<br><br>You can bind right click / left click / wheel click on any action. In the demo you can bind the key/mouse/joystick On same action. <br><br></td></tr></table><br>
<a name="362830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes what I ment was if you bind lets say the left mouse button to the jump, then the window which shows the bindings says its the right mouse button, and the other way around. The system works just fine, its just the text displaying the binding that seems reversed for the mouse buttons. <br><br></td></tr></table><br>
<a name="362831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah ok, thank a lot <br><br></td></tr></table><br>
<a name="362840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I couldn't get all of the features in 20 minutes, but about your system: You have switched the right and left mouse key, and the axis systems (at least the mouse one), works horrible. But I din't say that I didn't like your system, it's just not a big deal, and nothing I would ever buy. <br><br></td></tr></table><br>
<a name="362847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt; axis systems (at least the mouse one), works horrible<br>It's a generci exemple, off course I never seen a Game where Joystick / Mouse / key are in the same action, it's just to show that the lib can use axis.<br><br>&gt;You have switched the right and left mouse key<br>It's not the key how are swithc but the label$ :-), but a  bug in a beta version that I keep for me it's horrible, off course when you create some code, You never make bug :-)<br><br>I just put the demo , to see if someone are interrested, nobody are interrested so, I stop it. I keep my system for me <br><br></td></tr></table><br>
<a name="362852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Of course I posted about the bug solely to make a fool of you (I hadn't seen that zawran had already mentioned it) <br><br></td></tr></table><br>
<a name="362894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK now give the man a break, he got the point. No need to make him feel we're just bitching. <br><br></td></tr></table><br>
<a name="363049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> it's a nice idea, it's just something you wouldn't expect people to buy really, not unless you wanted to take advantage of total newbies. <br><br></td></tr></table><br>
<a name="363064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ashmantle</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why can't he sell it to newbies?<br><br>Stop kicking his behind, and let him discover how well it sells on his own.. after all, almost everyone of you who replied are people who actually know how to make your own and would not be his target audience. <br><br></td></tr></table><br>
<a name="363092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't see the problem in someone wanting to do something to sell it no matter how basic it might seem. If someone like it and want it, they will buy it, if not well they won't.<br><br>@Eole, just keep coding and try and be a bit more toughskinned when someone is commenting on the things you make. There will always be people who can't see the point or simply don't like the way something is done, but there will be other people who think its great, so just keep at it. <br><br></td></tr></table><br>
<a name="363309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I finish it, and I will post a new demo.<br><br>Thank all to be agree with me ... <br><br></td></tr></table><br>
<a name="363581"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I won't speak for others, but in case I was unclear I have nothing against Eole, actually I consider him as a real nice guy.<br>Reading back again my posts, I don't think I have been negative. I do believe I'm perfectly objective, and have given him a constructive advice.<br>I can admit I'd feel sorry for someone who pays for such a system (unless the price is really low, but as I said in this case it would surely not be worth it for Eole, hence my advice), and that I'd be tempted to write a free alternative for the sake of it. <br>But that was not the point, the idea was to point something that a lot of people here surely find pretty obvious: this lib really looks too light.<br>Nothing wrong with saying that...or it is? Personnaly I think that any criticism is welcome as long as it is nicely expressed and is not gratuitous. Especially if it comes with advices that could help make the criticism become outdated at some point.<br><br>So Eole please don't be p*** o** by what I said, just take it as it is, a constructive criticism from someone who knows you can *very* easily do much better (and much more profitable). <br><br></td></tr></table><br>
<a name="363586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> i also wasn't being negative, just pointing out it's a thing total newbies would need and most likely their project would not actually be advanced enough to require such a feature imho.<br><br>ps if anyone wants to sell anything, then it's up to them, people who wish to buy it will and the others will leave it be. <br><br></td></tr></table><br>
<a name="363982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's my system.  You owe me $100 if you use it:<br><br><pre class=code>Type Key
Field scancode, action
End Type

Function AddKey(scancode,action)
key.key=new key
key\scancode=scancode
key\action=action
EndFunction

Function GetKey()
For key.key=each key
  If KeyHit(key\scancode) Return key\action
  Next
End Function</pre><br><br><br>Honestly, you will never make any money selling anything to Blitzers, much less code.  Blitz sales make up about 2% of CShop sales, so few that I stopped sellling it from my own site. <br><br></td></tr></table><br>
<a name="364002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Halo, I don't sell it , so stop, and I don't think you test it :-).<br><br>Look at Candy Particle system, it's very good, but there is not GUI to set parameters and easly use it ...<br><br>If you don't understand that it's not the system, but how it's easy to use it ... <br><br>I can say that a lot of people buy some code, and tool for blitz :-), when they are good and esay to use ...<br><br>You want my system so get it <br><br><br>;==================================================================<br>; Project Title	: Key Binding System<br>;<br>; File			: KBS_V100.bb<br>;<br>; Author		: Poursin Nicolas<br>; Email			: Nicolas.poursin@...<br>;<br>; Version		: 1.0.0          <br>; Date			: 07.05.2004<br>;         <br>;==================================================================<br><br>; Constante to identify the type of action<br>Const KBS_Key			= 1<br>Const KBS_JoystickHit	= 2<br>Const KBS_JoystickAxis	= 3<br>Const KBS_MouseHit		= 4<br>Const KBS_MouseAxis		= 5<br><br><br>; Global to retreive some informations for mouse<br>Global KBS_MWheel#	; mousezspped() if you don't use the BCF 3.0<br>Global KBS_MX#		; mousexspeed()<br>Global KBS_MY#      ; mouseyspeed()<br><br>; Global to retreive some informations for joystick (all joyx(), joyy() etc ...<br>Global KBS_JX#		<br>Global KBS_JY#	<br>Global KBS_JZ#		<br>Global KBS_JU#		<br>Global KBS_JV#<br>Global KBS_JRoll#<br>Global KBS_JPitch#<br>Global KBS_JYaw#<br><br>; Global to set the dead zone of each joystick axis<br>Global KBS_JDeadZone_X# 	= 0.1<br>Global KBS_JDeadZone_Y# 	= 0.1<br>Global KBS_JDeadZone_Z# 	= 0.1<br>Global KBS_JDeadZone_U# 	= 0.1<br>Global KBS_JDeadZone_V# 	= 0.1<br>Global KBS_JDeadZone_Pitch#	= 0.1<br>Global KBS_JDeadZone_Yaw# 	= 0.1<br>Global KBS_JDeadZone_Roll# 	= 0.1<br><br>; internat global for filter axis don't use it<br>Global KBS_joyvx1#,KBS_joyvx2#,KBS_joyvx3#<br>Global KBS_joyvy1#,KBS_joyvy2#,KBS_joyvy3#<br>Global KBS_joyvz1#,KBS_joyvz2#,KBS_joyvz3#<br>Global KBS_joyvu1#,KBS_joyvu2#,KBS_joyvu3#<br>Global KBS_joyvv1#,KBS_joyvv2#,KBS_joyvv3#<br>Global KBS_joyvp1#,KBS_joyvp2#,KBS_joyvp3#<br>Global KBS_joyvyy1#,KBS_joyvyy2#,KBS_joyvyy3#<br>Global KBS_joyvr1#,KBS_joyvr2#,KBS_joyvr3#<br><br><br>; The TYPE :-)<br>Type KBS_Action<br><br>	Field Label$<br>	Field state<br>	Field Value#<br>	Field key1<br>	Field Key2<br>	<br>End Type<br><br><br><br><br>Function KBS_Action( action$ )<br><br>	For c.KBS_Action = Each KBS_Action<br><br>		If c\label$ = action$ Then<br>			Return c\state<br>		EndIf<br>	Next<br><br>	Return False<br>	<br>End Function<br><br>Function KBS_TypeAction( action$, key )<br><br>	For c.KBS_Action = Each KBS_Action<br><br>		If c\label$ = action$ Then<br><br>			If key=1 Then<br>				ak = c\key1<br>			Else<br>				ak = c\key2<br>			EndIf<br><br>			If ak&lt;1000 Then<br>				Return KBS_Key<br>			Else If ak&gt;=1000 And ak&lt;1100 Then<br>				Return KBS_MouseHit<br>			Else If ak&gt;=1100 And ak&lt;2000 Then<br>				Return KBS_MouseAxis<br>			Else If ak&gt;=2000 And ak&lt;2100 Then<br>				Return KBS_JoystickHit<br>			Else If ak&gt;=2100 Then<br>				Return KBS_JoystickAxis<br>			EndIf<br>			<br>		End If<br>	Next<br><br>End Function<br><br>Function KBS_ActionValue#( action$ )<br><br>	For c.KBS_Action = Each KBS_Action<br>		If c\label$ = action$ Then<br>			Return c\value#<br>		EndIf<br>	Next<br>	<br>End Function<br><br><br>;==================================================================<br>; init the action<br>;==================================================================<br>Function KBS_AddAction( label$ , key1 , key2 = -1)<br><br>	For c.KBS_Action = Each KBS_Action<br>		If c\label$ = label$ Then<br>			Return False<br>		EndIf<br>	Next<br><br>	c.KBS_Action = New KBS_Action<br><br>	c\Label$ = label$<br>	c\state = False<br>	c\key1 = key1<br>	c\key2 = key2<br><br>	Return True<br>	<br>End Function<br><br>Function KBS_ChangeAction( label$, key1 , key2  )<br><br>	For c.KBS_Action = Each KBS_Action<br>		If c\label$ = label$<br>			c\key1 = key1<br>			c\key2 = key2<br>					<br>		EndIf<br>	Next<br>End Function<br><br>Function KBS_ChangeActionKey1( label$ , key1 )<br><br>	For c.KBS_Action = Each KBS_Action<br>		If c\label$ = label$<br>			c\key1=key1<br>		EndIf <br>	Next<br>	<br>End Function<br><br>Function KBS_ChangeActionKey2( label$ , key2 )<br><br>	For c.KBS_Action = Each KBS_Action<br>		If c\label$ = label$<br>			c\key2=key2<br>		EndIf <br>	Next<br>	<br>End Function<br><br><br>;==================================================================<br>; The main update fonction, put it in the main loop<br>;==================================================================<br>Function KBS_Update( BCF=False )<br><br>	; Get the mouse informations<br>	If BCF Then<br>		KBS_MWheel# = BCF_MouseZSpeed#<br>	Else<br>		KBS_MWheel#	= MouseZSpeed()<br>	EndIf<br>	<br>	KBS_MX#		= MouseXSpeed()<br>	KBS_MY#		= MouseYSpeed()<br>	<br>	For c.KBS_Action = Each KBS_Action<br><br>		c\value# = KBS_CheckKeyboard#( c\key1)<br>		state = 1<br>		If c\value#=0 Then<br>			<br>			c\value# =  KBS_CheckKeyboard#( c\key2)<br>			state = 2<br>		EndIf<br><br>		If c\Value# = 0 Then<br>			c\state=False<br>		Else<br>			c\state=state<br>		EndIf<br>		<br>	Next<br>	<br>End Function<br><br>Function KBS_CheckKeyboard#( key )<br><br>	<br>	If key&lt;1000 Then<br>		If KeyDown(key) Then <br>			Return 1<br>		Else<br>			Return 0<br>		EndIf<br>	Else<br>		If KBS_CheckJoyMous(key) Then<br>			Return 1<br>		Else<br>			Return KBS_CheckJoyMousAxis(key)<br><br>		EndIf<br>	EndIf<br><br>	<br>End Function<br><br>Function KBS_CheckJoyMous(key)<br><br>	Select key<br>	<br>		; Souris<br>		Case 1001<br>			If MouseDown(1) Then<br>				<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 1002<br>			If MouseDown(2) Then<br>				<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 1003<br>			If MouseDown(3) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 1004<br>			If KBS_MWheel#&gt;=1 Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 1005<br>			If KBS_MWheel#&lt;=-1 Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br><br>		; Joystick<br>		Case 2001<br>			If JoyDown(1) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2002<br>			If JoyDown(2) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2003<br>			If JoyDown(3) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2004<br>			If JoyDown(4) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2005<br>			If JoyDown(5) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2006<br>			If JoyDown(6) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2007<br>			If JoyDown(7) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2008<br>			If JoyDown(8) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br>		Case 2009<br>			If JoyDown(9) Then<br>				Return True<br>			Else<br>				Return False<br>			EndIf<br><br>	End Select<br><br>End Function<br><br>Function KBS_CheckJoyMousAxis#(key)<br><br>	Select Key<br>		Case KBS_Joy_X<br>		<br>			KBS_JX# = KBS_GetJoyX()<br><br>			Return KBS_JX#<br><br>			<br>		Case KBS_Joy_Y<br>		<br>			KBS_JY# = KBS_GetJoyY()<br><br>			Return KBS_JY#<br><br><br>		Case KBS_Joy_Z<br>		<br>			KBS_JZ# = KBS_GetJoyZ()<br><br>			Return KBS_JZ#<br><br>			<br>		Case KBS_Joy_U<br><br>			KBS_JU# = KBS_GetJoyU()<br><br>			Return KBS_JU#<br>			<br>		Case KBS_Joy_V<br>		<br>			KBS_JV# = KBS_GetJoyV()<br>			<br>			Return KBS_JV#<br>			<br>		Case KBS_Joy_Roll<br>		<br>			KBS_JRoll# = KBS_GetJoyRoll()<br>			<br>			Return KBS_JRoll#<br><br>		Case KBS_Joy_Pitch<br>		<br>			KBS_Jpitch# = KBS_GetJoyPitch()<br><br>			Return KBS_Jpitch#<br><br>		Case KBS_Joy_Yaw<br>		<br>			KBS_JYaw# = KBS_GetJoyYaw()<br><br>			Return KBS_JYaw#<br><br>		Case KBS_Mous_Mou_X<br><br>			Return KBS_MX#	<br>			<br>		Case KBS_Mous_Mou_Y<br><br>			Return KBS_MY#	<br>	End Select<br><br>End Function<br><br><br>;==================================================================<br>; Function to create a Control Binding<br>;==================================================================<br>Function KBS_GetLabelCode$( KeyCode )<br><br>	Select KeyCode<br><br>		; -------------<br>		; La souris<br>		; -------------<br>		Case 1001<br>			Return "Right Click"<br>		Case 1002<br>			Return "Left Click"<br>		Case 1003<br>			Return "Wheel Click "<br>		Case 1004<br>			Return "Wheel Up"<br>		Case 1005<br>			Return "Wheel Down"<br>		Case 1100<br>			Return "Mouse X Axis"<br>		Case 1101<br>			Return "Mouse Y Axis"<br>			<br>		; -------------<br>		; Le joystick<br>		; -------------<br>		Case 2001<br>			Return "Button 1"<br>		Case 2002<br>			Return "Button 2"<br>		Case 2003<br>			Return "Button 3"<br>		Case 2004<br>			Return "Button 4"<br>		Case 2005<br>			Return "Button 5"<br>		Case 2006<br>			Return "Button 6"<br>		Case 2007<br>			Return "Button 7"<br>		Case 2008<br>			Return "Button 8"<br>		Case 2009<br>			Return "Button 9"<br><br>		Case 2101<br>			Return "Joy X axis"<br>		Case 2102<br>			Return "Joy Y axis"<br>		Case 2103<br>			Return "Joy Z axis"<br>		Case 2104<br>			Return "Joy U axis"<br>		Case 2105<br>			Return "Joy V axis"<br>		Case 2106<br>			Return "Joy Yaw axis"<br>		Case 2107<br>			Return "Joy Pitch axis"<br>		Case 2108<br>			Return "Joy Roll axis"<br><br><br>		; -----------------------------<br>		; Touches de direction<br>		; -----------------------------<br>		Case 203<br>			Return "Left"<br>		Case 205<br>			Return "Right"<br>		Case 200<br>			Return "Up"<br>		Case 208<br>			Return "Down"<br><br>		; -----------------------------------------------------------------------<br>		; Pave de touche au dessus des touches de direction<br>		; -----------------------------------------------------------------------<br>		Case 210<br>			Return "Insert"<br>		Case 211<br>			Return "Delete"<br>		Case 201<br>			Return "Page Up"<br>		Case 209<br>			Return "Page Down"<br>		Case 207<br>			Return "End"<br>		Case 199<br>			Return "Home"<br><br>		; ----------------------------<br>		; Touches de fonction<br>		; ----------------------------<br>		Case 59<br>			Return "F1"<br>		Case 60<br>			Return "F2"<br>		Case 61<br>			Return "F3"<br>		Case 62<br>			Return "F4"<br>		Case 63<br>			Return "F5"<br>		Case 64<br>			Return "F6"<br>		Case 65<br>			Return "F7"<br>		Case 66<br>			Return "F8"<br>		Case 67<br>			Return "F9"<br>		Case 68<br>			Return "F10"<br>		Case 87<br>			Return "F11"<br>		Case 88<br>			Return "F12"<br><br>		; ------------------------<br>		; Touches de 0 a 9<br>		; ------------------------<br>		Case 2<br>			Return "1"<br>		Case 3<br>			Return "2"<br>		Case 4<br>			Return "3"<br>		Case 5<br>			Return "4"<br>		Case 6<br>			Return "5"<br>		Case 7<br>			Return "6"<br>		Case 8<br>			Return "7"<br>		Case 9<br>			Return "8"<br>		Case 10<br>			Return "9"<br>		Case 11<br>			Return "0"<br>		Case 12<br>			Return "-"<br>		Case 13<br>			Return "="<br>		Case 14<br>			Return "Backspace"<br><br>		; ------------------------------------------------------------------------------------<br>		; Touches de controle ENTER + RETURN + ESCAPE + SPACE<br>		; ------------------------------------------------------------------------------------<br>		Case 1<br>			Return "ESC"<br>		Case 57<br>			Return "Space"<br>		Case 28<br>			Return "Enter"<br>		Case 156<br>			Return "Return"<br>		Case 15<br>			Return "Tab"<br><br>		; -----------------------------------------------<br>		; Touches Ctrl + Alt + shift + window<br>		; -----------------------------------------------<br>		Case 29<br>			Return "Left Control"<br>		Case 157<br>			Return "Right Control"<br>		Case 56<br>			Return "Left Alt"<br>		Case 184<br>			Return "Right Alt"<br>		Case 42<br>			Return "Left Shift"<br>		Case 54<br>			Return "Right Shift"<br>		Case 219<br>			Return "Left Windows"<br>		Case 220<br>			Return "Right Windows"<br><br>		; -------------------------------<br>		; Les lettres + symboles<br>		; -------------------------------<br>		Case 16<br>			Return "Q"<br>		Case 17<br>			Return "W"<br>		Case 18<br>			Return "E"<br>		Case 19<br>			Return "R"<br>		Case 20<br>			Return "T"<br>		Case 21<br>			Return "Y"<br>		Case 22<br>			Return "U"<br>		Case 23<br>			Return "I"<br>		Case 24<br>			Return "O"<br>		Case 25<br>			Return "P"<br>		Case 26<br>			Return "["<br>		Case 27<br>			Return "]"<br>		Case 30<br>			Return "A"<br>		Case 31<br>			Return "S"<br>		Case 32<br>			Return "D"<br>		Case 33<br>			Return "F"<br>		Case 34<br>			Return "G"<br>		Case 35<br>			Return "H"<br>		Case 36<br>			Return "J"<br>		Case 37<br>			Return "K"<br>		Case 38<br>			Return "L"<br>		Case 39<br>			Return ";"<br>		Case 40<br>			Return "'"<br>		Case 41<br>			Return "Grave"<br>		Case 44<br>			Return "Z"<br>		Case 45<br>			Return "X"<br>		Case 46<br>			Return "C"<br>		Case 47<br>			Return "V"<br>		Case 48<br>			Return "B"<br>		Case 49<br>			Return "N"<br>		Case 50<br>			Return "M"<br>		Case 51<br>			Return ","<br>		Case 52<br>			Return "."<br>		Case 53<br>			Return "/"<br><br>		; -----------------------<br>		; Pave numerique<br>		; -----------------------<br>		Case 82<br>			Return "Numpad 0"<br>		Case 79<br>			Return "Numpad 1"<br>		Case 80<br>			Return "Numpad 2"<br>		Case 81<br>			Return "Numpad 3"<br>		Case 75<br>			Return "Numpad 4"<br>		Case 76<br>			Return "Numpad 5"<br>		Case 77<br>			Return "Numpad 6"<br>		Case 71<br>			Return "Numpad 7"<br>		Case 72<br>			Return "Numpad 8"<br>		Case 73<br>			Return "Numpad 9"<br>		Case 83<br>			Return "."<br>		Case 74<br>			Return "-"<br>		Case 78<br>			Return "+"<br>		Case 69<br>			Return "Lock"<br>		Case 181<br>			Return "/"<br>		Case 55<br>			Return "*"<br>	End Select<br>	<br>End Function<br><br>Function KBS_GetActionCode(keyclick=True,mouse=True,joy=True)<br><br><br>	FlushKeys()<br>	FlushMouse()<br>	FlushJoy()<br><br>	<br> 	x# = KBS_JDeadZone_X# 	<br> 	y# = KBS_JDeadZone_Y# 	<br> 	z# = KBS_JDeadZone_Z# 	<br> 	u# = KBS_JDeadZone_U# 	<br> 	v# = KBS_JDeadZone_V# 	<br> 	p# = KBS_JDeadZone_Pitch#<br> 	yy# = KBS_JDeadZone_Yaw# 	<br> 	r# = KBS_JDeadZone_Roll# <br>	<br> 	KBS_JDeadZone_X# 	= 0.7<br> 	KBS_JDeadZone_Y# 	= 0.7<br> 	KBS_JDeadZone_Z# 	= 0.7<br> 	KBS_JDeadZone_U# 	= 0.7<br> 	KBS_JDeadZone_V# 	= 0.7<br> 	KBS_JDeadZone_Pitch#= 0.7<br> 	KBS_JDeadZone_Yaw# 	= 0.7<br> 	KBS_JDeadZone_Roll# = 0.7<br><br>	ju# = KBS_GetJoyU#()<br>	jv# = KBS_GetJoyV#()<br>	jp# = KBS_GetJoyPitch#()<br>	jyw# = KBS_GetJoyYaw#()<br>	jr# = KBS_GetJoyRoll#()<br><br>	ju# = KBS_GetJoyU#()<br>	jv# = KBS_GetJoyV#()<br>	jp# = KBS_GetJoyPitch#()<br>	jyw# = KBS_GetJoyYaw#()<br>	jr# = KBS_GetJoyRoll#()<br>	<br>	scancode=-1<br>	<br>	While scancode=-1<br><br><br>	<br>		For i=1 To 237<br><br>			If keyclick Then<br>				; -------------<br>				; Clavier<br>				; -------------<br>				If KeyDown(i) Then<br>					scancode=i<br>					Exit<br>				EndIf<br><br>				; -------------<br>				; Souris<br>				; -------------<br>				If MouseDown(2) Then<br>					scancode=KBS_Mous_RightClick<br>					Exit<br>				EndIf<br>			<br>				If MouseDown(1) Then<br>					scancode=KBS_Mous_LeftClick<br>					Exit<br>				EndIf<br>			<br>				If MouseDown(3) Then<br>					scancode=KBS_Mous_WheelClick<br>					Exit<br>				EndIf<br>				<br>				w=MouseZSpeed()<br>				<br>				If w&gt;=1 Then<br>					scancode=KBS_Mous_WheelUp<br>					Exit<br>				EndIf<br>				<br>				If w&lt;=-1 Then<br>					scancode=KBS_Mous_WheelDown<br>					Exit<br>				EndIf<br><br>				; -------------<br>				; Joystick<br>				; -------------<br>				If JoyDown(1) Then<br>					scancode=KBS_Joy_button1<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(2) Then<br>					scancode=KBS_Joy_button2<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(3) Then<br>					scancode=KBS_Joy_button3<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(4) Then<br>					scancode=KBS_Joy_button4<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(5) Then<br>					scancode=KBS_Joy_button5<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(6) Then<br>					scancode=KBS_Joy_button6<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(7) Then<br>					scancode=KBS_Joy_button7<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(8) Then<br>					scancode=KBS_Joy_button8<br>					Exit<br>				EndIf<br>	<br>				If JoyDown(9) Then<br>					scancode=KBS_Joy_button9<br>					Exit<br>				EndIf<br><br>			EndIf<br><br>			If mouse Then<br>				If MouseXSpeed()&lt;&gt;0 Then<br>					scancode=KBS_Mous_Mou_X<br>					Exit<br>				EndIf<br><br>				If MouseYSpeed()&lt;&gt;0 Then<br>					scancode=KBS_Mous_Mou_Y<br>					Exit<br>				EndIf<br>			EndIf<br><br><br>			If joy Then<br>			<br>				If KBS_GetJoyX#()&lt;&gt;0 Then<br>					scancode= KBS_Joy_X<br>					Exit<br>				EndIf<br><br>				If KBS_GetJoyY#()&lt;&gt;0 Then<br>					scancode= KBS_Joy_Y<br>					Exit<br>				End If<br><br>				If KBS_GetJoyZ#()&lt;&gt;0 Then<br>					scancode= KBS_Joy_Z<br>					Exit<br>				End If<br><br>				tmp# = KBS_GetJoyU#()<br>				If tmp#&lt;&gt;ju# Then<br>					scancode= KBS_Joy_U<br>					Exit<br>				End If<br><br>				tmp# = KBS_GetJoyV#()<br>				If tmp#&lt;&gt;jv# Then<br>					scancode= KBS_Joy_V<br>					Exit<br>				End If<br><br>				tmp# = KBS_GetJoyYaw#()<br>				If tmp#&lt;&gt;jyw# Then<br>					scancode= KBS_Joy_Yaw<br>					Exit<br>				End If<br><br>				tmp# = KBS_GetJoyPitch#()<br>				If tmp#&lt;&gt;jp# Then<br>					scancode= KBS_Joy_Pitch<br>					Exit<br>				End If<br><br>				tmp# = KBS_GetJoyRoll#()<br>				If tmp#&lt;&gt;jr# Then<br>					scancode= KBS_Joy_Roll<br>					Exit<br>				End If<br><br>			End If<br>			<br>		Next<br>		<br>	Wend<br><br> 	x# = KBS_JDeadZone_X# 	<br> 	y# = KBS_JDeadZone_Y# 	<br> 	z# = KBS_JDeadZone_Z# 	<br> 	u# = KBS_JDeadZone_U# 	<br> 	v# = KBS_JDeadZone_V# 	<br> 	p# = KBS_JDeadZone_Pitch#<br> 	yy# = KBS_JDeadZone_Yaw# 	<br> 	r# = KBS_JDeadZone_Roll#<br>	<br>	Return scancode<br>	<br>End Function<br><br>Function KBS_WaitOldKey()<br><br>	bOk=False<br>	While bOk=False<br>		bOk=True<br>		For i=1 To 237<br>			z = MouseZSpeed()<br>			If KeyDown(i) Or MouseDown(1) Or MouseDown(2) Or MouseDown(3) Or z&lt;&gt;0 Then<br>				bOk=False<br>			EndIf<br>			If JoyDown(1) Or JoyDown(2) Or JoyDown(3) Or JoyDown(4) Or JoyDown(5) Or JoyDown(6) Or JoyDown(7) Or JoyDown(8) Or JoyDown(9) Then<br>				bOk=False<br>			EndIf<br>		Next<br>		<br>	Wend<br>	<br>End Function<br><br><br><br>;==================================================================<br>; Internal Joystick fonction<br>;==================================================================<br>Function KBS_GetJoyX#()<br><br>	joy# = KBS_FilterJoyX#()<br><br>	If Abs(joy#)&lt;KBS_JDeadZone_X# Then joy#=0<br><br>	Return joy# <br>	<br>End Function<br><br>Function KBS_GetJoyY#()<br><br>	joy# = KBS_FilterJoyY#()<br><br>	If Abs(joy#)&lt;KBS_JDeadZone_Y# Then joy#=0<br><br>	Return joy#<br>	<br>End Function<br><br>Function KBS_GetJoyZ#()<br><br>	joy# = KBS_FilterJoyZ#()<br><br>	If Abs(joy#)&lt;KBS_JDeadZone_Z# Then joy#=0<br><br>	Return joy#<br>	<br>End Function<br><br>Function KBS_GetJoyU#()<br><br>	<br>	joy# = KBS_FilterJoyU#()<br><br>	joy# = (joy#-1)*-0.5<br>	<br>	If Abs(joy#)&lt;KBS_JDeadZone_U# Then joy#=0<br>	<br>	Return joy#  <br><br>End Function<br><br>Function KBS_GetJoyV#()<br><br>	<br>	joy# = KBS_FilterJoyV#()<br><br>	joy# = (joy#-1)*-0.5<br>	<br>	If Abs(joy#)&lt;KBS_JDeadZone_V# Then joy#=0<br>	<br>	<br>	Return joy#  <br><br>End Function<br><br>Function KBS_GetJoyPitch#()<br><br>	joy# = KBS_FilterJoyPitch#()<br><br>	joy# = joy#/180<br>	<br>	If Abs(joy#)&lt;KBS_JDeadZone_Pitch# Then joy#=0<br>	<br>	Return joy#<br>	<br>End Function<br><br>Function KBS_GetJoyYaw#()<br><br>	joy# = KBS_FilterJoyYaw#()<br><br>	joy# = joy#/180<br>	<br>	If Abs(joy#)&lt;KBS_JDeadZone_Yaw# Then joy#=0<br>	<br>	Return joy#<br>	<br>End Function<br><br>Function KBS_GetJoyRoll#()<br><br>	joy# = KBS_FilterJoyRoll#()<br><br>	joy# = joy#/180<br>	<br>	If Abs(joy#)&lt;KBS_JDeadZone_Roll# Then joy#=0<br>	<br>	Return joy#<br>	<br>End Function<br><br><br><br><br>Function KBS_FilterJoyX#()<br><br> jl#=JoyX()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=0.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvx3 = KBS_joyvx2<br> KBS_joyvx2 = KBS_joyvx1<br> KBS_joyvx1 = jl<br> <br> If (Abs(KBS_joyvx3-KBS_joyvx2)&gt;0.1) And (Abs(KBS_joyvx2-KBS_joyvx1)&gt;0.1)<br>  	KBS_joyvx2=(KBS_joyvx3+KBS_joyvx1)/2<br> EndIf<br> <br> Return KBS_joyvx2<br> <br>End Function<br><br>Function KBS_FilterJoyY#()<br><br> jl#=JoyY()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=0.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvy3 = KBS_joyvy2<br> KBS_joyvy2 = KBS_joyvy1<br> KBS_joyvy1 = jl<br> <br> If (Abs(KBS_joyvy3-KBS_joyvy2)&gt;0.1) And (Abs(KBS_joyvy2-KBS_joyvy1)&gt;0.1)<br>  	KBS_joyvy2=(KBS_joyvy3+KBS_joyvy1)/2<br> EndIf<br> <br> Return KBS_joyvy2<br> <br>End Function<br><br>Function KBS_FilterJoyZ#()<br><br> jl#=JoyY()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=0.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvz3 = KBS_joyvz2<br> KBS_joyvz2 = KBS_joyvz1<br> KBS_joyvz1 = jl<br> <br> If (Abs(KBS_joyvz3-KBS_joyvz2)&gt;0.1) And (Abs(KBS_joyvz2-KBS_joyvz1)&gt;0.1)<br>  	KBS_joyvz2=(KBS_joyvz3+KBS_joyvz1)/2<br> EndIf<br> <br> Return KBS_joyvz2<br> <br>End Function<br><br>Function KBS_FilterJoyU#()<br><br> jl#=JoyU#()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=1.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvu3 = KBS_joyvu2<br> KBS_joyvu2 = KBS_joyvu1<br> KBS_joyvu1 = jl<br> <br> If (Abs(KBS_joyvu3-KBS_joyvu2)&gt;0.1) And (Abs(KBS_joyvu2-KBS_joyvu1)&gt;0.1)<br>  	KBS_joyvu2=(KBS_joyvu3+KBS_joyvu1)/2<br> EndIf<br> <br> Return KBS_joyvu2<br> <br>End Function<br><br>Function KBS_FilterJoyV#()<br><br> jl#=JoyV#()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=1.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvv3 = KBS_joyvv2<br> KBS_joyvv2 = KBS_joyvv1<br> KBS_joyvv1 = jl<br> <br> If (Abs(KBS_joyvv3-KBS_joyvv2)&gt;0.1) And (Abs(KBS_joyvv2-KBS_joyvv1)&gt;0.1)<br>  	KBS_joyvv2=(KBS_joyvv3+KBS_joyvv1)/2<br> EndIf<br> <br> Return KBS_joyvv2<br> <br>End Function<br><br>Function KBS_FilterJoyPitch#()<br><br> jl#=JoyPitch()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=0.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvp3 = KBS_joyvp2<br> KBS_joyvp2 = KBS_joyvp1<br> KBS_joyvp1 = jl<br> <br> If (Abs(KBS_joyvp3-KBS_joyvp2)&gt;0.1) And (Abs(KBS_joyvp2-KBS_joyvp1)&gt;0.1)<br>  	KBS_joyvr2=(KBS_joyvp3+KBS_joyvp1)/2<br> EndIf<br> <br> Return KBS_joyvp2<br> <br>End Function<br><br>Function KBS_FilterJoyYaw#()<br><br> jl#=JoyYaw()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=0.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvyy3 = KBS_joyvyy2<br> KBS_joyvyy2 = KBS_joyvyy1<br> KBS_joyvyy1 = jl<br> <br> If (Abs(KBS_joyvyy3-KBS_joyvyy2)&gt;0.1) And (Abs(KBS_joyvyy2-KBS_joyvyy1)&gt;0.1)<br>  	KBS_joyvyy2=(KBS_joyvyy3+KBS_joyvyy1)/2<br> EndIf<br> <br> Return KBS_joyvyy2<br> <br>End Function<br><br>Function KBS_FilterJoyRoll#()<br><br> jl#=JoyRoll#()<br> <br> jst$=Str$(jl#)<br> jle=Len(jst$)<br> <br> If jle&gt;10 Then<br>  	If Mid$(jst$,jle-4,1)="e"<br>   		jl=0.0<br>  	EndIf<br> EndIf<br> <br> KBS_joyvr3 = KBS_joyvr2<br> KBS_joyvr2 = KBS_joyvr1<br> KBS_joyvr1 = jl<br> <br> If (Abs(KBS_joyvr3-KBS_joyvr2)&gt;0.1) And (Abs(KBS_joyvr2-KBS_joyvr1)&gt;0.1)<br>  	KBS_joyvr2=(KBS_joyvr3+KBS_joyvr1)/2<br> EndIf<br> <br> Return KBS_joyvr2<br> <br>End Function<br><br><br><br><br>;==================================================================<br>; 						CONSTANTE DECLARATION<br>;==================================================================<br><br>; the mouse<br>Const KBS_Mous_RightClick	= 1001<br>Const KBS_Mous_LeftClick 	= 1002<br>Const KBS_Mous_WheelClick 	= 1003<br>Const KBS_Mous_WheelUp	 	= 1004<br>Const KBS_Mous_WheelDown 	= 1005<br>Const KBS_Mous_Mou_X		= 1100<br>Const KBS_Mous_Mou_Y		= 1101<br><br>; Joystock<br>Const KBS_Joy_button1		= 2001<br>Const KBS_Joy_button2		= 2002<br>Const KBS_Joy_button3		= 2003<br>Const KBS_Joy_button4		= 2004<br>Const KBS_Joy_button5		= 2005<br>Const KBS_Joy_button6		= 2006<br>Const KBS_Joy_button7		= 2007<br>Const KBS_Joy_button8		= 2008<br>Const KBS_Joy_button9		= 2009<br>Const KBS_Joy_X				= 2101<br>Const KBS_Joy_Y				= 2102<br>Const KBS_Joy_z				= 2103<br>Const KBS_Joy_u				= 2104<br>Const KBS_Joy_v				= 2105<br>Const KBS_Joy_Yaw			= 2106<br>Const KBS_Joy_Pitch			= 2107<br>Const KBS_Joy_Roll			= 2108<br><br><br>; Directional KBS_Key<br>Const KBS_Key_Left			= 203<br>Const KBS_Key_Right 		= 205<br>Const KBS_Key_Up 			= 200<br>Const KBS_Key_Down 			= 208<br><br>; INSERT + DELETE + PAGE UP / DOWN + END + HOME<br>Const KBS_Key_Insert 		= 210<br>Const KBS_Key_Delete 		= 211<br>Const KBS_Key_PageUp 		= 201<br>Const KBS_Key_PageDown 		= 209<br>Const KBS_Key_End 			= 207<br>Const KBS_Key_Home			= 199<br><br>; F1 to F12<br>Const KBS_Key_F1 			= 59<br>Const KBS_Key_F2 			= 60<br>Const KBS_Key_F3 			= 61<br>Const KBS_Key_F4 			= 62<br>Const KBS_Key_F5 			= 63<br>Const KBS_Key_F6 			= 64<br>Const KBS_Key_F7 			= 65<br>Const KBS_Key_F8 			= 66<br>Const KBS_Key_F9 			= 67<br>Const KBS_Key_F10 			= 68<br>Const KBS_Key_F11 			= 87<br>Const KBS_Key_F12 			= 88<br><br>;  0 to 9<br>Const KBS_Key_1 			= 2<br>Const KBS_Key_2 			= 3<br>Const KBS_Key_3 			= 4<br>Const KBS_Key_4 			= 5<br>Const KBS_Key_5 			= 6<br>Const KBS_Key_6 			= 7<br>Const KBS_Key_7 			= 8<br>Const KBS_Key_8 			= 9<br>Const KBS_Key_9 			= 10<br>Const KBS_Key_0 			= 11<br>Const KBS_Key_Minus 		= 12<br>Const KBS_Key_Equal 		= 13<br>Const KBS_Key_Backspace 	= 14<br><br>; ENTER + RETURN + ESCAPE + SPACE + Tab<br>Const KBS_Key_ESC 			= 1<br>Const KBS_Key_Space 		= 57<br>Const KBS_Key_Enter 		= 28<br>Const KBS_Key_Return 		= 156<br>Const KBS_Key_Tab 			= 15<br><br>; Ctrl + Alt + shift + window<br>Const KBS_Key_LeftControl 	= 29<br>Const KBS_Key_RightControl 	= 157<br>Const KBS_Key_LeftAlt 		= 56<br>Const KBS_Key_RightAlt 		= 184<br>Const KBS_Key_LeftShift 	= 42<br>Const KBS_Key_RightShift 	= 54<br>Const KBS_Key_LeftWindows 	= 219<br>Const KBS_Key_RightWindows 	= 220<br><br>; A to Z etc ...<br>Const KBS_Key_Q 			= 16<br>Const KBS_Key_W 			= 17<br>Const KBS_Key_E 			= 18<br>Const KBS_Key_R 			= 19<br>Const KBS_Key_T 			= 20<br>Const KBS_Key_Y 			= 21<br>Const KBS_Key_U 			= 22<br>Const KBS_Key_I 			= 23<br>Const KBS_Key_O 			= 24<br>Const KBS_Key_P 			= 25<br>Const KBS_Key_Left_Bracket 	= 26<br>Const KBS_Key_Right_Bracket = 27<br><br>Const KBS_Key_A 			= 30<br>Const KBS_Key_S 			= 31<br>Const KBS_Key_D 			= 32<br>Const KBS_Key_F 			= 33<br>Const KBS_Key_G 			= 34<br>Const KBS_Key_H 			= 35<br>Const KBS_Key_J 			= 36<br>Const KBS_Key_K 			= 37<br>Const KBS_Key_L 			= 38<br>Const KBS_Key_SemiColon		= 39<br>Const KBS_Key_Apostrophe 	= 40<br>Const KBS_Key_Grave 		= 41<br><br>Const KBS_Key_Z 			= 44<br>Const KBS_Key_X 			= 45<br>Const KBS_Key_C 			= 46<br>Const KBS_Key_V 			= 47<br>Const KBS_Key_B 			= 48<br>Const KBS_Key_N 			= 49<br>Const KBS_Key_M 			= 50<br>Const KBS_Key_Comma 		= 51<br>Const KBS_Key_Period 		= 52<br>Const KBS_Key_Slash 		= 53<br><br>; Number<br>Const KBS_Key_Numpad0 		= 82<br>Const KBS_Key_Numpad1 		= 79<br>Const KBS_Key_Numpad2 		= 80<br>Const KBS_Key_Numpad3 		= 81<br>Const KBS_Key_Numpad4 		= 75<br>Const KBS_Key_Numpad5 		= 76<br>Const KBS_Key_Numpad6 		= 77<br>Const KBS_Key_Numpad7 		= 71<br>Const KBS_Key_Numpad8 		= 72<br>Const KBS_Key_Numpad9 		= 73<br><br>Const KBS_Key_Decimal		= 83<br>Const KBS_Key_Substract		= 74<br>Const KBS_Key_Add 			= 78<br>Const KBS_Key_Lock 			= 69<br>Const KBS_Key_Div 			= 181<br>Const KBS_Key_Mult			 = 55 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
