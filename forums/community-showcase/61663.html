<!DOCTYPE html><html lang="en" ><head ><title >Leadwerks engine portal system</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Leadwerks engine portal system</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Leadwerks engine portal system</a><br><br>
<a name="689212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's what I have been working on.<br><br>This demo presents the engine's portal occlusion system:<br><a href="http://www.leadwerks.com/ccount/click.php?id=27" target="_blank">http://www.leadwerks.com/ccount/click.php?id=27</a> (41.3 mb)<br><br>Patch for faster loading:<br>www.leadwerks.com/files/enginepatch1.zip<br><br>HOW TO RUN IT<br>Use a .bat file to launch any map in the engine. If you get a virus warning, disable your anti-virus program. This is a known error with Avast.<br><br>WHAT TO LOOK FOR<br>Use wireframe mode to see how the portal system works.<br><br>Set your 3D World Studio textures, mesh, and map paths to the engine directories. Open "simple_portals.3dw" in the editor. The map is split into two portalzones. Everything within the portalzone is clipped and treated as one "chunk". The portal brush connects them, and only has one face that isn't deleted. When the camera is in one portalzone, the adjacent portalzone is only visible if the connecting portal is in the camera frustum. Models in the adjacent portalzone are only visible if they can be seen through the connecting portal.<br><br>If you want to make an indoor/outdoor map, add a portal brush that only touches one portalzone. The outside world is treated as one big default portalzone, and any one-sided portal will connected to the outside.<br><br>CONTROLS<br>W - toggle wireframe<br>S - toggle stats<br>space - toggle materials<br>L - toggle lights<br>C - toggle colors<br>B - show hidden geometry<br>P - toggle portal culling<br>F - toggle frustum culling<br><br>KNOWN BUGS<br>Memory leak<br><br>Leadwerks forum topic:<br><a href="http://www.leadwerks.com/forums/viewtopic.php?p=7221#7221" target="_blank">http://www.leadwerks.com/forums/viewtopic.php?p=7221#7221</a><br><br><img src="http://www.leadwerks.com/screenshots/shot49.jpg"> <br><br></td></tr></table><br>
<a name="689224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>It seems nice! I get some terrain popping and a fence going transparent, but apart from that it seems to work fine.<br><br>It opens a bit weird, not in full screen but in the top left corner of my desktop...<br><br>Transparent fence:<br><img src="http://www.frecle.net/misc/3ng1n3.jpg"> <br><br></td></tr></table><br>
<a name="689251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WedgeBob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, okay, when I saw this thread at first, I thought you were trying to do like what Prey and HL2: Ep 2 with portal technology similar to theirs.  Thanks for the clarification.  If it were me, I'd try those gravity tracks next, those'd be awesome... <br><br></td></tr></table><br>
<a name="689264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maximo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> anazubg granisc :) <br><br></td></tr></table><br>
<a name="689277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Congrats - I hate this stuff :) Especially because (as I already mentioned) if I once made my Occlusion work, hiding and showing things was still slower than simply leave them clustered and let Blitz occlude them as good as it gets. <br><br></td></tr></table><br>
<a name="689285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is BlitzMax and OpenGL by the way, not Blitz3D. <br><br></td></tr></table><br>
<a name="689286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice... :)<br><br>IPete2. <br><br></td></tr></table><br>
<a name="689301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Complex not working, previous Simple_portal , working fine but not fullscreen but left upper corner of screen.. <br><br></td></tr></table><br>
<a name="689304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't worry about the window placement.  That is just so I can do other things while it is loading.<br><br>The complex map just takes a long time to load. <br><br></td></tr></table><br>
<a name="689355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> complex not working here too. just popping up the engine's window and closing again. thats it. <br><br></td></tr></table><br>
<a name="689362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nrasool</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> complex portal is not working for me, just seems to stay on the black screen saying "Loading", even thou it been sitting there for 6 mins with no HDD activity :( <br><br></td></tr></table><br>
<a name="689571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems that the longest step when loading is processing lights on all models the first time.  This takes more than one minute on my machine.<br><br>The engine lights models a bit differently than the editor.  In the editor, I calculated lighting for each vertex.  In the engine I am just doing a single visibility check between the center of the model and the light position, and using hardware lights on the entire model.  This gives slightly less accurate lighting than coloring each vertex, but the upside is that static and dyanmic lighting are just the same, for models.  It also means that the mesh color array can be used for bumpmaps.  HL2 uses this same exact method.  You'll notice their models are either lit completely by any given light, or are unaffected.<br><br>A good solution would be for the engine to process the lighting once, then save the results to a file that goes along with the .3dw file.  You will only have to do the slow light processing once any time you change the map.  After that, the editor will detect and load the associated light info file. <br><br></td></tr></table><br>
<a name="689615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> This patch will make it so lighting only has to be processed the first time you load a map.  The data is saved to a .lit file, associated with the .3dw map.  If the number of entities or lights in the file changes, lights will be reprocessed.  You can also just delete the .lit file to reset lighting.<br><br>I included the two .lit files for you, so the maps will load much faster:<br><a href="http://www.leadwerks.com/files/enginepatch1.zip" target="_blank">http://www.leadwerks.com/files/enginepatch1.zip</a> <br><br></td></tr></table><br>
<a name="689640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm going to have a go on this tomorrow. <br><br></td></tr></table><br>
<a name="689772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Red Ocktober</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> complex worked ok here... GeForce6100... took a lil while to load, but showed performance effect of portals when inside and outside of the buildings...<br><br>verrry decent stuff... looks great... and useful for a fps type environment...<br><br>question... portals and moving interiors... will it work if i have and interior that rotates...<br><br>what about if an interior moves along the x, y, and z?<br><br>--Mike <br><br></td></tr></table><br>
<a name="689858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't thought about moving portal systems, but I suppose it would work.  What would be the application? <br><br></td></tr></table><br>
<a name="689878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Red Ocktober</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> a ship or large vessel moving... like an aircraft carrier...<br><br>if it's not already implemented, don't get distracted with it now... not important as it can be circumvented...<br><br>how's the engine coming?<br><br><br>--Mike <br><br></td></tr></table><br>
<a name="689959"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://img356.imageshack.us/img356/5606/portaltutfs6.jpg"> <br><br></td></tr></table><br>
<a name="690325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> www.leadwerks.com/files/EnginePatch2.zip<br><br><img src="http://leadwerks.com/post/port.jpg"><br><br>Added cubemap reflections, corona, env_cubemap entities.<br><br>Some info on here:<br>www.leadwerks.com/developer/<br><br>Go to entities&gt;corona and env_cubemap.<br><br>Don't have time to type everything but, but it will grow.<br><br>Let the good times roll! <br><br></td></tr></table><br>
<a name="690350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> complex not working. just opens window, says "loading..." and the same moment it closes again. thats it. no error message no demo no nothing. <br><br></td></tr></table><br>
<a name="690450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drey</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this your openGL project or is this Blitz3d? <br><br></td></tr></table><br>
<a name="690452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is this your openGL project or is this Blitz3d?  <br></div> -&gt; <div class="quote"> This is BlitzMax and OpenGL by the way, not Blitz3D.  <br></div> <br><br></td></tr></table><br>
<a name="690660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drey</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm lil curious why this is running at 15 fps sometimes on my x1900xt?(yes latest drivers) Portals only slow things down on my system too.  But i figure that's just because the power of the card outweights the performance of the CPU checking for visible objects. <br><br></td></tr></table><br>
<a name="692729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I sped it up to 50-60 FPS.  Keep in mind this scene was supposed to be demanding, and is likely to run slowly. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
