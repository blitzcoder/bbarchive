<!DOCTYPE html><html lang="en" ><head ><title >Stellar Expansion</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Stellar Expansion</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Stellar Expansion</a><br><br>
<a name="1223520"></a>

<a name="1223529"></a>

<a name="1223534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >-Rick-</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Working on a 4x game and have given myself the challenge of completing it to playability by the end of the year. At this point I've been working for about 2 months.<br><br>Single player game against AI opponents (up to 7). The environment consists of 50 to 150 Stars arranged in various "Galaxy Patterns" such as Spiral, Clumped, Ringed, and Evenly Dispersed. Each star has 1 to 10 planets. <br><br>While the pace of the game is time oriented with variable speed and pause, it still plays much like a turn based game. There are a lot of features that I would like to describe, but I'm still in the early Alpha stages and much has not yet been implemented so those features might change.<br><br>I wanted to get a few images out there because I've been getting some greatly appreciated help on a couple issues and thought seeing what I'm doing might give a better understanding of the things I describe.<br><br>I really have no place other than facebook to post images to so am hoping that there aren't any issues with people having access to see them. Let me know if there are.<br><br><a href="https://www.facebook.com/photo.php?fbid=10152117380874624&amp;set=a.10152117380514624.1073741826.620769623&amp;type=3&amp;permPage=1" target="_blank">Click here to see a couple screenshots</a><br><br>Little disappointed out how bad the images look. Their original size is 1024x768. Between the the jpg conversion and the reduced size from facebook they came out pretty crappy. Probably should also point out that all the images currently in there are just placeholder images. Intend to sexy things up a lot more once I have the code stabilized and running more completely. <br><br></td></tr></table><br>
<a name="1223569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >feeble1</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really like the look of your gui. <br><br></td></tr></table><br>
<a name="1223582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >-Rick-</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Added in a few more screenshots to better display the different galaxy shapes in game generation. <br><br></td></tr></table><br>
<a name="1223609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice kinda the same route I'm going with Star Rogue :) <br><br></td></tr></table><br>
<a name="1224499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >-Rick-</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Worked up a technology Tree Creator that I'll be using to create my various game technologies. It creates a .dat file that can then be used by another program.<br><br>If no .dat file exists it starts off with a few basic technologies. The "Save File" turns red if it detects that there have been changes as a reminder to save and update the file. <br><br>It has 12 technology fields ranging from propulsion to materials to spying. Each field can track up to 5 levels of a technology. You can tie technologies together to become available only after other technologies have been researched and even mark those older technologies as becoming 'obsolete' once the new technology has completed researching. Clicking on a technology shows its specifics.<br><br>Each tech also lets you set 64 modifiers that are color coded to specific tasks. For example, gray is used for over-all values like the cost to build the technology, if it can go on ships or planets, cost, etc while black fields are related to spying modifiers.<br><br>I also put in a tech tree viewer to display what technology paths are required to reach that technology - however that part is a little buggy and needs more work. It lists all required techs for each branch and doesn't optimize by taking out duplicate techs. And I think its not entirely accurate in how it connects them together. Its just something I wanted to take a stab at but felt wasn't critical enough to perfect at this time in my own program using this.<br><br>Just thought this might be interesting or useful for some people.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ************************************************************
; * Project Name: Stellar Expanse Technology Tree Creator
; * Author(s): Eric Blackwell
; * Date Started: 3:37 pm March 8, 2014
; * Version Date SEETC 1.0a 3:37 pm  March 8, 2014
; * Version Date SEETC 1.0b 4:29 am  March 10 2014
; * Version Date SEETC 1.0c 12:58p m March 11 2014
; *
; * Current Version:  SEETTC 1.0d
; ************************************************************

;Special Thanks
;--------------
;Another GUI by Rob Farley
;http://www.blitzbasic.com/codearcs/codearcs.php?code=1470
;
;Word Wrap
;http://www.blitzbasic.com/Community/posts.php?topic=86784#983804
;by Shortwind and _Skully

Graphics 1024,768,16,2
SetBuffer BackBuffer()

Type TechTree
	Field x1,x2,y1,y2				;location in tech tree
	Field Name$						;Name of tech
	Field class$					;Class of tech
	Field Req.TechTree				;Techs required to have this tech
	Field Obsolete$					;Techs made obsolete
	Field Requirements				;# of requirement techs
	Field Added						;Number of req.techtree made
	Field Parent					;Which Branch TechTree is connected with
End Type

Type Technology
	Field ID						;ID of Technology
	Field Class$					;Tech Class it falls in
	Field Level						;Tier Level of Weapon
	Field Name$						;Name of Technology
	Field Requirements				;Number of Requirements
	Field Requires$[5]				;Array of Required techs
	Field CompTime					;Standard # Months to Research
	Field Descrip$					;255 word description of tech
	Field Completed					;Boolean : Research Complete / Not Complete
	Field Invested					;Number of Months Invested
	Field Done						;Boolean : Is All Tech info entered?
	Field Ready						;Boolean : Is it ready to Research?
	Field Marked					;Boolean : Player can Mark it to Remember to Research it
	Field Effect.Effects			;All Technology Effects
	Field Obsolete$					;Tech/ID of old technology replaced with this technology
End Type

;Technology Effects
Type Effects
;Component
	Field Slots						;How Many Slots takes up
	Field Health					;Component Health
	Field Ships						;Boolean : Can be used on Ships
	Field Planet					;Boolean : Can be used on Planet
	Field Cost						;Base Res Cost of Item
	Field Facing					;Where Mounted : 0=NA,1=Fore,-1=Aft
;Generators
	Field ENeed						;Energy Requirements
	Field EMake						;Energy Created
	Field EStore					;Max Energy Storage
;Scanners
	Field ScanRange					;Scanner Range in ly
	Field WeapRangeBonus			;% Increases Weapon Range
;Weapon
	Field Dmg						;Base Damage (Default Shield Armor to Component to Crew)
	Field SDmg						;% Shield Damage
	Field HDmg						;% Hull Damage
	Field CDmg						;% Component Damage
	Field CrDmg						;% Crew Dmg
	Field WRange					;Base Weapon Range
	Field WArc						;Base Weapon Arc
	Field WSpeed					;Weapon Flight Speed
	Field WHealth					;In cases like fighters
	Field Rounds					;Number Times can be fired
;Shields
	Field ShHealth					;Shield Effectiveness
	Field ShvsEnergy				;% damage taken from beam weaps (lasers/mazers/etc)
	Field ShvsKin					;% damage vs Kinetic type (missles/mass driver/cannon/etc)
	Field ShvsArea					;% damage vs Area weaps (radiation/graviton/temproal/etc)
	Field ShPlanet					;% dam reduction for planet
	Field ShCloak					;% Reduces Enemy Targeting
	Field Drain						; (25) How Much shield (cloak type) drains energy
;Propulsion
	Field MaxSpeed					;Max Warp Speed
;Defenses
	Field Absorb					;% Damage converted to energy
	Field RprLimit					;% armor Health it can repair up to
	Field Rpr						;% armr each day repairs self
;Planetary
	Field PopGrow					;% Population growth increases
	Field Recycle					;% Pop Res Requirement Decreases
	Field Mining					;% Mining increases
	Field Research					;% Increases Research
	Field Moral						;% Moral on Planet Increases
	Field PrdCost					;% Reduces Production Costs
	Field ConCost					;% Reduces Construction/Repair Costs
	Field BldTime					;% Reduces BuildTime
	Field Combat					;% Increases targeting
	Field Repair					;% Decreases Repair time
;Spy
	Field SpyAcc					;% spy info is accurate
	Field SpyWarn					;% Chance to know if enemy launching attack
	Field SpyTheft					;% that can be stolen/sabotaged (pop/economy % of whole, ship/art % of single)
	Field SpyThftRes				;% can steal Resources
	Field SpyThftShp				;% can steal Ship
	Field SpyThftPop				;% can get enemy pop to join
	Field SpyThftArt				;% can steal artifacts
	Field SpyThftTech				;% can steal Technology
	Field SabRes					;% can cause enemy res to vanish
	Field SabShip					;% ship in dock can be damaged
	Field SabPop					;% Pop become Insurgent and riot
	Field SabArt					;% can destroy artifact
	Field SabEnv					;% Chance to reduce planet class by 1
	Field SabCol					;% chance to damage colony components
	Field SabTech					;% Chance to destroy Research in their current Research Field
;Social
	Field Harmony					;% Colony resists SabPop,SpyThftPop
	Field Educ						;% Colony resists SabRes,SpyThftRes
	Field Vigil						;% Colony resists sabShip,SabCol,SpyThftShip,SpyThftArt
	Field Patriot					;% colony resists sabEnv,sabArt,SpyThftArt
	Field Security					;(59)% colony resists SabTech,SpyThftTech
;Ships
	Field Range						;Cargo/Colony/Torpedo How Far they can go
	Field Size						;How many components/colonists ship holds
	
End Type

Global Save_File_Version$ = "Stellar Expanse Technology Tree Creator Version 1.0d"
Global FileName$ = "SETTC.dat"
Global FileSaveIsCurrent
Global SystemMessage$
Global SoundOn = False

Global EndProgram = False
Global WIDTH = GraphicsWidth()
Global HEIGHT = GraphicsHeight()

Global fntText,fntNorm,fntTitle,fntMenu,fntDef
	fntText =LoadFont("fonts/blitz",14,True,False,False)
	fntNorm =LoadFont("fonts/blitz",16,True,False,False)
	fntTitle=LoadFont("fonts/blitz",72,True,False,False)
	fntMenu =LoadFont("fonts/blitz",22,False,False,False)
	fntDef	=LoadFont("fonts/blitz",22,False,False,False)
	
Global MenuSelect = 0
Global Choice$,Level,Name$			;Class,Level,Weapon Name
Global Scroll						;scroll weapon list
Global TextInput$					;Hold String until acceptable
Global GhostText$					;To allow copy of old text
Global cx1,cy1						;Cursor Position
Global EffectDone = False			;Boolean : Effect Selection Done

;Load Example Techs in case savefile is missing
Restore TechData
Read Techs
For count = 1 To techs
	t.technology = New Technology
	Read t\id
	Read t\class
	Read T\Level
	Read t\name
	Read t\requirements
	Read t\comptime
	If t\requirements &lt;&gt; 0 Then
		For count2 = 1 To t\requirements
			Read t\requires[count2]
		Next
	EndIf
	t\done = True
	t\effect.effects = New Effects
Next

;	ID	Class		Level	Name		Req	Buildtime
.TechData
Data 22
Data  1,"WEAPONS",		1,"POINT DEFENSE",	0,20
Data  2,"DEFENSES",		1,"HULL PLATING",	0,20
Data  3,"PROPULSION",	1,"CHEMICAL DRIVE",	0,20
Data  4,"ENERGY",		1,"CONVENTIONAL",	0,20
Data  5,"GENERATORS",	1,"COMBUSTION",		0,20
Data  6,"MATERIALS",	1,"VULCANIZED",		0,20
Data  7,"SCANNERS",		1,"OPTICAL",		0,20
Data  8,"MODULES",		1,"LIFE SUPPORT",	0,20
Data  9,"PLANETARY",	1,"RECYCLING",		0,20
Data 10,"SOCIAL",		1,"UNIFIED",		0,20
Data 11,"SPYCRAFT",		1,"OBSERVATION",	0,20
Data 12,"WEAPONS",		2,"HARD POINT GUN",	1,50
Data "POINT DEFENSE"
Data 13,"WEAPONS",		2,"LASER TURRET",	1,50
Data "POINT DEFENSE"
Data 14,"WEAPONS",		3,"MASER CANNON",	2,80
Data "LASER TURRET"
Data "SYNTHETIC"
Data 15,"WEAPONS",		2,"MASS DRIVER",	1,80
Data "POINT DEFENSE"
Data 16,"WEAPONS",		2,"MISSILES",		1,80
Data "POINT DEFENSE"
Data 17,"WEAPONS",		2,"FIGHTER SQUAD",	1,80
Data "POINT DEFENSE"
Data 18,"WEAPONS",		2,"FIELD RADIATION",1,80
Data "POINT DEFENSE"
Data 19,"WEAPONS",		2,"ENERGY PULSE",	1,80
Data "POINT DEFENSE"
Data 20,"DEFENSES",		2,"HARDENED ARMOR",	1,80
Data "MISSILES"
Data 21,"SHIP HULLS",	1,"SCOUT",			0,20
Data 22,"MATERIALS",	2,"SYNTHETIC",		1,50
Data "VULCANIZED"

;Set up DIM for displaying Techs in Proper Tier Level
Dim TierX(5)
Dim TierY(5)
Dim Row(12)
FileSaveIsCurrent = True
SystemMessage = Load_Tech_File()


While Not EndProgram
	If KeyHit(1) Then EndProgram = True
	Cls()
	SetCol("white")
	SetFont fntMenu
	Button (False,WIDTH/2-75,25,"MENU",150,20)
	count = 0
	For t.Technology = Each Technology
		count = count + 1
	Next
	SetFont fntText
	Button(False,WIDTH/2-50,50,"TOTAL TECHS",100,18)
	SetCol("yellow")
	SetFont fntNorm
	Text WIDTH/2,80,count,1,1
; ************************************************************************************************************
;Show Mouse X/Y Location
;SetFont fntText
;Text 0,10,"x :"+MouseX()+" y:"+MouseY()
;SetFont fntNorm
; ************************************************************************************************************

;Create Button
	If Button (True,WIDTH/4,60,"CREATE TECH",150,20) Then
		For t.technology = Each Technology
			count = count + 1
		Next
		t.technology = New Technology
		t\effect.effects = New Effects
		t\id = count
		t\requirements = -1
		For count = 1 To 5
			t\requires[count] = ""
		Next
		t\obsolete = "***"
		t\comptime = -1
		FileSaveIsCurrent = False
		MenuSelect = 1
		Choice$ = ""
		EffectDone = False
		For count = 1 To 12
			Row(count) = 0
		Next
	EndIf
;Edit / Delete Button
	If Choice &lt;&gt; "" And Level &lt;&gt; 0 And Name &lt;&gt; "" Then
	;Show if Specific Tech Selected
		If Button(True,WIDTH/2+WIDTH/4-150,60,"EDIT/DELETE",150,20) Then 
			MenuSelect = 2
			FileSaveIsCurrent = False
		EndIf
	Else
	;Subdue and unclickable if no record selected
		Button(False,WIDTH/2+WIDTH/4-150,60,"EDIT/DELETE",150,20,0,0,0,50,50,50)	
	EndIf
;Save File Button
	If FileSaveIsCurrent Then
	;green if file save is current
		If Button (True,WIDTH/4,100,"SAVE TECH",150,20,50,200,50,0,0,0,0,250,0) Then
			SystemMessage = Save_Tech_File()
			FileSaveIsCurrent = True
		EndIf
	Else
	;red if file save is not current
		If Button (True,WIDTH/4,100,"SAVE TECH",150,20,200,50,50,0,0,0,0,250,0) Then
			SystemMessage = Save_Tech_File()
			FileSaveIsCurrent = True
		EndIf
	EndIf
;Tech Tree Button
	If Choice &lt;&gt; "" And Level &lt;&gt; 0 And Name &lt;&gt; "" Then
		If Button(True,WIDTH/2-75,100,"TECH TREE",150,20)
			MenuSelect = 4
			Generate_Tree()
		EndIf
	Else
	;Subdue and unclickable if no record selected
		Button(False,WIDTH/2-75,100,"TECH TREE",150,20,0,0,0,50,50,50)	
	EndIf
	
;Quit Button
	If Button(True,WIDTH/2+WIDTH/4-150,100,"QUIT",150,20) Then EndProgram = True
	Button (False,0,135,"",WIDTH,5)
	For t.technology = Each Technology
		If Not t\done Then Exit
	Next
	SetFont fntNorm
;File Load/Save System Message
	If MenuSelect = 4 Then
		SetFont fntText
		x = 20
		y = 400
		done = False
		For count = 0 To 100
			Rows = 0
			For tech.techtree = Each TechTree
				If tech\parent = count Then Rows = Rows + 1
			Next
			If Rows = 0 Then 
				done = True
			Else
				For tech.techtree = Each TechTree
					If tech\parent = count Then
						Button(False,tech\x1,tech\y1-10,tech\class,100,12,50,130,130)
						If Button(True,tech\x1,tech\y1+2,tech\name,100,12) Then
							Name = tech\name
							Choice = tech\class
							MenuSelect = 0
						EndIf
						SetCol("yellow")
						Line tech\x1,tech\y1,tech\x2,tech\y2
						;y = y + 40
					EndIf
				Next
				;x = x + 125
				;y = 400
			EndIf
			If done = True Then Exit
		Next
		SetFont fntNorm
		If Button(True,WIDTH/2-50,HEIGHT - 100,"EXIT",100,20) Then MenuSelect = 0
	ElseIf MenuSelect = 3 Then
		x = StringWidth(SystemMessage) / 2
		y = StringHeight(SystemMessage) / 2
		If Button(True,WIDTH/2-x-25,HEIGHT/2-y,SystemMessage,x*2+50,60) Then
			MenuSelect = 0
		EndIf
;Create Tech
	ElseIf MenuSelect = 1 Then	
		If t &lt;&gt; Null Then
			If t\done = False Then Create_Tech(t.technology)
		EndIf
;Edit Tech
	ElseIf MenuSelect = 2 Then
		SetCol("yellow")
		For t.technology = Each Technology
			If t\class = Choice And t\Level &lt;&gt; 0 And t\name = Name Then
				edit_tech(220,240,t)
				Exit
			EndIf
		Next
		If Button(True,50,700,"EXIT",150,20) Then
			Choice = ""
			Level = 0
			Name = ""
			MenuSelect = 0
		EndIf
		If Button(True,WIDTH-200,700,"DELETE",150,20) Then
			For t.technology = Each Technology
				If Choice = t\class And Level = t\Level And Name = t\name Then Exit
			Next
			Choice = ""
			Level = 0
			Name = ""
			MenuSelect = 0
			Delete t
			FileSaveIsCurrent = False
		EndIf
;Display Tech
	ElseIf MenuSelect = 0 Then
			txt$ = "TECHNOLOGY FIELDS"
			Button(False,WIDTH/2-StringWidth(txt)/2-25,150,txt,StringWidth(txt)+50,18)
		If Button(True,WIDTH/2-500,180,"WEAPONS",150,20) Then
			Choice$ = "WEAPONS"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2-330,180,"DEFENSES",150,18) Then
			Choice$ = "DEFENSES"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2-160,180,"PROPULSION",150,18) Then
			Choice$ = "PROPULSION"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2+10,180,"ENERGY",150,18) Then
			Choice$ = "ENERGY"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2+180,180,"GENERATORS",150,18) Then
			Choice$ = "GENERATORS"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2+350,180,"MATERIALS",150,18) Then
			Choice$ = "MATERIALS"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2-500,210,"SCANNERS",150,18) Then
			Choice$ = "SCANNERS"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2-330,210,"MODULES",150,18) Then
			Choice$ = "MODULES"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2-160,210,"PLANETARY",150,18) Then
			Choice$ = "PLANETARY"
			Name$ = ""	
		EndIf
		If Button(True,WIDTH/2+10,210,"SOCIAL",150,18) Then
			Choice$ = "SOCIAL"
			Name$ = ""
		EndIf
		If Button(True,WIDTH/2+180,210,"SPYCRAFT",150,18) Then
			Choice$ = "SPYCRAFT"
			tn$ = ""
		EndIf
		If Button(True,WIDTH/2+350,210,"SHIP HULLS",150,18) Then
			Choice$ = "SHIP HULLS"
			tn$ = ""
		EndIf
		
		Button(False,0,240,Choice + " TECHNOLOGY TREE",WIDTH,18,50,150,150)
		SetFont fntText
		Button(False,0,510,"RESEARCH TIME",100,12)
		Button(False,0,570,"MAKES OBSOLETE",100,12)
		Button(False,110,510,"REQUIREMENTS",120,12)
		Button(False,240,510,Name + " LEADS TO",380,12)
		Button(False,630,510,"Tech Description",WIDTH-630,12)
		SetFont fntNorm
		SetCol("teal")
		Line 0,275,WIDTH,275
		x = 35: y = 260
		For count = 1 To 5
			Text x,y,"Level "+count
			x = x + 200
		Next
		Startx = 35
		Starty = 280
		For count = 1 To 5
			TierX(count) = 0
			TierY(count) = 0
		Next
	;List Technologies in Proper Tier Level	
		For t.technology = Each Technology
			If t\class = Choice Then
				x = startx + (t\level - 1) * 200
				y = starty + TierY(t\level)*25
				If Name$ = t\name Then
					r=50:g=200:b=200
				Else
					r=150:g=150:b=150
				EndIf
				If Button (True,x,y,t\name,150,18,r,g,b) Then Name$ = t\name
				TierY(t\level) = TierY(t\level) + 1
				Level = t\level
			;If Tech is clicked on Show Info
				If t\name = Name Then
					If Button(True,25,530,t\comptime,50,20) Then t\comptime = Get_Value(25,490)
					x1 = 110
					y1 = 540
					For tt.technology = Each Technology
						If tt\name = Name Then Exit
					Next
				;List Required Technologies of Selected Tech
					has = False
					SetFont fntText
					For count = 1 To 5
						If t\requires[count] &lt;&gt; "" And tt\name = t\name Then
							For ttt.technology = Each Technology
								If ttt\name = tt\requires[count] Then Exit
							Next
						;color code based on tech level comparison
							If t\level &lt; ttt\level Then
								r=200:g=50:b=50;		;red
							ElseIf t\level = ttt\level Then
								r=200:g=200:b=50		;yellow
							Else
								r=50:g=200:b=50			;green
							EndIf
							Button(False,x1,y1-10,ttt\class,120,12,r,g,b)
							If Button(True,x1,y1+2,tt\requires[count],120,12) Then
								Name = tt\requires[count]
								For ttt.technology = Each Technology
									If ttt\name = Name Then
										Choice = ttt\class
									EndIf
								Next
							EndIf
							y1 = y1 + 28
							has = True
						EndIf
					Next
					
					If Not has Then Button(False,120,530,"NONE",100,20)
					x1 = 240
					y1 = 540
					has = False
				;List Technologies made available by this tech
					For tt.technology = Each Technology
						For count = 1 To 5
							If tt\requires[count] = t\name Then
								For ttt.technology = Each Technology
									If ttt\name = tt\name Then Exit
								Next
								Button(False,x1,y1-10,ttt\class,120,12,50,150,150)
								If Button(True,x1,y1+2,tt\name,120,12) Then
									Name = tt\name
									Choice = tt\class
								EndIf
								x1 = x1 + 130
								If x1 &gt; 600 Then;Y
									x1 = 240
									y1=y1 + 28
								EndIf
								has = True
							EndIf
						Next
					Next
				;Display Tech Description
					SetCol("white")
					WordWrap(t\descrip,60,630,530,15)
					x= 230
					y= 615
					Edit_Effects(x,y,t.Technology)
					SetFont fntText
				;Show Technology made Obsolete by this Tech
					If t\obsolete = "" Then
						Button(False,0,590,"NOTHING",100,18)
					Else
						Button(False,0,590,t\obsolete,100,18)
					EndIf
					SetFont fntNorm
				EndIf
			EndIf
		Next
	EndIf
	SetCol("black")
	Oval MouseX()-3,MouseY()-3,6,6
	SetCol("white")
	Oval MouseX()-2,MouseY()-2,4,4
	Flip()	
Wend
End

Function Generate_Tree()
	Delete Each TechTree

	For tech.Technology = Each Technology
		If tech\name = Name Then Exit
	Next
	tree.techtree = New TechTree
	tree\name = Name
	tree\class = Choice
	tree\requirements = tech\requirements
	tree\obsolete = tech\obsolete
	tree\parent = 0
	tree\added = 0
	tree\x1 = 0
	tree\y1 = 400
	tree\x2 = 0
	tree\y2 = 400
	
	done = False
	While Not done
		done = True
		For tree.techtree = Each TechTree
			If tree\added &lt;&gt; tree\requirements Then
				;Get actual tree info
				For treeinfo.Technology = Each Technology
					If treeinfo\name = tree\name Then Exit
				Next
				;Create TechTree for each Requirement
				
				For count = 1 To treeinfo\requirements
					branch.techtree = New TechTree
					branch\name = treeinfo\requires[count]
					;Get Info on Branch
					For branchinfo.Technology = Each Technology
						If branchinfo\name = treeinfo\requires[count] Then Exit
					Next
					;Fill in branch info
					branch\class = branchinfo\class
					branch\requirements = branchinfo\requirements
					branch\obsolete = branchinfo\obsolete
					branch\parent = tree\parent + 1
					branch\x1 = tree\x1 + 125
					branch\y1 = (tree\y1 - tree\requirements * 60 + 30 * count) + branch\parent * 25
					branch\x2 = tree\x1 +100
					branch\y2 = tree\y1
					branch\added = 0
					
					tree\added = tree\added + 1
					done = False
				Next
			EndIf
		Next
	Wend
	
	
End Function

Function Edit_Effects(x,y,t.Technology)
SetFont fntText
	If Button(True,x+5,  y-5,"Slots : "+t\Effect\Slots,100,16) Then t\Effect\Slots = Get_Value()
	If Button(True,x+105,y-5,"Health : "+t\Effect\Health,100,16) Then t\Effect\Health = Get_Value()
	If Button(True,x+205,y-5,"Ships : "+t\Effect\Ships,100,16) Then t\Effect\Ships = Get_Value()
	If Button(True,x+305,y-5,"Planet : "+t\Effect\Planet,100,16) Then t\Effect\Planet = Get_Value()
	If Button(True,x+405,y-5,"E Need : "+t\Effect\ENeed,100,16,150,150,50) Then t\Effect\ENeed = Get_Value()
	If Button(True,x+505,y-5,"E Make : "+t\Effect\EMake,100,16,150,150,50) Then t\Effect\EMake = Get_Value()
	If Button(True,x+605,y-5,"E Store : "+t\Effect\EStore,100,16,150,150,50) Then t\Effect\EStore = Get_Value()
	
	If Button(True,x+5,  y+11,"Sc Range : "+t\Effect\ScanRange,100,16,150,50,150) Then t\Effect\ScanRange = Get_Value()
	If Button(True,x+105,y+11,"Wp Rng Bn : "+t\Effect\WeapRangeBonus+"%",100,16,150,50,150) Then t\Effect\WeapRangeBonus = Get_Value()
	If Button(True,x+205,y+11,"Wp Dmg : "+t\Effect\Dmg,100,16,200,50,50,200,200,200) Then t\Effect\Dmg = Get_Value()
	If Button(True,x+305,y+11,"Sh Dmg : "+t\Effect\SDmg+"%",100,16,200,50,50,200,200,200) Then t\Effect\SDmg = Get_Value()
	If Button(True,x+405,y+11,"Hu Dmg : "+t\Effect\HDmg+"%",100,16,200,50,50,200,200,200) Then t\Effect\HDmg = Get_Value()
	If Button(True,x+505,y+11,"Cmp Dmg : "+t\Effect\CDmg+"%",100,16,200,50,50,200,200,200) Then t\Effect\CDmg = Get_Value()
	If Button(True,x+605,y+11,"Crw Dmg : "+t\Effect\CrDmg+"%",100,16,200,50,50,200,200,200) Then t\Effect\CrDmg = Get_Value()
	
	If Button(True,x+5,  y+27,"W Range : "+t\Effect\WRange,100,16,200,50,50,200,200,200) Then t\Effect\WRange = Get_Value()
	If Button(True,x+105,y+27,"W Arc : "+t\Effect\WArc,100,16,200,50,50,200,200,200) Then t\Effect\WArc = Get_Value()
	If Button(True,x+205,y+27,"W Spd : "+t\Effect\WSpeed,100,16,200,50,50,200,200,200) Then t\Effect\WSpeed = Get_Value()
	If Button(True,x+305,y+27,"W Health : "+t\Effect\WHealth,100,16,200,50,50,200,200,200) Then t\Effect\WHealth = Get_Value()
	If Button(True,x+405,y+27,"Sh Hlth"+t\Effect\ShHealth,100,16,50,200,50) Then t\Effect\ShHealth = Get_Value()
	If Button(True,x+505,y+27,"Sh v En : "+t\Effect\ShvsEnergy+"%",100,16,50,200,50) Then t\Effect\ShvsEnergy = Get_Value()
	If Button(True,x+605,y+27,"Sh v Kn : "+t\Effect\ShvsKin+"%",100,16,50,200,50) Then t\Effect\ShvsKin = Get_Value()
	
	If Button(True,x+5,  y+42,"Sh v Ar : "+t\Effect\ShvsArea,100,16,50,200,50) Then t\Effect\ShvsArea = Get_Value()
	If Button(True,x+105,y+42,"ShPlnet : "+t\Effect\ShPlanet+"%",100,16,50,200,50) Then t\Effect\ShPlanet = Get_Value()
	If Button(True,x+205,y+42,"Sh Clok :"+t\Effect\ShCloak+"%",100,16,50,200,50) Then t\Effect\ShCloak = Get_Value()
	If Button(True,x+305,y+42,"Drain : "+t\Effect\Drain,100,16,50,200,50) Then t\Effect\Drain = Get_Value()
	If Button(True,x+405,y+42,"Mx Spd : "+t\Effect\MaxSpeed,100,16,200,200,50) Then t\Effect\MaxSpeed = Get_Value()
	If Button(True,x+505,y+42,"Absorb : "+t\Effect\Absorb+"%",100,16,25,100,25) Then t\Effect\Absorb = Get_Value()
	If Button(True,x+605,y+42,"Rpr Lm : "+t\Effect\RprLimit,100,16,25,100,25) Then t\Effect\RprLimit = Get_Value()
	
	If Button(True,x+5,  y+58,"RpRate : "+t\Effect\Rpr+"%",100,16,25,100,25) Then t\Effect\Rpr = Get_Value()
	If Button(True,x+105,y+58,"Pop Gr : "+t\Effect\PopGrow+"%",100,16,100,100,200) Then t\Effect\PopGrow = Get_Value()
	If Button(True,x+205,y+58,"Recycle: "+t\Effect\Recycle+"%",100,16,100,100,200) Then t\Effect\Recycle = Get_Value()
	If Button(True,x+305,y+58,"Mining : "+t\Effect\Mining+"%",100,16,100,100,200) Then t\Effect\Mining = Get_Value()
	If Button(True,x+405,y+58,"Rsearch: "+t\Effect\Research+"%",100,16,100,100,200) Then t\Effect\Research = Get_Value()
	If Button(True,x+505,y+58,"Moral : "+t\Effect\Moral+"%",100,16,100,100,200) Then t\Effect\Moral = Get_Value()
	If Button(True,x+605,y+58,"ProCost: "+t\Effect\PrdCost+"%",100,16,100,100,200) Then t\Effect\PrdCost = Get_Value()
	
	If Button(True,x+5,  y+75,"ConCost: "+t\Effect\ConCost+"%",100,16,100,100,200) Then t\Effect\ConCost = Get_Value()
	If Button(True,x+105,y+75,"BldTime: "+t\Effect\BldTime+"%",100,16,100,100,200) Then t\Effect\BldTime = Get_Value()
	If Button(True,x+205,y+75,"Combat : "+t\Effect\Combat+"%",100,16,100,100,200) Then t\Effect\Combat = Get_Value()
	If Button(True,x+305,y+75,"Repair :"+t\Effect\Repair+"%",100,16,100,100,200) Then t\Effect\Repair = Get_Value()
	If Button(True,x+405,y+75,"SpyAcc : "+t\Effect\SpyAcc+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyAcc = Get_Value()
	If Button(True,x+505,y+75,"SpyWarn: "+t\Effect\SpyWarn+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyWarn = Get_Value()
	If Button(True,x+605,y+75,"SpyThft: "+t\Effect\SpyTheft+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyTheft = Get_Value()
	
	If Button(True,x+5,  y+91,"ThftRes: "+t\Effect\SpyThftRes+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyThftRes = Get_Value()
	If Button(True,x+105,y+91,"ThftShp: "+t\Effect\SpyThftShp+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyThftShp = Get_Value()
	If Button(True,x+205,y+91,"ThftPop: "+t\Effect\SpyThftPop+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyThftPop = Get_Value()
	If Button(True,x+305,y+91,"ThftArt: "+t\Effect\SpyThftArt+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyThftArt = Get_Value()
	If Button(True,x+405,y+91,"ThftTec: "+t\Effect\SpyThftTech+"%",100,16,25,25,25,200,200,200) Then t\Effect\SpyThftTech = Get_Value()
	If Button(True,x+505,y+91,"SabRes : "+t\Effect\SabRes+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabRes = Get_Value()
	If Button(True,x+605,y+91,"SabShip: "+t\Effect\SabShip+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabShip = Get_Value()
	
	If Button(True,x+5,  y+107,"SabPop: "+t\Effect\SabPop+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabPop = Get_Value()
	If Button(True,x+105,y+107,"SabArt: "+t\Effect\SabArt+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabArt = Get_Value()
	If Button(True,x+205,y+107,"SabEnv: "+t\Effect\SabEnv+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabEnv = Get_Value()
	If Button(True,x+305,y+107,"SabCol: "+t\Effect\SabCol+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabCol = Get_Value()
	If Button(True,x+405,y+107,"SabTec: "+t\Effect\SabTech+"%",100,16,25,25,25,200,200,200) Then t\Effect\SabTech = Get_Value()
	If Button(True,x+505,y+107,"Harmny: "+t\Effect\Harmony+"%",100,16,50,150,150) Then t\Effect\Harmony = Get_Value()
	If Button(True,x+605,y+107,"Educat: "+t\Effect\Educ+"%",100,16,50,150,150) Then t\Effect\Educ = Get_Value()

	If Button(True,x+705,y-5,"Facing : "+t\Effect\Facing,100,16) Then t\Effect\Facing = 1 - t\Effect\Facing
	If Button(True,x+705,y+11,"Rounds : "+t\Effect\Rounds,100,16,200,50,50,200,200,200) Then t\Effect\Rounds = Get_Value()
	If Button(True,x+705,y+27,"Cost : "+t\Effect\Cost,100,16,200,200,50) Then t\Effect\Cost = Get_Value()
	If Button(True,x+705,y+42,"Size : "+t\Effect\Size,100,16,200,200,50) Then t\Effect\Size = Get_Value()
	If Button(True,x+705,y+58,"Range : "+t\Effect\Range+" ly",100,16,200,200,50) Then t\Effect\Range = Get_Value()
	If Button(True,x+705,y+75,"Vigil : "+t\Effect\Vigil+"%",100,16,50,150,150) Then t\Effect\Vigil = Get_Value()
	If Button(True,x+705,y+91,"Patriot: "+t\Effect\Patriot+"%",100,16,50,150,150) Then t\Effect\Patriot = Get_Value()
	If Button(True,x+705,y+107,"Securty: "+t\Effect\Security+"%",100,16,50,150,150) Then t\Effect\Security = Get_Value()
End Function

Function Create_Tech(t.Technology)
;Display Each Tech Data Field
	If t\Class &lt;&gt; "" Then
		Show_Tech(120,240,t)
	EndIf
;Determine Class
	If t\Class = "" Then 
		t\Class = Choose_Class(50,200)
		If t\Class = "DELETE" Then
			 Delete t
			MenuSelect = 0
		EndIf
;Determine Level
	ElseIf t\Level = 0 Then
		t\Level = Choose_Level(250,200,t\Class)
		If t\Level = -1 Then
			t\Level = 0
			t\Class = ""
		EndIf
;Determine Tech Name
	ElseIf t\Name ="" Then
		t\Name = Choose_Name(250,200)
	;update all techs with ***** to reflect they require this new name
		For tt.technology = Each Technology
			For count = 1 To 5
				If tt\requires[count] = "*****" Then tt\requires[count] = t\Name
			Next
		Next
		If t\Name = "BACK" Then
			t\Class = ""
		EndIf
;Determine How many tech Requirements
	ElseIf t\Requirements = -1 Then
		SetCol("white")
		txt$="NUMBER OF TECH REQUIREMENTS (0 TO 5)?"
		Button (False,WIDTH/2-StringWidth(TXT)/2,200,TXT,StringWidth(TXT)+30,20)
		If Button(True,WIDTH/2 - 125,230,"0",25,20) Then t\Requirements = 0
		If Button(True,WIDTH/2 - 75,230,"1",25,20) Then t\Requirements = 1
		If Button(True,WIDTH/2 - 25,230,"2",25,20) Then t\Requirements = 2
		If Button(True,WIDTH/2 + 25,230,"3",25,20) Then t\Requirements = 3
		If Button(True,WIDTH/2 + 75,230,"4",25,20) Then t\Requirements = 4
		If Button(True,WIDTH/2 + 125,230,"5",25,20) Then t\Requirements = 5
		If Button (True,50,580,"BACK",150,20) Then t\Name = ""
;Choose Tech Requirements
	ElseIf  t\Requirements &lt;&gt; 0 And t\Requires[t\Requirements] = "" Then
		For count = 1 To t\Requirements
			If t\Requires[count] = "" Then Exit
		Next
		StartX = 300
		StartY = 165
		SetFont fntText
		For count2 = 1 To 12
			Row(count2) = 0
		Next
		Button(False,300,150,"WEAPONS",100,12,50,200,200)
		;Display Scroll boxes
			If Button(True,300,150,"+",12,12,50,200,50) Then Scroll = Scroll + 1
			If Button(True,388,150,"-",12,12,50,200,50) Then Scroll = Scroll - 1
			If Scroll &lt; 0 Then Scroll = 0
		Button(False,410,150,"DEFENSES",100,12,50,200,200)
		Button(False,520,150,"PROPULSION",100,12,50,200,200)
		Button(False,630,150,"ENERGY",100,12,50,200,200)
		Button(False,740,150,"GENERATORS",100,12,50,200,200)
		Button(False,850,150,"MATERIALS",100,12,50,200,200)
		Button(False,300,400,"SCANNERS",100,12,50,200,200)
		Button(False,410,400,"MODULES",100,12,50,200,200)
		Button(False,520,400,"PLANETARY",100,12,50,200,200)
		Button(False,630,400,"SOCIAL",100,12,50,200,200)
		Button(False,740,400,"SPYCRAFT",100,12,50,200,200)
		Button(False,850,400,"SHIP HULLS",100,12,50,200,200)
		For tc.technology = Each Technology
			If tc\class = "WEAPONS" Then	X2 = 1
			If tc\class = "DEFENSES" Then	X2 = 2
			If tc\class = "PROPULSION" Then	X2 = 3
			If tc\class = "ENERGY" Then		X2 = 4
			If tc\class = "GENERATORS" Then	X2 = 5
			If tc\class = "MATERIALS" Then	X2 = 6
			If tc\class = "SCANNERS" Then	X2 = 7
			If tc\class = "MODULES" Then	X2 = 8
			If tc\class = "PLANETARY" Then	X2 = 9
			If tc\class = "SOCIAL" Then		X2 = 10
			If tc\class = "SPYCRAFT" Then	X2 = 11
			If tc\class = "SHIP HULLS" Then	x2 = 12
			If t\ID &lt;&gt; tc\id Then
			;Find the Row to Display the button on
				If x2 &lt; 7 Then
					x1 = startx + ((x2-1) * 110)
					y1 = starty + Row(x2) * 15
				Else
					x1 = startx + ((x2-1) * 110) - 660
					y1 = starty + (Row(x2) * 15) + 250
				EndIf
				Row(x2) = Row(x2) + 1
			;If Weapons List is too long make it scrollable
				If x2 = 1 Then 
					y1 = y1 - Scroll*15
					If y1 &lt; 165 Then y1 = -15
					If y1 &gt; 375 Then y1 = -15
				EndIf
			;Display and check if tech is selected
				If Button (True,x1,y1,tc\name,100,12) Then 
					t\Requires[count] = tc\name
					tmp$ = t\Requires[count]
				;check for duplicates
					For count2 = 1 To 5
						If (t\Requires[count2] = t\Requires[count]) And (count2 &lt;&gt; count) Then
							t\Requires[count] = ""
							Exit
						EndIf
					Next
					Exit
				EndIf
			EndIf
		Next
		SetFont fntNorm
;Determine Base months of Research
	ElseIf t\CompTime = -1 Then
		If Button (True,50,580,"BACK",150,20) Then 
			For count = 1 To 5
				t\Requires[count] = ""	
			Next
		EndIf
		t\CompTime = Choose_BuildTime(250,200)
;Get Item Description
	ElseIf t\Descrip = "" Then
		txt$ = Get_Description(250,200)
		If txt &lt;&gt; "" Then t\Descrip = txt
		If Button(True,50,580,"BACK",150,20) Then
			t\CompTime = 0
		EndIf
	ElseIf Not EffectDone Then
		Edit_Effects(230,375,t.Technology)
		If Button(True,600,500,"DONE",80,20) Then EffectDone = True
		If Button(True,520,500,"BACK",80,20) Then 
			TextInput = t\Descrip
			t\Descrip = ""
		EndIf
	ElseIf t\Obsolete = "***" Then
;What does this tech replace?
		Tech_Selection_List(300,165,t.Technology,tc.Technology)
		If Button(True,WIDTH/2,500,"NOTHING",100,20) Then t\Obsolete = ""
	Else
		t\Done = True
		MenuSelect = 0
	EndIf
End Function

Function Tech_Selection_List(x,y,t.Technology,tc.Technology)
SetFont fntText
		For count2 = 1 To 12
			Row(count2) = 0
		Next
		Button(False,300,150,"WEAPONS",100,12,50,200,200)
		;Display Scroll boxes
			If Button(True,300,150,"+",12,12,50,200,50) Then Scroll = Scroll + 1
			If Button(True,388,150,"-",12,12,50,200,50) Then Scroll = Scroll - 1
			If Scroll &lt; 0 Then Scroll = 0
		Button(False,410,150,"DEFENSES",100,12,50,200,200)
		Button(False,520,150,"PROPULSION",100,12,50,200,200)
		Button(False,630,150,"ENERGY",100,12,50,200,200)
		Button(False,740,150,"GENERATORS",100,12,50,200,200)
		Button(False,850,150,"MATERIALS",100,12,50,200,200)
		Button(False,300,400,"SCANNERS",100,12,50,200,200)
		Button(False,410,400,"MODULES",100,12,50,200,200)
		Button(False,520,400,"PLANETARY",100,12,50,200,200)
		Button(False,630,400,"SOCIAL",100,12,50,200,200)
		Button(False,740,400,"SPYCRAFT",100,12,50,200,200)
		Button(False,850,400,"SHIP HULLS",100,12,50,200,200)
		For tc.Technology = Each Technology
			If tc\Class = "WEAPONS" Then	X2 = 1
			If tc\Class = "DEFENSES" Then	X2 = 2
			If tc\Class = "PROPULSION" Then	X2 = 3
			If tc\Class = "ENERGY" Then		X2 = 4
			If tc\Class = "GENERATORS" Then	X2 = 5
			If tc\Class = "MATERIALS" Then	X2 = 6
			If tc\Class = "SCANNERS" Then	X2 = 7
			If tc\Class = "MODULES" Then	X2 = 8
			If tc\Class = "PLANETARY" Then	X2 = 9
			If tc\Class = "SOCIAL" Then		X2 = 10
			If tc\Class = "SPYCRAFT" Then	X2 = 11
			If tc\Class = "SHIP HULLS" Then	x2 = 12
			If t\ID &lt;&gt; tc\ID Then
			;Find the Row to Display the button on
				If x2 &lt; 7 Then
					x1 = x + ((x2-1) * 110)
					y1 = y + Row(x2) * 15
				Else
					x1 = x + ((x2-1) * 110) - 660
					y1 = y + (Row(x2) * 15) + 250
				EndIf
				Row(x2) = Row(x2) + 1
			;If Weapons List is too long make it scrollable
				If x2 = 1 Then 
					y1 = y1 - Scroll*15
					If y1 &lt; 165 Then y1 = -15
					If y1 &gt; 375 Then y1 = -15
				EndIf
			;Display and check if tech is selected
				If Button(True,x1,y1,tc\Name,100,12) Then t\Obsolete = tc\Name
			EndIf
		Next
End Function

Function Get_Value(x=550,y=595)
	FileSaveIsCurrent = False
		SetCol("white")
		Locate x, y 
		val = Input("Value : ")
		Return val
End Function

Function edit_tech(x,y,t.Technology)
;Show Class
	If Button (True,x-70,y-20,t\Class,150,20) Then
		t\Class = ""
		t\Level = 0
		t\Name = ""
		t\Requirements = -1
		For count = 1 To 5
			t\Requires[count] = ""
		Next
		t\CompTime = 0
		t\Done = False
		MenuSelect = 1
	EndIf
;Show Weapon Level
	If Button (True,x-70,y+20,t\Level,150,20) Then
		t\Level = 0
		t\Name = ""
		t\Requirements = -1
		For count = 1 To 5
			t\Requires[count] = ""
		Next
		t\CompTime = 0
		t\Done = False
		MenuSelect = 1
	EndIf
;Show Weapon Name
	If Button (True,x+5-(StringWidth(t\Name)+30)/2,y+60,t\Name,StringWidth(t\Name)+30,20) Then
	;Replace name in all techs requiring it with dummy name
		For tt.technology = Each Technology
			For count = 1 To 5
				If tname &lt;&gt; tt\name And tt\requires[count] = t\Name Then tt\requires[count] = "*****"
			Next
		Next
		t\Name = ""
		t\Requirements = -1
		For count = 1 To 5
			t\Requires[count] = ""
		Next
		t\CompTime = 0
		t\Done = False
		MenuSelect = 1
	EndIf
;Show How many Required Techs are needed
	If Button (True,x-70,y+100,t\Requirements+" TECHS",150,20) Then
		t\Requirements = -1
		For count = 1 To 5
			t\Requires[count] = ""
		Next
		t\CompTime = 0
		t\Done = False
		MenuSelect = 1
	EndIf
;List Required Techs
	For count = 1 To t\Requirements
		SetCol("green")
		If count = 1 Then Rect x-100,y+110,30,6
		Rect x-100,y+110 + count*40,50,6
		Rect x-100,y+70 + count*40,5,40
		x1 = StringWidth(t\Requires[count])/2
		If Button (True,x-50,y+100 + count * 40,t\Requires[count],x1*2+30,20) Then
			t\Requires[count] = ""
		;If edited requirement isn't last one then swap last with edited one
			If t\Requires[t\Requirements] &lt;&gt; "" Then 
				t\Requires[count] = t\Requires[t\Requirements]
				t\Requires[t\Requirements] = ""
			EndIf
			t\CompTime = 0
			t\Done = False
			MenuSelect = 1
		EndIf
	Next
;Show Base Research Time
	If Button(True,WIDTH/2,200,"RESEARCH TIME : "+t\CompTime+" MONTHS",300,20) Then
		t\CompTime = Choose_BuildTime(WIDTH/2,220)
	EndIf
	SetCol("white")
	Text x-70,y+360,"Research Time "+t\CompTime+" months"
;Edit Tech Description
	If Button(True,WIDTH/2,250,"TECH DESCRIPTION",300,20) Then
		TextInput = t\Descrip
		t\Descrip = ""
		t\Done = False
		MenuSelect = 1
	EndIf
;Change Tech Effects
	If Button(True,WIDTH/2,300,"TECH EFFECTS",300,20) Then
		t\Done = False
		MenuSelect = 1
		EffectDone = False
	EndIf
;Change what it makes Obsolete
	If Button(True,WIDTH/2,350,"MAKES OBSOLETE",300,20) Then
		t\Obsolete = "***"
		MenuSelect = 1
		t\Done = False
		EffectDone = True
	EndIf
End Function

Function Show_Tech(x,y,t.Technology)
	SetCol("white")
	Rect x,y,10,22,0
	Rect x,y+40,10,22,0
	Rect x,y+80,10,22,0
	SetCol("red")
	Rect x+1,y+1,8,20,1
	Rect x+1,y+41,8,22,1
	Rect x+1,y+81,8,22,1
	Button (False,x-70,y-20,t\Class,150,20)
	Button (False,x-70,y+20,t\Level,150,20)
	Button (False,x+5-(StringWidth(t\Name)+30)/2,y+60,t\Name,StringWidth(t\Name)+30,20)
	Button (False,x-70,y+100,t\Requirements+" TECHS",150,20)
	For count = 1 To t\Requirements
		SetCol("green")
		If count = 1 Then Rect x-100,y+110,30,6
		Rect x-100,y+110 + count*40,50,6
		Rect x-100,y+70 + count*40,5,40
		Button (False,x-50,y+100 + count * 40,t\Requires[count],150,20)
	Next
	If t\Requirements &gt; 0 Then
		If Button(True,x-70,y+340,"CANCEL BACK",150,20) Then t\Requirements = -1
		
	EndIf
	SetFont fntText
	Button (False,x-70,y+140,"REPLACES",150,18)
	Button (False,x-70,y+158,t\Obsolete,150,20)
	SetCol("white")
	Text x-70,y+360,"Research Time "+t\CompTime+" months"	
End Function

Function Get_Description$(x,y)
	key = GetKey()
	If Len(TextInput) &lt; 255 Then
		If key &gt;31 And key &lt;127 Then TextInput = TextInput + Chr(key)
	EndIf
	If key = 8 And Len(TextInput) &gt; 0 Then TextInput = Left(TextInput,Len(TextInput)-1)
	WordWrap(TextInput,60,x,y,20)
	If TextInput = "" Then 
		SetCol("white",1)
		If MenuSelect &lt;&gt; 0 Then Rect x,y+2,8,12
		SetCol("white")
	EndIf
	If Button(True,x+ 100,y+200,"CLEAR",80,20) Then 
		GhostText$ = TextInput
		TextInput = ""
		cx1 = 0
		cy1 = 0
	EndIf
	If GhostText$ &lt;&gt; "" Then 
		WordWrap(GhostText,60,x+400,y,20,0)
		Button(False,x+400,y-30,"Copy of Old Text",200,20) 
	EndIf
	If Button(True,x,y+200,"DONE",80,20) Then 
		cx1 = 0
		cy1 = 0
		Return TextInput
	Else
		Return ""
	EndIf
End Function

Function WordWrap$(phrase$,WIDTH,x,y,drop,blinker=1)
	While phrase &lt;&gt; ""
		pageline$ = ""
		notext = True
	;if length of string is greater than our width
		If Len(phrase) &gt; WIDTH
			spotcheck = WIDTH
			char$ = ""
		;Look for the last space in our next 'width chunk' of the MasterText
			Repeat
				spotcheck = spotcheck - 1
				char = Mid(phrase,spotcheck,1)
			Until char = " " Or spotcheck = 0
		;didn't find a space
			If spotcheck = 0
				pageline = Left(phrase,WIDTH)
				phrase = Right(phrase,Len(phrase) - WIDTH)
		;found a space
			Else
				pageline = Left(phrase,spotcheck - 1)
				phrase = Right(phrase,Len(phrase) - spotcheck) 
			EndIf
	;length of string is less than return width so send it all back
		Else
			pageline=phrase
			phrase = ""
		;Make a cursor
			cx = StringWidth(pageline) + 2 + x
			cy = y 
			If cx1 &gt; 0 Then cx1 = 0
			If cx1 &lt; Len(pageline)*-1 Then cx1 = Len(pageline)*-1
			SetCol("white",1)
			If MenuSelect &lt;&gt; 0 And blinker Then Rect cx,cy+2,8,12
			SetCol("white")
		EndIf
		Text x,y,pageline
		y = y + drop
	Wend
End Function 

Function Choose_BuildTime(x,y)
	FlushKeys()
	Locate x,y
	txt$ = Input("Base Months to Research : ")
	months = Int(txt)
	Return months
End Function

Function Choose_Name$(x,y)
	FlushKeys()
	Locate 250,220
	Name$ = Input("Name of Technology : ")
	Name$ = Upper(Name)
	Return Name$	
End Function

Function Choose_Level(x,y,class$)
	SetCol("teal")
	Text x,y-20,"Set the Tier Level"
	Line x,y,x+300,y
	If Button(True,WIDTH/2 - 75,230,"1",25,20) Then Return 1
	If Button(True,WIDTH/2 - 25,230,"2",25,20) Then Return 2
	If Button(True,WIDTH/2 + 25,230,"3",25,20) Then Return 3
	If Button(True,WIDTH/2 + 75,230,"4",25,20) Then Return 4
	If Button(True,WIDTH/2 + 125,230,"5",25,20) Then Return 5
	If Button (True,50,580,"BACK",150,20) Then Return -1
	Return 0
End Function

Function Choose_Class$(x,y)
	SetCol("teal")
	Text x,y-20,"Choose a Class"
	Line 0,y,200,y
	If Button (True,x,y+20,"WEAPONS",150,20) Then Return "WEAPONS"
	If Button (True,x,y+40,"DEFENSES",150,20) Then Return "DEFENSES"
	If Button (True,x,y+60,"PROPULSION",150,20) Then Return "PROPULSION"
	If Button (True,x,y+80,"ENERGY",150,20) Then Return "ENERGY"
	If Button (True,x,y+100,"GENERATORS",150,20) Then Return "GENERATORS"
	If Button (True,x,y+120,"MATERIALS",150,20) Then Return "MATERIALS"
	If Button (True,x,y+140,"SCANNERS",150,20) Then Return "SCANNERS"
	If Button (True,x,y+160,"MODULES",150,20) Then Return "MODULES"
	If Button (True,x,y+180,"PLANETARY",150,20) Then Return "PLANETARY"
	If Button (True,x,y+200,"SOCIAL",150,20) Then Return "SOCIAL"
	If Button (True,x,y+220,"SPYCRAFT",150,20) Then	Return "SPYCRAFT"
	If Button (True,x,y+240,"SHIP HULLS",150,20) Then Return "SHIP HULLS"
	If Button (True,x,y+260,"CANCEL",150,20) Then Return "DELETE"
	Return ""
End Function

Function Button(clickable,x,y,txt$,w=75,h=14,br1=150,bg1=150,bb1=150,fr1=0,fg1=0,fb1=0,br2=200,bg2=200,bb2=200,fr2=0,fg2=0,fb2=0)
;Clickable = Button or Placard
;x/y = coord
;txt = txt in button
;w/h = length and width of button
;br1/bg1/bb1 = Button Color
;fr1/fg1/fb1 = text color
;br2/bg2/bb2 = Button Mouse-Over Color
;fr2/fg2/fb2 = Text Mouse-Over Color
	Color br1,bg1,bb1
	Rect x,y,w,h,True
	Color fr1,fg1,fb1
	Text x+w/2,y+h/2,txt$,True,True
	If clickable Then
		mx = MouseX()
		my = MouseY()
		Clicked = False
		If my &gt; y And my &lt; y+h Then
			If mx &gt; x And mx &lt; x+w Then ;mouse-over
				Color br2,bg2,bb2
				Rect x,y,w,h,True
				Color fr2,fg2,fb2
				Text x+w/2,y+h/2,txt$,True,True
				;Tool Tips for Effect List
				Select Left(txt,7)
					Case "Slots :"
						Button(False,x-100,y-45,"Number of Ship Slots",200,40)
					Case "Health "
						Button(False,x-100,y-45,"Item's Health",200,40)
					Case "Ships :"
						Button(False,x-100,y-45,"Boolean: Ship Component",200,40)	
					Case "Planet "
							Button(False,x-100,y-45,"Boolean : Base Component",200,40)
					Case "E Need "
							Button(False,x-100,y-45,"Energy Required to Function",200,40)
					Case "E Make "
							Button(False,x-100,y-45,"Energy Created",200,40)
					Case "E Store"
							Button(False,x-100,y-45,"Energy that it Can Store",200,40)
					Case "Sc Rang"
							Button(False,x-100,y-45,"Range of Scanner in ly",200,40)
					Case "Wp Rng "
							Button(False,x-100,y-45,"% increase Weapon Range",200,40)
					Case "Wp Dmg "
							Button(False,x-100,y-45,"Base damage weapon does on hit",200,40)
					Case "Sh Dmg "
							Button(False,x-100,y-45,"% Base dmg goes to shields",200,40)
					Case "Hu Dmg "
							Button(False,x-100,y-45,"% Base dmg goes to Ship",200,40)
					Case "Cmp Dmg"
							Button(False,x-100,y-45,"% Base dmg goes to Components",200,40)
					Case "Crw Dmg"
							Button(False,x-100,y-45,"% Base dmg goes to Crew",200,40)
					Case "W Range"
							Button(False,x-100,y-45,"Range of Weapon",200,40)
					Case "W Arc :"
							Button(False,x-100,y-45,"Firing Arc",200,40)
					Case "W Spd :"
							Button(False,x-100,y-45,"Speed of 'bullet' 100=instant",200,40)
					Case "W Healt"
							Button(False,x-100,y-45,"Weapon Component Health",200,40)
					Case "Sh Hlth"
							Button(False,x-100,y-45,"Shield HP",200,40)
					Case "Sh v En"
							Button(False,x-100,y-45,"% dmg decrease vs Energy Weap",200,40)
					Case "Sh v Kn"
							Button(False,x-100,y-45,"% dmg decrease vs Kinetic Weap",200,40)
					Case "Sh v Ar"
							Button(False,x-100,y-45,"% dmg decrease vs Area Weap",200,40)
					Case "ShPlnet"
							Button(False,x-100,y-45,"% dmg decrease on Planet",200,40)
					Case "Sh Clok"
							Button(False,x-100,y-45,"% decrease enemy Sensor range",200,40)
					Case "Drain :"
							Button(False,x-100,y-45,"Drain Rate of cloaking devices",200,40)
					Case "Mx Spd "
							Button(False,x-100,y-45,"Maximum Ship Speed",200,40)
					Case "Absorb "
							Button(False,x-100,y-45,"% dmg Armor absorbs",200,40)
					Case "Rpr Lm "
							Button(False,x-100,y-45,"% when armor stops self-repair",200,40)
					Case "RpRate "
							Button(False,x-100,y-45,"% armor repaired each day",200,40)
					Case "Pop Gr "
							Button(False,x-100,y-45,"% pop growth increase",200,40)
					Case "Recycle"
							Button(False,x-100,y-45,"% reduce resource need per colonist",200,40)
					Case "Mining "
							Button(False,x-100,y-45,"% increase planet resources",200,40)
					Case "Rsearch"
							Button(False,x-100,y-45,"% increase Colony Research",200,40)
					Case "Moral :"
							Button(False,x-100,y-45,"% increase Colony Moral",200,40)
					Case "ProCost"
							Button(False,x-100,y-45,"% decrease Colony Production cost",200,40)
					Case "ConCost"
							Button(False,x-100,y-45,"% decrease Colony Construction",200,40)
					Case "BldTime"
							Button(False,x-100,y-45,"% decrease Colony Build Time",200,40)
					Case "Combat "
							Button(False,x-100,y-45,"Combat bonus %",200,40)
					Case "Repair "
							Button(False,x-100,y-45,"Ship/Colony Repair per day %",200,40)
					Case "SpyAcc "
							Button(False,x-100,y-45,"Accuracy % of Spy Reports",200,40)
					Case "SpyWarn"
							Button(False,x-100,y-45,"% chance spy discovers attack",200,40)
					Case "SpyThft"
							Button(False,x-100,y-45,"% Base chance Theft Success",200,40)
					Case "ThftRes"
							Button(False,x-100,y-45,"% of enemy Resources can be taken",200,40)
					Case "ThftShp"
							Button(False,x-100,y-45,"% increase success steal ship",200,40)
					Case "ThftPop"
							Button(False,x-100,y-45,"% enemy pop that can be stolen",200,40)
					Case "ThftArt"
							Button(False,x-100,y-45,"% increase succes Artifact theft",200,40)
					Case "ThftTec"
							Button(False,x-100,y-45,"% increase success Tech stolen",200,40)
					Case "SabRes "
							Button(False,x-100,y-45,"% sabotage Research",200,40)
					Case "SabShip"
							Button(False,x-100,y-45,"% sabotage docked Ship",200,40)
					Case "SabPop:"
							Button(False,x-100,y-45,"% riot to kill ThftPop",200,40)
					Case "SabArt:"
							Button(False,x-100,y-45,"% to destroy rand artifact",200,40)
					Case "SabEnv:"
							Button(False,x-100,y-45,"% to Reduce world class by 1",200,40)
					Case "SabCol:"
							Button(False,x-100,y-45,"% to damage colony modules",200,40)
					Case "SabTec:"
							Button(False,x-100,y-45,"% increase Res Time of rand tech",200,40)
					Case "Harmny:"
							Button(False,x-100,y-45,"% colony resist sab/theft pop",200,40)
					Case "Educat:"
							Button(False,x-100,y-45,"% colony resist sab/theft res",200,40)
					Case "Size : "
							Button(False,x-100,y-45,"How many components Ship can have",200,40)
					Case "Range :"
							Button(False,x-100,y-45,"Range in ly of colony/cargo ships",200,40)
					Case "Vigil :"
							Button(False,x-100,y-45,"% col resist sab-shp/col thf-shp/art",200,40)
					Case "Patriot"
							Button(False,x-100,y-45,"% col resist sab-env/art thf-art",200,40)
					Case "Securty"
							Button(False,x-100,y-45,"% col resist sab/thf tech",200,40)
					Case "Rounds "
							Button(False,x-100,y-45,"How many Rounds are held",200,40)
					Case "Cost : "
							Button(False,x-100,y-45,"Base Resource Cost",200,40)
					Case "Facing "
							Button(False,x-100,y-45,"Can be mounted Fore/Aft",200,40)
				
						;Button(False,
				End Select
				If MouseHit(1) Then
					Clicked = True
;					;	If SoundOn Then PlaySound (sndButton)
				
				EndIf
			EndIf
		EndIf
	Else
		Clicked = False
	EndIf
;3d Borders (thick)
	Color br1*.75,bg1*.75,bb1*.75
	Rect x+w-2,y,2,h	
	Rect x,y+h-1,w,2
	Color br1*1.25,bg1*1.25,bb1*1.25
	Rect x,y,w,2
	Rect x,y,2,h
	Return Clicked
End Function

Function SetCol(Kolor$="white",Effect$ = "0")

	FTime$ = Str(MilliSecs())
	Time$ = Mid(Ftime,Len(ftime)-2,2)
	Fade# = Float(Time) * .01
	Effect$ = Lower(Effect)

	Select Effect
		Case 0,"none"
			fade = 1.0
		Case 1,"blink"
			If fade &lt; .5 Then 
				fade = 1
			Else
				fade = 0
			EndIf
		Case 2,"pulse"
			If Fade &lt; .5 Then 
				Fade# = 1 - Fade
			EndIf
		Case 3,"charge"
			If fade &lt; 1 Then
				fade = fade + fade / 5
			Else
				fade = 0
			EndIf
		Case 4,"fade"
			If fade &gt; 0 Then
				fade = 1 - fade 
			Else
				fade = 1
			EndIf
	End Select

	Kolor = Lower(Kolor)
	Select Kolor
		Case "0","blk","black"							;Black
			Color 0,0,0
		Case "1","red"									;Red
			Color 255*Fade,0,0	
		Case "2","grn","green"							;Green
			Color 0,255*Fade,0
		Case "3","blu","blue"							;Blue
			Color 0,0,255*Fade
		Case "4","yel","yellow"							;Yellow
			Color 255*Fade,255*Fade,0
		Case "5","drd","dred","darkred"					;Dark Red
			Color 150*Fade,0,0
		Case "6","dgr","dgreen","darkgreen"				;Dark Green
			Color 0,150*Fade,0
		Case "7","dbl","dblue","darkblue"				;Dark Blue
			Color 0,0,150*Fade
		Case "8","dyl","dyellow","darkyellow"			;Dark Yellow
			Color 150*Fade,150*Fade,0
		Case "9","pur","purple"							;Purple
			Color 255*Fade,0,255*Fade
		Case "10","whi","white"							;White
			Color 255*Fade,255*Fade,255*Fade
		Case "11","gry","grey","gray"					;Grey
			Color 150*Fade,150*Fade,150*Fade
		Case "12","tel","teal"							;Teal
			Color 0,255*Fade,255*Fade
		Case "13","dgry","dgray","dark gray","dark grey";Dark Grey
			Color 50*fade,50*Fade,50*Fade	
	End Select
End Function

Function Save_Tech_File$()
;Create the Savefile
	SaveFile = WriteFile(FileName$)
;Start out with the Name of Savefile Version
				WriteString SaveFile, 	Save_File_Version$ 
;Count how many technologies we are saving	
	count = 0
	For t.technology = Each Technology
		count = count + 1
	Next
;Save the number of technologies in the file
				WriteInt 	savefile,	count
;Now go through and save the information for each technology
	For t.technology = Each Technology
				WriteInt 	savefile,	t\Id
				WriteString savefile,	t\Class
				WriteInt	savefile,	t\Level
				WriteString savefile,	t\Name
				WriteInt	savefile,	t\Completed
				WriteInt	savefile,	t\Requirements
				WriteString savefile,	t\obsolete
;Save all 5 Requires arrays
		For count = 1 To 5
				WriteString savefile,	t\requires[count]
		Next
				WriteInt	savefile,	t\CompTime
				WriteInt	savefile,	t\invested
				WriteInt	savefile,	t\done
				WriteString	savefile,	t\descrip
;Now List in All the Tech Effects
				WriteInt	savefile,	t\effect\slots
				WriteInt	savefile,	t\effect\health
				WriteInt	savefile,	t\effect\ships
				WriteInt	savefile,	t\effect\planet
				WriteInt	savefile,	t\effect\eneed
				WriteInt	savefile,	t\effect\emake
				WriteInt	savefile,	t\effect\estore
				WriteInt	savefile,	t\effect\scanrange
				WriteInt	savefile,	t\effect\weaprangebonus
				WriteInt	savefile,	t\effect\Dmg
				WriteInt	savefile,	t\effect\SDmg
				WriteInt	savefile,	t\effect\HDmg
				WriteInt	savefile,	t\effect\CDmg
				WriteInt	savefile,	t\effect\CrDmg
				WriteInt	savefile,	t\effect\WRange
				WriteInt	savefile,	t\effect\WArc
				WriteInt	savefile,	t\effect\WSpeed
				WriteInt	savefile,	t\effect\WHealth
				WriteInt	savefile,	t\effect\ShHealth
				WriteInt	savefile,	t\effect\ShvsEnergy
				WriteInt	savefile,	t\effect\SHvsKin
				WriteInt	savefile,	t\effect\ShvsArea
				WriteInt	savefile,	t\effect\ShPlanet
				WriteInt	savefile,	t\effect\ShCloak
				WriteInt	savefile,	t\effect\Drain
				WriteInt	savefile,	t\effect\MaxSpeed
				WriteInt	savefile,	t\effect\Absorb
				WriteInt	savefile,	t\effect\RprLimit
				WriteInt	savefile,	t\effect\Rpr
				WriteInt	savefile,	t\effect\PopGrow
				WriteInt	savefile,	t\effect\Recycle
				WriteInt	savefile,	t\effect\Mining
				WriteInt	savefile,	t\effect\Research
				WriteInt	savefile,	t\effect\Moral
				WriteInt	savefile,	t\effect\PrdCost
				WriteInt	savefile,	t\effect\ConCost
				WriteInt	savefile,	t\effect\BldTime
				WriteInt	savefile,	t\effect\Combat
				WriteInt	savefile,	t\effect\Repair
				WriteInt	savefile,	t\effect\SpyAcc
				WriteInt	savefile,	t\effect\SpyWarn
				WriteInt	savefile,	t\effect\SpyTheft
				WriteInt	savefile,	t\effect\SpyThftRes
				WriteInt	savefile,	t\effect\SPyThftShp
				WriteInt	savefile,	t\effect\SpyThftPop
				WriteInt	savefile,	t\effect\SpyThftArt
				WriteInt	savefile,	t\effect\SpyThftTech
				WriteInt	savefile,	t\effect\SabRes
				WriteInt	savefile,	t\effect\SabShip
				WriteInt	savefile,	t\effect\SabPop
				WriteInt	savefile,	t\effect\SabArt
				WriteInt	savefile,	t\effect\SabEnv
				WriteInt	savefile,	t\effect\SabCol
				WriteInt	savefile,	t\effect\SabTech
				WriteInt	savefile,	t\effect\Harmony
				WriteInt	savefile,	t\effect\Educ
				WriteInt	savefile,	t\effect\Vigil
				WriteInt	savefile,	t\effect\Patriot
				WriteInt	savefile,	t\effect\Security
				WriteInt	savefile,	t\effect\Range
				WriteInt	savefile,	t\effect\Size
				WriteInt	savefile,	t\effect\rounds
				WriteInt	savefile,	t\effect\cost
				WriteInt	savefile,	t\effect\facing
	Next
;Now Close the Savefile
	CloseFile (savefile)
	FileSaveIsCurrent = True
	MenuSelect = 3
	Return "Save Complete"
End Function

Function Load_Tech_File$()
;Open the Savefile for reading in exact order we saved to it
	SaveFile = ReadFile(FileName$)
If savefile = 0 Then
	MenuSelect = 3
	FileSaveIsCurrent = False
	Return "No Save File - Using Default Starter"
EndIf
;First thing we do is read in the version of the file
				filever$	= 		ReadString(savefile)
;Check if file exists or is correct version number or if acceptable version #
good = False
If filever = "Stellar Expanse Technology Tree Creator Version 1.0b" Then good = True
If filever = "Stellar Expanse Technology Tree Creator Version 1.0c" Then good = True
If filever = Save_File_Version Then good = True
If Not good Then
	MenuSelect = 3
	FileSaveIsCurrent = False
	Return "Save File incorrect Version Number"
EndIf
;Next read in how many techs there are
				total		=		ReadInt(savefile)
;Clear out any existing Tech Data structures
	Delete Each Technology
;Load in the exact amount of techs that were saved
	For count = 1 To total
		t.technology = New Technology
			t\id				=		ReadInt(savefile)
			t\class				=		ReadString(savefile)
			t\Level				=		ReadInt(savefile)
			t\name				=		ReadString(savefile)
			t\completed			=		ReadInt(savefile)
			t\requirements		=		ReadInt(savefile)
			t\obsolete 			=		ReadString(savefile)
;Read in each array
		For count2 = 1 To 5
			t\requires[count2]	=		ReadString(savefile)
		Next
			t\CompTime			=		ReadInt(savefile)
			t\Invested			=		ReadInt(savefile)
			t\done				=		ReadInt(savefile)
		If filever = "Stellar Expanse Technology Tree Creator Version 1.0b" Then
			t\descrip = ""
		Else
			t\descrip 			=		ReadString(savefile)
		EndIf
		t\effect.effects = New Effects
		If filever = "Stellar Expanse Technology Tree Creator Version 1.0d" Then
			t\effect\slots			=	ReadInt(savefile)
			t\effect\health			=	ReadInt(savefile)
			t\effect\ships			=	ReadInt(savefile)
			t\effect\planet			=	ReadInt(savefile)
			t\effect\eneed			=	ReadInt(savefile)
			t\effect\emake			=	ReadInt(savefile)
			t\effect\estore			=	ReadInt(savefile)
			t\effect\scanrange		=	ReadInt(savefile)
			t\effect\weaprangebonus	=	ReadInt(savefile)
			t\effect\Dmg			=	ReadInt(savefile)
			t\effect\SDmg			=	ReadInt(savefile)
			t\effect\HDmg			=	ReadInt(savefile)
			t\effect\CDmg			=	ReadInt(savefile)
			t\effect\CrDmg			=	ReadInt(savefile)
			t\effect\WRange			=	ReadInt(savefile)
			t\effect\WArc			=	ReadInt(savefile)
			t\effect\WSpeed			=	ReadInt(savefile)
			t\effect\WHealth		=	ReadInt(savefile)
			t\effect\ShHealth		=	ReadInt(savefile)
			t\effect\ShvsEnergy		=	ReadInt(savefile)
			t\effect\SHvsKin		=	ReadInt(savefile)
			t\effect\ShvsArea		=	ReadInt(savefile)
			t\effect\ShPlanet		=	ReadInt(savefile)
			t\effect\ShCloak		=	ReadInt(savefile)
			t\effect\Drain			=	ReadInt(savefile)
			t\effect\MaxSpeed		=	ReadInt(savefile)
			t\effect\Absorb			=	ReadInt(savefile)
			t\effect\RprLimit		=	ReadInt(savefile)
			t\effect\Rpr			=	ReadInt(savefile)
			t\effect\PopGrow		=	ReadInt(savefile)
			t\effect\Recycle		=	ReadInt(savefile)
			t\effect\Mining			=	ReadInt(savefile)
			t\effect\Research		=	ReadInt(savefile)
			t\effect\Moral			=	ReadInt(savefile)
			t\effect\PrdCost		=	ReadInt(savefile)
			t\effect\ConCost		=	ReadInt(savefile)
			t\effect\BldTime		=	ReadInt(savefile)
			t\effect\Combat			=	ReadInt(savefile)
			t\effect\Repair			=	ReadInt(savefile)
			t\effect\SpyAcc			=	ReadInt(savefile)
			t\effect\SpyWarn		=	ReadInt(savefile)
			t\effect\SpyTheft		=	ReadInt(savefile)
			t\effect\SpyThftRes		=	ReadInt(savefile)
			t\effect\SPyThftShp		=	ReadInt(savefile)
			t\effect\SpyThftPop		=	ReadInt(savefile)
			t\effect\SpyThftArt		=	ReadInt(savefile)
			t\effect\SpyThftTech	=	ReadInt(savefile)
			t\effect\SabRes			=	ReadInt(savefile)
			t\effect\SabShip		=	ReadInt(savefile)
			t\effect\SabPop			=	ReadInt(savefile)
			t\effect\SabArt			=	ReadInt(savefile)
			t\effect\SabEnv			=	ReadInt(savefile)
			t\effect\SabCol			=	ReadInt(savefile)
			t\effect\SabTech		=	ReadInt(savefile)
			t\effect\Harmony		=	ReadInt(savefile)
			t\effect\Educ			=	ReadInt(savefile)
			t\effect\Vigil			=	ReadInt(savefile)
			t\effect\Patriot		=	ReadInt(savefile)
			t\effect\Security		=	ReadInt(savefile)
			t\effect\Range			=	ReadInt(savefile)
			t\effect\size			=	ReadInt(savefile)
			t\effect\rounds			=	ReadInt(savefile)
			t\effect\cost			=	ReadInt(savefile)
			t\effect\facing			=	ReadInt(savefile)
		EndIf
	Next
;Close the file
	CloseFile (savefile)
	FileSaveIsCurrent = True
MenuSelect = 3
FileSaveIsCurrent = True
Return "Load Successful"
End Function
</textarea> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
