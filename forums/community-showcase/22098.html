<!DOCTYPE html><html lang="en" ><head ><title >Dynamic DX Lighting</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Dynamic DX Lighting</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Dynamic DX Lighting</a><br><br>
<a name="226546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was just having a play about with lights.<br><br>I created a Maplet level and recorded where the lights are using Droplet. Then I wrote a bit of code to see where the lights are (in relation to the player) pick the one closest to the player and put a DX light there of the right colour.<br><br>It works pretty well apart from the fact that you can be lit by a light on the other side of a wall... Bah details!<br><br>[img "http://mysite.freeserve.com/mentalillusion/temp/b001.jpg"]<br>[img "http://mysite.freeserve.com/mentalillusion/temp/b002.jpg"]<br>[img "http://mysite.freeserve.com/mentalillusion/temp/b003.jpg"]<br>[img "http://mysite.freeserve.com/mentalillusion/temp/b004.jpg"] <br><br></td></tr></table><br>
<a name="226565"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool - regarding the lighting through walls, I'm no 3d guru or nuthin, but couldn't you do a linepick or summat, at the point when the target light was chosen? (wouldn't have to be every frame) <br><br></td></tr></table><br>
<a name="226578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes you could, this was just a quick-and-dirty-see-how-it-looks affair, if I were to implement this into a game I'd do a linepick or summat, probably summat as droplet deals with zones too, so if the light is in the same zone at the player then use it type thing. <br><br></td></tr></table><br>
<a name="226596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stonking.  It actually gives more logic to the way a location looks.  That red room would look very odd without the lady (bathed in red light) standing in it.<br><br>Stating the obvious I know, but certainly drives it home graphically. <br><br></td></tr></table><br>
<a name="226699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're working on this again then Rob? Doesn't look like a spooky mansion anymore.<br><br>I notice you've retextured her... in fact... she's got a bum - I thought the skirt looked good.<br><br>Here's what I have so far (my version of the buffy texture) I work on it on and off so she's taking her time :)<br><br><img src="http://www.binarymoon.co.uk/preview/buffy.jpg"><br><br>BTW I think you still have that seam down her middle. Just move the chest uv coords that are next to the edge of the texture right three or four pixels. That will sort it all out. <br><br></td></tr></table><br>
<a name="226717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ben, totally retextured from scratch (apart from the head) did my own UVs the lot! I've been playing with unwrapping meshes as it's something I've got to learn to do, after that got to play with animation.<br><br>The poly count has gone up a bit due to the arse, but still sub 1000 tris. I thought the skirt just made her look like a hooker! And totally not an adventuring kick-ass kind of look.<br><br>Not sure if I'm working on this or not though, I just had a thought about lights and thought I'd give it a go, it turned out pretty good (at least I think so), the level is just something I'd done playing around with maplet ages ago.<br><br>My main project is Lander, although I've also got a little puzzle game on the production line called 'All Aboard'. Oh, and droplet, oh, and some other stuff too... <br><br></td></tr></table><br>
<a name="226749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> This looks like a useful trick.  In order to match the player's coloring to the lightmap I am actually checking the color of lightmap pixels under the player; there are definite pros and cons to either mine or your method. <br><br></td></tr></table><br>
<a name="226852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The poly count has gone up a bit due to the arse <br></div><br><br>...Sounds like she's getting fat? :)<br><br>Anyways, this kind of light / lightmap blending is the only way to make lightmapped enviroments and realtime lighted characters match. This technique was used for example in the Max Payne, more or less. <br><br>I suggested ages ago a method where I would use cubemap lighting the same way as it would result smoother and better lighting (color gradients) and has direction too (from the enviroment to the character), so it's way better than plain point light. But Blitz3D still has no cubemap support so I can't do that at least for now. <br><br></td></tr></table><br>
<a name="228435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zo Zo Zee Zar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm checking the color of the lightmap underneath my player and all characters too. Robs method looks just as good though although if you have 5 lights in a room with 4 baddies and the player it may fall down. <br><br></td></tr></table><br>
<a name="228612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Red Ocktober</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice looking models guys...<br><br>Doc, is the handrails and supporting crossmembers in the second picture all geometry, or is it done with alpha transparencies?<br><br>--Mike <br><br></td></tr></table><br>
<a name="228750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Robs method looks just as good though although if you have 5 lights in a room with 4 baddies and the player it may fall down. <br></div>How so? it checks for the 2 nearest lights to the player and puts DX lights there, also I've just added an extra bit of code that dims them as you move further away (kind of like fall off).<br><br>[quote]Doc, is the handrails and supporting crossmembers in the second picture all geometry, or is it done with alpha transparencies?[quote]It's geometry. <br><br></td></tr></table><br>
<a name="228757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Rob,<br>nice idea indeed.<br><br>A question, since I would like to implement the same concept:<br>How can you pick the right colour that the light should have ? Do you pick a vertex color under the (droplet's) light coordinates ? If so, how ?<br><br>By the way, I find Droplet extremely useful, and I'm using it in my project - thanks a lot for such an useful application.<br><br>Regards,<br>Sergio. <br><br></td></tr></table><br>
<a name="228758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, double post. <br><br></td></tr></table><br>
<a name="228804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zo Zo Zee Zar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> How so? it checks for the 2 nearest lights to the player and puts DX lights there, also I've just added an extra bit of code that dims them as you move further away (kind of like fall off).  <br></div><br><br>Just thinking of things you may come up against, what I meant in my example is the nearest two lights to the player may not be the nearest light to baddie number one - infact all baddies may be nearer to other lights - means the dx light count is going to go up and potentially run out - depends on how many lights you are going to have in a room i guess.<br><br>It might be worth you trying the lightmap method too to see the difference - the shots you postest above certainly look amazing, im just thinking dx lights go through other objects, so, if your character walks in and out of a nice shadow casting from a pillar or something she wont react to that shadow - picking the lightmap pixel beneath her would give you this tho. <br><br>Another example would be where you have an iron grating in the roof with light shining through it like this:<br><img src="http://www.miltronec.com/grate.jpg"><br>(excuse the crude image but i just knocked it up quick to demonstrate), if you pick the lightmap underneath the character she will walk in and out of the shadows being cast giving a really cool effect and making her really look like she is there, using a dx light will light her correctly and from the right angle but wont allow her to walk in and out of the shadows. <br><br></td></tr></table><br>
<a name="228818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good point Dave... A combination of the 2 is in order I think. Pick up the colour from the lightmap and the location in the same way. I'm using a 2 DX lights the whole time and it's totally driven from the player location. Sure bad guys might look a bit odd now and again but I'm not worrying too much about it.<br><br>Sergio, I just set up a light entity in droplet with RGB values (you have to manually enter it all), then just read it in. Or indeed create a bunch of light entities of different (common) colours, ie Red light, Green light, Cyan light etc. <br><br></td></tr></table><br>
<a name="228884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zo Zo Zee Zar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah like it - combination of the two will look awesome, two lights will be nice and fast and yes i agree - the odd bad guy looking odd wont detract from the overall cool lighting. Nice one :) <br><br></td></tr></table><br>
<a name="229035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers Dr Av for explanation, and thanks all for such an interesting discussion.<br><br>:)<br><br>Sergio. <br><br></td></tr></table><br>
<a name="229296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DarkEagle</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> can you explain the theory/code of reading the pixels under the player? i assume a linepick, then find the uv coords? any chance of telling me how? <br><br></td></tr></table><br>
<a name="229316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Someone posted some code a while back. Its in one of the 3d forums.  Anyway the tricky bit is getting the picked UV coords, because Blitz does not have a pickedU/pickedV function.  Once you have the UV coords its easy to get the appropriate pixel from the lightmap texture.  Fortunately Fredborg has mastered the maths, done all the hard work, and has posted this code in the archives. <a href="http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=515." target="_blank">http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=515.</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
