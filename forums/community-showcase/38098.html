<!DOCTYPE html><html lang="en" ><head ><title >Community Project - Alien Breed Remake Thread 2</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Community Project - Alien Breed Remake Thread 2</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >Community Project - Alien Breed Remake Thread 2</a><br><br>
<a name="421069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Currently Standing like this:<br><br><a href="http://www.mentalillusion.co.uk/projects.php?section=Games&amp;name=Alien%20Breed%20Remake" target="_blank"><img src="http://www.mentalillusion.co.uk/tmp/topdown.jpg"></a><br><br><a href="/posts.php?topic=37773" target="_blank">Following from first thread</a><br><br>History<br><pre class=code>06-09-2004 :	Poed Boy - Added decals instead of tile splatters
		Rob Farley - Modified decal include to act as a basic particle system
		CoffeeDotBean - Added Gun flash code
		Rims - Added HUD and corrected player 2 strafe mode bug
		Rob Farley - Added the basic console for intex systems

04-09-2004 :	Rob Farley - Retreat/strafe mode, when holding down fire the played doesn't change direction
		           - Turnaround added so aliens and players don't switch from left to right they go round all available turning positions, makes it look better.
		           - Alien media tidied up a bit
		           - Bullet media added
			   - Alien blood media added
			   - When aliens dies they leave blood

03-09-2004 :	Rims - Different weapons
		Rob Farley - Different visible bullet types for the weapons, also this type is carried over to the kill_bullet to allow for different blasts depending on the bullet type
		           - Basic collision on the aliens so they don't run over each other, although they sometimes get stuck so this needs to be improved.

02-09-2004 :	Perturbatio - Improved and fixed a couple of bugs in the editor
		Matt - Updated shooting and object collection to deal with clips
		Rob Farley - Removed offset from positioning of bullets and blasts
		           - Added shooting of aliens, alien health and alien death

01-09-2004 :	Matt - Fixed the shooting bug
		Poed Boy - Seperated out the player code into functions and tidied up the main loop
		Rob Farley - Refixed the players getting stuck at edges bug!
		           - Added alien gfx and basic alien handling code

31-08-2004 :	Rims - Blast and shooting includes (athough shooting appears to be a little buggy)
		Matt - Fixed players getting stuck at edges bug

29-08-2004 :	Rims - 2 Player code
		Rob Farley - Updated temp hud
		           - Media, added block overlay on map, added object tiles.
		           - More Media, doors and keys now work. Door opening needs animation though
		Coffeedotbean kindly donated the media from his Alpha Breed project.

25-08-2004 :	Rob Farley - First release, basic map editor, game engine and tileset.</pre><br><br>Both zips just updated...<br><br>Come on guys... Support the community and add some code. <br><br></td></tr></table><br>
<a name="421132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated code.zip<br><br>Added control.bb for the starter of a better control methodology. Updated intex.bb. Added temp_int global variable for self contained functions that need to pass a variable from on to another without you bothering to pass it... crappy coding but handy.<br><br>Other changes... Changed player 1's fire key to the right ctrl button.<br><br>Press I to get into intex systems, there will be a console on the wall to access it, not done that yet! <br><br></td></tr></table><br>
<a name="421141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thats  1 very fancy indx systems.. congrats. <br><br></td></tr></table><br>
<a name="421176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> very snazzy looking intex system there, rob. This is looking very nice. I get a "die you green alien crud!!!" feeling when I shoot them. Is that normal? <br><br></td></tr></table><br>
<a name="421307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, just got to make the menus do something and make it so it gets activated when you wonder up to a terminal.<br><br>With regards to "Die you green alien crud!!!" Yep! Good ennit!<br><br>Note: Due to bandwidth costs I can no longer host this project. <br><br></td></tr></table><br>
<a name="421327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> email it to me rob and I'll host it as long as I can.<br>matt at 3030deathwar.co.uk <br><br></td></tr></table><br>
<a name="421329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sent. <br><br></td></tr></table><br>
<a name="421333"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, it's here:<br><br>www.3030deathwar.com/downloads/ab/code.zip<br>www.3030deathwar.com/downloads/ab/media.zip<br><br>How shall we do this? Shall I handle the code updates, or do you want to do it and then email me the new versions?<br><br>Here's how it stands (in medium quality to save bandwidth)<br>www.3030deathwar.com/downloads/ab/standing.jpg <br><br></td></tr></table><br>
<a name="421335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rims, you may as well handle the code updates... I'm going on holiday next week for 2 weeks anyway so I won't be anywhere near a computer! I'm hoping to come back to a finished game!! :) <br><br></td></tr></table><br>
<a name="421337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> you cheeky monkey. Ok, I'll handle the code. I hope there's a pay rise. Where you off to? <br><br></td></tr></table><br>
<a name="421339"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, here's our todo list:<br><pre class=code>
[done] Shooting
[done] Doors
[done] Keys
[done] Player 2
[30%] Bad Guys
[30%] Bad Guy AI
[done] Ammo
[   ] Credits
[30%] Intex Systems
</pre> <br><br></td></tr></table><br>
<a name="421344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> More todos...<br><br><div class="quote"> Weapon Graphics - For when you see them on the ground and pick em up! Also we need dead people decals!<br><br>Different bad guys - Extend the Alien type to allow for different bad guys, including face huggers scuttling around and stuff. This would mean the radius needs to be included in the type and probably an offset variable so the image is drawn centrally, ie 64x64 would have an offset of 32 a 32x32 would have an offset of 16 etc.<br><br>Sound - There is some sound media in the original downloads from coffeedotbean but this needs to be implemented.<br><br>Ammo - Needs to distiguish what weapons it's for<br><br>Intex system console - Tiles for the intex systems so player can access it, this allows players to buy armour, weapons, ammo, health, etc. Maybe even sell stuff too?!<br><br>More Alien media - Currently it's not animated, doesn't die etc etc. And if we made more than one alien too, also I think we need static bad guys too like auto cannons etc.<br><br>More Player media - Personally I think we can cut half the animation frames out and you'd not notice, and use the spares for death and pain animation.<br><br>Extend Editor - Need to add an extra layer for placing bad guy spawn points, ambient sounds, animated decals etc.<br><br>Doors - Currently any key will open any door, using the extra map layer mentioned each door could have it's own unique ID and key, or indeed, a common ID <br></div>Probably more but that's all I can think of right now... I'll get to work this evening and try and sort the door/editor thing seeing as I've probably got the clearist picture of that lot! <br><br></td></tr></table><br>
<a name="421395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Little update of the decals.bb<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function Decal_updateAll()
	Local d.Decal
	
	If Decal_Count&gt;Decal_Max Then Delete First Decal : Decal_Count=Decal_Count-1
	
	For d = Each Decal
		;let blitz handle clipping :D
		
		d\x=d\x+d\xs
		d\y=d\y+d\ys
		d\xs=d\xs*.9
		d\ys=d\ys*.9
		DrawImage d\Image,d\X-16-ScreenX,d\Y-16-ScreenY
		d\time=d\time-1
		If d\time&lt;=0 Then Delete d
		
	Next
	 
End Function

Function decal_drawall()
	Local d.Decal
	For d = Each Decal
		DrawImage d\Image,d\X-16-ScreenX,d\Y-16-ScreenY
	Next
End Function</textarea><br><br>This seperates the updating of the decals and the rendering. This is needed so the timing all works correctly. It replaces the existing decal_drawall function.<br><br>This means now you have to add..<br><br>Decal_updateAll()<br><br>Just after:<br>handleblasts()<br>handlebullets()<br>update_aliens()<br><br>Some more thoughts...<br><br>The alien type should have a flag to say if the alien is in pain or not so when it gets to the rendering of the alien sprites you might have a pain animation frame to render instead of the regular animation, I think that would look good. Once it's rendered the frame it sets it to false, or indeed instead of a flag it is a number that counts down if it's &gt;0 and whilst the number is &gt;0 the pain frame is shown. <br><br></td></tr></table><br>
<a name="421404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimbob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess you should kinda slow down its movement at the same time, so you can kinda 'hold back' the aliens with your machine gun fire. Maybe if each weapon had a 'blast power' you could make the aliens recoil against the bigger weapons... <br><br></td></tr></table><br>
<a name="421415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've not downloaded yet, but really want to support this...<br><br>My idea I'd like to add in is a "fog of war" type effect, but want gauge opinion first.  Essentially, you can see where you've been and the up to walls / doors enclosing your current location.  On opening a door, the visible area is extended into the new area.  You can see anything on visible stuff, but nothing on non-visible tiles.  (Note that I'm not proposing we actually implement line of sight stuff for the player)<br><br>This will be pretty easy to add (will try to do it tonight when I get home from work), and I think will be pretty cool in the game.  It will add an element of suspense / surprise when opening each door - will you find a horde of monsters or a bag of gold in the cupboard?<br><br>Another thing that'll be easy to add (with the way I'm thinking anyway, without looking at the code!) is to enable the intex systems to show the full level map.  I'm thinking a 'security' section in the intex, which needs a password to access.  The password will (ultimately) be found as a pickup somewhere in the level.<br><br>And a 'map' key in game as well to show where you are / have been.  I'm thinking (again without touching the code) that a scaled down version of the existing graphics engine ought to do the trick...<br><br>Thoughts? <br><br></td></tr></table><br>
<a name="421420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> JimBob, I had the same thought, the aliens already knock backwards a bit but I think if you had a massive 8 ball gun that twats them down a corridor that would be pretty cool!<br><br>Mark, Sounds reasonable, I've though about vision systems of sorts, based around where the player(s) are and then basically flood fill until you hit collision blocks. They way to implement this would be add an additional layer on the map of simply "Can I see this block?" if you can it's set true then it draws it if false then not. The hardest thing I think would be when do you recalc your view? Probably every time a door opens?<br><br>Anyway, you're more than welcome to add it!<br><br>Intex systems are going to be pretty much everything that isn't in the basic gameplay, shop, map, ping pong game, whatever you care to throw a stick at, there's no reason not to extend it massively. Access codes and stuff in there would be handy for opening doors (to secret areas) you can't get passed. <br><br></td></tr></table><br>
<a name="421440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ragtag</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a dead body for you folks. Did it for fun to test out the demo of openCanvas 3.0. It's not the corpse of the player, just someone you can scatter around the place...feel free to modify the poor sod.<br><br><img src="http://www.ragtag.net/xternal/blitz/body.png"><br><br>I may do some more stuff if I find the time. Tested the game the other day, and it looks cool so far. Personally I would prefer to aim with the mouse, so I could strafe using the left and right keys...but of course, then you couldn't do a split screen mode.<br><br> Cheers,<br>   Ragnar <br><br></td></tr></table><br>
<a name="421493"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Created a particle system to replace the decal.bb file, this one deals with animated textures and other stuff!<br><br>Particle.bb<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Global particles = LoadAnimImage("gfx\particles\particles.png",32,32,0,4)
MaskImage particles,255,0,255
Global alienblood = LoadAnimImage("gfx\particles\splatfade.png",64,64,0,8)
MaskImage alienblood,255,0,255

Type particle
	Field x#,y#,xs#,ys#
	Field firstframe,lastframe
	Field life
	Field totallife
	Field offset
	Field graphic
End Type

Global maxparticle = 200
Global particlecount = 0

Function createparticle(x,y,xs#,ys#,life,firstframe,lastframe,graphic,offset)

; x,y - the particle position
; xs,ys - the particle speed
; life - how long it will last
; graphic - what graphic to use
; offset - how much it should offset when drawing ie a 32x32 particle would have a 16 offset

; the animation will play from beginning to end over the life of the particle

	Local p.particle = New particle
	
	p\x = x
	p\y = y
	p\xs = xs
	p\ys = ys
	p\life = life
	p\totallife = life
	p\firstframe = firstframe
	p\lastframe = lastframe
	p\graphic = graphic
	p\offset = offset
	
End Function

Function UpdateParticles()

	If particlecount&gt;maxparticle Then Delete First particle

	particlecount = 0
	
	Local p.particle
	
	For p = Each particle
		
		; move the particle
		p\x = p\x + p\xs
		p\y = p\y + p\ys
		
		; dampen the speed
		p\xs = p\xs * .9
		p\ys = p\ys * .9
		
		; reduce the life
		p\life = p\life - 1
		If p\life &lt;= 0 Then Delete p Else particlecount=particlecount+1
	Next
End Function
	
	
Function drawparticles()
	
	Local p.particle
	
	For p = Each particle
	
		; work out what frame it should be displaying
		range = p\lastframe - p\firstframe
		life# = Float(p\totallife - p\life) / Float(p\totallife)
		frame = range * life
		
		DrawImage p\graphic,p\x-p\offset-ScreenX,p\y-p\offset-ScreenY,p\firstframe+frame
		
	Next
End Function</textarea><br><br>Updated alienhit and aliendie functions<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function Alien_Die(al.alien)
	
	createparticle(al\x,al\y,0,0,1000,0,7,alienblood,32)
	
	;create death splat
	n=Rand(10)+2
	For i=1 To n
		d=Rand(359)
		f=Rand(0,3)
		createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)	
	Next
	
	Delete al.alien
			
End Function

Function alien_hit(al.alien,damage=1)
	
	al\health = al\health - damage
	
	;random alien blood splats
	d=Rand(0,359)
	f=Rand(0,3)
	createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)
		
	If al\health&lt;=0 Then alien_die(al)
End Function</textarea><br><br>Download the <a href="http://www.mentalillusion.co.uk/tmp/particles.zip" target="_blank">Particle gfx here.</a> These need to go in the particle dir in the gfx folder.<br><br>In engine.bb - Put draw particles here.<pre class=code>drawmap(ScreenX,ScreenY,1)

drawparticles()

drawmap(ScreenX,ScreenY,2)
drawbullets()</pre>And put updateparticles() here<pre class=code>handleblasts()
handlebullets()
update_aliens()
UpdateParticles()</pre><br><br>Any other decal references need to be removed, but I think that's got the lot. <br><br></td></tr></table><br>
<a name="421501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob, yup that method was exactly what I was thinking - I knocked up a little test in excel at lunchtime (at work) based on flood-filling when you open a door, seems pretty straightforward if I<br>1) assume there'll always be a 'solid' wall round the outside of the map (which seems reasonable, else the player could wander off...)<br>2) allow 'vis' to seep through diagonals.  I don't imagine this would be a problem, as maps with diagonally aligned 'solid' walls will look a bit funny anyway, and probably only apply to 'pillar' type walls, in which it makes sense that you can see through them!<br><br>Will get on to it now... <br><br></td></tr></table><br>
<a name="421508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mark, one 'problem' I've thought of... Your flood fill will have to flood one block further than the collision (ie include the collision boundry) otherwise you won't see the walls. <br><br></td></tr></table><br>
<a name="421547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> New Aliens.bb<br><br>Aliens now have a bit more AI, they have an added field called mode that is the AI state they are in.<br><br>They will now only attack if they can see the player.<br>They will stop attacking if they lose sight of the player.<br>If they get shot at they will attack with vengence!!<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;==========================================================================================
;TYPES
;==========================================================================================
Type alien
	Field x
	Field y
	Field frame
	Field health
	Field fpause
	Field dir
	Field id
	Field sdelay
	Field targetdir
	Field mode$
End Type

Global alienradius = 20
Global aliengfx = LoadAnimImage("gfx/alien.png",64,64,0,8) : MaskImage aliengfx,255,0,255




Function SpawnAlien(X%,Y%,id)
	al.alien = New alien
	
	al\x = X
	al\y = Y
	al\frame = 0
	al\health = 10
	al\fpause = 0
	al\dir = 0
	al\id = id
	al\sdelay = 0
	al\mode="newroam"
End Function

Function Alien_Die(al.alien)
	
	createparticle(al\x,al\y,0,0,1000,0,7,alienblood,32)
	
	;create death splat
	n=Rand(20)+5
	For i=1 To n
		d=Rand(359)
		f=Rand(0,3)
		createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)	
	Next
	
	Delete al.alien
			
End Function

Function alien_hit(al.alien,damage=1)
	
	al\health = al\health - damage
	al\mode="underattack"
	
	;random alien blood splats
	d=Rand(0,359)
	f=Rand(0,3)
	createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)
		
	If al\health&lt;=0 Then alien_die(al)
End Function

Function Alien_DrawAll()
	Local al.alien
	For al.alien = Each alien
		DrawImage aliengfx,al\x-32-screenx,al\y-32-screeny,al\dir
		
		
		; debug text
		bText al\x-screenx,al\y-screeny,al\mode,True,True
	Next
End Function	

Function update_aliens()

acount=0
	
For al.alien = Each alien

	acount=acount+1


	move=False
	direct$=""
	mr=False
	ml=False
	mu=False
	md=False
	
	; basic alien follow AI
	
	dis = 1000
	targetx=0
	targety=0
	For pl.player = Each player
		ndis = Sqr(((al\x-pl\x)*(al\x-pl\x))+((al\y-pl\y)*(al\y-pl\y)))
		If ndis&lt;dis
			targetx=pl\x
			targety=pl\y
			dis=ndis
		EndIf
	Next
	
	
	If dis&gt;500 And al\mode="underattack" Then al\mode="attack"
	
	; if a player is in range then attack
	If dis&lt;1000
	
	
		If al\mode&lt;&gt;"underattack"
		
		
			; can alien see a player?
			
			For dd=-30 To 30 Step 30
			x=al\x
			y=al\y
			xd=Sin(al\dir*45+dd)*64
			yd=-Cos(al\dir*45+dd)*64

			
			ld=10
			cansee=False
			Repeat
				
				x=x+xd
				y=y+yd
				
				For pl.player = Each player
					If circlesoverlap(x,y,alienradius*4,pl\x,pl\y,playerradius) Then cansee=True:ld=1
				Next
				If x&lt;0 Or x&gt;7552 Or y&lt;0 Or y&gt;7552 Then x=0:y=0:id=1
				If gettile(x,y,0)=1 Then cansee=False:ld=1			
			
				ld=ld-1
			Until ld=0
			
			If cansee = True Then Exit
			
			Next
			
			If cansee And al\mode="roam" Then al\mode="attack"
			If cansee=False And al\mode="attack" Then al\mode="roam"
		EndIf
		
		
		;If al\mode="underattack" Then al\mode="attack"
				
		If al\mode="attack" Or al\mode="underattack"
			If al\x&lt;targetx Then mr=True
			If al\x&gt;targetx Then ml=True
			If al\y&lt;targety Then md=True
			If al\y&gt;targety Then mu=True
		EndIf
		
		If al\mode="roam"
			t=al\dir
			If t=7 Or t=0 Or t=1 Then mu=True
			If t=7 Or t=6 Or t=5 Then ml=True
			If t=3 Or t=4 Or t=5 Then md=True
			If t=1 Or t=2 Or t=3 Then mr=True
		EndIf
				
		If al\mode="newroam"
			t=Rand(0,7)
			If t=7 Or t=0 Or t=1 Then mu=True
			If t=7 Or t=6 Or t=5 Then ml=True
			If t=3 Or t=4 Or t=5 Then md=True
			If t=1 Or t=2 Or t=3 Then mr=True
			al\mode="roam"
		EndIf
		

	EndIf
	
	; check collisions with other aliens
	For al1.alien = Each alien
		If al\id&lt;&gt;al1\id
		
			If mr And circlesoverlap(al\x+2,al\y,alienradius,al1\x,al1\y,alienradius) Then mr=False
			If ml And circlesoverlap(al\x-2,al\y,alienradius,al1\x,al1\y,alienradius) Then ml=False
			If md And circlesoverlap(al\x,al\y+2,alienradius,al1\x,al1\y,alienradius) Then md=False
			If mu And circlesoverlap(al\x,al\y-2,alienradius,al1\x,al1\y,alienradius) Then mu=False
			
		EndIf

	Next
	
	; check collisions with players	
	For pl.player = Each player
		If mr And circlesoverlap(al\x+2,al\y,alienradius,pl\x,pl\y,playerradius) Then mr=False
		If ml And circlesoverlap(al\x-2,al\y,alienradius,pl\x,pl\y,playerradius) Then ml=False
		If md And circlesoverlap(al\x,al\y+2,alienradius,pl\x,pl\y,playerradius) Then md=False
		If mu And circlesoverlap(al\x,al\y-2,alienradius,pl\x,pl\y,playerradius) Then mu=False
	Next
	
	
	

	; Don't hit walls
	If mr Then
		If gettile(al\x+alienradius,al\y,0)=0 Then 
			If al\sDelay=0 Then al\x=al\x+1
			move=True
			direct=direct+"R"
		End If
			
		
	End If
	If ml Then 
		If gettile(al\x-alienradius,al\y,0)=0 Then 
			If al\sDelay=0 Then al\x=al\x-1
			move=True
			direct=direct+"L"
		End If

	End If
	If mu Then
		If gettile(al\x,al\y-alienradius,0)=0 Then 
			If al\sDelay=0 Then al\y=al\y-1
			move=True
			direct=direct+"U"
		End If
	End If
	If md Then 
		If gettile(al\x,al\y+alienradius,0)=0 Then 
			If al\sDelay=0 Then al\y=al\y+1
			move=True
			direct=direct+"D"
		End If	
	End If
	
	If move=False And al\mode="roam" Then al\mode="newroam"
	
	al\sdelay = (al\sdelay+1) Mod 2
	
	
	; animation frame control
	If move
		al\fpause = (al\fpause+1) Mod 5
		If al\fpause = 0 Then al\frame = (al\frame+1) Mod 15
	EndIf

	If direct = "U" Then al\targetdir=0
	If direct = "RU" Then al\targetdir =1
	If direct = "R" Then al\targetdir =2 
	If direct = "RD" Then al\targetdir = 3
	If direct = "D" Then al\targetdir = 4
	If direct = "LD" Then al\targetdir = 5
	If direct = "L" Then al\targetdir = 6
	If direct = "LU" Then al\targetdir = 7
	
	If turndelay = 0
		al\dir = dirdif (al\dir,al\targetdir)

	EndIf

	
Next
End Function</textarea> <br><br></td></tr></table><br>
<a name="421550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hrm...  if they lose sight of the player?  So if you stand at a corner and fire...  duck behind the corner...  they lose sight and go back to what they were doing?  Should maybe have a timer on that.  If they lose sight for more than a few seconds maybe.......<br><br>Just an observation. <br><br></td></tr></table><br>
<a name="421569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kanati... If they lose sight of a player they still keep heading in the direction they were going, but yes, the AI is still crap... but getting there. <br><br></td></tr></table><br>
<a name="421572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rims, hang on, I've just finished my base fog of war code, incorporating all changes up to Robs last one.  My changes are quite invasive.  I'll add in robs aliens change to my stuff and upload; will post again in 5-10 mins...<br><br>Rob, yup, had already figured that I needed the first boundary.  The base version does 'the bare minimum' really; by just finding the first boundary you lose some of the neat extra detail within some boundaries (vents near start for example).  Will need to work on that.  Also not convinced about a pure black background for non-visible, but not sure what else to do.  One good side effect is aliens in areas not visible don't need to be updated, so that can massively reduce AI, etc going on. <br><br></td></tr></table><br>
<a name="421573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob, I think you've been testing it with debug off, because I keep getting array errors in the aliens.bb-&gt;update_aliens() function. I think the tile check is being given the wrong coords. This works fine with debug off. I've modified the gettile function so this doesn't try and access a wrong dimension in the array.<br><br>I've updated the code.zip. Get it in my sig. <br><br></td></tr></table><br>
<a name="421575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> doh! Can you integrate this version into your code, Mark? <br><br></td></tr></table><br>
<a name="421580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> gah!  Ok, I'll drag my code out of my zip and stick it into yours.  Gimme 20 mins... <br><br></td></tr></table><br>
<a name="421582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry dude! <br><br></td></tr></table><br>
<a name="421600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> No problem: Here it is incorporating all above changes -&gt; <a href="http://members.lycos.co.uk/marktiffany" target="_blank">*clicky*</a> <br><br>I've done a bit more tidying of files: added map.bb and util.bb - engine.bb is now almost purely the game loop.<br><br>vis is in, although possibly a little basic.  Note that the map is obviously still a test map so 1) it takes ages to check vis on startup in debug mode (very minor delay in non-debug) due to the massive visible area, and 2) you might find areas where you *think* the vis has screwed up, but it hasn't, it's the map.  ;-)  I can't see any noticeable delay when checking vis on opening doors, although it's conceivable on larger areas.<br><br>Once we start designing proper maps (or even just setting up a decent enclosed/small area start point on this map) this will go away by making sure our maps are sensible.  <br><br>Unforunately it doesn't immediately give the 'suspense' feel I thought it would, but again, I think that's the map, not the principle.  <br><br>I'm not sure about the fully black background for non-visible areas.  But I don't know what to replace it with.<br><br>I think we also need to consider the fact that my code is currently limited to just seeing one block into 'solid' objects.  You can no longer see the vents in the walls near the start, which is a shame.  Not entirely sure how to address this one though...maybe non-visible areas should be covered in 'roof' tiles until they are visible, and we class the wall detail the same?!?<br><br>A neat side effect is that aliens now don't do anything until they are visible, which should help us when designing maps and piling huge numbers of aliens in different rooms - they won't impact performance (much) until their door is opened...<br><br>One feature request from me though: animated backgrounds.  stuff moving behind those vents.  corpses that twitch every 5 minutes.  Just enough to make you think "did I just see that, or...?"  And more constantly animated stuff - intex systems ought to animate, plus fans, maybe flickering lights? <br><br></td></tr></table><br>
<a name="421614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mark, animated backgrounds already thought of that, it'll be an extra map layer that will hold additional info like sound emitters, spinning fans, alien positions, that sort of thing.<br><br>Regarding the vis, maybe it should just spread onto top-of-wall blocks? (80,81,82,83 and 5) this list may increase so we'll just have this as an exception. A bit crap but should do the trick. I'm not a big fan of hard coding this sort of thing but I don't think there would be many more expections?<br><br>Bit more splatter:<br><br>Updated alien die<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function Alien_Die(al.alien)
	
	createparticle(al\x,al\y,0,0,2000,0,7,alienblood,32)
	
	;create death splat
	n=Rand(20)+5
	For i=1 To n
		d=Rand(359)
		f=Rand(3,7)
		createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)	
	Next
	
	Delete al.alien
			
End Function</textarea><br><br>updated line on particle<br><pre class=code>Global alienblood = LoadAnimImage("gfx\particles\splatfade.png",64,64,0,8)</pre><br><br><a href="http://www.mentalillusion.co.uk/tmp/particles.png" target="_blank">New particle media</a> <br><br></td></tr></table><br>
<a name="421615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nm, I got it to compile. I'll see if I can come up with something. <br><br></td></tr></table><br>
<a name="421623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.mentalillusion.co.uk/tmp/test.zip" target="_blank">Updated test.map to work with the vis better</a><br><br>Also spotted that the check vis is called every time the open door is called, the problem with this is that the open door is called recursively so vis is checked several times for one door, without checking the code is this going to have any major impact? <br><br></td></tr></table><br>
<a name="421625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Agreed with the animated things. I think rob's noted this. I like your implementation of the fog. It gives me a sense of suspense, but like you said, this can be hightened with a good map.<br><br>I've added an animation include. This replaces and implements  blast.bb. This will allow you to put looping animations in the map at coords.<br><br>Functions:<br>; create an animation using this image<br>; at these coords<br>; running between these frames (s -&gt; e)<br>; an looping "loop" times. loop=-1 means infinitely.<br>Function createAnimation(image,x,y,sf,ef,speed#,loop=-1)<br><br>Updated the code.zip to contain your updates. <br><br></td></tr></table><br>
<a name="421628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated opendoor function to only check vis once.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function opendoor(x,y,vis=True)
	map(x,y,2)=0
	map(x,y,0)=0
	
	If map(x,y-1,2)=7 Then opendoor(x,y-1,False)
	If map(x,y+1,2)=7 Then opendoor(x,y+1,False)
	If map(x+1,y,2)=8 Then opendoor(x+1,y,False)
	If map(x-1,y,2)=8 Then opendoor(x-1,y,False)

	; check the vis from this newly opened door!
	If vis Then CheckVis(x,y)
	
End Function</textarea> <br><br></td></tr></table><br>
<a name="421630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> rob your particles are having a problem with these lines:<br><pre class=code>
		range = p\lastframe - p\firstframe
		life# = Float(p\totallife - p\life) / Float(p\totallife)
		frame = range * life
		frame = p\firstframe+frame
		If frame &gt; p\lastframe Then frame=p\lastframe
		If frame &lt; 0 Then frame=0
		
		DrawImage p\graphic,p\x-p\offset-ScreenX,p\y-p\offset-ScreenY,frame
</pre><br>specifically the frame. Image frame out of range. I tried doing some error checking with the last three added lines, but it doesn't help. <br><br></td></tr></table><br>
<a name="421633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's the problem, I don't get any errors? Anyway... Time for bed... It's 00:13 and I've got work tomorrow! <br><br></td></tr></table><br>
<a name="421635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll update the code.zip tomorrow. I'll go for your method: update once at night... maybe twice.<br><br>This is looking nice. We need some graphics though. I know I'm crap at graphics. <br><br></td></tr></table><br>
<a name="421725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rims - Thinking about the particle system problem, I'm assuming you did download the new Particle.png media? That had an extra 4 frames in it. If not, then you'd run out of frames.<br><br>[edit]Looking at your code it doesn't look like you changed the number of frames when loading the new graphic.[/edit] <br><br></td></tr></table><br>
<a name="421745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob, I had decided that the recursive opendoor vis check wasn't a problem - if any connecting tiles have already been marked as visible, they're not checked.  So the first opendoor does the full CheckVis, and subsequent ones enter and exit CheckVis just once (as all surrounding tiles are already checked); so I didn't see it as an overhead.  Doesn't matter as you've prevented that little inefficiency anyway.<br><br>As for the central wall blocks, this isn't as simple as it ought to be.  You could floodfill vis the internal wall tiles every time you hit a solid wall, but this could make large sections of a level visible when you don't want it to.<br><br>I'm thinking (top of my head at the moment) that the collision layer could have 0, 1 and 2 (if other values aren't already used? I'm at work).  For normal collisions, anything other than 0 means a collisions.  For vis checks, only 2 counts.  This does mean an extension to the map editor, and we'll have to specifically mark out vis sections. But I think it would solve this problem...will mull it over whilst pretending to work today... <br><br></td></tr></table><br>
<a name="421749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mark, the vis thing is really cool so we need to make this work,. The idea of the tristate collision could work, what if central blocks were marked as type 2? So when the flood fill hits the edge it check surrounding blocks for type 2s, if it finds any type 2s it flood fills the 2... Hmmm... Actually that won't work unless the map is specifically design for it...<br><br>Also I noticed where I've put a locker or something similar against a wall this causes problems as you end up with a black block in the middle of it...<br><br>... hmmm...<br><br>Yes we need 3 states of collisions... Players will hit 1 or 2s but vis will only hit 2s. I think that should solve the problem. [edit] This is exactly what you said isn't it! Doh, yes I agree! [/edit]<br><br>Something else, I've mentioned it a couple of times already, but I think with the vis added we will need more doors, so we should either have some doors that are keyless, or security levels on doors so you get the basic level security that opens up a few doors and later you find higher security level passes to get you further into the map. Obviously you'd still have your red, green, and blue keys for special doors. Thoughts? <br><br></td></tr></table><br>
<a name="421760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, something else as a fairly urgent todo before we get carried away with all these fx...<br><br>Improve collision on weapons &gt; aliens<br>Add player health and lives<br>When alien hits player causes pain on player.<br><br>Also some more thoughts...<br><br>I really think we need more rotation animation, I think we could probably lose half of the animations we've currently got and use those to produce in-between rotations (22.5 degs), I just think it would make it looks much smoother.<br><br>Discuss... <br><br></td></tr></table><br>
<a name="421765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Had a thought on an algorithm for the vis thing that I think will work.  Please discuss before I get home and start coding tonight (8 hours from now!)...<br><br>1) Do the vis as currently, but add all newly visible wall blocks in a new wall_vis_list.<br>2) Once normal vis is complete, work through each item in this new wall_vis_list<br>3) From each of these tiles, 'draw' 4 lines (up, down, left, right) outwards until you hit a) a non-internal wall tile, b) a lit block, or b) the edge of the screen<br>4) If you stopped at the edge of the screen, or an already lit tile, all intermediate tiles are lit.  Add all of these to the wall_vis_list to check.  Note that hitting a non-internal wall that isn't lit means no tiles get lit.<br>5) repeat until you've checked all tiles in wall_vis_list<br><br>The only 'minor' problems with this are:<br>1) As soon as you hit a room on the outer edge of the map, all internal wall tiles around the edge of the map become visible.  However, I'm not sure this is too much of a problem, as it helps players visualise the level size.<br>2) If you have a 'secret' room completely surrounded by rooms you've already been in, it will be obvious that there's something there (because it's black, not filled in).  However this would be a problem with the collision layer=2 model too, and would only be 'fixed' if we covered mom-visible areas with a default 'roof' tile.  It's also a neat feature IMHO, as astute players will spot such unexplored areas on the map (when I implement it!).<br><br>I think this works (having played with a simple map in an excel spreadsheet!), and avoids us having to predefine vis areas, which I really don't like the idea of.  (predefined vis areas is really what we mean by a new '2' collision layer state).  Too much potential for error, and we ought to try to avoid it if poss.<br><br>Agree we need to sort some fundamental stuff out.  player / alien collisions for one.  player &amp; aliens extremeties overlapping walls for another (this is a problem when going under the netting near the start of the level, your gun and alien arms stick out the sides).  And damage / lives to actually make this a game!  I also want to get a map display in, if only to make sure the vis stuff really is doing it's job!<br><br>At some point we'll need to think about story / structure though.  I'd quite like to see a (slightly) rpg feel, going to different locations rather than just getting deeper into one 'dungeon'.  And based around buying / selling / finding upgrades, rather than full on stats based crap.  Intex systems can provide the latter, but we'll also need notes / documents as pick ups (if only to provide the pwd to get the full level map off the intex).  I've got a few story ideas rumbling round in my head, I might put something in a doc later today.  Somehow try to avoid the cliches... <br><br></td></tr></table><br>
<a name="421774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see unseen blocks being in the middle of maps as a problem I think it would make people say... "How the hell do I get to see that bit, what's in there?"<br><br>Without thinking too much, that sounds like a perfect reasonalble way of going about the vis, and I agree with the predefine vis.<br><br>I agree there should be plenty of puzzles to solve, I liked the old 8 bit arcade adventures where you had to pick up the plunger, wire and dynamite then use all 3 to blow up a door for example. Or you find the access pass to get into the computer, etc etc. I like the idea of this being more of an adventure rather than a straight alien blast.<br><br>Regarding the deeper into the dungeon feel, if you played Alien Breed tower assult that was cool, you had an area of play that had several building in it, each one had it's own theme of sorts although they all had the same feel. I liked this as it gave you a non-linear game and you could explore the buildings in pretty much any order you wanted if you'd found the right access passes, or got a generator working etc etc. <br><br></td></tr></table><br>
<a name="421777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tonight I'm going to write a sound library, so no-one else do that!<br><br>I've got the idea that you just throw sounds at it and it deals with if you can hear it, where to play it etc etc. Also it'll check for sound emitters and if you can hear those. How many sounds playing at the same time etc etc.<br><br>Anyway... I'll do it tonight! <br><br></td></tr></table><br>
<a name="421846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Story's coming along nicely, I hope you'll like it, but you'll have to wait until tonight ;-)<br><br>I'm afraid there are a couple of cliches - unavoidable with the genre really.  But several twists.  Even if we never implement what I produce, I think it will at least spark a few neat ideas for features / tiles / maps...<br><br>I agree with the 'freedom' / 'non-linearity' ideas above, have some degree of that incorporated.  My concept is of a story driven blastfest (as opposed to a pure blastfest!), so although there is occassional story telling (in game), including an upfront tutorial / intro level, it's kept to a minimum unless you decide to read every note / book / intex email you find... ;-) <br><br></td></tr></table><br>
<a name="422071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Basic sound include:<br><br>Because this sets up an array this include needs to be included before other stuff. Blitz is funny like that!<br><br>This include is only for one shots not for sustained sounds... I'll deal with those later!<br><br><a href="/posts.php?topic=37615" target="_blank">Get the sounds from the alpha breed download in this thread</a> and put them in an sfx directory.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; load sounds, these need to be global even though they are passed to functions?!

Global snd_aliendeath = LoadSound("sfx\death.wav")
Global snd_alienattack = LoadSound("sfx\astar.wav")

Dim snd_alienhit(3)
For n=1 To 4
nn$=n: If n=1 Then nn=""
snd_alienhit(n-1) = LoadSound("sfx\hit"+nn+".wav")
Next



; sound set up control, hear radius in pixels, and snd volume as an overall volume
Global hearradius# = 800
Global SndVolume# = 1



Function playoneshot(sound,x,y)

; middle of play
scnx=GOffsetX + 320
scny=goffsety + 240

snddistance# = Sqr(((scnx-x)*(scnx-x))+((scny-y)*(scny-y)))

volume# = 1 - (snddistance / hearradius)

If volume &lt; 0 Then Return

pan# = (x - scnx) / (hearradius/2)

sndplay = PlaySound(sound)

ChannelVolume sndplay,volume * sndvolume
ChannelPan sndplay,pan

End Function</textarea><br><br>Alien.bb update to include a bit of sound:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Const STANDARD_ALIEN 		= 0
Const FACE_HUGGER_ALIEN		= 1

;==========================================================================================
;TYPES
;==========================================================================================
Type alien
	Field x
	Field y
	Field frame
	Field health
	Field fpause
	Field dir
	Field id
	Field sdelay
	Field targetdir
	Field mode$
	Field visible ; are they currently visible to the player?
	
	Field radius
	Field offset
	Field kind	
End Type

Global aliengfx = LoadAnimImage("gfx/alien.png",64,64,0,8) : MaskImage aliengfx,255,0,255




Function SpawnAlien(X%,Y%,id,kind=STANDARD_ALIEN)
	al.alien = New alien
	
	al\x = X
	al\y = Y
	al\frame = 0
	al\health = 10
	al\fpause = 0
	al\dir = 0
	al\id = id
	al\sdelay = 0
	al\mode="newroam"
	al\visible=gettile(al\x,al\y,LAYER_VISIBLE)
	
	al\kind = kind
	Select kind
		Case 0: ; standard alien
			al\radius=20
			al\offset=32
		Case 1: ; face hugger
			al\radius=10
			al\offset=16
	End Select	
End Function

Function Alien_Die(al.alien)
	
	createparticle(al\x,al\y,0,0,1000,0,7,alienblood,32)
	playoneshot(snd_aliendeath,al\x,al\y)
	
	;create death splat
	n=Rand(20)+5
	For i=1 To n
		d=Rand(359)
		f=Rand(0,3)
		createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)	
	Next
	
	Delete al.alien
			
End Function

Function alien_hit(al.alien,damage=1)
	
	al\health = al\health - damage
	al\mode="underattack"
	
	If Rand(0,2)=0 Then playoneshot(snd_alienhit(Rand(0,3)),al\x,al\y)
	
	
	
	;random alien blood splats
	d=Rand(0,359)
	f=Rand(0,3)
	createparticle(al\x,al\y,Sin(d)*2,Cos(d)*2,Rand(10,100),f,f,particles,16)
		
	If al\health&lt;=0 Then alien_die(al)
End Function


Function Alien_DrawAll()
	Local al.alien
	For al.alien = Each alien
		If al\visible Then 
			Select al\kind
				Case 0:image=aliengfx ; standard alien			
				Case 1:image=aliengfx ; facehugger
			End Select
			DrawImage image,al\x-al\offset-screenx,al\y-al\offset-screeny,al\dir
			;bText al\x-screenx,al\y-screeny,al\mode,True,True
		End If
	Next
End Function



Function update_aliens()

acount=0
	
For al.alien = Each alien

	oldmode$ = al\mode

	If al\visible

		acount=acount+1
	
	
		move=False
		direct$=""
		mr=False
		ml=False
		mu=False
		md=False
		
		; basic alien follow AI
		
		dis = 1000
		targetx=0
		targety=0
		For pl.player = Each player
			ndis = Sqr(((al\x-pl\x)*(al\x-pl\x))+((al\y-pl\y)*(al\y-pl\y)))
			If ndis&lt;dis
				targetx=pl\x
				targety=pl\y
				dis=ndis
			EndIf
		Next
		
		
		If dis&gt;500 And al\mode="underattack" Then al\mode="attack"
		
		; if a player is in range then attack
		If dis&lt;1000
		
		
			If al\mode&lt;&gt;"underattack"
			
			
				; can alien see a player?
				
				For dd=-30 To 30 Step 30
				x=al\x
				y=al\y
				xd=Sin(al\dir*45+dd)*64
				yd=-Cos(al\dir*45+dd)*64
	
				
				ld=10
				cansee=False
				Repeat
					
					x=x+xd
					y=y+yd
					
					For pl.player = Each player
						If circlesoverlap(x,y,al\radius*4,pl\x,pl\y,playerradius) Then cansee=True:ld=1
					Next
					If x&lt;0 Or x&gt;7552 Or y&lt;0 Or y&gt;7552 Then x=0:y=0:id=1
					If gettile(x,y,0)=1 Then cansee=False:ld=1			
				
					ld=ld-1
				Until ld=0
				
				If cansee = True Then Exit
				
				Next
				
				If cansee And al\mode="roam" Then al\mode="attack"
				If cansee=False And al\mode="attack" Then al\mode="roam"
			EndIf
			
			
			;If al\mode="underattack" Then al\mode="attack"
					
			If al\mode="attack" Or al\mode="underattack"
				If al\x&lt;targetx Then mr=True
				If al\x&gt;targetx Then ml=True
				If al\y&lt;targety Then md=True
				If al\y&gt;targety Then mu=True
			EndIf
			
			If al\mode="roam"
				t=al\dir
				If t=7 Or t=0 Or t=1 Then mu=True
				If t=7 Or t=6 Or t=5 Then ml=True
				If t=3 Or t=4 Or t=5 Then md=True
				If t=1 Or t=2 Or t=3 Then mr=True
			EndIf
					
			If al\mode="newroam"
				t=Rand(0,7)
				If t=7 Or t=0 Or t=1 Then mu=True
				If t=7 Or t=6 Or t=5 Then ml=True
				If t=3 Or t=4 Or t=5 Then md=True
				If t=1 Or t=2 Or t=3 Then mr=True
				al\mode="roam"
			EndIf
			
	
		EndIf
		
		; check collisions with other aliens
		For al1.alien = Each alien
			If al\id&lt;&gt;al1\id
			
				If mr And circlesoverlap(al\x+2,al\y,al\radius,al1\x,al1\y,al1\radius) Then mr=False
				If ml And circlesoverlap(al\x-2,al\y,al\radius,al1\x,al1\y,al1\radius) Then ml=False
				If md And circlesoverlap(al\x,al\y+2,al\radius,al1\x,al1\y,al1\radius) Then md=False
				If mu And circlesoverlap(al\x,al\y-2,al\radius,al1\x,al1\y,al1\radius) Then mu=False
				
			EndIf
	
		Next
		
		; check collisions with players	
		For pl.player = Each player
			If mr And circlesoverlap(al\x+2,al\y,al\radius,pl\x,pl\y,playerradius) Then mr=False
			If ml And circlesoverlap(al\x-2,al\y,al\radius,pl\x,pl\y,playerradius) Then ml=False
			If md And circlesoverlap(al\x,al\y+2,al\radius,pl\x,pl\y,playerradius) Then md=False
			If mu And circlesoverlap(al\x,al\y-2,al\radius,pl\x,pl\y,playerradius) Then mu=False
		Next
		
		
		
	
		; Don't hit walls
		If mr Then
			If gettile(al\x+al\radius,al\y,0)=0 Then 
				If al\sDelay=0 Then al\x=al\x+1
				move=True
				direct=direct+"R"
			End If
				
			
		End If
		If ml Then 
			If gettile(al\x-al\radius,al\y,0)=0 Then 
				If al\sDelay=0 Then al\x=al\x-1
				move=True
				direct=direct+"L"
			End If
	
		End If
		If mu Then
			If gettile(al\x,al\y-al\radius,0)=0 Then 
				If al\sDelay=0 Then al\y=al\y-1
				move=True
				direct=direct+"U"
			End If
		End If
		If md Then 
			If gettile(al\x,al\y+al\radius,0)=0 Then 
				If al\sDelay=0 Then al\y=al\y+1
				move=True
				direct=direct+"D"
			End If	
		End If
		
		If move=False And al\mode="roam" Then al\mode="newroam"
		
		al\sdelay = (al\sdelay+1) Mod 2
		
		
		; animation frame control
		If move
			al\fpause = (al\fpause+1) Mod 5
			If al\fpause = 0 Then al\frame = (al\frame+1) Mod 15
		EndIf
	
		If direct = "U" Then al\targetdir=0
		If direct = "RU" Then al\targetdir =1
		If direct = "R" Then al\targetdir =2 
		If direct = "RD" Then al\targetdir = 3
		If direct = "D" Then al\targetdir = 4
		If direct = "LD" Then al\targetdir = 5
		If direct = "L" Then al\targetdir = 6
		If direct = "LU" Then al\targetdir = 7
		
		If turndelay = 0
			al\dir = dirdif (al\dir,al\targetdir)
	
		EndIf

	EndIf
	
	If al\mode&lt;&gt;oldmode And (al\mode="attack" Or al\mode="underattack")
		playoneshot(snd_alienattack,al\x,al\y)
	EndIf
		
Next ; next alien

End Function</textarea> <br><br></td></tr></table><br>
<a name="422112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, so here it is -&gt; <b><a href="http://members.lycos.co.uk/marktiffany/story.html" target="_blank">Possible Story</a></b><br><br>It's very ambitious, and I certainly don't suggest we try to build all this now.  Or even at all. I don't know that we'll ever get that far. But to make a true game, we need something to aim for, and even if we discard the above completely, it serves to provide a context within which to design a new tileset and maps. It also shows up a few more potential todo's:<br><br>1)Documents lying on the ground which are read when picked up<br>2)Intex system to give access to individuals emails (logons on the documents), which not only develop plot but provide access codes to some doors (to ensure players get the key plot emails!)<br>3)'Alien' types that you shouldn't shoot (NPCs)<br>4) Limited conversations with NPCs (i.e. no interaction, trigerred by entering a room / killing all aliens / boss energy level being low)<br>5) Level structure / completion conditions / in between level media<br>6) Reward structure such that shooting only aliens (not real humans) is rewarded (maybe a 'hero' rating?)<br><br>However, as Rob has stated before, we need to get some more core elements working before we tackle many of those.  But how's that for starters?<br><br>(And I'm quite happy to be shot down and told this is crap, and for it to be thrown away at some point.  Hopefully it will at least have served the purpose of igniting discussion and fuelling further ideas...) <br><br></td></tr></table><br>
<a name="422137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll be up on this tomorrow guys. Wow, mark, I LIKE the story. Very nicely thought out! <br><br></td></tr></table><br>
<a name="422150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> ta.  now we just gotta make it... ;-)<br><br>There's a bug somewhere in the alien logic I think.  If I stand still (or not) for a while (10 secs), an array index out of bounds occurs in gettile.  I'm guessing it's the alien AI for roaming, but haven't had a chance to check it out - almost there with the vis...<br><br>...speaking of which, can we move all 'internal' wall block to a set location in the list (beginning, middle or end, just together somewhere) to simplify my vis check.  'fraid I don't have to do it myself right now... <br><br></td></tr></table><br>
<a name="422167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Guys, I sent an email to a guy called Zeb who does alien fan art, I got an email from the guy who runs the site saying that Zeb is a nice guy and will probably say yes to using his pictures, or maybe... just maybe he might do some for us. <br><br>I said it's a freebee game so we can't pay anything but will give as much credit or links to sites as he wants...<br><br>Anyway... here's a link to some of his stuff:<br><br><a href="http://www.brian-oshaughnessy.com/alien/Fan-Art.html" target="_blank">http://www.brian-oshaughnessy.com/alien/Fan-Art.html</a><br><br>I thought it would make great inbetween level images with the briefing appearing over the top.<br><br><br><br>Regarding the story...<br><br>Not sure how much of this investigation should happen by the player and how much should be narrative. I think if you try to have too much thinking work in the game it'll slow it down. Having it as a narrative would keep the action of the game in place but still maintain the plot without slow bits. <br><br>I think you've got to have one or the other, I don't think a blastathon followed by basically a point and click adventure (or there abouts) will work, and it'll make the game engine complicated as hell.<br><br>I do like the story though, I just think the more complex parts (investigation and so on) need to just be told rather than explored by the player.<br><br>Also, you've got to take into account the two player mode so it's potentially not one man against the world, it's a team. So maybe you could have a crack team that go down and have a set piece where most die, all except one or two?<br><br>Just my thoughts. <br><br></td></tr></table><br>
<a name="422179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Story:<br><br>Space baps.<br><br>The End. <br><br></td></tr></table><br>
<a name="422182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Like the set piece bit.  My thinking on how the narrative would unfold is a small number of key documents / emails / conversations that *must* happen (i.e. they unlock a door / ending for a map), but have other supporting stuff if you go looking.  I'm thinking just one or two key things per map - and some maps might simply be blastfests with no key info.<br><br>Anyway, here's an updated vis.  It's not *quite* right (try adding a building with 4 rooms in and thick internal walls and you'll see).  I've run out of time tonight, will fix tomorrow...<br><br>Again it's a little slow, but let's see where this goes for now...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; list of tiles to check for visibility
Type vis_list
	Field x,y
End Type

Type wall_vis_list
	Field x,y
End Type

Function CheckVis(x,y)
; This function determine the map vis for a player
	
	; add the start tile to the list
	v.vis_list=New vis_list
	v\x=x
	v\y=y

	; and start checking by looping through all tiles in the list that need checking
	Repeat
		; go through all 8 nearby squares
		For i=1 To 8
			Select i
				Case 1:x=v\x-1:y=v\y-1
				Case 2:x=v\x-1:y=v\y
				Case 3:x=v\x-1:y=v\y+1
				Case 4:x=v\x:y=v\y-1
				Case 5:x=v\x:y=v\y+1
				Case 6:x=v\x+1:y=v\y-1
				Case 7:x=v\x+1:y=v\y
				Case 8:x=v\x+1:y=v\y+1
			End Select
			
			; if it's on the map, we check it
			If x&gt;=0 And x&lt;=255 And y&gt;=0 And y&lt;=255 Then
				; if it's never been checked before (vis=0), check it.  otherwise, don't bother
				If map(x,y,LAYER_VISIBLE)=0 Then

					; set it to visible (including all solid blocks at the boundary of vis are themselves visible)
					map(x,y,LAYER_VISIBLE)=1
				
					; and provided it's not solid, add it to the list of tiles to process
					If map(x,y,0)=0 Then
						nv.vis_list=New vis_list
						nv\x=x
						nv\y=y
					Else
						;if it is solid, add to the wall_vis_list to check in mo...
						wv.wall_vis_list=New wall_vis_list
						wv\x=x
						wv\y=y
					End If
				End If
				
			End If	
					
		Next
		
		; set current tile to visible
		map(v\x,v\y,LAYER_VISIBLE)=1
				
		; eliminate this one from the list to check and move on to the next one
		Delete v
		v=First vis_list
	Until v=Null
	
	; now check all wall tiles that have just been identified for checking
	; this is to ensure INTERNAL walls get vis'd too...
	wv.wall_vis_list=First wall_vis_list
	If wv&lt;&gt;Null Then
		Repeat
			; go through all 4 directions
			For i=1 To 4
				x=wv\x
				y=wv\y
				Select i
					Case 1:xstep=0:ystep=-1
					Case 2:xstep=0:ystep=+1
					Case 3:xstep=-1:ystep=0
					Case 4:xstep=+1:ystep=0
				End Select				
				
				Repeat
					x=x+xstep
					y=y+ystep
					
					; if we fell off the map, light them
					If x&lt;0 Or x&gt;255 Or y&lt;0 Or y&gt;255 Then bLight=True:Exit
					
					; if we hit a lit tile, then we can light all in between
					If map(x,y,LAYER_VISIBLE)&gt;0 Then bLight=True:Exit
					
					; if it's not an internal wall tile...
					If map(x,y,1)&lt;&gt;6 And map(x,y,1)&lt;&gt;36 And map(x,y,1)&lt;&gt;37 And map(x,y,1)&lt;&gt;51 And map(x,y,1)&lt;&gt;52 And map(x,y,1)&lt;&gt;81 And map(x,y,1)&lt;&gt;82 And map(x,y,1)&lt;&gt;83 And map(x,y,1)&lt;&gt;84 Then 
						bLight=False:Exit
					End If
					
				Forever 
				
				; if we decided to light in between tiles...
				If bLight Then
					Repeat
						; work backwards from where we are
						x=x-xstep
						y=y-ystep
						; to where we started
						If x=wv\x And y=wv\y Then Exit
						; lighting each tile as we go
						map(x,y,LAYER_VISIBLE)=1
						; and adding them to the list to check
						nwv.wall_vis_list=New wall_vis_list
						nwv\x=x
						nwv\y=y
					Forever 			
				End If
				
			Next
			
			; eliminate this one from the list to check and move on to the next one
			Delete wv
			wv=First wall_vis_list
		Until wv=Null	
	End If
	
	; now check all aliens (UNSURE if this should be here, or in aliens.bb?)
	For al.alien = Each alien
		If al\visible=0 Then
			If gettile(al\x,al\y,LAYER_VISIBLE)&gt;0 Then al\visible=1
		End If
	Next
	
End Function
</textarea> <br><br></td></tr></table><br>
<a name="422187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm all for adventuring, finding keys, security passes to get through the level. I'm just thinking with emails and things you don't have to do anything about it, it just happens.<br><br>This needs more discussion... Ideally down the pub...<br><br>Anyway... time for bed said zeberdee! <br><br></td></tr></table><br>
<a name="422190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your getTile() function doesn't have these lines in it, add them. They check for out of dimension calls. You should also add these lines to putTile() as well.<br><pre class=code>
	If x &lt; 0 Then Return
	If y &lt; 0 Then Return
	If x &gt; 7552 Then Return
	If y &gt; 7552 Then Return
</pre><br>I'll upload the code and new media in 10 minutes. <br><br></td></tr></table><br>
<a name="422199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, updated. Check in my sig. <br><br></td></tr></table><br>
<a name="422322"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matthew Smith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Made some changes to descrease the players health:<br><br>In Player.bb:<br><pre class=code>
Player Type:
change health to health#

Add to global variables:
Global playerHealthDecrease# = 0.1	;used to determine how quickly the player loses health when touched by alien
</pre><br><br>In Player.bb - Player_UpdateAll<br><pre class=code>
;Check player health
If pl\health = 0 Then
	;TODO: Death of player
		
End If
</pre><br><br>In Alien.bb - Update Aliens<br><pre class=code>
; check collisions with players	
For pl.player = Each player
        If mr And circlesoverlap(al\x+2,al\y,al\radius,pl\x,pl\y,playerradius) Then mr=False
        If ml And circlesoverlap(al\x-2,al\y,al\radius,pl\x,pl\y,playerradius) Then ml=False
	If md And circlesoverlap(al\x,al\y+2,al\radius,pl\x,pl\y,playerradius) Then md=False
	If mu And circlesoverlap(al\x,al\y-2,al\radius,pl\x,pl\y,playerradius) Then mu=False
			
	;Check for player damage
	If circlesoverlap(al\x,al\y,al\radius*1.2,pl\x,pl\y,playerradius) Then
		pl\health = pl\health - playerHealthDecrease
		If pl\health &lt; 0 Then
			pl\health = 0
					
		End If
			
	End If

Next
</pre><br><br>To alert some aliens of a player's presence, you could add some trigger fields on the map - ie. around doorways.<br><br>It's really starting to come together - you guys have done a great job! <br><br></td></tr></table><br>
<a name="422436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> not bad so far:<br><pre class=code>
09-09-2004 : 
Rims
- Changed rob's .wav to .mp3 in the sound lib.
- Added pickup of key and health sounds in player.bb as well as shoot sound
- Moved sounds to sounds.bb file
- Added player hurt sound to aliens.bb
- Moved code effecting player's health to player.bb -&gt; Player_affectHealth(p.player,h)
Matt
- Added player decrease in health (aliens affect player)

08-09-2004 :
Rob Farley
- Added a sound lib. Added to util.bb
- Updated alien_hit with sounds.
- Added media from coffeebean's alien breed alpha. New media.zip
Coffeebean
Very, very useful sound media
Mark Tiffany 
- First version of story.
- Updated vis function.
Rims
- Added a version const so we know where we are.
- Hold down space to see alien states.

07-09-2004 :
Rob Farley 
- Particles.bb added replacing decals.bb
- Updated alien.bb-&gt;alien_Hit and alien_Die functions
- New particle media added.
- New alien states.
- Updated openDoor function.
- Modified test.map
Rims 
- Added animation.bb for animation loops.
- Changed the history.txt to be more readable.
Mark Tiffany 
- util.bb and map.bb added for more code separation
- Main routine formatting tidied (indented!)
- Added map visibility.  Updated at start and opening doors, alien code also uses vis to determine who gets updated
Rims 	
- Added alien kinds and radius+offsets.
- Updated alien_drawAll to accomodate new alien drawing. As soon as we get some new face hugger media we can get them drawn and moving around.
- Updated the getTile function (error checking)
			 

06-09-2004 :	
Poed Boy 
- Added decals instead of tile splatters
Rob Farley 
- Modified decal include to act as a basic particle system
CoffeeDotBean 
- Added Gun flash code
Rims 
- Added HUD and corrected player 2 strafe mode bug
Rob Farley 
- Added the basic console for intex systems
- Added control.bb, outline for better control methodology

04-09-2004 :	
Rob Farley 
- Retreat/strafe mode, when holding down fire the played doesn't change direction
- Turnaround added so aliens and players don't switch from left to right they go round all available turning positions, makes it look better.
- Alien media tidied up a bit
- Bullet media added
- Alien blood media added
- When aliens dies they leave blood

03-09-2004 :
Rims 
- Different weapons
Rob Farley 
- Different visible bullet types for the weapons, also this type is carried over to the kill_bullet to allow for different blasts depending on the bullet type
- Basic collision on the aliens so they don't run over each other, although they sometimes get stuck so this needs to be improved.

02-09-2004 :
Perturbatio 
- Improved and fixed a couple of bugs in the editor
Matt 
- Updated shooting and object collection to deal with clips
Rob Farley 
- Removed offset from positioning of bullets and blasts
- Added shooting of aliens, alien health and alien death

01-09-2004 :
Matt 
- Fixed the shooting bug
Poed Boy 
- Seperated out the player code into functions and tidied up the main loop
Rob Farley 
- Refixed the players getting stuck at edges bug!
- Added alien gfx and basic alien handling code

31-08-2004 :
Rims 
- Blast and shooting includes (athough shooting appears to be a little buggy)
Matt 
- Fixed players getting stuck at edges bug

29-08-2004 :	
Rims 
- 2 Player code
Rob Farley
- Updated temp hud
- Media, added block overlay on map, added object tiles.
- More Media, doors and keys now work. Door opening needs animation though
Coffeedotbean 
- kindly donated the media from his Alpha Breed project.

25-08-2004 :	
Rob Farley 
- First release, basic map editor, game engine and tileset.

</pre> <br><br></td></tr></table><br>
<a name="422437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Certainly not bad for 2 weeks work!<br><br>I've actually signed up to a couple of extra forums after seeing these referrers from these sites to my site...<br><br><a href="http://forum.team17.com/showthread.php?p=308676#post308676" target="_blank">http://forum.team17.com/showthread.php?p=308676#post308676</a><br><a href="http://www.lemonamiga.com/forum/viewtopic.php?t=354" target="_blank">http://www.lemonamiga.com/forum/viewtopic.php?t=354</a><br><br>Anyway... I've only got one more night of work on this before I go away for 2 weeks... I think I'll have a go at the face hugger! <br><br></td></tr></table><br>
<a name="422450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've tried but I'm so crap at graphics that it looks almost cute and cuddly scuttling around. <br><br></td></tr></table><br>
<a name="422643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, I've made a pretty drastic update to several files, I started keeping a changelog, but there was a helluva lot to change to get this to work:<br><br>Added a new layer type to the editor (hit point layer) this allows you to create destructible objects (at this point, only doors)<br>I had to modify a lot of the files to get it working, too many changes to list here.<br><br>You can download a zip with all the code files <a href="http://www.perturbatio.com/files/code.zip" target="_blank">here</a><br><br>I created a new include: consts.bb this contains easy to read consts instead of hard coded values all over the place.<br>Not all the relevant code has been updated to reflect this, but I'll eventually get around to it, just wanted to post this to make sure I get it in before someone else updates.<br><br>(to adjust the hit points for a section, switch to hit point layer, left click to increase value, right click to decrease, hold left ctrl to inc/dec by 5)<br><br>*EDIT*<br>oops, forgot:<br>Use middle mouse in map editor to set a dynamic collision object<br><br>*EDIT*<br>in map.bb, add the following to the bottom of the select clause in Function DamageTile<br><pre class=code>
			;default action for any other destructible object
			Default
				Map(x,y,LayerObject) = 0
				Map(x,y,LayerCollision) = 0
</pre> <br><br></td></tr></table><br>
<a name="422664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll be back in a few hours and have a look. <br><br></td></tr></table><br>
<a name="422796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, it's all updated. Check the sign. <br><br></td></tr></table><br>
<a name="422816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, a very basic map.  I needed this to think about vis rather than anything else, and it needs work.  But I thought it worth posting anyways...<br><br>First up, you need <a href="http://members.lycos.co.uk/marktiffany/tiles_small.png" target="_blank">*this*</a> new file: gfx/tiles_small.png.  I'm sure we could generate this on the fly (when loading the big tiles), but this ended up being simplest.<br><br>In engine.bb, where tiles are loaded, amend it to read as follows:<br><pre class=code>Global tiles = LoadAnimImage("gfx/tiles.png",32,32,0,maxtile)
Global tiles_small = LoadAnimImage("gfx/tiles_small.png",16,16,0,maxtile)
Global objects = LoadAnimImage("gfx/objects.png",32,32,0,maxobject)
MaskImage tiles,255,0,255
MaskImage tiles_small,255,0,255
MaskImage objects,255,0,255</pre><br>and in the same file, where the keyhit checks are at the end of the main loop, add this:<br><pre class=code>	If KeyHit(50) Then showmap(1):time=MilliSecs()-period ; M</pre><br>In intex.bb, in the Intex() function, amend the input code to look like this:<br><pre class=code>	itemno = intexmenu("Testing|Testing|One|Two|Download Map|Exit",150,itemno,player)
	
	If control(pfire1,player)
		If itemno = 5 Then
			;TODO: request password for map 
			; light up everything
			For x=0 To 255
				For y=0 To 255
					map(x,y,LAYER_VISIBLE)=1
					; TODO: Consider setting mapped but unexplored areas differently to show them as such on the map?
				Next
			Next
			;TODO: ought to visibly confirm the map has been downloaded (or not)!
		End If	
		If itemno = 6 Then Exit
	EndIf</pre><br>On the way, a little 'bugfix' that helped out: in players.bb add this line to the end of player_create()...<br><pre class=code>Player(id)=pl</pre><br>In map.bb, replace drawmap with this:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function drawmap(xpos,ypos,layer,zoom=1)

If zoom=1 Then
	blocksize=32
	max_x=20
	max_y=15
	mytiles=tiles
ElseIf zoom=2 Then
	xpos=xpos/2
	ypos=ypos/2
	blocksize=16
	max_x=40
	max_y=30
	mytiles=tiles_small ; need a 1/2 size set of tiles
EndIf
; for all "if ___ then Draw ___" lines, multiply the expression by map(x+xoff,y+yoff,LAYER_VISIBLE)

; sort out the block location based on pixel co-ord
xoff = Floor(xpos/blocksize)
yoff = Floor(ypos/blocksize)

; find the pixel offset
xpxoff = (xoff * blocksize) - xpos
ypxoff = (yoff * blocksize) - ypos

; draw base layer
; uses draw block so you don't need a cls and is quicker.
If layer = 1
	Cls
	For x = -1 To max_x
		For y = -1 To max_y
			If x+xoff&gt;=0 And y+yoff&gt;=0 And x+xoff&lt;=255 And y+yoff&lt;=255		
			If map(x+xoff,y+yoff,layer)*map(x+xoff,y+yoff,LAYER_VISIBLE)&gt;0 Then DrawBlock mytiles,(x*blocksize)+xpxoff,(y*blocksize)+ypxoff,map(x+xoff,y+yoff,layer)-1			
			EndIf
		Next
	Next
EndIf

If layer = 2
	For x = -1 To max_x
		For y = -1 To max_y
			If x+xoff&gt;=0 And y+yoff&gt;=0 And x+xoff&lt;=255 And y+yoff&lt;=255	
			If map(x+xoff,y+yoff,layer)*map(x+xoff,y+yoff,LAYER_VISIBLE)&gt;0 Then DrawImage objects,(x*blocksize)+xpxoff,(y*blocksize)+ypxoff,map(x+xoff,y+yoff,layer)-1			
			EndIf
		Next
	Next
EndIf

; draw other layers
If layer = 3
	For x = -1 To max_x
		For y = -1 To max_y
			If x+xoff&gt;=0 And y+yoff&gt;=0 And x+xoff&lt;=255 And y+yoff&lt;=255			
			If map(x+xoff,y+yoff,layer)*map(x+xoff,y+yoff,LAYER_VISIBLE)&gt;0 Then DrawImage mytiles,(x*blocksize)+xpxoff,(y*blocksize)+ypxoff,map(x+xoff,y+yoff,layer)-1		
			EndIf
		Next
	Next
EndIf

; layer 4, block overlay no transparancy
If layer = 4
	For x = -1 To max_x
		For y = -1 To max_y
			If x+xoff&gt;=0 And y+yoff&gt;=0 And x+xoff&lt;=255 And y+yoff&lt;=255			
			If map(x+xoff,y+yoff,layer)*map(x+xoff,y+yoff,LAYER_VISIBLE)&gt;0 Then DrawBlock mytiles,(x*blocksize)+xpxoff,(y*blocksize)+ypxoff,map(x+xoff,y+yoff,layer)-1			
			EndIf
		Next
	Next
EndIf

End Function
</textarea><br>And finally, also in map.bb, add the new showmap()<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function ShowMap(i)
	; this is a very naff map, mainly intended for helping to test the vis functions
	p.player=Player(i)
	x=p\x/2:y=p\y/2
	;TODO: Initial position is dodgy, should be centred on the player...
	
	Repeat
		Cls
		drawmap(x,y,1,2)
		; don't make it too easy, leave out the objects... ;-)
		;TODO: trouble is, we need the doors...
		drawmap(x,y,3,2)
		drawmap(x,y,4,2)
		;TODO: need to show players location!
		
		If control(pup,i) Then y=y-8
		If control(pdown,i) Then y=y+8
		If control(pleft,i) Then x=x-8
		If control(pright,i) Then x=x+8
		
		Flip
	Until KeyHit(1)
		
End Function</textarea><br><br>Which is kinda handy.<br><br>However, it has proven to me (along with several test maps*) that I don't think we can use dynamic vis - I think we need pre-calculated vis blocks as discussed above.  I may be able to reuse my current code however to 'guess' those vis lines for you in the editor, so maybe all is not lost.  Will try to fix this over the weekend, but am away at the in-laws...<br><br>*If you're interested in maps that screw the vis, create a large building in the middle of an empty map with thick internal walls.  Divide it into 4 rooms with a big +, making sure the centre of the plus includes lots of internal walls.  Play it.  You'll be able to see the outline structure of the building *and* the internal walls.  There are other problems too (put more structure around the outside and you'll see), but this was the one that broke the camels back for me... <br><br></td></tr></table><br>
<a name="422817"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> Time for a new thread? <br><br></td></tr></table><br>
<a name="422825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> Absolutely... <br><br></td></tr></table><br>
<a name="422854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rims... Did you get my face hugger gfx. <br><br></td></tr></table><br>
<a name="422855"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, it's in there. Did you get my mail? You couldn't have a look at the code. Specifically: aliens.bb-&gt;Alien_DrawAll(). I've cludged the face huggers walking around. <br><br></td></tr></table><br>
<a name="423135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/Community/posts.php?topic=38223" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=38223</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
