<!DOCTYPE html><html lang="en" ><head ><title >playing with ode</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >playing with ode</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=61" >Showcase</a>/<a href="#bottom" >playing with ode</a><br><br>
<a name="1034531"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br><br><img src="http://sites.google.com/site/odriozolajuanignacio/demo.jpg"><br><br>still much to do, take a look<br><br><a href="http://sites.google.com/site/odriozolajuanignacio/demo.zip" target="_blank">http://sites.google.com/site/odriozolajuanignacio/demo.zip</a><br><br>Basically i'm building some cars with ConveyorBelts, Magnets, and the like. They are built/designed on a editor (sold separately: AWC) and then merged on a scenary. <br><br><img src="http://sites.google.com/site/odriozolajuanignacio/auto2.jpg"><br><br>And some interactive objects wich can trigger some events. At this stage, with Keys preasigned you can control the "Active Car" and pressing TAB key you can cycle through the 5 placed. Some cubes are metalic and can be handled with magnets some others not, there are some green and red small and thin cubes on the floor that act as IR barriers an at the moment control 3 conveyor belts palaced on the scenary. Planed Plataforms, Doors, and the like.<br><br>If you edit the cars and or the scenary there are some objects you can't rename or delete: those called "Ctrl....." they are used to create controlled joints, magnets and conveyor belts.<br>There are 5 objects in Scenary.awc called Pivot_001 to Pivot_005 that control the initial position of the cars.<br><br>There are no rules at the momment, simply some primitive objects.<br><br>Any comments sugestions and ideas will be apreciated.<br><br>thank's<br><br>Juan <br><br></td></tr></table><br>
<a name="1034576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> wow - bravo! This looks like a very cool use of a physics engine.<br>I had a quick play and the vehicles are slow and difficult to control but I very much like where this is going - keep it up!<br><br>D. <br><br></td></tr></table><br>
<a name="1034579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice stuff!<br><br>Are you using the JV ODE dll, or an own wrapper? If it is your own wrapper, woud you be willing to share it? <br><br></td></tr></table><br>
<a name="1034638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, they are difficult to drive, more steer, more speed shoul be ok, also i'm trying to apply the opposit steer to the backward wheels to reach smaller turns and feels ok.<br><br>just JV-ODE with some .bb code included with the Free AWC (not sold separatly!) to load the world and to create the ode objects.<br><br>the 6 *.awc files in DEMO.ZIP can be edited and they are readed by the demo.exe to create the ode/blitz objects, so any changes you made will be reflected the next run.<br><br>following is an incomplete (just because there are still much experimental and dirty code) but with it you can load the scenary.awc and the 5 cars. The main loop only updates the camera and no forces are aplied to any joint. (you need to download awc for the editor and some included .bb files)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;
;autor Juan Ignacio Odriozola	jio@...	Charrua
;
;
;just an example of how to load the Scenary and merge the cars made in separate awc files
;the first loaded file: Scenary.awc has Pivots (from Pivot_001 to Pivot_005 to signal the position where cars will be placed)


Graphics3D 800,600,0,2

SetBuffer BackBuffer()

Include "include\awc Loader.bb"		;this files are part of AWC, a free World Editor
Include "include\awc_ode_lib.bb"

;awc_PhysicsDebug=True	;set to true as needed
;awc_Debug = True

Local Result


Global gameFPS#, frameTime, framePeriod

;used to calculate the time spent in UpdateGame and RenderWorld and to
;calculate the ammount of renders per second and Game updates per second
Global fps_, fps	;number of RenderWorld's per second
Global ups_, ups	;number of update games per second
Global tug_, tug	;accumulated time of update games in 1 second
Global trw_, trw	;accumulated time of render world in 1 second
Global tuw_, tuw	;accumulated time of update world in 1 second
Global NextSecond
Global TrisGranularity
Global tTemp

Global ExitLoop, ShowBarGraph=True

gameFPS=50.0
framePeriod = 1000 / gameFPS
frameTime = MilliSecs () - framePeriod	;simulamos que el tiempo del cuadro anterior fue del
									;período que quermos

NextSecond = MilliSecs()
TrisGranularity = 1000

odeInit()

temp = CreatePivot()
NameEntity temp,"Scenary_"
LoadWorld("scenary.awc",0,temp)
FreeEntity temp

temp=GetEntity("Scenary_Pivot_001")
NameEntity temp,"A1_"
LoadWorld("MagnetoCar.awc",0,temp)

temp=GetEntity("Scenary_Pivot_002")
NameEntity temp,"A2_"
LoadWorld("MagnetoCar2.awc",0,temp)

temp=GetEntity("Scenary_Pivot_003")
NameEntity temp,"A3_"
LoadWorld("ConveyorBelt.awc",0,temp)

temp=GetEntity("Scenary_Pivot_004")
NameEntity temp,"A4_"
LoadWorld("Forklift.awc",0,temp)

temp=GetEntity("Scenary_Pivot_005")
NameEntity temp,"A5_"
LoadWorld("MechanicalShover.awc",0,temp)


CreateOdeObjects()

Global Camera = getEntity("Scenary_Camera_001")

Repeat

	Repeat
		frameElapsed = MilliSecs () - frameTime
	Until frameElapsed
	frameTicks = frameElapsed / framePeriod
	
	frameTween# = Float (frameElapsed Mod framePeriod) / Float (framePeriod)
	
	For frameLimit = 1 To frameTicks
	
		If frameLimit = frameTicks Then CaptureWorld
		frameTime = frameTime + framePeriod
		
		tTemp = MilliSecs()
		
		UpdateGame ()
		
		tug_ = tug_ + MilliSecs() - tTemp
		
		ups_ = ups_ + 1

		tTemp = MilliSecs()
		UpdateWorld
		tuw_ = tuw_ + MilliSecs() - tTemp

			
	Next
	
	tTemp = MilliSecs()
	RenderWorld frameTween
	trw_ = trw_ + MilliSecs() - tTemp
	fps_=fps_+1

	
	If MilliSecs()&gt;NextSecond Then
		fps = fps_
		fps_ = 0
		ups = ups_
		ups_ = 0
		tug = tug_
		tug_ = 0
		trw = trw_
		trw_ = 0
		tuw = tuw_
		tuw_ = 0
		NextSecond=MilliSecs()+1000
	End If
	If ShowBarGraph Then BarGraph()
	
	Flip

Until ExitLoop


End

Function BarGraph()

	;shows a graph with 
	;	FPS in red from 0 To 60
	;	game updates in white from 0 to 60
	;	ammount of RenderWorld in green plus game updates in blue plus update world in yelow
	;	concatenated and calculated as a percent of 1 second
	;
	;the graph has as a background a rectangle in black that covers just 5/6
	;signaling 100% for UpdateGame+UpdateWorld+RenderWorld
	;the vertical lines signal 5, 10, 15 and so on for fps and 10, 20, 30, etc
	;for percentages.
	;least: TrisRendered() from 0 to TrisGranularity*100 in grey
	;each vertical line signal for TrisRendered the ammount defined previously by TrisGranularity
	
	
	Color 0,0,0
	Rect 10,8,100,42
	For i=1 To 12		;from 0 to 60 whatever per second or 0 to 100%
		If i Mod 2 Then
			Color 0,128,128
		Else
			Color 0,192,192
		End If
		Line 10+i*10,8,10+i*10,50
	Next
	Color 255,0,0		;en rojo world renders 
	Rect 10,10,fps*2,6
	Color 255,255,255	;en blanco game updates
	Rect 10,20,ups*2,6
	Color 0,255,0		;como porcentaje en verde Trender
	Rect 10,30,100*trw/1000,6
	Color 0,0,255		;en azul T update game
	Rect 10+100*trw/1000,30,100*tug/1000,6
	Color 255,255,0		;en amarillo T update world
	Rect 10+100*trw/1000+100*tug/1000,30,100*tuw/1000,6
	Color 192,192,192
	Rect 10,40,TrisRendered()/TrisGranularity ,6	;en gris TrisRendered()

End Function

Function UpdateGame()

	If KeyHit(1) Then ExitLoop=True	;ESC
	If KeyHit(68) Then ShowBarGraph = Not(ShowBarGraph)	;F10

	MouseLook(Camera)

	odeUpdate()

End Function

;stolen from fast lib examples! 
Global DeltaTimeK# = 1.0
Global DeltaTimeOld = MilliSecs()

Function MouseLook(cam)
	Local t=MilliSecs()
	Local dt = t - DeltaTimeOld
	DeltaTimeOld = t
	Local dk# = Float(dt)/16.666
	DeltaTimeK = dk
	s#=0.2*dk
	dx#=(GraphicsWidth()/2-MouseX())*0.2
	dy#=(GraphicsHeight()/2-MouseY())*0.2
	TurnEntity cam,-dy,dx,0
	RotateEntity cam,EntityPitch(cam,1),EntityYaw(cam,1),0,1
	 If KeyDown(17) MoveEntity cam,0,0,s
	 If KeyDown(31) MoveEntity cam,0,0,-s
	 If KeyDown(32) MoveEntity cam,s,0,0 
	 If KeyDown(30) MoveEntity cam,-s,0,0
	y# = EntityY(cam,1)
	If y&lt;-3 Then y=-3
	If y&gt;5 Then y=5
	PositionEntity cam, EntityX(cam,1),y,EntityZ(cam,1)
	MoveMouse GraphicsWidth()/2, GraphicsHeight()/2
End Function

</textarea><br><br>thank's for your time<br><br>Juan <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
