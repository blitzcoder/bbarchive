<!DOCTYPE html><html lang="en" ><head ><title >Max NG 64 bit compiler compilation</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Max NG 64 bit compiler compilation</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=126" >BlitzMax NG</a>/<a href="#bottom" >Max NG 64 bit compiler compilation</a><br><br>
<a name="1312404"></a>

<a name="1312405"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya all,<br><br>I was just wondering if anyone is using 64bit builds of the NG compiler tools on Linux?<br><br>I have come across a slight issue of a segmentation fault when New'ing an object that has a Field member that's a Ptr ( in my case a Float Ptr ). This only happens during runtime when compiled by the 64bit version which doesn't happen when compiled by the 32bit version of the compiler.<br><br>Other than the runtime components I fail to see how this makes any difference at the moment. I don't want to blame the compiler itself as it could well be, and seems like, that the fault is elsewhere in the runtime components.<br><br>The app is built and run as a 64bit app using both compilers.<br><br>Just wondered if anyone else is using a 64bit version and experiencing any probs.<br><br>Cheers! <br><br></td></tr></table><br>
<a name="1312407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could create a small "bugged samplE" - and then compare the intermediately generated C-files (to see what they do differently).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1312408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you happen to have a small, reproducible example? ;-)<br><br><div class="quote"> I was just wondering if anyone is using 64bit builds of the NG compiler tools on Linux? <br></div><br>I tend to use 64-bit bmk, and 32-bit -legacy compiled- bcc (generally because I'm using two different sets of BlitzMax, a legcay one for developing bcc, and an NG BlitzMax for testing and every-day stuff).<br><br>But, yeah, there shouldn't really be any difference in output between a 32-bit and 64-bit version of bcc - if there is, then there's a bug somewhere :-p<br>I suppose, one could diff source output from legacy bcc compiled, 32-bit and 64-bit NG compiled versions - there should be no difference. <br><br></td></tr></table><br>
<a name="1312409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did manually look through the output which looked identical, but admittedly it was really late and I was going a little cross eyed so I may well have missed something :p<br>I'm at work the mo so I can't double check via diff until later.<br><br><div class="quote"> Do you happen to have a small, reproducible example? <br></div><br>For sure, its as simple as<br><pre class=code>
SuperStrict
Type MyType
	Field fp:Float Ptr
EndType

Local t:MyType = New MyType
</pre><br><br>Using a 64bit build of all the tools it segfaults at the New statement, removing the Ptr and no segfault. Using 32bit compiled tools the example works as expected. Real strange. I must have missed something somewhere in the output. <br><br></td></tr></table><br>
<a name="1312412"></a>

<a name="1312413"></a>

<a name="1312414"></a>

<a name="1312415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh I just remembered some potentially important parts, lol, it DOESNT segfault in release mode. In debug mode it errors out whether I step through using the editor or just let it run.<br>And also I just remembered that the editor is built as 64bit too, so I guess that should also be factored into the bug hunt. I'm starting to think that's where I'd look first now... some sleep did help after all :D <br><br></td></tr></table><br>
<a name="1312420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> So the editor segfaults rather than the sample code?<br><br>I had issues with crashing MaxIDE(gtk) too on some debugging scenarios (unreproduceable).<br><br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1312421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FireballStarfish</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Personally, I can't reproduce this.<br>64-bit NG-built bcc, bmk and MaxIDE here, all up-to-date with the master branches on git.<br>With the code from two posts above (I've taken the liberty of adding a "Framework BRL.Blitz"), compiled on Windows 7 under any settings (including x64 debug mode), no crash or error message occurs. Seems to be working fine here. <br><br></td></tr></table><br>
<a name="1312422"></a>

<a name="1312423"></a>

<a name="1312425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So the editor segfaults rather than the sample code? <br></div><br>It looks as though it could be that. I was just thinking about it this morning and what other possible areas could cause it. I was doubting it could be the compiler or the runtime parts, as the compiler should output the same code regardless of its build architecture, and I think to question the runtime would be a red herring.<br><br>@FireballFlame<br>Thanks for your windows feedback. I was going to do a 64bit build of everything on a Windows7 machine this afternoon and see how it is with the full app as opposed to the sample code. It runs fine when compiled with a 32bit build. <br><br></td></tr></table><br>
<a name="1312429"></a>

<a name="1312431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Opening a can of worms here :D<br><br>I admit my Linux NG setup is a week or 2 behind the latest commits however using a Win7 machine, and the very latest commits of bcc, bmk, maxide, brl.mod and pub.mod, and using NG x86 to compile to x64 binaries I have this:<br><br>bcc - built ok<br>bmk - built ok<br>maxide - built ok<br><br>Moved the binaries to the correct folders and 'Rebuild all Modules' gives me this:<br><pre class=code>
[ 44%] Compiling:lua.bmx.debug.win32.x64.c
C:/BlitzMax/mod/pub.mod/lua.mod/.bmx/lua.bmx.debug.win32.x64.c:33:2: error: 'BBDEBUGSCOPE_USERSTRUCT' undeclared here (not in a function)
  BBDEBUGSCOPE_USERSTRUCT,
  ^
Build Error: failed to compile C:/BlitzMax/mod/pub.mod/lua.mod/.bmx/lua.bmx.debug.win32.x64.c
Process complete
</pre><br><br>Commenting out the pub.mod/lua.mod and brl.mod/maxlua.mod I then 'Rebuild all modules' compiles everything without a problem.<br><br>Anyway with that little bit aside, re-compiling the 'not working' app on the Win7 x64 built NG and everything compiles and runs in debug and release without a problem.<br><br>I guess I'll take a another, better, look at my setup when I get home and report back.<br><br>@Derron,<br>did you ever get to the cause of your crashes? <br><br></td></tr></table><br>
<a name="1312446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope..as this needs a maxide run within a maxide ..so a debugbuild then. But as thus only happens occsssionally...i am not testing that.<br><br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1312460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> BBDEBUGSCOPE_USERSTRUCT  is declared in blitz_debug.h <br><br></td></tr></table><br>
<a name="1312461"></a>

<a name="1312462"></a>

<a name="1312463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> My initial posted problem turns out to be a bug in the debugger.<br><br>There is a relatively new feature in the there that derefences basic pointer types to give you their 'pointed to' value in the editors debug pane. Although it deferences pointers to pointers recursively it didn't check the final pointer to see if it was null before getting its value.<br><br>I don't know how the other builds get away with it but still, it was bombing out in my scenario.<br><br>Thanks for the help with testing on your pcs! Cheers!! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
