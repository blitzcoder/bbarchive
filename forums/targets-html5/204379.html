<!DOCTYPE html><html lang="en" ><head ><title >CallBack by CloseTab</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >CallBack by CloseTab</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=504" >HTML5</a>/<a href="#bottom" >CallBack by CloseTab</a><br><br>
<a name="2046624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TFT</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hallo,<br><br>sorry vor my shit english. I have a question.<br><br>My HTML5 App mast do close the online conection befor the<br>BrowserTab close. OnSuspend() work it not under Win or Mac Browser .<br>Wat can i do ?<br><br>Thx TFT <br><br></td></tr></table><br>
<a name="2046627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> OnSuspend IS called if you set #MOJO_AUTO_SUSPEND_ENABLED=True<br>inside the config.monkey file that is build during the build process.<br><br>But that detects only if the user clicks somewhere else so the focus is lost. If you close the tab, there is no buildin way to handle this. <br><br></td></tr></table><br>
<a name="2046703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might be able to do it with an extern somehow, using the window.onbeforeunload or window.onunload callbacks... <br><br></td></tr></table><br>
<a name="2046701"></a>

<a name="2046740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TFT</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hallo,<br><br>great info ..... <br><br>Thx TFT<br><br>PS: The window.onbeforunload work in the MonkeyGame.html perfectly,<br><br>&lt;script language="JavaScript"&gt;<br>  window.onbeforeunload = confirmExit;<br>  function confirmExit()<br>  {<br>    return "You have attempted to leave this page.  If you have made any changes to the fields without clicking the Save button, your changes will be lost.  Are you sure you want to exit this page?";<br>  }<br>&lt;/script&gt;<br><br>at the Main.JS not. Way? <br><br></td></tr></table><br>
<a name="2046776"></a>

<a name="2046777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >impixi</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Save the functions in a Javascript file and Import it in your Monkey code. Example:<br><br>unload.js<br><br><pre class=code>
window.onbeforeunload = function()
{
	return "";
};

window.onunload = function()
{
	//Close connections, call destructors, etc...
};
</pre><br><br><br>runapp.monkey<br><br><pre class=code>
Strict

Import "unload.js"

Function Main:Int()
	
	Print "Running..."

	Return 0
End

</pre><br><br>You can over-ride any HTML DOM event like that. However, sending data back to your calling Monkey code is more complicated: Probably create global javascript variables/objects and Extern them into your Monkey code. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
