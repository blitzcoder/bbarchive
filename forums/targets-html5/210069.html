<!DOCTYPE html><html lang="en" ><head ><title >"Native OS Module not implemented" error</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >"Native OS Module not implemented" error</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=504" >HTML5</a>/<a href="#bottom" >"Native OS Module not implemented" error</a><br><br>
<a name="2110066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to get an existing code-base (~160 source files) running on HTML5. Until now I've only ever built it as GLFW.<br><br>I'm getting a "Native OS Module not implemented" error in the OS module. I understand that the OS module is for desktop builds only and as far as I can see I'm not using any of the OS methods. I've searched the codebase for all the method names listed in the OS module and the only matches I had were for LoadString and ExtractDir, but I'm using the mojo.LoadString and filepath.ExtractDir versions which I believe should be fine.<br><br>Obviously I'm not going to post my entire game here  :-)  But does anyone have any clues as to how I might go about finding the culprit? <br><br></td></tr></table><br>
<a name="2110069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bitJericho</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you have "Import os" at the top of your code? If so, you need to remove this for the html5 build. The best way to do this is as follows:<br><br>#if TARGET&lt;&gt;"html5"<br>	Import os<br>#end <br><br></td></tr></table><br>
<a name="2110070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, no "import os" in any of my code. <br><br></td></tr></table><br>
<a name="2110072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bitJericho</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps you're using a third party module that is importing it. Does monkey output a list of the locations that led up to the error? What is the full error message? <br><br></td></tr></table><br>
<a name="2110076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The entire compiler output is:<br><br><pre class=code>C:\Documents\Programs\MonkeyXPro85b\Bin\transcc_winnt.exe -build -config=debug -target=Html5_Game   "C:/Documents/Development Projects/Monkey X/Sandbox/Sandbox/sandbox.monkey"
TRANS monkey compiler V1.86
Parsing...
C:/Documents/Programs/MonkeyXPro85b/modules/os/os.monkey&lt;14&gt; : Error : Native OS Module not implemented
Abnormal program termination.
 Exit code: -1</pre><br><br>... so not very useful  :-(<br><br>I'm using a handful of third party source files, but I'm including those when I say "no import os in any of my code" and I'm not using any other third party stuff.<br><br>Obviously something is using the os module, but it doesn't appear to be my own code and I can't figure out what is using it  :-( <br><br></td></tr></table><br>
<a name="2110075"></a>

<a name="2110073"></a>

<a name="2110074"></a>

<a name="2110077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bitJericho</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm mojo.LoadString and filepath.ExtractDir work on html5 for me. Perhaps you could temporarily remove os.monkey and see what is calling it that way. Perhaps it will error out saying that the module was not found. <br><br></td></tr></table><br>
<a name="2110079"></a>

<a name="2110080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ha! Renaming "os.monkey" (to "_os.monkey") makes the build work and the game runs. Strange ... <br><br></td></tr></table><br>
<a name="2110078"></a>

<a name="2110081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bitJericho</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh yes I see this is normal behavior I guess. Hmm puzzling! Well something somewhere is calling os.monkey. You could find it by using edit &gt; find in files and checking your project and any modules you are importing. <br><br></td></tr></table><br>
<a name="2110084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did that already (see my first post). <br><br>I searched every file in my source and the build folders for "os" and every method name listed in the os.module documentation and couldn't see anything  :-( <br><br></td></tr></table><br>
<a name="2110082"></a>

<a name="2110107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you really want to figure out what's importing 'os', then unfortunately you'll have to rebuild transcc (Which isn't that big of a deal). I've done this kind of thing before, most notably when I was porting code from Mojo to Mojo 2, and I had a ton of imports to the original Mojo.<br><br>Basically, you'll want to either call '<a href="http://www.monkey-x.com/docs/html/Modules_monkey.lang.html#DebugStop" target="_blank">DebugStop</a>' on <b><a href="https://github.com/blitz-research/monkey/blob/30b05c8df478464d6980d5958f0ef9c0c125bad7/modules/trans/preprocessor.monkey#L183" target="_blank">this line</a></b>, or output every time you import a module. For the sake of keeping things simple, the first option is better.<br><br>From there, simply rebuild the <i><b><a href="https://github.com/blitz-research/monkey/blob/30b05c8df478464d6980d5958f0ef9c0c125bad7/src/transcc/transcc.monkey" target="_blank">"src/transcc/transcc.monkey"</a></b> file</i> in debug mode (Using the "C++ Tool" target), then (Ideally) move the binary ("transcc.buildv<i><b>VERSIONHERE/</b></i>cpptool/main_<i><b>INSERTHOSTHERE</b></i>") to your Monkey installation's "bin" folder. Now, rename your existing version of "transcc_<i><b>INSERTHOSTHERE</b></i>" to whatever you want, then rename your new binary to the previous name of your transcc version.<br><br>After that, try building again. It'll take longer (Since it's a debug build), but when it gets to the error, you can look at the module-paths using your IDE's debugging functionality (Right side of Ted). <b>When you're done debugging, make sure to switch back to your original version</b>, as it will run faster.<br><br>For future reference, whatever module is using '<a href="http://www.monkey-x.com/docs/html/Modules_os.html" target="_blank">os</a>' <i>should</i> switch to the '<a href="http://www.monkey-x.com/docs/html/Modules_brl.html" target="_blank">brl</a>' modules, as '<a href="http://www.monkey-x.com/docs/html/Modules_os.html" target="_blank">os</a>' is <i>technically <u>deprecated</u></i>. <br><br></td></tr></table><br>
<a name="2110105"></a>

<a name="2110104"></a>

<a name="2110103"></a>

<a name="2110102"></a>

<a name="2110101"></a>

<a name="2110100"></a>

<a name="2110099"></a>

<a name="2110098"></a>

<a name="2110097"></a>

<a name="2110124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, though it doesn't look like it's my code that's referencing os.module at all as I can delete the os.module file and my code will build and run fine in both HTML5 and GLFW3.<br><br><i>Something</i> is pulling os.module in, but none of my source files are directly referencing it and whatever is pulling it in doesn't actually appear to use it. <br><br></td></tr></table><br>
<a name="2110115"></a>

<a name="2110106"></a>

<a name="2110257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have to understand that transcc  culls unreachable code before compiling it. Maybe not before attempting to import it, however. I can almost guarantee you that OS is being imported somewhere, maybe a third party library. Since OS is depreciated, nothing should really use it. It is used for command line template in jungle IDE to access arguments, however, that functionality has been superseded by brl.process, and I'm guessing that Ziggy just hasn't gotten around to updating the template. I don't know anywhere else that the OS import would be called accidentally without your knowledge, unless it's used in some third party library...<br><br>I recommend taking your entire modules directory, and also your source code project directory, and using an automated search on ALL monkey files contained therein for either "import os" (case insensitive) or "Alias". Or take immutable octet advice and recompile transcc. Skipping out on this runs the risk of this problem coming back to haunt you later, especially considering your work around is altering a core module, however depreciated that module may be. <br><br></td></tr></table><br>
<a name="2110256"></a>

<a name="2110288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I should've mentioned this at the beginning, but before I started this thread I did a grep on all my *.monkey files for "import os", "os" (whole word matched) and "os." (nothing for any of them). I then did a grep of *all* files (including the build folder) for the same (nothing suspicious, a few "pos.x" and "pos.y" hits in GLFW3 source, some mentions of "OS X" in comments and string constants). I then pulled up the os module help and greped all files for all the function names listed and the only matches (other than comments and a reference to a genenv function in one of the GLFW3 source files) were for LoadString and ExtractDir, but I was already using the mojo.LoadString and filepath.ExtractDir versions as I knew the os module was deprecated.<br><br>The only modules I use are two single file ones: Skn3's Xml Module (https://github.com/skn3/xml, only uses the os module in one example, not in the actual module), and AngelFont (which originally used os.LoadString but I long ago changed this to mojo.LoadString) and both of these were included in the searches described above.<br><br>I've now also searched for "alias" with the only hits being in comments.<br><br>So I'm pretty confident when I say that none of my source files are referencing the os module  :-)<br><br>Clearly I'm missing something and it looks like recompiling transcc might be my only option for finding out what, though it seems like a bit of a nuclear option ... <br><br></td></tr></table><br>
<a name="2110287"></a>

<a name="2111433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arjailer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Turns out (after rebuilding transcc as ImmutableOctet suggested) that I had imported trans.trans at some point (which in turns imports the os module).<br>I think I added the trans.trans import to my framework at some point last year when I inadvertently used ExitApp instead if EndApp and then promptly forgot it was there.<br><br>I removed the import (and nothing else) and now everything runs fine in HTML5.<br><br>So, thanks everyone for your help  :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
