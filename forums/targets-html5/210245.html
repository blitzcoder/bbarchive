<!DOCTYPE html><html lang="en" ><head ><title >Networking with HTML5</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Networking with HTML5</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=504" >HTML5</a>/<a href="#bottom" >Networking with HTML5</a><br><br>
<a name="2113765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raph</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been away from Monkey for a while -- has a networking solution for HTML5 been developed by anyone? Interested in sockets in particular. <br><br></td></tr></table><br>
<a name="2113780"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is going to be a lot to take in, so have at it:<br><br>Kind of... The issue with networking on HTML5 is that a lot of it isn't really portable, or well represented at a lower level. This means '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/socket.monkey" target="_blank">brl.socket</a>' is a bit too specific for comfort. What you want are "WebSockets". WebSockets are a means of having the browser open a highly controlled TCP stream between your browser and a server. It does this by first opening a TCP connection, then performing a "handshake" using what is effectively pseudo-HTTP. Don't get me started on how terrible that process is, especially when you're doing it all from scratch (<i>Like I did</i>). With that out of the way, the main format is pretty simple, but annoying to parse. It splits messages up into parts, has a questionable header, and XORs the message (Not too sure on this one. Security, maybe?). You should also take note that WebSockets are a new and <i>experimental</i> technology in browsers. Though, at this point the basic specs have been implemented almost everywhere you'd be targeting. But enough about the details, the point is that '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/socket.monkey" target="_blank">brl.socket</a>' is a very big stretch. If you're on the other targets, it's a solid choice, but for HTML5? Not so much.<br><br>With this in mind, you'd need something better abstracted; something that can deal with WebSockets behind the scenes. I've developed <a href="https://github.com/Regal-Internet-Brothers/networking" target="_blank">a networking module</a> that handles abstraction very well, and is standard I/O compliant ('<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/stream.monkey" target="_blank">brl.stream</a>'). It's called '<a href="https://github.com/Regal-Internet-Brothers/networking" target="_blank">regal.networking</a>', and it's pretty nice now. There's some <a href="https://github.com/Regal-Internet-Brothers/networking/tree/master/Examples" target="_blank">examples</a> if you're interested. The main features are support for both TCP and UDP, connections, clients, pings, disconnections, multi-part packets, and protocol abstraction. It needs a bit of optimization here and there, but the feature-set is solid. Documentation is <a href="https://regal-internet-brothers.github.io/monkey/docs/Modules_regal.networking" target="_blank">available here</a>; see below for installation details, if you're interested.<br><br>So, what's the problem here, why doesn't it work with HTML5? The short answer is it can, and likely will, but it's not a priority at the moment. I started implementing a backend that does just that, but HTML5 support is pretty far from working. I started back in late October, but moved to other projects since WebSockets weren't a priority. I have some basic stuff going; initial message processing (Both ways), WebSockets are usable for HTML5 targets, etc. It's pretty far from done, though. On the bright side, I do intend to get back to working on it when I get the chance, so it might be a valid option later down the road.<br><br>So, what are your choices? Well, if you're not looking to wait, or you want to take a crack at it yourself, Monkey has a 'WebSocket module, called '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/dom/websocket.monkey" target="_blank">dom.websocket</a>', available with your Monkey installation. This covers a basic, but functional wrapper for the JavaScript API (Not much is needed thanks to '<a href="https://github.com/blitz-research/monkey/tree/develop/modules/dom" target="_blank">dom</a>'). Though, like the rest of '<a href="https://github.com/blitz-research/monkey/tree/develop/modules/dom" target="_blank">dom</a>', it's not documented. To be fair, it's mostly the same as the standard DOM/WebSocket APIs anyway. There's a few minor changes, but it's simple enough to grasp by looking the bindings over. And of course, native JavaScript is always an option.<br><br>There's also Ferdi's somewhat older <a href="http://www.monkey-x.com/Community/posts.php?topic=4858&amp;post=55024&amp;view=all" target="_blank">"PushButton" module</a>, which should support WebSockets, but I'm not too familiar with it. It's also TCP only, but that's always the case with HTML5. I also have <b>no idea about documentation</b>.<br><br>It's from an era where UDP was only a thing from third parties; <a href="http://www.monkey-x.com/Community/posts.php?topic=3275&amp;post=59228&amp;view=all" target="_blank">ANet by Sub_Zero</a>, and of course, <a href="http://www.monkey-x.com/Community/posts.php?topic=4866&amp;post=62522" target="_blank">QuickSock</a>, a long outdated wrapper of my <i><a href="https://github.com/Regal-Internet-Brothers/QuickLib" target="_blank">C++ library</a></i>. Don't use these as anything but potential references. If you're looking at QuickSock/QuickLib, please view the <a href="https://github.com/Regal-Internet-Brothers/QuickLib" target="_blank">newest source on GitHub</a>.<br><br>For normal sockets (<i>Other targets</i>), you've got '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/socket.monkey" target="_blank">brl.socket</a>', as previously mentioned. You've also got '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/httprequest.monkey" target="_blank">brl.httprequest</a>', available for just about everything. There's also '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/tcpstream.monkey" target="_blank">brl.tcpstream</a>', but that requires '<a href="https://github.com/blitz-research/monkey/blob/develop/modules/brl/socket.monkey" target="_blank">brl.socket</a>'.<br><br>Then there's my old, unholy abomination of a codebase, '<a href="https://bitbucket.org/ImmutableOctet/regalnet" target="_blank">regalnet</a>', which no one should use now. (Succeeded by '<a href="https://github.com/Regal-Internet-Brothers/networking" target="_blank">regal.networking</a>', as brought up before)<br><br>So, that's the main list. The main thing about HTML5 to take away here is that it's convoluted. As a side note, if it wasn't obvious already, you can't host a server using normal WebSockets. For that, you'd need a server to mediate the packets.<br><br>If you're interested in what my module can do, it can be <a href="https://github.com/Regal-Internet-Brothers/networking" target="_blank">found here</a>. As I said, though, it doesn't support HTML5 yet. <b>Documentation for it can be <a href="https://regal-internet-brothers.github.io/monkey/docs/Modules_regal.networking" target="_blank">found here</a></b>. That module depends on my other modules, so if you're planning on installing it, you should follow <a href="https://github.com/Regal-Internet-Brothers/regal-modules#regal-modules" target="_blank">the installation guide</a>. The docs aren't perfect, but they're pretty comprehensive.<br><br><b>Documentation for the official modules can be <a href="http://www.monkey-x.com/docs/html/Modules.html" target="_blank">found here</a> (Official; somewhat outdated)</b>. An unofficial mirror, with up-to-date docs can be <a href="https://regal-internet-brothers.github.io/monkey/docs/Modules.html" target="_blank">found here on GitHub</a>, including my own modules' docs (Currently '<a href="https://github.com/Regal-Internet-Brothers/networking" target="_blank">regal.networking</a>' and defaults) <br><br></td></tr></table><br>
<a name="2113779"></a>

<a name="2113777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> - <br><br></td></tr></table><br>
<a name="2113778"></a>

<a name="2113776"></a>

<a name="2113774"></a>

<a name="2113775"></a>

<a name="2113773"></a>

<a name="2113772"></a>

<a name="2113784"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raph</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the detailed answer -- I knew some of this, but not all! I had in fact downloaded regal.networking already, for example.<br><br>Sounds like you can make an HTML5 client to a networked game, but with effort; and can't really use Monkey to make a server app unless you are running a Windows server.<br><br>I was hoping to do some quick prototypes of server-based games using a single codebase and language. <br><br></td></tr></table><br>
<a name="2113792"></a>

<a name="2113793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, for that you'll still need to use a dedicated server (Windows, Mac, Linux, or BSD potentially). The client could still be done in JavaScript, but you're stuck with "<a href="http://www.monkey-x.com/Community/posts.php?topic=4858&amp;post=55024&amp;view=all" target="_blank">PushButton</a>" or '<a href="https://github.com/Regal-Internet-Brothers/networking" target="_blank">regal.networking</a>' (Eventually).<br><br>The only other option right now is Client -&gt; Server -&gt; Client packet routing. To be fair, that's what most multiplayer games do, anyway, just with a proper dedicated program. Peer-to-Peer isn't really going to happen authentically, which kind of sucks. <br><br></td></tr></table><br>
<a name="2113794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raph</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wonder how feasible it would be to wrap libwebsockets as a module for the HTML5 target, and then use that for servers, with game logic in Monkey... <br><br></td></tr></table><br>
<a name="2113800"></a>

<a name="2113801"></a>

<a name="2113802"></a>

<a name="2113803"></a>

<a name="2113804"></a>

<a name="2113805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm currently working on a Network modul for me.<br><br>All targets that has brl.socket implemented can hosts servers and all other targets with brl.socket + HTML5 can be a client.<br><br>But very early and still in progress.<br><br><img src="http://kognetwork.ch/Bildschirmfoto%202015-12-01%20um%2008.56.26.png"> <br><br></td></tr></table><br>
<a name="2113806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raph</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh nice! Still calls for Windows Server hosting if you were to deploy anything on the web, but still pretty cool.<br><br>Did you basically just implement a Websocket server with brl.socket? <br><br></td></tr></table><br>
<a name="2113807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, have implemented the WebSocket handshake and on Client Side, all Clients connects over the WebSocket protocol, so you can use an GLFW Client to connect to an Java Websocket Server etc. <br><br></td></tr></table><br>
<a name="2113812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dip</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that comprehensive post, ImmutableOctet(SKNG)! I've been getting back into Monkey recently and struggling to find good implementation/docs for cross-platform networking. I'm checking your stuff out now. Thanks! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
