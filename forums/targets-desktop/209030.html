<!DOCTYPE html><html lang="en" ><head ><title >Including a Dll</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Including a Dll</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=300" >Desktop</a>/<a href="#bottom" >Including a Dll</a><br><br>
<a name="2094762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nigelibrown</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a desktop project that requires the use of a API dll, I have the header file, the .lib file and the .dll file but keep getting lots of 'not declared in this scope' errors.<br><br>I have been able to find some example code on how to use system dll's, but not one you have all the information required to get things going.<br><br>I have the same thing working in BlitzMAX without problem using a module. Does anyone have experience of getting this going under Monkey? <br><br></td></tr></table><br>
<a name="2094764"></a>

<a name="2094765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried using #CC_OPTS?<br>The other method is to open up the compiler project file/makefile and add the required libraries directly to the project. <br><br></td></tr></table><br>
<a name="2094767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW_</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> #CC_OPTS doesn't for the desktop target btw. <br><br></td></tr></table><br>
<a name="2094772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You'll most likely need to write a wrapper in C++. Not sure if <a href="/posts.php?topic=8652&amp;post=90398&amp;view=all" target="_blank">this thread</a> is what you found before, but the example below which resulted from it *might* help you piece together a wrapper:<br><br><a href="http://www.hi-toro.com/monkey/dllexample.zip" target="_blank">http://www.hi-toro.com/monkey/dllexample.zip</a><br><br>It was created for the <a href="http://www.blitzbasic.com/Community/posts.php?topic=103056" target="_blank">Hardwired</a> 3D library by Ploppy, but it basically shows how to access a plain C DLL from Monkey.<br><br>I wrote a program to convert Hardwired's Blitz3D .decls file into C++ declarations (lot of trial and error involved!), so you might want to do something similar for whatever DLL you're trying to use (eg. convert its .h declarations to .cpp and .monkey).<br><br>There's a stripped-down version of the hardwiredlib.cpp wrapper in 'stripped.cpp' which may help to separate out the pieces you'll need (opening a DLL, declaring its functions and some function pointers, and so on), along with hardwired.monkey, which demonstrates how to access the C/C++ functions defined in hardwiredlib.cpp (or stripped.cpp) from Monkey.<br><br>I'd recommend finding a single function in your DLL (one that produces some kind of observable result) that you can define in .cpp and .monkey form in order to understand and experiment with, then take it from there... <br><br></td></tr></table><br>
<a name="2094771"></a>

<a name="2094770"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
