<!DOCTYPE html><html lang="en" ><head ><title >applying filtering to the output buffer</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >applying filtering to the output buffer</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=300" >Desktop</a>/<a href="#bottom" >applying filtering to the output buffer</a><br><br>
<a name="2098674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >lom</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to find a fast way to apply filtering to the output buffer. Only way I can think of is using ReadPixels for each frame and then applying some kind of smoothing algorithm to the pixels array. But it would be pretty slow I guess.<br>MOJO_IMAGE_FILTERING doesn't work well for me because it causes a lot of artefacts and I'm cutting my sprites from spritesheets. <br><br></td></tr></table><br>
<a name="2098692"></a>

<a name="2098695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Check out this <br><a href="https://twitter.com/mungodev/status/564154627311276032" target="_blank">https://twitter.com/mungodev/status/564154627311276032</a> <br><a href="http://www.monkey-x.com/Community/posts.php?topic=8435&amp;page=3" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8435&amp;page=3</a><br><a href="http://source.mungo.io/modules/mojo/tree/harmony/harmony" target="_blank">http://source.mungo.io/modules/mojo/tree/harmony/harmony</a> <br><br></td></tr></table><br>
<a name="2098718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> To avoid artefacts you just need to use a suitable power of 2 (depending on how much scaling you are going to do) and align your sprites top and left to such boundaries in your layout process.<br><br>For MSAA oversampling try the following:<br><br>#GLFW_WINDOW_SAMPLES=4 <br><br></td></tr></table><br>
<a name="2098717"></a>

<a name="2098746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should be noted that is for GLFW3 target only. <br><br></td></tr></table><br>
<a name="2098767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >lom</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Soap,<br>Thanks for the links, looks interesting. I hope it will help.<br><br>skid,<br>I've already have a lot of sprites which are not suitable power of 2, and I want to use scaling to fit user's desktop resolution.<br>#GLFW_WINDOW_SAMPLES doesn't show any results (don't know why) <br><br></td></tr></table><br>
<a name="2098801"></a>

<a name="2098802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apologies, I think I am on pre-release version of GLFW3.<br><br><br>Also, I am not sure about what you mean by not suitable? I am talking about leaving a gap on the sheet, not scaling the source.<br><br>For my first game in Monkey I think I ended up using 3 sheets of 2048x2048 with 16 as my alignment factor which allowed me to scale up to 2.5x all sprites without artefacts / mip smears.<br><br>For sprites bigger than say 128x128 there is little point in adding them to the atlas / sprites sheets as the fill rate / drawing time is always going to be many orders of magnitude bigger than the time saved by reducing texture state changes.<br><br>The only other issue is if GLFW is not using pre-multiplied alpha blending. If it is not then transparent pixels on your sprite sheet need to still contain RGB of solid neighbours as those channels will still contribute to blending when filtering is taking place causing blackish borders etc along edges. <br><br></td></tr></table><br>
<a name="2098867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >lom</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> skid,<br>Thanks for explanation!<br>I forgot to tell that I want to allow user to turn on filtering without reloading the game. Just to make an option for switching filtering on air.<br>It seems like MOJO FILTERING can't be switched during the game. <br><br></td></tr></table><br>
<a name="2099052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >lom</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> My game originally runs in 320x240, 60 fps and I'm using Matrix for scaling. I found out that if I grab not scaled game buffer (Scale 1,1) with ReadPixels (obviously it doesn't work well for 60 fps) and then will write those pixels into an image, it can be scaled to any resolution without artefacts or sprite bleeding. That's exactly what I need. And then I think it will be possible to apply filtering to that image and turn it off in realtime with some Mojo hacking, I found in this thread: <a href="http://www.monkey-x.com/Community/posts.php?topic=993" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=993</a> <br>If only Mojo has a fast and easy method to copy render buffer into an image, like in Blitz3D (it has awesome CopyRect command). For now it seems like it's only possible with gles20 module, but it's pretty complicated for me. <br><br></td></tr></table><br>
<a name="2099076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skape</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If only Mojo has a fast and easy method to copy render buffer into an image... <br></div><br>Join the club! ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
