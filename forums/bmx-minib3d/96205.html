<!DOCTYPE html><html lang="en" ><head ><title >iMiniB3D can't create instance after release</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >iMiniB3D can't create instance after release</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >iMiniB3D can't create instance after release</a><br><br>
<a name="1112475"></a>

<a name="1112477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hoping someone else has a guess where I should look to resolve this...<br><br>I have an EAGLView that is created when the game starts play, and destroyed when the game exits play and returns to the main menu. This works fine. The second time the game starts play the EAGLView is created again, and the game begins. I've had to tweak and adjust some things in iMiniB3D to get the world to properly destroy and re-create, but it does so without crashing now, however alpha is not respected on the second (or more) entries into 3D. The first time everything works as expected, I use alpha on some vertexes for some generated meshes, everything looks right. But when I start a second game alpha is either on or off. If something has any alpha value it is solid, if it's zero it is, as expected, invisible. I can tell because I create a mesh with multiple points along it's length and fade them out from one end to the other. The result is that the mesh fades from it's start to it's end until it's fully transparent and then is freed. On second run the mesh pops out in segments, as in when a given segment would reach alpha 0 that segment vanishes, until then it is fully opaque.<br><br>Global::Graphics() is called each time the EAGLView (along with it's context) is created, so it isn't that some init in there is being missed. All alpha related flagging is done on the creation of the meshes that require them, so when a new mesh is made part of it's creation method flags it with vertex alpha (and again, it works the first time so I'm quite confident the code exists in the OpenGL implementation, not my init routines).<br><br>Any thoughts? It seems like some simple OpenGL flag isn't being set to enable alpha, but since Graphics() is being executed I'm not sure where to look... Perhaps it's something that is executed at init of the lib (i.e. application startup...) such as the creation of the root_ent pivot (which btw needs to either not be freed in clearworld, or to be created again in Graphics if you don't want things to crash and intend to clearworld...)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1112482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> two ideas:<br>1. is the gl drawing surface set up for 8-bit alpha? RGBA8. I don't know if iOS is reverse, BGRA8. It's something to check. <br><br>2.<br><a href="http://stackoverflow.com/questions/297408/re-displaying-eaglview-in-simple-iphone-game" target="_blank">http://stackoverflow.com/questions/297408/re-displaying-eaglview-in-simple-iphone-game</a> <br><br></td></tr></table><br>
<a name="1112498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, the EAGLLayer is rebuilt when the view is rebuilt, and as a result it has it's properties set, including kEAGLColorFormatRGBA8.<br><br>Thanks for the link, but I think he's having issues related to his context getting destroyed by the navigation controller. I'm releasing and re-creating the context every time as well.<br><br>I think it has something to do with the Graphics() call (just a guess...). I think perhaps glAlphaFunc() doesn't do what it's supposed to when it's called a second time... nothing to really base this on and trying to test it out. <br><br></td></tr></table><br>
<a name="1112499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's something to do with the context... if I don't destroy the context, just reset the graphics when I remake the view it works! this means there's a context floating around as a static all the time which I'm not too keen on but it's a livable solution for me for now... maybe I'm not destroying the old one properly and that's borking up OpenGL... will dig further if I have time. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
