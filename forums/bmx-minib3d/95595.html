<!DOCTYPE html><html lang="en" ><head ><title >What's going on here?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >What's going on here?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >What's going on here?</a><br><br>
<a name="1102084"></a>

<a name="1102086"></a>

<a name="1102087"></a>

<a name="1102088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having some trouble with a MiniB3d game i'm working on, but only on Win7/vista 64bit machines with an ATI graphics card. <br><br>Basically, the game exits, crashing to the desktop with an EXCEPTION_ACCESS_VIOLATION error. I've got some testers to run a debug build, and do a stack tracce when it crashes. So far, it's always crashing on Linked Lists from MiniB3d (surf_list being turned into an array, line 1547 in TMesh.bmx, and looping through ent_p.child_list in the UpdateChildren method of TEntity.bmx, line 1561).<br><br>I've added the important bits of the stack traces below, maybe someone know what's going on here, and why it only seems to affect 64bit ATI machines? Driver bug maybe? It does seem strange that it's always a linked list causing the crash. I'm hoping it's nothing too sinister!<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
~&gt;DebugStop:
~&gt;
t
~&gt;StackTrace{
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/setup.bmx&lt;2373,2&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4050,3&gt;
~&gt;Function Update
~&gt;Local Self:newmenu=$18032510
~&gt;Local menupaused:Int=0
~&gt;Local panelaction:Int=-1
~&gt;Local graphicspanelaction:Int=-1
~&gt;Local audiopanelaction:Int=-1
~&gt;Local controlpanelaction:Int=-1
~&gt;Local keyspanelaction:Int=-1
~&gt;Local joystickpanelaction:Int=-1
~&gt;Local creditspanelaction:Int=-1
~&gt;Local quitpanelaction:Int=-1
~&gt;Local scorepanelaction:Int=-1
~&gt;Local achpanelaction:Int=-1
~&gt;Local challengepanelaction:Int=-1
~&gt;Local tutorialpanelaction:Int=-1
~&gt;Local expertpanelaction:Int=-1
~&gt;Local challengescorespanelaction:Int=-1
~&gt;Local submitpanelaction:Int=-1
~&gt;Local onlinepanelaction:Int=-1
~&gt;Local custompanelaction:Int=-1
~&gt;Local syncpanelaction:Int=-1
~&gt;Local profilepanelaction:Int=-1
~&gt;Local profiledetailspanelaction:Int=-1
~&gt;Local tagspanelaction:Int=-1
~&gt;Local flickFullscreen:Int=0
~&gt;Local shake:Float=0.000000000
~&gt;Local CurrentSpeed:Float=0.449999988
~&gt;Local TargetAngle:Float=179.492340
~&gt;Local difference:Float=3.88566589
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4052,4&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4066,5&gt;
~&gt;Local &lt;local&gt;
~&gt;Local g:newgame=$18030e10
~&gt;Local canexit:Int=0
~&gt;Local gos:GameOverScreen=Null
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4101,6&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4101,6&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4068,6&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;4068,24&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/new game.bmx&lt;2686,3&gt;
~&gt;Function Update
~&gt;Local Self:newgame=$18030e10
~&gt;Local thevol:Float=1.00000000
~&gt;Local xdiff:Float=-381.147644
~&gt;Local ydiff:Float=-308.441589
~&gt;Local donespawnpointcheck:Int=0
~&gt;Local disabledbutton1:Int=8
~&gt;Local disabledbutton2:Int=9
~&gt;Local count:Int=0
~&gt;Local x1:Float=0.000000000
~&gt;Local y1:Float=0.000000000
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/new game.bmx&lt;2722,4&gt;
~&gt;Local &lt;local&gt;
~&gt;Local e:enemybase=$1f86f590
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/new game.bmx&lt;2723,4&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/new game.bmx&lt;2732,5&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/enemies/grunt.bmx&lt;296,3&gt;
~&gt;Function Update
~&gt;Local Self:grunt=$1f86f590
~&gt;Local p1:player=$1455df80
~&gt;Local enemylist:TList=$140b1c50
~&gt;Local bulletspeed:Float=2.00000000
~&gt;Local recuables:TList=$140ae850
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/enemies/grunt.bmx&lt;321,4&gt;
~&gt;Local &lt;local&gt;
~&gt;@...;
~&gt;Function MoveEntity
~&gt;Local ent:TEntity=$115187c0
~&gt;Local x:Float=1.50000000
~&gt;Local y:Float=0.000000000
~&gt;Local z:Float=0.000000000
~&gt;@...;
~&gt;Function MoveEntity
~&gt;Local Self:TEntity=$115187c0
~&gt;Local mx:Float=-0.424321890
~&gt;Local my:Float=1.36414886
~&gt;Local mz:Float=0.457218647
~&gt;Local new_mat:TMatrix=$23362a10
~&gt;@...;
~&gt;Function UpdateChildren
~&gt;Local ent_p:TEntity=$115187c0
~&gt;@...;
~&gt;Function ObjectEnumerator
~&gt;Local Self:TList=$23c642e0
~&gt;Local enum:TListEnum=Null
~&gt;}
~&gt;


</textarea><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
~&gt;DebugStop:
~&gt;
t
~&gt;StackTrace{
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/setup.bmx&lt;2374,2&gt;
~&gt;Local &lt;local&gt;
~&gt;@C:/Documents and Settings/charlie/Desktop/bc3d/newmenu.bmx&lt;5350,3&gt;
~&gt;Function draw
~&gt;Local Self:newmenu=$147bd570
~&gt;Local aHeight:Int=0
~&gt;@...;
~&gt;Function RenderWorld
~&gt;@...;
~&gt;Function RenderWorld
~&gt;@...;
~&gt;Local &lt;local&gt;
~&gt;@...;
~&gt;Function RenderWorldAA
~&gt;@...;
~&gt;Local &lt;local&gt;
~&gt;@...;
~&gt;Local &lt;local&gt;
~&gt;Local cam:TCamera=$17bd5450
~&gt;@...;
~&gt;Function RenderCamera
~&gt;Local cam:TCamera=$17bd5450
~&gt;Local render_list:TList=$1d556cf0
~&gt;@...;
~&gt;Local &lt;local&gt;
~&gt;Local mesh2:TMesh=$18677830
~&gt;@...;
~&gt;Local &lt;local&gt;
~&gt;Local mesh2:TMesh=$18677830
~&gt;@...;
~&gt;Function Update
~&gt;Local Self:TMesh=$18677830
~&gt;Local name:String=""
~&gt;Local fog:Int=0
~&gt;Local surfs:TSurface[]=Null
~&gt;Local anim_surfs:TSurface[]=Null
~&gt;Local anim_surf:TSurface=Null
~&gt;Local anim_surf_no:Int=0
~&gt;@...;
~&gt;Function ListToArray
~&gt;Local list:TList=$1869f6d0
~&gt;@...;
~&gt;Function ToArray
~&gt;Local Self:TList=$1869f6d0
~&gt;Local arr:Object[]=Null
~&gt;Local i:Int=0
~&gt;Local link:TLink=Null
~&gt;}
~&gt;



</textarea><br><br>Any help gratefully appreciated!<br><br>Cheers<br>Charlie<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1102324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's hard to give any kind of suggestion, without any code reproducing the problem... <br><br></td></tr></table><br>
<a name="1102367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you using threading, or compiling with threading enabled even if you aren't using threads?<br><br>Shot in the dark but the MT GC has caused some weird problems before... <br><br></td></tr></table><br>
<a name="1102375"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, no threads. <br><br>I've been using BASS for audio, which i've discovered may be the problem (it runs in it's own thread, and the regular GC doesn't like it), but i'm not totally convinced yet, mostly because the common factor for crashing is ATI video cards.<br><br>It's also peculiar that it always seems to crash with null things in lists that are part of MiniB3d. Very strange, and probably shouldn't be happening.<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1102390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gc problems are a huuuuge pain, mix in another thread and it gets exponentially worse... If possible try a build without the audio and using the standard gc, see what happens on those ati systems. If it works you've got a gremlin in the gc/threading/ati driver mix... <br><br></td></tr></table><br>
<a name="1102403"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've sent a soundless version out already, but haven't heard back from any testers yet.<br><br>I suppose it would be better if it was BASS causing the issue, as i could switch sound libraries for Windows, or provide an alternative sound library maybe. The only issue i'd have is that because i'm streaming a lot of music, whatever i replace it with would need to do the same, else load times would become a big problem.<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1102434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If soundless fixes it, I would still say "Causing" is too strong a word... I think it's one of those perfect storm conditions rather than something explicitly faulty (rather a stack of tiny faults that cause a nice big boom). However it would still be the "simple" solution...<br><br>Don't know how BASS works (never used it myself), or how you're using it exactly but you might be able to consider working in a time allotment on the main thread for handling your network stream? Each pass you check for data, if there is some you read say 1kb at a time until you use up your alloted time (say 0.01 of a second) then continue on with your normal render loop... depends how much extra time you have between frames on your main thread obviously, and how your streaming is handled etc. just a thought <br><br></td></tr></table><br>
<a name="1103957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Soundless doesn't fix it :(<br><br>Anyway, i've got a screengrab from a tester. It looks like certain textures are being corrupted. The lines in the background should be an image of a space scene, drawn onto a sphere which is flipmeshed. I guess if certain textures are not being loaded properly, this may possible cause a crash, right?<br><br><img src="http://i.imgur.com/HR3sD.jpg"><br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1104445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wonder if it's a data access problem with the VBOs being updated.<br>In UpdateChildren, the matricies are being updated, right? <br><br></td></tr></table><br>
<a name="1104449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, I think i've fixed it. I was BASS crashing, and i've found a different (and non-crashy) way round it.<br><br>The texture issue is resolved with a preference change in the catalyst control center.<br><br>Still, you could be right. I still need to do some checking.<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
