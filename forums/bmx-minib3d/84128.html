<!DOCTYPE html><html lang="en" ><head ><title >iMiniB3D - force screen flip</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >iMiniB3D - force screen flip</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >iMiniB3D - force screen flip</a><br><br>
<a name="950133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> in love with iMiniB3d, but I don't understand Objective C very well so I don't know how to pull out what I want...<br><br>I need to force the screen to update mid flow to display a basic loading screen. drawView in EAGLView.mm does the flipping it seems, and is called by the animation loop on the GLView, which is all well and good, but I don't know how (assuming it's possible) to do the update commands from another file, as I can't figure out how to get to the contexts etc.<br><br>Or (more likely I think) is there a way to basicly let the program go for a loop, like giving it system time so it will try to process a frame?<br><br>Sorry if this is inapropriate for the forums since it's iMini and not bmax, I didn't want to bother simon since it's not a bug etc. <br><br></td></tr></table><br>
<a name="950150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I need to force the screen to update mid flow to display a basic loading screen. drawView in EAGLView.mm does the flipping it seem <br></div><br>[myEAGLView drawView] might work (I only just took a quick look at the class and assume it is he equivalent of [myNSView setNeedsDisplay]) where myEAGLView is a member of your application delegate, but even so it might not cause an instantaneous screen update. However, to call it outside of the application delegate you would go...<br><br>[((MyAppDelegate *)[UIApplication sharedApplication].delegate).myEAGLView drawView]<br><br>...assuming you had readied your EAGLView instance for dot-syntax (ie defined and synthesised an @property entry for it in MyAppDelegate.h) and ensured that MyAppDelegate.h was imported into EAGLView.mm. There might be a more succinct way to access a member of MyAppDelegate with C++ but the above is the Objective-C method (unless you want to <a href="http://cocoawithlove.com/2008/11/singletons-appdelegates-and-top-level.html" target="_blank">use a singleton</a>).<br><br><div class="quote"> Or (more likely I think) is there a way to basicly let the program go for a loop, like giving it system time so it will try to process a frame? <br></div><br>Sure. If you write your program as a state machine the loading state could traverse a list of files to load, one per loop. <br><br>I assume you're asking about this because you want to implement a loading bar. Remember that these are mobile devices and if you're taking so long to load stuff that you need a progress bar then you should probably have a rethink. <br><br></td></tr></table><br>
<a name="950151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very interesting, I will have a poke, thank you!<br><br>A loading bar would be nice, but my load times I don't expect to be more than a few seconds, it's more for the initial app load, so the user isn't left with a black screen going "did this just crash?" for 5 seconds while I prep the base stuff. and depending on how big a level gets it may take a few seconds to load so I'd like another splash screen there. I've played a few games (iDracula comes to mind) that have longer loading times than I'm planning so I don't think it's too unreasonable, but the decent games all have at least a loading screen so you know you're not frozen. <br><br></td></tr></table><br>
<a name="950152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> it's more for the initial app load, so the user isn't left with a black screen going "did this just crash?"  <br></div><br>Oh in that case just stick Default.png (320x480 pixels) in your project directory (and drag its icon onto your "Groups &amp; Files" list) and it will be displayed automatically. <br><br></td></tr></table><br>
<a name="950154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> dangit, how can there be that many usefull auto loading things on iphone. Is there a list somewhere with all "make file x and it'll do this without any code or touching interface builder" etc?<br><br>That will do for now, but I'm still curious about loading screen type display, basicly a manual flip.<br><br>what I've got so far just modifying the base files<br><br>Add #import "AppDelegate.h" to EAGLView.h<br><br>add the following functions to EAGLView.mm (and declare them in EAGLView.h)<br>- (void)drawFlipPrep { // Perpare for drawing<br>	<br>	[EAGLContext setCurrentContext:context];<br>	glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);<br>	<br>}<br><br>- (void)drawFlip { // Post Renderworld flip<br>	<br>	glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);<br>	[context presentRenderbuffer:GL_RENDERBUFFER_OES];<br>	<br>}<br><br>add #include "EAGLView.h" to my .mm file I want to do the flip from<br><br>when I want to flip I do<br><br>[((b3dAppDelegate *)[UIApplication sharedApplication].delegate).glView drawFlipPrep];<br>Global::RenderWorld();<br>[((b3dAppDelegate *)[UIApplication sharedApplication].delegate).glView drawFlip];<br><br>which crashes in drawFlip on [context presentRenderbuffer:GL_RENDERBUFFER_OES]; but I'm calling this in the Game::Init() so it might be that not everything is set up yet so the renderbuffer croaks... going to do some more poking. <br><br></td></tr></table><br>
<a name="950155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is there a list somewhere with all "make file x and it'll do this without any code or touching interface builder" etc? <br></div>The other one is Icon.png, which should be <strike>64x64</strike> 57x57 pixels [see <a href="/posts.php?topic=84128#950587" target="_blank">below</a>]. <br><br></td></tr></table><br>
<a name="950156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> [Update]<br>It works out of the init loop. so Default.png for initial loading screen, and<br>[((b3dAppDelegate *)[UIApplication sharedApplication].delegate).glView drawFlipPrep];<br>Global::RenderWorld();<br>[((b3dAppDelegate *)[UIApplication sharedApplication].delegate).glView drawFlip];<br>if you want to force a flip<br><br>the reason I'm not using [((b3dAppDelegate *)[UIApplication sharedApplication].delegate).glView drawView]; is that it calls Game::Run() which will run through the game logic, which if you loading etc. might not work so great since you may not have the resources loaded... you could check for that in your game logic and just do a draw screen and return, but I'd prefer not to add that extra if to every single frame cycle when I only need it 1 in a thousand times.<br><br>So, thank you again sledge! saved me many a headache and gave me another (much needed) push towards Objective C <br><br></td></tr></table><br>
<a name="950587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's 57x57 for the icon - you have to get the size right otherwise the app gets rejected by Apple.<br><br>I didn't know about default.png myself - thanks for the tip! <br><br></td></tr></table><br>
<a name="950653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for mentioning that -- 64x64 works so I would've stiffed myself there. <br><br></td></tr></table><br>
<a name="953243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just stumbled upon this. If anyone else wants to know the various special names etc. take a look at <br><br><a href="http://developer.apple.com/iPhone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW20" target="_blank">http://developer.apple.com/iPhone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ApplicationEnvironment/ApplicationEnvironment.html#//apple_ref/doc/uid/TP40007072-CH7-SW20</a><br><br>Settings.bundle - a settings bundle that will be put into the Settings app so people can configure your app without launching it<br>Icon.png - Icon for your application 57x57 72dpi 24bit PNG. you can use anything for testing but when trying to publish to the app store it must conform. I use my big app picture for the icon too while testing because I make changes along the way and it's anoying to export it then scale and export again.<br>Icon-Settings.png - 29 x 29 72dpi 24bit PNG. if you use a settings.bundle you can also put this in for a custom icon in the settings, if it's not there it uses the icon.png and scales for you.<br>MainWindow.xib - the nib file with the main window for your app, have to have this or your app has no window and therefore no display, and won't run. should be created for you when you make any new project.<br>Default.png - 480 x 320 72dpi png that will automatically load and be displayed while your application loads. for games a loading screen could be appropriate for apps I think the standard is to use a fake starting view to give the impression the interface is loaded before it actually has. some of the apple examples do this (see list view examples) some don't, it's optional but quite handy<br>iTunesArtwork - (note, NO extension) 512 x 512 png or jpeg that will show up for your app in itunes for add-hoc distribution. you can also toss this in for your testers and they'll see it as well since testing is basically ad-hoc, just not commercial. I can't get my app to run on my own device when using this and it isn't supported for app store distribution (for the app store you upload this image seprately when submitting the app)<br>Info.plist - plist file with all your app configuration info like bundle identifier etc. should be created for you when you make any new project, you will need to change your bundle identifier as part of the distribution to app store, and it's pretty poorly documented as to what you're supposed to set it to, atleast from what I could find.<br>en.lproj,fr.lproj,**.lproj,... - language specific resources. used to localize your app to other languages, put a version of each resource file that needs localizing in each language folder. i.e. Hello.png is a picture with the word hello, if you're making a french version you need another Hello.png in the fr.lproj folder that contains a picture of the word Bonjour. when you request a path to a bundle resource in your app it will automaticly grab the localized version if there is one, for whatever language the user has active.<br>anything else you want - any other pictures, nibs, string files, plists etc. that you may need. If you're going to be using a database you can make a starter database in your resources with all your tables layed out and any initial content you want, and then on first run make a copy of it to the application's document folder (see the sqlite tutorials for examples) so you can make changes since the bundle is read only at run time.<br><br>I believe there's a way to have the app put some files in it's documents folder (so you have write access to them) for you, but I haven't needed that yet so I haven't dug deep enough. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
