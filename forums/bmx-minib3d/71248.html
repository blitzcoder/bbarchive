<!DOCTYPE html><html lang="en" ><head ><title >Cameras and Walls (3D Noob)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Cameras and Walls (3D Noob)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >Cameras and Walls (3D Noob)</a><br><br>
<a name="796323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CASO</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a code (that I'm think came with Maplet) and it lets you walk through the places you create. However, it is set in first-person view. I tried moving the camera back to create a third-person view, but the camera can go through a wall and ruin that feel of being inside.<br><br><b>What is the easiest way to create third-person view without letting the camera go through a wall?</b> <br><br></td></tr></table><br>
<a name="796339"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's weird, the wall should stop you from going through.  Does the wall use a transparent texture, like water?  You might need to use a heavier texture, something solid like wood or brick. <br><br></td></tr></table><br>
<a name="796411"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CASO</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It stops the player (sphere) from going through, but not the camera. I tried to make the camera a 'solid', but then I had problems keeping the camera a set distance behind the player. I think I am missing an important concept or something. <br><br></td></tr></table><br>
<a name="796417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is actually a common problem with 3rd person programs.  You need to figure out how to intelligently move the camera when walls or other objects start to get in the way.<br>There is an example in the code archives here<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1083" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1083</a> <br><br></td></tr></table><br>
<a name="797367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CASO</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I translated and tried the code (Posted Above), but it didn't do what I wanted. I want the camera to not go outside of a mesh 'building'. The player can't get out, but the camera can. <br><br></td></tr></table><br>
<a name="797521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> To let the camera not pass the walls you have to create a collidable Pivot which is set to sliding collision. to this pivor you parent the camera. Or you update the position and rotation manual to avoid that the camera will look through the walls. <br>If you have no idea what I'm talking about I will make you an example. <br><br></td></tr></table><br>
<a name="797530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CASO</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I vaguely understand, but I really like examples. <br><br></td></tr></table><br>
<a name="797834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK ;)<br><br>Here is a modified castle demo code with 3rd person control:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Import klepto.minib3d

Global width=640,height=480,depth=16,mode=0

Graphics3D width,height,depth,mode

P:TPlayer = TPlayer.Create() 'creates a player type with camera and 3rd person control


Local light=CreateLight(1)
RotateEntity light,90,0,0

Local mesh=LoadMesh("media/test.b3d")
ScaleEntity mesh,10,10,10

;' create mesh octree - makes collision detection faster (MiniB3D only)
CreateOctree(mesh,200,5)

 ; ' set mesh entity type to 2
EntityType mesh,2

;' use collisions command to enable colliisons between entity type 1 and 2, with reponse 4 (sphere only)
Collisions 1 , 2 , 4 , 2


;' used by camera code
Local mxs#=0
Local mys#=0
Global move#=0.5
MouseXSpeed() ;' flush
MouseYSpeed() ; ' flush




;' used by fps code
Local old_ms=MilliSecs()
Local renders
Local fps

While Not KeyDown(KEY_ESCAPE)		

	If KeyHit(KEY_ENTER) Then DebugStop

	;'' control camera
	
	;' mouse look
	
	
	
	
	;' move camera forwards/backwards/left/right with cursor keys
	
	P.Update()
	;''

	UpdateWorld
	RenderWorld

	renders=renders+1

	;' calculate fps
	If MilliSecs()-old_ms&gt;=1000
		old_ms=MilliSecs()
		fps=renders
		renders=0
	EndIf

	Text 0,0,"FPS: "+fps

	Flip
	
Wend
End

Type TPlayer
	Field Entity:TEntity
	Field Camera:TCamera
	Field PlayerPivot:TPivot
	Field mxs:Float
	Field mys:Float
	Field Jump:Byte = False
	Field JumpTime:Int = 0
	
	Function Create:TPlayer()
		Local P:TPlayer = New TPlayer
		P.Entity = CreateCube()
		P.PlayerPivot = CreatePivot(P.Entity)
		P.Camera = CreateCamera()
		
		TranslateEntity P.PlayerPivot , 0 , 1 , - 10
		ScaleEntity P.Entity , 2 , 4 , 2
		PositionEntity P.Camera , 0 , 10 , - 5
		PositionEntity P.Entity,0,14,0
		CameraRange P.Camera,.5,500

		EntityType P.Camera , 1
		EntityType P.Entity , 1
		
		EntityRadius P.Entity,4
		EntityRadius P.Camera , 1
		Return P
	End Function
	
	Method Update() 
				
		If KeyDown(KEY_UP)=True Then MoveEntity Entity,0,0,move# ;' move camera forward
		If KeyDown(KEY_DOWN)=True Then MoveEntity Entity,0,0,-move# ;' move camera back

		If KeyDown(KEY_LEFT)=True Then TurnEntity Entity,0,move#*5,0 ;' move camera left
		If KeyDown(KEY_RIGHT) = True Then TurnEntity Entity , 0 , - move# * 5 , 0 ; ' move camera right
		
		If KeyHit(KEY_SPACE) And Jump = False Then
			Jump = True
			JumpTime = MilliSecs()
		EndIf
		
		Smoothcam(camera , PlayerPivot , entity , 1.5)
		
		
		If Jump = True Then 
			MoveEntity Entity , 0 , .76 , 0
			If (MilliSecs() - JumpTime) &gt; 400 Then
				Jump = False
			EndIf
		EndIf
		
		MoveEntity Entity , 0 , - 0.38 , 0 ' Gravity

	End Method

End Type

Function smoothcam(cam:TCamera,pivot:TEntity,target:TEntity,camspeed:Float = 5.0)

curx#=EntityX(cam)
curz#=EntityZ(cam)
destx#=EntityX(pivot,True)
destz#=EntityZ(pivot,True)

curx#=curx#+((destx#-curx#)/camspeed)
curz#=curz#+((destz#-curz#)/camspeed)
cury#=EntityY(pivot,True)+5.0

PositionEntity cam,curx#,cury#,curz#

PointEntity cam,target
End Function

</textarea><br><br>I hope this works in the way you want. <br><br></td></tr></table><br>
<a name="798133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CASO</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks klepto2. That works wonderfully. I used standard MiniB3D though. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
