<!DOCTYPE html><html lang="en" ><head ><title >OpenB3D Disable Stencil Self Shadowing?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >OpenB3D Disable Stencil Self Shadowing?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >OpenB3D Disable Stencil Self Shadowing?</a><br><br>
<a name="1304354"></a>

<a name="1304355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wonder if this is possible or is there any way to manage it. The self shadows looks kind of blocky even though if you apply smooth normals. <br><br></td></tr></table><br>
<a name="1304455"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if the stencil shadowing technique in OpenB3D does this, but stencil shadowing usually reveals an ambient-lit-only vision of the scene.<br><br>You can tone down the hard edge effect of the shadowed faces of the mesh by changing the intensity of the light sources in your scene -- I don't remember if it's by making the light sources stronger or weaker. <br>Ideally, you want to have a shading that goes from lit mesh to ambient-lit mesh, so that the ambient-lit-mesh part blends (and hides) with the hard edges.<br><br>Other than that, you can also change the OpenB3D shadow-volume generation code (<a href="https://github.com/markcwm/openb3d.mod/blob/614fa5a16032a2603a2450a09219c945509a3c38/openb3dlib.mod/openb3d/src/shadow.cpp#L316" target="_blank">this file</a> from the OpenB3D module) to implement something like "reverse extruded shadow volumes", which avoids the shadowed face artifacts:<br><a href="http://aras-p.info/texts/revext.html" target="_blank">http://aras-p.info/texts/revext.html</a> <br><br></td></tr></table><br>
<a name="1304459"></a>

<a name="1304462"></a>

<a name="1304463"></a>

<a name="1304464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow thanks Kryzon :D this looks like even a better solution. I never knew that this kind of approach existed. Great find!<br><br>I'm not that familiar (yet) with openb3d to start messing around with it, so I would like to hear angros47 and munch's take on this. But this is really as good as it gets.<br><br>Maybe something along the lines like:<br><br><b>Function CreateShadow:TShadowObject( parent:TMesh,Static:Int=False, Mode:Int=0 )</b><br><br>Where:<br>0 = Default<br>1 = Reverse Extruded<br><br>Or if it can't be a per instance thing, maybe an extra command to toggle it <b>SetShadowMode</b><br><br>Tried the demo, it looks really good and I see it's DirectX, shader based. though I'm still wondering if this will solve the flickering problem.<br><br>thanks again. <br><br></td></tr></table><br>
<a name="1304465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >angros47</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> In OpenB3D, stencil shadows just makes the area darker, without re-computing lighting. It's less accurate, but avoids rendering the scene twice (and this is good in terms of speed), and it allows to cast two shadows if there are two lights, making the area where two shadows intersect even darker. Of course, the drawback is that if ambient light is bright shadows would look unrealistic.<br><br>But all shadow solutions have advantages, and disadvantages <br><br></td></tr></table><br>
<a name="1304469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks angros47. Looking at my work again, I think I can manage for now with my current setup. It is really faster having those stencil shadows but I would agree with the pros and cons.<br><br>BTW, will it be simple to turn off self shadowing in the source or there's a lot of code changes? <br><br></td></tr></table><br>
<a name="1304470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >angros47</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You would have to replace the z - fail algorithm with z - pass algorithm. It's not obvious, and might introduce other bugs <br><br></td></tr></table><br>
<a name="1304472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok got it thanks. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
