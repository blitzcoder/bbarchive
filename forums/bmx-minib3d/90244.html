<!DOCTYPE html><html lang="en" ><head ><title >Tmesh versus Tentity</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Tmesh versus Tentity</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >Tmesh versus Tentity</a><br><br>
<a name="1025559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The troubles I am having trying to manipulate entities are draining my damn patience. Tmesh commands work without problems, but Tmeshes are not practical for memory conservation reasons.<br><br>Can somebody please take a look at what's causing the confusion with Tentities please? Alpha, and Brushes are useless with multiple Tentities in a type, but are very important!!! It's got to be something simple.. Like why the red component is ignored if painting an entity with a brush?<br><br>I don't know C whatever and don't know where to look to fix these bugs. <br><br></td></tr></table><br>
<a name="1025565"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you give an example of the bugs? I have no problems with tmeshes or tentitys... <br><br></td></tr></table><br>
<a name="1025568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Check this thread thread here <br><br>Entityalpha() bug??<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=90238" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=90238</a><br><br>Or the brush bug here:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=90243" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=90243</a><br><br><br><br>As mentioned - Tmeshes are unnaffected. <br><br></td></tr></table><br>
<a name="1025583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It could help to update your video card driver. I did have trouble using EntityAlpha and EntityColor as well, due to my graphical card being buggy, but I was able to work around it using:<br><pre class=code>glLightModeli(GL_LIGHT_MODEL_COLOR_CONTROL,GL_SINGLE_COLOR)'GL_SEPARATE_SPECULAR_COLOR)&lt;--original value set by minib3d</pre><br>After using Graphics3D. Also after using EndMax2D, btw, as it resets this setting. <br><br></td></tr></table><br>
<a name="1025584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey thanks - I'll try this now. <br><br></td></tr></table><br>
<a name="1025585"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> No - no change...Still only works if I don't apply '1.0' alpha value to a solid tile in my entity list - has to be 0.9999 or something...Bloody baffled! <br><br></td></tr></table><br>
<a name="1025589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> An enitiy alpha value of 1.0 causes it to be rendered in standard order, and possibly some other affects, as opposed to &lt; 1 where it is manually draw ordered. Don't know why this would affect you, but it seems something there is getting broken...<br><br>Can you confirm you have the most up to date minib3d and blitzmax? Does this happen in a simple sample program you could share? I'm quite confused on it ignoring red values in EntityColor...<br><br>Specifically looking through your snipet in the alpha bug post, I can see ways it could be a pointer issue and not actually a minib3d problem, but without seeing more it's impossible to tell... <br><br></td></tr></table><br>
<a name="1025605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bmax is 1.39 and miniB3D is the latest version on the Wiki page.<br><br>Tell me please what you think about the possibilty of it being a pointer problem?<br><br>The original code used 'mesh' as part of my type field, but I changed it to 'ent' just in case something was going wrong with the mesh\entity pointer. <br><br></td></tr></table><br>
<a name="1025620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> In you snippet you're referencing m_picked and I don't know where that comes from, I assume it's a global entity you use to hold results from a pick call... and is tile_list a TList? and it's a list of tile_set types apparently, but those are your own type, and I assume tile_set.mesh is the actual mesh/entity you want to be referencing but I don't know...<br><br>While it is odd that it doesn't work right when using TEntity's, and does with with TMesh's, is there a particular reason you're using TEntity's rather than TMesh's? Even if you refer to a mesh as an entity, all the fields of a mesh are still there, you can typecast it into a mesh, so there's no memory savings... May not fix the problem at the core, but it may get you going... <br><br></td></tr></table><br>
<a name="1025635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> From what I understand in Blitz3D - copymesh() makes a whole new individual base mesh using more ram, whilst copyentity() references just the one original loaded mesh. I see that using copymesh() uses more ram in my debug screen info.<br><br>It's what I don't understand - I already saw that Tmesh extends Tentity, so I figure something fundamental is different in the way they are being handled under the miniB3D bonnet but I don't have a clue where to look.<br><br>I've not tried typecasting a Tentity into a Tmesh so maybe I'll give it a try and see. <br><br>Thanks. <br><br></td></tr></table><br>
<a name="1025640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> You should maybe best open up the files in blitzmax\mod\sidesign.mod\minib3d.mod\ and add debug code (print or debuglog) to trace where it goes wrong. I would look into CopyEntity. That is, I believe, TMesh.bmx-&gt;CopyEntity. A TMesh is a form of a TEntity, and a TEntity by itself doesn't render at all. TMesh overrides the Update method, which is responsible for rendering the mesh. So that method also would be a good place to investigate.<br>Another thing to track is the RenderWorld command. It ends up in the TCamera-&gt;Update method. There, everything is set up and rendered. Although the actual mesh rendering is done by TMesh-&gt;Update itself.<br><br>It is difficult if others can't reproduce the error. Another thought: maybe you could assign the same 'brush' to each TEntity:<br><pre class=code>
local cube:TMesh = createcube()
local cube2:TMesh = copyentity(cube)
cube2.brush = cube.brush
</pre>I didn't test this, as I have an self-adapted version of minib3d. <br><br></td></tr></table><br>
<a name="1025648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm - just tried that. Used the same brush on all of them - no difference.<br><br>Literally the last tile in the list is the only 'picked' tile that get's its alpha adjusted to 0.5..then every other tile disappears completely when they are supposed to be set 1.0...all other commands such as scale,entityFX etc. work normally and affect the correct tiles, so I know it's not my flakey code :)<br><br>I suppose I'll have to dig deeper. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
