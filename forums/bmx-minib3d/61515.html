<!DOCTYPE html><html lang="en" ><head ><title >MiniB3D Thread 2</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >MiniB3D Thread 2</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >MiniB3D Thread 2</a><br><br>
<a name="687519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=59650" target="_blank">Thread 1</a><br><br><strike>V0.25</strike> V0.26 is now available from <a href="http://www.si-design.co.uk" target="_blank">here</a>.<br><br>I was going to add some more things before releasing a new version, but seeing as it was taking me so long (blame the World Cup and sunny weather for that) and the old version was so out-of-date, I've decided to release what I have right now.<br><br>It should be quite a bit faster than the previous version, although there is a still a lot more to be done in terms of speeding things up. As ever, let me know of any bugs/fixes/feature requests etc. <br><br></td></tr></table><br>
<a name="687554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found this to be *substantially* faster than the previous version, and represents some excellent coding!<br><br>Very well done and thanks for sharing<br><br>[edit] works great in linux too, real fast! <br><br></td></tr></table><br>
<a name="687562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you for sharing this simon<br>great work :-) <br><br></td></tr></table><br>
<a name="687609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> great job simon! <br><br></td></tr></table><br>
<a name="687616"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JonasL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @simonh: Yes, great work! There is a significant speed improvement. No crashes on my Mac. However, the dwarf model still takes 33 seconds to load. I'll look into it to try to establish what is slowing it down. <br><br></td></tr></table><br>
<a name="687628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try commenting out UpdateNormals from the end of the LoadAnimB3D function, see if that effects anything. <br><br></td></tr></table><br>
<a name="687688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JonasL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Try commenting out UpdateNormals from the end of the LoadAnimB3D function, see if that effects anything. <br></div><br>Yes, that is the bottleneck. Commenting it out makes loading take 1 second. Thanks! Now we know what to optimize. <br><br></td></tr></table><br>
<a name="687689"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's 'MiniB3D?' - will I like it?  Is it anything to do with 'Blitz3D'? <br><br></td></tr></table><br>
<a name="687690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a cut-down version of Blitz3D for BlitzMax. <br><br></td></tr></table><br>
<a name="687691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> JonasL - I've managed to reproduce the slowdown here with UpdateNormals and the Dwarf model (could have sworn it didn't happen before). I'll have a look at it. <br><br></td></tr></table><br>
<a name="687703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think this is some kind of sneaky trick to make me use BMax.<br><br>Well, I jolly-well won't.<br><br>I'll buy the 3D mod for Max - but I certainly will not be using it.<br><br>Blitz3D has got another 10 years in it - BMax will be dead and buried by then. <br><br></td></tr></table><br>
<a name="687752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JonasL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I've managed to reproduce the slowdown here with UpdateNormals and the Dwarf model (could have sworn it didn't happen before). I'll have a look at it.  <br></div><br>Simon, we owe you big time for sharing MiniB3D. I will follow your example by releasing our cross BlitzMax /C++ game framework as open source as soon as we have v 0.1 ready. It was developed so I can prototype games in BlitzMax and then port them in no time to C++. <br><br></td></tr></table><br>
<a name="687756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Booticus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> dude, this rules. Its pretty killer. <br><br></td></tr></table><br>
<a name="687774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vertex</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, GLAdjustTexSize doesn't work here, becouse there is any bug with proxy textures.<br><br>See: <a href="http://www.blitzbasic.com/Community/posts.php?topic=55157" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=55157</a><br><br>Please use:<br><pre class=code>Function AdjustTexSize(Width:Int Var, Height:Int Var)
	Local MaxSize:Int

	glGetIntegerv(GL_MAX_TEXTURE_SIZE, Varptr(MaxSize))
	Width  = Pow2Size(Width, MaxSize)
	Height = Pow2Size(Height, MaxSize)

	Function Pow2Size:Int(Size:Int, MaxSize:Int)
		Local QuadSize:Int

		QuadSize = 1
		While QuadSize &lt; Size And QuadSize &lt; MaxSize
			QuadSize = QuadSize Shl 1
		Wend

		Return QuadSize
	End Function
End Function</pre><br><br>What about shaders? Very easy to bind this in TBrush. <br><br>Like:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Type TFragmentProgram
	Global MaxInstructions    : Int
	Global MaxLocalParams     : Int
	Global MaxEnvParams       : Int
	Global MaxTemporaries     : Int
	Global MaxParams          : Int
	Global MaxAttribs         : Int
	Global MaxTexInstructions : Int

	Field ProgramID : Int

	Method Delete()
		glDeleteProgramsARB(1, Varptr(Self.ProgramID))
	End Method

	Method SetLocalParameter(Index:Int, X:Float, Y:Float, Z:Float, W:Float)
		If Index =&gt; 0 And Index &lt;= TFragmentProgram.MaxLocalParams Then
			glProgramLocalParameter4fARB(GL_FRAGMENT_PROGRAM_ARB, Index, X, Y, Z, W)
		Else
			RuntimeError("FragmentProgram-Local-Parameter-Index out of range!")
		EndIf
	End Method

	Function CreateFragmentProgram:TFragmentProgram(Program:String)
		Local FragmentProgram:TFragmentProgram

		FragmentProgram = New TFragmentProgram
		glGenProgramsARB(1, Varptr(FragmentProgram.ProgramID))
		glBindProgramARB(GL_FRAGMENT_PROGRAM_ARB, FragmentProgram.ProgramID)
		glProgramStringARB(GL_FRAGMENT_PROGRAM_ARB, GL_PROGRAM_FORMAT_ASCII_ARB, ..
		                   Program.Length, Program.ToCString())

		If glGetError() = GL_INVALID_OPERATION Then
			Local Error:String

			Error = String.FromCString(Byte Ptr(glGetString(GL_PROGRAM_ERROR_STRING_ARB)))
			RuntimeError("FragmentProgram Error: "+Error)

			Return Null
		Else
			Return FragmentProgram
		EndIf
	End Function

	Function SetEnvParameter(Index:Int, X:Float, Y:Float, Z:Float, W:Float)
		If Index =&gt; 0 And Index &lt;= TFragmentProgram.MaxEnvParams Then
			glProgramEnvParameter4fARB(GL_FRAGMENT_PROGRAM_ARB, Index, X, Y, Z, W)
		Else
			RuntimeError("FragmentProgram-Environment-Parameter-Index out of range!")
		EndIf
	End Function

	Function GetInfo()
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_INSTRUCTIONS_ARB, ..
		                  Varptr(MaxInstructions))
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_LOCAL_PARAMETERS_ARB, ..
		   	              Varptr(MaxLocalParams))
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_ENV_PARAMETERS_ARB, ..
		                  Varptr(MaxEnvParams))
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_TEMPORARIES_ARB, ..
		                  Varptr(MaxTemporaries))
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_PARAMETERS_ARB, ..
		                  Varptr(MaxParams))
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_ATTRIBS_ARB, ..
		                  Varptr(MaxAttribs))
		glGetProgramivARB(GL_FRAGMENT_PROGRAM_ARB, GL_MAX_PROGRAM_TEX_INSTRUCTIONS_ARB, ..
		                  Varptr(MaxTexInstructions))
	End Function
End Type

Type TVertexProgram
	Global MaxInstructions    : Int
	Global MaxLocalParams     : Int
	Global MaxEnvParams       : Int
	Global MaxTemporaries     : Int
	Global MaxParams          : Int
	Global MaxAttribs         : Int
	Global MaxTexInstructions : Int

	Field ProgramID : Int

	Method Delete()
		glDeleteProgramsARB(1, Varptr(Self.ProgramID))
	End Method

	Method SetLocalParameter(Index:Int, X:Float, Y:Float, Z:Float, W:Float)
		If Index =&gt; 0 And Index &lt;= TVertexProgram.MaxLocalParams Then
			glProgramLocalParameter4fARB(GL_VERTEX_PROGRAM_ARB, Index, X, Y, Z, W)
		Else
			RuntimeError("VertexProgram-Local-Parameter-Index out of range!")
		EndIf
	End Method

	Function CreateVertexProgram:TVertexProgram(Program:String)
		Local VertexProgram:TVertexProgram

		VertexProgram = New TVertexProgram
		glGenProgramsARB(1, Varptr(VertexProgram.ProgramID))
		glBindProgramARB(GL_VERTEX_PROGRAM_ARB, VertexProgram.ProgramID)
		glProgramStringARB(GL_VERTEX_PROGRAM_ARB, GL_PROGRAM_FORMAT_ASCII_ARB, ..
		                   Program.Length, Program.ToCString())

		If glGetError() = GL_INVALID_OPERATION Then
			Local Error:String

			Error = String.FromCString(Byte Ptr(glGetString(GL_PROGRAM_ERROR_STRING_ARB)))
			RuntimeError("VertexProgram Error: "+Error)

			Return Null
		Else
			Return VertexProgram
		EndIf
	End Function

	Function SetEnvParameter(Index:Int, X:Float, Y:Float, Z:Float, W:Float)
		If Index =&gt; 0 And Index &lt;= TFragmentProgram.MaxEnvParams Then
			glProgramEnvParameter4fARB(GL_VERTEX_PROGRAM_ARB, Index, X, Y, Z, W)
		Else
			RuntimeError("VertexProgram-Environment-Parameter-Index out of range!")
		EndIf
	End Function

	Function GetInfo()
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_INSTRUCTIONS_ARB, ..
		                  Varptr(MaxInstructions))
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_LOCAL_PARAMETERS_ARB, ..
		                  Varptr(MaxLocalParams))
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_ENV_PARAMETERS_ARB, ..
		                  Varptr(MaxEnvParams))
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_TEMPORARIES_ARB, ..
		                  Varptr(MaxTemporaries))
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_PARAMETERS_ARB, ..
		                  Varptr(MaxParams))
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_ATTRIBS_ARB, ..
		                  Varptr(MaxAttribs))
		glGetProgramivARB(GL_VERTEX_PROGRAM_ARB, GL_MAX_PROGRAM_TEX_INSTRUCTIONS_ARB, ..
		                  Varptr(MaxTexInstructions))
	End Function
End Type

Function CreateVertexProgram:TVertexProgram(Program:String)
	Return TVertexProgram.CreateVertexProgram(Program)
End Function

Function VertexProgramLocalParameter(VP:TVertexProgram, Index:Int, ..
                                     X:Float, Y:Float, Z:Float, W:Float)
	VP.SetLocalParameter(Index, X, Y, Z, W)
End Function

Function VertexProgramEnvParameter(Index:Int, X:Float, Y:Float, Z:Float, W:Float)
	TVertexProgram.SetEnvParameter(Index, X, Y, Z, W)
End Function

Function CreateFragmentProgram:TFragmentProgram(Program:String)
	Return TFragmentProgram.CreateFragmentProgram(Program)
End Function

Function FragmentProgramLocalParameter(FP:TVertexProgram, Index:Int, ..
                                       X:Float, Y:Float, Z:Float, W:Float)
	FP.SetLocalParameter(Index, X, Y, Z, W)
End Function

Function FragmentProgramEnvParameter(Index:Int, X:Float, Y:Float, Z:Float, W:Float)
	TFragmentProgram.SetEnvParameter(Index, X, Y, Z, W)
End Function</textarea><br>(Shit big functionnames, but you can find a way to use like TShader)<br><br>Make a function like BrushVertexProgram(Brush:TBrush, VP:TVertexProgram) and BrushFragmentProgram(Brush:TBrush, FP:TFragmentProgram).<br><br>Render it with<br>glEnable(GL_VERTEX_PROGRAM_ARB)<br>glBindProgramARB(GL_VERTEX_PROGRAM_ARB, VP.ProgramID)<br><br>and<br><br>glEnable(GL_FRAGMENT_PROGRAM_ARB)<br>glBindProgramARB(GL_FRAGMENT_PROGRAM_ARB, FP.ProgramID)<br><br>cu olli <br><br></td></tr></table><br>
<a name="687826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm..i gotta try this! <br><br></td></tr></table><br>
<a name="687837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry i cant resist screenie time!<br><img src="http://www.chris-camacho.com/tmp/minib3dshot.png"><br>Notice the fps, b3d actually runs slightly slower on my system! this shot is an experiment of mine using simplified mesh display lists. <br><br></td></tr></table><br>
<a name="687876"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> BMax will be dead and buried by then. <br></div><br>Keep saying stuff like that and you'll be dead and buried before then too ;] <br><br></td></tr></table><br>
<a name="687941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Defoc8</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> gonna try this out later - thanks heaps :] ;) <br><br></td></tr></table><br>
<a name="687974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Red Ocktober</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> no need to apologize Chris... as a matter of fact, thanks for the screenie... finally get to see what people are doing with minb3d...<br><br>i don't wanna turn the thread into a minib3D photoshoot, but anyone else got any screenshots of what they're doing with Simon's creation...<br><br>thx<br><br>--Mike <br><br></td></tr></table><br>
<a name="687989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> quickly, someone make a screenie of a 3D submarine for Red... <br><br></td></tr></table><br>
<a name="688031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Si.<br><br>I do get an error in the test-fog.bmx demo, though. It crashes right after opening the window with no debug on, and just says "Unhandled Exception:Unhandled Memory Exception Error" with debug on, highlighting RenderWorld.<br><br>Glad to see you're still working on this! <br><br></td></tr></table><br>
<a name="688040"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wierd. Any chance you could step through Renderworld and narrow down where it crashes exactly?<br><br>Also, does it crash if you comment out the SetCameraFogMode command? <br><br></td></tr></table><br>
<a name="690022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Avon</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Woah... I'm away from the community for a while and simonh unleashes this!  Fantastic stuff.  I can't wait for the weekend to try this out.  Many thanks Si! <br><br></td></tr></table><br>
<a name="690178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome.<br><br>Going on holiday today for a week so I'll reply to any emails when I get back. <br><br></td></tr></table><br>
<a name="690192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, Si, I forgot to check this thread, but I've just disabled ALL fog-related commands (and also commented out the cam2 stuff, which doesn't seem to be used), and I still get the error on RenderWorld, which is really weird because everything else works. I've tried debug/non-debug and quick build on/off.<br><br>I'll try and take a look in the next dew days and comment out a load of stuff until it works.<br><br>Enjoy your holiday! <br><br></td></tr></table><br>
<a name="690193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also failed to read what you said. I just stepped through RenderWorld, and here's the debug output:<br><br><pre class=code>
Building test-fog
Compiling:MiniB3D.bmx
flat assembler  version 1.64
4 passes, 0.3 seconds, 696393 bytes.
Compiling:test-fog.bmx
flat assembler  version 1.64
3 passes, 11103 bytes.
Linking:test-fog.debug.exe
Executing:test-fog.debug.exe
DebugLog:BRUS
DebugLog:NODE
DebugLog:MESH
DebugLog:VRTS
DebugLog:TRIS

Process complete
</pre><br><br>It opens linkedlist.bmx, ending with the cursor on the NextObject -&gt; "Return value" line here:<br><br><pre class=code>
Type TListEnum

	Field _link:TLink

	Method HasNext()
		Return _link._value&lt;&gt;_link
	End Method

	Method NextObject:Object()
		Local value:Object=_link._value
		Assert value&lt;&gt;_link
		_link=_link._succ
		Return value
	End Method

End Type
</pre><br><br>I notice that in the Debug tab, under Function RenderWorld, the render_list is Null.<br><br>Seems like it's not specifically fog-related as far as I can see. I'll try to investigate more. <br><br></td></tr></table><br>
<a name="691364"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I cant seem to get B3d's loading very well.  I wanted to load one B3d and it took forever to load and a few other B3ds I just get errors trying to load em.  Is there a specific B3d exporter we're suppose to be using? <br><br></td></tr></table><br>
<a name="691460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> comment out line 5467 <br><br></td></tr></table><br>
<a name="691540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>UpdateNormals is slow because it's an O(N^2) algorithm.<br><br>Since a model has about as many verts as tris, the nested loops...<br><br>For each tri...<br>   For each vert...<br><br>...can take a long, long time - eg: for 1,000 verts, there will be about 1,000,000 iterations!<br><br>Here's an alternative that uses a Map to speed things up ( This should be about O( N Log N ) complexity I think).<br><br>First you'll need to add a TVec type at the top:<br><pre class=code>
Type TVec
	Field x#,y#,z#
	
	Const EPSILON=.0001

	Method Compare( with:Object )
		Local q:TVec=TVec(with)
		If x-q.x&gt;EPSILON Return 1
		If q.x-x&gt;EPSILON Return -1
		If y-q.y&gt;EPSILON Return 1
		If q.y-y&gt;EPSILON Return -1
		If z-q.z&gt;EPSILON Return 1
		If q.z-z&gt;EPSILON Return -1
		Return 0
	End Method
	
	Method Normalize()
		Local d#=1/Sqr(x*x+y*y+z*z)
		x:*d
		y:*d
		z:*d
	End Method
	
	Function Create:TVec( x#,y#,z# )
		Local t:TVec=New TVec
		t.x=x
		t.y=y
		t.z=z
		Return t
	End Function
End Type
</pre><br>...nothing fancy, just enough for finding vertices in a map...<br><pre class=code>
	Method UpdateNormals()
	
		For Local s=1 To CountSurfaces()
		
			Local norm_map:TMap=New TMap
		
			Local surf:TSurface=GetSurface( s )
			
			For Local t=0 Until surf.CountTriangles()
			
				Local nx#=surf.TriangleNX#(t)
				Local ny#=surf.TriangleNY#(t)
				Local nz#=surf.TriangleNZ#(t)
				
				For Local c=0 Until 3
				
					Local vx#=surf.VertexX#(surf.TriangleVertex(t,c))
					Local vy#=surf.VertexY#(surf.TriangleVertex(t,c))
					Local vz#=surf.VertexZ#(surf.TriangleVertex(t,c))
					
					Local vert:TVec=TVec.Create( vx,vy,vz )
			
					Local norm:TVec=TVec( norm_map.ValueForKey( vert ) )
					
					If norm
						norm.x:+nx
						norm.y:+ny
						norm.z:+nz
					Else
						norm_map.Insert vert,TVec.Create(nx,ny,nz)
					EndIf
				Next
			Next
			
			For Local norm:TVec=EachIn norm_map.Values()
				norm.Normalize
			Next
		
			For Local v=0 Until surf.CountVertices()

				Local vx#=surf.VertexX#( v )
				Local vy#=surf.VertexY#( v )
				Local vz#=surf.VertexZ#( v )
			
				Local vert:TVec=TVec.Create( vx,vy,vz )
				
				Local norm:TVec=TVec( norm_map.ValueForKey( vert ) )
				If Not norm Continue
				
				surf.vert_norm#[v*3+0]=norm.x
				surf.vert_norm#[v*3+1]=norm.y
				surf.vert_norm#[v*3+2]=norm.z
			Next
		Next
	End Method
</pre><br>I haven't tested it thoroughly, but it's basically the same idea as B3D's so it should work.<br><br>Best of all, dwarf load time has gone from 18 secs to 1! <br><br></td></tr></table><br>
<a name="691645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> I added your code thanks mark but my error seems to be with renderworld.  I get "Unhandled Exception: Attempt to index array element beyond Array Length"  When I run it with Minib3d.bmx open it highlights this line.<br><br>If (surf.brush&lt;&gt;Null And surf.brush.tex[ix]&lt;&gt;Null) Or brush.tex[ix]&lt;&gt;Null<br><br>and debuglog shows <br><br><br>Building Main<br>Compiling:MiniB3D.bmx<br>flat assembler  version 1.64<br>4 passes, 0.3 seconds, 702700 bytes.<br>Compiling:Main.bmx<br>flat assembler  version 1.64<br>3 passes, 6521 bytes.<br>Linking:Main.debug.exe<br>Executing:Main.debug.exe<br>DebugLog:TEXS<br>DebugLog:BRUS<br>DebugLog:NODE<br>DebugLog:-NODE (parent= Group01)<br>DebugLog:-MESH<br>DebugLog:-VRTS<br>DebugLog:-TRIS<br>DebugLog:-TRIS<br>DebugLog:-TRIS<br>DebugLog:-TRIS<br>DebugLog:-TRIS<br>DebugLog:-NODE (parent= Group01)<br>DebugLog:-MESH<br>DebugLog:-VRTS<br>DebugLog:-TRIS<br>DebugLog:-NODE (parent= Group01)<br>DebugLog:-MESH<br>DebugLog:-VRTS<br>DebugLog:-TRIS<br>DebugLog:-NODE (parent= Group01)<br>DebugLog:-MESH<br>DebugLog:-VRTS<br>DebugLog:-TRIS<br>DebugLog:-NODE (parent= Group01)<br>DebugLog:-MESH<br>DebugLog:-VRTS<br>DebugLog:-TRIS<br>DebugLog:-NODE (parent= Group01)<br>DebugLog:-MESH<br>DebugLog:-VRTS<br>DebugLog:-TRIS<br><br>Process terminated <br><br></td></tr></table><br>
<a name="691916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >spec-e</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, thanks for that contribution Mark!  Much appreciated. <br><br></td></tr></table><br>
<a name="692268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Panno</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> is minib3d faster  as b3d on all systems ?<br><br>have anyone a test ?<br><br>no time to make my own  :( <br><br></td></tr></table><br>
<a name="692373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> CKob,<br><br>It doesn't load all B3D's yet, it's pretty good though.<br><br>I keep meaning to get 5 minutes to go through and tweak the loader as I did with the first MiniB3D, i never released that though as my code was rushed and unclean.<br><br><br>From memory here (I don't have the source to look through and haven't done so for a month or so):<br><br>it needs to store vertex, tri and texture information and not build the mesh until it's got all information. With an unfound texture, a plain white texture would be applied instead.<br><br>I seem to remember our race track not loading because a missing texture threw the texture/brush index out.<br><br>Nice work Simon! and Cheers Mark! <br><br></td></tr></table><br>
<a name="692381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cygnus, Yeah that was my first guess was maybe I was missing a texture but that wasnt the case as I tried loading a model with a single texture and it didnt work.  I am using 3d studio max and the B3d pipeline to export the mesh maybe thats causing the problems? <br><br></td></tr></table><br>
<a name="692414"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> No idea.<br><br>I will see if I get some time to run over it, If Simon doesn't mind? Times sparse for me at the mo tho.<br><br>I think every surface has to have a texture, too.... <br><br></td></tr></table><br>
<a name="692417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> every surface does have a texture, I was thinking maybe it had something to do with higher polycount?  If I make a cube and export it then I can load it fine but when I tryed loading anything lets say 20k poly's up it craps out. <br><br></td></tr></table><br>
<a name="692421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ewie... No idea then.<br><br>If i get to give this a try over the weekend we will see if it works :) <br><br></td></tr></table><br>
<a name="692422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks:) <br><br></td></tr></table><br>
<a name="692721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paposo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi.<br><br>To marksibly:<br><br>The type TMap in BlitzMax is not balanced. The complexity is O(n). Test TMap whit previous ordered keys and take times. <br>The times aren very very very poor.<br><br>I pusblish in other thread one balanced TMap. It offer good eficiency O(log(n))<br><br>Bye,<br>    Paposo <br><br></td></tr></table><br>
<a name="693087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pingus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry to post a so dummy question.. but is it possible to use Bmax graphical function over the 3D render (drawing 2d sprites by ex) ?<br>This would be GREAT ! <br><br></td></tr></table><br>
<a name="693161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Pingus - for v2 of MiniB3D, with the help of the author i did get HighGUI working with MiniB3D with minor modifications so it is possible.  i have not tried it yet with v2.5. <br><br></td></tr></table><br>
<a name="693170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pingus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gman,<br><br>Sounds interresting, how can I see more ? Is there is a link on your forum ? <br><br></td></tr></table><br>
<a name="693197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can confirm this problem im having seems to be with loading 3d studio max exports. <br><br></td></tr></table><br>
<a name="693199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> @pingus<br>I used a modified version of Fredborg's code. Unfortually it appers to only work correctly HighGUI3 ( it messes up stuff with alpha , and I really dont understand why :/ ).<br><br>heres Fredborg's code:<br><pre class=code>Function UseMax2D()

		Local x,y,w,h
		GetViewport(x,y,w,h)
		
		glDisable(GL_LIGHTING)
		glDisable(GL_DEPTH_TEST)
		glDisable(GL_SCISSOR_TEST)
		glDisable(GL_FOG)
		glDisable(GL_CULL_FACE)

		glMatrixMode GL_TEXTURE
		glLoadIdentity
		
		glMatrixMode GL_PROJECTION
		glLoadIdentity
		glOrtho 0,GraphicsWidth(),GraphicsHeight(),0,-1,1
		
		glMatrixMode GL_MODELVIEW
		glLoadIdentity
		
		SetViewport x,y,w,h

		'
		' Clear textures		
		For Local Layer = 0 Until THardwareInfo.MaxTextures
			glActiveTexture(GL_TEXTURE0+Layer)
				
			glDisable(GL_TEXTURE_CUBE_MAP)
			glDisable(GL_TEXTURE_GEN_S)
			glDisable(GL_TEXTURE_GEN_T)
			glDisable(GL_TEXTURE_GEN_R)

			glDisable(GL_TEXTURE_2D)
		Next
		
		'
		' Activate texture layer 0
		glActiveTexture(GL_TEXTURE0)

		'
		' To reset states!
		DrawRect -10,-10,5,5
				
	EndFunction</pre><br><br>I basically got rid of the bit about clearing textures. <br><br></td></tr></table><br>
<a name="693262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> It should load all .b3ds. If you have a file that doesn't work, send it to me and I'll have a look.<br><br>Thanks for the improved UpdateNormals function, Mark!<br><br>And James, I appreciate you looking into that further for me. Still no idea what the problem is mind! <br><br></td></tr></table><br>
<a name="693277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> well as I said it only happens if I export from 3d studio max but let me see if I can reproduce it and ill email you the model if thats ok? <br><br></td></tr></table><br>
<a name="693278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there a way to use this with maxGUI ? <br><br></td></tr></table><br>
<a name="693291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pingus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Diablo,<br><br>Thanks but it does not work when included in one of the test apps. What is :THardwareInfo.MaxTextures ?<br>I got an error message when trying to compile test-anim with the UseMax2D function(identifier maxtextures not found).<br>Anyway, the first "getviewport" instruction crash the app. <br><br>Simonh,<br><br>Is the use of 2D native functions of Bmax is planned with miniB3D ? <br><br></td></tr></table><br>
<a name="693294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers ckob, I'll take a look at that later.<br><br>Pingus - not yet. Maybe in the future. <br><br></td></tr></table><br>
<a name="693301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Pingus - Thats just what Fredborg posted.<br><br>You'll have to change the sorce of MiniB3d.bmx<br><br>Change the line that says:<br><br>GLGraphics(width,height,depth,rate,GRAPHICS_BACKBUFFER|GRAPHICS_DEPTHBUFFER) 'windowed<br><br>to <br>SetGraphicsDriver (GLMax2DDriver())<br>Graphics(width,height,depth,rate,GRAPHICS_BACKBUFFER|GRAPHICS_DEPTHBUFFER) 'windowed<br><br>Also use this modified version of fredborg's code:<br><pre class=code>Function UseMax2D()

		Local x,y,w,h
		GetViewport(x,y,w,h)
		
		glDisable(GL_LIGHTING)
		glDisable(GL_DEPTH_TEST)
		glDisable(GL_SCISSOR_TEST)
		glDisable(GL_FOG)
		glDisable(GL_CULL_FACE)

		glMatrixMode GL_TEXTURE
		glLoadIdentity
		
		glMatrixMode GL_PROJECTION
		glLoadIdentity
		glOrtho 0,GraphicsWidth(),GraphicsHeight(),0,-1,1
		
		glMatrixMode GL_MODELVIEW
		glLoadIdentity
		
		SetViewport x,y,w,h

		'
		' Clear textures		

		
		'
		' Activate texture layer 0
		glActiveTexture(GL_TEXTURE0)

		'
		' To reset states!
		DrawRect -10,-10,5,5
		
		
				
	EndFunction

Function EnableStates ()

	glEnable(GL_LIGHTING)
		glEnable(GL_DEPTH_TEST)
		glEnable(GL_SCISSOR_TEST)
		glEnable(GL_FOG)
		glEnable(GL_CULL_FACE)
		
End Function </pre><br><br>Use it like...<br><br><pre class=code>
RenderWorld ()

UseMax2D ()

' 2D stuff

EnableStates ()
</pre><br><br><b>However</b><br>This solution only dosent work correctly, so your'll best bet would be to wait for an offical function/support from simonh. <br><br></td></tr></table><br>
<a name="693306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Paposo,<br><div class="quote"> <br>The type TMap in BlitzMax is not balanced. The complexity is O(n)<br> <br></div><br>You're right, and I've been meaning to fix it for ages.<br><br>I've posted a new version of TMap for testing in the 'BlitzMax Module Tweaks' forum. <br><br>I couldn't find the one you published, but I followed your lead and, erm,  'based' it on Java's Treemap too.<br><br>It looks very efficient to me, with less recursion than the current TMap implementation. This will hopefully make up for slightly more complex insertion/removal etc. <br><br></td></tr></table><br>
<a name="693396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> hate to ask again but maybe it was overlooked, can minib3d work inside a maxGUI canvas? <br><br></td></tr></table><br>
<a name="693422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paposo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello Marksibly.<br><br>I read your code. Is very very similar to my code. Probably you read the source Java. I read it for my code :-)<br><br>After certain time i post in code forum any implementation abstract for an binary tree. Is a god base for Tmaps, queues, etc. Is a version 1.0. I coded a version 1.1 refactorized not published in forums.<br><br>Sorry my bad english. I only talk spanish<br><br>Bye,<br>    Ramon <br><br></td></tr></table><br>
<a name="693443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Paposos code is here: <a href="http://blitzbasic.com/codearcs/codearcs.php?code=1745" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=1745</a> <br><br></td></tr></table><br>
<a name="693446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> hate to ask again but maybe it was overlooked, can minib3d work inside a maxGUI canvas?  <br></div><br><br>It can. Below is a quick hack to show it's possible. (put it in "tests" folder)<br><br>I'd really like MiniB3D support it natively.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict
Import "../MiniB3D.bmx"
'based on Simple GL cube demo + simonh's primitives.bmx sample
'Written by Birdie


SetGraphicsDriver GLGraphicsDriver(),GRAPHICS_BACKBUFFER|GRAPHICS_DEPTHBUFFER

Global ax#, ay#,tim#

Local w:TGadget = CreateWindow("Easy Minib3d in a GUI window", 10, 10, 512, 512 )

Local c:TGadget = CreateCanvas(0,0,w.clientwidth(),w.clientheight(),w,0)
c.setlayout 1,1,1,1


''''''''''''''''''''''''''''''''
	TGlobal.width = w.clientwidth()
	TGlobal.height = w.clientheight()


	TGlobal.depth=16
	TGlobal.mode=0
	TGlobal.rate=60



	SetGraphics CanvasGraphics( c )

	TTexture.TextureFilter("",9)
		
	glewInit() ' required for glActiveTexture

	glEnable(GL_LIGHTING)
	glLightModeli(GL_LIGHT_MODEL_COLOR_CONTROL,GL_SEPARATE_SPECULAR_COLOR)
	glLightModeli(GL_LIGHT_MODEL_LOCAL_VIEWER,GL_TRUE)
		
	glEnable(GL_NORMALIZE)

	glEnable(GL_SCISSOR_TEST)
	
	glEnable(GL_DEPTH_TEST)
	glClearDepth(1.0)						
	glDepthFunc(GL_LEQUAL)
	glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST)

	glAlphaFunc(GL_GEQUAL,0.5)
			
	glEnableClientState(GL_VERTEX_ARRAY)
	glEnableClientState(GL_COLOR_ARRAY)
	glEnableClientState(GL_NORMAL_ARRAY)

	glLineWidth(4)





Local  cam:TCamera=CreateCamera()
PositionEntity cam,0,0,-10

Local light:TLight=CreateLight(1)

Local tex:TTexture=LoadTexture("media/Rock.bmp")

Local cube:TMesh=CreateCube()
Local sphere:TMesh=CreateSphere()
Local cylinder:TMesh=CreateCylinder()
Local cone:TMesh=CreateCone() 

PositionEntity cube,-6,0,0
PositionEntity sphere,-2,0,0
PositionEntity cylinder,2,0,0
PositionEntity cone,6,0,0

EntityTexture cube,tex
EntityTexture sphere,tex
EntityTexture cylinder,tex
EntityTexture cone,tex

Local cx#=0
Local cy#=0
Local cz#=0

Local pitch#=0
Local yaw#=0
Local roll#=0

' used by fps code
Local old_ms:Int=MilliSecs()
Local renders:Int
Local fps:Int

''''''''''''''''''''''''''''''''''

CreateTimer( 60 )

While True
        WaitEvent()
        Select EventID()
				Case EVENT_WINDOWCLOSE
                       End

				Case EVENT_WINDOWSIZE

					TGlobal.width = w.clientwidth()
					TGlobal.height = w.clientheight()


					cam.CameraViewport(0,0,w.ClientWidth() , w.clientheight())				
					DebugLog "EVENT_WINDOWSIZE" 

                Case EVENT_TIMERTICK
                        RedrawGadget c
 

                       
                Case EVENT_GADGETPAINT
					 SetGraphics CanvasGraphics( c )

					MoveEntity cam,cx#*0.5,cy#*0.5,cz#*0.5
					RotateEntity cam,pitch#,yaw#,roll#
					cx#=0
					cy#=0
					cz#=0

					TurnEntity cube,0,1,0
					
					cx#=0
					cy#=0
					cz#=0
					
					RenderWorld
					
					Flip
                                
        EndSelect
Wend





</textarea> <br><br></td></tr></table><br>
<a name="693469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh man. We're in a deep shit ;-)<br><br>I assumed that I can use Max2D and MiniB3D without any issues and it even didn't bother me if it is slow. So I scheduled a milestone thet ends up 2 weeks from know and requires Max2D and MiniB3D to work :(<br><br>I guess I can do some kind of workaround with MiniB3d cause all I need is to draw a background and couple mashes on it.<br><br>Man, I need to be more careful next time. <br><br></td></tr></table><br>
<a name="693474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paposo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Peter <br><br></td></tr></table><br>
<a name="693526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks peter this should help :) <br><br></td></tr></table><br>
<a name="693534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry guys, never got a propper chance to look at the b3d loader :)<br><br>Simon might fix it too though. :) <br><br></td></tr></table><br>
<a name="693539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah its no prob I sent simon a model exported from 3d studio max using the pipeline to show him the problem I was having. <br><br></td></tr></table><br>
<a name="693552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well im not sure why maybe its because Minib3d doesnt yet offically support using maxGUI but after getting my scene on to the canvas I cant interact with it at all via key input. <br><br></td></tr></table><br>
<a name="693661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pingus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Diablo, it worked.<br><br>Unfortunatly, I realized that miniB3D requires OPenGL which is not very suitable for popular/casual game market.<br><br>Maybe there will be a DX7 version one day... ? <br><br></td></tr></table><br>
<a name="693986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> not sure what you mean about opengl I think the newest version of quake and doom 3 use opengl.<br><br>I still cant seem to get any input with canvas's <br><br></td></tr></table><br>
<a name="693990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> DX7? why not DX9? <br><br></td></tr></table><br>
<a name="694012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> because DX9 is probably overkill for MiniB3d. Let's leave it for Max3d. <br><br></td></tr></table><br>
<a name="694056"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >joncom2000</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Unfortunatly, I realized that miniB3D requires OPenGL which is not very suitable for popular/casual game market. <br></div><br><br>Well if by "popular/casual game market" you mean the type of games that sell on the portals then you wouldn't really need to be using minib3d anyway since there 99.9% 2D games and if a card can do DX7 direct3d at a speed worth running at then it should be able to do all the basic Opengl stuff thats equivalent to the DX7 stuff, it would only be some extension it might not be able to do. <br><br></td></tr></table><br>
<a name="694136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ckob : I hope you realize there is no keyhandling code in the sample I posted?. To put it in, you could start by adding some code to handle Case EVENT_KEYDOWN, Case EVENT_KEYUP. <br><br></td></tr></table><br>
<a name="694158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> @joncom2000: Yes, I mean popular/casual games. Because we are working on a game that would benefit a lot having player character rendered (3d) on "2d" prerendered screen then DX7 support would be nice to have (yes, this game is targeted at casual audience). I know it could do with OpenGL, but believe me, DX is still less hassle for those people. <br><br></td></tr></table><br>
<a name="694184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pete: I know but I started working on an editor in would like movement controls inside the editor, and I figured out that I have to use EVENT_KEYDOWN and it works but I have to tap the key in order to get it to work when I want to be able to hold it down any ideas on doing that? <br><br></td></tr></table><br>
<a name="694214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ckob, you lazy git :):<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict
Import "../MiniB3D.bmx"
'based on Simple GL cube demo + simonh's primitives.bmx sample
'Written by Birdie

SetGraphicsDriver GLGraphicsDriver(),GRAPHICS_BACKBUFFER|GRAPHICS_DEPTHBUFFER

Global ax#, ay#,tim#

Local w:TGadget = CreateWindow("Easy Minib3d in a GUI window", 10, 10, 512, 512 )

Local c:TGadget = CreateCanvas(0,0,w.clientwidth(),w.clientheight(),w,0)
c.setlayout 1,1,1,1


''''''''''''''''''''''''''''''''
	TGlobal.width = w.clientwidth()
	TGlobal.height = w.clientheight()


	TGlobal.depth=16
	TGlobal.mode=0
	TGlobal.rate=60



	SetGraphics CanvasGraphics( c )

	TTexture.TextureFilter("",9)
		
	glewInit() ' required for glActiveTexture

	glEnable(GL_LIGHTING)
	glLightModeli(GL_LIGHT_MODEL_COLOR_CONTROL,GL_SEPARATE_SPECULAR_COLOR)
	glLightModeli(GL_LIGHT_MODEL_LOCAL_VIEWER,GL_TRUE)
		
	glEnable(GL_NORMALIZE)

	glEnable(GL_SCISSOR_TEST)
	
	glEnable(GL_DEPTH_TEST)
	glClearDepth(1.0)						
	glDepthFunc(GL_LEQUAL)
	glHint(GL_PERSPECTIVE_CORRECTION_HINT, GL_NICEST)

	glAlphaFunc(GL_GEQUAL,0.5)
			
	glEnableClientState(GL_VERTEX_ARRAY)
	glEnableClientState(GL_COLOR_ARRAY)
	glEnableClientState(GL_NORMAL_ARRAY)

	glLineWidth(4)





Local  cam:TCamera=CreateCamera()
PositionEntity cam,0,0,-10

Local light:TLight=CreateLight(1)

Local tex:TTexture=LoadTexture("media/Rock.bmp")

Local cube:TMesh=CreateCube()
Local sphere:TMesh=CreateSphere()
Local cylinder:TMesh=CreateCylinder()
Local cone:TMesh=CreateCone() 

PositionEntity cube,-6,0,0
PositionEntity sphere,-2,0,0
PositionEntity cylinder,2,0,0
PositionEntity cone,6,0,0

EntityTexture cube,tex
EntityTexture sphere,tex
EntityTexture cylinder,tex
EntityTexture cone,tex

Local cx#=0
Local cy#=0
Local cz#=0

Local pitch#=0
Local yaw#=0
Local roll#=0

' used by fps code
Local old_ms:Int=MilliSecs()
Local renders:Int
Local fps:Int


Local UpKey:Int
Local DownKey:Int
Local LeftKey:Int
Local RightKey:Int


''''''''''''''''''''''''''''''''''

CreateTimer( 60 )

While True
        WaitEvent()




	Select EventID()

		Case EVENT_KEYDOWN
			Select EventData()
			
			
				Case KEY_ESCAPE
					End
			
				Case KEY_UP
					UpKey = True
				Case KEY_DOWN
					DownKey = True			
				Case KEY_LEFT
					LeftKey = True
				Case KEY_RIGHT
					RightKey = True
			EndSelect
			

		Case EVENT_KEYUP
			Select EventData()
			
				Case KEY_UP
					UpKey = False
				Case KEY_DOWN
					DownKey = False			
				Case KEY_LEFT
					LeftKey = False
				Case KEY_RIGHT
					RightKey = False			
			EndSelect




		Case EVENT_WINDOWCLOSE
                       End

		Case EVENT_WINDOWSIZE

			TGlobal.width = w.clientwidth()
			TGlobal.height = w.clientheight()


			cam.CameraViewport(0,0,w.ClientWidth() , w.clientheight())				
			DebugLog "EVENT_WINDOWSIZE" 

		Case EVENT_TIMERTICK

	If UpKey  Then cz#=cz#+1.0
	If LeftKey Then cx#=cx#-1.0
	If RightKey Then cx#=cx#+1.0
	If DownKey Then cz#=cz#-1.0
	
	'If KeyDown(KEY_W) Then pitch#=pitch#-1.0
	'If KeyDown(KEY_A) Then yaw#=yaw#+1.0
	'If KeyDown(KEY_S) Then pitch#=pitch#+1.0
	'If KeyDown(KEY_D) Then yaw#=yaw#-1.0

			MoveEntity cam,cx#*0.5,cy#*0.5,cz#*0.5
			RotateEntity cam,pitch#,yaw#,roll#
			cx#=0
			cy#=0
			cz#=0



			RedrawGadget c

                      
		Case EVENT_GADGETPAINT
			
			SetGraphics CanvasGraphics( c )

			TurnEntity cube,0,1,0
			
			
			RenderWorld
			
			Flip
                                
	EndSelect
Wend





</textarea> <br><br></td></tr></table><br>
<a name="694217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks peter, I actually almost had that I just didnt add the EVENT_Keyup bit and I think thats what did it. <br><br></td></tr></table><br>
<a name="694307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pingus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Anawiki,<br><br>----------------------<br>...would benefit a lot having player character rendered (3d) on "2d" prerendered screen then DX7 support would be nice to have (yes, this game is targeted at casual audience). I know it could do with OpenGL, but believe me, DX is still less hassle for those people.<br>-------------------------<br><br>Thanks, you said it better that I would have said it :)) (but exactly what I meant)<br>Having a tool allowing mix of 2D and 3D but keeping DX7 for the maximum audience would be great <br><br></td></tr></table><br>
<a name="694895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since I did the very clean/easy to use MD2 load/anim code, wouldn't it be an idea to integrate it into MiniB3D?<br><br>Actually these are also missing from the MiniB3D.htm:<br><br># LoadMD2<br># AnimateMD2<br># MD2AnimTime<br># MD2AnimLength<br># MD2Animating <br><br></td></tr></table><br>
<a name="695381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm.  This is very good!  Since the B3D terrain command doesn't seem to be implemented (at least as far as I could tell), what would be the best way to set up a simple terrain?  Using the included mesh commands, splitting the terrain mesh into uniform-sized chunks and tiling it, perhaps?  I wonder how Chris C did his in the screenshot up thread.  I would hate to have to write an entire terrain system (which I probably am not skilled enough to do at this point, anyway, especially not from heightmaps) just to use this GREAT add-in.  Any hints/shortcuts would be appreciated... <br><br></td></tr></table><br>
<a name="695384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> 5 post up is code to terrain <br><br></td></tr></table><br>
<a name="695471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> Huh?  5 posts up is the code for keyhandling in a BlitzGUI window (which is useful).  5 posts up from where? <br><br></td></tr></table><br>
<a name="695476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> The way would be the same as with B3D normally as well: A very simple geomipmap based terrain implementation (terrain chunks basing on a heightmap) <br><br></td></tr></table><br>
<a name="695492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> the r0nin, sorry wrong thread :P here<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=62118" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=62118</a> <br><br></td></tr></table><br>
<a name="695509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, ckob!  Fredborg's example is a GREAT starting point.  Now to set up my tech-demo and get started with the programming... <br><br></td></tr></table><br>
<a name="695594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> simonh: any plans on adding a camerapick ? i notice you have entitypickmode but I couldnt find a camerapick. <br><br></td></tr></table><br>
<a name="695595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I'd like to add CameraPick. I haven't spent a lot of time on MiniB3D recently due to holidays and starting a new job but I'm going to get back to it shortly. <br><br></td></tr></table><br>
<a name="695602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> will definately use this in future projects, is there any licensing things with this? <br><br></td></tr></table><br>
<a name="695605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> im using this in my current project but until I can get camerapick figured out or until its added im kind of at a stand still with my editor. <br><br></td></tr></table><br>
<a name="695606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> EdzUp - No. <br><br></td></tr></table><br>
<a name="695608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> What does camerapick do? <br><br></td></tr></table><br>
<a name="695610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> camerapick(cam,X,Y)  Allows you to pick a 3d location <br><br></td></tr></table><br>
<a name="696022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm testing miniB3d.<br><br>I have some trouble to load B3d mesh without texture <br><br></td></tr></table><br>
<a name="696028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> must be your mesh I load b3d's just fine. <br><br></td></tr></table><br>
<a name="696032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> and when i'm loading another b3d mesh with texture i have this.<br><br>inking:flee.debug.exe<br>Executing:flee.debug.exe<br>DebugLog:TEXS<br>DebugLog:BRUS<br>DebugLog:NODE<br>DebugLog:-NODE (parent= Exported by Gile[s] Version 1.17 at 00:04:40 on 05 Feb 2004 registered to Philippe Agnisola)<br>DebugLog:--NODE (parent= Exported by Gile[s] Version 1.16 at 00:32:35 on 03 Feb 2004 registered to Philippe Agnisola)<br>DebugLog:---NODE (parent= Scene Root)<br>DebugLog:---MESH<br>DebugLog:---VRTS<br>DebugLog:---TRIS<br>DebugLog:---TRIS<br>DebugLog:---TRIS<br>DebugLog:---NODE (parent= Scene Root)<br>DebugLog:---MESH<br>DebugLog:---VRTS<br>DebugLog:---TRIS<br>DebugLog:---NODE (parent= Scene Root)<br>DebugLog:---MESH<br>DebugLog:---VRTS<br>DebugLog:---TRIS<br>DebugLog:---NODE (parent= Scene Root)<br>DebugLog:---MESH<br>DebugLog:---VRTS<br>DebugLog:---TRIS<br>DebugLog:--NODE (parent= Exported by Gile[s] Version 1.16 at 00:32:35 on 03 Feb 2004 registered to Philippe Agnisola)<br>DebugLog:--NODE (parent= Exported by Gile[s] Version 1.16 at 00:32:35 on 03 Feb 2004 registered to Philippe Agnisola)<br>DebugLog:--NODE (parent= Exported by Gile[s] Version 1.16 at 00:32:35 on 03 Feb 2004 registered to Philippe Agnisola)<br>~&gt;Unhandled Exception:Attempt to index array element beyond array length<br>~&gt; <br><br></td></tr></table><br>
<a name="696068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> To ckob, patmaba and simonh, the error both ckob and patmaba are describing seems to be in the TMesh update method. The line:<br><br>For Local ix=0 To tex_count<br><br>should be:<br><br>For Local ix=0 Until tex_count<br><br>Hope that helps,<br>Chris <br><br></td></tr></table><br>
<a name="696070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didnt run into this problem after I started using b3d's exported from milkshape but I will change that thank you. <br><br></td></tr></table><br>
<a name="696076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> Falcon,<br><br>When I make that change (To into Until), some of my previously textured meshes no longer show textures.  That is the only line I modified, so I'm not sure that is the fix to their problem (if it adds other problems).  I change it back, and my terrain meshes show properly again... <br><br></td></tr></table><br>
<a name="696131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, it could be a problem somewhere else as well then, because it looks like brushes exported from B3D pipeline define the number of texture layers as 8 which means in the line:<br><br>For Local ix=0 To tex_count<br><br>the variable 'ix' attempts to loop through 9 texture layers.<br><br>The LoadAnimB3D function uses the following line:<br><br>For Local ix=0 To b_no_texs-1<br><br>to loop through and assign texture indices to the brush so I'm not really sure where it's going wrong, but I'll have another poke and see what I find. <br><br></td></tr></table><br>
<a name="696196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe I am doing something wrong, but it seems to me that lights are not working correctly. Use this code to test (cone simulates light, use numpad 1-2, 4-5, 7-8 to movelight in x-y-z).<br><br><pre class=code>
Import "../MiniB3D.bmx"

Local width=640,height=480,depth=16,mode=0

Graphics3D width,height,depth,mode

Local cam=CreateCamera()
PositionEntity cam,0,10,-25

Local light=CreateLight(2)

Local ent=LoadAnimMesh("media/zombie.b3d")

Local cx#=0
Local cy#=0
Local cz#=0

Local pitch#=0
Local yaw#=0
Local roll#=0

Local px#, py#, pz#, lx#, ly#, lz#

Local anim_time#=0

' used by fps code
Local old_ms=MilliSecs()
Local renders
Local fps

Local sp = createcone(32)

Local liteRange# = 25
lightrange light, liteRange
positionentity light, 0, 0, 0
positionentity sp, 0, 0, 0

While Not KeyDown(KEY_ESCAPE)		

	If KeyHit(KEY_ENTER) Then DebugStop

	' control camera

	If KeyDown(KEY_UP) Then cz#=cz#+1.0
	If KeyDown(KEY_LEFT) Then cx#=cx#-1.0
	If KeyDown(KEY_RIGHT) Then cx#=cx#+1.0
	If KeyDown(KEY_DOWN) Then cz#=cz#-1.0
	
	If KeyDown(KEY_W) Then pitch#=pitch#-1.0
	If KeyDown(KEY_A) Then yaw#=yaw#+1.0
	If KeyDown(KEY_S) Then pitch#=pitch#+1.0
	If KeyDown(KEY_D) Then yaw#=yaw#-1.0

'	MoveEntity cam,cx#*0.5,cy#*0.5,cz#*0.5
'	RotateEntity cam,pitch#,yaw#,roll#
	
	cx#=0
	cy#=0
	cz#=0

	'

	If KeyDown(KEY_MINUS) Then anim_time#=anim_time#-0.1
	If KeyDown(KEY_EQUALS) Then anim_time#=anim_time#+0.1
	
	SetAnimTime(ent,anim_time#)

	MoveEntity cam,cx#,cy#,cz#
	RotateEntity ent,pitch#,yaw#,roll#

	cx#=0
	cy#=0
	cz#=0

	If KeyDown(KEY_NUM1) Then px#=px#-1.0
	If KeyDown(KEY_NUM2) Then px#=px#+1.0
	If KeyDown(KEY_NUM4) Then py#=py#+1.0
	If KeyDown(KEY_NUM5) Then py#=py#-1.0
	If KeyDown(KEY_NUM7) Then pz#=pz#-1.0
	If KeyDown(KEY_NUM8) Then pz#=pz#+1.0
	
	If KeyHit(KEY_SPACE) Then liteRange:+2
	lightrange light, liteRange

	positionentity light, px, py, pz
	positionentity sp, px, py, pz

	pointentity light, ent
	pointentity sp, ent
	
	
	lx:+px ; ly:+py ; lz:+pz

'	px = 0 ; py = 0 ; pz = 0

	RenderWorld
	renders=renders+1

	' calculate fps
	If MilliSecs()-old_ms&gt;=1000
		old_ms=MilliSecs()
		fps=renders
		renders=0
	EndIf
	
	DebugText 0,0,"+/- to animate"
	DebugText 0,20,"FPS: "+String(fps)
	DebugText 0,40,"anim_time#: "+String(anim_time#)

	DebugText 0,100,"x: "+px
	DebugText 0,120,"y: "+py
	DebugText 0,140,"z: "+pz

	DebugText 0,200,"LR: "+liteRange

	Flip

Wend
End
</pre> <br><br></td></tr></table><br>
<a name="696199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well. The light sample that comes with MiniB3D works for me :) <br><br></td></tr></table><br>
<a name="696201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> MiniB3D light sample doesn't show the issue. Test "my" code. Try to position the light that it will light the zombie from left-upper corner. Rotate the zombie - it looks to me that no matter how you position the light when you rotate zombie light is rotated too (or repositioned). <br><br></td></tr></table><br>
<a name="696210"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> CKob: Camera pick idea: Yes, its a bit slow but it might get you working for now!<br><br>Take a render of the scene with every entity's colour set to its ID.Then just read the pixel from a certain X,Y position to retreive the Entity that is at that position :)<br><br>Later on you can replace this function with one that is more efficient. <br><br></td></tr></table><br>
<a name="696233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> cygnus: that would probebly work on an entity picking basis but if I want to pick xyz on a specific entity say terrain? to place a model. <br><br></td></tr></table><br>
<a name="696300"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use GLUUnproject as shown in C code below:<br><br><pre class=code>
CVector3 GetOGLPos(int x, int y)
{
	GLint viewport[4];
	GLdouble modelview[16];
	GLdouble projection[16];
	GLfloat winX, winY, winZ;
	GLdouble posX, posY, posZ;

	glGetDoublev( GL_MODELVIEW_MATRIX, modelview );
	glGetDoublev( GL_PROJECTION_MATRIX, projection );
	glGetIntegerv( GL_VIEWPORT, viewport );

	winX = (float)x;
	winY = (float)viewport[3] - (float)y;
	glReadPixels( x, int(winY), 1, 1, GL_DEPTH_COMPONENT, GL_FLOAT, &amp;winZ );

	gluUnProject( winX, winY, winZ, modelview, projection, viewport, &amp;posX, &amp;posY, &amp;posZ);

	return CVector3(posX, posY, posZ);
}
</pre><br><br>Note: This only implements polygon camerapick.<br>I think I remember there being box and sphere pics also.<br>These are simple to program though. <br><br></td></tr></table><br>
<a name="696316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> BTW: I would like to implement the MD2 functions from B3D.<br><br>Just wanted to see how I would go about doing that.<br>Since the MD2 functions are specialized functions in B3D, should i just make a TMD2Mesh class which derives from TEntity?<br><br>And then do the specialized functions below:<br><br># LoadMD2<br># AnimateMD2<br># MD2AnimTime<br># MD2AnimLength<br># MD2Animating<br><br>Now MD2 files needed a specific texture set through EntityTexture, but did the brush functions work with MD2s in B3D? I'm on mac ATM, so I can't really test this, but maybe someone remembers?<br>I can see from the entity texture that it's meshes only for now, but we could do a typecheck there. Will be needed anyhoo when terrain support comes along ;)<br><br>Regards <br><br></td></tr></table><br>
<a name="696386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes they do <br><br></td></tr></table><br>
<a name="696434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh ok. Well that's no problem anyway. They just seem like a real special case in Blitz3D :) (MD2 that is) <br><br></td></tr></table><br>
<a name="696508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can anyone confirm or decline lights issue? It looks to me that entity is always lighted from the same direction when rotating. <br><br></td></tr></table><br>
<a name="696518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. Zombie lighting looks like the light is coming from the opposite direction than it really is. But that could just be the depth perception of the cone tricking me. Otherwise it looks fine.<br>Could you explain in more detail?<br><br>I mean if the light is to the left of the zombie, then it should only be lighted from the left, not matter how you rotate the zombie. <br><br></td></tr></table><br>
<a name="696528"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's right OZAK. Cone might be a little tricky, but "error" is to big to blame cone for it. Opposite direction and rotating object "rotates with light" is what I see. And that's not how it should look like.<br><br>If zombie is facing light then lighting looks ok, but when you rotate him 90 degrees (Y) then  lighting is opposite. <br><br></td></tr></table><br>
<a name="696986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> woohoo, will try to port some of me other stuff to MiniB3d starting with me Asteroids3d :) <br><br></td></tr></table><br>
<a name="697129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm.  Little sprite issue (might be just because I haven't used Blitz3D in forever, so I forget things).  Copy and paste the following code [*disclaimer* the terrain code is not mine; this just shows the issue]:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import "../MiniB3D.bmx"

Local width=800,height=600,depth=32,mode=0
Local move =2.0

Graphics3D width,height,depth,mode

Local  cam:TEntity = CreateCamera()
PositionEntity cam,0,0,-10

Local spr:TSprite = LoadSprite("button_3.png",,cam)
PositionEntity spr,0,0,5

Local light:TEntity = CreateLight(1)

Local terrain:TEntity = LoadTerrain("terrtest.png")
Local tex:TTexture =  LoadTexture("grass.png")

PositionEntity terrain,0,-100,0
ScaleEntity terrain,4,50,4

EntityTexture terrain,tex

Local cx#=0
Local cy#=0
Local cz#=0

Local pitch#=0
Local yaw#=0
Local roll#=0

' used by fps code
Local old_ms=MilliSecs()
Local renders
Local fps

While Not KeyDown(KEY_ESCAPE)		

	If KeyHit(KEY_ENTER) Then DebugStop

	' control camera

	If KeyDown(KEY_UP) Then cz#=cz#+move
	If KeyDown(KEY_LEFT) Then cx#=cx#-move
	If KeyDown(KEY_RIGHT) Then cx#=cx#+move
	If KeyDown(KEY_DOWN) Then cz#=cz#-move
	
	If KeyDown(KEY_W) Then pitch#=pitch#-1.0
	If KeyDown(KEY_A) Then yaw#=yaw#+1.0
	If KeyDown(KEY_S) Then pitch#=pitch#+1.0
	If KeyDown(KEY_D) Then yaw#=yaw#-1.0

	MoveEntity cam,cx#*0.5,cy#*0.5,cz#*0.5
	RotateEntity cam,pitch#,yaw#,roll#
	
	cx#=0
	cy#=0
	cz#=0

	cx#=0
	cy#=0
	cz#=0

	RenderWorld
	renders=renders+1

	' calculate fps
	If MilliSecs()-old_ms&gt;=1000
		old_ms=MilliSecs()
		fps=renders
		renders=0
	EndIf
	
	DebugText 0,0,"FPS: "+String(fps)

	Flip


Wend
End

Function LoadTerrain:TMesh(url:Object,parent:TEntity=Null)

	Local pix:TPixmap

	If TPixmap(url)
		pix = TPixmap(url)
	Else
		pix = LoadPixmap(url)
		If pix = Null Return Null
	EndIf

	Local mesh:TMesh = CreateMesh(parent)
	Local surf:TSurface = CreateSurface(mesh,Null)

	Local uscale:Float = 1.0/pix.width
	Local vscale:Float = 1.0/pix.height

	For Local x:Int = 0 Until pix.width
		For Local y:Int = 0 Until pix.height
			Local argb:Int = pix.ReadPixel(x,y)
			Local height:Float = (((argb Shl 16) &amp; $FF) + ((argb Shl 8) &amp; $FF) + (argb &amp; $FF))/(3.0*255.0)

			Local v:Int = AddVertex(surf,x,height,y,x*uscale,y*vscale)
			VertexNormal surf,v,0,0,0
		Next
	Next

	For Local x:Int = 0 Until pix.width-1
		For Local y:Int = 0 Until pix.height-1
			Local v0:Int = x*pix.height + y
			Local v1:Int = v0 + 1
			Local v2:Int = v1 + pix.height
			Local v3:Int = v0 + pix.height
			
			Local t0:Int = AddTriangle(surf,v0,v1,v2)
			Local t1:Int = AddTriangle(surf,v0,v2,v3)
			
			'
			' Simple normal fix
			Local nx0:Float = surf.TriangleNX(t0)
			Local ny0:Float = surf.TriangleNY(t0)
			Local nz0:Float = surf.TriangleNZ(t0)
			Local nx1:Float = surf.TriangleNX(t1)
			Local ny1:Float = surf.TriangleNY(t1)
			Local nz1:Float = surf.TriangleNZ(t1)
						
			VertexNormal surf,v0,surf.VertexNX(v0)+nx0+nx1,surf.VertexNY(v0)+ny0+ny1,surf.VertexNZ(v0)+nz0+nz1
			VertexNormal surf,v1,surf.VertexNX(v1)+nx0    ,surf.VertexNY(v1)+ny0    ,surf.VertexNZ(v1)+nz0
			VertexNormal surf,v2,surf.VertexNX(v2)+nx0+nx1,surf.VertexNY(v2)+ny0+ny1,surf.VertexNZ(v2)+nz0+nz1
			VertexNormal surf,v3,surf.VertexNX(v3)+nx1    ,surf.VertexNY(v3)+ny1    ,surf.VertexNZ(v3)+nz1
		Next
	Next

	'
	' Normalize vertex normals
	For Local v:Int = 0 Until CountVertices(surf)
		Local nx:Float = surf.VertexNX(v)
		Local ny:Float = surf.VertexNY(v)
		Local nz:Float = surf.VertexNZ(v)
		Local d:Float = 1.0 / Sqr(nx*nx + ny*ny + nz*nz)
		VertexNormal surf,v,nx*d,ny*d,nz*d
	Next

	Return mesh
End Function

</textarea><br><br>You can get the 3 image files you need below (right-click/save image as):<br><br><img src="http://home.comcast.net/~r0nin/grass.png"><br><br><img src="http://home.comcast.net/~r0nin/terrtest.png"><br><br><img src="http://home.comcast.net/~r0nin/button_3.png"><br><br><br><br>OK.  Now use the W key to pitch 360 degrees.  For half of the trip, the parented sprite faces the camera.  For the other half, it faces away (or is inverted).  Is this a bug in MiniB3D (shouldn't a parented sprite always face its parent.... or the camera at least?), or is it something I'm missing? <br><br></td></tr></table><br>
<a name="697412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmmm.  Am I just that incorrect, or is this expected behavior?  How does this work in B3D? <br><br></td></tr></table><br>
<a name="697523"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll look into it and the other issues today. <br><br></td></tr></table><br>
<a name="697606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank's Si. We have a deadline on Wednesday so any improvements are very welcomed :) <br><br></td></tr></table><br>
<a name="697624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> Regarding the lighting issue - it appears to be due to a screwy UpdateNormals - replace it with this one:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">	
	Method UpdateNormals()
	
		Local max_shared_verts=3

		For Local s=1 To CountSurfaces()
			
			Local surf:TSurface=GetSurface(s)
			
			For Local v=0 To surf.no_verts-1
						
				Local shared_verts=0
				
				Local vx1#=surf.vert_coords[v*3+0]
				Local vy1#=surf.vert_coords[v*3+1]
				Local vz1#=surf.vert_coords[v*3+2]
		
				Local nx#=0
				Local ny#=0
				Local nz#=0
				
				For Local t=0 To surf.no_tris-1
				
					For Local c=0 To 2
					
						Local tri_no=(t+1)*3
						
						Local vx2#=surf.vert_coords[surf.tris[tri_no-(3-c)]*3+0]
						Local vy2#=surf.vert_coords[surf.tris[tri_no-(3-c)]*3+1]
						Local vz2#=surf.vert_coords[surf.tris[tri_no-(3-c)]*3+2]

						If vx2#&gt;vx1#-0.0001 And vx2#&lt;vx1#+0.0001 And vy2#&gt;vy1#-0.0001 And vy2#&lt;vy1#+0.0001 And vz2#&gt;vz1#-0.0001 And vz2#&lt;vz1#+0.0001

							shared_verts=shared_verts+1

							Local v0=surf.tris[tri_no-3]
							Local v1=surf.tris[tri_no-2]
							Local v2=surf.tris[tri_no-1]
		
							Local ax#=surf.vert_coords[v1*3+0]-surf.vert_coords[v0*3+0]
							Local ay#=surf.vert_coords[v1*3+1]-surf.vert_coords[v0*3+1]
							Local az#=surf.vert_coords[v1*3+2]-surf.vert_coords[v0*3+2]
		
							Local bx#=surf.vert_coords[v2*3+0]-surf.vert_coords[v1*3+0]
							Local by#=surf.vert_coords[v2*3+1]-surf.vert_coords[v1*3+1]
							Local bz#=surf.vert_coords[v2*3+2]-surf.vert_coords[v1*3+2]
		
							nx#=nx#+(ay#*bz#)-(az#*by#)
							ny#=ny#+(az#*bx#)-(ax#*bz#)
							nz#=nz#+(ax#*by#)-(ay#*bx#)
						
						EndIf
					
					Next
					
					If shared_verts&gt;=max_shared_verts Then Exit
								
				Next
				
				Local uv#=Sqr((nx#*nx#)+(ny#*ny#)+(nz#*nz#))

				surf.vert_norm#[v*3+0]=nx#/uv#
				surf.vert_norm#[v*3+1]=ny#/uv#
				surf.vert_norm#[v*3+2]=nz#/uv#
	
			Next
					
		Next
			
	End Method
</textarea><br><br>This is quite a bit faster than the 0.25 version, and roughly about the same speed as Mark's version. <br><br></td></tr></table><br>
<a name="697630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> The r0nin - I've checked and B3D doesn't flip the sprite. The sprite orientation code really needs redoing - another problem at the moment is that sprites in the corner of the screen will appear to be tilted slightly. <br><br></td></tr></table><br>
<a name="697632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, does anything untoward happen when you run the code?  When I run it (and just depress W and hold), the sprite goes from looking like the button is raised to looking like it is indented.  Do you get the same effect? <br><br></td></tr></table><br>
<a name="697643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#114">[#114]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, the sprite is flipped when it shouldn't be. <br><br></td></tr></table><br>
<a name="697721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#115">[#115]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK.  Sorry, didn't catch that you were talking about B3D above and not MiniB3D, so I didn't think you were getting the same effect.  My Bad! <br><br></td></tr></table><br>
<a name="697722"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#116">[#116]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've released a minor upgrade (0.26) which features fixes for the lighting and b3d loading issues. <br><br></td></tr></table><br>
<a name="698009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#117">[#117]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a lot Si. Now it works so much better. I finally managed to mix 2d &amp; 3d (although still not perfect) <br><br></td></tr></table><br>
<a name="698295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#118">[#118]</a></td></tr></table></td></tr><tr ><td class="posttext"> will definately use this to test out BMax stuffs, got loads of projects that would benefit from stuff like this :).<br><br>Si ya should whack out a logo so we can include it with projects made with it <br><br></td></tr></table><br>
<a name="698647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#119">[#119]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another lighting issue. If I create more than one light objects lighting is broken. No matter how far I put the lights from the object is "overlighted". Even if I set light range for both lights to 0 it doesn't change a thing. <br><br></td></tr></table><br>
<a name="698791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#120">[#120]</a></td></tr></table></td></tr><tr ><td class="posttext"> thans my mesh load correctly with the version 0.26.<br>well done.<br><br>Note, the texture with format dds doesn't work. <br><br></td></tr></table><br>
<a name="699154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#121">[#121]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi simonh<br><br>It's a really great job you have made !! clap clap !!<br>i see that you continue to work on :) it's cool !<br><br>I notify too that you have solved the problem with <br>gile(s) lightmapped b3d file :) cool :)<br><br>I'm trying to make a freelook camera but i don't know<br>to code mousexspeed/mouseyspeed function ? do you plan to <br>add it under miniB3D ? <br><br></td></tr></table><br>
<a name="699181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#122">[#122]</a></td></tr></table></td></tr><tr ><td class="posttext"> anawiki - OK, I'll look into that.<br><br>filax - Here's MouseSpeed functions - they return the pixel movement since they was last called.<br><br><pre class=code>Function MouseXSpeed()
	Global oldmx
	Local mxs=MouseX()-oldmx
	oldmx=MouseX()
	Return mxs
End Function

Function MouseYSpeed()
	Global oldmy
	Local mys=MouseY()-oldmy
	oldmy=MouseY()
	Return mys
End Function</pre> <br><br></td></tr></table><br>
<a name="699197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#123">[#123]</a></td></tr></table></td></tr><tr ><td class="posttext"> anawiki - I couldn't replicate the multiple lights issue. Could you post an example?<br><br>Here's my own example - put it in the tests folder - has two lights, seems to work fine:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Import "../MiniB3D.bmx"

Local width=640,height=480,depth=16,mode=0

Graphics3D width,height,depth,mode
AmbientLight 32,32,32

Local cam=CreateCamera()
PositionEntity cam,0,0,-60

Local light=CreateLight(2)
LightColor light,255,0,0
LightRange light,5
PositionEntity light,0,0,0

Local light2=CreateLight(2)
LightColor light2,255,255,0
LightRange light2,5
PositionEntity light2,10,0,0

Local ent1=LoadAnimMesh("media/grid.b3d")
Local ent2=CopyEntity(ent1)

PositionEntity ent1,0,10,0
PositionEntity ent2,0,-10,0

RotateEntity ent1,180,0,0

Local ent3=CreateSphere(20)
Local ent4=CreateSphere(20)

PositionEntity ent3,-10,0,0
PositionEntity ent4,10,0,0

ScaleEntity ent3,4,4,4
ScaleEntity ent4,4,4,4

Local cx#=0
Local cy#=0
Local cz#=0

Local pitch#=0
Local yaw#=0
Local roll#=0

' used by fps code
Local old_ms=MilliSecs()
Local renders
Local fps

While Not KeyDown(KEY_ESCAPE)		

	If KeyHit(KEY_ENTER) Then DebugStop

	' control camera

	If KeyDown(KEY_UP) Then cz#=cz#+1.0
	If KeyDown(KEY_LEFT) Then cx#=cx#-1.0
	If KeyDown(KEY_RIGHT) Then cx#=cx#+1.0
	If KeyDown(KEY_DOWN) Then cz#=cz#-1.0
	
	If KeyDown(KEY_W) Then pitch#=pitch#-1.0
	If KeyDown(KEY_A) Then yaw#=yaw#+1.0
	If KeyDown(KEY_S) Then pitch#=pitch#+1.0
	If KeyDown(KEY_D) Then yaw#=yaw#-1.0

	MoveEntity cam,cx#*0.5,cy#*0.5,cz#*0.5
	RotateEntity cam,pitch#,yaw#,roll#

	cx#=0
	cy#=0
	cz#=0

	'
	
	RenderWorld
	renders=renders+1
	
	' calculate fps
	If MilliSecs()-old_ms&gt;=1000
		old_ms=MilliSecs()
		fps=renders
		renders=0
	EndIf
	
	GLDrawText "FPS: "+String(fps),0,0

	Flip

Wend
End</textarea> <br><br></td></tr></table><br>
<a name="699208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#124">[#124]</a></td></tr></table></td></tr><tr ><td class="posttext"> oops sorry ... :) <br><br></td></tr></table><br>
<a name="699211"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#125">[#125]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm experiencing the same problem as James, with test-fog.bmx crashing out on renderworld-&gt;update-&gt;gldrawelements. If I comment out the loading of media/grid.b3d it works so it may be a problem with that model.<br><br>If I load grid.b3d into the test-anim.bmx program, it locks up when you press +/- so maybe thats a clue. <br><br></td></tr></table><br>
<a name="699329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#126">[#126]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If I load grid.b3d into the test-anim.bmx program, it locks up when you press +/- so maybe thats a clue. <br></div>No unfortunately it does that with every non animated mesh.<br><br>Does it work if you load the grid mesh, but don't scale it? Might be something to do with glEnable(GL_NORMALIZE) in TGlobal.Graphics3D<br><br>Also, does the grid load OK in light-test.bmx? <br><br></td></tr></table><br>
<a name="699348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#127">[#127]</a></td></tr></table></td></tr><tr ><td class="posttext"> Found the lighting bug - to fix it, change line 1834, or TLight.Update line 29, from:<br><br>glLightfv(gl_light[no_lights-1],GL_LINEAR_ATTENUATION,light_range#)<br><br>To this:<br><br>glLightfv(gl_light[light_no-1],GL_LINEAR_ATTENUATION,light_range#) <br><br></td></tr></table><br>
<a name="699378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#128">[#128]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can reproduce test-fog.bmx crashing out on renderworld-&gt;update-&gt;gldrawelements (well somewhere in renderworld-&gt;update anyway ). if I set my hardware acceleration on my GFX card to "none". On "full" everything is ok  ( Radeon 9600 XT ) <br><br></td></tr></table><br>
<a name="699391"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#129">[#129]</a></td></tr></table></td></tr><tr ><td class="posttext"> That crashes every program - it will always stop at glActiveTextureARB. If you rem out those lines the fog demo still runs. <br><br></td></tr></table><br>
<a name="699605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#130">[#130]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, thought I had something there, oh well. <br><br></td></tr></table><br>
<a name="700630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#131">[#131]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=62713" target="_blank">Thread 3</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
