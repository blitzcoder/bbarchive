<!DOCTYPE html><html lang="en" ><head ><title >iMiniB3D EXC_BAD_ACCESS on exit.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >iMiniB3D EXC_BAD_ACCESS on exit.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >iMiniB3D EXC_BAD_ACCESS on exit.</a><br><br>
<a name="1022401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> As per thread topic, pressing the home button when "building and going" from XCode causes entity.mm to get flagged up. Looks fairly innocuous on the surface, but it could be an AppStore approval breaker in the making.<br><br>(EDIT: Oh and I should really 'fess up to the fact that both my iPod OS and SDK are an iteration behind so feel free to encourage me to (finally) install Snow Leopard by shouting "Oh no it doesn't!") <br><br></td></tr></table><br>
<a name="1022435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't used iMiniB3D in quite a bit at this point, but I recall getting that. I believe I got it to go away my releasing everything I had created, and I think there may have been a handling issue with either meshes or textures that I had to track down... maybe one of my old threads can be of a little more help. <br><br></td></tr></table><br>
<a name="1022721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll  release 0.4 very soon, so hopefully that will fix it. <br><br></td></tr></table><br>
<a name="1022730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did find updating to Snow Leopard and/or updating the SDK etc helped sort a few issues I was having. <br><br></td></tr></table><br>
<a name="1022731"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @simonh Cheers. In the meantime I'm just manually freeing everything in Game:End() rather than using Global::ClearWorld(). Out of interest, should I be freeing a list that is a member of Game, rather than just deleting all of its (the list's) objects after freeing their members? (I'm kinda picking up C++ primarily from the iMiniB3D examples so I'll probably have a few dumb questions like this.)<br><br>@ima747 Thanks -- just rummaging through your previous posts.<br><br>@Beaker Yeah I really need to set some time aside to update everything. Typically, the external drive I would normally use for backup during such a process has started reporting errors this weekend! :( <br><br></td></tr></table><br>
<a name="1022734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Best of luck with the rummage Sledge I tend to wander :0)<br><br>regarding updating specifically for iphone development it tends to be a good idea to keep everything as new and shinny as possible, apple is much quicker to depreciate things in the iphone SDK than for mac. I recall spending 2 weeks getting some listboxes to work just right and then they overhauled the events quite a bit so I either had to start over or stick with an old OS target, which was fine since I wanted legacy support, but when it finally came time to drop the old OS's for some new features I had to do a good chunk of re-working...<br><br>@simonh I'm drooling already... <br><br></td></tr></table><br>
<a name="1022987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good work si, looking forwards to 0.4.  Just a heads up to appstore people: please post back on these forums if you release a game with iMiniB3D, I am sure si will be pleased as heck to see his little engine in action in other games...<br><br>Also one other thing, if you're targetting iPad compatibility (&gt;3.2) you need to ensure your orientation flips. This is a callback in your delegate. The easiest way to deal with this is just rotating the camera, but in your touch handler you will want to flip the touch x,y depending.<br><br>Also, you need to ensure that its flipped dynamically. That is, you can't guarantee its running on 320x480. It could be ipad dimensions, so query the system. <br><br></td></tr></table><br>
<a name="1023052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ima747 Yeah I just updated and re-tested to make sure it wasn't being behind that was the problem. Fortunately (for my dignity I mean) Global::ClearWorld() still causes the EXC_BAD_ACCESS flip-out. It's quite an intriguing error:<br><pre class=code>Current language:  auto; currently objective-c++
Program received signal:  “EXC_BAD_ACCESS”.
Warning: the current language does not match this frame.
kill
quit</pre>It flags up different iMiniB3D source files based on what has or hasn't been manually freed.<br><br>@Rob Sigh, another set of docs to digest -- thanks iPad! :D <br><br></td></tr></table><br>
<a name="1023056"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I'm not seeing any problems with ClearWorld() at the moment. Can you punch of a test that causes it?<br><br>What is your build target? (debug/release, simulator/device, iphone/ipad)<br><br>Are you sure you're not over freeing things? <br><br></td></tr></table><br>
<a name="1023168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Hmm, I'm not seeing any problems with ClearWorld() at the moment. Can you punch of a test that causes it? <br></div>All the examples that use it!<br><br><br><div class="quote"> What is your build target? <br></div>It's now Device - 3.2 | Release. Incidentally, how do I get the iPad simulator to sod off when building for the simulator? Since updating, XCode has arbitrarily decided that I want to be an iPad developer, which is a bit presumptuous of it!<br><br><div class="quote"> Are you sure you're not over freeing things?  <br></div>Nah, I just commented out the manual freeing of things and it made the same complaint (although it's flagging up stl_iterator_base_funcs.h now!)<br><br>Note that I'm causing this behaviour by pressing the home button while the build is running on an actual device. It doesn't complain when you press the virtual home button in the simulator (bearing in mind that it currently insists on being an iPad instead of an iPhone (grrrrr!), for what the difference is worth). <br><br></td></tr></table><br>
<a name="1023175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It's now Device - 3.2 | Release. Incidentally, how do I get the iPad simulator to sod off when building for the simulator? Since updating, XCode has arbitrarily decided that I want to be an iPad developer, which is a bit presumptuous of it! <br></div><br><br>You can't/won't get 3.2 for the iPhone. 3.2 is iPad only, so build for 3.1x. <br><br></td></tr></table><br>
<a name="1023179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, cheers. It merrily building for the device threw me there. <br><br></td></tr></table><br>
<a name="1023206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> yea, building under 3.2 gets you iphone, 3.2 gets you ipad in simulator. A real device will just fail on calls that are not implemented on it's revision (so if you build a 3.1 and deploy on 2.0 the new api calls on from 3.1 if you make any will fail, which is why you're supposed to test for apis before using them if you're targeting mixed versions or mixed devices that might not have things, such as camera on a touch or ipad...). Though in the simulator the device toggle in the menu REALLY should lock it to that device for testing imo...<br><br>I'll do some more poking but I wasn't seeing any errors back on device. will report back after I give it another poke. <br><br></td></tr></table><br>
<a name="1024358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Finally got to give it another poke and I'm getting the exec error as well when pressing home on a device in either release or debug mode.<br><br>Seems to come from an SDK header <br>Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS3.0.sdk/usr/include/c++/4.2.1/bits/stl_list.h<br>This is coming from FreeEntity, specifically for me from freeing a pivot, under Global::ClearWorld. It happens while iterating child entities, on child_list.size()<br><br>[update]<br>Seems as though I am clearing the world in game-&gt;end() and then applicationWillTerminate is also clearing the world after it runs game end... Removing either of the clearworlds fixes the problem. I think multiple clears shouldn't cause issue, but it's easy to work around. Either clear yourself, or let the appdelegate handle it. Basically it's a double release.<br>[/update]<br><br>Side note: if you're targeting universal this might be helpful<br><pre class=code>
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) {
	viewCamera-&gt;CameraViewport(0, 0, 320, 480);
} else {
	viewCamera-&gt;CameraViewport(0, 0, 768, 1024);
}
</pre> <br><br></td></tr></table><br>
<a name="1024378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> huh, I just assumed you're not supposed to quit while testing by hitting the home button, it didn't even occur to me that this is a problem to fix. I've just been using Stop in the Run menu, now I'm worried that this has been causing problems on my iPhone. <br><br></td></tr></table><br>
<a name="1024423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not really that big a deal in the real world, just very impolite to the memory... When you exit the memory gets wiped for your app anyway. Additionally it only happens if you manually clearworld before exiting (being too polite) which then sets up the clearworld in the appterminate event to cause some uglyness. Hopefully simon can clean up clearworld so running it more than is needed doesn't cause this glitch (I assume something is just not getting nulled out once it's freed so the next pass still sees a value even though it's dead). But until then just don't clearworld manually at the end and you get no problem. <br><br></td></tr></table><br>
<a name="1024571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <pre class=code>if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) {
	viewCamera-&gt;CameraViewport(0, 0, 320, 480);
} else {
	viewCamera-&gt;CameraViewport(0, 0, 768, 1024);
}</pre> <br></div>Neat!<br><br>Good investigative work there, too.<br><br><div class="quote"> I'm worried that this has been causing problems on my iPhone.  <br></div><div class="quote"> When you exit the memory gets wiped for your app anyway. <br></div>I'm not convinced by how good the OS is at this: I've had apps that failed to start for seemingly no reason, which returned to normal operation after a hard reset. Nothing definitive in that, but it fits with the notion of a dwindling pool of available mem. <br><br></td></tr></table><br>
<a name="1024590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> well the bad access is caused by a double release, so there may be a little leftover but since it's over clearing (rather than under) there shouldn't be much left, and the app memory space should be opened up after it's released... course no guarantee which is why it's nice to get a clean exit, but I'm not too concerned for testing atleast. And just make sure you don't over clearworld and it goes away so no issue... and again hopefully simon can work it out so over running clearworld doesn't cause the fault at all. <br><br></td></tr></table><br>
<a name="1024693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh I'm not trying to suggest that running iMiniB3D apps might be causing available mem to dwindle over time, I'm suggesting that <i>running apps</i> might be causing available mem to dwindle over time! <br><br></td></tr></table><br>
<a name="1024696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I C, and agree very much. if you still have a first gen iphone around give the poor thing a night in the off position some time, it'll wake refreshed and much perkier... for a short while :0) there is also the mysterious performance decay on iphones as well which is a secondary but related issue... but i digress from the thread. And now back to my wads of code. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
