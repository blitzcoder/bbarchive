<!DOCTYPE html><html lang="en" ><head ><title >iMiniB3D slow on 3GS</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >iMiniB3D slow on 3GS</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >iMiniB3D slow on 3GS</a><br><br>
<a name="1125123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have written a simple demo that runs fine in the Simulator.<br><br>On my 3GS it runs at about 10-11 frames per second.<br><br>Are there any tips on things to avoid in iMiniB3D that heavily impact performance on a real device? <br><br></td></tr></table><br>
<a name="1125139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leon Drake</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> what is the polycount in the scene? <br><br></td></tr></table><br>
<a name="1125166"></a>

<a name="1125167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simulator only simulates code execution, but it's running on the desktop hardware so has no connection when it coms to performance. Sometimes it's worse, usually it's a lot better. Biggest thing in general is remember its a mobile platform, that means : much slower processor. Much less ram. Everything needs to be trimmed accordingly: loops, allocations and releases, object count (this is the hardest one for me usually), mesh complexity, texture size, etc.<br><br>If you're using thing outside of iminib3d there are plenty of chances for that to impact performance. Timers in particular add up pretty quick...<br><br>Sometimes your allocations can have a big impact if you make and especially if you're auto releasing things every frame. Depends on your structure but allocating some work objects and recycling them can be a big gain.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The code I was testing had a lot of looping, and was quite inefficient, so I have changed that and things have improved.<br><br>iMiniB3D really improves your coding, reminds me of the old Z80 days for the Spectrum ;-)<br><br>Thanks for all your help<br><br>Rob <br><br></td></tr></table><br>
<a name="1125201"></a>

<a name="1125202"></a>

<a name="1125204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't even remember how many ways there are to loop things in Objective C... all with varying pros and cons. Simple rule of thumb for anything with tight hardware requirements: if it *can* be tighter it probably *needs* to be :0) That's why Android bothers me so much, automatic garbage collection is great if you're lazy but what if you want to make sure the memory doesn't thrash in the middle of a render call... SOL. I'll take the hassle of managing things myself and knowing what is happening when... it's easier to snipe leaks than duel with the system over basic functionality. Manual management becomes second nature quite quickly, then it feels weird to go back to a managed environment... "so... I can just sort of leave that there and it will be ok? handy... but now I'm scared"<br><br>There is one lazy trick that I do use a lot in iOS as relates to looping... If you have to modify a grouping *while* iterating it, iterate a copy. You incur the overhead of making a copy every pass but if you make a lot of changes it makes life SOOOO much easier... e.g.<br><br><pre class=code>
for (BadGuy *onBadguy in [[badguys copy] autorelease]) {
if(onBadguy.Update()) {
// if the update returns true the badguy died
[badguys removeObject:onBadguy]; // since he's dead we don't need him anymore, since we're actually itterating a copy of the badguys array it's safe to modify the real one...
}
}
</pre><br><br>you can tighten it a little by creating the list, then iterating it, then releasing it so you're not using autorelease, but it's nice to have it all in one line somtimes... also it's nice to have the cleanup of the badguy objects that get dropped along with the array copy happen on the cycle cap rather than mid update...<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found the bottleneck was in my "workaround" for the gimbal lock problem, using RotateMesh but this is incredibly slow :-(<br><br><pre class=code>
sphere-&gt;RotateMesh(fPitch,fYaw,fRoll);
</pre><br><br>Will try to find another workaround <br><br></td></tr></table><br>
<a name="1125383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vertigo</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Might I suggest using the following library:<br><a href="http://code.google.com/p/vfpmathlibrary/" target="_blank">http://code.google.com/p/vfpmathlibrary/</a><br><br>Also remember that the arm processor in iOS devices is slow as shit when handling lots of floating points.  I use bytes and shorts where possible.  Be sure to implement delta timing for those times when the cpu cycles drop way down.<br><br>Animation on multiple entities will drop your cpu performance pretty badly, be sure to space out updates on that.<br><br>Finally I cap the frame rate at 30fps which seems to help give some breathing room, and if you use delta timed movement you dont notice it anyways.<br><br>Best of luck speeding your code up! <br><br></td></tr></table><br>
<a name="1125445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the tips<br><br>Is there a way to cap the framerate in iMiniB3D? <br><br></td></tr></table><br>
<a name="1125448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You may already know this, but use texture atlases for your sprites. The less texture switching, the faster the app will be. This includes fonts, and UI. <br><br></td></tr></table><br>
<a name="1125451"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Iminin3d calls its update method with an NSTimer in its eaglview subclass. It either has a method to start the timer delay or there's a constant... I haven't used the base on in a while so I don't recall exactly :0). It can't render faster than the timer fires. If the main thread is engaged while the timer wants to fire (for example it's already processing a fire...) then it gets skipped and you drop a frame, hence tweening comes in handy. If you can keep it above your target frame rate, since iOS devices are static hardware with little to no actual background tasks, you can cheat and skip tweening more safely than a desktop. Buts it's still better to do it right... Plus if you tween you can raise your frame rate on faster devices without recoding... <br><br></td></tr></table><br>
<a name="1125494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Enable VBOs if you haven't already. Gerball went from 30-40FPS to 60FPS on a 3GS when I enabled VBOs.<br><br>I use RotateMesh in gerball by the way - it's not that slow! How many vertices does your mesh have? Try to limit the number of vertices. <br><br></td></tr></table><br>
<a name="1126037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> CreateSphere(64) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
