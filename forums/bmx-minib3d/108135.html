<!DOCTYPE html><html lang="en" ><head ><title >OpenB3D Framework</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >OpenB3D Framework</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >OpenB3D Framework</a><br><br>
<a name="1342691"></a>

<a name="1342692"></a>

<a name="1342693"></a>

<a name="1342694"></a>

<a name="1342695"></a>

<a name="1342696"></a>

<a name="1342697"></a>

<a name="1342698"></a>

<a name="1342699"></a>

<a name="1342700"></a>

<a name="1342701"></a>

<a name="1342702"></a>

<a name="1342703"></a>

<a name="1342704"></a>

<a name="1342705"></a>

<a name="1342706"></a>

<a name="1342707"></a>

<a name="1342708"></a>

<a name="1342709"></a>

<a name="1342710"></a>

<a name="1342711"></a>

<a name="1342712"></a>

<a name="1342713"></a>

<a name="1342749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://www.christianhart.de/bmax/openb3d/openb3d_logo.PNG"><br>I started this Framework in miniB3D for my <a href="/posts.php?topic=106666" target="_blank">Extrasolar</a> game project and ported it now to OpenB3D as it is more superior than miniB3D. This framework is still under construction but it has already many features to help creating a 3D game or demo using the OpenB3D wrapper in Blitzmax. I'm using this now in my current <a href="/posts.php?topic=108106" target="_blank">Legend of Faerghail</a> game project and I think it will be the base of all other projects in future. It's free so feel free to use/alter it for you own needs or just learn from it.<br><br>The demo has some basic movement code, use WASD and R/F to move around.<br><br><a href="http://www.christianhart.de/bmax/openb3d/openb3d_framework.jpg" target="_blank"><img src="http://www.christianhart.de/bmax/openb3d/openb3d_framework_t.jpg"></a><br><br>Download [5.1MB]: <a href="http://www.christianhart.de/bmax/openb3d/OpenB3D_Framework.zip" target="_blank">OpenB3d_Framework.zip</a><br><br><br>The main features are:<br><br><b>Associative Media management with TMaps capable of unloading</b><br>Instead of loading and assigning Media objects the "classic" way you just load the Media in a TMedia Object and retrieve it from everywhere, assign it and even delete it again to save VRAM (for example loading a different level with other textures):<br><br>Global MEDIA:TMedia = New TMedia<br>MEDIA.Load("TEX", "NOTEX", "notex.png", 1 + 8)<br>EntityTexture mesh, MEDIA.GetTexture("NOTEX")<br>MEDIA.Unload("NOTEX")<br><br>The TMedia Object supports many different types like Textures, Pixmaps, Sounds, Images, Fonts and so on. Check out the TMedia.bmx in the includes/Types folder or look at the demo source. In the compiled .debug EXE or if you set the PROJECT_DEBUG variable in the Variables.bmx to True there is an example how to fill VRAM with created Textures and unload them. I've checked this with the nVidia Gpu Utilization tool and it worked.<br><br><br><b>Instant screen resolution switch (ingame)</b><br>If you want to switch the resolution ingame a common method is to use EndGraphics and rebuild the whole scene again. Rubbish. Using a MAXGUI window with canvas can switch the resolution ingame with just a new function: SetResolution(x,y). I had to rewrite BeginMax2D/EndMax2D (now called: Begin2D/End2D) for this and use a global "Scaler" variable but it works, try it yourself. In Windows it is even possible to create either a fullscreen window or a window maximized including the Windows Taskbar.<br><br><br><b>Pre-Load resolution selector</b><br>Using MAXGUI has another advantage: Gadgets. When you start the game/demo you can now select a resolution first from a list which contains common resolutions retrieved from the available client resolution list.<br><br><br><b>Framesafe movement</b><br>The framework includes FPS management, so the game always runs at a fixed speed, if there a 30 or 300 FPS, Vsync, Delay or not. Just multiply all movement with the FPS.Multi variable and it'll be fine.<br><br><br><b>Localization</b><br>The framework has a simple localization system using Brucey's bah.DBSQLite module and a single SQL file containing ALL localized text. So your application can be multilingual now. It is very easy to use it. In the SQL Table you define a Category, a Key and one row per supported language. So the table looks like:<br><br><img src="http://www.christianhart.de/bmax/openb3d/openb3d_localization.PNG"><br><br>If you want to retrieve the english text for the "CREATECANVAS" key in your application you just use it this way:<br><br>Global LOCALE:TLocale = New TLocale<br>LOCALE.path = PATH_Locale<br>LOCALE.language = "EN"<br>LOCALE.Load		<br>InitLocaleArrays<br>Print LOCALE.Get("LOG_CREATECANVAS").<br>Result: Create Canvas Window<br><br>The key to retrieve is using this Syntax: CATEGORY_KEY, that's why it is "LOG_CREATECANVAS" instead of "CREATECANVAS". In the Framework demo I'm using this in the GUI.bmx file to display information. You can even store an array of text in a cell and decode it later like "on/off" and so on. It's all shown in the demo how to use it.<br><br><br><b>Shaders</b><br>OpenB3D can load shaders and the demo shows a single bumpmapping shader with a diffusemap and a normalmap applied to it. With the TMedia Object it is possible to "cache" a shader - you load it once and apply it to many objects by creating the shader when you need it. This is much faster than loading the files again and again. This is shown in the demo too. You can even load a different texture resolution in the demo and apply it to the shader again, in runtime. The demo basically shows a level with walls and two lights, one blue pointlight above the sphere and a second spotlight attached to the camera pointing forward. You can alter the light intensity with the mouswheel and see how the tiled surface is affected by the two lightsources when you look around. You can turn the lightsources on and off with the two mouse buttons.<br><br><br><b>Functions</b><br>I've included TONS OF FUNCTIONS in the include/Functions folder ready to use. You'll find many useful functions for Math, Text, Mesh, Primitives, Noise and so on. I've documented everything and most of them shoudl be easy to understand and how they are used. If not feel free to ask me about them. There are other cool features like the "Blip Text" which displays a text like a SciFi Computer with a "blip" for each character. I've made this using the TBeat Type to initiate an event every x milliseconds. Don't miss the two mouselook codes, one uses Euler rotation like in a FPS shooter and the other complex Quaternion rotation like in a 3D space game or flight simulator. Another addition is the Fraps-like FPS counter in the upper right corner, I've even created an extra font for this. So there is no need to have Fraps running in the background anymore :-p Turn it on/off with F12 like in the original.<br><br><br><b>BLIde additions</b><br>I've included the whole <a href="http://www.blide.org/" target="_blank">BLIde</a> project and my color settings. I've even added a feature that you can edit GLSL shaders in BLIde as GLSL is using a C Syntax and highlighting is very important as there are only limited ways to debug a shader. It's not perfect but I only use BLIde for editing GLSL now. I've tweaked the color settings for my own needs and I'm using the "Lucida Console" Font in 11pt. This is perfect for my 2560x1440 iMac resolution.<br><br><img src="http://www.christianhart.de/bmax/openb3d/openb3d_blide.PNG"><br><br>And now - what do you think or what can you create using this framework or contribute to it? Like I said I had to rewrite the BeginMax2D/EndMax2D functions to make the ingame resolution switch work and I'm not sure if I did this correct. At least it is working but you never know which sideeffects can occur.<br><br>Oh, and by the way I've created a new Rocket Icon like in Blitz3D for this project. It looks like the old one but is available in a larger resolution, I've even made a mouse cursor from it, feel free to use it:<br><br>Full Resolution:<br><img src="http://www.christianhart.de/bmax/openb3d/rocket/rocket_512x512.png"><br><br>Cursor:<br><img src="http://www.christianhart.de/bmax/openb3d/rocket/rocket_cursor.png"><br><br>Download <a href="http://www.christianhart.de/bmax/openb3d/rocket/rocket.ico" target="_blank">rocket.ico</a> <br><br></td></tr></table><br>
<a name="1342730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice additions to the OpenB3D framework.<br><br>One thing I noticed ( and I know that you said it's early days yet but... ) the normal mapping calculation is wrong and it's not working properly for the walls ( only the floor and ceiling ). You should really use a TBN matrix for correct normal mapped lighting to get what becomes the x, y, z of the texel in world coordinates before adjusting the lighting with the x, y, z channel in your normal map. <br><br></td></tr></table><br>
<a name="1342732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, the shader is basically the "bumpmap2" shader from the OpenB3D examples folder. Do you have an example? I think these geometry calculations are too complex to me at the moment. <br><br></td></tr></table><br>
<a name="1342736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great work Krischan! <br><br></td></tr></table><br>
<a name="1342738"></a>

<a name="1342739"></a>

<a name="1342740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Kriscan,<br><br>Yeah sure <a href="http://www.opengl-tutorial.org/intermediate-tutorials/tutorial-13-normal-mapping/" target="_blank">Here's an opengl tutorial</a>.<br><br>A TBN matrix is not that difficult to produce. You can produce it and store it with your actual geometry as 3 vectors so there's no need to create on each frame - although you do need to rotate it to align with your geometry on each frame. You already have the N ( normal ) part done, so you'll need to just calculate the Tangent and Binormal vectors with respect to the existing normal by using vectors calculated from the UV coords being applied.<br><br>For your cube this will really simple and you wouldn't even need to 'calculate' them - because the faces of the cube have a nice simple axis aligned normal vector and because your texture is squarely aligned too then the TB part will be unit vectors at right angles with your existing normal vector. The tutorial will explain all - there's no point me trying to repeat it badly here :D<br><br>If you get stuck let me know and I'll see if I can be of any help - I'm not the greatest mathematician but I do understand the majority of 3D math. <br><br></td></tr></table><br>
<a name="1342748"></a>

<a name="1342750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm I thought this can be all done within the shaders only? I've read another tutorial with a geometry shader but don't know how to implement this in OpenB3D as there is only a Vertex and a Fragment Shader, and the Geometry shader needs a higher OpenGL version and works between them.<br><br>Phew, I'm not good enough enough in this normal stuff and I'm still a beginner with GLSL so I think the best way is that somebody who is good in this normal stuff rewrites the shader / code and posts the corrections and I'll include it in my package. Even if the angles are not mathematically correct it still looks good at this stage for my game.<br><br>Any volunteers? <br><br></td></tr></table><br>
<a name="1342752"></a>

<a name="1342753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Krischan,<br><br>I haven't tried it yet but it all looks very useful and not things I was thinking of adding so thank you! The shader cache and resolution switching are probably the most essential, so congrats for figuring those out. <br><br>The bumpmap shader looks okay to me but I haven't really looked at it closely. I can see this shader calculates normals differently and is probably the correct way, so I'll put it on my todo list. Thanks col for the tutorial. <br><br></td></tr></table><br>
<a name="1342761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Krischan<br>Yes there's nothing wrong with calculating the tangent and binormal in a geometry shader from the normal and uv data passed in via each vertex - I suppose you could do in a vertex shader too. As they are a part of the vertex data that will be transformed by the pipeline, the tangents and binormals are usually calculated at the same time that the normal would be calculated, at which point they'd be sent to the gpu as a part of each vertex data- this would require a change to the vertex format inside OpenB3D. But as like everything in programming there's no one 'right' way of doing something and it's usually best to choose what works best for the underlying framework and media.<br><br>The bumpmap shader is accurate and does look nice! but it's just the wrong algo for the effect that you are looking to achieve. I don't mean to sound harsh and possibly making it sound like you haven't done great work here, I think you have done a great job with the extras, and also adding them to the OpenB3D framework! It's always awesome to see additions to anything Blitz related - especially 3D! <br><br></td></tr></table><br>
<a name="1342767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dave, you weren't harsh to me :-) You're right - the shading doesn't look accurate in right angles (and I have a lot of right angles in my map). I bypassed this problem by placing columns in all corners (which looks nicer, too). <br><br></td></tr></table><br>
<a name="1342771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would be great if BlitzMax would actually have a useable 3d engine. I was under the impression that MiniB3d was buggy and that OpenB3d was unfinished, so I'm very curious to see what you've done.<br>I'm definitely gonna try this. <br><br></td></tr></table><br>
<a name="1342806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Krischan, how did you make those golden letters in that promotional image? <br><br></td></tr></table><br>
<a name="1342813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would assume something in the likes of:<br>Emboss (chisel hard)<br>Metallic texture (light blended?) Or maybe just a "satin" effect...or "clouds"<br>(A slight gradient overlayed gradient - at least I would add one)<br>Soft dropshadow.<br><br>Hmm I should try to recreate that when home again.<br><br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1342814"></a>

<a name="1342815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kryzon: sssshhhh ;-) First you need Photoshop, <a href="http://graphicburger.com/cinematic-title-text-effect/" target="_blank">http://graphicburger.com/cinematic-title-text-effect/</a> and this Font: Cinzel: <a href="https://www.google.com/fonts/specimen/Cinzel" target="_blank">https://www.google.com/fonts/specimen/Cinzel</a><br><br>The PSD is included in the download there - I only changed the Font size, Color and added a different Background <a href="http://www.christianhart.de/bmax/openb3d/Background.gtx" target="_blank">I made myself in Genetica</a>, <a href="http://www.christianhart.de/bmax/openb3d/Background.jpg" target="_blank">here is the 3000x3000 JPG</a> of it.<br><br>Additional, to make the final Image sharper I flatten the Layers down, copy the layer, apply a 1px High Pass Filter to it and blend the new layer on top with the Overlay mode at 80%. This looks much better than a simple sharpen filter. <br><br></td></tr></table><br>
<a name="1342930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted June)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
