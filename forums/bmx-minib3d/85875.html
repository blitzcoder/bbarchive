<!DOCTYPE html><html lang="en" ><head ><title >rolling ball</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >rolling ball</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >rolling ball</a><br><br>
<a name="972234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would like a sphere to roll as it moves. I've made the sphere a child of a pivot so I can use moveentity on the pivot to steer. Then I get the difference in movement along X and Z and use turnentity to roll the sphere based on how much it's moved (pitch for Z change, and roll for X change) however since changing one changes the angle of rotation for the other (i.e. pitch forward 90 and now roll is actually yaw) this obviously doesn't work. Does anyone have a way of doing this (seemingly) simple rotation? I tried doing some parenting and un-parenting things with a second pivot but I just ended up with gimbal lock and a mess. <br><br></td></tr></table><br>
<a name="972246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's an example <a href="/codearcs.php?code=856" target="_blank">here</a>.<br><br>Unfortunately this site doesn't provide a good way to search the Code Archives. It's better to use google. I found the example by using this search query:<br><br><pre class=code>rolling site:http://blitzbasic.com/codearcs</pre> <br><br></td></tr></table><br>
<a name="972403"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for the link. I've dug around in it and after much poking I got it to compile but it dies right away saying signal 10 so I can't see exactly what it's supposed to do.<br><br>what I've got for single axis is <br><pre class=code>
mesh.TurnEntity((changeZ / circumference) * 360, 0, 0) ' pitch
</pre><br>Does anyone know of a way to calculate the yaw and roll based on the pitch? i.e. when the pitch is 90 then the yaw becomes the roll (but inverted I think...) and the roll becomes yaw. My brain is not being helpful in getting a handle on the math behind this. <br><br></td></tr></table><br>
<a name="972420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got a hacky work around going that suits my needs.<br><br>I parent the sphere to a pivot and then pitch the pivot based on movement on the Z axis. then clear the sphere's parent, reset the pivot to 0,0,0 rotation, parent the sphere to the pivot again and roll the pivot based on the movement on the X axis, then return the sphere to it's proper parent. This doesn't take into account changes along the Y axis so I'm not sure it will work long term, but for now it's convincing enough for my needs. <br><br></td></tr></table><br>
<a name="972551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The way I do it is to use RotateMesh for the ball. <br><br></td></tr></table><br>
<a name="972596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks simon, that's how I did it last time I needed a rolling ball as well, but this time I needed to stick things to it and have them spin too, and adding meshes together wasn't an option because I had to keep moving them once they're stuck. but clear, rotate 1, clear rotate 2 is working quite well so far. <br><br></td></tr></table><br>
<a name="1125236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ima747, Any chance I see the code as RotateMesh seems really slow on the device <br><br></td></tr></table><br>
<a name="1125248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simon uses rotate mesh in a production product so while it is a heavy method it is usable, first step I would take is trying to trim from elsewhere if it gives you the look you want.<br><br>I don't really understand the old code at a glance, haven't worked on it in a year and a half it looks like... I'm not positive it works flawlessly since the project was abandoned and I have no idea why (I think it was a combination of lazy making assets and a technical glitch I don't remember...)<br><br>Here's a snipped of I think what's relevant with a couple comments for what I *think* is going on...<br><pre class=code>
	//Get the position of the thing, core is a pivot
	float fx = core-&gt;EntityX();
	float fz = core-&gt;EntityZ();
	
	// Reset the position of the "turner" which is a pivot used to help with the rotation. have to put everything in the same place or the rotation origin will change... bad things
	turner-&gt;PositionEntity(core-&gt;EntityX(), core-&gt;EntityY(), core-&gt;EntityZ()); // there's a reason that it wasn't just parented to the core but I don't recall why... possibly I used the core orientation to calculate movements using move entity... not sure
	float circumference = PI * (radius*2); // for my game the ball could change size so this has to be updated constantly, normally this could just be static
	turner-&gt;RotateEntity(0, 0, 0);// reset the turner orientation
	meshCore-&gt;EntityParent(turner);// attach the actual visible mesh to the turner
	turner-&gt;TurnEntity((fz / circumference) * 360, 0, 0); // pitch the turner based on the core's position along the Z axis
	meshCore-&gt;EntityParent(core); // clear the mesh's parent
	turner-&gt;RotateEntity(0, 0, 0); // reset the turner orientation so it's not dirty with the pitch change
	meshCore-&gt;EntityParent(turner);// set the mesh parent again
	turner-&gt;TurnEntity(0, 0, (-fx / circumference) * 360); // roll the turner based on the core's position along the X axis
	meshCore-&gt;EntityParent(core); // reset the mesh's parent so it moves with the core in the next frame
</pre><br>Hope that helps, and god help you if it doesn't :0) <br><br></td></tr></table><br>
<a name="1125249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thinking about it, you might be able to do it more easily with 3 parented objects, just using one for each axis... not sure if that would work or not... I should look into it at some point.<br><br>Optimally official minib3d will eventually use quats and bring about world peace (in my mind), but the quat implementations haven't worked for me so far... at least not applied to existing projects and it's only for BMax to my knowledge. <br><br></td></tr></table><br>
<a name="1125255"></a>

<a name="1125258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> ima747, (Logan) awesome! :-) It works, and a smooth 60 FPS on the iPhone 3GS<br><br>Many, MANY thanks<br><br>Rob<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> glad it helped. The problem is that the Euler rotation can cause gimbal lock due to how it processes changes in orientations. By forcing each change to be in it's own space, that is not cumulative, but one axis per object, each object avoids gimbal lock, and when you put the results together you get an orientation. It's more like a snap shot of an orientation than a calculated offset, but it's, in theory, good enough for a ball rolling in a game (we're not simulating the universe on a particle level here, just making a sphere go "WHEE!!!").<br><br>It's ugly and hacky, but as long as one doesn't need to do it a lot it seems to work. A space sim sould still be tricky with this approach because a) it's inherently innacurate and b) you'd have to apply it to every object that spins every frame... it would get heavy fast. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
