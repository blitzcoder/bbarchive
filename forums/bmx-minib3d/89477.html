<!DOCTYPE html><html lang="en" ><head ><title >fullbright bug in iminib3d</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >fullbright bug in iminib3d</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >fullbright bug in iminib3d</a><br><br>
<a name="1016137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My apologies if this is already discussed in other threads, I can't find any mention.<br><br>I think there may be a bug with the fullbright setting in iminib3d. I have EntityFX set to 1, but the brightness changes when the camera rotates. Is there a known bug here, or am I just doing something wrong?<br><br>The entity of concern is a sprite parented to the camera, other objects aren't changing brightness. And actually now that I think about that, I'm thinking maybe I need to change the sprite's default blend mode or something.<br><br>Here's the code setting up my sprites:<br><pre class=code>
//setup the GUI
	for (int i = 0; i &lt; 3; i++) {
		gui[i] = Sprite::CreateSprite(camera);
		gui[i]-&gt;PositionEntity(9, i * 5 - 5, 15);
		
		int color = i * 30 + 50;
		gui[i]-&gt;EntityColor(color, color, color);
		gui[i]-&gt;EntityOrder(-10);		//always on top
		gui[i]-&gt;EntityFX(1);				//full-bright		//BRIGHTNESS CHANGES AS CAMERA ROTATES***************
		gui[i]-&gt;EntityPickMode(3);
		gui[i]-&gt;EntityBox(-1, -1, -.1, 2, 2, .2);
	}
</pre> <br><br></td></tr></table><br>
<a name="1016152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was having some lighting issues a while back and my game didn't need much in the way of lighting so I just decided to forgo a light source and use the ambient light setting which looked surprisingly good since my world space was shadowed through textures anyway.<br><br>Not really a solution for you I would assume but related and perhaps can help someone. <br><br></td></tr></table><br>
<a name="1016171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually that's a good point, I may just want to crank up the ambient light because all of the lighting is going to be through textures and vertex colors.<br><br>Somehow I suspect that if there is a bug with fullbright on sprites then it'll affect them even with the ambient light turned all the way up, but that's something to test. <br><br></td></tr></table><br>
<a name="1016190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did have some issues with lighting. Can't remember what they were, but I solved it using this line:<br><pre class=code>glLightModeli(GL_LIGHT_MODEL_COLOR_CONTROL,GL_SINGLE_COLOR)'GL_SEPARATE_SPECULAR_COLOR)&lt;--original value set by minib3d</pre>after Graphics3D.<br>Also, don't use Max2D as it puts this mode back.<br>For a more permanent solution, I changed this setting in TGlobal and TBlitz2D. <br><br></td></tr></table><br>
<a name="1016200"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Were your problems related to a specific graphics card Warner? I think jhocking is referring to iMiniB3D for iPhone OS, rather than minib3d in blitzmax... <br><br></td></tr></table><br>
<a name="1016831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> aha so I just got around to trying a few things with the lights as a test and have discovered more about this bug. First off the problem isn't simply that the brightness changes, but that they are just plain too bright. I didn't notice that before, but when I changed their color to red they ended up looking pink.<br><br>Second, the problem affects anything with full-bright, not just sprites. Furthermore, the bug isn't just when setting EntityFX, it's also when I turn up the ambient light all the way. That is, when I set ambient to 255 everything looked like the sprites, too bright.<br><br>But here's the really interesting thing; there's only a problem when there's a light in the scene. When I tested turning up ambient light without removing the scene light yet, everything turned bright and washed out but <i>still shaded</i>. When I removed the directional light then everything turned full bright as expected.<br><br>So the bug seems to be with lights themselves. Given that things get too bright but still shaded, it looks like the brightness of the directional light is getting added to the object's full brightness, rather than replaced. Now I'm going to test if this is a problem for point lights as well or only directional lights.<br><br><br>@warner: yeah what he said, I'm talking about iminib3d, not minib3d. <br><br></td></tr></table><br>
<a name="1016834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> whoah so um lights in iminib3d are really screwy. As I said at the end of my long post, I tested putting in a point light. Now everything is waaaay too bright; most surfaces are white, the only exceptions are really oblique surfaces that aren't getting much light. Even if the light is too close and I need to reduce the LightRange, full-brightness should be the color of the object, not white.<br><br>At any rate, now I'm thinking/hoping there would be a simple fix here where I can go into the iminib3d code and tell the lights not to affect anything with EntityFX 2.<br><br><br>ADDITION: I've commented out these two lines in the middle of Mesh-&gt;Render:<br><br>float ambient[]={ambient_red,ambient_green,ambient_blue};	<br>glLightModelfv(GL_LIGHT_MODEL_AMBIENT,ambient);<br><br>Fullbright is working correctly now, but we'll see what negative repercussions this little edit will have. <br><br></td></tr></table><br>
<a name="1016843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for all the effort jhocking, when I ran into lighting being odd I just killed all my lights and used ambient (as I stated above) and my next project will actually be doing the same but for different reasons so I'm glad someone is doing some digging, hopefully if simon hasn't got this squashed yet you'll be pointing him in the right direction.<br><br>Interestingly I didn't notice any lighting issues that I can recall in the demos, only in my own code... either I'm not remembering correctly or perhaps a look into the demo sources could help (avoiding a pun there was very hard...) <br><br></td></tr></table><br>
<a name="1025428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> just an fyi for anyone stumbling on this thread, simon fixed this bug in iminib3d 0.4 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
