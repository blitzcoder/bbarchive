<!DOCTYPE html><html lang="en" ><head ><title >MiniB3D Thread 3</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >MiniB3D Thread 3</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=119" >MiniB3D Module</a>/<a href="#bottom" >MiniB3D Thread 3</a><br><br>
<a name="700629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=61515" target="_blank">Thread 2</a><br><br>Latest Version: 0.27 - download from <a href="http://www.si-design.co.uk" target="_blank">here</a>.<br><br>0.27 features a few bug fixes, mostly relating to sprites which are now always displayed correctly and also a few other things. <br><br></td></tr></table><br>
<a name="700634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You are getting worst than Mark into making updates...:D <br><br></td></tr></table><br>
<a name="700636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice solid work thanks for sharing <br><br></td></tr></table><br>
<a name="700683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simonh, I really appreciate all your hardwork on this project it's really helping out. <br><br></td></tr></table><br>
<a name="700716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sweet!  Talk about quality (and responsiveness)!<br><br>What a great tool you've created! <br><br></td></tr></table><br>
<a name="700774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> is the link dead or just me who can't access to the website ? <br><br></td></tr></table><br>
<a name="700815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> works fine here. <br><br></td></tr></table><br>
<a name="700834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note, How can use linepick method with minib3d ?<br><br>Special message For Boby,  за marche impec l'ami. <br><br></td></tr></table><br>
<a name="700860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> LinePick is not implemented yet. <br><br></td></tr></table><br>
<a name="701028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> strange issue... it 's the only link that i can't access. I can't solve it . Maybe anyone could post a mirror Link to download ? It would be lovely :) <br><br></td></tr></table><br>
<a name="701032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I assume Simon doesn't mind, since it's a public download.<br><br>It's in my temp folder, so don't expect it to stay there for ever, but since you're having problems.<br><br><a href="http://www.glimmergames.com/temp/MiniB3D-v027.zip" target="_blank">http://www.glimmergames.com/temp/MiniB3D-v027.zip</a> <br><br></td></tr></table><br>
<a name="701042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> has anyone been able to get entitypick or camerapick to work?  I've tried and failed. <br><br></td></tr></table><br>
<a name="701089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanx ! I try it in the minute.<br>[edit]<br>Many works done. really good !<br><br>But for the moment, there are so many functions not available, that i really often use like "CreateTexture" ,"TextureBuffer" , "getSurfacebrush" etc... and of course the TForm functions. So for the moment, i keep a look on this, but i can't use it.<br><br>Continue, it's really a good work !!! <br><br></td></tr></table><br>
<a name="701137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do people use for 2D with MiniB3D? Anyone hacked Max2D to work with it? I saw it somewhere in the forums, but can't find it ATM. <br><br></td></tr></table><br>
<a name="701152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> About meshwidth, meshdepth and meshheigth functions, i received always 2.0<br><br>I had tested with different mesh the value returned for the theses functions is always 2.<br><br>I don't understand why ? <br><br></td></tr></table><br>
<a name="701218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another problem about CountSurfaces.<br><br>When i use this functions, i received for my mesh value 0.<br><br>I test the same function CountSurfaces whit the same mesh in blitz3d the returne value is 4. <br><br></td></tr></table><br>
<a name="701226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> While I haven't testet it, the code for meshwidth etc. looks valid.<br><br>As for CountSurfaces it's used heavy internally, so that's probably ok too. Please re-check your results :) <br><br></td></tr></table><br>
<a name="701230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> We really should make Max2D support a priority in MiniB3D. It's such a pain doing it yourself each time :) <br><br></td></tr></table><br>
<a name="701271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. Did some work on converting entity position to screen coords (for labels over objects etc.), but only the x position is correct.<br>The y Position keeps moving up for some odd reason.<br>I know the returned Y is reverse from normal.<br><br><pre class=code>
' Object to screen stuff
	Method ObjectToScreen:TVector(Entity:TEntity)
	
		Local SX:Double
		Local SY:Double
		Local SZ:Double
		Local MVMatrix:Double[16]
		Local ProjMat:Double[16]
		Local VPort:Int[4]
		glGetDoublev(GL_MODELVIEW_MATRIX,Varptr MVMatrix[0])
		glGetDoublev(GL_PROJECTION_MATRIX,Varptr ProjMat[0])
		glGetIntegerv(GL_VIEWPORT,Varptr VPort[0])
		gluProject(EntityX(Entity),EntityY(Entity),EntityZ(Entity),MVMatrix,ProjMat,VPort, Varptr SX, Varptr SY, Varptr SZ)
		
		Return TVector.Create(SX, SY, SZ)

	
	End Method
</pre><br><br>Anyone?<br><br>I'm trying to do CameraProject for MiniB3D<br><br><pre class=code>
CameraProject camera,x#,y#,z#
Parameters:
camera - camera handle
x# - world coordinate x
y# - world coordinate y
z# - world coordinate z
</pre> <br><br></td></tr></table><br>
<a name="701292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange, for me your method works (after changed to OO version as the compiler blocks because of object to int conversion beeing illegal). <br><br>But I'll do some other tests to see if it is only because of the setup of the basic entity test. <br><br></td></tr></table><br>
<a name="701294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. No compiler errors here. (It's a method tho)<br>Although Y coordinate is everchanging, even though object is at center of screen.<br>A good guess is that some kind of projection is going on here.<br>Will investigate futher. <br><br></td></tr></table><br>
<a name="701296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I edited the above post.<br>The projection issue is gone, was an error on my side!<br><br>Thats the code I used and put into the example after the other line of debugtext.<br><pre class=code>
	Local vec:TVector = cam.ObjectToScreen(cube)
	DebugText 0,20, "Coords: " + vec.x + ","+vec.y+","+vec.z
	DebugText vec.x, height-vec.y, "Cube"  		' height - vec.y needed as OpenGL has reversed y. Else it looks like projection error!</pre> <br><br></td></tr></table><br>
<a name="701297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. I tried that, but it didn't work. When are you calling ObjectToScreen? (Before/after renderworld etc.)<br>Also, mine is placed on a moving object.<br>It's correct that gluProject reverses the Y coordinate, since OpenGL starts at bottom left (weeeh, we've been smoking too much weed)<br><br>Can you make a very simple example that works for you? <br><br></td></tr></table><br>
<a name="701303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> patmaba - can you post an example program?<br><br>This program suggest MeshWidth/Height etc and CountSurfaces are working OK:<br><br><pre class=code>Import "../MiniB3D.bmx"

Local width=640,height=480,depth=16,mode=0

Graphics3D width,height,depth,mode

Local  cam=CreateCamera()
PositionEntity cam,0,0,-10

Local light=CreateLight(1)

Local tex=LoadTexture("media/test.png")

Local cube=CreateCube()

ScaleMesh cube,5,1,1

RenderWorld

DebugText 0,0,"MeshWidth: "+String(MeshWidth(cube))
DebugText 0,20,"Count Surfaces: "+String(CountSurfaces(cube))

Flip

WaitKey</pre><br>ozak - Yeah I'll add Max2D support to the next version. <br><br></td></tr></table><br>
<a name="701311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Btw: I'm working on the collision functions from Blitz3D and was wondering what the procedures are, if I should mail you a suggested update? <br><br></td></tr></table><br>
<a name="701340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Si,<br><br>I've also emailed some stuff you might find useful. <br><br></td></tr></table><br>
<a name="701558"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <i>Yeah I'll add Max2D support to the next version.</i><br><br>Sweet!  I was just starting to fiddle with straight OpenGL in order to find a better way to do 2D than using sprites childed to the camera (which led to the discovery of the sprite orientation issue you fixed so quickly!).  This is a terrific tool.  Thanks for your hard work! <br><br></td></tr></table><br>
<a name="701623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am still working on trying to get a camerapick to work but its proving to be pretty difficult. <br><br></td></tr></table><br>
<a name="701659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ozak:<br><br>I put your method on the TCamera class (think thats where you have it as well).<br><br>The code above was put into the basic example with the rotating cube etc straight after the other line of debug text so after renderworld ie about the last thing before the screen is flipped.<br><br>PS: For lazy programmers, here is the one with the correct y output. Just put it into the TCamera type.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' Object to Screen method
	Method ObjectToScreen:TVector(Entity:TEntity)
	
		Local SX:Double
		Local SY:Double
		Local SZ:Double
		Local MVMatrix:Double[16]
		Local ProjMat:Double[16]
		Local VPort:Int[4]
		glGetDoublev(GL_MODELVIEW_MATRIX,Varptr MVMatrix[0])
		glGetDoublev(GL_PROJECTION_MATRIX,Varptr ProjMat[0])
		glGetIntegerv(GL_VIEWPORT,Varptr VPort[0])
		gluProject(Entity.EntityX(),Entity.EntityY(),Entity.EntityZ(),MVMatrix,ProjMat,VPort, Varptr SX, Varptr SY, Varptr SZ)
		
		Return TVector.Create(SX, TGlobal.height - SY, SZ)

	
	End Method</textarea><br><br>And here is the whole test-privmitives.bmx, type based to make it work at all:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Import "../MiniB3D.bmx"

Local width=640,height=480,depth=16,mode=0

Graphics3D width,height,depth,mode

Local  cam:TCamera=CreateCamera()
PositionEntity cam,0,0,-10

Local light:TLight=CreateLight(1)

Local tex:TTexture=LoadTexture("media/test.png")

Local cube:TEntity=CreateCube()
Local sphere:TEntity=CreateSphere()
Local cylinder:TEntity=CreateCylinder()
Local cone:TEntity=CreateCone() 

PositionEntity cube,-6,0,0
PositionEntity sphere,-2,0,0
PositionEntity cylinder,2,0,0
PositionEntity cone,6,0,0

EntityTexture cube,tex
EntityTexture sphere,tex
EntityTexture cylinder,tex
EntityTexture cone,tex

Local cx#=0
Local cy#=0
Local cz#=0

Local pitch#=0
Local yaw#=0
Local roll#=0

' used by fps code
Local old_ms=MilliSecs()
Local renders
Local fps

While Not KeyDown(KEY_ESCAPE)		

	If KeyHit(KEY_ENTER) Then DebugStop

	' control camera

	If KeyDown(KEY_UP) Then cz#=cz#+1.0
	If KeyDown(KEY_LEFT) Then cx#=cx#-1.0
	If KeyDown(KEY_RIGHT) Then cx#=cx#+1.0
	If KeyDown(KEY_DOWN) Then cz#=cz#-1.0
	
	If KeyDown(KEY_W) Then pitch#=pitch#-1.0
	If KeyDown(KEY_A) Then yaw#=yaw#+1.0
	If KeyDown(KEY_S) Then pitch#=pitch#+1.0
	If KeyDown(KEY_D) Then yaw#=yaw#-1.0

	MoveEntity cam,cx#*0.5,cy#*0.5,cz#*0.5
	RotateEntity cam,pitch#,yaw#,roll#
	
	cx#=0
	cy#=0
	cz#=0

	'
	
	TurnEntity cube,0,1,0

	cx#=0
	cy#=0
	cz#=0

	RenderWorld
	renders=renders+1

	' calculate fps
	If MilliSecs()-old_ms&gt;=1000
		old_ms=MilliSecs()
		fps=renders
		renders=0
	EndIf
	
	DebugText 0,0,"FPS: "+String(fps)
	Local vec:TVector = cam.ObjectToScreen(cube)
	DebugText 0,20, "Coords: " + vec.x + ","+vec.y+","+vec.z
	DebugText vec.x, vec.y, "Cube"  		

	Flip

Wend
End</textarea> <br><br></td></tr></table><br>
<a name="701687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> The stuff I sent Si was some CameraPick and LinePick code I did for my own OGL engine. I'm just going through MiniB3D at the moment and looking at the viability of integrating it.<br><br>[EDIT]<br><br>It's failed. It works very well in my Engine, but is a bit of a 'square peg in a round hole' for MiniB3D. :( <br><br></td></tr></table><br>
<a name="701710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, my first post here: At first Simon, great work and I think with the help of this community this engine will be grow very fast. <br><br>Here is my addition i'm currently working on:<br><br><a href="http://www.blitzforum.de/upload/file.php?id=451" target="_blank">http://www.blitzforum.de/upload/file.php?id=451</a><br><br>It is a Terrain Engine (currently without LOD).<br>It should be in the end a Quadtree Terrain.<br><br>@Simon: Please add the UpdateNormals code from Mark, it is much faster here then yours. And for Terrains I need a good Updatenormals function. <br><br>Second Addition was a simply Wireframe command, but I think this is to small to post here ;) <br><br></td></tr></table><br>
<a name="701730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sent CameraProject to Simon. 100% like Blitz3D's.<br>Thanks to Dreamora for the help. I'll keep testing it tho. <br><br></td></tr></table><br>
<a name="701745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> This project is sweet! But I have one question.<br>Was unsure if I should start a new thread, or just ask away here. I hope nobody minds if I ask here. :)<br><br>I haven't used Blitz3D before so I don't know if this is possible to do this, but is there a way to make a mesh a child to a bone? One example is to place a weapon in the hand of a player or enemy. <br><br>I looked at the TMesh code, TBone code and the TKeys code but all I found was a function in TMesh that makes a copy of all the bones. And it didn't look like it was useful in this case.<br><br>Thanks for any help, and for working on MiniB3D! <br><br></td></tr></table><br>
<a name="701748"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> In Blitz3D it isn't a problem.<br>As a Bone is an entity and any entity accepts child you can simply parent the object to the bone.<br><br>Haven't tried in MiniB3D yet. <br><br></td></tr></table><br>
<a name="701756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> How was this done in Blitz3D? I have been searching the code archives but haven't found anything that explains this.<br>Is the names for the bones saved in a B3D file?<br><br>EDIT:<br>Ooh, wait. There is a FindChild in TEntity. Looks like it could be useful in this case. :) <br><br></td></tr></table><br>
<a name="701771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yupp thats exactly the way it is done in B3D.<br>You load as AnimMesh and look for the bone by FindChild :) <br><br></td></tr></table><br>
<a name="701860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I found a small bug with the lights.<br>The Blitz3D manual says: "Specifying a parent entity will still result in the light being created at position 0,0,0 rather than at the parent entity's position."<br>But when I added a light as a child to a robot in my little test-MiniB3D-game the light was placed at the feet. <br><br></td></tr></table><br>
<a name="701864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> The doc is wrong. <br><br></td></tr></table><br>
<a name="701867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange<br>Because current B3D creates entities with specified parent at 0,0,0, but not global 0,0,0 but parent 0,0,0. Or is this just an inconsistency on lights?<br><br>It does not make sense to place it somewhere else than 0 of the parent as it will move relative to it and relative to "somewhere" is a little pointless. <br><br></td></tr></table><br>
<a name="701874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Because current B3D creates entities with specified parent at 0,0,0, but not global 0,0,0 but parent 0,0,0 <br></div><br>Yes, CreateCamera/Light/Mesh etc, when a parent is specified, will position the child entity at local 0,0,0 (i.e. the parent entity's position). This is true for all entities in either B3D or MiniB3D.<br><br>The docs suggest that the child entity is created at global 0,0,0 when a parent is specified, which is wrong.<br><br>In dep's case I would guess that the local 0,0,0 is at the robot's feet. <br><br></td></tr></table><br>
<a name="701880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I wanted it to be created at local 0,0,0. (at the feet of the robot.)<br>So it looks like there was no bug after all. Sweet. :)<br><br>Thanks.<br><br>Edit: A virtual cookie to the one who can guess what game I'm making a clone of, using MiniB3D. :)<br><a href="http://img428.imageshack.us/img428/8135/devscrn1jz8.jpg" target="_blank">Screenshot</a><br>(The zombie is a placeholder, will be removed later.) <br><br></td></tr></table><br>
<a name="702123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> [EDIT]<br>Oops.<br>[EDIT]<br>Well after some extensive testing I found out why why my LinePick / Camerapick stuff failed. All the Maths appear to be the reverse of my own OLG engine for some reason. :/ <br><br></td></tr></table><br>
<a name="702226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah isnt that the way blitz3d did it? <br><br></td></tr></table><br>
<a name="702243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well. You can join the club. My CameraProject only works with one camera :)<br><br>Maybe we should just add the needed math to code it all ourselves, instead of relying on Glu stuff (thinking of frustum culling here too)<br>That way we could have the orthogonal stuff  too. <br><br></td></tr></table><br>
<a name="702275"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> About my problem with the functions meshwidth, depth, height and count surface. The code work in a mini program.<br><br>The function work perfect with this code<br><br>Import "MiniB3D.bmx"<br><br>Graphics3D 800,600,16,2<br>m:TMesh=LoadMesh ("media/batfighter.b3d")<br>Print "CountSurfaces="+CountSurfaces(m) <br>Print "MeshWidth="+MeshWidth(m) <br>Print "MeshHeight="+MeshHeight(m) <br>Print "MeshDepth="+MeshDepth(m) <br>Print ""<br>Print "Press key to exit"<br><br>WaitKey <br><br><br>but in another program too big to post the result is incorrect<br><br>DebugLog:Entity XYZ CountSurfaces=0<br>DebugLog:Entity XYZ MeshWidth=-2.00000000e+009<br>DebugLog:Entity Base CountSurfaces=1<br>DebugLog:Entity Base MeshWidth=2.00000000<br><br>I havent found why <br><br></td></tr></table><br>
<a name="702277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Email me the big program and I'll take a look. <br><br></td></tr></table><br>
<a name="702283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got some problems with adding children to bones.<br><br>Looks like (TMesh) children isn't placed at the parent position, and they isn't moved when the parent moves, and isn't rotated when the parent is rotating.<br><br>Here is a method from my Droid Type:<br><pre class=code>
	Method New()
	
		If Not e_droid Then 
			' Load the mesh, then hide it. Used for making copies of this one later
			e_droid = LoadAnimMesh("data/droidmk2.b3d")
			HideEntity( e_droid )
		EndIf
		
		If Not e_sight Then
			e_sight = LoadMesh("data/lasersight.b3d")
			HideEntity( e_sight )
		EndIf

		obj = CopyEntity( e_droid )
		
		' Place the droid
		Local x:Int = 2 ' Use known values for debug reasons.
		Local z:Int = 3 
		PositionEntity( obj, 20+(x*40),0,20+(z*40) )
		RotateEntity( obj, 0, Rand(0,3)*90, 0 ) ' Get a random direction

		Local b:TEntity = FindChild( obj, "borglaserend" )
		If b Then
			lasersight = CopyEntity( e_sight,b )
			ShowEntity( lasersight )
			EntityFX( lasersight, 1 )
		
			Print EntityX(lasersight,True)+","+EntityY(lasersight,True)+","+EntityZ(lasersight,True)
		Else
			Print "Unable to find the bone!"		
		EndIf
		
	EndMethod
</pre><br><br>The debug output says: <br><pre class=code>
-0.0206391700,13.4376907,0.975049317
</pre><br><br>And that looks like the correct position, if the origin is at the droid's feet. But the droid is placed at (global) 100,0,140. So, if I understand things correctly, the Output Should have said something like:<br><pre class=code>
99.98, 13.437,140.975
</pre><br>Since I tell EntityX,Y,Z to return the global coordinates.<br><br>Or am I wrong here? <br><br></td></tr></table><br>
<a name="702355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, looking into, bones don't actually transform child entities at the moment - need to fix that. <br><br></td></tr></table><br>
<a name="702571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> about countsurface and mesh size functions failed when Tmesh is used with loadanimmesh<br><br>here a code.<br><br>Import "MiniB3D.bmx"<br><br>Type TA<br>	Field entity:TMesh<br>	<br>	Method loadentity( pName:String )<br>		entity = LoadAnimMesh( pName )<br>	End Method<br>End Type<br><br>Graphics3D 800,600,16,2<br>m:TMesh=LoadMesh ("media/patmaba.b3d")<br>Print "CountSurfaces="+CountSurfaces(m)<br>Print "MeshWidth="+MeshWidth(m)<br>Print "MeshHeight="+MeshHeight(m)<br>Print "MeshDepth="+MeshDepth(m)<br>Print ""<br><br><br>A:TA = New TA<br>A.loadentity("media/patmaba.b3d")<br><br>Print "A CountSurfaces="+CountSurfaces(A.entity)<br>Print "A MeshWidth="+MeshWidth(A.entity)<br>Print "A MeshHeight="+MeshHeight(A.entity)<br>Print "A MeshDepth="+MeshDepth(A.entity)<br>Print "Press key to exit"<br><br>WaitKey <br><br></td></tr></table><br>
<a name="703073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Quick question:<br><br>I'm working on a rudimentary collision detection and I'm having trouble with my terrain collisions.  My terrain is a tilemapped series of meshes, so I'll need actual mesh collisions (rather than the bounding boxes I'm using for objects).<br><br>How are the values for each triangle/surface stored in the Tmesh type?  Would I have to EachIn the surfaces of the mesh, then For-Next up to no_verts to get each of the vert coords (i.e. up to vert_coords[no_verts-1]) for each surface, with each vert_coords[i] representing either the x,y, or z value (relative to the mesh origin)?  Are the vertexes themselves recorded in the array in clockwise order?  Any help would be... er... helpful! <br><br></td></tr></table><br>
<a name="703077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> For vertices, you have one big array, with each vertex position stored like so: x (0), y (1), z (2), x (3), y (4), z (5) etc.<br><br>For triangles, you have another big array, with each vertex index stored like so: So: v2 (0), v1 (1), v0 (2), v2 (3), v1 (4), v0 (5) etc, with v0, v1, v2 representing the parameters in AddVertex.<br><br>So to get the vertex position for each triangle, you need to loop through the triangle array, get the vertex index, and use that to find the vertex position from the vertex array. <br><br></td></tr></table><br>
<a name="703080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> patmaba - your example runs OK here (I tested it with zombie.b3d). Can you send me your 'patmaba.b3d' model so I can test it with that? <br><br></td></tr></table><br>
<a name="703124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, again.<br>Here is small status on how far I was coming in the last days.<br><br>Terrain Engine mainly stays (some minor things and tweaking to get nearly to the original Terrain)<br>Also added Wireframe (not such a big thing)<br>and<br>If someone is interrested, I have succesfully attached Shaders  to the Brushtype.<br><br>BtW, here is small demo of the Terrain:<br><br><a href="http://klepto2.kl.funpic.de/DL/TerrainDemo.rar" target="_blank">http://klepto2.kl.funpic.de/DL/TerrainDemo.rar</a><br><br>Arrow Keys to Move around<br>Mouse to Look around<br>W for Wireframe<br>and Left Mouse Button for a small Shader test<br><br>Enjoy. <br><br></td></tr></table><br>
<a name="703128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Link's dead. <br><br></td></tr></table><br>
<a name="703130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sigi</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rightclick and save as :) <br><br></td></tr></table><br>
<a name="703133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry, sometimes it works, sometimes not. But not long and I will have a better webspace. Currently follow sigi's post. <br><br></td></tr></table><br>
<a name="703157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems to work well. What type of terrain system is it? <br><br></td></tr></table><br>
<a name="703160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is a preoptimised Tiled Quadtree Terrain. <br>It is mainly based on this code: <a href="http://www.blitzbasic.com/Community/posts.php?topic=34168#368818" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=34168#368818</a><br>and currently I try to embbed it into MiniB3D. The only thing I have vurrently a problem with, is to get the height of the real terrain. <br><br></td></tr></table><br>
<a name="703163"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, unfortunately Eole released that code with a license agreement, so I'm not sure I'd be able to add it to MiniB3D.<br><br>To get the real height of the terrain use this:<br><br><pre class=code>
ya#=(y10-y00)*fx+y00
yb#=(y11-y01)*fx+y01
y#=(yb-ya)*fz+ya
</pre>Where y00,y01,y10,y11 are the height of the tile corners, and fx# and fz# are the fractional x and z positional values (0-1) within the tile. <br><br></td></tr></table><br>
<a name="703166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I could make it new from scratch (now where I understand Quadtrees ;). and thx for the height formula, I will try it out. <br><br></td></tr></table><br>
<a name="703283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> From the license he added, there is nothing that prevents using it unless you are planning to make MiniB3D a commercial project.<br>But easiest thing is always to contact people and simply ask.<br><br>I'm currently porting Particle Candy to MiniB3D but need to add some commands before (I need TForm commands and Cam Project). When I'm done I'll send the code to its creator so he can decide if owners of the license get that code as well to use with MiniB3D.<br>I'm mainly interested in the speed difference we get because I'm quite sure that the BM-MiniB3D will be significantly faster. <br><br></td></tr></table><br>
<a name="703284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> What about games that use MiniB3D? Will the license prevent them from being commercial? <br><br></td></tr></table><br>
<a name="703285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> SimonH: I think this module deserves its own website and forum Where we can collect togethor on MiniB3d specifically. <br><br></td></tr></table><br>
<a name="703359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't seend the model. I'm not the owner of the model.<br><br>But the model is exported with gile application( <a href="http://www.frecle.net/giles/" target="_blank">http://www.frecle.net/giles/</a> )<br><br>The problem come when i'm using LoadAnimMesh function. <br><br></td></tr></table><br>
<a name="703370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried using TEntity for the type when using animmesh command on loading?<br>Main problem might be that Gile[s] head node has no geometry attached, it is only a pivot. so that might interfer perhaps. <br><br></td></tr></table><br>
<a name="703375"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> Impossible Dreamora,  the load function is implemented into TMesh. <br><br></td></tr></table><br>
<a name="703383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry missspelled the idea perhaps a little.<br>What I meant is that you assign the loaded animmesh to a TEntity instead of TMesh<br><br>But thinking over it there is another simple reason why it won't work with animmesh: exactly the reason above. You are asking the head node for its surfaces ... and as it is only a pivot, it naturally has none. Nor has it a mesh width as no geometry is attached. You have to ask all of its childs for this informations.<br>Although I'm not sure if B3D in this case just uppropagandated all the bounding box informations to get the dimensions on the head as well. In this case, at least the width, height, depth are bugged if they don't return anything on the head pivot. (bugged or might be added later. Currently culling is on sphere base not bounding volume and the later is the data, width - height - depth would return on the head pivot normally) <br><br></td></tr></table><br>
<a name="703428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, if the head node is a pivot, that might cause CountSurface/MeshWidth etc to return wrong values. I'll look into it.<br><br>Dreamora: The TForm commands and CameraProject commands are already in the new version (0.3), which will be released soon. I'm not sure MB3D will be quicker yet though. <br><br></td></tr></table><br>
<a name="703443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad to hear :)<br>We will see if it is faster or slower.<br><br>It would definitely be cool if it would be faster, as OpenGL is causing less problems than DX7 does, the newer the graphics driver are. <br><br></td></tr></table><br>
<a name="703469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have mailed Eole and I'm waiting for his answer now.<br><br>As long I'm currently working on GLSL Shader integration to the TBrush Type, which comes quite well.<br><br>My Terrain with a Environment Map Shader attached:<br><br><img src="http://klepto2.kl.funpic.de/DL/EnvMap.PNG"><br><br>Here is some Code how to attach a Shader to the Brush:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Global Terrain:TTerrain = TTerrain.Create( "height2.png" , 4 , 5)
ScaleEntity Terrain.Terrain,40,40,40
Terrain.TextureTerrain(brush , 0.5 , 1)
'Terrain.TextureTerrain(detail , 0.01 , 0)
Terrain.PaintTerrain(brush1)


Global brush:TTexture = LoadTexture("media/sky_UP.bmp")
Local detail:TTexture = LoadTexture("CrackedStone.BMP")
Local brush1:TBrush = CreateBrush()
brush1.AddVertexShader("Shaders/CH10-envmap.vert.txt")
brush1.AddFragmentShader("Shaders/CH10-envmap.frag.txt") 

brush1.Po.Activate()
brush1.Po.SetUi1("EnvMap" , 1)
brush1.Po.SetUI3("BaseColor" , 0 , 0 , 150)
brush1.Po.SetUF1("MixRatio",.4)
brush1.Po.deActivate()
</textarea><br><br>In the mainloop you could do a simply Terrain.setShader(True/False) to switch it on/off.<br><br>If V 0.3 is ready I will build it in and send the code to Simon. <br><br></td></tr></table><br>
<a name="703482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> You rock simon! So. Can we have 0.3 soon? Really need that Max2D stuff :) <br><br></td></tr></table><br>
<a name="703488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have I mentioned that this thing is getting better and better?<br><br>I might consider dropping my "2D entity framework" idea and instead thinking about a way of integrating my own particle system into MiniB3D (it has its root back in ParticleDreams for those that have used it when it was available. But got a major redesign to work more efficiently) as I definitely like it and would like to contribute to it as well :-) <br><br></td></tr></table><br>
<a name="703503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm working on a multiplayer action game with the current MiniB3D and it's more than capable. Also, my game runs on both Windows and Mac without problems :) <br><br></td></tr></table><br>
<a name="703544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah ill add to it, I am using this for my project as well. <br><br></td></tr></table><br>
<a name="703715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for the feedback about my problem. But have you a workaround with the gile exported model. <br><br></td></tr></table><br>
<a name="703717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> Currently the only workaround I could think if is:<br><br>Define minX,maxX / y / z:float<br>Define surfaces:int<br><br>Take your giles model and ask each child for its surface count and add that to surfaces<br>Ask each child for its width, depth, height, divide it by 2 and add it to entityX/y/z and see if it is larger / smaller than your minX / maxX etc and if so, apply it to the coresponding values.<br>As all the childs should be meshes (unless you exported lights as well), this shouldn't be a problem. <br><br></td></tr></table><br>
<a name="703782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok DreamOra, but to ask my model, i must used the count surface function. Before to start this function have trouble with gile model. <br><br></td></tr></table><br>
<a name="703792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't understand your posting.<br><br>Yes you must use the count surface function, but not on your model. You have to use the Entity Child functions to get all childs and ask those for the surfaces as those are the meshes.<br><br>When I'm back home and find time, I'll possibly write you a function to do so. <br><br></td></tr></table><br>
<a name="703842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone noticed that regular alpha blending does not work with sprites? Also, when using Max2D I always get additive alphablending no matter what I specify (even no blend)<br><br>Regards<br><br>Ozak <br><br></td></tr></table><br>
<a name="703861"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> With Max2D this is expected. If you add alpha information, they are taken into account on anyblend beside SolidBlend (no blend does not exist, default is Mask when I remember correctly)<br><br>Haven't tested on sprites yet. But isn't that exactly what Blitz3D does as well?<br>If you want a different behavior with Blitz3D it is normally a mix of EntityBlend and TextureBlend to compensate each other. <br><br></td></tr></table><br>
<a name="703889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> I will just add my own pointless post to say that this project looks quite exciting.<br>Kudos Simon, and keep up the good work. <br><br></td></tr></table><br>
<a name="703911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a calculation problem with my terrain system to get the current height at x,z.<br><br>Here is some code:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Method TerrainY:Float(x:Float , y:Float ,z:Float)
		Local Dist:Float = 99999999999
		Local Mesh:TMesh = GetMesh(x , z , Terrain.sx)
		PatchTest = Mesh
		Local ID:Int = 0
		Local Counter:Int = 0
		If Mesh = Null Then Return 0
				
		Local Vid:Int = 0
		Local surf:TSurface = Mesh.GetSurface(1)
			
		For Local I:Int = 0 To surf.CountTriangles() - 1
			Local VN:Int = surf.TriangleVertex(I,0)
			Local x1:Float = surf.VertexX(VN) + EntityX(mesh,True)
			Local y1:Float = (Surf.VertexY(VN) + 1 )+EntityY(mesh,True)
			Local z1:Float = surf.VertexZ(VN) + EntityZ(mesh,True)
			
			Local xd:Float = X1 - X
			Local yd:Float = y1 - y
			Local zd:Float = z1 - Z
			
			'Print "Local: " + surf.VertexZ(VN) + ":" + surf.VertexX(VN) + ":" + surf.VertexZ(VN)
			
				
			Local D:Float = Sqr(xd * xd + yd * yd + zd * zd)
			
			
			'Print D + " &lt; " + Dist + " : " + I + " : " + Vid
			
			If D &lt; Dist Then 
				Vid = I
				'ID = COunter
				Dist = D
			EndIf
			
		Next
		
		Local v1:Int = surf.TriangleVertex(Vid , 0)
		Local v2:Int = surf.TriangleVertex(Vid , 1) 
		Local v3:Int = surf.TriangleVertex(Vid , 2)
		
		
		TestID = V1
				
		Return PointHeightOnTri(x,z, surf.VertexX(v1),surf.VertexY(v1),surf.VertexZ(v1),surf.VertexX(v2),surf.VertexY(v2),surf.VertexZ(v2),surf.VertexX(v1),surf.VertexY(v3),surf.VertexZ(v3))
	End Method
Function PointHeightOnTri#(px#,pz#, x1#,y1#,z1#,x2#,y2#,z2#,x3#,y3#,z3#)
	Local e#=(x2-x1)*(z3-z1)-(x3-x1)*(z2-z1)
	e=1.0/e
	Local e1#=e*((x2-px)*(z3-pz)-(x3-px)*(z2-pz))
	Local e2#=e*((x3-px)*(z1-pz)-(x1-px)*(z3-pz))
	Local e3#=e*((x1-px)*(z2-pz)-(x2-px)*(z1-pz))
	Return e1*y1+e2*y2+e3*y3
End Function

</textarea><br><br>As you see: the terrain is based an patches (equal to meshes)<br>so if i have found a mesh via the getmesh method (returns definatly the right Mesh) I'm going through all triangles in the surface and compare the dist to the given x ,y and z position. <br>Well I know that the VertexX commands returns local positions <br>and I have taken look to the TForm commands in B3D and added the needed things to the Vertexpositions. <br>Now I would guess that the triangle Id should change in a constant way, if I move across the terrain, but it doesn't. It jumps from one Id to another or stays on one Id a long time, any Ideas how to solve this?<br><br>thx. <br><br></td></tr></table><br>
<a name="704302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alrighty then...<br><br>After banging my head against Left Handed/Right Handed Matrices for a Looong time. I've made some working additions to the TMatrix Class. Just add in these methods:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Method MultiplyVector(I:TVector var, O:TVector Var)
	Local Mt:TMatrix = New TMatrix
	Local tmp:Float[3]
	Local tmp2:Float[3]
	Local itmp3:Float
	mt.LoadIdentity
	mt.Scale(1,1,-1)
	mt.Multiply(Self)
	itmp3 = 1.0 /(I.x*mt.grid[0,3]+I.y*mt.grid[1,3]+I.z*mt.grid[2,3]+mt.grid[3,3])
	tmp[0] = itmp3*I.x
	tmp[1] = itmp3*I.y
	tmp[2] = itmp3*(I.z*-1)
	O.x=tmp[0]*(mt.grid[0,0])+(tmp[1])*(mt.grid[1,0])+tmp[2]*(mt.grid[2,0])+itmp3*(mt.grid[3,0])
	O.y=tmp[0]*(mt.grid[0,1])+(tmp[1])*(mt.grid[1,1])+tmp[2]*(mt.grid[2,1])+itmp3*(mt.grid[3,1])
	O.z=tmp[0]*(mt.grid[0,2])+(tmp[1])*(mt.grid[1,2])+tmp[2]*(mt.grid[2,2])+itmp3*(mt.grid[3,2])
End Method

Method MultiplyNormal(I:TVector var, O:TVector Var)
	Local Mt:TMatrix = New TMatrix
	mt.LoadIdentity
	mt.Scale(1,1,-1)
	mt.Multiply(Self)
	Local tmp:Float[3]
	Local itmp:Float
	tmp[0]=I.x*mt.grid[0,0]+I.y*mt.grid[1,0]+(I.z*-1)*mt.grid[2,0]
	tmp[1]=I.x*mt.grid[0,1]+I.y*mt.grid[1,1]+(I.z*-1)*mt.grid[2,1]
	tmp[2]=I.x*mt.grid[0,2]+I.y*mt.grid[1,2]+(I.z*-1)*mt.grid[2,2]
	itmp=1.0/sqr(tmp[0]*tmp[0]+tmp[1]*tmp[1]+tmp[2]*tmp[2])
	O.x=tmp[0]*itmp
	O.y=tmp[1]*itmp
	O.z=tmp[2]*itmp
End Method
Method Invert:TMatrix() ' Returns an Inverted Matrix
  Local out:TMatrix = New TMatrix
  Adjoint(out)
  Return out
End Method
Method Adjoint( out:TMatrix Var )
  out.grid[0,0]  =   det3x3(grid[1,1], grid[2,1], grid[3,1], grid[1,2], grid[2,2], grid[3,2], grid[1,3], grid[2,3], grid[3,3])
  out.grid[1,0]  = - det3x3(grid[1,0], grid[2,0], grid[3,0], grid[1,2], grid[2,2], grid[3,2], grid[1,3], grid[2,3], grid[3,3])
  out.grid[2,0]  =   det3x3(grid[1,0], grid[2,0], grid[3,0], grid[1,1], grid[2,1], grid[3,1], grid[1,3], grid[2,3], grid[3,3])
  out.grid[3,0]  = - det3x3(grid[1,0], grid[2,0], grid[3,0], grid[1,1], grid[2,1], grid[3,1], grid[1,2], grid[2,2], grid[3,2])

  out.grid[0,1]  = - det3x3( grid[0,1], grid[2,1], grid[3,1], grid[0,2], grid[2,2], grid[3,2], grid[0,3], grid[2,3], grid[3,3])
  out.grid[1,1]  =   det3x3( grid[0,0], grid[2,0], grid[3,0], grid[0,2], grid[2,2], grid[3,2], grid[0,3], grid[2,3], grid[3,3])
  out.grid[2,1]  = - det3x3( grid[0,0], grid[2,0], grid[3,0], grid[0,1], grid[2,1], grid[3,1], grid[0,3], grid[2,3], grid[3,3])
  out.grid[3,1]  =   det3x3( grid[0,0], grid[2,0], grid[3,0], grid[0,1], grid[2,1], grid[3,1], grid[0,2], grid[2,2], grid[3,2])

  out.grid[0,2]  =   det3x3( grid[0,1], grid[1,1], grid[3,1], grid[0,2], grid[1,2], grid[3,2], grid[0,3], grid[1,3], grid[3,3])
  out.grid[1,2]  = - det3x3( grid[0,0], grid[1,0], grid[3,0], grid[0,2], grid[1,2], grid[3,2], grid[0,3], grid[1,3], grid[3,3])
  out.grid[2,2]  =   det3x3( grid[0,0], grid[1,0], grid[3,0], grid[0,1], grid[1,1], grid[3,1], grid[0,3], grid[1,3], grid[3,3])
  out.grid[3,2]  = - det3x3( grid[0,0], grid[1,0], grid[3,0], grid[0,1], grid[1,1], grid[3,1], grid[0,2], grid[1,2], grid[3,2])
  
  out.grid[0,3]  = - det3x3( grid[0,1], grid[1,1], grid[2,1], grid[0,2], grid[1,2], grid[2,2], grid[0,3], grid[1,3], grid[2,3])
  out.grid[1,3]  =   det3x3( grid[0,0], grid[1,0], grid[2,0], grid[0,2], grid[1,2], grid[2,2], grid[0,3], grid[1,3], grid[2,3])
  out.grid[2,3]  = - det3x3( grid[0,0], grid[1,0], grid[2,0], grid[0,1], grid[1,1], grid[2,1], grid[0,3], grid[1,3], grid[2,3])
  out.grid[3,3]  =   det3x3( grid[0,0], grid[1,0], grid[2,0], grid[0,1], grid[1,1], grid[2,1], grid[0,2], grid[1,2], grid[2,2])
EndMethod
Function det3x3!( a1!, a2!, a3!, b1!, b2!, b3!, c1!, c2!, c3! )
  Local ans!
  ans = a1 * det2x2( b2, b3, c2, c3 )
  ans = ans - b1 * det2x2( a2, a3, c2, c3 )
  ans = ans + c1 * det2x2( a2, a3, b2, b3 )
  Return ans
End Function
Function det2x2!( a!, b!, c!, d!)
  Return a*d-b*c
End Function
</textarea><br><br>This will allow you to convert normals and vectors by an arbitrary matrix and to invert the matrix to do the opposite. <br><br></td></tr></table><br>
<a name="704304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> Example Program using the above to track the movement and rotation of a cube, shown by spheres.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' Based on code by Birdie and Peter Scheutz

Import "../MiniB3D.bmx"

SetGraphicsDriver GLGraphicsDriver(),GRAPHICS_BACKBUFFER|GRAPHICS_DEPTHBUFFER

Global ax#, ay#,tim#

Local w:TGadget = CreateWindow("MiniB3D in a GUI window", 10, 10, 512, 512 )

Local c:TGadget = CreateCanvas(0,0,ClientWidth(w),ClientHeight(w),w,0)
SetGadgetLayout c,1,1,1,1

TGlobal.width = ClientWidth(w)
TGlobal.height = ClientHeight(w)

TGlobal.depth=16
TGlobal.mode=0
TGlobal.rate=60

SetGraphics CanvasGraphics( c )
ActivateGadget c
TGlobal.GraphicsInit()

Local cam:TCamera=CreateCamera()
PositionEntity cam,0,0,-10

Local light:TLight=CreateLight(1)

Local tex:TTexture=LoadTexture("media/test.png")

Local cube:TMesh=CreateCube()
Local sphere:TMesh=CreateSphere()
Local Cone:TMesh = CreateSphere()
Local Cube2:TMesh = Createsphere()

PositionEntity cube,0,0,0
PositionEntity sphere,0,0,0
PositionEntity Cone,0,0,0
PositionEntity Cube2,0,0,0

EntityTexture cube,tex
EntityTexture sphere,tex
EntityColor cone,255,0,0
EntityColor Cube2,0,255,0

Local cx#=0
Local cy#=0
Local cz#=0
Local tog

Local pitch#=0
Local yaw#=0
Local roll#=0

' used by fps code
Local old_ms:Int=MilliSecs()
Local renders:Int
Local fps:Int

Local up_key:Int
Local down_key:Int
Local left_key:Int
Local right_key:Int

CreateTimer( 60 )
camerazoom cam,3
While True

	WaitEvent()

	Select EventID()

		Case EVENT_KEYDOWN
		
			Select EventData()
				Case KEY_ESCAPE
					End
				Case KEY_UP
					up_key = True
				Case KEY_DOWN
					down_key = True			
				Case KEY_LEFT
					left_key = True
				Case KEY_RIGHT
					right_key = True	
				Case KEY_A
					A_KEY = True
				Case KEY_Z
					z_KEY = True		
			EndSelect
			
		Case EVENT_KEYUP
		
			Select EventData()
				Case KEY_UP
					up_key = False
				Case KEY_DOWN
					down_key = False			
				Case KEY_LEFT
					left_key = False
				Case KEY_RIGHT
					right_key = False
				Case KEY_A
					A_KEY = False
				Case KEY_Z
					z_KEY = False		
			EndSelect

		Case EVENT_WINDOWCLOSE
		
            End

		Case EVENT_WINDOWSIZE
		
			TGlobal.width = ClientWidth(w)
			TGlobal.height = ClientHeight(w)

			cam.CameraViewport(0,0,ClientWidth(w),ClientHeight(w))
							
			DebugLog "EVENT_WINDOWSIZE" 

		Case EVENT_TIMERTICK

			If up_key Then cy#=cy#+0.1
			If left_key Then cx#=cx#-0.1
			If right_key Then cx#=cx#+0.1
			If down_key Then cy#=cy#-0.1
			
			If a_key Then cz#=cz#+0.1
			If z_key Then cz#=cz#-0.1

			positionentity cube,cx#,cy#,cz#
			RotateEntity cam,pitch#,yaw#,roll#
			
			RedrawGadget c
              
		Case EVENT_GADGETPAINT
			
			SetGraphics CanvasGraphics( c )

			TurnEntity cube,1,1,1
			
			Local Inv:TMatrix 
		
			Local Vec1:TVector = New TVector
			Local Vec2:TVector = New TVector
			Local Vec3:TVector = New TVector
		
			Vec1.z = -2 ; vec1.y = 0 ; vec1.x = 0
			Vec2.z = 0 ; vec2.y = 2 ; vec2.x = 0
			Vec3.z = 0 ; vec3.y = 0 ; vec3.x = 2
		
			Cube.mat.MultiplyVector(Vec1,vec1)
			Cube.mat.MultiplyVector(Vec2,vec2)
			Cube.mat.MultiplyVector(Vec3,vec3)

			'Inv = Cube.mat.Invert()			

			'inv.MultiplyVector(Vec1,vec1)
			'inv.MultiplyVector(Vec2,vec2)
			'inv.MultiplyVector(Vec3,vec3)
					
			positionentity sphere,vec1.x,vec1.y,vec1.z
			positionentity cone,vec2.x,vec2.y,vec2.z
			positionentity cube2,vec3.x,vec3.y,vec3.z

			RenderWorld
			Flip True
	EndSelect
Wend
</textarea><br><br>Looks like this:<br><img src="http://web.bethere.co.uk/terabit//mb3d1.jpg"> <br><br></td></tr></table><br>
<a name="704331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The Caffeine Kid</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> Amazing work everyone - this is truly the best BlitzMax community project anyone could ask for. I wish I had the 3d and math knowledge to contribute. You guys rock. :) <br><br></td></tr></table><br>
<a name="704401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to let you know, I will probably opt against adding stuff like terrain systems, shader systems, bsps, md2s etc to the main release of MiniB3D. While the support and interest that MiniB3D is gained is quite overwhelming, there a couple of things which I need to make clear:<br><br>* While I am a member of BRL I cannot allow MiniB3D to become a conflict of interest with either B3D or Max3D, and therefore MiniB3D will remain exactly that - a lightweight version of B3D without all the bells and whistles. There are a few commands left that I wish to add (most of which will be forthcoming in the next release), but after than, I will consider MiniB3D to be pretty much 'done' (bar optimisations and bug fixes).<br><br>* MiniB3D is being written so that I can convert Super Gerball to the Mac. MiniB3D does not make me any money, Super Gerball does. Therefore really I cannot afford to devote more time to MiniB3D than is necessary, and while I would dearly like to spend all day attending to support issues and managing all the different author contributions, unfortunately my day job and other commitments dictate that I can't.<br><br>I hope you understand. Just felt the need to post this as I felt MiniB3D was spiralling out of control somewhat, and I haven't really got the time to contribute to this thread or project as much as I would like. I can promise though that I will continue to support and maintain MiniB3D as much as I can - my own game projects depend on it (at least until Mark releases his own GL B3D), so it won't be abandoned anytime soon.<br><br>Of course, people are still free to release their own add-ons and libs, so hopefully this won't affect anything too much. I just wanted to clarify that MiniB3D itself will not be developed much further. <br><br></td></tr></table><br>
<a name="704409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> ouch must be Blitz Research slapped your hand :(<br><br>well I hope as a community we will keep this going strong. <br><br></td></tr></table><br>
<a name="704414"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't see any conflict with Max3D. Max3D isn't targeted at the same market.<br><br>Nor is Blitz3D as it bases on an API not fully supported anymore by current graphic card drivers. (I'm getting more and more confusing issues on NV side).<br><br>but yes, I understand that you have a real life, like we all do have it :-)<br>But after all, it would be sad if the only BM based 3D engine would die, so I hope you won't go against people creating addon modules/sources for it to extend its possibilities. <br><br></td></tr></table><br>
<a name="704431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> SimonH;<br>Perhaps, when you feel MiniB3D to be as complete as you want it to be, post it as a community project?<br>I think all the effort you put into it could be a very good base for others to expand on.. :) <br><br></td></tr></table><br>
<a name="704445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> From Mark's Worklog:<br><div class="quote"> I am also designing Max3D with older hardware somewhat in mind, but any such version - if it ever actually happens - will have *less* capabilities than Blitz3D. Which oddly enough increases the chance of a GL Blitz3D happening one day - unless Si H's MiniB3D gets there first! <br> <br></div><br><br>In all honesty, most of the Blitz community are waiting for Max3D before they start any real serious 3D work <i>(I am).</i> I already wrote a Mini 3D Engine that does some very similar things, but is certainly not as well/clearly written as MiniB3D (in my defence, I wrote it purely as a learning experience :)<br><br>I think that to get the most out of Max3D, it is good to play about with other Blitz written engines. Not only is it a good learning experience, It also helps us to see how <b>these things are not trivial to write!</b> <br><br>When Max3D does get out there, we'll see it for the cool stuff it's going to be. That's been my motivation for chipping in. It wouldn't occur to me to think that any 3D Engine I am likely to write/contribute to could be competing with Max3D. <br><br></td></tr></table><br>
<a name="704501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> Max3D is cutting edge.  B3D is old.<br><br>Both are very good things to be, for completely different reasons.  There is no competition whatsoever with each other from what I can tell.<br><br>When MiniB3D reaches 'complete' as far as you're concerned simon...  I think it would be a very wise idea for either you to create a Sourceforge page and hand control over to someone else, or BRL to take it up and offer it alongside Max3D. <br><br></td></tr></table><br>
<a name="704538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xMicky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> If BRL would be so kind to recognize the overwhelming resonance to MiniB3D (to me its more attractive than the announced Max3D stuff) - why don't they make it fully and officially to a product of them ? Should this not be possible with a product started by one members of their team ?? They might call it "Blitz 3D Next Generation" and I gladly would pay some money for it, if its Version 1.0 supports 2D graphics too. <br><br></td></tr></table><br>
<a name="704541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matthew Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't use the 3d side of things myself, but certainly the benefit of this project is getting existing Blitz3d projects into BlitzMax (almost better than a code converter tool). <br><br>I would not have thought it should/would be seen as a conflict to continue the module as it's a great way to bring people over to BlitzMax! <br><br>Much in the same way you might convert VB6 into VB.Net, in the end you will (eventually) either re-write it to take advantage of new features/functionality in the advanced product or start your new projects in BlitzMax.<br><br>Simon has done a great job and should be congratulated!! <br><br></td></tr></table><br>
<a name="704553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Just to let you know, I will probably opt against adding stuff like terrain systems, shader systems, bsps, md2s etc to the main release of MiniB3D. <br></div><br><br>Sounds perfect. My intrest is in a "low end" 3D Engine, and MiniB3D fits the bill perfectly. I think the main thing to add is <a href="/posts.php?topic=62684#700962" target="_blank">hardware checks</a> and switches, that'll let it run on low end GFX cards. This  is one of the true strenghs of the Blitz3D engine.<br><br>I'm really hoping that the any addition of shaders and such, *if they are made*, will be made as optional modules or at least as features that can be turned on and off. <br><br>There is also the possibillity to fork the project into a lowend and a highend version. Personally I think that if you want a high end 3D engine, you should go with one of the existing ones or wait for Max3D, but that's just me... ;)<br><br>PS: Thanks Terrabit, that matrix stuff works ace!<br><br>PPS: I have deployed a BMax OpenGL application on a number of lowend computers last year, and it is went rather well: 9 out of 10 would run the basic stuff though some did need a  GFX card driver update. <br><br></td></tr></table><br>
<a name="704644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see why this isn't bundle with the BlitzMax install. I see MiniB3D as an advantage to Max not as compatition to B3D. BRL should actively encourage Simon to complete it. But whatever happens I don't think the project should stray from it's original goal of working exactly as B3D does. I feel it's this clearly defined goal that has kept, and will keep, the project on track. If everyone is pulling in the same direction we'll get there quicker. <br><br></td></tr></table><br>
<a name="704675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think that anyone is planning to change the way the core is working, even in cases where B3D worked against a usefull behavior that then had to be faked again. <br><br></td></tr></table><br>
<a name="704781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ouch must be Blitz Research slapped your hand :( <br></div><br>Not at all - in fact the opposite. Mark has helped with various things and gave his full support to the public release. The decision on how far to take MiniB3D is mine alone.<br><br><div class="quote"> Don't see any conflict with Max3D. Max3D isn't targeted at the same market. <br></div><br>It doesn't conflict at the moment, if however shaders and particle systems were added to MiniB3D, then it starts edging into Max3D territory.<br><br><div class="quote"> Nor is Blitz3D <br></div><br>If MiniB3D has more and more features added to it, then MiniB3D becomes MassiveB3D, and Blitz3D becomes MiniBlitz3D. Do you see?<br><br><div class="quote"> But after all, it would be sad if the only BM based 3D engine would die <br></div><br>It wouldn't die, it would be finished - nothing more to add to it.<br><br><div class="quote"> Sounds perfect. My intrest is in a "low end" 3D Engine, and MiniB3D fits the bill perfectly. I think the main thing to add is hardware checks and switches, that'll let it run on low end GFX cards <br></div><br>At last, someone on the same wavelength as me. <br><br></td></tr></table><br>
<a name="704790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree with simons decision. After all, we got the source so we can add specific features we need.<br><br>We just need those picking/collision funcs :) <br><br></td></tr></table><br>
<a name="704984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree MiniB3D should not add any more than what B3D has, but I think everything simon gave examples of<br><div class="quote"> I will probably opt against adding stuff like terrain systems, shader systems, bsps, md2s etc to the main release of MiniB3D. <br></div><br>with the exception of shaders, should eventually see it in by somebody... <br><br></td></tr></table><br>
<a name="705102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I have written, I'm having Shaders already build in with MiniB3D, I'm not really satisfied how it is currently build into the engine so I have some Questions. Currently the Shader is build in TBrush, but this I have found out isn't a good solution because it is hard to handle if there is no shader, and you want just use standard textures. So I ask you what do you think of this idea:<br><br>I will start a TShader type which has a second set of textures <br>applied to itself. This Shader Type will be handled like TBrush without the whole blend modes etc. . And in the Program you only have to assign the textures used by the shader to the TShader class and could keep the TBrush as a Fallback, if there is no Shader available.<br><br>PS: I completely understand you Simon. I think addons could be handled like usermade libs for B3D, so you everyone is able to choose self what he wants in MiniB3D. So thx for this great expandable Engine. <br><br></td></tr></table><br>
<a name="705105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldn't a TShader as an extended TBrush make more sense, at least from the point of handling it as an addon to MiniB3D?<br>I don't know how you actually integrated it so this could be an extremely worse idea as well.<br>Just seemed like a good idea to me as you can change the default brush behavior to fit your shader behavior without needing to change / break with other stuff. <br><br></td></tr></table><br>
<a name="706904"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smokey</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>First time I hear about minib3d<br><br>seem nice, I wonder why not add feature close to blitz3d<br>since I own B3D the only avantage would be speed probaly and have hability to compile to other platform, I wonder if Blitz Research today still make money of blitz3d since most of people here wait for max3d, for my point I will never get back to b3d because bmax offer much more possibility that Blitzbasic don't have.<br><br>by the way great work simon. :) <br><br></td></tr></table><br>
<a name="707119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JonasL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just downloaded 0.27. Is it just me or did CopyMesh() get broken? My code works just fine in 0.26, but in 0.27 the copied mesh is inside out. <br><br></td></tr></table><br>
<a name="707128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> dear simonh,<br><br>can you please add a collision detection routine.<br><br>I don't know how to add a collision sytem like linepick. <br><br>But, i have found a doc about sphere tree collision detection<br><br>the url of the topic is <br><a href="http://isg.cs.tcd.ie/spheretree/#examples" target="_blank">http://isg.cs.tcd.ie/spheretree/#examples</a><br><br><br>I'm starting a building spheretree, but the first step is hard<br><br>update the value of the to constant :<br>LE_MESH is the path of your mesh<br>LA_PROFONDEUR is the deep of the spheretree.<br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' =================
' Author patmaba
' patmaba@...
' =================

SuperStrict 
Import "MiniB3D.bmx"
Import "3DMathLib20.bmx"

Const LE_MESH:String = "media\batfighter\Batfighter.b3d"
'Const LE_MESH:String = "media\navette.b3d"
'Const LE_MESH:String = "media\patmaba.b3d"
'Profondeur toujours &gt;=  1
Const LA_PROFONDEUR:Int = 4

' -----------------------
' Variable(s) globale(s)
' -----------------------
Global cam:TCamera
Global D:TMesh
Global Light1:TLight
Global m:TMesh
Global gi_CubeSize:Float = 0.0

'------------------------
'Freelook cam Var
'------------------------
Global Mouse_X_Speed:Float 
Global Mouse_Y_Speed:Float 
Global Camera_VelX:Float 
Global Camera_VelZ:Float 
Global Camera_Pitch:Float 
Global Camera_Yaw:Float 
Global oldmx:Int 
Global oldmy:Int


Const AppFPS:Int = 50
Global FramePeriod:Int = 1000 / AppFPS
Global FrameTime:Int = MilliSecs () - FramePeriod
Global FrameElapsed:Int 
Global FrameTicks:Int 
Global FrameTween:Float 

' ---------------
' Init la scene
' ---------------
InitScene()


' ---------------
' Init les Agents
' ---------------
InitOctree()


' -------------------------------------
' Variables pour la gestion du fps
' -------------------------------------
Local old_ms:Int=MilliSecs()
Local renders:Int
Local fps:Int 

Global countbox:Int=0

Repeat
	' --------------------------
	' Frame rate limiting
	' --------------------------
	Repeat
		FrameElapsed = MilliSecs () - FrameTime
	Until FrameElapsed

	FrameTicks = FrameElapsed / FramePeriod
	FrameTween:Float = Float (FrameElapsed mod FramePeriod) / Float (FramePeriod)

	' -----------------------
	' Update tweening
	' -----------------------
	For Local FrameLimit:Int = 1 To FrameTicks

		FrameTime = FrameTime + FramePeriod
		
		UpdateGame ()
		UpdateWorld
	Next

	' -------------------
	' Redraw world
	' -------------------
	RenderWorld 
	
	' ---------------------
	' Text
	' ---------------------
	
	cube( -MeshWidth(m)/2,MeshWidth(m)/2,-MeshHeight(m)/2, MeshHeight(m)/2,-MeshDepth(m)/2,MeshDepth(m)/2)
	Flip False	
Until KeyHit (KEY_ESCAPE)


Function UpdateGame()
	Proc_Freelook(1.03,0.03)		
	PointEntity cam, m	
EndFunction 



' ---------------------------------
' InitScene() 
' Description de la scene 
' ---------------------------------
Function InitScene()
	Graphics3D 800,600,32,0

	' -------------------------------------
	' Setup camera 
	' -------------------------------------
	cam=CreateCamera()
	PositionEntity cam,-11,70,-125
	CameraRange cam,1,250000
	CameraZoom cam,0.9

	' -------------------------------------
	' Setup Light and ambiance
	' -------------------------------------
	Light1=CreateLight(2)
	PositionEntity Light1,-1630,1630,1630
	LightColor Light1,155,220,255
	LightRange Light1,5500


EndFunction 



' ---------------------------------
' InitOctree() 
' Calcul la taille de mon octree sur base du mache augmentй 
' de 15%( * 1.15)
' ---------------------------------
Function InitOctree()
	m:TMesh = LoadMesh(LE_MESH)		
	gi_CubeSize = 0.0
	
	gi_CubeSize = MeshWidth( m )	
	If gi_CubeSize &lt; MeshHeight( m ) Then gi_CubeSize = MeshHeight( m )
	If gi_CubeSize &lt; MeshDepth( m ) Then gi_CubeSize = MeshDepth( m )	
	gi_CubeSize = gi_CubeSize * 1.15
	
	PositionEntity cam,-gi_CubeSize /2,gi_CubeSize /2,-gi_CubeSize /2
	PointEntity cam, m
	
	dessine_octree()		

	DebugLog "countbox="+countbox
End Function 



'------------------------
'Camera freelook
'------------------------
Function Proc_Freelook(Velocity:Float,Speed:Float)
	Local flag:Int=False 
	
	Mouse_X_Speed=(MouseXSpeed())*0.5
	Mouse_Y_Speed=(MouseYSpeed())*0.5

	MoveMouse GraphicsWidth()/2,GraphicsHeight()/2
	Camera_Pitch=Camera_Pitch+Mouse_Y_Speed
	Camera_Yaw=Camera_Yaw+Mouse_X_Speed

	If flag=True
		RotateEntity cam,Camera_Pitch,-Camera_Yaw,0
	EndIf 
	
	If KeyDown(KEY_LEFT) Then
		Camera_VelX=Camera_VelX-Speed
	ElseIf  KeyDown(KEY_RIGHT)
		Camera_VelX=Camera_VelX+Speed
	EndIf
	
	If KeyDown(KEY_DOWN) Then
		Camera_VelZ=Camera_VelZ-Speed
	ElseIf  KeyDown(KEY_UP)
		Camera_VelZ=Camera_VelZ+Speed
	EndIf
 
	Camera_VelX=Camera_VelX/Velocity
	Camera_VelZ=Camera_VelZ/Velocity
	MoveEntity cam,Camera_VelX,0,Camera_VelZ

	If KeyDown(KEY_UP) Then
		MoveEntity cam,0,0,Speed
	EndIf

	If KeyDown(KEY_DOWN) Then
		MoveEntity cam,0,0,-Speed
	EndIf

	If KeyDown(KEY_RIGHT) Then
		MoveEntity cam,Speed,0,0
	EndIf

	If KeyDown(KEY_LEFT) Then
		MoveEntity cam,-Speed,0,0
	EndIf
End Function

Function MouseXSpeed:Int()
	Local mxs:Int=MouseX()-oldmx
	oldmx=MouseX()
	Return mxs
End Function

Function MouseYSpeed:Int()
	Local mys:Int=MouseY()-oldmy
	oldmy=MouseY()
	Return mys
End Function


'------------------------
'dessine un cube en mode de file de fer
'------------------------
Function cube (x0:Float, x1:Float, y0:Float, y1:Float, z0:Float, z1:Float)
	glBegin (GL_LINE_STRIP);

	glVertex3f (x0, y0, z0);
	glVertex3f (x1, y0, z0);
	glVertex3f (x1, y1, z0);
	glVertex3f (x0, y1, z0);
	glVertex3f (x0, y0, z0);
	glVertex3f (x0, y0, z1);
	glVertex3f (x1, y0, z1);
	glVertex3f (x1, y0, z0);
	glVertex3f (x1, y0, z1);
	glVertex3f (x1, y1, z1);
	glVertex3f (x1, y1, z0);
	glVertex3f (x1, y1, z1);
	glVertex3f (x0, y1, z1);
	glVertex3f (x0, y1, z0);
	glVertex3f (x0, y1, z1);
	glVertex3f (x0, y0, z1);

	glEnd ();

EndFunction 

' dessine l'octree recursivement
Function dessine_8_cubes (lxmin:Float, lxmax:Float, lymin:Float, lymax:Float, lzmin:Float, lzmax:Float, pMaxLevel:Int, pCurrentLevel:Int, the_list:TList)

	Local lb_val:Int
	Local l_vsomme:Vector = Vector.Create()
	Local l_vmin:Vector = Vector.Create()
	Local l_vmax:Vector = Vector.Create()
	
	'lb_val:Int = Point_Inside_Box(m, lxmin, lxmax, lymin, lymax, lzmin, lzmax )
	Local my_list:TList = Point_Inside_List(lxmin, lxmax, lymin, lymax, lzmin, lzmax, the_list )
	
	If my_list.count() = 0
		lb_val = False
	Else 	
		lb_val = True
	EndIf 
	' si on est un noeud terminal on s'arrete 
	If (pMaxLevel=pCurrentLevel) 'and ( lb_val = True)

		l_vsomme.Set(0,0,0)
		DebugLog "pCurrentLevel="+pCurrentLevel
		For Local L:TVertexInfo = EachIn my_list
			Local Surface_Handle:TSurface = GetSurface(m, L.SurfIndex)
			Local vx:Float = VertexX#(Surface_Handle, L.VertIndex)			
			Local vy:Float = VertexY#(Surface_Handle, L.VertIndex)			
			Local vz:Float = VertexZ#(Surface_Handle, L.VertIndex)				

			l_vsomme.x = l_vsomme.x + vx 
			l_vsomme.y = l_vsomme.y + vy 
			l_vsomme.z = l_vsomme.z + vz 
			
			If vx &lt; l_vmin.x Then l_vmin.x = vx
			If vy &lt; l_vmin.y Then l_vmin.y = vy			
			If vz &lt; l_vmin.z Then l_vmin.z = vz						
			If vx &gt; l_vmax.x Then l_vmax.x = vx
			If vy &gt; l_vmax.y Then l_vmax.y = vy			
			If vz &gt; l_vmax.z Then l_vmax.z = vz						
			'DebugLog "&lt;" + vx + "," + vy + "," + vz + "&gt;"
		Next 
		l_vsomme.DivS(my_list.count())				

'       Vieu code pour un sphere tree       
'
'		Local c:TMesh = CreateCube()		
'		EntityAlpha c, 0.4
'		PositionEntity c, (lxmin + lxmax) / 2,(lymin + lymax) / 2,(lzmin + lzmax) / 2
'		ScaleEntity c, 1/MeshWidth(c)*(lxmax-lxmin),  1/MeshHeight(c)*(lymax-lymin), 1/MeshDepth(c)*(lzmax-lzmin)		

'		Local s:TMesh = CreateSphere()		
'		EntityAlpha s, 0.4

		Local px:Float=( (l_vmin.x + l_vmax.x) / 2 )
		Local py:Float=( (l_vmin.y + l_vmax.y) / 2 )
		Local pz:Float=( (l_vmin.z + l_vmax.z) / 2 )

		'PositionEntity s, (lxmin + lxmax) / 2,(lymin + lymax) / 2,(lzmin + lzmax) / 2
'		PositionEntity s, px,py,pz
		
		Local l_rayon:Float = (l_vmin.Magnitude() + l_vmax.Magnitude())/2
		Local si:TSphereInfo = TSphereInfo.Create(px, py, pz, l_rayon)
		countbox=countbox+1
		Return
	EndIf 
	
	If lb_val= True and lb_val
	' on rappelle rcursivement pour les 8 fils
	dessine_8_cubes (lxmin, (lxmin + lxmax) / 2, lymin, (lymin + lymax) / 2, lzmin, (lzmin + lzmax) / 2, pMaxLevel, pCurrentLevel + 1, my_list )
	dessine_8_cubes (lxmin, (lxmin + lxmax) / 2, lymin, (lymin + lymax) / 2, (lzmin + lzmax) / 2, lzmax, pMaxLevel, pCurrentLevel + 1, my_list )

	dessine_8_cubes (lxmin, (lxmin + lxmax) / 2, (lymin + lymax) / 2, lymax, lzmin, (lzmin + lzmax) / 2, pMaxLevel, pCurrentLevel + 1, my_list )
	dessine_8_cubes (lxmin, (lxmin + lxmax) / 2, (lymin + lymax) / 2, lymax, (lzmin + lzmax) / 2, lzmax, pMaxLevel, pCurrentLevel + 1, my_list )

	dessine_8_cubes ((lxmin + lxmax) / 2, lxmax, lymin, (lymin + lymax) / 2, lzmin, (lzmin + lzmax) / 2, pMaxLevel, pCurrentLevel + 1, my_list )
	dessine_8_cubes ((lxmin + lxmax) / 2, lxmax, lymin, (lymin + lymax) / 2, (lzmin + lzmax) / 2, lzmax, pMaxLevel, pCurrentLevel + 1, my_list )

	dessine_8_cubes ((lxmin + lxmax) / 2, lxmax, (lymin + lymax) / 2, lymax, lzmin, (lzmin + lzmax) / 2, pMaxLevel, pCurrentLevel + 1, my_list )
	dessine_8_cubes ((lxmin + lxmax) / 2, lxmax, (lymin + lymax) / 2, lymax, (lzmin + lzmax) / 2, lzmax, pMaxLevel, pCurrentLevel + 1, my_list )
	EndIf 
EndFunction 



Function dessine_octree ()
	Local my_list:TList 
	my_list = New TList
	
	glDisable (GL_TEXTURE_2D);
	glColor3ub (50, 255, 50);
	my_list = GetPointIntoList(m)
	dessine_8_cubes (-(gi_CubeSize/2), (gi_CubeSize/2), -(gi_CubeSize/2), (gi_CubeSize/2), -(gi_CubeSize/2), (gi_CubeSize/2),LA_PROFONDEUR, 1, my_list)	
	glColor3ub (255, 255, 255);
	glEnable (GL_TEXTURE_2D);
	
	TSphereInfo.p_delSphereIntoSphere()
	DebugLog "Nombre de sphere :" + TSphereInfo.TAllList.count()
EndFunction



Type TVertexInfo
	Field SurfIndex:Int
	Field VertIndex:Int
EndType 



Function GetPointIntoList:TList(ThisEntity:TMesh )		

	' Calculate the bounding box (in Object space) For this Object.
	' You can precalculate this For every Object in your game For a huge speed increase!
	Local Surfaces:Int = CountSurfaces(ThisEntity)
	Local my_list:TList = New TList
	Local t:Int=0
	For Local LOOP_Surface:Int = 1 To Surfaces
		Local Surface_Handle:TSurface = GetSurface(ThisEntity, LOOP_Surface)	
		Local Verts:Int = CountVertices(Surface_Handle) - 1
		For Local LOOP_Verts:Int = 0 To Verts-1			
			Local my_vi:TVertexInfo = New TVertexInfo
			my_vi.SurfIndex = LOOP_Surface
			my_vi.VertIndex = Loop_Verts
			my_list.AddLast my_vi
		Next
	Next
		
	Return my_list
EndFunction



Function Point_Inside_List:TList( min_x:Float, max_x:Float, min_y:Float, max_y:Float, min_z:Float, max_z:Float, thelist:TList )		
	
	Local my_list:TList = New TList	

	For Local L:TVertexInfo = EachIn thelist
		Local Surface_Handle:TSurface = GetSurface(m, L.SurfIndex)
		Local vx:Float = VertexX#(Surface_Handle, L.VertIndex)			
		Local vy:Float = VertexY#(Surface_Handle, L.VertIndex)			
		Local Vz:Float = VertexZ#(Surface_Handle, L.VertIndex)				

		' Determine If the point (in Object space) is inside the bounding box (in Object space).
		If (vx# &gt; min_x#) and (vx# &lt; max_x#) and (vy# &gt; min_y#) and (vy# &lt; max_y#) and (Vz# &gt; min_z#) and (vz# &lt; max_z#)				
			Local my_vi:TVertexInfo = New TVertexInfo
			my_vi.SurfIndex = L.SurfIndex
			my_vi.VertIndex = L.VertIndex
			my_list.AddLast my_vi
		EndIf 
	Next 
	
	Return my_list
EndFunction



Type TSphereInfo
	Field Entity:TMesh
	Field vPos:Vector
	Field rayon:Float

	' ---------------------------------
	' Creation d'une liste pour le type
	' ---------------------------------
	Global TAllList:TList

	Method New ()
       	If TAllList = Null Then TAllList = New TList
       	TAllList.AddLast Self
    EndMethod 

	Function Create:TSphereInfo(px:Float, py:Float, pz:Float, pr:Float)
		Local S:TSphereInfo = New TSphereInfo
		
		S.vPos = Vector.Create()
		S.vPos.Set( px, py, pz )
			
		S.Entity = CreateSphere(8)	  
		EntityAlpha S.Entity, 0.7	
		S.rayon = pr
		PositionEntity S.Entity, px,py,pz
		ScaleEntity S.Entity, 1/MeshWidth(S.Entity)*(pr),  1/MeshHeight(S.Entity)*(pr), 1/MeshDepth(S.Entity)*(pr)			
		Return S
	End Function

	Function p_delSphereIntoSphere()
		For Local S1:TSphereInfo = EachIn TAllList
			For Local S2:TSphereInfo = EachIn TAllList			
				If S1.Entity &lt;&gt; S2.Entity
					Local m:Float 
					m = (S2.vPos.x - S1.vPos.x)^2+(S2.vPos.y - S1.vPos.y)^2+(S2.vPos.z - S1.vPos.z)^2
					If m &gt; (S1.rayon + S2.rayon)^2
						FreeEntity S2.Entity
						TAllList.Remove S2
					End If
				End If
			Next
		Next
	EndFunction
EndType
</textarea> <br><br></td></tr></table><br>
<a name="707130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note 3DMathLib20.bmx us in the import command is <br>the  3D Math Library v2.0 from Chroma.<br><br>You can find the bmx file on code archive section. <br><br></td></tr></table><br>
<a name="707147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> here's sphere collision <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=63073" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=63073</a><br><br>if that helps? <br><br></td></tr></table><br>
<a name="707327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> *cough* *codebox* *cough* <br><br></td></tr></table><br>
<a name="707989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think its a brilliant system on its own merits, it certainly shows what BlitzMax is capable of. <br><br></td></tr></table><br>
<a name="708044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is the next version close to a release? It's quite usable as it is but some bugs makes things a bit complicated to do sometimes. <br><br></td></tr></table><br>
<a name="708175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not to put your Minib3d Library on <a href="http://sourceforge.net/" target="_blank">http://sourceforge.net/</a><br><br>It's an idea <br><br></td></tr></table><br>
<a name="708229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> New version will be out in a few days. <br><br></td></tr></table><br>
<a name="708670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> good news <br><br></td></tr></table><br>
<a name="709299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JonasL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, good news! I don't think anyone has confirmed or denied if CopyMesh() is broken in v 0.27. My copied models are suddenly turned inside out! Anyway, is that fixed in the new version or is it just me? <br><br></td></tr></table><br>
<a name="709500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#114">[#114]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, to fix that you need to reverse the vertex order in one of the AddTriangle commands in AddMesh. From v2, v1, v0 to v0, v1, v2. <br><br></td></tr></table><br>
<a name="709994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >patmaba</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#115">[#115]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simonh, In your next version of MiniB3D do you provide a linepick and collisions function like B3d ? <br><br></td></tr></table><br>
<a name="710088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#116">[#116]</a></td></tr></table></td></tr><tr ><td class="posttext"> This has probably been solved, and I really wish I wasn't at risk of asking this a 2nd or 3rd time, but, alas...<br>I'll make a deal: When I learn this, I will try to round up some other information and add it to a MiniB3d FAQ at BlitzWiki.org.<br><br>I am trying to use MiniB3d with a simple but amazing LUA-utilizing thing, but to do so I need to know this:<br>How can I cast TMesh (or TEntity, I guess) to a Double or an Int? <br><br></td></tr></table><br>
<a name="710153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#117">[#117]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Pickle - HandleFromObject/HandleToObject.  keep in mind you must Release the handle when you are done with it as it increments the reference counter. <br><br></td></tr></table><br>
<a name="710208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#118">[#118]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Simonh, In your next version of MiniB3D do you provide a linepick and collisions function like B3d <br></div><br>All the picking functions are in, no collision functions yet though. I'll probably add some basic sphere-&gt;poly collision stuff in the release after next. <br><br></td></tr></table><br>
<a name="712285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DannyD</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#119">[#119]</a></td></tr></table></td></tr><tr ><td class="posttext"> Getting a few errors in some but not all the examples in the tests folder on Mac os X<br><pre class=code>
Building KBSplines
Compiling:MiniB3D.bmx
flat assembler  version 1.66
4 passes, 0.3 seconds, 701432 bytes.
Compiling:KBSplines.bmx
Compile Error: Type 'TBBType' not found
[C:/Documents and Settings/xxx/Desktop/Drop/MiniB3D-v027/MiniB3D-v027/tests/KBSplines.bmx;16;1]
Build Error: failed to compile C:/Documents and Settings/xxx/Desktop/Drop/MiniB3D-v027/MiniB3D-v027/tests/KBSplines.bmx
Process complete</pre> Any ideas? <br><br></td></tr></table><br>
<a name="712633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >simonh</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#120">[#120]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=63844" target="_blank">Thread 4</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
