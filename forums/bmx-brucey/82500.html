<!DOCTYPE html><html lang="en" ><head ><title >Max2D in CEGUI Control</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Max2D in CEGUI Control</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >Max2D in CEGUI Control</a><br><br>
<a name="930567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Retimer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How would I go about drawing within a control?<br><br>I have tried subscribing events to <u>TCEFrameWindow::</u> <b>EventRenderingEnded</b> and <b>EventRenderingStarted</b>, where I would attempt drawing a red square, but that was no good.<br><br>I assume there is a way to do this, and that i'm trying it the wrong way.<br><br>I understand I could call draw commands after calling <b>TCESystem.renderGUI()</b>, but then render ordering and advanced partial rendering would have to come into place with windows/controls overtop, which would kind of require more work than I think necessary.<br><br>I'm basically looking for an event that is called 'right' after it renders the control (not including the controls within that control) so I can draw stuff ontop of it, so controls within it will render over what I draw.<br><br>Hoping you understand what i'm getting at.<br><br>*bashes head on wall for having a speech impediment when it comes to technical terms* <br><br></td></tr></table><br>
<a name="935695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know one of my level editor feature (the tile selector) need to update a staticImage CEGUI object.<br><br>It's a bit related to this problem.<br>I know that CEGUI is using accelerated image to draw everything.<br>So as my driver is openGL I'm wondering if it's possible to get direct access to one of the memory staticImage used by CEGUI in order to draw inside.<br><br>I will probably ask this in the CEGUI forum too but there is clearly a BlitzMax step to achieve this.<br><br>You'll probably have to play with ImagesetManager class<br><a href="http://www.cegui.org.uk/api_reference/classCEGUI_1_1ImagesetManager.html" target="_blank">http://www.cegui.org.uk/api_reference/classCEGUI_1_1ImagesetManager.html</a><br><br>And the imageSet Class<br><a href="http://www.cegui.org.uk/api_reference/classCEGUI_1_1Imageset.html" target="_blank">http://www.cegui.org.uk/api_reference/classCEGUI_1_1Imageset.html</a><br><br>Could you help us on this Brucey ?? <br><br></td></tr></table><br>
<a name="935701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I know that CEGUI is using accelerated image to draw everything. <br></div><br>Isn't everything cached, so that it only "redraws" when required? <br><br></td></tr></table><br>
<a name="935702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can access a Texture directly... but I don't know if this is what you really want to be doing ;-) <br><br></td></tr></table><br>
<a name="935706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> In fact I would like to be able to draw a BlitzMax TImage onto a CEGUI Window (more precisely a StaticImage).<br><br>This TImage will be created at runtime so maybe it's possible to create a runtime StaticImage from my TImage but I'll rather prefer to simply draw onto the CEGUI Window. <br><br></td></tr></table><br>
<a name="935708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know what you mean, but I'm not entirely sure if it's possible.<br><br>But I'll look into it. <br><br></td></tr></table><br>
<a name="935711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks :D <br><br></td></tr></table><br>
<a name="936248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Think I would go in that direction :<br>http://www.cegui.org.uk/phpBB2/viewtopic.php?t=3362&amp;highlight=draw+onto<br><br>* Render / otherwise copy content to a texture<br>* Create a CEGUI::Texture from the underlying engine / API texture<br>* Create an Imageset from the CEGUI::Texture<br>* Define an Image for the Imageset<br>* Draw the image from your window / skin / or use a StaticImage. <br><br>The only missing part is the passing a blitzmax texture to a CEGUI::Texture <br><br></td></tr></table><br>
<a name="936256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  The only missing part is the passing a blitzmax texture to a CEGUI::Texture <br></div><br>Indeed :-)<br><br>I hope you don't mean an actual hidden-away from us TImage texture reference? :-p <br><br></td></tr></table><br>
<a name="936261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Humm Sad... (put his research on hold) ^^<br><br>I was already playing with this lol :<br><pre class=code>	Local texture:TCETexture = TCEImagesetManager.getImageset("ToolBarLook").GetTexture()
	texture.loadFromMemory(****magical texture reference pointer****, 48, 48, PF_RGBA)
	TCEImagesetManager.createImagesetFromTexture("TEST", texture)
	TCEWindowManager.getWindow("tileSelected").setProperty("Image", "set:TEST image:NormalPaint")</pre><br><br>Note that I could go with saving the small texture to the drive and reload it with CEGUI since it's not realtime stuff... But it's a dirty solution. <br><br></td></tr></table><br>
<a name="936262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> magical texture reference pointer <br></div><br>Couldn't that simply be the pixmap data? (pixelptr) <br><br></td></tr></table><br>
<a name="936267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't try.<br><br>The CEGUI::Imageset:GetTexture() seems to be missing from the current SVN of Max CEGUI.<br>And the loadFromMemory() doesn't return any TCETexture object curiously.<br><br>So new object ? ( <a href="http://www.cegui.org.uk/api_reference/classCEGUI_1_1Texture.html" target="_blank">http://www.cegui.org.uk/api_reference/classCEGUI_1_1Texture.html</a> )<br><br>I doubt it would be so simple, but worth to try :D <br><br></td></tr></table><br>
<a name="936269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh I see that TCETexture extend blitzmax Object so I know I could use New to create a new Texture (Well I think).<br><br>PixmapPixelPtr my pixmaps result in a Unhandled Memory Exception Error through :( <br><br></td></tr></table><br>
<a name="936270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm perplex :<br><a href="http://www.cegui.org.uk/phpBB2/viewtopic.php?t=3782&amp;highlight=texture" target="_blank">http://www.cegui.org.uk/phpBB2/viewtopic.php?t=3782&amp;highlight=texture</a><br>I suppose it's the same thing for OpenGL texture :s<br><br><div class="quote"> Note that in regard to creating the Imageset from the texture, you usually would create a CEGUI::Texture from the underlying engine / API texture for use by the Imageset, however if you're using OpenGL, we are missing a means of doing this directly, so you'd create the CEGUI::Texture first, extract the OpenGL texture name from this and then either the data into it (or use it when setting up a frame buffer, or whatever).  <br></div> <br><br></td></tr></table><br>
<a name="936276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well until any better solution I will use that trick :<br><pre class=code>	SavePixmapPNG(TileSetImage.pixmaps[tileNumber], AppDir + "/TMPSelection.png")
	If TCEImagesetManager.isImagesetPresent("TMPSelection") Then TCEImagesetManager.destroyImageSet("TMPSelection")
	TCEImagesetManager.createImagesetFromImageFile("TMPSelection", AppDir + "/TMPSelection.png").setAutoScalingEnabled(False)
	TCEWindowManager.getWindow("tileSelected").setProperty("Image", "set:TMPSelection image:full_image")
	If FileType(AppDir + "/TMPSelection.png") = 1 Then DeleteFile(AppDir + "/TMPSelection.png")
</pre><br><br>A bit ugly but work like a charm since my tile are only a few pixels width and depth.<br>Alpha Borders of staticImage are a bit strange because of the scaling smooth through.<br>I wonder if there is a way to uncheck this ?<br><br>Ho !<br>I found this lately and that was very useful :<br><a href="http://www.cegui.org.uk/wiki/index.php/SetProperty" target="_blank">http://www.cegui.org.uk/wiki/index.php/SetProperty</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
