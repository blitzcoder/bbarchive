<!DOCTYPE html><html lang="en" ><head ><title >bah.crypto feature request</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >bah.crypto feature request</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >bah.crypto feature request</a><br><br>
<a name="976559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Brucey,<br><br>A MD5File() function would be nice, to calculate the hash of a file. Loading a bigfile with LoadText() isn't always going to work.<br><br>The Perl module Digest::MD5 (and Digest::MD5::File) are able to do this. The maintainer of that module is using a method called add() which adds to the MD5 hash, so you can open a stream to a file, load it bit by bit and pass the contents to the MD5 object without loading the full file into memory.<br><br><a href="http://cpansearch.perl.org/src/GAAS/Digest-MD5-2.39/MD5.xs" target="_blank">Direct link to the C code</a><br><a href="http://search.cpan.org/~gaas/Digest-MD5-2.39/MD5.pm" target="_blank">Digest::MD5</a><br><a href="http://search.cpan.org/~dmuey/Digest-MD5-File-0.07/File.pm" target="_blank">Digest::MD5::File</a><br><br>It would be really nice if you could add this :-). Thanks.<br><br>Update: Browsing through the source wouldn't you be able to do this with MD5_Update() from openssl? <br><br></td></tr></table><br>
<a name="976564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, all the code is already there for you to make that up yourself :-p<br>(see the digest example for use of "update" method)<br><br>You have the choice of using the "easy" API, or the meaty low-level API.<br><br><br>However, I've just updated all the digest functions to now take either a String (which they did previously) or a TStream.<br><br>There's a small "stream_digest.bmx" example too, so that you can see it in action.<br><br>Check out latest SVN for the updates.<br><br>:o) <br><br></td></tr></table><br>
<a name="976565"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know all the code is there and I'd probably would've been able to do it myself. But, as a programmer I'm lazy :-). So I thank you for doing the hard work ^_^.<br><br>So far seems to be working perfectly. Thanks. <br><br></td></tr></table><br>
<a name="976567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> One *bug* report :-)<br><br>Shouldn't you reset the position of the stream after being done to 0 or the last known position? I currently have to do it manually, no biggie, but it would just be a little bit nicer if it did it by itself. <br><br>Anyway, I made a patch. I'm not sure about the stream.Seek(0) if the ctx.DigestUpdate() returns False, but seems logical to me.<br><br><pre class=code>Index: crypto.bmx
===================================================================
--- crypto.bmx	(revision 829)
+++ crypto.bmx	(working copy)
@@ -893,10 +893,13 @@
 			End If
 			
 			If Not ctx.DigestUpdate(data, count) Then
+				stream.Seek(0)
 				Return Null
 			End If
 
 		Wend
+
+		stream.Seek(0)
 		
 	Else
 		Return Null
</pre> <br><br></td></tr></table><br>
<a name="976570"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Shouldn't you reset the position of the stream after being done to 0 or the last known position? <br></div><br>Well, I can't assume that a stream you are giving me supports Seek(0).<br>For example, an http stream wouldn't, so I think the interface really needs to be quite generic in that regards. No ? <br><br></td></tr></table><br>
<a name="976571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I hadn't thought of that :-). Good thinking. I'll revert my changes now. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
