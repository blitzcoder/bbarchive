<!DOCTYPE html><html lang="en" ><head ><title >Mojo2 does not build with latest BMK and BCC</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Mojo2 does not build with latest BMK and BCC</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >Mojo2 does not build with latest BMK and BCC</a><br><br>
<a name="1301642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >seriouslee</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pulled the latest bmk, bcc, brl.mod and pub.mod this evening for NG. When I tried to recompile my project using mojo2, I got the following warnings:<br><br><div class="quote"> <br>Compile Warning: In call to Function glBufferData:Int(Local target_:Int,Local size_:Int,Local data_:Byte Ptr,Local usage_:Int). Argument #2 is "Long" but declaration is "Int". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;162;0]<br><br>Compile Warning: In call to Method TDrawList.Transform(Local ix:Float,Local iy:Float,Local jx:Float,Local jy:Float,Local tx:Float,Local ty:Float). Argument #1 is "Double" but declaration is "Float". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;1795;0]<br><br>Compile Warning: In call to Method TDrawList.Transform(Local ix:Float,Local iy:Float,Local jx:Float,Local jy:Float,Local tx:Float,Local ty:Float). Argument #2 is "Double" but declaration is "Float". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;1795;0]<br><br>Compile Warning: In call to Method TDrawList.Transform(Local ix:Float,Local iy:Float,Local jx:Float,Local jy:Float,Local tx:Float,Local ty:Float). Argument #3 is "Double" but declaration is "Float". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;1795;0]<br><br>Compile Warning: In call to Method TDrawList.Transform(Local ix:Float,Local iy:Float,Local jx:Float,Local jy:Float,Local tx:Float,Local ty:Float). Argument #4 is "Double" but declaration is "Float". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;1795;0]<br><br>Compile Warning: In call to Function glColorMask:Int(Local red_:Byte,Local green_:Byte,Local blue_:Byte,Local alpha_:Byte). Argument #1 is "Int" but declaration is "Byte". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;3122;0]<br><br>Compile Warning: In call to Function glColorMask:Int(Local red_:Byte,Local green_:Byte,Local blue_:Byte,Local alpha_:Byte). Argument #2 is "Int" but declaration is "Byte". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;3122;0]<br><br>Compile Warning: In call to Function glColorMask:Int(Local red_:Byte,Local green_:Byte,Local blue_:Byte,Local alpha_:Byte). Argument #3 is "Int" but declaration is "Byte". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;3122;0]<br><br>Compile Warning: In call to Function glColorMask:Int(Local red_:Byte,Local green_:Byte,Local blue_:Byte,Local alpha_:Byte). Argument #4 is "Int" but declaration is "Byte". <br>[C:/BMXng/mod/mky.mod/mojo2.mod/graphics.bmx;3122;0]<br> <br></div><br><br>The project does not compile with a very long list of errors. I've reverted back to the older bmk and bcc, keeping brl.mod and pub.mod and the project compiles fine after rebuilding mods. <br><br></td></tr></table><br>
<a name="1301660"></a>

<a name="1301661"></a>

<a name="1301662"></a>

<a name="1301663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems you use the newly introduced "-w"  param (should be included in Brucey's MaxIDE already).<br>So instead of stopping the compilation it only prints warnings (concerning param widening and overload-functionality).<br><br><br>To get rid of them: fix these issues :-)<br><br><br>What has changed?<br>With the introduction of "overloadable functions/methods" Brucey also needed to check for given params. Now it does not find the function-definition "<i>glBufferData:Int(int,long,byte ptr, int)</i>" because it does not exist (but it could, as "overloading" is now possible).<br>The original function is "<i>glBufferData:Int(int,<b>int</b>,byte ptr, int)</i>" but you are not calling it.<br>Solution: go to line 162 of the blamed graphics.bmx and change the line to <i>glBufferData GL_ELEMENT_ARRAY_BUFFER,<b>int(</b>idxs.Size()<b>)</b>,idxs._buf,GL_STATIC_DRAW".</i> <br>The reason is: Size() returns a Long in BMX-NG (&gt;4GB support) which vanilla does not.<br><br><br>Ok so what about this "-w"-param for BMK? It then let's you compile this code unchanged as long as there is only exactly _one_ definition of the called function (read: "overload" is not used).<br>When I blamed that same problem to Brucey the solution was to output a warning, so the developer knows at which line he uses vague assumptions about data types. So the end is that you get a list of warnings (with the chance to fix it) instead of breaking the compilation each time without knowing what there might be else left to fix. <br><br><br>@ "local varname:type, local ..."<br>I assume this is kind of a bug, there is no need to have this long-style there.<br><br><br>As you only got compile warnings (else you would only have the first problem printed, not the follow ups) you already used "-w". What _errors_ did you get as you mentioned it is no longer compileable.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1301683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >seriouslee</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I am using the latest and greatest MaxIDE using the "-w" param.<br><br>I opened graphics.bmx and applied the appropriate castings. The module compiles now without warnings.<br><br>The project also compiles and executes without error. I like the warning messages. They certainly helped fix these issues. But the methods that produced the warnings did not compile, so it seems like they are not warnings but errors.<br><br>Also, it looks like math functions are returning doubles as we can see in the method below:<br><br><pre class=code>
Rem
bbdoc: Rotates the current 2d matrix.
end rem
Method Rotate( rz:Float )
	Transform Float( Cos( rz ) ),Float( -Sin( rz ) ),Float( Sin( rz ) ),Float( Cos( rz ) ),0,0
End Method
</pre><br><br>Casting the math functions back to a float resolves the issue, but that seems like it could break a lot of things, or maybe they've always returned doubles but BMax auto casted it? I'm guessing here. <br><br></td></tr></table><br>
<a name="1301684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The latest mojo2 should build cleanly with the very latest bcc.<br><br>The latest bcc has been updated so that you shouldn't need to do things like cast from False to Byte... <br><br></td></tr></table><br>
<a name="1301688"></a>

<a name="1301693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >seriouslee</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Brucey!<br><br>Mojo2 compiles cleanly, but when I try to use it, I get an exception_access_violation. I do not get line number information, but in debug it looks like it is in the InitVbos function being called from InitMojo2.<br><br>This is Windows 10, bcc version is 0.76, bmk is 3.11. GCC version is 5.1.0. Compile options in IDE are debug, threaded, build gui app, quickscan, and overload warnings. Compiling x64.<br><br>EDIT:<br><br>I'm trying to run the mojotest from the examples folder as a baseline. Get the following errors:<br><br><div class="quote"> <br>[100%] Linking:mojotest.debug.mt.exe<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/sdlsystem.debug.mt.win32.x64.a(glue.c.debug.mt.win32.x64.o): In function `bmx_SDL_EmitSDLEvent':<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:143: undefined reference to `sdl_sdlsystem_TSDLMultiGesture__getGesture'<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:145: undefined reference to `sdl_sdlsystem_TSDLMultiGesture__freeGesture'<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:143: undefined reference to `sdl_sdlsystem_TSDLMultiGesture__getGesture'<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:145: undefined reference to `sdl_sdlsystem_TSDLMultiGesture__freeGesture'<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:143: undefined reference to `sdl_sdlsystem_TSDLMultiGesture__getGesture'<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:145: undefined reference to `sdl_sdlsystem_TSDLMultiGesture__freeGesture'<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/sdlsystem.debug.mt.win32.x64.a(glue.c.debug.mt.win32.x64.o): In function `bmx_SDL_EventFilter':<br>C:/BmxTest/mod/sdl.mod/sdlsystem.mod/glue.c:487: undefined reference to `sdl_sdlsystem_TSDLSystemDriver__eventFilter'<br>Build Error: Failed to link C:/BmxTest/mod/mky.mod/mojo2.mod/examples/mojotest/mojotest.debug.mt.exe<br> <br></div> <br><br></td></tr></table><br>
<a name="1301694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops. Apologies.<br><br>Should be all working now (updated mky project). <br><br></td></tr></table><br>
<a name="1301696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >seriouslee</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That did the trick. Mojotest compiles and run cleanly. Thanks, again.<br><br>And no apologies are necessary! I appreciate ALL you do in Blitz and for the community. Thanks! <br><br></td></tr></table><br>
<a name="1301753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabhand</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've built a new Windows package (0.76),wrapped it up and plonked it over at bmxng.com... With a little note stating the "-w" parameter when building modules.<br><br>Should keep people at bay for a bit! :D<br><br>Dabz <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
