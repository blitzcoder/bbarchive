<!DOCTYPE html><html lang="en" ><head ><title >bah.box2d update would be great</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >bah.box2d update would be great</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >bah.box2d update would be great</a><br><br>
<a name="1146258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lobby</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I'm currently working on a project that uses the bah.box2d physics engine. It's a really nice engine but the wrapped version of box2d is 2.0.2 while there's 2.2.1 out.<br>Where's the problem? The problem is that the old version isn't optimized for manuel position changing (using SetXForm). If you've more than 100 bodies (I think this should be expectable in a 2d game) you want to move at once to another position this needs more than 100ms. For a realtime game this is unacceptable and it's a known issue of the old box2d version.<br>So I hope that a new version of bah.box2d will be released because it seems to be really difficult to update the wrapper oneself (in addition there are also other great new features of the new version). <br><br></td></tr></table><br>
<a name="1146301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried to update it to 2.3 myself here : <br><a href="http://blitzmax.com/Community/posts.php?topic=97835#1138772" target="_blank">http://blitzmax.com/Community/posts.php?topic=97835#1138772</a><br><br>But I got a small problem of C++ object.<br>I never was able to hire someone to port it to BlitzMax so I guess we are stuck.<br><br><b>Extending BlitzMax</b>: that's really something Blitz Research Ltd should think about! Like a premium service or something...<br>When I ask a bit about this they answer me that we are not supposed to mess with the C++ side of things.<br><br>Ok, then what ?<br><br>I don't understand why they stopped adding cool modules and improving BlitzMax. I thought that Monkey would be the answer but in fact no. <br><br></td></tr></table><br>
<a name="1147139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lobby</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice try you've done. Unfortunately, I also have no knowledge how to solve the problems. It would be a pity if I've to abort my project in BlitzMax only because the wrapper is out of date.<br><br>As you already implied, it's sad that the support to BlitzMax seems to be dead. <br><br></td></tr></table><br>
<a name="1147158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wasn't aware of the SetXForm problem during the development of my engine.<br><br>I'm not 100% sure of that but I tried to replicate this thanks a Teleporter object in my game. It's using SetXForm to teleport objects.<br><br>Pushing an extreme amount of objects inside (around 500) didn't impact the FPS much.<br><br>So I build a small test using SetXForm where a specific object would move randomly at each frame.<br><br>For 1024 objects:<br>The one using SetXForm give me <b>70 FPS</b><br>The one without SetXForm give me <b>140 FPS</b><br><br>So effectively there is a noticeable differences between the 2.<br><br><br>I don't know about your game but the Box2D Manual discourage manual positioning during simulation because it's disturbing it.<br>Now maybe you can find a way to decrease the number of call during each frames. SetXForm 20 objects per frames for example?<br><br>But it's clear that soon or later, if we want to continue using Box2D the Module will have to be updated.<br>After all: <a href="http://www.develop-online.net/news/37171/GDC11-How-the-Box-2D-hero-caught-Rovio-out" target="_blank">http://www.develop-online.net/news/37171/GDC11-How-the-Box-2D-hero-caught-Rovio-out</a> <br><br></td></tr></table><br>
<a name="1147515"></a>

<a name="1147516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lobby</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you for testing. I think the problem in my game is that I use a lot of shapes per body (up to 100 in common). So I've to decrease the number of shapes of a body to solve this, although that may cause other issues (the box2d intern commands for every shape are really useful).<br><br>Here a little testcode that shows that it need more than 100ms to reposition 100 bodies with 16 shapes per body:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict

Import bah.box2d

Graphics(800, 600, 0)

'Init world for physics
Local worldAABB:b2AABB = b2AABB.CreateAABB()
worldAABB.SetLowerBound(New b2Vec2.Create(-100, -100))
worldAABB.SetUpperBound(New b2Vec2.Create(1000, 1000))
Local WORLD:b2World = New b2World.Create(worldAABB, New b2Vec2.Create(0, 0), True)

'Prepare body shape (simple square)
Local shapeDef:b2PolygonDef = New b2PolygonDef
shapeDef.SetAsOrientedBox(1, 1, New b2Vec2.Create(-0.5, -0.5), 0)

'Prepare body definition
Local bodyDef:b2BodyDef = New b2BodyDef

'Create bodies
Local bodyList:TList = New TList
For Local i:Int = 0 Until 100
	'Set a random position for the body and create it
	bodyDef.SetPosition(New b2Vec2.Create(Rnd(0, 40), Rnd(0, 30)))
	Local body:b2Body = WORLD.CreateBody(bodyDef)
	'Add 16 shapes to this body (they are ident here, but who cares)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	body.CreateShape(shapeDef)
	'Add it to the body list
	bodyList.AddLast(body)
Next

While(Not(KeyHit(KEY_ESCAPE) Or AppTerminate()))
	Cls()
	
	'Reposition all bodies
	If KeyHit(KEY_SPACE) Then
		Local startms:Int = MilliSecs()
		For Local body:b2Body = EachIn bodyList
			body.SetXForm(New b2Vec2.Create(Rnd(0, 40), Rnd(0, 30)), 0)
		Next
		Print (MilliSecs() - startms)
	End If
	
	'Draw things
	For Local body:b2Body = EachIn bodyList
		Local Pos:b2Vec2 = body.GetPosition()
		SetRotation(body.GetAngle())
		DrawRect(Pos.x() * 20, Pos.y() * 20, 20, 20)
	Next
	
	'Simulate world (although not needed in this sample)
	WORLD.DoStep(1.0 / 60.0, 1, 1)
	
	'Trivial
	Flip()
Wend

'Goodbye
WORLD.Free()
End
</textarea><br><br>To move the bodies separately could be a solution, but it seems to cause easily physic toubles when collision doesn't work in this short time of movement. The point is that my world is splitted into chunks so that I've only to reposition (all) things when the chunk is changed (I've to do this because the box2d world have to be not too big, otherwise physics fail).<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1153117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think Brucey has posted anything at all since last year, so I wouldn't hold my breath on getting Box2D updated (unless someone else wants to give it a shot...).<br><br>I imagine he has moved on to bigger and better things. With his programming talents, he could work anywhere he wants really.<br><br>Sad for us, but good for him!<br><br>Still, it would be nice to hear from the 'ol boy...<br><br>Russell <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
