<!DOCTYPE html><html lang="en" ><head ><title >BaH.RegEx - Regular Expressions</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BaH.RegEx - Regular Expressions</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >BaH.RegEx - Regular Expressions</a><br><br>
<a name="844441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has been updated to PCRE 7.4, although I've just noticed they've released 7.6 the other day, so expect another update in the not so distant future :-p<br><br>For the uninitiated, Regular Expressions are an extremely powerful method of search/replacing in strings.<br><br>Here's a complex example, just to show you what it can do :<br><br>Imagine you wanted to be able parse a string for dates in format dd/mm/yyyy or dd/mm/yy, and replace those entries in the string with the year only inside quotes. Writing a program to do that would be quite involved.<br><br>Now let's look at such a program using Regular Expressions :<br><pre class=code>
SuperStrict

Framework BaH.RegEx
Import BRL.StandardIO

Local date:String = "The dates are: 12/30/1969, 06/04/1974 and 15/08/1980"
Print "Original : " + date + "~n"

Local regex:TRegEx = TRegEx.Create("(\d\d)[-/](\d\d)[-/](\d\d(?:\d\d)?)")

Print regex.replaceAll(date, "~q\3~q")
</pre><br>would result in the output :<br><pre class=code>
Original : The dates are: 12/30/1969, 06/04/1974 and 15/08/1980

The dates are: "1969", "1974" and "1980"
</pre><br><br>The difficult part is learning how to write the regular expression, but there are good tutorials online, as well as an in-depth guide included with the module.<br><br>Have Fun ! :-) <br><br></td></tr></table><br>
<a name="844451"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks -- your regex module has definitely come in handy in the past.<br><br>Any specific changes/improvements in this new version? <br><br></td></tr></table><br>
<a name="844452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> By the way: Windows XP's zipfolders had problems extracting the files from your zip file, although Winrar worked Ok. <br><br></td></tr></table><br>
<a name="844458"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Windows XP's zipfolders had problems extracting the files <br></div><br>Thanks for that... They were compressed on Mac (using the built-in context menu), and unzipped fine here on Win2k with Winzip so I hadn't noticed.<br><br><div class="quote"> Any specific changes/improvements in this new version? <br></div><br>Just the update to the core library, in which they tend to fix bugs, improve speed, and generally make it better here and there.<br>No changes to the Max-side of things. <br><br></td></tr></table><br>
<a name="844465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Thanks for that... They were compressed on Mac (using the built-in context menu), and unzipped fine here on Win2k with Winzip so I hadn't noticed. <br></div><br><br>I have a feeling that XP might have an issue with both a folder and a file with the same name in the main folder... (regex.mod)<br><br>I just noticed that some of your other mods have the same problem. <br><br></td></tr></table><br>
<a name="844467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> XP might have an issue with both a folder and a file with the same name in the main folder <br></div><br>Except there aren't any files called regex.mod :-)<br><br>I've just tried unzipping the regex_1_03_src.zip folder in Win2k using the built-in "Extract Here" context menu, and it appeared to work as expected. <br><br></td></tr></table><br>
<a name="844469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I double-click on the regex_1_03_src.zip file in XP on my computer, it opens a compressed folder containing both a folder named regex.mod and a file named regex.mod<br><br>When I try to extract the file, it tells me 'the system cannot find the file specified'... Yet I do see it. :-? <br><br></td></tr></table><br>
<a name="844474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >North</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use Winzip<br><br>@Brucey - Thanks for the update! :) <br><br></td></tr></table><br>
<a name="844557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for this module Brucey (and all the rest :) ).<br>BTW, I noticed a bug lately: when doing replaceAll on a non-ascii text, everything is screwed. IIRC it seemed to be due to the fact that pcre is giving you indexes that relate to the utf8 buffer, but you use these indexes to index the BlitzMax string. Hence the mismatch. <br><br></td></tr></table><br>
<a name="844589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Koriolis, that's possible. It didn't used to support UTF-8 the way it does now. And I see that the newest version is even more unicode friendly.<br>I'll need to revamp the string conversion - hopefully that won't be a huge job! <br><br></td></tr></table><br>
<a name="915253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found a bug. I'm using the SVN version by the way.<br><br><pre class=code>Import bah.regex

Local strs:String[] = ["test1", "test2", "test3", "test4"]
Local text:String = "Just a test1 string with test, test2, test3 and ofcourse test 4"

For Local str:String = EachIn strs
	Try
		Local regex:TRegEx = TRegEx.Create(str)
		text = regex.Replace(text, "`" + str + "`")
		regex = Null
	Catch ex:TRegExException
		Notify ex.toString()
	Catch ex:Object
		Notify ex.ToString()
	End Try
Next

Print text</pre><br><br>It gives a Unhandeld Memory Exception error. I scanned the module and couldn't see data member pcre (Byte Ptr) being freed anywhere. I'm not sure if the problem is there though.<br><br>When removing the Try/Catch blocks it sends me to regex.bmx on line 190. <br><br></td></tr></table><br>
<a name="917140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sadly (or not!), this example works for me (on Mac).<br><br>I'll give it a try elsewhere and see if I can make it break.<br><br>EDIT : working on Linux too. <br><br></td></tr></table><br>
<a name="917150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> BTW, I noticed a bug lately: when doing replaceAll on a non-ascii text, everything is screwed. <br></div><br>Bit of a late fix....  but I think it's working properly now with non-ASCII text. Well, the offsets seem to be correct now. May still require some work though. <br><br></td></tr></table><br>
<a name="917153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried my bug on Windows XP or Vista? <br><br></td></tr></table><br>
<a name="917165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, and have just applied a fix :-) <br><br></td></tr></table><br>
<a name="917166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll try it soon. Nice to see that it's fixed. (it is right?) <br><br></td></tr></table><br>
<a name="917167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I hope so :-)<br><br>Certainly, it crashed on XP as described before I changed the code, and now it doesn't... <br><br></td></tr></table><br>
<a name="917189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated to PCRE 7.8, and fixed another utf8 issue.<br><br>utf8 support seems to be quite solid now. <br><br></td></tr></table><br>
<a name="918730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Finally had some time to test it. It works for me now. Thanks! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
