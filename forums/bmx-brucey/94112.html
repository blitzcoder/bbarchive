<!DOCTYPE html><html lang="en" ><head ><title >Error compiling freeimage on Win7 x64</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Error compiling freeimage on Win7 x64</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >Error compiling freeimage on Win7 x64</a><br><br>
<a name="1078524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> BMax compiles every other Brucey module (with only a few exceptions) with no trouble, but freeimage.mod gives this error:<br><pre class=code>Compiling:pngwrite.c
Compiling:pngwtran.c
Compiling:pngwutil.c
Compiling:bio.c
In file included from C:/BlitzMax/mod/bah.mod/freeimage.mod/src/LibOpenJPEG/opj_includes.h:104,
                 from C:/BlitzMax/mod/bah.mod/freeimage.mod/src/LibOpenJPEG/bio.c:32:
C:/BlitzMax/mod/bah.mod/freeimage.mod/src/LibOpenJPEG/opj_malloc.h:67:25: mm_malloc.h: No such file or directory
Build Error: failed to compile C:/BlitzMax/mod/bah.mod/freeimage.mod/src/LibOpenJPEG/bio.c
Process complete</pre><br>Any ideas?<br><br>Thanks in advance!<br>Russell <br><br></td></tr></table><br>
<a name="1078598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> In src/LibOpenJPEG/opj_malloc.h<br><br>Try changing this bit at line 66 :<br><pre class=code>
	#ifdef __GNUC__
		#include &lt;mm_malloc.h&gt;
		#define HAVE_MM_MALLOC
</pre><br><br>to this<br><br><pre class=code>

	#ifdef __GNUC__
		#include &lt;malloc.h&gt;
		#define HAVE_MM_MALLOC
</pre> <br><br></td></tr></table><br>
<a name="1078621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I will give that a try as soon as possible! :)<br><br>If it's a misspelling of the malloc.h filename, how come everyone doesn't get this error when compiling? (Or maybe they do, but are able to find the problem and fix it on their own ;^P<br><br>Russell <br><br></td></tr></table><br>
<a name="1078622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> That did the trick, Brucey! Thanks!<br><br>Russell <br><br></td></tr></table><br>
<a name="1078623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's an issue with old(er) versions of MinGW. I believe versions which have a GCC &gt;= 4.x do not have this problem.<br><br>I should probably change that bit to use different includes depending on the version of GCC (for minGW) <br><br></td></tr></table><br>
<a name="1094958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, Brucey!<br><br>Sorry for the really late reply to this. I neglected to try to compile any example programs for freeimage (The module itself compiles just fine after the "malloc" change). All of the examples report one or more variations of the following:<br><br><div class="quote"> <br>C:/BlitzMax/mod/bah.mod/freeimage.mod/freeimage.debug.win32.x86.a(tcd.c.debug.win32.x86.o):tcd.c:(.text+0x1acc): undefined reference to `_mm_malloc'<br> <br></div><br>or<br><div class="quote"> <br>C:/BlitzMax/mod/bah.mod/freeimage.mod/freeimage.debug.win32.x86.a(tcd.c.debug.win32.x86.o):tcd.c:(.text+0x507f): undefined reference to `_mm_free'<br> <br></div><br><br>I only use GCC version 3.4.2 because that is the one contained in Mark's Module Compiling tutorial (MinGW 5.1.3). I would love to use the latest minGW, but had no end of troubles getting both modules AND example programs to compile with it. (It sure would be nice if BMax's distributable contained the latest version of minGW [or at least the parts necessary for module compilation] - I think this would solve a lot of issues people are having with module compilation).<br><br>Anyway, the file referenced in the above error line, tcd.c, contained no reference to '_mm_malloc' or '_mm_free' (nor the HAVE_MM_MALLOC constant/compiler directive), so I have no idea what to fix.<br><br>Any ideas?<br><br>Russell <br><br></td></tr></table><br>
<a name="1094960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Some of the modules do require a more modern GCC now - the march of progress, etc.<br><br>Maybe I need two complete installations of BlitzMax set up for old and new GCCs, but it's a bit of a pain to swap environment settings about.<br><br>I think someone uses a script to copy files into the BlitzMax structure. I suppose that would be useful at least for an easier way of ensuring the required files are in the right place. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
