<!DOCTYPE html><html lang="en" ><head ><title >File Sharing Shenanigans</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >File Sharing Shenanigans</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >File Sharing Shenanigans</a><br><br>
<a name="1012167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This little example downloads a PDF of the Art of War, from the internet somewhere :<br><pre class=code>
SuperStrict

Framework BaH.Libtorrent
Import BRL.StandardIO

Local session:TSession = New TSession
session.listenOn(6881, 6889)

Local params:TAddTorrentParams = New TAddTorrentParams
params.setSavePath("./")
params.setTorrentInfo(TTorrentInfo.Load("artofwar.torrent"))

session.addTorrent(params)

' wait for the user to end..

Input "enter to end..."
</pre><br>I'm almost tempted to throw away Vuze now :-p<br><br>The most trouble I've had is finding legal torrents to test with... pah! <br><br></td></tr></table><br>
<a name="1012169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really? Most Linux distro's are available through bittorrent :). <br><br></td></tr></table><br>
<a name="1012170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Really? Most Linux distro's are available through bittorrent  <br></div><br>Let me rephrase that :<br><br>The most trouble I've had is finding legal torrents, that weren't the size of CDs, to test with.<br><br>:-p <br><br></td></tr></table><br>
<a name="1012171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm also loathed to use Graphics to run the examples in... but then my options are otherwise fairly limited - to basic console output or a GUI module.<br><br>Perhaps I'll knock up a little CEGUI-based app for the bigger example (with realtime stats and such). <br><br></td></tr></table><br>
<a name="1012204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, Brucey.<br><br>Here's a small Linux distro for you to test:<br><br><a href="http://www.damnsmalllinux.org/download.html" target="_blank">http://www.damnsmalllinux.org/download.html</a><br><br>Just scroll down to the Bittorrent Mirror section. :) <br><br></td></tr></table><br>
<a name="1012254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats great! :) Thanks alot Brucey! <br><br></td></tr></table><br>
<a name="1012261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Still writing the "client example" app :<br><br><img src="http://brucey.net/programming/blitz/misc/screenshots/libtorrent_client_test.png"><br><br>which is taking a while, to say the least...<br><br>..but it does have the advantage of also testing out all the various parts of the API - to show up any "Brucey" errors. <br><br></td></tr></table><br>
<a name="1012289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Before anyone (xlsior :-p ) jumps in to mention that it doesn't build on Windows... that's because I've been working exclusively on Mac until now, and I've only just committed it - and now I'm off to bed.<br><br>Hopefully, it will be working on all platforms within the next few days - assuming it does actually work at all on MinGW... ho ho...<br><br>Notes : since it is built on Boost, unsurprisingly, it requires BaH.Boost (latest from SVN). It also requires SSL, which I may need to add support on Win32 via BaH.Crypto. The main example also requires BaH.Format.<br>I do find that It is nice, over time, to be able to utilise many other modules in new projects :-) <br><br></td></tr></table><br>
<a name="1012324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> &lt;crickets chirping&gt;<br><br><br>;-) <br><br></td></tr></table><br>
<a name="1012333"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Righty. I appear to have it working on Win32 now :-)<br><br>I'm still in the middle of writing the example, but it runs as-is. Not all of the "toggle options" show more information yet, ("a" and "i" so far, iirc). So, plenty to do there.<br>As the first post shows, you don't need much code to handle a torrent, but if you want more information, you need to hit the APIs.<br><br>Win32 requires BaH.Boost and BaH.Crypto (for SSL). You will also need the OpenSSL DLLs. (for all that encryption and hashing stuff).<br><br>As for the (rather) lengthy module build times... that's just how it is, I'm afraid. <br><br></td></tr></table><br>
<a name="1012360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> As for the (rather) lengthy module build times... <br></div><br>Yes indeed !<br>It reminds me a bit CeGui for that :p<br><br><b>BaH.Format</b> is also needed in order to use the client_test.bmx example.<br><br>By the way OpenSSL <b>libeay32.dll</b> and <b>libssl32.dll</b> (I needed to rename this one <b>ssleay32.dll</b> for some reasons) aren't present in the module. Don't know if you can include them but that would be handy for Win32 users.<br><br>But overall working really great !<br>Maybe Art of War need more seeds but I will stick to µTorrent for the moment :p<br><br>When the PDF was downloaded I delete the folder and try to [j] force recheck or anything else but nothing did it (though I don't know if this also happen with others torrent client, I rarely do that :@)<br><br>No use for torrent currently but what a nice Module ! So much things to learn about Torrent protocol.<br>Great piece of work Brucey, thanks ;) <br><br></td></tr></table><br>
<a name="1012362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> By the way OpenSSL libeay32.dll and libssl32.dll (I needed to rename this one ssleay32.dll for some reasons) aren't present in the module. <br></div><br>I suggest using the installer from here : <a href="http://www.slproweb.com/products/Win32OpenSSL.html" target="_blank">http://www.slproweb.com/products/Win32OpenSSL.html</a><br>I don't think it's such a great idea to include these dlls.. otherwise that's something else I need to keep up-to-date...<br><br><div class="quote"> Maybe Art of War need more seeds  <br></div><br>Quite possibly. It's just a little example I found. Just enough to demonstrate that everything works.<br><br><div class="quote"> try to [j] force recheck <br></div><br>Not currently implemented in the example :-)<br>It wouldn't be so bad if I was directly porting the C++ example to BlitzMax, but since I'm using Graphics to display it, I'm having to rewrite blocks to fit better in that kind of display.<br><br>I do like the fact that it runs happily in the background, and can be used with no user-interaction whatsoever. <br>A torrent library is even more niche than my usual modules, but it's nice to have it - even if noone else really wants it :-p <br><br></td></tr></table><br>
<a name="1012379"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> No no! Im going to use this:) <br><br></td></tr></table><br>
<a name="1012388"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> count me in as someone with plans. Torrents are a fantastic way to handle updates for things as it eases your server load when something new comes out (see world of warcraft and a lot of other MMOs are following as well) and an integrated updater is key as no one is going to get a client and learn to use it just to update a program.<br><br>Yet again, thanks Brucey! <br><br></td></tr></table><br>
<a name="1012416"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, another fantastic module! <br><br></td></tr></table><br>
<a name="1012457"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Option "i" in the example is showing lots more useful information now - live peer stats - which looks kind of groovy - except there's not always enough screen to show everything... :-)<br><br>But at least you won't be too short on statistics... <br><br></td></tr></table><br>
<a name="1012542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> The latest "client_test" example, showing multiple torrents, peers and pieces.<br><br><img src="http://brucey.net/programming/blitz/misc/screenshots/libtorrent_client_test2.png"> <br><br></td></tr></table><br>
<a name="1012546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems to work very well. :)<br>Is there any way to create a torrent file with this library? <br><br></td></tr></table><br>
<a name="1012568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is there any way to create a torrent file with this library?  <br></div><br>Yes, apparently. But I've not covered that part of the API yet. <br><br></td></tr></table><br>
<a name="1012586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does it also support prioritizing, and rate-limiting? <br><br></td></tr></table><br>
<a name="1012616"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Does it also support prioritizing, and rate-limiting? <br></div><br>You can set priority by file or by piece.<br>You can set upload/download limits by session (global), torrent or peer (ip address). <br><br></td></tr></table><br>
<a name="1012675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Otus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any plans to make it work on Linux? Or should it already? I had trouble compiling anything with it due to boost linking errors which I couldn't figure out. <br><br></td></tr></table><br>
<a name="1012679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't had a chance to test the Linux build yet. So, in answer to your questions... Yes and possibly.<br>:-) <br><br></td></tr></table><br>
<a name="1012682"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apologies for the delay...<br><br>It's now also working on Linux. (see SVN for latest)  :-) <br><br></td></tr></table><br>
<a name="1012768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Otus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then I must be doing something wrong... The module compiles, but trying to compile client_test.bmx I get linker errors like this:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">/home/jan/Programming/Blitz/BlitzMax/mod/bah.mod/libtorrent.mod/libtorrent.release.linux.x86.a(glue.cpp.release.linux.x86.o): In function `global constructors keyed to _ZN18Max_session_statusC2EN10libtorrent14session_statusE':
glue.cpp:(.text+0x32ca): undefined reference to `boost::system::get_system_category()'
glue.cpp:(.text+0x32d4): undefined reference to `boost::system::get_generic_category()'
glue.cpp:(.text+0x32de): undefined reference to `boost::system::get_generic_category()'
glue.cpp:(.text+0x32e8): undefined reference to `boost::system::get_generic_category()'
glue.cpp:(.text+0x32f2): undefined reference to `boost::system::get_system_category()'
glue.cpp:(.text+0x3324): undefined reference to `boost::system::get_system_category()'
glue.cpp:(.text+0x341e): undefined reference to `boost::system::get_system_category()'</textarea> <br><br></td></tr></table><br>
<a name="1012774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you also using the latest BaH.Boost? (from SVN)<br><br>&lt;EDIT&gt; And have you built it? <br><br></td></tr></table><br>
<a name="1012810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the module Brucey! It does almost all I wanted :)<br>It works perfectly on windows but it doesnt start on winpe which is where I needed it. Perhaps something to do with the crypto dlls or something.<br><br>So I guess i have to go back to the drawing board. <br><br></td></tr></table><br>
<a name="1012820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It works perfectly on windows but it doesnt start on winpe which is where I needed it. Perhaps something to do with the crypto dlls or something. <br></div><br>What about <b><a href="http://www.veder.com/nwdskpe/" target="_blank">this</a></b>? <br><br></td></tr></table><br>
<a name="1012831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Otus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Are you also using the latest BaH.Boost? (from SVN)<br><br>&lt;EDIT&gt; And have you built it?  <br></div><br>I guess something was wrong with my local version. I removed it and checked out again and now it works. Sorry about that, and thanks for the module! <br><br></td></tr></table><br>
<a name="1013717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...No longer compiles under Win32 after the boost SVN update the other day:<br><br><div class="quote"> <br>Compile Error: File 'c:/code/blitzmax/mod/bah.mod/boost.mod/src/libs/thread/src/win32/exceptions.cpp' not found<br>[c:/code/blitzmax/mod/bah.mod/libtorrent.mod/source.bmx;117;64]<br>Build Error: failed to compile <br> <br></div><br><br>(The exceptions.cpp file is indeed no longer there. I removed both the libtorrent and the boost folders and re-synced, and still get the same error) <br><br></td></tr></table><br>
<a name="1013718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apologies. I missed a commit.<br><br>Too many modules, me thinks.... :-/ <br><br></td></tr></table><br>
<a name="1013724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like that did the trick... Thanks again! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
