<!DOCTYPE html><html lang="en" ><head ><title >BaH.MACAddress</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BaH.MACAddress</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >BaH.MACAddress</a><br><br>
<a name="1008471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Because the world always has room for yet another cross-platform module....<br><br>BaH.MACAddress is a small utility module which uses a standard <b>cross-platform</b> API to retrieve the MAC address of your PC.<br><br>It consists of two functions :<br><pre class=code>
Function GetMACAddress:Int[]()

Function GetMACAddressString:String(uppercase:Int = True)
</pre><br>GetMACAddress() returns an array of 6 ints.<br>GetMACAddressString() returns a String of the form 00:00:00:00:00:00<br><br><br>Currently in SVN, but I'll do a release once I've given the Linux code a proper test.<br><br>Notes : This retrieves only 1 MAC address. If you have 12 network cards installed, it will retrieve only 1 MAC address. <br><br></td></tr></table><br>
<a name="1008473"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DavidDC</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hooray! Thank you Brucey :-) <br><br></td></tr></table><br>
<a name="1008478"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No worries ;-)<br><br>I only noticed your "request" for it this morning in the other thread...<br>I thought it was better to be more generic than tied to wx. <br><br></td></tr></table><br>
<a name="1008484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, sort of related to this: Are you aware of any way to retrieve the <i>netmask</i> used by a network card?<br><br>Blitz can natively find the IP addresses, but without knowing the netmask you can't determine the broadcast address for your network segment... <br><br></td></tr></table><br>
<a name="1008500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another little useful extension from you!<br>*is envy of Brucey coding skills*<br>Thanks. ;D <br><br></td></tr></table><br>
<a name="1008553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a nice adition but what card gets chosen? If for example you have wireless network and a wired? <br><br></td></tr></table><br>
<a name="1008584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> These two related questions :<br><div class="quote">  Are you aware of any way to retrieve the netmask used by a network card? <br></div><br><div class="quote"> what card gets chosen? <br></div><br>got me thinking.<br><br>I'm now thinking that it may be more useful to be able to retrieve information on all the "network interfaces" installed on the local machine. This will include MAC addresses for each, and all the relevant other stuff, like netmask, broadcast, ip address, ipv6 address, etc.<br><br>I'm looking into it. :-p <br><br></td></tr></table><br>
<a name="1008589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great! <br><br></td></tr></table><br>
<a name="1008765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is looking promising :<br><pre class=code>
Interface  : en0
IP Address : 192.168.2.1
Netmask    : 255.255.255.0
Broadcast  : 192.168.2.255
MACAddress : xx:xx:xx:xx:xx:xx
</pre><br><br>Stored in a type like this :<br><pre class=code>
Type TInet
	Field name:String
	Field address:Int
	Field MACAddress:Int[]
	Field MACAddressString:String
	Field netmask:Int
	Field broadcast:Int
End Type
</pre><br>A function, GetInetInterfaces() retrieves the list of interfaces.<br><br>Comparing the output to ifconfig, it produces the same list.<br><br>Working so far on Mac. Linux should be easier to implement. Windows... well, we'll see.<br><br>Should it also retrieve "flags" (eg. UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST) etc? <br><br></td></tr></table><br>
<a name="1008766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh my. Is there anything you can't do?! :P <br><br></td></tr></table><br>
<a name="1008790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great. Now its alot more usefull :)<br>I do this with a vbs script for the moment so this is a good development <br><br></td></tr></table><br>
<a name="1008822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have this on Win32 now :<br><pre class=code>
Interface  : {XXXXXXXX-4D1E-4018-84CF-FEE91BXXXXXX}
IP Address : 10.211.55.3
Netmask    : 255.255.255.0
Broadcast  : 10.211.55.255
MACAddress : xx:xx:xx:xx:xx:xx
</pre><br><br>Windows doesn't seem to have a simple interface name... but I don't suppose it matters really?<br>It's producing the same output as ipconfig.<br><br>I should probably change the name of the module to BaH.inet or something now... <br><br></td></tr></table><br>
<a name="1008854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, I've changed the name to BaH.Inet.... and committed the work so far.<br>It appears to be working on Mac and Win32. I'm about to investigate Linux now. <br><br></td></tr></table><br>
<a name="1008863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also working now for Linux.<br><br>Possible enhancements :<br><br>* Maybe removing the loopback interface from the list, since it seems a bit redundant.<br>* Adding "flags". <br><br></td></tr></table><br>
<a name="1008871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works like a charm under Win32 -- and unlike the built-in Blitz command to get the IP address, this is instant (the built-in command takes like 5-10 seconds to return my IP address last time I tried it)<br><br>There should be *some* way to get the proper interface names, though - ipconfig labels them "local area network", "VMware Network Adapter VMnet1", etc. <br><br></td></tr></table><br>
<a name="1008873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  There should be *some* way to get the proper interface names, though <br></div><br>I imagine there is. I could get the description field, but when I tried that, it came back with the name of the actual hardware. I'll do some more research :-p <br><br></td></tr></table><br>
<a name="1008889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rixarn</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey, this is exactly what i was looking for. Bmax wouldn't be the same thing without you, (and neither my project he he..)<br><br>Thank you very much!! :) <br><br></td></tr></table><br>
<a name="1008892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rixarn</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey, i when i try to run your example_01.bmx, i get this error:<br><br>"../BlitzMax/bin/ld.exe: cannot find -lrpcrt4"<br><br>it's a dll i need to have in my directory or something?<br><br>Thanks! <br><br></td></tr></table><br>
<a name="1008893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  i get this error... <br></div><br>okay, I've removed that requirement now. It was original required in an early build of the module. It seems that the move to a different API means that is no longer required.<br><br>Hope that works for you now. <br><br></td></tr></table><br>
<a name="1008901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rixarn</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whoa! ultra fast reply he he.. Tried again with your recent fix, but this time i get this error: BlitzMax/bin/ld.exe: cannot find -liphlpapi<br><br>Checked your source, and there are 2 imports:<br><br>Import "-lws2_32"<br>Import "-liphlpapi"<br><br>Removed the import line but it seems the module needs that line to work <br><br></td></tr></table><br>
<a name="1008902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm afraid libiphlpapi.a is required for this to work. It is in your MinGW distribution. Unfortunately, BlitzMax/lib does not include all of the .a files that you might need... only a subset.<br><br>If you browse to your MinGW/lib folder in explorer, you should see <b>libiphlpapi.a</b> there.<br>You can copy that to your BlitzMax/lib folder.<br><br>Maybe I should ask Mark nicely if he wouldn't mind providing the full set of library files... then it would save you the trouble of copying them yourself. <br><br></td></tr></table><br>
<a name="1008904"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rixarn</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, thanks for your quick reply :)<br><br>It's ok, you do more than enough by making this modules for the community so, moving files from one place to another is nothing. <br><br>Thanks for your help and your great modules. <br><br></td></tr></table><br>
<a name="1009003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> After <b>a lot</b> of searching, and searching, and trial and error, I've finally got Win32 to display the correct "ethernet adapter" as the name field. Eg :<br><pre class=code>
Interface   : Local Area Connection 2
IP Address  : 10.225.122.150
Netmask     : 255.255.255.0
Broadcast   : 10.225.122.255
MAC Address : xx:xx:xx:xx:xx:xx
</pre><br><br>Can some of you check that it is returning the correct information for you please?<br>It should match up to what ipconfig says...<br><br>Thanks. <br><br></td></tr></table><br>
<a name="1009119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Added support for "flags" on Mac and Win32. Linux to follow :<br><br><pre class=code>
Interface   : Local Area Connection 3
            : UP, BROADCAST, MULTICAST
IP Address  : 10.211.55.3
Netmask     : 255.255.255.0
Broadcast   : 10.211.55.255
MAC Address : xx:xx:xx:xx:xx:xx
</pre> <br><br></td></tr></table><br>
<a name="1009139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there a way of checking if ports are open? <br><br></td></tr></table><br>
<a name="1009156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like the updated version works:<br><br><pre class=code>
Interface   : Local Area Connection
            : UP, BROADCAST, MULTICAST
IP Address  : 192.168.1.2
Netmask     : 255.255.255.0
Broadcast   : 192.168.1.255
MAC Address : xx:xx:xx:xx:xx:xx

Interface   : VMware Network Adapter VMnet1
            : UP, BROADCAST, MULTICAST
IP Address  : 192.168.0.1
Netmask     : 255.255.255.0
Broadcast   : 192.168.0.255
MAC Address : xx:xx:xx:xx:xx:xx

Interface   : VMware Network Adapter VMnet8
            : UP, BROADCAST, MULTICAST
IP Address  : 192.168.249.1
Netmask     : 255.255.255.0
Broadcast   : 192.168.249.255
MAC Address : xx:xx:xx:xx:xx:xx
</pre><br><br>(disabling my local area network adapter dropped it from the list of returned information as well.) <br><br></td></tr></table><br>
<a name="1009174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> is there a way of checking if ports are open?  <br></div><br>Like with the command-line tool netstat ?<br>I imagine so. <br><br></td></tr></table><br>
<a name="1009254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's some PureBasic code (sorry) I wrote not so long ago -- this shows the method for retrieving a netstat-like list of open ports:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Procedure.l IntFromAddress (ip$)
	ProcedureReturn inet_addr_ (@ip$)
EndProcedure

Procedure.s AddressFromInt (ip.l)
	ProcedureReturn PeekS (inet_ntoa_ (ip))
EndProcedure

Structure MIB_TCPROW
	dwState.l
	dwLocalAddr.l
	dwLocalPort.l
	dwRemoteAddr.l
	dwRemotePort.l
EndStructure

Structure MIB_TCPTABLE
	dwNumEntries.l
	*ips.MIB_TCPROW
EndStructure

#MIB_TCP_STATE_CLOSED = 1
#MIB_TCP_STATE_LISTEN = 2
#MIB_TCP_STATE_SYN_SENT = 3
#MIB_TCP_STATE_SYN_RCVD = 4
#MIB_TCP_STATE_ESTAB = 5
#MIB_TCP_STATE_FIN_WAIT1 = 6
#MIB_TCP_STATE_FIN_WAIT2 = 7
#MIB_TCP_STATE_CLOSE_WAIT = 8
#MIB_TCP_STATE_CLOSING = 9
#MIB_TCP_STATE_LAST_ACK = 10
#MIB_TCP_STATE_TIME_WAIT= 11
#MIB_TCP_STATE_DELETE_TCB = 12

tablesize = SizeOf (MIB_TCPTABLE)
*table.MIB_TCPTABLE = AllocateMemory (tablesize)

valid = #False

Repeat

	Select GetTcpTable_ (*table, @tablesize, #True)
		
		Case #NO_ERROR
			valid = #True
			
		Case #ERROR_INSUFFICIENT_BUFFER
			*table = ReAllocateMemory (*table, tablesize)

		Case #ERROR_INVALID_PARAMETER
			Debug "Param"

		Case #ERROR_NOT_SUPPORTED
			Debug "Not supported"

		Default
			Debug "Call GetError!"
		
	EndSelect

Until valid

*tcpinfo.MIB_TCPROW = @*table\ips

For loop = 0 To *table\dwNumEntries - 1

	If *tcpinfo\dwLocalPort And *tcpinfo\dwLocalAddr

		Debug "Local address: " + AddressFromInt (*tcpinfo\dwLocalAddr) + " [Port " + Str (ntohs_ (*tcpinfo\dwLocalPort)) + "]"

		If *tcpinfo\dwState = #MIB_TCP_STATE_LISTEN
			Debug "No remote connection! [Listening]"
		Else
			Debug "Remote address: " + AddressFromInt (*tcpinfo\dwRemoteAddr) + " [Port " + Str (ntohs_ (*tcpinfo\dwRemotePort)) + "]"
		EndIf
		
		Select *tcpinfo\dwState
	
			Case #MIB_TCP_STATE_CLOSED
				Debug "The TCP connection is in the CLOSED state that represents no connection state at all."
			Case #MIB_TCP_STATE_LISTEN
				Debug "The TCP connection is in the LISTEN state waiting for a connection request from any remote TCP and port."
			Case #MIB_TCP_STATE_SYN_SENT
				Debug "The TCP connection is in the SYN-SENT state waiting for a matching connection request after having sent a connection request (SYN packet)."
			Case #MIB_TCP_STATE_SYN_RCVD
				Debug "The TCP connection is in the SYN-RECEIVED state waiting for a confirming connection request acknowledgment after having both received and sent a connection request (SYN packet)."
			Case #MIB_TCP_STATE_ESTAB
				Debug "The TCP connection is in the ESTABLISHED state that represents an open connection, data received can be delivered to the user. This is the normal state for the data transfer phase of the TCP connection."
			Case #MIB_TCP_STATE_FIN_WAIT1
				Debug "The TCP connection is FIN-WAIT-1 state waiting for a connection termination request from the remote TCP, or an acknowledgment of the connection termination request previously sent."
			Case #MIB_TCP_STATE_FIN_WAIT2
				Debug "The TCP connection is FIN-WAIT-1 state waiting for a connection termination request from the remote TCP."
			Case #MIB_TCP_STATE_CLOSE_WAIT
				Debug "The TCP connection is in the CLOSE-WAIT state waiting for a connection termination request from the local user."
			Case #MIB_TCP_STATE_CLOSING
				Debug "The TCP connection is in the CLOSING state waiting for a connection termination request acknowledgment from the remote TCP."
			Case #MIB_TCP_STATE_LAST_ACK
				Debug "The TCP connection is in the LAST-ACK state waiting for an acknowledgment of the connection termination request previously sent to the remote TCP (which includes an acknowledgment of its connection termination request)."
			Case #MIB_TCP_STATE_TIME_WAIT
				Debug "The TCP connection is in the TIME-WAIT state waiting for enough time to pass to be sure the remote TCP received the acknowledgment of its connection termination request."
			Case #MIB_TCP_STATE_DELETE_TCB
				Debug "The TCP connection is in the delete TCB state that represents the deletion of the Transmission Control Block (TCB), a data structure used to maintain information on each TCP entry."
			
		EndSelect
		
		Debug ""
	
	EndIf
	
	*tcpinfo = *tcpinfo + SizeOf (MIB_TCPROW)
		
Next
</textarea> <br><br></td></tr></table><br>
<a name="1009267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Here's some PureBasic code <br></div><br>Yuck... :-p<br>But thanks :-)<br><br>That PHP(sic) dll is coming in quite handy.<br><br>On Linux, everything apparently lives in /proc/net/tcp<br><br>I'm still rummaging around for the Mac stuff. <br><br></td></tr></table><br>
<a name="1012415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is pretty nice, missed this thread origianlly, thanks Brucey for the work on this. Could come in very handy. <br><br></td></tr></table><br>
<a name="1016045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DavidDC</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now that I'm actually using this I wanted to add: what a wonderful, easy to use interface you've given us Brucey. Thank you! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
