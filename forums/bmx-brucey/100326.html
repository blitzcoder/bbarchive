<!DOCTYPE html><html lang="en" ><head ><title >zlib</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >zlib</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >zlib</a><br><br>
<a name="1183526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is the chance you could wrap the zlib library?  With or without the minizip extension. <br><br></td></tr></table><br>
<a name="1183551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wasn't zlib not already available as pub.zlib? <br><br></td></tr></table><br>
<a name="1183622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought that when I was searching for compression libraries as well.  I saw the zlib library web page and said "Wait, isn't that in pub.zlib?"  But when I looked I found that pub.zlib is just a tiny portion of zlib.  zlib has a lot more functionality than what is available in pub.zlib. <br><br></td></tr></table><br>
<a name="1183863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Direct TStream support would be a bit difficult, given that TStream is driven by Ints.<br><br>A libarchive module is probably the way forward…<br><br>… watch this space. <br><br></td></tr></table><br>
<a name="1183899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  zlib has a lot more functionality than what is available in pub.zlib. <br></div><br><br>What kind of functionality are you needing, exactly? <br><br></td></tr></table><br>
<a name="1183913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am trying to compress files into a zip (or other archive) on the fly.  Lots of files and files larger than the 2GB integer limit imposed by the file streams in Blitz.<br><br>Currently I am just copying all of the files to a directory tree.  I would like to push them into an archive on the fly.  The program I am writing is a backup program.<br><br>I use the Windows API for copying the files, so that files larger than 2GB can be copied. <br><br></td></tr></table><br>
<a name="1183924"></a>

<a name="1183925"></a>

<a name="1183926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> On Windows, it seems 64-bit seek/tell support requires msvcr80 as a minimum. Which doesn't bother me any, to add as a requirement... since that must date back to 2005 or somewhere in the distant past. <br><br></td></tr></table><br>
<a name="1183929"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> So instead of using a library, you should consider using a external/3rdparty tool which can be controlled by command line (7zip and others).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1183930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not really.<br>I've got no problems using libraries. It's more fun anyway :-)<br><br>libarchive turns out to be quite useful, and has a nice API to talk to a variety of different compression systems. <br><br></td></tr></table><br>
<a name="1183933"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok then I misinterpreted that "doesn't bother me ... since..." as irony.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1183950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Calling a third party tool a couple hundred thousand times while doing a complete backup would probably make my backups take 5 times longer than necessary.  I would rather leave them uncompressed and in a directory tree, than to do that.  Ideally though, I would open an archive and add files to it  at the backup destination.  Currently, I am just copying all of them and maintaining the directory tree.  With NTFS compression on, it isn't so bad, but when it is hundred of thousands of files, the OS handles it badly when you need to move or copy the files around.  One large archive file is much easier to manage. <br><br></td></tr></table><br>
<a name="1183958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> filehandling in win32-blitzmax is slow compared to linux (especially when you need the file access/creation/... date).<br><br>If you know the file size you could use the external file only in case of &gt;2gb files. For smaller ones you use the internal functions. In the case of compressing &gt;2gb of data, the time to call an external process should be ignorable.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1183960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm all for more choices... <br><br></td></tr></table><br>
<a name="1183962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> More choices which people will use to stress your nerves "ahh brucey XYZ is not working/cannot compile/is missing..." - if you erm.. _like_ to torture yourself that way :P.<br><br>Say if you need one to crack the binary whip. <br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1184097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, since BMax is not being updated anymore, it is easier for Brucey to keep his modules up to date. :)<br><br>I know I am glad I don't have to go change stuff in my ifsoGUI module because of BlitzMax changes anymore.<br><br>Derron not sure what you mean by calling an external function only for big files.  I either want to put ALL of the backed up files in one archive or not.  Not archive the individual files in the backup tree.  If I put them in an Archive, it would be best to do it progmatically so I can open the archive and add files to it while backing up, then close the archive when I am done.  If I were to use an external 7zip call, or some such thing, I would have to keep calling it to add each additional file as I went along.  That is what would be cumbersome and add a lot of backup time to the process which can already take a few hours to backup a server share that has 550,000 files. <br><br></td></tr></table><br>
<a name="1184217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> After being annoyed by my test app asking for msvcr80.dll when I introduced stream support (ah, so it did bother me!), I had a rummage through the mingw headers and found another way to get long file support for seek/tell, which appears to work (for now). <br><br></td></tr></table><br>
<a name="1184235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> @TaskManager.<br><br>I just meant: for each bigger file you tell an external packer to "add a file to an existing archive". For all smaller ones you will be able to use your internal routine. This will introduce many "file open/close"-calls. Exception is you sort by filesize before archiving.<br><br>But maybe this idea can went into the fog of forgotten tales ... if bruceys "way" is the right one.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1184261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I see what you mean now.  That would make sense, except that not being able to read long files keeps the existing zip modules form being able to access a zip file that is larger than 2GB, not just the files you want to put into it.<br><br>Anyway, I don't really mind not archiving the files, at least that method works.  Archiving just simplifies some stuff.<br><br>If I copy the file, I then have to redate the file.  I have to set the dates and times (created, modified, last accessed) of the newly copied file to be the same as the old ones.  That isn't difficult, but it adds a step of opening the source file, reading the dates, opening the destination file, writing the dates.  For each file.  If it were put into an archive, those dates are maintained automatically by the archiving/dearchiving process.<br><br>Also, as I stated before, if I decided to delete or move an archive directory, the file system handles one file MUCH MUCH better than it does 500,000 files and directories.  Even if it is a huge file.<br><br>Anyway, it isn't keeping me from moving forward and if an archiving solution comes about, I will be able to easily implement it. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
