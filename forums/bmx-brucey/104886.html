<!DOCTYPE html><html lang="en" ><head ><title >BlitzMax on iOS</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BlitzMax on iOS</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >BlitzMax on iOS</a><br><br>
<a name="1273627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hot-on-the-heels of getting DX9 working in bmx-ng, I thought I'd have a bash at iOS.<br><br>Getting code to compile correctly turned out to be the easier part of the mission.<br><br>As far as can see there are three possible targets for iOS : armv7, arm64 and x86 (simulator).<br>Apparently armv7 will work on all devices since the iPhone4...<br>But for now I've been concentrating on the simulator, as it doesn't require me to pay for a dev license to test it.<br><br>Dynamically building the xcode project has been a trickier part to get right, involving a bit of trial and error and looking at other's project files for inspiration. We're pretty much there now though, and it is happily populating things in the right place.<br>There are lots of possibilities for customisation though, which can be looked into at a later date (like folders of stuff you want auto-packaged into the bundle, etc)<br><br>The biggest hurdle so far has been SDL.GL2SDLMax2D, which has refused to render *any* graphics whatsoever, and since there's so much going on in there, it's hard to work out where it actually isn't working. :-(<br><br>However, I knocked together a small test program which renders a coloured rectangle on the screen, and it is working as expected ! :-)<br>Which proves that, in theory at least, iOS is definitely a viable target.<br><br>SDL.GL2SDLMax2D is already known to work on the Pi and Android so it's a bit of a puzzle why it's not rendering anything on iOS...<br><br>If anyone has any wild or crazy ideas, I'm more than happy to listen to them. <br><br></td></tr></table><br>
<a name="1273884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FabriceW</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since XCode 7 beta you no longer need an apple dev membership to test on the device.  <a href="http://bouk.co/blog/sideload-iphone/" target="_blank">http://bouk.co/blog/sideload-iphone/</a> <br><br></td></tr></table><br>
<a name="1273889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting! Thanks ;-) <br><br></td></tr></table><br>
<a name="1273893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's all a bit like some mysterious magic stuff... when everything just seems to work...<br><img src="http://brucey.net/programming/blitz/bmx_ng/pics/digesteroids_ng_ios_sim.png"><br>(running on iOS simulator, *with sound*!)<br><br>One has to be somewhat impressed with Skid's freeaudio module, which so far has played on every platform without issue. Go Skid! :-D <br><br></td></tr></table><br>
<a name="1273894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's pretty awesome... <br><br></td></tr></table><br>
<a name="1273896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow! <br><br></td></tr></table><br>
<a name="1273899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Magical indeed :)<br>But I guess user input will be a lot more difficult than just getting MouseHit(), MouseX() etc? <br><br></td></tr></table><br>
<a name="1273900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But I guess user input will be a lot more difficult than just getting MouseHit(), MouseX() etc?  <br></div><br>Depends if you want to support multi-touch or not? Otherwise, MouseX() and co reflect the "first" touch input.<br><br>For the breakout sample, when your finger touches the screen and move the bat across it, you are effectively holding down the mouse button while you move - think, click-and-drag.<br><br>So yes, you may need to adapt your mouse input stuff, but it's not so hard. You can catch the initial "down" when the user touches the screen and do something then if you like. Unlike moving your mouse cursor around the screen, the cursor will appear to "jump" around from place to place as the user touches different parts of the screen.<br><br>I added some new events for BlitzMax to help with multi-touch stuff (on top of the mouse handling which already works) :<br><pre class=code>
Const EVENT_TOUCHMASK=$40000
Const EVENT_TOUCHDOWN=$40001
Const EVENT_TOUCHUP=$40002
Const EVENT_TOUCHMOVE=$40003
</pre><br>Rather than a button number in the event you will get a touch id, which you can use to track multiple fingers at the same time. <br><br></td></tr></table><br>
<a name="1273901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can only synopsize some of the earlier comments:<br>Wow, that's pretty awesome! <br><br></td></tr></table><br>
<a name="1273905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very interesting! <br><br></td></tr></table><br>
<a name="1273956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Panno</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great ! <br><br></td></tr></table><br>
<a name="1274571"></a>

<a name="1274572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks to the generosity of some members of the community, I can now work directly with iOS hardware, rather than just the simulator... <i>(donations generally go directly towards improving the tools and environment I have at my disposal for creating all this stuff I churn out. ;-)</i><br><br><iframe width="560" height="345" src="http://www.youtube.com/embed/p452Fcc6SSM" frameborder="0" allowfullscreen></iframe><br><br>Nice to see my virtual joystick stuff actually seems to work! :-D<br><br><pre class=code>
SuperStrict

Framework sdl.gl2sdlmax2d

Import sdl.virtualjoystick


Local joy:TRenderedJoystick = TRenderedJoystick(New TRenderedJoystick.Create("VJ", 100, 680, 50, 20))
joy.AddButton(900, 680, 30)
joy.AddButton(970, 620, 30)


Graphics 1024, 768, 0

SetBlend alphablend

SetClsColor 255, 255, 255
SetColor 0, 0, 0

While Not KeyDown(key_escape)

	Cls
	
	' draw joystick
	joy.Render()
	
	' get some stats
	SetColor 0, 0, 0
	
	Local x:Float = JoyX()
	DrawText "JoyX : " + x, 100, 300
	DrawLine 150, 330, 150, 360, False
	DrawRect 150, 330, x * 50, 30
	
	Local y:Float = JoyY()
	DrawText "JoyY : " + y, 300, 300
	DrawLine 260, 310, 290, 310, False
	DrawRect 260, 310, 30, y * 50
	
	If JoyDown(0) Then
		DrawText "Button 0 : DOWN", 100, 380
	Else
		DrawText "Button 0 : UP", 100, 380
	End If

	If JoyDown(1) Then
		DrawText "Button 1 : DOWN", 100, 400
	Else
		DrawText "Button 1 : UP", 100, 400
	End If

	Flip
Wend


Type TRenderedJoystick Extends TVirtualJoystick

	Method Render()
		If touchId &lt;&gt; -1 Then
			SetColor 200, 200, 100
		Else
			SetColor 100, 200, 100
		End If
		DrawOval centerX - radius, centerY - radius, radius * 2, radius * 2
		
		SetColor 100, 100, 200
		DrawOval xPos - knobRadius, yPos - knobRadius, knobRadius * 2, knobRadius * 2
		
		For Local i:Int = 0 Until buttons.length
			Local button:TVirtualButton = buttons[i]
			If JoyDown(i) Then
				SetColor 255, 100, 100
			Else
				SetColor 100, 100, 100 + i * 50
			End If
			DrawOval button.centerX - button.radius, button.centerY - button.radius, button.radius * 2, button.radius * 2 
		Next
	End Method

End Type
</pre> <br><br></td></tr></table><br>
<a name="1274643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey, I must admit I feel 'joy'seeing the simple&amp;dear&amp;old BlitzMax syntax of the source code and the result running on an 'alien' device like iOS.<br>In MX this feeling is still missing... <br><br></td></tr></table><br>
<a name="1274644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is the iOS simulator available on Mac?<br><br>Nice video demo - I thought it was better with no sound though - sort of distracting.<br><br>I didn't know you could do "Typename( New Typename.Create(arg) )". How is that better than a Create function?<br><br>Anyway great progress! It's all looking very cool. <br><br></td></tr></table><br>
<a name="1274649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Is the iOS simulator available on Mac? <br></div><br>Yes. I was developing against that until recently (x86/x64 targets).<br>However, building for the devices themselves raised different issues that I was unaware of until now.<br><br><div class="quote"> How is that better than a Create function? <br></div><br>This way I am creating an instance of my subclass and initialising it. The Create method itself is part of the superclass.<br>A create function would define a particular Type to create an instance of. This way, I am free to subclass and instantiate as I please, which is much more flexible.<br>Of course, you could also do the following if you aren't using any subclass-specific functionality :<br><pre class=code>
Local joy:TVirtualJoystick = New TRenderedJoystick.Create("VJ", 100, 680, 50, 20)
</pre> <br><br></td></tr></table><br>
<a name="1274652"></a>

<a name="1274655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyhoo, here's Digesteroids running on the iPad Mini with the virtual joystick for input ...<br><br><iframe width="560" height="345" src="http://www.youtube.com/embed/N13chC3_xmE" frameborder="0" allowfullscreen></iframe><br><br>As you can probably see, there's some potential for getting BlitzMax games on iOS ;-) <br><br></td></tr></table><br>
<a name="1274654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very Nice and keep good work up :-) <br><br></td></tr></table><br>
<a name="1274658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome!  What's next?  BMax on XBone and PS4!?  :D <br><br></td></tr></table><br>
<a name="1274693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> @brucey: it's doable a patron page(or like) for supporting BMX.NG or there could be a potential conflict with BRL? <br><br></td></tr></table><br>
<a name="1274703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> TBH I cant see a patron page conflicting with BRL as its not their code its Bruceys, also Mark has abandoned this forum ages ago so I dont see it as a issue anymore. <br><br></td></tr></table><br>
<a name="1274704"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not have doable a patron page for Brucey<br><br>Win to win situation for Brucey :-) <br><br></td></tr></table><br>
<a name="1274940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  What's next? BMax on XBone and PS4!? <br></div><br>Of those, more likely PS4, but unlikely just the same (although PS4 is running on top of BSD which isn't too far away from Linux) :-p<br><br>I will probably add support for nacl (Chrome OS/Chrome browser) at some point since SDL already supports it.<br><br>iOS is coming along. Did some work on lib and framework importing today, which made BASS useable, so I made a little app streaming internet radio on the iPad.<br><br>Very cool how you can build and run your app for desktop, then re-compile for iOS and it *just works* :-)<br>It's something I've always enjoyed with BlitzMax - the ability to switch platform and see your app running the same. And is more-or-less what I demand of NG - that you shouldn't need to change much (platform specific caveats aside), if anything, to run your stuff on the "new" platforms. <br><br></td></tr></table><br>
<a name="1275016"></a>

<a name="1275029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was (mostly) kidding, but I'm surprised PS4 is more likely.<br><br>Out of curiosity, is it possible to make a stand-alone NG compiler?  One that requires no other installs (MinGW, SDL, etc.)? <br><br></td></tr></table><br>
<a name="1275039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Out of curiosity, is it possible to make a stand-alone NG compiler? One that requires no other installs (MinGW, SDL, etc.)?  <br></div><br><br>MinGW is only necessary to (re)compile modules, so if you have a compiled version of the mods and don't intent to add any others then you shouldn't need MinGW I'd think. <br><br></td></tr></table><br>
<a name="1275041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm surprised PS4 is more likely. <br></div><br>PS4 builds with Clang/LLVM, as does Apple's OSX and iOS.<br><br><br><div class="quote"> is it possible to make a stand-alone NG compiler? One that requires no other installs (MinGW, SDL, etc.)? <br></div><br>Yes, one could probably drop a copy of MinGW into BlitzMax/MinGW32, and add some of the other modules to it for some kind of basic Windows distribution. <br><br></td></tr></table><br>
<a name="1275097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> one could probably drop a copy of MinGW into BlitzMax/MinGW32 <br></div>Ah, cool.  Wasn't sure if that was a legal distribution method.  What about other platforms?  Would that be Clang/LLVM instead? <br><br></td></tr></table><br>
<a name="1275102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Wasn't sure if that was a legal distribution method.  <br></div><br>BlitzMax already ships with MinGW components.<br><br><div class="quote">  What about other platforms? Would that be Clang/LLVM instead?  <br></div><br>No. Unless you go to the trouble of creating your own custom distro of clang/gcc then it's easier just to use the compiler tools available on the system (XCode on Mac, GCC (or perhaps clang/llvm) on Linux. <br><br></td></tr></table><br>
<a name="1275299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> BlitzMax already ships with MinGW components <br></div>Oh?  I couldn't see anything obvious (no MinGW directory), but I'll take your word for it.<br><br>How difficult would it be to add true first class functions to Blitz? <br><br></td></tr></table><br>
<a name="1275300"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  How difficult would it be to add true first class functions to Blitz?  <br></div><br>I've no idea. Ask Yasha :-) <br><br></td></tr></table><br>
<a name="1275301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I've no idea. Ask Yasha <br></div>Bah! <br><br></td></tr></table><br>
<a name="1275532"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's all rather exciting as the various parts come together :-)<br><br>Wake/sleep handling is now working.<br>The on-screen keyboard interacts well with BlitzMax's key stuff.<br>Fixed some 64-bit lua issues over the weekend, so it's running well now on iOS - I've been using Derron's TVTower game (https://github.com/GWRon/TVTower) as a testbed since it's huge, complex, has lua support, etc. The code only requires a couple of minor tweaks to run on iOS (graphics driver, logging), but it's now running very stable. Of course, the UI/interaction will need some work to be more touch friendly, but that is to be expected really. I was surprised it runs at a solid 60fps, considering how inefficient Max2D generally is.<br><br>One really nice thing XCode gives you is a fantastic depth of profiling information. You can snapshot the app any time and it will flood you with warnings (and detailed explanations) about the code, highlighting the lines of code, and ways you might want to change it to make it better... <br><br></td></tr></table><br>
<a name="1275635"></a>

<a name="1275636"></a>

<a name="1275638"></a>

<a name="1275639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, this <i>IS</i> interesting.  I'm hoping that this will make porting my game engine to the major platforms...less painful, anyway.  All along, I've assumed that I'd have to translate everything to C or C++, but I would love to be wrong about that!<br><br>I'm using LuaJIT for scripting and have recently learned how to get better performance - Yasha's right when he sings its praises.  So I'd have to get Zeke's module working.  Is there a page somewhere that has a list of things to watch out for (for those of us used to standard BMX)?  Did I read something earlier about Byte Ptr not working with 64-bit?  I use them often... <br><br></td></tr></table><br>
<a name="1275859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> (a modified) LuaJIT appears to work fine in 64-bit BlitzMax.<br><br>I'll add it to the bmx-ng repo at some point. <br><br></td></tr></table><br>
<a name="1275869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> (a modified) LuaJIT appears to work fine <br></div>Modified in what way? <br><br></td></tr></table><br>
<a name="1275870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I meant the module, rather than luajit itself :-) <br><br></td></tr></table><br>
<a name="1275871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know, that was what I meant.  What has to change in standard BMX code in order to use it with NG? <br><br></td></tr></table><br>
<a name="1275873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh :-)<br><br>Anything that refers to size_t in the API should be Long for 64-bit platforms. Also, externed Types should be wrapped instead.<br><br>Otherwise, it should work as normal.<br><br><br>Lugi, on the otherhand, would probably require a major rewrite - as it accesses BlitzMax Objects at a very low level, and I've rewritten the object internals for NG to use a different GC.<br>(A modified) MaxLua does work though (see paragraph 2 above) :-) <br><br></td></tr></table><br>
<a name="1275874"></a>

<a name="1275875"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, okay.  I am not using Lugi, but I am using BBObject and the like for exposing objects.  I suppose I'd have to know how the new GC works.<br><br>My current garbage collection function for exposed Lua userdata:<br><pre class=code>int __gc_object( lua_State *state ) {
    BBObject **obj = (BBObject**)lua_touserdata( state, 1 );
    BBRELEASE(*obj);
    *obj = NULL;
    return 0;
}</pre><br>I've minimized the C code required and there are no instances of <i>size_t</i> (and no externed types), but I am using <i>int</i> - am I right to assume that doesn't matter? <br><br></td></tr></table><br>
<a name="1275879"></a>

<a name="1275880"></a>

<a name="1275881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's no need for your Null set there, unless you are specifically checking for it somewhere else?<br><br>Ints are fine, as long as you aren't using them for pointers.<br><br>For specific 64-bit changes, look for ?ptr64 here : <a href="https://github.com/bmx-ng/zeke.mod" target="_blank">https://github.com/bmx-ng/zeke.mod</a> <br><br></td></tr></table><br>
<a name="1275884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> unless you are specifically checking for it somewhere else? <br></div>BBRELEASE works for BlitzMax GC, but Lua's GC also needs to release it.  It's a metatable function.<br><br>Thanks for the link; I'll definitely want to look into this stuff soon.  Just wish I had all the hardware for testing... <br><br></td></tr></table><br>
<a name="1275902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Lua's GC also needs to release it. <br></div><br>I thought that was why this function would be called? - because Lua was GC'ing anyway. <br><br></td></tr></table><br>
<a name="1275933"></a>

<a name="1275934"></a>

<a name="1275946"></a>

<a name="1275947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps you're right; don't think it's hurting anything, either.  I've put a comment by it to check into when I run through gc testing again.  :) <br><br></td></tr></table><br>
<a name="1275961"></a>

<a name="1275962"></a>

<a name="1275963"></a>

<a name="1275968"></a>

<a name="1275970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should the modified LuaJIT be working with original BlitzMax?  Since the link you posted had a later version of LuaJIT (and one that might actually solve an issue I'm having), I decided to give it a try.  The module built just fine, but when I tried to make an executable, I got some undefined references.<br><br>C:/BlitzMax/mod/zeke.mod/luajit.mod/lib/win32/libluajit_x86.a(lib_os.o):lib_os.c:(.text+0x10e): undefined reference to `_difftime32'<br>C:/BlitzMax/mod/zeke.mod/luajit.mod/lib/win32/libluajit_x86.a(lib_os.o):lib_os.c:(.text+0x548): undefined reference to `_time32'<br>C:/BlitzMax/mod/zeke.mod/luajit.mod/lib/win32/libluajit_x86.a(lib_os.o):lib_os.c:(.text+0x600): undefined reference to `_localtime32'<br>C:/BlitzMax/mod/zeke.mod/luajit.mod/lib/win32/libluajit_x86.a(lib_os.o):lib_os.c:(.text+0x8ab): undefined reference to `_gmtime32'<br>C:/BlitzMax/mod/zeke.mod/luajit.mod/lib/win32/libluajit_x86.a(lib_os.o):lib_os.c:(.text+0x8e8): undefined reference to `_time32'<br><br>What should I do about this?  I'm using TDM 4.7 - could that be the problem?<br><br>EDIT: Tried updating TDM to 5.1 and still not working.<br><br>EDIT2: I'm guessing that the .a just needs to be recompiled. <br><br></td></tr></table><br>
<a name="1275971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's built with TDM 5.1 64-bit.<br><br>Yes, a recompile with a different version would probably sort it. <br><br></td></tr></table><br>
<a name="1276002"></a>

<a name="1276004"></a>

<a name="1276007"></a>

<a name="1276008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I guess I don't know how to do that.  Thought "gcc -o Makefile luajit.c" from the terminal would do it...  :(<br><br>EDIT: "mingw32-make", by itself, generates a .dll and .exe, but no static libs.  Keep finding sources that say it should be spitting out .a libs.  :/ <br><br></td></tr></table><br>
<a name="1276013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just edit the makefile.<br><br>Look for the line :<br><pre class=code>
BUILDMODE= mixed
</pre><br>And change it to static.<br><br>Or comment out that line and uncomment the following one... <br><br></td></tr></table><br>
<a name="1276016"></a>

<a name="1276017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, guess I read that wrong.  I thought "mixed" meant it would create both.  I did as you suggested and got another error message related to making the exe...however...it DID build the static lib.<br><br>Unfortunately, the undefined references from above are still there.  :( <br><br></td></tr></table><br>
<a name="1276018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> As far as I am aware, if you build everything with the 32-bit TDM, you shouldn't have an issue as it won't suffix those functions with 32. <br><br></td></tr></table><br>
<a name="1276031"></a>

<a name="1276035"></a>

<a name="1276036"></a>

<a name="1276048"></a>

<a name="1276051"></a>

<a name="1276052"></a>

<a name="1276053"></a>

<a name="1276054"></a>

<a name="1276055"></a>

<a name="1276058"></a>

<a name="1276060"></a>

<a name="1276075"></a>

<a name="1276076"></a>

<a name="1276077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> EDIT: Wtf moment...rescinded!<br><br>EDIT 2: Compiling problem resolved, but I think I'm getting too old for this...<br><br>EDIT 3: Finding lots of instances of size_t in luajit.mod - what has been "modified?" <br><br></td></tr></table><br>
<a name="1276159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  what has been "modified?" <br></div><br>See post #39 above. <br><br></td></tr></table><br>
<a name="1276168"></a>

<a name="1276169"></a>

<a name="1276170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did see that post, but it was unclear to me what you meant.  I thought there were changes in the luajit C source.<br><br>Anyhoo, the luajit ffi stuff is not 100% working and now I'm trying to track down why... <br><br></td></tr></table><br>
<a name="1276172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nah, there are no changes to the library itself.<br><br>The examples were working fine, so I assumed it was okay. <br><br></td></tr></table><br>
<a name="1276173"></a>

<a name="1276174"></a>

<a name="1276193"></a>

<a name="1276194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've learned somewhat recently that FFI (not used in the examples, I think) allows you to directly call C functions and they get inlined with the JIT.  It's very fast and better, in theory, than using the C API.  In the process of switching over, I ran into an issue that I thought updating to the most recent version of LuaJIT (I was still using 2.0.1) would fix - but the issue is still there.  I have to assume I'm still doing something wrong...<br><br>EDIT: Think I've just confirmed the ffi part is not fully functional, but I'll post an update tomorrow. <br><br></td></tr></table><br>
<a name="1276244"></a>

<a name="1276245"></a>

<a name="1276251"></a>

<a name="1276253"></a>

<a name="1276255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I'm almost sure that ffi in the module is not working - at least not for cdata and ctype.  LuaJIT allows you to create cdata objects and work with them directly and attach metamethods to them, just like userdata.  Unfortunately, I've discovered that the ctypes are not recognized and that means the __index and __newindex metamethods are not getting called properly.<br><br>Just in case you're curious, here's an example Lua script...<br><pre class=code>local ffi = require( "ffi" )

ffi.cdef[[
struct foo { int a, b; };
]]

local tt = ffi.new( "foo", 5, 8 )

print( " ----- " )
print( tt.a )
print( type( tt ) )
print( ffi.typeof( tt ) )
print( " ----- " )</pre>I am expecting the result to be...<br><br>&gt;  -----<br>&gt; 5<br>&gt; cdata<br>&gt; foo     &lt;-- or maybe "struct foo"<br>&gt;  -----<br><br>Instead, the lines above and below "cdata" are blank.<br><br>Sorry for diverging from the thread topic.  The truth is that JIT is turned off on iOS (and consoles).  It may not be the best option for all platforms, but I'm not aware of a better one.  It's too bad because except for these caveats, LuaJIT is pretty awesome. <br><br></td></tr></table><br>
<a name="1276257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> What happens when you declare your struct like this? :<br><pre class=code>
typedef struct { int a, b; } foo;
</pre> <br><br></td></tr></table><br>
<a name="1276258"></a>

<a name="1276259"></a>

<a name="1276260"></a>

<a name="1276261"></a>

<a name="1276264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Same thing... I've tried many combinations and have been following working examples from the LuaJIT forums.<br><br>I don't know how the mod could be responsible for this - I don't see any connection.  This is a simple example, of course.  What I was trying to do was use BBArray directly and was pleasantly surprised when the __len meta method worked.  Then, of course, I was deflated when the __index meta method did not.  :/<br><br>The type is not getting recognized, so that explains it, but it would be nice to find a solution. <br><br></td></tr></table><br>
<a name="1276265"></a>

<a name="1276266"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, that's interesting. When I tried it with the above def I got this on OS X :<br><pre class=code>
 ----- 
5
cdata
ctype&lt;struct 95&gt;
 ----- 
</pre><br><br>... and the same result on Windows 7. <br><br></td></tr></table><br>
<a name="1276270"></a>

<a name="1276271"></a>

<a name="1276278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ugh.  Okay, I'll look elsewhere...  Thanks for looking into it, though.<br><br>EDIT: I'm embarrassed to say this was just my replacement "print" function.  Not related to my original problem at all. <br><br></td></tr></table><br>
<a name="1276290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> So your problem is this?<br><div class="quote">  What I was trying to do was use BBArray directly... <br></div><br><br>In case you hadn't noticed, the BBArray struct does not actually define the whole of the contents of your array. 'scales' is a variable size, and the data comes somewhere after that.<br><br>Unfortunately, I don't understand much of the innards of lua (like what are all these double-underscore variables), to be of too much help. <br><br></td></tr></table><br>
<a name="1276293"></a>

<a name="1276294"></a>

<a name="1276296"></a>

<a name="1276297"></a>

<a name="1276299"></a>

<a name="1276389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's okay.  I appreciate what you have done and just by testing it (and exposing my blunder), you steered me away from spending too much time looking in the wrong place.<br><br><div class="quote"> So your problem is this? <br></div>Sort of.  There's a bit more to it.<br><br>--<br><br>All of this is already working using the C API and userdata, but I wanted best possible performance and that's where ffi came in.  However, ffi is incompatible with the stack and you need the stack to make userdata.  Another option is just to push every single object as userdata, but I'd prefer to avoid that.<br><br>Certain objects (table, userdata, and cdata) can have metatables/methods attached to them with double-underscore-prefixed keys that are accessors.<br><pre class=code>x = foo.bar ..... triggers __index, if it exists
foo.bar = x ..... triggers __newindex, ..
#a .............. triggers __len, ..
a + b ........... triggers __add, ..
etc.</pre>The BBArray was another test case.  This works right now, with the correct typedefs in ffi.cdef...<br><pre class=code>local arrayMT = {
  __len = function( self )
    return self.scales[0]
  end
}

local arrayType = ffi.metatype( "BBArray", arrayMT )</pre><br>The __index metamethod wasn't triggering properly, but I have made some steps in the right direction and am no longer convinced the mod is the issue. <br><br></td></tr></table><br>
<a name="1276354"></a>

<a name="1276356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got it sorted now, thanks for your help (and sorry for the noise)! <br><br></td></tr></table><br>
<a name="1278710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, simply amazing! <br><br></td></tr></table><br>
<a name="1278719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey, you rock! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
