<!DOCTYPE html><html lang="en" ><head ><title >wxListCtrl and Vista Styles</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >wxListCtrl and Vista Styles</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >wxListCtrl and Vista Styles</a><br><br>
<a name="955193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I published my application using the Blide publisher which has the option to enable visual styles so that the app fits either winxp or vista gui styles. If I do this though large icons in list controls don't appear for some reason, the list box is just blank.<br><br>I have a feeling that this is just a wxWidgets problem but thought I'd post just in case. <br><br></td></tr></table><br>
<a name="955316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Enablig styles on the Publisher, you tell windows to use the latest windows forms controls version, instead of the 98-compatbiel default API versions. This is the only diference, so it seems that somehow the wxListCtrl does not handle well images depending on the underlying windows controls. Ayway, Brucey may have more infor on this? <br><br></td></tr></table><br>
<a name="955352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know if it makes any difference if the wx.rc file is included?, and I don't know how you might include this as part of a build?<br><br>include/wx/msw/wx.rc<br><br>I'm certainly not an expert when it comes to Win32 things... <br><br></td></tr></table><br>
<a name="955394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> wx.rc is not a pre-copiled resource file? Creating the corresponding .o file and including it should work but, if I'm not wrong, what it'll do is to add the maniffest file to the EXE, the same BLIde Plublisher does, so I'm 90% sure the issue is not related to this, unless the rc file really adds anything else apart from the maniffest and maybe an icon.<br>Maybe if you provide a bit of source code, we can give it a try? Maybe a small app replicating the issue? <br><br></td></tr></table><br>
<a name="955452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried publishing the sample listctrl that comes with wxwidgets and it seems ok, although the sample does have other issues - but its always been like that for me. <br><br>I'll have a play around and see if I can replicate the problem with a small smaple. <br><br></td></tr></table><br>
<a name="955467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  although the sample does have other issues <br></div><br>What are those? (apart from perhaps being an incomplete implementation of the original C++ - which I put down to the tedium of porting C++ to BlitzMax :-p ) <br><br></td></tr></table><br>
<a name="955574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you select icon view then the list view is still there, and you can't actually click on the large icons. Easier to show with a pic:<br><br><img src="http://peterigz.myzen.co.uk/listctrl.jpg"> <br><br></td></tr></table><br>
<a name="955576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That looks *really* ill...<br><br>This is an exe built on Vista, or does it happen to the exe if it is built on XP first? <br><br></td></tr></table><br>
<a name="955577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you try this <b><a href="http://brucey.net/programming/blitz/misc/stuff/listctrl_cpp_290.rar" target="_blank"> listctrl_cpp_290.rar</a></b>?<br><br>It's the C++ listctrl sample built from my latest static libraries on XP.<br><br>If anything is going to work properly, it should be this one.<br><br>Thanks.<br><br><br><br>Also.. maybe ziggy knows what this is doing (which it adds to the final exe :<br><pre class=code>
windres --use-temp-file -ilisttest.rc -ogcc_mswu\listctrl_listtest_rc.o    --define __WXMSW__      --define _UNICODE  
--define wxUSE_GRAPHICS_CONTEXT=1 --include-dir .\..\..\lib\gcc_lib\mswu --include-dir ./../../include --include-dir .  
--include-dir ./../../samples --define NOPCH
</pre><br>...creating the resource stuff, I expect.. <br><br>and the contents of that temp-file :<br><pre class=code>
aaaa     ICON "mondrian.ico"
mondrian ICON "mondrian.ico"
#include "wx/msw/wx.rc"

icon1       ICON    "bitmaps/toolbrai.ico"
icon2       ICON    "bitmaps/toolchar.ico"
icon3       ICON    "bitmaps/toolchec.ico"
icon4       ICON    "bitmaps/tooldata.ico"
icon5       ICON    "bitmaps/toolgame.ico"
icon6       ICON    "bitmaps/toolnote.ico"
icon7       ICON    "bitmaps/tooltime.ico"
icon8       ICON    "bitmaps/tooltodo.ico"
icon9       ICON    "bitmaps/toolword.ico"

iconsmall   ICON    "bitmaps/small1.ico"
</pre><br>nothing very exciting there...<br><br>But I wonder if all this shouldn't be part of a wxMax build for Windows... or does it not really matter? <br><br></td></tr></table><br>
<a name="955590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> cool, I'll give it a go tomorrow and let you know. <br><br></td></tr></table><br>
<a name="955712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Brucey: It is embeding the icons as EXE resources AFAIK, mondrian.ico is defined as the executable icon, while the others are just stored one after the other (for runtime referencing). I supose it is getting them at runtime to display them. It's strange it seems not to be adding also a manigest file. Do you have any xml file with the extension maniffest in the source code of the sample? If you do, can you add it to the wx.rc file and see if that changes anything? I can't remember wich has to be the index of the resource for embeded xml maniffest files, but I can take a look to it tomorrow at my house (I'm out for some days). It would be easier to track the issue if you import maxGUI also in a sample and see if it interfere, as maxGUI integrates its own .o resource file, so it may be 'hiding' the pre-built one in the sample. I would recommend to either include the propper manifest file in the sample, in the same resource compiled file, to avoid this problem, or to make the sample use incbined resources instead of embeded .o resources. Just my 2 cent... :) <br><br></td></tr></table><br>
<a name="955715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tried that cpp one and it worked fine. I use Vista btw. <br><br></td></tr></table><br>
<a name="955725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Tried that cpp one and it worked fine <br></div><br>Well... either that's unfortunate (because there's something else going on), or 2.9.0 has some fixes.<br><br>I assume all your tests until now have been with wxMax 2.8.x ?<br><br>Righty... here's the same sample but compiled with 2.8.9 : <b><a href="http://brucey.net/programming/blitz/misc/stuff/listctrl_cpp_289.rar" target="_blank"> listctrl_cpp_289.rar</a></b>.<br><br>See how you get on with that? :-) <br><br></td></tr></table><br>
<a name="955762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Rigz</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> that one works fine too.<br><br>My wx is 2.8.9 aswell I think, how can I double check? Pretty sure I SVN'd it when you upgraded it to that. <br><br></td></tr></table><br>
<a name="955764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Brucey: I think I know what's happening here. The icon.o resource is replacing the listctrl_listtest_rc.o at link time, as EXEs on windows only support ONE accesible resource file embeded (remember the discussion on the dev team forum about embeding the manifest files in iverse order becouse of maxgui breaking some third party tools with Mark, Sebhol and I becouse of this exact problem some months ago, and how this was fixed)<br> <br>This sample is not compatible with the BLIde Publisher, or any other publisher or module that integrates a resource file with icons and a manifest file.<br>I'm very sure you'll be able to replicate the issue by importing the XPmainfest.o file of the MaxGUI module (under maxgui.mod/win32maxguiexe.mod) in the sample. Doing this simple import will replicate the issue, if it is a problem with resource embeding (wich I'm 90% sure). If it does not replicate it, then it's time to look somewhere else! (you should import the XPmanifest file AFTER the module import!) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
