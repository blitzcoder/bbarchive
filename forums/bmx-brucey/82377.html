<!DOCTYPE html><html lang="en" ><head ><title >Native unicode file support in BlitzMax</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Native unicode file support in BlitzMax</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >Native unicode file support in BlitzMax</a><br><br>
<a name="928783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, thought it was worth giving it a go, and see how we'll get on...<br>( I'm doing it in this forum just to keep out of the way )<br><br>First things first, I'll probably just hack in some "tweaks" to get something working.<br>Then I imagine it's a case of putting forward the proposal for acceptance proper ;-)<br><br>So... what are the current issues?<br><br>1) <b>Complete lack of non-ascii file/dir support on all platforms.</b> (indeed... issues on Mac too!)<br><br><br>Possible ways to fix issues<br><br>A) <b>Implement on-the-fly Max (Wide) strings -&gt; UTF-8 String conversion where required.</b> (and back again, probably)<br>B) <b>Implement native unicode functions where required. </b><br><br>... anything else?<br><br>Oh, I'll need some volunteers to test this on systems where there are currently problems. There's only so much "pretend" folder naming I can do myself.<br>Please !?<br><br><br>fun fun ;-) <br><br></td></tr></table><br>
<a name="928788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm all for <b>A)</b> because I'm desperate to get BlitzMax core support for UTF8&lt;-&gt;Wide string conversion.<br>At the moment, each module that requires it, implements its own function.  Messy. <br><br></td></tr></table><br>
<a name="928796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh... seems the unicode friendly functions on Windows are only available from : Win NT, Win 2000, Win XP + ...<br><br>That's a shame... <br><br></td></tr></table><br>
<a name="928811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice!<br><br><div class="quote"> seems the unicode friendly functions on Windows are only available from : Win NT, Win 2000, Win XP + ... <br></div><br>Unless you make use of <a href="http://www.microsoft.com/globaldev/handson/dev/mslu_announce.mspx" target="_blank">MSLU (Microsoft Layer for Unicode)</a>. In case you haven't heard of it before, it allows wide character functions to be called on the older Windows 9X OSs. I got Mark to include <a href="http://libunicows.sourceforge.net/" target="_blank">libunicows</a> into the last BlitzMax v1.30 release for <b>MaxGUI.Win32MaxGUI<u>Ex</u></b>, so you can just import it using something like...<br><br><pre class=code>Import "-lunicows"</pre>...and then you can use all the wide-character Win32 API functions providing that a <a href="http://www.microsoft.com/downloads/details.aspx?FamilyID=73BA7BD7-ED06-4F0D-80A4-2A7EEAEE17E2&amp;displaylang=en" target="_blank">unicows.dll</a> is distributed alongside the EXE or the Windows 9X users have MSLU installed on their system. The downside is that if the end-user has neither of the above, then they can't run the EXE.<br><br>Don't know if this helps... Obviously it would be nice if it were possible to do this without breaking Windows 9X support immediately but if needs-must. <br><br></td></tr></table><br>
<a name="928813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> But do you have to Import that only if you are using the dll?<br>How do you know when to include it? Have a 9x specific build? <br><br></td></tr></table><br>
<a name="928816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> do you have to Import that only if you are using the dll?<br>How do you know when to include it? Have a 9x specific build?  <br></div><br>The idea is that you import it regardless and the library should check the platform and only require the DLL (or MSLU package install) if you are on the older OSs. On Windows 2000/XP/Vista it should just use the internal system DLLs like it normally would.<br><br>To reiterate, if you import the library, Windows 2000/XP/Vista users will not require the DLL.<br><br>It sounded like the perfect excuse to ditch <b>MaxGUI.Win32MaxGUI</b>, but the emulation layer is not quite as polished as the UI integrated into Windows 9X and it that specific library (<a href="http://libunicows.sourceforge.net/" target="_blank">libunicows</a>) simply terminates you program if the DLL isn't found on the older OSs. There is no way of catching it (to my knowledge) so it would force Windows 9X users to carry the DLL around with them for all programs or copy the DLL into the system directory.<br><br>The other problem is that there are some licensing issues with distributing the official Microsoft DLL. See the following page (specifically the 'Alternatives to MSLU') for more info:<br><br><a href="http://libunicows.sourceforge.net/" target="_blank">http://libunicows.sourceforge.net/</a> <br><br></td></tr></table><br>
<a name="928832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking good so far...<br><br>My unit tests are passing on all the basic file stuff (on Mac only for now) - RealPath, ChangeDir, FileType, CreateDir, DeleteDir, CreateFile....<br><br>Still more tests to write, but I'm pretty confident now.<br><br>Same changes should work on Linux too, by all accounts.<br>Heh, which will be the two important platforms done first ;-) <br><br></td></tr></table><br>
<a name="928849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Everything works on Linux too... yay :-p <br><br></td></tr></table><br>
<a name="928869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ta Da!!!!<br><br>All tests pass on Win32 :-)<br><br><br>If anyone is interested in being guinea pig for this Unicode/UTF8 savvy Pub.Stdc module (and test), please <b>drop me an email</b>, and I'll send you the stuff to play with.<br><br><br>Bit quick though.. dunno what I'm going to find to do tomorrow now... :-/ <br><br></td></tr></table><br>
<a name="928871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Brucey,<br><br>If you send them on over, I'll have a quick look if I have time. I can't promise any serious testing though...<br><br>Thanks <br><br></td></tr></table><br>
<a name="928953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd help, but all my systems are english. I suppose i could rename some folders something silly, but i guess you've already tried that?<br><br>This will be a really useful module though, as Bullet Candy came up against some funny languages and didn't like them, so it would be useful to get the game working in those, and also add it to my new one. This would work with your Volumes.mod right?<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="928954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This would work with your Volumes.mod right? <br></div><br>Yes, it should do - perhaps with a small update of it.<br><br>I'm now looking at brl.system and others, to see where else we are missing unicode support. Like in requesters and so forth. <br><br></td></tr></table><br>
<a name="929019"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >siread</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, I post a problem and within 24 hours Brucey has it nailed. Nice work, I look forward to testing it. :) <br><br></td></tr></table><br>
<a name="929035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's getting there...   been fixing some of the dialogs (RequestFile etc) which were bit shoddy too.<br><br>Still some issues with AppDir and co, I think... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
