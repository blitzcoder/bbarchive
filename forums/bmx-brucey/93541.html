<!DOCTYPE html><html lang="en" ><head ><title >BaH.Volumes - Update</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BaH.Volumes - Update</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >BaH.Volumes - Update</a><br><br>
<a name="1070270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b><a href="http://code.google.com/p/maxmods/wiki/VolumesModule" target="_blank">BaH.Volumes</a></b> is a small cross-platform module which provides useful volume/device information support for BlitzMax, using a common API.<br><br>A new version (1.07) is now available.<br><br>This contains the following improvements :<br> * Added support for all native CSIDL paths on Win32 using GetCustomDir.<br> * Added support for 'k' paths on Mac using GetCustomDir.<br> * Updated documentation.<br><br><br><b>BaH.Volumes</b> is available for download from the <a href="http://code.google.com/p/maxmods/downloads/list?q=drive" target="_blank">Maxmods GoogleCode</a> site, as are most of my modules.<br><br>Enjoy :o) <br><br></td></tr></table><br>
<a name="1070291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool, thanks <br><br></td></tr></table><br>
<a name="1070390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool. It might be useful <br><br></td></tr></table><br>
<a name="1070513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, this will be handy. <br><br></td></tr></table><br>
<a name="1100053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >siread</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Brucey, I cannot seem to locate the Recycle Bin with GetCustomDir...<br><br><pre class=code>
Const CSIDL_DESKTOP                 = $0000  ' &lt;desktop&gt;
Const CSIDL_BITBUCKET               = $000a  ' &lt;desktop&gt;\Recycle Bin
</pre><br><br>CSIDL_DESKTOP works fine but CSIDL_BITBUCKET returns blank on Win32 (I'm on Win7). Any idea? No biggie but I'd like to be able to move files to trash rather than deletefile().<br><br>Also, I can't find any info on these 'k paths' you mention. Do you know what the mac equivalent is or where I can find a list of k-paths? <br><br></td></tr></table><br>
<a name="1100082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Vista deprecates CSIDL, apparently... cool :-)<br><br>I have a workaround, which uses the new API...  just need to see how to implement it and yet remain compatible with the rest (if that's possible!)<br><br>There's a long list of k-paths in the current source (vol_mac.bmx), that you can use. I think that has most of them. <br><br></td></tr></table><br>
<a name="1100195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've checked in new support for FOLDERIDs. On systems that support it (vista, win7, etc) it should transparently use the matching FOLDERID value for the passed CSIDL, calling the new API instead.<br><br>But funnily enough, I can't get FOLDERID_RecycleBinFolder to return anything, while all the others appear to be working as expected!! :-/<br><br>I think it may be because it is a virtual folder, and I may need to go in through IKnownFolderManager::GetFolder to find a real path instead... this may be true for all the virtual folders. <br><br></td></tr></table><br>
<a name="1100219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> After further investigation, virtual folders simply don't exist. That's why it returns nothing.<br>So you don't have direct access to a path for virtual folders :)<br><br>However, it is possible to delete a file using SHFileOperation, and have it go into the recycle bin rather than being deleted permanently, but this functionality is outside the scope of my module. <br><br></td></tr></table><br>
<a name="1100261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to use the API to throw a deleted file at the recycle bin -- Simply moving a file to the recylcebin folder (if you knew the location) wouldn't be sufficient since it wouldn't know the original location necessary to restore a file if you changed your mind. <br><br></td></tr></table><br>
<a name="1100271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> That too :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
