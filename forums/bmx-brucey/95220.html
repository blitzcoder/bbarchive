<!DOCTYPE html><html lang="en" ><head ><title >Win32 BlitzMax with GCC 4.x - HowTo</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Win32 BlitzMax with GCC 4.x - HowTo</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=124" >Brucey's Modules</a>/<a href="#bottom" >Win32 BlitzMax with GCC 4.x - HowTo</a><br><br>
<a name="1095311"></a>

<a name="1095313"></a>

<a name="1236301"></a>

<a name="1236302"></a>

<a name="1236304"></a>

<a name="1236309"></a>

<a name="1276544"></a>

<a name="1276545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> People seem to have a lot of problems using a newer version of MinGW with BlitzMax on Windows. The main problem is that versions of MinGW which use the GCC version 4.x require that certain files installed with BlitzMax are replaced with new ones from the MinGW install.<br>There are also linking issues with bmk, because the order of some files need to be changed to work correctly with 4.x.<br><br>I've created a bundle of files which can be used to replace those in your default BlitzMax install. This should ease setting up BlitzMax to use GCC 4.x.<br><br>I recommend you use the TDM version of MinGW, since I have found it to be vastly more predictable to set up than the "official" MinGW.<br>The latest version of TDM that we can use with BlitzMax without too many issues is 4.7.1. Later versions are only available as a 64-bit deployment, and don't necessarily support compilation of 32-bit binaries.<br><br>The downloads for TDM MinGW 32-bit are available at : <b><a href="http://sourceforge.net/projects/tdm-gcc/files/TDM-GCC%20Installer/Previous/1.1006.0/" target="_blank">http://sourceforge.net/projects/tdm-gcc/files/TDM-GCC%20Installer/Previous/1.1006.0/</a></b><br><br>You should download and install the <b>tdm-gcc-4.7.1-2.exe</b> release, near the top of the list.<br><br>You will also need to run a batch-script to overwrite certain files in BlitzMax/bin and lib with the ones from MinGW that you have just downloaded.<br><br>Here's the source :<br><pre class=code>
@echo off
@set dirMinGW=c:\mingw
@set minGWVersionString=4.7.1
@set dirBlitzmax=c:\coding\BlitzMax

copy %dirMinGW%\bin\ar.exe %dirBlitzmax%\bin /Y
copy %dirMinGW%\bin\ld.exe %dirBlitzmax%\bin /Y

for /f "delims=" %%i in ('dir %dirBlitzmax%\lib /b') do (
copy "%dirMinGW%\lib\%%i" "%dirBlitzmax%\lib\%%i" /z /y
copy "%dirMinGW%\lib\gcc\mingw32\%minGWVersionString%\%%i" "%dirBlitzmax%\lib\%%i" /z /y
)
</pre><br>You will need to change the paths to correspond with those where your files are located - That's those for dirMinGW, and dirBlitzmax.<br><br>-----------------------------------------------------<br><br><b>Install Procedure</b><br><br>1) Install MinGW in the usual place.<br>2) Make sure to add both the MINGW environment variable and add it's bin dir to the PATH - as per normal.<br>3) If you intend to use the official bmk (rather than my replacement), you will need to create a another environment variable with the following settings : <b>BMK_LD_OPTS = -lmsvcrt -lgcc</b><br>   (This is because of changes to the libs in later versions of MinGW.)<br>4) Install BlitzMax.<br>5) Create and run the script.<br>6) Rebuild All modules.<br><br>-----------------------------------------------------<br><br>I just did a full install as above, and everything appears to work as expected.<br>I also tested BaH.FreeImage, and the examples built and ran as expected.<br><br>Hope this helps a little<br><br>:o)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1095357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey, thanks a million for posting this. I was REALLY getting frustrated... (Maybe this should be stickied and/or combined with Mark's How to on module compilation?)<br><br>Anyway, I'm at work now, but wil give this a go as soon as I get home!<br><br>Thanks again.<br>Russell <br><br></td></tr></table><br>
<a name="1095358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe I should add a disclaimer? : "It worked for me, but your mileage may vary"... ;-) <br><br></td></tr></table><br>
<a name="1095473"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Worked for me too, this time!<br>You are a life (and hair) saver, Brucey!<br><br>The only issues I ran into so far are:<br>- wx.mod/wxrarinputstream.mod complains about not finding a file called 'new.h' which is not part of any of the newer minGW installations apparently, but I found it in an older minGW setup and put it in minGW/include folder. <br><br>- The CEGUI example, widgetgalore.bmx gives an error about not finding d3dx9.dll (missing from system), but switching to the OpenGL driver (BaH.CEGUIOpenGL) instead fixes it (and I hear that installing the newest DirectX redistributable fixes the problem also).<br><br>- CEGUI requires Regex.mod, it seems (the pcre files). No big deal. Compiled and ran fine after I copied it (regex.mod) to bah.mod.<br><br>Otherwise, it all looks good!<br><br>Thanks again!<br>Russell <br><br></td></tr></table><br>
<a name="1095474"></a>

<a name="1095475"></a>

<a name="1095476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whoops, it seems I need unicows because when I try to run any MaxGUI programs, for example the 'redrawgadget.bmx' example, I get:<br><div class="quote"> <br>Linking:.redrawgadget.debug.exe<br>c:/mingw/bin/../lib/gcc/mingw32/4.5.2/../../../../mingw32/bin/ld.exe: cannot find -lunicows<br>collect2: ld returned 1 exit status<br>Build Error: Failed to link C:/BlitzMax/docs/html/Modules/MaxGUI/MaxGUI/.redrawgadget.debug.exe<br>Process complete<br> <br></div><br>I searched my system and the only unicows program I found was in an Adobe installation called 'unicows.dll'. Is that it? <br><br>Other than MaxGUI programs and the above mentioned minor glitches, everything seems to be working!<br><br>Any ideas about the unicows thing, though?<br>Russell<br><br>[EDIT: Actually, I found a file in the BlitzMax/lib folder (copied from your file bundle 'lib' folder) called 'libunicows.a'. It's there, so I don't know why it can't find it. On a possibly related note, I have in my path, in addition to the C:\MinGW\bin folder, I also have C:BlitzMax\bin. Could this be interferring? {I have it just before the MinGW\bin entry}]<br><br>[EDIT 2: It seems MaxGUI is the only one having problems now (The unicows thing). None of the MaxGUI examples will compile without that error so far. But honestly, I can live without it. Still, it would be nice to know what's up with it.]<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1095477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> What version of Windows are you running?<br><br>On win95/98 you explicitly need unicows.dll for things to work, on newer versions of windows that shouldn't be necessary. <br><br></td></tr></table><br>
<a name="1095503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If anything, unicows should be a runtime check and only loaded if required on those specific versions of the OS. Not impossible, as that is how the openal module works.<br><br><div class="quote"> Worked for me too, this time! <br></div><br>Glad you got it working at last :-) <br><br></td></tr></table><br>
<a name="1095536"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have Windows 7 x64, so I would imagine that it would be included, right? I've been able to compile and run MaxGUI programs in the past, but that may have been under Windows XP before I upgraded to Windows 7. (Been a while since I've had any need to use MaxGUI, so I can't remember.)<br><br>Is the 'lunicows.a' file in the BlitzMax/libs folder the one it is looking for, do you think? Should I put the BlitzMax/lib folder in the PATH just to be sure?<br><br>Anyone else running Win7 x64, with BMax 1.42 and the latest minGW able to compile and run MaxGUI programs? Or getting the same error as me?<br><br>Anyway, it's no big deal (I'll be using wx.mod most likely from now on anyway for any GUI apps I may need). Thanks again, Brucey, and everyone else who offered help.<br><br>Russell <br><br></td></tr></table><br>
<a name="1095653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a second, default, installation of BlitzMax and it compiles MaxGUI fine, so I'll just use that for the rare times that I need something using MaxGUI.<br><br>Since it works in the default setup, does that mean there's something in the newer minGW files that were copied to BlitzMax/bin and /lib that it doesn't agree with?<br><br>Thanks for all your help, and thanks for stickying this as well!<br><br>Russell <br><br></td></tr></table><br>
<a name="1096114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nigel Brown</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you Brucey for your help with this, unfortunately after 3 days of compiling I am still no closer to achieving a successful link of my program. How difficult can this be all the modules re-build without any errors. Still get the _Unwind_Resume errors at the linking stage of my program, it uses wx and some of the BaH modules.<br><br><br>Linking:main.debug.exe<br>C:/BlitzMax/mod/wx.mod/wx.mod/../lib/win32/libwxmsw29u_xrc.a(xrclib_xmlres.o):xmlres.cpp:(.text+0x23c): undefined reference to `_Unwind_Resume'<br>C:/BlitzMax/mod/wx.mod/wx.mod/../lib/win32/libwxmsw29u_xrc.a(xrclib_xmlres.o):xmlres.cpp:(.text+0x491): undefined reference to `_Unwind_Resume'<br>C:/BlitzMax/mod/wx.mod/wx.mod/../lib/win32/libwxmsw29u_xrc.a(xrclib_xmlres.o):xmlres.cpp:(.text+0x77b): undefined reference to `_Unwind_Resume'<br>C:/BlitzMax/mod/wx.mod/wx.mod/../lib/win32/libwxmsw29u_xrc.a(xrclib_xmlres.o):xmlres.cpp:(.text+0x939): undefined reference to `_Unwind_Resume'<br>C:/BlitzMax/mod/wx.mod/wx.mod/../lib/win32/libwxmsw29u_xrc.a(xrclib_xmlres.o):xmlres.cpp:(.text+0x95f): undefined reference to `_Unwind_Resume'<br>C:/BlitzMax/mod/wx.mod/wx.mod/../lib/win32/libwxmsw29u_xrc.a(xrclib_xmlres.o):xmlres.cpp:(.text+0xbac): more undefined references to `_Unwind_Resume' follow <br><br></td></tr></table><br>
<a name="1097458"></a>

<a name="1097459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mostly this works ok. LibcurlSSL.mod doesn't build though, complaining it's missing the libssh2.h file.<br><br>Libcurlssh does build if i don't update the lib and bin folder with the files you provided however.<br><br>Cheers<br>Charlie<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> libssh2 is in another module (bah.libssh2) . Strange that it builds okay when you use different binaries... <br><br></td></tr></table><br>
<a name="1105576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Henri</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Link to the bundle does not seem to work. <br><br></td></tr></table><br>
<a name="1109409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've now migrated to a new host... hopefully everything will be back to normal soon (within 24 hrs as the DNS caches are refreshed).<br><br>At least my email is working again :-) <br><br></td></tr></table><br>
<a name="1263960"></a>

<a name="1263961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Brucey,<br><br>could you please add these findings here to your installation instructions?<br><a href="http://www.blitzbasic.com/Community/post.php?topic=104339&amp;post=1263586" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=104339&amp;post=1263586</a><br><br>The extra system variable mentioned fixed my compiling problems under Win 8.1 (64 Bit) with MinGW 4.8.1 (with your BMX module tweaks installed).<br><br>Thanks! <br><br></td></tr></table><br>
<a name="1266235"></a>

<a name="1266236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a warning to people that might read and want to try this - I believe this is heavily out-of-date again!!!<br><br>That's is, I've spend two days trying to get the OFX + bah.freeimage modules to compile - on a win7/64 machine. with NO luck, whatsoever. Whilst all other modules (incl many others) work fine. <br>I tried all the different hacks suggested in other threads; I hope others have more luck..<br><br>meh<br>PS. I also need minGW to program my Arduino - but I'm pretty sure that's gone to hell now as well... <br><br></td></tr></table><br>
<a name="1266239"></a>

<a name="1266240"></a>

<a name="1266241"></a>

<a name="1266243"></a>

<a name="1266244"></a>

<a name="1266246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK ---  I'm running Win7 /64bit, I followed the instructions, but still can't create the modules for OFX..<br><br>@Brucey: Is it normal that HALF the files don't get found/copied using your batch-file?! When using "tdm-gcc-4.7.1-2.exe", the files DO exist in the folder "MinGW\lib", but NOT in the folder: "MinGW\lib\gcc\mingw32\4.7.1" -as used by the 2nd copy command, in the for loop.<br><br>Then, ALL modules build fine (Bah, Pub, etc) - including Bah.FreeImage "build" without problem - BUT the freeImage examples don't work: "Can't find interface for module 'bah.freeimage'" (note: I'm using freeimage_1_07_src.zip)<br><br>And the above, prevents me from building OFX.CORE:<br><pre class=code>
Compile Error: Can't find interface for module 'bah.freeimage'
[C:/Dropbox/BlitzMax/mod/ofx.mod/core.mod/source.bmx;28;1]
  Build Error: failed to compile C:/Dropbox/BlitzMax/mod/ofx.mod/core.mod/source.bmx</pre><br><br>WHY?! What am I doing wrong, this time?! :)<br><br>Thanks in advance for any help!!! I'm dying to get cracking with OpenCV - even bought a new WebCam last weekend for it, but I'm dead in the water, at the moment :(<br><br>Danny. <br><br></td></tr></table><br>
<a name="1266247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> After / whilst rebuilding ALL modules again, using:<br><pre class=code>C:\Dropbox\blitzmax\bin\bmk makemods -a brl.mod
C:\Dropbox\blitzmax\bin\bmk makemods -a -h brl.mod
C:\Dropbox\blitzmax\bin\bmk makemods -a
C:\Dropbox\blitzmax\bin\bmk makemods -a -h</pre><br>I get this one:<pre class=code>Building Modules
Archiving:bass.debug.mt.win32.x86.a
Archiving:fmod.debug.mt.win32.x86.a
ar: creating C:/Dropbox/BlitzMax/mod/BaH.mod/bass.mod/bass.debug.mt.win32.x86.a
ar: creating C:/Dropbox/BlitzMax/mod/BaH.mod/fmod.mod/fmod.debug.mt.win32.x86.a
Archiving:FreeImage.debug.mt.win32.x86.a
ar: creating C:/Dropbox/BlitzMax/mod/BaH.mod/FreeImage.mod/FreeImage.debug.mt.win32.x86.a
ar: unable to rename 'C:/Dropbox/BlitzMax/mod/BaH.mod/FreeImage.mod/FreeImage.debug.mt.win32.x86.a'; reason: File exists
Build Error: Failed to create archive C:/Dropbox/BlitzMax/mod/BaH.mod/FreeImage.mod/FreeImage.debug.mt.win32.x86.a
Process complete</pre> <br><br></td></tr></table><br>
<a name="1276546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've updated the original post with a new step 3, to set an environment variable for users of the official bmk.<br>(although I'd recommend trying bmk_ng, as it supports parallel builds, which can greatly speed up the build process) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
