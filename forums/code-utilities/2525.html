<!DOCTYPE html><html lang="en" ><head ><title >RecycleBinPath()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Returns the physical path of the Recycle Bin (Windows XP and earlier), language=bmx, category=File Utilities'><meta name='author' content='Ked'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=8>File Utilities</a>/RecycleBinPath()</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="2525.bmx">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >RecycleBinPath() by Ked</td><td align="right">2009 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Returns the physical path of the Recycle Bin (Windows XP and earlier) </td></tr><tr ><td class="cell"><pre class="code">Function RecycleBinPath:String()
	Local drive:String=GetEnv_("SYSTEMDRIVE")
	Local os:String=GetEnv_("OS")
	
	If Lower(os)="windows_nt"
		drive:+"\RECYCLER\"
	Else
		drive:+"\RECYCLED\"
	EndIf
	
	Local dir:String[]=LoadDir(drive)
	Local path:String=Null
	If dir
		path=drive+dir[0]
	EndIf
	
	Return path
EndFunction</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> ...Except on non-English versions of windows, where the folder won't be named 'recycled', but whatever the local translation happens to be.<br><br>This is one of those things where you ought to use the windows API (or at a bare minimum read it from the registry) rather than making assumptions... <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> Also, why make it Windows-only? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ...Except on non-English versions of windows, where the folder won't be named 'recycled', but whatever the local translation happens to be. <br></div><br>Right. English only. :)<br><br><div class="quote"> This is one of those things where you ought to use the windows API (or at a bare minimum read it from the registry) rather than making assumptions... <br></div><br>I don't think this was an assumption. I just grabbed information from MSDN.<br><br><div class="quote"> Also, why make it Windows-only? <br></div><br>I only have a Windows computer. And this was just for something I am working on. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> Interesting,s ince Microsoft's own design guidelines would have you use their appropriate API's to obtain the correct info reliably... Using the environment variables is one thing when you're trying to determine the system drive, but there is no such thing to help you pick the actual *folder* that the recycle bin is stored at.<br><br>Even if you add additional checks to make sure that it is indeed an English-language install, you still don't account for other variances like people tweaks to repoint their recyclebin to a custom location. Hey, it happens. :-?<br>It also wouldn't be future-proof: for all we know, Windows 8 may give it a different name again altogether.<br><br>Using the API's would always give you the correct location, regardless of the language or how 'creative' someone has been with their OS settings. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> Good to know, but this was just for something I was working on. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> there is no such thing to help you pick the actual *folder* that the recycle bin is stored at.<br> <br></div><br><br>The "RECYCLER" name itself should be under one of the MUI lists in the registry, so regardless of the language, it can be found.<br><br>As far as I know, (Speaking Windows - I had no idea other OS even have recycle bin folders :D ) it's not possible to relocate the Recycle Bin(s), except by disabling it on one drive annd enabling it on another.<br><br>Even so, it's not much help because the actual recycle bin 'contents' might not be in "RECYCLER" directly, but in a folder within that with a generated name referring to the current User by session. I'm unsure if  this is affected by FUS or similar, I only have the default users and my own account on this machine.<br><br>You could use NextFile presumably and identify the folder which would be easier than checking the HKEY_USERS\ registry entry for the name. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> Actually, scratch that....<br><br>after I've read this:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=80751#910343" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=80751#910343</a><br><br>and considering HOW the recycle bin works (by 'flagging' files, rather than moving them anywhere - <br><br>(Yes, even if you do the trick mentioned and delete a file on drive X then open up the Recycleron C it will be there, however, the FILE DATA is still on drive X. That doesn't change unless you disable the Recycle Bin entirely for X.<br><br>Anyway, it seems that the actual 'folders' for recycled files are not at all real folders. Not even masked names like for the "CD Burning" or "My Documents" type folders, nope. I think they are just a 'window' meh bad word, bt anyway, a window that shows the information retrieved by Windows OS when it looks for the files flagged as "In the recycle Bin", so I'm guessing you can never truly obtain a PATH to the Recycle Bin contents, the closest you could get, is to mimic Windows by finding all the files flagged and then maybe copy them to a single location, or store their individual paths (which I would imagine remain the same as before they were 'deleted'.)<br><br>I'm doubtful, though to how possible it would be to work with these files, seeing as how normally a 'deleted' (i.e. in the recycle bin file) is no longer accessible by its original path from blitz. <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
