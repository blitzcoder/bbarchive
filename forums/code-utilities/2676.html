<!DOCTYPE html><html lang="en" ><head ><title >RenameFile</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Functions to allow for file renaming, language=bb, category=File Utilities'><meta name='author' content='_PJ_'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=8>File Utilities</a>/RenameFile</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="2676.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >RenameFile by _PJ_</td><td align="right">2010 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Very simply, this is a means to Rename file/folders from within Blitz.<br><br>These functions hijack the 'pseudo-DOS' implemented in Windows XP. They should work with NT, Windows 2000 and earlier Windows versions, but I have no idea if the DOS command interface is included anymore with the likes of Vista and Windows 7<br><br>Also, since the fake DOS environment is based on virtual 16-bit architecture, I am not sure what, if any, effects there are in Windows 64-bit versions.<br>Best advice is see if Start-Run-cmd brings up a command prompt interface or not. :)<br><br>I added the ability to do some bulk renaming if required, this is purely optional, but requires tracking a value which is passed in to the function. This value should be incremented each call.<br><br>To ensure against possible errors and bad calls, I added some simple (a bit sloppy to be honest) checks for the file extension and such.<br><br>I sincerely suggest that this function is tested on some unimportant files/directories before putting it to real use. JUST IN CASE!<br><br>___________________<br><br>To use all the features, call the RenameFile(path$, NewFile$,Count_Renamed) function, parameters are:<br><br>Path: Complete path and filename to the file to be renamed<br>NewFile: The new name for the file (If you omit the extension, the same extension as the original will be added)<br>Count_Renamed: If required, This is the tracking variable for consecutive batch processing.<br><br>Otherwise, for more simplistic, direct conversions, you can directly call<br><br>ExecuteRename(Path$, NewFile$)<br><br>This function is the main renaming and imply changes the name of the file / folder that path$ points to, to NewFile$. If NewFile$ already exists, then nothing happens.<br><br>__________________________<br><br>Lastly: <br>A return value is added which corresponds to the filetype of the newly renamed file. This is just an extra.<br>It may be that this fails due to the time taken for the computer to actually rename the file. </td></tr><tr ><td class="cell"><pre class="code">Function RenameFile(Path$="",NewFile$="",Count_Renamed=False)
	;Count_Renamed should be incremented each call for batch processing
	Local Consecutor$=""
	If (Count_Renamed) Then Consecutor$=Str(Count_Renamed)
	If (Right(path,1)=".") Then Return
	If (Path$="") Then Path$=CurrentDir()
	If (Right$(Path,1)="\") Then path$=Left(path$,Len(path$)-1)
	If (NewFile$="")
		If (FileType(Path$)=2)
			NewFile$="Renamed Folder"
			ExecuteRename(Path$,NewFile$+Consecutor$)
		Else
			If (FileType(Path$)=1)
				NewFile$="Renamed File"
			Else
				Return
			End If
		End If
	End If	
	Local Extension_separator=Instr(Path$,".")
	Local Extension$=""
	Local Path_Separators
	Local LastPath=0
	While (Path_separators)
		LastPath=Path_Separators
		Path_Separators=Instr(Path$,"\",Path_Separators+1)
	Wend
	If ((Not(Instr(NewFile$,"."))) And (LastPath&lt;Extension_Separator))Then Extension$="."+Right(Path,(Len(Path)-Extension_Separator))
	Return ExecuteRename(Path$,NewFile$+Consecutor$+Extension$)
End Function 
Function ExecuteRename%(Path$,NewFile$)
	ExecFile(Chr(34)+"cmd"+Chr(34)+" /c RENAME "+Chr(34)+Path$+Chr(34)+" "+Chr(34)+NewFile$+Chr(34))
	Local Path_Separators
	Local LastPath=0
	While (Path_separators)
		LastPath=Path_Separators
		Path_Separators=Instr(Path$,"\",Path_Separators+1)
	Wend
	Local Parent$=Left$(Path,LastPath)+NewFile$
	Return (FileType(Parent$))
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Streaksy</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Tried it in Vista... didnt seem to work ;/ <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the feedback Streaksy, I assume that the Start - Run - "cmd" doesn't invoke a command prompt interface? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Streaksy</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Vista has cmd...  I don't have it in my start menu (forgot how) but I can invoke it with New Task from in task manager.  I use it for IPCONFIG like everyone else ;P <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I made a small change, but it shouldn't have been anything critical, the function <i>should</i> work provided Blitz can run the cmd.<br><br>Perhaps there's a permissions issue?<br><br>Could/did you try different paths, just in case? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Streaksy</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Doesn't seem to work but I'm cursed with Vista and always get weird problems.  I could by a brand new pc with a fresh vista and still get mad problems nobody's ever heard of.<br><br>Guess you need another Vista user to test it ;/ <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> No wworries, Thanks for the info anyway, if I can find a solution for you, I'll be sure to post about it :) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Streaksy</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> No bother <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> works like a charm on vista here <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Noticed a small error in the code.<br><br>(Fixed above now)<br><br>Last_Path was also written as LastPath in some cases. Might have been an issue in some cases. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Does the new Powershell thingy that Miscrosoft released with Windows Update have any significance here?<br><br>From what I see, it seems to be some kinda replkacement for the cmd shell?<br><br>I'm on XP so presumably it's oinly included to help compaitibilities with Win7 etc??? <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
