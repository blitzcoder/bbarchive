<!DOCTYPE html><html lang="en" ><head ><title >Grayscale</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Turn your graphics to grayscale mode, language=bb, category=Graphics'><meta name='author' content='pexe'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=1>Graphics</a>/Grayscale</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="1266.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grayscale by pexe</td><td align="right">2005 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Turn your graphics to grayscale mode.<br><br>This is my first script using readpixel and writepixel. Because of this, its very slow.<br><br>If somebody have a tip to make it faster, tell me please.<br><br>Enjoy. =D </td></tr><tr ><td class="cell"><pre class="code">;Grayscale
;By pexe

;WARNING: This is my first script using readpixel and writepixel, and its VERY SLOW!

;Function grayscale(Buffer, X Starting Point, Y Starting Point, Width, Height)

Function grayscale(GS_buffer,GS_vx,GS_vy,GS_w,GS_h)
LockBuffer(GS_buffer)
For GS_y = GS_vy To GS_vy+GS_h-1
For GS_x = GS_vx To GS_vx+GS_w-1
GS_pix = ReadPixelFast(GS_x,GS_y,GS_buffer)

GS_r% = (GS_pix Shr 16) And $ff ;\
GS_g% = (GS_pix Shr 8) And $ff  ;  Transform values
GS_b% = GS_pix And $ff          ;/

GS_v% = 0.3*GS_r+0.59*GS_g+0.11*GS_b

GS_pix=(GS_v Or (GS_v Shl 8) Or (GS_v Shl 16) Or ($ff000000)) ;Put values back
WritePixelFast GS_x,GS_y,GS_pix,GS_buffer

Next
Next
UnlockBuffer(GS_buffer)
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Byteemoz</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> There are two errors in the For-loops:<br>It should be <br>"For GS_y = GS_vy To GS_vy+GS_h - 1" and <br>"For GS_x = GS_vx To GS_vx+GS_w - 1".<br>Otherwise this function will attempt to read and write outside the specified rectangle.<br><br>For example if you want to grayscale the whole buffer in 800 x 600 graphics mode with<br><br>grayscale GraphicsBuffer(), 0, 0, 800, 600<br><br>GS_y will go from 0 to 600 and GS_x from 0 to 800, but it should go to 599 and 799 respectively. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bertrand</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> Another error, every greyscale algorithm don't work like that. I mean, by additioning tree value and divide it by 3.<br>Usualy, the best way it's to multiply each color component by a specific value: red*0.3(red &lt;0-1&gt;), green*0.59(green &lt;0-1&gt;) and blue*0.11(blue &lt;0-1&gt;).<br>You can check this values on any website in relation with computer graphic or any 2D softwares(Shake, Digital Fusion) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >pexe</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> Living and Learning..<br><br>Thanks for the tips..  i will re-make this script soon.. (and trying to make something more fast) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >pexe</td><td align="right"><font class=tiny>2011</font></td></tr></table></td></tr><tr ><td class="posttext"> BTW: I've fixed the code <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
