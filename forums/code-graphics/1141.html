<!DOCTYPE html><html lang="en" ><head ><title >Filled Quad</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Fills quads with a certain one color, language=bb, category=Graphics'><meta name='author' content='starfox'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=1>Graphics</a>/Filled Quad</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="1141.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filled Quad by starfox</td><td align="right">2004 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Takes four points (any position) and fills it with a quadrilateral, useful for pseudo 3d stuff. Also comes with an optional parameter gridprecise to determine how precise to make the quad (smaller the more precise, but slower). This function is pretty fast. </td></tr><tr ><td class="cell"><pre class="code">Function FilledQuad(p1x,p1y,p2x,p2y,p3x,p3y,p4x,p4y,gridprecise=2)
Local farleftx,farlefty ;Find the point farthest to the left
Local farrightx,farrighty ;Find the point farthest to the right
Local mid1x,mid1y ;Find the point second farthest to the left
Local mid2x,mid2y ;Find the point second farthest to the right
Local farleftid,farrightid,mid1id,mid2id

;Find parallel points
par1x = p1x
par1y = p1y
par2x = p4x
par2y = p4y

If Abs(par1x-p1x) &lt; 2
count = count + 1
EndIf
If Abs(par1x-p2x) &lt; 2
count = count + 1
EndIf
If Abs(par1x-p3x) &lt; 2
count = count + 1
EndIf
If Abs(par1x-p4x) &lt; 2
count = count + 1
EndIf
If count &gt;= 3 Then Return ;Can't do anything to that!
count=0
If Abs(par2x-p1x) &lt; 2
count = count + 1
EndIf
If Abs(par2x-p2x) &lt; 2
count = count + 1
EndIf
If Abs(par2x-p3x) &lt; 2
count = count + 1
EndIf
If Abs(par2x-p4x) &lt; 2
count = count + 1
EndIf
If count &gt;= 3 Then Return ;Can't do anything to that!
count=0
If Abs(par1y-p1y) &lt; 2
count = count + 1
EndIf
If Abs(par1y-p2y) &lt; 2
count = count + 1
EndIf
If Abs(par1y-p3y) &lt; 2
count = count + 1
EndIf
If Abs(par1y-p4y) &lt; 2
count = count + 1
EndIf
If count &gt;= 3 Then Return ;Can't do anything to that!
count=0
If Abs(par2y-p1y) &lt; 2
count = count + 1
EndIf
If Abs(par2y-p2y) &lt; 2
count = count + 1
EndIf
If Abs(par2y-p3y) &lt; 2
count = count + 1
EndIf
If Abs(par2y-p4y) &lt; 2
count = count + 1
EndIf
If count &gt;= 3 Then Return ;Can't do anything to that!

;Long unneccesary function to detect locations:p

farleftx = p1x
farlefty = p1y
farleftid=1

If farleftx &gt; p2x
farleftx = p2x
farlefty = p2y
farleftid=2
EndIf

If farleftx &gt; p3x
farleftx = p3x
farlefty = p3y
farleftid=3
EndIf

If farleftx &gt; p4x
farleftx = p4x
farlefty = p4y
farleftid=4
EndIf

farrightx = p1x
farrighty = p1y
farrightid=1

If farrightx &lt; p2x
farrightx = p2x
farrighty = p2y
farrightid=2
EndIf

If farrightx &lt; p3x
farrightx = p3x
farrighty = p3y
farrightid=3
EndIf

If farrightx &lt; p4x
farrightx = p4x
farrighty = p4y
farrightid=4
EndIf

If farleftid &lt;&gt; 1 And farrightid &lt;&gt; 1
mid1x = p1x
mid1y = p1y
mid1id=1
EndIf

If farleftid &lt;&gt; 2 And farrightid &lt;&gt; 2
If mid1id &lt;&gt; 0
mid2x = p2x
mid2y = p2y
mid2id=2
Else
mid1x = p2x
mid1y = p2y
Mid1id = 2
EndIf
EndIf

If farleftid &lt;&gt; 3 And farrightid &lt;&gt; 3
If mid1id &lt;&gt; 0
mid2x = p3x
mid2y = p3y
mid2id=3
Else
mid1x = p3x
mid1y = p3y
Mid1id = 3
EndIf
EndIf

If farleftid &lt;&gt; 4 And farrightid &lt;&gt; 4
If mid1id &lt;&gt; 0
mid2x = p4x
mid2y = p4y
mid2id=4
Else
mid1x = p4x
mid1y = p4y
Mid1id = 4
EndIf
EndIf

col = ray2dintersect(farleftx,farlefty,mid1x,mid1y,mid2x,mid2y,farrightx,farrighty)
If col = 1 Then changdir=1
col = ray2dintersect(farleftx,farlefty,mid2x,mid2y,mid1x,mid1y,farrightx,farrighty)
If col = 1 Then changdir=2

;2D vectors
Local vec1x#,vec1y#,vec1step#
Local vec2x#,vec2y#,vec2step#

;Quad Picture
;   O---------O
;  /         /
; /         /
;O---------O

vec1x = farleftx:vec1y = farlefty
vec2x = farleftx:vec2y = farlefty


dist1# = Abs(mid1x-farleftx)
If dist1 = 0 Then dist1 = 1
dist2# = Abs(mid2x-farleftx)
If dist2 = 0 Then dist2 = 1
alldist = Abs(farrightx-farleftx)

vec1step = (mid1y-farlefty)/(dist1)
vec2step = (mid2y-farlefty)/(dist2)

If mid1x-farleftx = 0
vec1y = vec1y + vec1step
EndIf

If mid2x-farleftx = 0
vec2y = vec2y + vec2step
EndIf

If changdir = 2
dist2# = Abs(farrightx-farleftx)
If dist2 = 0 Then dist2 = 1
vec2step = (farrighty-farlefty)/(dist2)

If farrightx-farleftx = 0
vec2y = vec2y + vec2step
EndIf

ElseIf changdir = 1
dist1# = Abs(farrightx-farleftx)
If dist1 = 0 Then dist1 = 1
vec1step = (farrighty-farlefty)/(dist1)

If farrightx-farleftx = 0
vec1y = vec1y + vec1step
EndIf

EndIf

starttea = farleftx
endtea = farrightx

For tea =  starttea To endtea

If tea Mod gridprecise = 0
If vec1y &lt; vec2y

	If tea &gt;= 0 And tea &lt;= 640
	If vec1y &gt;= 0 And vec1y &lt;= 480
	Rect(tea,vec1y,gridprecise,vec2y-vec1y+1)
	EndIf
	EndIf
Else
	If tea &gt;= 0 And tea &lt;= 640
	If vec2y &gt;= 0 And vec2y &lt;= 480
	Rect(tea,vec2y,gridprecise,vec1y-vec2y+1)
	EndIf
	EndIf
EndIf
EndIf

	If tea &gt;= mid1x And gotomid1=0
	If changdir=0
	dist1# = (farrightx-mid1x)
	If dist1 = 0 Then dist1 = 1
	vec1step = (farrighty-mid1y)/(dist1)
	ElseIf changdir = 2
		dist1# = (mid2x-mid1x)
		If dist1 = 0 Then dist1 = 1
		vec1step = (mid2y-mid1y)/(dist1)
	ElseIf changdir = 1
		dist2# = (farrightx-mid1x)
		If dist2 = 0 Then dist2 = 1
		vec2step = (farrighty-mid1y)/(dist2)
	EndIf
	gotomid1=1
	EndIf
	
	If tea &gt;= mid2x And gotomid2=0
	If changdir=0
	dist2# = (farrightx-mid2x)
	If dist2 = 0 Then dist2 = 1
	vec2step = (farrighty-mid2y)/(dist2)
	ElseIf changdir=2
		dist1# = (farrightx-mid2x)
		If dist1 = 0 Then dist1 = 1
		vec1step = (farrighty-mid2y)/(dist1)
	ElseIf changdir=1
		dist2# = (mid1x-mid2x)
		If dist2 = 0 Then dist2 = 1
		vec2step = (mid1y-mid2y)/(dist2)
	EndIf
	gotomid2=1
	EndIf
	
	vec1y = vec1y + vec1step
	vec2y = vec2y + vec2step
	
Next


End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
