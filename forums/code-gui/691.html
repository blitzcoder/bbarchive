<!DOCTYPE html><html lang="en" ><head ><title >CreateSyntaxArea(...)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Syntax Highlighting in B+, language=bb, category=BlitzPlus Gui'><meta name='author' content='ShadowTurtle'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=10>BlitzPlus Gui</a>/CreateSyntaxArea(...)</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="691.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >CreateSyntaxArea(...) by ShadowTurtle</td><td align="right">2003 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Hi.<br><br>Heres Syntax Sample:<br>Abs <br>After <br>And <br>Before <br>Case <br>Const <br>Data <br>Default <br>Delete <br>Dim <br>Each <br>Else <br>ElseIf <br>EndIf <br>Exit <br>False <br>Field <br>First <br>Float <br>For <br>Forever <br>Function <br>Global <br>Gosub <br>Goto <br>Handle <br>If <br>Include <br>Insert <br>Int <br>Last <br>Local <br>Mod <br>New <br>Next <br>Not <br>Null <br>Object <br>Or <br>Pi <br>Read <br>Repeat <br>Restore <br>Return <br>Sar <br>Select <br>Sgn <br>Shl <br>Shr <br>Step <br>Str <br>Then <br>To <br>True <br>Type <br>Until <br>Wend <br>While <br>Xor <br>DebugLog <br>FreeTimer <br>WaitTimer <br>CreateTimer <br>SetEnv <br>GetEnv <br>SystemProperty <br>CommandLine <br>MilliSecs <br>Delay <br>ExecFile <br>RuntimeError <br>AppTitle <br>Stop <br>End <br>RuntimeStats <br>EntityName <br>NameEntity <br>FreeEntity <br>ShowEntity <br>HideEntity <br>EntityOrder <br>EntityAutoFade <br>EntityFX <br>EntityBlend <br>EntityTexture <br>EntityShininess <br>EntityAlpha <br>EntityColor <br>PaintEntity <br>FindChild <br>GetChild <br>CountChildren <br>EntityParent <br>Animating <br>AnimLength <br>AnimTime <br>AnimSeq <br>ExtractAnimSeq <br>AddAnimSeq <br>SetAnimKey <br>Animate <br>SetAnimTime <br>AlignToVector <br>PointEntity <br>RotateEntity <br>ScaleEntity <br>PositionEntity <br>TranslateEntity <br>TurnEntity <br>MoveEntity <br>CollisionTriangle <br>CollisionSurface <br>CollisionEntity <br>CollisionTime <br>CollisionNZ <br>CollisionNY <br>CollisionNX <br>CollisionZ <br>CollisionY <br>CollisionX <br>CountCollisions <br>EntityCollided <br>EntityDistance <br>EntityBox <br>EntityRadius <br>GetEntityType <br>GetParent <br>EntityPickMode <br>EntityType <br>ResetEntity <br>DeltaYaw <br>DeltaPitch <br>VectorPitch <br>VectorYaw <br>TFormedZ <br>TFormedY <br>TFormedX <br>TFormNormal <br>TFormVector <br>TFormPoint <br>GetMatElement <br>EntityRoll <br>EntityYaw <br>EntityPitch <br>EntityZ <br>EntityY <br>EntityX <br>CopyEntity <br>EmitSound <br>CreateListener <br>ModifyTerrain <br>TerrainHeight <br>TerrainSize <br>TerrainZ <br>TerrainY <br>TerrainX <br>TerrainShading <br>TerrainDetail <br>LoadTerrain <br>CreateTerrain <br>CreatePlane <br>CreateMirror <br>BSPAmbientLight <br>BSPLighting <br>LoadBSP <br>MD2Animating <br>MD2AnimLength <br>MD2AnimTime <br>AnimateMD2 <br>LoadMD2 <br>SpriteViewMode <br>HandleSprite <br>ScaleSprite <br>RotateSprite <br>LoadSprite <br>CreateSprite <br>CreatePivot <br>LightConeAngles <br>LightRange <br>LightColor <br>CreateLight <br>PickedTriangle <br>PickedSurface <br>PickedEntity <br>PickedTime <br>PickedNZ <br>PickedNY <br>PickedNX <br>PickedZ <br>PickedY <br>PickedX <br>CameraPick <br>LinePick <br>EntityPick <br>EntityVisible <br>EntityInView <br>ProjectedZ <br>ProjectedY <br>ProjectedX <br>CameraProject <br>CameraFogMode <br>CameraFogRange <br>CameraFogColor <br>CameraViewport <br>CameraProjMode <br>CameraClsMode <br>CameraClsColor <br>CameraRange <br>CameraZoom <br>CreateCamera <br>TriangleVertex <br>VertexW <br>VertexV <br>VertexU <br>VertexAlpha <br>VertexBlue <br>VertexGreen <br>VertexRed <br>VertexNZ <br>VertexNY <br>VertexNX <br>VertexZ <br>VertexY <br>VertexX <br>CountTriangles <br>CountVertices <br>VertexTexCoords <br>VertexColor <br>VertexNormal <br>VertexCoords <br>AddTriangle <br>AddVertex <br>PaintSurface <br>ClearSurface <br>FindSurface <br>CreateSurface <br>GetSurface <br>CountSurfaces <br>MeshesIntersect <br>MeshDepth <br>MeshHeight <br>MeshWidth <br>LightMesh <br>UpdateNormals <br>AddMesh <br>PaintMesh <br>FlipMesh <br>FitMesh <br>PositionMesh <br>RotateMesh <br>ScaleMesh <br>CopyMesh <br>CreateCone <br>CreateCylinder <br>CreateSphere <br>CreateCube <br>CreateMesh <br>LoadAnimSeq <br>LoadAnimMesh <br>LoadMesh <br>BrushFX <br>BrushBlend <br>BrushTexture <br>BrushShininess <br>BrushAlpha <br>BrushColor <br>FreeBrush <br>LoadBrush <br>CreateBrush <br>TextureFilter <br>ClearTextureFilters <br>TextureBuffer <br>TextureHeight <br>TextureWidth <br>PositionTexture <br>RotateTexture <br>ScaleTexture <br>TextureCoords <br>TextureBlend <br>FreeTexture <br>LoadAnimTexture <br>LoadTexture <br>CreateTexture <br>Stats3D <br>TrisRendered <br>ActiveTextures <br>ClearWorld <br>RenderWorld <br>CaptureWorld <br>UpdateWorld <br>Collisions <br>ClearCollisions <br>AmbientLight <br>WireFrame <br>AntiAlias <br>Dither <br>WBuffer <br>HWMultiTex <br>LoaderMatrix <br>NetMsgData <br>NetMsgTo <br>NetMsgFrom <br>NetMsgType <br>RecvNetMsg <br>SendNetMsg <br>NetPlayerLocal <br>NetPlayerName <br>DeleteNetPlayer <br>CreateNetPlayer <br>StopNetGame <br>JoinNetGame <br>HostNetGame <br>StartNetGame <br>Load3DSound <br>ChannelPlaying <br>ChannelPan <br>ChannelVolume <br>ChannelPitch <br>ResumeChannel <br>PauseChannel <br>StopChannel <br>PlayCDTrack <br>PlayMusic <br>PlaySound <br>SoundPan <br>SoundVolume <br>SoundPitch <br>LoopSound <br>FreeSound <br>LoadSound <br>DirectInputEnabled <br>EnableDirectInput <br>FlushJoy <br>JoyVDir <br>JoyUDir <br>JoyZDir <br>JoyYDir <br>JoyXDir <br>JoyHat <br>JoyRoll <br>JoyYaw <br>JoyPitch <br>JoyV <br>JoyU <br>JoyZ <br>JoyY <br>JoyX <br>JoyWait <br>WaitJoy <br>GetJoy <br>JoyHit <br>JoyDown <br>JoyType <br>MoveMouse <br>FlushMouse <br>MouseZSpeed <br>MouseYSpeed <br>MouseXSpeed <br>MouseZ <br>MouseY <br>MouseX <br>MouseWait <br>WaitMouse <br>GetMouse <br>MouseHit <br>MouseDown <br>FlushKeys <br>WaitKey <br>GetKey <br>KeyHit <br>KeyDown <br>HidePointer <br>ShowPointer <br>Locate <br>Input <br>Print <br>Write <br>ImageRectCollide <br>ImageRectOverlap <br>RectsOverlap <br>ImagesCollide <br>ImagesOverlap <br>TFormFilter <br>TFormImage <br>RotateImage <br>ResizeImage <br>ScaleImage <br>ImageYHandle <br>ImageXHandle <br>ImageHeight <br>ImageWidth <br>AutoMidHandle <br>MidHandle <br>HandleImage <br>MaskImage <br>DrawBlockRect <br>DrawImageRect <br>TileBlock <br>TileImage <br>DrawBlock <br>DrawImage <br>ImageBuffer <br>GrabImage <br>SaveImage <br>FreeImage <br>LoadAnimImage <br>CreateImage <br>CopyImage <br>LoadImage <br>CloseMovie <br>MoviePlaying <br>MovieHeight <br>MovieWidth <br>DrawMovie <br>OpenMovie <br>StringHeight <br>StringWidth <br>FontHeight <br>FontWidth <br>FreeFont <br>LoadFont <br>CopyRect <br>Text <br>Line <br>Oval <br>Rect <br>Plot <br>Cls <br>SetFont <br>ClsColor <br>ColorBlue <br>ColorGreen <br>ColorRed <br>GetColor <br>Color <br>Viewport <br>Origin <br>CopyPixelFast <br>CopyPixel <br>WritePixelFast <br>ReadPixelFast <br>WritePixel <br>ReadPixel <br>UnlockBuffer <br>LockBuffer <br>SaveBuffer <br>LoadBuffer <br>GraphicsBuffer <br>SetBuffer <br>GraphicsDepth <br>GraphicsHeight <br>GraphicsWidth <br>Flip <br>VWait <br>ScanLine <br>BackBuffer <br>FrontBuffer <br>GammaBlue <br>GammaGreen <br>GammaRed <br>UpdateGamma <br>SetGamma <br>EndGraphics <br>Graphics3D <br>Graphics <br>Windowed3D <br>GfxMode3D <br>GfxMode3DExists <br>CountGfxModes3D <br>GfxDriver3D <br>TotalVidMem <br>AvailVidMem <br>GfxModeDepth <br>GfxModeHeight <br>GfxModeWidth <br>GfxModeExists <br>CountGfxModes <br>SetGfxDriver <br>GfxDriverName <br>CountGfxDrivers <br>CallDLL <br>WriteBytes <br>ReadBytes <br>PokeFloat <br>PokeInt <br>PokeShort <br>PokeByte <br>PeekFloat <br>PeekInt <br>PeekShort <br>PeekByte <br>CopyBank <br>ResizeBank <br>BankSize <br>FreeBank <br>CreateBank <br>DeleteFile <br>CopyFile <br>FileType <br>FileSize <br>DeleteDir <br>CreateDir <br>ChangeDir <br>CurrentDir <br>NextFile <br>CloseDir <br>ReadDir <br>SeekFile <br>FilePos <br>CloseFile <br>WriteFile <br>ReadFile <br>OpenFile <br>TCPTimeouts <br>TCPStreamPort <br>TCPStreamIP <br>AcceptTCPStream <br>CloseTCPServer <br>CreateTCPServer <br>CloseTCPStream <br>OpenTCPStream <br>UDPTimeouts <br>UDPMsgPort <br>UDPMsgIP <br>UDPStreamPort <br>UDPStreamIP <br>RecvUDPMsg <br>SendUDPMsg <br>CloseUDPStream <br>CreateUDPStream <br>HostIP <br>CountHostIPs <br>DottedIP <br>CopyStream <br>WriteLine <br>WriteString <br>WriteFloat <br>WriteInt <br>WriteShort <br>WriteByte <br>ReadLine <br>ReadString <br>ReadFloat <br>ReadInt <br>ReadShort <br>ReadByte <br>ReadAvail <br>Eof <br>CurrentTime <br>CurrentDate <br>Bin <br>Hex <br>Len <br>Asc <br>Chr <br>RSet <br>LSet <br>Trim <br>Lower <br>Upper <br>Mid <br>Instr <br>Replace <br>Right <br>Left <br>String <br>RndSeed <br>SeedRnd <br>Rand <br>Rnd <br>Log10 <br>Log <br>Exp <br>Ceil <br>Floor <br>Sqr <br>ATan2 <br>ATan <br>ACos <br>ASin <br>Tan <br>Cos <br>Sin<br><br>Have fun. Cu, ST. :) </td></tr><tr ><td class="cell"><pre class="code">wnd = CreateWindow("SyntaxArea Sample", 10, 10, 400, 400, 0, 1) 
butn1 = CreateButton("Exit.", 2, 2, 100, 30, wnd) 

S_Style = CreateSyntaxStyle() 
SyntaxAreaWordsFromFile S_Style, "syntax.txt", 255, 255, 0 

S_Area = CreateSyntaxArea(2, 40, 388, 300, wnd) 
SetSyntaxAreaStyle S_Area, S_Style 

Programm = 1 
While Programm 
  MyEvent = WaitEvent() 
  If EventSource() = butn1 Then Programm = 0 

  SyntaxAreaScanAll S_Area 
Wend 


Type SyntaxAreas 
  Field S_Handle 
  Field S_GadGet 
  Field S_Style.SyntaxStyles 
End Type 

Type SyntaxStyles 
  Field S_Handle 
  Field Color_BG[3] 
  Field Color_StdFont[3] 
  Field S_Char1$ 
  Field S_Char2$ 
  Field S_Char3$ 
  Field Font 
  Field FontName$ 
  Field FontSize 
  Field MaxWordLen 
End Type 

Type SyntaxWord 
  Field S_Style.SyntaxStyles 
  Field Word$ 
  Field Color_StdFont[3] 
End Type 

Function CreateSyntaxArea(x1,y1,x2,y2,g,s=0) 
  nextround=1 
  While nextround = 1 
    newhandle = Rnd(99999) : nextround=0 
    For SA.SyntaxAreas = Each SyntaxAreas 
      If SA\S_Handle = newhandle Then nextround=1 
    Next 
  Wend 

  SA.SyntaxAreas = New SyntaxAreas 
  SA\S_Handle = newhandle 
  SA\S_GadGet = CreateTextArea(x1, y1, x2, y2,g,s) 

  Return SA\S_Handle 
End Function 

Function SetSyntaxAreaStyle(H_Syntax, H_Style) 
  For SA.SyntaxAreas = Each SyntaxAreas 
    If SA\S_Handle = H_Syntax Then 
      For SS.SyntaxStyles = Each SyntaxStyles 
        If SS\S_Handle = H_Style Then 
          SA\S_Style = SS 
          SetTextAreaColor SA\S_GadGet, SS\Color_BG[1], SS\Color_BG[2], SS\Color_BG[3], 1 
          SetTextAreaColor SA\S_GadGet, SS\Color_StdFont[1], SS\Color_StdFont[2], SS\Color_StdFont[3] 
          SS\Font = LoadFont(SS\FontName$, SS\FontSize) 
          SetTextAreaFont SA\S_GadGet, SS\Font 
          FreeFont SS\Font 
        End If 
      Next 
    End If 
  Next 
End Function 

Function CreateSyntaxStyle() 
  .n_round : newhandle = Rnd(99999) : For SS.SyntaxStyles = Each SyntaxStyles 
  If SS\S_Handle = newhandle Then Goto n_round 
  Next  

  SS.SyntaxStyles = New SyntaxStyles 
  SS\S_Handle = newhandle 
  SS\Color_BG[1] = 50 : SS\Color_BG[2] = 50 : SS\Color_BG[3] = 255 
  SS\Color_StdFont[1] = 255 : SS\Color_StdFont[2] = 255 : SS\Color_StdFont[3] = 255 
  SS\FontName$ = "Blitz" 
  SS\FontSize = 20 
  SS\S_Char1$ = "1234567890" 
  SS\S_Char2$ = "´!"+Chr$(34)+"§&amp;/()=?`&lt;,.*'&gt;;:!" 
  SS\S_Char3$ = "qwertzuiopüasdfghjklöäßyxcvbnmQWERTZUIOPÜASDFGHJKLÖÄYXCVBNM$%#" 

  Return SS\S_Handle 
End Function 

Function SyntaxAreaAddWord(H_Style, Word$, C_R, C_G, C_B) 
  For SS.SyntaxStyles = Each SyntaxStyles 
    If SS\S_Handle = H_Style Then 
      SW.SyntaxWord = New SyntaxWord 
      SW\S_Style = SS 
      SW\Word$ = Word$ 
      SW\Color_StdFont[1] = C_R : SW\Color_StdFont[2] = C_G : SW\Color_StdFont[3] = C_B 

      If SS\MaxWordLen &lt; Word$ Then SS\MaxWordLen = Len(Word$) 
    End If 
  Next 
End Function 

Function SyntaxAreaWordsFromFile(H_Style, FileName$, C_R, C_G, C_B) 
  TheFile = ReadFile(FileName$) 
    While Not Eof(TheFile) 
      Word$ = ReadLine$(TheFile) 
      If Instr(Word$, " ") Then Word$ = Mid$(Word$, 1, Instr(Word$, " ")-1) 
      SyntaxAreaAddWord(H_Style, Word$, C_R, C_G, C_B) 
    Wend 
  CloseFile(TheFile) 
End Function 

Function SyntaxAreaScanAll(H_Syntax) 
  For SA.SyntaxAreas = Each SyntaxAreas 
    If SA\S_Handle = H_Syntax Then 
      SyntaxCur = TextAreaCursor(SA\S_GadGet) 
      SyntaxText$ = TextAreaText$(SA\S_GadGet) 

      CurA = SyntaxCur 
      Repeat 
        If (CurA &lt; 1) Or (Not Instr(SA\S_Style\S_Char1$+SA\S_Style\S_Char3$, Mid$(SyntaxText$,CurA,1))&gt;0) Then Exit 
        CurA = CurA - 1 
      Forever 

      mabs = 1 
      If Not Instr(SA\S_Style\S_Char1$+SA\S_Style\S_Char3$, Mid$(SyntaxText$,CurA,1))&gt;0 Then CurA=CurA+1 : mabs = 0 

      CurB = CurA 
      Repeat 
        If (CurB &gt; Len(SyntaxText$)) Or (Not Instr(SA\S_Style\S_Char1$+SA\S_Style\S_Char3$, Mid$(SyntaxText$,CurB,1))&gt;0) Then Exit 
        CurB = CurB + 1 
      Forever 

      Word$ = Mid$(SyntaxText$, CurA+mabs, CurB-CurA-mabs) 

      FormatTextAreaText SA\S_GadGet, SA\S_Style\Color_StdFont[1], SA\S_Style\Color_StdFont[2], SA\S_Style\Color_StdFont[3], 0, CurA-mabs-1, CurB-CurA 
      fWord = 0 
      For SW.SyntaxWord = Each SyntaxWord 
        If SA\S_Style = SW\S_Style Then 
          If Lower(Word$) = Lower(SW\Word$) Then 
            FormatTextAreaText SA\S_GadGet, SW\Color_StdFont[1], SW\Color_StdFont[2], SW\Color_StdFont[3], 0, CurA-mabs-1, CurB-CurA 
            fWord = 1 
          End If 
        End If 
      Next 

      If fWord = 0 Then FormatTextAreaText SA\S_GadGet, SA\S_Style\Color_StdFont[1], SA\S_Style\Color_StdFont[2], SA\S_Style\Color_StdFont[3], 0, SyntaxCur-1,1 
    End If 
  Next 
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
