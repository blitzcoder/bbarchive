<!DOCTYPE html><html lang="en" ><head ><title >Need help getting tooltip userlib working</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need help getting tooltip userlib working</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Need help getting tooltip userlib working</a><br><br>
<a name="319187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The string you are passing to the dll is not getting "converted"...  I'm guessing that instead of taking your "lol" + asc(0) as a string, it's looking at it as a memory address to a string.<br><br>As to what exactly you need to do to fix it...  I haven't got the time right now to look, but when I get home later tonight I'll see what I can dig up.<br><br>Kanati <br><br></td></tr></table><br>
<a name="319294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one, I was on those lines after a few hours of looking for a bug in my code.<br><br>I am passing the address of a seperate string bank, containing the string+asc(0), not just directly plonking it into the main struct bank.<br><br>It makes no difference as to what your string is, so my initial conclusion was that putting the value of a bankhandle, into another bank would infact not point to the bank in question (wtf ?). I know this to be false, in the case of using it again in blitz basic. Passing that bank across to another system is of course a totaly different matter.<br><br>Oh and 1 thing to try, in debug mode/no-debug-mode the text in the tooltip will change.<br><br>Its frustrating to say the least :) <br><br></td></tr></table><br>
<a name="320051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No one got a solution ?<br>It would be a shame to let this helpfull userlib goto waste.. <br><br></td></tr></table><br>
<a name="320113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ford escort</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm not at ease with 'userlib stuff' but it seem that the string don't have any effect to the tool type displayed,but<br>if you modify the adress passed to the userlib <br>ex:<br>PokeInt(bank,36,bankstring+2)<br><br>the string displayed is shorter.so it look like that there's something wrong with what is do with the adress sent <br><br></td></tr></table><br>
<a name="320133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >pantsonhead.com</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I reckon there's a problem with the ToolInfo structure.<br><br>I've seen it defined like this in VB so I wonder if using the bank address is actually required.<br><br><pre class=code>Private Type TOOLINFO
    lSize As Long
    lFlags As Long
    hwnd As Long
    lId As Long
    lpRect As RECT
    hInstance As Long
    lpStr As String
    lParam As Long
End Type</pre><br>Are you getting ",,%Ÿ" in debug mode? I get the same text as your picture in non-debug mode.<br><br>I will have another decent look at this tonight as my lunch break is now over :( <br><br></td></tr></table><br>
<a name="320250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I get those texts in the different debug modes.<br><br>The trouble is, a string in blitz (as far as I know) be poked as an int memory location into a bank. Which is how the lpStr type stores it.<br><br>When passing a string to a userlib, it converts fine, but passing the string in that way, via a "fake" struct is seemingly impossible, without pointers in blitz. GAH!<br><br>I have a dll that somone made for me, I'll put it up for download soon if this can't be resolved. <br><br></td></tr></table><br>
<a name="320705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I got it working by myself :D<br><br><img src="http://skn3.acsv.net/images/tooltip_works.gif"><br><br>I'll make some wrapper functions in blitz, and look into all the other possabilities now. Expect a userlib soon :) <br><br></td></tr></table><br>
<a name="320774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >pantsonhead.com</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent work - keen to see your working code now :) <br><br></td></tr></table><br>
<a name="321242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nooooooooooooooooooooooooooooooo!<br><br>After all this hassle of getting it working, then writting the functions and blah blah blah.<br><br>They don't seem to working properly. They will create ok, they will function fine. When you click on the gadget you attached the tooltip to, the tooltip will disappear and then no longer function.<br><br>Very anoying.<br><br>Doed anyone know anything about tooltips, and how to get around it ? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
