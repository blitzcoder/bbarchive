<!DOCTYPE html><html lang="en" ><head ><title >How to create a color form in BP?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to create a color form in BP?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >How to create a color form in BP?</a><br><br>
<a name="424988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >William Miller</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ayy ideas on how to create a form with a background color that differs from the standard 'system' color? I know the 'SetSysColors' does this in the Win32 API, but if it is possible to use this for BP, what values would one pass to the function, and how?<br><br>Here is the .decls for this function:<br><br>api_SetSysColors% (nChanges%, lpSysColor%, lpColorValues%)<br><br>I believe the 'lpSysColor' value would be: <br>COLOR_APPWORKSPACE as listed by the API-Guide, but I havent a clue on the other values, or how one would use them in this case.<br><br>TIA,<br><br>WM <br><br></td></tr></table><br>
<a name="424992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You've done most of the work already.<br><br>Have you looked it up on MSDN?  It will tell you what the parameters mean, and also what library it's in (e.g. kernel32.dll, user32.dll, etc)<br><br>As for setting the background color, you'll have to use GDI functions FillRect (I think), GetDC, etc.  You'll also have to do it once per frame unless you can catch the WM_PAINT messages.<br><br>I've got an example -- I did this once -- but not on this computer. <br><br></td></tr></table><br>
<a name="425006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >William Miller</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Soja,<br><br>The function is in user32.dll, I have the function in the user32.decls file in my userlib, and indeed I do have the function added in the code itself --it will compile, but it does nothing as I really don't know how or what values to pass to it. The function takes 3 parameters: for example the third function parameter is a 3-part RGB color code: RGB(x,x,x). But how do I pass that 3-part color value into that parameter in the function in BP? I cant simply enter the 3 numbers, of course. Passing it a 3-eleement array with the 3 color values might work, but how exactly would one do that?<br><br>Thanks,<br>WM <br><br></td></tr></table><br>
<a name="426252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Well, let me answer some of your questions first.  As you see in the documentation on MSDN, the third parameter is a *pointer* to a COLORREF type.  We don't know what that is at this point, but we do know that since it's a pointer, we should pass either a bank or a type object and declare the paramter in the decls file with * (not % or $).  As for the COLORREF type (which exists in Win32 but not Blitz, obviously), just click on the COLORREF link from the docs.  That takes you to the definition, and lo and behold, we find that COLORREF is the exact same thing as a DWORD, and a DWORD is simply two WORDs, 4 bytes, or 32 bits.  You can also see that the lowest byte stores the red value (0-255), the second lowest byte stores the green, the third the blue, and the fourth is not used here.  <br><br>So an example, to pass yellow:<br>Declare the lpColorValues parameter as * (not %) in the decls.<br>Then in your program, do one of these:<br><pre class=code>cv=CreateBank(3)
PokeByte(cv, 3, $FF)
PokeByte(cv, 2, $FF)
</pre><br><pre class=code>type ColorValue : Field cv% : End Type
cv.ColorValue = New ColorValue
cv\cv = ($ff Shl 8) Or $ff ; Creates $0000FFFF = Yellow</pre><br>...then when you call it, just pass cv as the third param.<br><br>THAT SAID...<br>By all means, try it out and see if you can get it to work (learning and stuff), but I don't think you should use this function for what you're doing.  You'll end up changing the color of ALL your windows.<br><br>You'll have to use GDI to do what you want, like I mentioned briefly before.  I should probably see the example of how I did it before to help help you though (it's at home)<br><br><br>&lt;EDIT&gt; Note, if the function didn't require a pointer as the third parameter, you could have just used an int% (since a COLORREF is just 4 bytes = int), but since it's a pointer, that why we have to "enclose" the int within a bank or type object. <br><br></td></tr></table><br>
<a name="426474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's one way to do it.  If anybody has another way of doing it, please share!<br><pre class=code>
; .lib "gdi32.dll"
; Rectangle%(hdc%, l, t, r, b):"Rectangle"
; GetStockObject%(fnObject%):"GetStockObject"
; SetDCBrushColor%(hdc%, crColor%):"SetDCBrushColor"
; SelectObject%(hdc, hgdiobj%):"SelectObject"

Const DC_BRUSH = 18
Global wndMain=CreateWindow("",200,200,200,200)
Global btn=CreateButton("Hello", 10, 10, 100, 20, wndMain)

CreateTimer(60)
Repeat
	Select WaitEvent()
		Case $803 : End
		Case $4001 : DrawBG()
	End Select
Forever

Function DrawBG() ; Low-CPU GDI calls
	dc% = GetDC(QueryObject(wndMain,1)) : If Not dc Then Return ; Fail
	SelectObject(dc, GetStockObject(DC_BRUSH))
	SetDCBrushColor(dc, $cccc) ; Mustard yellow
	Rectangle(dc,0,0,GadgetWidth(wndMain),GadgetHeight(wndMain))
	ReleaseDC(QueryObject(wndMain,1), dc)
End Function
</pre> <br><br></td></tr></table><br>
<a name="426777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >William Miller</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Soja,<br><br>That does work, at least in the test window, but using it <br>in my application causes it to crash with a heap error.<br><br>A friend of mine has a good lead on another possible method to do this, I will talk to him and post what he comes up with here if it works as I hope it does.<br><br>Thanks!<br>WM <br><br></td></tr></table><br>
<a name="426889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Make sure that your window gadget handle is global... if it isn't, that would cause a crash. <br><br></td></tr></table><br>
<a name="427460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >William Miller</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Soja,<br><br>All my window handles &amp; gadgets are declared Global -- I believe the crash issue has to do with the sequencing of how several of the window forms and gadgets in my project are created. For now I am continuing on with the main project work itself, and I will revist the color-forms issue at a later date, since the color-form issue is not a high-priority goal in the work.<br><br>Thanks for your kind assistance!<br>WM <br><br></td></tr></table><br>
<a name="427709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=596" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=596</a> <br><br></td></tr></table><br>
<a name="427815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brilliant, you can change the color of a panel.  Much easier than using GDI directly. <br><br></td></tr></table><br>
<a name="428213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >William Miller</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Skidracer &amp; Soja,<br><br>Yes, that one I already tried...but text labels still have the default grey background under them, which makes my forms look rather tacky I'm afraid, as I have a number of text labels on the forms. If it were not for that, this would be a near-perfect solution indeed...<br><br>Thanks,<br>WM <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
