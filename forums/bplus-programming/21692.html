<!DOCTYPE html><html lang="en" ><head ><title >Why the server qui ???</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Why the server qui ???</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Why the server qui ???</a><br><br>
<a name="222112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi !<br><br>Launch the server code and click "Démarrer le serveur" for starting a server.<br><br>Execute client code and click "Connection au serveur" for connection with the server.<br><br>But ! when i click on "Déconnection du serveur" for disconnecting from the server, the server quit ???<br><br>Error in my client 'type' ???<br><br><br><br>Server Code :<br>-------------<br><br><br>Global Window_Width=630<br>Global Window_Height=215<br>Global Window_Left=210<br>Global Window_Top=100<br>Global Window_Title$="Filax window"<br><br>; Declaration d'une fenetre et des boutons<br>; ----------------------------------------<br>Global Filax_Window=CreateWindow(Window_Title$,Window_Left,Window_Top,Window_Width,Window_Height,0,1+8)<br><br><br>Global Filax_Bouton01=CreateButton("&amp;Démarrer le serveur",10,10,130,30,Filax_Window)<br>Global Filax_Bouton02=CreateButton("&amp;Arreter le serveur",10,40,130,30,Filax_Window)<br><br>Global Filax_Liste01=CreateListBox( 150,10,230,150,Filax_Window )<br>Global Filax_Liste02=CreateListBox( 400,10,210,150,Filax_Window )<br><br>Global ClientMode=0<br>Global ServerMode=0<br><br>Type NewClient<br>	Field Name$<br>	Field TCPStream<br>End Type<br><br>Global T.NewClient<br><br><br>While Not KeyHit(1) <br>	; ----------------------------<br>	; Boucle de gestion des gadget<br>	; ----------------------------<br>	Select WaitEvent(0)<br>		Case $401	<br>			Select EventSource()<br>				Case Filax_Bouton01<br>					If ServerMode=0<br>						ServerStream=CreateTCPServer(8080) <br>		<br>						If ServerStream&lt;&gt;0 Then <br>							InsertGadgetItem Filax_Liste01,0,"Démarrage du serveur ok ..." : WaitEvent(0)<br>							ServerMode=1<br>						Else <br>							InsertGadgetItem Filax_Liste01,0,"Impossible de démarrer le serveur ..." : WaitEvent(0)<br>							ServerMode=0<br>						End If <br>					EndIf<br>				Case Filax_Bouton02<br>					If ServerMode=1 Then<br>						InsertGadgetItem Filax_Liste01,0,"Serveur déconnecté ..." : WaitEvent(0)<br>						CloseTCPServer(ServerStream) <br>						ServerMode=0<br>					EndIf<br>			End Select<br>		Case $803 <br>			End<br>	End Select<br>	<br>	; ---------------------------<br>	; Boucle de gestion du reseau<br>	; ---------------------------	<br>	If ServerMode=1 Then<br>		TCPStream=AcceptTCPStream(ServerStream) <br>		<br>		If TCPStream Then<br>			TCPString$=ReadString$(TCPStream)<br>			<br>			T.NewClient=New NewClient<br>			T\Name$=TCPString$<br>			T\TCPStream=TCPStream<br>			<br>			InsertGadgetItem Filax_Liste01,0,"Nouvelle connection ..."+TCPString$ : WaitEvent(0)<br>			Proc_RedrawClientList()<br>		End If <br>	EndIf	<br>	<br>	Proc_GetClientMessage()<br>Wend 	<br><br>End <br><br>Function Proc_GetClientMessage()<br>	For T.NewClient=Each NewClient<br>		TCPString$=ReadString$(T\TCPStream)<br>		<br>		If TCPString$&lt;&gt;"" Then<br>			Select TCPString$<br>			Case "[DISCONNECT]"<br>				TCPString$=ReadString$(T\TCPStream)<br>				InsertGadgetItem Filax_Liste01,0,"Déconnection du client : "+TCPString$ : WaitEvent(0)<br>					<br>				Proc_RemoveClient(TCPString$)<br>				Proc_RedrawClientList()<br>			End Select<br>		EndIf<br>	Next<br>End Function<br><br>Function Proc_RedrawClientList()<br>	ClearGadgetItems Filax_Liste02<br>	<br>	For T.NewClient=Each NewClient<br>		InsertGadgetItem Filax_Liste02,0,T\Name$ : WaitEvent(0)		<br>	Next<br>End Function<br><br>Function Proc_RemoveClient(Name$)	<br>	For T.NewClient=Each NewClient<br>		If T\Name$=Name$<br>			CloseTCPStream T\TCPStream<br>			Delete T : Delay 2000<br>		EndIf<br>	Next	<br>End Function<br><br><br><br><br><br><br><br><br><br><br>Client Code :<br>-------------<br><br><br>Global Window_Width=600<br>Global Window_Height=215<br>Global Window_Left=410<br>Global Window_Top=400<br>Global Window_Title$="Filax window"<br><br>; Declaration d'une fenetre et des boutons<br>; ----------------------------------------<br>Global Filax_Window=CreateWindow(Window_Title$,Window_Left,Window_Top,Window_Width,Window_Height,0,1+8)<br><br>Global Filax_Bouton01=CreateButton("&amp;Connection au serveur",10,10,130,30,Filax_Window)<br>Global Filax_Bouton02=CreateButton("&amp;Déconnection du serveur",10,40,130,30,Filax_Window)<br>Global Filax_Bouton03=CreateButton("&amp;Envoyer une phrase",10,70,130,30,Filax_Window)<br><br>Global Filax_Liste01=CreateListBox( 150,10,430,150,Filax_Window )<br><br>Global ClientMode=0<br>Global ServerMode=0<br><br>Global ClientName$="Filax"<br><br>While Not KeyHit(1) <br>	; ----------------------------<br>	; Boucle de gestion des gadget<br>	; ----------------------------<br>	Select WaitEvent(0)<br>		Case $401	<br>			Select EventSource()<br>				Case Filax_Bouton01<br>					If ClientMode=0 Then<br>						ClientStream=OpenTCPStream("localhost",8080) <br>	<br>						If ClientStream&lt;&gt;0 Then <br>							WriteString ClientStream,ClientName$<br>							<br>							InsertGadgetItem Filax_Liste01,0,"Connection au serveur ok ..." : WaitEvent(0)<br>							ClientMode=1<br>						Else <br>							InsertGadgetItem Filax_Liste01,0,"Connection du serveur impossible ..." : WaitEvent(0)<br>							ClientMode=0<br>						End If <br>					EndIf<br>				Case Filax_Bouton02<br>					If ClientMode=1 Then<br>						WriteString ClientStream,"[DISCONNECT]"<br>						WriteString ClientStream,ClientName$<br>						Delay 2000<br>						<br>						CloseTCPStream(ClientStream)<br>						InsertGadgetItem Filax_Liste01,0,"Déconnection du serveur ok ..." : WaitEvent(0)<br>						ClientMode=0<br>					EndIf<br>				Case Filax_Bouton03<br>					Delay 1000<br>			End Select<br>		Case $803 <br>			End<br>	End Select<br>Wend <br><br></td></tr></table><br>
<a name="222212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anybody have an idea ? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
