<!DOCTYPE html><html lang="en" ><head ><title >Load from Bank</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Load from Bank</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Load from Bank</a><br><br>
<a name="257189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ALAN-MHz</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is possible (with or without custom dll) to load image, video and audio directly from a memory bank ? exist some external module to do this ? Thanks. <br><br></td></tr></table><br>
<a name="257225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, currently it can't be done by any means.<br><br>Its been asked for many times before though, so, fingers crossed it will be possible one day. <br><br></td></tr></table><br>
<a name="259085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Seldon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well.. as regards images can be possible using a trick. You create an image buffer (CreateImage) , then you copy all the bytes from the bank to the image buffer. Here it is some code I found (with B+ , you can do further optimitazions) :<br><br>Graphics 640,480<br>SetBuffer BackBuffer()<br><br>bBank = CreateBank(5)<br>iImage = LoadImage("testin.png")<br><br>ImageToBank(bBank, iImage)<br><br>newImage = BankToImage(bBank)<br>DrawImage newImage, 0,0<br><br>Flip<br>WaitKey()<br><br>FreeBank bBank<br>FreeImage newImage<br>FreeImage iImage<br>End<br><br><br>;;;;;;;;;;;;;;;;;;;;;;;;<br>; Function ImageToBank ;<br>;;;;;;;;;;;;;;;;;;;;;;;;<br>;Accepts a bank which will be resized to store the data, and an image to store, <br>;optional parameter is the AlphaFlag (currently irrelevant)<br>;Returns the error code.<br>Function ImageToBank(bankImage, bufferImage, iAlphaFlag=0)<br>bufOldBuffer = GraphicsBuffer();get the handle for the current buffer<br>Error = 0; Error 0 = no error, error 1 = image size invalid<br><br>;Check the image dimensions, if invalid then exit function with errorcode 1<br>If (ImageWidth(bufferImage)&lt;1) Or (ImageHeight(bufferImage)&lt;1) Then <br>	Error = 1<br>	Goto EndBufferToBank<br>EndIf<br><br>;get the total number of bytes the image makes up<br>SizeOfImage = ImageWidth(bufferImage)*ImageHeight(bufferImage)<br><br>ResizeBank bankImage, (SizeOfImage*4) + 9 ;(4 bytes per int for the image info + 9 extra bytes for header)<br><br>PokeInt bankImage,0,ImageWidth(bufferImage);store the width in the bank<br>PokeInt bankImage,4,ImageHeight(bufferImage);store the height<br><br>;store other info in byte 8 (the ninth byte)<br>iByte8 = %00000000<br>If iAlphaFlag Then iByte8 = iByte8 Or %00000001 ; OR the first bit to 1 if it has an alpha mask<br><br>PokeByte bankImage,8,iByte8 ;store iByte8<br><br>;DebugLog "Byte 8: " + iByte8<br><br>iBankPointer = 9<br>SetBuffer ImageBuffer(bufferImage)<br>LockBuffer ImageBuffer(bufferImage)<br>For iLoopX = 0 To ImageWidth(bufferImage)-1<br>	For iLoopY = 0 To ImageHeight(bufferImage)-1<br>		PokeInt bankImage,ibankPointer, ReadPixelFast(iLoopX,iLoopY)<br>		iBankPointer = iBankPointer + 4;increment by 4 each time since it is an int we are poking<br>	Next<br>Next<br>UnlockBuffer ImageBuffer(bufferImage)<br>SetBuffer bufOldBuffer ; restore the buffer<br><br>.EndBufferToBank<br>Return Error<br>End Function<br><br><br>;;;;;;;;;;;;;;;;;;;;;;;;<br>; Function BankToImage ;<br>;;;;;;;;;;;;;;;;;;;;;;;;<br>; Accepts a bank that has previously had its' data set with ImageToBank<br>; Returns an image<br>Function BankToImage(bankImage)<br>bufOldBuffer = GraphicsBuffer()<br>iWidth = PeekInt(bankImage,0)<br>iHeight = PeekInt(bankImage,4)<br>iiByte8 = PeekByte(bankImage,5)<br>;get the length of the data block<br>SizeOfData = iWidth*iHeight<br>imgReturn = CreateImage(iWidth,iHeight)<br><br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br>;Insert code To process iByte8<br>; NOTE FOR ALPHA: if ((BIT0) And %00000001) = 1 then (process alpha info)<br>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br><br>iBankPointer = 9<br><br>SetBuffer ImageBuffer(imgReturn)<br>LockBuffer ImageBuffer(imgReturn)<br>For iLoopX = 0 To ImageWidth(imgReturn)-1<br>	For iLoopY = 0 To ImageHeight(imgReturn)-1<br>		WritePixelFast(iLoopX,iLoopY,PeekInt(bankImage,iBankPointer))<br>		iBankPointer = iBankPointer + 4;increment by 4 each time since it is an int we are peekin<br>	Next<br>Next<br>UnlockBuffer ImageBuffer(imgReturn)<br>SetBuffer bufOldBuffer<br><br><br>Return imgReturn<br><br><br>End Function<br><br><br>; The following is a description of the format in which the information is stored in the bank<br>; -------------------------------------------------------------------------------------------<br>; <br>; Bytes 0-3 contains the width of the image (4-byte integer) must not be less than 1<br>; Bytes 4-7 contains the height of the image (4-byte integer) must not be less than 1<br>; Bit 0 of Byte 8 describes whether the image has an alpha mask (0=no, 1=yes) <br>; 		may contain more information at a later date<br>;<br>; NOTE FOR ALPHA: if ((BIT0) And %00000001) = 1 then (process alpha info)<br>;<br>; Bytes onward from 9 descrive the image as integers, because the length of this can be calculated<br>; by multiplying the width by the height, there is no need for a terminator <br><br></td></tr></table><br>
<a name="259106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seldon, I think the point in doing this is that you can generate images on the fly by peeking data on a bank, and then load the image passing the bank address. Another use is to prevent the media for your game to be accesible to undesired hands, because you can store the media encrypted in one PAK, and then load chunks of that PAK, decrypt them into a bank, and load it from a bank, without the need of a temp file in the hard disk.<br><br>So it's a different thing to what you're explaining. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
