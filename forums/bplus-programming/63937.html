<!DOCTYPE html><html lang="en" ><head ><title >FreeTGA?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >FreeTGA?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >FreeTGA?</a><br><br>
<a name="713563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tyler</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using the LoadTGA and DrawTGA functions I found in the code archives, but I need to know if there's a way to write my own FreeTGA function, and how I'd go about doing that.<br><br>I'm not sure whether it's the amount of TGAs I've got drawn (only 7), or the way I'm loading / deleting them whenever the image list updates, but Blitz+ slows to a crawl and dies after only 6-7 small TGA files (72x72 pixels), so I think it's that I've got no equivalent to "FreeImage" with the TGAs. Please help! Thanks! <br><br></td></tr></table><br>
<a name="713587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> To free the TGA you would need to do the following, I assume you are using Andres Code Archive Entry:<br><br>free the image then free the bank like so:<br><br><pre class=code>
Function FreeTGA(%image)

imghandle=peekint(image,2)
if imghandle&lt;&gt;0 then freeimage imghandle
freebank %image

end function

</pre><br><br>Also you may notice that in the LoadTGA command he does not close the file that was read from so you should include a "closefile file" command prior to the command "return bank"<br><br>There are ways to optimise drawing of images like this.<br><br>Because these images have to be drawn pixel by pixel, as in the DrawTGA function, a few tips would be:<br><br>1.Rather than calculating the color of an alpha blended sprite for each pixel regardless of whether it is fully transparent or fully opaque only calculate the alpha for those pixels with an alpha value of neither 0 nor 255.<br><br>2.Locking buffers does speed things up, which he does, but it is faster to do all your pixel writes in one hit than locking/unlocking buffers between each image to be drawn.  <br><br>Those are some of my thoughts on the matter, hope it can  help a little. <br><br></td></tr></table><br>
<a name="713592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tyler</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you! You've helped me immensely, and I'll see about taking your advice on selective calculating of the alpha pixels and buffer locking! Thank you again :D <br><br></td></tr></table><br>
<a name="713732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andres</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't need to worrie about the first aspect provided by Matty because it already does draw pixels 0/255 with DrawImage.<br><br>One more thing: Do you even need to use lockbuffer/unlockbuffer when using PokeInt to draw a pixel?<br><br>Updated the archives. <br><br></td></tr></table><br>
<a name="713761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tyler</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I appreciate all the help and thank you Andres for writing the TGA functions :D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
