<!DOCTYPE html><html lang="en" ><head ><title >Formatting Text Areas</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Formatting Text Areas</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Formatting Text Areas</a><br><br>
<a name="756858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alaric</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having some problems with formatting text areas.  I'm trying to get the program to color certain words that appear in the text area for a programming text editor.  Here's the code.  <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Global Mainwin=CreateWindow("Mainwin",0,100,640,480,Desktop(),3)

Global SaveButt=CreateButton("Save",0,0,25,25,Mainwin,1)
SetGadgetLayout(SaveButt,1,0,1,0)
Global OpenButt=CreateButton("Open",25,0,25,25,Mainwin,1)
SetGadgetLayout(OpenButt,1,0,1,0)

Global MainArea=CreateTextArea(0,23,631,423,Mainwin,0)
SetTextAreaColor(MainArea,243,243,243,True)
tmpfont=LoadFont("Arial",14)
SetTextAreaFont MainArea,tmpfont
SetGadgetLayout(MainArea,1,1,1,1)

HotKeyEvent(28,0,$FFFF)

Repeat
	event=0
	event=WaitEvent()
	Select event
	Case $803
		Exit
	Case $FFFF
		AddTabs(MainArea)
	Case $401
		Select EventSource()
		Case MainArea
			;Stop
			LockTextArea mainarea
			FormatTextAreaText(mainarea,1,1,1,0,0)
			UnlockTextArea mainarea
			ColorText(MainArea," Xor ; And ; Or ; Not ",255,0,0)
		End Select
	Default
	End Select
Forever

HotKeyEvent(28,0,0)

Function colortext(TextArea,ColorString$,colorr,colorg,colorb)
	Strng$=TextAreaText$(textarea)
	While Instr(ColorString,";",LastFindExt+1)
		Strng$=TextAreaText$(textarea)
		NextHighLight$=Mid$(ColorString,LastFindExt+1,Instr(ColorString,";",LastFindExt+1)+LastFindExt-1)
		LastFindInt=0
		While Instr(Lower$(strng),Lower$(NextHighLight),LastFindInt+1)
			Strng$=TextAreaText$(textarea)
			LockTextArea mainarea
			FormatTextAreaText(TextArea,ColorR,ColorG,ColorB,0,Instr(Lower$(strng),Lower$(NextHighLight),LastFindInt+1)-1,Len(NextHighLight),1)
			UnlockTextArea mainarea
			LastFindInt=Instr(Strng,nexthighlight,LastFindInt+1)
		Wend
		LastFindExt=Instr(ColorString,";",LastFindExt+1)
	Wend
End Function

Function AddTabs(TextArea)
	linenum=TextAreaCursor(TextArea,2)
	lineabove$=TextAreaText(TextArea,linenum-1,linenum,2)
	I=1
	While (Mid$(lineabove,I,1) = "	") And (I &lt; Len(lineabove))
		I=I+1
	Wend
	For J=1 To I-1
		ret$=ret$+"	"
	Next
	SetTextAreaText(TextArea,ret,TextAreaCursor(MainArea,1),0,1)
	For J=1 To I-1
		keypress(39,0,0,0)
		keypress(39,0,2,0)
	Next		
End Function</textarea><br><br>P.S. you'll need this userlib in order to run the program <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1227." target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1227.</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
