<!DOCTYPE html><html lang="en" ><head ><title >Problem with Blitz 2D code running in Blitz Plus</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Problem with Blitz 2D code running in Blitz Plus</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Problem with Blitz 2D code running in Blitz Plus</a><br><br>
<a name="203805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a 2d app that I wrote in Blitz 3D, it doesn't use any of the 3D code.  It runs in widowed mode.  Techinally it should run in all versions of Blitz.  Anyway, when I run it in Blitz plus, the graphic speed is so slow, it's literally like a frame a second.  If I run the same app in blitz 3D, it runs at full speed.  Has anyone experienced this?  This is frustrating. <br><br></td></tr></table><br>
<a name="203809"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitzplus uses a different format for images that is not as fast (managed images I think was the name).  Someone worked around it by creating a hidden canvas and storing graphics on that.  Search the forums for something like the word canvas and you should find it. <br><br></td></tr></table><br>
<a name="203819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> dynaman is right.  BlitzPlus loads images to a different area of memory, and as a result image manipulations can be slow.  However, canvases are still fast (in fact they should be faster than Blitz2d), so you should use them instead.  The next update to Blitz, according to marks worklog, should enable you to store the image in memory appropriate to what you intend to do with it.  i.e. you'll be able to request that an image is in memory that makes it as fast as canvases. <br><br></td></tr></table><br>
<a name="203848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had that experience last week when doing some r-type style thingy, in windowed mode (using graphics mode) it was nice 'n fast, but when running fullscreen it was really very slow! <br><br></td></tr></table><br>
<a name="203855"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't found B+ faster than B3d (2d mode), if anything it's considerably slower in canvas mode, not talking about the new pixel writing routines(haven't tried these yet). Although speed is OK for aplications and games. Also Mark S. is doing something about this. Also most games will run in full screen mode.<br><br>But one frame a second seems ludicrous, are you sure you have turned debug off? <br><br></td></tr></table><br>
<a name="204004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep <br><br></td></tr></table><br>
<a name="204147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Craig,<br>any chance to have a small piece of code that replicates the behaviour you are claiming ?<br><br>It's really hard to guess what's going on without a code example.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="204203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Reaper</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heres a fps test program I`ve written in B+ . With background of 600 Drawblock Tiles and 600 Sprite drawn with DrawImage I get 77Fps. Turn off the Drawblock routine and I get 120fps. This is on an 850Amd / 512mb / Geo2.<br><br>;Fps Test using canvas<br><br>w=GadgetWidth(Desktop())<br>h=GadgetHeight(Desktop())-40<br>w2=640<br>h2=480<br>If w2 &gt; w Then w2 = w<br>If h2 &gt; h Then h2 = h<br>x1 = (w-w2)/2<br>y1 = (h-h2)/2<br><br> <br>frametimer=CreateTimer(600)<br><br>mainwindow=CreateWindow("Test Gfx",0,0,w,h,0,15)<br><br>menu=WindowMenu(mainwindow)<br>File = CreateMenu("File",0,menu)<br>CreateMenu "Start",1,File<br>CreateMenu "Exit",2,File<br>UpdateWindowMenu mainwindow<br><br>can=CreateCanvas(x1,y1,w2,h2,mainwindow)<br>SetBuffer CanvasBuffer(can)<br>Cls<br><br>Repeat<br>	Select WaitEvent()<br>		Case $1001<br>			Select EventData()<br>				Case 1<br>					Exit<br>				Case 2<br>					Notify "bye"<br>					End<br>			End Select<br>		Case $803<br>			End<br>	End Select<br><br>Forever	<br><br><br>Color 255,0,0<br>Rect 1,1,18,18,1<br>gfx=CreateImage(20,20,701)<br>GrabImage gfx,0,0,1<br><br>Cls<br>Color 0,0,255<br>Rect 0,0,20,20,1<br>GrabImage gfx,0,0,2<br><br>Cls<br>For n = 3 To 200<br>Color 255,n,255-n<br>Rect 1,1,18,18,1<br>GrabImage gfx,0,0,n<br>Next<br><br>Cls<br>For n = 201 To 400<br>Color 450-n,n-150,66<br>Rect 1,1,18,18,1<br>GrabImage gfx,0,0,n<br>Next<br><br><br>Cls<br>For n = 401 To 600<br>Color n-350,66,650-n<br>Rect 1,1,18,18,1<br>GrabImage gfx,0,0,n<br>Next<br><br>MaskImage gfx,0,0,0<br><br>Cls<br>	<br>x=50:y =50<br><br>Type sprite<br>Field x<br>Field y<br>Field lr<br>Field ud<br>Field s<br>End Type<br>For n = 1 To 3<br>For x = 1 To 20<br>For y = 1 To 10<br>alien.sprite = New sprite<br>alien\x = x*30<br>alien\y = y*40<br>alien\lr = (Rnd(0,2)-1)<br>alien\ud = (Rnd(0,2)-1) <br>alien\s =  Rnd(1,2)<br>Next<br>Next	<br>Next<br>	<br>	<br><br><br>Gosub drawscreen<br><br><br>	<br>	<br>Repeat<br>	id= WaitEvent()<br>	If (KeyHit(205) Or KeyDown(205)) And x &lt; w2-20 Then x = x + 1<br>	If (KeyHit(203) Or KeyDown(203)) And x &gt; 0 Then x = x - 1	<br>	If (KeyHit(200) Or KeyDown(200)) And y &gt; 0 Then y = y - 1<br>	If (KeyHit(208) Or KeyDown(208)) And y &lt; h2-20 Then y = y + 1<br>	If KeyHit(1) Then Exit<br>	Select id<br>		Case $1001<br>			Select EventData()<br>				Case 2 <br>					Notify "bye"<br>					End<br>			End Select<br>		Case $803<br>			End<br>		Case $4001<br>			If EventSource() = frametimer Then Gosub drawscreen<br>	End Select	<br>Forever<br><br>End<br><br><br><br>.drawscreen<br>If MilliSecs() &gt; fpstime Then <br>	fpstime = MilliSecs()+1000<br>	fpss=fps<br>	fps=1<br>Else<br>	fps=fps+1<br>EndIf<br><br>;Draw a tiled background made of 600 tiles<br>Cls<br>For xx = 1 To 30<br>	For yy = 1 To 20<br>		DrawBlock gfx,xx*(w2/32),yy*(h2/24),2<br>	Next<br>Next<br><br>;Draw 600 sprites on screen<br>i = 2<br>For alien.sprite = Each sprite<br>	i = i +1<br>	If alien\lr = 1 Then <br>		alien\x = alien\x + alien\s<br>		If alien\x &gt;(w2-20) Then alien\x=w2-20 : alien\lr = -1	<br>	Else<br>		alien\x = alien\x - alien\s<br>		If alien\x &lt; 0 Then alien\x = 0 : alien\lr = 1<br>	EndIf<br>		<br>	If alien\ud = 1 Then <br>		alien\y = alien\y + alien\s<br>		If alien\y &gt;(h2-20) Then alien\y=h2-20 : alien\ud = -1	<br>	Else<br>		alien\y = alien\y - alien\s<br>		If alien\y &lt; 0 Then alien\y = 0 : alien\ud = 1<br>	EndIf<br>	<br>		<br>	DrawImage gfx,alien\x,alien\y,i<br>	<br>Next<br><br>	DrawImage gfx,x,y,1<br>	SetStatusText mainwindow,"Fps "+fpss<br><br>	FlipCanvas can<br>Return<br><br><br>p.s how do I insert code in one of them cool scrolly window thingy`s ? <br><br></td></tr></table><br>
<a name="204234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> reaper&gt;&gt; nice, I get 130 with drawings, 305 without<br><br>Athlon 1Ghz // 512 meg RAM // Gforce4 MX <br><br></td></tr></table><br>
<a name="204486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >notandor</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've just updated my graphics card drivers to the latest nVidia ones, and I get 15fps! on my AtlonXP2100, 512mb DDR333 Ram, GF4 Ti4600, and a test program I was writing before the upgrade now runs almost 7.5 times slower even with debug turned off. Can't wait for the update. <br><br></td></tr></table><br>
<a name="204499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> The latest Nvidia drivers do not seem to like 2d text in blitz.  Mark is looking into it. <br><br></td></tr></table><br>
<a name="204586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nvidia drivers. Hmmm. here the older seem to work better than the newer ones. Nvidia here seems to have made a good job at making their drivers worse and worse with time. Maybe it's a cool idea to make you buy their latest card. <br><br></td></tr></table><br>
<a name="206362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was under the impression the image manipulation slowdown occurred mostly when you want to draw to an ImageBuffer.  But in my 2D code I've just started messing around with, I am trying to draw some very large bitmaps onto the screen and everything slows down to 1-2 FPS when any part of those images are drawn, when they are scrolled offscreen everything is fast again.  The slowdown occurs with even just 1 pixel of the large bitmaps showing...  Will canvasses help this or is this something else that will be improved when Mark implements the image storing flags? <br><br></td></tr></table><br>
<a name="210590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GameLab</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> That is weird...<br>I have written this game and compiled it.<br>But, I have just downloaded the Blitz Plus Demo and ran the<br>game from within the IDE.<br>And and appears to be running much faster than the compiled B3D one.<br>I will have to check out, add an FPS indicator to the game; but, as far as I can tell just by looking at it, it runs MUCH faster.<br>The sound doesn't work, thou.<br>By te wau, any ideas why the sound is not working ?<br>/R <br><br></td></tr></table><br>
<a name="210972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, B+ is faster with it's graphics if you're not doing anything too tricky ;]<br><br>As far as the sound is concerned...  it's my understanding that LoopSound no longer works, an optional flag has been added to PlaySound instead.  There are other posts around here somewhere that will explain it better.  Go huntin ;] <br><br></td></tr></table><br>
<a name="213671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I heard that Nvidia know about this problem with their graphics drivers and are soon going to be releasing a new set of drivers to rectify the problem. <br><br></td></tr></table><br>
<a name="214296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I believe one or two or maybe three (minor) driver updates have been released since they said that and the problem remains ;] <br><br></td></tr></table><br>
<a name="214306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SDF_of_BC</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had the problem with the full screen thing, it kept flashing making my eyes go funny, so I got rid of some viewport stuff and it stopped :D <br><br></td></tr></table><br>
<a name="214365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;&gt; I believe one or two or maybe three (minor) driver updates have been released since they said that and the problem remains ;] <br><br>No drivers have been released archive or otherwise since the initial 43.45 March 27 release. Perhaps your thinking of unofficial ones, but those shouldn't contain the fix anyway since only nVidia was mailed about it. <br><br></td></tr></table><br>
<a name="214646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, well, that explains that then =] <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
