<!DOCTYPE html><html lang="en" ><head ><title >External Windows</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >External Windows</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >External Windows</a><br><br>
<a name="346073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, ive seen a post on this before i think but i couldn't find it so maybe i didnt...anyway...is there anyway to control external windows, like if i have another app open say (as its the first that came to mind) Notepad. Is there anyway to close it using blitz or even write into it?<br><br>Thanks if you can help <br><br></td></tr></table><br>
<a name="346133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, but you have to use WinAPI (not so hard).  There are a number of functions that will let you do a number of things.  What do you need specifically? <br><br></td></tr></table><br>
<a name="346144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well i was just inquiring at the mo for the future, but thanks for the info!<br><br>Matt <br><br></td></tr></table><br>
<a name="346245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um this may sound stupid what is WinAPI? <br><br></td></tr></table><br>
<a name="346348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows Application Programming Interface.  Essentially a bunch of DLLs from Microsoft in windows\system(32) that provide functions for programming with Windows.  See documentation on msdn.microsoft.com. <br><br></td></tr></table><br>
<a name="346719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok thanks <br><br></td></tr></table><br>
<a name="346789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok i found one to get the window handle "FindWindowEx" but i dont know how i would get it to work in my program.<br><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/Windowing/Windows/WindowReference/WindowFunctions/FindWindowEx.asp" target="_blank">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/WinUI/WindowsUserInterface/Windowing/Windows/WindowReference/WindowFunctions/FindWindowEx.asp</a> <br><br></td></tr></table><br>
<a name="346832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> First you need to write a declaration (.decls) for it.  See "Specs and Utils -&gt; Userlibs Specifications".<br><br>At the bottom of the MSDN page, look at the Import Library (user32.lib) -- so this function is found in user32.dll.<br><br>1) Type in a plain text file:<br><pre class=code>.lib "user32.dll"</pre><br><br>Now look at the function declaration, at the top.  Let's break it apart, bit by bit.  The first part of it (HWND) specifies that it returns a handle to a window (which to Blitz, is just an Int) so put in the name of the function for Blitz, and an Int return value:<br><pre class=code>FindWindowEx%(...</pre><br>And then it takes 4 parameters.  The two HWNDs are Ints to Blitz, and the two LPCTSTRs are pointers to character arrays in C, which would be Strings to Blitz.  So we specify those parameters like so:<br><pre class=code>FindWindowEx%(hwndParent%, hwndChildAfter%, lpszClass$, lpszWindow$)...</pre><br>The parameter names can really be anything you want, but I just made them the same as what's on MSDN.  Also, notice the descriptions for the arguments on MSDN.  They're all marked as IN which means the arguments are only used as you pass them in.  Sometimes they might be marked OUT or IN\OUT, which means they could be used to return values to you, and you would probably have to pass a custom type instance or a bank (basically, a memory block).  Also, if you want to pass NULL, the parameter must be declared as % and you must pass 0.<br><br>Finally, just write the name of the function exported from the DLL, like so:<br><pre class=code>FindWindowEx%(hwndParent%, hwndChildAfter%, lpszClass$, lpszWindow$):"FindWindowEx"</pre><br>and then save that file with a .decls extension and put it in the userlibs folder.  <br><br>You might also want to take note of the supprted versions of Windows for the function.<br><br>Now to use it in a program, you can just type:<br><pre class=code>hwnd% = FindWindowEx(0, 0, "CLASSNAME", "TITLE")</pre><br><br>This will search all the windows (and child windows) on the desktop for one that matches the CLASSNAME window class, and TITLE in the title bar.  Note that you could also change the 4th parameter from $ to %, and pass 0 instead to match anything.<br><br>In order to get the window classname, try downloading Greatis' WinDowse.  It will tell you a ton of stuff about the windows on your desktop.<br><br>Well, that's the basics of it.  Make sure you do error handling and such.  Try it out, you'll probably have questions.  Hope it makes sense for you though.  =) <br><br></td></tr></table><br>
<a name="346837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, it makes perfect sense! I'll try it out now. <br><br></td></tr></table><br>
<a name="346846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just had a go but it says user lib function not found.<br><br>Have i done something wrong? <br><br></td></tr></table><br>
<a name="347016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> - <br><br></td></tr></table><br>
<a name="347170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I still get "user lib function not found". I put it in the user32.decls which also has other functions and they work fine. I tried a different one that i found and also put it in user32.decls but that doesn't work either. When i tried the beep function, that seemed to work ok. <br><br></td></tr></table><br>
<a name="347342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, I see.  The actual exported function name is FindWindowExA.  Tack that A onto the end there and see how that works.<br><br>I found this out by looking at the actual exported functions of the DLL with dumpbin.  (You can also do it with PEView.) <br><br></td></tr></table><br>
<a name="347980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for all your help, its now working!<br><br>Thanks again to everyone! <br><br></td></tr></table><br>
<a name="347986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not a problem.  Would you mind posting your declarations and bb function call?  Does it still say "user lib function not found"?<br><br>If so, make sure that these two lines:<br><pre class=code>.lib "user32.dll"
FindWindowEx%(hwndParent%, hwndChildAfter%, lpszClass$, lpszWindow$):"FindWindowExA"</pre><br>...are in a .decls file which is found in the userlibs folder.    Remember, it doesn't matter what you call the .decls file as long as it is plain text, there is only one '.lib "user32.dll"' line, and it's in the userlibs folder.  <br><br>Then, just put this line:<pre class=code>hwnd% = FindWindowEx(0, 0, "CLASSNAME", "TITLE")
Notify hwnd</pre> into a program and run it.  It should return 0, but you can try it with an actual classname and title (found from WinDowse) and it should work.<br><br>If you don't see where your problem is, we'll help you figure it out. <br><br></td></tr></table><br>
<a name="347989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol, I spoke too soon. The handle i get from Blitz is different to the one i get on WinDowse. WinDowse has letters in the handle for media player, while when i change the variable type for the blitz one, i get a strange symbol. Also when i use DestroyWindow (API) with the handle i get from blitz, nothing happens to Media Player. <br><br></td></tr></table><br>
<a name="347993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stay away from DestroyWindow, use PostMessage with the WM_CLOSE (16) flag to kill it. <br><br></td></tr></table><br>
<a name="348057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> do you mean the class? or the actual windows handle? <br><br></td></tr></table><br>
<a name="348167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>a% = FindWindowExA(0, 0, "WMPlayerApp", "Windows Media Player")</pre><br><br>When i print a it has a number in it but when i looked at the handle in WinDowse it showed a number with a B in it. <br><br></td></tr></table><br>
<a name="348332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> B is a number is hexadecimal (base 16, 0-9,A-F... F=15 in decimal)<br><br>I've been comparing the two -- I'm not sure what handle WinDowse is displaying.  I'm not sure I would trust it (since I can't figure it out).  Try this:<br><pre class=code>
w=CreateWindow("hi",100,100,100,100,0,3)
Print GetForegroundWindow()
Print FindWindowEx(0, 0, "BLITZMAX_WINDOW_CLASS", "hi")
Print QueryObject(w,1)
WaitKey()
</pre><br>See how they all display the same number?  I don't know what WinDowse is displaying... I've never used it to get a window handle.  (Also not that window handles will probably change each time you create/destroy the window.)<br><br>GetForegroundWindow is defined under .lib "user32.dll" as:<br>GetForegroundWindow%():"GetForegroundWindow" <br><br></td></tr></table><br>
<a name="348371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattVonFat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, it seems to be working ok now. Not only that i've also learnt about making decls for the WinAPI, so this has been a good learning experience.<br><br>Thanks again <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
