<!DOCTYPE html><html lang="en" ><head ><title >Did update change MouseXSpeed and MouseYSpeed?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Did update change MouseXSpeed and MouseYSpeed?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Did update change MouseXSpeed and MouseYSpeed?</a><br><br>
<a name="368788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abazek</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I recently downloaded and installed BlitzPlus Update 137 (formerly had BlitzPlus 111).<br><br>Is there a Version Log which lists chages?  Specifically, what was changed with the MouseXSpeed and MouseYSpeed functions?  <br><br>I was using these fuctions to aim a tank turret in a game I'm making, and with BlitzPlus 111 it works fine.  Now with the 137 updated installed, the turret jumps all over the place.<br><br>Here's the piece of code:<br><br>   ;; MouseX can also change gun angle<br>   mxs=MouseXSpeed()<br>   If mxs&lt;&gt;0 Then<br>      tank\angle=tank\angle+mxs<br>      MoveMouse ScreenXSize/2,ScreenYSize/2<br>   End If<br><br>If I comment out the "MoveMouse" it works as before...  But it will stop when the mouse hits the edge of the screen (that was why I put the MoveMouse in...  It would keep the mouse in the center so it would never hit the edge of the screen and quit working).<br><br>I've thought of several solutions (I can share them if you want, just let me know).<br><br>I was just wondering what changes were made to MouseXSpeed() and MouseYSpeed() because the above code worked pefectly in BlitzPlus 111 but doesn't work in BlitzPlus 137 (nothing else was changed in the Source Code.  Only change was to update to BlitzPlus 137) <br><br></td></tr></table><br>
<a name="368792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> After you install an update, versions.txt is placed in your B+ directory and it outlines the fixes. I looked through my 1.37 changelog and didn't see any note of mouse alterations. <br><br></td></tr></table><br>
<a name="368793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The mouse speed functions return the number of pixels the mouse has moved.  Changing it would be nonsensical.<br><br>I'll bet you're just running your game, or windows, in a different resolution.<br><br>The solution is to code a custom mouse speed function which takes into account the resolution, assuming that windows does not change the mouse speed depending on resolution.  I'm not sure if it does or not.<br><br>If it does, then using floating point values, divide the speed by the resolution, and either use that, or multiply by your chosen base resolution, ie, 1024x768, to convert to pixels in that res.<br><br>You can also average the mouse position over two frames to smooth out the motion more. <br><br></td></tr></table><br>
<a name="368796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abazek</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for mentioning Versions.txt Eikon.<br><br>Also, good suggestions, sswift...  But I'm not changing MouseSpeed. I'm changing MouseCoordinates! <br>This has to be done so MouseXSpeed will always return a value when the player moves the mouse (if I do not return<br>the mouse to the center afterwords, MouseXSpeed will always return 0 when the mouse reaches the edge of the screen.  Even if the player continues to move it...)<br><br>Also, keep in mind that it worked perfectly in BlitzPlus 1.11, but it doesn't work in BlitzPlus 1.37...  The only<br>thing that changed is that I updated BlitzPlus.  Nothing else.  Its the same machine, same Windows version, same<br>Resolution...  I even rebooted to make sure it wasn't just Windows instability...<br><br>My solution, for now, was to Down-Grade...  That is, to use the older BlitzPlus 1.11, which I had originally downloaded.  I don't like that at all because there are a lot of Bug Fixes between 1.11 and 1.37!!!<br><br><br>PS:  The code also works fine in Blitz3D 1.86 (the newest available at time of this writing).  But I am planning to use a few functions which are present BlitzPlus but not in Blitz3D... <br><br></td></tr></table><br>
<a name="368797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>But I'm not changing MouseSpeed. I'm changing MouseCoordinates! <br> <br></div><br>SSwift meant that an update changing the command would be pointless, not you.<br><br>I just noticed MoveMouse has an optional canvas parameter just like MouseXSpeed()/MouseYSpeed(). If your even using one, have you tried passing them the canvas handle? <br><br></td></tr></table><br>
<a name="368799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abazek</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree...  I'm thinking its a BUG...  Like maybe updating something else (perhaps the addition of Canvases?) might have inadvertantly caused MouseXspeed/MouseYspeed to behave differently.<br><br>In my code, I'm not using any canvas.  Just GRAPHICS 800,600,16,1 and TEXT, PLOT, DRAWIMAGE, and FLIP.  Pretty simple stuff.  <br><br>Hmm...  Wondering if there is a canvas handle for the default screen?<br><br><br>Oh, and thanks for your help and quick response! <br><br></td></tr></table><br>
<a name="368957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abazek</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> FOUND A FIX...  If you add a call to MouseXSpeed IMMEDIATELY after the call to MoveMouse, it works correctly (in all versions old and new both BlitzPlus and Blitz3D).  <br><br>This code illustrates:<br><br>.MainLoop<br>;;<br>;;  Whole bunch of other code for the game here<br>;;<br>mxs=MouseXSpeed() <br>If mxs&lt;&gt;0 Then <br>  tank\angle=tank\angle+mxs <br>  MoveMouse ScreenXSize/2,ScreenYSize/2 <br>  mxs=MouseXSpeed() <br>End If <br>;;<br>;;  Code to draw Tank, Turrent, and FLIP here...<br>;;<br>Goto MainLoop<br><br>Now if anyone can tell me WHY this extra call to MouseXSpeed is required in the newer (1.36, 1.37) versions of BlitzPlus and NOT required in the older (1.11) versions of BlitzPlus and the current version (1.86) of Blitz3D that would be great!!<br><br>PS:  I got the idea to try this from the Blitz3D documentation.  There's a line that says "You really have to use these commands TWICE to get anything out of them. Each call you make returns the difference in location since the LAST time you called it."...<br><br>Now, whats funny is in the example code given (in Blitz3D Documentation) does NOT call MouseXSpeed and MouseYSpeed immediately after the call to MouseMove...  This example code (just like my code) will run just fine in BlitzPlus 1.11 but will not run correctly (as is) BlitzPlus 1.37.  It will run in both older and newer versions of Blitz3D.<br><br>In the Sample Code, if you add a call to MouseXSpeed and MouseYSpeed immediately after the call the MoveMouse, the Sample Code will work in BlitzPlus 1.37.<br><br><br>DEFINITELY, UNQUESTIONABLY A BUG HERE SOMEWHERE.  Either BlitzPlus 1.37 isn't handling MouseXSpeed/MouseYSpeed correctly (most likely), OR all the other versions of BlitzPlus and Blitz3D are not handling it correctly (unlikely).<br><br><br><br>Here is the Sample Code from the Blitz3D Docs, for reference<br>(this is the code without the extra calls after MoveMouse, it will work fine in Blitz3D and older versions of BlitzPlus, but not in newer versions of BlitzPlus):<br><br>Graphics 640,480 <br>SetBuffer BackBuffer() <br>x=320 <br>y=240 <br><br>; infinite mouse movement <br><br>Repeat <br>Cls <br>xs=MouseXSpeed() ; see how far the mouse has been moved <br>ys=MouseYSpeed() <br>MoveMouse 320,240 ;put the mouse back in the middle of the screen <br><br>x=x+xs ;adjust mouse co-ords <br>y=y+ys <br><br>If x&gt;GraphicsWidth()-1 Then x=x-GraphicsWidth() ;wrap screen <br>If x&lt;0 Then x=x+GraphicsWidth() <br>If y&lt;0 Then y=y+GraphicsHeight() <br>If y&gt;GraphicsHeight()-1 Then y=y-GraphicsHeight() <br><br>Text x,y,"X",True,True <br><br>Flip <br>Until KeyHit(1) <br>End <br><br><br><br>Here is that same sample code with the extra call to MouseXSpeed and MouseYSpeed after the call to MoveMouse (this will work correctly in all versions of BlitzPlus and Blitz3D):<br><br>Graphics 640,480 <br>SetBuffer BackBuffer() <br>x=320 <br>y=240 <br><br>; infinite mouse movement <br><br>Repeat <br>Cls <br>xs=MouseXSpeed() ; see how far the mouse has been moved <br>ys=MouseYSpeed() <br>MoveMouse 320,240 ;put the mouse back in the middle of the screen <br>;;<br>;;  Extra call to MouseXSpeed/MouseYSpeed to overcome BUG in BlitzPlus 1.36 and 1.37:<br>;;<br>tmp=MouseXSpeed()<br>tmp=MouseYSpeed() <br><br>x=x+xs ;adjust mouse co-ords <br>y=y+ys <br><br>If x&gt;GraphicsWidth()-1 Then x=x-GraphicsWidth() ;wrap screen <br>If x&lt;0 Then x=x+GraphicsWidth() <br>If y&lt;0 Then y=y+GraphicsHeight() <br>If y&gt;GraphicsHeight()-1 Then y=y-GraphicsHeight() <br><br>Text x,y,"X",True,True <br><br>Flip <br>Until KeyHit(1) <br>End <br><br><br>Hopefully this will help others who want to use the Mouse to move game characters in BlitzPlus! <br><br></td></tr></table><br>
<a name="369175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> So... what you're doing is: <br><br>Get the mouse speed since the last time you called the function.  <br><br>At this point the mouse is  still off center.  <br><br>Then you move the mouse back to the center of the screen. <br><br>Then getting the mouse speed again.<br><br>What this second mouse speed call is telling you is how far the mouse moved since the last call to it.  And the mouse has just been moved from some location on the screen, back to the center.<br><br>At first glance I thought what you were doing was nonsensical, since the mouse couldn't have moved very far since you called the mouse position command, but apparently the mouse position command doesn't reset the mouse speed command back to 0.<br><br>I have to ask though... you have two calls there.  Which is the original?  The one before repositioning the mouse in the center, or the one after?  Have you considered that you could just put the one in the other place?  Ie, if it was before, put it after?  That could solve your problem too.   <br><br>I don't know why it would not work both ways. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
