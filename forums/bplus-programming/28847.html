<!DOCTYPE html><html lang="en" ><head ><title >Colorfade (to/from) black algorithm</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Colorfade (to/from) black algorithm</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Colorfade (to/from) black algorithm</a><br><br>
<a name="304028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> @all<br><br>On the Amiga I programmed plenty of demo's where I faded to/from black an image in realtime.<br><br>Holy christ, I just cannot remember the algorithm I used, I remember I used bit-by-bit fade ... but I just cant remember how.<br><br>help out, please! and I'm talking BlitzPlus here ... <br><br></td></tr></table><br>
<a name="304055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's one in the code archives. In fact there's quite a few. :) <br><br></td></tr></table><br>
<a name="304057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Ross C<br><br>yeah, I checked them all out, but they all seem to be slow or in other ways limited to Blitz3D <br><br></td></tr></table><br>
<a name="304065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kevin_</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dont forget that on the Amiga all you had to do was change the value in a colour register. On the PC it is quite different. You have to manually change the RGB of each pixel colour. However, some people have managed to get this working at a reasonable speed. <br><br></td></tr></table><br>
<a name="304069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Prof<br><br>yeah, you're right. I still think Assembler on the Amiga logically, which just complicates things ... <br><br></td></tr></table><br>
<a name="304072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kevin_</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Programming in Assembler on the Amiga A500 was great because everyone had the same chipset which meant you had cross-compatability. Those days are gone I'm afraid due to every PC being different. You can get away with some Assembler on the PC but if you hit the hardware direct then you are asking for trouble.<br><br>Regards <br><br></td></tr></table><br>
<a name="304076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Hansie, it really depends on the size of the image. Fading to black will be quite quick, as there's no reading from vram required. Just blend the piexels to/from back. :) <br><br></td></tr></table><br>
<a name="304077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Ross C<br><br>yeah, but what are the fastest BlitzPlus commands for blending pixels? <br><br></td></tr></table><br>
<a name="304092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you would use lockedpixels command. I've only just recently bought Blitz plus, so i'm not up to speed yet :) <br><br></td></tr></table><br>
<a name="304098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Brine</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yo dude<br><br>You could use the gamma channel commands to fade to black<br>this is pretty fast.<br><br>Mr Brine <br><br></td></tr></table><br>
<a name="304215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >darklordz</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> yea but they only work in fullscreen!@ <br><br></td></tr></table><br>
<a name="304264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lockedpixels command together with RPF and WPF. You can boost the speed if you store the image RGB values in an array or a bank and then either read it from there or peek it from the bank. You can do full screen fades at a decent speed if you program it right. <br><br></td></tr></table><br>
<a name="304334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Seldon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Hansie: it isn't just a matter of assembly. Original Amiga chipset can offer just 256 colours (HAM and HAM24 is a trick) so you only need to change the register of each colour. With a PC you could also do that if you opened a palette based 256 colours screen, but that is *not* possible in 16/24 bits modes (also with Amiga).<br><br>@zawran: If you use LockedPixels you can access the image buffer like a bank, right ? I mean you can use Poke/Peek, with no copy needed into a bank ? <br><br></td></tr></table><br>
<a name="304350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> @all<br><br>I have never used the GAMMA commands in BlitzPlus. Has anyone experience with these? <br><br></td></tr></table><br>
<a name="304382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, but they only work in full screen mode, so I forgot about them again because I tend to either use windowed or give the user an option, so its no good. <br><br></td></tr></table><br>
<a name="304429"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Brine</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi hansie,<br><br>Ive had some experince, I cant remember a great deal about em but I did code this kewl little function that lets you manipulate the gamma channels in a nice user friendly way, any how check it out:<br><br>;-----------------------------------------------------------<br><br>;r/g/bint	: rgb intensity (0 - minimum, 255 - maximum)<br>;<br>Function SetGammaRGBIntensity(rint#, gint#, bint#)<br><br>	Local r#, g#, b#<br><br>	Local ri# = rint / 255.0<br>	Local gi# = gint / 255.0<br>	Local bi# = bint / 255.0<br><br>	For w = 0 To 255<br><br>		SetGamma w, w, w, r, g, b<br>		r = r + ri<br>		g = g + gi<br>		b = b + bi<br><br>	Next	<br><br>	UpdateGamma<br>	<br>End Function<br><br>;---------------------------------------------------------<br><br><br>so set the color palette to normal call:<br><br>SetGammaRGBIntensity(255, 255, 255)<br><br>to set the color palette to black call:<br><br>SetGammaRGBIntensity(0, 0, 0)<br><br>to fade the color palette to black:<br><br>for x = 255 to 0 step -1<br><br>    SetGammaRGBIntensity(x, x, x)<br><br>next<br><br>You can also get other palette effects by setting the different intensity values to different values.  Things to note:<br><br>- its only useable in full screen mode.<br>- the amount of processor time this function takes is   pretty variable, the updategamma function seems to only update values in the gamma channel it needs to.  Tests on my computer (p4 2ghz with a gforce fx5600 running at 60fps) showed it was consuming approx 10 - 30% of availavle processor time depending on which rgb intensity values were being modified. <br><br>Yeah!<br><br>Mr Brine <br><br></td></tr></table><br>
<a name="304593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> @all<br><br>Thanx :-D <br><br></td></tr></table><br>
<a name="326018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Zawran<br><br>Do you have a working sample for Windows mode? <br><br></td></tr></table><br>
<a name="326042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is some pseudo code for you:<br><br>for each pixel in buffer<br>   read pixel from buffer<br>   transform pixel to individual r,g,b values<br>   minus fadenumber from each value<br>   make sure the values does not pass boundry<br>   write combined rgb value back into buffer<br>next<br><br>I Hope thats of any use for you. <br><br></td></tr></table><br>
<a name="326054"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> using only lockbuffer(), unlockbuffer(), readpixelfast() and writepixelfast()?? <br><br></td></tr></table><br>
<a name="326096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, why not?  You read all the pixels of the screen, then either add or subtract something from the red, green and blue values depending on whether you are fading to white or black and then write them back again. For a 640x480 screen you should be getting about 30fps on a P4 2.4ghz, thats what I can get on mine anyways. <br><br></td></tr></table><br>
<a name="326177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big pete</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Keep on coding another few months Hansie, and maybe you'll even be able to finish that fading routine you promised some day... Didn't you already claim it was finished a few months ago? LOL <br><br></td></tr></table><br>
<a name="326314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want to speed things up, then you can pull the image into an array before you start you fading and then read the data from the array instead of reading the pixels off the buffer. That way you should be able to get about 45fps on a P4 2.4ghz instead of the 30fps, and it only takes one frame to read the image over, so that might be worth it if you are targeting lower end systems as well. <br><br></td></tr></table><br>
<a name="326359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Murilo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's what I did zawran. My fade routine can fade between images or to any colour, and it works in both a window and full screen. I first make a bank containing the RBG values of the source image (which takes no time at all), and they simply cross fade between them. <br><br></td></tr></table><br>
<a name="326366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> @big pete<br><br>don't forget your daily medication! the red pill is important! <br><br></td></tr></table><br>
<a name="326383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Hansie,  I think between what have been mentioned here and the code archieves you should be able to figure something out. And it would be wisely to code it as functions capable of receiving:  bufferhandles, x/y starting points and width/height.  Because this way you are preparing the function to be reusable for just about any situation that you would need to fade something.<br><br>Good luck and happy coding. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
