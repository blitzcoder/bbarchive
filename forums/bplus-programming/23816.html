<!DOCTYPE html><html lang="en" ><head ><title >Problem with SendMessage API call</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Problem with SendMessage API call</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Problem with SendMessage API call</a><br><br>
<a name="246552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AKJ</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can somebody please tell me why the following code fails?<br>If it is relevant, my O.S. is Windows ME.<br><br>    width=400 ; Window client width<br>    height=300 ; Window client height<br>    gap=20 ; Gap between gadgets<br>    hwin=CreateWindow("Testing",100,50,width,height,0,33)<br>    lbox=CreateListBox(gap,gap,width-gap*2,height-gap*2,hwin)<br>    If lbox=0 Then Notify "Didn't create listbox": End<br>    AddGadgetItem lbox,"Line 1"<br>    AddGadgetItem lbox,"Line 2"<br>    items=SendMessage(lbox, $18B, 0, 0) ; LB_GETCOUNT<br>    ; Next line should add "2" to the listbox, but adds "0"<br>    AddGadgetItem lbox,Str$(items)<br>    Repeat<br>	Select WaitEvent() <br>	Case $803: Exit ; Window close<br>	End Select <br>    Forever<br><br>It creates a listbox, populates it with 2 lines of text and then uses the SendMessage() API call to count the number of lines (2) and then display the count as a further line in the listbox.  But 0 is displayed, not 2 as I expect. Why?<br><br>My userlibs folder contains a single .decls file containing the following lines (amongst other lines):<br>.lib "user32"<br>SendMessage%(hwnd%, wMsg%, wParam%, lParam%):"SendMessageA"<br><br>Also, a further question:<br>How do I create a listbox with style LBS_MULTICOLUMN so that I can send it the message LB_SETCOLUMNWIDTH ?<br><br>Anthony Jordan <br><br></td></tr></table><br>
<a name="246590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mmm .. I tried it with QueryObject() and it still fails:<br><br><pre class=code>Const LB_GETCOUNT=$18b

width=400 ; Window client width 
height=300 ; Window client height 
gap=20 ; Gap between gadgets 
hwin=CreateWindow("Testing",100,50,width,height,0,33) 
lbox=CreateListBox(gap,gap,width-gap*2,height-gap*2,hwin) 

For d=1 To 5
	AddGadgetItem lbox,"Line "+d
Next

i=SendMessage(QueryObject(lbox,1),LB_GETCOUNT,0,0)
AddGadgetItem lbox,"Count = "+Str$(i)

WaitEvent
End</pre><br><br>For more listbox information have you looked at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/listboxes/listboxes.asp" target="_blank">MSDN Library - ListBoxes</a> ? <br><br></td></tr></table><br>
<a name="246703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AKJ</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello Syntax,<br><br>(Regarding the question at the very end of my earlier post)<br><br>Following your suggestion I have now looked at MSDN Library - Listboxes.<br>This does not help me.<br>I need to know the styles specifically supported by the BlitzPlus CreateListBox command.  The BlitzPlus documentation does not list any style parameter, but pressing F1 to get the quick help on CreateListBox in the status bar shows that styles ARE supported.  I need to know the style number for LBS_MULTICOLUMN, assuming BlitzPlus accepts this style.<br><br>Anthony <br><br></td></tr></table><br>
<a name="246808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've no idea want the styles do. Normally the online docs are the most up to date reference. No mention on there though.<br><br><a href="/bpdocs/command.php?name=CreateListBox&amp;ref=gui_cat" target="_blank">CreateListBox</a><br><br>As for listboxes with columns, I don't think it B+ supports them yet. See <a href="/bbs/posts.php?topic=23446" target="_blank">this link</a> in the feature requests. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
