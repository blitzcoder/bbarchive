<!DOCTYPE html><html lang="en" ><head ><title >Trouble Redrawing Controls</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Trouble Redrawing Controls</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Trouble Redrawing Controls</a><br><br>
<a name="764274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alaric</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm working on a program that needs to show which control that the user has selected currently.  To do this I draw a red box around the gadget using setbuffer(desktopbuffer()).  However, I have no good way to get rid of the red box once I draw it.  I've been trying to use USER32.DLL userlib commands for quite a while, but for the life of me I can't figure out how to get a control to redraw itself to remove this red box.  My latest attempt has been to add this line to my program <br><br>RedrawWindow(QueryObject(mainwin,1),0,0,1+256+128) ;This means that RDW_ALLCHILDREN(128), RDW_INVALIDATE(1), And RDW_UPDATENOW(256) are set<br><br>I have the userlib installed correctly, (I'm pretty sure at least) but this command causes a crash whenever I run the program.  Can anyone tell me why this command crashes the program?  Here's a link to the msdn command page.  <a href="http://msdn2.microsoft.com/en-us/library/aa921313.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/aa921313.aspx</a> <br><br></td></tr></table><br>
<a name="764971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Petron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could use a canvas and load each gadget as an image. <br><br></td></tr></table><br>
<a name="765075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alaric</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I know that I could.  The problem is that I've already got the program very far by just creating the actual gadgets and it would be much easier just to use a userlib function to redraw the dirty gadgets. <br><br></td></tr></table><br>
<a name="765167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Petron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a stupid question, but what does your signature mean? <br><br></td></tr></table><br>
<a name="765188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alaric</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I asked a girl out a couple of weeks ago, and being the geek that I am, I looked up the DNA sequence for a rose online and sent it to her.  That's the first 100 nitrogen bases (there are four, adenine, thymine, cytosine, and guanine) that make up the DNA of a rose.  I guess I don't make it all that clear in the sig. <br><br></td></tr></table><br>
<a name="765944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >William Drescher</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> When you call the user32.dll command, try calling it like this:<br><br><pre class=code>
RedrawWindow(QueryObject(mainwin,1),0,0,1 Or 256 Or 128)
</pre><br>or<br><br><pre class=code>
Const RDW_ALLCHILDREN = 128
Const RDW_INVALIDATE = 1
Const RDW_UPDATENOW = 256

RedrawWindow(QueryObject(mainwin,1),0,0,RDW_INVALIDATE Or RDW_UPDATENOW Or RDW_ALLCHILDREN)
</pre><br><br>Let me know what happens. <br><br></td></tr></table><br>
<a name="765979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alaric</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, no good.  It still crashes with a "blitzcc.exe has encountered a problem and needs to close.  We are sorry for the inconvenience."  The only thing that I can think up would be to make a dll that calls it, but... I have yet to figure out how to do that. <br><br></td></tr></table><br>
<a name="766201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alaric</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another thing that I've tried was to use sendmessageA and WM_PAINT (As well as WM_NCPAINT and WM_PRINT) to refresh the control, but blitz doesn't seem to respond to these messages at all!  Is there some reason that these messages don't seem to work in blitz?  You'd think that this would be seen as a major glitch in Blitz because if this is missing, then what other messages are? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
