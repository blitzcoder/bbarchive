<!DOCTYPE html><html lang="en" ><head ><title >Help? =] I am freaking out!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Help? =] I am freaking out!</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Help? =] I am freaking out!</a><br><br>
<a name="217249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, largish program, probably uses too much vidmem (but I have 128MB and I definately havn't used that much yet;) - three very large (3000x800+) pictures being blitted to the screen, amongst other smaller, much more normal images.<br><br>Runs fine in B2D, crawls to a halt in B+.  Two of those pictures are loaded from a png - one created using CreateImage().  If either of the two pngs are blitted anywhere on the visible screen area, massive slowdown.  If pngs are blitted offscreen everything runs smoothly.<br><br>This is not true for the CreateImage()'d pic - it doesn't slow anything down whether it's in view or not.<br><br>---<br><br>Forgetting the defualt response of 'don't blit images larger than the screen', can we discuss reasons why this behaviour exists and perhaps also why it doesn't exist in B2D/B3D at all?<br><br>I should probably mention that the behaviour doesn't exist in a small testbed comprising the offending images only (B+ is faster then)...  but it's 2.30am here and instead of creating a bigger, more elaborate, comprehensive testbed, I'm gunna go sleep ;] I don't drink coffee.  =] <br><br></td></tr></table><br>
<a name="217439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bagels</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason this behavior exists is DirectX itself.<br><br>Which leads to an interesting possibility - if you have bought a copy of BlitzPlus, try testing that same stuff using either of the two new graphics drivers (the Native or the OpenGL, as opposed to the original DirectDraw) and see if the problem gets resolved. <br><br></td></tr></table><br>
<a name="217471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Try setting image flags to 'dynamic' (2 I think).<br><br>This should emulate the behaviour of Blitz2D. <br><br></td></tr></table><br>
<a name="217589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> No no, that's what I was hoping for, this behavior has not changed with B+1.34 - flags make no change, differant gfx modes make no change (OpenGL is a little slower, in fact - and Native crashed (Error Reporting dialogue style!) but I can't be certain if this was the cause, I havn't fiddled with it extremely much).<br><br>I was -so- hoping the dynamic flag would 'fix' it...<br><br>The only differance is between B+ and B2D/3D, it is HELL weird, I've decided, probably something dodgy going on in my code somewhere, but I havn't had the time to delve into it very deeply yet.  Soon. <br><br></td></tr></table><br>
<a name="217625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds like dodgy code to me - which would be good news AND bad news for you I guess...;o) <br><br></td></tr></table><br>
<a name="217638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeh, Anthony I figured something like that too - but the problem lay with me thinking it was due to -blitting- these large images (because when ;ming out the 'culprit' DrawImage commands it ran fine)...  not the case.  I've solved the problem, hurrah.  =]<br><br>The culprit?  Fricken ReadPixel.  It -has- got to do with the image loading flags - with flag 1, even though the image isn't being modified, it seems Blitz still needs to grab it back from vidmem to read it (makes sense) - but perhaps also sends it back to vidmem even though nothing has been altered...  My guess is that when SetBuffer is called, the image is grabbed from mem and then put back when DrawImage is called - Mark, maybe you can optimise it a bit by only writing the picture back if a WritePixel operation has been performed?  That's assuming, of course, that what I'm saying isn't so far off...<br><br>I've put it down to AGP bandwidth being clogged.  I'm feeling slightly less crazy-stressed now.  Only slightly.  =]<br><br>EDIT : Oh, a little more insight into my crazy little world, for those that want it, the reason I originally thought the flags didn't fix it (and they didn't until...) - in the same routine that uses these ReadPixel commands on the large pictures, are commands that blit to a 25x25 image, which happens 8 times per frame, all of which later get blitted to the screen.  Wasn't causing any problems when the large images were taken out of the equation, so I thought maybe they were small enuff to not worry about ;] Big mistake.  It was these 8 -in combination- with the ReadPixel commands on the large bitmaps that were causing the slowdown.  Phew!<br><br>EDIT EDIT : At first I thought it was interesting that the third large, CreateImage()'d pic didn't cause the slowdown - of course, it isn't being read or written to (that was planned later on in development - it's basically just a blank huge image sitting in the background for now).  Naturally it gets sent to the vidcard once and isn't affecting the AGP bandwidth after that.<br><br>Anyway, now it's 1.50am again so, night all ;] I can at least sleep a little better tonight =] <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
