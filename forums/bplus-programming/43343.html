<!DOCTYPE html><html lang="en" ><head ><title >Problem when starting Blitz Prog from Start Menu</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Problem when starting Blitz Prog from Start Menu</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Problem when starting Blitz Prog from Start Menu</a><br><br>
<a name="484293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >-=Darkheart=-</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When my program is started from the start menu it sets it's current directory to the location of the start menu or the users home folder, e.g. c:\Documents and Settings\Username. This causes it not to find any media or assets I need it to use.<br><br>There is a simple fix which is to set the "Start in" section of the shortcut however I've not found any way of doing this automatically as part of the install routine. As I don't want to have to screen a message saying, "Dear user please edit your shortcut", I'm not sure what to do.<br><br>Is there any way of setting the current directory for the application to the place where the application is installed (i.e. the location of the program executeable) so that when my program starts in c:\program files\my program\myprog.exe it will look in the directory of the program and NOT in any other location? CurrentDIR$ always returns the location of the $HOME for the user (yes I've tested).<br><br>I think there must be a way of doing this but I can't find it, any help gratefully recieved.<br><br>I know it sounds evil but to me the registry sounds like the answer here...<br><br>Thanks,<br><br>Darkheart <br><br></td></tr></table><br>
<a name="484303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >keyboard</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've never had a problem with starting a program from the start menu, I wonder what is going on? sorry I have no help, just to say that it hasn't happened here... <br><br></td></tr></table><br>
<a name="484307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This should do the trick: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1276" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1276</a> <br><br></td></tr></table><br>
<a name="484313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >keyboard</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @fredborg can you elaborate? this has not happened to me, can you say why it happens? cheers. <br><br></td></tr></table><br>
<a name="484338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> It happens because when you start a program from a shortcut on the PC, the program is informed that it is started from the directory of the shortcut instead of the directory where the executable is located.<br><br>This means that if your game needs to load some files, it will look for them in the directory where the shortcut is located. This is often not what you want, and if you fail to change the game directory to the real one, it is likely to result in a crash. <br><br></td></tr></table><br>
<a name="484629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >-=Darkheart=-</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, Fredborg you are my hero! I searched the codearchs and completely missed that.<br><br>Thanks a lot, just what I needed.<br><br>Darkheart <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
