<!DOCTYPE html><html lang="en" ><head ><title >Will EndGraphics free all images?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Will EndGraphics free all images?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Will EndGraphics free all images?</a><br><br>
<a name="256363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need to free all the images in my game at certain points, and I reckon it would be easier to just clear all the graphics using a single command rather than writing FreeImage for every single image I've loaded. Would EndGraphics work, or is there another command, or some code that would let me select each graphic in turn and free it, eg. in a For-Next loop? I'm using Blitz Basic 2D. Thanks in advance! <br><br></td></tr></table><br>
<a name="256390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, EndGraphics will do it.  It won't free sound effects though.<br><br>The downside is that the resolution change will look very untidy.  You'll get better results if you keep track of what's loaded and free it all manually. <br><br></td></tr></table><br>
<a name="256471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, while this will free all graphics in Blitz Basic (2d) and Blitz3D, it won't work for all images in BlitzPlus.  this is because you can load some images to video mem and some to system mem in Blitz+, and only the video memory ones get cleaned out on a graphics mode change.<br><br>Of course, that may be irrelevant to you dependent on what version of Blitz you're using now - although you might want to keep your code future-proofed in case you do upgrade. <br><br></td></tr></table><br>
<a name="256562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there an alternative? For example, would I be able to select each image in a For-Next loop and delete them from there? <br><br></td></tr></table><br>
<a name="256571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could create a function called MyLoadImage, which as well as loading the image and returning it from the function creates an instance of a type that also references that image.  Then you could loop through all instances of that type and free the images when you need to clear everything out.<br><br>However, as GFK implied, you'd be far better off keeping track of what you have and haven't got loaded, freeing it as soon as you can and doing everything manually.  It sounds like a lot of work, but if you start out doing this, your app will be better for it (in the least it will use the minimum of memory). <br><br></td></tr></table><br>
<a name="256756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >keyboard</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a reason why you don't put all the images to be freed in a function<br><br><pre class=code> 

function FreeSpecificImages()

  freeimage firstimage
  freeimage secondimage

end function

</pre><br><br><br>and call it when necessary? <br><br></td></tr></table><br>
<a name="256849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I could, but I have a lot of images to free, which means a lot of typing by me. I also need to free a lot of images all at once, as all of them are called up before each level, depending on whether I need them for that level or not. I don't want to load and delete them in the middle of the level. <br><br></td></tr></table><br>
<a name="256977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ghoula</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> For those who haven't learned the hard way, remember to free images correctly...<br><br>Call:<br><pre class=code>
gfx_image=Func_SafeFreeImage(gfx_image)
</pre><br>Function:<br><pre class=code>
Function Func_SafeFreeImage(image)

  If image&lt;&gt;0 Then FreeImage image
  Return 0	

End Function
</pre> <br><br></td></tr></table><br>
<a name="257156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean 'learn the hard way'? I obviously haven't encountered the incendent that allows me to learn, but could you enlighten me as to what it is, before I do anything damaging? <br><br></td></tr></table><br>
<a name="257175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Presumably freeing an image that's already been freed. <br><br></td></tr></table><br>
<a name="257226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> What he means is that when you free an image, the image handle is still retained in the variable, so:<pre class=code>image% = LoadImage("myimage.jpg")
Print image%
FreeImage image
Print image%
WaitKey
End</pre>Would show<div class="quote"> 248563942<br>248563942 <br></div>etc... <br><br></td></tr></table><br>
<a name="257395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SSS</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> btw doesnt BB include Garbage Collection??? <br><br></td></tr></table><br>
<a name="257439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right... but is EndGraphics SAFE? I don't want to mess up my sytem/program/graphics/whatever, and I get the feeling that Ghoula was saying that EndGraphics is prone to doing this. <br><br></td></tr></table><br>
<a name="257590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ghoula</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What do you mean 'learn the hard way'? <br></div><br>Exactly what Gfk said. Simply calling freeimage by itself will not free the image handle, you should zero that manually. I learned the hard way because i was not doing this when i first started with blitz. After my program ran for awahile images started becoming corrupt and bizarre looking. So i had to go through a ton of code to correct my error, pain in the arse it was :)<br><br>As for using EndGraphics() i personally have never had a need to use it. But i did do a test: I Loaded up an image into gfx_image then called EndGraphics() then printed gfx_image... the image handle was still being retained.<br><br>Given the above i don't think EndGraphics() will do exactly what you are looking for. You would still need to set all your image handles to zero/null manually to be sure no weirdness happens after the prgram runs awhile. <br><br></td></tr></table><br>
<a name="257610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dangerdave</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Function Func_SafeFreeImage(image)<br><br>  If image&lt;&gt;0 Then FreeImage image<br>  Return 0	<br><br>End Function<br> <br></div><br><br>This would return 0 regardless with the freeimage was successful.<br>Is this right? <br><br></td></tr></table><br>
<a name="257632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Function Func_SafeFreeImage(image) <br><br>If image&lt;&gt;0 Then FreeImage image <br>Return 0 <br><br>End Function <br><br><br><br><br>This would return 0 regardless with the freeimage was successful. <br>Is this right? <br> <br></div><br><br>Yes, it will always return zero because the safefreeimage WILL ALWAYS be successful.  Either the image exists and is freed or the the image doesn't exist(and is thereby already freed). <br><br></td></tr></table><br>
<a name="257717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SSS</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> btw the handle would be retained because it the handle just points to the data, i.e. the handle could still be &lt;&gt;0 but the image could be freed <br><br></td></tr></table><br>
<a name="257727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrpeepers</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does this hold true with FreeEntity(), FreeTexture(), etc. as well? <br><br></td></tr></table><br>
<a name="257752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right. That's okay. I was worried that I might do something wrong. Thanks for the details. <br><br></td></tr></table><br>
<a name="257796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ghoula</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Does this hold true with FreeEntity(), FreeTexture(), etc. as well? <br></div><br><br>Yes it does. <br><br>When you free a handle be it an image or sound it frees the memory that was allocated to it, but the handle is still pointing to that specific area in memory where it was stored.<br><br>To avoid problems, that alone is not good enough. You should manaully 'zero/null' the handle you are trying to free as a safe gaurd, like in the small function above. I personally use basically the same function for a the similiar things like: images/textures/sounds/entities etc... I have like a SafeFreeEeenity(), SafeFreeImage(), SafeFreeSound() and so on. <br><br>This is good programming practice and could save you a heap o' grief down the road, especially if you have a large prog that does a lot of loading and unloading of images/textures and what-nots.<br><br>Cheers! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
