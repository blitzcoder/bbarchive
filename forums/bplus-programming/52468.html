<!DOCTYPE html><html lang="en" ><head ><title >TCP Connection Over Internet</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TCP Connection Over Internet</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >TCP Connection Over Internet</a><br><br>
<a name="585771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>You know when you are transferring large memory banks over a Blitz established TCP connection over the internet [Using WriteBytes() and ReadBytes()], what exactly happens??? Over a LAN it doesn't really matter because the transfer speeds are too fast to notice, but over an internet connection (e.g. broadband 1Mbps Download/256kbps Upload)... If both the computers had the same speed connection what would happen?<br><br>Prediction of chain of events when sending file<br>================================<br>*File is in a memory bank at a "server".<br>*File is sent using WriteBytes() to a pre-established TCP stream.<br>*File is being uploaded @ 256kbps to a memory buffer.<br>*"Client" begins to download file (ReadBytes()) @ 1Mbps and catches up to already uploaded data.<br>*Client download speed is reduced to 256kbps to keep in line with incoming stream.<br>*Once "client" has received last bit of data the program moves onto next command.<br><br>================================<br>End of Prediction<br><br>Or alternatively, does the client wait until all of the data is uploaded before it starts to download it... I'm confused - could someone please clear this up for me as I'm trying to do a progress bar for sending large files across a connection and looping through a file byte by byte takes wayyyyyy too long. ReadBytes()/WriteBytes() is fast enough but I can't find a way to find out how much data has been sent or received until the command has completed. (The program halts until the ReadBytes() or WriteBytes() command has completed).<br><br>Any ideas? - Thanks in advance<br><br>Seb <br><br></td></tr></table><br>
<a name="588887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sub_Zero</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess the data is being stored in chunks directly to memory (the bank) when recieved, probaby packet by packet.<br><br>The tcp protocol discards packets when the transfer rate is too high, and therefore adjusts the speed, but this is handled at a lower level.<br><br><br>For the progressbar, Try something like this:<br><br><pre class=code>lastpos = 0
pbsize = filelen/256
pbinc# = 1/pbsize

  for curpos = 256 to filelen step 256
   WriteBytes bank,tcpstream,lastpos,curpos
    updateprogbar progbar,pbinc#
    lastpos = curpos
  next</pre> <br><br></td></tr></table><br>
<a name="589350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arem</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just send the filesize of the file over before you start actually sending the file.  Then they receiver will know how far along the progress is. <br><br></td></tr></table><br>
<a name="596483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy UK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why TCP was ever included in the basic language structure i will never know. Due to TCP's nature and the fact that Blitz cannot multithread, a slow TCP connection to a Blitz server app will almost deffinately stall/slow it down. Its unavoidable so do yourself and anybody else reading this post a favour and use UDP. Its easier to use and you can emulate a mutithreaded server without the hicups. You will have to implement your own error checking but thats half the fun. I suppose TCP has its uses in Blitz but i cant imagine it being anything serious. Oh and i have managed to fully traverse a nat/router without having to open any ports whatsoever! Works on 98/me/2k/xp/xp64/vista and its really easy. I just read about nat and how it works, then it came to me on the toilet one night. UDP and Blitz combined can produce serious online networked apps! <br><br></td></tr></table><br>
<a name="674373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Real men code in TCP !<br>TCP is good if one know how to code it.<br><br>TCP is verry diferent from UDP.<br><br>I recomend use static size of every TCP message.<br>that way tcp works as good as UDP in blitz.<br><br>Like only tcp command i use today for sending data is.<br>readavail(128)  ;For a 128 byte packet.<br>writebyteS () command.<br><br>Common mistakes !<br>NeverUse:<br> WriteByte()<br> WriteLINE()<br> WriteINT()<br>(the command above is no good for fast gaming.)<br>not using readavail() = Will slow down main.<br><br>Yes UDP is simpler but not safe ! and packets may come out corrupt,disorted etc. <br><br></td></tr></table><br>
<a name="675726"></a>

<a name="1134267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> .<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="675783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DjBigWorm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> RaGR, This is some great insite.  Can you post some simple code for me to look at.  It Sounds like you know what you are talking about, and I would love to learn form a blitz working example.  Thank You <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
