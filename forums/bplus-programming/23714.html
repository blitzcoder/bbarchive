<!DOCTYPE html><html lang="en" ><head ><title >How to compile a screensaver *.scr</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to compile a screensaver *.scr</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >How to compile a screensaver *.scr</a><br><br>
<a name="245470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi, blitzplus guys :-)<br><br>I fancy doing a screen saver. <br>I see that those already installed are scr filetypes. <br>Do you simply rename an exe file to scr or is there something more to do?<br>Also, how do you register it with the OS so it is presented as a choice in Display Properites?<br>And - does the OS kill it directly when something happens or does the saver do the detecting? <br><br></td></tr></table><br>
<a name="245506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> YOu jsut rename the file.  When windows tries to display a preview it will call the exe with some command line parameter.  And when you click the configure button, it will call another thing.  And when you actually run it it calls it with yet another command line parameter.  Search the code archives I'm sure there's some code in there that shows what to do. <br><br></td></tr></table><br>
<a name="245519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, just change exe to scr and put it into <br>    C:\Windows\system32\<br>right?<br><br>I'll try that staight away :-)<br><br>Thanks <br><br></td></tr></table><br>
<a name="245524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> no, into the windows directory. <br><br></td></tr></table><br>
<a name="245537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> My OS is Windows XP Home.<br>I put it in C:\Windows\system32\ <br>because that's where I found the other .scr files. <br>And it wurkt :-)<br>But I'll change it to C:\Windows\ if you think it wise. <br><br>One remaining problem - I don't know how to discover the parameters with which my program is called. <br><br>How do I?<br><br>Thanks in anticipation ... <br><br></td></tr></table><br>
<a name="245624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahem...<br><br>"Search the code archives I'm sure there's some code in there that shows what to do."<br><br>...<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=266" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=266</a><br><br>As for the windows vs windows\system32 dir thing I don't know what to tell you.  It could be different in different versions of windows. <br><br></td></tr></table><br>
<a name="245656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>RuntimeError CommandLine$()</pre>This will pop-up a message with the parameters passed to the screensaver. <br><br></td></tr></table><br>
<a name="245702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like "kalle" forgot "/p" for preview. <br><br></td></tr></table><br>
<a name="245853"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys ...<br><br>RuntimeError CommandLine$() - OK<br><br>Ah, I just found Kalles' screen saver. <br>Thank you, sswift :D<br>I presume that is where Kalle forget "/p" ? <br><br></td></tr></table><br>
<a name="245902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep <br><br></td></tr></table><br>
<a name="245917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is "/p" for Preview, then? <br><br></td></tr></table><br>
<a name="246082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Spot-Nothing</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> i collected some info:<br><br>Windows .SCR screen savers<br>~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>SCR files are nothing more complex than .EXE files with the extension SCR.  Windows calls the .SCR file with two command-line options:<br><br>    /s  to launch the screensaver <br>    /c  to configure the screensaver<br><br>For the windows control panel to recognise the screensaver, the program's module description string must begin with SCRNSAVE: (in uppercase).  So, if writing a Visual Basic screensaver, simply set the application title to something like "SCRNSAVE:Test Screensaver". To create a new screen saver simply write a program that checks the command-line option when starting and performs the appropriate action.  The display should use a full-screen window (usually with a black background) and should end when any key is pressed or when the mouse is moved. When the program is compiled, rename the .EXE to .SCR and put it into the Windows directory so it can be found by the screensaver selection dialog in Windows.<br><br>Edit also parameters setting Web Screen Saver as the default screen saver in [HKEY_CURRENT_USER\Control Panel\Desktop] registry key: ScreenSaveTimeOut Screen Save delay (in seconds). ScreenSaveActive Is screen save mode active? SCRNSAVE.EXE Path of Web Screen Saver (C:\WINDOWS\WEBSS4.SCR). <br><br>Deny access to Display Appearance, Background, Screen saver, and Settings pages: Change the values of NoDispAppearancePage,NoDispBackgroundPage,NoDispScrSavPage, and NoDispSettings Page in the key given above. <br><br></td></tr></table><br>
<a name="246733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi spot_bot  :-)<br><br>Thanks for the info!<br><br>/s to launch the screensaver is a must-have, just so it only executes at the desired moment. <br>I presume that ignoring /c won't do any harm?<br><br>One final question concerning ...<br><div class="quote"> the program's module description string <br>must begin with SCRNSAVE: (in uppercase). <br>So, if writing a Visual Basic screensaver, <br>simply set the application title to something like <br>"SCRNSAVE:Test Screensaver".  <br></div><br><br>How or where does one put "SCRNSAVE:Test Screensaver" in a BlitzPlus program?<br><br>Thank you for your kind attention :-D <br><br></td></tr></table><br>
<a name="246825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Spot-Nothing</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt; How or where does one put<br>&gt; "SCRNSAVE:Test Screensaver"<br>&gt; in a BlitzPlus program?<br><br>i don't think it's necessary to do this. just name your project, rename your exe to scr and that's it :-) <br><br></td></tr></table><br>
<a name="246866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> /s to launch the screensaver <br>/c to configure the screensaver <br>/p to preview screensaver<br><br><br>GG <br><br></td></tr></table><br>
<a name="246953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Spot-Nothing</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> the only question which is still open is how to create a little preview screen or even a little preview animation. i couldn't find any information so far how to do this. anyone else does? <br><br></td></tr></table><br>
<a name="247070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >superqix</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> "/p" also returns the window handle of the little preview window.  I think it looks like this "/p:87390"<br><br>You would probably need to write a UserLib to draw anything on that window. <br><br></td></tr></table><br>
<a name="247112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Spot-Nothing</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> a userlib? i see. is there anyone who'd like to code such a screensaver user lib as a paid job? i really can use such a user lib in some commercial projects so i'm willing to pay for someone who can do this. anyone interested? <br><br></td></tr></table><br>
<a name="247255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> The preview window is entirely optional though.  Yes, you SHOULD have one, but if you don't it's not a huge problem.  I've seen plenty of screensavers that don't do the little preview window at all. <br><br></td></tr></table><br>
<a name="249148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have made a little screensaver for you all to play with.<br>It does not appear in the mini-window but does respond to the "Preview" button.<br>The "Settings" button does nothing.<br>When you have compiled it, rename the .exe to .scr and copy it to the Windows directory.<br>It should then be immediately available to the "Display Properties -&gt; Screen Saver".<br><pre class=code>
;===============
;   Seti-Bot
;  julianbury
;  2003.08.01
;===============

AppTitle "Seti-bot"
ChangeDir SystemProperty$("appdir")
If CommandLine$() = "/S" Or CommandLine$() = "/s" Then goto startup
End

.startup

Global sincos=9999
Global vertices	= 6000
Global distortion = 1800
Global xaxis, yaxis, zaxis
Global posx, posy, posz
Global xres, yres, xh, yh, yb, yc, xi,yi,di, xm,ym,nn,nnn

Dim icos(sincos+1)
Dim isin(sincos+1)
Dim drawx(vertices)
Dim drawy(vertices)
Dim drawd(vertices)
dim vis(vertices)
Dim drawc(vertices)
Dim viewx(vertices)
Dim viewy(vertices)
Dim viewz(vertices)
Dim worldx(vertices)
Dim worldy(vertices)
Dim worldz(vertices)
dim r(64),g(64),b(64)
dim xc(64), tc(64)
dim xk(64), yk(64), tk(64)
dim xb(8), bar(8)

xres = GadgetWidth(Desktop())
yres = GadgetHeight(Desktop())
xh=xres/2
yh=yres/2

Graphics xres,yres
SetBuffer BackBuffer()
SeedRnd Millisecs()

posx	= 0
posy	= 0
posz	= 0
xaxis	= 0
yaxis	= 0
zaxis	= 0
sincos_tables()

Origin xh, yh
For n=0 To vertices-1
	worldx(n)=Rand(0,2550000)-1270000
	worldy(n)=Rand(0,2550000)-1270000
	worldz(n)=Rand(0,2550000)
Next
for n=0 to 7
	xb(n)=xh-(32+n*6)
	bar(8)=rnd(80)
next
yb=yh-32
for n=0 to 63
	r(n)=rand(1,2)*127
	g(n)=rand(1,2)*127
	b(n)=rand(1,2)*127
	xc(n)=n*4-128
	tc(n)=0
	tk(n)=0
	xk(n)=32+(8*(n mod 4))-xh
	yk(n)=yh-(48+(32*(n/16))+(8*(n/4)))
Next
yc=yh-48


While Not KeyDown(1)
	For n=0 To vertices-1
		worldz(n)=worldz(n)-3000
		If 	worldz(n)&lt;1 Then
			worldx(n)=Rand(0,2550000)-1270000
			worldy(n)=Rand(0,2550000)-1270000
			worldz(n)=2550000
		EndIf
	Next
	rotate_about_object
	drawstars
	if MouseX() &lt;&gt; 0 Or MouseY() &lt;&gt; 0 Or GetKey() &lt;&gt; 0 Or GetMouse() &lt;&gt; 0 then end
Wend


Function sincos_tables()
	s#=360.0/(sincos+1)
	a#=0
	For n=0 To sincos
		isin(n) = (Sin(a#)*4096.0)
		icos(n) = (Cos(a#)*4096.0)
		a#=a#+s#
	Next
End Function


Function rotate_about_object()
	di=0
	nn=0
	For n=0 To vertices-1
		vis(n)=0
		xx# = worldx(n)
		yy# = worldy(n)
		zz# = worldz(n)
		y# = (yy# * icos(xaxis)) - (zz# * isin(xaxis))
		z# = (yy# * isin(xaxis)) + (zz# * icos(xaxis))
		yy#=(y#/4096): zz#=(z#/4096)
		x# = (xx# * icos(yaxis)) + (zz# * isin(yaxis))
		z# = (zz# * icos(yaxis)) - (xx# * isin(yaxis))
		xx#=(x#/4096): zz#=(z#/4096)
		x# = (xx# * icos(zaxis)) - (yy# * isin(zaxis))
		y# = (xx# * isin(zaxis)) + (yy# * icos(zaxis))
		xx#=(x#/4096): yy#=(y#/4096)
		viewx(n) = xx# - posx
		viewy(n) = yy# - posy
		viewz(n) = zz# + posz
		If viewz(n)&gt;0 Then
			drawx(n) = (viewx(n)*distortion)/viewz(n)
			drawy(n) = (viewy(n)*distortion)/viewz(n)
			drawd(n) = 1+((1000*distortion)/viewz(n))
			if drawx(n)&gt;-xh and drawx(n)&lt;xh and drawy(n)&gt;-yh and drawy(n)&lt;yh
				vis(n)=1
				if abs(drawx(n))&lt;200 and abs(drawy(n))&lt;200 then di=drawd(n):nn=n
			endif
		EndIf
	Next
	xi=drawx(nn)
	yi=drawy(nn)
	xm=xi+di/2
	ym=yi+di/2
	if nnn&lt;&gt;nn
		for n=0 to 63:tc(n)=0:next
		for n=0 to 7:bar(n)=1:next
		nnn=nn
	endif
End Function


Function drawstars()
	Cls
	Color 255,255,255
	For n=0 To vertices-1
		if vis(n)=1 then Rect drawx(n), drawy(n),drawd(n),drawd(n)
	Next
	Color 0,255,0
	line xm,ym+8,xm-4,ym+32
	line xm,ym+8,xm+4,ym+32
	line xm,ym-8,xm-4,ym-32
	line xm,ym-8,xm+4,ym-32
	line xm+8,ym,xm+32,ym-4
	line xm+8,ym,xm+32,ym+4
	line xm-8,ym,xm-32,ym-4
	line xm-8,ym,xm-32,ym+4
	for n=0 to 63
		rr=rnd(64)
		if rr&lt;n
		  rr=rnd(40)
			if rr=3 then tc(n)=rnd(0,1)
		endif
	Next
	Color 255,0,0
	for n=0 to 63
		if tc(n)=1 then rect xc(n),yc,3,16
	next
	if rnd(12)=7
		n=rnd(0,63)
		r(n)=rnd(0,1)*255
		g(n)=rnd(0,1)*255
		b(n)=rnd(0,1)*255
	endif
	for n=0 to 63
		rr=rnd(32)
		if rr=1 then tk(n)=rnd(0,1)
		if tk(n)=1 then Color r(n),g(n),b(n):rect xk(n),yk(n),6,6
	next
	for n=0 to 7
		bar(n)=bar(n)+rnd(0,16)-8
		if bar(n)&lt;1 then bar(n)=1
		Color r(n),g(n),b(n):rect xb(n),yb-bar(n),4,bar(n)
	next
	Flip
End Function
</pre><br><br>Well there it is :-) <br><br></td></tr></table><br>
<a name="251215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SuperDan</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> What about installing the screensaver?<br>Does anyone know how to edit the registry from Blitz+ to make the screensaver the Windows default?<br>eg. If you had an installer program as a front end. <br><br></td></tr></table><br>
<a name="251316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Spot-Nothing</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah. check for HKEY_CURRENT_USER\Control Panel\Desktop ... there you have some screensaver flags and also a key with the path to the default screensaver. <br><br></td></tr></table><br>
<a name="251366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> This used to work:<br>(Powerbasic code)<br><pre class=code>
Sub SelectAsDefault( longsavername As Asciiz*%Max_Path  )
    Local shortname As Asciiz*%Max_Path '(260 chars)
    Local ret As Long
    shortname=Space$(%Max_Path)
    ret=GetShortPathName (longsavername,shortname,%Max_Path)
    WritePrivateProfileString "boot","SCRNSAVE.EXE",shortname,"system.ini"
    SystemParametersInfo %SPI_SETSCREENSAVEACTIVE,%TRUE,%Null,%TRUE
    ' that sends a WM_WININICHANGE so that DisplayProperties dialog  ' knows we've changed
End Sub
</pre><br><br>It's called with the full path of the screensaver exe <br><br></td></tr></table><br>
<a name="251734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nathan</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Julian,<br><br>great little screensaver you made. I had fun with it. <br><br></td></tr></table><br>
<a name="255781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >julianbury</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, Nathan<br><br>If you made fun changes, post 'em here so I can play with them too :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
