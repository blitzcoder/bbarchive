<!DOCTYPE html><html lang="en" ><head ><title >How to print an image without a DLL/API</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to print an image without a DLL/API</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >How to print an image without a DLL/API</a><br><br>
<a name="198262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blue Steel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kanati (sp?) made an awesome DLL for printing, (really useful for my text stuff).  <br><br>But I have seen a newbie post or two about printing images and some folks may not be aware how to do this without using a DLL or API calls.<br><br>If you just need to print a simple image that will fit on a normal sized piece of paper, you do not need to use a DLL or API calls.<br><br>I am doing a program where the user needs to be able to print the image they have made.<br><br>MS Paint allows command line options.  You can run MS Paint from the command line with the Print switch and it will print the image directly to the default printer without opening MS Paint. <br><br>You need to grab the directory for MS Paint (system/system32, etc) and grab the directory that the image you want to print is in and the file name, then add the "/p" switch.<br><br>For example:<br><br><pre class=code>
ExecFile ("c:\windows\system32\mspaint.exe c:\tik.bmp /p")
</pre><br><br>(I have tested this on 95,98/98se/NT/XP and it works fine) <br><br>I figured this may be helpful to a few folks. <br><br></td></tr></table><br>
<a name="198332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good tip Brice.  I wasn't aware of this.  :)<br><br>Kanati <br><br></td></tr></table><br>
<a name="198357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice idea.  Only problem is that I don't have MSPAINT installed. <br><br></td></tr></table><br>
<a name="198430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blue Steel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;Only problem is that I don't have MSPAINT installed.&lt;<br><br>probably good to error trap and make sure MS Paint is installed, in case you do encounter that one in a million who have uninstalled it. <br><br></td></tr></table><br>
<a name="198556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> (I have tested this on 95,98/98se/NT/XP and it works fine) <br></div>No it doesn't. The path is winnt on NT/XP machines. :o&gt; <br><br></td></tr></table><br>
<a name="198575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blue Steel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> No it doesn't. The path is winnt on NT/XP machines. <br></div><br><br>I grabbed the appropiate path for each OS. :c)  BTW, My store bought XP disc always default installs to c:\windows <br><br></td></tr></table><br>
<a name="199366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does ExecFile "MSPaint.exe" work?<br>It launches on my system without any path info.<br>Also, what about these:<br><br><pre class=code>
ExecFile "calc.exe"
ExecFile "notepad.exe"
ExecFile "appwiz.cpl" ; Add/Remove programs
ExecFile "C:\Windows\" ; open the folder
</pre><br><br>I use these on a QuickLaunch application written in Blitz+<br>It's handy for running common programs/tasks and opening regular folders. <br><br></td></tr></table><br>
<a name="199428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Syntax - once I put your code through a spell-checker (:D) they all worked apart from the "appwiz.cpl" one.<br><br>(Not forgetting MSPaint didn't work cos it's not installed here.) <br><br></td></tr></table><br>
<a name="199494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> once I put your code through a spell-checker (:D) <br></div>Wot spilling misttackes? ;-)<br><br><div class="quote"> they all worked apart from the "appwiz.cpl" one. <br></div>Try these:<br><pre class=code>
ExecFile Chr$(34)+"appwiz.cpl"+Chr$(34)        ; add/remove programs
ExecFile Chr$(34)+"timedate.cpl"+Chr$(34)      ; time/date
ExecFile Chr$(34)+"sysdm.cpl"+Chr$(34)         ; system properties
ExecFile Chr$(34)+"main.cpl"+Chr$(34)+" @1"    ; keyboard
ExecFile Chr$(34)+"joy.cpl"+Chr$(34)           ; joystick
</pre><br><br><br>Oh, and use ExecFile as a function to determine whether the application launched ok ...<br>Returns TRUE (1) if launched else 0<br><pre class=code>If ExecFile("MSPaint.exe") Print "launched!!!"</pre> <br><br></td></tr></table><br>
<a name="199711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blue Steel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does ExecFile "MSPaint.exe" work? <br>It launches on my system without any path info. <br></div><br><br>It "should" always work, but to be safe, I always grab the system path anyway.  An ounce of prevention is worth a pound of cure.<br><br>I have been using this method for printing images for many years and have yet to run into any problems. <br><br></td></tr></table><br>
<a name="216221"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could do some error trapping like this:<br><br><pre class=code>
If FileExists("c:\windows\system32\mspaint.exe c:\tik.bmp /p") Then
   ExecFile ("c:\windows\system32\mspaint.exe c:\tik.bmp /p")
   Else
   Print "Error! Need MS-Paint to print, which appears not to be installed on your system"
   End If
</pre> <br><br>That's the kind of error trapping I would use... :) <br><br></td></tr></table><br>
<a name="216440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blue Steel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> That's the kind of error trapping I would use... :) <br></div>You are assuming that windows will be on the "C" drive.  Much better to take the extra step and be safe and grab the system directory than hardcode a directory,<br><br>For example, on my DEV system, Windows is on the "K" drive. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
