<!DOCTYPE html><html lang="en" ><head ><title >I have asked this, already,  but not at this forum...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >I have asked this, already,  but not at this forum...</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >I have asked this, already,  but not at this forum...</a><br><br>
<a name="276749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DBuzzFan</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for the multiple posts (you´ll find this at the "advanced 3d" forums, too).<br>But Ross C just pointed that this could be the right place to ask this.<br>If I don´t get an asnwer here, I will not post it again --- promisse :^)<br><br>Quick question: <br><br>Can I rely on normals for backface-culling, on a software-only 3d rendering system? <br>I ask that because I wrote a small piece of B+ code, and it is not working properly. <br>Actualy, it DOES, when I rotate around the y and/or z axis. <br>But,when I rotate around the x axis, the normals don´t seem to rotate right. <br>Yeah, I already know that Euler angles are evil --- and am aware of gimbal lock, but that doesn´t seem to be the case here, ´cause when I rotate around the y AND z axis, simultaneously, the backface culling works fine. <br>But, when I rotate around the X axis (alone), it doesn´t work, no matter what. <br>Maybe I am mssing something, and one should not use the normals for backface culling, because that might be the wrong way to do it. <br>But it just makes perfect sense to me. <br>Can you help me out? <br>Thanks, <br><br>BTW: Here´s the code, just in case you or someone else would like to help me... <br>(Remember: it is Blitz Plus, NOT Blitz 3D --- this is a study code, and is not meant to be used to create any fancy 3d engine hehe... I am just trying to get into the maths of 3d, before starting using the 3d stuff that is available on B3d; You know... do just what you did... learn how it works before using it) <br><br><br>Dim x#(16, 9) <br>Dim y#(16, 9) <br>Dim z#(16, 9) <br>; <br>Dim rx#(16, 9) <br>Dim ry#(16, 9) <br>Dim rz#(16, 9) <br>; <br>Dim nx#(16, 9) <br>Dim ny#(16, 9) <br>Dim nz#(16, 9) <br>; <br>Dim rnx#(16, 9) <br>Dim rny#(16, 9) <br>Dim rnz#(16, 9) <br>; <br>Global a# = 0.00 <br>Global b# = 0.00 <br>Global g# = 0.00 <br><br><br><br>Graphics 1024, 768, 16, 0 <br><br><br><br>For i% = 0 To 15 <br>For j% = 0 To 8 <br>r# = Sin#(22.50 * j%) <br>x#(i%, j%) = Cos#(22.50 * i%) * r# <br>y#(i%, j%) = Cos#(22.50 * j%) <br>z#(i%, j%) = -Sin#(22.50 * i%) * r# <br>Next <br>Next <br><br><br><br>For i% = 0 To 15 <br>For j% = 0 To 8 <br>x0# = +x#(i%, j%) <br>y0# = -y#(i%, j%) <br>z0# = +z#(i%, j%) <br>x1# = +x#((i% + 1) Mod 16, j%) <br>y1# = -y#((i% + 1) Mod 16, j%) <br>z1# = +z#((i% + 1) Mod 16, j%) <br>x2# = +x#((i% + 1) Mod 16, (j% + 1) Mod 9) <br>y2# = -y#((i% + 1) Mod 16, (j% + 1) Mod 9) <br>z2# = +z#((i% + 1) Mod 16, (j% + 1) Mod 9) <br>x3# = +x#(i%, (j% + 1) Mod 9) <br>y3# = -y#(i%, (j% + 1) Mod 9) <br>z3# = +z#(i%, (j% + 1) Mod 9) <br>If Abs(x2# - x3#) &lt; 0.001 Then <br>dx1# = x2# - x0# <br>dy1# = y2# - y0# <br>dz1# = z2# - z0# <br>dx2# = x2# - x1# <br>dy2# = y2# - y1# <br>dz2# = z2# - z1# <br>Else <br>dx1# = x3# - x1# <br>dy1# = y3# - y1# <br>dz1# = z3# - z1# <br>dx2# = x3# - x2# <br>dy2# = y3# - y2# <br>dz2# = z3# - z2# <br>EndIf <br>nx#(i%, j%) = (dy1# * dz2#) - (dz1# * dy2#) <br>ny#(i%, j%) = (dz1# * dx2#) - (dx1# * dz2#) <br>nz#(i%, j%) = (dx1# * dy2#) - (dy1# * dx2#) <br>l# = Sqr#((nx#(i%, j%) * nx#(i%, j%)) + (ny#(i%, j%) * ny#(i%, j%)) + (nz#(i%, j%) * nz#(i%, j%))) <br>nx#(i%, j%) = nx#(i%, j%) / l# <br>ny#(i%, j%) = ny#(i%, j%) / l# <br>nz#(i%, j%) = nz#(i%, j%) / l# <br>Next <br>Next <br><br><br><br>Repeat <br>Cls() <br>rotateVertices(a#, b#, g#) <br>rotateNormals(a#, b#, g#) <br>drawSphere() <br>Flip() <br>If KeyDown(30) Then <br>a# = a# + 1.00 <br>While a# &gt; 360.00 <br>a# = a# - 360.00 <br>Wend <br>EndIf <br>If KeyDown(44) Then <br>a# = a# - 1.00 <br>While a# &lt; 0.00 <br>a# = a# + 360.00 <br>Wend <br>EndIf <br>If KeyDown(31) Then <br>b# = b# + 1.00 <br>While b# &gt; 360.00 <br>b# = b# - 360.00 <br>Wend <br>EndIf <br>If KeyDown(45) Then <br>b# = b# - 1.00 <br>While b# &lt; 0.00 <br>b# = b# + 360.00 <br>Wend <br>EndIf <br>If KeyDown(32) Then <br>g# = g# + 1.00 <br>While g# &gt; 360.00 <br>g# = g# - 360.00 <br>Wend <br>EndIf <br>If KeyDown(46) Then <br>g# = g# - 1.00 <br>While g# &lt; 0.00 <br>g# = g# + 360.00 <br>Wend <br>EndIf <br>Until KeyHit(1) <br>End <br><br><br><br>Function rotateVertices(alpha#, betha#, gamma#) <br>For i% = 0 To 15 <br>For j% = 0 To 8 <br>xl0# = x#(i%, j%) <br>yl0# = y#(i%, j%) <br>zl0# = z#(i%, j%) <br>xl1# = (Sin#(betha#) * zl0#) + (Cos#(betha#) * xl0#) <br>yl1# = yl0# <br>zl1# = (Cos#(betha#) * zl0#) - (Sin#(betha#) * xl0#) <br>xl2# = xl1# <br>yl2# = yl1# * Cos#(alpha#) - zl1# * Sin#(alpha#) <br>zl2# = yl1# * Sin#(alpha#) + zl1# * Cos#(alpha#) <br>rx#(i%, j%) = yl2# * Sin#(gamma#) + xl2# * Cos#(gamma#) <br>ry#(i%, j%) = yl2# * Cos#(gamma#) - xl2# * Sin#(gamma#) <br>rz#(i%, j%) = zl2# <br>Next <br>Next <br>End Function <br><br><br><br>Function rotateNormals(alpha#, betha#, gamma#) <br>For i% = 0 To 15 <br>For j% = 0 To 8 <br>xl0# = nx#(i%, j%) <br>yl0# = ny#(i%, j%) <br>zl0# = nz#(i%, j%) <br>xl1# = zl0# * Sin#(betha#) + xl0# * Cos#(betha#) <br>yl1# = yl0# <br>zl1# = zl0# * Cos#(betha#) - xl0# * Sin#(betha#) <br>xl2# = xl1# <br>yl2# = yl1# * Cos#(alpha#) - zl1# * Sin#(alpha#) <br>zl2# = yl1# * Sin#(alpha#) + zl1# * Cos#(alpha#) <br>rnx#(i%, j%) = yl2# * Sin#(gamma#) + xl2# * Cos#(gamma#) <br>rny#(i%, j%) = yl2# * Cos#(gamma#) - xl2# * Sin#(gamma#) <br>rnz#(i%, j%) = zl2# <br>Color 255, 255, 255 <br>Text 100 + 100 * j%, 100 + 20 * i%, rnz#(i%, j%) <br>Next <br>Next <br>End Function <br><br><br><br>Function drawSphere() <br>For i% = 0 To 15 <br>For j% = 0 To 7 <br>x0# = +rx#(i%, j%) * 100.00 + 512.00 <br>y0# = -ry#(i%, j%) * 100.00 + 384.00 <br>x1# = +rx#((i% + 1) Mod 16, j%) * 100.00 + 512.00 <br>y1# = -ry#((i% + 1) Mod 16, j%) * 100.00 + 384.00 <br>x2# = +rx#((i% + 1) Mod 16, (j% + 1) Mod 9) * 100.00 + 512.00 <br>y2# = -ry#((i% + 1) Mod 16, (j% + 1) Mod 9) * 100.00 + 384.00 <br>x3# = +rx#(i%, (j% + 1) Mod 9) * 100.00 + 512.00 <br>y3# = -ry#(i%, (j% + 1) Mod 9) * 100.00 + 384.00 <br>; If Abs(x2# - x3#) &lt; 0.01 Then <br>; dx1# = x2# - x0# <br>; dy1# = y2# - y0# <br>; dx2# = x2# - x1# <br>; dy2# = y2# - y1# <br>; Else <br>; dx1# = x3# - x1# <br>; dy1# = y3# - y1# <br>; dx2# = x3# - x2# <br>; dy2# = y3# - y2# <br>; EndIf <br>; bf# = (dx1# * (dy2# - dy1#)) - ((dx2# - dx1#) * dy1#) <br><br><br>bf# = rnz#(i%, j%) <br><br>If bf# &gt; 0.00 Then <br>If (j And 1) Then <br>Color 255, 0, 0 <br>Else <br>Color 0, 255, 0 <br>EndIf <br>Line x0#, y0#, x1#, y1# <br>Line x1#, y1#, x2#, y2# <br>Line x2#, y2#, x3#, y3# <br>Line x3#, y3#, x0#, y0# <br>EndIf <br>Next <br>Next <br>End Function <br><br></td></tr></table><br>
<a name="276867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure where you got your rotation algorithm from but to transform a point around 3 axis of rotation is a little more complicated than 12 mulitplies.<br><br>To set up a 3x3 matrix to represent a rotational transformation matrix you need something like this (a,b,c are your alpha, beta, gamma). The following has been optimized with temps holding common subexpressions, on paper you need to work out a 3x3 matix that represents just rotx then roty then rotz then multiply all 3 matrix together (yes order is important). <br><br><pre class=code>
	t1 = cos(b)
	t2 = cos(a)
	t4 = sin(c)
	t5 = sin(b)
	t6 = (t4*t5)
	t8 = cos(c)
	t9 = sin(a)
	t12 =(t8*t5)
	
	m[0][0] = (t1*t2)
	m[0][1] = (-t6*t2-t8*t9)
	m[0][2] = (-t12*t2+t4*t9)
	m[1][0] = (t1*t9)
	m[1][1] = (-t6*t9+t8*t2)
	m[1][2] = (-t12*t9-t4*t2)
	m[2][0] = t5
	m[2][1] = (t4*t1)
	m[2][2] = (t8*t1)
</pre><br><br>then you need to multiply each point through the matrix to acheive the transformation:<br><br><pre class=code>
	tx=x*m[0][0]+y*m[0][1]+z*m[0][2]
	ty=x*m[1][0]+y*m[1][1]+z*m[1][2]
	tz=x*m[2][0]+y*m[2][1]+z*m[2][2]
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
