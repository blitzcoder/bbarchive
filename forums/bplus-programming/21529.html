<!DOCTYPE html><html lang="en" ><head ><title >Is the mouse on a line?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is the mouse on a line?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Is the mouse on a line?</a><br><br>
<a name="220551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nazca</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been toying around with my own code to find this out, but it's not accurate, plus it only works half the time!<br><br>So could someone find/make me up a code that returns true if the mouse is being passed over a line (given x1,x2,y1,y2)<br><br>thanks! <br><br></td></tr></table><br>
<a name="220563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you can do the following:<br><br>If mousex() &lt;= x2 and mousex() =&gt; x1 and mousey() &lt;= y2 and mousey() =&gt; y1 then<br><br>I'm not home, so I can't test it, but I think it works.<br><br>Let me know, otherwise I'll find out when I get home. <br><br></td></tr></table><br>
<a name="220568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, that would be, "is mouse inside this box?".<br><br>I'm pretty sure that there is code to find a point on a line in the code archives, have you checked there first? <br><br></td></tr></table><br>
<a name="220601"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Finding a point on a line is not the answer.   He doesn't want to know if the mouse is ON the line, he wants to know if it's passed over it.<br><br>To do that, first, calcualte the normal of the line:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=450" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=450</a><br><br>Then, using Nx and Ny for A and B do this:<br><br>For an arbitary point (px,py), the distance to the line is:<br><br>distance = A*px + B*py + D<br><br>Astute readers will notice that this is a hacked up version of the plane equation, which is how I derived all this stuff, by pretending the line was the intersection of a 3D plane intersecting 2D space and canceling out all the Z stuff with 0's.<br><br><br>Anyhow, now that you know the distance, know that the distance here is either positive, or negative.  Which it is depends on which side of the line you specified you are on.<br><br>You can then use this to dtermine that the mouse cursor moved from one side of a line to the other during a frame, and thus that the mouse crossed the line.<br><br><br>Also, this is probably not important for you, but I forget which way the line normal will point.  I forget whether the normal, and thus the positive side of the line, points to the left or right if you are at point 1 on the line looking at point 2.  I think it's to the left.  If someone wants to figure that out and tell me then I'll update the code archives to reflect that. <br><br></td></tr></table><br>
<a name="220603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Completly untested BTW:<br><br> if (MouseX()-X2)/(mouseY()-Y2)=(y2-y1)/(x2-x1) and (mousex()&lt;=x1 and mousex()=&gt;x2) or (mousex()=&gt;x1 and mousex()&lt;=x2) and (mousey()&lt;=y1 and mousey()=&gt;y2) or (mousey()=&gt;x1 and mousey()&lt;=x2) then<br>;do whatever<br>endif<br><br>This is supposed to test if the slope of the line and the slope relative to a point from the mouse is the same. Then it does a box check to confirm that it is between the points. you do however, run into problems with vertical lines. in this case, do a special-case check. <br><br></td></tr></table><br>
<a name="220628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr Derek Doctors</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have an intersecting line algorythm if you like. As long as you store the old co-ordinates of the mouse each frame then it'd be a piece of cake to check whether the line described by the mouse between this frame and the last intersected with another line... Want it? <br><br></td></tr></table><br>
<a name="220629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr Derek Doctors</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nothing to see here! Move along! <br><br></td></tr></table><br>
<a name="220691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a duplicate post checking function if you'd like it.  It checks to see if all the characters in one post are the same as another! <br><br></td></tr></table><br>
<a name="220697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr Derek Doctors</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm gonna' blame this one on the website I think... :) <br><br></td></tr></table><br>
<a name="220733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is why I use Mozilla.  It does not automatically refresh, it ASKS you when you refresh, if you submitted post data, if you want to resubmit it. :-) <br><br></td></tr></table><br>
<a name="220746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know  that my code checks to see if the mouse is inside a box, but if x1 and x2 is the same or y1 and y2 is the same, then it actually checks to see if the mouse is on the line. But it only works for vertical and horizontal lines not diagonals. Ah well. <br><br></td></tr></table><br>
<a name="220887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Haven't tested this extensively, but works for this demo at least... ;)<br><br><pre class=code>
; -------------------------------------------------------
; Graphics Gems is your friend!
; -------------------------------------------------------
; <a href="http://www.graphicsgems.org/" target="_blank">http://www.graphicsgems.org/</a>
; -------------------------------------------------------

; -------------------------------------------------------
; PointOnLine () - returns True if point is on the line.
; -------------------------------------------------------
; x and y are the co-ords of the point to check; px, py,
; qx, qy define the line...
; -------------------------------------------------------

Function PointOnLine (x, y, px, py, qx, qy)
	If ((px = qx) And (py = qy))
		If ((x = px) And (y = py))
			Return 2
		Else
			Return 0
		EndIf
	EndIf
    If (Abs ((qy - py) * (x - px) - (y - py) * (qx - px)) =&gt; (Max (Abs (qx - px), Abs (qy - py)))) Then Return 0
	If (x &lt; px) Or (x &gt; qx) Or (y &lt; py) Or (y &gt; qy) Then Return 0
    Return True
End Function

; -------------------------------------------------------
; Used by above function...
; -------------------------------------------------------

Function Max (a, b)
	If a &gt; b Then Return a Else Return b
End Function

; -------------------------------------------------------
; D E M O . . .
; -------------------------------------------------------

Graphics 640, 480, 0, 2
SetBuffer BackBuffer ()

Repeat

	Cls
	
	Line 100, 100, 400, 300
	
	If PointOnLine (MouseX (), MouseY (), 100, 100, 400, 300)
		Text 20, 20, "On the line!"
	EndIf
	
	Flip
	
Until KeyHit (1)

End
</pre> <br><br></td></tr></table><br>
<a name="220898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> It would be very bad to use that in a user interface.  Do you know how hard it would be to hold your mouse over a single pixel? :-)<br><br>If what he wants to know is if the mouse is close to the line, then he should use that function I linked to above, and instead of simpyl determining if the distance is greater than or less than 0, use the distance and see if it is below a certain amount.  <br><br>Ie:<br><br>If abs(distance) &lt; 10 then mouse is less than 10 pixels away from the line. <br><br></td></tr></table><br>
<a name="221063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nazca</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks everyone! I have it working fine now :) <br><br></td></tr></table><br>
<a name="221246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need some code to find out if a line intersects an image. What's the fastest way of doing this? I'd rather not plot along the points of the line and do ImageRectCollide checks for each point on the line. If there's a quicker way of checkign, I would be most grateful. <br><br></td></tr></table><br>
<a name="226734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MuffinRemnant</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> cyberseth:<br><br>this is the same math as a clipping routine i.e. you're effectively clipping the line to a rectangle but instead of drawing that line you just need a function to return 'True' if any part of it *would* be drawn. There are lots of ways to do it but search on the net for the Sutherland-(SomeonewhosnameIcantremember) algorithm (try Google-&gt;Sutherland-&gt;clipping) for a speedy way. <br><br></td></tr></table><br>
<a name="226860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I read the original problem, the question is how to detect if the mouse has passed over a line, not just<br>intersected it.  After all, if you are interested in whether<br>it intersected it, you want to know if it rests on just one pixel of that line.  That is a very fine determination to make, and difficult to achieve manually.  Crossing over the line is a more general case.<br><br>It's obvious then that you have to track where the mouse was, then determine where it is now.  draw a line between the cordinates involved.  It constructed line intersects the line you are concerned with, then it did indeed cross the line.  Visually, the problem might look like an X, but turned to the angles indicated by the four points.<br><br>Since each line can be expressed as an equation, if you set one equation to equal the other, the solution should be the point of intersection.  If you can't find a real solution that lies between the values for the X's and Y's of each line, then the two lines do not intersect between those points.<br><br>An interesting point is that since X and Y are bound by a linear relationship (these are presumably straight lines),<br>you only have to check to see if the interecet point is between the X's at the end points, or the Y's at the end points, as it is not necessary to check for both the X's and Y's at the end points.  <br><br>Another way of possibly looking at the problem is to take the old mouse x-y coordinate and construct a triangle with the end points of the line in question.  Then after the mouse moves, take the new mouse x-y coordinate and construct another triangle with the end points of the line in question.  If the triangle deflects in the opposite direction, then the line has been crossed.  I dn't think that this offers any improvements, but it was another approach that I considered.  I also thought about "boxing" the four points.  That is, If I could draw a line from the old mouse x-y to one end of the line, then from that end point to the new mouse x-y position, back to the other end of the line, then close the box by returning to the old mouse x-y point again, what would I prove?  Well, for one thing, and none of the interior angles is greater than 180 degrees (sum total is 360 degrees), then the box was formed with the old and new mouse points on either side of the line or on the line, meaning it had been crossed or intersected by the mouse.<br><br>The intersect of an image is probably easier, since you consider the image to be a rectangle, and here you just want to see if the mouse point lies within the rectangular coordinates.  Most images are vertically or horizontally aligned, meaning no special tricks with line slopes or diagonals. <br><br></td></tr></table><br>
<a name="226888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did someone not pay attention in their linear algebra course? :)  You could easily solve this as a system of equations with a vertical or horizontal line at the point the mouse is.  Then you simply have to compare the solution to the system to the position of the mouse x/y.... so I suppose you would have to find solutions for the X and Y of the mouse, but still not hard.   I'll write a funciton if someone else hasnt already ( I didnt read the whole thread ) someone give me a heads up :). <br><br></td></tr></table><br>
<a name="232881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I will give two approaches:  First a line (x1,y1mx2,y2), and two points:  (x3,y3) (the old mouse position), and (x4,y4) (the new mouse position).  For the mouse to have just crossed the line, the two points must be on opposite sides of the line (x1,y1,x2,y2).  The easiest way to check<br>this is to consider that an invisible "line: joins the<br>old and new mouse points, which would then have the<br>co-points of (x3,y3,x4,y4).  If the mouse trail or line<br>crosses the actual line, the two lines are said to intersect at one point, which we could consider (x5,y5).<br><br>By first deriving the equations for the two lines, then<br>solving for a common solution (solution of simultaneous equations), we would either find a real solution, meaning that they cross or would cross if extended infinately, or we would not get any solution, meaning the lines must be parallel.<br><br>To find the equation for the first line, you would use the<br>formula (x2-x1)*(y-y1)=(y2-y1)**x-x1).  Note that in this<br>form there is no risk of a divide-by-zero error, which makes it preferable to the Y=mX+C slope form.  You don't know what Y and X are yet, so when you solve the equation,<br>replace the Y with "Y", and the X with "X", and just put<br>in the known values for x1,y1,x2,and y2.  As you resolve the<br>equation, you will end up with some_value * "X" - some_value * "Y" + some_value (for "C").  You still don't know what "X" and "Y" are in terms of a value, but the above represents an equation for the first line.<br><br>Then you do the same for the second line or "trail":<br>(x4-x3)&amp;(y-y3)=(y4-y3)*(x-x3).  Perform the reduction in the same manner, and again you will end up with Some_value * "X" - some_value * "Y" + some_value (again, the y offset).<br><br>Now you have two equations, which can be solved simultaneously to determine if there is a value for X and a value for Y that would satisfy both.  Although you can use<br>substitution and elimination methods to end up solving for<br>just one unknown (either X or Y), then use that value back in the original equations to find the missing variable (find Y if you have X, or find X if you have Y), the simplest thing to do with a computer is a brute force approach involving fixed rules and no variations.  Such a rule is Cramer's Rule, and if you apply it properly, it will tell you if there is a point where the two lines would intersect.<br><br>But hold on, it would still tell you that even if the two points represent end points of the line, and so you still need to determine if that point exists on both lines, between both sets of X values, or both sets of Y values.  So X would have to be (x1&lt;=X&lt;=x2 OR x1&gt;=X&gt;=x2) AND (x3&lt;=X&lt;=x4 OR x3&gt;=X&gt;=x4), or you can make the same checks<br>using the equivalent points along the Y-axis against Y.<br><br>You can find the complete solution in my program, "X-Y 2D Graph", under the 2D Graphics portion of the forums.  Look in the program in the section where I actually draw the<br>lines, and you will also see where I find the equation for<br>the lines.  All this information is ported in the GP#() array to a function called Cramer that decides if the two lines intersect or not.  If they do, it returns the (x,y) intersection point.  If they do not, then it returns<br>(---,---). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
