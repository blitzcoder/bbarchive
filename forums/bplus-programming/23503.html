<!DOCTYPE html><html lang="en" ><head ><title >What happens during Alt-tab?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >What happens during Alt-tab?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >What happens during Alt-tab?</a><br><br>
<a name="243004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >APE</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does the program still get input and go about its way, but just not draw anything to the screen?  Does it stop in one posistion and wait their until it regains focus?  If its waiting.. is it in a do nothing loop, or is it actually getting 0 cpu time, and truly stalled in one place? <br><br></td></tr></table><br>
<a name="243009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Keeps going as far as i know. <br><br></td></tr></table><br>
<a name="243014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, it keeps going.  Just check your task manager window and look at the CPU cycles your game is taking.  It doesn't decrease if the game doesn't have the focus. <br><br></td></tr></table><br>
<a name="243058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It keeps going, but with BlitzPlus, you get an event that let's you know that you've lost or gained focus (i.e. alt-Tabbed out or in to the game / app).  Which is very handy to auto-pause a 2d game when some hits alt-tab. <br><br></td></tr></table><br>
<a name="243076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just tested my Tank game in Blitz 3D, and the game pauses when I alt-tab out of it from fullscreen, but not from windowed mode.<br><br>Maybe Millisecs() just doesn't increment?  That seems like it would crash some people's code though if they had FPS counters and didn't check for divide by 0.  So it must stop completely. <br><br></td></tr></table><br>
<a name="243082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually I was mistaken.  I'm getting weird behavior.  The game does seem to continue in the background, but not in a normal manner.<br><br>For example, if I fire a bullet, alt tab out of the app for a moment, and then return to it, the bullet's direction is often reversed, as if it bounced off a wall and came straight back at me.  But when bullets bounce off the walls in my game, they don't come straight back at you, they ricochet off at an angle like a pool ball.<br><br>So something funky is going on.<br><br>Maybe the gameplay stops but the timer continues, and this causes weird glitches in my physics code.  Though I don't see how a frame time of over a second would cause a glitch like this.<br><br>I guess it's back to using my own custom alt-tab code.  I just removed it yesterday because I thought Blitz had gotten it's act together on alt-tab.  The game should stop completely when you alt-tab out of it in full screen.  That includes the timer incrementing.<br><br>If (KeyDown(KEY_LEFTALT) Or KeyDown(KEY_RIGHTALT)) And KeyDown(KEY_TAB) Then Stop<br><br>The above code doesn't stop the timer from incrementing, but it does stop everything else.  The timer is internal to windows, and special code would need to handle storing and restoring the value when the game is alt tabbed out of.  Or you would need to skip a frame when you return to the game.  <br><br>Actually perhaps if I just moved the alt tab code to another part of my main loop between the end of the last frame, and the storing of the time the last frame finished rendering at...  Hm.<br><br>Argh.  I just did another test.  It seems like my own custom code won't be called at all if I alt-tab out of the game!  So I can't do this to solve the problem:<br><br><pre class=code>
			If (KeyDown(KEY_LEFTALT) Or KeyDown(KEY_RIGHTALT)) And KeyDown(KEY_TAB) 
			
				; Stop app.
				Stop
			
				; Reset timer.  Do nothing for first frame after returning from alt-tab.
				Current_Time    = MilliSecs()
				Time_Delta      = 0
				Time_Old		= Current_Time
				Time_Delta_Sec# = 0
			 
			EndIf
</pre><br><br><br>The code will never get executed.  Blitz steals the alt-tab input from me.  Ugh.  Well this is stupid.  I would rather Blitz force me to write my own alt-tab code than behave like this.  If it behaves this way EVERY game will break.  At least if Mark did nothing then properly coded games won't break on return from alt-tab.  Is Mark considering alt-tabbing out as more important than the game working when you return to the game? <br><br></td></tr></table><br>
<a name="243104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) ENAY</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ALT+TAB is a truly evil command after running full screen. Who knows what will or is happening to your window once you go back to it.<br><br>I'd recommend:-<br><br>If (KeyDown(KEY_LEFTALT) Or KeyDown(KEY_RIGHTALT)) And KeyDown(KEY_TAB) Then End<br><br>in your main game loop <br><br></td></tr></table><br>
<a name="243436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> By timer, do you mean a Blitz timer, or MilliSecs()?  The latter should NEVER stop, as it is the number of milliseconds your system has been up (or was it from midnight?  One of the two).  The idea of Blitz timers stopping when an alt-tab occurs, while nice, sounds like it could be very difficult to implement.<br><br>In terms of funny behaviour with the bullets, I think that when in fullscreen mode, flips may not wait for a vertical blank (Vwait may not either) as the screen is not being displayed.  That's what I decided problems I had in my game were down to anyway.  Which is why I migrated to BlitzPlus, as an event driven system is the only way you can really hope to deal with this (which doesn't help B3ders of course!) <br><br></td></tr></table><br>
<a name="243490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> "The latter should NEVER stop, as it is the number of milliseconds your system has been up"<br><br>I don't care about the number of milliseconds since my system has been up.  I only care about the number of milliseconds my game has been running for.  As the game should stop when you alt-tab out of it, so too should millisecs().<br><br>However, I can see how some people may desire that the game continue running when alt-tabbed out of.  So that may not be the best solution.<br><br>I suppose a better solution would be for mark to create a special function which is called on return from an alt-tab event.  That would allow us to put specialized code in there to handle the stuff ourselves.  We can then create our own version of millisecs() which stops when our game stops and starts up again when it returns. <br><br></td></tr></table><br>
<a name="243576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You mean, cause an event to occur that your event handling code can detect and use as you see fit?  That's exactly what BlitzPlus does.  If you're writing a 2d only game (which I think it's fair to assume you are by the forum this post is in) in BlitzBASIC, maybe now is the time to upgrade to BlitzPlus.<br><br>Of course, as I said before, that doesn't help for any 3Ders... <br><br></td></tr></table><br>
<a name="243597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why CAN'T Blitz3D be event driven (at least for the ALT-TAB command)??<br><br>I don't see why it can't be done. <br><br></td></tr></table><br>
<a name="244549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason the funny behaviour happens (if your frame-limiting uses Millisecs()) is because Millisecs() is a global constant value, and doesn't pause when your computer does. (I'm getting weird deja vu posting this, and I feel like I did the last time I posted it... anyway...)<br><br>Millisecs() is the total number of millisecs since you last turned your computer on, so it's not going to stop for your program.<br><br>When your program has an event loop, a timer with Millisecs() finds out the difference between the last time it checked the millisecs. By doing this it finds out how many millisecs have passed since the last loop, and converts this into frames according to the FPS speed you specified.<br><br>The thing is, if you've ALT+TABBED out of your game for 10 seconds, and then return, then a game running at 60FPS has 600 frames to catch up with. The frame-limiter calculates this and calls 600 frames in order to catch up. Not only does your game jerk to a halt for a few seconds, but depending on how it's set up, especially with commands like UpdateWorld, some really weird stuff can happen!!<br><br>To combat this, I usually implement a simple thing which goes like this:<br><br><pre class=code>

; Calculate number of frames depending on difference
; between the system timer, and the last time we updated
; our code to catch up with it. ie the number of millisecs passed

milli# = Millisecs()-Timer
frames = milli/(1000/FPS)   ; convert to frames

If Millisecs()-Timer&gt;3000
    ; If more than 3 seconds have passed since the last
    ; time round, then we must have ALT+TABBed, coz
    ; the game should not have run that slowly.

    ; Set timer = Millisecs() to catch up with the system clock
    Timer = Millisecs()

    ; Set number of frames to 1 instead of what it was.
    Frames =1
End If

For k=1 to frames
    ; Update game code
    Timer=Timer+(1000/FPS)
    .
    .
Next
</pre> <br><br></td></tr></table><br>
<a name="244640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> "I don't see why it can't be done."<br><br>I'm sure it can be.  Mark just hasn't either because it would be hard to code, or he doesn't think it's the right thing, or he's too busy and doesn't think it's important enough to most users to bother with yet, or ever. <br><br></td></tr></table><br>
<a name="244718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Certain non-blitz games have a warning in the manual that says "do not use Alt-Tab with this game". Look I found an example in Delta Force 2:<div class="quote"> Delta Force 2 does not support task switching, "Alt-Tabbing".  Alt-Tab should NOT be used to switch to other tasks when running Delta Force 2. <br></div>So I guess when I complete a game and write a manual for it I would include a similar message! :) <br><br></td></tr></table><br>
<a name="244946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I doubt the Blitz3d product will ever get improved alt-tabbing behaviour, purely because it would (more or less) require half of BlitzPlus to be plugged into Blitz3d.<br><br>However, a certain other, oft mentioned product, bearing a similar name to that not so popular soft drink Pepsi Max, will be BlitzPlus with 3d plugged in, and would support it.  So for now, go update yer manuals!  ;-) <br><br></td></tr></table><br>
<a name="245118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't want your game to continue while you've alt-tabbed to the desktop, though, do you? You want it to pause. And the method I posted above lets you do that, right? :O <br><br></td></tr></table><br>
<a name="245279"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Absolutely you want to pause the game when alt-tab occurs.  All I was saying was that with BlitzPlus you'll get instant notification via windows events of when someone alt-tabs in and out of your game.  So rather than guessing that they've alt-tabbed AFTER 3 seconds, and potentially having Blitz go strange on you (which I've heard of happening on some PCs during Alt-Tab), you can handle it 'properly' in BlitzPlus. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
