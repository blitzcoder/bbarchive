<!DOCTYPE html><html lang="en" ><head ><title >ExecFile()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ExecFile()</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >ExecFile()</a><br><br>
<a name="228963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>how do I execute an external program using the above command with a command line parameters??<br><br><pre class=code>
cmd$ = "echo hello"
execfile(cmd$)
</pre> <br>the above runs echo, but doesn't pass the command line params<br><br>I have even tried<br><pre class=code>
cmd$ = chr(34) + "echo hello" + chr(34)
execfile(cmd$)
</pre><br>that above just tries to execute a program called 'echo hello' as one filename<br><br>anyone else having the same problems??<br>or is there something I'm obviously doing wrong..<br>PS all directorys are correct and files present <br><br></td></tr></table><br>
<a name="228988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kevin_</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try using the command processor that runs DOS stuff. In XP it is cmd.exe, dont know what is it in ME/2K.<br><br>Regards <br><br></td></tr></table><br>
<a name="229067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> try<br><br><pre class=code>cmd$ = chr(34) + "echo" + chr(34) + " hello"
execfile(cmd$)</pre><br><br>you could also try echo.exe.. if that doesn't work you're probably sending the command line parameter differently to how echo reads it. <br><br></td></tr></table><br>
<a name="229157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> PantsOn:<br>What OS are you using?  When I do that, nothing happens -- no new window, no echo whatsoever.  (Mine is XP.)<br><br>Prof:<br>In al 9x variants (95, 98, ME, etc) it's command.com.  In all NT variants (4, 2K, XP, etc) it's cmd.exe.<br><br>Fullernator:<br>FYI, echo is a built-in command of the shell -- there is no external executable called echo.exe. <br><br></td></tr></table><br>
<a name="229188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might wish to try CreateProcess - this does the same as ExecFile, but returns a stream that you can interrogate for program output.  I think it may have been documented online now... <br><br></td></tr></table><br>
<a name="229349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Might have to explain a bit better..<br>above was just an example.. I am not actually calling the echo command at all.<br><br>I have written a blitz prog that can have commandline parameters. But when I call it using the ExecFile method it doesn't work.<br><br>Many thanks for your help anyway... I'll try this Creatprocess command<br>cheers <br><br></td></tr></table><br>
<a name="229352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, that didn't work....<br>the docs for Execfile say to put quotes round..<br><a href="http://www.blitzbasic.co.nz/bpdocs/command.php?name=ExecFile&amp;ref=2d_a-z" target="_blank">http://www.blitzbasic.co.nz/bpdocs/command.php?name=ExecFile&amp;ref=2d_a-z</a><br><br>Is anyone else experiencing problems calling programs with parameters????<br><br>PS I'm on W2K, P4 <br><br></td></tr></table><br>
<a name="229554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not experiencing problems calling programs with parameters.  For example, this works fine:<br><pre class=code>
cmd$ = "notepad newfile.txt"
ExecFile(cmd)
</pre><br>...as does:<br><pre class=code>
cmd$ = "cmd /k cd c:\"
ExecFile(cmd)
</pre><br><br>Do you have spaces in your path?  If so, you'll have to use quotes, like this:<br><pre class=code>
cmd$ = Chr$(34)+"c:\program files\blitzplus\program.exe"+Chr$(34)+" param1 param2"
ExecFile(cmd)
</pre><br><br>Finally, are you sure you're handling command line parameters correctly? <br><br></td></tr></table><br>
<a name="232173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> will try again...<br>command line parameters are fine..  as I can runthe program with params from command line fine...<br><br>back to drawing board... <br><br></td></tr></table><br>
<a name="232245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> So... hmm.. are you saying that your program doesn't handle the command line parameters you pass it?<br><br>Make sure you tokenize what CommandLine$() returns, and remember it's case sensitive to compare strings, so use Upper$() or Lower$().<br><br>Or are you saying it's sorted?<br><br>(I'm a little confused with "...are fine..." and "back to the drawing board".)  =) <br><br></td></tr></table><br>
<a name="235029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ExecFile shells out of windows. meaning it leaves the GUI environment, to perform a command line function, which you are passing to it as a string.  The fact is though, that the Win95/98/Me Command.com program does not behave in the same manner as the Cmd.exe file used in the NT version of Windows.  Command recognizes parameters, such as programs to execute (followed by their own parameters), or switches, such as /k, which effect the behavior of Command.  For instance, Command /K is often used to keep the DOS window open so that you have to close it manually.<br><br>Cmd.exe dose not respond to parameters, and otherwise acts like Command /K, as it does not allow the DOS window to close automatically.  <br><br>Because Shell processes actually initiate new instances of the Command or Cmd interpreters, you can expect some differences in the way programs act when you shell to them, or attempt to pass parameters to them.  By playing around with the Start/Run/Command ( or for NT platforms, Start/Run/Com), you will get some idea of what works and how.  For instance, using Start/Run/Cmd Notepad, a DOS windows opens, but notepad is not executed.  On the other hand, enter Start/Run/Notepad Now is the Time, and Notepad not only opens, but it checks to see if it can open a file called Now is the Time.<br><br>As also pointed out, you can generate a batch file (with a .BAT extension) that sets forth commands with their parameters, and then execute that.  As kludgy as this seems, it often provided a method of doing something that<br>would be hard to achieve otherswise.  For instance, if your program was initiated by a Call statement in a batch file, when you exit your program the batch file resumes execution.  You cannot modify this batch file directly, but if it were set up to then call a second batch file after your program exits, you can modify that second batch file to do whatever your program wants it to do once your program terminates.  (You can't modify the first batch file because it is already loaded into memory, and your changes would only effect the copy that is on the hard drive.  But the second batch file has het to be loaded into memory because it has not been called yet).<br><br>The use of batch files can be helpful to initiating programs that have to be loaded and run in sections.  With a lot of memory at your disposal, this may not be an important point.  But let's say you were writing a program that involves multiple levels, then you might want to design it so that only one level needs to be loaded to be worked on or played at a time.  Batch files are easy to modify (since they are essentially plain text files) to retain parameters related to individual users, or game levels, or what have you.  Just because they are primitive does not mean that they aren't useful. <br><br></td></tr></table><br>
<a name="235071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Cmd.exe dose not respond to parameters, and otherwise acts like Command /K, as it does not allow the DOS window to close automatically. <br></div>On the contrary, cmd.exe has more parameters available to it than command.com.  <br><br>Just try "cmd /?".<br><br>To close automatically, the /c parameter works just like it does with command.com.<br><br>I thought you'd like to know -- you seem quite genuine in your dialog and thoughtful replies. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
