<!DOCTYPE html><html lang="en" ><head ><title >Force refresh rate</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Force refresh rate</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Force refresh rate</a><br><br>
<a name="282652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello,<br><br>I remember asking this last year, but there was no solution apart from work-arounds back then so I thought I'd ask again.<br><br>In 2D, I would like to force a refresh rate of 60Hz for example. I am currently working with all sorts of refreshrates and checking the delta time to calculate a multiplier that I scale everything to run at a similar speed. I would however really like to force a refresh rate instead, maybe using a nifty trick in blitz or possibly using a DLL?<br><br>Any suggestions? <br><br></td></tr></table><br>
<a name="282667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Brine</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yo dude!<br><br>Heres how I force a refresh rate!<br><br>;-------------------------------------------------------------<br>; program loop starts here!<br><br>repeat<br><br>tim = createtimer(60)<br><br>;<br>; dump yer code here<br>;<br><br>waittimer(tim)<br>freetimer tim)<br><br>forever<br><br>; end of example code<br>; ----------------------------------------------------------<br><br>This should keep youre game running at a smooth 60fps unless  youre code exceeds the amount of processing time available then the FPS value will get lower (slowdown), no dll's are req!<br><br>Hope this helps you out<br><br>Mr Brine <br><br></td></tr></table><br>
<a name="282688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>This should keep youre game running at a smooth 60fps<br> <br></div><br><br>There's just one thing I would dispute about that and that is the word, "smooth" <br><br></td></tr></table><br>
<a name="282703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Réno</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Mr Brine, the waittimer works strange with monitors refresh rate higher than 60 Hz.<br><br>Actually, the only methode to run a game perfectly with the monitor is to set DirectX to 60Hz. <br><br></td></tr></table><br>
<a name="282777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or set your game timer to run at the current refresh rate. <br><br></td></tr></table><br>
<a name="282795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just go like this:<br><br><pre class=code>
timeseq=1000/60  ; 60 hz

repeat
  time=millisecs()
  ; code here


  While (not keydown(1)) and (millisecs()-timer&lt;timeseq)
  wend
forever
</pre> <br><br></td></tr></table><br>
<a name="282800"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use a multiplier at the moment to compensate for refreshrates, i.e. a multiplier of 0.5 if someone runs the game at 120Hz instead of 60Hz, all calculations of variables will then be multiplied for the compensation.<br><br>The reason why I prefer not to use waittimer is because I am after 100% smoothness in the 2D game, nothing will do it as good as making sure everything runs at a steady phase in according to the refresh rate.<br><br>The only solution I am after apart from the one I am currently using is to definitely tell windows / the graphics card and monitor that "RUN AT 60HZ!" =) I don't think Blitz supports this, but there are utilities out there to set refreshrates for DX, so maybe it is possible to integrate it into Blitz with some sort of a DLL or something?<br><br>Thanks for the replies so far. <br><br></td></tr></table><br>
<a name="282814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you choose a refresh rate that someones monitor doesn't support, then you could physically damage their monitor.  60 Hz is probably OK, but people set their refresh rates higher for a reason, usually to reduce flicker.  If you set it lower, they might not be happy with you. <br><br></td></tr></table><br>
<a name="282886"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> WolRon, I do agree with you to an extent. I don't like 60hz in windows for example, I always use 100+ if possible. I think in the 2D game 60hz should be fine as the benefit is that the game will be guaranteed to run at that refreshrate on all monitors, and the timing and smoothness will be perfect, especially when playing over the LAN so that people won't benefit or lose out because the game behaves slightly different using different refreshrates.<br><br>Currently the game runs fine anywhere between 60hz and 120hz, really smooth, and the speed of the cars are nearly identical (too close to measure any difference), but the handling of the skids and stuff may be slightly different. <br><br></td></tr></table><br>
<a name="282890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats a HUGE NONO!  Never change someones OS refresh rate!!! for the reasons WolRon mentioned plus its really annoying when your monitor goes to crap when you start an application that uses a refresh not supported.<br><br>And.. in North America 60hz hurts... our power is 60hz and you get flicker... in Europe where the power is 50hz you dont get this problem with 60hz as much...<br><br>I think most people that know about it and know how to change it run at 75 or 85hz now too.<br><br>Skully <br><br></td></tr></table><br>
<a name="282915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> =)I didn't know the problem was magnified for American users, but I know there is a slight flicker, mainly in windows environments rather than games. The game only runs in 640x480, 800x600, 1024x768 so I should be alright at locking it at 75hz too. It's graphically demanding (and eats quite a bit of video memory due to the size of circuits etc), so I suppose people that can't cope with 75hz won't be able to play the game anyway =)<br><br>Thanks. <br><br></td></tr></table><br>
<a name="282961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Réno</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Imphenzia, check to dxdiag.exe on your hard-drive : it runs the DirectX dialog box, and you can set the monitor refresh ONLY for DirectX applications. <br><br></td></tr></table><br>
<a name="283447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Simon S</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a pathectic weakness of the Windows system. A lot of drivers have no idea what refresh rate your monitor is capable of.<br><br>However I doubt you could damage any modern monitor by forcing the refresh rate, though old (pre 95) monitor's are quite dodgy.<br><br>I'm afraid you'll have to live with one of the alternatives such as delta time or tweening, though they are pretty crap for 2D. Certainly a lot better than waittimer, but never as good at a steady refresh rate. <br><br></td></tr></table><br>
<a name="283539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd like to say that there's a large misconception about hz.<br>With consoles and older home computers like the amiga, you won't really get any flicker at 50 or 60, however with pcs you really need to avoid setting the hz like the plague.<br><br>You can obtain perfectly smooth 2D timing code regardless of hz.<br><br>Another thing: a lot of new pcs ship with tft flat panel displays (as well as laptops) and forcing 60hz will also have zero effect. Or ruin the entire look.<br><br>So you really *have no choice* but to use clever timing code. Look in code archives for alternatives. <br><br></td></tr></table><br>
<a name="283553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Simon S</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree you have to use timing code, but I don't agree that you can get perfectly smooth 2D using it.<br><br>You can get reasonably smooth 2D but you will see minor glitches enough to spoil that arcade smoothness. Timing code works perfectly for 3D as everything works with floating points and never really moves a whole number of pixels.<br><br>2D does though, so anything moving whole numbers (say the screen scrolling a 2 pixels a frame) will glitch in tweening. Barely noticable, but once you are used to true smoothness you will notice it. <br><br>This must be because the game logic has to be ready at the exact moment the monitor draws. Normally vwait pauses everything till it's ready so it will always draw at exactly the right moment. <br><br>In timing code the game logic is seperate from the drawing (though this is good practice, I agree). Chances are the logic fps is not going to divide perfectly into the number of display frames available, and about 1% of your frames will be slightly off.<br><br>Swedernik's code is about the best I've seen for 2D tweening. The game logic runs at 250fps so it's almost always ready when the frame refresh comes up.<br><br>If you run it on a 120hz display it's pretty much perfect, but of course this has the drawback of causing the GFX card twice as much work, not much use for a graphics intensive game.<br><br>I understand there's nothing can be done about it until drivers improve but I was in the mood for a rant. <br><br></td></tr></table><br>
<a name="283562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I move everything relative to elapsed time (game ticks) in my development...<br><br>This avoids the whole issue of movement irregularities due to monitor refresh.  The only down side is that you have to use float values in order to maintain smoothness even though the drawing of the images is done with integers.  This makes it slightly slower depending on how much you are doing; however, I usually leave Particle effects out of this restriction unless they can effect actual game objects.<br><br>Skully <br><br></td></tr></table><br>
<a name="283620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Brine</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had a quick gander at my code and realised a missed out a couple of things that might help smooth things out at little, (on my system everything runs a steady fps no matter what the refresh rate 50, 75, 60, My windows refresh rate is 75mhz):<br><br>;-------------------------------------------------------------<br>; program loop starts here!<br><br>vwait  ; before you enter the loop<br><br>repeat<br><br>tim = createtimer(60)<br><br>;<br>; dump yer code here<br>;<br>; excluding  vwait<br>;<br><br>flip false<br><br>waittimer(tim)<br>freetimer tim)<br><br>forever<br><br>; end of example code<br>; ----------------------------------------------------------<br><br>Its also been my experince (which aint a great deal) that putting functions relating to drawing on the backbuffer() at the top of the loop and functions the process the data at the bottom of the loop helps to increase performance a little.  But its like say I dont have great deal of experince  so I might be talking crap here :-)<br><br>also note the LACK of vwait, this I would say is important, but see the last line. <br><br>Hope  this helps resolve yer probs<br><br>Mr Brine <br><br></td></tr></table><br>
<a name="283767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use floating points for all my location variables too, and with a multiplier calculated based on the refresh rate I would say that it runs smooth enough.<br><br>You get the occasional glitch, maybe 1% as Simon said, but I can live with it in the type of a game I am making (CTCC). I just don't want someone to be able to patch the game and have control of that multiplier as it would enable cheats in multiplayer mode, but I guess I'll have to spend more time writing cheat-prevention code than locking refresh rates =)<br><br>My next game will be 3D I think, pixel perfect smooth on such a huge range of PC components is too much hassle =)<br><br>Mr Brine - I just tried the code above, and it doesn't achieve the smoothness I'm after, but it does however run at a steady phase =)<br><br>Thanks for discussing this. <br><br></td></tr></table><br>
<a name="284205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Brine</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Imphenzia,<br><br>Ive been upstairs playing with refresh rates:  I did come up with one more idea, which is changing the the createtimer(60) to createtimer(75), this'll force the update rate to 75fps and gives me really quite smooth animations, but the amount of processing time available in one frame drops, quite a bit, also everything speeds up.  I dont if this of help or not.  One thing I did notice is that for the first 10-20 seconds it can be a bit jittery, but this seems to smoothen out, with time, also whats a CTCC??<br><br>Mr Brine <br><br></td></tr></table><br>
<a name="284232"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the idea. I haven't tried it yet, but I can check just in case but I fear it still may not produce the same smoothness as sticking to the refreshrate that the monitor is set to.<br><br>CTCC is a 2D racing game, you can see more info and screenshots etc. here:<br><a href="http://www.imphenzia.com/games/ctcc/" target="_blank">http://www.imphenzia.com/games/ctcc/</a><br><br>Stefan <br><br></td></tr></table><br>
<a name="284233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Simon S</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry Mr Brine, the code you've made is essentially as effective as waittimer. The likely reason it looks better at 75 is that your monitor displays at 75hz.<br><br>Oh and apologies, there was a bit of nonsense in my explanation above. The glitch is not due to the game logic being unable to draw at the right time, it's how much an object moves in a refresh frame.<br><br>Say in a second an object moves 120 pixels. Now at 60 this would move smoothly as it computes as exactly 2 pixels pre refresh (120 pixels/60 frames)=2 pixels a frame.<br><br>But in 85, this doesn't quite work.<br>(120 pixels/85 frames)=1.4117647058823529411764705882353<br><br>And there's not enough precision in a floating point number for that. So it ends up unevenly divided amoungst the frames, in at least one frame, the object will move too far or too little. A dreaded remainder.<br><br>To be honest most gamers would not care about this, I guess I've been spoiled by too many SNES and Arcade games. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
