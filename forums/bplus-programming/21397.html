<!DOCTYPE html><html lang="en" ><head ><title >Anyone know how to do an "iris"?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Anyone know how to do an "iris"?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Anyone know how to do an "iris"?</a><br><br>
<a name="219087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WoeIsMe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> You know in cartoons, where at the end, a black ring closes in on the screen (called an iris if you didn't know), showing a smaller and smaller ring of the screen until the screen is completely black. I want to do one of these for when you die in Alf the Elf II. I already have a rectangular one that looks quite good, but does anyone know how to do a circular one that doesn't slow down the game much? Here's my code for the rectangle, should anyone be interested:<br><br><pre class=code>
;death\dietime=death\dietime+1 is somewhere earlier in the code
Color 0,0,0
Rect 0,0,800,(death\dietime)-100
Rect 0,600-(death\dietime)+100,800,death\dietime
Rect 0,0,(death\dietime*1.25)-100,600
Rect 800+100-(death\dietime*1.25),0,(death\dietime*1.25),600
</pre> <br><br></td></tr></table><br>
<a name="219095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd create an image the same size as the screen in a nice bright colour (255,0,255) - let's call it mask_image. I'd then draw a circle onto mask_image (the iris) in green say.<br><br>Set the mask colour for mask_image to the same green you drew the iris as.<br><br>Grab a copy of the image you want to 'iris out' (the screen) which I will call screen_image. Set screen_image to use the magenta colour for its mask colour then draw the  mask_image onto screen_image. The magenta will obscure the border but the circle should still be visible since it has been made transparent.<br><br>Draw screen_image to the screen and you should get a circle of the image visible. You can then just repeat the steps above (only need to get screen_image once) making the circle smaller each time.<br><br>Does that make sense?<br><br>Haven't got a clue how fast this will be but I suspect it will actually work quite fast and I may just use it myself :) since it will probably be the only thing running you shouldnn't have a problem <br><br></td></tr></table><br>
<a name="219113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a ton of ways you could do this.<br><br>None of them are super easy to do though.  It will take some optimization to make it fast.<br><br>You've basically got two equations you can use to draw a circle, plus the bresenham circle algorithm, but I'm not gonna explain that. :-)<br><br>The first is to use the cartesian to polar coordinates equations:<br><br>X = Radius * Cos(Angle)<br>Y = Radius * Sin(Angle)<br><br>For a circle of a specific radius, you can use that to find all points around the border of the circle.<br><br>Or, you can rearrange the equation to find the two X coordinates for the edges of the circle at a particular Y coordinate.  Which is what you would want to do to "rasterize" a circle so you can draw it with a series of horizontal lines on the screen.  Or as an outline.<br><br><br>Another way to calculate a circle is to use the distance equation:<br><br>RadiusSquared = Radius*Radius<br>DistanceSquared = ((CX-X)*(CX-X) + (CY-Y)*(CY-Y))<br>If (DistanceSquared &lt; RadiusSquared) Then this pixel is inside the circle.<br><br>CX, CY is the location of the center of the screen.<br> <br>You can do that for each pixel of the screen, decreasing the radius each time, and if the radius is greater than a certain value, or between a set of values, you can set the pixel black.<br><br>This might be the easiest method for you to implment.<br><br>If you want to do this, then what you'd do is first find the distance from the center of the screen to the pixel in the corner of the screen.  This is the largest you need to draw your circle.<br><br>You only need the square of the distance, so just go:<br><br>CornerDistanceSquared = ((GraphicsWidth()/2)^2 + (GraphicsHeight/2)^2)<br><br>You'll note this is a ltitle diffrent from the distance equation above.  That's cause I decideed to get the location of the 0,0 corner pixel, which allowed me to simplify the equation.<br><br>Once you have that corner distance, you know the largest you need to draw your circle.  This is the radius at which you start drawing an outline circle.<br><br>So what you do then is you set Radius to this value.  Then for each pixel in the screen, do this:<br><br>InnerRadiusSquared# = (Radius#-0.5)*(Radius#-0.5)<br>OuterRadiusSquared# = (Radius#+0.5)*(Radius#+0.5)<br>DistanceSquared# = ((CX-X)*(CX-X) + (CY-Y)*(CY-Y))<br><br>If (DistanceSquared# &gt; InnerRadiusSquared#) and (DistanceSquared# &lt; OuterRadiusSquared) Then set this pixel to be black.<br><br><br>And then you just keep decreasing the radius one unit at a time.<br><br>What this does is it fills pixels which are between an inner radius and an outer radius.  You need to fill pixels within two radiuses rather than just at the radius because if you just fill at the radius some pixels will be missed.  This will ensure that as you draw circles of decreasing size that the circles will fill all the pixels.  You may even be able to use a value of less than 0.5 for the radius size.  If you can then you will fill fewer pixels extra times and the algorithm will go faster.<br><br>This isn't the fastest way to do it, but it should be fast enough for your needs. <br><br></td></tr></table><br>
<a name="219114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh and I almost forgot, there's a bunch of code on BlitzCoder which does screen transitions.  And some of them are circles, and some are squares and some are checkerboards.  It's really cool and fast, and it's exaclty the sort of thing you need.  All you need to do is specify that the destination image is black. <br><br></td></tr></table><br>
<a name="219120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Instead of drawing pixels I would just draw circles.<br>It's inefficient in the sense that each pixel is drawn many times.<br>But who cares?<br><pre class=code>
Graphics 800, 600

dot = CreateImage(20,20)
SetBuffer ImageBuffer(dot)
Color 0, 0, 255
Oval 0,0, 20,20

r# = Sqr(400*400 + 300*300)
phase# = 1
SetBuffer BackBuffer()

While r &gt; 0
	
	For angle# = 0 To 358 Step 2

		a# = angle + phase
		x# = 400+r*Cos(a)
		y# = 300+r*Sin(a)	

		DrawImage dot,  x-10, y-10

	Next
	Flip	

	phase = 1 - phase
	r = r - 2.5
	
	CopyRect 0,0, 800,600, FrontBuffer(), BackBuffer()

Wend
WaitKey
End
</pre><br>The phase is just a trick for alternately drawing even and odd angles.<br>It makes things look a little smoother. <br><br></td></tr></table><br>
<a name="219298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a link to my code for realtime full-screen transitions like iris, checkerboard, etc...<br><br><a href="http://www.christianaupairs.com/seth/transitions.zip" target="_blank">http://www.christianaupairs.com/seth/transitions.zip</a> <br><br></td></tr></table><br>
<a name="227262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since you are considering creating an "iris" effect, you can create a more mechanical approach by considering the nature of a mechanical iris.  It is not a perfect circle, but rather a apperature that uses overlapping segments to close of more and more of the opening.  Suppose you created a six-sided figure at the extreme limits of the screen.  Each segment would enclose an angle of 120 degrees.  You then rotate the figure by say, five degreesm and make it slightly smaller so that each point touches a line segment on the first.  You do a fill to each triangle produced, then rotate another five degrees, and create another figure inside the second, again just touching at a point on the second figure.  Then a fourth figure rotated another five degrees and reduced to fit at the points inside the third.  You get a spiral effect, and each fill makes the iris smaller and blends it with the previous figures thus created. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
