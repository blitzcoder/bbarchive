<!DOCTYPE html><html lang="en" ><head ><title >InternetCheckConnection()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >InternetCheckConnection()</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >InternetCheckConnection()</a><br><br>
<a name="561547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't get this API function to work.<br><br><div class="quote"> Declare Function InternetCheckConnection Lib "wininet.dll" Alias "InternetCheckConnectionA" (ByVal lpszUrl As String, ByVal dwFlags As Long, ByVal dwReserved As Long) As Long<br><br><br>· lpszUrl<br>[in] Pointer to a string containing the URL to use to check the connection. This value can be set to NULL.<br><br>· dwFlags<br>[in] Unsigned long integer value containing the flag values. FLAG_ICC_FORCE_CONNECTION is the only flag that is currently available. If this flag is set, it forces a connection. A sockets connection is attempted in the following order. <br>If lpszUrl is non-NULL, the host value is extracted from it and used to ping that specific host.<br>If lpszUrl is NULL and there is an entry in WinInet's internal server database for the nearest server, the host value is extracted from the entry and used to ping that server.<br><br>· dwReserved<br>[in] Reserved. Must be set to zero.<br><br><br>Returns TRUE if a connection is made successfully, or FALSE otherwise. Use GetLastError to retrieve the error code. ERROR_NOT_CONNECTED is returned by GetLastError if a connection cannot be made or if the sockets database is unconditionally offline. <br></div><br><br>wininet.decls:<br><pre class=code>.lib "wininet.dll"
InternetAttemptConnect%() : "InternetAttemptConnect"
InternetCheckConnection%(lpszUrl$,dwFlags,dwReserved) : "InternetCheckConnectionA"</pre><br><br>Test program:<br><pre class=code>Notify InternetCheckConnection("",0,0)
Notify InternetCheckConnection("www.google.com",0,0)
Notify InternetCheckConnection("http://www.google.com",0,0)</pre> <br><br></td></tr></table><br>
<a name="561631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kevin_</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this...<br><br>[Code]<br>WebPage$="www.blitzbasic.com"<br>Net=Web_Connection_Available(WebPage$)<br>If Net=True<br>   Print "Connection Available"<br>Else<br>   Print "Not available"<br>EndIf<br>WaitKey()<br>End<br><br>; **********************************************<br><br>Function Web_Connection_Available(WebPage$)<br>  ; Checks to see if an Internet Connection is currently available.<br>  ; Returns True if available, otherwise false. Valid web address required.<br>  ;<br>  tcp=OpenTCPStream( WebPage$,80 )<br>  CloseTCPStream tcp<br>  If tcp <br>     Return True<br>  Else<br>     Return False<br>  EndIf<br>End Function<br>[/Code]<br><br>Adjust tcp timeouts if required. <br><br></td></tr></table><br>
<a name="561664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Halo, your test program is not calling InternetAttemptConnect ( see msdn Enabling Internet Functionality page linked at bottom of the other commands). <br><br></td></tr></table><br>
<a name="561665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm actually trying to check to see if a connection exists, without forcing one. <br><br></td></tr></table><br>
<a name="561672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> InternetGetConnectedState? <br><br></td></tr></table><br>
<a name="561682"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah-ha! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
