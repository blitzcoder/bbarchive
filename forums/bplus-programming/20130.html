<!DOCTYPE html><html lang="en" ><head ><title >Random Seed behaviour across OS inconsistent?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Random Seed behaviour across OS inconsistent?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Random Seed behaviour across OS inconsistent?</a><br><br>
<a name="205662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ran across an odd little observation today and I'm trying to work out whether it's my code that's messed or something else entirely.<br><br>Basically, I'm trying to share information between a client and a server.  I'm attempting to recreate a series of random numbers between said client and server.  I'm using BlitzPlus to do this.<br><br>When I do this between said client and server, both using WinXP, the series is recreated successfully -- this even works properly across separate physical computers.  When I do this between client and server on WinME, it works fine as well.  However, when I attempt to get a client on XP and a server on ME talking -- or vice versa -- the random sequence using the same seed is buggered up and won't replicate properly.<br><br>Is this expected behavior?  If so, is there any way around this?  Again, this is using precisely the same version of Blitz+, just on different OS's. <br><br></td></tr></table><br>
<a name="205671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't think it has anything to do with your code, not only different OS, different PC's may very well give different results. Maybe a way round that, would be that only one of the PC's generates the data and sends it to the other one(s). <br><br></td></tr></table><br>
<a name="205699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> One PC generating the sequence and transmitting it defeats the purpose entirely, unfortunately.<br><br>If this is expected behaviour I'll have to gen my own, consistent randomization procedure based on seeds.  Ugly, but if that's expected behaviour I've no other choice.  :/ <br><br></td></tr></table><br>
<a name="205703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zenith</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why the hell would random output be different on one computer, and then different on the next -- that's not possible with how a random generator works, the answer should be the same on every computer.<br><br>This is deffinatly a Blitz issue. <br><br></td></tr></table><br>
<a name="205869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Why the hell would random output be different on one computer, and then different on the next <br> <br></div><br><br>I'm taking a stab in the dark here, knowing nothing about which I speak (what else is new?) but I'm gonna go with - slightly different degrees of accuracy in floating point maths? Or am I an idiot? <br><br></td></tr></table><br>
<a name="205877"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the reading I've been doing on the subject (in order to prepare myself in case I need to write one) a consistent random seeding procedure is necessary and commonly written for the same reasons I'm using it -- namely for cryptography and security.  The fact that I'm getting unusual results is very strange indeed if that's the case, as these algorithms seem to be written specifically with an eye towards consistency and portability. <br><br></td></tr></table><br>
<a name="205889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MutteringGoblin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Morduun,<br><br>I'm assuming you have a C compiler lurking around somewhere? If you do then you already have the source for a random number generator. Just find the code for rseed() and rand() and translate it into Blitz. That's what I would do. After all, the standard libraries are yours to do what you like with. <br><br></td></tr></table><br>
<a name="205896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> MG --<br><br>Yes, I can do that without difficulty; it just seems a shame to have to do it longhand when one would logically assume that Blitz's internals would otherwise handle this with aplomb.  Some sort of verification that this is either (A) expected behavior and therefore I should trudge ahead with porting the code, or (B) no, this is a bug and will be fixed in a patch, would be nice -- not just for me, but for anyone else who's expecting Blitz's random number generation systems to be consistent. <br><br></td></tr></table><br>
<a name="205900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Random sequences should be identical between 2 machines.<br><br>Have you tried just printing a sequence of 10 numbers on both OS's and comparing results? Can you dump them here?<br><br>If you're trying to do what I think you are (ie: produce identical game results based on identical random numbers and user input - ie: 'demo playback') its pretty hard, but good luck! <br><br></td></tr></table><br>
<a name="205905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd hoped you'd say that, though it looks like that might mean there's a sneaky little sucker in there somewhere.  ;)<br><br>10-number sequences from XP and ME follow, and speak for themselves; they're very similar but not identical.<br><br>Code:<br><br><pre class=code>SeedRnd 723122303

myFile = WriteFile("XPrand.txt")

For i = 1 To 10
	x = Rand(0, 2147483647)
	WriteLine myFile, x
Next

CloseFile myfile

End</pre><br><br>P3/1G XP results:<br><br><pre class=code>402475453
1049528643
1376088714
1815118417
715725680
1589966466
548088846
1070404359
1019481149
407582393</pre><br><br>P3/700 ME results:<br><br><pre class=code>402475456
1049528640
1376088704
1815118464
715725696
1589966464
548088832
1070404352
1019481152
407582400</pre><br><br>VERY similar -- but not the same. <br><br></td></tr></table><br>
<a name="205908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice bug hunting dude!<br><br>Mark, see the following for possible cause:<br><br><a href="http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/ddraw7/directdraw7/imover_7410.asp" target="_blank">http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/ddraw7/directdraw7/imover_7410.asp</a> <br><br></td></tr></table><br>
<a name="205938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Simon, though I'm the idiot that didn't think to just do a straight run of 10 random numbers to see the difference for myself until Mark asked for it.  ;)  Just nice to know that I'm not going =totally= insane.  Or, er, at least not any more so than usual. <br><br></td></tr></table><br>
<a name="205950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't tell me my theory was actually RIGHT?!? I think I need to go have a lie down... <br><br></td></tr></table><br>
<a name="217452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> *sigh*  Apparently this fix didn't make it into the 1.34 update, so there's one more project frozen in place.  :/  Mark, any idea when this'll be addressed? <br><br></td></tr></table><br>
<a name="217487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>We're looking into this one, but its a fairly complex issue... <br><br></td></tr></table><br>
<a name="217504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I *think* this has something to do with float and/or real numbers, which differ on different machines because of float approximation.<br><br>The workaround would be: use small random numbers !<br><br>If you see in the above list of numbers, the first 6 digit are all syncronized between the two lists, while the rest  differ.<br><br>This can have something to do with approximation, IMO.<br><br>My Asteroids remake is also a demo playback (there are 3 different demos saved in .txt plan files), and works fine on all the pc I have tested so far.<br><br>It uses indeed random numbers which are generated using the same seed, but the numbers I use for the seed are small, I mean, not with 9 digits !!<br><br>So, my advice is: use small seeds !<br><br>;)<br><br>Sergio. <br><br></td></tr></table><br>
<a name="217600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not an option when you're using the random number generator for a cryptographic application, semar, but thanks for the thought.  ;)  I'd roll my own but one needs doubles to do it properly -- so for now I'm pretty much stuck. <br><br></td></tr></table><br>
<a name="217922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had always thought the algorithms for pseudo random number generation all use integers and never floats precisely to avoid such problems. If the built in blitz one uses floats then it's completly flawed from the very beginning (I would be very surprised if it was, a word of Mark about this wouls be interesting). The (few) algorithms I've seen use plain integers, and I guess generators for float numbers should be derived from these ones rather than using floats for their computations. <br><br></td></tr></table><br>
<a name="217925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just found a pieace of article showing what I thought:<br>The real (float) version of a random generator (returns a float in the [0,1) or [0,1] range) is here:<br>Rn = In/ float(m) for [0,1) <br>Rn = In/ float(m-1) for [0,1] <br>where m is the modulo for the method and In the integer random number.<br>The division is the only floating point operation in all the process, so using this, for float random numbers the precision errors are really not a big issue, anf for integers it's not at all because then there's only integer operations.<br><br>So the wierdest thing is morduun showed little differences with INTEGER random numbers. Mark, any comments? <br><br></td></tr></table><br>
<a name="217979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Come on, morduun, you can't seriously say that Blitz not being able to have a (non)random number generator freezes your project! Just code your own for the time-being! Create your own functions for Rnd(), Rand() and SeedRnd() and use DATA statements to get the numbers you want.<br><br>Then, when Blitz+ is updated to reflect the whole "random number" issue, you can just comment out your functions and voila! <br><br></td></tr></table><br>
<a name="218059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seth, I'm not interested in a workaround, thanks.  Mark's agreed it's broken and is looking into it.  I have no interest in wasting time writing redundant functions that will end up being unused. <br><br></td></tr></table><br>
<a name="218060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> What, you never use placeholders? <br><br></td></tr></table><br>
<a name="218114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SDF_of_BC</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> could you use a formula instead that gives close to random results like one that goes into chaos! <br><br></td></tr></table><br>
<a name="218158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> What, Seth, you never evaluate functionality to determine whether it will properly fulfill your needs or not?  You simply press ahead and assume that the direction you've chosen to take will work regardless of whether functionality will support the application fully no matter how deeply integrated into said application the questionable functionality is?<br><br>Perhaps you enjoy wasting your time doing such things.  I do not.  If this functionality cannot be supported I will have to rethink a significant portion of the application's underpinnings and I have no desire to press ahead simply assuming that it will be fixed.  <br><br>It's a complex problem.  Mark understands it's important to me.  I understand he's doing his best.  'Nuff said. <br><br></td></tr></table><br>
<a name="218167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberseth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well er heh as long as one enjoys wasting their time, then it's time well-spent! ;) Besides, I didn't say that I would press on using the flawed functionality, but rather than halting the entire production line for the sake of a loose pin I'd probably jam something in there to keep it going till I find that darn pin again..<br><br>Sounds questionable I agree, particularly with the given analogy, but I just didn't want you to have to halt your app simply for the sake of a random seed generator, and was providing alternatives to fill in until said seed generator becomes available. <br><br></td></tr></table><br>
<a name="218175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >morduun</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Appreciate the sentiment Seth, and there =are= certain things that can (and are) move(ing) ahead a little, but cryptography is an intrinsic part of the app and I don't want to move ahead too much without making a firm decision on an approach I can go forward with.  Recoding is my second-least favorite thing to do in programming (bughunting being my first-least favorite), and I'd rather set something aside for a while than spend time on bits that will just end up in the circular file. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
