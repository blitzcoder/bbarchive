<!DOCTYPE html><html lang="en" ><head ><title >Force Desktop Refresh</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Force Desktop Refresh</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Force Desktop Refresh</a><br><br>
<a name="1275327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any way to force re-drawing of (particular area of ) the desktop?<br><br>For example, if the Desktop buffer has been drawn to, artifacts will remain on the desktop until Windows re-draws that area. <br><br>Is there anything in User32.dll or Gdi32.dll etc. that may help here? <br><br></td></tr></table><br>
<a name="1275334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. This apparently supposed to do a full desktop refresh(haven't been able to test):<br><br>RUNDLL32.EXE USER32.DLL,UpdatePerUserSystemParameters 1, True <br><br><br>Or probably more usefull the MSDN docs to RedrawWindow function in User32.dll:<br><a href="https://msdn.microsoft.com/en-us/library/dd162911(v=vs.85).aspx" target="_blank">https://msdn.microsoft.com/en-us/library/dd162911(v=vs.85).aspx</a><br><br>Which says under Parameters:<br><i>hWnd [in] - A handle to the window to be redrawn. If this parameter is NULL, the desktop window is updated.</i><br><br>So not sure if this is correct, but probably something like:<br><b>User32_RedrawWindow%(hwnd%, rect%, hrgn%, uint%):"RedrawWindow"</b> <br><br></td></tr></table><br>
<a name="1275351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/Community/posts.php?topic=104741" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=104741</a><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3212" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3212</a> <br><br></td></tr></table><br>
<a name="1275360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did try this, but it didn't function as intended:<br>"RUNDLL32.EXE USER32.DLL,UpdatePerUserSystemParameters 1, True "<br><br>Thanks, for all the otehr suggestions, tooo, though - I should be able to find what I need there! <br><br></td></tr></table><br>
<a name="1275364"></a>

<a name="1275365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>.Lib"user32.dll"
User32_RedrawWindow% (hwnd%, lprcUpdate*, hrgnUpdate%, fuRedraw%) : "RedrawWindow"</pre><br><br>"Unknown decls directive" :( <br><br></td></tr></table><br>
<a name="1275367"></a>

<a name="1275368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that should be<br><pre class=code>.Lib "user32.dll"
api_RedrawWindow% (hwnd%, lprcUpdate*, hrgnUpdate%, fuRedraw%) : "RedrawWindow"</pre><br>A bunch of other user32 functions, if needed: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1179" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1179</a> <br><br></td></tr></table><br>
<a name="1275390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The api_RedrawWindow% or user32_RedrawWindow% is just the function name as used in Blitz, provided the return type is correct (%), It doesn't affect anything, so changing that makes no difference.<br><br>It doesn't seem to have any effect at all whether or not there is a space between .Lib and "user32.dll" either.<br><br>I suspect the issue may be some virtualisation / UAC preventing direct access to Syswow or system32 directory since I'm using a limited account here. <br><br></td></tr></table><br>
<a name="1275396"></a>

<a name="1275397"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want to redraw the content of a window which becomes the active window after it was not the active window (if the user has previously clicked on the desktop or on the taskbar or on another window), the approach i have described here :<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3212" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3212</a><br>works properly on windows xp, windows vista, windows 7, windows 8.<br><br>You don't need to use RedrawWindow() you need to use SetWindowPos() with the appropriate flags... <br><br></td></tr></table><br>
<a name="1275473"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's the actual desktop buffer.<br><br>I was working in a 'desk pet' type program where the drawing is actually on the desktop.  Artefacts remain drawn since the actual desktop elements are not redrawn until updated or the mouse cursor moves over them. <br><br></td></tr></table><br>
<a name="1275476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh i see. I misunderstood, i thought you were talking about a window. <br><br></td></tr></table><br>
<a name="1275482"></a>

<a name="1275505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's mlost likely not going to be something readily satisfactorily solved without in depth use of the DWM or other Windows API calls. Probably BlitzPlus is not really the best intended for this type of app <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
