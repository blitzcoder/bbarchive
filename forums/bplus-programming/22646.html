<!DOCTYPE html><html lang="en" ><head ><title >Memory leakage in OpenMovie!!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Memory leakage in OpenMovie!!</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Memory leakage in OpenMovie!!</a><br><br>
<a name="232579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikle</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems that in Blitz 1.83 there is leakage of videomemory when using OpenMovie/CloseMovie. <br><br>Here is the test code. <br><br>========================================= <br>; This example shows the leakage of videomemory when using <br>; OpenMovie / CloseMvie commands. <br><br>Graphics 800,600,16 <br>SetBuffer FrontBuffer() <br>fntArial=LoadFont("Arial",24,False,False,False) <br>SetFont fntArial <br><br>a0 = AvailVidMem() <br>For i = 0 To 10 <br>   m = OpenMovie("avi\m_27.avi ") <br>   ; m = OpenMovie("Graphics\l01_0006.gif") <br>   CloseMovie m <br>Next <br>diff = a0 - AvailVidMem() <br><br>Text 100, 100, "diff = " + diff <br>WaitKey() <br>End <br><br>========================================= <br><br>For .avi file it gives more than 10 Mb difference, for .gif -- about 0.44 Mb (both in non-debug mode). <br><br>Does anyone know how to overcome this problem? <br><br>Or, maybe, someone can suggest the way to free all videomemory? <br><br>Mikle. <br><br></td></tr></table><br>
<a name="232665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Either way, I'd report it in the bug reports forum, not here.  With that excellent code example, mark should hopefully be able to pin the leak down fairly quickly... <br><br></td></tr></table><br>
<a name="232710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think this is just the way Blitz manages video memory.<br><br>Even though you free the movie the memory is not freed until you need it for something else. <br><br></td></tr></table><br>
<a name="232817"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikle</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Floyd,<br><br>Does "something else" mean reusing videomemory for the next OpenMovie? If so, then memory leakage in the example should constantly be about 1 MB (the value reported after one run of OpenMovie). But it is 10 Mb... I don't know what will happen if I open/close movie 100 times. At least this example shows me that all videomemory will be exhausted (diff = 63 MB)!<br><br>I’ve sent the letter to Mark, but he did not answer :-((<br><br>Mikle. <br><br></td></tr></table><br>
<a name="232819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try opening and closing a big movie, say several Mb, a hundred times.<br><br>Then open it one more time and play it with DrawMovie. It should work.<br><br>The only problem here is that you can't tell how much video memory is really available.<br>I suppose this could be considered a bug in AvailVidMem(). <br><br></td></tr></table><br>
<a name="234424"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think there is a question of whether Blitz automatically releases the memory back to the operating system after you make the effort to release if from within your program.  It the thinking is that it is unnecessary to release the memory right away, only to possibly need it again, then by holding onto the memory for awhile would tend to improve overall performance.  And Blitz really does not need to take any more action regarding that released memory when it is released - after all, if you are not going to use it any mofe, why should you care?  It only needs to do housekeeping at the start when it acquires and assigns the memory.<br><br>Many years ago, there was a debate in the software community about whether "housecleaning" should be done at the start of a program, the end of a program, or both.  It could be shown that doing it at the end had a fatal flaw:  Not all programs ran to normal termination, and those that failed, left an untidy mess of assigned resources and memory that other programs had to resolve before they could run.  But the debate between those that wanted to clean up only at the start and those that wanted to also clean up at the end, continued.  The first were economists:  What was the point?  The second were, by nature, just tidy.<br><br>In a single-user system environment, a lot of programmers were probably unaware that this had been an issue.  So most programs initialized variables, assigned constants, created arrays, and requested memory and ran.  When they stopped, that was it.  Nothing to it.<br><br>Wut it has been my understanding that Windows has requrired that good programming practice do some cleanup when the programs end.  They release resources, including ports and memory, before they go away.  "Memory leaks" occur when they don't do that.  This has been an ongoing issue with programs written in C and C++, because the programmer is in full control, and has full responsibility, of all the activity performed (or neglected) by his or her program.  One of the key things done by BASIC and Java is that they cleanup is done automatically by the process that is created by the compiler.<br><br>But note that your program is still running, so the final cleanup is not involved.  Instead, what you are probably looking at is an accounting error - Blitz is not experiencing a memory leak, per se, but it is not giving you the expected value back when you query it about the amount of memory available to you.  That might be a bug, but technically, it is not a memory leak.<br><br>If you (or anyone else) finds that you are running out of memory, or resources, and your PC slows to the point of a crall or stops entirely, and your CPU meter pegs at 100%, then that can be induced in part by a memory leak, from one or more applications that are failing to terminate properly.<br>While you cannot fix the applications themselves, there are several things you can do to reduce or eliminate the problem.  (1)  Check your Virtual Memory settings under System in the Control Panel,  (2)  Add more memory to your system, especially if you have less than 256 MBytes,  (3) Install a third party resource and memory manager, such as TurboMem or Memory Zipper, among others.  These programs check how Windows is assigning memory and resources, and if they find a discrepancy between what is assigned, and the absence of the application that initially requested it. they then instruct Windows to release the resource or memory on behalf of the departed application.  They generally do a good job at this, so you have to judge which is best by what else they claim to do and the reviews that they get.  I don't mind saying that I've really liked Memory Zipper (also called MemZip) after trying some other products, simply because it seems to be a bit more thorough, give you lots of tweaks to play with (and default settings for different preferences), and acutally beat a couple of competitors in the number of simultaneous applications I could have open at once.  But this is not a pitch for a specific product - I'm just trying to clue anyone in as to how to deal with related problems if your search has brought you here.  Do your own online search and there is plenty of information available on the subject. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
