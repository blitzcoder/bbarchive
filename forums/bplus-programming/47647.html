<!DOCTYPE html><html lang="en" ><head ><title >Wow Winlock.dll</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Wow Winlock.dll</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Wow Winlock.dll</a><br><br>
<a name="529362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, if you want to block all unwanted windows key combos in your app, especially if it's full-screen, do the following:<br><br>1) Go here <a href="http://www.vandog.com/loc.html" target="_blank">http://www.vandog.com/loc.html</a> and download the lock o'clock program and install it (it's totally freeware).<br><br>2) Then get the newly installed winlock.dll from the windows folder and put it in your blitz application folder (the author says you can do this for free, yipee). I'm not going to post a link to the .dll, as he might not like me "distributing" it.<br><br>3) Make a new file in BlitzPlus\userlibs called winlock.decls and add this to it <pre class=code>.lib "winlock.dll"
LockKeys():"LockKeys"
UnlockKeys():"UnlockKeys"</pre><br>4) When your application loads, simply call LockKeys<br>5) When your application exits, call UnlockKeys<br>6) Thats it!<br><br>Some problems:<br>- I wouldn't recommend using it when developing because you can't alt+tab to anything else of course.<br>- If you close your app without calling UnlockKeys or it crashes, the next time you run it, for some reason the keys won't be locked.  You have to validly (is there such a word) exit it and restart it before the keys are locked.<br>- On my game Alt+Esc is not locked and it seems to take me back to windows with the game minimised but I can't click on it to go back in and Ctrl+Alt+Del is disabled so I can't kill it!<br>- Pressing Ctrl+Alt+Del isn't actually disabled, task manager is, so your app will still go back to windows and you'll see a message saying "Task Manager has been disabled by your administrator", bummer.<br>- Once after fiddling with it I couldn't use Ctrl+Alt+Del or Windows R (for Run) or Click Start/Run (it wasn't there) even after a reboot.  I had to rerun my app and exit it properly and then everything restored.  This implies the Dll doesn't just trap keys, it also fiddles with the registry which is dangerous imho.<br>- A major problem is that if you run in windowed mode and hit minimise, you can't restore the window at all (as far as I can see).  This isn't so good.  I haven't a clue why!<br><br>This dll could be made better by someone with some knowledge to avoid the registry hacks.  I know that for sure it uses User32.dll SetWindowsHookEx which calls a custom function that traps and cancels keys and then calls CallNextHookEx (to carry on processing).  Then later the hook is disabled with UnhookWindowsHookEx.  I could (maybe) write a blitz wrapper for this if only I knew how to pass a pointer to a custom function (made in blitz) into a dll call.  Anyone know?<br><br>try it out, it's good and it's bad. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
