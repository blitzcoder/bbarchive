<!DOCTYPE html><html lang="en" ><head ><title >File content bugs</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >File content bugs</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >File content bugs</a><br><br>
<a name="740136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awright, yo...<br>I'm having a bit of a problem. I've been experimenting with the B+ Demo lately, and I'm trying to create a program that can open any file, and display its contents in a text field. So for instance, a text file would display the same way it would in Notepad, but a sound file would be a load of "random" letters &amp; symbols, as each byte was translated into a character.<br>My problem is this: every time I open a normal file, like a DOC, or a TXT, or even an HTM, it works fine; the contents display in the field. But when I try to load a bitmap image, all that shows up is "BM" followed by some kind of symbol, regardless of its size. I know that file size isn't the problem, because I've successfully opened text documents larger than the images I've tried.<br>A thought <i>did</i> cross my mind, however: any bitmap image is bound to contain at least one byte set to zero. Could this be making the text field "cut off" the contents prematurely? If so, any combat ideas? <br><br></td></tr></table><br>
<a name="740157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that is it, some characters mark the end of a line, such as Chr$(0) or Chr$(13).<br>Maybe you could check the ascii value of the last character that is shown, or the one after it ?<br>An ascii table might help: <a href="http://www.asciitable.com/" target="_blank">http://www.asciitable.com/</a><br>Usually, to edit files of any type, a Hexeditor is used. It convertes all bytes into hex values. This looks nicely, because a value between 0-255 can be represented with two characters in hex. ($00-$FF) To maintain readability, after the hex value, between brackets, the ASCII character is shown.<br>So either use the ASCII values or find characters that can be used as a substitute, .. ADAM :D <br><br></td></tr></table><br>
<a name="740212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andres</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> in windows new next line = chr(13) + chr(10), but in linux it's just chr(13)<br><br>Try using textarea? <br><br></td></tr></table><br>
<a name="740520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy_A</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use "ReadByte" instead of "ReadLine" when opening an non-text file.<br><br>After "ReadByte" check for valid character. Should be in range of ASCII 32-127, if not then it's probably not a printable character. <br><br></td></tr></table><br>
<a name="740629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks everyone, I think that helps. Andy_A, I did use ReadByte at one point, but it was far slower... Not that my computer's exactly top-range, however (HP Win98 w/ Celeron 300? 400? Mhz (not quite sure), 256 MB RAM, 16 MB GFX mem ( ! ).) <br><br></td></tr></table><br>
<a name="740670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or rather than use "readbyte", create a bank the same size as the file and read all the bytes into the file<br><br><pre class=code>
yourfilehandle=readfile("filename.abc")
bank=createbank(filesize(yourfilehandle))
readbytes bank,yourfilehandle,0,banksize(bank)
closefile yourfilehandle
;then parse through the bytes in the bank and check the ASCII value of each byte in the bank rather than as it is read from the file.
</pre> <br><br></td></tr></table><br>
<a name="740747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy_A</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The CPU is not the bottleneck, it's the disk access that makes "readbyte" so much slower.<br><br>I mentioned readbyte because it's the most straight forward to understand. <br><br>"Readbytes" (plural) is faster because you're reading in the whole file at once instead of one byte at a time. Matty mentions reading in the whole file, which is best for small files. If you have very large files you could read in 1024-4096 byte chunks (same size as a disk sector) instead of the whole file, as this would still be pretty fast. <br><br></td></tr></table><br>
<a name="740791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Woah, never heard of ReadBytes! That's the problem with the B+ Demo, the command ref isn't available, and <i>my</i> computer doesn't have internet access, so I can't refer to the online ones as needed. Thanks for the tip, I'll try it!!!<br>Oh, BTW Andy_A, I know that CPUs normally aren't the cause of disk slowdowns, but in this case it isn't the <i>access</i> of the bytes that's the problem; any Blitz programs run in windowed mode on my PC go verrry slooow as it is; the hard drive itself is actually quite speedy! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
