<!DOCTYPE html><html lang="en" ><head ><title >Function doesn't work</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Function doesn't work</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Function doesn't work</a><br><br>
<a name="562137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zooker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The following is a Function I wrote to strip decimals from a string of numbers:<br>Function StripDec(Q$)<br>     Z=Instr(Q$,".",1)<br>     X=Z-1<br>;        PlaySound(sndBeep) <br> ;       WaitKey() <br>     A$=Left$(Q$,X) &lt; Puts Parameter must be Positive<br>        PlaySound(sndBeep)           on screen<br>        WaitKey() <br>     X=Len(Q$)<br>     B$=Right$(Q$,X-Z)<br>     Q$=A$+B$<br>     Z=Int(Q$)<br>     Z=100 * Z<br>     Return Z<br>End Function<br>What parameters could this be looking for? Playsound &amp; waitkeys are NOT apart of Function. Just used them to isolate problem. How can I solve this? <br><br></td></tr></table><br>
<a name="562186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> result=Int("234.123")<br><br>or.. if you just want to get rid of the dot, and want all fractional numbers to be a part of the real numbers..<br><br>result=Replace$("234.123",".","")<br><br>:D <br><br></td></tr></table><br>
<a name="562213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You are missing two ; to make the text following a command a comment. One ; is required before "&lt; Puts Parameter ..." and the other is required before "on screen" like this:<br><pre class=code>
; PlaySound(sndBeep) 
; WaitKey() 
A$=Left$(Q$,X) ;&lt; Puts Parameter must be Positive
PlaySound(sndBeep) ;on screen
WaitKey() 
X=Len(Q$)
B$=Right$(Q$,X-Z)
Q$=A$+B$
Z=Int(Q$)
Z=100 * Z
Return Z
End Function
</pre><br><br>Also, although you can use Int on a String it always rounds strings down this is undesireable for numbers like "1.6", because you'll get 1 not 2!<br><br>Also note that Int uses bankers rounding i.e. it rounds any numbers that fall exactly on 0.5 to nearest even number i.e. 1.5 = 2 and 2.5 = 2 (not 3).  Try this function (originally by Beaker) to do a rounding where .5 always rounds up to neareast integer (never down)<br><br><pre class=code>
Function ccRound(flot#)
	Return Floor(flot+0.5)
End Function
</pre> <br><br></td></tr></table><br>
<a name="562428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zooker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't need the ; because I put that explanation in after I pasted it in this post. There is absolutely nothing in this Function that should make an error message come on the screen saying that Parameters must be positive that I can see. There is also no index for error messages any where on the web site or in the manual.  If that is to be kept secret why have them at aLL? Frustrated!! <br><br></td></tr></table><br>
<a name="562467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well if it doesn't find a decimal point then Z is -1 I think. There for X is -2, and that would explain your problem. But I'm just guessing. <br><br></td></tr></table><br>
<a name="562500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry Zooker I didn't get your comment, I do now and Sushimasta is correct.  You need more error checking early on. <br><br></td></tr></table><br>
<a name="562562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Zooker, check out how to use the [code][/ code] commands to seperate your code from the rest of your post.<br><br><a href="/faq/faq_entry.php?id=2" >What are the forum codes?</a> <br><br></td></tr></table><br>
<a name="562579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yet I fail to see why Replace$("99.99",".","") couldn't do the job here.. <br><br></td></tr></table><br>
<a name="562595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> problem is he's using integers to hold floating point currency values (which is a good idea) but he'll need some of validation before using replace as what if the user enters more than 2 digits after the decimal point e.g. 12.345.  This will not result in an amount in cents, it will be in 10ths of cents which is dumb.  The string must be parsed to check it has a decimal place (and only one), to check it contains only numbers (no other chars) and if there are more than 2 decimal places, the extra ones must be removed.  Then Replace will work fine. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
