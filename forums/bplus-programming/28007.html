<!DOCTYPE html><html lang="en" ><head ><title >Net Use - API/.Decls problems</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Net Use - API/.Decls problems</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Net Use - API/.Decls problems</a><br><br>
<a name="293966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sin of Nature</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> --------------------------------------------------------------------------------<br>Hi,<br>Using Blitz+ neat .decls capabilities and trying to convert some of my old Visual Basic code into Blitz. I'm having trouble trying to work out how to get some of the parameters to work. For example, Blitz+ does not have Long's, only Int's. How do strip NULL's from the end of strings... etc.<br>The code below is a simple example of calling some api calls from within the MPR.DLL. It trying to map a drive to a machine. <br><br>Under Visual Basic, some of the constants had &amp;H1 which I think means Hex value 1. Under blitz, I couldnt see away of using hex numbers, so I simply converted them to decimal. Will that work?<br><br>The 2nd think I've done is used INT's instead of LONG's. I'm not sure how many Bytes that Blitz's INT's use compared with the number of bytes used in Visual Basics LONG's. I also need a Strip Nulls routine from the UserID string.<br><br>Pretty new to this .decls thing.<br><br>[CODE]<br>     Const RESOURCETYPE_ANY = 0 	; &amp;H0<br>     Const RESOURCETYPE_DISK = 1	; &amp;H1<br>     Const RESOURCETYPE_PRINT = 2   	; &amp;H2<br>     Const RESOURCETYPE_UNKNOWN = 65535 ; &amp;HFFFF<br>     Const CONNECT_UPDATE_PROFILE = 1<br>     Const NO_ERROR = 0<br>     Const ERROR_ACCESS_DENIED = 5<br>     Const ERROR_ALREADY_ASSIGNED = 85<br>     Const ERROR_BAD_DEV_TYPE = 66<br>     Const ERROR_BAD_DEVICE = 1200<br>     Const ERROR_BAD_NET_NAME = 67<br>     Const ERROR_BAD_PROFILE = 1206<br>     Const ERROR_BAD_PROVIDER = 1204<br>     Const ERROR_BUSY = 170<br>     Const ERROR_CANNOT_OPEN_PROFILE = 1205<br>     Const ERROR_DEVICE_ALREADY_REMEMBERED = 1202<br>     Const ERROR_DEVICE_IN_USE = 2404<br>     Const ERROR_EXTENDED_ERROR = 1208<br>     Const ERROR_INVALID_PASSWORD = 86<br>     Const ERROR_NO_NET_OR_BAD_PATH = 1203<br>     Const ERROR_NO_NETWORK = 1222<br>     Const ERROR_NOT_CONNECTED = 2250<br>     Const ERROR_OPEN_FILES = 2401<br>    ;Define miscellaneous variables<br>    <br>     Const ERROR_INVALID_ADDRESS = 487<br>     Const ERROR_INVALID_PARAMETER = 87<br>     Const ERROR_MORE_DATA = 234<br>     Const ERROR_UNEXP_NET_ERR = 59<br>     Const ERROR_NOT_SUPPORTED = 50<br>     Const ERROR_NOT_ENOUGH_MEMORY = 8<br><br>Type NETRESOURCE<br>   Field dwScope       ; Long<br>   Field dwType        ; Long<br>   Field dwDisplayType ; Long<br>   Field dwUsage       ; Long<br>   Field lpLocalName$  ; String<br>   Field lpRemoteName$ ; String<br>   Field lpComment$    ; String<br>   Field lpProvider$   ; String<br>End Type<br><br><br>Global rc<br>Global lCxnType<br>Global netAddCxn.NETRESOURCE = New NETRESOURCE<br>Global varPersistent = 0<br>Global sPassword = "", sUserID="administrator"<br><br><br>lCxnType = RESOURCETYPE_DISK<br><br>netAddCxn\dwType = RESOURCETYPE_DISK<br>netAddCxn\lpLocalName = "R:" ;sLocalDevice<br>netAddCxn\lpRemoteName = "\\MyMachine\c$" ;sShareName<br>netAddCxn\lpProvider = Chr(0)<br><br><br>rc = api_WNetAddConnection2(netAddCxn, sPassword, sUserID, varPersistent)<br><br>DebugLog rc<br><br>WaitKey()<br><br>[/CODE]<br><br>Anyone help? <br><br></td></tr></table><br>
<a name="293975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Some pointers:<br>use $ for hex numbers in Blitz - eg. $F7<br><br>Blitz Ints use 4 bytes (as do Floats). <br><br></td></tr></table><br>
<a name="294063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> also - visual basic create dll files will not work with blitz.  Something to do with VB making activeX .dll files instead of the kind blitz can use.<br><br>Hopefully someone who actually knows the difference will post so you don't have to rely on my rambling. <br><br></td></tr></table><br>
<a name="294277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sin of Nature</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The calls are not from a VB DLL. Its a standard windows API call (ie. windows DLL's).<br><br>You are right about VB's DLL's though, my mate had same problem calling them via C++.<br><br>Sin <br><br></td></tr></table><br>
<a name="294401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> u are all correct regarding using DLL crated with 'out-of the box" vb6.0..however.. some bright folks at WWW.vbAdvance.com have solved the problem.. YOU CAN USE Visual Basic DLL's with Blitz3d.. <br><br></td></tr></table><br>
<a name="295549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kurtz,<br>did you check if VBAdvance could really give to VB6 the capability of writing a DLL-Blitz compatible ?<br><br>Sergio. <br><br></td></tr></table><br>
<a name="295815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes...I have it working ...I am still trying to get forms working ... everything else (strings,numbers) work fine for both VB subs and functions.. my app uses INI files...I am using a vb6 written DLL with 6 functions to rd/wrt INI files..VBAdvance is FREE TO TRY.. it is quite easy...If I could get some of you 'really bright' folks using it you would figure out some neat stuff to do...email me and I will send you the code (vb6/Blitz) that I used to test vbadvance (short) <br><br></td></tr></table><br>
<a name="296013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kurtz,<br>you've got mail at the address specified in your profile.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
