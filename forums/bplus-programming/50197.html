<!DOCTYPE html><html lang="en" ><head ><title >Routine for making a sprite dissolve?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Routine for making a sprite dissolve?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Routine for making a sprite dissolve?</a><br><br>
<a name="558264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hockings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi All,<br>I'm trying to replicate an effect from an old game but am drawing a blank on a good way to do it (all the ways I can think of would require loads of code or stupidly large amounts of memory).<br><br>The original effect had a sprite of about 16x16 (Commodore 64 days) that would have a few random pixels change colour rapidly then change to black. A few of the non-black pixels would then change colour and go black, and then a few more, and so on until the sprite had been erased. The selection of which pixels to erase was random each time.<br><br>Has anyone got any good ideas on how I'd implement this effect, particularly with a much larger sprite?<br><br>Thanks!<br>Shane <br><br></td></tr></table><br>
<a name="558484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aab</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, i suppose you mean for realtime use<br>(eg 60 frames per second while user is moving a character about or something),<br><br>Otherwise you could just loop through after using LockBuffer() and WritedPixelFast()'ing. (On general sized images seems to take the same time as getting the LockedPixels() bank and Peeking and Poking it)<br><br>eg of use (not to do what you ask but to write a colour to every pixel)<br><pre class=code>
img=Loadimage(....)
buf=Imagebuffer(img)
w=Imagewidth(img)
h=Imageheight(img)

LockBuffer(buf)
For u=0 to w
	For v=0 to h
		WritePixelFast ... ;depending on your desires.
	Next
Next
Unlockbuffer(buf)
</pre><br>But that would be slow..<br>I assume that you already know the above well (and ive wasted some time) but if so, all i can think of is:<br><br>Making a list of images during loading times that have a mask, and are each drawn with some dots randomly during this time (in the way mentioned above): it wouldnt affect the user during this time as the game would be doing some loading routines and not actually 'playing'.<br>So say you made a list of random images each 512,512 or something similar: you could just Tileimage random ones of them on over time. (Setbuffer(imb=buffer(img)) so Tileimage draws to the image) Big problem..It would only do for the first part as there would be alot of leftover spaces.<br>And if you wanted the pixels to fade from their random colour to black, and not just 'black out', id be lost as to how to do it in any good timeframe in Blitz.<br><br><br><a href="http://www.nexuschat.com/forums/index.php" target="_blank"><img src="http://img.photobucket.com/albums/v335/aabants/nc_Support.png"></a> <br><br></td></tr></table><br>
<a name="558490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zster</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> First set up a function to go through your image and count how many non black pixels you have. Then assign them each to an array. Then travel through that array 10 at a time fading them out to a predeterminined palette (stored in an array). The travel is determined by a prime number greater than the amount of pixels (you can look these up on the internet) various primes look different and you can make the formula more random (forgotten how at the moment) but you can look it up. The example is quick and tries to show it but I think you need to extend the palette to at least 32 and have them fade slowly to get a decent effect. Hope it helps<br><br>eg<br><br>[/code]<br>Graphics 320,240,32,2<br>sprite=CreateImage(16,16)<br>SetBuffer ImageBuffer(sprite)<br>Rect 2,5,11,5,1<br>Rect 5,2,5,11,1<br>count=0<br>arraycount=0<br><br>Dim cp(10);the amount of pixels we want picked at a time<br><br><br>SetBuffer ImageBuffer(sprite)<br>LockBuffer ImageBuffer(sprite)<br>For nx=0 To 15<br>	For ny=0 To 15<br>		temp=ReadPixelFast(nx,ny)<br>		If temp=$FF000000;which is black FF is the alpha value<br>		Else<br>			count=count+1<br>		EndIf<br>	Next<br>Next<br>UnlockBuffer<br><br>;once you know the number<br>;arrays used for speed<br>Dim fadex(count)<br>Dim fadey(count)<br><br><br><br>SetBuffer ImageBuffer(sprite)<br>LockBuffer ImageBuffer(sprite)<br><br>For ny=0 To 15<br>	For nx=0 To 15<br>		temp=ReadPixelFast(nx,ny)<br>		If temp=$ff000000<br>		Else<br>			fadex(arraycount)=nx<br>			fadey(arraycount)=ny<br>			arraycount=arraycount+1<br>			If arraycount=4<br>				;Stop<br>			EndIf<br>		EndIf<br>	Next<br>Next<br>UnlockBuffer<br><br>;setupfast fade palette<br>;you may want to change to rand(100-(n*8),255-(n*8))<br>;so later colours are darker<br>Dim palette(16)<br>For n=1 To 15<br>	r=Rand(100,255)<br>	g=Rand(100,255)<br>	b=Rand(100,255)<br>	palette(n)=r Shl 16 + g Shl 8 + b<br>Next<br>palette(16)=$ff000001;last colour black<br><br>;now To test<br>pixel=Rand (84); random starting pixel must call this before function starts<br><br>For time=0 To 600<br>	If time&gt;120 ;wait 2 seconds then disolve<br>		If totalcount&lt;84<br>			SetBuffer ImageBuffer (sprite)<br>			LockBuffer ImageBuffer (sprite)<br>			;now here the random bit what you need is a prime<br>			;number greater than the number of pixels you're going<br>			;to cycle through in this case 89 (you can look these<br>			;up on the internet it works better with non uniform shapes<br>			 ;85 pixels in this image<br>			<br>			If palcount=0 ;this makes sure all pixels are faded out<br>							;before selecting the next 10 pixels<br>				For n=0 To 9<br>					cp(n)=pixel<br>					pixel=pixel+103<br>					While  pixel&gt;84;greater than pixel number<br>						pixel=pixel-85<br>					Wend<br>				Next<br>				palcount=1<br>			Else<br>				For n=0 To 9<br>					WritePixelFast(fadex(cp(n)),fadey(cp(n)),palette(palcount))<br>				Next<br>				palcount=palcount+1<br>				If palcount=17<br>					totalcount=totalcount+10<br>					palcount=0<br>				EndIf<br>			EndIf<br>			UnlockBuffer<br>		EndIf<br>	EndIf<br>	<br>	<br>	SetBuffer BackBuffer()<br>	Text 0,0,count<br>	DrawImage sprite,100,100<br>	Flip<br><br>Next<br>[/code] <br><br></td></tr></table><br>
<a name="558582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kevin_</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Crickey! That sure is a slow way to do it. Why not create some images the same size as your sprite with missing pixels then animate them. OK, more memory needed for the extra images but it will be fast enough especially if you want to disolve lots of sprites. <br><br></td></tr></table><br>
<a name="558694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hockings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the replies guys, they're certainly much appreciated! I'll have to think about the prime number thing to get it sorted in my head...<br>Considering that it's a remake of an old platformer (Henry's House) and there's not exactly heaps of graphics going on, I think the overhead of doing randomness will be worth it (especially when I want to map it to the correct animation frame for the character. Using image animation for disolves would mean X (number of animation frames) * Y (Number of disolve frames) images which means lots of frames for even a small sprite!)<br><br>The other way I had suggested was to have each pixel as a type (X,Y,Color), put the types in an array, shuffle the array, then blank out the pixels going through the array. I'm not sure which will give the best result in speed or performance but I'll give them all a go.<br><br>Again, thanks all very much for taking the time to respond!<br>Shane<br>(Look out for the game this relates to - Henry's House - coming to Retro Remakes sometime in the next month hopefully!) <br><br></td></tr></table><br>
<a name="558712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zster</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The demo was more to show the effect nothing stops you from using it to prerender some images although I don't think the overhead is large at all so realtime use is not out of the question. The method above causes pattern randomness to get a true random looking disolves using primes see<br><a href="http://www.developer.com/tech/article.php/10923_3496381_3" target="_blank">http://www.developer.com/tech/article.php/10923_3496381_3</a><br>it's in C++ the principles are the same <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
