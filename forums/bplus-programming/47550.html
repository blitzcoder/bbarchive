<!DOCTYPE html><html lang="en" ><head ><title >Minimise Help</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Minimise Help</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Minimise Help</a><br><br>
<a name="528418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> So far all the Blitz programming I have done has been in graphics mode but I just added a windowed mode to my game by calling Graphics 800,600,32,2.  the 2 flag on the end puts in in a window. Please excuse the simplicity of my questions...<br><br>How do I add a minimise and close button to the title bar?  And how do I call the minimise function in code (i.e. when the user presses a "Boss" key)?<br><br>Will Alt+F4 auto close the app when an X is on the title bar or will an event get raised?<br><br>thanks <br><br></td></tr></table><br>
<a name="528453"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snarkbait</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> to add minimize to the window:<br><br><pre class=code>
; add minimize button 
Wlong = User32_GetWindowLong(hWND, -16)
Wlong = Wlong Or $20000
User32_SetWindowLong(hWND, -16, Wlong)

</pre><br><br>You need these commands in your 'user32.decls'<br><br>User32_SetWindowLong% (hwnd%, nIndex%, dwNewLong%) : "SetWindowLongA"<br>User32_GetWindowLong%(hwnd%, nIndex%): "GetWindowLongA" <br><br></td></tr></table><br>
<a name="528480"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I'll try that.  Anyone able to answer my other questions? <br><br></td></tr></table><br>
<a name="528501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I made a user32.decls file and stuck <pre class=code>.lib "user32.dll" </pre> at the top of it.  I added the suggested code to the app, but I am at a loss as how to get the handle of my game window.  Bear in mind I created it with graphics (and flag 2 in the end) not CreateWindow. Any help will be appreciated.  Thanks <br><br></td></tr></table><br>
<a name="528504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Haven't tried it, but will QueryObject() work for a Graphics window? maybe with query_id 2? <br><br></td></tr></table><br>
<a name="528505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> This <pre class=code>Notify(QueryObject(BackBuffer(), 2))</pre> returns 0, so I guess it doesn't work.  If you make a window with Graphics, Blitz must have stored a handle somewhere so it can close it at the end!  But how can I access it.  Failing that I'll have to use CreateWindow (which is new to me in Blitz) but you can't use backbuffer and flip can you, which would mean some horrid re-writing. <br><br></td></tr></table><br>
<a name="528769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Failing that I'll have to use CreateWindow (which is new to me in Blitz) but you can't use backbuffer and flip can you<br> <br></div><br>You can create a canvas within the window and use that in the same manner ;)<br><br>Or try this...<br><br>AppTitle "Tetris"<br><br>Handle=FindWindowA("","Tetris")<br><br><div class="quote"> <br>.lib "user32.dll"<br>FindWindowA%(NullString,WindowText$):"FindWindowA"<br> <br></div> <br><br></td></tr></table><br>
<a name="528893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks VIP3R, that does indeed get the handle of the Blitz Graphic window.  I then called a modified version of Snarkbait's code as follows:<br><br><pre class=code>
Wlong = User32_GetWindowLong(TheWindow, -16)
		Wlong = Wlong Or $20000 Or $80000
		Notify User32_SetWindowLong(TheWindow, -16, Wlong)
</pre><br><br>I added Or $80000 to get a system menu because adding $20000 on its own for a Minimise box doesn't work.<br><br>So now I have a blitz graphic window with a system menu and a minimise button (no maximise or resize, which is fine).  One of my original questions remain:  How can I tell the App to minimise if the user presses a "Boss" key?  Also when I click the X, the app doesn't close.  So how do I intercept the close event in my main loop so I can exit the app myself.  Any help is really appreciated.  Thanks <br><br></td></tr></table><br>
<a name="529367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, I found out you can minimise a window when a key is pressed like this:<br><br>1) Make sure you have a handle to your window using the FindWindow code above.<br>2) declare this const <pre class=code>Const SW_MINIMIZE = 6 ;used with ShowWindow</pre><br>3) By now you must have a user32.decls file in BlitzPlus\UserLibs so add this line to it <pre class=code>User32_ShowWindow% (hwnd%, nCmdShow%): "ShowWindow" 
</pre><br>4) In your app call <pre class=code>User32_ShowWindow(TheWindow, SW_MINIMIZE)</pre> where TheWindow is the handle to your window.  Tada<br><br>Hope you find it useful.  My game now has a boss key!  Even in full-screen mode it can be done by reseting the graphics mode to use flag 2 on the end for windowed mode and then calling the minimise code from above. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
