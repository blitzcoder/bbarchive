<!DOCTYPE html><html lang="en" ><head ><title >userlib path</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >userlib path</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >userlib path</a><br><br>
<a name="411745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> i am in need of accessing a userlib that is not in a windows directory and is not in my application path (it is installed in a certain, dynamic location by another software product).  i cannot seem to get the userlib functionality to find the userlib file.  i tried setting the PATH environment variable but that did not work.  i also tried using CurrentDir() and ChangeDir() to change the current directory before i called the DLL function.  any ideas out there or anyone with insight into how the userlib functionality locates files?<br><br>thank you. <br><br></td></tr></table><br>
<a name="411746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you try .lib "c:\blah\blah\pathtodll\dll.dll"? <br><br></td></tr></table><br>
<a name="411748"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> greetings Eikon :)  while that may work (havent tried it), i need it to be dynamic since the user could have installed it to any directory :(  i read the path to the DLL from the registry.  i did try something like:<br><br>.lib gcPath$+"dll.dll"<br><br>and was planning on setting a global var but the compiler err'd when i tried to build the EXE.  said it was expecting a string :( <br><br></td></tr></table><br>
<a name="411754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmm.  heres a thought, i could copy the DLL (its not an activex dll) to the app folder and then delete it when im done.  boy thats ugly but it may be the only way... <br><br></td></tr></table><br>
<a name="411755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want to do that you'll need to use CallDLL instead of a userlib. Something like CallDLL regpath$ + "\mydll.dll", func <br><br></td></tr></table><br>
<a name="411764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> thx Eikon.  i was looking into that and i got the impression from the help that the DLL called needed to be written specifically for blitz (based on the example C function declaration).  the function i need to call has 5 params ($,$,$,%,$) and returns a %.  im getting decent with banks, but im not sure how i would define the IN bank for the function call.  is there a direction you can point me towards more info?  <br><br>&lt;edit&gt; i found one example in the forum that builds a bank of banks (using an integer to point to a bank for each $ that needs passed) to pass to a function call.  i think this is what i need to do? <br><br></td></tr></table><br>
<a name="411771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, if you've got that many params, a userlib would be ideal. Why not just declare .lib "mydll.dll" in the userlib and leave the DLL in the app folder. Then on the first run you could CopyFile it to SystemProperty("systemdir") and then DeleteFile it from the base dir afterwards, assuring it can always be located. <br><br></td></tr></table><br>
<a name="411793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> doh!  was just going to go with copying it in for the run of the program but ran into 2 issues:<br><br>1) it apparently determines if userlibs exist sometime before it reaches the code.  copying it in during an initialization phase still gives userlib not found.  if run again with it already there it works fine.  this could explain why either changing the path or setting the current directory at the time of the call didnt work for me.  it had predetermined that they it was already not there.<br><br>2) there is no way i can find to flush the DLL cache.  once a call is made i cannot delete the DLL file until the app is closed.<br><br>grrr :|  the reason i want to not move it to the systemdir is because i have no control over the install for the DLL.  any subsequent installation may not update the copy of the DLL being used if i permanently move it somewhere. <br><br></td></tr></table><br>
<a name="411796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, a real toughie. I'm sure someone will come along with a solution. Soja... <br><br></td></tr></table><br>
<a name="411913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> This problem is a pain. It would be much better if we had control over when the program searches for the dll's, that way we could even pack them into the exe.<br><br>There may be a solution but it's a bit long in the tooth:<br><br>Make a batch exe that does the following:<br>1) Searches for the dll and places a copy of it into the applications userlib folder.<br>2) Use the ExecFile command to start the application that needs the dll. The application will now detect the dll and start.<br>3) Close the batch exe.<br><br>Make another batch exe to delete the dll:<br>1) When the application closes, use ExecFile to call this batch exe to delete the dll from the applications userlib folder. You may need to use a delay to allow the dll to be freed.<br>2) Close the second batch exe.<br><br>You could use one batch exe using a flag saved in a dat file. <br><br></td></tr></table><br>
<a name="411954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> greetings vip3r :)  definately a pain!  i have thought long and hard about this and i think the best and easiest thing for me is to write a stub DLL that will do a loadlibrary and call the functions on the one i need access to.  i can keep it in the app directory and can pass a path into it for the loadlibrary.  not the best, but will be adequate and easy.  i thank you both for the replies :)  one of the reasons i bought B+ is due to the active community that works with it :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
