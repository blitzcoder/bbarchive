<!DOCTYPE html><html lang="en" ><head ><title >PNG Animation Util??</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >PNG Animation Util??</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >PNG Animation Util??</a><br><br>
<a name="355899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello all,<br><br>Have 1200 PNG files I need to put into a file(s?) that can be read with "LoadAnimImage".  Can't find a utility that will allow creation of the proper format (PNG) with this many/size files.  Prefer to do an entire directory at once (they are in alpha order).  Tried using Jasc Animation Shop but no-go (file/save options &lt;&gt; PNG).<br><br>Read somewhere "LoadAnimImage" is limited to 1024 frames?  Using B+.<br><br>Suggestion/comments appreciated.<br><br>Thanks in advance,<br>Jim <br><br></td></tr></table><br>
<a name="355902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not write a blitz program that draws each frame into a huge created image and then SaveImage it to a bmp for png conversion? You could make the png loading very simple by naming each img1.png, img2.png, etc. Hopefully the files already have some numbering or else renaming all 1,200 would require another program in itself ;)<br><br><pre class=code>
For i = 1 to Num_Images
    tmp_Image = LoadImage("img" + Str(i) + ".png")
    ; Do a CopyRect from one ImageBuffer to the other here
    tmpX = tmpX + ImageWidth(tmp_Image) ; Move over for the next pic
next
</pre><br><div class="quote"> <br>Read somewhere "LoadAnimImage" is limited to 1024 frames? Using B+.<br> <br></div><br>If so, I guess you'd  have to use two images. Maybe each could hold 600 frames. <br><br></td></tr></table><br>
<a name="355911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks,<br><br>Had dawned on me .. but,<br><br>not sure if B+ will handle it.  Used B+ to create 1200 309*309 BMP images .. each one 290K.  "SaveImage" saves BMP only (from what I have gathered).  Massive is a tad understated (for me anyway :)   So .. created 1200 PNG's (using "pic2pic" freeware .. a little flaky but does the job) at about 9K apiece, an entire directory at one shot.<br><br>I'll give your idea a run (using BMP's) but will be crossing fingers I don't crash .. again :)<br><br>There has to be a util out their that deals with stitching PNG's together.<br><br>BTW:  File names are sequential.<br><br>Thanks, <br><br></td></tr></table><br>
<a name="355918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I meant that you would SaveImage once, when you had the whole line up in the created image. Then you'd only need to convert one bmp to png. If you cant get it working then you can drop the images [a ftp://user:blitz@...] and i'll send you back the one png. <br><br></td></tr></table><br>
<a name="356482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PGF</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like Eikon's suggestion but wonder about the practicality.  It is going to be a large file even as a PNG on disk but when loaded into memory (if possible) it is going to be stored as a BMP anyway so bingo the PNG doesn't save you anything except disk and maybe disk to memory transfer time.  Most likely it just won't fit in graphics memory.<br><br>I'm not sure but I understand that B+ can use system memory for graphics and move them on demand to graphics card memory which might get you across the line.  Some optional flag for "managed" memory ?<br><br>If the memory isn't a problem but there is a limit of 1024 frames then use two AnimImages and switch at the appropriate point.<br><br>How about questioning the whole approach rather than looking for a solution to the perhaps impossible.<br><br>Could you show a frame or two to give a feel for the nature of the graphics ?<br><br>If frame to frame differences aren't great then a custom approach to recording the differences might work.  Good old "run length encoding of the delta" might give enough compression and you can just read enough bytes to build a frame before it is displayed.  Depends upon how much compression you'll get on the images from a simple algorithm.<br><br>What about streaming it continuously from disk ?  You just might be able to read and display frames quickly and smoothly enough.<br><br>What else has to be going on at the same time ?  Is it just a movie or do you need other animation to be running over it ?<br><br>Perhaps you need to compromise on the dimensions or number of frames.<br><br>Maybe the answer is to use some method external to Blitz invoked through a DLL.<br><br>Depends upon what the aim really is. <br><br></td></tr></table><br>
<a name="356564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Eikon/PGF,<br><br>I wasn't ignoring you Eikon (appreciate the offer .. might hold ya to it ;) .. as observed .. questioning my approach and didn't want to waste your time :)  Where can I post the BMP's ??<br><br>Here are all the gory details:<br><br>Using one 309x309 BMP as the graphics 'face'.<br>Using another BMP as the 'needle'.  Overlay the face over the needle .. interesting effect :) though I can do it normally also.<br><br>Run a Blitz program that creates 3600 BMP's (.01 degree needle res).  Why?  because I can divide 3600 by 2/3/4/5/6/8/9/10/etc .. nice number .. I can 'pick and choose' the displayed tachometer resolution and some flexibility in other ways.<br><br>Then use the "Glueit" program to create "ani-strips" with the 280K BMP's .. has its limits though .. picked 100 (or other # as required) a strip as it gets a tad cranky if I push it further.  Each 100 frame BMP is 37298K.<br><br>I then convert the BMP to PNG strips with the "pic2pic" program.  It is an imbedded system so I need the initial storage space.  BTW: Individual PNG strips are 217K (256 color).<br><br>Can't stream the data (don't know of a method) as a tach can bounce all over the place in very short order.  Have a ~270 degree needle swing (11,000 RPM tach; a 200MPH speedo and some smaller gauges to do after I get the general issue completed).<br><br>Am trying to figure out the best method to 'grab' only the updated part of the tach face and save .. AND a means to allow the program that does the image display 'coordinating' to handle placement of image sizes 'automajikly'.  That would allow much smaller ani-files and faster updates.  Have not figured out exactly how to do it ?!?!?!?<br><br>The other method tried is simply grabbing each 'individual' file as needed from disk and using one frame.  I can't say conclusively it is faster .. but at o'dark-thirty this morning it certainly looked like it was MUCH faster .. though I can't explain why.   Note: I'll be using a RAMdisk also.<br><br>As to what else will be going on at the same time?  <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=32901" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=32901</a><br>covers it somewhat.  Any questions just ask .. no secrets here.<br><br>Pretty much it. Ideas/suggestions/minor lambasts/etc OK.  It is public domain project so what goes out the door is what they get .. but would like to do it right.  Credit given where credit due. <br><br></td></tr></table><br>
<a name="356567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Where can I post the BMP's ??<br> <br></div><br>Depending on their zipped size you can upload them to the [a ftp://user:blitz@... link[/a] I provided earlier (5MB or more), or email them to eikon@... (5MB or less) <br><br></td></tr></table><br>
<a name="356569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Tried using Jasc Animation Shop <br></div>Save it as MNG (animated form of PNG) and write a loader for the MNG image.  Info about the MNG format can be found:<br><br><a href="http://www.libmng.com/" target="_blank">http://www.libmng.com/</a> <br><br></td></tr></table><br>
<a name="356574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Done,<br><br>Email and FTP .. a whole 10K :)<br><br>Thanks,<br>Jim <br><br></td></tr></table><br>
<a name="356622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> To turn tachneedle.bmp into 360 seperate frames I used this code:<br><pre class=code>
; Breaks Needle into 360 frames
; and places them into a 'need' dir
; Process will fail if 'need' directory doesnt exist
Needle = LoadImage("tachneedle.bmp")
tmp = CreateImage(264, 264)

For i = 0 To 359
	RotateImage Needle, i
	SetBuffer ImageBuffer(tmp): Cls
	DrawImage Needle, 132, 132
	SaveImage tmp, "need/img" + i + ".bmp"
	FreeImage Needle: Needle = LoadImage("tachneedle.bmp")
Next
</pre><br>If we were to combine all those frames into one AnimImage strip then it would be 95,040 x 95,040. This is simply not feasible for load time and video memory concerns. This is why I think a frame by frame loading animation technique would work best. Download this <a href="http://s93151849.onlinehome.us/needle.zip" target="_blank">project</a> which includes a mock up example and all 360 frames created with the program above. This method has zero load time and will only use the total vid memory of one frame, instead of them all. If this works out for you then your biggest worry will be finding a mass bmp-&gt;png converter. Im sure it wouldn't be too hard with the proper command line tool and a batch file. <br><br></td></tr></table><br>
<a name="356634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks !<br><br>Get back to you later .. have to depart the keyboard for a bit.<br><br>Jim <br><br></td></tr></table><br>
<a name="356693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello Eikon,<br><br>Back for a bit. Mind if I upload the PNG's to your site?<br>Following is a hack on sample code to go with.  Working on the other method as we speak.<br>Jim<br>--------------------------------------------------------<br>; LoadAnimImage/MaskImage Example <br>Global gfxTach,gfxTach1,gfxTach2<br><br>; Standard graphic declaration and double buffering setup <br>Graphics 309,309,0,2<br>SetBuffer BackBuffer() <br>; Load the imagestrips<br>gfxTach0=LoadAnimImage "\TachFace\Div_10\119.png",309,309,0,120) <br>gfxTach1=LoadAnimImage("\TachFace\Div_10\239.png",309,309,0,120) <br>gfxTach2=LoadAnimImage("\TachFace\Div_10\359.png",309,309,0,120) <br>Repeat<br>  For i = 0 To 120 Step 1<br>    If i &gt; 119 Then Exit<br>    If i = 61 Then Delay 1000<br>    If i &gt; 59 Then<br>     DrawImage gfxTach1,0, 0, i ;draw the image <br>     Flip ; show the buffer<br>    Cls <br>    End If<br>  Next<br>  For i = 0 To 120 Step 3<br>    If i &gt; 119 Then Exit<br>    DrawImage gfxTach2,0, 0, i ;draw the image <br>    Flip ; show the buffer<br>    Cls <br>  Next<br><br>  For i = 0 To 120 Step 6<br>    If i &gt; 102 Then Exit<br>    DrawImage gfxTach0,0, 0, i ; draw the image <br>    Flip<br>    Cls <br>  Next<br>Delay 1000<br><br>Until KeyHit(1)<br>End <br><br></td></tr></table><br>
<a name="356696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Caveat .. code was only used to determine CPU utilization and use if LoadAnimImage command. <br><br></td></tr></table><br>
<a name="356730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PGF</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait a minute - you're generating 3,600 images in order to display a tachometer ?!?<br><br>A tacho gives a quick indication of the reading so shouldn't need to be that precise.  Insert a numeric readout to give the exact value if necessary.<br><br>I doubt that there would be very much difference at all between successive images at such small increments.  Even say 360 or maybe 180 images would be smooth and accurate enough for just about any purpose.<br><br>And check your math - wouldn't 0.01 degree resolution require 36,000 images ?  Maybe you meant 0.1 degree increments ?<br><br>I just think that you are on the entirely wrong track.<br><br>If you aren't happy with images at say 1 degree steps then a basic alternative would be to use trig functions to calculate the needle end points from the angle and just draw them as lines.  If this isn't fancy enough then write a more complex drawing function using maybe circle endpoints.  For a relatively small number of pixels, using anti-alias and per pixel colour calculation could make it even prettier.<br><br>Programming anything significant is a balancing act of features / programming effort / CPU time / memory / disk tradeoff and I think you're searching around at the extreme end of just one of those dimensions. <br><br></td></tr></table><br>
<a name="356731"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> To no one in particular ...<br>Read/Writepixelfast next on the agenda.  Found a bug (an unnoticed "Delay" statement) in the RAMDisk I/O comparison method .. disregard the 'MUCH faster' comment.<br><br>Eikon ..<br>Your code works just dandy (hats off to you for the examples :).  Both of us are killing the CPU.<br><br>Later, <br><br></td></tr></table><br>
<a name="356734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for giving me something to toil over at work, besides work ;)<br><br>I stuck a 'Delay 5' above 'Flip: Cls' and got the CPU usage down to 25%<br><br>Good luck with whatever project your using this meter in. Adios <br><br></td></tr></table><br>
<a name="356924"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klasix</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello PGF,<br><br>.1 it is.<br>Seems I have .01 imbedded on the brain.<br><br>As stated previously: Can divide 3600 images by 2/3/4/5/6/8/9/10/etc to get the screen res I want.  I don't 'need' 3600.  With 3600 I can 'start' at any given 1/3600th of a circle and increment my way around by extracting an offset from the selected '0' point.  Only have to write the file once.<br><br>A close look at an ani-file will show there is more going on that one would think.  Send you one if you would like.  Think the average screen has 96DPI so a 5" gauge would have ~480 pixels top to bottom.  3600/8 = 450 is as close as I can get with one pixel res.  Aliasing comes into play also (hence the differences in the ani-file).  A 6" tach with 360 degrees res is a bit jumpy.  On a 2.5" faced gauge it is fine (and a bit of overkill).  Hence the multi-res.  Change screen DPI and ...<br><br>Going through what every 'newbie' does I guess.  And yes .. I explore to find a products methods limitations/ features/etc.  Doing so I determine/derive/guess 'why' something doesn't work.  In this case .. too much info to write in X time.  But I know what to do if I don't need the speed :)<br><br>The 'math' approach is in queue and have the algo in hand.  <br>Next in line is comparing needle image at X degrees with one at X+1 and comparing the differences.  Store the 'difference in pixels' starting from 0 to max-X.  Array storage should be small and hopefully fast as a result.  Several drawbacks to the approach (can't jump from X to X+2).  Dunno if that is an issue till I try.  On to the math after that.<br><br>A digital readout will be implemented also.  As will a shift light for the drag racers.  You (well .. me anyway) can't shift with twirling numbers well.  Needle on number works.<br><br>Eikon .. thanks again.  Glad to .. mmmm 'help' with work :)  Your code was more compact than mine and probably work with the smaller/slower gauges just fine.  Implemented the delay same as you in both cases.  Same results .. which helped a lot !!<br><br>Take care all,<br>Jim <br><br></td></tr></table><br>
<a name="357432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PGF</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> klasix,<br><br>I doubt that I'll understand your intention and approach without seeing an image.  If you're happy with your current method then don't worry.  Otherwise please post or e-mail an example.<br><br>Otherwise we're probably misunderstanding each other.<br><br>Regards <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
