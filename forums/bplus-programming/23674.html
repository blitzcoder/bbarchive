<!DOCTYPE html><html lang="en" ><head ><title >Smooth scrolling in 2D</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Smooth scrolling in 2D</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Smooth scrolling in 2D</a><br><br>
<a name="244975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello! I am trying to create a 2D racing game, in Blitz 2D. To get the idea of movement, it scrolls tiles across the screen from top to bottom. The problem is the scrolling is not really smooth. I know this is a well known problem, getting the frame rate right and the scrolling smooth without relying on some monitor refresh rate.<br><br>In a single-screen game I used the following solution to make sure a character moved say 40 times a second:<br><br>I know how long each frame should take: 1/40th of a second. So I measure how long it actually takes, and from these two figures I compute a correction_factor, to get from the actual to the desired duration. <br><br>Now, normally the player moves every single frame. So I would (theoretically) count the frames (adding 1 to this framecounter each frame), and the player would move if the count reaches 1 (and the framecounter is reset to 0). To get the correct animation speed however, I do not simply add 1 every frame, but instead I add 1.0 * correction_factor.<br><br>Notice that of course I am using floats here as otherwise the small differences would be lost. I also take care not to reset the frames counter to 0, but instead to frames_counter-1.0, so as to keep the remainder.<br><br>So I use this method in my racing game.<br><br>However... when I link my scroller's location to the location of the player (to get a scrolling screen when the player moves) it can be seen that movement is not really smooth. What happens is that most of the time, the player is "allowed" to move in every single frame, but sometimes, the player is not allowed to move (due to "correction", the player has to skip a turn) and this is seen in the scrolling as a slight delay.<br><br>Here's the code that says whether the player may move:<br><br><pre class=code>
AItime = AItime + correct(g_fpsc,1.0)

If (AItime&gt;=1.0) Then
					
   player_move()
					
   AItime = AItime - 1.0
					
   DebugLog("&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!")
					
Else
				
   DebugLog("wait...")
				
End If
</pre><br><br>("AItime" counts the frames, "g_fpsc" is an object that computes the corrected value of the value that is passed in the function. So instead of counting 1 frame, the program counts, say, 0.9 frames if the game has to be slowed down.) I also print some debug info to show the effect:<br><br><pre class=code>
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
wait...
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
&gt;&gt;&gt;&gt;&gt;&gt;&gt; ACTION!
wait...
</pre><br><br>And so on. Writing this all down it seems quite obvious that this would result in jerky scrolling, as whenever it says "wait" in the debuglog, at that moment the car does not move.<br><br>Does anyone have ideas or experience in creating smooth scrolling in Blitz 2D, or comments on what I am doing here?<br><br>The above method I got through advice in another post if I remember correctly, but it could be that I applied it differently.<br><br>A thing that I could try is to use the "correction" method to change the amount by which the car moves (also suggested earlier by others). Right now I use integer amounts, but changing this to floats I could apply the correction factor to the car's speed. Maybe that still results in jerky scrolling, as in the end, movement is by whole pixels, but maybe the problem will be smaller. <br><br></td></tr></table><br>
<a name="244984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try Delta Time, <a href="http://www.blitzcoder.com/cgi-bin/articles/show_article.pl?f=gamemorduun03212002.html" target="_blank">http://www.blitzcoder.com/cgi-bin/articles/show_article.pl?f=gamemorduun03212002.html</a> <br><br></td></tr></table><br>
<a name="244994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, so what I am doing now is Morduun's method, instead that I didn't apply it to the speed of the car, but instead to the movement "turns" the car is assigned. Thanks for the link, it is a very clear description by Morduun. So I will try to use his method the way it was meant to be used (I don't know why I did not do that in the first place, maybe because it involves adjusting every speed or timing value used in the game and I thought I could avoid this "extra processing").<br><br>Thinking some more about it, using it on the speed of the objects will probably give better results especially with higher resolutions, as in that case the possible amount of variation is bigger; the speed could for instance be changed from 6 pixels to 5 pixels in a given frame, and this would not be very noticable in scrolling.<br><br>Do you use Delta Time in your Alpha Breed game? <br><br></td></tr></table><br>
<a name="245141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr Derek Doctors</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or just tell the user to set their DirectX refresh rate to 60fps using the DXDiag override option (every PC monitor in the world must be able to display 60fps so it's a safe rate) and set your game to 60fps. It's a trick I learned off of Simon Smith and it works a *treat*. <br><br></td></tr></table><br>
<a name="245203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Réno</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Here is my method. Sorry, I can't comment it because my english is not very good. But for my next game, I'll allow the player to chose the normal timming, or setting himself the monitor refresh at 60hz ( for the best smooth, like console-games ).<br><br><br><br>AppTitle "Test"<br>;/////////////////////////////////////////////////////////////////////////<br>Const ResolutionX%=640;X<br>Const ResolutionY%=480;Y<br>Const FPS#=60;images par secondes du jeu<br>;/////////////////////////////////////////////////////////////////////////<br>Graphics ResolutionX,ResolutionY,16<br>;*****************************************************<br>;*****************************************************<br>;Routine pour gerer le nombre d'image par secondes	**<br>;*****************************************************<br>Type Frame_Rate						;*****************<br>	Field TargetFPS#				;*****************<br>	Field FPS#						;*****************<br>	Field TicksPerSecond#			;*****************<br>	Field CurrentTicks#				;*****************<br>	Field FrameDelay#				;*****************<br>	Field SpeedFactor#				;*****************<br>	Field AccumTicks#				;*****************<br>End Type							;*****************<br>Global Target_FPS#=FPS#				;*****************<br>Global FL.Frame_Rate=New Frame_rate	;*****************<br>Frame_Limit_Init(Target_FPS)		;*****************<br>;*****************************************************<br>;*****************************************************<br><br>;image<br>Image=CreateImage(64,64)<br><br>;variable<br>ImageX#=0;X<br>ImageY#=32;Y<br>Acceleration#=0;acceleration<br>AccelerationBis%=0;acceleration bis<br><br>;/////////////////////////////////////////////////////////////////////////<br>;*****************<br>;* boucle du jeu *<br>;*****************<br>SetBuffer BackBuffer()<br>While Not KeyDown(1);tant que "echappe" n'a pas ete presse<br>;******************************************************<br>;Routine pour gerer le nombre d'image par secondes	***<br>;******************************************************<br>Gosub Set_Speed_Factor;								***<br>;******************************************************<br>ClsColor 255,0,255<br>Cls;efface le tampon<br><br>;FL\SpeedFactor=1;a utiliser si rafraichissement moniteur=60hz<br><br>;acceleration<br>If AccelerationBis=1 ImageX=(ImageX-(4*FL\SpeedFactor));gauche<br>If AccelerationBis=2 ImageX=(ImageX+(4*FL\SpeedFactor));droite<br><br>;dessine l'image<br>DrawBlock Image,ImageX,ImageY<br><br>;textes<br>Text 00,100,"ImageX "+ImageX<br>Text 00,110,"ImageY "+ImageY<br>Text 00,120,"AccelerationBis "+AccelerationBis<br><br>;mise a jour<br>AccelerationBis=0<br><br>;/////////////////////////////////////////////////////////////////////////<br>Flip;basculement des tampons<br>;/////////////////////////////////////////////////////////////////////////<br><br>;controleur<br>If KeyDown(203) AccelerationBis=1;gauche<br>If KeyDown(205) AccelerationBis=2;droite<br><br>;/////////////////////////////////////////////////////////////////////////<br>Wend<br>End<br><br>;**************************************************************************************<br>;**************************************************************************************<br>;Routine pour gerer le nombre d'image par secondes	***********************************<br>;**************************************************************************************<br>.Set_Speed_Factor																;**																		;**<br>	FL\CurrentTicks=MilliSecs()													;**<br>	FL\SpeedFactor=(FL\CurrentTicks-FL\FrameDelay)/(FL\TicksPerSecond/FL\TargetFPS)	;**<br>	If FL\SpeedFactor&lt;0 FL\SpeedFactor=0;ne doit pas etre negatif				;**<br>	If FL\SpeedFactor&gt;1 FL\SpeedFactor=1;ne permet pas au jeu de saccader		;**<br>	FL\FPS=FL\TargetFPS/FL\SpeedFactor											;**<br>	FL\FrameDelay=FL\CurrentTicks												;**<br>	Return																		;**<br>Function Frame_Limit_Init(target_FPS)											;**<br>	FL\TargetFPS=target_FPS														;**<br>	FL\TicksPerSecond=1000														;**<br>	FL\FrameDelay=MilliSecs()													;**<br>End Function																	;**<br>;**************************************************************************************<br>;************************************************************************************** <br><br></td></tr></table><br>
<a name="245234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's that about tampons? <br><br></td></tr></table><br>
<a name="245245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What's that about tampons? <br></div>French word for "plug", apparently. :) <br><br></td></tr></table><br>
<a name="245252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Réno</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Tampon"=buffer<br><br>:) <br><br></td></tr></table><br>
<a name="245273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Réno. That looks similar to the "Delta Time" method. I will look at it some more.<br><br>OK, maybe I'd better just open up Blitz and put his in my game. I am *so* lazy.<br><br>Let's do it! <br><br></td></tr></table><br>
<a name="245305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have added Delta Time to change the speed of the car, and now I do get quite smooth scrolling! Yippie. Thanks for pointing this out again. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
