<!DOCTYPE html><html lang="en" ><head ><title >Disable the blue highlighting for tabs?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Disable the blue highlighting for tabs?</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Disable the blue highlighting for tabs?</a><br><br>
<a name="489772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The way tabs highlight in a dark blue color whenever I move over one is really annoying me... I was wondering if anyone knew how to disable this?<br><br>Also, I think I saw someone post some kind of code that would send messages to gadgets to make them do certain things that were normally not supported, and there were a bunch of constants with it, and I thought that might contain something to disable this for tabs. <br><br></td></tr></table><br>
<a name="489776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ugh... It looks like there is no way to disable that property once it is enabled...<br><br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/tab/reflist.asp" target="_blank">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/tab/reflist.asp</a><br><br>Specifically, the property that Mark appears to have enabled for the tabs is "TCS_HOTTRACK", which causes whichever tab the mouse is hovering over to be highlighted blue.<br><br>The only way to fix this would be to create a tab control manually.  But I'm not sure if that would work with Blitz's event system or not. <br><br></td></tr></table><br>
<a name="489784"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want the XP orange highlight color instead you can place a manifest file in the same dir as your exe.<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=31503" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=31503</a><br><br>also you may want to try the GWL_STYLE option of the SetWindowLong command for altering a window's style (tabber uses WS_CHILD|WS_CLIPCHILDREN|TCS_FOCUSNEVER|TCS_HOTTRACK). <br><br></td></tr></table><br>
<a name="489802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um... SetWindowLong needs an int as a parameter.  If I do this, will Blitz automatically convert the longint to an int, or is it going to cause a memory leak or a crash or something?<br><br>SetWindowLong%(hWnd%, nIndex%, dwNewLong%):"SetWindowLong"<br><br>And if I can't do that, then how can I access this function?  Am I stuck because of limitations of how Blitz allows me to access DLLs?<br><br>Also, just where am I supposed to find the values for all these constants?  MSDN conveniently leaves the values out, and I keep having to search for them with google. <br><br></td></tr></table><br>
<a name="489803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried to access that functiin, but Blitz tosses up an error when I actually try to call the function in the program saying the user lib function is not found.  The compiler is obviously finding the entry, and I've spelled it right, so either the function name is different somehow in the dll itself, or it does not like the longint parameter where there should be an int... Hm... <br><br></td></tr></table><br>
<a name="489805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need access to the windows sdk for the constants, the files winuser.h and commctrl.h in particular.<br><br>Longs and ints are both 32 bit values in win32 so you should be fine.<br><br>From reading the notes in MSDN you might not see a style changes take effect until you resize the gadget.<br><br>/*<br> * Window Styles<br> */<br>#define WS_OVERLAPPED       0x00000000L<br>#define WS_POPUP            0x80000000L<br>#define WS_CHILD            0x40000000L<br>#define WS_MINIMIZE         0x20000000L<br>#define WS_VISIBLE          0x10000000L<br>#define WS_DISABLED         0x08000000L<br>#define WS_CLIPSIBLINGS     0x04000000L<br>#define WS_CLIPCHILDREN     0x02000000L<br>#define WS_MAXIMIZE         0x01000000L<br>#define WS_CAPTION          0x00C00000L     /* WS_BORDER | WS_DLGFRAME  */<br>#define WS_BORDER           0x00800000L<br>#define WS_DLGFRAME         0x00400000L<br>#define WS_VSCROLL          0x00200000L<br>#define WS_HSCROLL          0x00100000L<br>#define WS_SYSMENU          0x00080000L<br>#define WS_THICKFRAME       0x00040000L<br>#define WS_GROUP            0x00020000L<br>#define WS_TABSTOP          0x00010000L<br><br>#define WS_MINIMIZEBOX      0x00020000L<br>#define WS_MAXIMIZEBOX      0x00010000L<br><br><br>#define WS_TILED            WS_OVERLAPPED<br>#define WS_ICONIC           WS_MINIMIZE<br>#define WS_SIZEBOX          WS_THICKFRAME<br>#define WS_TILEDWINDOW      WS_OVERLAPPEDWINDOW<br><br><br>#if (_WIN32_IE &gt;= 0x0300)<br>#define TCS_SCROLLOPPOSITE      0x0001   // assumes multiline tab<br>#define TCS_BOTTOM              0x0002<br>#define TCS_RIGHT               0x0002<br>#define TCS_MULTISELECT         0x0004  // allow multi-select in button mode<br>#endif<br>#if (_WIN32_IE &gt;= 0x0400)<br>#define TCS_FLATBUTTONS         0x0008<br>#endif<br>#define TCS_FORCEICONLEFT       0x0010<br>#define TCS_FORCELABELLEFT      0x0020<br>#if (_WIN32_IE &gt;= 0x0300)<br>#define TCS_HOTTRACK            0x0040<br>#define TCS_VERTICAL            0x0080<br>#endif<br>#define TCS_TABS                0x0000<br>#define TCS_BUTTONS             0x0100<br>#define TCS_SINGLELINE          0x0000<br>#define TCS_MULTILINE           0x0200<br>#define TCS_RIGHTJUSTIFY        0x0000<br>#define TCS_FIXEDWIDTH          0x0400<br>#define TCS_RAGGEDRIGHT         0x0800<br>#define TCS_FOCUSONBUTTONDOWN   0x1000<br>#define TCS_OWNERDRAWFIXED      0x2000<br>#define TCS_TOOLTIPS            0x4000<br>#define TCS_FOCUSNEVER          0x8000 <br><br></td></tr></table><br>
<a name="489807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>

user32.decls:
.lib "user32.dll"
SetWindowLong%(hWnd%, nIndex%, dwNewLong%):"SetWindowLongA"

Function Test(Gadget)

	Local GWL_STYLE       = -16
	Local WS_CHILD        = $40000000
	Local WS_CLIPCHILDREN = $02000000
	Local TCS_FOCUSNEVER  = $8000
	
	Blah = SetWindowLong(QueryObject(Gadget, 1), GWL_STYLE, WS_CHILD Or WS_CLIPCHILDREN Or TCS_FOCUSNEVER)
	
End Function
</pre><br><br><br>I tried this, but it doesn't work.  I call it immediately after creating my tabber, and I then insert my tabs, reposition/resize it with setgadgetshape, and then attach a panel with a canvas inside it to the tabber.  <br><br>This used to work fine, but now the panel with canvas does not show up, and the tabber still highlights the tabs, as if to mock me. <br><br></td></tr></table><br>
<a name="489808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aha...  You forgot WS_VISIBLE.  The tabber needs that property too.  <br><br>But the tabber continues to mock me.  As I feared, the documentation that said you can only remove certain properties, not including the one I want to remove, was probably telling the truth...  The highlighted tabs still there. :-( <br><br></td></tr></table><br>
<a name="489812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try reading the window details (GetWindowLong IIRC) and combining the flags you want/don't want with that result.<br><br>You might also need to update/refresh the window afterwards (can't remember offhand). The <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/windowclasses/windowclassreference/windowclassfunctions/setwindowlong.asp" target="_blank">SetWindowLong</a> docs say something along these lines. <br><br></td></tr></table><br>
<a name="489819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Argh, this is so annoying.<br><br>BlitzSupport:<br>I took your advice and tried calling SetWindowPos to be sure, even though I thought the SetGadgetShape should be enough to trigger the change, but no dice.  The appearance of the tabber doesn't change.<br><br><pre class=code>
Function Test(Gadget)

	Local GWL_STYLE        = -16
	Local WS_CHILD         = $40000000
	Local WS_CLIPCHILDREN  = $02000000
	Local TCS_FOCUSNEVER   = $8000
	Local WS_VISIBLE       = $10000000
	Local HWND_TOP         = 0				; Place window at top of Z order.
	Local SWP_NOSIZE       = 1
	Local SWP_NOMOVE       = 2
	Local SWP_NOZORDER     = 4		
	Local SWP_FRAMECHANGED = 20
	
	Blah = SetWindowLong(QueryObject(Gadget, 1), GWL_STYLE, WS_CHILD Or WS_CLIPCHILDREN Or TCS_FOCUSNEVER Or WS_VISIBLE)
	Blah = SetWindowPos(QueryObject(Gadget, 1), HWND_TOP, GadgetX(Gadget), GadgetY(Gadget), GadgetWidth(Gadget), GadgetHeight(Gadget), SWP_NOMOVE Or SWP_NOSIZE Or SWP_NOZORDER Or SWP_FRAMECHANGED)	
	
End Function
</pre> <br><br></td></tr></table><br>
<a name="490099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> This was an aggravating bugger, but I finally figured it out after an hour of messing around. It turns out that calling QueryObject on the tabber only returns the client hwnd (the work area below the tabs), and not the handle to the tabber itself. Calling GetParent on the original hWnd fixes the problem.<br><pre class=code>
;SetWindowLong%(hWnd%,Val%,Long%):"SetWindowLongA"
;GetWindowLong%(hWnd%,Val%):"GetWindowLongA"
;GetParent%(hwnd%)

Function Test(Gadget)

	Local hWnd% = QueryObject(Gadget, 1)
	hWnd = GetParent(hWnd)
	
	Local GWL_STYLE        = -16
	Local TCS_HOTTRACK     = $40

	SetWindowLong hWnd, GWL_STYLE, GetWindowLong(hWnd, GWL_STYLE) - TCS_HOTTRACK

End Function
</pre> <br><br></td></tr></table><br>
<a name="491085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think you're supposed to use - when dealing with windows constants like that...  I think maybe you want to use AND NOT?  <br><br>In this case you know the TCS_HOTTACK is on, but if Mark turns it off in a future version of Blitz this code (as is)  could screw up all the properties of the tabber, I think. <br><br></td></tr></table><br>
<a name="491087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hm, well, AND (NOT TCS_HOTTRACK) just makes the tabber dissapear, and yours works, so I guess I'll use yours.  <br><br>But I'm not sure why that is. :-) <br><br></td></tr></table><br>
<a name="491088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tryed that but couldn't get it to work. Both of these fail:<br><br>GetWindowLong(hWnd, GWL_STYLE) And Not TCS_HOTTRACK<br>GetWindowLong(hWnd, GWL_STYLE) And (Not TCS_HOTTRACK)<br><br>How should I do it?<br><br>* Edit * Ok, cool :) <br><br></td></tr></table><br>
<a name="491094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> It appears that NOT in Blitzplus does not do a bitwise not.  It does a boolean NOT.<br><br>Try this:<br><br>TCS_HOTTRACK = $40<br>Print Not TCS_HOTTRACK<br>Waitkey()<br><br>Your result will be 0, which is clearly wrong for a bitwise NOT, and correct for a boolean NOT.  Any value other than 0 in boolean is TRUE, so here the boolean not sees Print NOT TRUE, which is FALSE, which is 0.<br><br>Is there any way to do a bitwise NOT in Blitzplus?  <br><br>If not, then you could just do this:<br><br>TCS_HOTTRACK     = %00000000000000000000000001000000<br>NOT_TCS_HOTTRACK = %11111111111111111111111110111111<br><br>Which comes out to -65 in decimal, which is $FFFFFFFFFFFFFF6F in hexadecimal.<br><br>Gonna test this now.... <br><br></td></tr></table><br>
<a name="491096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes that works, and will not break if Mark changes the tabber properties so they no longer include the hot tracking. :-)<br><br><pre class=code>
; Add to User32.decls:
;
; .lib "user32.dll"
; SetWindowLong%(hWnd%,Val%,Long%):"SetWindowLongA"
; GetWindowLong%(hWnd%,Val%):"GetWindowLongA"
; GetParent%(hwnd%)

Function RemoveTabberHottrack(Gadget)

	Local hWnd% = QueryObject(Gadget, 1)
	hWnd = GetParent(hWnd)
	
	Local GWL_STYLE        = -16
	Local TCS_HOTTRACK     = $40
	Local NOT_TCS_HOTTRACK = -65
	
	SetWindowLong(hWnd, GWL_STYLE, GetWindowLong(hWnd, GWL_STYLE) And NOT_TCS_HOTTRACK)

End Function
</pre><br><br><br>I'll stick this in the code archives now. :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
