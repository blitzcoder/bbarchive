<!DOCTYPE html><html lang="en" ><head ><title >Transparent Images</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Transparent Images</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Transparent Images</a><br><br>
<a name="1083918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I decided now that I have learned about circles and angles and Sin(), Cos(), Tan() and the rest (thanks to all that helped with that) I'm going to test my knowledge of them by making a space shooter similar in nature to Star Sonata (kinda) but i looked at my old flame and energy effects and they do not belong in space, actually they do not belong in any non-Sribblenauts type game. They have no transparency so it is only circles and rectangles changing sizes and colors before disappearing.<br><br>well you get my point I'm trying to learn the art of alpha channels and transparency. I am currently studying code archives examples and they seem far to slow to use in real time... is it possible to do real time transparency in B+ ? I am for the most part just trying to make rectangles, circles and lines appear to glow, fade out or fade in to (ontop of many different backgrounds and space ships) simulate lasers, fire, plasma and any other type of glowing energy your can think of...<br><br>any references/articles/books/code etc... that you guys have found that would help to learn how to make a real time transparency function would be great<br><br>btw I'm trying to learn how to do this not just have code that does it, I like understanding exactly how everything works in my code<br><br>Thanks Ahead of time <br><br></td></tr></table><br>
<a name="1083956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's always going to be slow in blitzplus, since it runs in 2d mode... you'll have to do the math, mix and draw pixel by pixel.<br><br>Years ago I came across a dll that could draw transparent sprite in blitzplus pretty fast, but I don't remember its name.<br><br>It's always going to be much slower in blitzplus than it would be in a language like blitzmax though, since that one uses 2d-in-3d, and can use the hardware acceleration of the videocard to do blending, scaling, rotating etc. <br><br></td></tr></table><br>
<a name="1083964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> hhhmmm okay, I was playing around with readpixel/writepixel (fast) and I noticed that I could make something transparent if I added a little to the color integer before drawing it (aiming for the alpha value in it)<br><br>is there a way to convert that integer into 4 different variables r,g,b,a so that I can edit them?<br><br> and one random off topic-ish question<br>is BlitzMax that good? I was thinking of getting Blitz3D because, well.....<br>3D &gt; 2D in most situations (and it can still do 2D anyway)<br>is BlitzMax &gt; Blitz3D ? <br><br></td></tr></table><br>
<a name="1083967"></a>

<a name="1083969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> is there a way to convert that integer into 4 different variables r,g,b,a so that I can edit them? <br></div><br><br>Yes:<br><pre class=code>a = (col And $FF000000) Shr 24
r = (col And $FF0000) Shr 16
g = (col And $FF00) Shr 8
b = col And $FF</pre><br>Use Or and Shl to combine them back into one integer.<br><br><div class="quote"> is BlitzMax that good? I was thinking of getting Blitz3D because, well.....<br>3D &gt; 2D in most situations (and it can still do 2D anyway)<br>is BlitzMax &gt; Blitz3D ? <br></div><br><br>Way to kick a hornet's nest...<br><br>The only real pro point for Blitz3D is that it's more or less the same language as BlitzPlus, so you wouldn't have to learn very much new. All of its other pros are evenly matched by BlitzMax.<br><br>BlitzMax on the other hand has a bunch more good points. The ones that really stand out from B3D are that it has native OO (I'm sure you knew that) which gives you some more options for structuring your programs, and a much, much better compiler so it produces optimised code (at least, pretty good... not sure how it compares to top-end optimisers but whatever). The breaking-changes are not that bad, and most of them are for the better anyway (e.g. it has a garbage collector; linked lists are no longer tied to types). Also, BlitzMax is $20 cheaper.<br><br>In truth in terms of 2D and 3D support they're actually pretty evenly matched - all the BlitzMax 3D engines except miniB3D can be used with Blitz3D as userlibs, and libs like Draw3D give Blitz3D the same 2D power as the Max2D engine. Although why you would get Blitz3D only to use a third-party 3D engine is beyond me (in fact, couldn't you do this in BlitzPlus too?).<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1083977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool I just found a similar (not as direct) example on the BlitzMax Forums... but since I have very little knowledge on how this works I can't figure out how to combine them after I edit them<br><br>how is (rgba Shr 16) And $FF) = 0<br>while rgba Shr 16 = 65280<br>and the original color integer was -16765441<br><br>what is $FF anyway?<br><br>btw my programming knowledge is quite newbish since I'm still in highschool so don't squish my brain &gt;_&lt; <br><br></td></tr></table><br>
<a name="1083980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, OK...<br><br>First thing: in BlitzPlus and Blitz3D, "And", "Or" and "Xor" are bitwise operations, not just logical (in BlitzMax there's a distinction between And and BitAnd, etc.). This means that it compares all 32 bits of an integer to produce a result value, not just "is that integer False or not?" which is what a logical operator would do.<br><br>So 1 And 2 = 0 because the 1 bit and the 2 bit don't overlap, meaning no bits are set in both numbers. 1 Or 2 = 3 because it combines the set bits from both.<br><br>Second thing: $012A4D is how you enter number in hexadecimal format. The compiler perceives this as an integer same as if it were written in decimal. You can also write in binary: %0100100110011. The reason we would want to do this is because the format may better represent the way we want to use the data: if a number is representing bitflags, for instance, binary is good because it shows exactly which bits are set. It's common to use hex for colours, because the four-byte integer divides perfectly into eight characters, two for each component, and they line up exactly with the bytes, which decimals don't.<br><br>So a colour is represented as four bytes, representing the four component values. They are arranged in a row. So this hopefully explains how the And extracts a value: col And $00FF0000 uses And to ignore the a, g and b bytes (where the mask value has no bits set) and grab all the data from the r byte ($FF is the highest value a single byte can hold, so all bits are set and therefore whatever was in the colour in that space will be reproduced in the result).<br><br>Because the red byte is two slots along, its actual numeric value is much higher than 255. Therefore we use the right shift operator to reduce it: move it 16 bits (or four letters) to the right quickly divides it by 65536. In this case it's easier to think of it as literally shoving the value over to the right hand side of the integer.<br><br>To invert this operation you need to not just swap the operators around, but use the opposite operation. Once you've got the value of a pixel, Shl shoves it back toward the left, to wherever it should be within the colour value, and then these "shoved" pixels are combined together with Or (since they only have data in non-overlapping bytes, Or will simply combine them all, as explained above).<br><br>Example:<br><br><pre class=code>col = (a Shl 24) Or (r Shl 16) Or (g Shl 8) or b</pre><br><br>(b is already at the right position and doesn't need to be shifted.) <br><br></td></tr></table><br>
<a name="1083981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> WOW, thats cool info thanks a ton <br><br></td></tr></table><br>
<a name="1083986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> um.... what is the alpha value in this for?????<br><br>it is always read as 255 no matter what you write it as <br><br></td></tr></table><br>
<a name="1084122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy_A</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's  a transparent sprite routine from the archives that updates a 191x36 sprite in 2-3ms.<br><br><a href="http://www.blitzmax.com/codearcs/codearcs.php?code=913" target="_blank">http://www.blitzmax.com/codearcs/codearcs.php?code=913</a><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;transparent sprites in b+ by ford escort
;
;Inner-loop optimizations and simple demo by Andy_A

AppTitle "transparent sprites"

;------this must be included before the functions call
Dim lookup#(255), img%(255), bkd%(255)
populate() ;&lt;- fills look-up table

Global sw=640,sh=480
Global hSprite%, bknd%

Graphics sw,sh,32,2
SetBuffer BackBuffer()
SeedRnd MilliSecs()

;create simple graphics
setUpGraphics()

bankPointer% = bufferize(hSprite%,1,0,0,0)

fntArial20% = LoadFont("Arial",20,True,False,False)
SetFont fntArial20%
Color 32,190,255

inc% = 5
blinkRate% = 64 ;&lt;-- blink rate in milliseconds
maskFlag% = 1   ;&lt;-- change to 0 for no masking
While MouseHit(1)=0
	Cls
	DrawBlock bknd,0,0
	x = MouseX()
	y = MouseY()
	sp% = MilliSecs()
	If st &lt; MilliSecs() Then
		st = MilliSecs() + blinkRate%
		pct% = pct% + inc%
		If pct% &gt; 95 Then inc% = -5
		If pct% &lt; 5 Then inc% = 5
	End If
	Text (320,445,"'Click' to exit.",True,False)
	alphasprite(bankPointer,x,y,pct%,maskFlag%)
	ep% = MilliSecs()-sp%
	Text (10,445,"ET: "+ep)
	Flip
Wend

FreeBank bankPointer%
FreeImage bknd%

End

;------------------------------------------------------
Function bufferize%(image%, flag%, rm%, gm%, bm%)
; this function converts a picture to an rgb coded memorybank
; set flag=1 to free the memory of the original image after 'bufferize-ing'
; rm,gm,bm rgb of the color mask (not drawn)
	Local w%, h%, bank%, rgbVal%, offset%, x%, y%, r%, g%, b%

	w=ImageWidth(image)		 		; get image width
	h=ImageHeight(image)		 		; get image height
	bank=CreateBank((w*h*3)+7)		; allot first 4 bytes to store the width and height
												; of the picture+3 For the mask
	LockBuffer ImageBuffer(image)	; lock the buffer to speedup things
	PokeShort(bank,0,w)				; store the image width
	PokeShort(bank,2,h)				; store the image height
	PokeByte(bank,4,rm)				; store the red   mask value
	PokeByte(bank,5,gm)				; store the green mask value
	PokeByte(bank,6,bm)				; store the blue  mask value
	rgbVal% = CreateBank(4)			; 4 byte bank stores value of ReadPixelFast()
	offset=7

	For y=0 To h-1
		For x=0 To w-1
			; read current pixel into rgbVal% bank
			PokeInt(rgbVal%, 0,ReadPixelFast(x,y, ImageBuffer(image)))
			; Store directly into bank (no SHIFTing! No ANDing! Very Fast!)
			PokeByte bank,offset,PeekByte(rgbVal%,2) ;store current pixel red value
			offset=offset+1
			PokeByte bank,offset,PeekByte(rgbVal%,1) ;store current pixel grn value
			offset=offset+1
			PokeByte bank,offset,PeekByte(rgbVal%,0) ;store current pixel blu value
			offset=offset+1
		Next
	Next
	UnlockBuffer ImageBuffer(image)
	If flag=1 
		FreeImage image
	End If
	FreeBank rgbVal%
	Return bank
End Function

;usage:
;
;
;===================	alphasprite(bank, xx, yy, percent, flag) =======================
;   bank : the handle of the bank containing the sprite (made with bufferize function)
;   xx,yy: onscreen coordinate where the sprite will be drawn
; percent: transparency percentage
;   flag : if set to 1 then mask color will not be drawn (same as maskimage)
;
;this draws the image previously saved in memory to x,y coords specified
;percent is the amount of opacity (0% = transparent, 100% = opaque)
;If flag=1 then masking color of memory saved image is NOT blended or drawn
Function alphasprite(bank%, xx%, yy%, percent%, flag%)
	Local buffer%, gtw%, gth%, w%, h%, rm%, gm%, bm%, pixRGB%
	Local i%, offset%, y%, x%, r1%, g1%, b1%, r2%, g2%, b2%
	
	;make sure percent is within valid range of 0 &lt;= percent &lt;= 100
	If percent &lt; 0 Or percent &gt; 100 Then percent = percent Mod 101
	
	buffer=GraphicsBuffer()
	gtw=GraphicsWidth()
	gth=GraphicsHeight()
	w=PeekShort(bank,0)
	h=PeekShort(bank,2)
	rm=PeekByte(bank,4)
	gm=PeekByte(bank,5)
	bm=PeekByte(bank,6)
	pixRGB% = CreateBank(4)	; 4 byte bank stores value of ReadPixelFast()

	; The bigger the image, the more cycles this saves
	; as long as the image is 8x16 (128 pixels) or larger
	For i = 0 To 255
		img%(i) = Floor( lookup(i) * percent )
		bkd%(i) = Floor( lookup(i) * (100-percent) )
	Next
	
	offset=7
	LockBuffer buffer
	For y=0 To h-1								
		For x=0 To w-1
			r2=PeekByte(bank,offset)		; r
			offset=offset+1						; g
			g2=PeekByte(bank,offset)		; b
			offset=offset+1						; values
			b2=PeekByte(bank,offset)		; of the
			offset=offset+1						; bufferized image
			If xx+x&lt;=gtw And yy+y&lt;=gth		; the coordinates are in the drawing buffer
				If flag=0 Or (flag=1 And r2&lt;&gt;rm Or g2&lt;&gt;gm Or b2&lt;&gt;bm); the flag =0 or the colors are not the masked colors
					; read the current pixel into pixRGB% bank
					PokeInt(pixRGB%, 0,ReadPixelFast(xx+x, yy+y, buffer))
					; store new rgb values into pixRGB% bank
					PokeByte(pixRGB%, 2, img(r2)+bkd(PeekByte(pixRGB%,2))) ;r1))
					PokeByte(pixRGB%, 1, img(g2)+bkd(PeekByte(pixRGB%,1))) ;g1))
					PokeByte(pixRGB%, 0, img(b2)+bkd(PeekByte(pixRGB%,0))) ;b1))
					;draw the alpha-blended pixel
					WritePixelFast xx+x, yy+y, PeekInt(pixRGB%,0), buffer
				End If			
			End If
		Next
	Next
	UnlockBuffer buffer
	FreeBank pixRGB%
End Function


;Create simple sprite and place random rect's on screen to see alpha effect
Function setUpGraphics%()
	Local fntArial36B%, textWide%, textHigh%
	Local i%, j%, k%, r%, g%, b%
	Local msg$
	Cls
	
	fntArial36B = LoadFont("Arial", 36, True,False,False)
	SetFont fntArial36B%
	msg$ = "Alpha-Sprite!" ;&lt;- place your own message here
	txtWide% = StringWidth(msg$)
	txtHigh% = StringHeight(msg$)
	hSprite% = CreateImage(txtWide%, txtHigh%)
	Color 255, 255, 255 ;set color of text
	Text 100, 100, msg$
	GrabImage(hSprite%, 100, 100)

	Cls
	For i% = 1 To 400
		r% = Rand(0,192)
		g% = Rand(0,176)
		b% = Rand(0,255)
		Color r%, g%, b%
		j% = Rand(-50,540)
		k% = Rand(-50,380)
		Rect j%, k%, Rand(60,150), Rand(60,150),True
		Color 255-r%, 255-g%, 255-b%
		j% = Rand(-50,540)
		k% = Rand(-50,380)
		Oval j%, k%, Rand(60,150), Rand(60,150),True
	Next
	Color 0,0,0
	Oval 240,435,160,40
	
	SetBuffer BackBuffer()
	
	;create image buffer the size of current window
	bknd% = CreateImage(GraphicsWidth(), GraphicsHeight())
	;grab what's on the screen and store in image buffer
	GrabImage(bknd%, 0, 0)
	
	FreeFont fntArial36B%
End Function

; fill the look-up table with float values
Function populate()
	For a=0 To 255
		lookup#(a)=Float(a)/100.0
	Next
End Function</textarea> <br><br></td></tr></table><br>
<a name="1084171"></a>

<a name="1084183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> hhmm I read that earlier... it was very confusing as to how he did it though<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1084172"></a>

<a name="1084182"></a>

<a name="1084184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >InvincibleWall</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> thx for all the help guys<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1085795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mv333</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Years ago I came across a dll that could draw transparent sprite in blitzplus pretty fast, but I don't remember its name. <br></div><br><br>I think you're talking about the Extended B2D dll. I tried it over a year ago, and it worked great. The version i have is 1.60, i think that's the last one that came out. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
