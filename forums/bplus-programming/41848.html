<!DOCTYPE html><html lang="en" ><head ><title >Array Search Function Problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Array Search Function Problem</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=81" >BlitzPlus Programming</a>/<a href="#bottom" >Array Search Function Problem</a><br><br>
<a name="469645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The purpose of the following Function is to search the 25x1 array A$ (with a 0 in the second array dimension) for the entry specified in on$, and return a 1 if it is there, and a 0 if it isnt<br><br>Function SearchAnims(on$)<br>	While Not (TNum = 26 And oncheck$ = on$)<br>		oncheck$ = A$(TNum, 0)<br>		TNum = TNum + 1<br>	Wend<br>	If TNum = 26 Then<br>		Return 0<br>	Else<br>		Return 1<br>	EndIf<br>End Function<br><br>The function doesnt do that however, it used to return a 0 weather the entry was present or not until I added the $ signs to on$ and oncheck$, now it complains about the array element being out of bounds<br><br>Any help would be much apreciated <br><br></td></tr></table><br>
<a name="469669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know if it will fix it but<br><br> While Not (TNum = 26 And oncheck$ = on$) <br><br>should be<br><br> While Not (TNum = 26 Or oncheck$ = on$) <br><br></td></tr></table><br>
<a name="469787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this for a smaller function ...<br><br>Function SearchAnims(on$) <br>For TNum = 0 To 25<br>	If A$(TNum, 0) = on$ Then Return 1<br>Next<br>Return 0<br>End Function <br><br></td></tr></table><br>
<a name="469792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thx for the help but somethings still wrong, it could be one of the other asociated functions, guess I'll have to do some more testing<br><br>Thx anyway <br><br></td></tr></table><br>
<a name="469802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, its time to give a larger description of whats going on<br><br>I have 4 functions aimed at managing animations, for this particular animation I am testing with I have to use individual image variables for each frame, there is no getting around that<br><br>The details of an animation are stored in 2 arrays, A$(25,1) for 2 strings allowing me to identify the animation and AN(25, 2) in which the second dimension is set out as follows:<br><br>0: Millisecs between frame updates<br>1: Millisecs() on last update<br>2: Current frame number<br><br>To add an animation to the arrays I call this finction:<br><br>Function SetAnim(on, what, speed)<br>	A$(ANum, 0) = on<br>	A$(ANum, 1) = what<br>	AN(ANum, 0) = speed<br>	AN(ANum, 1) = MilliSecs<br>	ANum = 0<br>	While Not A$(ANum, 0) = ""<br>		ANum = ANum + 1<br>	Wend<br>End Function<br><br>The test animation is a simple 4 frame walking animation for when the player is walking south, when this happens the above function is called with:<br><br>SetAnim("Char1", "S", 2000)<br><br>the last number is large for testing purposes, but how big or small it is doesnt seem to make a difference<br><br>Another function checks which animations are stored in the array, updates them if neccessary, and draws them to the screen, the function is called at the end of a loop that runs constantly and is present for the express purpose of running check functions, other routines in the loop all work as they should, currently only the walking animation is present in the function<br><br>Function PlayAnims()<br>	For CNum = 0 To 25<br>		If Not A$(CNum,0) = ""<br>			If MilliSecs() &gt; AN(CNum,0) + AN(CNum,1) Then<br>				AN(CNum,2) = AN(CNum,2) + 1<br>				AN(CNum,1) = MilliSecs()<br>			EndIf<br>			If A$(CNum,0) = "Char1" Then<br>				If A$(CNum,1) = "S" Then<br>					DrawRoom<br>					If AN(CNum, 2) = 0 Then DrawImage Orient40, 32*LOCX+129, 32*LOCY+65<br>					If AN(CNum, 2) = 1 Then DrawImage Orient4, 32*LOCX+129, 32*LOCY+73<br>					If AN(CNum, 2) = 2 Then DrawImage Orient41, 32*LOCX+129, 32*LOCY+81<br>					If AN(CNum, 2) = 3 Then DeleteAnim(CNum)<br>				EndIf<br>			EndIf<br>		EndIf<br>	Next<br>End Function<br><br>The other functions called here are:<br>Drawroom:- Draws the current background to the screen and the players sprite if he is stationary<br>DeleteAnim:- Removes an animation from the arrays<br><br>Function DeleteAnim(Num)<br>	For I = 0 To 1<br>		A$(Num,I) = ""<br>	Next<br>	For I = 0 To 2<br>		AN(Num,I) = 0<br>	Next<br>End Function<br><br>In order to be useful the stationary sprites are not drawn if a "Char1" animation is present in the array, this is done with SearchAnim, thanks greyalien for the smaller code<br><br>Function SearchAnims(on$)<br>	For TNum = 0 To 25<br>		If A$(TNum, 0) = on$ Then Return 1<br>	Next<br>	Return 0<br>End Function<br><br>In Drawroom, SearchAnims is called like this:<br><br>K = SearchAnims("Char1")<br>If K = 0<br>Select Orientation<br>Case 1<br>DrawImage Orient1, X, Y<br>Case 4<br>DrawImage Orient4, X, Y<br>Case 2<br>DrawImage Orient2, X, Y<br>Case 3<br>DrawImage Orient3, X, Y<br>End Select<br>Else<br>Stop<br>EndIf<br><br>And here lies the problem, SearchAnim NEVER returns a 1, if it did the Else statement would be called and the program would stop, the strange thing is that even with it returning 0s the stationary image Orient4 is not drawn<br><br>Assuming that SearchAnims works, it would mean that the animation was removed from the arrays before being searched for, but I dont see how thats possible<br><br>Any help at all would be immensely apreciated <br><br></td></tr></table><br>
<a name="471113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for the delay, I think the problem is your function<br>Function SetAnim(on, what, speed) <br>because you have not specified the variable types Blitz assumes they are integers.  You should put a $ sign after the strings as follows:<br>Function SetAnim(on$, what$, speed)<br>Without them your array won't have "Char1" in it, it'll have some number (I don't know what). You could put a STOP in your code and run it in debug mode, this would tell you what the duff values are, but why bother if my suggestion fixes it!<br><br>Good Luck <br><br></td></tr></table><br>
<a name="471569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the help<br><br>It works now :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
