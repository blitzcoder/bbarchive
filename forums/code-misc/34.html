<!DOCTYPE html><html lang="en" ><head ><title >Format$ (number,digits [,places])</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Format number with aligned digits and fixed decimal field, language=bb, category=Miscellaneous'><meta name='author' content='DJWoodgate'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=9>Miscellaneous</a>/Format$ (number,digits [,places])</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="34.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Format$ (number,digits [,places]) by DJWoodgate</td><td align="right">2002 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Will return number string right aligned with spaces on the decimal point which is optional. A number too big for field will return asterisks. Number is rounded as required.<br>Version 1.1 which corrects an unnecessary use of fuziness correction, but more work is probably needed :)<br>Version 1.2 Fixed an error or two.<br>Version 1.3 Check for overflow. A bmax version added. </td></tr><tr ><td class="cell"><pre class="code">SeedRnd MilliSecs()
For c=1 To 20
x#=Rnd(-100000000,100000000)/Rnd(1000)
Print "Formatted: "+format$(x,6,4)+ " Unformatted: "+x#
Next
waitkey()


Function format$(v#,d,p=0) ; format a number
Local m$, e$, r$,  n,  x#=Abs(v)
If p&gt;0 Then m$=Int((x-Floor(x))*10^p) : e$="."+Right$("000000"+m$,p)
If p=0 Or Len(m$)&gt;p Then n=Int(x) Else n=Floor(x)
If v&lt;0 Then r$="-"+n Else r$=n 
If Len(r$)&gt;d or n&lt;0 Then r$=String$("*",d): If p&gt;0 Then e$="."+String$("*",p)
Return RSet$(r$,d)+e$
End Function

'---------Bmax version of function -----------------
Function format$(v!,d,p) ' bmax format a number
Local m$, e$, r$,  n:Long,  x!=Abs(v)
If p&gt;0 Then m$=Long((x-Floor(x))*10^p+0.5!) ; e$="."+Right$("000000000000000000"+m$,p)
If p=0 Or Len(m$)&gt;p Then n=Long(x+0.5!) Else n=Long(x)
If v&lt;0 Then r$="-"+n Else r$=n 
If Len(r$)&gt;d Or n&lt;0 Then 
	r$=left$("*******************",d)
	If p&gt;0 Then e$="."+left$("*******************",p)
Endif	
Return RSet$(r$,d)+e$
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>2014</font></td></tr></table></td></tr><tr ><td class="posttext"> I caught this thing making a solitary mistake - 1 number's post decimal place value was 1 digit short for some reason-<br>unfortunately, I cannot remember the number to reproduce the error.<br>It must be a RARE quirk. <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
