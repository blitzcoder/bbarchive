<!DOCTYPE html><html lang="en" ><head ><title >Julian Days conversion</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Very useful for day calculations, language=bb, category=Miscellaneous'><meta name='author' content='Imphenzia'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=9>Miscellaneous</a>/Julian Days conversion</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="451.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Julian Days conversion by Imphenzia</td><td align="right">2002 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> This is a simple method of converting Blitz dates into "Julian Days". Using this format you can convert any two dates into Julian Days and then simply substract the two resulting numbers to get the number of days between those dates without having to worry about days per month, leap years and all the rest! Can for example be used for calculating trial periods. </td></tr><tr ><td class="cell"><pre class="code">Dim Months$(12)
Months(1)="JAN":Months(2)="FEB":Months(3)="MAR":Months(4)="APR":Months(5)="MAY":Months(6)="JUN": Months(7)="JUL": Months(8)="AUG": Months(9)="SEP": Months(10)="OCT": Months(11)="NOV": Months(12)="DEC"

Print "Days between today and 23 Aug 2008: " + (JulianDays("23 AUG 2008") - JulianDays(CurrentDate()))

Function FindMonth(fm$)
  For i=1 To 12
  If Upper(fm$)=months$(i) Then Return i
  Next
End Function

Function JulianDays(txt$)
  d=Int(Left(txt$,2))
  m=Int(FindMonth(Mid(txt$,4,3)))
  y=Int(Right(txt$,4))
  jd=( 1461 * ( y + 4800 + ( m - 14 ) / 12 ) ) / 4 + ( 367 * ( m - 2 - 12 * ( ( m - 14 ) / 12 ) ) ) / 12 - ( 3 * ( ( y + 4900 + ( m - 14 ) / 12 ) / 100 ) ) / 4 + d - 32075
  Return jd
End Function</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TAS</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> The code below is public domain and is used to convert a Blitz date string to MS Excel type date number (1/1/1900 =day 1) and back.<br><br><br>Function E2Day$(ed)<br><br>	y%=Floor(ed/365.25)<br>	r%=ed-Floor(y*365+Floor((y+3)/4))<br>	Y=Y+1900<br><br>	m=Int(r/30)<br>	If (r-m*30)&lt;1 Then m=m-1<br>	<br>	If (y Mod 4) =0 Then<br>		;leap year <br>		If r&lt;32 Then<br>			Return Str$(r)+" JAN "+Y<br>		ElseIf r&lt;61<br>			Return Str$(r-31)+" FEB "+Y<br>		ElseIf r&lt;92<br>			Return Str$(r-60)+" MAR "+Y<br>		ElseIf r&lt;122<br>			Return Str$(r-91)+" APR "+Y<br>		ElseIf r&lt;153<br>			Return Str$(r-121)+" MAY "+Y<br>		ElseIf r&lt;183<br>			Return Str$(r-152)+" JUN "+Y<br>		ElseIf r&lt;214<br>			Return Str$(r-182)+" JUL "+Y<br>		ElseIf r&lt;245<br>			Return Str$(r-213)+" AUG "+Y<br>		ElseIf r&lt;275<br>			Return Str$(r-244)+" SEP "+Y<br>		ElseIf r&lt;306<br>			Return Str$(r-274)+" OCT "+Y<br>		ElseIf r&lt;336<br>			Return Str$(r-305)+" NOV "+Y<br>		ElseIf r&lt;367<br>			Return Str$(r-335)+" DEC "+Y<br>		Else<br>			Return "LERROR"<br>		EndIf<br>	Else<br>		If r&lt;32<br>			Return Str$(r)+" JAN "+Y<br>		ElseIf r&lt;60<br>			Return Str$(r-31)+" FEB "+Y<br>		ElseIf r&lt;91<br>			Return Str$(r-59)+" MAR "+Y<br>		ElseIf r&lt;121<br>			Return Str$(r-90)+" APR "+Y<br>		ElseIf r&lt;152<br>			Return Str$(r-120)+" MAY "+Y<br>		ElseIf r&lt;182<br>			Return Str$(r-151)+" JUN "+Y<br>		ElseIf r&lt;213<br>			Return Str$(r-181)+" JUL "+Y<br>		ElseIf r&lt;244<br>			Return Str$(r-212)+" AUG "+Y<br>		ElseIf r&lt;274<br>			Return Str$(r-243)+" SEP "+Y<br>		ElseIf r&lt;305<br>			Return Str$(r-273)+" OCT "+Y<br>		ElseIf r&lt;335<br>			Return Str$(r-304)+" NOV "+Y<br>		ElseIf r&lt;366<br>			Return Str$(r-334)+" DEC "+Y<br>		Else<br>			Stop<br>			Return "NLERROR"<br>		EndIf<br>	EndIf<br><br>End Function<br><br><br>Function EDATE(txt$)<br>	;Calculates a EXCEL type "Julian Date"<br>	;day 1 = 1/1/1900<br>  	;assumes DD_MMM_YYYY<br>  	d=Int(Left(txt$,2))<br>  	m=Int(FindMonth(Mid(txt$,4,3)))<br>  	y=Int(Right(txt$,4))	<br><br>	If y&gt;1899 Then <br>		y=y-1900<br>	ElseIf y&gt;99 Then<br>		Return 0<br>	Else<br>		Return 0<br>	EndIf<br>		<br>	;(y+3)/4 adds leap day 		<br>	r%=d+y*365+Floor((y+3)/4)<br>	<br>	If (y Mod 4)=0 Then <br>		;extra day if leap year and month is not Feb or Jan<br>		If m&gt;2 Then r=r+1<br>	EndIf<br>	<br>	Select m<br>	Case 1  :Return r<br>	Case 2  :Return r+31<br>	Case 3  :Return r+59<br>	Case 4  :Return r+90<br>	Case 5  :Return r+120<br>	Case 6  :Return r+151<br>	Case 7  :Return r+181<br>	Case 8  :Return r+212<br>	Case 9  :Return r+243<br>	Case 10 :Return r+273<br>	Case 11 :Return r+304<br>	Case 12 :Return r+334<br>	Default :Return 0<br>	End Select<br><br>End Function<br><br><br>Function FindMonth(fm$)<br>	Select Upper$(fm$)<br>	Case "JAN": Return 1<br>	Case "FEB": Return 2<br>	Case "MAR": Return 3<br>	Case "APR": Return 4<br>	Case "MAY": Return 5<br>	Case "JUN": Return 6<br>	Case "JUL": Return 7<br>	Case "AUG": Return 8<br>	Case "SEP": Return 9<br>	Case "OCT": Return 10<br>	Case "NOV": Return 11<br>	Case "DEC": Return 12<br>	Default<br>		Return 0<br>	End Select<br>End Function <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
