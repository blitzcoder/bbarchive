<!DOCTYPE html><html lang="en" ><head ><title >Print an image</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='How to print an image without a DLL/API, language=bb, category=Miscellaneous'><meta name='author' content='Kuron'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=9>Miscellaneous</a>/Print an image</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="1429.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Print an image by Kuron</td><td align="right">2005 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> If you just need to print a simple image that will fit on a normal sized piece of paper, you do not need to use a DLL or API calls.<br><br>MS Paint allows command line options. You can run MS Paint from the command line with the Print switch and it will print the image directly to the default printer without opening MS Paint. <br><br>You need to grab the directory for MS Paint (system/system32, etc) and grab the directory that the image you want to print is in and the file name, then add the "/p" switch. </td></tr><tr ><td class="cell"><pre class="code">ExecFile ("c:\windows\system32\mspaint.exe c:\tik.bmp /p")</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pedro</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> shorter !<br><pre class=code>
ExecFile "c:\tik.bmp"
</pre><br>Automatically windows find the program linked to bmp extansion and open it =&gt; it is like a double click on the file.<br><br>Works with all the files ... <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mystik</td><td align="right"><font class=tiny>2005</font></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  shorter !<br><br>ExecFile "c:\tik.bmp"<br><br> <br><br>Automatically windows find the program linked to bmp extansion and open it =&gt; it is like a double click on the file.<br><br>Works with all the files ...<br> <br></div><br><br>The first example prints the picture by opening mspaint in the background. Your shorter one just loads the picture into whatever program is currently associated with .bmp<br><br><br>Steve. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zcbeaton</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> Clever. I'd never have suspected it.<br><br>But, Pedro, yeah, that only opens the file, it doesn't actually print it. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> Major problem: Many, MANY systems don't store mspaint.exe in the c:\windows\system32 folder.<br><br>Probably about a 3rd of the windows installs out there are in c:\winnt\ , for starters.<br>In addition windows doesn't even need to be installed on C:\, it can be any driver letter...<br><br>You can do some damage control, and increase the chances of it being correct by calling it like this:<br><br><pre class=code>ExecFile (GetEnv$("windir")+"\system32\mspaint.exe c:\tik.bmp /p")</pre><br><br>You really ought to make sure that the mspaint.exe program even exists though, because it won't always be present either. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> or even simpler:<br><pre class=code>ExecFile ("mspaint.exe c:\tik.bmp /p")</pre><br>;) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Major problem: Many, MANY systems don't store mspaint.exe in the c:\windows\system32 folder. <br></div>Duh, thats why I said:<br><br><pre class=code>You need to grab the directory for MS Paint (system/system32, etc) and grab the directory that the image you want to print is in and the file name, then add the "/p" switch.</pre><br><br>Because MS Paint is not always in the same location and is not always installed.  Use error checking when you grab the location for MS Paint.  If MS Paint doesn't exist, then don't print the image ;c) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> maybe a simple function like<br><br><pre class=code>

Function MSPaint_Print(file$)
	App_Dir$=SystemProperty("systemdir")+"mspaint.exe"
	If FileType(app_dir)=1
		ExecFile( App_Dir+file+"/p")
		Return True
	Else
		Return False
	EndIf
End
</pre><br>could solve the problem. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ThePict</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Would the same thing work with Notepad for printing text or ASCII files? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ShadowTurtle</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> you can save the text as bitmap and run the MSPaint_Print function :) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> zombie thread :P<br>I'm not sure if something like notepad would accept the '/p' switch in its command-line arguments and actually print a text file... <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>2010</font></td></tr></table></td></tr><tr ><td class="posttext"> Notepad doesn't print here on XP when I use the /p switch. <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
