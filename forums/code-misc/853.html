<!DOCTYPE html><html lang="en" ><head ><title >HasFocus()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='This function tells you if your game window currently has focus., language=bb, category=Miscellaneous'><meta name='author' content='sswift'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=9>Miscellaneous</a>/HasFocus()</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="853.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >HasFocus() by sswift</td><td align="right">2003 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> This function tells you if your game has been tabbed out of.  It should work in all versions of Blitz, it has been tested in Blitz 3D.<br><br>All you need to do is take the code below, and place it in a text file in your userlibs directory, and name it "user32.decls".  The function will then be available for you to use, and you don't even need to include a DLL with your game, or put the user32.dll in the userlib folder, because it's part of Windows.<br><br>I reccomend that you use code similar to the following to pause your game:<br><br>		If Not HasFocus()												; If the game lost focus...<br>	<br>			Repeat														; Pause the game until focus has been regained.<br>				Delay(100) 												; Using delay dramatically reduces the amount of CPU power the game uses!<br>			Until HasFocus()	<br>	<br>			Time_Now = MilliSecs()									; Correct the time.  <br>			<br>		EndIf<br><br><br>Note how I reset Current_Time.  Current_Time contains the time the current frame started.  I need to reset this value, because otherwise upon returning to the game, it would think that the last frame took several seconds, minutes, or even hours to render, and everyhting in the game would be moved accoridngly, which would wreak havoc.  This way, the game thinks no time passed at all.  Of course there are even better ways to handle this situation which would take into account the possiblity of the millisecond timer wrapping while your game is paused, but as most people don't even worry about that with their regular timing routines, I think this is good enough.<br><br>PS: <br>Thanks go to Fredborg for this function! </td></tr><tr ><td class="cell"><pre class="code">; User32.decls

; Place in your Blitz Userlibs folder

.lib "user32.dll"

HasFocus%():"GetActiveWindow"</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WildCat</td><td align="right"><font class=tiny>2009</font></td></tr></table></td></tr><tr ><td class="posttext"> It seems to not work within debug mode. Or if I do something wrong? <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>2013</font></td></tr></table></td></tr><tr ><td class="posttext"> Not sure what the hell this code is meant to achieve, but the code below is what I'm currently using to recover from an alt-tab.<br><br><pre class=code>
; Requires:-
; user32.decls - <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1179" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1179</a>

; Place this file into your Blitz3D 'userlibs' folder (eg. C:\Program Files (x86)\Blitz3D\userlibs).

;------

; Place the code below at the top of your main loop.
; InitializeInputAndGraphics and SyncTiming functions will need to be provided by you.

; If an alt-tab occurred then re-synchronize the input and timing.
If api_GetActiveWindow() &lt;&gt; G_app_handle
	While api_GetActiveWindow() &lt;&gt; G_app_handle : Delay( 20 ) : Wend
	; -- Perform the re-synchronization functions you would normally perform after coming back from a pause here.
	InitializeInputAndGraphics
	SyncTiming
	;------
EndIf
</pre> <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
