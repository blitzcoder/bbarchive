<!DOCTYPE html><html lang="en" ><head ><title >Function Roman$</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Convert number to Roman Numerals, language=bb, category=Miscellaneous'><meta name='author' content='DJWoodgate'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=9>Miscellaneous</a>/Function Roman$</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="33.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Function Roman$ by DJWoodgate</td><td align="right">2001 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Two functions by me to convert a string to roman numerals and display it.  The display routine is a bit corny, but you could covert it to use a bitmap font of your own devising for a more professional effect. </td></tr><tr ><td class="cell"><pre class="code">; Returns a string with the Roman numerals for value v
; This will Not be accurate for numbers > 3999 as the number
; 5000 should be represented as an M with a line above it etc, however as we
; do not have such a character I have used N, O, P.. etc for larger numbers, but see printroman...
Function roman$(v%)
	r$="IVXLCDMNPQRSTUWYZ"
	n$=v : i=Len(n$)*2-1
	For x=1 To Len(n$)
		d=Mid$(n$,x,1)
		Select d
		Case 1,2,3	: rom$=rom$+String$(Mid$(r$,i,1),d)
		Case 4		: rom$=Rom$+Mid$(r$,i,1)+Mid$(r$,i+1,1)
		Case 5		: rom$=rom$+Mid$(r$,i+1,1)
		Case 6,7,8	: rom$=rom$+Mid$(r$,i+1,1)+String$(Mid$(r$,i,1),d-5)
		Case 9		: rom$=rom$+Mid$(r$,i,1)+Mid$(R$,i+2,1)
		End Select
		i=i-2
	Next
	Return rom$
End Function

; Print Roman characters in graphics mode to x,y
; Uses character mapping from roman$() to produce
; M with bars for large numbers.  It all gets a bit
; silly if numbers are realy large however.
; Works best with larger font sizes
Function Printroman(r$,x,y)
h=StringHeight("M"):w=StringWidth("M")
Locate x,y
For s=1 To Len(r$)
	t$=Mid$(r$,s,1)
	p=Instr("NPQRSTUWYZ",t$,1)
	If p>0
		x=x+w
		Write "M"
		For l=1 To p
			Locate x-w+w/5,y-(l-1)*h/10
			Write "¯"
		Next
		Locate x,y
	Else
		x=x+StringWidth(t$)
		Write t$
	End If
Next
End Function
</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
