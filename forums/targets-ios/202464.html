<!DOCTYPE html><html lang="en" ><head ><title >optimising PNGs for iOS</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >optimising PNGs for iOS</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=505" >iOS</a>/<a href="#bottom" >optimising PNGs for iOS</a><br><br>
<a name="2024385"></a>

<a name="2024386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anatol</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I just came across some useful information which I think is worth sharing: XCode automatically optimises PNGs in the build process for iOS (e.g. for App icons), but this optimisation doesn't seem to apply to PNGs in main.build/ios/data which is a copy of the main.data folder.<br><br>Just to be clear, the optimisation is not about file sizes (for file sizes check this thread instead: <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=253" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=253</a> ); in fact the file size of your PNGs will most likely increase. However, XCode optimisation will do some byte swapping and pre-multiply alpha. For a reason that I fail to understand iOS uses BGR instead of RGB, hence the byte swapping. And then it pre-multiplies alpha to the BGR colour values (which I guess is why the file size increases). The advantage of using this optimisation method is that this byte-swapping and pre-multiplying happens at build-time, not at run-time and you may get a performance gain.<br><br>Be aware that these optimised PNGs are no longer "valid" PNGs that follow the PNG standard, so they will be largely useless for image-manipulation or any non iOS platform including Mac OS. So if you want to read on and optimise your PNGs make sure that you don't accidentally corrupt all your source images.<br><br>It's very straightforward to batch-optimise all PNGs in either your main.data or build/ios/data folder (if you optimise the latter you'll have to do this after every build in Monkey). At the moment I simply copy my entire Monkeycode project folder and apply any optimisations to that folder.<br><br>To batch-optimise an entire folder you can simply run this command on a Mac<br><pre class=code>
/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/iphoneos-optimize /path/to/my/project/main.data
</pre><br>For individual files use /path/to/an/image.png<br><br>This will replace the original files with the optimised yet 'corrupt' PNG!<br><br>iphoneos-optimize is a customised version of pngcrush. Instead of the command above you could also use<br><pre class=code>
/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/pngcrush -iphone -f 0 /path/to/image.png /path/to/optimised.png
</pre><br>This gives you the option to make a copy of the original.<br><br>If PNGs seem corrupt and the icon is blank then they are optimised :)<br><br>Test and see if you get a performance gain.<br><br>A more precise explanation can be found at <a href="http://iphonedevelopment.blogspot.co.nz/2008/10/iphone-optimized-pngs.html" target="_blank">http://iphonedevelopment.blogspot.co.nz/2008/10/iphone-optimized-pngs.html</a><br><br>Cheers!<br>Anatol <br><br></td></tr></table><br>
<a name="2024397"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, that should be useful! <br><br></td></tr></table><br>
<a name="2024426"></a>

<a name="2024427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matt</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can get a QuickLook plugin to view these crushed/byte-swapped PNGs<br><br><a href="http://www.quicklookplugins.com/2012/02/09/image-dimensions-and-file-size-in-ql-title-bar/" target="_blank">http://www.quicklookplugins.com/2012/02/09/image-dimensions-and-file-size-in-ql-title-bar/</a><br><br>As Anatol says, works well with my PNGenie app. <br><br></td></tr></table><br>
<a name="2024422"></a>

<a name="2024423"></a>

<a name="2024424"></a>

<a name="2024425"></a>

<a name="2024435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> indeed file size increased a bit (5-10%), but load speed increased too, about 1s, drop to 4.2s from 5.2s.<br><br>Thanks for the tip! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
