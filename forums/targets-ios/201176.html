<!DOCTYPE html><html lang="en" ><head ><title >Need help with InApp Purchase module</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need help with InApp Purchase module</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=505" >iOS</a>/<a href="#bottom" >Need help with InApp Purchase module</a><br><br>
<a name="2010359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi <br>I am a bit stuck with In App Purchase module. I found (it was recommended to me) a framework that handles IAP:<br><br>http://blog.mugunthkumar.com/coding/introducing-mkstorekit-&amp;#8211;-version-3/<br><br>I am trying to wrap it, but without success. I merged MKStoreKit files into one cpp file that is imported into my module, but during compile time I get some errors that I don't know how to fix them:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'void -[MKStoreObserver failedTransaction:](MKStoreObserver*,
objc_selector*, SKPaymentTransaction*)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2695:
warning: 'MKStoreManager' may not respond to '-transactionCanceled:'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2695:
warning: (Messages without a matching method signature
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2695:
warning: will be assumed to return 'id' and accept
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2695:
warning: '...' as arguments.)
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'void -[MKStoreObserver
completeTransaction:](MKStoreObserver*, objc_selector*,
SKPaymentTransaction*)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2703:
warning: 'MKStoreManager' may not respond to
'-provideContent:forReceipt:'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'void -[MKStoreManager buyFeature:](MKStoreManager*,
objc_selector*, NSString*)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2902:
warning: 'MKStoreManager' may not respond to
'-canCurrentDeviceUseFeature:'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2912:
warning: 'MKStoreManager' may not respond to
'-enableContentForThisSession:'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'void -[MKStoreManager
provideContent:forReceipt:](MKStoreManager*, objc_selector*,
NSString*, NSData*)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:2980:
warning: 'MKStoreManager' may not respond to '-verifyReceipt:'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'int isProductPurchased(String)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3151:
warning: unused variable 'kFeatureID'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'void buyProduct(String)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3165:
warning: unused variable 'kFeatureID'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'String* getProductsDescription()':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3184:
warning: address of local variable 'descriptions' returned
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'bool canConsumeProduct(String)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3198:
warning: unused variable 'kFeatureID'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'bool canConsumeProduct(String, int)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3205:
warning: unused variable 'kFeatureID'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'bool consumeProduct(String, int)':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3215:
warning: unused variable 'productIdentifier'
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm: In
function 'int bbMain()':
/Users/roman/Desktop/anawiki games src/inapp.build/ios/main.mm:3607:
warning: unused variable 'bbt_control'
Ld build/Debug-iphonesimulator/MonkeyGame.app/MonkeyGame normal i386
    cd "/Users/roman/Desktop/anawiki games src/inapp.build/ios"
    setenv MACOSX_DEPLOYMENT_TARGET 10.6
    setenv PATH
"/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin:/Developer/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin"
    /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/g++-4.2
-arch i386 -isysroot
/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator4.3.sdk
"-L/Users/roman/Desktop/anawiki games
src/inapp.build/ios/build/Debug-iphonesimulator"
"-F/Users/roman/Desktop/anawiki games
src/inapp.build/ios/build/Debug-iphonesimulator" -filelist
"/Users/roman/Desktop/anawiki games
src/inapp.build/ios/build/MonkeyGame.build/Debug-iphonesimulator/MonkeyGame.build/Objects-normal/i386/MonkeyGame.LinkFileList"
-mmacosx-version-min=10.6 -Xlinker -objc_abi_version -Xlinker 2
-framework Foundation -framework UIKit -framework CoreGraphics
-framework OpenGLES -framework QuartzCore -framework OpenAL -framework
AudioToolbox -framework AVFoundation -o "/Users/roman/Desktop/anawiki
games src/inapp.build/ios/build/Debug-iphonesimulator/MonkeyGame.app/MonkeyGame"
 
Undefined symbols:
  "_OBJC_CLASS_$_SKPayment", referenced from:
      objc-class-ref-to-SKPayment in main.o
  "_OBJC_CLASS_$_SKPaymentQueue", referenced from:
      objc-class-ref-to-SKPaymentQueue in main.o
  "_OBJC_CLASS_$_SKProductsRequest", referenced from:
      objc-class-ref-to-SKProductsRequest in main.o
ld: symbol(s) not found
collect2: ld returned 1 exit status
** BUILD FAILED **
The following build commands failed:
MonkeyGame:
	Ld "/Users/roman/Desktop/anawiki games
src/inapp.build/ios/build/Debug-iphonesimulator/MonkeyGame.app/MonkeyGame"
normal i386
(1 failure)
TRANS Failed to execute 'xcodebuild -configuration Debug -sdk
iphonesimulator', return code=256
 
Process Complete
</textarea><br><br>You can download example app and full module from here:<br><br><a href="http://www.anawiki.com/flash/iap-mod.zip" target="_blank">http://www.anawiki.com/flash/iap-mod.zip</a><br><br>inapp.monkey is the file that tries to use iap.module. The zip contains original MKStoreKitV30 in subfolder.<br><br>Thanks! <br><br>If someone knows how to do this I can even sponsor finishing this module.<br><br>cheers<br>Roman <br><br></td></tr></table><br>
<a name="2010374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, this shit below happens because Trans ignores #import &lt;StoreKit/StoreKit.h&gt;. After I manually added this framework to the project the code compiles right:<br><br>Undefined symbols:<br>  "_OBJC_CLASS_$_SKPayment", referenced from:<br>      objc-class-ref-to-SKPayment in main.o<br>  "_OBJC_CLASS_$_SKPaymentQueue", referenced from:<br>      objc-class-ref-to-SKPaymentQueue in main.o<br>  "_OBJC_CLASS_$_SKProductsRequest", referenced from:<br>      objc-class-ref-to-SKProductsRequest in main.o<br><br>(ok, maybe not the code above, some different, but it was returning same error) <br><br></td></tr></table><br>
<a name="2015531"></a>

<a name="2015532"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do you manually add it?<br>Edit: I see, you have to use xcode. Go to buildphases and add StoreKit to link with binary libraries. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
