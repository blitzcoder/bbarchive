<!DOCTYPE html><html lang="en" ><head ><title >How to get Requestfile$() to Open in my Progs Dir</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to get Requestfile$() to Open in my Progs Dir</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=95" >BlitzPlus Beginners Area</a>/<a href="#bottom" >How to get Requestfile$() to Open in my Progs Dir</a><br><br>
<a name="1113107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>Can someone help me please ?<br><br>I need Requestfile$() to open in my programs folder (the folder that my executable is run from)<br><br>Can anybody help ?<br><br>All help is really appreciated, <br>Thankyou <br><br></td></tr></table><br>
<a name="1113118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> SystemProperty( "appdir" ) is the full path to the location of the .exe file. <br><br></td></tr></table><br>
<a name="1113123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, thats not it.<br><br>Say for instance, that the user copies my executables folder (folder Name = My Clock) to say "E:" drive, that would look like "E:/My Clock".<br>So now the user wants to load a new alarm sound, i need the "Requestfile$()" to open up in "E:/My Clock" folder.<br><br>I hope you understand what i mean ?? <br><br></td></tr></table><br>
<a name="1113128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your program got launched from "E:\My Clock", then thge appdir would return "e:\my clock" as well... did you actually try running it? <br><br></td></tr></table><br>
<a name="1113130"></a>

<a name="1113133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> does this work for you?<br><br><pre class=code>
test$=RequestFile$( "Requester","txt,bin,dat",0,SystemProperty("AppDir"))
</pre><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1113159"></a>

<a name="1113160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> When i try the above code, it does not even open up a requester<br>Below is what i used:<br><br>filename$=RequestFile$( "Choose alarm sound","wav,mp3",0,SystemProperty("AppDir"))<br><br>I dont know whats going on, sorry :(<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1113198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you have the latest version of Blitzplus?<br><br>IIRC the requestfile$ originally didn't support specifying a start folder, that was added in a later version. <br><br></td></tr></table><br>
<a name="1113201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems that the defname$ parameter expects a filename, not just a path. Just using SystemProperty( "appdir" ) doesn't do anything.<br><br>Using SystemProperty( "appdir" + "hello.txt" ) will give the desired folder, and also display hello.txt as the default file selection.<br><br>Remember that "*" can be used to represent an arbitrary file name.<br>Trying SystemProperty( "appdir" + "*" ) we get almost the desired effect. The path is right, but * is actually displayed as a file name. It's a little annoying, but certainly tolerable for personal use.<br><br>I don't if any of this is expected behavior, but it's what I get with BlitzPlus 1.47 and Windows 7. <br><br></td></tr></table><br>
<a name="1113204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @xlsor, I am running V1.47 on Windows 7 :)<br><br>@Floyd, i will try what you pointed out &amp; see what happens.<br><br>Thankyou both of you for your time &amp; wisdom. <br><br></td></tr></table><br>
<a name="1113205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using the code below, still opens the "Documents" folder<br><br>filename$=RequestFile$( "Choose alarm sound","wav,mp3",0,SystemProperty("AppDir"+"*"))<br><br>Im begining to think that the requestfile$ command is broken :( <br><br></td></tr></table><br>
<a name="1113215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, that was careless of me. I typed it in manually rather than copying working code.<br><br>What I meant was to append "*.*" to the path returned by SystemProperty( "appdir" ). So it should have been<br><br>SystemProperty( "appdir" ) + "*.*" <br><br></td></tr></table><br>
<a name="1113246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Floyd, Strange, i have tried it again using the following amended code:<br><br>filename$=RequestFile$("Choose alarm sound","wav,mp3",0,SystemProperty("AppDir"+"*.*"))<br><br>And it still opens the Documents folder, instead of opening in its own folder :(<br><br>Maybe its not totaly compatable in windows 7 ?? <br><br></td></tr></table><br>
<a name="1113254"></a>

<a name="1113255"></a>

<a name="1113256"></a>

<a name="1113257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> filename$=RequestFile$("Choose alarm sound","wav,mp3",0,SystemProperty("AppDir"+"*.*")) <br></div><br><br>Move the +"*.*" <i>outside</i> the call to SystemProperty. That's the change Floyd meant - the extra .* is incidental.<br><br>The difference? At the moment, you're requesting the system property "AppDir*.*", which obviously doesn't exist.<br><br>What you <i>want</i> is to retrieve the value of system property "AppDir", which may for example be "C:\MyApp\", and then append "*.*" to that, to give "C:\MyApp\*.*".<br><br><br>i.e. At the moment, you're appending the stars to the <i>argument</i> to SystemProperty, when what you need to do is append them to its <i>result</i>.<br><br><br><br><b>Good:</b> SystemProperty("AppDir") + "*.*"<br><br><b>Bad:</b> SystemProperty("AppDir" + "*.*")<br><br>Note the difference!<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1113259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Yasha, Thankyou that worked perfectly :)<br><br>I dont suppose you could tell me how i can check for more than one occurance of my executable, just so i can makesure that it wont open duplicates if double clicked ?<br>Thankyou. <br><br></td></tr></table><br>
<a name="1113286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a couple of ways of doing it -- the best way would be to use the windows API calls to view the process list of running processes, and look if there is another one with the same name as your program already running.<br><br>I'd expect that there is probably some code in the code archives for that already. <br><br></td></tr></table><br>
<a name="1113299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aPoPhus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, thankyou for your help :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
