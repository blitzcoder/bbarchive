<!DOCTYPE html><html lang="en" ><head ><title >Quick TCP question...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Quick TCP question...</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=95" >BlitzPlus Beginners Area</a>/<a href="#bottom" >Quick TCP question...</a><br><br>
<a name="950026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sauer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's the best way to speed up a TCP connection?  I have the game running correctly on a variety machines, but it's very slow...  I have three theories:<br><br>1.  Use less Read/Write commands<br>2.  Send smaller data (bytes instead of strings)<br>3.  Send/recv data less often<br><br>For my initial prototype I used all strings and WriteLine, which I knew would be costly for performance but was the easiest to work with.  I switched some of the data that was below 255 to a WriteByte, but will this improve performance?<br><br>Currently I use about 10-15 Read/Write commands per iteration of the game.  Perhaps I should write a parser and combine some of the elements into a single command?<br><br>And I was reading something about UDP on the forums that suggested to send data every ten millisecs... should I do this?<br><br>Which is the best?   Or is it all of the above? <br><br></td></tr></table><br>
<a name="953092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've done some multiplayer game programming using UDP and a small amount with TCP.<br><br>Some queries first:<br>Are you working on an action game (ie frequent updates from server-&gt;client - lots of net traffic)? (UDP usually more suitable but TCP can be used)<br>Are you planning on this game working only on a LAN or also on the Internet?<br>Is it a turn based game or other slower paced game?<br><br>Difficult to determine what is best for your situation without knowing some of the answers to these questions.<br><br>Regardless of TCP/UDP being used - you should not be expecting the Internet to handle messages being sent every frame if you are running at a frame rate of 30/60 frames per second...it's just too quick.  <br><br>Try to keep message lengths to less than 500bytes is something I've heard regardless of UDP/TCP.<br><br>If you are doing an action game then it can be worth compressing the data before sending...and a very easy way for example is to use the appropriate sized 'element' per data type. For example don't use a 4 byte float to store an angle that goes from 0-360, instead scale it back to 0-255 and use a byte, discarding values after the decimal point.  <br><br>That's a couple of ideas. <br><br></td></tr></table><br>
<a name="953140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sauer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have already made sure I use bytes/ints/string data types according to necessity, but I didn't notice a huge difference.  I guess the next thing is to try to send/receive on not every frame.<br><br>I should probably use UDP... but the point of this game was to hone my TCP skills.<br><br>But is it ok if I have multiple write commands, like:<br><pre class=code>
WriteByte(out, HP)
WriteByte(out,STR)
WriteLine(out,item$)
WriteByte(out, room)
WriteByte(out,att)
WriteLine(out,monster$)
WriteByte(out, level)
WriteByte(out,xp)
WriteLine(out,player$)
</pre><br><br>Hmm perhaps WriteString would speed things up too?<br><br>Sorry this post has gotten a bit incoherent.  And thanks for replying, I wasn't sure anyone was going to. <br><br></td></tr></table><br>
<a name="953299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Like I said, if you are doing an action game or fast paced game you don't want to send on every single frame ie 60 messages per second for example would be too many.<br><br>If you convert your ints/floats/shorts/bytes to their string representation (and I don't mean sending 1.234 as "1.234"*) then you can combine all your messages each frame into a single message, or split it per 500bytes.  That way you are only sending a small number of packets from your server.  <br><br>* - for example to convert a float into a string (of 4 bytes in length) you would create a bank of 4 bytes, write the float to the bank, then retrieving the bytes 1 at a time and adding them to the string to be sent.<br><br>Can I ask what you are trying to create? <br><br></td></tr></table><br>
<a name="953557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sauer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If you convert your ints/floats/shorts/bytes to their string representation (and I don't mean sending 1.234 as "1.234"*) <br></div><br><br>Yeah,  I know what you're talking about, similar to Python's <a href="http://docs.python.org/library/struct.html" target="_blank"> struct module </a>. I'll try to write a packer I guess.<br><br><div class="quote"> Can I ask what you are trying to create?  <br></div><br><br>I'm making a Multi User Dungeon (MUD) but its more of a learning experience than a serious game idea.  Having said that, I did play it with a friend and it was rather fun, so I may continue working on it.  <br><br>UDP would probably be the best bet, as the server is constantly sending information about what items, monsters, and players are in the room as well as player stats.  Just about everything is server side too... but I think it is feasible with TCP if I write a good packer and send data less. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
