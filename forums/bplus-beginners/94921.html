<!DOCTYPE html><html lang="en" ><head ><title >Redraw canvas</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Redraw canvas</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=95" >BlitzPlus Beginners Area</a>/<a href="#bottom" >Redraw canvas</a><br><br>
<a name="1091290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tiger</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do i check when its time to redraw canvas? <br><br></td></tr></table><br>
<a name="1092104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gladclef - Ben B</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The way I do it is with a global variable redrawCanvas, as such:<br><br><pre class=code>global redrawCanvas = 1
...
if (redrawCanvas)
    drawUpdateCanvas(canvasHandle)
    redrawCanvas = 0
endif
...
function invalidateCanvas()
    redrawCanvas = 1
end function</pre> <br><br></td></tr></table><br>
<a name="1092394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tiger</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> well that I understand, but how do I know that the canvas is trashed by<br>windows?<br>Is it any event I can check for when my canvas need to be redrawed? <br><br></td></tr></table><br>
<a name="1092407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yeshu777</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you asking is if app the focus has changed.? <br><br></td></tr></table><br>
<a name="1092552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tiger</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> don't know if focus events helps, the problem is that when for some reason the resolution on the screen is changed, or a screen-saver is started all the canvas graphics is trashed. (looks like crap)<br>I try to use a timer to draw the canvas every 5 sec, it works..almost.<br>if windows(XP) is logging out the user, it do so at my work where my code is running.. it craps out my timer too.<br><br>so, got 2 options... find a event for it, or draw the canvas every frame. <br><br></td></tr></table><br>
<a name="1092583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gladclef - Ben B</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know of any commands that can directly tell you if anything has changed on the OS's part (such as screen resolution). What you might be able to do is cache the screen's dimensions as something like desktopWidth/desktopHeight/desktopDepth and then access them every x millisecs with <a href="/bpdocs/command.php?name=gadgetwidth&amp;ref=goto" target="_blank">GadgetWidth</a>(<a href="/bpdocs/command.php?name=desktop&amp;ref=goto" target="_blank">Desktop()</a>) to see if they've changed.<br>As far as a screen saver, I don't even know if windows has any environmental variable that is switched when a screen saver comes on (since screen savers are .exe's renamed to .scr's and moved to system32). For that I guess, like you said, just do a redraw every few seconds.<br><br>The other option for the screen saver problem (that I can think of) is finding a list of all screen saver files in system32 and checking their last read times through this api (<a href="http://msdn.microsoft.com/en-us/library/aa364946(v=VS.85).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/aa364946(v=VS.85).aspx</a>).<br>Now that I take a second look at it, even this is fairly useless since last access times can be accurate to between 1 hour and 1 day. So, my vote says go with the draw every few seconds method, which if the image is cached shouldn't be too CPU intensive.<br><br>Sorry if I'm not giving you any ideas you haven't already thought of, or if just really don't want to deal with api's. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
