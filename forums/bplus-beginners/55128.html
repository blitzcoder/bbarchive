<!DOCTYPE html><html lang="en" ><head ><title >Sine/Cosine</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Sine/Cosine</h1><a href="forums.php" >BlitzPlus Forums</a>/<a href="topics.php?forum=95" >BlitzPlus Beginners Area</a>/<a href="#bottom" >Sine/Cosine</a><br><br>
<a name="613760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apparently math class last year wasn't all useless... however, if I had known that at the time, maybe I would have paid attention.<br><br>I'm trying my hand at a 2D space shooter (yes, you can groan) - as if this world didn't have enough of them.<br><br>My problem is the max speed of the ship.  It messes everything up.  Sometimes it doesn't allow the ship to move in a specific direction, and it is definitely messed up.  For example, when facing right, the ship's y movement should be zero, no?<br><br>I've been stuck for a while, and any help would be much appreciated.  Thanks!<br><br>Here's the full code:<br><br>Graphics 800, 600<br><br>TFormFilter 0;Gets rid of that rascally man, Mr. T-form<br><br>SeedRnd MilliSecs()<br><br>Const leftkey = 203, rightkey = 205, upkey = 200, downkey = 208<br>Const spacebar = 57<br><br><br>Global globaltimer<br><br>Type ship;sets up the type for the player<br><br>	Field x, y<br>	Field dx, dy<br>	Field rotations<br>	Field image<br>	Field frame<br>	Field direction<br>	Field totalframehunks;total rotations of ship in image<br>	Field framehunk;current one (see above)<br>	Field shootingframehunk;the framehunk that it needs to have to shoot<br>	Field turnspeed;different ships turn at different rates<br>	Field turntimer;how much time has elapsed since the last turn...<br>	Field shootspeed;see turnspeed<br>	Field shoottimer;see turntimer	<br>	Field chargeupshooter;if it is a charge-up shooter or not.  1 is yes, 0 is no.<br>	Field chargeup;if it's a charge-up shooter, then this becomes 1 if it is in the chargeup sequence.<br>	<br>End Type<br><br>Global ship.ship = New ship;actually creates the ship that the player uses<br><br>	ship\x = 0<br>	ship\y = 0<br>	ship\dx = 0<br>	ship\dy = 0<br>	ship\rotations = 32<br>	ship\totalframehunks = 4<br>	ship\shootingframehunk = 4<br>	ship\image = LoadAnimImage("TotalShip.bmp", 175, 175, 0, ship\rotations * ship\totalframehunks)<br>	<br>		MaskImage ship\image, 255, 0, 0<br>	<br>	ship\direction = 0<br>	ship\framehunk = 1<br>	ship\frame = 0<br>	ship\turnspeed = 50<br>	ship\turntimer = MilliSecs()<br>	ship\shootspeed = 1000<br>	ship\shoottimer = MilliSecs()<br>	ship\chargeupshooter = 1<br>	ship\chargeup = 0<br>	<br>	<br><br><br><br>Dim xtopspeedtable#(ship\rotations)<br>Dim ytopspeedtable#(ship\rotations)<br>	<br>;gets the sine and cosine tables<br><br>;Run through the full rotation cycle, and use Sin and Cos at increments.<br>;This helps to speed up the game because the compy doesn't have<br>;	to compute the Sine or Cosine in Real-Time.  Poor ol' compy.<br><br>multiplyer = 360/ship\rotations<br><br>Dim xSinTable#(ship\rotations)<br>Dim yCosTable#(ship\rotations)<br><br>For angle = 0 To ship\rotations - 1;through each and every one.<br>	<br>	xSinTable#(angle) = Sin(angle*multiplyer)<br>	yCosTable#(angle) = -Cos(angle*multiplyer);negates the Cosine so the ship doesn't spin oddly.<br>	<br>Next<br><br><br><br><br>precomputetopspeedtables(2);THIS IS THE PROBLEMATIC CODE THING!! HELP!!<br><br><br><br>SetBuffer BackBuffer();Makes it work<br><br>Global startingtime = MilliSecs()<br>Global timepassed<br><br>While Not KeyDown(1);Let's begin!<br>	<br>	globaltimer = MilliSecs()<br>	<br>	If globaltimer &gt; startingtime<br>	<br>		timepassed = globaltimer - startingtime<br>		<br>	<br>		Cls<br>	<br>	<br>		testkeys()<br>	<br>		moveship()<br>	<br>		draw()<br>	<br>	<br>		Flip<br>		<br>		startingtime = globaltimer<br>		<br>		Delay 15<br>		<br>	EndIf<br>	<br>	<br>Wend<br><br><br><br>Function draw();draws all images<br>	<br><br>	<br>	DrawImage ship\image, ship\x, ship\y, ship\frame<br>	<br>	Text 400, 0, "Ship\dx: " + ship\dx<br>	Text 400, 10, "Ship\dy: " + ship\dy<br>	Text 400, 400, "X-Top Speed: " + xtopspeedtable#((ship\frame / ship\framehunk))<br>	Text 400, 410, "Ship X-movement: " + ship\x + (ship\dy * timepassed)<br>	Text 400, 420, "Time passed: " + timepassed<br>	Text 400, 430, "Y-Top Speed: " + ytopspeedtable#((ship\frame / ship\framehunk))<br>End Function<br><br>Function moveship()<br><br>	If ship\dx &gt; xtopspeedtable#((ship\frame / ship\framehunk))<br>	<br>		ship\dx = xtopspeedtable#((ship\frame / ship\framehunk))<br>		<br>	EndIf<br><br>	If ship\dy &gt; ytopspeedtable#((ship\frame / ship\framehunk))<br>	<br>		ship\dy = ytopspeedtable#((ship\frame / ship\framehunk))<br>		<br>	EndIf<br>	<br>	<br><br>	ship\x = ship\x + (ship\dx * timepassed)<br>	ship\y = ship\y + (ship\dy * timepassed);move in realtime<br>	<br>End Function<br><br>Function testkeys();tests all key presses<br>	<br>	;SIDE-TO-SIDE MOVEMENT<br>	<br>	If globaltimer &gt; ship\turntimer + ship\turnspeed;if it's been long enough for<br>													;the ship to turn again<br>		If KeyDown(rightkey);rotates ship clockwise<br>	<br>			ship\frame = ship\frame + 1<br>		<br>			If ship\frame &gt; (ship\rotations * ship\framehunk) - 1;nifty code for getting<br>																 ;the frames right<br>																<br>				ship\frame = (ship\rotations * ship\framehunk) - ship\rotations<br>		<br>			EndIf<br>		<br>		EndIf<br>	<br>		If KeyDown(leftkey);rotates ship counter-clockwise<br>	<br>			ship\frame = ship\frame - 1<br>		<br>			If ship\frame &lt; (ship\rotations * ship\framehunk) - ship\rotations;gets the frames right<br>	<br>				ship\frame = (ship\rotations * ship\framehunk) - 1<br>		<br>			EndIf<br>		<br>		EndIf<br>		<br>		ship\turntimer = globaltimer;resets the turning timer, so the ship has to wait<br>							   ;the "ship\turnspeed" in milliseconds<br>	<br>	EndIf<br>	<br>	;FORWARD MOVEMENT<br>	If KeyDown(upkey)<br>	<br>		ship\dx = ship\dx + (xSinTable#((ship\frame / ship\framehunk)))<br>		ship\dy = ship\dy + (yCosTable#((ship\frame / ship\framehunk)))<br>		<br>	EndIf<br>	;SHOOTING MOVEMENT<br>	<br>	If globaltimer &gt; ship\shoottimer + ship\shootspeed;if it's been long enough for<br>													  ;the ship to shoot again<br>	<br>		If ship\chargeupshooter = 1;if the ship charges up to shoot<br>	<br>			If KeyDown(spacebar);enters shooting chargeup or shifts to next phase of shooting<br>														<br>				ship\frame = ship\frame + ship\rotations;moves forward one "framehunk"<br>				ship\framehunk = ship\framehunk + 1<br>			<br>				If ship\framehunk &gt; ship\shootingframehunk;if the frame is bigger than<br>														;the total frames in the image<br>																<br>					ship\frame = ship\frame - ship\rotations;reset the frame!<br>					ship\framehunk = ship\shootingframehunk<br>				<br>				<br>				EndIf<br>			<br>			EndIf<br>		<br>		EndIf<br>		<br>		ship\shoottimer = globaltimer<br>		<br>	EndIf<br>	<br>	If Not KeyDown(spacebar);if they're not pressing spacebar...<br>		<br>		If ship\framehunk = ship\shootingframehunk;if they let go of spacebar when gun is charged...<br>			<br>			shoot()<br>			<br>		EndIf<br>		<br>		ship\frame = ship\frame - (ship\rotations * (ship\framehunk - 1));resets the frame<br>		ship\framehunk = 1<br>			<br>	EndIf<br>	<br>End Function<br><br>Function shoot()<br>	<br>	Text 400, 300, "S  H  O  O  T  !", True, False<br>	<br>End Function<br><br>Function precomputetopspeedtables(speedtouse#)<br> Local speedcontrol#<br> Local xmaxrange = ship\rotations<br> Local xangle = xmaxrange<br> Local yangle = 0<br><br> ; setup our speed modifier<br> speedmodifier# = (speedtouse# / ship\rotations)<br> ; save our Top Speed<br> speedcontrol# = speedtouse#<br><br> For angle = 0 To ship\rotations<br>	<br>	     ; get that absolute value of our current speed control<br>     ; minus the speed modifier<br>     speedcontrol# = Abs(speedcontrol# - speedmodifier#)<br><br>     ; if it's below a certain level, just set it to zero<br>     If speedcontrol# &lt; .0001 Then<br>        speedcontrol# = .000000<br>     EndIf    <br> <br><br>	; assign the speed control per x,y angle<br>     xtopspeedtable#(xangle) = speedcontrol#<br>     ytopspeedtable#(yangle) = speedcontrol#<br><br>     ; make sure that arrays are being loaded<br>     ; in opposite directions<br>     xangle = xangle - 1<br>     yangle = yangle + 1<br><br><br> Next<br><br>End Function<br><br>End;Closinnng Tiiiime....<br><br><br><br><br>EDIT: I really don't understand some of the max speed stuff... I kind of took it from krylar's book without fully understanding it, and tweaked it (a bad idea).<br><br>Also, can someone tell me how to make that blue code box on the forums? <br><br></td></tr></table><br>
<a name="613767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> &lt;code&gt;<br>&lt;/code&gt;<br><br><br>but preferred for large chunks o' code:<br>&lt;codebox&gt;<br>&lt;/codebox&gt;<br><br>replace &lt;&gt; with [] <br><br></td></tr></table><br>
<a name="613769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mudcat</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> one thing I see after a quick look over is when you use cos and sin,you need to make your ships dx and dy a float.In fact you need to make everything that has to do with your movement floats.I've ran into a similar problems a few weeks back.<br>Reason is,if your dx is an int,and you do float math ,it will round it to the nearest whole number.<br><br>Hope this helps,<br>mudcat <br><br></td></tr></table><br>
<a name="613774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mudcat</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's something to paste and run.<br><pre class=code>
Graphics 800,600
 SetBuffer BackBuffer()
x#=GraphicsWidth()/2
y#=GraphicsHeight()/2

While Not KeyDown(1)
	Cls
	Line x-100,y,x+100,y
	Line x,y-100,x,y+100
	Line x,y,MouseX(),MouseY()
	a#=ATan2(MouseY()-y,MouseX()-x)
	Text 100,100,"angle= "+a
	Text x-100,y,"-100",1
	Text x+100,y,"+100",1
	Text x,y-100-FontHeight(),"-100",1
	Text x,y+100,"+100",1
	Flip
Wend 
</pre> <br><br></td></tr></table><br>
<a name="613791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> mudcat-<br><br>Thanks, but it doesn't help.  I still can't move the ship directly to the right.<br><br>By the way, do all &lt;b&gt;html&lt;/b&gt; tags work in here?<br><br>EDIT:  I guess not <br><br></td></tr></table><br>
<a name="613801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mudcat</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> By the way, do all &lt;b&gt;html&lt;/b&gt; tags work in here? <br></div><br><br><b>html</b> I gues they do<br><br>you have to use [] not &lt;&gt; <br><br></td></tr></table><br>
<a name="613981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh...<br><br>Thanks, but I'd still like to get back to my main problem...<br><br>[marquee]Sweet![/marquee] <br><br></td></tr></table><br>
<a name="614081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You guys, I'm desparate!  Help!!<br><br>Gaaaaaaaaaaaaaaaaah! <br><br></td></tr></table><br>
<a name="614087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I took out the top speed completely, and something is wrong with my angles.  At 180 degrees, the dx value should be zero, yet it isn't.<br><br>I think I can fix it though. <br><br></td></tr></table><br>
<a name="614764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's fixed!  Hallelujah! <br><br></td></tr></table><br>
<a name="615356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> btw I did some test of putting sin in an array to read instead of calling Sin realtime and it really was only fractionally faster.  In the old days it would have been a lot faster. <br><br></td></tr></table><br>
<a name="615518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Buggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow.  Things have gotten fast. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
