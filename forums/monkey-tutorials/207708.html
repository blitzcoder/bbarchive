<!DOCTYPE html><html lang="en" ><head ><title >How to integrate In App Purchases</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to integrate In App Purchases</h1><a href="forums.php" >Monkey Archive Forums</a>/<a href="topics.php?forum=513" >Monkey Tutorials</a>/<a href="#bottom" >How to integrate In App Purchases</a><br><br>
<a name="2074888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, this tutorial will handle the IAP part of your app. It will have a generic part (which is the test app itself) and 3 specific parts for Android, iOS and (later) WP8.<br><br>Here we go!<br><br>This the code I use, it's mainly the same as Mark's example:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import mojo
Import brl.json
Import brl.filestream
Import brl.monkeystore

Global CONSUMABLES:String[] = [ "bulletboost", "speedboost" ]
Global NON_CONSUMABLES:String[] = [ "shipupgrade" ]

Function Main:Int()
  New IAPTest()
  Return 0
End Function

Class IAPTest Extends App Implements IOnOpenStoreComplete, IOnBuyProductComplete, IOnGetOwnedProductsComplete
  Field _store:MonkeyStore
  Field _purchases:JsonObject
  Field _mousex:Float
  Field _mousey:Float
  
  Method OnCreate:Int()
    _purchases = New JsonObject()
    LoadPurchases()
    _store = New MonkeyStore()
    _store.AddProducts( CONSUMABLES, 1 )
    _store.AddProducts( NON_CONSUMABLES, 2 )
    
    _store.OpenStoreAsync( Self )
    
    SetUpdateRate(30)
    Return 0
  End Method

  Method OnUpdate:Int()
    UpdateAsyncEvents() 'IMPORTANT!!!
    _mousex = MouseX()
    _mousey = MouseY()
    Local hit:Int = MouseHit( 0 )

    If( _store.IsOpen() And Not _store.IsBusy() And hit )
      Local my:Float = _mousey * ( 480.0 / DeviceHeight() )
    
      If( my &gt;= 440-6 And my &lt; 440+6 )
        _store.GetOwnedProductsAsync( Self )
      Else
        Local y:Int = 40
        For Local p:Product = Eachin _store.GetProducts()
          If( my &gt;= y-6 And my &lt; y+6 )
            _store.BuyProductAsync( p, Self )
            Exit
          End If
          y += 24
        Next
      End If
    End If
    Return 0
  End Method

  Method OnRender:Int()
    Cls()
    PushMatrix()
      Scale( DeviceWidth() / 320.0, DeviceHeight() / 480.0 )
      DrawText( Millisecs(), 0, 0 )
    
      If( _store.IsOpen() )
        SetColor( 255, 255, 255 )
        If( _store.IsBusy() ) SetColor( 128, 128, 128 )
    
        DrawText( "Restore Owned Products", 160, 440, 0.5, 0.5 )
    
        Local y:Int = 40
        For Local p:Product = Eachin _store.GetProducts()
          Local t:String = "Buy " + p.Title
          Select p.Type
            Case 1
              t += " (" + _purchases.GetInt( p.Identifier ) + ")"
            Case 2
              If( _purchases.GetBool( p.Identifier ) ) t += " (owned)"
          End Select
          DrawText( t, 160, y, 0.5, 0.5 )
          y += 24
        Next
      Else
        DrawText( "Opening store...", 160, 40, 0.5, 0.5 )
      End If
    PopMatrix()
    
    SetColor( 255, 255, 255 )
    DrawCircle( _mousex-8, _mousey-8, 16 )
    Return 0
  End Method

  '*** Derived methods ***
  '*************************************************************************************  
  Method OnOpenStoreComplete:Void( result:Int )
    Print ( "OpenStoreComplete, result = " + result )
    If( result &lt;&gt; 0 ) Error "Store unavailable"
  End Method
  
  Method OnBuyProductComplete:Void( result:Int, product:Product )
    Print( "BuyProductComplete, result = " + result )
    If( result &lt;&gt; 0 ) Return
    Select product.Type
      Case 1
        _purchases.SetInt( product.Identifier, _purchases.GetInt( product.Identifier ) + 1 )
      Case 2
        _purchases.SetBool( product.Identifier, True )
    End
    SavePurchases()
  End Method
  
  Method OnGetOwnedProductsComplete:Void( result:Int, products:Product[] )
    Print( "GetOwnedProductsComplete, result = " + result )
    If( result &lt;&gt; 0 Or Not products ) Return
    For Local p:Product = Eachin products
      _purchases.SetBool( p.Identifier, True )
    Next
    SavePurchases()
  End Method

Private
  '*** Helper methods ***
  '*************************************************************************************  
  Method LoadPurchases:Void()
    Local f:FileStream = FileStream.Open( "monkey://internal/.purchases", "r" )
    If( Not f ) Return
    Local json:String = f.ReadString()
    Print( "LoadPurchases: Json = " + json )
    _purchases = New JsonObject( json )
    f.Close()
  End Method
  
  Method SavePurchases:Void()
    Local f:FileStream = FileStream.Open( "monkey://internal/.purchases", "w" )
    If( Not f ) Error "Unable to save purchases"
    Local json:String = _purchases.ToJson()
    Print( "SavePurchases: Json = " + json )
    f.WriteString( json )
    f.Close()
  End Method

End Class
</textarea> <br><br></td></tr></table><br>
<a name="2074889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>ANDROID</b><br><br>So far so good, that was the easy part. Compile it to Android and sign it with your release key as you have to upload it to the store. YES, there is no other way to test it with real product ids, but don't worry, you won't have to publish it!<br><br>Ok, so go to your developer console and go to "InApp Products"<br><img src="http://www.leidel.net/dl/monkey/iap/iap01.jpg"><br><br>Ahhh you see, we have to upload the apk first! I select beta testing for that purpose.<br><img src="http://www.leidel.net/dl/monkey/iap/iap02.jpg"><br><br>Done!<br><img src="http://www.leidel.net/dl/monkey/iap/iap03.jpg"><br><br>Now go to InApp Products again:<br><img src="http://www.leidel.net/dl/monkey/iap/iap04.jpg"><br><br>Let's add our product IDs as managed products. As far as I understand starting with API V3 everything is managed which means that you can only buy consumables ONCE and you must consume it before you can buy the next consumable of the same type. Luckily Mark already handles this for us!<br>The product IDs MUST be the same as in your app defined. In our example:<br><pre class=code>
Global CONSUMABLES:String[] = [ "bulletboost", "speedboost" ]
Global NON_CONSUMABLES:String[] = [ "shipupgrade" ]
</pre><br><img src="http://www.leidel.net/dl/monkey/iap/iap05.jpg"><br><br>Add title, description, price and set it to ACTIVE:<br><img src="http://www.leidel.net/dl/monkey/iap/iap06.jpg"><br><br>Alright, now your list should look like this:<br><img src="http://www.leidel.net/dl/monkey/iap/iap07.jpg"><br><br>Finally, to enable TESTING of your purchases you have to add beta testers to your account details. All Google accounts listed there will be able to purchase your items WITHOUT being charged for it. So the buy process will look exactly like the real one with the exception that your credit card isn't debited.<br><img src="http://www.leidel.net/dl/monkey/iap/iap08.jpg"><br><br>That's it! Actually you have to wait an hour or two till the product list is really available. <br><br></td></tr></table><br>
<a name="2075444"></a>

<a name="2075445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>iOS</b><br><br>Alright. Now to iOS. I was surprised how straight forward it is for this platform!<br><br>First, enter iTunes Connect and go to the app which you want to use InApp purchases with. Click on "Manage In-App Purchases":<br><img src="http://www.leidel.net/dl/monkey/iap/ios/01.png"><br><br>Right, you see, no IAPs yet, so let's create a new one!<br><img src="http://www.leidel.net/dl/monkey/iap/ios/02.png"><br><br>Ok, the type. Basically I've only tried consumables and non-consumables.<br>Consumables are things like fuel for a car.<br>Non-Consumables are things like a full version purchase or ad removal.<br><img src="http://www.leidel.net/dl/monkey/iap/ios/03.png"><br><br>I select a non-consumable here in this real example. The reference name is just for you, nothing the customer will ever see. The product ID should be the string you use in your app as id!<br><img src="http://www.leidel.net/dl/monkey/iap/ios/04.png"><br><br>Add languages (the display name is what the user sees) and (funny enough) a screenshot. I just used a screenshot where the "Buy" button is visible:<br><img src="http://www.leidel.net/dl/monkey/iap/ios/05.png"><br><br>Click done. So far so good. That's it basically. We need a binary now to complete it!<br><img src="http://www.leidel.net/dl/monkey/iap/ios/06.png"><br><br><img src="http://www.leidel.net/dl/monkey/iap/ios/07.png"><br><br>Now go to your member center ( <a href="https://developer.apple.com" target="_blank">https://developer.apple.com</a> ) and ensure that your bundle list has InApp purchases enabled:<br><img src="http://www.leidel.net/dl/monkey/iap/ios/08.png"><br><br>Finally enable IAPs in XCode in your app as well:<br><img src="http://www.leidel.net/dl/monkey/iap/ios/09.png"><br><br>That's it. Build and submit it for review. Peace of cake! ;)<br><br><b>BE AWARE: It is important to add a "Restore Purchases" button to your app. Otherwise Apple will reject it!</b> <br><br></td></tr></table><br>
<a name="2074890"></a>

<a name="2074891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>WP8</b><br><br>coming soon... <br><br></td></tr></table><br>
<a name="2074892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>Other Stores</b><br><br>(maybe) coming soon... <br><br></td></tr></table><br>
<a name="2074900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> very nice.  Here's the tutorial a bunch of people have been waiting for!  They should be thankful for all your help, considering how hard it used to be before the IAP module existed :) <br><br></td></tr></table><br>
<a name="2074906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul - Taiphoz</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You Sir can have some Stars :) <br><br></td></tr></table><br>
<a name="2074967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys! :) I still hope, Mark adds IAP for WP8 soon! <br><br></td></tr></table><br>
<a name="2074968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Supertino</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Xaron - If you already know an Amazon store one would be good too. <br><br></td></tr></table><br>
<a name="2074980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> XARON!!! This is great!<br>I never know how to integrate IAP &amp; Ads <br><br></td></tr></table><br>
<a name="2074984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very nice tutorial, thanks!  You make it look almost easy!<br><br>Do people feel that a single version with a single in-app purchase would get more traction these days than a shareware-style pro and lite version of a game or app? <br><br></td></tr></table><br>
<a name="2074986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Supertino</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Gerry Quinn - almost certainly, it's easier for all concerned, easier for the dev as they don't need to manage different version and more importantly easier for the would be buyer, no additional downloads, no worry about losing progress they made in the lite version.  And if they don'y upgrade you can still have the ads enabled. <br><br></td></tr></table><br>
<a name="2075101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow! Thank you very much for this :) <br><br></td></tr></table><br>
<a name="2075219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rIKmAN</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great start Xaron, this will help a lot of people so thanks for taking the time to do it.<br><br>Looking forward to the iOS guide. :) <br><br></td></tr></table><br>
<a name="2075230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sionco</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, fantastic! <br><br></td></tr></table><br>
<a name="2075254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome. iOS comes within the next days...<br><br>Dunno about WP8 yet, There is no official module yet. <br><br></td></tr></table><br>
<a name="2075282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >silentshark</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks for putting this together, Xaron. You are a star :-) <br><br></td></tr></table><br>
<a name="2075393"></a>

<a name="2075394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just dig through the Apple stuff and as far as I read you MUST have a Restore Button in your app as soon as you include non-consumable IAPs (like a button to buy the full version which would be a non-consumable item). Otherwise Apple will reject the app. Oh well... iOS IAP tutorial is coming along nicely... Stay tuned!<br><br><i>"...if your application supports product types that must be restorable, you must include an interface that allows users to restore these purchases. This interface allows a user to add the product to other devices or, if the original device was wiped, to restore the transaction on the original device."</i> <br><br></td></tr></table><br>
<a name="2075396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> what?<br><br>hey xaron, what about new topic for each platform?<br>it is also better for user comments... <br><br></td></tr></table><br>
<a name="2075397"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm well, might do this. thought to use the first 4 postings for all platforms. Because the code is always the same... <br><br></td></tr></table><br>
<a name="2075446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Added the iOS guide. :) <br><br></td></tr></table><br>
<a name="2075492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rIKmAN</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great stuff Xaron - suprised how easy it is but thanks for taking the time to do the guide, much appreciated :) <br><br></td></tr></table><br>
<a name="2075509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> yea - and where is that magic button code for Restore Purchases? <br><br></td></tr></table><br>
<a name="2075554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ordigdug</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Xaron - You should turn these guides into an e-book. <br><br></td></tr></table><br>
<a name="2077043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wylaryzel</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the guide - it seems very usable :-)<br><br>As I was reading through the different options and documentations... are subscription already implemented? And if yes, what would be the difference to the managed consumables?<br><br>thx<br>Wyl <br><br></td></tr></table><br>
<a name="2080298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> I always get result -1 when try to buy a product<br>iOS<br><br><pre class=code>
Global NON_CONSUMABLES:String[] = [ "com.whitezebra.turtling.doubler", 
									"com.whitezebra.turtling.megapack" ]

Global IAPStore := New IAPStoreClass

Class IAPStoreClass Implements IOnOpenStoreComplete, IOnBuyProductComplete, IOnGetOwnedProductsComplete

	Field _store:MonkeyStore

	Method Init:Void()

		_store = New MonkeyStore()
		_store.AddProducts( NON_CONSUMABLES, 2 )

		_store.OpenStoreAsync( Self )

		Print "IAP Store Opened"

	End Method

	Method Update:Void()

		UpdateAsyncEvents() 'IMPORTANT!!!
		
		If MouseHit(0)

			Local iap:Product = _store.GetProduct("com.whitezebra.turtling.doubler")

			Print iap.Identifier()
			Print iap.Price()
			Print iap.Title()

			_store.BuyProductAsync( iap, Self )

		End

	End Method

...
other standard methods
...

End Class
</pre><br><br><br>Debug Log:<br><pre class=code>
IAP Store Opened
OpenStoreComplete, result = 0
&lt;-- *** tap on the screen ***
com.whitezebra.turtling.doubler
$0.99
Double Coins
BuyProductComplete, result = -1
</pre> <br><br></td></tr></table><br>
<a name="2080296"></a>

<a name="2080299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is that with the emulator? If so, it won't work. You need a real device. Plus the InApp product has to be reviewed. <br><br></td></tr></table><br>
<a name="2080310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a device.<br><br>Will try with reviewed IAPs, however, on Unity there's no need to get them reviewed.<br><br>Thank you! <br><br></td></tr></table><br>
<a name="2080312"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well technically yes, there is a test mode. I've never tried this but in my case the real ones actually work in my apps. <br><br></td></tr></table><br>
<a name="2080380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> I got this working!<br><br>Small notes for people who has the same issue.<br>It seems that IAP registered through iTunes Connect only works in 2 cases:<br><br>1. The app has never been in "Waiting for review/upload". Your app status should be "Prepare for upload".<br>In this case you may simply create IAPs without having them reviewed or added to your binary.<br><br>2. If you pressed the button "Ready to upload binary" before IAPs was created (for that time status of your app should be "Waiting for upload"), you have to:<br>- create IAPs<br>- upload a binary<br>- reject it by yourself<br>- add IAPs to binary<br>- press "Ready to upload binary".<br>Then they will work.<br><br>Hope this will be helpful! <br><br></td></tr></table><br>
<a name="2080379"></a>

<a name="2080377"></a>

<a name="2080376"></a>

<a name="2080381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes. I went through this as well and should update my tutorial. Thanks for pointing that out! :) <br><br></td></tr></table><br>
<a name="2081826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Erik</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the guide, works great on ios! I can't get the android store to work though. I always get  "OpenStoreComplete, result = -1". I've followed the guide, signed the app, removed debug code etc etc. <br><br>Should I be transferring the signed apk to the test device and running that somehow? Currently I just compile it to the device from within monkey... <br><br>EDIT: I've tried uploading it to Google Play and downloading it from there using a valid test account. It downloads and runs fine on the device but still no IAP. <br><br></td></tr></table><br>
<a name="2081696"></a>

<a name="2081697"></a>

<a name="2081698"></a>

<a name="2084847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> My app status is: Prepare for Upload<br>I created one IAP - consumables<br><br>I receive the BuyProductComplete, result = -1<br><br>Tested on a real device. Any thoughts? <br><br></td></tr></table><br>
<a name="2085180"></a>

<a name="2085181"></a>

<a name="2085182"></a>

<a name="2085183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Raul,<br>Can you, please, post here your code?<br><br>Do you use the full ID for a proguct? i.e. "com.companyname..."<br>Do you see the name and price for a product in log?<br><br>What is your OpenStoreComplete result?<br><br>(just the guess)<br>Also, try to upload binary and then reject it.<br>First time do NOT do this ---&gt; (- press "Ready to upload binary".)<br>And try to compile to see the BuyProduct result.<br>If it will not work then press "Ready to upload binary". And again try to compile. <br><br></td></tr></table><br>
<a name="2086235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know most games let you pay real money for in-game currency and then you use the in-game currency to buy items.<br><br>So, how would this model work?<br><br>I assume I would create consumable items for the virtual currency, such as "bag of coins", "box of coins" etc.<br><br>However, does that mean I wouldn't create the other items that are bought with the virtual currency through the google play developer console?<br>If not, how would I support something like Restore Purchases, consumables, etc?<br><br>Thank you for the great tutorial :) <br><br></td></tr></table><br>
<a name="2086361"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Alex:<br>Yes, I use the full ID for the product. In fact, in the Debug area I receive the product name, price and id.<br>Also the 'store' is opened correctly.<br><br>I will try your tricks with rejecting the app this evening. I do not have the code near me, right now. <br><br></td></tr></table><br>
<a name="2086364"></a>

<a name="2086365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Raul, I had the same issue, I mean, I see all the parameters of the product in debug, and still get result=-1. It was fixed by the rejecting thing.<br><br>erebel55, only non-consumables can be restored. If I understood you right. If you want to remove ads or something after the consumable has been bought, you have to store the "purchase is bought" var on the device. It will not work on the other device or if the app will be deleted. <br><br></td></tr></table><br>
<a name="2086474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Alex. Basically, I am trying to do something like you do in your Tinny Flippers game.  I want to offer in-game currency that the user can collect during the game.  I also want to allow them to purchase this currency as iap.  They can then use it to buy items in the game.  I guess with this model the only thing that could be restored with a "Restore Purchases" option is the in-game currency and not the items bought with it. <br><br></td></tr></table><br>
<a name="2086433"></a>

<a name="2086445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  I guess with this model the only thing that could be restored with a "Restore Purchases" option is the in-game currency and not the items bought with it. <br></div><br>I would have thought it would be the other way around. The in-game currency is consumable and depending on the item it would be non-consumable.<br><br>For example, in your game you have in-game currency stored as "money", and you need to save this about via SaveState (or something), when a player "buys" more in-game currency from an IAP the money value increases:<br><pre class=code>Method OnBuyProductComplete:Void(result:Int, product:Product)
  money += 10
  SavePurchases()
End</pre> <br><br></td></tr></table><br>
<a name="2086465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> erebel55, "Restore Purchases" is used in case of the player has deleted the game from his device and installed again. If the game wasn't deleted you don't need to use "Restore Purchases".<br>Only NON-CONSUMABLE products can be restored. Because their purchase is stored on Apple/Google server and can be downloaded again. Non-consumables can be purchased only once. Example - Remove Ads, Permanent doubler. Once you purchase them, you cannot do it again.<br>You CANNOT restore consumable products. Such as "Coin Pack", because you can buy them many times. There's no way Apple/Google can store the purchase that you can buy many times. So, you have to save it on the device only while the app is installed, like therevills says. Once you uninstall it, all data will be lost. You cannot restore it, unless you, maybe, use any cloud service (I don't know for sure). <br><br></td></tr></table><br>
<a name="2086789"></a>

<a name="2086790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, with my model it looks like nothing can be restored after reinstall?  Doesn't ios require a restore purchases button?<br><br>The model I was thinking is to have the player purchase in-game currency with real money.<br>Player uses in-game currency to purchase all other items. <br><br></td></tr></table><br>
<a name="2086791"></a>

<a name="2086793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alex</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, not only your, but all the apps cannot restore consumable IAPs. Apple doesn't require consumables to be able to restore (Don't know for sure, but think, Google too. They can't require this, as they do not support this). <br>So, dont worry, you don't have to restore your consumable IAPs at all. <br><br></td></tr></table><br>
<a name="2086794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep. That's the reason why games like Clash of Clans don't have a restore button. They simply only offer consumables which are not required to be restored via Apple.<br><br>For Google Play you don't need a restore button at all. <br><br></td></tr></table><br>
<a name="2086795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was planning on having both consumable and non-consumable items that can be purchases with the in-game currency. And the only thing bought with real money is the in-game currency packs.<br>Some examples of non-consumables items in my game are different outfits and remove ads. <br><br></td></tr></table><br>
<a name="2086797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well in that case your ingame currency is a consumable item obviously no matter what you do with it internally. So there's no need for a restore button then. <br><br></td></tr></table><br>
<a name="2086806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, thanks guys.  I was just hoping there was a way to restore the non-consumable items that the user has purchased.  I guess there isn't since they are managed internally.  It looks like the only way to support that is to have non-consumable items be purchased with real money (and managed by google) instead of in-game currency. (Without getting into cloud storage) <br><br></td></tr></table><br>
<a name="2086804"></a>

<a name="2086799"></a>

<a name="2086800"></a>

<a name="2086801"></a>

<a name="2086802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> But keep in mind that non-consumables can only be bought once. <br><br></td></tr></table><br>
<a name="2086807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, I understand that. How would you recommend dealing with consumables/non-consumables and in-game currency? I thought in-game currency would be better because it seems to be the model everyone has gone to. <br><br></td></tr></table><br>
<a name="2086808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I'm going to use ingame currencies as well in one of my next apps. I always would do it as consumable. But of course it would be good to have it stored serverside which I will integrate as well (either via Google Gameservices, own server, etc...) <br><br></td></tr></table><br>
<a name="2086810"></a>

<a name="2086814"></a>

<a name="2086826"></a>

<a name="2086829"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> me again.<br><br>@Alex<br>I rejected my binary, but I still receive result = -1 when trying to buy a product.<br><br>Edit:<br>I made the following steps:<br>1. Created IAPs<br>2. Upload binary<br>3. Reject it.<br>4. Add IAPs to binary<br>5. Press "Ready for Upload"<br><br>It doesnt work :( <br><br></td></tr></table><br>
<a name="2086858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys.<br><br>I found my problem. I forgot to switch to a Test Account on my device.<br><br>Please edit the initial Post and mention this :D<br><br>Thank you Alex once again for helping me. <br><br></td></tr></table><br>
<a name="2086926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But keep in mind that non-consumables can only be bought once. <br></div><br><br>But if the user uninstalls the app they will still lose these non-consumables and have to purchases them again, correct?<br><br>What I'm getting at is, if the player uses in-game currency to purchase an item (consumable/non-consumable) it can't be restored since it isn't managed by google?<br>Only non-consumables managed by google (meaning bought with real money) can be restored.<br><br>So I can either forget about restoring any products OR I can have non-consumables managed by google and purchased with real money. <br><br></td></tr></table><br>
<a name="2086925"></a>

<a name="2087570"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am getting "OpenStoreComplete, result = -1" in my android app now as well.<br>This was working yesterday and I purchased a few items and tested that all out. However, it stopped working sometime this morning.  I didn't change anything..<br><br>The device has an internet connection. I've tried uninstalling the app and restarting my device.  The device is also setup as a test account.<br><br>This is what it is telling me<br>E/Volley  (  685): [14] BasicNetwork.performRequest: Unexpected response code 500 for <a href="https://android.clients.google.com/fdfe/bulkDetails" target="_blank">https://android.clients.google.com/fdfe/bulkDetails</a><br>I/[Monkey]( 8758): OpenStoreComplete, result = -1<br><br>Any ideas? Anywhere that I can find a more verbose log for this?<br><br>Edit: Nevermind I figured it out.  I was calling AddProducts on some products that weren't defined on the google play developer dashboard. <br><br></td></tr></table><br>
<a name="2087505"></a>

<a name="2087458"></a>

<a name="2087457"></a>

<a name="2087455"></a>

<a name="2088190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kslam</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>I got problem in iOS IAP.<br>In iOS 6, I can see the "Buy" screen, open store successful (OpenStoreComplete, result = 0). But, if I clicked buy, no error in Xcode debug log screen.<br>Then I click buy again, show error "OnBuyProductComplete, result = -1". I restart it, then I click "Cancel" instead of "Buy". The error is "OnBuyProductComplete, result = 1". <br>After that I upgraded my iPhone device to 7.1.1, open store successful (OpenStoreComplete, result = 0). Then no more "Buy" screen show up. It crashed (libc++abi.dylib: terminating with uncaught exception of type char const*).<br><br>My app is in Prepare for Upload status.<br>Monkey-x ver is 78h.<br>Xcode is Version 5.1.1 (5B1008)<br>iPhone device is 4s and iOS 6 and 7.1.1<br><br>Are there many Monkey-x developer successful develop their IAP game by using Monkey-x ?<br>If the IAP problem can't be solved, I consider remove IAP from my game. <br><br></td></tr></table><br>
<a name="2088282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kslam</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Solved the by adding Test account in itunesconnect.<br><br>Second problem come out.<br>Normally, if buy an item, we just click shopthisItem method, then click the buy button on the "Buy Screen". Consider 1 transaction.<br><br>The problem is,<br>I have to click shopthisItem method, then click Buy in "Buy Screen". After that, click shopthisItem method again. Then OnBuyProductComplete, result = 0.<br>Consider 1 transaction.<br><br>The shopthisItem method below:<br>       Method shopthisItem:Void()<br>		UpdateAsyncEvents()			<br>			Local iap:Product = _store.GetProduct("com.abc.mygame.100coin")<br>			Print iap.Identifier()<br>			Print iap.Price()<br>			Print iap.Title()<br>			_store.BuyProductAsync( iap, Self )<br>	End Method<br><br>Is there anyone got solution ?<br><br>Thank you. <br><br></td></tr></table><br>
<a name="2088378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think something may have changed on the google play side yesterday. Can someone please test the example given in this tutorial on android?  It no longer works for me and the iap I added to my game that has been working for weeks has also stopped.<br><br>The store opens correctly however GetProducts() is no longer returning any results.  I have tested on multiple devices with the same results.<br><br>I have tried clearing data for download manager, google play store, google services, and restarting device but it didn't help.<br><br><b>Hope someone can help!</b> Thanks <br><br></td></tr></table><br>
<a name="2088371"></a>

<a name="2088374"></a>

<a name="2088408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was able to chat with google play support today and this was their reply<br><div class="quote"> <br>Ah, I see the issue. Unfortunately we're to blame for this problem.<br>We made some changes to how IAP, OBB, and license testing works about a week ago.<br>We now require apps to be published in order to test these features.<br>Currently we recommend publishing to Alpha or Beta to test.<br>I apologize for the lack of communication, and we're currently working to update our documentation to reflect this change.<br> <br></div><br><br>Basically, you can no longer test in "Draft" mode and instead need to be published to Alpha/Beta/Prod.<br><br>So I am in the process of publishing my app so I can test to see if this fixes my issue. Will report back when I am done :) <br><br></td></tr></table><br>
<a name="2088390"></a>

<a name="2088413"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> In Xaron's tutorial he tells us that you need to release it to the store and his example is publishing it to the Beta section:<br><div class="quote"> ANDROID<br><br>So far so good, that was the easy part. Compile it to Android and sign it with your release key as you have to upload it to the store. YES, there is no other way to test it with real product ids, but don't worry, you won't have to publish it! <br></div><br><br>So what is different now? <br><br></td></tr></table><br>
<a name="2088419"></a>

<a name="2088420"></a>

<a name="2088421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> The "you won't have to publish it!" part is different now.<br><br>Xaron's example showed to "upload" to the Beta section (not publish).<br><br>I already had my signed game uploaded to the Beta section of google play.  However, it was in "Draft" mode.  Everything was working just fine for weeks and then google changed this.<br>So now you can't test IAP in draft mode.  You have to publish it. (You can publish to Alpha, Beta, or Prod)<br><br>To sum it up in an image, this was the issue<br><img src="https://dl.dropboxusercontent.com/u/106998981/Draft.png"> <br><br></td></tr></table><br>
<a name="2088418"></a>

<a name="2088417"></a>

<a name="2088415"></a>

<a name="2088416"></a>

<a name="2088426"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, that makes more sense - thanks Ethan.<br><br>Hate it when Google changes things like this. <br><br></td></tr></table><br>
<a name="2088436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sure no problem, I hope it helps someone in the future.<br><br>Also, just to confirm, I published my app and waited around 4 hours and the iap is all working again :D <br><br></td></tr></table><br>
<a name="2091935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange issue appeared now:<br><br>I have a new problem on this second app I am making for a client. I am trying to implement IAP as I already done in my game for an iOS game.<br>The issue is that I am not event able to access my iap data from the code.<br><br>So I:<br>- created the iaps<br>- uploaded the application<br>- rejected it<br>- added the iap to the binary<br>- App status is: Waiting for Upload<br><br>The problem is that in my code:<br>- I open the store (result = 0)<br><br>app is crashing at the first Print:<br><pre class=code>
Field iap1:Product
Field iap2:Product
</pre><br><br><pre class=code>
		iap1 = _store.GetProduct("com.appbundle.10000credits")
		iap2 = _store.GetProduct("com.appbundle.20000credits")		
		Print "Price: " + iap1.Price()
		Print "Price: " + iap2.Price()
</pre><br><br>I receive no errors in the line: iap1 = _store.GetProduct("com.appbundle.10000credits")<br>but when I try to access: price, description, etc. the app is crashing.<br><br>Also the buy does not work. In xCode is telling me the iap1 is null. <br><br></td></tr></table><br>
<a name="2091950"></a>

<a name="2091951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> I made a separately project using ONLY the Xaron code sample from the 1st post, to be sure is nothing wrong in my code.<br><br>No products are loaded. the product is NULL<br><br>The app is in Waiting for Upload. The iaps are also in waiting for review and are attached to the app version.<br><br>WHY IS NOT WORKING.... I am trying to do this shit for 4 days... <br><br></td></tr></table><br>
<a name="2118311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using a new version MonkeyX requires the new OnOpenStoreComplete method:<br><br><pre class=code>	Method OnOpenStoreComplete:Void(result:Int, interrupted:Product[])
		Print "OpenStoreComplete, result=" + result
		storeUnavailable = False
		If result&lt;&gt;0
			Print "Failed to open Monkey Store"
			storeUnavailable = True
		Endif
		If interrupted.Length
			Print "Interrupted purchases:"
			For Local p:=Eachin interrupted
				Print p.Identifier
				MakePurchase p
			Next
		Else
			Print "No interrupted purchases."
		Endif
	End</pre><br><br>Also it seems for testing you need to download the version from the app store... cant remember if this was a requirement before....<br><br>And I always forget about the UpdateAsyncEvents() method! <br><br></td></tr></table><br>
<a name="2118306"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
