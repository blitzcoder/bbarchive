<!DOCTYPE html><html lang="en" ><head ><title >ReadPixels/WritePixels on iPad</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ReadPixels/WritePixels on iPad</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=528" >Monkey Beginners</a>/<a href="#bottom" >ReadPixels/WritePixels on iPad</a><br><br>
<a name="2099174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TVCruelty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I'm completely baffled. The following code runs and works fine on desktop (PC and Mac) and HTML5. On the iPad, however, I never see the screen-grabbed image, just the new image on a black background. Any help would be much appreciated as my game really needs this.<br><br>(By the way, I don't know how to properly embed code here so apologies if it looks a bit naff.)<br><br>&lt;code&gt;<br><br>Method OnUpdate()<br>		If MouseHit()<br>			state = Not state<br>			If Not state<br>				gotGrab = False<br>			EndIf<br>		EndIf<br>	End<br><br>Method OnRender()<br>		<br>		If state And Not gotGrab<br>			grab = ScreenGrab(0, 0, DeviceWidth(), DeviceHeight())<br>			gotGrab = True<br>		EndIf<br>	<br>		Cls()<br>		<br>		If Not state<br>			DrawImage(card, 100, 100)<br>			DrawImage(card, 400, 100)<br>		Else<br>			SetAlpha 0.5<br>			DrawImage(grab, 0, 0)<br>			SetAlpha 1<br>			DrawImage(card, 300, 100)<br>		EndIf<br>		<br>	End<br><br>	Function ScreenGrab:Image(X:Int, Y:Int, Width:Int, Height:Int)<br>	<br>		If X &lt; 0 Error "Screen Grab Error"<br>		If Y&lt;0 Error "Screen Grab Error"<br>		If (X+Width)&gt;DeviceWidth() Error "Screen Grab Error"<br>		If (Y + Height) &gt; DeviceHeight() Error "Screen Grab Error"<br><br>		Local ScreenShot:Image<br>		ScreenShot = CreateImage(Width,Height)<br>		Local pixels:Int[] =New Int[Width*Height]<br>		ReadPixels(pixels, X, Y, Width,Height)<br>		ScreenShot.WritePixels(pixels, 0, 0, Width,Height)<br>		Return ScreenShot<br><br>	End<br><br>&lt;/code&gt;<br><br>Obviously, in this case the "grabbed" screen is the same every time but in the game proper it'll vary.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="2099179"></a>

<a name="2099180"></a>

<a name="2099181"></a>

<a name="2099182"></a>

<a name="2099183"></a>

<a name="2099184"></a>

<a name="2099185"></a>

<a name="2099188"></a>

<a name="2099189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ordigdug</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> For Forum Codes:<br>--  Click "forum codes" link above and to the right of post window<br>--     &lt; &gt; needs to be replaced with [ ]<br><br>As for your issue:<br>     MouseHit() does not work on touch screens, use TouchHit() <br><br></td></tr></table><br>
<a name="2099178"></a>

<a name="2099190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TVCruelty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, thanks. Didn't notice the forum codes link!<br><br>The MouseHit() definitely isn't the problem - it does work on iOS, in fact, and reduces my platform-specific code.<br><br>So, that apart, any idea why my screen-grabbed image isn't showing up? Like I said, this all works fine on other platforms. <br><br></td></tr></table><br>
<a name="2099214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pakz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe post it in the bugs forum? If it works on other targets and not on the other then I would think it is a bug. I had the same thing not so long ago with the flash target which turned out to be a bug. <br><br></td></tr></table><br>
<a name="2099215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TVCruelty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks @Pakz, I'll do that.<br><br>(If it is a bug I'd be surprised that no-one else has ever come across it - but I guess stranger things have happened!) <br><br></td></tr></table><br>
<a name="2099220"></a>

<a name="2099222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pakz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Monkey does not have that many users. So bugs tend to stay undiscovered.<br><br>edit:<br><br>You need a mac right to compile for ipad? I have a ipad but no mac. <br><br></td></tr></table><br>
<a name="2099224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TVCruelty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, you need a Mac. You compile on the Mac to the iOS target, then load the resulting project into Xcode. After that it's a "simple" matter of subscribing to the dev programme and registering your iPad as a development machine...<br><br>The next step, to actually submit to the App Store, is another whole world of pain that I haven't got clear in my head yet! <br><br></td></tr></table><br>
<a name="2099225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TVCruelty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> By the way, if anyone is able to test my code on an iOS device I'd appreciate your feedback. <br><br></td></tr></table><br>
<a name="2099233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Monkey does not have that many users. So bugs tend to stay undiscovered<br> <br></div><br><br>Also, most Monkey users I expect understand that using readpixels / writepixels in a hardware accelerated environment is a very poor solution to most problems so the commands themselves are left on the shelf.<br><br>In regards to modern iPad, allocating retina display sized images in itself is likely to produce more performance hick-ups and memory thrashing than simply compositing the display by drawing all the component images every frame. <br><br></td></tr></table><br>
<a name="2099243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TVCruelty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well OK but my intention is to use this technique only occasionally - it's not so unusual to want to, for example, grab what's on screen, alpha it down and place a dialog on top, is it? My game is a strategy game so it's not going to be happening at pace.<br><br>Like Pakz suggested, I'll probably raise this as a bug as soon as I've had chance to do some more tests, because, whether you approve of it or not, it should work. <br><br></td></tr></table><br>
<a name="2099245"></a>

<a name="2099246"></a>

<a name="2099247"></a>

<a name="2099248"></a>

<a name="2099249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  whether you approve of it or not, it should work  <br></div><br><br>I totally agree.<br><br>Just be aware that older iPads especially have very little memory and that drawing the scene plus a solid color full screen rectangle with alpha plus your dialog is likely to be a lot less taxing on such a platform than the use of display sized image grabs. <br><br></td></tr></table><br>
<a name="2099258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ReadPixels / WritePixels were one of the chief demands of Monkey users from the start.  The purpose is generally pre-level graphic composition, for which speed and efficiemcy are not irrelevant,  Sure, people do try to use it for things it's not suited to, but that doesn't alter the fact that it's very important for the things that need it. <br><br></td></tr></table><br>
<a name="2099276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pakz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I needed readpixels and writepixels for a space invaders game. Where you and the aliens destroy the blocks on the bottom of the screen. From what I tried with the feature it is fast enough for things like that. Worms (original blitz game) had destructable terrain. Modifying images is needed for that to. I had only had a speed problem with monkey in html5 with the setcolor command. Luckely someone told me About that. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
