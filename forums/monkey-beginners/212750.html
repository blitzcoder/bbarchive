<!DOCTYPE html><html lang="en" ><head ><title >almost there</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >almost there</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=528" >Monkey Beginners</a>/<a href="#bottom" >almost there</a><br><br>
<a name="2125490"></a>

<a name="2125491"></a>

<a name="2125492"></a>

<a name="2125493"></a>

<a name="2125494"></a>

<a name="2125495"></a>

<a name="2125496"></a>

<a name="2125497"></a>

<a name="2125498"></a>

<a name="2125499"></a>

<a name="2125500"></a>

<a name="2125501"></a>

<a name="2125502"></a>

<a name="2125503"></a>

<a name="2125504"></a>

<a name="2125505"></a>

<a name="2125512"></a>

<a name="2125513"></a>

<a name="2125514"></a>

<a name="2125515"></a>

<a name="2125516"></a>

<a name="2125519"></a>

<a name="2125520"></a>

<a name="2125521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dubbsta</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> getting the hang of this, im stuck but feel close. doing a tetris clone and my problem is in the shape class. all the commented out code was to render each shape separately, and worked great, but i wanted to be able to put the shapes in a list so im trying to keep the shape maker in one method. so i added more parameters to the constructor the only problem i seem to be having is how to pass the shape fields{t:int[][])into the block parameter <br>ive tried different combinations but cant find the right one<br><br>edit: just had a thought should each shape have its own sub class then called to the array? will give a try<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Import mojo

Global gcube:Image
global rcube:Image
global bcube:Image
global pkcube:Image
Global ycube:Image

Class shape
  Field color:int
  Field img:Image
  Field block:int
  Field x:Int ,y:Int
  Field rowmax:Int
  Field colmax:Int
  
  Field t:Int[][]=[[1,1,1],
		       [0,1,0]] 
				 
  Field z:Int[][]=[[1,1,0],
			[0,1,1]]

  Field o:Int[][]=[[1,1],
			[1,1]]
				 
  Field I:Int[][]=[[1],
                      [1],
                      [1],
                      [1]]
                 
  Field l:Int[][]=[[1,0],
                       [1,0],
                       [1,1]]
             
                 
				Method New(img:Image,x:Int,y:Int,
						  rowmax:Int,colmax:Int )
						  
				 Self.rowmax = rowmax
				 Self.colmax =colmax
				 Self.block = block 
				 Self.img= img
			     Self.x = x
			     Self.y = y
			     Self.color = color
			    End 
            Method Draw()
            
            	 For Local i:Int = 0 To rowmax
             	For Local j:Int = 0 To colmax   
             	   If t[j][i] = 1
             	  DrawImage(img,x+i*77/2,y+j*77/2,0,.5,.5)
             	    End 
             	 End 
             	 End 
            End
            
            
        #rem   Method Draw_t(gcube:Image,x:Int)
              Self.gcube = gcube
             For Local i:Int = 0 To 2
             	For Local j:Int = 0 To 1   
             	   If t[j][i] = 1
             	  DrawImage(gcube,x+i*77/2,50+j*77/2,0,.5,.5)
             	   End 
             	End 
             End  
           End 
           
           Method Draw_z(rcube:Image,x:int)
              Self.rcube = rcube
             For Local i:Int = 0 To 2
             	For Local j:Int = 0 To 1 
             	   If z[j][i] = 1
             	  DrawImage(rcube,x+i*77/2,50+j*77/2,0,.5,.5)
             	   End 
             	End 
             End  
           End 

			Method Draw_o(bcube:Image,x:int)
              Self.bcube = rcube
             For Local i:Int = 0 To 1
             	For Local j:Int = 0 To 1 
             	   If o[i][j] = 1
             	  DrawImage(bcube,x+i*77/2,300+j*77/2,0,.5,.5)
             	   End 
             	End 
             End  
           End 
			
			 Method Draw_i(pkcube:Image,x:int)
              Self.pkcube = pkcube
             For Local i:Int = 0 To 1-1
             	For Local j:Int = 0 To 3 
             	   If I[j][i] = 1
             	  DrawImage(pkcube,x+i*78/2,77/2+j*77/2,0,.5,.5)
             	   End 
             	End 
             End  
           End 
           
           Method Draw_l(ycube:Image,x:int)
              Self.ycube = ycube
             For Local i:Int = 0 To 1
             	For Local j:Int = 0 To 2 
             	   If l[j][i] = 1
             	  DrawImage(ycube,x+i*78/2,77/2+j*77/2,0,.5,.5)
             	   End 
             	End 
             End  
           End 
			Method move()
			    If KeyHit(KEY_D)	 	
			 	 x=x+38	 	   
			    End 
			End   
			#end 
End class


Class drop
 
	Field size:float
	Field gravity:Float
	Field droplet:Image
	Field x:Int,y:Int


		Method New(x:Int,y:Int,droplet:Image)
		    Self.droplet = droplet
		  	Self.x = x 
		  	Self.y = y
		    Self.size = size
		    gravity = Rnd(5.0,8.0)
		    size = Rnd(0.2,.5)	
		End 
		
		Method fall()
		    Self.gravity = gravity
		  	y+= gravity	
		End 
		
		Method Draw()
			DrawImage(droplet,x,y,0,size,size)
		End 
		
End Class	




Class bg 

  Field x:Int
  Field y:Int
  Field speed:Int
  Field bg1:Image
  Field name:String
 
  
		Method New(x:Int,y:Int,bg1:Image)
		  Self.x = x
		  Self.y = y 
		  Self.bg1 = bg1
		End 
		
		Method scroll(speed:Int)
		
		   Self.speed = speed

		 
		   x = x + speed
		   
		End 
		
		Method create(name:String)
		Self.name = name
		  bg1 = LoadImage("bg.png ")
		  
		End   
		  
		Method Draw()
		
		  DrawImage (bg1, x,y)
		
		End
		 
End Class
   
   
   
Class test2 Extends App
 Field ScreenHeight = 480
  Field ScreenWidth = 640
  
  Field background:bg 
  Field bg1:Image
  Field bg2:bg
  Field droplet:Image
  Field rain:drop
  
  Field bgList:List&lt;bg&gt; = New List&lt;bg&gt;()
  Field dropList:List&lt;drop&gt; = New List&lt;drop&gt;()
  
  Field L:shape
  Field I:shape
  Field T:shape
  Field Z:shape
  Field O:shape

  
  Field shapeList:List&lt;shape&gt; = New List&lt;shape&gt;()
  
  
		Method OnCreate()
		  SetUpdateRate(60)

		  ycube = LoadImage("yellowcube.png")		   
		  pkcube = LoadImage("pinkcube.png")									 
		  gcube = LoadImage("greencube.png")
		  rcube = LoadImage("redcube.png")
		  bcube = LoadImage("bluecube.png")							
		   	 'img,x,y,rmax,cmax,block		          *****************	
		  T =New shape(gcube,150, 150,1,2,[1,1,1],    '&lt;&lt;&lt;&lt;&lt;PROBLEM AREA
				                          [0,1,0]])	  '****************
		  L = New shape                               
		  I = New shape
		  Z = New shape
		  O = New shape
		 
			 
			 
		   'PlayMusic ("rain.mp3",1)

		   rain = New drop
		   droplet = LoadImage("drop.png") 
		   

		   background  = New bg
		   bg1 = LoadImage("bg2.png")
		  ' background.create("bg.png")
		  bg2 = New bg(0,0,bg1)
		  bgList.AddLast(New bg(0,0,bg1))   
		  
		End Method 
		
		
		Method OnUpdate()

		 dropList.AddLast(New drop(Rnd(ScreenWidth),-30,droplet))
		 
		  For Local rain:drop = Eachin dropList
			rain.fall()
		  End 
		  
			  	For Local rain:drop = Eachin dropList
			     If rain.y &gt; 520
			     
			      dropList.RemoveFirst()
			      
			     End 
		 		End 
	 
		End 
		
		
		Method OnRender()
		  Cls(0,0,0)
		  
		   DrawText(bgList.Count,20,20)
		   bg2.Draw()
		   
		   For Local rain:drop = Eachin dropList
		      rain.Draw()
		   End 
		   
		    T.Draw()
		   'Z.Draw_z(rcube,200) 
		   'O.Draw_o(bcube,50)
		   'I.Draw_i(pkcube,380)
		   'L.Draw_l(ycube,500)
		   'SetColor(88,37,82)
		   'DrawRect(0,0,ScreenWidth,ScreenHeight)
		   
		End 
		
End 

Function Main()

 	New test2()
 	
End 
</textarea><br><br>didnt think about it but if commenting out would help more i will. <br><br></td></tr></table><br>
<a name="2125522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dubbsta</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> took some hours but got it!! <br><br></td></tr></table><br>
<a name="2125525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You may want to copy the array for each shape into an individual shape object, so you can freely rotate it etc. without worrying about corrupting the original data (of course there are lots of ways to do this).  Your arrays would be in a 'ShapeFactory' object that you can ask to spit out a new Shape of a given kind at any time.  Or you could skip the factory class altogether and have Shape initialisers or constructors that fill in the fields of a newly-created shape (I'd probably do it the latter way).<br><br>(Just a way of thinking about it - if it's working fine now don't worry!). <br><br></td></tr></table><br>
<a name="2125531"></a>

<a name="2125532"></a>

<a name="2125533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dubbsta</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah was thinking of something like that but wasnt sure how to implement. would i be possible rotate each piece in a matrix, i will be looking into a shape factory though<br>this  is my current code<br><br>ps. my code is a little bit neater but the codebox shifts things around a bit<br><pre class=code>
Import mojo

Global gcube:Image
global rcube:Image
global bcube:Image
global pkcube:Image
Global ycube:Image

Class shape 
  Field piece:Int[][]
  Field color:int
  Field img:Image
  
  Field x:Int ,y:Int
  Field rowmax:Int
  Field colmax:Int
  Field gravity:Int 
  
  
				Method New(img:Image,x:Int,y:Int,
						  rowmax:Int,colmax:Int,piece:int[][])
				 	  
				 Self.rowmax = rowmax
				 Self.colmax =colmax
				 Self.img= img
			     Self.x = x
			     Self.y = y
			     Self.piece = piece
			    End 
            Method Draw()
            
              For Local i:Int = 0 To rowmax
             	For Local j:Int = 0 To colmax   
             	   If piece[j][i] = 1
             	     DrawImage(img,x+i*26,y+j*25,0,.5,.5)
             	   End 
             	 End 
              End 
            End
            
           ' Method t()
           '           [[1,1,1],
           '           [0,1,0]]
           'End 
            
            Method move(gravity:Int)
             Self.gravity = gravity
             
               If KeyHit(KEY_RIGHT)
                  x+=26
               Elseif KeyHit(KEY_LEFT)
               	  x-=26
               End 
               
                ' y+=gravity 
               
            End 
            
        
End class


Class drop

  Field size:float
  Field gravity:Float
  Field droplet:Image
  Field x:Int,y:Int


		Method New(x:Int,y:Int,droplet:Image)
			
		    Self.droplet = droplet
		  	Self.x = x 
		  	Self.y = y
		    Self.size = size
		    gravity = Rnd(5.0,8.0)
		    size = Rnd(0.2,.5)	
		End 
		
		Method fall()
		    Self.gravity = gravity
		  	y+= gravity	
		End 
		
		Method Draw()
			DrawImage(droplet,x,y,0,size,size)
		End 
		
End Class	




Class bg 

  Field x:Int
  Field y:Int
  Field speed:Int
  Field bg1:Image
  Field name:String
 
  
		Method New(x:Int,y:Int,bg1:Image)
		  Self.x = x
		  Self.y = y 
		  Self.bg1 = bg1
		End 
		
		Method scroll(speed:Int)
		
		   Self.speed = speed
		   x = x + speed
		   
		End 
		
		Method create(name:String)
		Self.name = name
		  bg1 = LoadImage("bg.png ")
		  
		End   
		  
		Method Draw()
		
		  DrawImage (bg1, x,y)
		
		End
		 
End Class
   
   
   
Class test2 Extends App
  Field ScreenHeight = 480
  Field ScreenWidth = 640 
  
  Field shapePicker:Int = 2
  Field background:bg 
  Field bg1:Image  
  Field bg2:bg  
  Field droplet:Image  
  Field rain:drop
  
  Field bgList:List&lt;bg&gt; = New List&lt;bg&gt;() 
  Field dropList:List&lt;drop&gt; = New List&lt;drop&gt;()
  
  Field L:shape
  Field I:shape
  Field T:shape
  Field Z:shape
  Field O:shape
  
  Field shapeList:List&lt;shape&gt; = New List&lt;shape&gt;()
  
  
		Method OnCreate()
		  SetUpdateRate(60)
		  
		  				  
				  ycube = LoadImage("yellowcubesmall.png")		   
				  pkcube = LoadImage("pinkcubesmall.png")									 
				  rcube = LoadImage("redcubesmall.png")
				  bcube = LoadImage("bluecubesmall.png")
				  gcube = LoadImage("greencubesmall.png")			
				  
		 For Local i:Int = 0 To 4
		    
	     End   
	     
		        If shapePicker = 1 
		 		  shapeList.AddLast(New shape(gcube,150, 150,2,1,[[1,1,1],[0,1,0]]))  'T
		 		Elseif shapePicker = 2
		 		  shapeList.AddLast(New shape(ycube,ScreenWidth/2, 0,2,1,[[1,1,0],[0,1,1]]))  'Z
		 		Elseif shapePicker = 3 
		 		  shapeList.AddLast(New shape(bcube,250, 250,0,3,[[1],[1],[1],[1]]))  'I
		 		Elseif shapePicker = 4 
		 		  shapeList.AddLast(New shape(pkcube,250, 250,1,1,[[1,1],[1,1]]))     'O
		 		Elseif shapePicker = 5  
		 		  shapeList.AddLast(New shape(rcube,250, 250,1,2,[[1,0],[1,0],[1,1]]))'L
		 		End 	  	                           	        
				 
		  
		   'PlayMusic ("rain.mp3",1)

		   rain = New drop
		   droplet = LoadImage("drop.png") 
		   

		   background  = New bg
		   bg1 = LoadImage("bg2.png")
		  ' background.create("bg.png")
		   bg2 = New bg(0,0,bg1)
		   bgList.AddLast(New bg(0,0,bg1))   
		  
		End Method 
		
		
		Method OnUpdate() 
		
			For Local i:= Eachin shapeList
			
			   i.move(2)
			   
			End 
		
		 dropList.AddLast(New drop(Rnd(ScreenWidth),0,droplet))
		 
		  For Local rain:drop = Eachin dropList
			rain.fall()
		  End 
		  
			  	For Local rain:drop = Eachin dropList
			     If rain.y &gt; 520
			     
			      dropList.RemoveFirst()
			      
			     End 
		 		End  
	 
		End 
		
		
		Method OnRender()
		  Cls(0,0,0)
		   
		   'bg2.Draw()
		   
		   For Local rain:drop = Eachin dropList
		       rain.Draw()
		   End 
		    
		   For Local shape:= Eachin shapeList		   
		       shape.Draw()
		    End 
		    SetColor(255,66,255)

		      SetAlpha .7
		    DrawRect(10,10,222,222)	
		    DrawOval(34,13,30,34)
		    
		    T.Draw()
		    Z.Draw() 
		    O.Draw()
		    I.Draw()
		    L.Draw()
           'nothing renders past here???
		   
		  
		 	
		   
		End 
		
End 

Function Main()

 	New test2()
 	
End 

</pre><br><br>quick thing, the bottom i couldnt render anything after the x.Draw's i had to put the  DrawRect before them, is there a reason why??? <br><br></td></tr></table><br>
<a name="2125534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just drawing the shapes rotated won't work - they won't know when they are colliding / overlapping non-empty squares on the board (assuming a norrmal Tetris-style game).  You need to be able to tell that if a shape falls one square, it will be over (say) (3,4), (4, 4), (4, 5) and (4, 6), and then check whether any of these squares are full, in which case it must now stop falling and 'stick' to the board (you add the shape's current squares to the board, and discard the shape).  Then you check the board for horizontal lines, and collapse it if there are any.  Then you release the next shape at the top of the play area. And so on. Every so many shapes, increase the fall speed a bit. No room to release a shape?  Game over!<br><br>(Again, that's plain old Tetris,you could be panning something different, but it will be the same kind of logic.)<br><br>I don't think you ever initialised T, Z, O, I and L. <br><br></td></tr></table><br>
<a name="2125535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dubbsta</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok sounds good, yes t,z,o,i,l are good they are initialized at OnCreate, they render fine the problem is anything drawn after that line wont render i dont know why <br><br></td></tr></table><br>
<a name="2125537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> They don't render at all.  You add a new shape to your list.  But nowhere does it sayT = New Shape(...).  T and the others are null as far as I can see.  So when T.Draw is called, the program crashes.<br><br>Also, you have<br><pre class=code>
For Local i:Int = 1 To 4
End
</pre><br><br>There's some error there. <br><br></td></tr></table><br>
<a name="2125539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dubbsta</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ohhhhh yes you're right I changed the whole thing not needing those calls anymore...doe <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
