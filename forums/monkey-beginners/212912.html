<!DOCTYPE html><html lang="en" ><head ><title >Need help with understanding the code</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need help with understanding the code</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=528" >Monkey Beginners</a>/<a href="#bottom" >Need help with understanding the code</a><br><br>
<a name="2127430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CanisLupus</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been following this tutorial:<br><a href="http://monkeygameprogramming.blogspot.co.uk/2015/01/monkey-x-2d-scrolling-platformer-with.html" target="_blank">http://monkeygameprogramming.blogspot.co.uk/2015/01/monkey-x-2d-scrolling-platformer-with.html</a><br><br>I don't understand the codes below:<br>'player springy collision<br>Function psc:Bool(offsetx:Int=0,offsety:Int=0)<br>    Local cx = (p.x+offsetx)/tilewidth+mapx<br>    Local cy = (p.y+offsety)/tileheight+mapy<br>    For Local y2=cy-1 Until cy+4<br>    For Local x2=cx-1 Until cx+4<br>        If x2&gt;=0 And x2&lt;mapwidth And y2&gt;=0 And y2&lt;mapheight<br>            If map[y2][x2] = 2<br>                Local x3 = (x2-mapx)*tilewidth-32+mapsx<br>                Local y3 = (y2-mapy)*tileheight+mapsy<br>                If rectsoverlap(p.x+offsetx,p.y+offsety,p.w,p.h,x3,y3+tileheight/2,tilewidth,tileheight/2) = True<br>                    Return True<br>                End If<br>            End If<br>        End If<br>    Next<br>    Next<br>    Return False<br>End Function<br><br>'player collide with solid blocks true/false<br>Function ptc:Bool(offsetx:Int=0,offsety:Int=0)<br>    Local cx = (p.x+offsetx)/tilewidth+mapx<br>    Local cy = (p.y+offsety)/tileheight+mapy<br>    For Local y2=cy-1 Until cy+4<br>    For Local x2=cx-1 Until cx+4<br>        If x2&gt;=0 And x2&lt;mapwidth And y2&gt;=0 And y2&lt;mapheight<br>            If map[y2][x2] = 1 <br>                Local x3 = (x2-mapx)*tilewidth-32+mapsx<br>                Local y3 = (y2-mapy)*tileheight+mapsy<br>                If rectsoverlap(p.x+offsetx,p.y+offsety,p.w,p.h,x3,y3,tilewidth,tileheight) = True<br>                    Return True<br>                End If<br>            End If<br>        End If<br>    Next<br>    Next<br>    Return False<br>End Function<br><br>Function rectsoverlap:Bool(x1:Int, y1:Int, w1:Int, h1:Int, x2:Int, y2:Int, w2:Int, h2:Int)<br>    If x1 &gt;= (x2 + w2) Or (x1 + w1) &lt;= x2 Then Return False<br>    If y1 &gt;= (y2 + h2) Or (y1 + h1) &lt;= y2 Then Return False<br>    Return True<br>End Function<br><br>Can someone please explain what each line means <br><br></td></tr></table><br>
<a name="2127432"></a>

<a name="2127433"></a>

<a name="2127434"></a>

<a name="2127436"></a>

<a name="2127437"></a>

<a name="2127438"></a>

<a name="2127439"></a>

<a name="2127440"></a>

<a name="2127441"></a>

<a name="2127442"></a>

<a name="2127443"></a>

<a name="2127444"></a>

<a name="2127445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would suggest that you start with <a href="http://www.monkey-x.com/Community/posts.php?topic=3318" target="_blank">Invader Jim's tutorials</a> first. They maybe old, but they are still relevant.<br>Pakz code needs more comments to explain what's going on.<br>With out going through the whole code<br><br>This bit is passing an offset to be added to the players position. In other words the area to search to one side of the player. It expects a result of the data type bool (a Boolean true or false value) to be passed back to the calling code.<br>Function psc:Bool(offsetx:Int=0,offsety:Int=0)<br><br>The next two are converting the players screen position with offset to column/row for the map array<br>Local cx = (p.x+offsetx)/tilewidth+mapx<br>Local cy = (p.y+offsety)/tileheight+mapy<br><br>The next 13 lines are doing a limited scan of the map array from the players offset position within the map array to see if the player has collided with anything.<br>For Local y2=cy-1 Until cy+4<br>For Local x2=cx-1 Until cx+4<br><br>This line is checking that for loops are within the map array before getting the value stored. If it didn't, then it would generate an index out of range error.<br>If x2&gt;=0 And x2&lt;mapwidth And y2&gt;=0 And y2&lt;mapheight<br><br>This line is checking the map array to see if the value at y2, x2 is equal to 2. This is the code given to whatever is to be checked for.<br>If map[y2][x2] = 2<br><br>This line is now converting the location of the detected map cell into screen coordinates<br>Local x3 = (x2-mapx)*tilewidth-32+mapsx<br>Local y3 = (y2-mapy)*tileheight+mapsy<br><br>This line is checking if the rectangle that represents the player's offset is in collision with the rectangle that represents whatever the player has collided with.<br>The rectsoverlap is a function that will return a value of True or False. If it's true, then it breaks out of the for/next loops and returns back the whatever<br>originally call the function with a result of true<br>If rectsoverlap(p.x+offsetx,p.y+offsety,p.w,p.h,x3,y3+tileheight/2,tilewidth,tileheight/2) = True<br>Return True<br><br>The rest are clousures for the If statments and For loops<br>End If<br>End If<br>End If<br>Next<br>Next<br><br>If the program reaches here, then nothing was detected, so return a value of false back to whatever called the function<br>Return False<br>End Function<br><br>This function would be easy to visualise whats happening if you use graph paper like they use in school to work out shapes and trigonometry.<br>Function rectsoverlap:Bool(x1:Int, y1:Int, w1:Int, h1:Int, x2:Int, y2:Int, w2:Int, h2:Int)<br>If x1 &gt;= (x2 + w2) Or (x1 + w1) &lt;= x2 Then Return False<br>If y1 &gt;= (y2 + h2) Or (y1 + h1) &lt;= y2 Then Return False<br>Return True<br>End Function<br><br><a href="http://www.geeksforgeeks.org/find-two-rectangles-overlap/" target="_blank">This</a> should help understanding whats happening with the rectsoverlap above code.<br><br>Use a calculator to work out what happening with the relationship between the screen and the map. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
