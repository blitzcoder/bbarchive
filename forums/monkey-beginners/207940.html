<!DOCTYPE html><html lang="en" ><head ><title >Recursion performance in Monkey?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Recursion performance in Monkey?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=528" >Monkey Beginners</a>/<a href="#bottom" >Recursion performance in Monkey?</a><br><br>
<a name="2078793"></a>

<a name="2078794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Aman</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does Monkey use Tail call optimization or does it suffer from allocating a new stack frame for every call?<br><br>I am just trying to figure out the most efficient way to handle iteration. <br><br></td></tr></table><br>
<a name="2078803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It depends on the target language. Typical TCO requires runtime support, and Monkey has no 'runtime'. Monkey could, of course, convert tail recursive functions into loops, but there are problems with mutual recursion.<br><br>What do you mean by efficient? TCO is a space optimization, not a speed one. If you are running out of space, you could always convert your recursion to a loop by hand.<br><br>Off the top of my head:<br>C++ doesn't guarantee TCO, but may apply it. Javascript generally doesn't have TCO, but I believe V8 does, and the new spec calls for proper tail calls (I think, not a Javascript buff). I don't think Flash does. Java definitely does not. I believe C# (XNA) does have TCO. <br><br></td></tr></table><br>
<a name="2078801"></a>

<a name="2078802"></a>

<a name="2078800"></a>

<a name="2078812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> TCO is basically a functional language thing IMO, because in those you are using recursion all the time.  Monkey and its targets are imperative languages which mostly only use recursion when they actually want to recurse, so I would not expect any special optimisations.  You should probably avoid deep recursion for flood-filling and such in these languages, and unroll by hand.<br><br>Lack of threading can be an issue too - if you're doing a chess game or similar in Monkey you'll probably want to make your own stack so you can come out of a long analysis a few times per second to update the screen. <br><br></td></tr></table><br>
<a name="2078826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Aman</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. I got used to do stuff recursively I noticed some problems on some targets but not all. Looks like I am going to start avoiding recursion.Time to rewrite a good chunk of my code. <br><br></td></tr></table><br>
<a name="2078877"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I got big problems when tryed to do flood-fill. So I also had to replace my recursive algos with iterative algos on the java target. <br><br></td></tr></table><br>
<a name="2078888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't have to be scared of using recursion, just very deep recursion. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
