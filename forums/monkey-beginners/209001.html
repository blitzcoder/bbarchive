<!DOCTYPE html><html lang="en" ><head ><title >Detecting Mouse Click once only</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Detecting Mouse Click once only</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=528" >Monkey Beginners</a>/<a href="#bottom" >Detecting Mouse Click once only</a><br><br>
<a name="2094332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've managed to sort this problem out, but I'm sure there is an easier way which someone can help me with.  It's for things like clicking on a button or image to select it.<br><br>e.g. <br><br><pre class=code>
Global ImageSelected:Bool = True

Method OnUpdate()
  If MouseDown()
     if ImageSelected Then ImageSelected = False Else ImageSelected = True
 Endif
End
</pre><br><br>If this code is run, the ImageSelected variable with alternate between True &amp; False until the mouse is released.  What I want is for it to change only once until the mouse button is released, and then change again if the use clicks again.<br><br>I thought it would be a simple matter of putting a Repeat...Until NOT MouseDown() but this doesn't work - I'm guessing with the way Monkey Apps update (30 or whatever times a second) it just jumps out of the Repeat...Until loop - is that correct?<br><br>I won't post the full code of how I got around this, basically it was making another variable like MouseStillDown:Bool and then setting it inside the MouseDown() code.<br><br><pre class=code>
Global MouseStillDown:Bool = False

If MouseDown() and NOT MouseStillDown Then
  MouseStillDown = True
  If ImageSelected Then ImageSelected = False Else ImageSelected = True
Endif

If NOT MouseDown() Then MouseStillDown = False
</pre><br><br>Guess what I'm asking is this, is the 2nd way and the way I'm doing it the correct way, or is there something easier that I'm missing? <br><br></td></tr></table><br>
<a name="2094335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think you're missing something, you probably need your own custom MouseUp state or event. Basically you don't want to register a click when the user is just starting to click the button, he could be dragging the mouse away while holding the mouse button down.<br>If the user releases the click (MouseUp) inside the same button area he started to click, only then register it as a button press. Then, immediately after you've handled the click, set the MouseUp state back to false.<br><br>Alternatively, you can use MouseHit() and see if that yields better results for you. <br><br></td></tr></table><br>
<a name="2094334"></a>

<a name="2094337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah the MouseUp() makes a lot of sense for the exact reason you specified, but that also means checking that the mouse was first clicked on the object and then release while also on the object.<br><br>As long as the way I'm doing this currently is Ok, that's fine, I just thought there may have been a simpler way of doing it.<br><br>I haven't looked at any of the GUI modules to see how they work, and I really don't know as much about Monkey as I ought to.  I'm guessing you could define each button/screen area as an Object/Class and have a MouseDown() &amp; MouseUp() method to trigger when they are clicked.<br><br>Must go back and watch some of the more advanced Tutorials by InvaderJim, I'm sure there is some stuff in there that will address the above Class creation. <br><br></td></tr></table><br>
<a name="2094336"></a>

<a name="2094342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The easiest way to do this is to use the MouseHit() function.  That will tell you if the mouse was clicked since the previous update,<br><br>If MouseHit( MOUSE_LEFT ) &gt; 0 And MouseIsOverButton()<br>DoButtonAction()<br>End<br><br>MouseDown() would be used if you were dragging or drawing something. <br><br></td></tr></table><br>
<a name="2094343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> MouseHit detects clicks, MouseDown detects button status (pressed or not). To sumarize, MouseHit will be "true" when the mouse button was up on previous frame, and it's down on current frame. This, or when mouse button was down in previous frame and it is up on current frame. That makes it be true only once per click, so it's useful to program buttons and the like. <br><br></td></tr></table><br>
<a name="2094347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ElectricBoogaloo</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tend to use a global "mdwn" variable, and set it upon "click".<br>The problem with mousehit is that it only works on that exact frame, so if you miss it by a fraction of a second, you've lost the "tap"<br>Instead, I check with MouseDown, then, upon "first use", I flag mdwn=1.  Upon mousedown=0, I reset mdwn=0.<br>Basically, a little DIY goes a long way. <br><br></td></tr></table><br>
<a name="2094351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Instead of handling "hit" you might be interested in "click". "click" means: it was once down, is now up AND the time since that "up" is at least X milliseconds.<br><br>Why? How will you know if it is a "click" or a "doubleclick" (or triple or ...). Means: only use "hit" if you do not care for doubleclicks or others. Keep this in mind if your code evolves into something like a gui system.<br><br>To handle such things you might create your own mousemanager storing state data.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="2094416"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> MouseHit(), unless it's bugged, is per update, not per rendering frame.  Check it every update and you will be fine. <br><br>Of course you can track things any way you want instead - I do myself.  But MouseHit() is the built-in function to allow you to test button-clicks easily. <br><br></td></tr></table><br>
<a name="2094419"></a>

<a name="2094420"></a>

<a name="2094421"></a>

<a name="2094422"></a>

<a name="2094423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Like said this does not "test for button clicks" but for "button hits" - which is something different (according to Microsoft  - they handle it similar to the thing I described -&gt; hit + waitingTime = click). Please make sure that you store the "hit position" as it might differ to the current one (clicking while moving the mouse).<br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="2094458"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, but classic Windows buttons are different - they are 100% mouse oriented and they fire on release if the mouse is still over the button.  If you put down the mouse on a button, you can change your mind by dragging it away before you release it,.<br><br>It seems to me that with modern touch interfaces, you may as well just respond immediately to a mouse-down in a button area.  That is simple and works whether there is a mouse or touch interface.<br><br>  Maybe that's because I am multi-targeting, like many Monkey users.  If you're targeting one device only, I guess it makes sense to have a less generic interface. <br><br></td></tr></table><br>
<a name="2094477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm regarding "touch" and "similar behaviour" you are absolutely right that it might better to rely on "hit".<br><br>I personally always liked that "arghh... i wanted to click that other button"-rescue-method. It is of course also available on touch devices - as long as you keep your finger in touch with the device.<br><br>For me it is just the question of whether I need to distinguish between single and double clicks/taps. Then of course it is also a matter if I want to support "drag and drop", if you "click" on hit already, you never know if the finger/mousebutton was down for a specific period. That is why for a more complicated "gui" you will still need multiple events: mousehit (was up, is now down), mouseClick (was "hit" and is now up + waited enough time), mouseDoubleClick(mouseClick + hitCount = 2), ... A TryDrag (or startDrag) needs to know then, if the gui element was "clicked" or not - so normally it should react on "mouseDown + waitedTime" or "mouseDown + mouseMovedDistance&gt;value".<br><br>For a normal "menu button" this is pure overhead and you might just choose between: onHit or onClick. <br><br>BTW: good idea with "onRelease" ... this is missing in my blitzmax-gui-lib and might be of use. <br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
