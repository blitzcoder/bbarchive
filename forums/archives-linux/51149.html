<!DOCTYPE html><html lang="en" ><head ><title >Crashing on exit</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Crashing on exit</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=109" >Linux Discussion</a>/<a href="#bottom" >Crashing on exit</a><br><br>
<a name="570340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just wondering if anyone else has had this problem and whether there is any way around it.<br><br>Basically, I have MEPIS installed, which works great with all my hardware and BlitzMax programs, but I am having problems with two of my programs (and as luck would have it, the two I want to release as freeware!).  They work without a problem until you come to exit, at which point Linux and possibly the programs themselves lock up!  This only happens when the games are ran in full screen mode (windowed mode runs perfectly).<br><br>Now for the weird bit... Everything else I have written in BlitzMax works without a problem - full screen, windowed and at all resolutions from 640x480 up to 1024x768 (the games run at 1024x768 and 800x600, btw).<br><br>At first I thought this was an audio problem, as that was the only difference between my games and the various other stuff I have written.  However, I have completely stripped out all audio from one of the games and the same thing happens!<br><br>Here's what else I have done.<br><br>1. Added EndGraphics before End<br>2. Manually freed all media and used FlushMem before EndGraphics.<br>3. Loaded graphics instead of using Incbin.<br>4. Taken out End<br><br>None of this has had any effect.  I even forced the program to write to a text file as it closed to see if I could spot where it halted, if at all.  It goes through every step without a problem, so either my game is crashing at the point it closes or Linux is crashing when it tries to re-establish the desktop.<br><br>Incidentally, the result of the crash is that the game screen can still be seen on top of the desktop in the upper left corner of the screen.  The IDE and the rest of the desktop is behind this 'window'.  I run my desktop at 1280x1024.<br><br>I'm running MEPIS, a Debian based Linux, Kernal 2.6, KDE desktop (the latest version) and I have an ATI Radeon 9800 Pro graphics card.<br><br>So, does anybody have any ideas on what to try next? <br><br></td></tr></table><br>
<a name="570353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig Watson</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can try the programs out for you if you want, seeing as they're freeware anyway.  You could also try to run it from a terminal and see if there are any error messages being written back - assuming of course you can find a way to see the terminal once the app has crashed.<br><br>I notice you're using an ATI graphics card.  Do you happen to know what version of their drivers you're using?  I have NVidia on both my machines at home, so if it works without crashing, might be a clue.<br><br>FYI: If X craps up like that, you can use Ctrl+Alt+Backspace to kill it, and it should return you to your login prompt. <br><br></td></tr></table><br>
<a name="570376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok.  The current full version, which runs in full-screen with all the audio, can be downloaded from <a href="http://www.sos-software.co.uk/downloads/MaxInvaders_Linux.zip" target="_blank">here</a>.  It's in ZIP form, so you'll need to extract it first.<br><br>The drivers I have installed, according to the ATI Control Panel, are 8.10.19.<br><br>I already know how to get out of X when it crashes like that, but thanks anyway.<br><br>Let me know if you have the same problem and any other advice would be appreciated. <br><br></td></tr></table><br>
<a name="570414"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig Watson</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does the same thing here I'm afraid.  It didn't want to die nicely either.<br><br>Are you using any Frameworks when you compile?  The thing I've noticed is that your executable does not include a link to libXxf86vm.so.1 whereas all of mine do.  Not sure if that's significant though.<br><br>Running from the terminal returns nothing of interest either because the program never manages to terminate. <br><br></td></tr></table><br>
<a name="570552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am using Framework, but I also use it in all of my other programs that actually exit without a problem.  However, I tried removing it to see what would happen and nothing changed.<br><br>I've now manually freed all media before exiting and this hasn't changed anything either.<br><br>It really is very mystifying why most of my other stuff works without a problem, but I cannot get these two games to work no matter what I do.  I really don't want to resort to only releasing the games as windowed only, as they were intended to be full-screen games.  Plus, windowed mode is only meant for debugging at the moment anyway.<br><br>I've had a look at the ATI site to see what the latest drivers are and it appears that they are currently up to version 8.16.20, where mine are 8.10.19.  So, it looks like my last ditch attempt is to update my drivers; something which scares me on Linux, being something of a newbie!  Having said that, you were still having the problem on NVidia, so it may not be a driver issue.  In which case, I'm stumped!<br><br>If that doesn't work, it either appears to be a bug with BlitzMax when closing, or an incompatibility issue with Linux or KDE. <br><br></td></tr></table><br>
<a name="570562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try adding<br><br>	XCloseDisplay(xdisplay);<br><br>to the end of the bbGLExit() function in glgraphics.linux.c<br><br>You could also wait for the next release of BlitzMax which is imminent to see if that doesn't solve your problems. <br><br></td></tr></table><br>
<a name="572136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the tip, Skidracer.  However, upon opening the source I find that the XCloseDisplay(xdisplay); call is already in there...<br><br><pre class=code>
void bbGLExit()
{
	bbGLGraphicsClose( _currentContext );
	if (cursor)
	{	
		XFreeCursor(xdisplay,cursor);
		cursor=0;
	}
	XCloseDisplay(xdisplay);
	xdisplay=0;
}</pre><br><br>That is the right function, isn't it?  What about the cursor bit, could that have anything to do with it?  Probably not, but I might as well ask.<br><br>So, when is the next update? ;o) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
