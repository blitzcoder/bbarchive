<!DOCTYPE html><html lang="en" ><head ><title >Pulse Audio Driver</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Pulse Audio Driver</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=109" >Linux Discussion</a>/<a href="#bottom" >Pulse Audio Driver</a><br><br>
<a name="1071991"></a>

<a name="1072352"></a>

<a name="1118957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Below is a new pulse audio driver for BlitzMax Linux users.<br><br>Before rebuilding modules grab the following two files and grab the PulseAudio headers using:<br><br><div class="quote"> <br>sudo apt-get install libpulse-dev<br> <br></div><br><br>Many thanks to those that have the time to test, and don't forget to post your results and the version of Linux you are running.<br><br><br><br>%BlitzMax%/mod/freeaudio.mod/pulseaudiodevice.cpp:<br><br><pre class=code>
// pulseaudiodevice.cpp
// sudo apt-get install libpulse-dev

#ifdef __linux

#include "freeaudio.h"

#include &lt;unistd.h&gt;
#include &lt;pulse/simple.h&gt;
#include &lt;pthread.h&gt;

extern "C" audiodevice *OpenPulseAudioDevice();

void *pulseaudiothread(void*dev);

#define LINUXFRAG 2048

struct pulseaudiodevice:audiodevice{
	pthread_t audiothread;
	int threadid;

	int running;
	int playing;
	int error;

	short *buffer;
	int buffersize;	//in bytes
		
	pa_simple *simple;
	
	static void *pulseaudiothread(void *arg){
		pulseaudiodevice* audio;
		audio=(pulseaudiodevice*)arg;
		audio-&gt;run();
		return 0;
	}
		
	int reset(){
	
		pa_sample_spec stereo16;
	
		running=0;
		playing=0;
		
		stereo16.format=PA_SAMPLE_S16LE;
		stereo16.rate=44100;
		stereo16.channels=2;

		simple=pa_simple_new(NULL,"freeaudio",PA_STREAM_PLAYBACK,NULL,"playback",&amp;stereo16,NULL,NULL,&amp;error);
		if (simple==NULL) return -1;

		mix=new mixer(LINUXFRAG);
		mix-&gt;freq=44100;
		mix-&gt;channels=2;

		buffer=new short[LINUXFRAG];
		buffersize=LINUXFRAG*2;

		pthread_attr_t	attr;
		pthread_attr_init(&amp;attr);

		running=1;
		threadid=pthread_create(&amp;audiothread,&amp;attr,pulseaudiothread,(void*)this);	
		return 0;
	}
	
	int close(){	
		int timeout;
		running=0;
		timeout=500;
		while (timeout-- &amp;&amp; playing){
			usleep( 10*1000 );
		}
		pa_simple_free(simple);
		return 0;
	}

	void run(){
		int data;
		int res;
		
		playing=1;
		while (playing &amp;&amp; running){
			mix-&gt;mix16(buffer);
			int err=pa_simple_write(simple, buffer, buffersize, &amp;error);
			if (err&lt;0) break;			
		}
		playing=0;
	}

};

audiodevice *OpenPulseAudioDevice(){
	return new pulseaudiodevice();
}

#endif
</pre><br><br>and backup then replace %BlitzMax%/mod/freeaudio.mod/freeaudio.bmx:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Module Pub.FreeAudio

ModuleInfo "Version: 1.23"
ModuleInfo "Author: Simon Armstrong"
ModuleInfo "License: Public Domain"
ModuleInfo "Copyright: Blitz Research Ltd"
ModuleInfo "Modserver: BRL"

ModuleInfo "History: 1.23 Release"
ModuleInfo "History: Added PulseAudio driver as default Linux sound driver"
ModuleInfo "History: 1.22 Release"
ModuleInfo "History: Fixed leak with sound recycling"
ModuleInfo "History: 1.21 Release"
ModuleInfo "History: Fixed reference counting for brl.freeaudioaudio"
ModuleInfo "History: 1.20 Release"
ModuleInfo "History: Removed duplication of sample memory"
ModuleInfo "History: 1.19 Release"
ModuleInfo "History: Added DirectSound mode"
ModuleInfo "History: 1.18 Release"
ModuleInfo "History: added fa_ChannelPosition for live sample generation"
ModuleInfo "History: 1.17 Release"
ModuleInfo "History: added check for windows playback position overflow"
ModuleInfo "History: 1.15 Release"
ModuleInfo "History: added low latency windows98 fix"
ModuleInfo "History: 1.14 Release"
ModuleInfo "History: fixed 1.13 recycling of stopped channels fix"
ModuleInfo "History: 1.13 Release"
ModuleInfo "History: fixed recycling of stopped channels"
ModuleInfo "History: 1.12 Release"
ModuleInfo "History: Uses linear interpolation for improved fidelity at low rates"
ModuleInfo "History: 1.11 Release"
ModuleInfo "History: Fixed freepool sounds Not resetting parameters - thanks To Fetze"
ModuleInfo "History: 1.10 Release"
ModuleInfo "History: Added ALSA support for Linux courtesy Craig Kiesau"
ModuleInfo "History: 1.09 Release"
ModuleInfo "History: Improved channel playback timing"
ModuleInfo "History: 1.08 Release"
ModuleInfo "History: Fixed memory leak in fa_FreeSound()"
ModuleInfo "History: 1.07 Release"
ModuleInfo "History: Removed output transitions for queued/paused sounds"
ModuleInfo "History: 1.06 Release"
ModuleInfo "History: Windows device error now silently fails"
ModuleInfo "History: 1.05 Release"
ModuleInfo "History: Linux version now opens audio device on second thread"
ModuleInfo "History: 1.04 Release"
ModuleInfo "History: Removed Linux debug output"

Import "freeaudio.cpp"
Import "freeaudioglue.cpp"

?Win32
Import "dsounddevice.cpp"
Import "mmdevice.cpp"
Extern "C"
Function OpenMultiMediaDevice()
Function OpenDirectSoundDevice()
End Extern
?MacOS
Import "-framework AudioUnit"
Import "-framework AudioToolbox"
Import "coreaudiodevice.cpp"
Extern
Function OpenCoreAudioDevice()
End Extern
?Linux
Import "-lpulse-simple"
'Import "-lasound"
'Import "alsadevice.cpp"
'Import "ossdevice.cpp"
Import "pulseaudiodevice.cpp"
Extern "C"
Function OpenPulseAudioDevice()
'Function OpenOSSDevice()
'Function OpenALSADevice()
End Extern
?

Extern

Const FA_CHANNELSTATUS_FREE=0
Const FA_CHANNELSTATUS_STOPPED=1
Const FA_CHANNELSTATUS_SINGLESHOT=2
Const FA_CHANNELSTATUS_LOOPING=4
Const FA_CHANNELSTATUS_STREAMING=8
Const FA_CHANNELSTATUS_PAUSED=16

Function fa_Reset( audiodevice )
Function fa_Close()
Function fa_CreateSound( length,bits,channels,hertz,samples:Byte Ptr=Null,looping=False )
Function fa_WriteSound( sound,samples:Byte Ptr,length ) 'length really neceesary?
Function fa_FreeSound( sound )
Function fa_AllocChannel()
Function fa_FreeChannel( channel )
Function fa_PlaySound( sound,paused_flag,channel )

Function fa_StopChannel( channel )
Function fa_ChannelStatus( channel )
Function fa_ChannelPosition( channel )

Function fa_SetChannelPaused( channel,paused )
Function fa_SetChannelVolume( channel,volume# )
Function fa_SetChannelRate( channel,pitch# )
Function fa_SetChannelPan( channel,pan# )
Function fa_SetChannelDepth( channel,depth# )

End Extern

Function fa_Init( deviceid )
	Local device
?Win32
	If deviceid
		device=OpenDirectSoundDevice()
	Else
		device=OpenMultiMediaDevice()
	EndIf
?Linux
	Select deviceid
		Case 0
			device=OpenPulseAudioDevice()
'		Case 1
'			device=OpenOSSDevice()	
'		Case 2
'			device=OpenALSADevice()
	EndSelect
?MacOS
	device=OpenCoreAudioDevice()
?
	Local res=-1
	If device res=fa_Reset(device)
	Return res
End Function	
</textarea><br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1072182"></a>

<a name="1072375"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works great here :D (no sound before with FreeAudio Driver)<br><br>I tried to SetAudioDrivers()[*] to<br><pre class=code>
*
AudioDrivers()[0] 'OpenAl"
AudioDrivers()[1] 'FreeAudio"
AudioDrivers()[2] 'FreeAudio OSS"
</pre><br>and every single of them worked. OpenAl seems to be a little bit more silent.<br><br>I think this should be included in the next version.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1072353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for testing. <br><br></td></tr></table><br>
<a name="1081102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It worked! (Well, all of the drivers except "FreeAudio OSS", which apparently I don't have)<br><br>Anyway, thanks a million!<br><br>Mark, can this be made part of 1.42?<br><br>Russell <br><br></td></tr></table><br>
<a name="1084858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did I forget a lib or something? Ubuntu 10.10.<br><div class="quote"> Compiling:pulseaudiodevice.cpp<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:6: error: invalid preprocessing directive #Include<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:8: error: invalid preprocessing directive #Include<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:9: error: invalid preprocessing directive #Include<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:10: error: invalid preprocessing directive #Include<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:97: error: invalid preprocessing directive #EndIf<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:4: error: unterminated #ifdef<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:12: error: expected constructor, destructor, or type conversion before string constant<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:18: error: expected class-name before &amp;#128;{&amp;#128; token<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:19: error: &amp;#128;pthread_t&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:20: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:22: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:23: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:24: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:26: error: ISO C++ forbids declaration of &amp;#128;Short&amp;#128; with no type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:26: error: expected &amp;#128;;&amp;#128; before &amp;#128;*&amp;#128; token<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:27: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:29: error: ISO C++ forbids declaration of &amp;#128;pa_simple&amp;#128; with no type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:29: error: expected &amp;#128;;&amp;#128; before &amp;#128;*&amp;#128; token<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:38: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:67: error: &amp;#128;Int&amp;#128; does not name a type<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp: In static member function &amp;#128;static void* pulseaudiodevice::pulseaudiothread(void*)&amp;#128;:<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:35: error: &amp;#128;Return&amp;#128; was not declared in this scope<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:35: error: expected &amp;#128;;&amp;#128; before numeric constant<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp: In member function &amp;#128;void pulseaudiodevice::run()&amp;#128;:<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:79: error: &amp;#128;Int&amp;#128; was not declared in this scope<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:79: error: expected &amp;#128;;&amp;#128; before &amp;#128;data&amp;#128;<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:80: error: expected &amp;#128;;&amp;#128; before &amp;#128;res&amp;#128;<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:82: error: &amp;#128;playing&amp;#128; was not declared in this scope<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:83: error: &amp;#128;running&amp;#128; was not declared in this scope<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:83: error: &amp;#128;While&amp;#128; was not declared in this scope<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:83: error: expected &amp;#128;;&amp;#128; before &amp;#128;{&amp;#128; token<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp: At global scope:<br>/home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp:93: error: expected constructor, destructor, or type conversion before &amp;#128;*&amp;#128; token<br>Build Error: failed to compile /home/kedric/BlitzMax/mod/pub.mod/freeaudio.mod/pulseaudiodevice.cpp <br></div> <br><br></td></tr></table><br>
<a name="1084860"></a>

<a name="1084862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, you pasted cpp code into a BlitzMax file so it got capitalized. In MaxIDE you should have saved a new file as .cpp THEN pasted the code.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1084861"></a>

<a name="1084863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ohhh... Yikes. Sorry about that. :/<br><br>Edit: Works amazingly!<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1088131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >oddchild</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> works great! <br><br></td></tr></table><br>
<a name="1105123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AvestheFox</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> aparently I'm doing something wrong here.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
misterbull@ubuntu:~$ sudo apt-get libpulse-dev
[sudo] password for misterbull: 
E: Invalid operation libpulse-dev
</textarea> <br><br></td></tr></table><br>
<a name="1105125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AvestheFox</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> nevermind, got the package to download :D<br><br>will be testing as soon as I work in the headers <br><br></td></tr></table><br>
<a name="1105130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AvestheFox</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works! :D<br><br>thanks bunches! <br><br></td></tr></table><br>
<a name="1106154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >computercoder</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are running in Ubuntu 11.04, use Synaptic Package Manager and search for libpulse-dev. Mark it for installation and then allow it to select the rest of what it needs. Apply the changes and then proceed with the rest of the changes skidracer describes :) <br><br></td></tr></table><br>
<a name="1109346"></a>

<a name="1109353"></a>

<a name="1109354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jur</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have Ubuntu 11.04 and for me this driver works only in debug build.<br>A pity since original OSS driver for MAX has pretty bad compatibility with various Linux distros.<br><br>EDIT: Ok, now it works also in the release mode. I was putting some WriteStdouts in the freeaudio.bmx to see what went wrong and it started to work somehow :)<br>Thanks a lot for this driver.<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1110685"></a>

<a name="1110686"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've waited a long while to get linux blitzmax sound and I'm almost there.<br><br>I've never worked at this low level before so excuse ignorance.<br><br>I managed to follow the instructions:<br><br>1. Install libpulse-dev<br><br>2. New file: BlitzMax\mod\pub.mod\freeaudio.mod\pulseaudiodevice.cpp<br><br>3. Replace BlitzMax\mod\pub.mod\freeaudio.mod\freeaudio.bmx<br><br>4. Rebuild all modules<br><br>Result: sound works in Debug mode only.<br><br>Checked BlitzMax\mod\pub.mod\freeaudio.mod\ and found only 4 files with today's date - the above two and:<br>freeaudio.debug.linux.x86.i<br>freeaudio.debug.linux.x86.a<br><br>I guess my problem is that they both say "debug" but I don't know what to do about it!<br><br>Hope someone can help.<br><br>Peter<br><br>PS I'm using Ubuntu 10.04 on a USB.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1110700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can recompile the mod manually from the shell in non-debug mode.<br>from the blitzmax/bin folder:<br><br>bmk makemods -a pub.freeaudio<br>and the threaded version:<br>bmk makemods -a -h pub.freeaudio<br><br>(The -a forces the recompile even when it thinks it probably won't need it) <br><br></td></tr></table><br>
<a name="1110710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or you could try rebuilding modules again, I think it is most likely you interrupted the process before it finished or there was an error that you missed. <br><br></td></tr></table><br>
<a name="1110766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks to you both.<br><br>@skidracer - I had tried that already - there is a Compile error right near the end but I've always had that.<br><br>@xlsior worked fine - but for the benefit of any other Linux noob reading this ... I had to precede bmk with "./"<br><br>Again ... many thanks to you both ... this is gonna make a lot of people happy!<br><br>Peter <br><br></td></tr></table><br>
<a name="1110807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Report:<br><br>Built app on Ubuntu 10.04<br>Result successfully run on<br>  Ubuntu 10.04<br>  Linux Mint 11<br>  Fedora 14<br>but on Debian 6.0.2 got<br>"Assertion 's' failed at pulse/simple.c:256, function pa_simple_free()"<br>and app aborted.<br><br>Peter<br><br>PS All Linuxes on USB <br><br></td></tr></table><br>
<a name="1110816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> App also successful on<br><br>OpenSUSE 11.3 (Live CD version)<br><br>Peter <br><br></td></tr></table><br>
<a name="1111095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Peter, I will post a fix soon for your Debian config so it doesn't crash. <br><br></td></tr></table><br>
<a name="1114175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have solved my problem on Debian by installing PulseAudio using the command<br><pre class=code>
apt-get install pulseaudio
</pre><br><br>Peter <br><br></td></tr></table><br>
<a name="1118950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matt!</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> After making these changes, my MacIDE is hanging during at freeaudio when building modules.<br><br>Any ideas? <br><br></td></tr></table><br>
<a name="1118997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, for me hangs in build modules means a syntax error. <br><br></td></tr></table><br>
<a name="1119250"></a>

<a name="1119251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine in ubuntu 10.4 (dell laptop, max 1.45) in debug or release mode. Sound working fine with old freeaudio driver too. <br><br>When I get the drivers:<br><pre class=code>For Local driver:String = EachIn AudioDrivers()
  Print driver
Next
</pre><br>It gives "FreeAudio, FreeAudio OpenSound System, Null" and both work. I don't know how to set up OpenAl on linux so I can't test it.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1124596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ho my...<br><br>You save my life Skid !<br><br>Working perfectly on a Mint Distro.<br><br>Does the users is required to install something related to the pulse driver or does the source dev. code does everything ?<br><br>Man! The Default Freeaudio driver sux.<br><b>This must be official.</b> <br><br></td></tr></table><br>
<a name="1124616"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> The feedback I've got from my customers is that the pulse audio driver is just as flaky as the default driver, with the downside of not being as commonly installed on systems. The only consistent driver on Linux seems to be the OpenAL one. In the end though I just allowed the end user to select which driver worked for them. <br><br></td></tr></table><br>
<a name="1124629"></a>

<a name="1124633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bad... Linux... really !<br>Can you believe that my current Nvidia driver isn't good too ? My Cg isn't correctly supported !<br><br><br>And about OpenAL ? Do you have to install the redistribuable to hear something like in Windows ?<br><br>Because with OpenAl on my system after 3 songs everything is mute !<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1124649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is user required to install something related to the pulse driver or does the source dev. code does everything ? <br></div><br><br>No your users do not need to install anything.<br><br><br>There is also an issue with freeaudioaudio.bmx in brl.mods/freeaudio where free audio driver names have been hard coded. <br><br>Ideally ALSA, OSS and Pulse should all be listed if mountable.<br><br><br>I have no idea of the implications of OpenAL on Linux, as long as it plays nice with the other mixer API's in the system and the user has correct speaker and headphone levels. <br><br></td></tr></table><br>
<a name="1127691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi skidracer ... good to see you back in this thread - does this mean that you might now be able to attend to my problem?<br><br><div class="quote"> Thanks Peter, I will post a fix soon for your Debian config so it doesn't crash.  <br></div><br><br>Thanks ... Peter <br><br></td></tr></table><br>
<a name="1133416"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> A fix for that problem would be awesome !<br>Something to draw back to OpenAL like Odd suggested ?<br>I probably need to find how to use it by default, hope it's not a breaker. <br><br></td></tr></table><br>
<a name="1135742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The feedback I've got from my customers is that the pulse audio driver is just as flaky as the default driver, with the downside of not being as commonly installed on systems. <br></div><br><br>Whatever the reasons most Linux users simply refuse to install the PulseAudio driver and find it more easy to ask the developer himself to implement an abstraction layer like OpenAL.<br><br>The thing is that OpenAL module is BUGGY like FreeAudio so if I do understand nothing for sounds is really working under Linux...<br><br>Will someone address this problem once and for all? I cannot fix my game under Linux because of that and it breaks my balls. <br><br></td></tr></table><br>
<a name="1136779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Agreed! Audio in Linux, and especially as it pertains to BMax is really disappointing.<br><br>I can't imagine why this is still an issue after all these years... (For Linux and Bmax as well).<br><br>Russell <br><br></td></tr></table><br>
<a name="1137493"></a>

<a name="1137494"></a>

<a name="1137495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Captain Wicker (crazy hillbilly)</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes but how do I SetAudioDriver() to Pulse Audio Free Audio?<br>I include<br> <pre class=code>Import pub.freeaudio
SetAudioDriver("PulseAudio")
</pre><br><br>And the terminal says:<br><pre class=code>austin@austin-Inspiron-N5110:~$ sudo apt-get install libpulse-dev
[sudo] password for austin: 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
libpulse-dev is already the newest version.
The following packages were automatically installed and are no longer required:
  wine1.3-gecko python3.2 gettext libpython3.2 libunistring0 python3.2-minimal
Use 'apt-get autoremove' to remove them.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
austin@austin-Inspiron-N5110:~$ 

</pre><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1137496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> As long as rebuild modules finishes without errors then you should be OK. <br><br>You don't need the SetAudioDriver as it is hardcoded for Linux.<br><br>Have you tested your setup with other music / sound players to make sure your basic Linux audio is working? <br><br></td></tr></table><br>
<a name="1137497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Captain Wicker (crazy hillbilly)</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I have tested my linux audio. My media player works fine.<br>Is this designed to work on Ubuntu 11.10? Do I need to import the module like Import BRL.FreeAudioAudio or Import pub.freeaudio??? Am I forgetting something? <br><br></td></tr></table><br>
<a name="1137567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> My son just installed Ubuntu on an old Dell laptop so I am planning on testing BlitzMax audio support soon.<br><br>If you want to be pragmatic you should consider avoiding Linux altogether. Spend the time writing better games for Mac OS/ Windows. <br><br></td></tr></table><br>
<a name="1137572"></a>

<a name="1137573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Captain Wicker (crazy hillbilly)</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> What a coincidence, I installed Ubuntu on my dell laptop too! :D <br>Not old though (Inspiron 15R N5110)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1141083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Captain Wicker (crazy hillbilly)</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> How exactly am I supposed to set the driver to free audio properly?<br>I followed all the steps in the first post but no sound :(<br><br>SRS Premium Sound <br><br></td></tr></table><br>
<a name="1183220"></a>

<a name="1183221"></a>

<a name="1183224"></a>

<a name="1183225"></a>

<a name="1183226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Shouldn't this be:<br><br><pre class=code>
	static void *pulseaudiothread(void *arg){
		pulseaudiodevice* audio;
		audio=(pulseaudiodevice*)arg;
		if (audio) 
		{ 
		   audio-&gt;run();
		   return 0;
		} else {
		   return audio;
		}
	}
</pre><br><br>Now I'm just guessing - didn't test it yet, but maybe with this change, this could work:<br><br><pre class=code>
   device=OpenPulseAudioDevice()
   if (device=null) then device=OpenALSADevice()
</pre><br><br>Edit 2: After changing it I'm having other problems - now everything I compile it hits me with 'undefined reference to `pa_simple_write' - and I do have pulseaudio and libpulse-dev installed :( <br><br></td></tr></table><br>
<a name="1183234"></a>

<a name="1183247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's been ages since I did any thing C/C++ related, but I would have thought that pulseaudiothread would need to return a value my self instead of void. <br><br></td></tr></table><br>
<a name="1183240"></a>

<a name="1183244"></a>

<a name="1183263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's what I tought - but looking at the OSS and Alsa drivers, they are implemented the same way, with "void".<br><br>Edit: found out my problem, I forgot to include <br><pre class=code>
Import "-lpulse-simple"
</pre><br><br>in freeaudio.bmx. Now it compiles and appears to work ok. Just have to test on the liveCD to see if the program crashes because it doesn't have pulseaudio as default.<br><br>Edit: No crashes! I even remove pulseaudio from the live-cd (with apt-get remove pulseaudio) and it worked without any issues :) <br><br></td></tr></table><br>
<a name="1188551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Trying this on Ubuntu 12.04. Not working.<br><br>Followed all of Skid's original advice. Just not getting any sound. What can I do to test if I have everything set up correctly? <br><br></td></tr></table><br>
<a name="1201651"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cruis.In</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got OpenAl to Works on Ubuntu 13.04<br><br>I created the files separately and pasted in the code and saved them, then put them in the respective dirs.<br><br>Didn't use blitzmax to make the files, as that was one of the issues I read some where. <br><br></td></tr></table><br>
<a name="1287749"></a>

<a name="1287750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> If anyone is using this driver / wants it added to the official blitzmax git, please reply.<br><br>If a moderator reads this, please unpin. <br><br></td></tr></table><br>
<a name="1287767"></a>

<a name="1287793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Shouldnt we use the freeaudio thing adjusted by brucey to runtime link to pulseaudio?<br>Without runtime linking ("on request") your app will require pulseaudio libs even when using alsa.<br>So apps might not run on certain distros (which is why I have to do two linux builds of my game...with and w/o pulseaudio).<br><br><br>Or did I mix things up now?<br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1287774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> link? <br><br></td></tr></table><br>
<a name="1287791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=101981" target="_blank">Starting at post #30</a><br>(#30 - runtime linking for alsa, #49 brucey added runtime linking for pulseaudio)<br><br>This results in:<br><a href="https://github.com/maxmods/pub.mod/tree/master/freeaudio.mod" target="_blank">https://github.com/maxmods/pub.mod/tree/master/freeaudio.mod</a><br><br>which leads to v1.23:<br><pre class=code>
ModuleInfo "History: 1.23"
ModuleInfo "History: Use ALSA instead of OSS on Linux."
ModuleInfo "History: Added PulseAudio driver as default Linux sound driver."
ModuleInfo "History: ALSA and Pulse audio drivers now link at runtime."
</pre><br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
