<!DOCTYPE html><html lang="en" ><head ><title >compiling C# to a DLL</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >compiling C# to a DLL</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=120" >Blitz3D SDK Programming</a>/<a href="#bottom" >compiling C# to a DLL</a><br><br>
<a name="785958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to compile the C# header to a dll so I can Import it to my VB.NET project.  I manage to compile the DLL but when I import it I am not able to use it.  Anyone have  pointers on what I'm doing wrong? <br><br></td></tr></table><br>
<a name="785968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It could be something releated to namespaces. I have a compiled dll version for use with Visual Basic.net <br><br></td></tr></table><br>
<a name="785970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I took the original C# blitz3dsdk class file and tried to compile it as a C# dll.  Did I need to change the name of the namespace?<br><br>The steps I took.<br>1 - I created a C# Class Library project and called it blitz3dsdk.<br>2 - I copied the existing namespace from the blitz3dsdk into it.<br>3 - Compiled to a DLL<br>4 - Referenced in a VB project.  It shows up in the list but I can't make use of it.<br><br>Should I use a different name for the namespace or C# project name?<br><br>I'd ask for a copy of the dll, but I'm not sure that is legal. <br><br></td></tr></table><br>
<a name="785975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are still having problems creating your DLL you could try converting the c# headers directly to the VB.NET equivalent.<br><br>If you download the free SharpDevelop IDE, <br><a href="http://sourceforge.net/project/downloading.php?groupname=sharpdevelop&amp;filename=SharpDevelop_2.1.0.2429_Final.msi&amp;use_mirror=kent" target="_blank">http://sourceforge.net/project/downloading.php?groupname=sharpdevelop&amp;filename=SharpDevelop_2.1.0.2429_Final.msi&amp;use_mirror=kent</a><br><br>There is a function in there (Tools Menu -&gt; Convert To) which will convert C# code to VB.NET code.<br><br>I haven't had a chance to test the conversion yet, but if it works, at least it means you don't have to have an a second DLL. <br><br></td></tr></table><br>
<a name="785977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Daz:<br>  I gave that a try, and it doesn't work with the DLL stuff.  I have done a good bit of manually already, but it has taken 6 hours or so at this point and I'm roughly 80% done.  <br><br>VB does not like the static class, so I changed that to a module.  The converter also had trouble with the const statements, they were easy enough to convert though.  It is going through the dll"B3D" stuff that is time consuming.<br><br>Only thing I'm worrying about (other then typos) is if the wrapper changes I'd have to go through and upgrade again, yuck... <br><br></td></tr></table><br>
<a name="785979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Static is shared on Visual Basic. <br><br></td></tr></table><br>
<a name="785981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Dynaman,<br><br>I have tried converting  the .cs header to VB.NET code using SharpDevelop converter and it worked.  That bit took about a minute to do.<br><br>The only code change I had to do with the SharpDevelop IDE converted code was change the Private to Public for the new method.<br><br>Here is the code I wrote to test the VB.NET header conversion - this example is rendering to a picture box control:<br><br><pre class=code>
Public Class Form1
    Public blitz = New Blitz3DSDK
    Dim cube, light, camera As Integer

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        blitz.SetBlitz3DHWND(PictureBox1.Handle.ToInt32())

        blitz.BeginBlitz3D()
        blitz.Graphics3D(PictureBox1.Width, PictureBox1.Height, 0, 2)

        cube = blitz.CreateCube(0)
        light = blitz.CreateLight(1, 0)
        camera = blitz.CreateCamera(0)
        blitz.PositionEntity(camera, 0, 0, -4, 1)

        Timer1.Enabled = True
    End Sub

    Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
        blitz.UpdateWorld(1)
        blitz.RenderWorld(0)
        blitz.TurnEntity(cube, 0.1F, 0.2F, 0.3F, 1)
        blitz.Text(20, blitz.GraphicsHeight() - 20, "Blitz3d SDK C# example to use a panel control", 0, 0)
        blitz.Flip(1)
    End Sub
End Class
</pre><br><br>So, all in all, the complete process only took me about 10 mins. <br><br></td></tr></table><br>
<a name="785983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I must have been using a different version then.  I'll give the one you listed a try.<br><br>Very nice.<br><br><br>[EDIT] Thanks to you too Ziggy. <br><br></td></tr></table><br>
<a name="785984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are two versions of SharpDevelop - one for .NET framework 1 and one for .NET framework 2.   I don't know if it  makes any difference but I used the version for .NET framework v2. <br><br></td></tr></table><br>
<a name="785994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> That did the trick.  I've gotten everything up and running now.  Thanks for all the help.<br><br>Perhaps VB.NET headers and examples could be included in the next update/bugfix. <br><br></td></tr></table><br>
<a name="785996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Daz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> No problem.  Glad to help.  <br><br>I agree about the VB.NET headers being include.  In fact,, I just sent off the VB.NET headers and an example to the team.  So, maybe they will include it in the next update/future versions. <br><br></td></tr></table><br>
<a name="786011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rone</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi,<br>why not compiling it to an .net component .dll with a nice properties box?<br>This could be used in all .net languages without making a wrapper for each language...<br><br>I quite recently have done that with ActivVisionTools and HalconX. It seems to be the best professional solution. <br><br></td></tr></table><br>
<a name="786201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe that's becouse in this case it is not a control, as a static library, it can't have multiple instances of itself, so making it a control is not possible. Maybe it could be done as a .net DLL so you can use the SDK with C#, with VB .net and, if it is the case, with both of them in the same project. <br><br></td></tr></table><br>
<a name="786395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> the approach of .NET DLL would even open it to a wider audience ... Delphi.NET and Eiffel (.NET projects)<br>both interesting languages where many would be interested in game creation but due to the small audience there is little possibility to do so. <br><br></td></tr></table><br>
<a name="791013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dazza</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> In addition to the sample code above, I would suggest that you change the following if you are going to use the code as a basis for further developing code...<br><br>1) Ensure you have...<br><pre class=code>    Option Strict On</pre>at the top of each class module. It will annoy the heck out of you when you are compiling, but when you come to debug you will be glad you did!<br><br><br>2) To get full intellisense (and because Option Strict will complain anyway!) change the SDK object declaration to:<br><pre class=code>
    Public blitz As Blitz3DSDK = New Blitz3DSDK
</pre> <br><br></td></tr></table><br>
<a name="791179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> the better way (though there's a ton of different ways) would be to declare it:<br><br><pre class=code>Public blitz As New Blitz3DSDK</pre><br><br>What Dazza is saying though is correct.  In your original declaration, you are basically creating blitz as a variant which is then assigned the new object of blitz3dsdk.  By declaring it AS blitz3dsdk you gain the benefits of intellisense. <br><br></td></tr></table><br>
<a name="791284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> man...  I had to go through and make all the public shared functions not shared...  and I'm probably going to make the bb functions private so they don't show up in intellisense as well.  Not as easy as just a convert tool over here.  :/ <br><br></td></tr></table><br>
<a name="796848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shayde</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also am very interested in VB.NET (both  2003 &amp; 2005)  examples and header.  I use 2003 at work mostly so I lean in that direction most.  Having some trouble with converting the C# examlpes myself (complaining about missing Namespace etc.).  Tried converting the Blitz3DSDK.cs to .vb using both the SharpDev tool and several C# to VB.NET converters on the Internet.  All bust.  Or maybe one of you smart fellas can put together a little Tut for us mere mortals.  I'd really like to see the VB.NET example in the next update. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
