<!DOCTYPE html><html lang="en" ><head ><title >Flash Mouse Coordinates</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Flash Mouse Coordinates</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=501" >Monkey Bug Reports</a>/<a href="#bottom" >Flash Mouse Coordinates</a><br><br>
<a name="2036111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mr_twister</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>I found a weird behavior in Flash regarding mouse movement when additional child objects are placed on screen.<br><br>I made a small module that adds a child element to the "stage" and while adding the element works, once you hover the mouse over the element, the MouseX(), MouseY() reported by Monkey become local coordinates inside the object instead of the coordinates inside the screen.<br><br>Researching a bit into the issue I found that when parsing the MouseEvent in the MouseOver() callback, Monkey is using localX and localY:<br><br><pre class=code>
stage.addEventListener( MouseEvent.MOUSE_MOVE,function( e:MouseEvent ):void{
	OnMouseMove( e.localX,e.localY );
} );
</pre><br><br>It seems that both should be replaced by stageX and stageY in order to get the correct coordinates every time. <br><br></td></tr></table><br>
<a name="2036110"></a>

<a name="2036685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I dunno...why is reporting mouse in scene coords any more (or less) correct than reporting mouse in local coords?<br><br>Wont it depend on what you're trying to achieve and just why you have multiple child objects? <br><br></td></tr></table><br>
<a name="2036835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mr_twister</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> localX and localY in the mouse event always report the coords relative to the object which the mouse is hovering over that is lowest in the scene hierarchy. The mouse event always contain both global and local coords as stated above.<br><br>I needed to add child objects to the stage to implement buttons properly so I could launch pages when the user clicked on them without chrome blocking the window (If navigateToUrl is invoked from outside a Flash event handler, Chrome blocks it, to prevent spammy apps which launch sites without consent from the user).<br><br>By doing that however I lost accurate track of the mouse position through MouseX() and MouseY() since once you hover over the "child button" the coords reported by Monkey become relative to that object, not the whole scene.<br><br>Using stageX and stageY works btw. Could this change be added to the official Monkey distribution? (as long as it doesn't break any code of yours, but Monkey seem to be working fairly fine since I added the fix in my local install). <br><br></td></tr></table><br>
<a name="2036833"></a>

<a name="2036830"></a>

<a name="2036986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>&gt; once you hover over the "child button" the coords reported by Monkey become relative to that object, not the whole scene<br><br>Ok, that sounds bad!<br><br>But I guess what we really want then is the 'game bitmap relative' mouse coords - ie: isn't there a chance the game bitmap could be offset into the stage, ie: it could be parented to something else and/or its x/y could be non-zero, in which case stage coords would be wrong?<br><br>Will definitely at least do the stageX, stageY fix, but if you can come up with something better... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
