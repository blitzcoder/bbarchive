<!DOCTYPE html><html lang="en" ><head ><title >WinPhone: IAP not working?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >WinPhone: IAP not working?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=501" >Monkey Bug Reports</a>/<a href="#bottom" >WinPhone: IAP not working?</a><br><br>
<a name="2086283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tested my code on Android - and it worked fine...<br>On WinPhone, i found a problem with this line:<br><br>store.OpenStoreAsync(Self)<br><br>i do not know what is wrong with it<br>when i comment it out, all is fine...<br>but store is not working then<br><br>VS2012 message:<br>First-chance exception at 0x77B81EDB in TaskHost.exe: Microsoft C++ exception: Platform::COMException ^ at memory location 0x0573F750. HRESULT:0x805A0194<br><br>this error comes direct at start...<br>if i start my game on phone - here is no crash or something,<br>but store is not opened then...<br><br><br>my code is nearly the same sample code:<br><br><pre class=code>	Method InitPurchases:Void ()
		LoadPurchases()
		store = New MonkeyStore()
		store.AddProducts(["pay_1"], 1)
		store.OpenStoreAsync(Self) '&lt;&lt;&lt;&lt;&lt;PROBLEM
	End</pre><br><br><br>i started my app from VS2012 - instead downloading beta app from store<br>or do i need something else?<br><br>SCREENSHOT:<br><a href="http://www.pasteall.org/pic/show.php?id=70787" target="_blank">http://www.pasteall.org/pic/show.php?id=70787</a> <br><br></td></tr></table><br>
<a name="2086280"></a>

<a name="2086281"></a>

<a name="2086293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Had the same issue and gave up...<br><br><a href="http://www.monkey-x.com/Community/posts.php?topic=8343" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8343</a> <br><br></td></tr></table><br>
<a name="2086298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br><br>i had success with my beta app!<br>after i uploaded it - and downloaded (signed app) on phone,<br>i could open the store and buy something...<br><br>my app started from VS2012 do not worked....<br><br><br>on android i do not need to upload and download my app... <br><br></td></tr></table><br>
<a name="2086295"></a>

<a name="2086296"></a>

<a name="2086297"></a>

<a name="2086301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well that's interesting! Thanks for sharing! :) <br><br></td></tr></table><br>
<a name="2086316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> strange... i did nothing... and started my app 2 hours later, and it do not start anymore...<br>i reinstalled it... nothing helps... <br><br></td></tr></table><br>
<a name="2086324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> i noticed, that...<br>if here is something wrong with store, the app exits directly...<br>because here are many ERROR-commands in monkeystore...<br><br>HELL!<br>if store is unavailable, my app should never quit!!!<br>it should simply ignore this...<br><br>(but i see no error message)<br><br><pre class=code>
	Method BuyProductAsync:Void( product:Product,onComplete:IOnBuyProductComplete )
		If _state&lt;0 Error "Store unavailable"
		If _state=0 Error "Store not open"
		If _state&lt;&gt;1 Error "Store currently busy"
...
</pre> <br><br></td></tr></table><br>
<a name="2086321"></a>

<a name="2086331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt; Had the same issue and gave up...<br><br>You have to click 'continue' here - as far as I can tell, it's just the way msvc/winrt works. See my reply to your bug report for more info. Note that this only happens when you run the app from msvc.<br><br>&gt; if here is something wrong with store, the app exits directly...<br><br>Do NOT use BuyProductAsync if store did not open correctly! <br><br></td></tr></table><br>
<a name="2086327"></a>

<a name="2086434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> LoadPurchases not worked for me...<br>need to check why... <br><br></td></tr></table><br>
<a name="2086340"></a>

<a name="2086602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting. Please keep us posted what's wrong there! <br><br></td></tr></table><br>
<a name="2086676"></a>

<a name="2086678"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> i found out, that following line crash my app:<br><br><pre class=code>purchases = New JsonObject(json)</pre><br><br>it seems that deinstalling and installing again do not help to remove saved data<br>i need to check what is wrong with saved json string...<br><br>i tested with a smaller sample code - but it worked fine (installed from VS and not from store). <br><br></td></tr></table><br>
<a name="2086652"></a>

<a name="2086653"></a>

<a name="2086675"></a>

<a name="2086677"></a>

<a name="2086679"></a>

<a name="2086680"></a>

<a name="2086681"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> my json string is <br>{"pay_1":2}<br><br>it do not look corrupt... <br>i checked for unicode etc... it is pure ascii without any control chars...<br>but this command fail to load and crash:<br><br>purchases = New JsonObject(json)<br><br><br><br>i decided to do not use JsonObject<br>and save purchases with SaveState...<br><br>this should fix it for me...<br>i do not know, why this happen... <br><br></td></tr></table><br>
<a name="2086655"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
