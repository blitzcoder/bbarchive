<!DOCTYPE html><html lang="en" ><head ><title >WritePixels missing frame value</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >WritePixels missing frame value</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=501" >Monkey Bug Reports</a>/<a href="#bottom" >WritePixels missing frame value</a><br><br>
<a name="2116777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EdzUp</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When creating a image you can use Image.CreateImage( width, height, frames) and GrabImage can grab x number of frames but writing to the image using WritePixels you cannot specify a frame to write to.<br><br>Is this a oversight or is there another way to get this working as I would like to write a animated image to a monkey internal frame image system but cannot as you can index the frames. <br><br></td></tr></table><br>
<a name="2116785"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> From what I remember of Mojo 1's weird all-in-one system, they share a surface. So, theoretically, the image you write to is effectively an atlas anyway. If you wanted to write to the "sub-images", wouldn't you be able to do this before calling 'GrabImage'?<br><br>I'll be honest, what you're asking is pretty weird already. If it's just about writing to the set of images, then it's just a very long surface.<br><br>Basically, it's "<b>width</b> x <i><b><u>frameCount</u></b></i>" long, so each image starts every <b>width</b> pixels on the same surface. This means you can just call 'WritePixels' with the <b>x</b> argument at multiples of the frame-<b>width</b> you used to make the original image.<br><br>In other words, they share the same surface, and 'WritePixels' doesn't care. With that said, I'm actually not sure if the debug logic for 'WritePixels' is correct, so that may actually be a bug itself.<br><br>If you're using Mojo 2, then there's a few better ways to do this, but a lot of this particular method is the same deal. <br><br></td></tr></table><br>
<a name="2116784"></a>

<a name="2116786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EdzUp</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I'm wondering is loading the image can the frames be done later. <br><br></td></tr></table><br>
<a name="2116788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>I'm pretty sure it doesn't matter, but that might be target-specific. Just keep the shared surface in mind</b>.<br><br>At this point, it sounds more like you just want to use an atlas for your graphics, which is the right answer to begin with. Honestly, you really shouldn't be making them on load-time unless you have to.<br><br>If you really want to make your own atlas system dynamically, you can still use 'CreateImage' with 'LoadImageData' from the OpenGL modules. You'll be limited to mostly OpenGL targets, though. There's also using the 'GraphicsDevice' stuff directly, but that may be locked down a bit too much. I'd suggest just using 'LoadImage' for static graphics, and 'CreateImage' for dynamic.<br><br>You can get the effect of a single shared surface by using a tool, though. Then you just need to use 'LoadImage' and 'GrabImage'. That's going to be the easiest route.<br><br><b>With that said, if you need to use 'WritePixels' dynamically, you should probably look into shaders</b>. The easiest way to use them is with Mojo 2. I wrote a <a href="https://github.com/Regal-Internet-Brothers/mojoinmojo2" target="_blank">compatibility layer</a>, but the CPU pixel-manipulation commands <i>haven't been tested</i>. I'd recommend porting to Mojo 2 properly, though.<br><br>If that doesn't cover your bases, then you need to be a bit more specific. It just sounds like you want to do what an external program should do, or what should be done while you're loading your game. Anything more than that is shader territory. <br><br></td></tr></table><br>
<a name="2116787"></a>

<a name="2116798"></a>

<a name="2116799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EdzUp</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Basically what I want to do is load pixel rgba data into a frame of a image for example;<br>1) create a image with ten frames<br>2) fill all the frames with pixel rgba data<br>3) use frames as a animimage with drawimage<br><br>It seems I will have to look at another route with this as grab image has to be done in On render which is out of the question.<br><br>The only thing I can think of is create a image for each frame in a array :/ <br><br></td></tr></table><br>
<a name="2116810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait, what? 'GrabImage' doesn't need to be used in 'OnRender' at all. You're thinking of 'ReadPixels', which is awful compared to 'WritePixels'. If you need 'ReadPixels', then you should probably be using shaders, but if you think you have to, it's there. You can use 'WritePixels' and 'GrabImage' whenever you want on any target. 'ReadPixels' must be in 'OnRender' because it literally reads from the back or front buffer.<br><br>At any rate, there is a bug where I thought there was. You can create a set of images with 'CreateImage', but you can't write to all of them in debug mode. This is because there's no relationship between the generated images. There's two ways for Mark to fix this, one's dead simple, and the other may be intended.<br><br><b><i><a href="https://github.com/ImmutableOctet/writepixels_example-monkey/blob/master/WritePixels_Example.monkey" target="_blank">Here's an example</a></i> that tests my claim, and should help you with 'WritePixels'</b>. (<a href="https://raw.githubusercontent.com/ImmutableOctet/writepixels_example-monkey/master/WritePixels_Example.monkey" target="_blank">Raw file</a>)<br><br>The 'WRITEPIXELS_DEMO_HACK' declaration at the top can be commented out to see what I mean (Build in debug mode, then in release). I'm not sure what Mark's intention with 'WritePixels' actually is. I'll make a bug report shortly.<br><br><b>EDIT: I made <a href="http://www.monkey-x.com/Community/posts.php?topic=10396" target="_blank">another topic</a> regarding this particular issue.</b> <br><br></td></tr></table><br>
<a name="2116803"></a>

<a name="2116802"></a>

<a name="2116801"></a>

<a name="2116800"></a>

<a name="2116812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EdzUp</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah ok I will have a look what does grab image grab from? <br><br></td></tr></table><br>
<a name="2116816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> The image you're using it with. It's a method, not a function. It's what you're supposed to use to grab an area of an atlas (Big image made up of smaller images). If you've got unrelated or differently sized images, it's the best way to store animations. With 'GrabImage', you can just use a tool to pack the images and grab based on the named coordinates it outputs.<br><br>Look at a tool like <a href="https://spritesheetpacker.codeplex.com" target="_blank">Sprite Sheet Packer</a>, which gives you a file in plain text. The file gives you the names of the files and where they are placed on the atlas. With this, you can pack a lot of files into one image, meaning you (Mojo in this case) only have to pack your resources into a few surfaces. Since surface (Texture) numbers are limited, even on today's hardware, they're very useful. They also speed up your game significantly, since the graphics card only has a few textures to work with.<br><br>In your case, if you intend to create animated images on the fly, you should pack them into an atlas (Large shared 'Image') if you have a lot of them.<br><br>As a side note, <a href="http://www.monkey-x.com/Community/posts.php?topic=10396" target="_blank">I made this topic</a> for the bug I was referring to. <br><br></td></tr></table><br>
<a name="2116815"></a>

<a name="2116814"></a>

<a name="2116820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EdzUp</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah thanks I thought grab image was like BlitzMax and had to grab from the back buffer as it uses a stored image for the atlas and to provide the uv coordinated for the frames I will use that for the system :)<br><br>Once again thanks for that it's a great help :) <br><br></td></tr></table><br>
<a name="2116834"></a>

<a name="2116835"></a>

<a name="2116836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a heads up: I accidentally forgot to push the latest version, so 'WRITEPIXELS_DEMO_RELATIVE' actually works now. It's not relevant unless Mark makes 'WritePixels' image relative, so if you're not interested, don't bother getting the latest version of my demo. <br><br></td></tr></table><br>
<a name="2116844"></a>

<a name="2116845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EdzUp</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ImmutableOctet:thanks for your help mate finally finished the packing system so instead of sixty files there's now five binary packs. The entire image system is loaded from these files and just takes about a second to load it all.<br><br>Now I have that done I can get everything else completed.<br><br>Once again thanks mate <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
