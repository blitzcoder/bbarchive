<!DOCTYPE html><html lang="en" ><head ><title >brl.json &amp; win8.1</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >brl.json &amp; win8.1</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=501" >Monkey Bug Reports</a>/<a href="#bottom" >brl.json &amp; win8.1</a><br><br>
<a name="2097317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pharmhaus</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi mark,<br><br>There seem to be some differences with different targets and brl.json.<br>The following code crashes when executed (release mode only) after being compiled with VS 2013 and win8.1 as the target.<br>It looks like it works just fine on html, glfw etc.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict
Import mojo
Import brl.json

Function Main:Int()
	New Game()
	Return 0
End

Class Game Extends App

	'summary:The OnCreate Method is called when mojo has been initialized and the application has been successfully created.
	Method OnCreate:Int()	
		'Set how many times per second the game should update and render itself
		SetUpdateRate(60)
		
		Local json:JsonObject = New JsonObject("{~qscores~q:[[~qglfw~q,~q9800~q],[~qhmm~q,~q3400~q],[~qbenjamin~q,~q2600~q]]}")
		
		Return 0
	End
	
	'summary: This method is automatically called when the application's update timer ticks. 
	Method OnUpdate:Int()

		Return 0
	End
	
	'summary: This method is automatically called when the application should render itself, such as when the application first starts, or following an OnUpdate call. 
	Method OnRender:Int()
		Cls()
		
		Return 0
	End

	'summary: This method is called instead of OnRender when the application should render itself, but there are still resources such as images or sounds in the process of being loaded. 
	Method OnLoading:Int()
		
		Return 0
	End
	
	'summary: This method is called when the application's device window size changes. 
	Method OnResize:Int()
		
		Return 0
	End
	
	'#REGION Code to handle susped status of the game goes here
	
	'summary: OnSuspend is called when your application is about to be suspended. 
	Method OnSuspend:Int()
	
		Return 0
	End
	
	'summary: OnResume is called when your application is made active again after having been in a suspended state. 
	Method OnResume:Int()
		
		Return 0
	End	
	'#END REGION
	
	'#REGION Code to handle game closing goes here:
	
	'summary: This method is called when the application's 'close' button is pressed. 
	Method OnClose:Int()
				
		Return Super.OnClose()
	End

	'summary:This method is called when the application's 'back' button is pressed. 
	Method OnBack:Int()

		Return Super.OnBack()
	End
	
	'#END REGION

End
</textarea> <br><br></td></tr></table><br>
<a name="2097276"></a>

<a name="2097281"></a>

<a name="2097325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine here with the "Windows RT Game (Tablet)" target.<br><br>There's nothing target dependent in the json module either (it's all just raw code) so I'm a bit stumped.<br><br>I did have to upgrade the project to Windows 8.1 - I reckon perhaps it's time 8.1 was made the default minimum? and msvc2013? <br><br></td></tr></table><br>
<a name="2097329"></a>

<a name="2097330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi mark<br><br>The problem comes from me, pharmhaus has only posted for me , because my english grammer is very bad.<br><br><br>When i compile the code in monkey in release mode with windows phone as target, then open the visual studio project and compile to device, the app crashes with error "json error".<br>But when i compile in debug mode, the app works fine on my phone.. <br><br></td></tr></table><br>
<a name="2097345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't get any errors using json with win phone 8.1 (release or debug), also yes Mark I think the default should be 8.1 and msvc2013 now. <br><br></td></tr></table><br>
<a name="2097348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm strange.... i'll post the log from vc2013 today evening.. <br><br></td></tr></table><br>
<a name="2097347"></a>

<a name="2097358"></a>

<a name="2097359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> the following error occurs:<br><br><pre class=code>Ausnahme (erste Chance) bei 0x77A835D7 in TaskHost.exe: Microsoft C++-Ausnahme: c_JsonError bei Speicherort 0x0189F658.
Der Thread 0x9e4 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x12c0 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x16f0 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x123c hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x1418 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0xcc0 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x1150 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x15e0 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0xa3c hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x5c4 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x104c hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x300 hat mit Code -1 (0xffffffff) geendet.
Der Thread 0x6cc hat mit Code -1 (0xffffffff) geendet.
Das Programm "[5432] TaskHost.exe" wurde mit Code -1 (0xffffffff) beendet.</pre><br><br>And this only in release mode (from Monkey, not Visual Studio<br><br><br>one of this two lines generates that error:<br><pre class=code>		String t_name=p_ParseString();
		p_Parse(String(L":",1));</pre><br><br>.<br>.<br>.<br>mark, have you any Idea, why the string has so strange value?<br>Here is the value from release version, you see? the length is 5:<br><a href="http://www.kognetwork.ch/value.png" target="_blank"><img src="http://www.kognetwork.ch/value.png"></a><br>.<br>.<br>on the debug version, the string length is 6:<br><a href="http://www.kognetwork.ch/value2.png" target="_blank"><img src="http://www.kognetwork.ch/value2.png"></a> <br><br></td></tr></table><br>
<a name="2097357"></a>

<a name="2097355"></a>

<a name="2097354"></a>

<a name="2097353"></a>

<a name="2097352"></a>

<a name="2097502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I can get it to crash if I build in release mode in monkey and build/run in msvc release mode. However, I have no idea where the crash is - not sure how you're debugging the release builds above...<br><br>Anyway, I've found I can 'fix' the crash by disabling compiler optimizations in msvc, ie: MonkeyGame.PhoneComponent-&gt;properties-&gt;c/c++-&gt;optimization and disable optimization. Does that fix it for you? If so, it means the issue could well be a bug in the msvc arm c++ compiler, as the same c++ code works everywhere else. <br><br></td></tr></table><br>
<a name="2097501"></a>

<a name="2097512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks mark, i will test it tonight and give you feedback ! .. <br><br></td></tr></table><br>
<a name="2097522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >k.o.g.</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Mark, good news.<br><br>The app runs, when optimization disabled is!<br><br>In this Mode, the string has the same length (Release: 5, Debug: 6) as debug mode in monkey. <br><br></td></tr></table><br>
<a name="2097519"></a>

<a name="2097520"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
