<!DOCTYPE html><html lang="en" ><head ><title >grabscreen "Invalid pixel rectangle"</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >grabscreen "Invalid pixel rectangle"</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=501" >Monkey Bug Reports</a>/<a href="#bottom" >grabscreen "Invalid pixel rectangle"</a><br><br>
<a name="2057475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dave.h</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> this works in release mode but not in debug mode.if i call the function as below.<br><br>grabscreen(100, 100, 200, 200)<br><br><br>Function grabscreen:Int(gs_x:Int, gs_y:int, SCREEN_WIDTH2:int, SCREEN_HEIGHT2:int)<br>	scrshot = CreateImage(SCREEN_WIDTH2, SCREEN_HEIGHT2)<br>	Local pixels:Int[] = New Int[SCREEN_WIDTH2 * SCREEN_HEIGHT2]<br>	ReadPixels(pixels, gs_x, gs_y, SCREEN_WIDTH2, SCREEN_HEIGHT2)<br>	scrshot.WritePixels(pixels, gs_x, gs_y, SCREEN_WIDTH2, SCREEN_HEIGHT2)<br>	DrawImage(scrshot, 100, 100)<br>	Return 0<br>End<br><br><br>in debug mode it fails and tells me error in line 126 of graphics.monkey which is the line below.<br><br>If x&lt;0 Or y&lt;0 Or x+width&gt;Self.width Or y+height&gt;Self.height Error "Invalid pixel rectangle"<br><br><br>All im doing is getting a partial screen grab.Like i say it works in release mode and i can just compile it in that. <br><br></td></tr></table><br>
<a name="2057497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> your image "scrshot" is to small for what you try to do.<br><br>Probably you mean this:<br><br><pre class=code>scrshot.WritePixels(pixels, 0, 0, SCREEN_WIDTH2, SCREEN_HEIGHT2)</pre> <br><br></td></tr></table><br>
<a name="2057506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dave.h</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No because that would always grab the screen starting at position 0,0 .im trying to do a screen grab of a portion of the screen from any starting point I choose.the code works perfectly in release mode.what you suggest will work but will always start the grab at position 0,0.the only reason I have posted this as a bug is because I thought that things ran the same in debug or release mode.thanks for your suggestion though. <br><br></td></tr></table><br>
<a name="2057511"></a>

<a name="2057512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> that sounds strange for me... the ReadPixel() reads a screen rectangle from 100/100 to 300/300 and stores it in an array...<br><br>The array is now filled from byte 0 to byte 40.000.<br><br>With WritePixel you write back the content to a image. The parameters are now target coordinates! I think you want to fill the image starting at the left top corner... so x and Y now has to be 0/0!<br><br>When you try to fill the image from 100/100 the 40.000 pixels will reach the coordinates 300/300, but the image width and height is only 200pixel.<br><br>The only reason why it "works" in release mode, ist because the compiler gives no error messages in release mode.<br><br>did you really test my suggestion?<br><br><pre class=code>scrshot = CreateImage(SCREEN_WIDTH2, SCREEN_HEIGHT2)
Local pixels:Int[] = New Int[SCREEN_WIDTH2 * SCREEN_HEIGHT2]
ReadPixels(pixels, gs_x, gs_y, SCREEN_WIDTH2, SCREEN_HEIGHT2)
scrshot.WritePixels(pixels, 0, 0, SCREEN_WIDTH2, SCREEN_HEIGHT2)</pre> <br><br></td></tr></table><br>
<a name="2057514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dave.h</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure I tried that before I posted but I will try again tomorrow.im up at 530am so I've no time now.cheers for the help. <br><br></td></tr></table><br>
<a name="2057572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dave.h</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok just tested it and you are indeed correct.I really thought i tried that but obviously not.thanks for the explanation and bearing with me while i was being stupid. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
