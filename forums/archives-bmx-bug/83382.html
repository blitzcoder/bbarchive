<!DOCTYPE html><html lang="en" ><head ><title >Crash While Loading Images</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Crash While Loading Images</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=105" >BlitzMax Bug Reports</a>/<a href="#bottom" >Crash While Loading Images</a><br><br>
<a name="940940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KrayzBlu</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>    I'm in the process of loading images, and then this comes up:<br><br><pre class=code>
main.debug(1802,0xa0652720) malloc: *** mmap(size=4198400) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug
</pre><br><br>Any help you could give would be much appreciated :)<br><br>Thanks!<br>~KrayzBlu <br><br></td></tr></table><br>
<a name="940941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What image format, bitdepth, and dimensions? <br><br></td></tr></table><br>
<a name="940943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KrayzBlu</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> PNG, 32-bit, 1000x1000 pixels. It loads a few of them before the crash. <br><br></td></tr></table><br>
<a name="940945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you sure you are not running out of video memory.<br><br>Each 1000x1000 32-bit image takes up 4MB of memory. <br><br></td></tr></table><br>
<a name="940951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Are you sure you are not running out of video memory.<br>Each 1000x1000 32-bit image takes up 4MB of memory.  <br></div><br><br>And keep in mind that the Windows desktop and such also take up a chunk in the background. <br><br></td></tr></table><br>
<a name="941006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KrayzBlu</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ugh, that would suck. What determines video memory? Wouldn't the computer automatically switch to virtual memory?<br><br>Do you know how big this video memory is? (Or is it variable...?) Is it a system thing or a BlitzMax thing?<br><br>Thanks <br><br></td></tr></table><br>
<a name="941032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> graphic cards can't switch to virtual memory, driver would have but that is a DX9 only thing. Neither OpenGL (no management at all) nor DX7.<br>All you render onscreen must fit into the VRAM at that point or it will just crash. <br><br></td></tr></table><br>
<a name="941052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Ugh, that would suck. What determines video memory? Wouldn't the computer automatically switch to virtual memory? <br></div><br><br>No -- videocard uses very fast dedicated memory on the video adapter itself. The only exception to this are the integrated onboard videocards that don't have their own memory but use the *much slower* normal system RAM for everything -- those can expand their memory and claim more RAM. (While depending on the amount of contiguous free system RAM available to them, AND the configuration settings that may limit how much RAM is available for them)<br><br>From a technical point of view the integrated adapters are very much inferior than the dedicated cards: much slower memory interactions, underpowered GPU, and typically a few generations behind in supported features. You're going to get much better frame rates on pretty much any dedicated 3D accelerator vs. onboard graphics.<br><br><div class="quote"> Do you know how big this video memory is? (Or is it variable...?) Is it a system thing or a BlitzMax thing? <br></div><br><br>It's a system thing. Unfortunately, Blitzmax has no built-in way to tell you how much videoram is present and/or available. It pretty much boils down to you doing the math, determinging that you use never use more than e.g. 187 MB or video RAM, add some reasonable allowance for videoRAM used by the operating system itself, and slap a '3D video card with 256MB memory'-line on the minimum system requirements of your game.<br><br>Blitz3D had a way of telling you how much available video RAM there was in DirectX. BlitzMax cannot, but technically that information should be accessible <i>somehow</i>. To my knowledge there is no way to query the available video memory under OpenGL.<br><br>Anyway, there are things you can do to reduce the need for video memory: for example, don't load every single background/sprite all at once at the beginning of your game, but only load them just before you need them and unload them once you are done.<br><br>If you don't have enough memory to hold everything at once (as is likely the case for you here), then you can do things like unload your menu screen once you leave the menu, unload the level 1 sprites before you load the level 2 sprites, etc. Video RAM is a finite resource... <br><br></td></tr></table><br>
<a name="941252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KrayzBlu</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, just wasn't exactly sure what VRAM was.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="941271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>malloc is not used to allocate graphics mem (and vboth dx and gl 'manage' vidmem anyway) so it's not a vidmem issue.<br><br>Can you post a runnable example - perhaps  using CreateImage instead of LoadImage to make it easier to test? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
