<!DOCTYPE html><html lang="en" ><head ><title >[GLMax2D] White Texture bug ... honing in?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >[GLMax2D] White Texture bug ... honing in?</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=127" >Bug Reports</a>/<a href="#bottom" >[GLMax2D] White Texture bug ... honing in?</a><br><br>
<a name="1041507"></a>

<a name="1326683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is code using my framework:<br><br><pre class=code>
SuperStrict
Import skully.TileMax
SetGraphicsDriver GLMax2DDriver()
TMStart()
'--------------------------------------------------------------------------
' Load Game Sprites
'--------------------------------------------------------------------------
Incbin "media/graphics/fplanes2.png"
Global spaceship:TImage=LoadImage("Incbin::media/graphics/fplanes2.png",DYNAMICIMAGE|MASKEDIMAGE )
TMSetImageMask(spaceship,121,173,183)

'--------------------------------------------------------------------------
' Set up Players
'--------------------------------------------------------------------------
Const ID_Actor:Int=0
Const ID_Player:Int=1

Global player:TMSprite=createplayer()
player.BindKey(KEY_LEFT,0,0,P_Angle,-1,KeyState_Held)
player.BindKey(KEY_RIGHT,1,0,P_Angle,1,KeyState_Held)
player.BindKey(KEY_UP,2,0,P_Velocity,0.01,KeyState_Held)
player.BindKey(KEY_DOWN,3,0,P_Velocity,-0.01,KeyState_Held)
'--------------------------------------------------------------------------
' Start Game Loop
'--------------------------------------------------------------------------
Global showtext:Int=False
While Not KeyDown(KEY_ESCAPE)
	TMUpdateTiming()
	TMUpdateIteration()
	TMSprite.UpdateAll()
	TMSprite.DrawAll(400,300)
	If KeyHit(KEY_T) showtext=1-showtext
	If showtext DrawText "Hello",0,0
	If KeyHit(KEY_P) TMSaveScreen()
	Flip
	Cls
Wend
'--------------------------------------------------------------------------
EndGraphics
End

Function CreatePlayer:TMSprite()
	Local player:TMSprite=TMCreateSprite(ID_Player,0,0,spaceship)
		player.MaxVelocity=5
		player.JumpSpeed=4
		player.pa.Anim.rot=270
		player.pa.SetScale(0.2,0.2)
		player.pa.SetAngleAligned()
		player.pa.SetFriction(0.999)
		player.Activate()
	Return player
End Function
</pre><br><br>Drawtext commented<br><img src="https://sites.google.com/site/skullyproductions/Home/files/Screengrab3.png"><br><br>Drawtext uncommented<br><img src="https://sites.google.com/site/skullyproductions/Home/files/Screengrab5.png"><br><br><a href="https://sites.google.com/site/skullyproductions/Home/files/spaceship.zip" target="_blank">Compiled Version (Zipped)</a><br>LT/RT Arrows turn, Up Arrow accelerates, down arrow decelerates.<br>Press T to turn drawtext on and off.. let me know if you see the same thing.<br><br>Pressing P saves the screen. <br><br></td></tr></table><br>
<a name="1041515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh... it works fine with the DX driver... no white texture.<br><br>Anyone else getting the white texture after pressing T? <br><br></td></tr></table><br>
<a name="1041546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've come across this behavior before using Indiepaths Render to texture module. To be honest i thought it was probably that modules fault, but seeing as these are the exact same symptoms (having to use drawtext to get GL to render correctly) then perhaps it wasn't.<br><br>What exactly are you doing to the images? you haven't included running source code.<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1041550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the case of the sprites, they are Sprite Types with Particles for visual representation.  The particles also have anims attached which actually control display...<br><br>essentially, the only thing I do with the image itself is this bit:<br><br><pre class=code>
		TMPushDraw()
		TMSetDraw(rsx,rsy,rr,blend,alpha)
		DrawSubImageRect (Self.image,x+ox,y+oy,sizeX,sizeY,frameX[frame],frameY[frame],sizeX,sizeY)
	'	DebugLog "Image w,h:"+Self.image.width+","+Self.image.Height+" DrawSubImageRect(x:"+(x+ox)+" y:"+(y+oy)+" w:"+sizeX+" h:"+sizeY+" sx:"+frameX[frame]+" sy:"+frameY[frame]+" sw:"+sizeX+" sh:"+sizeY+")"
		TMPopDraw()
</pre><br><br>As you can see I have monitored the values here too <br><br></td></tr></table><br>
<a name="1041557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested on my rig, as soon as I press T the sprite goes white... also I did notice before I pressed T when I rotated the sprite you could see this:<br><br><img src="http://www.therevillsgames.com/misc/spaceship.jpg"><br><br>Didnt you have an issue with the letter P not displaying correctly? <br><br></td></tr></table><br>
<a name="1041561"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I noticed the burr on the side of the image and have removed it from the one I have.. but I have an interesting development...<br><br>I expanded the code a bit to create comets.. I'll compile it... but the point is that if I create a comet first, its the comet texture that gets wrecked.<br><br><pre class=code>
SuperStrict
Import skully.TileMax
SetGraphicsDriver GLMax2DDriver()
TMStart()
'--------------------------------------------------------------------------
' Load Game Sprites
'--------------------------------------------------------------------------
Incbin "media/graphics/fplanes2.png"
Incbin "media/graphics/comet.bmp"
Global comet:TImage=LoadImage("Incbin::media/graphics/comet.bmp",DYNAMICIMAGE|MASKEDIMAGE )
Global spaceship:TImage=LoadImage("Incbin::media/graphics/fplanes2.png",DYNAMICIMAGE|MASKEDIMAGE )
TMSetImageMask(spaceship,121,173,183)
'--------------------------------------------------------------------------
' Set up Players
'--------------------------------------------------------------------------
Const ID_Actor:Int=0
Const ID_Player:Int=1
Const ID_Comet:Int=2

CreateComet(Rnd(-1800,1800),Rnd(-1400,1400))
Global player:TMSprite=CreatePlayer()
player.BindKey(KEY_LEFT,0,0,P_Angle,-2,KeyState_Held)
player.BindKey(KEY_RIGHT,1,0,P_Angle,2,KeyState_Held)
player.BindKey(KEY_UP,2,0,P_Velocity,0.1,KeyState_Held)
player.BindKey(KEY_DOWN,3,0,P_Velocity,-0.1,KeyState_Held)
'--------------------------------------------------------------------------
' Start Game Loop
'--------------------------------------------------------------------------
Global showtext:Int=False
Global focusx:Float=player.y
Global focusy:Float=player.x
While Not KeyDown(KEY_ESCAPE)
	If KeyDown(KEY_C) Then CreateComet(Rnd(-1800,1800),Rnd(-1400,1400))
	focusx:+((player.x-focusx)/12.0)
	focusy:+((player.y-focusy)/12.0)
	TMUpdateTiming()
	TMUpdateIteration()
	TMSprite.UpdateAll()
	TMSprite.DrawAll(-focusx+400,-focusy+300)
	If KeyHit(KEY_T) showtext=1-showtext
	If showtext Then DrawText "Hello",0,0
	If KeyHit(KEY_P) TMSaveScreen()
	Flip
	Cls
Wend
'--------------------------------------------------------------------------
EndGraphics
End

Function CreatePlayer:TMSprite()
	Local player:TMSprite=TMCreateSprite(ID_Player,0,0,spaceship)
		player.MaxVelocity=5
		player.JumpSpeed=4
		player.pa.Anim.rot=270
		player.pa.SetScale(0.2,0.2)
		player.pa.SetAngleAligned()
		player.pa.SetFriction(0.999)
		player.Activate()
	Return player
End Function

Function CreateComet:TMSprite(x:Float,y:Float)
	Local icomet:TMSprite=TMCreateSprite(ID_Comet,x,y)
	Local an:TMAnim=TMAnim.CreateAnim("comet",comet,27,31,1)
	an.AddFrames(0,0,5,0)
	an.AutoSetMidHandle()
	icomet.AddAnim(an)
	icomet.pa.P[P_AnimFrame ]=Rnd(0,5)
	icomet.SetVelocity(-Cos(ATan2(y,x)),-Sin(ATan2(y,x)))
	icomet.pa.P[P_RotVelocity]=1
	icomet.Activate()
End Function
</pre><br><br>OpenGL<br><img src="https://sites.google.com/site/skullyproductions/Home/files/Screengrab8.png"><br><br>DirectX<br><img src="https://sites.google.com/site/skullyproductions/Home/files/Screengrab9.png"><br><br>Download and run... <a href="https://sites.google.com/site/skullyproductions/Home/files/spaceship2.zip" target="_blank">here</a><br><br>press C to add more comets <br><br></td></tr></table><br>
<a name="1041577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Added a little map and some starting comets:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict
Import skully.TileMax

'Local mode:String=Input("DirectX? Y/N")
'WaitKey()

'SetGraphicsDriver GLMax2DDriver()
TMStart()
'--------------------------------------------------------------------------
' Load Game Sprites
'--------------------------------------------------------------------------
Incbin "media/graphics/fplanes2.png"
Incbin "media/graphics/comet.bmp"
Global comet:TImage=LoadImage("Incbin::media/graphics/comet.bmp",DYNAMICIMAGE|MASKEDIMAGE )
Global spaceship:TImage=LoadImage("Incbin::media/graphics/fplanes2.png",DYNAMICIMAGE|MASKEDIMAGE )
TMSetImageMask(spaceship,121,173,183)
'--------------------------------------------------------------------------
' Set up Players
'--------------------------------------------------------------------------
Const ID_Actor:Int=0
Const ID_Player:Int=1
Const ID_Comet:Int=2

For Local ct:Int=0 To 40
	CreateComet(Rnd(-1800,1800),Rnd(-1400,1400))
Next

Global player:TMSprite=CreatePlayer()
player.BindKey(KEY_LEFT,0,0,P_Angle,-2,KeyState_Held)
player.BindKey(KEY_RIGHT,1,0,P_Angle,2,KeyState_Held)
player.BindKey(KEY_UP,2,0,P_Velocity,0.1,KeyState_Held)
player.BindKey(KEY_DOWN,3,0,P_Velocity,-0.1,KeyState_Held)
'--------------------------------------------------------------------------
' Start Game Loop
'--------------------------------------------------------------------------
Global showtext:Int=False
Global focusx:Float=player.y
Global focusy:Float=player.x
While Not KeyDown(KEY_ESCAPE)
	If KeyDown(KEY_C) Then CreateComet(Rnd(-1800,1800),Rnd(-1400,1400))
	focusx:+((player.x-focusx)/8.0)
	focusy:+((player.y-focusy)/8.0)
	TMUpdateTiming()
	TMUpdateIteration()
	TMSprite.UpdateAll()
	drawmap(600,400,0.05)
	TMSprite.DrawAll(-focusx+400,-focusy+300)
	If KeyHit(KEY_T) showtext=1-showtext
	If showtext Then DrawText "Hello",0,0
	If KeyHit(KEY_P) TMSaveScreen()
	Flip
	Cls
Wend
'--------------------------------------------------------------------------
EndGraphics
End

Function CreatePlayer:TMSprite()
	Local player:TMSprite=TMCreateSprite(ID_Player,0,0,spaceship)
		player.MaxVelocity=5
		player.JumpSpeed=4
		player.pa.Anim.rot=270
		player.pa.SetScale(0.2,0.2)
		player.pa.SetAngleAligned()
		player.pa.SetFriction(0.999)
		player.Activate()
	Return player
End Function

Function CreateComet:TMSprite(x:Float,y:Float)
	Local icomet:TMSprite=TMCreateSprite(ID_Comet,x,y)
	Local an:TMAnim=TMAnim.CreateAnim("comet",comet,27,31,1)
	an.AddFrames(0,0,5,0)
	an.AutoSetMidHandle()
	icomet.AddAnim(an)
	icomet.pa.P[P_AnimFrame ]=Rnd(0,5)
	icomet.SetVelocity(-Cos(ATan2(y,x)),-Sin(ATan2(y,x)))
	icomet.pa.P[P_RotVelocity]=1
	icomet.Activate()
End Function

Function drawmap(cx:Float,cy:Float,ratio:Float=0.1)
	TMPushDraw
	For Local tsp:TMSprite=EachIn TMSprite.ActiveSprite
		Local ox:Float=(tsp.x-player.x)*ratio
		Local oy:Float=(tsp.y-player.y)*ratio
		If tsp=player
			SetColor 255,255,255
			DrawRect cx+ox-1,cy+oy-1,3,3
		Else
			SetColor 255,200,200
			Plot cx+ox,cy+oy
		End If
	Next
	TMPopDraw
End Function</textarea><br><br>If you want to see what this should look like download <a href="https://sites.google.com/site/skullyproductions/Home/files/spaceship3.zip" target="_blank">this one</a>, its DirectX <br><br></td></tr></table><br>
<a name="1041578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> this bug ALWAYS effects the very first texture displayed.  I can change what turns white by initially displaying something different... if i show sprites first and a comet is the first thing drawn, then all comets are white. If the player is drawn first (created first) then it turns white.  If I display a tile system in the background first it's texture goes white... ugh <br><br></td></tr></table><br>
<a name="1041589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Skully, try my code:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict
SetGraphicsDriver GLMax2DDriver()
HideMouse()

AutoMidHandle(1)

Const screenWidth% = 800
Const screenHeight% = 600
Local depth% = 0
Local showText% = False

Local spaceShipImg:TGameImage = TGameImage.LoadAnim("ship.png", 64, 64, 0, 7, DYNAMICIMAGE|MASKEDIMAGE )

Local spaceShipSprite:TPlayer= TPlayer.CreatePlayer(spaceShipImg, screenWidth / 2, screenHeight / 2)
spaceShipSprite.setFrame(3)
spaceShipSprite.SetScaleRotation(1, 1, 0, 2)
spaceShipSprite.SetSpeed(0, 0.25, -1, 4)

For Local i% = 0 To 1000
	TStar.CreateStar(Rand(0, screenWidth), Rand(0, screenHeight))
Next

Graphics screenWidth, screenHeight, depth

Repeat
	TStar.DrawAll()
	TStar.UpdateAll()
	spaceShipSprite.Update()
	spaceShipSprite.Draw()
	
	If KeyHit(KEY_T) showText = 1 - showText
	If KeyHit(KEY_Q) spaceShipSprite.drawNormal = 1 - spaceShipSprite.drawNormal
	If showText DrawText "Draw Normal :" + spaceShipSprite.drawNormal, 0, 0
	
	Flip
	Cls
Until AppTerminate() Or KeyHit(KEY_ESCAPE)

EndGraphics
ShowMouse()
End

Type TStar Extends TSprite
	Global list:TList = CreateList()
	Field r%, g%, b%
	Field fade%, fadeSpeed%
	
	Function CreateStar:TStar(x#, y#)
		Local s:TStar = New TStar
		s.x = x
		s.y = y
		Local c% = Rnd(255)
		s.r = c
		s.g = c
		s.b = c
		s.fade = Rand(1)
		s.fadeSpeed = Rand(5, 15)
		TStar.list.addlast(s)
		Return s
	End Function
	
	Function DrawAll()
		For Local s:TStar = EachIn TStar.list
			s.Draw()
		Next	
	End Function

	Function UpdateAll()
		For Local s:TStar = EachIn TStar.list
			s.Update()
		Next	
	End Function
	
	Method Draw()
		SetColor r, g, b
		Plot x, y
		SetColor 255, 255, 255
	End Method
	
	Method Update()
		If fade = 1
			r:-fadeSpeed
			b:-fadeSpeed
			g:-fadeSpeed
		Else
			r:+fadeSpeed
			b:+fadeSpeed
			g:+fadeSpeed	
		EndIf
		If (r &lt;= 0 Or g &lt;= 0 Or b &lt;=0) And fade = 1
			fade = 0
		EndIf
		If (r &gt; 255 Or g &gt; 255 Or b &gt; 255) And fade = 0
			fade = 1
		EndIf
	
	End Method
End Type

Type TPlayer Extends TSprite
	Function CreatePlayer:TPlayer(img:TGameImage, x#, y#)
		Local s:TPlayer = New TPlayer
		s.img = img
		s.x = x
		s.y = y
		s.scaleX = 1
		s.scaleY = 1		
		s.alpha = 1
		s.rotation = 0
		Return s
	End Function
		
	Method SetScaleRotation(scaleX#, scaleY#, rotation#, rotationSpeed#)
		Self.scaleX = scaleX
		Self.scaleY = scaleY
		Self.rotation = rotation
		Self.rotationSpeed = rotationSpeed
	End Method
	
	Method Update()
		Move()
		Controls()
	End Method
	
	Method Controls()
		If KeyDown(KEY_LEFT) 
			rotation:-rotationSpeed
			If frame &gt; 0
				frameDelay:+1
				If frameDelay &gt; maxFrameDelay
					frame:-1
					frameDelay = 0
				EndIf
			EndIf
		Else If KeyDown(KEY_RIGHT)
			rotation:+rotationSpeed
			If frame &lt; 6
				frameDelay:+1
				If frameDelay &gt; maxFrameDelay
					frame:+1
					frameDelay = 0
				EndIf
			EndIf			
		Else
			If frame &lt; 3
				frameDelay:+1
				If frameDelay &gt; maxFrameDelay
					frame:+1
					frameDelay = 0
				EndIf
			Else If frame &gt; 3
				frameDelay:+1
				If frameDelay &gt; maxFrameDelay
					frame:-1
					frameDelay = 0
				EndIf			
			EndIf
		EndIf
		If KeyDown(KEY_UP)
			If speed &lt; maxSpeed
				speed:+acceleration
			EndIf
		EndIf
		If KeyDown(KEY_DOWN)
			If speed &gt; minSpeed
				speed:-acceleration
			EndIf
		EndIf
	End Method
	
	Method Move()
		dx = Sin(rotation) * speed
		dy = -Cos(rotation) * speed		
		
		x:+dx
		y:+dy
		
		If x - (img.width2) &gt; screenWidth
			x = -(img.width2)
		EndIf
		If x + (img.width2) &lt; 0
			x = screenWidth + (img.width2)
		EndIf		
		If y - (img.height2) &gt; screenHeight 
			y = -(img.height2)
		EndIf
		If y + (img.height2) &lt; 0
			y = screenHeight + (img.height2)
		EndIf			
	End Method

End Type

Type TSprite Abstract
	Field x#, y#
	Field dx#, dy#
	Field rotation#, alpha#
	Field scaleX#, scaleY#
	Field frame%, speed#
	Field acceleration#
	Field maxSpeed#, minSpeed#
	Field rotationSpeed#
	Field img:TGameImage
	Field drawNormal% = True
	Field frameDelay%
	Field maxFrameDelay% = 3

	Method SetFrame(frame%)
		Self.frame = frame
	End Method	
	
	Method SetSpeed(speed#, acceleration#, minSpeed# = -1, maxSpeed# = 2)
		Self.speed = speed
		Self.acceleration = acceleration
		Self.minSpeed = minSpeed
		Self.maxSpeed = maxSpeed
	End Method
	
	Method Draw()
		SetAlpha alpha
		SetRotation rotation
		SetScale scaleX, scaleY
		If drawNormal
			DrawImage img.image, x, y, frame
		Else
			DrawSubImageRect(img.image, x, y, img.width, img.height, 0, 0, img.width, img.height, img.width2, img.height2, frame)
		EndIf
		SetAlpha 1
		SetRotation 0
		SetScale 1, 1
	End Method
	
	Method Update() Abstract
End Type

Type TGameImage
	Field image:TImage
	Field width%, height%
	Field width2%, height2%
	
	Function LoadAnim:TGameImage(path$, width%, height%, start%, total%, flags% = -1)
		Local gi:TGameImage = New TGameImage
		gi.image = LoadAnimImage(path, width, height, start, total, flags)
		gi.width = ImageWidth(gi.image)
		gi.height = ImageHeight(gi.image)
		gi.width2 = gi.width / 2
		gi.height2 = gi.height / 2		
		Return gi
	End Function
End Type
</textarea><br><br>Its just simple BlitzMax code, press T to display text and Q to switch render mode of the sprite. (I was getting carried away with the stars etc)<br><br>Code, Image and Exe:<br><a href="https://sites.google.com/site/therevillsgames/blitz/spaceShip_pureBlitz.zip" target="_blank">https://sites.google.com/site/therevillsgames/blitz/spaceShip_pureBlitz.zip</a><br><br>Does it work fine for you?<br><br><img src="https://sites.google.com/site/therevillsgames/blitz/spaceship.png"> <br><br></td></tr></table><br>
<a name="1041604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does DrawSubImageRect use a viewport/viewports to get the data to display? <br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1041658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've experienced exactly this before. I found the issue was the amount of RAM being used by the app. It happened with the same app on both windows and mac. Once I reduced the size of the IncBin'ed files the problem went away. After extensive testing I could get it to a point where the white rectangles would appear when in debug mode, but not in release mode because the debug exe/app was slightly larger. It's a really strange one. <br><br></td></tr></table><br>
<a name="1041664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> therevilles,<br>No problems with your code.. nice banking spaceship by the way :)  I'm going to modify it so it uses drawsubimagerect exclusively and see what happens.<br>{edit} no difference so I'll add a second image (since there has to be two for this to occur)<br><br><br><div class="quote"> Does DrawSubImageRect use a viewport/viewports to get the data to display?  <br></div><br><br>I've followed the DrawSubImageRect through the Max2D module right to the GLMAX2D driver (including adding debuglog statements) and I can't see whats causing the issue... no weirdness with it with the exception that in drawimagerect x0 and y0 were displaying as -0.0000000... so I added a max (num,0) wrapper on the x0,x1 initializations which did remove the -0.000000 but didn't change the results (white texture still) so I figured the -0.000000 is a blitz floating point anomaly.<br><br>DrawSubImageRect:<br><pre class=code>Function DrawSubImageRect( image:TImage,x#,y#,w#,h#,sx#,sy#,sw#,sh#,hx#=0,hy#=0,frame=0 )
	Local x0#=-hx*w/sw,x1#=x0+w
	Local y0#=-hy*h/sh,y1#=y0+h
	Local iframe:TImageFrame=image.Frame(frame)
	If iframe iframe.Draw(x0,y0,x1,y1,x+gc.origin_x,y+gc.origin_y,sx,sy,sw,sh)
'	If iframe DebugLog "iframe.Draw (x,y,x1,y1,tx,ty,sx,sy,sw,sh) "+x0+","+y0+","+x1+","+y1+","+(x+gc.origin_x)+","+(y+gc.origin_y)+","+sx+","+sy+","+sw+","+sh+")"
End Function
</pre><br><br>and the glmax2d driver frame draw... I had a debuglog statement for each gl statement and no negatives or texture breaching numbers there either:<br><pre class=code>	Method Draw( x0#,y0#,x1#,y1#,tx#,ty#,sx#,sy#,sw#,sh# )
		Assert seq=GraphicsSeq Else "Image does not exist"

		Local u0#=sx * uscale
		Local v0#=sy * vscale
		Local u1#=(sx+sw) * uscale
		Local v1#=(sy+sh) * vscale
		
		EnableTex name
		glBegin GL_QUADS
		glTexCoord2f u0,v0
		glVertex2f x0*ix+y0*iy+tx,x0*jx+y0*jy+ty
		glTexCoord2f u1,v0
		glVertex2f x1*ix+y0*iy+tx,x1*jx+y0*jy+ty
		glTexCoord2f u1,v1
		glVertex2f x1*ix+y1*iy+tx,x1*jx+y1*jy+ty
		glTexCoord2f u0,v1
		glVertex2f x0*ix+y1*iy+tx,x0*jx+y1*jy+ty
		glEnd
	End Method
</pre><br><br>Oddball,<br>Agreed..its a weird one.   two images I'm using are really small so I'm not sure how memory consumption would be the problem... its also ONLY openGL which is what makes it even weirder <br><br></td></tr></table><br>
<a name="1041671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found out what was causing the issue!  So excited!<br><br>I DON'T know why but this code removed from the tilemax graphics initialization removes the white texture bug...<br><br><pre class=code>

			Local ti:TImage=LoadImage("incbin::splash.png",DYNAMICIMAGE|MASKEDIMAGE)
			MidHandleImage ti
			
			Local TMS:TMSequencer=TMSequencer.CreateSequencer(1,0,1.5)
			Local tms2:TMSequencer=TMCreateSequencer(ti.width/2,ti.width,1.5)
			SetBlend ALPHABLEND
			While TMS.Position&lt;1
				TMUpdateTiming()
				SetAlpha TMS.GetValue()
				SetScale 0.4,0.4
				DrawImage ti,tms2.GetValue(),height-(ti.height*0.4/2)
				Flip
				Cls
			Wend
			SetAlpha 1
			SetScale 1,1
</pre><br>This was the TileMax logo that flew across the bottom of the screen! <br><br></td></tr></table><br>
<a name="1041682"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> What about if you changed the flags on loading the image?<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1041685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried DYNAMICIMAGE|MASKEDIMAGE, MASKEDIMAGE, and none... all the same. <br><br></td></tr></table><br>
<a name="1041752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about if you don't IncBin splash.png? <br><br></td></tr></table><br>
<a name="1041772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> No change... incbin'd or not the white texture bug comes back so I don't know what would be causing that... <br><br>I'll just leave the code out.  Its not necessary <br><br></td></tr></table><br>
<a name="1041797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabhand</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Scary thing is that this bug is still there, buried somewhere, and it'll obviously poke its ugly head again.<br><br>Shame it couldnt be nailed directly, but well done for fixing your issue, since it's had you tearing your head out for the last few week! ;)<br><br>Dabz <br><br></td></tr></table><br>
<a name="1041804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> nice banking spaceship by the way :)  <br></div><br>Good old Xenon 2000 ship there :P<br><br><img src="http://www.bitmap-brothers.co.uk/Image6.jpg"><br><br>Have you hacked that piece of code which you have found which causes your issue?<br><br>For example, try removing your TMUpdateTiming() call... then the scale commands etc.<br><br>Have you compiled on different PCs to see if you get the same issue? <br><br></td></tr></table><br>
<a name="1041815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've done all I can to that code.. commenting this and that.. the only thing that works is to comment out anything to do with the image...<br><br>It shows up no matter what PC... I even compiled on two separate PC's to check that it wasn't my laptop OpenGL intallation... all the same<br><br>I'm going to package up the code an zip it just in case Mark wants to take a look... I've followed it as far as I can really and I don't want to stall development any further than it has already.<br><br>For now, all I know is that I'm back up and running an coding/commenting like crazy again :)... waiting for the wife to tell me to "get off that damn computer" again ;) <br><br></td></tr></table><br>
<a name="1044452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am getting reports from some people seeing white squares in my game, exclusively on the newer Macintoshes.<br><br>I just made a post on this here:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=91759" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=91759</a> <br><br></td></tr></table><br>
<a name="1060862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jur</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have the same situation in OpenGL.  I am working on a project and I am  adding new images.  In rare occasion (for now, hopefully) I will get an image which will be drawn constantly as a white rectangle. It doesnt matter if I change the size of that image, build in debug or release mode, the problem persists. <br><br>I did found out that problem is related to the drawing order.  I have a flag in my loading routine, which allows to draw image to some offscreen location after loading (to get the image into vram). If I skip this "pre-drawing" then the problem goes away. <br><br>It looks to me that in specific situations the image can get corrupted when loaded into vram. <br><br></td></tr></table><br>
<a name="1067371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonM</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have this problem too.<br><br>Here is my code:<br><pre class=code>SuperStrict
SetGraphicsDriver GLMax2DDriver()
Graphics 800,600


'DrawImage LoadImage("1.png"),0,0
Loading()


For Local i:Int=0 To 100
	Local img:TImage = LoadImage("1.png")
Next


Global image1:TImage = LoadImage("1.png") 
Global image2:TImage = LoadImage("2.png") 


DrawImage image2,0,0 'draw normal
'Flip;WaitMouse
DrawImage image1,0,0
'Flip;WaitMouse
DrawImage image2,0,0 'draw white rect
	
Flip
WaitMouse
End
	
Function Loading()
	Local i:TImage = LoadImage("1.png")
	DrawImage i,0,0
EndFunction</pre><br>Maybe somebody knows how to solve this problem? <br><br></td></tr></table><br>
<a name="1068328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> The most obvious conclusion is that the texture reference is being freed up by OpenGL for whatever reason  (which is what I've always said). <br><br></td></tr></table><br>
<a name="1068400"></a>

<a name="1068401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try putting<br><pre class=code>GLShareContexts()</pre><br>before setting your graphics driver.<br><br>I had the same problem in a maxgui-app with multiple canvases. Maybe it will fix this one too.<br><br>Edit: o_O Brucey is back<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1068405"></a>

<a name="1068406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried AntonM code... and yes the white texture bug displays!!!<br><br>Messing with the code I found:<br><br>* If you dont call Loading() its fine<br>* If you do the Loading() code outside the function its fine<br>* GLShareContexts didnt fix it<br>* If you change the ordering of the drawing to: image1, image2, image2 - its fine<br>* Using DirectX its fine<br><br>Strange...<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1068418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Declaring the image in the Loading Function Global also fixes the problem. <br><br></td></tr></table><br>
<a name="1068614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The most obvious conclusion is that the texture reference is being freed up by OpenGL for whatever reason (which is what I've always said).  <br></div><br>seems correct, because<br><br><div class="quote"> <br>Declaring the image in the Loading Function Global also fixes the problem. <br></div><br>fixes this problem using the code above on my Mac. <br><br></td></tr></table><br>
<a name="1069140"></a>

<a name="1069148"></a>

<a name="1069154"></a>

<a name="1069155"></a>

<a name="1069302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying out this temporary solution:<br><br>Could you let me know if it works for any of you?<br><br>[EDIT] Sorry, this does not seem to fix anything :-( look below for another version.<br><br><pre class=code>
' put this in the top of any OpenGl program, to avoid the white image?

Global whitefixer:TImage = CreateImage(32,32)</pre><br><br>I've investigated a little and <br><pre class=code>	For Local i:Int =1  To 10
		DebugLog glIsTexture(i)
	Next	</pre> seems to indicate that OpenGl still has the textures loaded.<br><br>in the example above, changing the loop to<br><pre class=code>
For Local i:Int=0 To 1
	Local img:TImage = LoadImage("1.png")
        GCCollect() 
Next
</pre> <br>will also show a white texture<br><br>EDIT: Now trying this:<br><pre class=code>
' call WhiteFix() at the start of your OpenGL program 
Function WhiteFix()
	Global whitefixer:TImage = CreateImage(32,32)
End Function	</pre><br><br>Could you let me know if it works for any of you?<br><br>[EDIT] no need, that didn't fix anything, sticking all images in a global list seems to help?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I found a semi solid soulution, although it will need some testing.<br><br>In glmax2d Function CreateTex() textures are flushed.<br><br>The problem seems to be related to allocating a new texture name, that is the same as one just deleted.<br><br>I've changed the first part of the code to not use a newly deleted name, and that seems to work.<br><br>Please test  <br><pre class=code>Function CreateTex( width,height,flags )

	'flush dead texs
	If dead_tex_seq=GraphicsSeq
		For Local i=0 Until n_dead_texs
			'DebugLog "deleting " + dead_texs[i]
			glDeleteTextures 1,Varptr dead_texs[i]
		Next
	EndIf

	'
	'alloc new tex
	Local name

	Local safename:Int = False

	While Not safename
		glGenTextures 1,Varptr name
		safename = True
		For Local i=0 Until n_dead_texs
			If dead_texs[i] = name Then
				safename = False
			EndIf
		Next
	Wend

	'DebugLog "generated texture name " + name

	n_dead_texs=0
	dead_tex_seq=GraphicsSeq
	
	BindTex name</pre> <br><br></td></tr></table><br>
<a name="1069320"></a>

<a name="1069322"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you removed this line?:<br><br><pre class=code>glGenTextures 1,Varptr name</pre><br><br>This is my CreateTex in glmax2d in v1.41:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function CreateTex( width,height,flags )

	'flush dead texs
	If dead_tex_seq=GraphicsSeq
		For Local i=0 Until n_dead_texs
			glDeleteTextures 1,Varptr dead_texs[i]
		Next
	EndIf
	n_dead_texs=0
	dead_tex_seq=GraphicsSeq
	'
	'alloc new tex
	Local name
	glGenTextures 1,Varptr name
	
	BindTex name
	
	'set texture parameters
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_S,GL_CLAMP_TO_EDGE
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_T,GL_CLAMP_TO_EDGE
	
	If flags &amp; FILTEREDIMAGE
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR_MIPMAP_LINEAR
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR
		EndIf
	Else
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_NEAREST
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST_MIPMAP_NEAREST
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST
		EndIf
	EndIf

	Local mip_level

	Repeat
		glTexImage2D GL_TEXTURE_2D,mip_level,GL_RGBA8,width,height,0,GL_RGBA,GL_UNSIGNED_BYTE,Null
		If Not (flags &amp; MIPMAPPEDIMAGE) Exit
		If width=1 And height=1 Exit
		If width&gt;1 width:/2
		If height&gt;1 height:/2
		mip_level:+1
	Forever

	Return name
End Function
</textarea><br><br>Could you post your entire CreateTex function?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Have you removed this line?: <br></div><br>Nope. It's in the loop.<br><br>Full version:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function CreateTex( width,height,flags )

	'flush dead texs
	If dead_tex_seq=GraphicsSeq
		For Local i=0 Until n_dead_texs
			'DebugLog "deleting " + dead_texs[i]
			glDeleteTextures 1,Varptr dead_texs[i]
		Next
	EndIf

	'
	'alloc new tex
	Local name

	Local safename:Int = False

	While Not safename
		glGenTextures 1,Varptr name
		safename = True
		For Local i=0 Until n_dead_texs
			If dead_texs[i] = name Then
				safename = False
			EndIf
		Next
	Wend

	'DebugLog "generated texture name " + name

	n_dead_texs=0
	dead_tex_seq=GraphicsSeq
	
	BindTex name
	
	'set texture parameters
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_S,GL_CLAMP_TO_EDGE
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_T,GL_CLAMP_TO_EDGE
	
	If flags &amp; FILTEREDIMAGE
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR_MIPMAP_LINEAR
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR
		EndIf
	Else
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_NEAREST
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST_MIPMAP_NEAREST
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST
		EndIf
	EndIf

	Local mip_level

	Repeat
		glTexImage2D GL_TEXTURE_2D,mip_level,GL_RGBA8,width,height,0,GL_RGBA,GL_UNSIGNED_BYTE,Null
		If Not (flags &amp; MIPMAPPEDIMAGE) Exit
		If width=1 And height=1 Exit
		If width&gt;1 width:/2
		If height&gt;1 height:/2
		mip_level:+1
	Forever

	Return name
End Function
</textarea> <br><br></td></tr></table><br>
<a name="1069329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking at that code, It will probably need something to free up the "unsafe" names for reuse. I'll add that and see if it still works. <br><br></td></tr></table><br>
<a name="1069336"></a>

<a name="1069337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> . still working on it<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> This seems to be ok.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function CreateTex( width,height,flags )

	'flush dead texs
	If dead_tex_seq=GraphicsSeq
		For Local i=0 Until n_dead_texs
			DebugLog "deleting " + dead_texs[i]
			glDeleteTextures 1,Varptr dead_texs[i]
		Next
	EndIf

	'
	'alloc new tex
	Local name

	Local safename:Int = False
	
	Local unsafes:Int[n_dead_texs]
	Local unsafecount:Int

	While Not safename
		glGenTextures 1,Varptr name
		safename = True
		For Local i=0 Until n_dead_texs
			If dead_texs[i] = name Then
				unsafes[unsafecount] = name
				unsafecount:+1
				safename = False
			EndIf
		Next
	Wend
	
	
'	For Local i=0 Until unsafecount
'		DebugLog "deleting " + unsafes[i]
'		glDeleteTextures 1,Varptr unsafes[i]
'	Next	
	
	If unsafecount
		glDeleteTextures unsafecount,Varptr unsafes[0]	
		DebugLog "releasing 'unsafe' names to OpenGL - Count: " + unsafecount
	EndIf

	DebugLog "generated texture name " + name

	n_dead_texs=0
	dead_tex_seq=GraphicsSeq
	
	BindTex name
	
	'set texture parameters
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_S,GL_CLAMP_TO_EDGE
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_T,GL_CLAMP_TO_EDGE
	
	If flags &amp; FILTEREDIMAGE
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR_MIPMAP_LINEAR
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR
		EndIf
	Else
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_NEAREST
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST_MIPMAP_NEAREST
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST
		EndIf
	EndIf

	Local mip_level

	Repeat
		glTexImage2D GL_TEXTURE_2D,mip_level,GL_RGBA8,width,height,0,GL_RGBA,GL_UNSIGNED_BYTE,Null
		If Not (flags &amp; MIPMAPPEDIMAGE) Exit
		If width=1 And height=1 Exit
		If width&gt;1 width:/2
		If height&gt;1 height:/2
		mip_level:+1
	Forever

	Return name
End Function

</textarea> <br><br></td></tr></table><br>
<a name="1071132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> It just occured to me that simply changing the glGenTextures(), glDeleteTextures() order should fix this in a mush simpler way than the convoluted approach above.<br><br>It seems to work well here.<br><br>It would be really nice if you could take the time and test this.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function CreateTex( width,height,flags )



	'alloc new tex
	Local name
	glGenTextures 1,Varptr name
	BindTex name


	'flush dead texs
	If dead_tex_seq=GraphicsSeq
		For Local i=0 Until n_dead_texs
			glDeleteTextures 1,Varptr dead_texs[i]
		Next
	EndIf
	n_dead_texs=0
	dead_tex_seq=GraphicsSeq
	'

	
	'set texture parameters
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_S,GL_CLAMP_TO_EDGE
	glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_WRAP_T,GL_CLAMP_TO_EDGE
	
	If flags &amp; FILTEREDIMAGE
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR_MIPMAP_LINEAR
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR
		EndIf
	Else
		glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_NEAREST
		If flags &amp; MIPMAPPEDIMAGE
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST_MIPMAP_NEAREST
		Else
			glTexParameteri GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_NEAREST
		EndIf
	EndIf

	Local mip_level

	Repeat
		glTexImage2D GL_TEXTURE_2D,mip_level,GL_RGBA8,width,height,0,GL_RGBA,GL_UNSIGNED_BYTE,Null
		If Not (flags &amp; MIPMAPPEDIMAGE) Exit
		If width=1 And height=1 Exit
		If width&gt;1 width:/2
		If height&gt;1 height:/2
		mip_level:+1
	Forever

	Return name
End Function
</textarea> <br><br></td></tr></table><br>
<a name="1082465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested AntonM code using v1.42 at work and no white texture bug :)<br><br>I did try it at home yesterday but I couldn't repeat it using v1.41 (freshly downloaded), but at work I get the white texture bug using v1.41.<br><br>So v1.42 looks good :)<br><br>@Skully - can you try this with your TileMax stuff? (where are you btw!?!??! :P ) <br><br></td></tr></table><br>
<a name="1290138"></a>

<a name="1290140"></a>

<a name="1290142"></a>

<a name="1290143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> No-one seems to have found a simple solution to this problem, and yes, it was happening to me. Total WHITEOUT when I tried to use DrawText(), it would WHITEOUT my primary image (the entire screen).<br><br>I found a solution of sorts, create a dummy image thus:<pre class=code>Global dumi:TImage=CreateImage(1,1) ' necessary because of white rectangle error
' (see thread) http://www.blitzbasic.com/Community/posts.php?topic=91541</pre>Draw it just prior to wherever in your code you are using CLS, you don't actually want it appearing.<br><br>THIS image will become the WHITEOUT one, and your other images will be safely left intact.<br><br>This is a nasty bug that BlitzMAX has, didn't appear until I really started to add some serious drawing elements and code to my project, at least now I know how to control it.<br><br>Hope This Helps ! <br><br></td></tr></table><br>
<a name="1290607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did want to add, this WHITE rectangle phenomenon VANISHES COMPLETELY (at least for me) if you use Front Buffering for your graphics.<br><br>I think that pins it down to FLIP() <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
