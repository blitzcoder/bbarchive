<!DOCTYPE html><html lang="en" ><head ><title >Stunt Car Racing Multiplayer</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Stunt Car Racing Multiplayer</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >Stunt Car Racing Multiplayer</a><br><br>
<a name="581703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need a bit of advice regarding using Tokamak over a network - Stunt Car Racing seems to work just fine with 2 or more cars, but obviously each one is a collection of jointed Tokamak entities and suchlike, so I need to know how is best to run such a system over a network.<br><br>Split-screen is no problem, and the single Tokamak world and entities will exist and interact within the single program, but running over a network allows for a few possible options as far as I can see -<br><br>1. Run all the tokamak for all cars on one PC, then just get control input updates from the clients to control the cars locally, then send back the new positions for the visual entities only, and do no Tokamak at all on the clients.<br><br>2. Run Tokamak for the local car on each PC, then try to simulate the collisions using impulses etc...<br><br>3. Run Tokamak for the local car on each PC and ignore any collisions (Trackmania style) - not much fun this way.<br><br>The only other option seems to be to run Tokamak for the local car on each PC, then move a single tokamak body around in the world that represents each remote car. However I can see some real problems with the remote body hitting the local tokamak car, and I just don't see it working.<br><br>If anyone has any hints or tips on this I'd be very grateful to hear, as obviously 3 or 4 player over a network is more fun that 2 player split-screen.<br><br>To spark your interest, here's a screenie with 2 cars lined up ready to race - <br><img src="http://www.jameskett.dsl.pipex.com/SCR_multi.jpg"> <br><br></td></tr></table><br>
<a name="581725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, as i have commented before, you could use a 'dead reckoning system'. The DR System is very much used when running physics simulation over a network.<br><br>The idea is to have all computers running all full physics and synchronizing remote cars periodically.<br><br>In the DR algorith you send periodically local position, velocity, direction and user input, then the remote players update remote values and extrapolate positions using the remote input untill a new value arrives.<br><br>To avoid position jumps, the DR algorithm only updates position if there is enough position difference from actual values and the values received.<br><br>Advantages:<br><br>- Smooth movement<br>- Real Physics in every computer<br>- Easy implementation<br><br>Disadvantages:<br><br>- Some problem when cars collides at great velocities.<br><br>You can avoid the problems updating position only when not collided.<br><br>I suggest you to implement the basic algorithm then use your own tweaks.<br><br>I have implemented it in my racing game and is working great over internet!<br><br>Good Luck! <br><br></td></tr></table><br>
<a name="581742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> So using this system, each PC would run full physics for all cars, then pass their coords back and forth to check for any car being away from its real position. If it is, all systems will update their local car position to the real position.<br><br>The only problem I can immediately see is that there is no way to move a jointed Tokamak vehicle instantly from one place to another - you just end up with huge forces on some of the jointed parts and the object gets slung around. I originally tried to just re-position the cars after they fell off the track, but there is no way to do it. Even resetting all the force values to zero doesn't seem to work. In the end I had to make it rebuild the car completely when it gets reset.<br><br>However, having just read what I've written it occurs to me that I didn't reposition the joints themselves, just the physical entities, so I might try that again and see if I can get it to work.... <br><br></td></tr></table><br>
<a name="581759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi vorderman!<br><br>What i do in the Racer is:<br><br>have a flag to disable physics on logged-in cars. The disable simply stops the car from moving.<br><br>I use the network to send the position of each player from their clients, AND VELOCITIES. the velocities makes the collisions work properly.<br><br>ON receiving the location of a car, set the physics body of that car to the received location, and velocity. Over LAN, the racer runs absolutely fine like this, and is mostly playable with a tad of lag over a few hundred miles.<br><br>Lemme know if you need more information :) (yeah, there are other ways to do it, but this is my way. )<br><br>[edit]<br><br>to add to what Kurix said, which is probrably the better way, and is the way my new network code will do it,<br><br>When two cars collide at great velocities, theres a chance that one will act like it was made of rubber and it just hit a wall at 500 mph, bouncing off backwards.. Fnuny to watch.<br><br>Me and Evak have laughed quite a few times when our cars decided to visit the moon... <br><br></td></tr></table><br>
<a name="581762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br> Even resetting all the force values to zero doesn't seem to work<br> <br></div><br><br>Dont know where to start- You may be doing it wrong :? <br><br></td></tr></table><br>
<a name="581789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, i am using ode, and although repositioning a jointed body in ode is not a good idea, is working fine, because i position the body, then i set the velocities to the right values.<br><br>I don't know if you can make it with tokamak. <br><br></td></tr></table><br>
<a name="581795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive used the technique in both ODE and toka. it was easier on toka, ODE seems to dislike it a bit, but if youre stubborn with it, its fine (in ode, i force the reset to take place two frames in a row.) <br><br></td></tr></table><br>
<a name="581834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Dont know where to start- You may be doing it wrong :? <br></div><br><br>Yep, I was - just re-wrote the reposition routine in 1/2 hour and it works perfectly, so now I can ditch the code that deletes and rebuilds the car and use this nice quick easy repos routine instead. I forgot to repos the joints last time, I think that was the problem. <br><br><div class="quote"> use the network to send the position of each player from their clients, AND VELOCITIES <br></div><br><div class="quote"> In the DR algorith you send periodically local position, velocity, direction and user input <br></div><br>I think I'll try running this dead-reckoning system, sounds reaasonably easy to implement and I can't see many possible pitfalls, apart from when a remote car is repositioned inside another car...wonder what would happen then? <br><br></td></tr></table><br>
<a name="581837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> then... BOING (in ODE) one car flies off :) <br><br></td></tr></table><br>
<a name="581848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm tempted to try it in Tokamak and see what happens....<br><br>lol, this is what happens - <br><img src="http://www.jameskett.dsl.pipex.com/SCR_respawn.jpg"><br><br>Not too bad though, even with one car spawning right inside the other, they just get flung apart a bit. Can't see a case this bad happening in the game, so long as the clients are updated and checked pretty often. <br><br></td></tr></table><br>
<a name="581853"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehe. I should have known, I had the same thing happen yesterday when testing my library :)<br><br>As you said though, there shouldnt be a point where two cars spawn at the same point, you could just move player2's spawn point forward by the car length :) <br><br></td></tr></table><br>
<a name="581855"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now is where tweaking is important.<br><br>One thing you can make is not reposition the car if it is too near from other :)<br><br>DeadReckoning + Some Tweaks = Good System! <br><br></td></tr></table><br>
<a name="581856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> i have to say, these graphics are already top-notch. add physics andnetworking and you have a hit :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
