<!DOCTYPE html><html lang="en" ><head ><title >Raknet - Whats WRONG with it??</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Raknet - Whats WRONG with it??</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >Raknet - Whats WRONG with it??</a><br><br>
<a name="1040749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This post is pretty much out of desperation. I have been trying out the Raknet wrapper that's made for both BlitzMax and Blitz3D; coming with examples for both and documentation on the library. Worthy to mention is that this is not Kurix's wrapper but another by RepeatUntil which is somewhat based on Kurix'.<br><br>So Here is the problem: Raknet just lags, it hogs up to 100% on CPU process once "RN_Startup" is called and a connection is successfully established. It works, but I just can't get why it causes such a slowdown and it definitely comes from the dll; once the connection and peer is closed, the Blitz3D application speed goes back to normal.<br><br>Even tested this on a raw and empty B3D code sheet, the lib will just cause terrible framerates even on computers with more than one single core.<br><br>I am with B3D 1.103, downgraded to each version down to 1.98 to try it out on each, it gives the same result... Any ideas? <br><br></td></tr></table><br>
<a name="1040801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> RN_Startup%(rakPeerInterface%,maxConnections%, threadSleepTimer%, localPort%):"RN_Startup@16"<br><br>Think I found it, it could be that sleepTimer has to be a higher value. <br><br></td></tr></table><br>
<a name="1040859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Raknet is cool, but, try this : <a href="http://www.blitzbasic.com/Community/posts.php?topic=83448" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=83448</a><br><br>JP <br><br></td></tr></table><br>
<a name="1041292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..I'm not really looking to have people telling me to use a different library when I'm trying to solve this issue with the current one I'm using.<br><br>anyways, SleepTimer does not seem to be the case. Could it be that the dll needs to be recompiled with certain preprocessor directives enabled for minimal CPU usage? <br><br></td></tr></table><br>
<a name="1041539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> :(<br>I responded because I thought you had solved your problem. It was a reminder that there were other engines networks.<br>Lesson learned. Good luck. <br><br></td></tr></table><br>
<a name="1041735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pinete</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dear Sake906,<br>you will have to be more patient and have better understanding with people who try to help you.<br>I could understand your answer in terms of paid-per-help, but it is not the case.. <br>So what you're going get with that attitude is that people don't mind what you ask in the future. <br><br></td></tr></table><br>
<a name="1041742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..And what exactly is so "impatient" about my answer to ZJP? it was an honest reply and I think getting a "whatever, try this other thing: *links*" and completely overlooking the topic (and library in question) is more impolite than my "impatient" response, but the person already clarified it was because they thought I solved my problem.<br><br>I did look into XNET but will keep it as an option in case everything I try with RakNet fails. <br><br></td></tr></table><br>
<a name="1042128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferret</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using the same lib.<br><br>I'm just getting into RakNet but have not encounterd any problems with framerate or cpu usage.<br>With a client and server running on the same machine mi cpu usage is 67%<br><br>This is code from the client<br><pre class=code>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Global peer = 0
Global serverIp$ = "127.0.0.1"
Global serverPort = 61019
Global packet = 0

Global BitStreamIN = RN_BitStreamCreate1(0)
Global B = RN_BitStreamCreate1(0)

Const ID_CHAT = 101

Include "Include/raknet.bb"

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function Connect()
	peer = RN_GetRakPeerInterface()
	RN_Startup(peer,1,0,0)   ;1 player allowed To connect -&gt; client
	
	Local ok = 0
	ok = RN_Connect(peer,serverIp, serverPort, "", 0)
	If ok = 1
		Connected = True
		Return True
	Else
		Return False
	EndIf
End Function
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
Function UpdateNet()
	packet = RN_Receive(peer)
	If (packet) Then
		Local msg$ = RN_PacketGetData(packet)
		Local msgType = Asc(msg$)
		
		Select msgType
			Case ID_CONNECTION_REQUEST_ACCEPTED
				lastentry$ = "Connected"
			
			Case ID_CONNECTION_ATTEMPT_FAILED
				lastentry$ = "Connection Failed"
				
			Case ID_CHAT
				lastentry$ = "Chat Message: " + msg
				
		End Select
	EndIf
End Function
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</pre> <br><br></td></tr></table><br>
<a name="1042430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferret</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can also run some of your code on mi system if you want. <br><br></td></tr></table><br>
<a name="1043051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Baystep Productions</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> IMPATIENT ANSWER!<br><br>I wrote a network library along time ago, it worked fine and was easy to make.<br>Raknet sucks.<br>Download the other library. <br><br></td></tr></table><br>
<a name="1044099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ferret thank you very much. The code seems to be the same I'm having over here, only that I created some types to handle stuff on a more OOP way.<br><br>I do not see a main loop in your code though, but I guess you know that. I'm going to fetch my code and place it here in a bit just to show you what I'm using, though I doubt that's going to make a difference since the demos that came with the lib are also having the issue.<br><br>Have you recompiled the DLL or something like that? I'd like to know and also what version of it you are using.<br><br>Thanks in advance. <br><br></td></tr></table><br>
<a name="1044137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ferret:<br><br>Tried your client code, still gives me the same results as all the other raknet samples and my own samples. I wonder if you'd be able to provide the DLL you are using for your program? I am not sure if the one I have is optimized... <br><br></td></tr></table><br>
<a name="1045657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferret</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure about what version i'm using.<br>I did not recompile the DLL, i downloaded it from this link.<br><a href="http://repeatuntil.free.fr/raknet/index.html" target="_blank">http://repeatuntil.free.fr/raknet/index.html</a><br><br>I can provide the DLL i'm using if i'm allowed by the author, so ill send him a mail if you still want it. But i think the download still contains the same version as when i downloaded it.<br><br>UpdateNet() is what i call first in mi main loop, before i do anything else. <br><br></td></tr></table><br>
<a name="1047566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sake906</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really don't get this...<br><br>The problem is not in the update check, simply starting the "rakpeer interface" it already takes an insane amount of process, with or without the update loop.<br><br>Even tested it on another machine with multiple cores, slowdown is present. <br><br></td></tr></table><br>
<a name="1047610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
