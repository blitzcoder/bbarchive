<!DOCTYPE html><html lang="en" ><head ><title >WB3D forced repaint event?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >WB3D forced repaint event?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >WB3D forced repaint event?</a><br><br>
<a name="913230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been looking for something like this for ages..<br>Is there a way in wb3d /win32api to force a window's contents or a specific gadget to be 'repainted'?<br><br>I build complex custom windows with numerous gadgets. So I need to use wb3d_WB3D_AutoSetGadgetRedraw( window, 0) to disable SEEING gadgets being created, moved, reshaped, etc. Afterwards, I restore it back to '1'. <br>Without this, the changes to the gadgets would slow things down dramatically. But after this event, the window containing those gadgets won't be properly 'painted' - so the results aren't really 'visible' until you dip the window off screen and back again for example.<br>Can anyone follow this?! :D<br><br>Cheers,<br>D.<br>p.s. I'm using WB3D_Strict_GadgetCreation as well, which helps, but not when altering existing gadget's (shapes).. <br><br></td></tr></table><br>
<a name="913317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I follow what you're saying Danny, but I can't find anything like WB3D_AutoSetGadgetRedraw in the help file.<br><br>What is the command you are using? <br><br></td></tr></table><br>
<a name="913325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> try the API InvalidateRect function, pass 0 as the lpRect param. it would look like this, it should force the entire client area to be re-drawn.<br><br>user32_InvalidateRect(windows_hwnd,0,True)<br><br>InvalidateRect can be found in user32.dll <br><br></td></tr></table><br>
<a name="913503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Kev, sounds like a good trick! It would be so good if can get this to work, for sure!!<br><br>@John; No I don't believe it's in the help files. I use the decls for reference anyway ;) It takes a gadget/window handle and a 'state', setting state 0 seems to turn off the automatic repaint/redraw, whilst state 1 enables it again. How it otherwise behaves or should be used I have no idea - sorry that's all I know on it :D<br><br>Thanks again guys,<br>Next round's on me!<br><br>D. <br><br></td></tr></table><br>
<a name="913535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Shame, it didn't work. Well, that is, I can't seem to call this api_InvalidateRect() without getting a Memory Access Violation..<br><br>I've tried:<br>api_InvalidateRect( SystemProperty("AppHwnd") , 0, True )<br>api_InvalidateRect( SystemProperty("AppHwnd") , null, True )<br><br>with user32.decls:<br>api_InvalidateRect% (hwnd%, lpRect*, bErase%) : "InvalidateRect"<br><br>:( <br><br></td></tr></table><br>
<a name="913560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> in your .decls you define lpRect* as a bank, use an int lpRect% <br><br></td></tr></table><br>
<a name="913569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> My Borland docs for InvalidateRect say:<br>lpRect:	LPRECT type. Points to a RECT data structure that contains the rectangle (in client coordinates) to be added to the update region. If the lpRect parameter is NULL, the entire client area is added to the region. <br><br>(Sorry about this Blitz people, bear with us while we ex-C people chunner on.) <br><br></td></tr></table><br>
<a name="913577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> We could pass lpRect as a bank, but it seems unnecessary unless your using the api_InvalidateRect() call else were in your code that requires a bank. using lpRect as an int will enable you to pass a NULL, it would be great if we had a little more control of how decls are defined. <br><br></td></tr></table><br>
<a name="913937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unfortunately it didn't have the result I was hoping for. it's unpredictable and too slow..<br>What still works better is doing a wb3d_StopEvents prior to creating/moving a lot of gadgets followed by wb3d_StartEvents(). That gives a quick and solid refresh, although you can still see some gadgets 'move'/snap into their designated place ..<br><br>D. <br><br></td></tr></table><br>
<a name="914055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> What gadgets types are not been rendered correctly, are you defining there style when creating them? can you tell more more danny.<br><br>Kev <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
