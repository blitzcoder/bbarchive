<!DOCTYPE html><html lang="en" ><head ><title >BlitzExtensions - Really Extending Blitz</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BlitzExtensions - Really Extending Blitz</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >BlitzExtensions - Really Extending Blitz</a><br><br>
<a name="1267959"></a>

<a name="1267960"></a>

<a name="1267961"></a>

<a name="1268190"></a>

<a name="1268269"></a>

<a name="1268413"></a>

<a name="1268415"></a>

<a name="1270347"></a>

<a name="1287037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>BlitzExtensions</b><br>BlitzExtensions is a collection of User Libraries for the Blitz language, allowing you to do many additional things previously locked away from you.<br><br>License: Lesser GPL v3 <br>Links: <a href="https://github.com/Xaymar/BlitzExtensions" target="_blank">Project Source</a><br><br><b>Library: BlitzPointer</b><br>BlitzPointer allows you to get the pointers of a Blitz function and use these to your advantage. Ever wanted to call a DLL function that requires a callback but didn't know C++? BlitzPointer can help you there, as Blitz functions are __stdcall-able!<br><br>License: Lesser GPL v3 <br>Links: <a href="https://github.com/Xaymar/BlitzPointer/releases" target="_blank">Binary Releases</a> | <a href="https://github.com/Xaymar/BlitzPointer" target="_blank">Library Source</a><br><br><b>Library: BlitzSteam</b><br>BlitzSteam brings the Steamworks API to the Blitz language or any other language unable to call __cdecl functions. Integrate your game with Steam by using the Workshop, HTMLSurface or Steam Networking - everything the Steamworks API offers is at your disposal.<br><br><u>In order to use or compile this library you need to be a registered Steamworks developer. Steamworks restrictions will still apply.</u><br><br>License: Lesser GPL v3 <br>Links: <a href="https://github.com/Xaymar/BlitzSteam/releases" target="_blank">Binary Releases</a> | <a href="https://github.com/Xaymar/BlitzSteam" target="_blank">Library Source</a><br><br><b>Library: BlitzUtility</b><br>BlitzUtility gives you access to many extra 'Utility' functionality: ObjectList, TypeList, SQLite3, LongLong, Double, DisplayEnumerator, Indexers, WindowMessageHandler. For exact descriptions of what each does, check out README.md in the library source.<br><br>License: Lesser GPL v3 <br>Links: <a href="https://github.com/Xaymar/BlitzUtility/releases" target="_blank">Binary Releases</a> | <a href="https://github.com/Xaymar/BlitzUtility" target="_blank">Library Source</a> <br><br></td></tr></table><br>
<a name="1268009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent work there :) <br><br></td></tr></table><br>
<a name="1268093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ploppy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, smart stuff. <br><br></td></tr></table><br>
<a name="1268123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Ploppy:<br>May I ask you something? I've figured out some things in Blitz (Variables, Functions, Types) but I can't wrap my head around strings. It just doesn't make sense to me, as Blitz functions recieve a pointer to a structure with a pointer to a cstring inside, or that's what I think it does. Is this actually what happens? <br><br></td></tr></table><br>
<a name="1268127"></a>

<a name="1268128"></a>

<a name="1268129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ploppy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> In c++, strings in Blitz3d are handled by the BBStr class, I think it is the same in B+.  Here is the class declaration in all it's beauty for example..<br><br><pre class=code>
struct BBStr : public std::string{
	BBStr *next,*prev;

	BBStr();
	BBStr( const char *s );
	BBStr( const char *s,int n );
	BBStr( const BBStr &amp;s );
	BBStr( const std::string &amp;s );
	BBStr &amp;operator=( const char *s );
	BBStr &amp;operator=( const BBStr &amp;s );
	BBStr &amp;operator=( const std::string &amp;s );
	~BBStr();

	void *operator new( size_t size );
	void operator delete( void *q );

	void *operator new( size_t size,const char *file,int line ){ return operator new( size ); }
	void operator delete( void *q,const char *file,int line ){ operator delete( q ); }
};
</pre><br><br>As you can see, the class is a derivative of the std::string class, the actual string itself can be retrieved with the class's c_str() function, and the string length by the length() function.<br><br>The internal workings of blitz process strings by passing pointers between functions.  However, for userlibs, the char * method is used to pass strings, conversion happens between 'char *' and 'BBStr *' before and after calling a userlib function if needed. <br><br></td></tr></table><br>
<a name="1268168"></a>

<a name="1268169"></a>

<a name="1268177"></a>

<a name="1268182"></a>

<a name="1268189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That means I have to temporarily create a BBStr object to pass the string to a blitz function, allowing even strings to be passed. Alright, thanks for clearing that up.<br><br>Edit 1: Or retrieve the one that contains the original.<br>Edit 2: On second thought, it might be better to just disable string return and passing until I found a proper way to handle it.<br>Edit 3: I'm surprised my solution even worked like it did.<br>Edit 4: I have no idea how to pass strings to a blitz function. It either crashes or ends up being empty (which is better than a crash though). <br><br></td></tr></table><br>
<a name="1268211"></a>

<a name="1268212"></a>

<a name="1268213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ploppy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You'll need a bit of c++ code to convert it, something like<br><br><pre class=code>
#include &lt;string&gt;
using namespace std;

string * ConvertToBBStr(char * input)
{
    string * output=new string(input);
    return output;
}
</pre><br><br>This code for example will convert a char * string to a std::string type.<br><br>To convert it back to char * try something like<br><br><pre class=code>
#include &lt;windows.h&gt;
#include &lt;string&gt;
using namespace std;

char * ConvertToChar(string * input)
{
    char * output= new char[input-&gt;length()];
    memcpy (output,input-&gt;c_str(),input-&gt;length());
    return output;
}
</pre> <br><br></td></tr></table><br>
<a name="1268253"></a>

<a name="1268255"></a>

<a name="1268260"></a>

<a name="1268262"></a>

<a name="1268264"></a>

<a name="1268265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Ploppy:<br><br>If only that worked, that was one of the first things I tried. Sibly's BBStr is simply too different to be cast to a std::string:<br><br><pre class=code>
        | 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
--------+------------------------------------------------
00000000| 65 00 00 00 ?? ?? ?? ?? 0B 00 00 00 1F 00 00 00
00000010| &lt;varying&gt;</pre><br>Offset 0 is always the same 0x65 (0x00000065), after that there's a int32_t/intptr_t to a c-style string and then we have the weird 0x0B and 0x1F. This can't be directly casted to a std::string.<br>If I substract 8 from the returned pointer, I can cast it to a std::string<strike>, though it seems to cause Blitz to go back a few instructions in memory and repeat it over and over</strike>. Edit: forgot to mention that the casted std::string is wrong.<br><br>Edit: Here's a better view of the memory around the returned pointer:<br><img src="http://i.imgur.com/kmOnVJY.png"><br>0x004BB5F0 is the returned pointer.<br><br>Edit: Upon further investigation, it seems that using BlitzPointer near the end of the program causes the repeat. Probably because I was using __cdecl instead of __stdcall by accident.<br>Edit 2: I'll just take out those functions until further notice. <br><br></td></tr></table><br>
<a name="1268270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I uploaded version 1.1 of the DLL just now, changelog<br><i>1.1 - 15/05/2015</i><br>- [New] Added and updated Examples<br>- [New] Added functions for Direct Memory Access (DMA)<br>- [Fix] Fixed memory leak when returning strings by removing the functions for now. (It was a bug anyway, should never have worked.)<br>- [Fix] Hopefully fixed the backwards instruction jump caused by using BlitzPointer by using __stdcall.<br><br>If I figure out how to properly do strings, I'll probably add additional functions to pass them as pointers with manual cleanup. <br><br></td></tr></table><br>
<a name="1268739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eNano</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br>I don't know much about coding so I post this just in case is useful<br>This is how I've got the content of a string field based on other posts, I understood that is read only data<br><br><pre class=code>
;Create the object
Type testType
	Field FirstField%
	Field SecondField$
End Type

testInstance.testType = New testType
testInstance\FirstField = 10
testInstance\SecondField = "FieldContent"


;Get the Type Pointer:
instancePTR = Int(testInstance)

;Get First Field Pointer: (just as an example)
firstFieldPTR = ( instancePTR + 20 )

;Get Second Field Pointer:
secondFieldPTR = ( instancePTR + 20 ) + 4

;Get Pointer from second Field Pointer:
stringPTR = MemoryPeekInt(secondFieldPTR)
;Get length of string:
stringLength = MemoryPeekInt( stringPTR + 8 )
;Get location of the characters:
CharsPTR = MemoryPeekInt(stringPTR + 4)

;Get each character:
For n = 0 To ( stringLength - 1 )
	theString$ = theString$ + Chr( MemoryPeekByte( CharsPTR + n  ) )
Next

Print theString
</pre><br>I hope this help <br><br></td></tr></table><br>
<a name="1270345"></a>

<a name="1270346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, some news. The pointers retrieved by BlitzPointer should be directly callable as __stdcall functions, requiring no intermediate functions. No guarantee that it works though, haven't been able to test it due to an odd bug (Blitz3D won't load DLLs from the /userlibs/ folder anymore).<br><br>Edit: __stdcall Test successful: <img src="http://i.imgur.com/zvLbU3c.png"> <br><br></td></tr></table><br>
<a name="1287038"></a>

<a name="1287039"></a>

<a name="1287070"></a>

<a name="1287071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzPointer just received a much needed update and is now at version 1.4.0, featuring Variable-pointers and a few fixes.<br><br><b>Changelog:</b><br>* Upgraded to Visual Studio 2015<br>* Fixed broken .Decls file (missing parameter).<br>* Implemented Variable-pointers (BP_GetVariablePointerInt, BP_GetVariablePointerFloat, BP_GetVariablePointerType)<br>* Fixed BP_GetReturnAddress returning the wrong address.<br>* Fixed BP_GetFunctionPointer being unstable by using a more intelligent design.<br>* Reduced overall usage of raw asm instruction to just reading the BasePointer.<br>* Added Example 8 - Variable-pointers.<br><br>Binaries &amp; Source Code: <a href="https://github.com/Xaymar/BlitzPointer/releases/tag/1.4.0" target="_blank">Here</a><br><br>Screenshot: <br><img src="http://i.imgur.com/Iu13VmK.png"> <br><br></td></tr></table><br>
<a name="1311590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PSY</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Xaymar<br><br>I just stumbled on your BlitzSteam Library.<br><br>Some time ago, I wrote a game in B3B and sold a handful of copies, winning a bet in the process. 2014, I uploaded it on Steam Greenlight, just to get some experience with the Steam system.<br>2 days ago, I received an eMail from Valve, saying the game has been greenlit.<br><br>Now I want to add some achievements to the game. <br>My knowledge of C is literally ZERO, but I understand I can implement achievements in a B3D project with your library?<br><br>That would be really awesome...<br><br>Thanks in advance,<br>PSY<br><br>P.S. I tried to contact you by your website, but it seems to be down/emtpy... <br><br></td></tr></table><br>
<a name="1311594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaymar</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> @PSY<br><br>Indeed, almost all Steam Interfaces are available to you. Achievements, Statistics, Leaderboards, Networking, etc. I've included some examples for the APIs I understand, the rest is almost pure native C wrapper.<br><br>You can reach me via michael.fabian.dirks@..., I'm currently moving servers. <br><br></td></tr></table><br>
<a name="1311689"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PSY</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Xaymar<br><br>Awesome, thanks alot.<br><br>I really appreciate that!! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
