<!DOCTYPE html><html lang="en" ><head ><title >JV-ODE Physics Thread 6</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >JV-ODE Physics Thread 6</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >JV-ODE Physics Thread 6</a><br><br>
<a name="625077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now available for <b>Blitz3D</b> &amp; <b>BlitzMax (Win32)</b><br><br>The JV-ODE Physics Wrapper is an advanced user library supporting almost all of the Open Dynamics Engine functions wrapped inside a DLL (Dynamic Link Library).<br><br>The library can be used with any programming language that supports DLL's, including Blitz3D and BlitzMax (Win32). The Euler rotation system in JV-ODE has been adapted to match the left-handed Euler rotation used in Blitz3D, however functions for accessing Quaternion and Axis Angle rotation systems are also included. The full versions contain all of the necessary files to get you started, including over 30 demos showing the various features found in ODE and a complete Function Reference document.<br><br>The BlitzMax (Win32) version also features a built-in 'bare-bones' OpenGL 3D engine module and B3D mesh loader module for demo purposes.<br><br>To view more information and screenshots <a href="http://jv-ode.devcode.co.uk/" target="_blank">click here</a>.<br><br>Options are now available to purchase the wrapper using either PayPal or Share*it.<br><br>The <b>Blitz3D</b> restricted demo version is now available for download <a href="http://jv-ode.devcode.co.uk/dload/JV-ODE-Demo-Blitz3D.zip" target="_blank">here</a> (169KB)<br><br>The <b>BlitzMax (Win32)</b> restricted demo version is now available for download <a href="http://jv-ode.devcode.co.uk/dload/JV-ODE-Demo-BlitzMax.zip" target="_blank">here</a> (238KB)<br><br>Have Fun :)<br><br>Previous JV-ODE Threads: <a href="/posts.php?topic=43653" target="_blank">1</a> <a href="/posts.php?topic=45048" target="_blank">2</a> <a href="/posts.php?topic=48743" target="_blank">3</a> <a href="/posts.php?topic=52572" target="_blank">4</a> <a href="/posts.php?topic=53490" target="_blank">5</a><br>JV-ODE <a href="http://playerfactory.proboards25.com/" target="_blank">Player Factory</a> Forum<br><br>Useful Links: <a href="http://www.ode.org/" target="_blank">ODE.org Website</a> - <a href="http://www.ode.org/ode-latest-userguide.pdf" target="_blank">ODE User Guide (PDF)</a> - <a href="http://www.ode.org/ode-latest-userguide.html" target="_blank">ODE User Guide (HTML)</a> - <a href="http://q12.org/pipermail/ode/" target="_blank">ODE Archives</a> <br><br></td></tr></table><br>
<a name="625112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> cannot seem to get collision with trimesh, sphere seems to be colliding with non existant tris. <br><br></td></tr></table><br>
<a name="625180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you post (or send me via email) the problematic code including the mesh, I'll take a look for you.<br><br>What mesh format are you converting into a TriMesh? <br><br></td></tr></table><br>
<a name="625192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> same prob happens with *.x and *.b3d, emailed ya <br><br></td></tr></table><br>
<a name="625205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for sending it :)<br><br>Ok, the mesh appears to be colliding correctly. I think you may be getting caught out by the mirror here, if a mesh is positioned lower than the mirror/plane, the part that's submerged appears as an inverted solid mesh above the plane level.<br><br>Try the following code with the 'CarDemo-TriMesh-Sphere.bb' demo and add your mesh to the media folder to see the mesh colliding correctly...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################

; ### CREATE TRIMESH

demomesh=LoadMesh("media\test.b3d")
ScaleMesh demomesh,1,0.3,1

trimesh=CreateTriMesh(Space,demomesh)
dGeomSetRotation(trimesh,0,0,0)
dGeomSetPosition(trimesh,0,30,0)

RotateEntity demomesh,0,0,0
PositionEntity demomesh,0,30,0

EntityColor demomesh,255,255,255
EntityAlpha demomesh,1

demotexture=LoadTexture("media\terrain.png")
ScaleTexture demotexture,0.08,0.08
EntityTexture demomesh,demotexture

; ###################################################################################################
</textarea> <br><br></td></tr></table><br>
<a name="625239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> thing is, there is no mirror in what im trying, its like there is some invisible plane blocking it (but there isnt in code) <br><br></td></tr></table><br>
<a name="625293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'm having to speculate as there wasn't any code in the archive you sent over, only two mesh files. I can't find any problems with those two meshes, the mirror was the only obvious cause that springs to mind.<br><br>Can you resend the meshes with the source code (or an example) so that I can see the exact problem?<br><br>Your TriMesh sounds like it isn't aligned with the visible mesh, but without seeing your TriMesh setup it's hard to say for sure what's causing the problem. <br><br></td></tr></table><br>
<a name="625421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> it seems to work if i dont scale the mesh down, (btw i thought i sent code) but it seems ok if i dont scale.. so i wont<br><br>edited: was using scaleentity instead of scale mesh on pieces i was cloneing, changed to scalemesh fixed it <br><br></td></tr></table><br>
<a name="625460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, you need to use ScaleMesh.<br><br>The CreateTriMesh() function uses the source mesh dimensions for its own scale, ScaleEntity doesn't change the actual mesh structure hence the mis-alignment. In your case the visible mesh would be scaled ok, but the TriMesh would be the same size as the original source mesh dimensions prior to re-sizing.<br><br>I didn't receive any code in the archive, only the two test meshes. I could've saved you some head-scratching if I saw your TriMesh setup code, oh well at least you've cracked it now :) <br><br></td></tr></table><br>
<a name="625502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>The ultimate RagDoll :-)<br><br><a href="http://www.planetdan.net/pics/misc/georgie.htm" target="_blank">http://www.planetdan.net/pics/misc/georgie.htm</a><br><br>Use the mouse <br><br></td></tr></table><br>
<a name="625549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> erm, cannot seem to return if a collision has happened on a geo, any ideas?<br><br>DebugLog dGeom1CountCollisions(MainPlayer\PhysEntity\Geom) <br><br></td></tr></table><br>
<a name="625587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok ZJP, now do that in blitz+ode ;)<br><br>btw: ^^<br>[a http://user.blue-cable.de/ojay/ups.JPG] sorry vip3r, you're damn right :D <br><br></td></tr></table><br>
<a name="625616"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice RagDoll considering it's made in Flash :)<br><br>OJay, can you either shrink or remove the image please, it's too damn ugly :P [edit] Thanks ;)<br><br><div class="quote"> <br>erm, cannot seem to return if a collision has happened on a geo, any ideas?<br><br>DebugLog dGeom1CountCollisions(MainPlayer\PhysEntity\Geom)<br> <br></div><br>Well, going on the incredibly detailed explanation of the problem, I can deduce that 'MainPlayer\PhysEntity\Geom' isn't a geom class or it doesn't exist :P<br><br>Does it give any error or return a constant zero?<br><br>Are you using single or multiple spaces?<br><br>Have you tried 'dGeom<b>2</b>CountCollisions(MainPlayer\PhysEntity\Geom)'?<br><br>Have you tried the 'CarDemo-DetailedC.bb' demo?<br><br>The more info you give, the better and faster the solution ;) <br><br></td></tr></table><br>
<a name="625811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can someone please provide an example of a slider joint? Something like a cube on an invisible bungey cord that drops under gravity but is pulled back by the slider joint.<br><br>According to the docs there's no dJointSetSliderAnchor() to position the joint, and I can't get the params to do what I thought they'd do. My slider works just like a rigid Fixed joint :( <br><br></td></tr></table><br>
<a name="625871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here you go Shifty...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #										JV-ODE - Slider Demo										#
; #									Code by Jim Williams (VIP3R)									#
; ###################################################################################################

AppTitle "JV-ODE - Slider Demo"

Include "JV-ODE.bb"

Graphics3D 800,600,0,2

Global SliderRange=30

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

Dim Sphere(10)
Dim Joint(10)

; ###################################################################################################

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.1)
dContactSetMu(48)

; ### Create Slider

For count=1 To 2
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Sphere(count)=ode\body
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,-30,100-(count*30),0)
	dBodySetAutoDisableFlag(ode\body,1)
	ode\geom=dCreateSphere(Space,4)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateSphere()
	ScaleMesh ode\mesh,4,4,4
	RotateMesh ode\mesh,0,0,0
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
	If count=1
		Joint(count)=dJointCreateBall(World,0)
		dJointAttach(Joint(count),0,Sphere(count))
		dJointSetBallAnchor(Joint(count),dBodyGetPositionX(Sphere(count)),dBodyGetPositionY(Sphere(count)),dBodyGetPositionZ(Sphere(count)))
		Else
		Joint(count)=dJointCreateSlider(World,0)
		dJointAttach(Joint(count),Sphere(count-1),Sphere(count))
		dJointSetSliderAxis(Joint(count),0,1,0)
		dJointSetSliderParam(Joint(count),dParamLoStop,-SliderRange)
		dJointSetSliderParam(Joint(count),dParamHiStop,SliderRange)
		End If
Next

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000
PositionEntity Camera,0,90,-100
RotateEntity Camera,30,0,0

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0

Mirror=CreateMirror()

; ###################################################################################################

While Not KeyHit(1)

	UpdateKeys()

	PTime=MilliSecs()

	If MilliSecs()-Timer&gt;700
		AddObject()
		Timer=MilliSecs()
		End If

	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 640,0,"Add Force To Slider"
	Text 640,15,"Using Arrow Keys"
	Text 640,55,"Add Motor Velocity"
	Text 640,70,"Using F1 &amp; F2"

	Text 0,80,"Slider Position: "+dJointGetSliderPosition(Joint(2))
	Text 0,95,"Slider Rate: "+dJointGetSliderPositionRate(Joint(2))

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function AddObject()

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,30,80,0)
dBodySetAutoDisableFlag(ode\body,1)
ode\geom=dCreateBox(Space,10,5,10)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,5,2.5,5
EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
EntityAlpha ode\mesh,1
EntityShininess ode\mesh,0.7

End Function

; ###################################################################################################

Function UpdateKeys()

dBodyEnable(Sphere(2))

If KeyDown(59)
	dJointSetSliderParam(Joint(2),dParamVel,-3)
	dJointSetSliderParam(Joint(2),dParamFMax,100)
	End If

If KeyDown(60)
	dJointSetSliderParam(Joint(2),dParamVel,3)
	dJointSetSliderParam(Joint(2),dParamFMax,100)
	End If

If dJointGetSliderPosition(Joint(2))=SliderRange Or dJointGetSliderPosition(Joint(2))=-SliderRange
	dJointSetSliderParam(Joint(2),dParamVel,0)
	dJointSetSliderParam(Joint(2),dParamFMax,100)
	End If

If KeyDown(203) Then dBodyAddForce(Sphere(2),-10,0,0)
If KeyDown(205) Then dBodyAddForce(Sphere(2),10,0,0)
If KeyDown(200) Then dBodyAddForce(Sphere(2),0,10,0)
If KeyDown(208) Then dBodyAddForce(Sphere(2),0,-10,0)

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	If dBodyIsEnabled(ode\body)
		RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
		PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
		End If
Next

End Function

; ###################################################################################################
</textarea><br>The demo shows how to setup the slider, it doesn't have any spring/dampening yet though.<br><br>There's no need to specify an anchor position for a slider, it actually has two anchors - anchor 1 is positioned at body 1, anchor 2 is positioned at body 2. <br><br></td></tr></table><br>
<a name="625928"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks. I was trying to attach the Slider to 'the world' with an object on the other end.  Adding bungy-bounce was easy enough (dParamBounce). Of course, now I have to think how to create this in my limited joint description system. It's not straightforward referencing a body in a linked-list ;) <br><br></td></tr></table><br>
<a name="625996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> any idea on the best frame limiting method? tried out shiftys stuff in another post but it doesnt really work all that well, erm someone must have a solution <br><br></td></tr></table><br>
<a name="626003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> The best method is to use a fixed frame speed (30-60 fps etc) for the physics and separate timing for the rendering.<br><br>Here's a 10 Pin Bowling demo for Jeff...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #									JV-ODE - 10 Pin Bowling Demo									#
; #									Code by Jim Williams (VIP3R)									#
; ###################################################################################################

AppTitle "JV-ODE - 10 Pin Bowling Demo"

Include "JV-ODE.bb"

Graphics3D 800,600,0,2

Global Ball

Global Aim=0
Global BallMass#=200

Dim PinBody(10)
Dim PinGeom(10)
Dim PinMesh(10)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.2)
dContactSetMu(48)

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000
PositionEntity Camera,0,20,-50
RotateEntity Camera,30,0,0

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0

Mirror=CreateMirror()

; ###################################################################################################

AddBall(0,4,-40)
AddPins()

While Not KeyHit(1)

	UpdateKeys()

	PTime=MilliSecs()

	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 640,0,"F1 - Add New Ball"
	Text 640,15,"Space - Push Ball"
	Text 640,30,"Arrows - Adjust Aim"
	Text 0,50,"Aim: "+Aim

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function AddBall(xp#,yp#,zp#)

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Ball=ode\body
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,xp,yp,zp)
dBodySetAutoDisableFlag(ode\body,1)
mass=dMassCreate()
dMassSetSphereTotal(mass,BallMass,2.4)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateSphere(Space,2.4)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateSphere()
ScaleMesh ode\mesh,2.4,2.4,2.4
EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
EntityAlpha ode\mesh,1
EntityShininess ode\mesh,0.7

End Function

; ###################################################################################################

Function AddPins()

xp#=0
yp#=6
zp#=70

padding=7

For count=1 To 10
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	PinBody(count)=ode\body
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,xp,yp,zp)
	dBodySetAutoDisableFlag(ode\body,1)
	ode\geom=dCreateCylinder(Space,1.4,10)
	PinGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	PinMesh(count)=ode\mesh
	ScaleMesh ode\mesh,1.4,5,1.4
	EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
	xp=xp+padding
	If count=1 Then xp=xp-((padding*1)+(padding*0.5)) : zp=zp+padding
	If count=3 Then xp=xp-((padding*2)+(padding*0.5)) : zp=zp+padding
	If count=6 Then xp=xp-((padding*3)+(padding*0.5)) : zp=zp+padding
Next

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyHit(59)=1
	AddBall(0,4,-40)
	End If

If KeyDown(203)=1
	Aim=Aim-1
	End If

If KeyDown(205)=1
	Aim=Aim+1
	End If

If KeyDown(57)=1
	dBodyEnable(Ball)
	dBodyAddForce(Ball,Aim*0.5,0,400)
	End If

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	If dBodyIsEnabled(ode\body)
		RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
		PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
		End If
Next

End Function

; ###################################################################################################
</textarea> <br><br></td></tr></table><br>
<a name="626055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> any idea on the best frame limiting method? tried out shiftys stuff in another post but it doesnt really work all that well, erm someone must have a solution <br></div>My code was actually about getting the same physics timing with different screen refresh rates. It doesn't help keep things smooth.<br><br>What's wrong with your system?<br><br>The only way to really get smooth, constant framerate is to ensure your rendering and updates are completed within the time of a frame. If you split rendering and physics timings, at some point they're going to be executed at the same program cycle and you'll need to render both. If the processing takes longer than a frame you're going to ruin the smoothness.<br><br>By my reckoning, if there's going to be occassions where physics and rendering are rendered simultaneously, to get that framerate smooth I need to keep physics+render &lt; frametime for those frames. And if I can manage physics+render &lt; frametime for those frames, I can amange it for all frames. Hence in my program I lock to the screen refresh and keep everything executing in 1 screen refresh period (about 16 ms at 60 Hz).<br><br>Things like frame tweening allow you to calculate only some frames and interpolate the rest at less overhead. I guess in theory it would be possible to render graphics on one frame, update physics the next tweening the graphics, giving more time for processing yet keeping a 60 fps update, though physics would be less accurate.<br><br>Otherwise, there's no real solution that I know of. I've yet to find a professional full-price game that doesn't have slowdowns and poor framerates at times! <br><br></td></tr></table><br>
<a name="626165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> The term 'frame limiting' would imply that there is enough processing time per frame for at least one pass of the physics, rendering and logic. Frame limiting is used to prevent the physics/render/logic updating too quickly on faster machines than the minimum requirements.<br><br>Let's assume we have our game loop frame time split as follows:<br><br>Logic: ~3 fps<br>Physics: ~7 fps<br>Rendering: ~50 fps<br><br>Total: ~60 fps (minimum design framerate)<br><br>Limiting the frame speed to 60 fps will work fine here on all machines except those which cannot reach the minimum design speed of 60 fps, then we get the poor frame rates.<br><br>The only time you will benefit from separate timing is if you have redundant processing time available during each frame update. If a machine has a refresh rate of 85Hz in the above situation, we will have 25 fps free per frame to update the rendering or process more logic. But not the physics, which -must- run at an identical frame rate on both the 85Hz machine and the 60Hz machine for the simulation to remain accurate and consistent on both machines.<br><br>If you need the physics to run faster or with increased accuracy, you will have to sacrifice render/logic frame time, like so...<br><br>Logic: ~3 fps<br>Physics: ~7 fps (two passes at 7 fps or one at 14 fps)<br>Physics: ~7 fps<br>Rendering: ~43 fps (minus 7 fps)<br><br>Total: ~60 fps (minimum design framerate)<br><br>You can't process the physics during any spare frame time available on faster machines, because it simply defies the minimum requirements of the design. It would mean the physics will never run at full speed on the 60Hz machines.<br><br>In a nutshell, the physics MUST run at a constant frame rate, regardless of render/logic timing and free processor time during a frame. But most importantly, the physics MUST be able to run at full speed (whatever it is) at the minimum design framerate. <br><br></td></tr></table><br>
<a name="626203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jeffmorris</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that dBodyDestroy command doesn't remove objects from the world. How do I remove objects from the world? The ball and the pins that were knocked down should be removed before the next roll of the ball and all pins should be removed and 10 new pins set up before the next frame of the game. In Frame 10, you get three rolls of ball if you get a spare or a strike. <br><br></td></tr></table><br>
<a name="626263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You can't process the physics during any spare frame time available on faster machines, because it simply defies the minimum requirements of the design. It would mean the physics will never run at full speed on the 60Hz machines.<br><br>In a nutshell, the physics MUST run at a constant frame rate, regardless of render/logic timing and free processor time during a frame. But most importantly, the physics MUST be able to run at full speed (whatever it is) at the minimum design framerate. <br></div><br>Which is where my physics timing method works, where the game is 'frame-limited' to the refresh rate. I guess I'm not really understanding what {cYanide} wants. If he's not capped to VWait : Flip, he ought to be to frame limit and keep things smooth and at a constant speed. If he is capped to frame rate and not processing quickly enough every frame so some frames overrun the wait and you get jitters, the only fix I know of is to reduce processing requirements, or cap to a sub frame-rate at say half the screen refresh rate.<br><br>What other options are there? What's the problem {cYanide}'s having? <br><br></td></tr></table><br>
<a name="626315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> i ended up just forcing the physics to run at a certain "fps", works fine,<br><br>erm one more Q, ive noticed that when 2 or more trimeshes are overlapping the physics time goes rather high, im not really sure this is, as i wouldnt expect trimeshes to be tested against eachother... if thats even whats happening.<br><br>is there a way to stop this as currently i have to position my map pieces with a lil gap (visible) so it wont inc the phys time like mad <br><br></td></tr></table><br>
<a name="626317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Assuming for trimeshes you mean static scenery, drop them into a subspace and disable internal collisions for that.<br><br>ODE_world=dWorldCreate()<br>ODE_space=dHashSpaceCreate(0)<br>ODE_scenery_space=dHashSpaceCreate(ODE_space)<br>dSetInternalSpaceCollideMode(0)<br><br>And create your trimeshes in ODE_scenery_space instead of ODE_space. Create your moving objects in ODE_space so they collide with each other. <br><br></td></tr></table><br>
<a name="626327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >boomboommax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> that did it;) <br><br></td></tr></table><br>
<a name="626387"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I think that dBodyDestroy command doesn't remove objects from the world. How do I remove objects from the world? The ball and the pins that were knocked down should be removed before the next roll of the ball and all pins should be removed and 10 new pins set up before the next frame of the game. In Frame 10, you get three rolls of ball if you get a spare or a strike.<br> <br></div><br>You don't need to destroy them, you can re-use them by resetting their position and rotation. When you destroy an ODE body or geom, you must also delete the ODEGeom type objects associated with them (ode\body, ode\geom etc). Btw, where did you learn your manners? because you need a refresher course.<br><br><div class="quote"> <br>the only fix I know of is to reduce processing requirements, or cap to a sub frame-rate at say half the screen refresh rate.<br> <br></div><br>Exactly right, the code either needs streamlining or you have to settle for a lower design frame rate. Your alternative timing method is one of the best I've seen so far, but the simulation would suffer from inconsistency across different frame rates ;) <br><br></td></tr></table><br>
<a name="626691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I see what you're getting out, having experienced a frusting couple of days. With my ODE scaling system, ODE progresses at the same rate on different refreshes, but my custom force functions applied every frame were of course running at different speeds between systems. I've just implemented a straightforward tweening system and it works very well, with the same smooth framerate as I was getting before, yet with physics locked to 50 Hz regardless of system, (50 Hz is every 20 ms, which can be measured properly unlike 60 Hz's 16.666667 ms and won't exceed one update per frame)<br><br>I'll write a proper explanation later in the Tweening thread. <br><br></td></tr></table><br>
<a name="627847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jake L.</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've ran against a wall with my current project and hopefully one of you can point me the right direction. I need no ready solution, just some ideas how to do it.<br><br>Here's the scenario:<br><br>Plastic coins (Cylinders,2x1) dropping into a 'slimy'/high viscosity fluid(Plane). The coins should penetrate the fluid/swim in it. If two coins collide (one dropping onto another), they should slip off each other (better: the bottom coin should dive a bit into the fluid and then evade to the side while the upper coin slips into the fluid).<br><br>I experimented a lot with Soft-ERP/CFM, but no matter what I do, either the coins do sink or bounce off with high speed. <br><br>Any ideas what contactmodes are best for the coins/plane ?<br><br>Thanks in advance<br>Jake <br><br></td></tr></table><br>
<a name="627875"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried using a box for the slime instead of a plane? The plane might be too 'thin'.<br><br>It might also be due to incorrect mass/density of the coins/slime.<br><br>Another thing that could cause problems is the ODE dCylinder geom, when two cylinders are dropped directly on top of each other (end on end, like a stack of coins) it can create faulty contacts causing them to fly off at high speed. The dCylinder isn't part of the original ODE library (like dCCylinder), so its reliability is suspect. <br><br></td></tr></table><br>
<a name="627923"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> CFM probably isn't ideal as there's a limit on penetration. You'd probably be better off writing your own force routine where if object is in fluid, apply force upwards greater than gravity. <br><br></td></tr></table><br>
<a name="628372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jake L.</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> This dCylinder problem is exactly what happens. I'll give CCylinder a try, though this will make collisions appear inaccurate. Maybe I could stick to dCylinder and try to limit this "Fly off" manually. <br><br>If I manage to get this stable I will let you know and post an example. This could take a week or two due spare time to code.<br><br>Jake <br><br></td></tr></table><br>
<a name="628379"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> CCylinders won't work for coins becausae they have spherical ends. A CCylinder is a Pill shape.<br><br>If you have to use a coin shape (you can't get away with using thin boxes) your best solution is to use several box geometries each rotated slightly, creating a multi-pronged star (still with a cylinder mesh), or more difficult to calculate placing them around the edge with one in the centre for a 16 edge polygon<br><br>Cylinders aren't well supported in ODE. <br><br></td></tr></table><br>
<a name="628568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Shifty is quite right, the capped cylinder isn't really suitable for coins due to the semi-sphere caps.<br><br>Another solution is to add a box geom transform to the cylinder geom. You need to make the box slightly larger in height so that the cylinder 'ends' are covered by the box geom and thus won't generate any faulty contacts. The rim of the cylinder will still generate normal contacts. The box corners can remain within the cylinder rim, there's no need to make it cover the entire cylinder end.<br><br>Let me know if you need any more help trying the above solution, I can knock you up a simple demo to show this in no time ;) <br><br></td></tr></table><br>
<a name="629670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>JV-ODE V1.12 Update Released</b><br><br>Please check your inbox :)<br><br>The new update fixes the dSpaceDestroy() MAV issue reported <a href="/posts.php?topic=56336" target="_blank">here</a><br><br>Please let me know if you experience any problems with the new update. <br><br></td></tr></table><br>
<a name="629727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks VIP3R,<br><br>Appreciate your efforts once more.<br>Keep up the good work!<br><br>cheers,<br><br>Mark <br><br></td></tr></table><br>
<a name="629812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> cool.<br>cool.<br>cool.<br><br>D <br><br></td></tr></table><br>
<a name="629873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Received. Good job.<br><br>Thanks<br><br>JP <br><br></td></tr></table><br>
<a name="630079"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all, you're welcome :) <br><br></td></tr></table><br>
<a name="631264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R,<br><br>JV/ODE can load tri-meshes with a mesh, but I'd like to see example of it loading specified layer of and AnimMesh.<br><br>Be nice to see this included with JV/ODE to give users little more flexibility in dealing with meshes and terrains.<br><br>I do have some code laying around to do this so it's not too difficult, just a piece I'd like to see added.<br><br>Please consider adding this feature.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="631303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Wayne,<br><br>I'll certainly take a look at it :)<br><br>Can you send me the code you mention and the necessary media for testing? <br><br></td></tr></table><br>
<a name="631425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Will get it together and send it. <br><br></td></tr></table><br>
<a name="631508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here it is my code to create full trimesh from animmesh. It should be easy to choose what meshes to export and what not:<br><br><pre class=code>
;-------------------------------------------------;
Function KODE_dTriMeshCreateRecursive%(space,mesh%)
; USE THIS IF USING LOADANIMMESH
;-------------------------------------------------;
	tris_count% = 0
	vert_count% = 0

	RecursiveCount(mesh)

	vertices_bank% = CreateBank(vert_count * 4 * 4)
	indices_bank% = CreateBank(tris_count * 3 * 4)

	offset% = 0
	offset_tris% = 0
	baseverts=0
	
	RecursiveAdd(mesh)
	
	t_data = KODE_dGeomTriMeshDataCreate()
	KODE_dGeomTriMeshDataBuildSimple(t_data, vertices_bank, vert_count, indices_bank, tris_count * 3)

	Return KODE_dCreateTriMesh(space, t_data)
End Function

;-----------------------------;
Function RecursiveCount(mesh%)
; Add to the Global Values the Vertex and Tris Count
;-----------------------------;
children = CountChildren(mesh)

If (children = 0)
	For k = 1 To CountSurfaces(mesh)
		tris_count = tris_count + CountTriangles(GetSurface(mesh, k))
		vert_count = vert_count + CountVertices(GetSurface(mesh, k))
	Next
Else
	For k = 1 To Children
		RecursiveCount(GetChild(mesh,k))
	Next
EndIf

End Function

Function RecursiveAdd(mesh%)

children = CountChildren(mesh)

If (children = 0)	
	For i = 1 To CountSurfaces(mesh)
		sf = GetSurface(mesh, i)
		For v = 0 To CountVertices(sf) - 1	
			v1x# = VertexX(sf,v)
			v1y# = VertexY(sf,v)
			v1z# = VertexZ(sf,v)			
			TFormPoint v1x,v1y,v1z,mesh,0
			
			PokeFloat vertices_bank, offset, TFormedX()
			offset = offset + 4
			PokeFloat vertices_bank, offset, TFormedY()
			offset = offset + 4
			PokeFloat vertices_bank, offset, TFormedZ()
			offset = offset + 8
		Next
		For t = 0 To CountTriangles(sf) - 1
			For j = 0 To 2
				v = TriangleVertex(sf, t, j)+baseverts
				PokeInt indices_bank, offset_tris, v
				offset_tris = offset_tris + 4
			Next
		Next
		baseverts=baseverts+CountVertices(sf)
	Next
Else
	For k = 1 To Children
		RecursiveAdd(GetChild(mesh,k))
	Next
EndIf

End Function
</pre><br><br>Cheers, KuRiX <br><br></td></tr></table><br>
<a name="631633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the code Kuri, it MAVs for me though on the following line...<br><br><i>For k = 1 To CountSurfaces(mesh)</i><br><br>...any idea why?<br><br><br>Here's a See-Saw Ramp demo requested by {Devious}...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #										  JV-ODE Car Demo											#
; #									Code by Jim Williams (VIP3R)									#		#
; #						Feel free to use this code, any credit appreciated							#
; ###################################################################################################

AppTitle "JV-ODE Car Demo - See-Saw"

Include "JV-ODE.bb"

Graphics3D 800,600,0,2

Global CMass#=200			; ### Car Mass
Global WMass#=14			; ### Wheel Mass
Global RampMass#=100		; ### Ramp Mass

Global WorldERP#=1			; ### World Error Correction
Global WorldFriction#=70	; ### World Friction

Global Torque#=24			; ### Joint Torque
Global SuspensionHS#=0.01	; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0
Global Steer#=0

Global Car
Global CGeom
Global CMesh

Global CarStartY=20

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactSlip1)
dContactSetMu(WorldFriction)

; ### Create car body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,0,CarStartY,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dMassTranslate(mass,0,-1,0)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0
EntityColor ode\mesh,40,80,255
EntityAlpha ode\mesh,1

; ### Create wheels

For count=1 To 4
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Wheel(count)=ode\body
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,0,0,0)
	mass=dMassCreate()
	dMassSetSphereTotal(mass,WMass,0.7)
	dBodySetMass(ode\body,mass)
	dMassDestroy(mass)
	ode\geom=dCreateSphere(Space,0.7)
	WGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	ScaleMesh ode\mesh,0.7,0.25,0.7
	RotateMesh ode\mesh,0,0,90
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create some objects

SeedRnd MilliSecs()

For spheres=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,Rnd(-100,100),30,Rnd(-100,100))
	ode\geom=dCreateSphere(Space,4)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateSphere()
	ScaleMesh ode\mesh,4,4,4
	RotateMesh ode\mesh,0,0,0
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
Next

For cylinders=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,90,0,0)
	dBodySetPosition(ode\body,Rnd(-100,100),30,Rnd(-100,100))
	ode\geom=dCreateCCylinder(Space,1,8)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	ScaleMesh ode\mesh,1,5,1
	RotateMesh ode\mesh,90,0,0	; &lt;&lt;&lt; Mesh X-Axis must be rotated 90 degrees to fix cylinder alignment
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
Next

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global CameraPivot=CreatePivot(CMesh)
PositionEntity CameraPivot,0,2,-7

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0

Mirror=CreateMirror()

; ###################################################################################################

; ### BLITZ STATIC OBJECT (White)

blitzobject=CreateCube()
ScaleMesh blitzobject,1,4,20
RotateMesh blitzobject,-10,8,4
PositionMesh blitzobject,10,5,40

EntityColor blitzobject,255,255,255
EntityAlpha blitzobject,1

; ### ODE STATIC OBJECT (Blue)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,2,8,40)
dGeomSetRotation(ode\geom,-10,8,4)
dGeomSetPosition(ode\geom,20,5,40)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,1,4,20
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,0,100,200
EntityAlpha ode\mesh,1

; ###################################################################################################

; ### Ramp (Red)

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
RampBody=ode\body
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,-20,5,40)
mass=dMassCreate()
dMassSetBoxTotal(mass,RampMass,18,0.2,40)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,18,0.2,40)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,0.1,20
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,200,0,100
EntityAlpha ode\mesh,1

; ### Ramp Base (Purple)

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
BaseBody=ode\body
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,-20,2.5,40)
mass=dMassCreate()
dMassSetBoxTotal(mass,RampMass,18,5,0.5)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,18,5,0.5)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,2.5,0.25
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,200,0,200
EntityAlpha ode\mesh,1

; ### Ramp Joints

StaticJoint=dJointCreateFixed(World,0)	; ### Fix base to ODE world
dJointAttach(StaticJoint,0,BaseBody)
dJointSetFixed(StaticJoint)

HJoint=dJointCreateHinge(World,0)
dJointAttach(HJoint,RampBody,BaseBody)
dJointSetHingeAxis(HJoint,1,0,0)
dJointSetHingeAnchor(HJoint,-20,5,40)
dJointSetHingeParam(HJoint,dParamLoStop,-0.4)
dJointSetHingeParam(HJoint,dParamHiStop,0.4)

; ### Roll ramp

dJointSetHingeParam(HJoint,dParamVel,-1)
dJointSetHingeParam(HJoint,dParamFMax,10)

; ###################################################################################################

SetupCar()

While Not KeyHit(1)

	UpdateKeys()

	PTime=MilliSecs()

	UpdateCar()

	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateCam()

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 0,50,"Force:"+Force
	Text 0,65,"Torque:"+Torque
	Text 640,0,"A - Accelerate"
	Text 640,15,"Z - Brake/Reverse"
	Text 640,30,"Arrows - Steering"
	Text 640,45,"Space - Reset Car"

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function SetupCar()

For count=1 To 4
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
	If count&gt;2
		dJointSetHinge2Param(Joint(count),dParamLoStop,0)
		dJointSetHinge2Param(Joint(count),dParamHiStop,0)
		End If
Next

Force=0

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyDown(30)=1
	Force=Force+0.08
	If Force&gt;30 Then Force=30
	End If

If KeyDown(44)=1
	Force=Force-0.1
	If Force&lt;-10 Then Force=-10
	If Force&gt;0 Then Force=Force*0.97
	End If

If KeyDown(30)=0 And KeyDown(44)=0 Then Force=Force*0.99

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=0.5
		Else
		Steer=-0.5
		End If
	Else
	Steer=0
	End If

If KeyHit(57)=1
	Force=0
	dBodySetRotation(Car,dGeomGetPitch#(CGeom),dGeomGetYaw#(CGeom),0)
	End If

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 4
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

End Function

; ###################################################################################################

Function UpdateCam()

PositionEntity CameraPivot,0,3,-12

camx#=EntityX(CameraPivot,1)-EntityX(Camera)
camy#=EntityY(CameraPivot,1)-EntityY(Camera)
camz#=EntityZ(CameraPivot,1)-EntityZ(Camera)

TranslateEntity Camera,camx*0.5,camy*0.5,camz*0.5

PointEntity Camera,CMesh

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
	PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
Next

End Function

; ###################################################################################################
</textarea> <br><br></td></tr></table><br>
<a name="631800"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Testing some slightly modified VIP3R code to load the full animesh, and will send ASAP, things just taking longer today. <br><br></td></tr></table><br>
<a name="631819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> No problem Wayne ;)<br><br>I've not had much experience with animated meshes tbh, how is each frame stored? Is each frame a set of children meshes to the parent mesh?<br><br>That's what Kuri seems to be doing above, cycling to the last child mesh and creating the TriMesh from that, is this right? <br><br></td></tr></table><br>
<a name="631873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is untested:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################

Function CreateAnimTriMesh(trispace,mesh)

tricount=0
vertcount=0
For child=1 To CountChildren(mesh)
	For count=1 To CountSurfaces(GetChild(mesh,child))
		tricount=tricount+CountTriangles(GetSurface(GetChild(mesh,child),count))
		vertcount=vertcount+CountVertices(GetSurface(GetChild(mesh,child),count))
	Next
Next

tribank=CreateBank(tricount*3*4)
vertbank=CreateBank(vertcount*4*4)

offset=0
trioffset=0
vertoffset=0

For child=1 To CountChildren(mesh)
	For count=1 To CountSurfaces(GetChild(mesh,child))
		surface=GetSurface(GetChild(mesh,child),count)
		For vert=0 To CountVertices(surface)-1
			PokeFloat(vertbank,offset,VertexX(surface,vert)+EntityX(GetChild(mesh,child),1))
			offset=offset+4
			PokeFloat(vertbank,offset,VertexY(surface,vert)+EntityY(GetChild(mesh,child),1)))
			offset=offset+4
			PokeFloat(vertbank,offset,VertexZ(surface,vert)+EntityZ(GetChild(mesh,child),1)))
			offset=offset+8
		Next
		For tri=0 To CountTriangles(surface)-1
			For corner=0 To 2
				PokeInt(tribank,trioffset,TriangleVertex(surface,tri,corner)+vertoffset)
				trioffset=trioffset+4
			Next
		Next
		vertoffset=vertoffset+CountVertices(surface)
	Next

trimeshdata=dGeomTriMeshDataCreate()

dGeomTriMeshDataBuildSimple(trimeshdata,vertbank,vertcount,tribank,tricount*3)

Return dCreateTriMesh(trispace,trimeshdata)

End Function
</textarea> <br><br></td></tr></table><br>
<a name="631970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Viper, be sure to load the mesh with loadanimmesh before calling the function<br><br>dtrimeshcreaterecursive()<br><br>That is the only function you should call, the others are helpers to that one.<br><br>Tell me if it works for you! <br><br></td></tr></table><br>
<a name="632105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, it's loaded with loadanimmesh ;)<br><br>The function Wayne posted MAVs for me too, it's the Zombie mesh I'm testing it with that's the cause of the MAV by the looks of it. I'm sure I had problems finding children in that mesh before.<br><br>Have you got any animated meshes I could try Wayne? I don't have any meshes here that would be suitable. <br><br></td></tr></table><br>
<a name="632143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I do, T.ED the terrain editor can create animeshes, I'll whipe up a small one right now. <br><br></td></tr></table><br>
<a name="632183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> This code appeared to work prefect for me.<br>All that was required was a few small additions to Vip3r code.<br><br>I'll post a link to the animmesh right after I try loading just one layer.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function CreateAnimTriMesh(trispace,mesh)

tricount=0
vertcount=0
For child=1 To CountChildren(mesh)
	For count=1 To CountSurfaces(GetChild(mesh,child))
		tricount=tricount+CountTriangles(GetSurface(GetChild(mesh,child),count))
		vertcount=vertcount+CountVertices(GetSurface(GetChild(mesh,child),count))
	Next
Next

tribank=CreateBank(tricount*3*4)
vertbank=CreateBank(vertcount*4*4)

offset=0
trioffset=0
vertoffset=0

For child=1 To CountChildren(mesh)
	For count=1 To CountSurfaces(GetChild(mesh,child))
		surface=GetSurface(GetChild(mesh,child),count)
		For vert=0 To CountVertices(surface)-1
			PokeFloat(vertbank,offset,VertexX(surface,vert))
			offset=offset+4
			PokeFloat(vertbank,offset,VertexY(surface,vert))
			offset=offset+4
			PokeFloat(vertbank,offset,VertexZ(surface,vert))
			offset=offset+8
		Next
		For tri=0 To CountTriangles(surface)-1
			For corner=0 To 2
				PokeInt(tribank,trioffset,TriangleVertex(surface,tri,corner)+vertoffset)
				trioffset=trioffset+4
			Next
		Next
		vertoffset=vertoffset+CountVertices(surface)
	Next
Next

trimeshdata=dGeomTriMeshDataCreate()

dGeomTriMeshDataBuildSimple(trimeshdata,vertbank,vertcount,tribank,tricount*3)

Return dCreateTriMesh(trispace,trimeshdata)

End Function
</textarea> <br><br></td></tr></table><br>
<a name="632186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> This function will load single layer (child)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function CreateAnimLayerTriMesh(trispace,mesh,child)

tricount=0
vertcount=0

For count=1 To CountSurfaces(GetChild(mesh,child))
	tricount=tricount+CountTriangles(GetSurface(GetChild(mesh,child),count))
	vertcount=vertcount+CountVertices(GetSurface(GetChild(mesh,child),count))
Next


tribank=CreateBank(tricount*3*4)
vertbank=CreateBank(vertcount*4*4)

offset=0
trioffset=0
vertoffset=0


For count=1 To CountSurfaces(GetChild(mesh,child))
	surface=GetSurface(GetChild(mesh,child),count)
	For vert=0 To CountVertices(surface)-1
		PokeFloat(vertbank,offset,VertexX(surface,vert))
		offset=offset+4
		PokeFloat(vertbank,offset,VertexY(surface,vert))
		offset=offset+4
		PokeFloat(vertbank,offset,VertexZ(surface,vert))
		offset=offset+8
	Next
	For tri=0 To CountTriangles(surface)-1
		For corner=0 To 2
			PokeInt(tribank,trioffset,TriangleVertex(surface,tri,corner)+vertoffset)
			trioffset=trioffset+4
		Next
	Next
	vertoffset=vertoffset+CountVertices(surface)
Next


trimeshdata=dGeomTriMeshDataCreate()

dGeomTriMeshDataBuildSimple(trimeshdata,vertbank,vertcount,tribank,tricount*3)

Return dCreateTriMesh(trispace,trimeshdata)

End Function
</textarea> <br><br></td></tr></table><br>
<a name="632195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Terrain Editor (T.ED) created the B3d AnimMesh with each layer being a surface. Example: Dirt, grass, rock.. and the last layer representing the entire terrain. By using the animmesh world builders can process the layers separately and add trees, rocks.. sample code fragment:<br><br>; Load animMesh<br>mesh=LoadAnimMesh("AnimTer.b3d")<br>; Load Last child layer (full terrain) into ODE Trimesh trispace<br>tmesh=CreateAnimLayerTriMesh(trispace,mesh,CountChildren(mesh)) <br><br></td></tr></table><br>
<a name="632209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent work Wayne! :)<br><br>I'll take a good look at it later, are you happy for me to add your new function to the JV-ODE Wrapper? <br><br></td></tr></table><br>
<a name="632214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are two functions to use and distribute as you wish.<br><br>I do have application that tests the two functions, it's a little large but I'd like to send it to you. <br><br>Be my guest to make any changes and apply the Vip3r touch.<br>If you'd like to see the app let me know what email you'd like it sent to.<br><br>8) <br><br></td></tr></table><br>
<a name="632530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Wayne, I really appreciate your efforts :)<br><br>I've had a good few hours experimenting with the animated mesh terrain, I think we could get away with the second function alone as it can be made recursive to create a TriMesh for each layer if need be. Also, I've noticed part of the code doesn't appear to do anything on your terrain mesh...<br><br><i>+EntityX/Y/Z(GetChild(mesh,child),1)</i>?<br><br>The child positions are the same as the parent in the terrain mesh, so these functions always return a zero. Are they needed?<br><br>Can the terrain and texture media you've posted above be used in a JV-ODE demo and included with the wrapper? <br><br></td></tr></table><br>
<a name="632560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Remove the stuff that always returns zero.<br><br>I replaced the texture set with free ones.<br>I reapplied the textures to the original anim.<br><br>Here is media and b3d for inclusion into JV/ODE:<br><a href="http://www.bz911.com/postnuke/index.php?name=PNphpBB2&amp;file=download&amp;id=67" target="_blank">http://www.bz911.com/postnuke/index.php?name=PNphpBB2&amp;file=download&amp;id=67</a><br><br>Screen shot showing animmesh terrain with new textures.<br>(trees, grass not in this demo, next one)<br><br>8)<br><br><img src="http://www.bz911.com/postnuke/modules/PNphpBB2/files/animland.jpg"> <br><br></td></tr></table><br>
<a name="632603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks great Wayne :)<br><br>Yikes! how big are those textures :O<br><br>I need to keep the download size as low as possible, can you trim a few KBs off and re-size them to 512x512 or 256x256?<br><br>The new CreateAnimTriMesh(trispace,mesh,layer) function will be added to the next JV-ODE update, thanks again for your help Kuri/Wayne ;) <br><br></td></tr></table><br>
<a name="632672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's the low fat version:<br><a href="http://www.bz911.com/postnuke/index.php?name=PNphpBB2&amp;file=download&amp;id=69" target="_blank">http://www.bz911.com/postnuke/index.php?name=PNphpBB2&amp;file=download&amp;id=69</a> <br><br></td></tr></table><br>
<a name="632810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Manipulating  and positioning ODE bodies<br> <br>I believe it would be most helpfull to have the following B3D functions to manipulate ODE bodies. The functions would operate on the specified ODE body as if it were a pivot. The functions would also act on the attached joints and attached bodies to perform the operation. Inaddition the linear and anglular velocities would be set to zero by default.<br><br>Summary allow simple non physics like functions to quickly setup and position simple and complex ode objects.<br><br>MoveBody<br>PositionBody<br>RotateBody<br>ScaleBody<br>TranslateBody<br>TurnBody<br><br>Does this seem usefull to you guys? <br><br></td></tr></table><br>
<a name="633029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the updated 'low fat' terrain files Wayne, I'll add them to the new AnimTriMesh demo for the next JV-ODE update ;) <br><br></td></tr></table><br>
<a name="633590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, it's official...<br><br><b>JV-ODE is now working in BlitzMax (Win32)</b><br><br>TriMeshes are supported but not yet implemented in demo form, the demos will use bare-bones OpenGL routines for the 3D graphics. As there are many options for 3D graphics engines in BlitzMax, it might be best to build-in the basic graphics for demo purposes for the time being. Once some of the engines have matured, dedicated demos for each engine will be looked at.<br><br>Coming soon...<br><br>:) <br><br></td></tr></table><br>
<a name="633724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Outstanding VIP3R<br><br>I'll buy BlitzMax if you're going to get JV/ODE working and some barebones OpenGL for the demos.<br><br>Will this be a new product ?<br>What is the expected MSRP ? <br><br></td></tr></table><br>
<a name="633764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, the new BlitzMax functionality and demos will be included in the Blitz3D version of JV-ODE.<br><br>I'm not planning to make additional charges for it at the moment.<br><br>Any donations would be most welcome and extremely helpful though ;) <br><br></td></tr></table><br>
<a name="633788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd certainly consider paying again for MAX support, though the chances of me using MAX are none until it gets  aproper, simple 3D method like BlitzBasic. That's what made Blitz so good and without that, MAX sounds like just another language (unless you're doing 2D). <br><br></td></tr></table><br>
<a name="634549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> It would be worth paying for again! <br><br>If you've got it working in Max, this is pretty much perfect timing for me, well done man! <br><br></td></tr></table><br>
<a name="636180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>BlitzMax JV-ODE Preview Now Available</b><br><br>Please visit the following blitzmax.com showcase link for more information, to download the demos or post any feedback or questions...<br> <br><a href="http://www.blitzmax.com/Community/posts.php?topic=57233" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=57233</a><br><br>Thanks :) <br><br></td></tr></table><br>
<a name="638853"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Update:<br><br>The BlitzMax version is almost ready for release. All of the Blitz3D demos are now in and working, including fully working TriMesh demos! The only exception is the Zombie demo, the built-in 3D engine can't do animated meshes at the moment.<br><br>The BlitzMax version will include:<br><br>All Blitz3D demos converted to run in BlitzMax (except Zombie demo)<br>Built-in bare-bones 3D OpenGL engine (for demo purposes only)<br>Built-in B3D Mesh Loader<br><br>More soon...<br><br>:) <br><br></td></tr></table><br>
<a name="638909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Boiled Sweets</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R,<br><br>I am interested in purchasing this.  I have some questions...<br><br>1.  Is there a manual I could download prior to purchase?<br><br>2.  Can I use the examples as basis for my application?<br><br>3.  Are updates free?<br><br>4.  Also in the sphere demo the balls keep on moving.  Is there a way to get them to act under friction, i.e. slow down and stop? <br><br></td></tr></table><br>
<a name="639034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1. There's an online user manual for ODE <a href="http://www.ode.org/ode-latest-userguide.html" target="_blank">here</a>. The full version of JV-ODE comes with a Function Reference which covers every JV-ODE/ODE function, it's not a user manual though.<br><br>2. Yes, provided you don't break any of the license conditions.<br><br>3. Yes<br><br>4. Yes, Shifty Geezer did some nice work in this field. Check the previous JV-ODE threads for more info and code.<br><br>:) <br><br></td></tr></table><br>
<a name="639063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Boiled Sweets</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> 4.  Could you be a bit more specific there is a lot of posts here :-( <br><br></td></tr></table><br>
<a name="639098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes there is indeed a lot of posts, which is why I wasn't more specific.<br><br>Check Thread 4 about 1/2 way down.<br><br>Thank the lord for Google. <br><br></td></tr></table><br>
<a name="639136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whats next.. JV/3D ?<br><br>8) <br><br></td></tr></table><br>
<a name="642957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>JV-ODE V1.14 Update Released</b><br><br>Please check your inbox :)<br><br>Added new rotation functions:<br><i><br>dBodySetAxisAngle(body,angle#,rx#,ry#,rz#)<br>dBodyGetAxisAngle(body)<br>dGeomSetAxisAngle(geom,angle#,rx#,ry#,rz#)<br>dGeomGetAxisAngle(geom)<br></i><br>Added CreateAnimTriMesh(trispace,mesh,layer) function<br><br>Added CarDemo-AnimTriMesh demo<br><br>Please let me know if you experience any problems with the new update.<br><br>:) <br><br></td></tr></table><br>
<a name="642958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one Vip3r!<br><br>Either you are a tiny bit supersticious or you forgot to send me version 1.13 :))))))<br><br>Excellent work!<br><br>Danny <br><br></td></tr></table><br>
<a name="642961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Danny, much appreciated :)<br><br>Don't worry there wasn't a V1.13, it's gone up by two version numbers because it's a Blitz3D update and also a new release for BlitzMax.<br><br>;) <br><br></td></tr></table><br>
<a name="642977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks again, new demo works really well.<br>Might have to get into MAX now so i can try the other flavour of JV-ODE.....<br><br>cheers,<br><br>Mark <br><br></td></tr></table><br>
<a name="643104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Mark, you're welcome :)<br><br>Can't wait for the launch of Tricky Tracks!<br><br>Maybe we'll see a BlitzMax version of it some day ;) <br><br></td></tr></table><br>
<a name="644031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Vip3r,<br><br>I understand there are some historical issues with 'cylinders', but what is this exactly about?!<br>I just wanted to make something and found out that a normal cylinder WILL NOT collide with a trimesh terrain! :( and just sink through. I don't think this is a matter of tweaking other values since any other geometry will act normally...<br><br>When checking your demo's for some inspiration I noticed that you have everything 'except' a trimesh-cylinder demo :)<br><br>Cheers,<br>Danny <br><br></td></tr></table><br>
<a name="644045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> The cylinder geom isn't part of the original ODE package, but an external contribution to ODE. That's why the cylinder functions are listed separately under 'External ODE User Library Functions' in the JV-ODE Function Reference. At the moment cylinder to TriMesh collision isn't supported by the core of the library.<br><br>The workaround for achieving cylinder to TriMesh collision is to 'sphere-wrap' the cylinders, have a look at the SphereWrapCylinder car demo. The only drawback is that it will only work with cylinders which are at least 2x the radius in length. The demo uses fixed joints to attach the spheres, but geom transforms would probably work better. I need to look at that :) <br><br></td></tr></table><br>
<a name="644175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> aha. ok. that does explain a lot yes... <br><br>funny... I'm no math crack, but you'd think that simple cylinders would be easier to do than capped cylinders..<br><br>ok thanks!<br><br>d. <br><br></td></tr></table><br>
<a name="645922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> You want JV-ODE to work with 2D projects eh?<br><br>No problem :)<br><br>Here's a 2D JV-ODE Spheres demo...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #									  JV-ODE - 2D Spheres Demo										#
; #									Code by Jim Williams (VIP3R)									#
; ###################################################################################################

AppTitle "JV-ODE - 2D Spheres Demo"

Include "JV-ODE.bb"

Graphics 800,600,0,2

Type ODEGeom
	Field body
	Field geom
	Field r
	Field g
	Field b
End Type

; ###################################################################################################

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-9.8,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.8)
dContactSetMu(48)

; ### Create plane

dCreatePlane(Space,0,1,0,0)

; ### ODE STATIC BARRIER (Near)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,1000,1000,1)
dGeomSetRotation(ode\geom,0,0,0)
dGeomSetPosition(ode\geom,0,500,-15)
dGeomContactSetMu(ode\geom,0.0)

; ### ODE STATIC BARRIER (Far)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,1000,1000,1)
dGeomSetRotation(ode\geom,0,0,0)
dGeomSetPosition(ode\geom,0,500,15)
dGeomContactSetMu(ode\geom,0.0)

; ###################################################################################################

SetBuffer BackBuffer()

While Not KeyHit(1)

	Cls

	PTime=MilliSecs()

	If MilliSecs()-Timer&gt;800
		AddObject()
		Timer=MilliSecs()
		End If

	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.05)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function AddObject()

xp=Rand(-80,80)

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,xp,500,0)
dBodySetAutoDisableFlag(ode\body,1)
ode\geom=dCreateSphere(Space,14)
dGeomSetBody(ode\geom,ode\body)
ode\r=Rand(255)
ode\g=Rand(255)
ode\b=Rand(255)

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	If ode\body
		Color ode\r,ode\g,ode\b
		xpos#=400+dGeomGetPositionX#(ode\geom)
		ypos#=580-dGeomGetPositionY#(ode\geom)
		Oval xpos,ypos,28,28,1

		Color 255,255,255
		angle#=-dGeomGetRoll#(ode\geom)
		px#=Cos(angle)*10+xpos
		py#=Sin(angle)*10+ypos
		Oval 10+px,10+py,8,8,1
		End If
Next

End Function

; ###################################################################################################
</textarea><br><br>All I've done is restrict motion on the z-axis using two very large slim boxes (barriers). You can think of these two boxes as two sheets of glass in a double glazed window, then the spheres are dropped between them. To make sure the spheres don't snag on the insides of the two barriers, their friction has been set to zero. There is also a plane at the base to stop them falling below ground level.<br><br>Hopefully this will help anyone trying to work out how to use JV-ODE in 2D, let me know if you have any questions.<br><br>:) <br><br></td></tr></table><br>
<a name="646038"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> I rigged a quick 2D ODE engine by just setting Z speed to 0 every frame and Z postion to 0 for each object. That allowed collisions as normal with arbitary shapes and no 'container' overhead. <br><br></td></tr></table><br>
<a name="646145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you sure that isn't abusing the simulation Shifty? How well did it work?<br><br>If you run the 2D Spheres demo without the barriers present, it would still work ok because the spheres never stray off course on the z axis anyway. The barriers are there to prevent the odd chance that a sphere might go off course, only then will a sphere make contact with the barriers. Whether the barriers are used or not, the physics processing time remains the same, so there is in fact no overhead in this particular example.<br><br>How you approach the problem depends on what you're trying to simulate in 2D. <br><br></td></tr></table><br>
<a name="646255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> It worked fine for me. I had a static mesh hitting spheres. Well, i also had static mesh hitting static mesh but we know that's crazy ;). I actually though to implement '2D' meshes, an outline of the 3D object viewed from above turned into a polyhedron, so collisions would always been along the plane with no z component. In theory that alone with zero gravity should be another. But certainly my results were very good. Didn't have any wierdness issues. I may have set rotation in the z axis (or whichever one) to zero each frame too. <br><br></td></tr></table><br>
<a name="649007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, need some help!<br><br>I am having problems with speed. My game has 64 terrain tiles each 32X32 totalling 256X256 ie 131072 triangles in total. I tried adding all of them but things just freeze up. it dus work when I just add 4 tiles. I still need to add lots of trees a rocks. Here is the problem code.<br><br><br><br>				If s=0 Then<br>				<br>					trimesh(xx,yy)=CreateTriMesh(Space,Land_mesh(xx,yy))<br>					trimesh(xx+4,yy)=CreateTriMesh(Space,Land_mesh(xx,yy))<br>					trimesh(xx,yy+4)=CreateTriMesh(Space,Land_mesh(xx,yy))<br>					trimesh(xx+4,yy+4)=CreateTriMesh(Space,Land_mesh(xx,yy))<br><br>					dGeomSetPosition(trimesh(xx,yy),1024+(xx*2048),0,1024+(yy*2048))<br>					dGeomSetPosition(trimesh(xx+4,yy),1024+(xx*2048)+8192,0,1024+(yy*2048))<br>					dGeomSetPosition(trimesh(xx,yy+4),1024+(xx*2048),0,1024+(yy*2048)+8192)<br>					dGeomSetPosition(trimesh(xx+4,yy+4),1024+(xx*2048)+8192,0,1024+(yy*2048)+8192)<br>				EndIf<br><br>Any ideas to speed things up? <br><br></td></tr></table><br>
<a name="649016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> It sounds like your TriMesh tiles are colliding with each other.<br><br>You need to create a sub-space containing all of the TriMesh tiles...<br><i><br>Global Space=dHashSpaceCreate(0)<br>Global SceneSpace=dHashSpaceCreate(Space) ; &lt;&lt;&lt; Sub-Space for TriMesh tiles<br></i><br>Then disable internal space collisions to prevent them colliding with each other...<br><i><br>dSetInternalSpaceCollideMode(0)<br></i><br>Make sure you specify 'SceneSpace' instead of 'Space' in the CreateTriMesh function calls...<br><i><br>trimesh(xx,yy)=CreateTriMesh(<b>SceneSpace</b>,Land_mesh(xx,yy))<br></i><br>The 'CarDemo-TriMesh-X4' demo shows the above method in action. <br><br></td></tr></table><br>
<a name="649022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks it's working nicely now. <br><br></td></tr></table><br>
<a name="649037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been trying to fix this code but with out much susses. The problem is that the objects vanish and then come back every frame or so. I want the to move to a new location and stay there. he is the code. any help would be gratefully received.<br><br>For ode.ODEGeom=Each ODEGeom<br><br>	RotateEntity ode\mesh,dBodyGetPitch#(ode\geom),dBodyGetYaw#(ode\geom),dBodyGetRoll#(ode\geom)<br>	obx#=dBodyGetPositionX#(ode\body)<br>	oby#=dBodyGetPositionY#(ode\body)<br>	obz#=dBodyGetPositionZ#(ode\body)<br>	ch=0<br>	If obx#&gt;(Local_Player_x#+HalfmapSizeX) Then<br>		obx#=obx# - FullmapSizeX<br>		ch=1<br>	Else If Rx&lt;(Local_Player_x#-HalfmapSizeX) Then<br>		obx#=obx# + FullmapSizeX<br>		ch=1<br>	EndIf<br>		<br>	If obz#&gt;(Local_Player_z#+HalfmapSizeY) Then <br>		obz#=obz# - FullmapSizeY<br>		ch=1<br>	Else If obz#&lt;(Local_Player_z#-HalfmapSizeY) Then<br>		obz#=obz# + FullmapSizeY<br>		ch=1<br>	EndIf<br><br>		dBodyDisable(ode\body)<br>			If ch=1 Then dBodySetPosition(ode\body,obx,oby,obz)<br>			PositionEntity ode\mesh,obx,oby,obz<br>		dBodyEnable(ode\body)<br><br>Next <br><br></td></tr></table><br>
<a name="649046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try changing the last part to the following:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
dBodyDisable(ode\body)

if ch=1 then
     dBodySetPosition(ode\body,obx,oby,obz)
     ; Set linear velocity and rotational velocity to zero
     dBodySetLinearVel  (ode\body, 0,0,0)
     dBodySetAngularVel (ode\body, 0,0,0)
end if

PositionEntity ode\mesh,obx,oby,obz
dBodyEnable(ode\body)

Next

</textarea> <br><br></td></tr></table><br>
<a name="649062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry did not work. I also need them to keep moving the same direction too. Any other Idears <br><br></td></tr></table><br>
<a name="649078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>JV-ODE Users:</b><br><br>The video card in my dev machine has just developed a serious fault, or in other words it's @#!*ed and won't display any hardware accelerated graphics :/<br><br>I've requested a service call but obviously it limits my ability to help folks until it's fixed, hopefully it won't take too long. <br><br></td></tr></table><br>
<a name="649096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> ViP3R, hang in there buddy.<br><br>Battle Tanks,<br>Need more information. What are you trying to do in general? More code would also be helpfull.<br><br>8) <br><br></td></tr></table><br>
<a name="649099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Battle Tanks: You're going to run into problems if you're manually repositioning objects in ODE. It isn't necessary to tile the ODE geometry, you can create the entire scene in ODE without affecting render speed, then apply your tile system to the visible geometry only. This will avoid the need to reposition the geoms. Btw, it's easier to read code when posted using the codebox tags... [ codebox ] Your Code Here [ / codebox ] - Without the spaces ;)<br><br>@Wayne: Will do :) <br><br></td></tr></table><br>
<a name="649107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> that's bad news...<br><br>I have  a couple of cards (through my day job) which are 'spare' for indefinte loan - let me know if you want one posting today.<br><br>cheers,<br><br>Mark <br><br></td></tr></table><br>
<a name="649133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow Mark thanks, that's extremely generous of you :)<br><br>It would be very helpful to borrow one until this one gets replaced, I'll send you an email ;) <br><br></td></tr></table><br>
<a name="649417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is what I am up to <br><br>I have created 4 identical worlds, when the player can see the edge of one of the worlds he is transported to an Identical location in the world behind him with out the player noticing what has happed. Using this method the player can keep going in one direction with out running out of land.<br><br>To get object to work in this system I use the following system.<br><br>If the object is beyond a 4096 units in x or z   from the player the object is then transported to an  Identical location on one of the other three Identical worlds. <br><br>Info:<br>Worlds: 4 Identical worlds in total<br>   A world contains 4x4 Land Tiles  each with it own Hash Space. All the trees and rocks on a tile have their own Hash Space linked to the Tiles Hash Space. Non of these are ever moved. (Note that no all the surfaces are added to the Physic system as leaves should to be able to stop a Oil barrels)<br><br>Physic Objects:<br>   Are anything that moves except internet controlled objects (local objects can collide with Internet/Lan controlled objects ), Physic Objects are Ai players, Projectiles. Oil barrels,  bricks, rocks ect<br><br>Problems I am encountering are;<br><br><br>1) The more objects I add the more likely the game will crash. The error give is memory violation on this line dSpaceCollide(Space,World,ContactGroup)<br><br>I have managed to fix the other problem somehow<br><br>What would be the best way to make a shock wave that knocked other object out the way with out being move its self, just growing is size.<br><br>Thanks for your help VIP3R.<br><br>here's a dum question for you, how do you post a picture. <br><br></td></tr></table><br>
<a name="649484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is some of the code<br> <textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

	
	Global WorldERP#=2			; ### World Error Correction
	Global WorldFriction#=200	; ### World Friction
	
	Global Force#=0
	Global Steer#=0
	
	Global Car
	Global CGeom
	Global CMesh
	Global SceneSpace
	Global HalfmapSizeX=4096,HalfmapSizeY=4096


	Global CarStartY=48
	Global ode.ODEGeom
	
	Global Local_Player_x#
	Global Local_Player_z#
	
	Dim Wheel(4)
	Dim WGeom(4)
	Dim Joint(4)
	Dim mesh(7,7)
	Dim Rock(4)
	

	
	Type ODEGeom
		Field body
		Field geom
		Field mesh
	End Type


	Global World,Space,ContactGroup,PhysicsTime#

Function Setup_Physics()


	
	
	; ###################################################################################################
	
	; ### Setup ODE
	
	World=dWorldCreate()
    Space=dHashSpaceCreate(0)
	SceneSpace=dHashSpaceCreate(Space) ; &lt;&lt;&lt; Sub-Space for TriMesh tiles
	For x=0 To 7
		For y=0 To 7
			Space64(x,y)=dHashSpaceCreate(SceneSpace)
		Next
	Next

	ContactGroup=dJointGroupCreate(0)
	
	dSetInternalSpaceCollideMode(0)
	

	dWorldSetAutoDisableFlag(World,1)
	dWorldSetGravity(World,0,-2.5,0)
	dWorldSetERP(World,0.4)
	dContactSetMode(dContactBounce)
	dContactSetBounce(0.1)
	dContactSetMu(120)

	
	; ### Create some objects
	
	SeedRnd MilliSecs()
	For a=1 To 1
		Rock(a)= LoadMesh("Media\Trees\Rock\MoreRock"+a+".3ds")
	Next
	rock_texture=LoadTexture("Media\Land\rock2.jpg")
	For spheres=1 To 10
		ode.ODEGeom=New ODEGeom
		ode\body=dBodyCreate(World)
		dBodySetRotation(ode\body,0,0,0)
		tdx#=Rnd(1*2048,6*2048)
		tdz#=Rnd(1*2048,6*2048)
		dBodySetPosition(ode\body,tdx#,256,tdz#);Rnd(4094,12288),300,Rnd(4094,12288))
		mass=dMassCreate()
		dMassSetSphereTotal(mass,2500,40)
		dBodySetMass(ode\body,mass)
		dMassDestroy(mass)
		
		ode\geom=dCreateSphere(Space,40)
		dGeomSetBody(ode\geom,ode\body)
		dGeomContactSetMu(ode\geom,3600)
		dGeomContactSetBounce(ode\geom,-1)
		ode\mesh=CopyMesh(Rock(Rand(1,1)));CreateSphere()
		ScaleMesh ode\mesh,0.75,0.75,0.75
		RotateMesh ode\mesh,0,0,0
		PositionMesh ode\mesh,0,0,0
		EntityTexture ode\mesh,rock_texture
		;EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
		;EntityAlpha ode\mesh,1
		;EntityShininess ode\mesh,0.7
	Next
	For a=1 To 1
		FreeEntity Rock(a)
	Next
	FreeTexture rock_texture
	oildrum = LoadMesh("Media\msh\oildrum2.3ds")
	For cylinders=1 To 15
		ode.ODEGeom=New ODEGeom
		ode\body=dBodyCreate(World)
		tdx#=Rnd(1*2048,6*2048)
		tdz#=Rnd(1*2048,6*2048)
		dBodySetPosition(ode\body,tdx#,256,tdz#)
		mass=dMassCreate()
		dMassSetSphereTotal(mass,50,40)
		dBodySetMass(ode\body,mass)
		dMassDestroy(mass)
		ode\geom=dCreateCCylinder(Space,12,40)
		dGeomSetBody(ode\geom,ode\body)
		dGeomContactSetMu(ode\geom,3)
		dGeomContactSetBounce(ode\geom,0.02)
		ode\mesh=CopyMesh(oildrum);CreateCylinder(8)
		
		;ScaleMesh ode\mesh,10,10,10
		RotateMesh ode\mesh,270,0,0	; &lt;&lt;&lt; Mesh X-Axis must be rotated 90 degrees to fix cylinder alignment
		PositionMesh ode\mesh,0,0,0
		;EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
		;EntityAlpha ode\mesh,1
		;EntityShininess ode\mesh,0.7
	Next
	FreeEntity oildrum
	
End Function


Function UpdateGeoms()

Local_Player_x# = EntityX(Ship,True)
Local_Player_z# = EntityZ(Ship,True)

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime
	


For ode.ODEGeom=Each ODEGeom


		If EntityX(ode\mesh,True)&gt;(EntityX(ship,True)+HalfmapSizeX) Then
			dGeomDisable(ode\geom)
			dGeomSetPosition(ode\geom,dGeomGetPositionX#(ode\geom)-FullmapSizeX,dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom))	
			dGeomEnable(ode\geom)
		Else If EntityX(ode\mesh,True)&lt;(EntityX(ship,True)-HalfmapSizeX) Then
			dGeomDisable(ode\geom)
			dGeomSetPosition(ode\geom,dGeomGetPositionX#(ode\geom)+FullmapSizeX,dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom))
			dGeomEnable(ode\geom)
		EndIf
	
		If EntityZ(ode\mesh,True)&gt;(EntityZ(ship,True)+HalfmapSizeX) Then
			dGeomDisable(ode\geom)
			dGeomSetPosition(ode\geom,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)-FullmapSizeY)	
			dGeomEnable(ode\geom)
		Else If EntityZ(ode\mesh,True)&lt;(EntityZ(ship,True)-HalfmapSizeX) Then
			dGeomDisable(ode\geom)
			dGeomSetPosition(ode\geom,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)+FullmapSizeY)
			dGeomEnable(ode\geom)
		EndIf


	If dBodyIsEnabled(ode\body)
		RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
		PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
	End If
Next

End Function

;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
;++++++++++++++++++  Make Terrian Mesh  +++++++++++++++++++
;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Function Make_Terrian_Mesh()
	Make_Pick_Maps()
	;LandTexture=Colormap
	BlockSize=64
	ts%=32
	start=0-((BlockSize*ts%)/2)
	Adjust=75
	For xx=0 To 3 
       	For yy=0 To 3
			Land_mesh(xx,yy) = CreateMesh()
			
			;EntityFX Land_mesh(xx,yy),34;*****************
			For s=0 To Level\Land_Texture_Number%-1 ;
				
				First_Vertex%=0
				For lx# = 0 To ts%
					For ly# = 0 To ts%
						x=((xx*ts%)+lx)
						y=((yy*ts%)+ly)
						If Land_Texture_Mask(s,x,y)=1 Then
							If First_Vertex=0 Then 
								Land_surf(s,xx,yy) = CreateSurface(Land_mesh(xx,yy))
								First_Vertex=1
							EndIf
							tr(lx#,ly#) = AddVertex(Land_surf(s,xx,yy), start + (lx * BlockSize) , map(0,x*8,y*8) * Level\LandHi%, start + (ly * BlockSize), (Float(x)/128.0) , 1-(Float(y)/128.0))
							
							
							Red=Land_Red(x,y)-Best_Red(s):If Red&gt;Adjust Then Red=Adjust ElseIf Red&lt;(0-Adjust) Then Red=0-Adjust
							Green=Land_Green(x,y)-Best_Green(s):If Green&gt;Adjust Then Green=Adjust ElseIf Green&lt;(0-Adjust) Then Green=0-Adjust						
							Blue=Land_Blue(x,y)-Best_Blue(s)	:If Blue&gt;Adjust Then Blue=Adjust ElseIf Blue&lt;(0-Adjust) Then Blue=0-Adjust
							Red=Red+(255-Adjust)
							Green=Greed+(255-Adjust)
							Blue=Blue+(255-Adjust)
							VertexColor Land_surf(s,xx,yy),tr(lx#,ly#), Red, Green, Blue,Land_Texture_Picker#(s,x,y)
						EndIf
					Next
				Next	
				If First_Vertex=1 Then
					For lx = 0 To ts%-1
						For ly = 0 To ts%-1
							x=((xx*ts%)+lx)
							y=((yy*ts%)+ly)
							If Land_Texture_Mask(s,x,y)=1 And Land_Texture_Mask(s,x,y+1)=1 And Land_Texture_Mask(s,x+1,y)=1 Then
								AddTriangle Land_surf(s,xx,yy), tr(lx#,ly#), tr(lx#,ly#+1), tr(lx#+1,ly#)
							EndIf
						
							If Land_Texture_Mask(s,x,y+1)=1 And Land_Texture_Mask(s,x+1,y+1)=1 And Land_Texture_Mask(s,x+1,y)=1 Then
								AddTriangle Land_surf(s,xx,yy), tr(lx#,ly#+1), tr(lx#+1,ly#+1), tr(lx#+1,ly#)
							EndIf
						
						Next
					Next

					
				EndIf
				If s=0 Then
				
					trimesh(xx,yy)=CreateTriMesh(Space64(xx,yy),Land_mesh(xx,yy))
					trimesh(xx+4,yy)=CreateTriMesh(Space64(xx+4,yy),Land_mesh(xx,yy))
					trimesh(xx,yy+4)=CreateTriMesh(Space64(xx,yy+4),Land_mesh(xx,yy))
					trimesh(xx+4,yy+4)=CreateTriMesh(Space64(xx+4,yy+4),Land_mesh(xx,yy))

					dGeomSetPosition(trimesh(xx,yy),1024+(xx*2048),0,1024+(yy*2048))
					dGeomSetPosition(trimesh(xx+4,yy),1024+(xx*2048)+8192,0,1024+(yy*2048))
					dGeomSetPosition(trimesh(xx,yy+4),1024+(xx*2048),0,1024+(yy*2048)+8192)
					dGeomSetPosition(trimesh(xx+4,yy+4),1024+(xx*2048)+8192,0,1024+(yy*2048)+8192)
				EndIf
			Next	
				
				
				Land_mesh(xx+4,yy)=CopyEntity(Land_mesh(xx,yy))
				Land_mesh(xx,yy+4)=CopyEntity(Land_mesh(xx,yy))
				Land_mesh(xx+4,yy+4)=CopyEntity(Land_mesh(xx,yy))
				PositionEntity Land_mesh(xx,yy), 	1024+(xx*2048),				0,	1024+(yy*2048)
				PositionEntity Land_mesh(xx+4,yy), 	1024+(xx*2048)+8192,		0,	1024+(yy*2048)
				PositionEntity Land_mesh(xx,yy+4), 	1024+(xx*2048),				0,	1024+(yy*2048)+8192
				PositionEntity Land_mesh(xx+4,yy+4),1024+(xx*2048)+8192,		0,	1024+(yy*2048)+8192
				
				
			For xxx=0 To 4 Step 4
				For yyy=0 To 4 Step 4

					EntityPickMode Land_mesh(xx+xxx,yy+yyy),2
				Next
			Next
       	Next
    Next

End Function

	If Scenery_Obj_Class\Is_added_to_Collision&gt;0 Then ; add the Scenery object to the Collision system
				
		test_Space=dHashSpaceCreate(Space64(Floor(bx/2048),Floor(by/2048)))
		test = CreateTriMesh_First_Surface(test_Space,NewTree)
		dGeomSetPosition(test, bx, byy#, bz)
					
		test_Space=dHashSpaceCreate(Space64(Floor((bx + FullmapSizeX)/2048),Floor(by/2048)))
		test = CreateTriMesh_First_Surface(test_Space,NewTree)
		dGeomSetPosition(test, bx + FullmapSizeX, byy#, bz)
					
		test_Space=dHashSpaceCreate(Space64(Floor(bx/2048),Floor((by + FullmapSizeY)/2048)))
		test = CreateTriMesh_First_Surface(test_Space,NewTree)
		dGeomSetPosition(test, bx, byy#, bz + FullmapSizeY)
					
		test_Space=dHashSpaceCreate(Space64(Floor((bx + FullmapSizeX)/2048),Floor((by + FullmapSizeY)/2048)))
		test = CreateTriMesh_First_Surface(test_Space,NewTree)
		dGeomSetPosition(test, bx + FullmapSizeX, byy#, bz + FullmapSizeY)
	EndIf
 </textarea> <br><br></td></tr></table><br>
<a name="649640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>The more objects I add the more likely the game will crash. The error give is memory violation on this line dSpaceCollide(Space,World,ContactGroup)<br> <br></div><br>Quite a few things can cause SpaceCollide to MAV so it isn't always easy to pinpoint. It can happen if you create geoms inside the boundary of other geoms, for example adding more than one geom in the exact same location (overlapping the previous geom). Another cause can be if too many collision contacts are generated causing memory/stack issues.<br><br>Here are some things to check that you may have missed...<br>- Make sure all of your Space variables are global or a dim array (I can't see where you're defining the Space64 array).<br>- Check for memory leaks.<br>- Try lowering/raising the max contacts value with dContactSetMaxContacts(maxvalue) to see if that helps, its default is 128.<br>- Make sure your Space64 sub-spaces are not colliding with each other or the ground plane (if used).<br>- Make use of the body auto disable feature so that it cuts down the amount of contacts generated when objects are stationary.<br><br>I still think tiling the ODE geometry like you're doing will give you headaches, so that may be at the center of the MAV issue. Try destroying and recreating the geometry instead of repositioning, it may work better and should certainly be fast enough.<br><br>Not sure about the best way to do the shock wave, have you tried adding force to the surrounding objects based on their distance from the epicentre. Be careful changing the geom size while the simulation is running, I'm not sure how ODE will react to that. You can try using the dGeomSphereSetRadius(sphere,radius) etc functions for this purpose.<br><br>Hope this helps :)<br><br>Oh, and the forum codes...<br><br><a href="http://www.blitzmax.com/faq/faq_entry.php?id=2" target="_blank">http://www.blitzmax.com/faq/faq_entry.php?id=2</a> <br><br></td></tr></table><br>
<a name="649812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have found where the problem is, well most of it. It seems that the  Cylinder to trimesh is the course of most of the crashes. I will add a Spheres to each end and see if that fixs the crashing problem<br><br>I am also adding dContactSetMaxContacts(512)<br><br>I am not moving any of the trimeshes only the Cylinders and Spheres. The crashing stated before I add the code to translate them to their new locations.<br><br>I was thinking along the same lines with the shock wave thing<br><br>One thing I would like to do is make a house with bricks and then blow it up. speed will be a problem. I have tried optimising it but still need some tips. I will use about 200 bricks. any speed tips.<br><br>I will make a demo for you all to mess with. Call it something like <br><br>Demolition house on trimesh.bb<br><br>Thanks for your help <br><br></td></tr></table><br>
<a name="649821"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might be better off using capped cylinders if the standard ones are giving you problems.<br><br>Hmm, speed tips for 200 bricks? Try lowering your dContactSetMaxContacts() value down as low as possible. You could also try increasing the QuickStep step size. Use body auto disable on the bricks. <br><br></td></tr></table><br>
<a name="650794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=54352" target="_blank">Credit where credit is due!</a> <br><br></td></tr></table><br>
<a name="650832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehe, 24/7... I'm not sure about that but I do check on the troops regularly.<br><br>Thanks BT :) <br><br></td></tr></table><br>
<a name="650915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow 3 hours, you are letting yourself go ;) <br><br></td></tr></table><br>
<a name="650942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://myspace-661.vo.llnwd.net/00649/16/63/649323661_l.jpg" target="_blank"><img src="http://myspace-661.vo.llnwd.net/00649/16/63/649323661_l.jpg"></a><br><br>Battle Tanks Earth Level. Still early days. <br><br></td></tr></table><br>
<a name="651199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ooh I hope that's a tank game with physics, can't wait to see something like that done with ODE :)<br><br>PS: Gasp! 9 hours late ;) <br><br></td></tr></table><br>
<a name="651559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can anyone confirm the DSpaceCollide2 function works 100% under BlitzMax? (Sorry, there's no Bmax thread yet so I posted here in hope!)<br><br><pre class=code>dSpaceCollide2(ray,Space.Space,world.world,group.group) - Memory Exception Error</pre><br><br><pre class=code>dSpaceCollide2(ray,0,world.world,group.group) - Memory Exception error.</pre><br><br>Ray, Space,World and Group are all valid.<br><br>The second line throwing an error makes sense, 0 space. I was toying with it to see if it would allow me to use that instead of Ode's DCollide function. (Could do with that function ;) )<br><br>I fail to see why this fails, I can use DSpaceCollide in the same place to collide spaces with other spaces no problem?<br><br>If i don't bother trying to do this, and call DspaceCollide, then the ray returns values on the next frame so it *does* work, but trying to use DSpaceCollide2 doesn't.<br><br>Perhaps i've got the wrong function? <br><br></td></tr></table><br>
<a name="651570"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> You should be supplying two geoms Cygnus, not a geom and space...<br><br>dSpaceCollide2(geom1,geom2,world,group)<br><br>[edit] Confirmed, it's working ok in BlitzMax ;) <br><br></td></tr></table><br>
<a name="651651"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see, I thought that would be the case, The official ODE Docs  read:<br><div class="quote"> <br>void dSpaceCollide2 (dGeomID o1, dGeomID o2,<br>                     void *data, dNearCallback *callback);<br><br>This function is similar to dSpaceCollide, except that it is passed two geoms (or spaces) as arguments. It calls the callback for all potentially intersecting pairs that contain one geom from o1 and one geom from o2.<br><br>The exact behavior depends on the types of o1 and o2:<br><br>    * If one argument is a non-space geom and the other is a space, the callback is called with all potential intersections between the geom and the objects in the space.<br>    * If both o1 and o2 are spaces then this calls the callback for all potentially intersecting pairs that contain one geom from o1 and one geom from o2. The algorithm that is used depends on what kinds of spaces are being collided. If no optimized algorithm can be selected then this function will resort to one of the following two strategies:<br>         1. All the geoms in o1 are tested one-by-one against o2.<br>         2. All the geoms in o2 are tested one-by-one against o1. <br>      The strategy used may depends on a number of rules, but in general the space with less objects has its geoms examined one-by-one.<br>    * If both arguments are the same space, this is equivalent to calling dSpaceCollide on that space.<br>    * If both arguments are non-space geoms, this simply calls the callback once with these arguments. <br><br> <br></div><br><br>So, I need a command where i can check one single geom against a space, like Dcollide or the Official DSpaceCollide2 command. How can I do this? :D <br><br></td></tr></table><br>
<a name="651667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> Checking for collisions with spaces using dSpaceCollide2() isn't implemented in JV-ODE, only geoms are currently supported with this function.<br><br>dCollide() is of absolutely no use externally, hence it isn't wrapped.<br><br>I can look into whether it's possible to implement space collisions with dSpaceCollide2() for the next JV-ODE update if you wish? <br><br></td></tr></table><br>
<a name="651671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you can, Yeah, I looked at Dcollide, since it doesnt return any details it is indeed useless.<br><br>I do need the ability to check geom&gt;Space though so if you could implement that i'd be extremely greatful! :D <br><br></td></tr></table><br>
<a name="651679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've just done a few quick tests and it looks like it will indeed be possible with a little bit of work. It would give the ability to check geom/space&gt;geom/space using dSpaceCollide2().<br><br>I'll add it to the 2do for the next update. <br><br></td></tr></table><br>
<a name="651684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Viper. When it comes to customer support, you can't be beaten! :D <br><br></td></tr></table><br>
<a name="652264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think their are three Viper. Entreating ,  I hear you say, that is what the 3 is for in VIP3R. They each take 8 hours shift answering our questions.  So what dues it all stand for? Very Intelligent Person  with 3 Replicas. In-fact I think the original one is on holiday. Which I think is very unfair on the them poor Replicas. I think we should start campaign.  So come on Viper get back here and do your fare share. Before will let the authority know about your Clones!  !We have photo graphic evidence! ;)<br><img src="http://myspace-280.vo.llnwd.net/00649/08/22/649332280_l.jpg"> <br><br></td></tr></table><br>
<a name="652278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#114">[#114]</a></td></tr></table></td></tr><tr ><td class="posttext"> [qupte]Very Intelligent Person with 3 Replicas.[/quote]<br><br>LMFAO! :D <br><br></td></tr></table><br>
<a name="652286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#115">[#115]</a></td></tr></table></td></tr><tr ><td class="posttext"> On a more informative note. For all you JV-ODE fans out there eager to get every last bit of speed out of an already fast Physic system, here some speed tips.<br><br>Speed Tip 1) Only add the surfaces of an model to the Physic system that you really need to i.e. no need to add the leaves of a tree just the trunk<br><br>Speed Tip 2) Use a program like milkshake to reduce the number of polygons in our models. The DirectX mesh tool is grate for this. Now Export it as a new model something like phy-(oldname).3ds.<br>Now in your program when you use the model of a Tree for instance you will and a hi poly model for Eye Candy and a low poly model for the Physic system. I used these two methods  on a tree with over 6000 triangles and made a Physic trimesh with 136 triangles, why not try it.<br><br>If fact it would be really cool if Viper could include a triangle reduction tool like this into the next update. Something like Newmesh=ReduceTriangles(oldmesh, % Reduction) <br><br></td></tr></table><br>
<a name="652294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#116">[#116]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1285" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1285</a> ;) <br><br></td></tr></table><br>
<a name="652315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#117">[#117]</a></td></tr></table></td></tr><tr ><td class="posttext"> :)<br>:)<br>:) <br><br></td></tr></table><br>
<a name="652348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#118">[#118]</a></td></tr></table></td></tr><tr ><td class="posttext"> I Did Try that one.<br>It's good but has some bad side effects and is slow. I found the DirectX tool gives the best finish but you have to use it out side of blitz. The code Is a start but needs some work. <br><br></td></tr></table><br>
<a name="652384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#119">[#119]</a></td></tr></table></td></tr><tr ><td class="posttext"> you're never satisfied, are you? your poor mom/wife... &gt;;P <br><br></td></tr></table><br>
<a name="652800"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#120">[#120]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been helping a JV-ODE user out with AMotor joints via email and thought that this info would be helpful to everyone, so here it is...<br><br>Creating and using AMotor joints:<br>Attach two bodies using a Ball joint, then attach an AMotor joint to the same two bodies. The Ball joint will keep the two bodies attached to each other and will allow movement in all directions. In the car demo below, you will see that the rear wheels are attached using Ball joints instead of Hinge2 joints like the two front wheels.<br> <br>Without the AMotor joints on the rear wheels, they would collapse as Ball joints move in any direction. Try commenting out all of the AMotor stuff in the SetupCar() and UpdateCar() functions in the AMotor demo and you will see the rear wheels wobble and collapse.<br> <br>One ability of the AMotor joint is to restrict motion on any axis, in the car demo it stops the wheels collapsing by restricting movement of the Ball joint in all directions except the z axis to allow the Ball joint (or wheel) to rotate.<br> <br>The dJointSetAMotorAxis() functions will allow you to set whether rotation is allowed on each axis of the joint. A value of 0 (zero) will not allow movement, a value of 1 (or -1 to reverse) will allow movement.<br> <br>Next, you need to set the 'dParamLoStop' and 'dParamHiStop' parameters with the dJointSetAMotorParam() function to define how much rotation is allowed. The value should be in radians, not degrees. A value of zero for both LoStop and HiStop will not allow any movement. As you can see in the car demo we need full rotation to allow the wheel to spin completely, so it is set with -4 radians for the LoStop and 4 radians for the HiStop which will allow full rotation. Try changing them to -2 and 2 and you will see that the wheels lock after approx 1/2 a rotation. Remember that the LoStop value must always be the lowest value and the HiStop must be the highest value.<br> <br>The second ability is that you are able to supply a force to AMotor joints to make them rotate, like an electric motor. See the third For/Next loop in the UpdateCar() function in the car demo, you can use 'dParamVel' (force) and 'dParamFMax' (torque) to do this.<br> <br>You need to set all of the AMotorAxis and AMotorParam settings for the AMotor joint to function correctly.<br><br>Here's the AMotor demo... (it will be included in the next JV-ODE update)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #										  JV-ODE Car Demo											#
; #									Code by Jim Williams (VIP3R)									#		#
; #						Feel free to use this code, any credit appreciated							#
; ###################################################################################################

AppTitle "JV-ODE Car Demo - AMotor"

Include "JV-ODE.bb"

Graphics3D 800,600,0,2

Global CMass#=200			; ### Car Mass
Global WMass#=14			; ### Wheel Mass

Global WorldERP#=0.8		; ### World Error Correction
Global WorldFriction#=70	; ### World Friction

Global Torque#=24			; ### Joint Torque
Global SuspensionHS#=0.01	; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0
Global Steer#=0

Global Car
Global CGeom
Global CMesh

Global CarStartY=20

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactSlip1)
dContactSetMu(WorldFriction)

; ### Create car body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,0,CarStartY,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dMassTranslate(mass,0,-1,0)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0
EntityColor ode\mesh,40,80,255
EntityAlpha ode\mesh,1

; ### Create wheels

For count=1 To 4
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Wheel(count)=ode\body
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,0,0,0)
	mass=dMassCreate()
	dMassSetSphereTotal(mass,WMass,0.7)
	dBodySetMass(ode\body,mass)
	dMassDestroy(mass)
	ode\geom=dCreateSphere(Space,0.7)
	WGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	ScaleMesh ode\mesh,0.7,0.25,0.7
	RotateMesh ode\mesh,0,0,90
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create some objects

SeedRnd MilliSecs()

For spheres=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,Rnd(-100,100),30,Rnd(-100,100))
	ode\geom=dCreateSphere(Space,4)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateSphere()
	ScaleMesh ode\mesh,4,4,4
	RotateMesh ode\mesh,0,0,0
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
Next

For cylinders=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,90,0,0)
	dBodySetPosition(ode\body,Rnd(-100,100),30,Rnd(-100,100))
	ode\geom=dCreateCCylinder(Space,1,8)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	ScaleMesh ode\mesh,1,5,1
	RotateMesh ode\mesh,90,0,0	; &lt;&lt;&lt; Mesh X-Axis must be rotated 90 degrees to fix cylinder alignment
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
Next

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global CameraPivot=CreatePivot(CMesh)
PositionEntity CameraPivot,0,2,-7

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0

Mirror=CreateMirror()

; ###################################################################################################

; ### BLITZ STATIC OBJECT (White)

blitzobject=CreateCube()
ScaleMesh blitzobject,1,4,20
RotateMesh blitzobject,-10,8,4
PositionMesh blitzobject,10,5,40

EntityColor blitzobject,255,255,255
EntityAlpha blitzobject,1

; ### ODE STATIC OBJECT (Blue)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,2,8,40)
dGeomSetRotation(ode\geom,-10,8,4)
dGeomSetPosition(ode\geom,20,5,40)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,1,4,20
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,0,100,200
EntityAlpha ode\mesh,1

; ### ODE STATIC OBJECT (Red)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,18,0.2,40)
dGeomSetRotation(ode\geom,-14,0,0)
dGeomSetPosition(ode\geom,-20,4.9,40)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,0.1,20
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,200,0,100
EntityAlpha ode\mesh,1

; ###################################################################################################

SetupCar()

While Not KeyHit(1)

	UpdateKeys()

	PTime=MilliSecs()

	UpdateCar()

	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateCam()

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 0,50,"Force:"+Force
	Text 0,65,"Torque:"+Torque
	Text 640,0,"A - Accelerate"
	Text 640,15,"Z - Brake/Reverse"
	Text 640,30,"Arrows - Steering"
	Text 640,45,"Space - Reset Car"

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function SetupCar()

For count=1 To 2
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
Next

For count=3 To 4
	Joint(count)=dJointCreateBall(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetBallAnchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	Joint(count)=dJointCreateAMotor(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetAMotorMode(Joint(count),dAMotorEuler)
	dJointSetAMotorAxis(Joint(count),0,0,0,0,0)
	dJointSetAMotorAxis(Joint(count),1,0,0,0,0)
	dJointSetAMotorAxis(Joint(count),2,0,0,0,1)
	dJointSetAMotorParam(Joint(count),dParamLoStop,-4)
	dJointSetAMotorParam(Joint(count),dParamHiStop,4)
	dJointSetAMotorParam(Joint(count),dParamLoStop2,0)
	dJointSetAMotorParam(Joint(count),dParamHiStop2,0)
	dJointSetAMotorParam(Joint(count),dParamLoStop3,0)
	dJointSetAMotorParam(Joint(count),dParamHiStop3,0)
Next

Force=0

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyDown(30)=1
	Force=Force+0.08
	If Force&gt;70 Then Force=70
	End If

If KeyDown(44)=1
	Force=Force-0.1
	If Force&lt;-10 Then Force=-10
	If Force&gt;0 Then Force=Force*0.97
	End If

If KeyDown(30)=0 And KeyDown(44)=0 Then Force=Force*0.99

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=0.5
		Else
		Steer=-0.5
		End If
	Else
	Steer=0
	End If

If KeyHit(57)=1
	Force=0
	dBodySetRotation(Car,dGeomGetPitch#(CGeom),dGeomGetYaw#(CGeom),0)
	End If

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 2
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=3 To 4
	dJointSetAMotorParam(Joint(count),dParamVel,-Force)
	dJointSetAMotorParam(Joint(count),dParamFMax,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

End Function

; ###################################################################################################

Function UpdateCam()

PositionEntity CameraPivot,0,3,-12

camx#=EntityX(CameraPivot,1)-EntityX(Camera)
camy#=EntityY(CameraPivot,1)-EntityY(Camera)
camz#=EntityZ(CameraPivot,1)-EntityZ(Camera)

TranslateEntity Camera,camx*0.5,camy*0.5,camz*0.5

PointEntity Camera,CMesh

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
	PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
Next

End Function

; ###################################################################################################
</textarea> <br><br></td></tr></table><br>
<a name="652807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#121">[#121]</a></td></tr></table></td></tr><tr ><td class="posttext"> hm i always wondered what is the real benefit of using motors instead of using normal joints+applying rotational forces to them? <br><br></td></tr></table><br>
<a name="652813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#122">[#122]</a></td></tr></table></td></tr><tr ><td class="posttext"> They're good for simulating stuff like motor servos or can be used as motors for insect legs, that kind of thing. They provide more flexibility for joint control in both restriction of movement and when applying forces. <br><br></td></tr></table><br>
<a name="654309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Atomic Duck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#123">[#123]</a></td></tr></table></td></tr><tr ><td class="posttext"> After looking at (and deconstructing) the cardemo's there's one question I like to ask:<br><br>First you create a body , then create the geometry for it and then create the mesh. So far so good.<br><br>Now, let's say I've modeled a car (including the wheels). <br>Would it not be possible to create ODE-objects in a reverse order?<br><br>Thus: <br><br>1) load carmesh (wheels are child-entities within the same file btw)<br>2) create a body <br>3) determine size of carmesh (meshwidth,meshheight,meshdepth)<br>4) position body at location of carmesh<br>5) use dMassSetBoxTotal as follows: dMassSetBoxTotal ( mass , CarMass , meshwidth*2 , meshheight*2 , meshdepth*2 )<br>6) create geometry for carmesh<br>7) bind geometry to body<br><br>and because I already know the location and size of each wheel just repeat step (2) through (7) ?<br><br>This should do the trick , right? <br>Unfortunately I get some strange readings in my debuglog , and my screen shows absolutely nothing.<br>I'll try to reproduce the situation and post a screenshot of it. <br><br>In the meantime I would like to know if the aforementioned procedure is acceptable or not? <br><br>Thanks in advance! <br><br></td></tr></table><br>
<a name="654317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#124">[#124]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've used the procedure when starting what was "Enginev2". it worked fine, so it is possbile :) <br><br></td></tr></table><br>
<a name="654323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Atomic Duck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#125">[#125]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Cygnus. I'm a happy bunny :D<br>BTW here are a few models I'm using it for (they are not finished yet though)<br><br><img src="http://i8.photobucket.com/albums/a39/firestarter_/rescuevan01.png"><br><br><img src="http://i8.photobucket.com/albums/a39/firestarter_/f1.png"> <br><br></td></tr></table><br>
<a name="654324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#126">[#126]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>JV-ODE V1.15 Update Released</b><br><br>Please check your inbox :)<br><br>The new update includes:<br><br>Added support for Space collision checking in the dSpaceCollide2() function<br><br>Added CarDemo-AMotor<br>Added CarDemo-TruckTrailer<br><br>Changed CarDemo-SphereWrapCylinder to include Geom Transform option<br><br>Please let me know if you experience any problems with the new update.<br><br>:) <br><br></td></tr></table><br>
<a name="654328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#127">[#127]</a></td></tr></table></td></tr><tr ><td class="posttext"> You *know* i've been staring at this thread waiting. Thanks man! <br><br></td></tr></table><br>
<a name="654337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#128">[#128]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks VIP3R - looking good as usual.<br><br>One question, the Amotor method of driving a vehicles wheels would not have the inherent suspension settings that a hinge2 joint would have, would it ?<br><br>Am i right in thinking that you would need to model the suspension yourself (a little project i've been thinking of for a while).<br><br>i.e. use the amotor to drive the wheel whilst it's held in position using a system of connecting rods / hinges to mimic a real suspension unit.<br><br>Mark <br><br></td></tr></table><br>
<a name="654347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#129">[#129]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool... updates just keep coming! :) <br><br></td></tr></table><br>
<a name="654351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#130">[#130]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all :)<br><br>You should be able to use the AMotor as a wheel joint providing you add a separate suspension system as you've decribed. I haven't tried it yet, but the theory seems sound to me. <br><br></td></tr></table><br>
<a name="654352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barton</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#131">[#131]</a></td></tr></table></td></tr><tr ><td class="posttext"> thx for update!<br><br>for what is it good the new "dSpaceCollide2()" ? <br><br></td></tr></table><br>
<a name="654358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#132">[#132]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome Barton :)<br><br>dSpaceCollide() processes collisions for all Geoms and Spaces.<br><br>dSpaceCollide2() processes collisions on only the Spaces/Geoms specified, allowing you to manually select which Geoms or Spaces are checked for collisions. <br><br></td></tr></table><br>
<a name="654460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#133">[#133]</a></td></tr></table></td></tr><tr ><td class="posttext"> More control, I like it !!<br>Thanks for update VIP3R. <br><br></td></tr></table><br>
<a name="654636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#134">[#134]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome Wayne :)<br><br>Btw, nice models Atomic Duck. <br><br></td></tr></table><br>
<a name="654655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#135">[#135]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice Car.<br><br>I was just wondering if I need to create a geom for a body if I don't need the object to spin. I.E. the CreateSprite() could I just us a body for this or is a geom needed anyway. I am making a projectile and as soon as it hits something it is deleted. <br><br></td></tr></table><br>
<a name="654698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#136">[#136]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I'm not entirely sure what you need to do, anyway here's what a body and geom does...<br><br>An ODE body is affected by forces and mass, like gravity etc.<br><br>An ODE geom is used for collision detection.<br><br>If you create a body without a geom it will be affected by forces like gravity, but will not collide with any other objects.<br><br>If you create a geom without a body it will be static (not affected by forces etc), but it will still collide with other geoms. <br><br></td></tr></table><br>
<a name="654707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#137">[#137]</a></td></tr></table></td></tr><tr ><td class="posttext"> So for a round rock that is part of the land I could us a ODE geom Sphere.<br><br>But for projectile with a Sprite I need both a ODE body and ODE geom to work right.<br><br>Thanks for the clarification :)<br><br>I am finding that after a while run my game things slow down for a couple of seconds.<br><br>I am creating and Destroying ODE body and ODE geom all the time it's running. could it be ODE doing a garbage collection that is temporally slowing things down to a crawl (about 1 to 2 seconds). Is there a command to help overcome this? <br><br></td></tr></table><br>
<a name="655174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#138">[#138]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, for the round rock you can use a static Sphere geom (with no body).<br><br>I don't know of any memory leaks etc so I'm not sure why you get those slowdowns. Of course there could be a million and one reasons, but I would double check that you're destroying not only the body/geoms but also any joints that are holding them together. Destroy any unused spaces. As a test you could reposition (re-use) the body/geoms to see if that cures the problem, it may help find the cause. Also check for straying geoms that may have been created beneath the TriMeshes etc as that would probably cause instability or slowdowns. If you're creating static rocks that are in contact with the TriMeshes, make sure they're in the same sub-space with internal space collide mode disabled.<br><br>Let me know if you need anymore info ;) <br><br></td></tr></table><br>
<a name="655199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#139">[#139]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd also avoid using create and destroy where possible. You have an overhead of managing resources when doing that, with the OS having to manage RAM. Better if you can to move objects off scene. In my engine I set an object to no space to disable it, and set the mesh invisible. Then when I want it back in, add it to the root ODE space and make the mesh visible. So if you're creating bullets on the fly, try instead having an array of bullets and make them active/inactive that way. <br><br></td></tr></table><br>
<a name="655826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#140">[#140]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I will give it a go and tell you how it goes :) <br><br></td></tr></table><br>
<a name="656192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >yinch</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#141">[#141]</a></td></tr></table></td></tr><tr ><td class="posttext"> Forgive a JV-ODE noob, I have a question about how to alter/set the centre of rotation for a body.<br><br>At the moment, all created bodies pivot around their geometric centre - is there a way to make them pivot around some point OTHER than their geometric centres?<br><br>Do I have to use mass or hinge?<br>At the moment, the object only has body, geom and mesh.<br><br>yinch'06<br><br>p.s. JV-ODE is the just about the most brilliant userLib I have ever found. <br><br></td></tr></table><br>
<a name="656259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#142">[#142]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is the only command I could find to set the center of gravity.<br><br>void dMassSetParameters (dMass *, dReal themass,<br>dReal cgx, dReal cgy, dReal cgz,<br>dReal I11, dReal I22, dReal I33,<br>dReal I12, dReal I13, dReal I23);<br>Set the mass parameters to the given values. themass is the mass of the body. (cx,cy,cz) is the<br>center of gravity position in the body frame. The Ixx values are the elements of the inertia matrix:<br>[ I11 I12 I13 ]<br>[ I12 I22 I23 ]<br>[ I13 I23 I33 ]<br><br>I have no idea how to use it? <br>What would this be ? inertia matrix:[ I11 I12 I13 ]<br><br>Anyone up to making an example? <br><br></td></tr></table><br>
<a name="656488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#143">[#143]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for helping out BT ;)<br><br>Hi yinch,<br><br>Don't use the dMassSetParameters() function, the inertia matrix stuff is a bit complicated.<br><br>There's another ODE mass function that will move the center of gravity of a body...<br><b>dMassTranslate(mass,x,y,z)</b><br><br>Replace the AddObject() function in the 'Demo-Spheres.bb' demo with this one...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function AddObject()

xp=Rand(-8,8)
zp=Rand(-8,8)
ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,xp,30,zp)
dBodySetAutoDisableFlag(ode\body,1)
mass=dMassCreate()
dMassSetSphereTotal(mass,1,3)
dMassTranslate(mass,0,0,-8) ; &lt;&lt;&lt; Center of mass moved -8 units on z-axis
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateSphere(Space,3)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateSphere()
ScaleMesh ode\mesh,3,3,3
EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
EntityAlpha ode\mesh,1
EntityShininess ode\mesh,0.7

End Function
</textarea><br>If you need a jointed body to rotate around a different point, you need to move the anchor position of the joint. <br><br></td></tr></table><br>
<a name="656503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#144">[#144]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's interesting. That could be used to simulate a half full barrel, by slowly moving the center of gravity to the lower end <br><br>I will have to use that line Don't use the dMassSetParameters() function, the inertia matrix stuff is a bit complicated. When I not shore how something works too ;) .It makes you look cleave without giving the fact you dont know your self ;)<br><br>I think VIP3R is going to explain it now, or at least look it up and then explain it ;) <br><br></td></tr></table><br>
<a name="656514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >yinch</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#145">[#145]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Vip3r,<br><br>I was starting to use hinges already. But it is useful to know about the mass translate function.<br><br>Once again - keep up the brilliant brilliant work on JV-ODE, you rock!<br><br><br>yinch'06 <br><br></td></tr></table><br>
<a name="656519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#146">[#146]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome yinch :)<br><br>Hehe, Battle Tanks if you really want to understand how an inertia matrix works then here you are, knock yourself out...<br><br><a href="http://scienceworld.wolfram.com/physics/MomentofInertia.html" target="_blank">http://scienceworld.wolfram.com/physics/MomentofInertia.html</a><br><br>...like I said, it's a bit complicated<br><br>I'm not a professor of physics you know ;) <br><br></td></tr></table><br>
<a name="656593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#147">[#147]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's the thread clump of Hebrew and Aztec symbols that realy cleared things up for me ;) I feel so thick now for knot geting from   <br><br>[ I11 I12 I13 ]<br>[ I12 I22 I23 ]<br>[ I13 I23 I33 ]<br><br>Well back to Superman then, he may not be real but he has laserguns for eyeballs you know ;) <br><br></td></tr></table><br>
<a name="656602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Battle Tanks</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#148">[#148]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's allot simpler in two dimensions<br><br>[ I11 I12 ]<br>[ I12 I22 ]<br><br>moment of inertia is just the mass times the square of perpendicular distance to the rotation axis, i.e. I = mr2. That point mass relationship becomes the basis for all other moments of inertia since any object can be built up from a collection of point masses.<br><br>so if we put the center of mass to one side of our circle or Sphere. And that side gets a glacing blow it will make the  circle or Sphere spin more rapidly that if it was hit further way from the center of mass. <br><br>Am I right in saying all it is, is a fence three dimensional lever. Move the short end of the lever and the long end moves the distance the short end moved divided by the length of the short end  X the length of the long end.  So if the short end was 10 cm long (distance from the pivot) and the long end was 30 cm long (distance from the pivot) if the short end was move 5 cm then the  long end would move 3X that (15cm) 5cm / 10cm * 30cm = 15cm<br><br>It that right or have I got the wrong end of the lever :) <br><br></td></tr></table><br>
<a name="656631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#149">[#149]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Am I right in saying<br> <br></div><br>No, you're not even close. If you had any understanding of what an inertia matrix is and how it works you would know that 'I = mr2' doesn't apply to solid objects and that a circle and sphere both have different moment of inertia algorithms.<br><br>Let's get something straight shall we, I'm not here to give people in-depth physics lessons. If that's what you desire I suggest you take a degree in the subject.<br><br>Now, is there anything else I can help you with? :) <br><br></td></tr></table><br>
<a name="656720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#150">[#150]</a></td></tr></table></td></tr><tr ><td class="posttext"> Time for a new thread Viper? <br><br></td></tr></table><br>
<a name="656736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#151">[#151]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>THREAD 6 IS ABOUT TO CLOSE</b><br><br>Please continue on the new thread located <a href="/posts.php?topic=59001" target="_blank">here</a><br><br>Thanks :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
