<!DOCTYPE html><html lang="en" ><head ><title >Block Intrusive keys (ALT+TAB, WINkey, etc.)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Block Intrusive keys (ALT+TAB, WINkey, etc.)</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >Block Intrusive keys (ALT+TAB, WINkey, etc.)</a><br><br>
<a name="552571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have posted an update to my StickyKeys_dll to the Code Arcs. I created it to deal with the problem of Accessibility features in Windows that can intrude on a game that uses the Shift key (in particular) or the NUM Lock key. <a href="/posts.php?topic=49055" target="_blank">There were a number of requests on the BlitzBasic B3D board asking for ways to disable other intrusions</a> such as accidentally hitting the Windows (Start) key or crashes caused by users ALT+TABbing within a game. The update includes this functionality.<br><br>Features:<br>=========<br>1. Can toggle the Accessibility features (FilterKeys, StickyKeys, ToggleKeys) on and off<br>2. Can independently toggle ToggleKeys on/off<br>3. Can enable/disable SysKey combinations {Alt+TAB, Alt+Esc, Ctrl+Esc, LeftWIN key, RightWIN key} through simple toggle to restrict task switching from within game<br>4. Can toggle audible feedback for blocked SysKeys<br>5. Simple toggle to allow/deny any keyboard intrusions (put outside start + end of your game loop)<br><br>N.B. there is presently no Ctr+Alt+Delete blocking functionality<br><br>There have been a few tests by the community and it all seems to be working nicely. :-)<br><br>Check the Code Arc entry for <a href="/codearcs.php?code=1334" target="_blank">StickyKey_dll</a><br><br>Hope this isn't seen as 'spamming' (I announced this on the thread requesting the new functions) ... but threads drop out of sight quickly on the B3D Programming forum and this is technically a UserLib. <br><br></td></tr></table><br>
<a name="569743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't seem to get this to work on my win98SE machine.<br><br>I want to block all intrusions to my fullscreen app but using Alt+tab is still taking me back to the desktop.<br><br>I tested using your supplied code:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics 640, 480

StopIntrusions = True
vernum$ = GetStickyKeysVersionNumber()

KeyboardGameLock(True)

Repeat
Text 20,0,  "'T' to toggle Keyboard intrusion features on/off ......."
Text 20,60, "Keypressed " + GetKey()
Text 20,100, vernum
Text 20,140, "Keyboard intrusion state is " + StopIntrusions 

Text 20, 300, "try pressing SHIFT 5+ times (... can launch StickyKeys dialog);"
Text 20, 320, "hold down RightSHIFT For 8+ seconds (can launch FilterKeys dialog);"
Text 20, 340, "hold down NUMLOCK for 5+ seconds (can launch ToggleKeys dialog);"
Text 20, 360, "use ALT+TAB, ALT+Esc, CTRL+Esc Or the Win key ... can cause task switching"


If KeyHit(20) Then                 ;  'T' to toggle StopIntrusions 
   StopIntrusions = 1 - StopIntrusions 
   KeyboardGameLock( StopIntrusions )
EndIf	
		  

Flip False
Delay 30
Cls
Until KeyHit(1)
   
KeyboardGameLock(False); ESSENTIAL - Unhook GLOBAL (all apps) filter 


End
</textarea><br><br>Running this code also completely disabled/unloaded StickyKeys so the shortcut no longer worked (even after exiting the program) and the StickyKeys checkbox in Control Panel became unchecked.<br><br>Any ideas for us poor win98 users? :) <br><br></td></tr></table><br>
<a name="570342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ big10p:<br><br>Thanks for reporting your issues with W98SE. The dll <b>should</b> work on W98, but I am willing to take your results on faith over the documentation from M$.<br><br>I have the option of including some W98/ME specific code that uses the 'ScreenSaver mode' to disable task-switching... I will try to include this in the next version if I can get reliable reporting of the OS version.<br><br>As for the StickyKeys problem... I am not sure why this isn't working. Can you check for the file "StickyKey.txt" on your machine ? {Probably in same folder as the dll.}<br><br>If this file exists and is not hidden, then the dll had a problem exiting. Running again <b>should</b> restore the previous settings.<br><br>If the file exists and <i>is</i> hidden then it <i>thinks</i> it closed down correctly.<br><br>You might try deleting all references to "StickyKey.txt", resetting your Control panel, then try running again to see if the file is being changed during program running.<br><br>Please let me know how you get on with this... <br><br></td></tr></table><br>
<a name="570347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for replying, BlackJumper.<br><br>OK, I looked in the userlibs folder and the stickykeys.txt file was there, not hidden.<br><br>Funny thing is, I deleted the file and ran the above code again. It still didn't prevent Alt+tab working but, on exit, the stickykeys.txt file did not reappear in the userlibs folder - hidden or otherwise.<br><br>I didn't bother turning on stickykeys in control panel as I just wanted to see if I could get Alt+tab to be blocked.<br><br>Have you (or any other user) tested this dll on win98? If so, I'm not sure what's wrong with my machine. :) <br><br></td></tr></table><br>
<a name="570656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @big10p:<br><br>I have emailed you a new build of the dll that (hopefully) detects W95/W98/WME versions and uses the ScreenSaver mode to disable Alt+TAB and Ctr+Alt+Del, etc.<br><br>Can you give it a whirl and let me know if it works for you... if so I will make this an official release to satisfy the teeming hordes of Blitzers who have W98 machines that require this functionality ;-) <br><br></td></tr></table><br>
<a name="571775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Latest info for W98 machines...<br><br>big10p has tried my newest build of StickyKeys.dll on a W98SE machine and it does not appear to be working for task-switching. (I believe that StickyKeys, Toggle|Keys and FilterKeys are working though.)<br><br>I will be dusting off an old laptop with W98 installed when I get some time and trying to fix this. This is not likely to happen until early November at the earliest. I will also try to incorporate other feature requests at that point.<br><br>In the meantime, W98 and W95 (lol) are not fully supported by this userlib. Apologies for any inconvenience. <br><br></td></tr></table><br>
<a name="573812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barton</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmm<br><br>STRG+ALT+ENTF isn't blocked :(<br><br><br>and !! ...<br>If DirectInput=1 then blitz3d ignoring your KeyBlocks. <br><br></td></tr></table><br>
<a name="574127"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Barton:<br><br><div class="quote"> STRG+ALT+ENTF isn't blocked :(  <br></div><br><br>... OK, I got myself an ALT key, but I have no idea what those others are. If you can supply details then I can block them in the next version.<br><br><div class="quote"> If DirectInput=1 then blitz3d ignoring your KeyBlocks.  <br></div><br><br>... Good to know - could explain the rare problems people have had with this. I will try to include a check for this condition in the next version and maybe give the option of disabling it or at least reporting back on the reason for failure.<br><br>Thanks for the input! <br><br></td></tr></table><br>
<a name="576692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why would you want to block the Alt key?  Professional games don't do this, because you need to be able to switch out of full-screen mode. <br><br></td></tr></table><br>
<a name="576788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, apart from a probable 'block everything' approach required for W98, I will be giving the option of which features to turn on and off. <br><br>Some people might be writing kiosk-style apps that they don't want people to be able to switch out of. There was also some discussion of 'kiddie-proofing' an environment so you could happily leave a toddler bashing away on the keyboard without fear of losing your system.<br><br>I know King Dave originally asked for this as a result of problems caused by Freeworld players getting MAVs or lockups. <br><br></td></tr></table><br>
<a name="576797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barton</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @halo <br> <br>if one plays a game, one shall switch nothing over. Just B3D then often falls away. (Memory Access Error) <br><br></td></tr></table><br>
<a name="593026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I said before in an email, but I'll say it on the forum, the "block all" is really good for little kids software, my 1.8 year old loves a slideshow app where space progresses, but Windows Key or anything else doesn't bomb him out. <br><br></td></tr></table><br>
<a name="596092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Professional games don't do this, because you need to be able to switch out of full-screen mode"<br><br>FYI, I've had graphics cards where if you did this (in any app) it crashed the gfx card. So its good that its the author's choice. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
