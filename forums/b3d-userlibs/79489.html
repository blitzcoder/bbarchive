<!DOCTYPE html><html lang="en" ><head ><title >JV-ODE Physics Thread 11</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >JV-ODE Physics Thread 11</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >JV-ODE Physics Thread 11</a><br><br>
<a name="892499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now available for <b>Blitz3D</b> &amp; <b>BlitzMax (Win32)</b><br><br>The JV-ODE Physics Wrapper is an advanced user library supporting almost all of the Open Dynamics Engine functions wrapped inside a DLL (Dynamic Link Library).<br><br>The library can be used with any programming language that supports DLL's, including Blitz3D and BlitzMax (Win32). The Euler rotation system in JV-ODE has been adapted to match the left-handed Euler rotation used in Blitz3D, however functions for accessing Quaternion and Axis Angle rotation systems are also included. The full versions contain all of the necessary files to get you started, including over 40 demos showing the various features found in ODE and a complete Function Reference document.<br><br>The BlitzMax (Win32) version also features a built-in 'bare-bones' OpenGL 3D engine module and B3D mesh loader module for demo purposes.<br><br>To view more information and screenshots <a href="http://jv-ode.devcode.co.uk/" target="_blank">click here</a>.<br><br>Options are now available to purchase the wrapper using either PayPal or Share*it.<br><br>The <b>Blitz3D</b> restricted demo version is now available for download <a href="http://jv-ode.devcode.co.uk/dload/JV-ODE-Demo-Blitz3D.zip" target="_blank">here</a> (207KB)<br><br>The <b>BlitzMax (Win32)</b> restricted demo version is now available for download <a href="http://jv-ode.devcode.co.uk/dload/JV-ODE-Demo-BlitzMax.zip" target="_blank">here</a> (376KB)<br><br>The <b>JV-ODE Leadwerks Engine Demo Pack</b> is now available for download <a href="http://jv-ode.devcode.co.uk/dload/JV-ODE-LeadwerksEngine.zip" target="_blank">here</a> (60KB)<br><br>Have Fun :)<br><br>Previous JV-ODE Blitz3D Threads: <a href="/posts.php?topic=43653" target="_blank">1</a> <a href="/posts.php?topic=45048" target="_blank">2</a> <a href="/posts.php?topic=48743" target="_blank">3</a> <a href="/posts.php?topic=52572" target="_blank">4</a> <a href="/posts.php?topic=53490" target="_blank">5</a> <a href="/posts.php?topic=56209" target="_blank">6</a> <a href="/posts.php?topic=59001" target="_blank">7</a> <a href="/posts.php?topic=63898" target="_blank">8</a> <a href="/posts.php?topic=68198" target="_blank">9</a> <a href="/posts.php?topic=72220" target="_blank">10</a><br><br>Useful Links: <a href="http://www.ode.org/" target="_blank">ODE.org Website</a> - <a href="http://opende.sourceforge.net/wiki/" target="_blank">ODE Wiki</a> - <a href="http://www.ode.org/ode-latest-userguide.pdf" target="_blank">ODE User Guide (PDF)</a> - <a href="http://www.ode.org/ode-latest-userguide.html" target="_blank">ODE User Guide (HTML)</a> <br><br></td></tr></table><br>
<a name="892945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the new update, my 3d Rigs over a network around fort block isn't abandoned... just waiting for my work to back off a bit so I can spend more time hobby coding.  <br><br>Regards, BP. <br><br></td></tr></table><br>
<a name="892950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome BP :) <br><br></td></tr></table><br>
<a name="893034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just fired up my rigs, computer 1's rig does move on computer 2 via network control, however am now using your 2 car demo to optimize my 2 player (or more...) TCP server client blah within the twin car demo.  Cheers. <br><br></td></tr></table><br>
<a name="893404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Carter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for the updates best thing to hit my inbox in years. <br><br></td></tr></table><br>
<a name="894510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KronosUK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a little thing I tacked onto the ragdoll demo as an experiment. The shadows don't look quite right somehow though, perhaps they should fade with distance or something.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">' ###################################################################################################
' #									   JV-ODE - RagDoll Demo										#
' #									Code by Jim Williams (VIP3R)									#
' ###################################################################################################

SuperStrict

Framework BRL.GLMax2D
Import BRL.Random
Import DevCode.JVODE
Import DevCode.JVODEOpenGL

AppTitle:String="JV-ODE - RagDoll Demo"

SetGraphicsDriver GLMax2DDriver()

Graphics 800,600,0,0

Global CamX:Float
Global CamZ:Float
Global numrags:Int = 10
Global RagDollMax:Int=numrags+1
Global ODEJointMax:Int=15
Global I:Int
Global WorldERP:Float=0.1	
Global RDBody:Int[RagDollMax,ODEJointMax]
Global RDJoint:Int[RagDollMax,ODEJointMax]

Type ODEGeom
	Field body:Int
	Field geom:Int
	Field mesh:Int
	Field rgb:Int[]
	Field scale:Float[]
End Type

Global ODEGeomList:TList=CreateList()

' ###################################################################################################

' ### Setup ODE

Global World:Int=dWorldCreate()
Global Space:Int=dHashSpaceCreate(0)
Global ContactGroup:Int=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-2.8,0)
dWorldSetERP(World,WorldERP)
dContactSetMode(dContactSlip1+dContactBounce)
dContactSetBounce(0.75)
dContactSetMu(48)

' ### Setup Scene

InitOpenGL(GL_SMOOTH)	' ### GL_SMOOTH - GL_FLAT

InitLight(-40,80,100)	' ### xpos - ypos - zpos

' ### Create plane

dCreatePlane(Space,0,1,0,0)

' ###################################################################################################

' ### Create RagDolls

Local Count:Int

For Count=1 To numrags
	CreateRagDoll(Count)
Next

' ###################################################################################################

Local PTime:Int
Local PhysicsTime:Float

While Not AppTerminate() And Not KeyDown(KEY_ESCAPE)

	UpdateControls()

	ClearScene()

	UpdateCamera(-30+CamX,9,-25+CamZ,30,1,0,0)	' ### xpos - ypos - zpos - angle - rx - ry - rz

	DrawPlanarShadow()'UpdateGeoms()

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime=MilliSecs()-PTime

	EnableGLText(255,255,255)		' ### red - green - blue
	GLDrawText "JV-ODE Version "+FixFloat(dGetVersion()),0,0
	GLDrawText "Physics Time:"+FixFloat(PhysicsTime),0,15
	GLDrawText "F1 - Drop RagDolls",300,0
	GLDrawText "Space - Throw RagDolls",300,15
	GLDrawText "Arrow Keys - Move Camera",300,30
	GLDrawText "F2 - Attach RagDolls",580,0
	GLDrawText "L Mouse Button - Push Body",580,15
	GLDrawText "R Mouse Button - Pull Body",580,30

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

' ###################################################################################################

Function CreateRagDoll(rd:Int)

Local ode:ODEGeom
Local xp:Float=8+(rd*4)
Local yp:Float=6
Local zp:Float=4

' ### RagDoll Dimensions

Local HeadRad:Float=0.4
Local BodyUX:Float=1.0
Local BodyUY:Float=1.5
Local BodyUZ:Float=0.4
Local BodyLX:Float=1.4
Local BodyLY:Float=0.75
Local BodyLZ:Float=0.5
Local ArmURad:Float=0.08
Local ArmULen:Float=1.1
Local ArmLRad:Float=0.08
Local ArmLLen:Float=1.1
Local LegURad:Float=0.125
Local LegULen:Float=1.3
Local LegLRad:Float=0.125
Local LegLLen:Float=1.3
Local FeetX:Float=0.5
Local FeetY:Float=0.25
Local FeetZ:Float=1.0
Local HandX:Float=0.1
Local HandY:Float=0.4
Local HandZ:Float=0.28

' ### Create Head

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,0]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp,yp,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateSphere(Space,HeadRad)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dSphereClass
ode.rgb=[255,255,255]
ode.scale=[HeadRad]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Body (Upper)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,1]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp,yp-1.25,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,BodyUX,BodyUY,BodyUZ)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dBoxClass
ode.rgb=[0,200,200]
ode.scale=[BodyUX,BodyUY,BodyUZ]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Body (Lower)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,2]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp,yp-2.5,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,BodyLX,BodyLY,BodyLZ)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dBoxClass
ode.rgb=[0,100,100]
ode.scale=[BodyLX,BodyLY,BodyLZ]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Left Arm (Upper)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,3]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp+0.9,yp-1.25,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,ArmURad,ArmULen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[255,0,0]
ode.scale=[ArmURad,ArmURad,ArmULen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Left Arm (Lower)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,4]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp+0.9,yp-2.35,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,ArmLRad,ArmLLen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[125,0,0]
ode.scale=[ArmLRad,ArmLRad,ArmLLen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Left Hand

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,5]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp+0.9,yp-3.05,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,HandX,HandY,HandZ)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dBoxClass
ode.rgb=[255,255,255]
ode.scale=[HandX,HandY,HandZ]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Right Arm (Upper)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,6]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp-0.9,yp-1.25,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,ArmURad,ArmULen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[0,255,0]
ode.scale=[ArmURad,ArmURad,ArmULen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Right Arm (Lower)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,7]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp-0.9,yp-2.35,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,ArmLRad,ArmLLen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[0,125,0]
ode.scale=[ArmLRad,ArmLRad,ArmLLen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Right Hand

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,8]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp-0.9,yp-3.05,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,HandX,HandY,HandZ)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dBoxClass
ode.rgb=[255,255,255]
ode.scale=[HandX,HandY,HandZ]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Left Leg (Upper)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,9]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp+0.5,yp-3.6,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,LegURad,LegULen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[255,0,0]
ode.scale=[LegURad,LegURad,LegULen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Left Leg (Lower)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,10]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp+0.5,yp-4.9,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,LegLRad,LegLLen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[125,0,0]
ode.scale=[LegLRad,LegLRad,LegLLen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Left Foot

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,11]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp+0.5,yp-5.7,zp-0.25)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,FeetX,FeetY,FeetZ)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dBoxClass
ode.rgb=[255,255,255]
ode.scale=[FeetX,FeetY,FeetZ]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Right Leg (Upper)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,12]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp-0.5,yp-3.6,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,LegURad,LegULen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[0,255,0]
ode.scale=[LegURad,LegURad,LegULen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Right Leg (Lower)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,13]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp-0.5,yp-4.9,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateCylinder(Space,LegLRad,LegLLen)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dCylinderClass
ode.rgb=[0,125,0]
ode.scale=[LegLRad,LegLRad,LegLLen]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Create Right Foot

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
RDBody[rd,14]=ode.body
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp-0.5,yp-5.7,zp-0.25)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,FeetX,FeetY,FeetZ)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=dBoxClass
ode.rgb=[255,255,255]
ode.scale=[FeetX,FeetY,FeetZ]
ListAddLast(ODEGeomList,ode:ODEGeom)

' ### Static Joint To Head

RDJoint[rd,0]=dJointCreateBall(World,0)
dJointAttach(RDJoint[rd,0],0,RDBody[rd,0])
dJointSetBallAnchor(RDJoint[rd,0],xp,yp,zp)

' ### Head To Body (Upper)

RDJoint[rd,1]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,1],RDBody[rd,0],RDBody[rd,1])
dJointSetHingeAxis(RDJoint[rd,1],1,0,1)
dJointSetHingeAnchor(RDJoint[rd,1],xp,yp-0.44,zp)
dJointSetHingeParam(RDJoint[rd,1],dParamLoStop,-0.7)
dJointSetHingeParam(RDJoint[rd,1],dParamHiStop,0.7)

' ### Body (Upper) To Body (Lower)

RDJoint[rd,2]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,2],RDBody[rd,1],RDBody[rd,2])
dJointSetHingeAxis(RDJoint[rd,2],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,2],xp,yp-2.05,zp)
dJointSetHingeParam(RDJoint[rd,2],dParamLoStop,-0.25)
dJointSetHingeParam(RDJoint[rd,2],dParamHiStop,0.25)

' ### Left Arm (Upper) To Body (Upper)

RDJoint[rd,3]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,3],RDBody[rd,3],RDBody[rd,1])
dJointSetHingeAxis(RDJoint[rd,3],1,-1,1)
dJointSetHingeAnchor(RDJoint[rd,3],xp+0.9,yp-0.7,zp)
dJointSetHingeParam(RDJoint[rd,3],dParamLoStop,-1.5)
dJointSetHingeParam(RDJoint[rd,3],dParamHiStop,1.5)

' ### Left Arm (Lower) To Left Arm (Upper)

RDJoint[rd,4]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,4],RDBody[rd,4],RDBody[rd,3])
dJointSetHingeAxis(RDJoint[rd,4],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,4],xp+0.9,yp-1.8,zp)
dJointSetHingeParam(RDJoint[rd,4],dParamLoStop,0.0)
dJointSetHingeParam(RDJoint[rd,4],dParamHiStop,2.0)

' ### Left Hand To Left Arm (Lower)

RDJoint[rd,5]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,5],RDBody[rd,5],RDBody[rd,4])
dJointSetHingeAxis(RDJoint[rd,5],0,0,1)
dJointSetHingeAnchor(RDJoint[rd,5],xp+0.9,yp-2.9,zp)
dJointSetHingeParam(RDJoint[rd,5],dParamLoStop,-0.3)
dJointSetHingeParam(RDJoint[rd,5],dParamHiStop,0.3)

' ### Right Arm (Upper) To Body (Upper)

RDJoint[rd,6]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,6],RDBody[rd,6],RDBody[rd,1])
dJointSetHingeAxis(RDJoint[rd,6],1,1,1)
dJointSetHingeAnchor(RDJoint[rd,6],xp-0.9,yp-0.7,zp)
dJointSetHingeParam(RDJoint[rd,6],dParamLoStop,-1.5)
dJointSetHingeParam(RDJoint[rd,6],dParamHiStop,1.5)

' ### Right Arm (Lower) To Right Arm (Upper)

RDJoint[rd,7]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,7],RDBody[rd,7],RDBody[rd,6])
dJointSetHingeAxis(RDJoint[rd,7],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,7],xp-0.9,yp-1.8,zp)
dJointSetHingeParam(RDJoint[rd,7],dParamLoStop,0.0)
dJointSetHingeParam(RDJoint[rd,7],dParamHiStop,2.0)

' ### Right Hand To Right Arm (Lower)

RDJoint[rd,8]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,8],RDBody[rd,8],RDBody[rd,7])
dJointSetHingeAxis(RDJoint[rd,8],0,0,1)
dJointSetHingeAnchor(RDJoint[rd,8],xp-0.9,yp-2.9,zp)
dJointSetHingeParam(RDJoint[rd,8],dParamLoStop,-0.3)
dJointSetHingeParam(RDJoint[rd,8],dParamHiStop,0.3)

' ### Left Leg (Upper) To Body (Lower)

RDJoint[rd,9]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,9],RDBody[rd,9],RDBody[rd,2])
dJointSetHingeAxis(RDJoint[rd,9],1,0,-1)
dJointSetHingeAnchor(RDJoint[rd,9],xp+0.5,yp-2.9,zp)
dJointSetHingeParam(RDJoint[rd,9],dParamLoStop,-1.0)
dJointSetHingeParam(RDJoint[rd,9],dParamHiStop,1.0)

' ### Left Leg (Lower) To Left Leg (Upper)

RDJoint[rd,10]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,10],RDBody[rd,10],RDBody[rd,9])
dJointSetHingeAxis(RDJoint[rd,10],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,10],xp+0.5,yp-4.25,zp)
dJointSetHingeParam(RDJoint[rd,10],dParamLoStop,-2.0)
dJointSetHingeParam(RDJoint[rd,10],dParamHiStop,0.0)

' ### Left Foot To Left Leg (Lower)

RDJoint[rd,11]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,11],RDBody[rd,11],RDBody[rd,10])
dJointSetHingeAxis(RDJoint[rd,11],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,11],xp+0.5,yp-5.5,zp)
dJointSetHingeParam(RDJoint[rd,11],dParamLoStop,-0.25)
dJointSetHingeParam(RDJoint[rd,11],dParamHiStop,0.25)

' ### Right Leg (Upper) To Body (Lower)

RDJoint[rd,12]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,12],RDBody[rd,12],RDBody[rd,2])
dJointSetHingeAxis(RDJoint[rd,12],1,0,1)
dJointSetHingeAnchor(RDJoint[rd,12],xp-0.5,yp-2.9,zp)
dJointSetHingeParam(RDJoint[rd,12],dParamLoStop,-1.0)
dJointSetHingeParam(RDJoint[rd,12],dParamHiStop,1.0)

' ### Right Leg (Lower) To Right Leg (Upper)

RDJoint[rd,13]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,13],RDBody[rd,13],RDBody[rd,12])
dJointSetHingeAxis(RDJoint[rd,13],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,13],xp-0.5,yp-4.25,zp)
dJointSetHingeParam(RDJoint[rd,13],dParamLoStop,-2.0)
dJointSetHingeParam(RDJoint[rd,13],dParamHiStop,0.0)

' ### Right Foot To Right Leg (Lower)

RDJoint[rd,14]=dJointCreateHinge(World,0)
dJointAttach(RDJoint[rd,14],RDBody[rd,14],RDBody[rd,13])
dJointSetHingeAxis(RDJoint[rd,14],1,0,0)
dJointSetHingeAnchor(RDJoint[rd,14],xp-0.5,yp-5.5,zp)
dJointSetHingeParam(RDJoint[rd,14],dParamLoStop,-0.25)
dJointSetHingeParam(RDJoint[rd,14],dParamHiStop,0.25)

End Function

' ###################################################################################################

Function UpdateControls()

If KeyDown(KEY_F1)=1 Then 
For i = 1 To numrags
dJointAttach(RDJoint[i,0],0,0)
Next
EndIf
If KeyDown(KEY_F2)=1 Then 
For i = 1 To numrags
dJointAttach(RDJoint[i,0],0,RDBody[i,0])
Next
EndIf

If KeyDown(KEY_SPACE)=1
	For i = 1 To numrags
	dBodyAddForce RDBody[i,0],0,150,0
	Next
	End If

If KeyDown(KEY_UP)=1 Then CamZ:+0.3
If KeyDown(KEY_DOWN)=1 Then CamZ:-0.3
If KeyDown(KEY_LEFT)=1 Then CamX:+0.3
If KeyDown(KEY_RIGHT)=1 Then CamX:-0.3

If MouseDown(MOUSE_LEFT)=1
	For i = 1 To numrags
	dBodyAddForce RDBody[i,1],0,0,10
	Next
	End If

If MouseDown(MOUSE_RIGHT)=1
	For i = 1 To numrags
	dBodyAddForce RDBody[i,1],0,0,-10
	Next
	End If

End Function

' ###################################################################################################

Function UpdateGeoms()

Local ode:ODEGeom



' ### Update Geoms
For ode:ODEGeom=EachIn ODEGeomList
	glPushMatrix()

	glTranslatef(dGeomGetPositionX(ode.geom),dGeomGetPositionY(ode.geom),dGeomGetPositionZ(ode.geom))
	dGeomGetAxisAngle(ode.geom)
	glRotatef(dVectorW(),dVectorX(),dVectorY(),dVectorZ())

	SetDrawColour(ode.rgb[0],ode.rgb[1],ode.rgb[2])

	' ### DrawSphere:		radius - slices - stacks
	' ### DrawCube:			xscale - yscale - zscale
	' ### DrawCylinder:		radiusb - radiust - length - slices - loops
	' ### DrawCCylinder:	radiusb - radiust - length - slices - loops
	If ode.mesh=dSphereClass Then DrawSphere(ode.scale[0],14,14)
	If ode.mesh=dBoxClass Then DrawCube(ode.scale[0],ode.scale[1],ode.scale[2])
	If ode.mesh=dCylinderClass Then DrawCylinder(ode.scale[0],ode.scale[1],ode.scale[2],8,8)
	If ode.mesh=dCapsuleClass Then DrawCapsule(ode.scale[0],ode.scale[1],ode.scale[2],8,8)

	glPopMatrix()
Next

End Function

' ###################################################################################################
Function DrawPlanarShadow()
' ### Update Plane
SetDrawColour(230,230,240)	' ### red - green - blue
DrawPlane(-(CamX-(CamX Mod -20)),0,-(CamZ-(CamZ Mod -20)))

Local plane:Float[]=[0.0,1.0,0.0,0.0]
Local shadowmatrix:Float[16]
Local dot:Float
Local lightpos:Float[]=[-40.0,180.0,-100.0,0.0]


'now set shadow matrix

dot = plane[0]*lightpos[0]+plane[1]*lightpos[1]+plane[2]*lightpos[2]+plane[3]*lightpos[3]

shadowmatrix[0] 	= dot - lightpos[0]*plane[0]
shadowmatrix[4] 	= 0.0 - lightpos[0]*plane[1]
shadowmatrix[8] 	= 0.0 - lightpos[0]*plane[2]
shadowmatrix[12] 	= 0.0 - lightpos[0]*plane[3]

shadowmatrix[1] 	= 0.0 - lightpos[1]*plane[0]
shadowmatrix[5] 	= dot - lightpos[1]*plane[1]
shadowmatrix[9] 	= 0.0 - lightpos[1]*plane[2]
shadowmatrix[13] 	= 0.0 - lightpos[1]*plane[3]

shadowmatrix[2] 	= 0.0 - lightpos[2]*plane[0]
shadowmatrix[6] 	= 0.0 - lightpos[2]*plane[1]
shadowmatrix[10] 	= dot - lightpos[2]*plane[2]
shadowmatrix[14] 	= 0.0 - lightpos[2]*plane[3]

shadowmatrix[3] 	= 0.0 - lightpos[3]*plane[0]
shadowmatrix[7] 	= 0.0 - lightpos[3]*plane[1]
shadowmatrix[11] 	= 0.0 - lightpos[3]*plane[2]
shadowmatrix[15] 	= dot - lightpos[3]*plane[3]


glPushMatrix()
glDisable(GL_TEXTURE_2D)
glDisable(GL_LIGHTING)
glDisable(GL_DEPTH_TEST)
glEnable(GL_BLEND)
glColor4f(0.0,0.0,0.0,0.5)
glMultMatrixf(shadowmatrix)
UpdateGeoms()'drawobject as shadow
glEnable(GL_DEPTH_TEST)
glDisable(GL_BLEND)
glEnable(GL_LIGHTING)
glPopMatrix()
UpdateGeoms()'drawobject as object

End Function</textarea> <br><br></td></tr></table><br>
<a name="894576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome Pete, thanks :)<br><br>@KronosUK: Excellent stuff! It's great to see shadows working with the bare bones engine, it's fast too. I might experiment a bit more with that when I update the JVODEOpenGL module. Your ragdolls look like they could do with a bit more food ;) <br><br></td></tr></table><br>
<a name="896030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> moving forwards with clients chatting to a server for control info to be sync'd between clients.... slowly:-<br><br><img src="http://myweb.tiscali.co.uk/diecastcars/5cars.jpg"><br><br>The reason the version is only 1.24 is that I didn't have enough time to get v1.27 onto my usb stick for dev whilst on hols... <br><br>During development I'd 200 cars all moving in time, didn't half cause some carnage when I started varying the force dependant upon client number (;-) cheers BP. <br><br></td></tr></table><br>
<a name="896096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> 200 networked cars, that's impressive!<br><br>Keep it up :) <br><br></td></tr></table><br>
<a name="896327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KronosUK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Regarding the code below can someone clarify whether the tribank and vertbank continue to be used by ode after the trimesh is created?. In other words you couldn't use this function to create two trimeshs from two or more different b3d's as they would share the same tribank/vertbank.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function CreateTriMesh:Int(trispace:Int,xscale:Float=1.0,yscale:Float=1.0,zscale:Float=1.0)

Global TriBank:TBank=CreateBank(NTris*3*4)
Global VertBank:TBank=CreateBank(NVerts*4*4)

Local Offset:Int=0
Local TriOffset:Int=0

Local VertData:Vrts
Local TriData:Tris

For VertData:Vrts=EachIn B3DVrtsList
	PokeFloat(VertBank,Offset,xscale*VertData.X)
	Offset:+4
	PokeFloat(VertBank,Offset,yscale*VertData.Y)
	Offset:+4
	PokeFloat(VertBank,Offset,zscale*VertData.Z)
	Offset:+8
Next

For TriData:Tris=EachIn B3DTrisList
	PokeInt(TriBank,TriOffset,TriData.V0)
	TriOffset:+4
	PokeInt(TriBank,TriOffset,TriData.V1)
	TriOffset:+4
	PokeInt(TriBank,TriOffset,TriData.V2)
	TriOffset:+4
Next

Local TriMeshData:Int=dGeomTriMeshDataCreate()

dGeomTriMeshDataBuildSimple(TriMeshData,BankBuf(VertBank),NVerts,BankBuf(TriBank),NTris*3)

Return dCreateTriMesh(trispace,TriMeshData)

End Function
</textarea> <br><br></td></tr></table><br>
<a name="896363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Once the TriMesh has been created using the banks, they're no longer accessed by ODE. I think at one time ODE needed them to be kept reserved (hence the global scope) but that isn't the case anymore. It still works ok if the banks are local scope only. <br><br></td></tr></table><br>
<a name="896436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KronosUK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get an unhandled memory exception on the line<br><br>dSpaceCollide(Space,World,ContactGroup)<br><br>in the main loop if I make tribank/vertbank Local so i guess Ode still needs them reserved. <br><br></td></tr></table><br>
<a name="896541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, it works ok here with local scope. The error you mentioned is what used to happen when global scope was required.<br><br>Are you using V1.27 of JV-ODE (including the modules)?<br><br>Also, which version of BlitzMax are you using? <br><br></td></tr></table><br>
<a name="896729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KronosUK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive copied over the v1.27 dll but still no joy. i think I need to recheck my code as there is something funny happening with my "spaces". <br><br></td></tr></table><br>
<a name="897290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> do you mean code spaces, like GGrrr.. underbar spaces in variable names (suffered about an hour from a trailing underbar in a var name within a function associated with the cars steerage - my fault!).  If you mean 3d spaces then I can't empathise.  <br><br>Safe to say, I'm now an initial capital fan as opposed to an underbar separation fan.  As far as my TCP ing is going, I'm not 100  percent that everyone will be able to be represented on other peoples computers effectively without some dead reckoning wizardry.  Never say die.... <br><br></td></tr></table><br>
<a name="897980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mortiis</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does it have cloth simulation support too? <br><br></td></tr></table><br>
<a name="897988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, but not natively. You need to create your own cloth object using a matrix of spheres attached to each other with ball joints. Any physics engine with ball joints should be capable of this. There's a simple demo in JV-ODE Thread 10, search for 'Cloth Demo'. <br><br></td></tr></table><br>
<a name="898027"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does JV-ODE support soft-body simulation?<br>I saw it in Physx and bullet. <br><br></td></tr></table><br>
<a name="898042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, ODE simulates rigid body physics.<br><br>However, certain types of soft body physics are still possible with ODE, for example the cloth physics as mentioned above. <br><br></td></tr></table><br>
<a name="900649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Jim!<br><br>Can I change the "WorldFriction" in "real time" ? <br><br>I want to make this to make variations during the game... <br><br>I have changing the WorldFriction# value and using this command dContactSetMu(WorldFriction), but, Not happen...<br><br>Can you Help me with this? <br><br></td></tr></table><br>
<a name="900659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi EmerGki,<br><br>Not world friction, however you can use the geom functions to do this in real time instead... dGeomContactSetMu(geom,mu)<br><br>Here's a car demo with variable wheel geom friction...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #										  JV-ODE Car Demo											#
; #									Code by Jim Williams (VIP3R)									#
; #								Devious Codeworks - Copyright © 2008								#
; ###################################################################################################

AppTitle "JV-ODE Car Demo"

Include "JV-ODE.bb"

Graphics3D 800,600,0,2

Global CMass#=200			; ### Car Mass
Global WMass#=14			; ### Wheel Mass

Global WorldERP#=1			; ### World Error Correction
Global WorldFriction#=70	; ### World Friction
Global GeomFriction#=70		; ### Geom Friction

Global Torque#=24			; ### Joint Torque
Global SuspensionHS#=0.01	; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0
Global Steer#=0

Global Car
Global CGeom
Global CMesh

Global CarStartY=20

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactSlip1)
dContactSetMu(WorldFriction)

; ### Create car body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,0,CarStartY,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0
EntityColor ode\mesh,40,80,255
EntityAlpha ode\mesh,1

; ### Create wheels

For count=1 To 4
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Wheel(count)=ode\body
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,0,0,0)
	mass=dMassCreate()
	dMassSetSphereTotal(mass,WMass,0.7)
	dBodySetMass(ode\body,mass)
	dMassDestroy(mass)
	ode\geom=dCreateSphere(Space,0.7)
	WGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	ScaleMesh ode\mesh,0.7,0.25,0.7
	RotateMesh ode\mesh,0,0,90
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create some objects

SeedRnd MilliSecs()

For spheres=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,Rnd(-100,100),30,Rnd(-100,100))
	ode\geom=dCreateSphere(Space,4)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateSphere()
	ScaleMesh ode\mesh,4,4,4
	RotateMesh ode\mesh,0,0,0
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
Next

For capsules=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,90,0,0)
	dBodySetPosition(ode\body,Rnd(-100,100),30,Rnd(-100,100))
	ode\geom=dCreateCapsule(Space,1,8)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder(8)
	ScaleMesh ode\mesh,1,5,1
	RotateMesh ode\mesh,90,0,0	; &lt;&lt;&lt; Mesh X-Axis must be rotated 90 degrees to fix cylinder alignment
	PositionMesh ode\mesh,0,0,0
	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7
Next

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global CameraPivot=CreatePivot(CMesh)
PositionEntity CameraPivot,0,2,-7

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0

Mirror=CreateMirror()

; ###################################################################################################

; ### BLITZ STATIC OBJECT (White)

blitzobject=CreateCube()
ScaleMesh blitzobject,1,4,20
RotateMesh blitzobject,-10,8,4
PositionMesh blitzobject,10,5,40

EntityColor blitzobject,255,255,255
EntityAlpha blitzobject,1

; ### ODE STATIC OBJECT (Blue)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,2,8,40)
dGeomSetRotation(ode\geom,-10,8,4)
dGeomSetPosition(ode\geom,20,5,40)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,1,4,20
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,0,100,200
EntityAlpha ode\mesh,1

; ### ODE STATIC OBJECT (Red)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,18,0.2,40)
dGeomSetRotation(ode\geom,-14,0,0)
dGeomSetPosition(ode\geom,-20,4.9,40)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,0.1,20
RotateMesh ode\mesh,0,0,0
PositionMesh ode\mesh,0,0,0

EntityColor ode\mesh,200,0,100
EntityAlpha ode\mesh,1

; ###################################################################################################

SetupCar()

While Not KeyHit(1)

	UpdateKeys()

	UpdateCar()

	UpdateGeoms()

	For count=1 To 4
		dGeomContactSetMu(WGeom(count),GeomFriction)
	Next

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateCam()

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 0,50,"Force:"+Force
	Text 0,65,"Torque:"+Torque
	Text 0,100,"Use F1 &amp; F2 To Modify Wheel Friction"
	Text 0,115,"GeomFriction:"+GeomFriction
	Text 640,0,"A - Accelerate"
	Text 640,15,"Z - Brake/Reverse"
	Text 640,30,"Arrows - Steering"
	Text 640,45,"Space - Reset Car"

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function SetupCar()

For count=1 To 4
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
	If count&gt;2
		dJointSetHinge2Param(Joint(count),dParamLoStop,0)
		dJointSetHinge2Param(Joint(count),dParamHiStop,0)
		End If
Next

Force=0

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyDown(30)=1
	Force=Force+0.08
	If Force&gt;30 Then Force=30
	End If

If KeyDown(44)=1
	Force=Force-0.1
	If Force&lt;-10 Then Force=-10
	If Force&gt;0 Then Force=Force*0.97
	End If

If KeyDown(30)=0 And KeyDown(44)=0 Then Force=Force*0.99

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=0.5
		Else
		Steer=-0.5
		End If
	Else
	Steer=0
	End If

If KeyHit(57)=1
	Force=0
	dBodySetRotation(Car,dGeomGetPitch#(CGeom),dGeomGetYaw#(CGeom),0)
	End If

If KeyDown(59)=1 Then GeomFriction=GeomFriction+1
If KeyDown(60)=1 And GeomFriction&gt;0 Then GeomFriction=GeomFriction-1

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 4
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

End Function

; ###################################################################################################

Function UpdateCam()

PositionEntity CameraPivot,0,3,-12

camx#=EntityX(CameraPivot,1)-EntityX(Camera)
camy#=EntityY(CameraPivot,1)-EntityY(Camera)
camz#=EntityZ(CameraPivot,1)-EntityZ(Camera)

TranslateEntity Camera,camx*0.5,camy*0.5,camz*0.5

PointEntity Camera,CMesh

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
	PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
Next

End Function

; ###################################################################################################
</textarea> <br><br></td></tr></table><br>
<a name="900664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank You Jim! =D <br><br></td></tr></table><br>
<a name="901746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >proud2bme</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good Day,<br><br>     I'm trying to buy JV-ODE but on the website the Buy Now button doesn't show up. <br><br></td></tr></table><br>
<a name="901807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>It seems to be working ok here at the moment, are you using <a href="http://jv-ode.devcode.co.uk/" target="_blank">http://jv-ode.devcode.co.uk/</a> ?<br><br>Let me know if you're still having problems and I'll look into it further for you. <br><br></td></tr></table><br>
<a name="901832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >proud2bme</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah that's the site I'm using. I still can't purchase, even on my laptop. There is no Buy Now button. I hope I'm not the only one with this problem. If I am I can't explain it. <br><br></td></tr></table><br>
<a name="902033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange, it still works here, maybe your browser cache needs clearing?<br><br>Here's some direct links to the Share*it product pages...<br><br><a href="http://www.shareit.com/product.html?cart=1&amp;productid=300012758&amp;languageid=1&amp;stylefrom=300012758&amp;backlink=http%3A%2F%2Fjv-ode.devcode.co.uk%2F&amp;currencies=GBP,EUR,USD" target="_blank">JV-ODE Blitz3D Version</a><br><br><a href="http://www.shareit.com/product.html?cart=1&amp;productid=300064971&amp;languageid=1&amp;stylefrom=300064971&amp;backlink=http%3A%2F%2Fjv-ode.devcode.co.uk%2F&amp;currencies=GBP,EUR,USD" target="_blank">JV-ODE BlitzMax Version</a> <br><br></td></tr></table><br>
<a name="902038"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >proud2bme</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the links dude. I cleaned the cache, same thing happens. Anyway, I will be buying your software. <br><br></td></tr></table><br>
<a name="903265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >karmacomposer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I bought JV-ODE for Blitz3D a while ago and now have a new email address.  The old email address is defunct and I do not have access to it.  How do I download the latest version?<br><br>I do have the original email with the 1.17 version download as well as my username and password.<br><br>Mike Felker<br>mike at world-class-multimedia.com<br>www.world-class-multimedia.com <br><br></td></tr></table><br>
<a name="903350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I've updated your email address with the one in your profile and sent you an email regarding the latest version download. <br><br></td></tr></table><br>
<a name="903411"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >karmacomposer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got it - thanks.<br><br>Mike <br><br></td></tr></table><br>
<a name="904277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Someone has created a good "brake system" (for vehicles) with ODE? Can someone help me with this? <br><br></td></tr></table><br>
<a name="904279"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use zero force and lots of torque on the wheel joints.<br><br>Adding the following code to the UpdateKeys() function in the car demos will lock all four wheels when the 'down' arrow key is pressed...<br><br><pre class=code>
If KeyDown(208)=1
	Force=0
	Torque=1000
	Else
	Torque=24
	End If
</pre> <br><br></td></tr></table><br>
<a name="904310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jim,<br><br>I'm making a "progressive brake", where you can control the "force" of the brake with the pedal... My brake work in a plane highway, but, in a Downhill highway, the brake make my car lose the control, something like the wheel turning for one side...<br><br>I have tried making the "Force" go down and Torque go up, progressively, like this: <br><br>	Force=Force-0.01*BrakePedal#<br>	HingeTorque=HingeTorque+(0.1*BrakePedal#)<br><br>I believe that I'll need to use another variable to control the brake... <br><br></td></tr></table><br>
<a name="904378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..I just bought this cute wrapper...so far its all smooth, but I would like to know how to properly use &gt;&gt;dBodyGetLinearVel(body)&lt;&lt;, because when i try to use it, I got 'Illegal type conversion' error...what i did is I just wanted to get Linear velocity by doing this LVelocity=dBodyGetLinearVel(Car) (I tried with one of provided examples).. <br><br></td></tr></table><br>
<a name="904406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> @EmerGki: Ah progressive braking, I see. Using force damping like that is like engine braking which might not be what you want. Have you tried using zero force and only progressive torque instead? It's difficult to suggest the cause of the loss of control without seeing it in action, but it could be linked to the levels of mass and friction you're using for the car/wheels/highway.<br><br>@NA: The <i>dBodyGetLinearVel(body)</i> function returns a vector in ODE, which can't be returned to Blitz directly. You can either use the unique JV-ODE functions to return a specific vector component using <i>dBodyGetLinearVelX(body)</i>, <i>dBodyGetLinearVelY(body)</i> or <i>dBodyGetLinearVelZ(body)</i>. Or you can get the complete vector by calling <i>dBodyGetLinearVel(body)</i> and then use the vector functions like this...<br><br><i>dBodyGetLinearVel(body)<br>LVelX#=dVectorX()<br>LVelY#=dVectorY()<br>LVelZ#=dVectorZ()</i> <br><br></td></tr></table><br>
<a name="904432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..in order to make my level geometry physics interactive, I have to use trimesh stuff from examples?? or there is another way?? How to make custom shape geometry physics interactive(non static)? <br><br></td></tr></table><br>
<a name="904547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> TriMeshes should only be used for static objects in reality, they're too slow compared to primitives. If you want to create non static custom geometry, you need to build composite objects using multiple primitive geoms like cubes, spheres and capsules with geom offsets. Look at the Geom Offset demos to see how it works. Once you've built your custom physics geometry, update your custom mesh (the visible geometry) with the position/rotation of the body or one of the geoms. <br><br></td></tr></table><br>
<a name="904753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>JV-ODE V1.28 Update Released</b><br><br>Please check your inbox :)<br><br>All JV-ODE demos have been updated, tweaked and improved.<br><br>Added new demos:<br><i>CarDemo-AABB<br>CarDemo-Duo<br>CarDemo-Velocity<br>Demo-RayPick (Blitz3D Version)<br>Demo-Slider<br>Demo-TriMeshes (BlitzMax Version)</i><br><br>The following demos now use Geom Offsets instead of Geom Transforms...<br><i>CarDemo-TruckTrailer<br>CarDemo-SphereWrapCylinder<br>Demo-RagDolls-Zombie (Blitz3D Version)</i><br><br>The old Geom Transform demos are obsolete and have been removed, however Geom Transforms are still supported in JV-ODE.<br><br>The JV-ODE OpenGL 3D Engine module in the BlitzMax version has been completely redesigned to mimic the command set and appearance of Blitz3D. All JV-ODE BlitzMax demos have been modified to use the new 3D engine. It is now much easier to convert the demos to run in MiniB3D, for example to convert the Demo-Spheres code, change the Framework to SiDesign.MiniB3D and comment out the Blitz Plane code - that's it.<br><br>An updated Leadwerks Engine Demo Pack is also available from the Leadwerks Forums.<br><br>Please let me know if you experience any problems with the new update.<br><br>:) <br><br></td></tr></table><br>
<a name="904771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..nice.. thanks man.. :) you really keeping things updated... <br><br></td></tr></table><br>
<a name="904874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> After the Version 1.25, I'm getting this error: <br><br><img src="http://www.dynamicgames.com.br/images/odeerror.JPG"><br><br>How to solve this problem, or, what's wrong??<br><br><br>So, I'm still using the 1.24... <br><br></td></tr></table><br>
<a name="904902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> @NA: You're welcome  :)<br><br>@EmerGki: I take it you're using dMassTranslate()?<br><br>In the recent versions of ODE, the centre of mass must be at 0,0,0 in relation to the position of the body (the origin) or it will throw an error. It has always worked this way but earlier versions didn't throw an error if it was used incorrectly.<br><br>It's quite complicated and it works the opposite way to how you might think.<br><br>I've asked the ODE authors about this before and they admitted the function name is misleading. If you create a body and attach two geoms to it, with the second geom off-centre, you have to reposition all of the geometry until the centre of the whole object is at 0,0,0. Then, you translate the mass back to the centre of the whole object which is now 0,0,0.<br><br>So you don't move the centre of gravity, you move the geometry until it's overall centre is at 0,0,0, then you reset the centre of gravity to 0,0,0 with dMassTranslate(). It's used in one of the ODE examples which you can find <a href="http://opende.sourceforge.net/mediawiki-1.6.10/index.php/HOWTO_composite_objects" target="_blank">here</a>. <br><br></td></tr></table><br>
<a name="904946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..im a bit stuck  with trimeshes...maybe because i use to use all time Physx wrapper so its a different..I just dont know...in Physx if you dont describe object mass, its considered infinite mass, therefore, static..here I had look over demo-trimeshes and it seems that they are dynamic and not static/while mass is not described/..Im wondering what exactly and how to enable parts of my geometry to be static(non uniform geometry, my level practically), with use of trimeshes.. <br><br></td></tr></table><br>
<a name="904947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R, do you mind to post again cloth demonstration with use of spheres, I lost it..and is it possible to use pivots instead of spheres? <br><br></td></tr></table><br>
<a name="905108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> In ODE you have a rigid body which has mass and is affected by gravity and forces etc. Then you have the geom, which is used for collision detection. To create a TriMesh that is non-static, it needs a body like in the Demo-TriMeshes demo. To create a static TriMesh, you only create the geom and omit the body. If you look at the CarDemo-TriMesh-* demo code, you will notice the static terrain TriMeshes don't have a body associated with them.<br><br>If you don't specify the mass, ODE will use a default mass value of 1.0, not infinity. As there is no body associated with static objects, they have no mass, but behave as if their mass is infinite.<br><br>The cloth demo is in JV-ODE Physics Thread 10, about two-thirds of the way down. The visible sphere meshes can be replaced with anything you like, pivots, mesh bones etc. <br><br></td></tr></table><br>
<a name="905127"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..okay..I hope im doing something wrong here and its not wrapper issue..I want to set up my level to be static..now..during loading, I pass trough level structure loaded with LoadAnimMesh and store every element in to types so later I have names, and ID for each element on scene. Then I pass trough elements in Type and turn them in to trimesh with Trimesh function provided with samples..and..nothing happen..cubes or other primitives i create for sake of test, simply drop trough my level geometry....I did similar approach with Physx and it was working without any problems...I also noticed that command dSpaceCollide is present in demos while docs said its unsuported...what im missing here?? <br><br></td></tr></table><br>
<a name="905129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..hmm..I got it work but its extreme slow (4 fps) dropped from 70fps..what i did is, I sliced my level in to 4 chunks and load them separately as use for physics, practically this:<br>Ode1=LoadMesh("Ode1.b3d")<br>trimesh1=CreateTriMesh(Space,Ode1)<br>FreeEntity Ode1<br>Ode2=LoadMesh("Ode2.b3d")<br>trimesh2=CreateTriMesh(Space,Ode2)<br>FreeEntity Ode2<br>Ode3=LoadMesh("Ode3.b3d")<br>trimesh3=CreateTriMesh(Space,Ode3)<br>FreeEntity Ode3<br>Ode4=LoadMesh("Ode4.b3d")<br>trimesh4=CreateTriMesh(Space,Ode4)<br>FreeEntity Ode4<br><br>after this, collision working over geometry properly but with funny slow fps..level has 120K polys and same level I use to rig with Physx before worked fine and with no slowdown at all..what I did wrong here?? <br><br></td></tr></table><br>
<a name="905193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> To create a TriMesh from a mesh loaded with LoadAnimMesh, you need to use the <i>CreateAnimTriMesh()</i> function instead of <i>CreateTriMesh()</i>. Look at the CarDemo-AnimTriMesh demo, you need to specify which layer to use for the geometry.<br><br><i>dSpaceCollide()</i> is not implemented in its original form, the JV-ODE version has different parameters, notice the docs have a link 'Unique JV-ODE Function alternative' next to it.<br><br>The slowdown is caused by the static TriMeshes colliding with other scenery like the plane or other TriMeshes. You need to use a sub-space for the static scenery and disable internal collisions with <i>dSetInternalSpaceCollideMode(0)</i> to prevent them colliding with each other. Look at the CarDemo-TriMesh-X4 demo and check how the spaces are used, search the code for SceneSpace to see where. First the sub-spaces are added to the top level space, next internal collisions are disabled, then each scenery object is created in the sub-space SceneSpace (not 'Space' which is the top level space).<br><br>You'll soon have it running like greased lightning ;) <br><br></td></tr></table><br>
<a name="905195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> given meshes were collapsed in to one single  mesh, thats why I used CreateTriMesh()...however I havent use dSetInternalSpaceCollideMode(0),  what may cause problems...because when my car dropped on to scene, its was jumping like a horse until jump becomeso big that carr dissapear on horizon...I just copied same car settings I did without racing track, where things use to work perfect..anyway here is how structure look like..all level entities are stored in here<br>Type Level<br> field ID<br> field Name$<br> field Trimesh<br>end type<br>so, when I pass trough this structure i wanted to do <br>Trimesh=CreateTrimesh(Space,Entity\ID) , and similar thing working smooth like silk with Physx (but i want to go for ODE because of drivers physix require)..so  when i do that on way I show with Ode, program freeze so i had to slice level in few chunks and load separately outside of hierarchy i show just now..then it worked but horribly slow, and car never ever touched track itself(i load already tested and set car, with no scaling or anything, and all  previously set in empty scene with plane)..instead car jumping a lot...<br><br>Now..I set up  car on such way that car shell is trimesh, but wheels are primitives(spheres) and wheels shouldcollide as they do just fine on my setup scene...so, im a bit confused because racing track is up to scale with car already set so i havent touch that..ehh <br><br></td></tr></table><br>
<a name="905327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, the car disappearing on the horizon is the simulation exploding, which is caused by a bad setup.<br><br>It's ok to use a single mesh for the terrain, but you must use the CreateAnimTriMesh() function if you're loading a mesh with LoadAnimMesh. You shouldn't have to slice your meshes for them to work, that's bypassing the actual problem, instead of fixing it.<br><br>As mentioned earlier, to fix the slowdown, setup your spaces like this...<br><pre class=code>
Global Space=dHashSpaceCreate(0)
Global SceneSpace=dHashSpaceCreate(Space)
dSetInternalSpaceCollideMode(0)
...
dCreatePlane(SceneSpace,0,1,0,0) ; &lt;&lt;&lt; If a plane is used
Trimesh=CreateTrimesh(SceneSpace,TLevel\TriMesh) ; &lt;&lt;&lt; Use CreateAnimTriMesh here if using LoadAnimMesh
</pre>Next, don't use a TriMesh for the car shell, build it from primitives (boxes). You can use any mesh for the visible entity, you don't have to use cubes. You should have an ODE body (ode\body), an ODE geom (ode\geom - boxes) and the car shell mesh (ode\mesh - .B3D .3DS etc).<br><br>Be aware that Physx and ODE work differently to each other. So whatever worked in Physx might need tweaking to behave the same in ODE.<br><br>If you're still stuck, post some code (or send it via email) so that I can show you where you're going wrong. Or send me the level &amp; car meshes, and I will add them to a simple demo for you so that you can see how to do it correctly. <br><br></td></tr></table><br>
<a name="905345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...thanks man...I will send you level(its actual model for F1 racing circuit in malaysia), and car with all parts separated(shell, wheels, discs...)...i can use this email 	jv-ode[no-spam]devcode.co.uk?<br><br>My scene setup is same as you have been posted...is there any requirement from ODE regarding polygons on geometry or way how is it triangulated, or whatever?? I will send you level+car in next 1 hour.. <br><br></td></tr></table><br>
<a name="905369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..ok..geometry+ car + some screenshots sent... <br><br></td></tr></table><br>
<a name="905374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I've just received it, gimme an hour or two.<br><br>There are no special requirements for the geometry, every mesh I've tried so far has worked ok. <br><br></td></tr></table><br>
<a name="905432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've sent you a working demo with all <b>958</b> TriMeshes running at less than 1.0 physics time.<br><br>That's seriously fast!!! <br><br></td></tr></table><br>
<a name="905492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..yeah..wonderful..I see why it was slow..or not collision at all..only thing I didnt use properly is Trimesh function(I used one provided with demo  scenes)...I luv it..thank you A LOT.. <br><br></td></tr></table><br>
<a name="905607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome :) <br><br></td></tr></table><br>
<a name="905838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> .Vip3r, how to change friction value on the fly? I have tried to change friction value in runtime(depending what car do) with use of dContactSetMu(WorldFriction), while changing WorldFriction value on the fly, but it seems that there is no effect, related to initial set up..how to update world friction on the fly?? <br><br></td></tr></table><br>
<a name="905940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> World friction only changes when a new geom is created. You need to use the Geom Contact functions if you want to change the friction in real time... <i>dGeomContactSetMu(geom,mu)</i><br><br>There's a demo showing it in use half way up this thread ^ <br><br></td></tr></table><br>
<a name="906078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...Schön... :) <br><br></td></tr></table><br>
<a name="907278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R,<br><br>Once again, thank you very much for your latest update (1.28).<br>Excellent customer support as always.<br><br>cheers,<br><br>Mark <br><br></td></tr></table><br>
<a name="907413"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R, have been excercising my VB.net skills in conjunction with a front end for car Demo.  Dropped in 1.28 dll to the directory &amp; works a treat. Any thoughts you have with regard to extra buttons to auto configure stuff appreciated. Heres the post:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=80626" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=80626</a> <br><br></td></tr></table><br>
<a name="907451"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome Mark :)<br><br>@Blitzplotter: How about some buttons to change the mass / suspension / wheel friction of each car. You could use a list box to select the car, then three input boxes for the settings? <br><br></td></tr></table><br>
<a name="907653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >proud2bme</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Silly question. How do I get this update? It wasn't emailed to me. Thanks. <br><br></td></tr></table><br>
<a name="907709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> @VIP3R, could do... need to apply some more thought to the structure of my ini file, as I intend to write out to the ini file from VB.Net with whatever is populated, the B3D exe will read the ini file and run with whatever's passed. <br><br></td></tr></table><br>
<a name="907874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> @proud2bme: Your update email was sent to the address you used when purchasing JV-ODE, I've not received any error to indicate it failed. Check your spam filters if you're using one. Let me know the address I have is correct and I'll resend it for you. <br><br></td></tr></table><br>
<a name="908106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >proud2bme</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> All I see in my junk mail folder are emails about Viagra. The original email containing my JV-ODE purchase had no problems reaching my inbox. The address there is the same. <br><br></td></tr></table><br>
<a name="908133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've resent the update email for you. <br><br></td></tr></table><br>
<a name="908878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> I started looking into physics stuff for my game and started wondering how some shapes (like boxes or barrels) should be initialized? <br><br>TriMesh? If so... can you provide simple code for creating TriMesh barrel (I'm testing Demo-MultipleObjects, and would be nice to see how it could work with "barrel.3ds")<br><br>Or... box geoms? But then, is there any easy way to provide physics geom for the barrel mesh?<br><br>Thanks <br><br></td></tr></table><br>
<a name="908902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> TriMeshes should only really be used for static scenery, they're much slower than primitives (boxes, spheres and cylinders).<br><br>Any meshes can be used to represent any type of ODE object, just change the ode\mesh to whatever you want... <i>ode\mesh=LoadMesh("mesh.3ds")</i><br><br>To create a barrel with a custom mesh, you should create a cylinder ODE geom (ode\geom) and use the 'barrel.3ds' for the visible mesh (ode\mesh). <br><br></td></tr></table><br>
<a name="908985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >proud2bme</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry to say, I still haven't received my 1.28 update VIP3R. I sent you an email and I'm wondering why nothing you sent showed up. I did check my junk mail and, nothing there either. Thanks for any info. <br><br></td></tr></table><br>
<a name="909029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R, yes, I realize that any mesh can be used to represent... but how can I (relatively) easily make the cylinder ODE geom match the barrel mesh. If I just create cylinder, it doesn't mean that my 2 units wide, 1.73 units high barrel will be okay. And not to mention the other barrel that might have totally different values. <br><br>Is there any 'easy way' to match those primitives? I wonder if anybody has created an editor for this purpose? (If not, then I suppose I gotta do it :)) <br><br></td></tr></table><br>
<a name="909248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> @proud2bme: I haven't received any emails from you within the last 24 hours and I've still not received any errors to indicate your update email failed. Our email accounts are all running ok, I would advise you check whether your email account is working correctly. Let me know if you manage to get it working, or if you want to use a different address instead.<br><br>@Game Producer: I see, it wasn't clear that was the info you wanted. There are 3 sets of dimensions you need to think about... ODE Geoms, Blitz Meshes and Custom Meshes.<br><br>The default dimensions of Blitz meshes is 1 unit. The corresponding ODE geom size for a Blitz mesh with default dimensions is as follows...<br><br>Sphere<br>1.0 (Same as Blitz units)<br><br>Cube<br>0.5 (1/2 of Blitz units)<br><br>Cylinder<br>0.5 Length (1/2 of Blitz units)<br>1.0 Radius (Same as Blitz units)<br><br>For custom meshes like your barrel, it depends on the dimensions used when it was created. The dimensions of the ODE geom should match the mesh units. For example a barrel mesh with the dimensions of 3.0 units length and 1.0 units radius, would be setup like this... dCreateCylinder(Space,1.0,3.0)<br><br>If you alter the scale of the mesh in Blitz, you may need to do the same with the ODE geom dimensions. <br><br></td></tr></table><br>
<a name="909312"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> @VIP3R: Yes, thanks. Then exporting content pack art (which might have different starting positions, and "weird" units that are not possible to know in Blitz side, it would mean manually creating the corresponding ODE geoms). <br><br>Gotta start making an editor for that (shouldn't be too hard though :))<br><br>Thanks for the info!<br><br>---<br><br>Another question came to my mind: is there ready made example on how to get characters  (like human) moving with ASWD type of controls? (if the character is made of 'cylinder' for example (and perhaps a cube or something attached in the head :))<br><br>What about some sort of "waypoint system", is there examples for these type of controls?<br><br>---<br><br>Thanks again for great support (yeh, I'm a happy JV-ODE customer and have bugged you earlier :)) <br><br></td></tr></table><br>
<a name="909350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome :)<br><br>There isn't a character controller demo using capsules/cylinders, but there is something which uses a sphere in the same way...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; JV-ODE - Key Controlled Sphere Demo Using Angular Velocities
; Code by Jim Williams (VIP3R)
; Arrow key control by Jeff (PsychicParrot)

AppTitle "JV-ODE - Key Controlled sphere Demo"

Include "jv-ode.bb"

Graphics3D 800,600,0,2

Type ODEGeom

	Field body
	Field geom
	Field mesh
	Field pivot ; To find direction vectors
	Field head  ; Just a stupid head to show which direction it's going in!
	Field inair ; To tell if player is on the ground or not!!
	
End Type

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetGravity(World,0,-1,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.2)
dContactSetMu(38)

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000
PositionEntity Camera,0,20,-50
RotateEntity Camera,30,0,0

; ### Control vars

Global potato#=0 ; y rotation of thingy (rotater,rotato,potato!!)
Global spud#
Global fwd_key
Global back_key
Global left_key
Global right_key
Global jump_key

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0
EntityPickMode plane,2

Mirror=CreateMirror()

AddObject() ; Add our thingy to the world

While Not KeyHit(1)

	PTime=MilliSecs()

	; Update controls
	
	c.ODEGeom=First ODEGeom
	Getkeys(c)
	movethingy(c)
	lookforground(c)
	
	PointEntity (camera,c\mesh)
	
	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.14)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

Function getkeys(c.ODEGeom)

	fwd_key=False
	back_key=False
	left_key=False
	right_key=False
	jump_key=False

	If c\inair=False Then ; Only let player control 'thrust' when on the ground
	
		If KeyDown(200) Then fwd_key=True
		If KeyDown(208) Then back_key=True

	EndIf
	
		If KeyDown(205) Then left_key=True
		If KeyDown(203) Then right_key=True
		If KeyDown(57) Then jump_key=True

	;EndIf

End Function

Function lookforground(c.ODEGeom)

	If LinePick(EntityX(c\mesh,True),EntityY(c\mesh,True)+1,EntityZ(c\mesh,True),0,-4,0)&lt;&gt;0 Then ; Check for anything 'under' player
		c\inair=False
	  Else
		c\inair=True
	EndIf

End Function

Function movethingy(c.ODEGeom)

	If fwd_key=True Then
		spud=spud+.1
	EndIf

	If back_key=True Then
		spud=spud-.1
	EndIf
	
	If left_key=True Then
		potato=potato-2
	End If
	
	If right_key=True Then
		potato=potato+2
	End If

	If jump_key=True And c\inair=False Then		
		dBodyAddForce(c\body,0,16 ,0)		
	End If

	RotateEntity c\head,0,potato#,0
	
	; Add forward force

	TFormVector 0,0,spud,c\head,0
	
	vx# = dBodyGetAngularVelX(c\body) + TFormedX()
	vy# = dBodyGetAngularVelY(c\body) + TFormedY()
	vz# = dBodyGetAngularVelZ(c\body) + TFormedZ()

	damping#=.8
	dBodySetAngularVel(c\body,vx#*damping#,vy#*damping#,vz#*damping#)

	spud=spud*.9
	
End Function

Function AddObject()

xp=Rand(-8,8)
zp=Rand(-8,8)
ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
dBodySetRotation(ode\body,0,0,0)
dBodySetPosition(ode\body,xp,30,zp)
dBodySetAutoDisableFlag(ode\body,0)
ode\geom=dCreateSphere(Space,3)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateSphere()
ScaleMesh ode\mesh,3,3,3
EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
EntityAlpha ode\mesh,1
EntityShininess ode\mesh,0.7
ode\head=CreateCube()

ScaleMesh ode\head,1.5,1.5,1.5

ode\pivot=CreatePivot() ; Create pivot to get direction vectors

End Function


Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	
		RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
		
		PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
		
		PositionEntity ode\head,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom)+4.5,dGeomGetPositionZ#(ode\geom)
	
Next

End Function
</textarea><br><br>Waypoints are not directly related to physics engines, hence no examples. You'll find much more information about waypoint systems in the Blitz3D Programming forum. <br><br></td></tr></table><br>
<a name="912362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, thanks. <br><br>I've looked more into this and found some suggestion where 'capsule' should be staying on top of a ray. <br><br>I'm looking into this example (http://www.enchantedage.com/sites/default/files/raycar/index.html) but any ideas on how to keep the capsule on top of ray would be gladly taken :) <br><br></td></tr></table><br>
<a name="912376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've don't have any experience with it tbh, never understood why people would use a capsule over a sphere-composite object. An upright capsule would drag across a surface, exactly the opposite of what a physics engine is designed to do with it.<br><br>Anyway, there's more info here...<br><a href="http://opende.sourceforge.net/mediawiki-1.6.10/index.php/HOWTO_upright_capsule" target="_blank">http://opende.sourceforge.net/mediawiki-1.6.10/index.php/HOWTO_upright_capsule</a><br><br>Good luck ;) <br><br></td></tr></table><br>
<a name="912395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> sphere is "fat"... you want to have a taller guy and be able to hit the body (not just the low part) (check hit location using ray, or throw stuff towards the guy). I haven't seen many characters that resemble spheres :D<br><br>with 'ray' you are able to create jumping/crouching too. <br><br>not sure what you mean by "upright capsule would drag"... since I believe this is how people are doing character movement in games :) <br><br>thanks for the link<br><br>p.s. did you check out that ray demo link...? <br><br></td></tr></table><br>
<a name="912410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, getting there...<br><br>Based on information here (http://www.ode.org/old_list_archives/2006-June/019114.html) I started tweaking the 'ball control' code and added stuff like here:<br><pre class=code>
	dBodySetRotation(c\body,0, 0, 0)
	dBodySetAngularVel(c\body,0, 0, 0)
	dBodySetTorque (c\body,0, 0, 0)

	;xforce# = leftforce-rightforce
	;zforce# = forwardforce-backforce

	dBodyAddForce(c\body, xforce#, 0, zforce# )
</pre><br><br>This works pretty good for moving FORWARD + RIGHT, but for some reason when I try to move down or left, it always moves 'southwest'. I haven't used ray nor spring yet, but will try that stuff at some point.<br><br>Here's the full code (any help regarding the odd behavior for down/left movement gladly taken):<br><br>(EDIT: see below for newer code...) <br><br></td></tr></table><br>
<a name="912432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated the code a bit...<br><br>(EDIT: see below for newer code...)<br><br>Also found this:<br><a href="http://www.ogre3d.org/wiki/index.php/OgreOde_Walking_Character" target="_blank">http://www.ogre3d.org/wiki/index.php/OgreOde_Walking_Character</a><br>(seemed quite interesting approach) <br><br></td></tr></table><br>
<a name="912435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> And now it works! :)'<br>(still need some work, but at least it's decent!)<br><br>The capsule demo:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; JV-ODE - Key Controlled Sphere Demo Using Angular Velocities
; Code by Jim Williams (VIP3R)
; Arrow key control by Jeff (PsychicParrot)
; Character control by Juuso (www.GameProducer.net)

AppTitle "JV-ODE - Key Controlled capsule Demo"

Include "jv-ode.bb"

Graphics3D 800,600,0,2

SeedRnd(MilliSecs())

Type ODEGeom

	Field body
	Field geom
	Field mesh
	Field pivot ; To find direction vectors
	Field head  ; Just a stupid head to show which direction it's going in!
	Field inair ; To tell if player is on the ground or not!!
	
End Type

; ### Setup ODE

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetGravity(World,0,-1,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.1)
dContactSetMu(10)

; ### Create light

Global Light=CreateLight()

RotateEntity Light,45,-90,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create camera

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000
PositionEntity Camera,0,20,-50
RotateEntity Camera,30,0,0

; ### Control vars

Global potato#=0 ; y rotation of thingy (rotater,rotato,potato!!)
Global spud#
Global fwd_key
Global back_key
Global left_key
Global right_key
Global jump_key

; ### Create plane

dCreatePlane(Space,0,1,0,0)

Plane=CreatePlane()

EntityAlpha Plane,0.8

PlaneTexture=CreateTexture(128,128,9)

ClsColor 0,200,80
Cls

Color 255,255,255

Rect 0,0,64,64,1
Rect 64,64,64,64,1

CopyRect 0,0,128,128,0,0,BackBuffer(),TextureBuffer(PlaneTexture)
ScaleTexture PlaneTexture,20,20
EntityTexture Plane,PlaneTexture,0,0
EntityPickMode plane,2
EntityAlpha plane, .7

;Mirror=CreateMirror()

AddObject() ; Add our thingy to the world

For i=1 To 10
	AddObject()
Next


While Not KeyHit(1)

	PTime=MilliSecs()

	; Update controls
	
	c.ODEGeom=First ODEGeom
	Getkeys(c)
	movethingy(c)
	lookforground(c)
	
	
	;PositionEntity camera, c\mesh)
	
	UpdateGeoms()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.14)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateWorld

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime

	Flip

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

Function getkeys(c.ODEGeom)

	fwd_key=False
	back_key=False
	left_key=False
	right_key=False
	jump_key=False

	If c\inair=False Then ; Only let player control 'thrust' when on the ground
	
		If KeyDown(200) Then fwd_key=True
		If KeyDown(208) Then back_key=True

	EndIf
	
		If KeyDown(205) Then left_key=True
		If KeyDown(203) Then right_key=True
		If KeyDown(57) Then jump_key=True

	;EndIf

End Function

Function lookforground(c.ODEGeom)

	If LinePick(EntityX(c\mesh,True),EntityY(c\mesh,True)+1,EntityZ(c\mesh,True),0,-4,0)&lt;&gt;0 Then ; Check for anything 'under' player
		c\inair=False
	  Else
		c\inair=True
	EndIf

End Function

Global counter
Function movethingy(c.ODEGeom)

	speed = 2
	If fwd_key=True Then
		zforce# = speed 
	EndIf

	If back_key=True Then
		zforce# = -speed 
	EndIf
	
	If left_key=True Then
		xforce# = speed 
	End If
	
	If right_key=True Then
		xforce# = -speed 

	End If


	dBodySetAngularVel(c\body,0, 0, 0)
	dBodySetTorque (c\body,0, 0, 0)
	dBodySetRotation(c\body,90, 0, 0)

	
	;xforce# = leftforce-rightforce
	;zforce# = forwardforce-backforce

	dBodySetPosition(c\body, dGeomGetPositionX#(c\geom), 2.9 ,dGeomGetPositionZ#(c\geom) )

	dBodyAddForce(c\body, Int(xforce#), 0, Int(zforce#) )

	;DebugLog "get force:"+dBodyGetForce(c\body)
		

	If jump_key=True And c\inair=False Then		
		xforce = 10 * (Rnd(-1, 1))
		zforce = 10 * (Rnd(-1, 1))
		
		dBodyAddForce(c\body, 0 , 10 , 0 )		
	End If
	
End Function

Function AddObject()

xp=Rand(-8,8)
zp=Rand(-8,8)
ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
dBodySetRotation(ode\body,90,0,0)
dBodySetPosition(ode\body,xp,0,zp)
dBodySetAutoDisableFlag(ode\body,0)
;ode\geom=dCreateSphere(Space,3)
;ode\geom=dCreateBox(Space, 2, 6, 2)
ode\geom=dCreateCapsule(space,1,8)

dGeomContactSetBounce(ode\geom, 1.000)



dGeomSetBody(ode\geom,ode\body)
;ode\mesh=CreateSphere()
;ode\mesh=CreateCube()
ode\mesh=CreateCylinder()
ScaleMesh ode\mesh,1,5,1
RotateMesh ode\mesh,90,0,0	; ### Align Blitz3D Cylinder To ODE Capsule

;RotateMesh ode\mesh,90,0,0

EntityColor ode\mesh,Rand(255),Rand(255),Rand(255)
EntityAlpha ode\mesh,1
EntityShininess ode\mesh,0.7
ode\head=CreateCube()


mass=dMassCreate()
;dMassSetBoxTotal(mass, 2, 1,1,1)
;dBodySetMass(ode\body,mass)


ScaleMesh ode\head,1.5,1.5,1.5

ode\pivot=CreatePivot() ; Create pivot to get direction vectors


PointEntity (camera,ode\mesh)

End Function


Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	
		RotateEntity ode\mesh,dGeomGetPitch#(ode\geom),dGeomGetYaw#(ode\geom),dGeomGetRoll#(ode\geom)
		
		PositionEntity ode\mesh,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom),dGeomGetPositionZ#(ode\geom)
		
		PositionEntity ode\head,dGeomGetPositionX#(ode\geom),dGeomGetPositionY#(ode\geom)+14.5,dGeomGetPositionZ#(ode\geom)
	
Next

End Function</textarea><br><br>Sorry for quadruple posting - stopping now;) <br><br></td></tr></table><br>
<a name="912612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> I said a sphere-<b>composite</b>, for example a small sphere at the feet and another object to represent the body. Not a sphere to represent the entire character :)<br><br>Glad to see you have it working now though, it might be a good idea to remove the earlier code posts and leave only the working version. <br><br></td></tr></table><br>
<a name="912646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, sorry. Hasty reading from my part :)<br><br>Anyway, looks like the capsule thing works pretty neatly (removed older code). Will still look on how to do the ray-thing in the feet (since it should work better with stuff like stairs (compared to ball at the feet)<br><br>Thanks VIP3R for such quick comments &amp; good support. <br><br></td></tr></table><br>
<a name="912656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome :)<br><br>Thanks for updating your posts. I would imagine you extend the rays from the base of the capsule towards the floor, then when the ray penetrates the floor, you raise the capsule until it's no longer penetrating. It should work ok for stairs as long as the rays are long enough. <br><br></td></tr></table><br>
<a name="912685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aye, thanks again. I'll see if I manage to do that next... <br><br></td></tr></table><br>
<a name="912702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> Question about rays:<br>dGeomRaySet(ray,px#,py#,pz#, dx#,dy#,dz#)<br><br>Ogre docs said:<br><pre class=code>Ogre::Vector3 diff = dest - pos;
diff.normalise();
dGeomRaySet(mRay, pos.x, pos.y, pos.z, diff.x, diff.y, diff.z);
</pre><br><br>How do you find out which values there should be for dx, dy, and dz? I'm using the following:<br><pre class=code>px# = EntityX(gun)
py# = EntityY(gun)
pz# = EntityZ(gun)

dx# = EntityX(pivot)-EntityX(gun)
dy# = EntityY(pivot)-EntityY(gun)
dz# = EntityZ(pivot)-EntityZ(gun)

dGeomRaySet(RayGeom, px#, py#, pz#, dx#, dy#, dz# )</pre><br><br>EDIT: Managed to get this working.  Sweet! :)<br><br>Here's the "shoot the ground (or that box)" code.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; ; ###################################################################################################
; #                                     JV-ODE - Ray Pick Demo                                      #
; #                                  Code by Jim Williams (VIP3R)                                   #
; #                              Devious Codeworks - Copyright © 2008                               #
; ###################################################################################################

Include "JV-ODE.bb"

AppTitle "JV-ODE - Ray Pick Demo"

Graphics3D 800,600,0,2

Global RayGeom
Global RayCollision=0

Type ODEGeom
	Field body
	Field geom
	Field mesh
	
	Field name$
End Type

; ###################################################################################################

; ### Setup ODE

dInitODE()

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.01)
dContactSetMu(48)

; ### Create Light

Global Light=CreateLight()
RotateEntity Light,50,-50,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create Camera

Global Camera=CreateCamera()
CameraClsColor Camera,0,0,0
CameraRange Camera,.1,1000
PositionEntity Camera,0,30,-40

;PositionEntity Camera,2,15,-30


RotateEntity Camera,50,0,0

Global gun = CreateCube()
EntityColor gun, 0, 0 ,200
;EntityAlpha gun, 0.5



; ### Create Plane

dCreatePlane(Space,0,1,0,0)

Global Plane=CreatePlane()
EntityAlpha Plane,0.8

EntityTexture Plane,PlaneTexture()

EntityPickMode plane, 2
Global pivot = CreateSphere()
ScaleEntity pivot, .3, .3, .3

;PositionEntity pivot,2,5,-30
PointEntity Camera, pivot

;CreateMirror()

; ### Create Cylinder

Global Cylinder=CreateCylinder()
ScaleMesh Cylinder,0.2,3,0.2
PositionEntity Cylinder,0,3,-5
RotateEntity Cylinder,90,0,0
EntityColor Cylinder,230,0,0
EntityShininess Cylinder,0.7

; ###################################################################################################

AddObject()



While Not KeyHit(1)

	pick = CameraPick(camera, MouseX(), MouseY())
	PositionEntity(pivot, PickedX(), PickedY()+1, PickedZ())
	

	If (KeyHit(57) )
		
		
		DebugLog "pressed space"
	EndIf
	


	UpdateGeoms()

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 0,70,"Cylinder = Ray Geom Position"
	Text 0,95,"Green = Collision"
	Text 0,110,"Red = No Collision"

	AddRay()

	Flip 1

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function AddObject()

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
dBodySetPosition(ode\body,0,20,0)
dBodySetRotation(ode\body,0,20,20)
dBodySetAutoDisableFlag(ode\body,1)
;ode\geom=dCreateSphere(Space,3)
ode\geom=dCreateBox(Space, 6, 6, 6)

dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,3,3,3
EntityColor ode\mesh,100,100,255
EntityShininess ode\mesh,0.7
EntityAlpha ode\mesh,0.8

ode\name$ = "target..."

End Function

; ###################################################################################################

Function AddRay()

RayGeom=dCreateRay(Space,300)
;dGeomRaySet(RayGeom,0,3,-5, 0,0,10)
PositionEntity gun, 2, 5, -10
PositionEntity gun, EntityX(camera), EntityY(camera), EntityZ(camera)



PointEntity gun, pivot

;dGeomRaySet(RayGeom, EntityX(gun), EntityY(gun), EntityZ(gun), EntityPitch(pivot), EntityYaw(pivot), EntityRoll(pivot))
px# = EntityX(gun)
py# = EntityY(gun)
pz# = EntityZ(gun)

dx# = EntityX(pivot)-EntityX(gun)
dy# = EntityY(pivot)-EntityY(gun)
dz# = EntityZ(pivot)-EntityZ(gun)

dGeomRaySet(RayGeom, px#, py#, pz#, dx#, dy#, dz# )



; ### Perform Ray Collision Check
dSpaceCollide(Space,World,ContactGroup)
count1=dGeom1CountCollisions(RayGeom)
count2=dGeom2CountCollisions(RayGeom)
RayCollision=count1+count2
dJointGroupEmpty(ContactGroup)

ms = MilliSecs()

mousehit1 = MouseHit(1)

For i=1 To count1
;loop collission count
	CollisionGeom1=dGeom1CollisionGeom(RayGeom,i)
	;DebugLog "collided1 with:"+CollisionGeom1
	For ode.ODEGeom=Each ODEGeom
		If (ode\geom = CollisionGeom1 )
			;DebugLog "ode name:"+ode\name$
		EndIf
	Next

	cx# = dGeom1CollisionX(RayGeom,i)
	cy# = dGeom1CollisionY(RayGeom,i)
	cz# = dGeom1CollisionZ(RayGeom,i)
		
	If (mousehit1)
		temp = CreateSphere()
		EntityColor temp, 200, 100, 200
		size# = .3
		ScaleEntity temp, size#, size#, size#
	;	EntityAlpha temp, .1
		PositionEntity temp, cx, cy, cz#
		
		c.ODEGeom = First ODEGeom
		EntityParent temp, c\mesh
		
		DebugLog "created thingy"
	EndIf
Next


For i=1 To count2
;loop collission count
	CollisionGeom2=dGeom2CollisionGeom(RayGeom,i)
	;DebugLog "collided1 with:"+CollisionGeom2
	For ode.ODEGeom=Each ODEGeom
		If (ode\geom = CollisionGeom2 )
			;DebugLog "ode name:"+ode\name$
		EndIf
	Next
	
	cx# = dGeom2CollisionX(RayGeom,i)
	cy# = dGeom2CollisionY(RayGeom,i)
	cz# = dGeom2CollisionZ(RayGeom,i)

	If (mousehit1)
		temp = CreateSphere()
		EntityColor temp, 200, 100, 200
		size# = .3
		ScaleEntity temp, size#, size#, size#
	;	EntityAlpha temp, .1
		PositionEntity temp, cx, cy, cz#
		
		c.ODEGeom = First ODEGeom
		EntityParent temp, c\mesh
		
		DebugLog "created thingy"
	EndIf

Next



If RayCollision&gt;0 

	EntityColor Cylinder,0,200,100
	Else
	EntityColor Cylinder,200,0,100
	End If

;DebugLog RayCollision+" --- "+ dx+", "+dy+", "+dz

dGeomDestroy(RayGeom)

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	PositionEntity ode\mesh,dGeomGetPositionX(ode\geom),dGeomGetPositionY(ode\geom),dGeomGetPositionZ(ode\geom)
	RotateEntity ode\mesh,dGeomGetPitch(ode\geom),dGeomGetYaw(ode\geom),dGeomGetRoll(ode\geom)
Next

End Function

; ###################################################################################################</textarea> <br><br></td></tr></table><br>
<a name="912750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, another tiny problem: is there a fast way to check the FIRST collidedGeom when you create a ray? (I realize I can loop everything, but it seems bit silly to first loop collided1 and collided2 and then compare distances to find out the first one)<br><br>This is so that I can shoot something... and the bullet will stop in the wall, and not also hit the guy behind the wall :) <br><br></td></tr></table><br>
<a name="912906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, have you listed the collision geoms to see how they are indexed. Depending on the types of space used, they may already be indexed in a certain order. I'm sure they're indexed based on their size in hash spaces.<br><br>You can also try using <i>dSpaceCollide2(geom1,geom2,world,group)</i> to check collisions between two specific geoms (or spaces). <br><br></td></tr></table><br>
<a name="912968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, thanks. I suppose I'll just go through the index. Doesn't require much time anyway so I think it's fine.<br><br>One more newb question about rays:<br>- should I do call dSpaceCollide(Space,World,ContactGroup) every time I create a ray?<br>- or... can I simply first create X number of rays, and after those are created call the dSpaceCollide (and then after that - delete all rays) <br><br></td></tr></table><br>
<a name="912972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can create X number of rays and call dSpaceCollide() once to generate the collision information, then delete them. <br><br></td></tr></table><br>
<a name="912998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's what I thought :) Thanks again! <br><br></td></tr></table><br>
<a name="913335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been working on "save/load" functionality, and currently I'm using the following code<br>First I'm disabling all geoms/bodies (looping every single 'ode' object):<br><pre class=code>	For n.netobject = Each netobject
		n\lastUpdateTime = 0
		If (n\physics &lt;&gt; Null)
			If (n\physics\geom)
				dGeomDisable(n\physics\geom)
			EndIf
			If (n\physics\body)
				dBodyDisable(n\physics\body)
			EndIf
		EndIf
	Next</pre><br><br>After this, I position/rotate objects all objects:<br><pre class=code>
	If (mover\physics\body)
		dBodySetAngularVel(mover\physics\body,0, 0, 0)
		dBodySetTorque (mover\physics\body,0, 0, 0)
		dBodySetPosition(mover\physics\body, x#, y#, z#)
               dBodySetRotation(physicsInstance\body, rotation_x#, rotation_y#, rotation_z# )	

	EndIf
</pre><br>And after positioning, I enable all objects:<br><pre class=code>	For n.netobject = Each netobject
		n\lastUpdateTime = 0
		If (n\physics &lt;&gt; Null)
			If (n\physics\geom)
				dGeomEnable(n\physics\geom)
			EndIf
			If (n\physics\body)
				dBodyEnable(n\physics\body)
			EndIf
		EndIf
	Next</pre><br><br>This seems to work fine, and all the objects are snapped to the proper locations when user clicks load. If you move your character, and click 'load' everything goes to proper locations again.<br><br>There's just one tiny bug: if I've pushed a barrel object (for example), and click 'load' I can see that the barrel goes to the proper location &amp; has the right rotation - but the barrel is still MOVING in this new snapped location. I suppose barrel is having some sort of force applied to it, and continues updating after getting snapped to the position.<br><br>Any ideas what I'm doing wrong... or how this should be done correctly? <br><br></td></tr></table><br>
<a name="913380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're missing these two functions in your position/rotation code...<br><br><i>dBodySetLinearVel(body,0,0,0)<br>dBodySetForce(body,0,0,0)</i><br><br>Let me know if that doesn't help. <br><br></td></tr></table><br>
<a name="913542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi VIP3R, have got the front end varying the amount of cars in the world, along with objects and the concentration of capsules and spheres.  I am going to invoke/ reinvoke an FPS counter.  Can you please help with the following:-  How can I superimpose a car's number onto the top and bottom of the cube - I am going to make 100/200 images (dependant on my max car count) with my numbers on then apply the numbered image within my car creation function using my loop count to the 'top' and the 'bottom' of the car.<br><br>In order to maintain a dead car count do this I want to perform a check on whether the 'top' of the car is touching the 'world' or not, then increment a dead car count - is there a more efficient way to do this, if not could you please show me an example of how to perform is top of cube touching world check - I will be setting a flag in a global array that will ensure once the check is confirmed the car will not be checked a second time.....<br><br>Regards, BP. <br><br></td></tr></table><br>
<a name="913743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to look at texturing the cubes with the car numbers. Only 10 number images are needed (0-9), you can then create the textures with any number. These types of question are not physics related, you would be better off asking them in the Blitz3D Programming forum tbh.<br><br>Regarding the dead car count, it's easier to detect the 'Roll' angle of the car body to see if it's upside-down or not. Use a counter to make sure it has been upside-down for a few seconds then increase the dead car count. If you want to use collisions instead, look at the CarDemo-DetailedC demo to see how collision information is obtained. <br><br></td></tr></table><br>
<a name="913779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks VIP3R (;-), managed to create two meshes at this post:-<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=81131#914022" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=81131#914022</a><br><br>Now just gotta correlate it to somehow blending in two pngs....  I'm considering trying to see my car bodies in wireframe to help me apprecaite if there is the necessary meshes created along the lines of the following code:<br><br>ode\geom=dCreateBox(Space,3,1,4)   ;  I think this line intelligently makes all the quads to make a cube, whereas the assistance I'm receiving is along the lines of building a 'entity' from the most basic commands:-<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

;create new mesh(s)
mesh = CreateMesh()
mesh2 = CreateMesh()
;create surface(s)
surf = CreateSurface(mesh)
surf2 = CreateSurface(mesh2)

;create 4 vertices
v0 = AddVertex(surf,  1,  1, 0, 1.0, 1.0)
v1 = AddVertex(surf,  1, -1, 0, 1.0, 0.0)
v2 = AddVertex(surf, -1, -1, 0, 0.0, 0.0)
v3 = AddVertex(surf, -1,  1, 0, 0.0, 1.0)
;create another 4 vertices
v4 = AddVertex(surf2,  3,  1, 0, 1.0, 1.0)
v5 = AddVertex(surf2,  3, -1, 0, 1.0, 0.0)
v6 = AddVertex(surf2, 1, -1, 0, 0.0, 0.0)
v7 = AddVertex(surf2, 1,  1, 0, 0.0, 1.0)

;create 2 triangles
AddTriangle surf, v0, v1, v2
AddTriangle surf, v2, v3, v0
;create 2 more triangles
AddTriangle surf2, v4, v5, v6
AddTriangle surf2, v6, v7, v4

;create camera
cam = CreateCamera()
MoveEntity cam, 0, 0, -5

;main loop
Repeat

	;w = wireframe
	WireFrame KeyDown(17)
	RenderWorld
	
	Text 0, 0, "w = wireframe"
	Flip

;esc = exit	
Until KeyHit(1)

End

</textarea><br><br>Somehow I need to maybe extract the information from createbox to pick out the individual sides of the entity.... I'm not sure how yet. <br><br></td></tr></table><br>
<a name="914142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You're missing these two functions in your position/rotation code...<br><br>dBodySetLinearVel(body,0,0,0)<br>dBodySetForce(body,0,0,0)<br><br>Let me know if that doesn't help.  <br></div><br>Excellent, seemed to do the trick! <br><br></td></tr></table><br>
<a name="914165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>JV-ODE V1.32 Update Released</b><br><br>Please check your inbox :)<br><br>JV-ODE is now compiled using ODE V0.10.1 which includes several additions, fixes and tweaks. You can view the ODE changelog for specific details <a href="http://opende.sourceforge.net/mediawiki-1.6.10/index.php/Changelog#Changes_for_0.10" target="_blank">here</a> and <a href="http://opende.sourceforge.net/mediawiki-1.6.10/index.php/Changelog#Changes_for_0.10.1" target="_blank">here</a>.<br><br><b>Important Notes:</b><br>JV-ODE V1.32 immediately follows V1.28, there were no versions released in between them. The version number has increased by 4 because there were 4 major changes made to JV-ODE for this update, two new ODE core updates (V0.10 and V0.10.1) and a wrapper update for each core. The ODE core V0.10 was broken, therefore the core was replaced with the new V0.10.1 bugfix release.<br><br>The ODE core has been compiled using the new TriMesh&gt;TriMesh collider to give improved results.<br><br>As previously warned, you <b>must</b> initialize this version of ODE by calling <i>dInitODE()</i> before <i>dWorldCreate()</i>. It is now mandatory and failure to do so will result in an error.<br><br>The <i>dGeomTriMeshDataBuildSimple()</i> function is not as stable as it was in previous releases, causing faulty collision contacts to be generated. To avoid the problem, the JV-ODE TriMesh creation functions have been modified to use <i>dGeomTriMeshDataBuildSingle()</i> instead, which also has the added benefit of a smaller memory footprint. If you have built your own 'CreateTriMesh()' functions, it is highly recommended you change over to use <i>dGeomTriMeshDataBuildSingle()</i> too, you can use the built-in functions as a guide.<br><br>The new update includes built-in damping, 'sweep and prune' collision spaces, prismatic-universal &amp; piston joints and multiple thread support (untested).<br><br>Added new functions:<br><i>dInitODE2(initflags)<br>dAllocateODEDataForThread%(allocateflags)<br>dCleanupODEAllDataForThread()<br>dWorldGetLinearDamping#(world)<br>dWorldGetAngularDamping#(world)<br>dWorldSetLinearDamping(world,scale#)<br>dWorldSetAngularDamping(world,scale#)<br>dWorldSetDamping(world,linear_scale#,angular_scale#)<br>dWorldGetLinearDampingThreshold#(world)<br>dWorldGetAngularDampingThreshold#(world)<br>dWorldSetLinearDampingThreshold(world,threshold#)<br>dWorldSetAngularDampingThreshold(world,threshold#)<br>dWorldGetMaxAngularSpeed#(world)<br>dWorldSetMaxAngularSpeed(world,max_speed#)<br>dSpaceSetSublevel(space,sublevel)<br>dSpaceGetSublevel%(space)<br>dSpaceGetClass%(space)<br>dSweepAndPruneSpaceCreate%(space,axisorder)<br>dBodyGetLinearDamping#(body)<br>dBodyGetAngularDamping#(body)<br>dBodySetLinearDamping(body,scale#)<br>dBodySetAngularDamping(body,scale#)<br>dBodySetDamping(body,linear_scale#,angular_scale#)<br>dBodyGetLinearDampingThreshold#(body)<br>dBodyGetAngularDampingThreshold#(body)<br>dBodySetLinearDampingThreshold(body,threshold#)<br>dBodySetAngularDampingThreshold(body,threshold#)<br>dBodySetDampingDefaults(body)<br>dBodyGetMaxAngularSpeed#(body)<br>dBodySetMaxAngularSpeed(body,max_speed#)<br>dBodyGetFirstGeom%(body)<br>dBodyGetNextGeom%(geom)<br>dJointSetHingeAxisOffset(joint,x#,y#,z#,angle#)<br>dJointGetNumBodies%(joint)<br>dJointCreatePU%(world,group)<br>dJointSetPUAnchor(joint,x#,y#,z#)<br>dJointSetPUAnchorDelta(joint,x#,y#,z#,dx#,dy#,dz#)<br>dJointSetPUAxis1(joint,x#,y#,z#)<br>dJointSetPUAxis2(joint,x#,y#,z#)<br>dJointSetPUAxis3(joint,x#,y#,z#)<br>dJointSetPUAxisP(joint,x#,y#,z#)<br>dJointSetPUParam(joint,parameter,value#)<br>dJointGetPUPosition#(joint)<br>dJointGetPUPositionRate#(joint)<br>dJointGetPUAnchor(joint)<br>dJointGetPUAxis1(joint)<br>dJointGetPUAxis2(joint)<br>dJointGetPUAxis3(joint)<br>dJointGetPUAxisP(joint)<br>dJointGetPUAngles(joint)<br>dJointGetPUAngle1#(joint)<br>dJointGetPUAngle2#(joint)<br>dJointGetPUAngle1Rate#(joint)<br>dJointGetPUAngle2Rate#(joint)<br>dJointGetPUParam#(joint,parameter)<br>dJointCreatePiston%(world,group)<br>dJointSetPistonAnchor(joint,x#,y#,z#)<br>dJointSetPistonAnchorOffset(joint,x#,y#,z#,dx#,dy#,dz#)<br>dJointSetPistonAxis(joint,x#,y#,z#)<br>dJointSetPistonParam(joint,parameter,value#)<br>dJointGetPistonAnchor(joint)<br>dJointGetPistonAnchor2(joint)<br>dJointGetPistonAxis(joint)<br>dJointGetPistonPosition#(joint)<br>dJointGetPistonPositionRate#(joint)<br>dJointGetPistonAngle#(joint)<br>dJointGetPistonAngleRate#(joint)<br>dJointAddPistonForce(joint,force#)<br>dJointGetPistonParam#(joint,parameter)</i><br><br>Please let me know if you experience any problems with the new update.<br><br>:) <br><br></td></tr></table><br>
<a name="914233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gameproducer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice, thanks for the info! <br><br></td></tr></table><br>
<a name="915954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KimoTech</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was just wondering, how can you staticly link the ODE engine to your DLL, and then sell the product? Isn't that in conflict with the GPL license? <br><br></td></tr></table><br>
<a name="915966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> no. ode doesnt use gpl... <br><br></td></tr></table><br>
<a name="916074"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Game Producer: No problem ;)<br><br>JV-ODE uses the ODE <b>BSD license</b>, not the LGPL license. <br><br></td></tr></table><br>
<a name="916764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> Am I doing something obviously wrong here, I can't seem to create a box the same size as my mesh as far as the physics world is concerned, is it a problem the 'width' of my mesh is zero upon loading ?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

xstart=16
ystart=5
zstart=1

xsz = 5
hsz = 4
dsz = 5

For bricks=1 To 20

	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetRotation(ode\body,0,0,0)
	dBodySetPosition(ode\body,(bricks*xstart),ystart,zstart)
	
	Smass=dMassCreate()
	dMassSetBoxTotal(Smass,CapsuleMass,xsz,hsz,dsz) ; not sure hat s direction of 1 means
	dBodySetMass(ode\body,Smass)
	dMassDestroy(Smass)
	
	ode\geom=dCreateBox(Space,2*xsz,2*hsz,2*dsz)  ;  Box has to be twice size of mesh ??	

	dGeomSetBody(ode\geom,ode\body)

	ode\mesh=LoadMesh("8_pt_for_u3d_spike.b3d")
		
	deep=MeshDepth(ode\mesh)   ; upon load the depth of my mesh is 2
	tall=MeshHeight(ode\mesh)  ; upon load the height of my mesh is 1
	width=MeshWidth(ode\mesh)  ; upon load the width of my mesh is 0?

	FitMesh ode\mesh,width,tall,deep,xsz,hsz,dsz,0
	ScaleMesh ode\mesh,0.5,0.5,0.5
	RotateMesh ode\mesh,0,0,0

	EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)
	EntityAlpha ode\mesh,1
	EntityShininess ode\mesh,0.7

Next

</textarea> <br><br></td></tr></table><br>
<a name="916905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sph!nx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is probably a little stupid but I read on the news page JV-Ode has a new version.<br><br>I recently bought it but I cannot find a update link or something. To get it up-to-date again, do I need to buy it again?<br><br><br>Thanks! <br><br></td></tr></table><br>
<a name="917059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Blitzplotter: The first three parameters of FitMesh() are positions not dimensions. You don't need to use it anyway though, use ScaleMesh() only instead. If the width equals zero then yes it will cause a problem. You will need to return floats with MeshWidth() etc, not integers. If the width is less than 1.0 then it will return an integer of zero. Return floats instead like this...<br><pre class=code>
deep#=MeshDepth(ode\mesh)
tall#=MeshHeight(ode\mesh)
width#=MeshWidth(ode\mesh)

ScaleMesh ode\mesh,width*0.5,tall*0.5,deep*0.5
</pre><br>@Sph!nx: No, each update is free. I send out emails to all users with the new download link to the email address they registered when purchasing JV-ODE.<br><br>If you haven't received the update email and are still using the registered email address, double check it hasn't been filtered as spam.<br><br>If your registered email address is no longer used and gives errors when sending emails, it will be removed from the updates list after two failures in succession.<br><br>If you need to update your registered email address or are still unable to find the update email, send me an email with details of your original purchase and I will update it and send a new download link for you. <br><br></td></tr></table><br>
<a name="917063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the clarification VIP3R.  I am returning floats now instead of ints, should stop my lego bricks wobbling on the 0 width!  <br><br>That is a great help, once I resolve this I'll be trying out 1.32 cheers! <br><br></td></tr></table><br>
<a name="917090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sph!nx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks VIP3R!<br><br>I found this e-mail in your profile: ......., I assume it is ......, just checking, cause I intend to send you my initial purchase e-mail so its kinda confidential and I don't want it to end up somewhere else...<br><br><br><b>Edit :</b><br><br>Removed email by request. Thanks again VIP3R! <br><br></td></tr></table><br>
<a name="917115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, that's correct. <br><br></td></tr></table><br>
<a name="917580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sph!nx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I will foreward the e-mail I recieved when purchasing your library. Only proof I have I guess.<br><br><br><b>Edit :</b> Send the e-mail! :) <br><br></td></tr></table><br>
<a name="917590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, you didn't receive an update email because you already have the latest version (V1.32) which was released a few days before your purchase.<br><br>You will receive an email notifying you when future updates become available. <br><br></td></tr></table><br>
<a name="917613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sph!nx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops ... Sorry, I should have checked...<br><br><br>Thanks anyway! <br><br></td></tr></table><br>
<a name="917854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome and thanks for the edit. <br><br></td></tr></table><br>
<a name="920600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R,<br><br>I know Ive asked you about this before, but I can't seem to find my notes so apologies if Im covering old ground.<br><br>Essentially i have been working on a new vehicle based game and have become confused with the ODE / JV-ODE friction settings and i want to get a proper handle on how JV-ODE works, as i think i've misunderstood previously.<br><br>Ideally i want to create a friction model for a wheel that when loaded sideways i.e. when cornering, loses grip progressively and slowly, rather than a sudden 'got grip now / no grip now' type of curve.<br><br><img src="http://www.wildebeestgames.com/friction/case1.jpg"><br><br>Part 1. Out of the box (See case one on diagram)<br> <br>If i have understood the ode manual correctly (!)......<br><br>-When a wheel creates a contact joint with the floor the contact normal is perpendicular to the surface.<br><br>-The FDir1 and FDir2 vectors are calculated as being perpendicular to the contact normal and to each other.<br><br>-Since the FDir1 direction has not been specified, the vector can be at any rotation to the contact normal, as long as it is perpendicular to it.<br><br>In laymans terms (i.e. my simpletons approach!) this means that FDir1 can face in any direction, and will alomost certainly not align itself with the direction the wheel is pointing. This means that the wheels behaviour when it comes to gentle progressive sideways sliding is impossible to set-up (using slip1 / slip2 and mu and mu2, etc).<br><br>Hopefully i'm right so far ....<br><br><img src="http://www.wildebeestgames.com/friction/case2.jpg"><br><br>Part 2. Setting FDir1 and why i am confused (See case two on diagram)<br><br>If i have read the ODE manual correctly (a big 'if') you can set the FDir1 direction and so align it to the direction the wheel is facing.<br><br>The FDir1 vector is still perpendicular to the contact normal with the ground, but now it is rotated to suit our purposes.<br><br>This means you can set mu and mu2 and slip1 and slip2 to give the required tyre characteristics on different surfaces and at different speeds because ODE knows which way the wheel is facing.<br><br>In theory this should enable you to create a wheel that progressivly loses grip sideways as its rotational speed increases.<br><br><br>This is where i get confused - in the JV-ODE car demo the FDir1 direction is set, at the start, but then remains unaltered in the main program loop.<br>Shouldn't this direction be updated each loop to reflect the wheels orientation or am i missing something ?<br><br>I have tried to do this myself, by respecifying the FDir1 direction as the car / wheel moves during the game, but this doesn't seem to have any effect.<br><br>Also, the slip1 and slip2 values are supposed (according to the ODE manual) to be varied depending on the wheels speed, but when i set these values in my program only the first values i pass to ODE are used, any subsequent values i pass seem to be ignored.<br><br>Many thanks for taking the time to read this :- when you get a moment let me know what you think.<br><br>kind regards<br><br>Mark Judd <br><br></td></tr></table><br>
<a name="920710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> You've got the concept correct ;)<br><br>The misunderstanding is probably thanks to the FDir1 demo, it's no longer included with JV-ODE for this reason (after our previous discussions on the subject). In the demo, the friction direction was manually adjusted in order to experiment with the effects of FDir1, but the main purpose of the demo was to show how to setup FDir1 in code. I realised it was too misleading and decided to scrap it a while ago.<br><br>So, everything you've posted is correct, you do need to adjust the friction direction to align with the wheels for it to work like real tyres.<br><br>To adjust these values in real time, they must be applied with the Geom contact functions only... <i>dGeomContactSetMode(geom,mode)... dGeomContactSetFDir1(geom,fdir1x#,fdir1y#,fdir1z#) etc</i><br><br>Same applies to the slip values.<br><br>Using the geom functions should resolve those issues, let me know if it still isn't working correctly.<br><br>The most important part of the ODE docs regarding this problem is this bit...<br><div class="quote"> <br>To model this in ODE set the tire-road contact parameters as follows: set friction direction 1 in the direction that the tire is rolling in, and set the FDS slip coefficient in friction direction 2 to k*v, where v is the tire rolling velocity and k is a tire parameter that you can chose based on experimentation.<br> <br></div><br>Nice pics btw :) <br><br></td></tr></table><br>
<a name="920749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R,<br><br>Ahhh - I see where I've been going wrong.<br>Thanks very much. I'll give this a go and let you know how it turns out.<br><br>Incidentally the publisher I sold my Tricky Tracks game to decided for some reason to not market it (at least not yet) so Im looking at a newer version which is what this is for.<br><br>Thanks again.<br><br>Mark<br><br>EDIT : Bah! - I thought I had it but its not working - I seem to be really struggling. Any chance of a quick demo VIP3R ? <br><br></td></tr></table><br>
<a name="920856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#114">[#114]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi VIP3R,<br><br>OK Ive spent some time messing with Fdir and have come to a dead end.<br>The following code is the segment of my program (from inside the main loop just before 'updategeoms') which calculates the direction of each wheel and applies the geom parameters to define Fdir1.<br><br>(Ive used the common variables from any of the JV-ODE car demos).<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; loop through all four wheels of car
For count=1 To 4
; use the direction of the car body to create a vector (to set friction direction)
; get angle of car body
car_angle#=dGeomGetYaw(CGeom)
; factor in the angle between the wheel and the car body so the steering wheels are catered for
wheel_angle#=dJointGetHinge2Angle1(joint(count))*57.4 ; (57.4 = radians to degrees)
x_component#=Sin(car_angle#+wheel_angle#)*-1.0 
y_component#=0.0
z_component#=Sin(car_angle#+wheel_angle#+90.0)
; set geoms contact parameters
dGeomContactSetMode(WGeom(count),dContactFDir1+dContactSlip1)
; friction in direction wheel is rolling
dGeomContactSetMu(WGeom(count),20.0)
; friction in perpendicular direction to roll
dGeomContactSetMu2(WGeom(count),30.0)
; set friction direction
; Note (!) putting parameters in order i.e. x,y,z gives very strange result - trial and error shows y,x,z as better but not perfect (?)
dGeomContactSetFDir1(WGeom(count),y_component#,x_component#,z_component#)
; slip value for direction of roll
dGeomContactSetSlip1(WGeom(count),0.005)
; get rotational speed of wheel
spin#=dJointGetHinge2Angle2Rate(joint(count))
; slip value for second direction (factored by rotational speed i.e. k*v)
dGeomContactSetSlip2(WGeom(count),0.005+(Abs(spin#)/100))
Next
</textarea><br><br>Problem is it doesnt seem to work. Try setting mu2 to a silly low value (i.e. no sideways grip) and see what happens. Its like the Fdir1 direction is not being set each loop.<br><br>I think I understand the principle of <i>what</i> i need to do - its just <i>how</i> I achieve it in the code thats stumping me.<br><br>Hopefully I'm missing something really simple (not for the first time!)<br><br>Let me know what you think friend - as always - really appreciate your time.<br><br>cheers,<br><br>Mark <br><br></td></tr></table><br>
<a name="920884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#115">[#115]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I noticed a few problems.<br><br>If you examine the x/y/z components during runtime you will see that they don't reflect the angle of the wheels globally, therefore the friction direction will be wrong most of the time. If you drive in circles, what you should see is the x and z components rise and fall depending on the global angle of the wheel.<br><br>I've created a quick demo using your code snippet with the following changes...<br>* Added World Contact / Mu2 / Slip settings (in addition to the geom contact settings)<br>* Removed the car angle code (not needed)<br>* Changed the wheel angle to use the yaw value (the hinge2 angle is local and it needs to be global)<br>* The friction values are exaggerated for testing, I think Mu and Mu2 are mixed up though, this might be because the yaw is perpendicular to the wheel.<br><br>I haven't adjusted the slip settings so they might be interfering with the friction (hence the 20000 value).<br><br>It seems to be working correctly, but needs much more tweaking and testing with those friction / slip values.<br><br>Anyway, here it is...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #                                        JV-ODE Car Demo                                          #
; #                                  Code by Jim Williams (VIP3R)                                   #
; #                              Devious Codeworks - Copyright © 2008                               #
; ###################################################################################################

Include "JV-ODE.bb"

AppTitle "JV-ODE Car Demo"

Graphics3D 800,600,0,2

Global CMass#=200.0				; ### Car Mass
Global WMass#=14.0				; ### Wheel Mass

Global WorldERP#=1.0			; ### World Error Correction
Global WorldFriction#=70.0		; ### World Friction

Global Torque#=24.0				; ### Joint Torque
Global SuspensionHS#=0.01		; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0.0
Global Steer#=0.0

Global Car
Global CGeom
Global CMesh

Global CarStartY=20

Global x_component#=0.0	; &lt;&lt;&lt;&lt; Here
Global y_component#=0.0	; &lt;&lt;&lt;&lt; Here
Global z_component#=0.0	; &lt;&lt;&lt;&lt; Here

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

dInitODE()

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactFDir1+dContactSlip1)	; &lt;&lt;&lt;&lt; Here
dContactSetMu(WorldFriction)
dContactSetMu2(1.0)	; &lt;&lt;&lt;&lt; Here
dContactSetFDir1(1.0,1.0,1.0)	; &lt;&lt;&lt;&lt; Here
dContactSetSlip1(0.005)	; &lt;&lt;&lt;&lt; Here
dContactSetSlip2(0.005)	; &lt;&lt;&lt;&lt; Here

; ### Create Car Body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetPosition(ode\body,0,CarStartY,0)
dBodySetRotation(ode\body,0,0,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
EntityColor ode\mesh,40,80,255

; ### Create Wheels

For count=1 To 4
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Wheel(count)=ode\body
	dBodySetPosition(ode\body,0,0,0)
	dBodySetRotation(ode\body,0,0,90)
	mass=dMassCreate()
	dMassSetSphereTotal(mass,WMass,0.7)
	dBodySetMass(ode\body,mass)
	dMassDestroy(mass)
	ode\geom=dCreateSphere(Space,0.7)
	WGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder()
	ScaleMesh ode\mesh,0.7,0.25,0.7
	EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create Objects

SeedRnd MilliSecs()

For spheres=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetPosition(ode\body,Rand(-100,100),30,Rand(-100,100))
	dBodySetRotation(ode\body,0,0,0)
	ode\geom=dCreateSphere(Space,4)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateSphere()
	ScaleMesh ode\mesh,4,4,4
	EntityColor ode\mesh,Rand(0,255),Rand(0,255),Rand(0,255)
	EntityShininess ode\mesh,0.7
Next

For capsules=1 To 20
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	dBodySetPosition(ode\body,Rand(-100,100),30,Rand(-100,100))
	dBodySetRotation(ode\body,90,0,0)
	ode\geom=dCreateCapsule(Space,1,8)
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder()
	ScaleMesh ode\mesh,1,5,1
	RotateMesh ode\mesh,90,0,0	; ### Align Blitz3D Cylinder To ODE Capsule
	EntityColor ode\mesh,Rand(0,255),Rand(0,255),Rand(0,255)
	EntityShininess ode\mesh,0.7
Next

; ### Create Light

Global Light=CreateLight()
RotateEntity Light,50,-50,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create Camera

Global CameraPivot=CreatePivot()

Global Camera=CreateCamera(CameraPivot)
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000

; ### Create Plane

dCreatePlane(Space,0,1,0,0)

Global Plane=CreatePlane()
EntityAlpha Plane,0.8

EntityTexture Plane,PlaneTexture()

CreateMirror()

; ###################################################################################################

; ### Blitz3D Static Object (White)

Global Blitz3DObject=CreateCube()
ScaleMesh Blitz3DObject,1,4,20
PositionEntity Blitz3DObject,10,5,40
RotateEntity Blitz3DObject,-10,8,4
EntityColor Blitz3DObject,255,255,255

; ### ODE Static Object (Blue)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,2,8,40)
dGeomSetPosition(ode\geom,20,5,40)
dGeomSetRotation(ode\geom,-10,8,4)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,1,4,20
EntityColor ode\mesh,0,100,200

; ### ODE Static Object (Red)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,18,0.2,40)
dGeomSetPosition(ode\geom,-20,4.9,40)
dGeomSetRotation(ode\geom,-14,0,0)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,0.1,20
EntityColor ode\mesh,200,0,100

; ###################################################################################################

SetupCar()

While Not KeyHit(1)

	UpdateKeys()

	UpdateCar()

	UpdateGeoms()

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateCam()

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 0,50,"Force:"+Force
	Text 0,65,"Torque:"+Torque
	Text 640,0,"A - Accelerate"
	Text 640,15,"Z - Brake/Reverse"
	Text 640,30,"Arrows - Steering"
	Text 640,45,"Space - Reset Car"

	Text 0,100,"X:"+x_component#
	Text 0,120,"Y:"+y_component#
	Text 0,140,"Z:"+z_component#

	Flip 1

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function SetupCar()

For count=1 To 4
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
	If count&gt;2
		dJointSetHinge2Param(Joint(count),dParamLoStop,0)
		dJointSetHinge2Param(Joint(count),dParamHiStop,0)
		End If

	dGeomContactSetMode(WGeom(count),dContactFDir1+dContactSlip1)	; &lt;&lt;&lt;&lt; Here
Next

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyDown(30)=1
	Force=Force+0.08
	If Force&gt;30 Then Force=30
	End If

If KeyDown(44)=1
	Force=Force-0.1
	If Force&lt;-10 Then Force=-10
	If Force&gt;0 Then Force=Force*0.97
	End If

If KeyDown(30)=0 And KeyDown(44)=0 Then Force=Force*0.99

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=0.5
		Else
		Steer=-0.5
		End If
	Else
	Steer=0.0
	End If

If KeyHit(57)=1
	Force=0.0
	dBodySetRotation(Car,dGeomGetPitch(CGeom),dGeomGetYaw(CGeom),0)
	End If

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 4
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

; Here &gt;&gt;&gt;&gt;
For count=1 To 4
	wheel_angle#=dGeomGetYaw(WGeom(count))
	x_component#=Sin(wheel_angle#)*-1.0 
	y_component#=0.0
	z_component#=Sin(wheel_angle#+90.0)

	dGeomContactSetMu(WGeom(count),30)
	dGeomContactSetMu2(WGeom(count),20000)

	dGeomContactSetFDir1(WGeom(count),x_component#,y_component#,z_component#)

	dGeomContactSetSlip1(WGeom(count),0.005)

	spin#=dJointGetHinge2Angle2Rate(joint(count))
	dGeomContactSetSlip2(WGeom(count),0.005+(Abs(spin#)/100))
Next
; &lt;&lt;&lt;&lt; Here

End Function

; ###################################################################################################

Function UpdateCam()

PositionEntity Camera,0,3,-12

PivotX#=Cos(EntityYaw(CMesh)-90)+EntityX(CMesh)
PivotY#=EntityY(CMesh)
PivotZ#=Sin(EntityYaw(CMesh)-90)+EntityZ(CMesh)

PositionEntity CameraPivot,PivotX,PivotY,PivotZ

PointEntity CameraPivot,CMesh

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	PositionEntity ode\mesh,dGeomGetPositionX(ode\geom),dGeomGetPositionY(ode\geom),dGeomGetPositionZ(ode\geom)
	RotateEntity ode\mesh,dGeomGetPitch(ode\geom),dGeomGetYaw(ode\geom),dGeomGetRoll(ode\geom)
Next

End Function

; ###################################################################################################
</textarea><br><br>I've marked the new areas of code with the tag '&lt;&lt;&lt;&lt; Here'.<br><br>Hope this helps, let me know if you need anymore info ;) <br><br></td></tr></table><br>
<a name="920918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Judd</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#116">[#116]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R,<br><br>You've done it again !<br><br>Thats great, thanks for your help.<br>Works really nicely now - just fine tuning the values to give the feel I'm after.<br>I had really become confused with the global / local angles issue and despite starting from scratch a couple of times seemed to wind up in the same place each time.<br><br>Once again, many thanks for your excellent support.<br><br>Mark <br><br></td></tr></table><br>
<a name="931139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sokrates</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#117">[#117]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, <br>i got a error message ("colliders array not initalized (..\ode\src\collision_kernel.cpp:256")-  JV-ODE ERROR 2 -  with this source-code. Can somebody  confirm this or can help to fix it ? Maybe it is a problem with the JV-ODE 1.32 -Blitzmax-Edition ? <br><br>Thanks in Advance <br>Jens <br><br>Blitz3DSDK_V102<br>Blitzmax 1.30<br>JV-ODE 1.32<br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' #############################################################################
' #                            JV-ODE - Cubes Demo                            #
' #                        Code by Jim Williams (VIP3R)                       #
' #                    Devious Codeworks - Copyright © 2007                   #
' #############################################################################

SuperStrict

Framework BRL.GLMax2D ' only needed for "AppTerminate()"
Import BRL.Random
Import DevCode.JVODE
Import blitz3d.blitz3dsdk

AppTitle:String="JV-ODE - Cubes Demo"

bbBeginBlitz3D()
bbGraphics3D 800,600,0,2

Type ODEGeom
	Field body:Int
	Field geom:Int
	Field mesh:Int
	Field rgb:Int[]
	Field scale:Float[]
End Type

Global ODEGeomList:TList=CreateList()

' #############################################################################

' ### Setup ODE

Global World:Int=dWorldCreate()
Global Space:Int=dHashSpaceCreate(0)
Global ContactGroup:Int=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dContactSetMode(dContactBounce)
dContactSetBounce(0.1)
dContactSetMu(48)

' ### Create light

Global Light:Int = bbCreateLight()

bbRotateEntity Light,45,-90,0
bbLightColor Light,255,255,255
bbAmbientLight 130,130,130

' ### Create camera

Global Camera:Int = bbCreateCamera()
bbCameraClsColor Camera,0,0,0
bbCameraRange Camera,1,1000
bbPositionEntity Camera,0,20,-50
bbRotateEntity Camera,30,0,0

' ### Create plane

dCreatePlane(Space,0,1,0,0)

Local plane:Int = bbCreatePlane()

bbEntityAlpha Plane,0.8

Local PlaneTexture:Int = bbCreateTexture(128,128,9)

bbClsColor 0,200,80
bbCls

bbColor 255,255,255

bbRect 0,0,64,64,1
bbRect 64,64,64,64,1

bbCopyRect 0,0,128,128,0,0,bbBackBuffer(),bbTextureBuffer(PlaneTexture)
bbScaleTexture PlaneTexture,20,20
bbEntityTexture Plane,PlaneTexture,0,0

Local Mirror:Int = bbCreateMirror()

' #############################################################################

Local PTime:Int
Local Timer:Int
Local PhysicsTime:Float

While Not AppTerminate() And Not bbKeyDown(1)

	If MilliSecs()-Timer&gt;700
		AddObject()
		Timer=MilliSecs()
	End If

	UpdateGeoms()

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime=MilliSecs()-PTime

	bbRenderWorld

	bbText 0,0,"JV-ODE Version "+dGetVersion()
	bbText 0,15,"Physics Time:"+PhysicsTime

	bbFlip 

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

' #############################################################################

Function AddObject()

Local xp:Float
Local zp:Float
Local ode:ODEGeom

xp=Rand(-10,10)
zp=Rand(-10,10)

ode:ODEGeom=New ODEGeom
ode.body=dBodyCreate(World)
dBodySetAxisAngle(ode.body,0,0,0,0)
dBodySetPosition(ode.body,xp,30,zp)
dBodySetAutoDisableFlag(ode.body,1)
ode.geom=dCreateBox(Space,5,5,5)
dGeomSetBody(ode.geom,ode.body)
ode.mesh=bbCreateCube()
bbScaleMesh ode.mesh,2.5,2.5,2.5
bbEntityColor ode.mesh,Rand(0,255),Rand(0,255),Rand(0,255)
ListAddLast(ODEGeomList,ode:ODEGeom)

End Function

' #############################################################################

Function UpdateGeoms()

Local ode:ODEGeom

' ### Update Geoms
For ode:ODEGeom=EachIn ODEGeomList

	If dBodyIsEnabled(ode.body)
		bbPositionEntity ode.mesh,dGeomGetPositionX(ode.geom),dGeomGetPositionY(ode.geom),dGeomGetPositionZ(ode.geom)
		bbRotateEntity ode.mesh,dGeomGetPitch#(ode.geom),dGeomGetYaw#(ode.geom),dGeomGetRoll#(ode.geom)
	EndIf

Next

End Function

' #############################################################################


</textarea> <br><br></td></tr></table><br>
<a name="931183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#118">[#118]</a></td></tr></table></td></tr><tr ><td class="posttext"> Add the following line after '### Setup ODE'...<br><br><pre class=code>
' ### Setup ODE

dInitODE()

</pre>ODE must be initialized in JV-ODE V1.32 <br><br></td></tr></table><br>
<a name="931214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sokrates</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#119">[#119]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you very much  VIP3R ! <br><br>Sometimes I am a tiny idiot - if i'd thought about it, i could have managed myself. ;-) <br><br></td></tr></table><br>
<a name="931305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabhand</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#120">[#120]</a></td></tr></table></td></tr><tr ><td class="posttext"> EDIT: Doesnt matter, I've sussed it, while not using JV-ODE! :)<br><br>Cheers<br><br>Dabz <br><br></td></tr></table><br>
<a name="933507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mortiis</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#121">[#121]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can I use JV-ODE for water/sea physics? Like waves effecting boats and items float on the surface, stuff like that? If so I'll but it now. Thanks. <br><br></td></tr></table><br>
<a name="933557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#122">[#122]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sadly not, ODE only simulates rigid body physics. You need a soft body physics engine for 'proper' flowing water.<br><br>It's possible to do simple water stuff with ODE though, like icebergs etc. <br><br></td></tr></table><br>
<a name="933630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mortiis</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#123">[#123]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the quick reply VIP3R<br><br>How would I do that in ODE? Can you code a little example for me? I mean the icebergs. <br><br></td></tr></table><br>
<a name="933636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#124">[#124]</a></td></tr></table></td></tr><tr ><td class="posttext"> You create a body of water using a cuboid, then give the body certain collision properties. When you drop other solid objects (like an iceberg body) onto the water cube, they will behave as if they are floating on a fluid. You can also adjust the height of the water in real-time, but it will always remain flat (no waves). The water cube can be placed at an angle to simulate flowing water though. It's really easy to do.<br><br>Wave simulation might be possible with some intensive math, but that's where things get complicated and eventually would go beyond the limits of a rigid body engine like ODE.<br><br>The full version of JV-ODE has water and iceberg demos, but they won't run in the demo version. <br><br></td></tr></table><br>
<a name="937590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Atomic Duck</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#125">[#125]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having a bit of trouble repositioning and rotating a rigid body AFTER it has been made. <br><br>I'd rather 'recycle' Bodies, Geoms &amp; Meshes , instead of destroying them.<br><br>The general idea is that the distance of all 25 cars is calculated.<br>This list is sorted. If a car is outside the maximum distance, it gets<br>repositioned. <br><br>Every road in the game has a number of waypoints. <br>Each waypoint has a number, and points towards his next Waypoint.<br>This generates the YAW of that Waypoint. This YAW is used to rotate the rigid body..... Only it doesn't work. :/ <br><br>I've tried dbodysetrotation , dbodysetaxisangle . I even tried disabling bodies before positioning and rotating, but that didn't work either.<br><br>This is the code so far: <br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #                                        JV-ODE Car Demo                                          #
; #                                  Code by Jim Williams (VIP3R)                                   #
; #                              Devious Codeworks - Copyright © 2008                               #
; ###################################################################################################

Include "JV-ODE.bb"

AppTitle "JV-ODE Car Demo"

Graphics3D 800,600,0,2

HidePointer 

Global CMass#=200.0				; ### Car Mass
Global WMass#=14.0				; ### Wheel Mass

Global WorldERP#=1.0			; ### World Error Correction
Global WorldFriction#=70.0		; ### World Friction

Global Torque#=24.0				; ### Joint Torque
Global SuspensionHS#=0.01		; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0.0
Global Steer#=0.0

Global Car
Global CGeom
Global CMesh

Global CarStartY=10
Global TotalWP					; total no. of waypoints
Global Next_Waypoint			; car travels to this waypoint		
Global Dummy					; The Dummy Car 
Global cam_x#,cam_z#,cam_pitch#,cam_yaw#						
Global dest_cam_x#,dest_cam_z#,dest_cam_pitch#,dest_cam_yaw#	
 
Global 		CUBE = CreateCube()
ScaleMesh 	CUBE , 1.6 , 0.1 , 1.6
EntityColor CUBE , 255 , 0 , 0
HideEntity 	CUBE

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

dInitODE()

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactSlip1)
dContactSetMu(WorldFriction)

; ### Create Car Body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetPosition(ode\body,0,CarStartY,0)
dBodySetRotation(ode\body,0,0,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
EntityColor ode\mesh,40,80,255

; ### Attach Compass to Car
Global 		 CarCompass = CreateCone()
RotateMesh   CarCompass , 90 , 0 , 0 
ScaleMesh    CarCompass , 1,0.1,1
EntityColor  CarCompass , 200,10,10
EntityParent CarCompass , Cmesh
x# = EntityX#( Cmesh , 1 )
y# = EntityY#( Cmesh , 1 )
z# = EntityZ#( Cmesh , 1 )
PositionEntity CarCompass , x# , y#+1 , z# , 1

; ### Create Wheels

For count=1 To 4
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Wheel(count)=ode\body
	dBodySetPosition(ode\body,0,0,0)
	dBodySetRotation(ode\body,0,0,90)
	mass=dMassCreate()
	dMassSetSphereTotal(mass,WMass,0.7)
	dBodySetMass(ode\body,mass)
	dMassDestroy(mass)
	ode\geom=dCreateSphere(Space,0.7)
	WGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder()
	ScaleMesh ode\mesh,0.7,0.25,0.7
	EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create Light

Global 			Light = CreateLight()
RotateEntity 	Light ,  50 ,-50  , 0
LightColor 		Light , 255 , 255 , 255
AmbientLight    130 , 130 , 130

; ### Create Camera

Global CameraPivot=CreatePivot()

Global 			Camera=CreateCamera();CameraPivot)
CameraClsColor  Camera , 0 , 0 , 0
CameraRange 	Camera , 1 , 1000

; ### Create Plane

dCreatePlane    (Space,0,1,0,0)
Global 			Plane = CreatePlane()
EntityAlpha 	Plane , 1
EntityTexture   Plane,PlaneTexture()

; ###################################################################################################

SetupCar()
Make_DummyCar()
Load_Waypoints()
MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

PositionEntity CameraPivot , 0 , 8 , -10 

While Not KeyHit(1)

	UpdateCar()

	UpdateGeoms()

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	PhysicsTime#=MilliSecs()-PTime

	UpdateWorld 
	RenderWorld

	ExampleCODE()
	CAR_AI()

	Color 100,100,255

	Text   0 ,  0 , "JV-ODE Version "+ dGetVersion()
	Text   0 , 15 , "Physics Time.. " + PhysicsTime
	Text   0 , 50 , "Force......... " + Force
	Text   0 , 65 , "Torque........ " + Torque
	Text 240 ,  0 , "Point Mouse at Waypoint"
	Text 240 , 15 , "Click [LMB] to rotate DummyCar at Waypoint's YAW"
	Text 240 , 30 , "Move Camera with [W] &amp; [S] ,or Cursor[UP] &amp; [DOWN]"
	Text 240 , 45 , "Press [SPACE] to reset car" 

	Color 255,255,255
	
	Flip 1

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function SetupCar()

For count=1 To 4
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
	If count&gt;2
		dJointSetHinge2Param(Joint(count),dParamLoStop,0)
		dJointSetHinge2Param(Joint(count),dParamHiStop,0)
		End If
Next

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 4
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	PositionEntity ode\mesh,dGeomGetPositionX(ode\geom),dGeomGetPositionY(ode\geom),dGeomGetPositionZ(ode\geom)
	RotateEntity ode\mesh,dGeomGetPitch(ode\geom),dGeomGetYaw(ode\geom),dGeomGetRoll(ode\geom)
Next

End Function

; ###################################################################################################

Type Waypoint
	Field X,Y,Z
	Field Pivot
	Field Number
	Field Next_WP_Num
	Field Rotate_To_Next_WP
End Type

Function ExampleCODE()

; Mouse look

	PositionEntity Camera , EntityX#(camerapivot),EntityY#(camerapivot),EntityZ#(camerapivot)

	mxs=MouseXSpeed()
	mys=MouseYSpeed()
	dest_cam_yaw#=dest_cam_yaw#-mxs
	dest_cam_pitch#=dest_cam_pitch#+mys
	cam_yaw=cam_yaw+((dest_cam_yaw-cam_yaw)/5)
	cam_pitch=cam_pitch+((dest_cam_pitch-cam_pitch)/5)
	
	RotateEntity camera,cam_pitch#,cam_yaw#,0
	
	MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

; Camera move
	
	If KeyDown(200) Or KeyDown(17)  Then dest_cam_z=1
	If KeyDown(208) Or KeyDown(31)  Then dest_cam_z#=-1

	cam_z=cam_z+((dest_cam_z-cam_z)/5)
	cam_x=cam_x+((dest_cam_x-cam_x)/5)

	RotateEntity camerapivot , 0 , EntityYaw#( Camera ,1) , 0 ,1
	MoveEntity camerapivot,cam_x,0,cam_z
	dest_cam_x=0 : dest_cam_z=0

	MX = MouseX()
	MY = MouseY()

; Draw Cursor
	
	Color 32,32,32
	For tx=-1 To 1
		For ty=-1 To 1
			Line mx+tx,my+ty,mx+6+tx,my+6+ty
			Line mx+tx,my+ty,mx+tx,my+8+ty
		Next
	Next
	Color 255,255,255
	Line mx,my,mx+6,my+6
	Line mx,my,mx,my+8

	CameraPick Camera,MX,MY

	W1.Waypoint = Null
	
	If Not PickedEntity()=0
		W1.WayPoint = Object.WayPoint (Int(EntityName(PickedEntity())))
	EndIf

	If W1.Waypoint &lt;&gt; Null
		
		Color 255 , 0 , 0
		Text MX , MY    , "Waypoint      " + W1\Number
		Text MX , MY+15 , "Next Waypoint " + W1\Next_WP_Num
		Text MX , MY+30 , "Rotation      " + W1\Rotate_To_Next_WP
		Color 255 , 255 , 255
	
		If MouseHit(1)
			PositionEntity Dummy , W1\X , W1\Y + 1 , W1\Z , 1
			RotateEntity   Dummy , 0 , W1\Rotate_To_Next_WP , 0 ,1
		
			;For count=1 To 4
			;	dBodyDisable(Wheel(count))
			;Next
			;dBodyDisable(Car)
		
			dBodySetPosition  ( Car ,W1\X , W1\Y + 20 , W1\Z)
			dBodySetRotation  ( Car, dGeomGetPitch(CGeom),dGeomGetYaw(CGeom),0)   
			dBodySetAxisAngle ( Car ,2 , 0 , W1\Rotate_To_Next_WP , 0 )
			
			;For count=1 To 4
			;	dBodyEnable(Wheel(count))
			;Next
			;dBodyEnable(Car)

			
			
			FlushMouse()
			
		EndIf
	EndIf 

	If KeyHit(57)=1
		Force=0.0
		dBodySetRotation(Car,dGeomGetPitch(CGeom),dGeomGetYaw(CGeom),0)
	End If


End Function

Function CAR_AI()

	If TotalWP =&gt; 22
	
		Select Next_Waypoint 
			Case 0 
				Temp.WayPoint = First WayPoint 
				Next_Waypoint = Temp\Number 
			
				Temp.WayPoint = Last WayPoint 
				Temp\Next_WP_Num = 1 

			Default
				For W.Waypoint = Each Waypoint 
					If W\Number = Next_Waypoint 
						Temp = W
						Exit
					EndIf
				Next 	
				
				PointEntity CarCompass , Temp\Pivot
				
				Distance = EntityDistance ( Cmesh , Temp\Pivot )
				If Distance &lt; 5 
					Next_Waypoint = Temp\Next_WP_Num
				Else 
					Force = Force + 0.08
					If Force &gt; 3 Then Force = 3
				End If

				CarAngle     = EntityYaw#( Cmesh      , 1 ) 
				CompassAngle = EntityYaw#( CarCompass , 1 )

				TempAngle# = AngleDifference( CarAngle , CompassAngle )
	
				If TempAngle &lt; -5 Then TempAngle = -5
				If TempAngle &gt;  5 Then TempAngle =  5

				Steer = -(TempAngle * 0.05)

		End Select 
	EndIf
	
End Function

Function AngleDifference( CurrentAngle , TargetAngle )
    If TargetAngle - CurrentAngle &gt; 180 Then TargetAngle = TargetAngle - 360
    If CurrentAngle - TargetAngle &gt; 180 Then CurrentAngle = CurrentAngle - 360
    Return CurrentAngle - TargetAngle
End Function

Function Load_Waypoints()

	Restore WPdata

	Read Total
	
	For T = 1 To Total
	
		Read nX 
		Read nY 
		Read nZ
		Read nCurrentWP
		Read nNextWP
		Read nRotation

		W.WayPoint    = New WayPoint 

		W\X 		        = nX 
		W\Y 		        = nY 
		W\Z 		        = nZ
		W\Pivot  	        = CopyEntity ( CUBE )
		W\Number 	        = nCurrentWP
		W\Next_WP_Num       = nNextWP
		W\Rotate_To_Next_WP = nRotation
		
		PositionEntity W\Pivot , W\X , W\Y , W\Z , 1
		NameEntity     W\Pivot , Str$( Handle ( W.WayPoint ))
		EntityPickMode W\Pivot , 2
		RotateEntity   W\Pivot , 0 , Rotation , 0 , 1
	Next 
	
	TotalWP = T-1 
	  	
End Function

Function Make_DummyCar()

	Dummy = CreateCube()
	ScaleMesh Dummy , 1.5 , 0.5 , 2
	EntityColor Dummy ,0,0,255

	W1 = CreateCylinder(16) 
 	ScaleMesh  W1 , 0.7,0.25,0.7
	RotateMesh W1 , 0 , 0 , 90
	EntityColor W1 ,0 ,0,255

	W2 = CopyEntity ( W1 )
	W3 = CopyEntity ( W1 )
	W4 = CopyEntity ( W1 )
	
	PositionEntity W1 ,-2 , -0.5 , +2 
	PositionEntity W2 ,+2 , -0.5 , +2 
	PositionEntity W3 ,-2 , -0.5 , -2 
	PositionEntity W4 ,+2 , -0.5 , -2 

	EntityParent W1 , Dummy
	EntityParent W2 , Dummy
	EntityParent W3 , Dummy
	EntityParent W4 , Dummy

End Function

.WPdata

Data 22
Data  0   , 0 ,  43 ,  1 ,  2 ,  28
Data -9   , 0 ,  60 ,  2 ,  3 ,  43
Data -25  , 0 ,  77 ,  3 ,  4 ,  53
Data -42  , 0 ,  90 ,  4 ,  5 ,  48
Data -81  , 0 , 125 ,  5 ,  6 ,  26
Data -104 , 0 , 173 ,  6 ,  7 , -4
Data -102 , 0 , 201 ,  7 ,  8 , -36
Data -83  , 0 , 227 ,  8 ,  9 , -48
Data -63  , 0 , 245 ,  9 , 10 , -90
Data -36  , 0 , 245 , 10 , 11 , -90
Data -2   , 0 , 245 , 11 , 12 , -110
Data  34  , 0 , 232 , 12 , 13 , -144
Data  63  , 0 , 192 , 13 , 14 , -159
Data  77  , 0 , 155 , 14 , 15 ,  178
Data  75  , 0 , 101 , 15 , 16 ,  155
Data  52  , 0 ,  52 , 16 , 17 ,  126
Data  29  , 0 ,  35 , 17 , 18 ,  104
Data -3   , 0 ,  27 , 18 , 19 ,   49
Data -27  , 0 ,  48 , 19 , 20 , -4
Data -21  , 0 , 142 , 20 , 21 , -90
Data  32  , 0 , 142 , 21 , 22 , -169
Data  51  , 0 ,  40 , 22 , 1  ,  0

</textarea><br><br>Thanks! :D <br><br></td></tr></table><br>
<a name="937597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#126">[#126]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to zero the force, torque and velocity on the car body and all of the wheels, before you move them...<br><i><br>dBodySetForce(body,0,0,0)<br>dBodySetTorque(body,0,0,0)<br>dBodySetAngularVel(body,0,0,0)<br>dBodySetLinearVel(body,0,0,0)<br></i><br>Btw, it's forward slash '/' for the codebox end tag ;) <br><br></td></tr></table><br>
<a name="937728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Atomic Duck</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#127">[#127]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Vip3R,<br>It works beautifully. :)<br><br><div class="quote"> Btw, it's forward slash '/' for the codebox end tag  <br></div><br><br>whoops, sorry about that... I.ve edited it. :D <br><br></td></tr></table><br>
<a name="937804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#128">[#128]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi, i have a little problem with a 12 cars race game... <br><br>sometimes when i start the race and the cmesh touch or collition with an object, the cars bounce to an increible speed, and it goes from 45 to 1600 km/h in that exact moment, and it flies to the space :)<br> <br>it doesn't always happen, when I put more cars on the scenary more possibilities fot this error to happen<br><br>sometimes too, all the cars constantly bounce<br><br>maybe i have something wrong with my 3d scenary, but when i use an odeplane, I have the same problem<br><br>I would like to know the reason why when the cmesh collides the cars bounce at ultra high speed!?? <br><br>i'm sure this is some problem with my code.<br><br>thanks and regards. <br><br></td></tr></table><br>
<a name="937916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#129">[#129]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I understand correctly, the car meshes are colliding when the simulation is started? That would cause the high speed bounce as you put it.<br><br>If two or more objects overlap (collide) when you step the simulation, ODE may generate very high collision forces to correct it (the high speed bounce you've experienced).<br><br>The solution is to make sure they don't collide with anything when they're created or added to the scene.<br><br>The other issue (constant bounce) sounds like twitchy physics, adjusting things like ERP and CFM can help, you can also try adjusting the collision depth with <i>dWorldSetContactSurfaceLayer(world,depth#)</i>. <br><br></td></tr></table><br>
<a name="938896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#130">[#130]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi.. <br><br>i have this screenshot of my racecar track,  i only want to know if these triangles distribution works fine with the ode cars..<br><br>i can change the polys if there is a best way to do the tracks for the ode system..<br><br><img src="http://santiago3d.com.ar/capturas/dibujo.jpg"><br><br>thanks VIP3R, your answers are always a big help.<br><br>another question -&gt; is this the right forum to post this kind of question? or i must post in userlib\?<br><br>regards!, santiago <br><br></td></tr></table><br>
<a name="939179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#131">[#131]</a></td></tr></table></td></tr><tr ><td class="posttext"> Those triangles should be ok.<br><br>You can post here with questions, it's fine. <br><br></td></tr></table><br>
<a name="941823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#132">[#132]</a></td></tr></table></td></tr><tr ><td class="posttext"> i edit this post.. <br><br>now the only problem i have with my cars, is when the road is go to up or down. when i turn the cars loose grip.. ¿how can i fix that? <br><br></td></tr></table><br>
<a name="942046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#133">[#133]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's extremely hard to say without an example showing the problem.<br><br>Try to describe in detail how the car reacts when there's grip/no grip. If it were a real-life situation, how would the car react compared to your simulation? <br><br></td></tr></table><br>
<a name="942060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#134">[#134]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apply a down force based on the velocity of your car.<br><br>Get fancy, and use some simplified lift equations:<br>L = 0.5 * Cl * A * r * V^2<br><br>Where L is lift (in this case, downforce), Cl =lift coefficient, A = area of the body facing the flow, r =air density, and V = velocity of the air flow.<br><br>CL = 2 * pi * angle <br><br>angle=-5 degrees<br><br>A = 3<br><br>r=0.074887 <br><br>I hope you get the idea.. <br><br></td></tr></table><br>
<a name="942136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#135">[#135]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks...<br><br>Wayne. that is a good idea, i am going to apply that force to see what happens... i'm going  to check ode functions, the force i think is not allways like gravity (down direction), because is created in the reality for the spoilers of the cars... <br><br>vip3r, i'll make some video and post the car data... to show the problem.<br><br>this is a link with some pictures of the game... (blitz forum link)<br><a href="http://blitzbasic.com/Community/posts.php?topic=83490" target="_blank">http://blitzbasic.com/Community/posts.php?topic=83490</a> <br><br></td></tr></table><br>
<a name="942234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#136">[#136]</a></td></tr></table></td></tr><tr ><td class="posttext"> vip3r, i posted a video in youtube showing the car movement, in the half part of the video, when the car reaches the track turns, look how the car makes small jumps. <br><br></td></tr></table><br>
<a name="942242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#137">[#137]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, it looks like the bumps in the mesh are causing the car to bounce out of control. I remember the mesh picture you posted previously, from the video it appears that the triangles aren't flat. Try to arrange the triangles to form flat quads in bands around the track, so that the only angles there are at the edges of the quads (not the triangles). Doing this will prevent the wheels bouncing in an alternating fashion, causing the instability.<br><br>Adjusting the collision depth with <i>dWorldSetContactSurfaceLayer(world,depth#)</i> might also help. Wayne's suggestion sounds ideal if you're loosing too much friction.<br><br>Outstanding work btw, you can see a huge amount of work has been put into it :) <br><br></td></tr></table><br>
<a name="942653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#138">[#138]</a></td></tr></table></td></tr><tr ><td class="posttext"> I looked at the youtube video and saw the wheels really bouncing.<br><br>How are the track meshes being created? <br><br></td></tr></table><br>
<a name="942743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#139">[#139]</a></td></tr></table></td></tr><tr ><td class="posttext"> i have an ode plane for ground.<br><br>the track is a createmesh, with triangles sharing vertex by color. road, outroad and piano. when i finish the track i use this command to convert the trackmesh to trimesh ode...<br><br>entityfx trackmesh,2<br>updatenormals(trackmesh<br>pista_ode=CreateTriMesh(Space,trackmesh)<br>	 dGeomSetPosition(pista_ode,0,-.5,0)<br>	 dGeomSetRotation(pista_ode,0,0,0)<br>	 dGeomContactSetMu(pista_ode,100)<br>	 <br>	 plano = dCreatePlane(Space,0,1,0,-.5)<br>	 dGeomContactSetMu(plano,10)<br>	 dgeomcontactsetbounce(plano,0))<br><br>i change the collision depth but don't see big changes..<br><br>im a newbie with ode, maibe in my code have more than one problem about physics... <br><br></td></tr></table><br>
<a name="942746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#140">[#140]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure your physics code is mostly fine ;)<br><br>The mesh needs to be modified to remove those bumps at the edges of the triangles.<br><br>The built-in CreateTriMesh() function of JV-ODE doesn't use the mesh normals, so updating them will have no effect on the TriMesh. But, you could try changing the CreateTriMesh() function to use the following function...<br><br><i>dGeomTriMeshDataBuildSingle1(trimeshdata,vertices*,vtxstride,vtxcount,indices*,idxcount,tristride,<b>normals*</b>)</i><br><br>instead of...<br><br><i>dGeomTriMeshDataBuildSingle(trimeshdata,vertices*,vtxstride,vtxcount,indices*,idxcount,tristride)</i><br><br>Create a bank containing the normals data of the mesh, then use it for the normals parameter. In the same way that the verts and tris data is used.<br><br>Not sure whether that will help or not, but it's worth a try. <br><br></td></tr></table><br>
<a name="942833"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#141">[#141]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does the car bounce when you are on the ground plane too ?<br><br>Have you taken a close look at the track when the wireframe is on ?<br><br>What are you using for tires on the car ? <br><br></td></tr></table><br>
<a name="942867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#142">[#142]</a></td></tr></table></td></tr><tr ><td class="posttext"> wayne, i base my cars in the ode cars samples... <br>the ode wheels are like spheres, the car a cube...<br>i change the ode_properties, mu, mass, dimensions, bounces, etc..<br><br><br>i note the wheels makes a small and fast bounce when the car are stop in the road... i fixed that problem elevating the road..<br>that problem was because the ode_road and the ode_ground were too close.. and the ode_wheells touch two geometris...<br><br>now i only need to work in the car bounce because off the track edges differences...  to fix that problem i working in the track editor, to make more smoother the triangles edges diferences, and i improve the ode cars propierties.<br><br>i recieve a lot of information about this problem, in this post and other post in the forum.. in few days i think this is totally solved. <br><br></td></tr></table><br>
<a name="944879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#143">[#143]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi, sorry if this is a very simple question, maybe not..<br><br>when my car gets out of the road, go to the infinite ode plane i made...<br><br>the question is, which command i must use to detect when a car touch the grass (ode plane).<br><br>is to slower procces calculate if a tire is over the grass for ode?, i have 12 cars, x 4 tires each one :p...<br><br>have you some advice or idea... :) <br><br></td></tr></table><br>
<a name="944895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#144">[#144]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something simple to try:<br><br>Hide all except track and terrain, place camera at tire position, point it down, take a 1x1 picture, get rgb color, if green component is &gt;= 100 this tire in grass, repeat for each tire position. <br><br></td></tr></table><br>
<a name="945009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#145">[#145]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless I'm misunderstanding something, the JV-ODE collision functions should be used to detect if a wheel is touching the ground plane. It would be significantly faster than isolating and detecting RGB values (sorry Wayne :) ).<br><br>Check the CarDemo-CCount and CarDemo-DetailedC collision detection demos for the necessary functions needed. In those demos, it takes much longer to render the collision information to the screen (using the Text function) than it does to actually detect the collisions.<br><br>There is no extra overhead when using the collision functions in JV-ODE, because this information is gathered anyway for every object in the simulation, whether you access it or not. <br><br></td></tr></table><br>
<a name="945015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#146">[#146]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, was just thinking outside the box. Vip3r always has great technical advice, and were all the better for it. Cheers! <br><br></td></tr></table><br>
<a name="945172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#147">[#147]</a></td></tr></table></td></tr><tr ><td class="posttext"> :) thanks vip, i'm going to check the car demos for detect the collision<br><br>wayne, maybe i can use yout method to create some sprites with the same color of the ground. <br><br></td></tr></table><br>
<a name="945202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#148">[#148]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Vip3r, just a quick question - Latatoy mentioned the use of 'spheres' as wheels as opposed to cylinders.  I've created some wheels from pure cylinders, here:<br><br><br><br>To achieve the best results with regard to adhesion and incremental slipperage would I be better retain pur cylinders (ie the tyre tread is totally flat on the surface) or, would I be better dissecting the walls of the cylinder in 2 (the 'tread' of the tyre/tire) and extruding the 'cirecumference' of the tyre right in the middle so that the wheel is riding on a knife edge as opposed to a large footprint ?  Thanks in advance for your feedback, regards, BP. <br><br></td></tr></table><br>
<a name="945356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#149">[#149]</a></td></tr></table></td></tr><tr ><td class="posttext"> Real tyres have a square/rectangular 'footprint' so simulating that would be better. The problem is that ODE generates collision contact 'points', rather than a collision zone or footprint.<br><br>If you examine the collisions of a wheel cylinder on a flat plane, you will notice it always has 2 collision points, these will be on the inner and outer rim central to the wheel. Like a knife edge running across the tyre, but only making contact at each end.<br><br>If you extrude the cylinder to create a central highspot, the knife edge will now run at the same angle as the wheel, but again only 2 collision points are generated on a flat plane.<br><br>With spheres there is a single contact point and they're more reliable where collisions with other objects are concerned.<br><br>None of the above will give an accurate tyre footprint, but it may be plenty good enough depending on your goals. The small number of contact points can cause a sudden (snappy) loss of grip, which some folks wrongly assume is caused by the 'friction model' that ODE uses. You would have to resort to casting multiple rays to simulate the collision zone of a tyre properly, for more information check out the raycar source here... <a href="http://opende.sourceforge.net/wiki/index.php/HOWTO_4_wheel_vehicle" target="_blank">http://opende.sourceforge.net/wiki/index.php/HOWTO_4_wheel_vehicle</a><br><br>It's in C/C++ but the ODE stuff has the same syntax as JV-ODE. <br><br></td></tr></table><br>
<a name="946539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#150">[#150]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Jim!<br><br>Jim, I'm having some problems here, when I try to reposition a "truck and trailer", I have tried to create the body, setup the wheels and etc, disable the body, reposition the body, etc. But, always my truck gonna crazy, like him have collided with anything... Can you help me to create this code to work with the new position and rotation? <br><br></td></tr></table><br>
<a name="946639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#151">[#151]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have to zero all forces and velocities on all objects (truck, trailer and wheels) <i>before</i> you reposition them, otherwise they will continue moving (go crazy as you say).<br><br>Here are the functions needed...<br><br><i>dBodySetForce(body,0,0,0)<br>dBodySetTorque(body,0,0,0)<br>dBodySetAngularVel(body,0,0,0)<br>dBodySetLinearVel(body,0,0,0)</i> <br><br></td></tr></table><br>
<a name="946739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EmerGki</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#152">[#152]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes Jim, I have done it too... <br><br>And, I'm trying to create a new truck in other position/rotation, but, when I create, the truck always starts rolling or rotating :(... <br><br></td></tr></table><br>
<a name="947389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#153">[#153]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the truck still moves, there are some forces still active on its components.<br><br>Check you're not applying any forces in your own code (accelerate/braking etc).<br><br>Also, make sure you step the simulation at least once after zeroing the forces. <br><br></td></tr></table><br>
<a name="949738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Play</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#154">[#154]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any jv-ode tutorial which include joint lesson, demo, or something ? <br><br></td></tr></table><br>
<a name="949844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#155">[#155]</a></td></tr></table></td></tr><tr ><td class="posttext"> Several of the available joints are used in the JV-ODE demos.<br><br>The ODE manual is the best place to start learning how to use them...<br><br><a href="http://opende.sourceforge.net/wiki/index.php/Manual_%28Joint_Types_and_Functions%29" target="_blank">http://opende.sourceforge.net/wiki/index.php/Manual_%28Joint_Types_and_Functions%29</a> <br><br></td></tr></table><br>
<a name="950004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZJP</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#156">[#156]</a></td></tr></table></td></tr><tr ><td class="posttext"> "...The ODE manual is the best place to start learning how to use them..."<br><br>Hahaha. VIP3R is the best man to ask these questions. ;-)<br><br>JP <br><br></td></tr></table><br>
<a name="951183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Play</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#157">[#157]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello again today i have some trouble with restarting that library..<br><br>For example carDemo with simply goto loop:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
.restart
ClearWorld

Graphics3D 320,240,0,2
SetBuffer BackBuffer()


testcube=CreateCube()
testcam=CreateCamera()
testlajt=CreateLight()
PositionEntity testcube,0,0,-5
PointEntity testcam,testcube


While Not KeyHit(1)

TurnEntity testcube,1,1,1

UpdateWorld()
RenderWorld()
Flip

Wend
ClearWorld


Graphics3D 800,600,0,2
SetBuffer BackBuffer()
Include "JV-ODE.bb"






Global CMass#=200.0                    ; ### Car Mass
Global WMass#=14.0                        ; ### Wheel Mass

Global WorldERP#=1.0            ; ### World Error Correction
Global WorldFriction#=70.0            ; ### World Friction

Global Torque#=24.0                    ; ### Joint Torque
Global SuspensionHS#=0.01              ; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0.0
Global Steer#=0.0

Global Car
Global CGeom
Global CMesh

Global CarStartY=20

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
        Field body
        Field geom
        Field mesh
End Type




; ###################################################################################################

; ### Setup ODE


dInitODE()

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactSlip1)
dContactSetMu(WorldFriction)


; ### Create Car Body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetPosition(ode\body,0,CarStartY,0)
dBodySetRotation(ode\body,0,0,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
EntityColor ode\mesh,40,80,255

; ### Create Wheels

For count=1 To 4
        ode.ODEGeom=New ODEGeom
        ode\body=dBodyCreate(World)
        Wheel(count)=ode\body
        dBodySetPosition(ode\body,0,0,0)
        dBodySetRotation(ode\body,0,0,90)
        mass=dMassCreate()
        dMassSetSphereTotal(mass,WMass,0.7)
        dBodySetMass(ode\body,mass)
        dMassDestroy(mass)
        ode\geom=dCreateSphere(Space,0.7)
        WGeom(count)=ode\geom
        dGeomSetBody(ode\geom,ode\body)
        ode\mesh=CreateCylinder()
        ScaleMesh ode\mesh,0.7,0.25,0.7
        EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create Objects

SeedRnd MilliSecs()

For spheres=1 To 20
        ode.ODEGeom=New ODEGeom
        ode\body=dBodyCreate(World)
        dBodySetPosition(ode\body,Rand(-100,100),30,Rand(-100,100))
        dBodySetRotation(ode\body,0,0,0)
        ode\geom=dCreateSphere(Space,4)
        dGeomSetBody(ode\geom,ode\body)
        ode\mesh=CreateSphere()
        ScaleMesh ode\mesh,4,4,4
        EntityColor ode\mesh,Rand(0,255),Rand(0,255),Rand(0,255)
        EntityShininess ode\mesh,0.7
Next

For capsules=1 To 20
        ode.ODEGeom=New ODEGeom
        ode\body=dBodyCreate(World)
        dBodySetPosition(ode\body,Rand(-100,100),30,Rand(-100,100))
        dBodySetRotation(ode\body,90,0,0)
        ode\geom=dCreateCapsule(Space,1,8)
        dGeomSetBody(ode\geom,ode\body)
        ode\mesh=CreateCylinder()
        ScaleMesh ode\mesh,1,5,1
        RotateMesh ode\mesh,90,0,0      ; ### Align Blitz3D Cylinder To ODE Capsule
        EntityColor ode\mesh,Rand(0,255),Rand(0,255),Rand(0,255)
        EntityShininess ode\mesh,0.7
Next

; ### Create Light

Global Light=CreateLight()
RotateEntity Light,50,-50,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create Camera

Global CameraPivot=CreatePivot()

Global Camera=CreateCamera(CameraPivot)
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000

; ### Create Plane

dCreatePlane(Space,0,1,0,0)

Global Plane=CreatePlane()
EntityAlpha Plane,0.8

EntityTexture Plane,PlaneTexture()

CreateMirror()

; ###################################################################################################

; ### Blitz3D Static Object (White)

Global Blitz3DObject=CreateCube()
ScaleMesh Blitz3DObject,1,4,20
PositionEntity Blitz3DObject,10,5,40
RotateEntity Blitz3DObject,-10,8,4
EntityColor Blitz3DObject,255,255,255

; ### ODE Static Object (Blue)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,2,8,40)
dGeomSetPosition(ode\geom,20,5,40)
dGeomSetRotation(ode\geom,-10,8,4)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,1,4,20
EntityColor ode\mesh,0,100,200

; ### ODE Static Object (Red)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,18,0.2,40)
dGeomSetPosition(ode\geom,-20,4.9,40)
dGeomSetRotation(ode\geom,-14,0,0)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,0.1,20
EntityColor ode\mesh,200,0,100

; ###################################################################################################

SetupCar()

While Not KeyHit(1)

        UpdateKeys()

        UpdateCar()

        UpdateGeoms()

        PTime=MilliSecs()

        dSpaceCollide(Space,World,ContactGroup)
        dWorldQuickStep(World,0.1)
        dJointGroupEmpty(ContactGroup)

        PhysicsTime#=MilliSecs()-PTime

        UpdateCam()

        RenderWorld

        Text 0,0,"JV-ODE Version "+dGetVersion()
        Text 0,15,"Physics Time:"+PhysicsTime
        Text 0,50,"Force:"+Force
        Text 0,65,"Torque:"+Torque
        Text 640,0,"A - Accelerate"
        Text 640,15,"Z - Brake/Reverse"
        Text 640,30,"Arrows - Steering"
        Text 640,45,"Space - Reset Car"

        Flip 1

Wend

;dJointGroupDestroy(ContactGroup)
;dSpaceDestroy(Space)
;dWorldDestroy(World)
;dCloseODE()

ClearWorld
Goto restart


















End

; ###################################################################################################

Function SetupCar()

For count=1 To 4
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
	If count&gt;2
		dJointSetHinge2Param(Joint(count),dParamLoStop,0)
		dJointSetHinge2Param(Joint(count),dParamHiStop,0)
		End If
Next

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyDown(30)=1
	Force=Force+0.08
	If Force&gt;30 Then Force=30
	End If

If KeyDown(44)=1
	Force=Force-0.1
	If Force&lt;-10 Then Force=-10
	If Force&gt;0 Then Force=Force*0.97
	End If

If KeyDown(30)=0 And KeyDown(44)=0 Then Force=Force*0.99

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=0.5
		Else
		Steer=-0.5
		End If
	Else
	Steer=0.0
	End If

If KeyHit(57)=1
	Force=0.0
	dBodySetRotation(Car,dGeomGetPitch(CGeom),dGeomGetYaw(CGeom),0)
	End If

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 4
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

End Function

; ###################################################################################################

Function UpdateCam()

PositionEntity Camera,0,3,-12

PivotX#=Cos(EntityYaw(CMesh)-90)+EntityX(CMesh)
PivotY#=EntityY(CMesh)
PivotZ#=Sin(EntityYaw(CMesh)-90)+EntityZ(CMesh)

PositionEntity CameraPivot,PivotX,PivotY,PivotZ

PointEntity CameraPivot,CMesh

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	PositionEntity ode\mesh,dGeomGetPositionX(ode\geom),dGeomGetPositionY(ode\geom),dGeomGetPositionZ(ode\geom)
	RotateEntity ode\mesh,dGeomGetPitch(ode\geom),dGeomGetYaw(ode\geom),dGeomGetRoll(ode\geom)
Next

End Function

; ###################################################################################################
</textarea><br><br>why it doesn't work well ?<br>What's mean Bad arguments (..\..\ode\src\ode.cpp:1723) <br><br></td></tr></table><br>
<a name="951259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#158">[#158]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're getting errors due to the fact you regenerate a simulation (World) without first deleting the previous simulation...<br><br><pre class=code>
;dJointGroupDestroy(ContactGroup)
;dSpaceDestroy(Space)
;dWorldDestroy(World)
;dCloseODE()
</pre><br>...those should be called before creating a new simulation. You also need to delete any 'ODEGeom' type instances used.<br><br>Please note it is very bad practice to use a goto loop in that manner. For example, you're repeatedly recalling the following...<br><br><i>Graphics3D 320,240,0,2<br>Graphics3D 800,600,0,2<br>Include "JV-ODE.bb"<br>dInitODE()</i><br><br>...which are only required once during runtime. You only need to call 'Graphics3D' again if you use 'End Graphics' to close the previous Graphics3D mode.<br><br>Try to structure the code well or you'll run into all kinds of problems ;) <br><br></td></tr></table><br>
<a name="951544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#159">[#159]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi VIP3R, <br><br>[edit] fixed that somewhat lengthy problem by taking the kids to a theme park for the day, having some red wine, firing up UU3D and actually resizing my gargantuan wheels.  I am still intrigued about struggling to dip the scaleentity below 0.7....<br><br>If you know of a reason wht I'd be happy to know - however I have a new issue - my rig/cab does not steer anymore - contrary to what the image with the small wheels shows - the cab at an angle is as a result of a head on collision.<br><br>Can you please let me know why my steerage is ineffectual, the front wheels are certainly steering - but it is as though they have no traction other than Forwards....?<br><br>I will delete the excessive text below and the images to stop this thread being bloated - it'd be nice to resolve the steerage problem. Cheers.<br><br>I've been having a bit of fun this morning importing somewheels I made and attempting to attach them to the truck cab, have had limited success but cannot seem to scale the scale and wheel vars below 0.7?  <br><br>[EDIT... snip snip] <br><br></td></tr></table><br>
<a name="951740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#160">[#160]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, don't change any ODE code/dimensions from the demo if you want it to behave the same.<br><br>To add a custom mesh like the wheels, replace the Blitz cylinder meshes only and set their scale with ScaleMesh (not ScaleEntity), you shouldn't need to change anything else. Doing this will not affect the steering or handling in any way.<br><br>The confusion you're getting into is down to the scales of the custom wheel mesh vs the Blitz/ODE geometry. You need to make your wheel meshes the same dimensions as the Blitz cylinder at 'full size' first (it should be 1.0 unit tall, not 0.7). Then, scale them in code down to 0.7 with ScaleMesh to match the ODE geom dimensions (like the demo).<br><br>If your wheel mesh dimensions are correct, the original Blitz cylinder and your wheel mesh should match when both are displayed at the same scale. <br><br></td></tr></table><br>
<a name="951847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#161">[#161]</a></td></tr></table></td></tr><tr ><td class="posttext"> @VIP3R, thanks for the extra clarification - of to check my wheels/meshes dimensions out, after going shopping with the Mrs.... <br><br></td></tr></table><br>
<a name="952006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#162">[#162]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, forgot to mention... make sure the wheel mesh is centered properly in your 3D modelling software too, otherwise it may cause the mesh to offset incorrectly when scaled using ScaleMesh. <br><br></td></tr></table><br>
<a name="953547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#163">[#163]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi..<br><br>i wan't to know about mass...<br><br>If i have a car that weighs 1800 Kg,what is the correct mass for the car..<br><br>where i can find some to read about that? is newton physics?<br><br><br>regards... <br><br></td></tr></table><br>
<a name="953679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#164">[#164]</a></td></tr></table></td></tr><tr ><td class="posttext"> All weights are relative, for example it depends on things like the gravity value used.<br><br>The JV-ODE demos use a value of 0.98 Newtons per Kg for gravity, which is a tenth of the real value (9.81 Newtons). A lower value is used as it helps with stability and accuracy of the simulation.<br><br>If you're using the same gravity as the demos (0.98), for a car that weighs 1800 Kg the correct mass value would be 18000 Kg (multiplied by ten because gravity is a tenth). If you're using the real gravity value of 9.81, it would be 1800 Kg.<br><br>As it's relative, other settings can be affected, like spring tension/compression (car suspension) and physics timing (the stepping values). <br><br></td></tr></table><br>
<a name="954484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Play</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#165">[#165]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm searching, and searching and i can't find anything.<br>Which is the easiest way to create nice explosian efect ?<br>Something like this <a href="http://www.youtube.com/watch?v=AV4gSVB7IZ4" target="_blank"> click</a> <br><br></td></tr></table><br>
<a name="954591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#166">[#166]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, there are several ways. One way is to apply a force on the surrounding objects based on their distance and angle from the source of the explosion.<br><br>The easiest way though is to cheat, create a very small sphere at the center of the explosion with lots of mass, then rapidly increase its size so that it pushes all surrounding objects away. Attach the sphere to the world using a ball joint to prevent it moving about when it collides. <br><br></td></tr></table><br>
<a name="954859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#167">[#167]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi VIP3R, I want to hide the 'pond' that I am creating at a specfic point in my game, tried this to no avail:<br><br>	;hide the pond<br>	HideEntity CapsuleGeom(1)<br><br><br>how do I identify it?<br><br>;createpond<br>	ode.ODEGeom=New ODEGeom<br>	ode\body=dBodyCreate(World)<br>	dBodySetRotation(ode\body,90,0,0)<br>	dBodySetPosition(ode\body,100,2,2800)<br>	;ode\geom=dCreateCapsule(Space,1,8)<br>	ode\geom=dCreateCapsule(Space,1,8)<br>	CapsuleGeom(1)=ode\geom<br>	dGeomSetBody(ode\geom,ode\body)<br>	ode\mesh=CreateCylinder(24)<br>	ScaleMesh ode\mesh,20,1,20<br>	RotateMesh ode\mesh,90,0,0	; &lt;&lt;&lt; Mesh X-Axis must be rotated 90 degrees to fix cylinder alignment<br>	PositionMesh ode\mesh,0,0,0<br>	EntityTexture  ode\mesh,WaterTexture<br>	;EntityColor ode\mesh,Rnd(255),Rnd(255),Rnd(255)<br>	EntityAlpha ode\mesh,1<br>	EntityShininess ode\mesh,0.7<br>;endpond <br><br></td></tr></table><br>
<a name="954903"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#168">[#168]</a></td></tr></table></td></tr><tr ><td class="posttext"> It needs to be the Blitz entity (ode\mesh), not the ODE geom (ode\geom)...<br><br><i><br>ode\mesh=CreateCylinder(24)<br>CapsuleGeom(1)=ode\mesh<br>HideEntity CapsuleGeom(1)<br></i> <br><br></td></tr></table><br>
<a name="955021"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#169">[#169]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi :)<br><br>im working in improving the race car game...<br><br>this car body, with the wheels inside can give me problems with ode? or is ok for ode ?<br><br>in the samples allways you car have all wheels outside of the car body<br><br><br><br><img src="http://img18.imageshack.us/img18/9247/odecar.jpg"> <br><br></td></tr></table><br>
<a name="955071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#170">[#170]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, it's fine to have the wheels inside the car body. <br><br></td></tr></table><br>
<a name="955115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#171">[#171]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks VIP3R. <br><br></td></tr></table><br>
<a name="956330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#172">[#172]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R, I've created a trailer like this now, my aspiration (yes, I know I've got high hopes....)  is to make the elevated section within the trailer super slippy on top so that as soon as it starts elevating (it will happen slowly... probably both in implementation and execution!) the objects that are on it will slide of the back.<br><br>A question I have is that for the side pillars, should I create 'imaginary' codified boxes which are the length of the trailer walls rather than attempt to create individual pillars of space within JV-ODE ?<br><br><img src="http://www.wishingwellsoftware.co.uk/tiptrail.jpg"> <br><br></td></tr></table><br>
<a name="956458"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#173">[#173]</a></td></tr></table></td></tr><tr ><td class="posttext"> It depends on how you want the objects to behave if they collide with the sides. Go for the pillars if you don't mind objects getting snagged on them, or if you want a smooth slide then put solid (invisible) walls in place.<br><br>It won't make much difference speed wise on an individual truck so it will be okay either way in that respect ;) <br><br></td></tr></table><br>
<a name="956500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#174">[#174]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess maybe this was in the worng place, but here's a question for VIP3R regarding JV-ODE<br><br><a href="http://blitzbasic.com/Community/posts.php?topic=83553" target="_blank">http://blitzbasic.com/Community/posts.php?topic=83553</a> <br><br></td></tr></table><br>
<a name="956513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#175">[#175]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't visit the Content Creation Tools forum much, so I missed it.<br><br>Replied now though ;) <br><br></td></tr></table><br>
<a name="958050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#176">[#176]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi vip3r, i want to know something..<br><br>you allways give answers, fast, and you realy give solution to our problems about ode knowldge..<br><br>my question is, you write ode?, or is a comunity program?, becouse i see other ode, or newton physics system... but you are the only who nows all about ode.<br><br>i relative new in this community, 1 year... i realy ultra happy of this product, jv-ode is for me the big tool to make good games... and i want to thank you the fact you allways check this forum to give answers..<br><br>another question, i see flight simulator use ODE, for physics. how is that?, use ode for the flight simuation?, or they use ode for simulate the landing land part?<br><br>regards, and thanks! <br><br></td></tr></table><br>
<a name="958208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#177">[#177]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome and thanks :)<br><br>I didn't write ODE itself, you really need to know your stuff to build a physics library. It was originally created by Russell Smith and is now kept updated by a few contributors. All ODE libraries/wrappers are based around the same core ODE library. Newton is a separate physics library.<br><br>I would say there are a few folks here who know ODE well, having worked on JV-ODE for 4 years I've gained a lot of experience with it - hence the (mostly) fast solutions.<br><br>The flight simulators probably use ODE for stuff like thrust control, inertia response etc. They would need to add things like air resistance/drag themselves though because ODE doesn't simulate that. <br><br></td></tr></table><br>
<a name="958885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#178">[#178]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi, i have a problem, i made some changes in my program, now ode say "stack overflow" runtime error, in the line dworldquitckstep(world,0.1)<br><br>what could it be? <br><br></td></tr></table><br>
<a name="958887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#179">[#179]</a></td></tr></table></td></tr><tr ><td class="posttext"> ups, i find the solution... in another post... :)<br><br><div class="quote"> A stack overflow in ODE will happen if too many objects overlap when created. It causes too many collision contacts during the stepping process.<br> <br></div><br><br>regards!. <br><br></td></tr></table><br>
<a name="959810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#180">[#180]</a></td></tr></table></td></tr><tr ><td class="posttext"> got a problem with dMassTranslate()...it has no effect at all :)<br><br>is that the correct order for applying masses?<br><pre class=code>
mass = dMassCreate()
dMassSetBoxTotal( mass, massval, masswidth,massheight,massdepth )
dBodySetMass( ODEbody, mass )
dMassTranslate( mass, massOffsetX,massOffsetY,massOffsetZ )
dMassDestroy( mass )
</pre><br><br>if i call dMassTranslate() before dBodySetMass() i get a "ode internal error 2: the centre of mass must be at the origin (ode.cpp:500)"<br><br>i need to offset the mass since i got an object that has several collision shapes, which are offsetted itself...<br><br>*help* :) <br><br></td></tr></table><br>
<a name="959841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#181">[#181]</a></td></tr></table></td></tr><tr ><td class="posttext"> This was asked up there (posts #40 - #41) ^ :)<br><br><a href="http://www.blitzmax.com/Community/posts.php?topic=79489#904902" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=79489#904902</a><br><br>If you need more info let me know. <br><br></td></tr></table><br>
<a name="959868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#182">[#182]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm...i must admit, i dont quite get it ^^<br>and the sample you mensioned uses geomtransforms, which are marked as depreciated :/<br><br>also, the sample seems to do something different from what you told in your explanation<br><br>thats, what the sample does:<br>- moving the geoms like wanted<br>- translating the mass the same amount like the geoms<br>- moving the geoms the averaged amount back plus its original position (?)<br>- translating the mass the averaged amount back (?)<br><br>but how do i now get the geoms to exactly that position i want?<br><br>really confusing... :/<br><br><br>small sample code? =)<br><br><br><br>PS: got my mail regarding the trimesh-sphere collision problem? <br><br></td></tr></table><br>
<a name="959888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#183">[#183]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I agree, it's very confusing.<br><br>Geom Transforms are depreciated and have been replaced by Geom Offsets which are easier to use. Either method applies in this scenario so it's irrelevant.<br><br>I would suggest ignoring the dMassTranslate method as it doesn't do what you want it to do (offset the mass), it only centers/resets the mass. That's why the ODE authors admitted its function name was misleading (and confusing).<br><br>To move the center of gravity you create the body and geom normally, then add some mass. Now, to move the mass all you need to do is offset the geometry. It's the reverse of what you're trying to do with mass translate, we move the geom not the body/mass, but in doing so it will move the center of gravity.<br><br>Take a look at this modified CarDemo-SeeSaw demo...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; ###################################################################################################
; #                                        JV-ODE Car Demo                                          #
; #                                  Code by Jim Williams (VIP3R)                                   #
; #                              Devious Codeworks - Copyright © 2008                               #
; ###################################################################################################

Include "JV-ODE.bb"

AppTitle "JV-ODE Car Demo - SeeSaw"

Graphics3D 800,600,0,2

Global CMass#=200.0				; ### Car Mass
Global WMass#=14.0				; ### Wheel Mass
Global RampMass#=100.0			; ### Ramp Mass

Global WorldERP#=1.0			; ### World Error Correction
Global WorldFriction#=70.0		; ### World Friction

Global Torque#=24.0				; ### Joint Torque
Global SuspensionHS#=0.01		; ### Suspension Hardness/Softness (Higher=Softer - Lower=Harder)

Global Force#=0.0
Global Steer#=0.0

Global Car
Global CGeom
Global CMesh

Global CarStartY=20

Dim Wheel(4)
Dim WGeom(4)
Dim Joint(4)

Type ODEGeom
	Field body
	Field geom
	Field mesh
End Type

; ###################################################################################################

; ### Setup ODE

dInitODE()

Global World=dWorldCreate()
Global Space=dHashSpaceCreate(0)
Global ContactGroup=dJointGroupCreate(0)

dWorldSetAutoDisableFlag(World,1)
dWorldSetGravity(World,0,-0.98,0)
dWorldSetERP(World,WorldERP)

dContactSetMode(dContactSlip1)
dContactSetMu(WorldFriction)

; ### Create Car Body

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
Car=ode\body
dBodySetPosition(ode\body,0,CarStartY,0)
dBodySetRotation(ode\body,0,0,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,CMass,3,1,4)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,3,1,4)
CGeom=ode\geom
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
CMesh=ode\mesh
ScaleMesh ode\mesh,1.5,0.5,2
EntityColor ode\mesh,40,80,255

; ### Create Wheels

For count=1 To 4
	ode.ODEGeom=New ODEGeom
	ode\body=dBodyCreate(World)
	Wheel(count)=ode\body
	dBodySetPosition(ode\body,0,0,0)
	dBodySetRotation(ode\body,0,0,90)
	mass=dMassCreate()
	dMassSetSphereTotal(mass,WMass,0.7)
	dBodySetMass(ode\body,mass)
	dMassDestroy(mass)
	ode\geom=dCreateSphere(Space,0.7)
	WGeom(count)=ode\geom
	dGeomSetBody(ode\geom,ode\body)
	ode\mesh=CreateCylinder()
	ScaleMesh ode\mesh,0.7,0.25,0.7
	EntityColor ode\mesh,255,255,255
Next

dBodySetPosition(Wheel(1),-2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(2),+2,CarStartY-0.5,+2)
dBodySetPosition(Wheel(3),-2,CarStartY-0.5,-2)
dBodySetPosition(Wheel(4),+2,CarStartY-0.5,-2)

; ### Create Light

Global Light=CreateLight()
RotateEntity Light,50,-50,0
LightColor Light,255,255,255
AmbientLight 130,130,130

; ### Create Camera

Global CameraPivot=CreatePivot()

Global Camera=CreateCamera(CameraPivot)
CameraClsColor Camera,0,0,0
CameraRange Camera,1,1000

; ### Create Plane

dCreatePlane(Space,0,1,0,0)

Global Plane=CreatePlane()
EntityAlpha Plane,0.8

EntityTexture Plane,PlaneTexture()

CreateMirror()

; ###################################################################################################

; ### Blitz3D Static Object (White)

Global Blitz3DObject=CreateCube()
ScaleMesh Blitz3DObject,1,4,20
PositionEntity Blitz3DObject,10,5,40
RotateEntity Blitz3DObject,-10,8,4
EntityColor Blitz3DObject,255,255,255

; ### ODE Static Object (Blue)

ode.ODEGeom=New ODEGeom
ode\geom=dCreateBox(Space,2,8,40)
dGeomSetPosition(ode\geom,20,5,40)
dGeomSetRotation(ode\geom,-10,8,4)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,1,4,20
EntityColor ode\mesh,0,100,200

; ###################################################################################################

; ### Ramp (Red)

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
RampBody=ode\body
;dBodySetPosition(ode\body,-20,5,40) ; ### Original position
dBodySetPosition(ode\body,-20,5,30) ; ### Move ramp back by offset amount (10 units)
dBodySetRotation(ode\body,0,0,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,RampMass,18,0.2,40)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,18,0.2,40)
dGeomSetBody(ode\geom,ode\body)

dGeomSetOffsetPosition(ode\geom,0,0,10) ; ### Offset the ramp by 10 units

ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,0.1,20
EntityColor ode\mesh,200,0,100

; ### Ramp Base (Purple)

ode.ODEGeom=New ODEGeom
ode\body=dBodyCreate(World)
BaseBody=ode\body
dBodySetPosition(ode\body,-20,2.5,40)
dBodySetRotation(ode\body,0,0,0)
mass=dMassCreate()
dMassSetBoxTotal(mass,RampMass,18,5,0.5)
dBodySetMass(ode\body,mass)
dMassDestroy(mass)
ode\geom=dCreateBox(Space,18,5,0.5)
dGeomSetBody(ode\geom,ode\body)
ode\mesh=CreateCube()
ScaleMesh ode\mesh,9,2.5,0.25
EntityColor ode\mesh,200,0,200

; ### Ramp Joints

StaticJoint=dJointCreateFixed(World,0)	; ### Fix Base To ODE World
dJointAttach(StaticJoint,0,BaseBody)
dJointSetFixed(StaticJoint)

HJoint=dJointCreateHinge(World,0)
dJointAttach(HJoint,RampBody,BaseBody)
dJointSetHingeAxis(HJoint,1,0,0)
dJointSetHingeAnchor(HJoint,-20,5,40)
dJointSetHingeParam(HJoint,dParamLoStop,-0.4)
dJointSetHingeParam(HJoint,dParamHiStop,0.4)

; ### Roll Ramp

;dJointSetHingeParam(HJoint,dParamVel,-10)
;dJointSetHingeParam(HJoint,dParamFMax,20)

; ###################################################################################################

SetupCar()

While Not KeyHit(1)

	UpdateKeys()

	UpdateCar()

	UpdateGeoms()

	PTime=MilliSecs()

	dSpaceCollide(Space,World,ContactGroup)
	dWorldQuickStep(World,0.1)
	dJointGroupEmpty(ContactGroup)

	dBodyEnable(RampBody)

	PhysicsTime#=MilliSecs()-PTime

	UpdateCam()

	RenderWorld

	Text 0,0,"JV-ODE Version "+dGetVersion()
	Text 0,15,"Physics Time:"+PhysicsTime
	Text 0,50,"Force:"+Force
	Text 0,65,"Torque:"+Torque
	Text 640,0,"A - Accelerate"
	Text 640,15,"Z - Brake/Reverse"
	Text 640,30,"Arrows - Steering"
	Text 640,45,"Space - Reset Car"

	Flip 1

Wend

dJointGroupDestroy(ContactGroup)
dSpaceDestroy(Space)
dWorldDestroy(World)
dCloseODE()

End

; ###################################################################################################

Function SetupCar()

For count=1 To 4
	Joint(count)=dJointCreateHinge2(World,0)
	dJointAttach(Joint(count),Car,Wheel(count))
	dJointSetHinge2Anchor(Joint(count),dBodyGetPositionX(Wheel(count)),dBodyGetPositionY(Wheel(count)),dBodyGetPositionZ(Wheel(count)))
	dJointSetHinge2Axis1(Joint(count),0,1,0)
	dJointSetHinge2Axis2(Joint(count),-1,0,0)
	dJointSetHinge2Param(Joint(count),dParamSuspensionERP,0.8)
	dJointSetHinge2Param(Joint(count),dParamSuspensionCFM,SuspensionHS)
	If count&gt;2
		dJointSetHinge2Param(Joint(count),dParamLoStop,0)
		dJointSetHinge2Param(Joint(count),dParamHiStop,0)
		End If
Next

End Function

; ###################################################################################################

Function UpdateKeys()

If KeyDown(30)=1
	Force=Force+0.08
	If Force&gt;30 Then Force=30
	End If

If KeyDown(44)=1
	Force=Force-0.1
	If Force&lt;-10 Then Force=-10
	If Force&gt;0 Then Force=Force*0.97
	End If

If KeyDown(30)=0 And KeyDown(44)=0 Then Force=Force*0.99

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=0.5
		Else
		Steer=-0.5
		End If
	Else
	Steer=0.0
	End If

If KeyHit(57)=1
	Force=0.0
	dBodySetRotation(Car,dGeomGetPitch(CGeom),dGeomGetYaw(CGeom),0)
	End If

End Function

; ###################################################################################################

Function UpdateCar()

For count=1 To 4
	dBodyEnable(Wheel(count))
Next

dBodyEnable(Car)

For count=1 To 4
	dJointSetHinge2Param(Joint(count),dParamVel2,Force)
	dJointSetHinge2Param(Joint(count),dParamFMax2,Torque)
Next

For count=1 To 2
	angle#=Steer-dJointGetHinge2Angle1(Joint(count))
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next

End Function

; ###################################################################################################

Function UpdateCam()

PositionEntity Camera,0,3,-12

PivotX#=Cos(EntityYaw(CMesh)-90)+EntityX(CMesh)
PivotY#=EntityY(CMesh)
PivotZ#=Sin(EntityYaw(CMesh)-90)+EntityZ(CMesh)

PositionEntity CameraPivot,PivotX,PivotY,PivotZ

PointEntity CameraPivot,CMesh

End Function

; ###################################################################################################

Function UpdateGeoms()

For ode.ODEGeom=Each ODEGeom
	PositionEntity ode\mesh,dGeomGetPositionX(ode\geom),dGeomGetPositionY(ode\geom),dGeomGetPositionZ(ode\geom)
	RotateEntity ode\mesh,dGeomGetPitch(ode\geom),dGeomGetYaw(ode\geom),dGeomGetRoll(ode\geom)
Next

End Function

; ###################################################################################################
</textarea><br><br>Normally the demo adds a small continuous hinge force to roll the ramp. In the version above, the forces are commented out. Instead, the ramp geom has been offset by 10 units on the z-axis. This means the center of gravity/mass has shifted back by 10 units, making the ramp heavier on the closest side to the camera.<br><br>If you comment out the geom offset and move the ramp back to its original position, you will see it balances as the mass is centered.<br><br>Now you need to apply that method to your object, move all of the geometry to offset it from the body/mass.<br><br>Btw, I haven't received your latest email. The last one I received was about the mesh with collision holes. <br><br></td></tr></table><br>
<a name="959980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#184">[#184]</a></td></tr></table></td></tr><tr ><td class="posttext"> ah ok, got it working...had to fiddle around a bit, because dbodysetposition() takes global coords, and dgeomsetoffsetposition() local ones, but thanks to blitz' tformvector() this was a piece of cake... (after i found out about the global/local thing of course ^^)<br><br>thx a ton!<br><br><br>as for my mail: if its too much work to reproduce the problem for yourself, you may just ignore it for now...ill try to pinpoint it down with a smaller scale sample the next days...<br><br><br><br>just a small side note: <br><pre class=code>dJointSetHinge2Param(Joint(count),dParamFMax,400)</pre><br>doesnt make much sense, because "dParamFMax" is a 0.0..1.0 value ;)<br>at least it seems so, because any value higher than 1 doesnt change anything for the speed of steering in a hinge2 joint...this is a "problem" im currently working on too:<br>there seems to be no possibilty to increase the speed of steering above a hard coded value in the hinge2 joint...any ideas? <br><br></td></tr></table><br>
<a name="960116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#185">[#185]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>doesnt make much sense, because "dParamFMax" is a 0.0..1.0 value ;)<br>at least it seems so, because any value higher than 1 doesnt change anything for the speed of steering in a hinge2 joint<br> <br></div><br>Eh?<br><br>The range of dParamFMax is 0.0 to dInfinity.<br><br>It doesn't change the speed, it sets the maximum force/torque the joint motor is allowed to use in order to run up to the required speed.<br><br>dParamVel sets the speed on a joint motor. <br><br></td></tr></table><br>
<a name="960126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#186">[#186]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi :)..<br>i need some help..<br><br>i have a problem with a ode car, the car wheels bounce like crazy...<br><br>i have a ode menu, with one ode car...<br>i start the race, with a new ode, destroying all ode data...<br><br>but when i restart the menu, creating a ode world, car, and dplane, the car bounce like crazy..<br><br>to restart and clear the world and ode data i use this commands...<br><br><pre class=code>
	
	For ode.ODEGeom=Each ODEGeom
		Delete ode
	Next
	
	For car.car = Each car
		Delete car
	Next
	
	dJointGroupDestroy(ContactGroup)
	dSpaceDestroy(Space)
	dWorldDestroy(World)
	dCloseODE()

</pre><br><br>why might be this happening? the car never stop of bounce and jump like an mexican car :)<br><br>the strange thing is, always happend after the first time i run the menu..<br><br><br>i use this code to create the ode world..<br><pre class=code>
Global WorldERP#			
Global WorldFriction#	
Global World
Global Space
Global ContactGroup


	WorldERP#		= 1		
	WorldFriction#	= 60
	dInitODE()
	World=dWorldCreate()
	Space=dHashSpaceCreate(0)
	ContactGroup=dJointGroupCreate(0)
	dWorldSetAutoDisableFlag(World,0)
	dWorldSetGravity(World,0,-1.98,0)
	dWorldSetERP(World,WorldERP)
	dContactSetMode(dContactSlip1)
	dContactSetMu(WorldFriction)
	dWorldSetContactSurfaceLayer(World,.01)
</pre> <br><br></td></tr></table><br>
<a name="960147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#187">[#187]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, very strange. It sounds like something hasn't been deleted properly.<br><br>Try manually deleting all of the bodies, geoms, trimeshes and joints with the following functions, -before- deleting the jointgroup/space/world...<br><i><br>dBodyDestroy(body)<br>dGeomDestroy(geom)<br>dGeomTriMeshDataDestroy(trimeshdata)<br>dJointDestroy(joint)<br></i><br>If that doesn't help, you might need to re-use the world/space instead of deleting everything and re-initialising ODE. <br><br></td></tr></table><br>
<a name="960155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#188">[#188]</a></td></tr></table></td></tr><tr ><td class="posttext"> can i use the same world if i use clearworld 1,1,1?<br><br>thanks vip3r... <br><br></td></tr></table><br>
<a name="960160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#189">[#189]</a></td></tr></table></td></tr><tr ><td class="posttext"> ClearWorld only applies to Blitz entities and will have no effect on an ODE world.<br><br>In the post above, I'm referring to ODE worlds only. <br><br></td></tr></table><br>
<a name="960238"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#190">[#190]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Eh?<br><br>The range of dParamFMax is 0.0 to dInfinity.<br><br>It doesn't change the speed, it sets the maximum force/torque the joint motor is allowed to use in order to run up to the required speed.<br><br>dParamVel sets the speed on a joint motor.  <br></div><br><br>but dParamVel is used in your car demos to set the steering angle...? does it have another meaning if used on a hinge2 joint? what could i do about to change the speed of steering? tried nearly all joint parameters and a lot of combinations, without any success yet. sincerly, the ode docs are not very helpful on that... :(<br><br>sorry to bug you about this...but im really trying to understand it :/ <br><br></td></tr></table><br>
<a name="960412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#191">[#191]</a></td></tr></table></td></tr><tr ><td class="posttext"> No problem ;)<br><br>dParamVel sets the speed at which the joint motor will run, this applies to the first axis of any joints including the hinge2.<br><br>In the demos, the steering works by increasing/reducing the speed depending on the current angle of the joint axis, it will eventually stop as the Hinge2Angle1 and Steer values cancel each other out.<br><br>To change the speed of the steering in the demos, you have to increase two values. First is the 'Steer' value in the UpdateKeys() function. The second is the 'Hinge2Angle1' value in the UpdateCars() function.<br><br>If you want the speed of the steering 10x faster, you multiply both values by 10, like so...<br><pre class=code>
; ### UpdateKeys()

If KeyDown(203)=1 Or KeyDown(205)=1
	If KeyDown(203)=1
		Steer=5 ; &lt;&lt;&lt; HERE (0.5 * 10)
		Else
		Steer=-5 ; &lt;&lt;&lt; HERE (0.5 * 10)
		End If
	Else
	Steer=0.0
	End If

; ### UpdateCar()

For count=1 To 2
	angle#=Steer-(dJointGetHinge2Angle1(Joint(count))*10) ; &lt;&lt;&lt; HERE
	dJointSetHinge2Param(Joint(count),dParamVel,angle)
	dJointSetHinge2Param(Joint(count),dParamFMax,400)
Next
</pre><br>At this speed the steering is almost instant, it won't go much faster though because the values won't cancel each other out properly causing the wheels to spin erratically.<br><br>So there's no difference between each axis in the joint, we are just preventing the steering axis from turning when it reaches a certain limit based on the angle. If you remove the <i>dJointGetHinge2Angle1(Joint(count))</i> function from the equation, you will see the wheels then turn continuously like they do on the second (rolling) axis. <br><br></td></tr></table><br>
<a name="960487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#192">[#192]</a></td></tr></table></td></tr><tr ><td class="posttext"> ah great...seems like i misunderstood the whole steering concept :D<br>i really thought "dJointSetHinge2Param(Joint(count),dParamVel,angle)" would set the actual ANGLE of the steering wheel...but now i understand that this sets the velocity the REACH the desired angle! got a bit mislead by the variable "angle#" here...<br><br>ok, now all this makes more sense to me...thanks again!<br><br>surprisingly all my steering code i wrote to date (including calculating steering limits from degrees!) seemed to worked perfectly well, now i dont understand why, but it did...except from the ability to define the speed of steering of course ^^<br>anyway...rewrote it now, so it reflects the correct way of doing it and it works equally well including the steering speed, excellent! :)<br><br>now on to the trimesh collision stuff.......you may hear from me soon again... =D <br><br></td></tr></table><br>
<a name="963821"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#193">[#193]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi VIP3R, I'm looking at creating a hinged door on the back of an articulated trailer flatbed.  I am analysing the zombie code to try and see how 'hinges' are implemented, but any assistance you could provide with code between two cuboids that would lock a vertical cuboid(the door) to a horizontal cuboid(the trailer floor) at 90 degrees until the 'move door' key press, then the door would rotate down, on the hinge until it hits the floor.  Then, the same key press would rotate the door back up again until it reaches the vertical whereby the door would ' shut' on the back of the trailer.  Quite an in depth question, I have looked at various door examples in Blitz 3D but none of them are parenting/hinging a door top the back of a flatbed. Sorry if I ask too much.....  I've so far added a setup bones function, although at this point I'm not sure of the relevance of the numbering system related to bones:<br><br><pre class=code>
Function SetupBones()

SetBone(1)=1		; ### Left hand side of door to flatbed rear left hand side (lower)
SetBone(2)=2		; ### Right hand side of door to flatbed rear right hand side (lower)

end function

</pre><br><br>I am attempting to analyse the setupnodes function but it is a bit beyond me at the moment....., am also analysing the cloth demo within thread 10 for sphere conections.... <br><br></td></tr></table><br>
<a name="963864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#194">[#194]</a></td></tr></table></td></tr><tr ><td class="posttext"> Forget the bones stuff, that was used for the animated mesh (zombie model).<br><br>Have a look at the CarDemo-SeeSaw demo, the ramp uses a hinge joint with a continuous force pushing the ramp down on one side.<br><br>To create your door, add the door body/geom/mesh in the closed position on your trailer. Now create the hinge joint and anchor it at the base of the door. You only need one joint, but you can use two if you want. Set the required axis with 1 or -1 to allow movement on one axis only (X, Y or Z).<br><br><i>dJointSetHingeAxis(Joint,1,0,0)</i><br><br>Now add some joint motor stops to restrict the motion of the door. You only want the door to open outwards so keep the 'LoStop' at zero (the start position), then set the 'HiStop' to the maximum angle you want it open to (normally the ground should stop it before it reaches this stop). The angles used here are in radians, not degrees.<br><br><i>dJointSetHingeParam(Joint,dParamLoStop,0)<br>dJointSetHingeParam(Joint,dParamHiStop,2)</i><br><br>To move it up/down, just add force and torque to the joint motor with...<br><br><i>dJointSetHingeParam(Joint,dParamVel,force#)<br>dJointSetHingeParam(Joint,dParamFMax,torque#)</i><br><br>There are several ways to lock the door shut, you can apply a continuous force/torque to hold it shut. Or, detect the angle of the joint and apply zero force with lots of torque to lock it into position.<br><br>To allow it to move freely, you would use zero force and zero torque.<br><br>If you need more help with it, let me know. <br><br></td></tr></table><br>
<a name="963870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#195">[#195]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thankyou for the swift feedback VIP3R, very much appreciated - if I was on the PC that had B3D on it I'd try your solution now. I'll try implementing it tomorrow, I'm tempted to do it now but family duties need tending (;-) <br><br></td></tr></table><br>
<a name="965111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#196">[#196]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi vip3r..<br><br>i goint to try to reuse my ode world in my game...<br><br>the question i have, is , which one is the correct way to delete for example, my race car, and track to use the same world in the menu...<br><br>there is an example of deleting ode objects in the ode samples?<br><br>regars! <br><br></td></tr></table><br>
<a name="965146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#197">[#197]</a></td></tr></table></td></tr><tr ><td class="posttext"> The correct way is the reverse order in which they were created, for example...<br><br>Create Order:<br>Type Reference<br>Body<br>Geoms<br>Meshes<br>Joints<br><br>Delete Order:<br>Joints<br>Meshes<br>Geoms<br>Body<br>Type Reference <br><br></td></tr></table><br>
<a name="965249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Santiworld</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#198">[#198]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks vip3r....  :) very important data..<br><br><br>another thing.. i finish the first downloable version of the game..<br>i am using ode, sometimes, the cars come crazy and start to bounce...<br>we talk in this post about that...<br><br>please, can you play the game, and help me with that?..<br><br>to download the game...<br>www.simplerace.com.ar   in download links.<br><br>i post a topic about the bugs of the game and advices here<br><a href="http://blitzbasic.com/Community/posts.php?topic=85344" target="_blank">http://blitzbasic.com/Community/posts.php?topic=85344</a><br><br>regards, and thanks for the learning... this post of jvode is like a school for me... :) thanks.. <br><br></td></tr></table><br>
<a name="965281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#199">[#199]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've downloaded and tried the demo. Excellent work so far.<br><br>The only bouncing I noticed was when the car goes over the joints in the track mesh. It seems quite minor to me, is that the bouncing you mean? The only cure for that would be to smooth the ridges of the mesh joints. Are the mesh triangles large?<br><br>Do you have a wireframe option in the demo? It might make the diagnosis easier.<br><br>A couple of other things I noticed...<br>The demo crashes after completing a race (2 laps) with a 'Userlib not found' error.<br>The SimpleRace website button on the right says 'DONWLOAD' instead of 'DOWNLOAD'. <br><br></td></tr></table><br>
<a name="965284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#200">[#200]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>THREAD 11 IS ABOUT TO CLOSE</b><br><br>Please continue on the new thread located <a href="/posts.php?topic=85346" target="_blank">here</a><br><br>Thanks :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
