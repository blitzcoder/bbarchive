<!DOCTYPE html><html lang="en" ><head ><title >ODE - Axis rotation nightmare (need math help)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ODE - Axis rotation nightmare (need math help)</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >ODE - Axis rotation nightmare (need math help)</a><br><br>
<a name="690815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I'm in desperate need of some math help...<br><br>I have a HINGE JOINT along the X-axis (1,0,0) and uses the Lo-Stop/Hi-Stop constraints set to -1.0*pi and +1.0*pi.<br><br>This works fine, but at a certain point I need to re-set the joint (for example after the object has been moved in the editor, or a level is re-loaded). So I need to reset the joint's position and rotate it's axis relatively to the object. I use the following code - which works perfectly fine:<br><br><pre class=code>
;reposition joint with offset relative to mesh's current position &amp; rotation
;----------------
TFormPoint xOffset#,yOffset#,zOffset#, mesh, 0
dJointSetHingeAnchor joint, TFormedX#(),TFormedY#(),TFormedZ#()

;re-align the joint's axis (Hinge along X axis) relative to mesh's current rotation
;----------------
ax# = 1.0
ay# = 0.0
az# = 0.0
TFormNormal ax#,ay#,az#, mesh, 0
dJointSetHingeAxis joint, TFormedX#(),TFormedY#(),TFormedZ#()
</pre>BUT then I realised that the Joint's LO-STOP and HI-STOP values need to be adjusted as well!! To compensate for the Joint's Axis rotation!<br>Since the axis is no longer aigned at 1,0,0 the lo/histop values -1*pi and +1*pi won't give the same result ie. they need to be 'rotated' as well.<br><br>So I guess I have to rotate the axis-vector by the original lo/histop values to get the new lo/histop values. But rotating vectors around their axis and mixing degrees and pi's and.. Sorry, I have no cue how to do this! :)<br><br>Any help greatly appreciated!<br><br>Danny <br><br></td></tr></table><br>
<a name="690820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The normal procedure for resetting stuff like joint axis angles is to build the object/joints in their default position/rotation, only then should you reposition and rotate them to their new values.<br><br>Remember that the hi/lo stops use radians, not degrees.<br><br>Hope this helps :) <br><br></td></tr></table><br>
<a name="690894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Vip3r,<br><br>That's exactly what that function is intended to do to 'reposition and rotate them to their new values' after having them setup from their default position.<br>If the object is made of 2 rigib bodies connected by a hinge, I need to move/rotate the 2 bodies AND the joint all togther - keeping their relative offsets and angles in tact. I got everything else working (the bodies, joint position &amp; axis); just converting these lo/hi stops are giving me a headache ;) <br><br></td></tr></table><br>
<a name="690900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you using radians for the lo/hi stops?<br><br>Get the angle of the hinge axis after rotating it and use the following conversions to change the angle of the hinge axis (which is in degrees) into radians for the lo/hi stops...<br><br>1 Radian = 57.2957795130823208767981548141052 Degrees<br>1 Degree = 0.0174532925199432957692369076848861 Radians<br><br>...then offset the default lo/hi stops values by the result of the above calculation. <br><br></td></tr></table><br>
<a name="691760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes viper, I'm using radians.<br><br>But I think my first conclusion is wrong. When I reset two bodies connected by a joint - and make sure they are WITHIN the given lo/hi stop constrains then there's no problem.<br><br>I was expecting that the lo/hi stop would FORCE the bodies/hinge back to within the constrains, but I guess it doesn't do that when you reset all forces on the bodies... <br>And instead the bodies seem to be happy to intersect with each other whilst the hinge is way out of it's lo/hi stop. But not 100% sure about that statement either.. :/ <br><br></td></tr></table><br>
<a name="691991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I guess it doesn't do that when you reset all forces on the bodies...<br> <br></div><br>Yeh, that sounds about right to me. You could try stepping the simulation first before resetting the forces, maybe that will work. It's difficult to say with any certainty as I've not tried doing this myself.<br><br>If you're still stuck, send me a simple demo over that illustrates the problem and I'll see if I can help. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
