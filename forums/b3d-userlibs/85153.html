<!DOCTYPE html><html lang="en" ><head ><title >need help with an api call for my wiimote lib</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >need help with an api call for my wiimote lib</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=94" >Blitz3D Userlibs</a>/<a href="#bottom" >need help with an api call for my wiimote lib</a><br><br>
<a name="962746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, i'been paying arround with a wiimote last year and wrote some code to handle it (http://blitzbasic.com/Community/posts.php?topic=78384), it seems to work correctly under XP but, i'm testing the code under Vista Home Basic and found a trouble.<br><br>the call to wiiSetupDiGetClassDevs returnsme a -1, I call getLastError and give me error code #13 (i couldn't find what means 13 help here too!).<br><br>the line of code is<br><pre class=code>
DeviceInfoSet = wiiSetupDiGetClassDevs(GUID,"",0,Flags)
</pre><br><br>(inside the Function: ObtenerHID() )<br><br>The fact is that if in the same machine i do that call from a small app in VisualBasic 6, and it works good. So I think that is not merely a vista problem. <br><br><br>any idea?<br><br>thank's in advance<br><br>Juan<br><br>(sorry for my bad english!) <br><br></td></tr></table><br>
<a name="962896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Traditionally, an Error 13 (With regards to Device Drivers) in Windows is:<br><br>[quote]<br>Code 13 <br>This device is either not present, not working properly, or does not have all the drivers installed. (Code 13)<br><br>To have Windows detect whether this device is present or not, click Detect Hardware. <br>Solution button: Detect Hardware<br><br>This code indicates that the device driver did not find the hardware.<br>[/code] <br><br></td></tr></table><br>
<a name="962928"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank's malice<br><br>but I'm confused, becouse that error arrives when I do the call from blitz but when I do the same call from visual basic the routine doesn'r report any error and work properly. Why the same call does two diferent thing's?<br><br>the machine, operating system and drivers are the same. The source of the call is diferent, from Visual Basic 6.0 and from blitz. Under XP I have no problems. <br><br>any idea? <br><br></td></tr></table><br>
<a name="962967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have no idea, I don;t like Vista ftrom what limited experience I have with it, but I can hazard a guess it might be related to Vista's insitence on admin rights and signed drivers?<br>i.e. Run blitz as an administrator and check the drivers are signed.... sorry can't help much :S <br><br></td></tr></table><br>
<a name="962996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank's again<br><br>i tried to run in administrator mode, try to run blitz in xp compatibility and the like, but without succees! I'm new too in vista and at this time I' m testing if my other software works properly with it, and obviously the wiimote code fail the tests!<br><br>based on the sample dll that is in the userlibs.txt on the userlibs folder i did a simple dll to handle some matrix calulations just for test if I could done some thing like that, but my skills are so limited with c and i'm not shure that could write part of the lib or the whole lib in c. But being a technician in electronics I think that I travel so far in porgramming so, probably do the work (try at least) if no one has a simpler solution. I think that if it works from within visual basic it will work from c.<br><br>I'm using BlueSolei and probably try to use other bloototh stack if my hardware work with it. But I relize that the problem is not in vista, should be the calling method from within blitz?<br><br>best regards<br><br>Juan <br><br></td></tr></table><br>
<a name="963081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJ00200</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can try what I'm doing.<br><br>You need the Internet Channel for your Wii, and a free web hosting account at t35.com.<br><br>Build a webpage to access the opera.wii JavaScript object, and use AJAX to upload the info to a PHP script on the server, and use BB3D to connect to the server and get the info.<br><br>Google opera.wii, and Wii Opera SDK <br><br></td></tr></table><br>
<a name="963099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, I think it should work from Blitz3D, there might just be something small that is causing this. I wish I could help, but I have no Wiimote. <br>If you're considering writing a DLL, maybe you could create one in VB? <br><br></td></tr></table><br>
<a name="963146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  <br>Actually, I think it should work from Blitz3D<br> <br></div><br>I agree. Doesn't Blitz  effectively go 'via' windows to do stuff like that?<br><br>I do admit this is all quite beyond me, and I neither have Wii remote, nor know much about DLLs etc.<br><br>I am a little confused as to what's happening, can you clarify:<br><br>1) You call the 'function' from a VB app on XP - No problem ?<br>2) You call the 'function' from Blitz3D on XP - No problem ?<br>3) You call the 'function' from a VB app on Vista - No Problem ?<br>4) You call the 'function' from Blitz3D on Vista - Error Report ?<br><br>Are you SURE the .decls fiile is written properly and in the right place with the dll? Maybe just try a quick test on Vista with B3D using a different .dll and .decls t(that does something different) <br><br></td></tr></table><br>
<a name="963194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank's people!<br><br>that's my "wii_setupapi.decls" (the same i use on xp)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

.lib "setupapi.dll"

wiiSetupDiDestroyDeviceInfoList%(DeviceInfoSet) : "SetupDiDestroyDeviceInfoList"
wiiSetupDiEnumDeviceInterfaces%(DeviceInfoSet, DeviceInfoData, InterfaceClassGuid*, MemberIndex, DeviceInterfaceData*) : "SetupDiEnumDeviceInterfaces"
wiiSetupDiGetClassDevs%(ClassGuid*, Enumerator$, hwndParent%, Flags%) : "SetupDiGetClassDevsA"
wiiSetupDiGetDeviceInterfaceDetail%(DeviceInfoSet, DeviceInterfaceData*, DeviceInterfaceDetailData, DeviceInterfaceDetailDataSize, RequiredSize*, DeviceInfoData) : "SetupDiGetDeviceInterfaceDetailA"
wiiSetupDiGetDeviceInterfaceDetail2%(DeviceInfoSet, DeviceInterfaceData*, DeviceInterfaceDetailData*, DeviceInterfaceDetailDataSize, RequiredSize*, DeviceInfoData) : "SetupDiGetDeviceInterfaceDetailA"

</textarea><br><br>that's are the declarations in a .bas of VB required to get access to an api from Visual Basic:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

'******************************************************************************
'API constants, listed alphabetically
'******************************************************************************

'from setupapi.h
Public Const DIGCF_PRESENT = &amp;H2
Public Const DIGCF_DEVICEINTERFACE = &amp;H10
Public Const FILE_FLAG_OVERLAPPED = &amp;H40000000
Public Const FILE_SHARE_READ = &amp;H1
Public Const FILE_SHARE_WRITE = &amp;H2
Public Const FORMAT_MESSAGE_FROM_SYSTEM = &amp;H1000
Public Const GENERIC_READ = &amp;H80000000
Public Const GENERIC_WRITE = &amp;H40000000

'Typedef enum defines a set of integer constants for HidP_Report_Type
'Remember to declare these as integers (16 bits)
Public Const HidP_Input = 0
Public Const HidP_Output = 1
Public Const HidP_Feature = 2

Public Const OPEN_EXISTING = 3
Public Const WAIT_TIMEOUT = &amp;H102&amp;
Public Const WAIT_OBJECT_0 = 0

'******************************************************************************
'User-defined types for API calls, listed alphabetically
'******************************************************************************

Public Type GUID
    Data1 As Long
    Data2 As Integer
    Data3 As Integer
    Data4(7) As Byte
End Type

Public Type HIDD_ATTRIBUTES
    Size As Long
    VendorID As Integer
    ProductID As Integer
    VersionNumber As Integer
End Type

'Windows 98 DDK documentation is incomplete.
'Use the structure defined in hidpi.h
Public Type HIDP_CAPS
    Usage As Integer
    UsagePage As Integer
    InputReportByteLength As Integer
    OutputReportByteLength As Integer
    FeatureReportByteLength As Integer
    Reserved(16) As Integer
    NumberLinkCollectionNodes As Integer
    NumberInputButtonCaps As Integer
    NumberInputValueCaps As Integer
    NumberInputDataIndices As Integer
    NumberOutputButtonCaps As Integer
    NumberOutputValueCaps As Integer
    NumberOutputDataIndices As Integer
    NumberFeatureButtonCaps As Integer
    NumberFeatureValueCaps As Integer
    NumberFeatureDataIndices As Integer
End Type

'If IsRange is false, UsageMin is the Usage and UsageMax is unused.
'If IsStringRange is false, StringMin is the string index and StringMax is unused.
'If IsDesignatorRange is false, DesignatorMin is the designator index and DesignatorMax is unused.
Public Type HidP_Value_Caps
    UsagePage As Integer
    ReportID As Byte
    IsAlias As Long
    BitField As Integer
    LinkCollection As Integer
    LinkUsage As Integer
    LinkUsagePage As Integer
    IsRange As Long
    IsStringRange As Long
    IsDesignatorRange As Long
    IsAbsolute As Long
    HasNull As Long
    Reserved As Byte
    BitSize As Integer
    ReportCount As Integer
    Reserved2 As Integer
    Reserved3 As Integer
    Reserved4 As Integer
    Reserved5 As Integer
    Reserved6 As Integer
    LogicalMin As Long
    LogicalMax As Long
    PhysicalMin As Long
    PhysicalMax As Long
    UsageMin As Integer
    UsageMax As Integer
    StringMin As Integer
    StringMax As Integer
    DesignatorMin As Integer
    DesignatorMax As Integer
    DataIndexMin As Integer
    DataIndexMax As Integer
End Type

Public Type OVERLAPPED
    Internal As Long
    InternalHigh As Long
    Offset As Long
    OffsetHigh As Long
    hEvent As Long
End Type

Public Type SECURITY_ATTRIBUTES
    nLength As Long
    lpSecurityDescriptor As Long
    bInheritHandle As Long
End Type

Public Type SP_DEVICE_INTERFACE_DATA
   cbSize As Long
   InterfaceClassGuid As GUID
   Flags As Long
   Reserved As Long
End Type

Public Type SP_DEVICE_INTERFACE_DETAIL_DATA
    cbSize As Long
    DevicePath As Byte
End Type

Public Type SP_DEVINFO_DATA
    cbSize As Long
    ClassGuid As GUID
    DevInst As Long
    Reserved As Long
End Type

'******************************************************************************
'API functions, listed alphabetically
'******************************************************************************

Public Declare Function CancelIo _
    Lib "kernel32" _
    (ByVal hFile As Long) _
As Long

Public Declare Function CloseHandle _
    Lib "kernel32" _
    (ByVal hObject As Long) _
As Long

Public Declare Function CreateEvent _
    Lib "kernel32" _
    Alias "CreateEventA" _
    (ByRef lpSecurityAttributes As SECURITY_ATTRIBUTES, _
    ByVal bManualReset As Long, _
    ByVal bInitialState As Long, _
    ByVal lpName As String) _
As Long

Public Declare Function CreateFile _
    Lib "kernel32" _
    Alias "CreateFileA" _
    (ByVal lpFileName As String, _
    ByVal dwDesiredAccess As Long, _
    ByVal dwShareMode As Long, _
    ByRef lpSecurityAttributes As SECURITY_ATTRIBUTES, _
    ByVal dwCreationDisposition As Long, _
    ByVal dwFlagsAndAttributes As Long, _
    ByVal hTemplateFile As Long) _
As Long

Public Declare Function FormatMessage _
    Lib "kernel32" _
    Alias "FormatMessageA" _
    (ByVal dwFlags As Long, _
    ByRef lpSource As Any, _
    ByVal dwMessageId As Long, _
    ByVal dwLanguageZId As Long, _
    ByVal lpBuffer As String, _
    ByVal nSize As Long, _
    ByVal Arguments As Long) _
As Long

Public Declare Function HidD_FreePreparsedData _
    Lib "hid.dll" _
    (ByRef PreparsedData As Long) _
As Long

Public Declare Function HidD_GetAttributes _
    Lib "hid.dll" _
    (ByVal HidDeviceObject As Long, _
    ByRef Attributes As HIDD_ATTRIBUTES) _
As Long

'Declared as a function for consistency,
'but returns nothing. (Ignore the returned value.)
Public Declare Function HidD_GetHidGuid _
    Lib "hid.dll" _
    (ByRef HidGuid As GUID) _
As Long

Public Declare Function HidD_GetPreparsedData _
    Lib "hid.dll" _
    (ByVal HidDeviceObject As Long, _
    ByRef PreparsedData As Long) _
As Long

Public Declare Function HidP_GetCaps _
    Lib "hid.dll" _
    (ByVal PreparsedData As Long, _
    ByRef Capabilities As HIDP_CAPS) _
As Long

Public Declare Function HidP_GetValueCaps _
    Lib "hid.dll" _
    (ByVal ReportType As Integer, _
    ByRef ValueCaps As Byte, _
    ByRef ValueCapsLength As Integer, _
    ByVal PreparsedData As Long) _
As Long
       
Public Declare Function lstrcpy _
    Lib "kernel32" _
    Alias "lstrcpyA" _
    (ByVal dest As String, _
    ByVal source As Long) _
As String

Public Declare Function lstrlen _
    Lib "kernel32" _
    Alias "lstrlenA" _
    (ByVal source As Long) _
As Long

Public Declare Function ReadFile _
    Lib "kernel32" _
    (ByVal hFile As Long, _
    ByRef lpBuffer As Byte, _
    ByVal nNumberOfBytesToRead As Long, _
    ByRef lpNumberOfBytesRead As Long, _
    ByRef lpOverlapped As OVERLAPPED) _
As Long

Public Declare Function ResetEvent _
    Lib "kernel32" _
    (ByVal hEvent As Long) _
As Long

Public Declare Function RtlMoveMemory _
    Lib "kernel32" _
    (dest As Any, _
    src As Any, _
    ByVal Count As Long) _
As Long

Public Declare Function SetupDiCreateDeviceInfoList _
    Lib "setupapi.dll" _
    (ByRef ClassGuid As GUID, _
    ByVal hwndParent As Long) _
As Long

Public Declare Function SetupDiDestroyDeviceInfoList _
    Lib "setupapi.dll" _
    (ByVal DeviceInfoSet As Long) _
As Long

Public Declare Function SetupDiEnumDeviceInterfaces _
    Lib "setupapi.dll" _
    (ByVal DeviceInfoSet As Long, _
    ByVal DeviceInfoData As Long, _
    ByRef InterfaceClassGuid As GUID, _
    ByVal MemberIndex As Long, _
    ByRef DeviceInterfaceData As SP_DEVICE_INTERFACE_DATA) _
As Long

Public Declare Function SetupDiGetClassDevs _
    Lib "setupapi.dll" _
    Alias "SetupDiGetClassDevsA" _
    (ByRef ClassGuid As GUID, _
    ByVal Enumerator As String, _
    ByVal hwndParent As Long, _
    ByVal Flags As Long) _
As Long

Public Declare Function SetupDiGetDeviceInterfaceDetail _
   Lib "setupapi.dll" _
   Alias "SetupDiGetDeviceInterfaceDetailA" _
   (ByVal DeviceInfoSet As Long, _
   ByRef DeviceInterfaceData As SP_DEVICE_INTERFACE_DATA, _
   ByVal DeviceInterfaceDetailData As Long, _
   ByVal DeviceInterfaceDetailDataSize As Long, _
   ByRef RequiredSize As Long, _
   ByVal DeviceInfoData As Long) _
As Long
    
Public Declare Function WaitForSingleObject _
    Lib "kernel32" _
    (ByVal hHandle As Long, _
    ByVal dwMilliseconds As Long) _
As Long
    
Public Declare Function WriteFile _
    Lib "kernel32" _
    (ByVal hFile As Long, _
    ByRef lpBuffer As Byte, _
    ByVal nNumberOfBytesToWrite As Long, _
    ByRef lpNumberOfBytesWritten As Long, _
    ByVal lpOverlapped As Long) _
As Long


</textarea><br><br>of particular interest the declaration of the routine that is problematic at this time (is the first error I found and probably if i fix it oher arrives...!)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Public Declare Function SetupDiGetClassDevs _
    Lib "setupapi.dll" _
    Alias "SetupDiGetClassDevsA" _
    (ByRef ClassGuid As GUID, _
    ByVal Enumerator As String, _
    ByVal hwndParent As Long, _
    ByVal Flags As Long) _
As Long

</textarea><br><br><br>malice, yes to all 1,2,3, 4. I think that the code should work from blitz.<br><br>that call isn't related wiht the wiimote. Acordingly with the few thing's I know that call is to get access to a list of all the devices that match certain type. The wiimote is seen as a HID (human interfase device) as a mouse or a keyboard. Some lines of code after, the code loops through that list (until reach the end) and get aditional information looking for a particular device number () with the intention of found specifically a wiimote.<br><br>the code i translated is from a book about USB devices (HID) and is related to a general pourpose code to find some kind of devices, the comments of the autor about that call says:<br><br>'******************************************************************************<br>'SetupDiGetClassDevs<br>'Returns: a handle to a device information set for all installed devices.<br>'Requires: the HidGuid returned in GetHidGuid.<br>'******************************************************************************<br><br>so is a call that should get no error<br><br>without bluesolei installed and with a mouse and a keypad connected on two usb ports, i get a list of 2 devices (always function properly from VB!), obviously no one matches the one I'm looking for (the not installed wiimote). <br>What i'm saying is that the trouble is in a function that report an error when it should report a least 2 devices!<br>by the way in xp blitz report the list of devices (mouse, keypad etc and the wiimote!)<br>thank's again<br><br>probably this weekend i have time to capture that BUG<br><br>Juan <br><br></td></tr></table><br>
<a name="963225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi again<br><br>i wrote a simple small app that use the call to the api that isn't working (in my machine) under vista.<br>It needs 3 .decls that are in the zip.<br><br><a href="http://odriozola.juanignacio.googlepages.com/hidtest.zip" target="_blank">http://odriozola.juanignacio.googlepages.com/hidtest.zip</a><br><br>if is it posible for you to test what happens in your machine i will be pleased.<br><br>it will give a list of HID devices as: mouse, keyboard, joystick etc that are connected via usb (in theory) <br>or, it will be giving an error code 13, that's what happend in my machine under windows vista. Aparently under xp works properly<br><br>any test you could do under xp or vista will appreciated.<br><br>thank's in advance.<br><br>sincerely<br><br>Juan <br><br></td></tr></table><br>
<a name="963427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, here's my results:<br><br>I have no idea what it all means but I can tell you I do not possess a Wii or any hardware for it. :D<br><br>At least,it ran perfectly every time, I got no errors. I have a few HID devices attached, as my keyboard possesses its own USB ports too, plus I have joystick etc.<br><br>This was run on Blitz3D on Windows XP (service Pack 3)<br><br><div class="quote"> <br>wiiHidD_GetHidGuid: 1754207236<br>4D1E55B2<br>F16F<br>11CF<br>88<br>CB<br>00<br>11<br>11<br>00<br>00<br>30<br>wiiSetupDiGetClassDevs success!<br>Handle ID: 1260<br>\\?\hid#vid_046d&amp;pid_c215#7&amp;15e4f500&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C215<br>No es el que yo busco<br>Handle ID: -1<br>\\?\hid#vid_046d&amp;pid_c221&amp;mi_00#8&amp;25f687a2&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C215<br>No es el que yo busco<br>Handle ID: 1260<br>\\?\hid#vid_046d&amp;pid_c221&amp;mi_01&amp;col01#8&amp;361dc87&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C221<br>No es el que yo busco<br>Handle ID: 1260<br>\\?\hid#vid_046d&amp;pid_c221&amp;mi_01&amp;col02#8&amp;361dc87&amp;0&amp;0001#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C221<br>No es el que yo busco<br>Handle ID: -1<br>\\?\hid#vid_046d&amp;pid_c225&amp;col01#7&amp;24b1a1&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C221<br>No es el que yo busco<br>Handle ID: 1260<br>\\?\hid#vid_046d&amp;pid_c225&amp;col02#7&amp;24b1a1&amp;0&amp;0001#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C225<br>No es el que yo busco<br>Handle ID: -1<br>\\?\hid#vid_1532&amp;pid_0001#6&amp;bea07d6&amp;0&amp;0000#{4d1e55b2-f16f-11cf-88cb-001111000030}<br>VendorID : 0000046D  Product: 0000C225<br>No es el que yo busco<br>Ultimo dispositivo<br> <br></div> <br><br></td></tr></table><br>
<a name="963435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> thnk's<br>it's just a list of HID's (Human Device Interfase) connected or listed (not necesary present) on your system. VendorID and ProductID are specific for a manufacturer and product so, when I search that list, I look for:<br>(VendorID = $057E) And (ProductID = $0306)the ones the wiimote has. <br>I don't know what specifically means VendorID $046D and the product $C225, but what I know with this loop is if one or more wiimotes are installed on a system. <br>Under xp i get a result similar to your depending on the amount of USB devices installed (i.e. keyboard, mouse, scanner, printer, joystick and the like, really not shure about scanner and printer but a pendrive should be no detectes as a HID).<br>The thing still is that the api call succeed in xp and not in vista when is made from blitz. When is made from VB is always ok.<br><br>If some one could test this code in vista i will be pleased.<br><br>at this moment I know that in my machine have this problem and i don't know if it is my machine or a general rule.<br><br>(when i say "not necesary present" is for example, if we connect the wiimote and blue solei detects it, then the call list the device even in the case that we were turned it off)<br><br>thanks<br><br>Juan <br><br></td></tr></table><br>
<a name="963547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm on Windows Vista, this is the result:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
wiiHidD_GetHidGuid: 1942559212
4D1E55B2
F16F
11CF
88
CB
00
11
11
00
00
30
nro de error: 13
Ultimo dispositivo
</textarea> <br><br></td></tr></table><br>
<a name="963582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that explanation, Charrua, I understand it now :D<br><br>Looking at the <br>"nro de error: 13<br>Ultimo dispositivo"<br><br>of Warner's results, seems like it is a general issue with Blitz3D on vista, and since, it works on XP, I guess there's something about Vista that VB knows where to look, but Blitz for some reason doesn't or isn't allowed to. <br><br></td></tr></table><br>
<a name="963627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> i feel the same!<br>thank's a lot for your help.<br>as always something new to investigate.<br><br>see you<br><br>Juan <br><br></td></tr></table><br>
<a name="963782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> When looking into this, I found mentions of SetupDiGetClassDevsW, SetupDiGetClassDevsExA and SetupDiGetClassDevsExW? Not sure what they are, what their difference is, and if they exist, but I thought it could be worth mentioning them. <br><br></td></tr></table><br>
<a name="963818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'll try to google on this to see what they are<br><br>malice, warner thanks's sincerely<br><br>juan <br><br></td></tr></table><br>
<a name="980068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> surprise, surprise<br><br>my functions call doesen't work from vista, but if i make a VirtualMachine with VirtualBox, and install an XP on it, the code above works!<br><br>so, in a virtual machine the call to the apis work and not direct from vista!<br><br>the big problem i have now is that, blitz only works in text mode, because the CountGfxModes3D reports 0 from blitz running on a VM!<br><br>any idea?<br><br><br><br>Juan <br><br></td></tr></table><br>
<a name="1027912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nanahuatzin</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi.. this thread is a bit old... but i have just tested in an XP64 machine... and got the same error:<br><br><br>wiiHidD_GetHidGuid: 1749750832<br>4D1E55B2<br>F16F<br>11CF<br>88<br>CB<br>00<br>11<br>11<br>00<br>00<br>30<br>nro de error: 13<br>Ultimo dispositivo<br><br>So.. interesting... <br><br></td></tr></table><br>
<a name="1028009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> mmm, i thinked that the problem where on vista. I use 32 bits vista home basic and this detection code stop working from my 32 bits XP.<br><br>I rewrite the lib wiht another detection code, that work's in 32 bits XP and my 32 vista home basic, if you can test the new one, i'll be pleased<br>see this thread<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=89809" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=89809</a><br>or download from my signature<br><br>nice to hear about you, has you enjoyed with the wiimote?<br><br>regards<br><br>Juan <br><br></td></tr></table><br>
<a name="1030769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nanahuatzin</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> well  the new version works beatifully in XP 64<br><br>And yes,  i have been having a los of fun... maybe i will do a video of it  :) <br><br></td></tr></table><br>
<a name="1030790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm glad to know that! <br><br>thank's for your feedback about xp64<br><br>keep in touch<br><br>Juan <br><br></td></tr></table><br>
<a name="1030868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's good to know...<br>Any ideas on whether this works with Windows 7 too?<br><br>I don't own a Wii or Windowes 7, just curious! :D <br><br></td></tr></table><br>
<a name="1030885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> at this moment it work's on the few machines/os tested:<br>xp32, xp64 and vista home basic<br><br>when some one else do that test, hope it will post here or the wiimote 2010 thread<br><br>the problem where not about the file trasnfers to comunicate with the bluettooth device, in the transition to the new code, i made a VB code to obtaint the "Device file name" and using (pasting that string) it from blitz3d (in the same machine) there where no problems, so i found another way to ask the OS the device file name. <br><br>Obviously didnt fount that solution lookin for it, sudenly, working with keypads rawinput and the like, i found the way to ask for a device list!. And works in vista for wiimotes!<br><br>Juan <br><br></td></tr></table><br>
<a name="1032337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Charrua,<br><br>this still has my interest, I've just been a little busy with work, exams &amp; life stuff. I've got a Wii &amp; A W7 machine - just gotta source the interfacing hardware. <br><br></td></tr></table><br>
<a name="1032374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'll wait for your results with W7. Hope you enjoy with it.<br>i just instaled W7 for test it on my laptop and this weekend i'll test the wiimote related software on it. Probably soon i'll install w7 64 on my home pc and then will do a test on it too.<br><br>Juan <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
