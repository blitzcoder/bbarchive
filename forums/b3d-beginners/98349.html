<!DOCTYPE html><html lang="en" ><head ><title >Concepts to convert a high tris mesh in a low tris</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Concepts to convert a high tris mesh in a low tris</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Concepts to convert a high tris mesh in a low tris</a><br><br>
<a name="1148277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, :)<br><br>In my game, i use subdivided meshes for the walls of the rooms in order to have a beautiful lighting.<br><br>Each room is built with several parts of walls and then i use addmesh to have a single mesh.<br><br>An example of a high tris room :<br><img src="http://img51.imageshack.us/img51/9660/hightrismeshforrender.jpg"><br><br>I want to create a low tris mesh for each high tris mesh of each room so that i can use the low tris mesh as a collider.<br><br>An example of a low tris collider i want :<br><img src="http://img140.imageshack.us/img140/8543/lowtrismeshforcollider.jpg"><br><br>But i have no idea how i can code this, and i need to be able to code it because my program will generate the shape and the size of each room, and i also want it to generate a collider for each room.<br><br><br>If you have an idea on how to achieve this, can you explain ? Please?<br><br>Thanks, <br><br></td></tr></table><br>
<a name="1148343"></a>

<a name="1148344"></a>

<a name="1148345"></a>

<a name="1148346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you rely on the rooms to always be arranged according to a grid? Do they have a particular maximum size? What are the general parameters for room design?<br><br>It's important when coming up with systems for simplifying something to know exactly which ways something can be simplified. For instance, in this case, if we know that rooms are always grid-aligned and grid-constricted, the task becomes ....well, doesn't <i>look</i> too hard, whereas doing it with arbitrarily-shaped rooms would be nightmarishly hard.<br><br>If we can assume that the rooms are built to a grid, the way I would probably do this would be:<br><br>-- start with one of the axis-aligned 'sides' to the room. This is simplest with the floor, but with a bit of splitting and tweaking to handle unconnected areas separately, could work with the walls as well.<br><br>-- assign each component quad a virtual grid location, as though you are projecting the floor over the largest square that can hold it.<br><br>-- pick a corner. Doesn't matter which one if the rooms are statistically likely to be symmetrical. Choosing one is probably more difficult than necessary; or if you're feeling generous with time, you could repeat this whole thing four times to choose the one that generates the fewest quads.<br><br>-- use a simple distance-search to find the floor-quad that is physically closest to the starting corner. Mark this floor quad; this is now your work area.<br><br>-- maintain an X-size and a Y-size measurement for your quad. <i>For</i> each in the X-range, check if the tiles X, Y+1 are all within the room and unclaimed. Do the same for the Y-range. Choose the side with the greater number of unclaimed tiles (the number is zero if any a claimed or outside the room), and expand the quad to cover those tiles. If neither side is available for expansion, the this quad is done.<br><br>-- go back to the search step to find the next nearest tile to the starting corner. Repeat...<br><br>-- eventually there will be no more tiles left. Every tile in the room will have been assigned to a quad. You now have enough information to build a collision mesh.<br><br><br>....all that said, however, you should:<br><br>1) seriously consider using collision boxes instead of a mesh, because a small group of box collisions may be significantly faster than one complex mesh collision (experiment and see which is better).<br><br>2) simplify things further for large constants like the floor: if several rooms share a floor or a single side wall, have them share one extended collision box. If <i>all</i> the rooms are on one flat plane, have an actual plane; even get rid of the collision element and use a simple "If Y &lt; 0 Then Y = 0" approach.<br><br>3) consider generating the simple room mesh first, and producing the complex lighting mesh out of it, rather the the other way around; or have your procedural room-generator output both at the same time. Either of these is likely much simpler than generating a collision mesh from a rendering mesh.<br><br>There's always room for further simplification!<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1148353"></a>

<a name="1148359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Can you rely on the rooms to always be arranged according to a grid?<br> <br></div><br><br>Yes, each wall part is a tile of 1x1 unit<br><br><div class="quote"> <br>Do they have a particular maximum size? <br> <br></div><br><br>Yes, each room can measure up to 20x20 tiles (or units)<br><br><div class="quote"> <br>What are the general parameters for room design?<br> <br></div><br><br>I am not sure i understand what you mean by that...<br>Each room can have irregular shapes as illustrated on the screenshots but each room will always use a maximum of 20x20 units and be flat.<br><br>There will be several levels linked by rooms with stairs, but otherwise, all rooms of each level will have the same flat ground<br><br><div class="quote"> <br>consider generating the simple room mesh first, and producing the complex lighting mesh out of it, rather the the other way around<br> <br></div><br><br>Yeah this is an interesting idea, i can try to code something like this.<br><br><div class="quote"> <br>even get rid of the collision element and use a simple "If Y &lt; 0 Then Y = 0" approach.<br> <br></div><br><br>Well, this will probably work for a room with a flat ground but not for a room with stairs or others irregular shapes (on the Y axis)<br><br>I have not understood your others explanations yet, but i will reread later.<br><br>Thanks!<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1148360"></a>

<a name="1148361"></a>

<a name="1148362"></a>

<a name="1148369"></a>

<a name="1190872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Those collection of tiles amount to concave polygons. The floor, the ceiling and each individual wall are polygons.<br><br>You can "see" these polygons if you ignore the tiles in the middle, and only consider the edge tiles:<br><br><img src="http://i45.tinypic.com/35d4uit.jpg"><br><br>Once you can extract the polygon shapes these tiles form, all you need to do is <i>triangulate</i> them.<br><br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=2259" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=2259</a> - by Warpy<br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=2508" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=2508</a> - by Warner<br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=816" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=816</a> - by Pepsi<br><a href="http://en.nicoptere.net/?p=16" target="_blank">http://en.nicoptere.net/?p=16</a> <br><br></td></tr></table><br>
<a name="1148840"></a>

<a name="1148845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for these explanations Kryzon, i will study it if i need it later.<br><br><br><br>I have done some tests on 3 pcs and even on my weakest config (EEE 900, Celeron 900Mhz, 1go DDR, Intel GMA 900 64mo)  the collisions calculations take only 1 to 2 ms for :<br>-&gt;A static collider mesh of around 9000 tris. (for the walls of the room)<br>-&gt;50 static colliders meshes (cube, cylinder, or low tris colliders) (for the furnitures)<br>-&gt;10 moving colliders spheres (for the characters)<br><br>I use a routine to unset/set the colliders and the collisions groups before moving the characters, in order to calculate the collisions only on the characters in the same room of the player and on the furnitures around the characters and the player in this room.<br><br>So i think i don't need to optimize the collider mesh of the room even if it has far too many tris. Maybe later.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1149421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sety some linepicks to identify where the distance from any face to the opposite one changes - This will mean there's a corner. At each corner, place a collider vertex and build up a collider mesh this way. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
