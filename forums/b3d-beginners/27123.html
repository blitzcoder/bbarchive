<!DOCTYPE html><html lang="en" ><head ><title >Background Task</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Background Task</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Background Task</a><br><br>
<a name="283895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could blitz be used to write a program that sits in the background and only does anything when a certain type of file is created by another application? E.G.<br><br>Start the Blitz code<br>   Blitz code checks directory for files ending in .CTA<br>Repeat<br>      If files found<br>         process them<br>      Else<br>         Sleep without using loads of memory<br>      Endif<br>Forever<br><br>sort of thingy????<br><br>Luna <br><br></td></tr></table><br>
<a name="283896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> you would need to use win API calls.<br>Take a look for FindFirstChangeNotification, WaitForMultipleObjects and FindNextChangeNotification. <br><br></td></tr></table><br>
<a name="283900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perturbation,<br><br>Are they Blitz3d functions?<br><br>Luna <br><br></td></tr></table><br>
<a name="283907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> no they are Windows API calls (requires winAPI userlibs)<br><br>I would steer clear of them if you know not what you are doing. <br><br></td></tr></table><br>
<a name="283914"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Count me as steered clear.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="283916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't get me wrong, you should try and learn API calls at some point, but if you've never done it before, doing it from blitz is not going to be the easiest thing. <br><br></td></tr></table><br>
<a name="283952"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> leeluna, yes, you could do that with minimal effort (and minimal CPU usage) in BlitzPlus.  API calls are not necessary. <br><br></td></tr></table><br>
<a name="284085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perturbatio,<br>I will still look into API, I found a few good posts on this site which will point me in the right direction but for my present project I will leave well enough alone.<br><br>Soja,<br><br>Dang and I went and bought B3D !!!<br><br>Luna <br><br></td></tr></table><br>
<a name="284300"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzPlus would be much more suited to that than Blitz3D, but never fear, Blitz3D is useful in its own right! <br><br></td></tr></table><br>
<a name="284320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CyberPackRat</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't poo-poo Blitz3D.. it rocks. <br><br></td></tr></table><br>
<a name="284334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can think if one way of doing it in B3D without API calls, but it might not have a very low cpu usage.  <br><br>Basically, write a function to scan the directory for the filetype, and call it once every few seconds.<br><br>The advantage of the API calls is that they will tell you when the directory has changed as opposed to you manually checking. <br><br></td></tr></table><br>
<a name="284386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tremens - Er... the right tool for the right job, and all that... Blitz3D rocks for making games, but not really for transparent background tasks.<br><br>Pertubatio - For an API function to tell you something when an event occurs, you would need to register a callback function with it, right?  Have you figured out a way to handle that in Blitz without writing your own DLL in another language?  The way I figure it, you're going to have to keep polling either way, whether through Blitz or a WinAPI function.  (And in BlitzPlus, with its event-based architecture, you could do that easily with low CPU and I/O usage.) <br><br></td></tr></table><br>
<a name="284415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >darklordz</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> *friendly reminder, blitz is a gameprogramming lang, suited best for game programming. To use blitz in the background would be foolish because the exe eats ur system resources.... <br><br></td></tr></table><br>
<a name="284465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> * A qualification: Darklordz is probably talking about BlitzBasic and Blitz3D, and he's right.  However, using BlitzPlus for a background application falls completely within the bounds of what it was meant for, and will be very easy on your system resources. <br><br></td></tr></table><br>
<a name="284487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> People,<br><br>After reading your responses I am very tempted to purchase B+, Will this conflict with my B3D installation or should everything be OK?.<br><br>I purchased B3D as soon as I heard about it on the PC and had dreams of controlling my PC with the ease of controlling my old amiga. Like everyone I would love to create my own game but I always seem to end up coding stuff for work which has nothing to do with shooting anything!!!<br>.<br>Thanks<br>Luna <br><br></td></tr></table><br>
<a name="284623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> No conflict at all, exept, if you open a .bb file you cannot make your coputer predict if it should use B+ or B3D.<br><br>For the original topic, it all depends, how large an area should it check and how often, if you put all your .CTA files in one directory and want it to check every 10 secs I don't think it will be a problem, seems like a b3D program take at least 6 MB of your ram. <br><br></td></tr></table><br>
<a name="284624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have bb, b3d, and b+ all installed.  All work fine with each other. <br><br></td></tr></table><br>
<a name="284749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> eBusiness,<br><br>Thanks for the info, All the .CTA files will be in the same directory and I will be checking for them every 20 - 30 minutes and then starting another task depending on the .CTA file contents( ExecFile() ).<br><br>Thanks again<br>Luna <br><br></td></tr></table><br>
<a name="284809"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's ok to buy B+ since it offres a lot of useful things for apps not found in B3D, but I think what you need is dead simple and could be done in blitz easily.<br><br>It isn't that hard to get into simple API Calls using Blitz .decls.<br><br>You need the command ShowWindow that can be used to make the Blitz app invisible. Blitz will not use that big lot of memory, compared to a preloaded MSIE in memory or something, I wouldn't worry too much about it. Blitz is not using too much of CPU power if you use the "delay" command in a clever way.<br><br>All you have to do is: <br><pre class=code>
Run the app in windowed mode
Using ShowWindow hwnd,0 to hide the task

delay 10000
check if it's time for a new .CTA Check (every 20 Minutes as you say)
if so, read the directory and search for the .CTA files
if you want to know if a file with the same name has been edited sine the last time then check the checksum
</pre><br><br>.decls: these are files you have to store inside the "userlibs" folder of your Blitz3D folder.<br><br>they contain definitions of Api (and other DLL) -calls you want to be accsessible in Blitz. They start with the definition of the DLL that contains the calls. A list of call-commands then follows.<br><br>the ShowWindow call needs to be defind this way:<br><br>Since the Windows System-API call "ShowWindow" is part of the "user32.dll" Dynamic Link Library ou have to use a file named "user32.decls" for this. The file looks like this:<br><pre class=code>
.lib "user32.dll"
FindWindow%( class$,Text$ ):"FindWindowA"
ShowWindow(hwnd%,nCmdShow%)
GetActiveWindow%()
GetDC%(hWnd% )
ReleaseDC%(hWnd%,hDC%)
GetDesktopWindow%()
GetSystemMetrics%(nIndext%)
GetWindowTextLength%(hwnd):"GetWindowTextLengthA" 
GetWindowText%(hwnd%,buff*,anzahl%):"GetWindowTextA" 
SetWindowText(hwnd%,buffer$):"SetWindowTextA"
</pre><br><br>So here you can see the command ShowWindow along with some other useful Api-calls. <br><br>One important thing with Api calls is the "hwnd" which is the window-handle of the running app. If your app want to use Api-calls to midify itself then it needs to know its own Window-Handle. There are several ways to determine the hwnd, the esiest would be to call GetActiveWindow(), but it is not very secure since an other window could become "the active window" meanwhile. It's better to use FindWindow that is using the app class and the app title.<br><br>the class is diffrent with the several Blitz Products, however, here is the code to hide the window:<br><br><pre class=code>
; Const class$="GX_WIN32_CLASS"         ; &lt;- BlitzPlus 1.11
; Const class$="BLITZMAX_WINDOW_CLASS"  ; &lt;- BlitzPlus 1.34
Const class$="Blitz Runtime Class"    ; &lt;- Blitz3D

Global title$="My Blitz Window" ; starting title
AppTitle title$

hwnd=FindWindow(class$,title$)

WaitKey()
Delay 500
FlushKeys()
ShowWindow hwnd,0 ; hide it

; do anything in the background

Delay 5000
ShowWindow hwnd,1 ; show it
WaitKey()
End

</pre><br><br>I hope this helps. <br><br></td></tr></table><br>
<a name="284911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note that jfk's example is for Blitz3D only.  I think there are some issues regarding the difference between BlitzPlus and Blitz3D worth paying attention to: (1) Using the Delay command results in your application being unresponsive to Windows.  This is unacceptable if you wish your application to be multitasked (and IMO windowed apps should always play nice in a multitasking environment).  BlitzPlus would use the WaitEvent command in an event loop, which effectively puts the app to sleep, though it still listens for messages from Windows, so it will respond when you try to minimize/maximize/move/close/re-paint it.  (2) You don't need to use the Windows API ShowWindow in BlitzPlus because there's already a command to do the same thing (e.g. HideGadget/ShowGadget).  In fact, you also have the option of not even using a window at all.<br><br>Of course you can't get around those issues with Blitz3D -- BUT if you're just looking for simple functionality (and don't want to pay $60 yet), you can do it that way.<br><br>The program you want could probably be written well in around 50 lines of BlitzPlus code. <br><br></td></tr></table><br>
<a name="284939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> leeluna, I wrote up this program really quick which does the basics of what you want in BlitzPlus.  It uses a fraction of 1% of my CPU time.<br><pre class=code>
Const WaitTime% = 10 ; 10 Seconds
Const Folder$ = "C:\"
CreateTimer(1)
Repeat
	Select WaitEvent()
		Case $4001 ; Timer tick (one second) has occurred
			ticks% = ticks + 1
			; if WaitTime has passed then check the folder for *.CTA files
			If ticks Mod WaitTime = 0 Then CheckFolder(Folder)
	End Select
Forever

Function CheckFolder(Folder$)
	; Find all CTA files in the folder
	dir = ReadDir(Folder)
	While MoreFiles(dir)
		; Found a file.  Is it CTA file?
		file$ = NextFile$(dir)
		If Upper$(Right$(file$, 4)) = ".CTA" Then CheckCTA(file)
	Wend
	CloseDir(dir)
End Function

Function CheckCTA(file$)
	; Check to see if we've seen this CTA file before
	For cta.CTAFiles = Each CTAFiles
		If cta\Name = file Then Return
	Next
	; It's a new one
	cta.CTAFiles = New CTAFiles
	cta\Name = file
	Notify "Found '"+file$+"'... perform ExecFile stuff here..."
End Function

Type CTAFiles
	Field Name$
End Type
</pre> <br><br></td></tr></table><br>
<a name="284977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> JFK, Soja.<br><br>Thanks to both of you for helping me out, I will be purchasing B+ to do this code as I intend to install it at my work place and dare not take risks with API - .decls. which I to be honest have no knowledge of, The last thing I need to do is end my career by melting down my work place servers.<br><br>Thanks loads for the help and info.<br><br>Luna <br><br></td></tr></table><br>
<a name="284988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >leeluna</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK I have taken the plunge and am sitting all excited waiting for my product to arrive!!!.<br><br>Hhhmm how long does this usually take?? tick tick tick...<br><br>Luna. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
