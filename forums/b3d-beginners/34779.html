<!DOCTYPE html><html lang="en" ><head ><title >dos commands, or file-rename</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >dos commands, or file-rename</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >dos commands, or file-rename</a><br><br>
<a name="376608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>In Qbasic there was a SHELL command, which you could use to perform dos operations.. is there such a command in B(+) ?<br><br>If no, how do I rename a file in B(+) ? (in a typical contruction with ReadDir, NextFile etc.) I just want to make some app that renames a great number of files according to my conditions.. <br><br></td></tr></table><br>
<a name="376672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, there is always copyfile: delete old file, but as far sa I know there is no true rename command. <br><br></td></tr></table><br>
<a name="376673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stoop Solo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's no specific rename command in Blitz, but you can copy and delete files, so you could use this:<br><br><pre class=code>
CopyFile "c:\old.txt","c:\new.txt"
DeleteFile "c:\old.txt"
</pre><br><br>You can't really have a "shell" type command now, because of running in Windows. It was different where QBasic etc were concerned, because they were running from within a command environment already.<br><br>As far as running external programs is concerned, you can do it via the ExecFile comand, although this can only execute other programs. It would work the same way as the "run"  comand line thingy in the start menu. You can use it to instruct Windows to open up any file (with the associated viewer if required). So you would only be able to use it to run the command interpreter. Though the command interpreter has copy and rename, amongst other commands, you wouldn't be able to use it to copy or rename a file, as you would not be able to pass the command interpreter any commands.<br><br>Bear in mind also that if you do open a file up with ExecFile, that application will then get the focus. <br><br></td></tr></table><br>
<a name="376760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big pete</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>outfile=WriteFile("h:\temp.bat")
WriteLine(outfile,"rename h:\peach.exe peach.jpg")
CloseFile outfile
ExecFile("h:\temp.bat")
;DeleteFile("h:\temp.bat")</pre><br>This seems to work fine- upto the point where I enable the last line, so I think there's no way to avoid an ugly .BAT file from staying on the harddisk. :/ <br><br></td></tr></table><br>
<a name="376895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are multiple ways to rename a file.  Here's one way:<br><pre class=code>
CreateProcess("cmd.exe /c rename file1 file2")
</pre><br>Of course you have to use the right command interpreter depending on the OS.<br><br>Here's another way which should work on all systems:<br><pre class=code>
;.lib "msvcrt.dll"
;RenameFile%(source$, dest$):"rename"

result = RenameFile("file1", "file2")
If Not result Then Notify "Success!" Else Notify "Failure."
End
</pre><br><br>I would not recommend using the copy/temp file method. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
