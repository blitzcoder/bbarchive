<!DOCTYPE html><html lang="en" ><head ><title >Who's Logged In?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Who's Logged In?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Who's Logged In?</a><br><br>
<a name="240599"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Question is, suppose you want to know which user is currently logged into the PC?  This is important if you<br>want to look along the correct path to that person's<br>Desktop or My Document folder, for instance, or if you<br>want to call up custom settings for that player in a<br>game setting.  I'm sure with research I will find an<br>answer, but I bet someone already knows. <br><br></td></tr></table><br>
<a name="242361"></a>

<a name="1224650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deletemeplease</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> ** DELETED ** <br><br></td></tr></table><br>
<a name="242388"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> For example, the current user's desktop:<br><pre class=code>
DesktopPath$ = GetEnv("USERPROFILE")+"\Desktop"
</pre><br>Of course this only works for NT machines.  For 9x machines, you'll have to check the default system variables to see what's available.  Maybe you'd just have to manually figure it out.<br><br>For more info, run a command line shell (cmd.exe or command.com) and type "set".  Or, you can go into Control Panel -&gt; System Properties -&gt; Advanced -&gt; Environment Variables. <br><br></td></tr></table><br>
<a name="242520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> With a userlib, you might want to look at the Win32 command SHGetSpecialFolderLocation, as it'll return the path to the requested folder (My Documents, Program Files, etc) according to the current user, though it's a bit of a weird one (has some odd structures and stuff), so I'm not sure if it'll work as things stand... <br><br></td></tr></table><br>
<a name="242522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doh... or try <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/getusername.asp" target="_blank">GetUserName</a>, though as Soja points out, the paths are going to be different on 9x... <br><br></td></tr></table><br>
<a name="242662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using the GetEnv$() function can prove to be the key to<br>finding out something about the environment set up for<br>the user.  For instance, some of the environmental values<br>are derived from the current user's profile, so if you have<br>left these at their default values, you might find that GetEnv$("TEMP") or GetEnv$("TMP") provides a path to something like:<br><br>"c:\Documents and Settings\Default User\Local Settings\Temp"<br><br>or that the GetEnv$("USERPROFILE") might return:<br><br>"C:\Documents and Settings\Default User\"<br><br>Of course, instead of "Default User", you would expect to see the name of the person who is currently logged in.  And as pointed out, going to Start/Run and entering "Cmd" (or entering "Command /k" on Win9x/ME machines) and then entering "SET" will display all the environmental variables and their settings.  You can use the Alt+Enter (or Alt+Carrage Return) to change the Command Line Window to full screen, then use it again to toggle back to a normal screen in order to close it (or just type "Exit" to leave). <br><br></td></tr></table><br>
<a name="242742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ...or entering "Command /k" on Win9x/ME machines <br></div><br><br>Oldefoxx, you don't need the /k switch. <br><br></td></tr></table><br>
<a name="242768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, you do if you want to keep some of the Command Windows open.  Not every Windows version behaves the same, and some close as soon as the given command is executed.  For instance, if you did a DIR command, the directory would get listed and the windows then closes so fast you could not see the results.  For other windows, the Command /K is not needed, but the /k remains for compatability.  I am merely attempting to avoid some conflict here by going with the lowest common denominator. <br><br></td></tr></table><br>
<a name="242801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no version of Windows in which command.com closes itself immediately after being run (with no parameters).  All you need to do is run "command", then type "set". <br><br>In fact, the /k switch does not exist in all versions of command.com. <br><br></td></tr></table><br>
<a name="242822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please note the following:<br><br><br> COMMAND<br><br>Starts a new instance of the MS-DOS command interpreter.<br><br>A command interpreter is a program that lets you type commands. Use the EXIT<br>command to stop the new command interpreter and return control to the old<br>one.<br><br>Syntax<br>    COMMAND [[drive:]path] [device] [/E:nnnnn] [/Y [/C command|/K command]]<br><br>In your CONFIG.SYS file, use the following syntax:<br><br>    SHELL=[[dos-drive:]dos-path]COMMAND.COM [[drive:]path][device]<br>    [/E:nnnn] [/P [/MSG]]<br><br>Parameters<br><br>[drive:]path<br>    Specifies the directory in which the command interpreter is to look for<br>    the COMMAND.COM file when the transient part of the program needs to be<br>    reloaded. This parameter must be included when loading COMMAND.COM for<br>    the first time if the COMMAND.COM file is not located in the root<br>    directory. This parameter is used to set the COMSPEC environment<br>    variable. For more information, see Transient and Resident Memory in<br>    &lt;COMMAND--Notes&gt;.<br><br>device<br>    Specifies a different device for command input and output. For more<br>    information about this parameter, see the &lt;CTTY&gt; command.<br><br>[dos-drive:]dos-path<br>    Specifies the location of the COMMAND.COM file.<br><br>Switches<br><br>/C command<br>    Specifies that the command interpreter is to perform the specified<br>    command and then exit. This switch must be the last switch on the<br>    command line.<br><br>/E:nnnnn<br>    Specifies the environment size, where nnnnn is the size in bytes. The<br>    value of nnnnn must be in the range 160 through 32768. MS-DOS rounds<br>    this number up to a multiple of 16 bytes. The default value is 256.<br><br>/K command<br>    Runs the specified command, program, or batch program and then displays<br>    the MS-DOS command prompt. This switch must be the last switch on the<br>    COMMAND command line.<br><br>    This switch is particularly useful for specifying a startup batch file<br>    for the MS-DOS Prompt in Windows (much like AUTOEXEC.BAT for MS-DOS). To<br>    do this, open the DOSPRMPT.PIF file using the PIF Editor, and type the<br>    /K switch in the Optional Parameters box. It is not recommended to use<br>    the /K switch on the SHELL command line in your CONFIG.SYS file; doing<br>    so can cause problems with applications and installation programs that<br>    make changes to your AUTOEXEC.BAT file.<br><br>/P<br>    Should be used only when COMMAND is used with the SHELL command in the<br>    CONFIG.SYS file. The /P switch makes the new copy of the command<br>    interpreter permanent. In this case, the EXIT command cannot be used to<br>    stop the command interpreter. If you specify /P, MS-DOS runs your<br>    AUTOEXEC.BAT file before displaying the command prompt. If there is no<br>    AUTOEXEC.BAT file in the root directory of the startup drive, MS-DOS<br>    carries out the DATE and TIME commands instead. If you do not have a<br>    SHELL command in your CONFIG.SYS file, COMMAND.COM is automatically<br>    loaded from the root directory with the /P switch.<br><br>/MSG<br>    Specifies that all error messages should be stored in memory. Usually,<br>    some messages are stored only on disk. This switch is useful only if you<br>    are running MS-DOS from floppy disks. You must specify the /P switch<br>    when you use the /MSG switch. For more information about using the /MSG<br>    switch, see &lt;COMMAND--Notes&gt;.<br>/Y<br>    Directs COMMAND.COM to step through the batch file specified by the /C<br>    or /K switches. This switch is useful for debugging batch files. For<br>    example, to step through the TEST.BAT batch file line by line, you would<br>    type COMMAND /Y /C TEST. The /Y switch requires either the /C or the /K<br>    switch.<br><br>Related Command<br><br>The &lt;SHELL&gt; command is the preferred method of using COMMAND to permanently<br>increase space for the environment table. <br><br></td></tr></table><br>
<a name="243046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right.  I said<div class="quote"> ...you don't need the /k switch. <br></div><br>Try it. <br>Start-&gt;run-&gt;"Command"<br><br>And still, I also said:<div class="quote"> There is no version of Windows in which command.com closes itself immediately after being run (with no parameters). <br></div><br><br>Maybe I'm not seeing what you're trying to say. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
