<!DOCTYPE html><html lang="en" ><head ><title >detecting when graphics begin exactly</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >detecting when graphics begin exactly</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >detecting when graphics begin exactly</a><br><br>
<a name="358693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do you tell exactly when graphics have begun?  There seems to be a lag at the beginning when you are initializing graphics.  If I display a logo for one second at the beginning of my game, by the time graphics are actually being displayed to the screen that second is passed and the logo is no longer being drawn.  How do I code things so that the logo will actually be displayed onscreen for one second? <br><br></td></tr></table><br>
<a name="358723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have noticed that different monitors take different amounts of time to switch resolutions.  What works on one (timewise), doesn't necessarily work on another.<br><br>I have tried performing a Flip, thinking that the game won't advance until the Flip is finished, but that method doesn't work.  Apparantly the screen can Flip, even if the resolution hasn't completed changing yet.<br><br>So far, all I've found to be able to do is set a Delay for 1 or 2 seconds before my game begins.  I've also chosen to do this because WinXP has an annoying habit of redrawing the taskbar at the bottom of the screen for the first half-second or so after my game switches to fullscreen (even though it shouldn't be writing to the screen anymore). <br><br></td></tr></table><br>
<a name="358857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone else?  I've seen games written in Blitz which have an accurate 1 second logo at the beginning of the game so I know this is possible; anybody who's written a game with a logo screen at the beginning feel like enlightening me? <br><br></td></tr></table><br>
<a name="358865"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> would a check for graphicswidth() do it? <br><br></td></tr></table><br>
<a name="358882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That doesn't seem to work.  I tried adding<br><br>While GraphicsWidth()&lt;&gt;xres<br>Wend<br><br>before the 1 second delay starts but that didn't help ("xres" is a variable storing the X resolution I used in the call to Graphics3D.)  Any other thoughts? <br><br></td></tr></table><br>
<a name="358920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would timing how long graphics take to initialize be of any use? Something like:<br><br><pre class=code>
	gstart = MilliSecs()
	Graphics3D 640,480,16
	gend=MilliSecs()
	gtime=gend-gstart
	EndGraphics
	
	Graphics3D 640,480,16
	Delay gtime

	Print "hello"
	Delay 1000
	
	Flip
	
	WaitKey()
	End
</pre><br><br>[edit] Sorry, scrap that - that code is clearly rubbish! :P <br><br></td></tr></table><br>
<a name="358926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Purple Sheep</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That works for me, but of course it takes twice as long to get the graphics mode running. <br><br></td></tr></table><br>
<a name="359030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So far, all I've found to be able to do is set a Delay for 1 or 2 seconds before my game begins. <br></div><br><br>This worked for me, displaying a logo for as long as I Delayed it.  I don't quite understand why this is no good for you? <br><br></td></tr></table><br>
<a name="359035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> some way of detecting WM_DISPLAYCHANGE might solve it:<br><div class="quote"> <br>the WM_DISPLAYCHANGE message is sent to all windows when the display resolution has changed.<br><br>WM_DISPLAYCHANGE  <br>cBitsPerPixel = wParam; <br>cxScreen = LOWORD(lParam); <br>cyScreen = HIWORD(lParam); <br> <br><br>Parameters<br><br>cBitsPerPixel<br><br>Specifies the new image depth of the display in bits per pixel.<br><br>cxScreen<br><br>Specifies the new horizontal resolution of the screen. <br><br>cyScreen<br><br>Specifies the new vertical resolution of the screen. <br> <br></div><br><br>probably going to have to be through a userlib <br><br></td></tr></table><br>
<a name="359192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Graphics mode change should be instant.  If it's not, then it is the monitor's fault.  Being the monitor's fault, there may be no way to detect when it's finally begun displaying the image.<br><br>But if there is any way, the only way I can think of might be to check the scanline that the monitor is currently displaying.  It might be worthwhile to write a program to print the current scanline it detects to a logfile both before and after a graphics mode change and see if it gets stuck at 0 for a little while.  If that is the case then maybe you could wait until it's not 0 to begin displaying graphics.<br><br>I'm highly doubtful that this will work, but it's the only thing I can think of that might work if the monitor is at fault. <br><br></td></tr></table><br>
<a name="359242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would have thought that simply doing a cls and flip would force it to wait until the graphics mode could respond the the flip and vwait.<br><br>As sswift says, if the monitor doesn't keep up, there is not very much that can be done to detect it. <br><br></td></tr></table><br>
<a name="359260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Graphics mode change should be instant. If it's not, then it is the monitor's fault. <br></div><br><br>Actually I've noticed that it takes windows XP much longer to change graphics mode than windows 2000/9x/ME.  So it's more likely the operating system's fault. <br><br></td></tr></table><br>
<a name="359307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> That bloody Bill Gate's fault again! :P<br><br>I thought of that scaline checking method, also. I, too, was rather sceptical it would work and I wasn't disappointed. :/ <br><br></td></tr></table><br>
<a name="359314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Graphics 800,600
delay 1000
</pre><br><br>Also, be sure your not loading things after your gfx call. <br><br></td></tr></table><br>
<a name="359333"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Er, if I don't load anything after the graphics call then nothing will be visible, rather defeating the purpose.<br><br>ADDITION: That last comment got me thinking. and I just did a little tinkering with my code and think I've figured something out.  I'll post once I figure out exactly what's going on. <br><br></td></tr></table><br>
<a name="359340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just realized the pause before graphics start rendering is not due to loading things after Graphics3D, it is due to having code BEFORE Graphics3D.  Very odd.  I just tested it down to the only line of code before I call Graphics3D is a line declaring a global variable, and this still results in a pause.  But if I call Graphics3D all the way up at the top, the starting logo is displayed immediately, even with lots of stuff going on after it before rendering starts.<br><br>This is good to know but very annoying.  I think I'll be calling Graphics3D into a safe mode like 640,480 just for displaying logos at the start, and then re-initializing into a different mode for the actual game with a check to see if that other mode is supported. <br><br></td></tr></table><br>
<a name="359343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> AARGH!  I just realized what I just described is only true if the call to Graphics3D at the top is Graphics3D 0,0<br><br>WTF?!  I think I'm going to cry.<br><br>EDIT: Sorry all, I was freaking out a little there.  This all makes sense to me now.  You need to call Graphics3D before you can use any 3D commands (and my logo is a sprite.)  Meanwhile, if you use 0,0 for the resolution, the monitor settings aren't actually changed (ie. you're rendering at desktop resolution,) thus no pause.  This is no good however since it is entirely possible for the desktop resolution to be set to a resolution which isn't supported for 3D rendering.<br><br>I'm thinking I'm just going to start with two seconds of black before displaying any logos to account for the pause. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
