<!DOCTYPE html><html lang="en" ><head ><title >Newb question - external DLLs</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Newb question - external DLLs</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Newb question - external DLLs</a><br><br>
<a name="356577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EddieRay</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can someone direct me to some documentation on how to set up calls to functions in an external DLL?  In the official B3D docs, I only see "CallDLL" which has a fixed "prototype".  However, from some of the forum posts I see what looks like B3D code with ".libs" and ".decls" stuff in it, that appears to be making function prototypes for DLLs... but I just can't find any docs describing those features...<br><br>Thanks!<br><br>Ed <br><br></td></tr></table><br>
<a name="356603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look up...  Specs and Utils.  :) <br><br></td></tr></table><br>
<a name="356604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, go to Community-&gt;Specs and Utils-&gt;Userlib Specification<br><br>As you can see, there are numerous examples floating around that use exported WinAPI functions.<br><br>&lt;edit&gt; what are the odds?  the post sits there for over an hour and then it gets two responses within 10 seconds of each other... =) <br><br></td></tr></table><br>
<a name="357269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are several aspects of external DLLs that you need to consider.  First, you have to tell your program what library (DLL) it needs to reference to use some function(s) in that library.  You can either give a specific path to the library, or you can leave it to the system to try and locate the library when it is needed.  In general, the system will search application-specific paths as found the register, the system directory (usually \windows\system), then the windows directory (usually \windows), then it will search the application directory (where the executable file loaded from), then it will search the current directory (which may be different from the application directory), and finally it will search along the path provided in the environment.  If your library can be found, then it will be loaded when needed (and kept in memory until released by all requesting processes).<br><br>Second, The function information you provide must match the number of parameters and the type of parameters (or at least the number of bytes per parameter) required for the function.  You must also provide an exact name for the function as it is found in the library, since an exact match (including case) is required.<br><br>Third, some functions provide multiple ways of processing that are controlled by certain values passed to it.  A zero may mean no parameter is passed.  A -1 may mean a default parameter is assumed.  These parameters are often related to certain constants that may be defined in files related to a given library, such as a header file (.h) for c/c++ programs, or an Include (.INC file with some Basics.  You can either define those constants in your own program, or just pass the raw value as a parameter.<br><br>Blitz3D assumes that all library (DLL) and external functions will be defined in one or more .DECLS files that may be edited and placed in the \PureBasic\UserLibs folder.<br>Most Basics (and c/c++) compilers assume you will have both "Include" and "Library" directives to permit certain functions and DLLs to be associated with different programs.  But Blitz3D actually acts by adding the external functions to its own internal references, so that all those functions and DLLs become extensions of the Blitz3D environment.  The problem at this point, is that I don't see where it also provides for universal recognition of the associated constants that go with these libraries.  You do not really need them, because you can use the raw values, but it feels like something left incomplete as a result.<br><br>It is a very interesting approach, and gives everyone the ability to enhance their copy of Blitz3D in some unique ways.  The down side is that if you mess up a .DECLS file, you can prevent Blitz3D from being able to start up, and if you misidentify a function or its parameters in a given library, it may well prevent a program from running or causing a process crash, terminating your program abnormally.  However, if you are careful, and get a good handle on the \PureBasic\UserLibs and .DECLS relationships, you are going to have a lot of fun working with this feature. <br><br></td></tr></table><br>
<a name="364766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EddieRay</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great info... thanks guys! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
