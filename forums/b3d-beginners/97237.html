<!DOCTYPE html><html lang="en" ><head ><title >Moving character over terrain in a straight line</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Moving character over terrain in a straight line</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Moving character over terrain in a straight line</a><br><br>
<a name="1128229"></a>

<a name="1128230"></a>

<a name="1128231"></a>

<a name="1128232"></a>

<a name="1128233"></a>

<a name="1128247"></a>

<a name="1128248"></a>

<a name="1128249"></a>

<a name="1128251"></a>

<a name="1128252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi guys,<br><br>I've got a problem but I don't know how to fix it.<br><br>I've made a terrain mesh in 3DS Max and imported it succesfully in Blitz3D.<br>Then I made a test-character (just a sphere) which should move in a straight line towards an end-point.<br><br>I've made the terrain mesh pickable and wherever I click on the terrain, the end-point is indicated by another sphere.<br><br>When I click the terrain, the end-point sphere is created correctly and the character moves automatically towards this point using PointEntity and MoveEntity.<br><br>However, the character doesn't move in a straight line towards the end-point when it encounters a hill.<br><br>Since the MoveEntity command pushes the character against a hill, it's forced a bit upwards, but also a bit sideways due to collisions with the terrain mesh.<br>So, the character moves in curves towards the end-point, which isn't what I need.<br><br>The character should move in a straight line even if it encounters a very steep hill.<br><br>I'm planning to use collision-meshes afterwards to prevent the character moving up some hills where he isn't supposed to go.<br><br>Just like in most MMORPG's, where you can use the arrow keys or click on the terrain to go towards that point.<br>In those games, the character moves in a straight line, running at the same speed all the time.<br><br>I was thinking about creating pivots to which the character is attached to.<br>Then I would move this pivot towards the end-point and it would drag the character along.<br>But I think this won't keep the character in a straight line either, as the character itself still collides with the terrain and gets pushed aside even when the pivot moves straight ahead.<br><br>How is this done properly? I'm thinking about this problem for a few days now and I can't continue without a solution.<br><br>This is for a MMORPG-like game (like WoW), but it will be single player only and it won't be as big of course.<br>But it will feature many aspects of such a game:<br>- killing monsters to gain experience and acquire loot<br>- trade with NPC's and craft equipment so you get more defense (better armor) and better attack (better weapon) so you can kill higher level monsters<br>- do quests to gain additional experience and unique equipment<br>- mining to get some ore (required for upgrading your gear)<br>- it will have a long main storyline with many side-quests<br>- ...<br><br>The monsters you need to kill to gain experience would use the same movement,<br>so it would be really weird if you attack a monster and it comes running towards you as if it's drunk<br>(moving in a curved path instead of a straight line because he's colliding with the hills on the terrain which push him sideways).<br><br>I've created a small example (it uses 3 textures of the xfighter demo which comes with Blitz3D).<br>It shows you what's happening. Somewhere, there's a red sphere, this is the character.<br>Just click anywhere on the terrain, there will appear a white sphere as target where the character should move towards in a straight line (but he runs there in a curved line because of collisions):<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

; Setup collision structures
Collisions 2, 1, 2, 3

;Load terrain
terr = LoadTerrain("hmap_1024.bmp")
ScaleEntity terr, 20, 250, 20
PositionEntity terr, -20*512, 0, -20*512
EntityFX terr, 1
EntityType terr, 1
EntityPickMode terr, 2

;apply textures to terrain	
tex1 = LoadTexture("coolgrass2.bmp", 1)
ScaleTexture tex1, 10, 10
tex2 = LoadTexture("lmap_256.bmp")
ScaleTexture tex2, TerrainSize(terr), TerrainSize(terr)
EntityTexture terr, tex1, 0, 0
EntityTexture terr, tex2, 0, 1



; Create camera
Global cam = CreateCamera()
PositionEntity cam, 500, 1500, -500
; Create a pivot at the center of the world and point the camera to it
center = CreatePivot()
PointEntity cam, center
CameraRange cam, 10.0, 5000.0



; Setup character
Global Char = CreateSphere()
ScaleEntity Char, 25, 25, 25
EntityColor Char, 255, 0, 0
PositionEntity Char, 0.0, 1000.0, 0.0
EntityType Char, 2
EntityRadius Char, 25, 25
TranslateEntity Char, 0.0, -1000.0, 0.0



; Setup mouse coordinates
MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2
mousespeed#       = 0.5 
camerasmoothness# = 4.5



; The target entity to which the character should move in a straight line
Global target



; Main loop
While Not KeyHit(1)
	; Check If the Left-mouse-button has been clicked
	LMBHit = MouseHit(1)

	mxs# = CurveValue(MouseXSpeed() * mousespeed, mxs, camerasmoothness)
	mys# = CurveValue(MouseYSpeed() * mousespeed, mys, camerasmoothness)
	camxa# = camxa - mxs Mod 360
	camya# = camya + mys
	If camya &lt; -89 Then camya = -89
	If camya &gt;  89 Then camya =  89
	MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2
	RotateEntity cam, camya, camxa, 0.0

	; Try picking an entity where the player clicks the mouse
	If LMBHit &gt; 0 Then
		PickedMesh = CameraPick(cam, MouseX(), MouseY())
		If PickedMesh Then
			If target &lt;&gt; 0 Then FreeEntity target
			target = CreateSphere()
			ScaleEntity target, 25, 25, 25
			PositionEntity target, PickedX(), PickedY(), PickedZ()
		EndIf
	EndIf

	; Check If there is a target set To move To
	If target &lt;&gt; 0 Then
		PointEntity Char, target
		MoveEntity Char, 0, 0, 10.0

		If EntityDistance(Char, target) &lt; 30.0 Then
			FreeEntity target
			target = 0
		EndIf
	EndIf

	; Apply gravity To the character
	TranslateEntity Char, 0.0, -25.0, 0.0

	UpdateWorld
	RenderWorld
	Flip
Wend

End




; For camera mouse look
Function CurveValue#(newvalue#, oldvalue#, increments)
	If increments &gt;  1 Then oldvalue# = oldvalue# - (oldvalue# - newvalue#) / increments 
	If increments &lt;= 1 Then oldvalue# = newvalue# 
	Return oldvalue# 
End Function
</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128253"></a>

<a name="1128254"></a>

<a name="1128269"></a>

<a name="1128274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this:<br><br>[EDIT: Updated]<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

; NOT using collisions.
;Collisions 2, 1, 2, 3

;Load terrain
terr = LoadTerrain("C:\blitz3d\samples\mak\xfighter\hmap_1024.bmp")
ScaleEntity terr, 15, 450, 15
PositionEntity terr, -20*512, 0, -20*512
;EntityFX terr, 1
;EntityType terr, 1
EntityPickMode terr, 2

;apply textures to terrain	
tex1 = LoadTexture("C:\blitz3d\samples\mak\xfighter\coolgrass2.bmp", 1)
ScaleTexture tex1, 10, 10
tex2 = LoadTexture("C:\blitz3d\samples\mak\xfighter\lmap_256.bmp")
ScaleTexture tex2, TerrainSize(terr), TerrainSize(terr)
EntityTexture terr, tex1, 0, 0
EntityTexture terr, tex2, 0, 1

; Create camera
Global cam = CreateCamera()
PositionEntity cam, 500, 1500, -500,True 
; Create a pivot at the center of the world and point the camera to it
center = CreatePivot()
PointEntity cam, center
CameraRange cam, 10.0, 5000.0

l = CreateLight()
MoveEntity l,-50,50,50
PointEntity l,center

; Setup character
Global Char = CreateSphere()
ScaleEntity Char, 25, 25, 25  ; ---------- Radius of the sphere is "25" units.
EntityColor Char, 255, 0, 0
PositionEntity Char, 0.0, 1000.0, 0.0
;EntityType Char, 2
;EntityRadius Char, 25, 25
TranslateEntity Char, 0.0, -1000.0, 0.0

Const CharSpeed# = 0.5
Local tempY#

; Setup mouse coordinates
MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2
mousespeed#       = 0.5 
camerasmoothness# = 4.5

; The target entity to which the character should move in a straight line
Global target

; Main loop
While Not KeyHit(1)
	; Check If the Left-mouse-button has been clicked
	LMBHit = MouseHit(1)

	mxs# = CurveValue(MouseXSpeed() * mousespeed, mxs, camerasmoothness)
	mys# = CurveValue(MouseYSpeed() * mousespeed, mys, camerasmoothness)
	camxa# = camxa - mxs Mod 360
	camya# = camya + mys
	If camya &lt; -89 Then camya = -89
	If camya &gt;  89 Then camya =  89
	MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2
	RotateEntity cam, camya, camxa, 0.0

	; Try picking an entity where the player clicks the mouse
	If LMBHit &gt; 0 Then
		PickedMesh = CameraPick(cam, MouseX(), MouseY())
		If PickedMesh Then  
			If target &lt;&gt; 0 Then FreeEntity target
			target = CreateSphere()
			ScaleEntity target, 25, 25, 25
			PositionEntity target, PickedX(), PickedY(), PickedZ()
		EndIf
	EndIf

	; Check If there is a target set To move To
	If target &lt;&gt; 0 Then
		
		;Old movement code:
		
		;PointEntity Char, target
		;MoveEntity Char, 0, 0, 10.0
		
		
		;Fancy new movement code:
		If EntityDistance(Char, target) &gt; 30.0 Then
			;Point Char to Target.
			TurnEntity Char,0,DeltaYaw(Char,Target),0
			
			;Calculate Char's next position based on speed.
			TFormPoint 0,0,CharSpeed, Char, 0
			
			tempY = TerrainY(terr,TFormedX(),TFormedY(),TFormedZ())
			
			;Move Char to new position (radius is added to Y so the sphere doesn't cut the 
			;terrain). No collisions used.
			PositionEntity Char,TFormedX(),(tempY+25),TFormedZ()						
		Else 
			PositionEntity Char,EntityX(Target,True),EntityY(Target,True)+25,EntityZ(target,True),True
			FreeEntity target
			target = 0
		EndIf
	
	EndIf

	; Apply gravity To the character
	;TranslateEntity Char, 0.0, -25.0, 0.0

	UpdateWorld
	RenderWorld
	Flip
Wend

End




; For camera mouse look
Function CurveValue#(newvalue#, oldvalue#, increments)
	If increments &gt;  1 Then oldvalue# = oldvalue# - (oldvalue# - newvalue#) / increments 
	If increments &lt;= 1 Then oldvalue# = newvalue# 
	Return oldvalue# 
End Function
</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This works perfectly, just as I needed it.<br><br>I've never used TFormPoint before, so I'll try to figure things out how it really works.<br><br>Would this cause much of an issue towards performance when 25 monsters are following you, each using a linepick every frame to calculate it's new position?<br><br><br><br>I've written this test code in B3D, but I'm gonna create the game using BMax + Xors3D.<br>It allows me to maintain my types better later on when I have alot of different object-types (weapons, armor-pieces, ammo, loot, ...). <br><br></td></tr></table><br>
<a name="1128265"></a>

<a name="1128266"></a>

<a name="1128267"></a>

<a name="1128268"></a>

<a name="1128270"></a>

<a name="1128271"></a>

<a name="1128272"></a>

<a name="1128273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, it can be faster. I was using LinePick because TerrainHeight was giving a freaky result.<br><br>I read a bit and this TerrainHeight command is not best suited for what I wanted. We should be using <b>TerrainY</b> (which returns the transformed terrain's Y height at a certain world location).<br><br>So in that sample above, overwrite these two lines:<br><pre class=code>
LinePick(TFormedX(),250,TFormedZ(),0,-250,0)
tempY = PickedY()
</pre>with this single one:<br><pre class=code>
tempY = TerrainY(terr,TFormedX(),TFormedY(),TFormedZ())
</pre>It runs the same, should be faster and you can use later on under Xors3D with the xTerrainY equivalent.<br><br><br>Also, just to see the sample really go to town, scale the terrain like this:<br><pre class=code>
ScaleEntity terr, 15, 450, 15
</pre>...instead of the original "20, 250, 20" (I've updated the sample with all these changes).<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've only used the terrain to show the problem. Uploading the actual mesh would need you to download another file to test my example.<br><br>The real game won't use Blitz Terrains, but actual meshes, created in 3DS Max.<br>I'll stick to the linepick in that case. TerrainY won't work with that.<br><br>On the terrain (or landscape mesh), there will be buildings, trees, rocks and other stuff as well, like the stuff all these kind of games have.<br><br>I only need to put it in a method, so it's easier to use for any monster or character. <br><br></td></tr></table><br>
<a name="1128429"></a>

<a name="1128431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> After testing some new code (adding 5 monsters to the map), which uses the same approach (using a linepick to determine the height where the monster should be positioned), performance drops significantly.<br><br>When the monsters are on their spawn-point, just idling, fps is about 320 fps.<br><br>When the player comes near them, they are put in a follow-player mode, where they use the linepicks for their movement.<br>Fps drops to about 64fps with only 5 monsters on the map.<br><br>I'll need a few 100 monsters on the same map (but they won't follow the player all the time). But there may be cases where there are 10-20 monsters moving at once, all attacking the player.<br><br>Currently, I only have a map (size 1000x1000) which is one huge mesh (about 20.000 triangles).<br>I have one player (only a sphere object) and 5 monsters, which are also spheres for now.<br>Nothing is animated yet, so that will take a performance-hit as well later on.<br><br>I'll have to find a new approach or revert back to collisions if all other approaches are performance-hitters, and take the side-effects like side-shifting of the monsters while they move.<br>It could be something special, so the monsters seem to take the easiest path (running around hills instead of over them).<br><br>I wonder how other games of this type do this efficiently, processing over a few hundred monsters at once without a big performance-hit.<br><br>Also, I cannot put all coordinates in a look-up table as the maps are too huge for this. It would eat a few 100Mb of RAM just for those coordinates to make them accurate enough.<br><br>EDIT:<br>Just tested with 20 monsters.<br>When they are all following the player, fps drops to 20fps.<br>When they are in idle-mode, fps is about 280fps.<br>This can be before the player came close to them, or after they chased the player but lost him (player got too far away and they run back to their spawn-point).<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting bit of code :) <br><br></td></tr></table><br>
<a name="1128433"></a>

<a name="1128434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob the Great</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's an odd way of doing it. Picture that you are going to point the Char sphere at the target sphere, lift it 100 meters into the air so that collisions are not a factor, move it towards the target, and then bring it down 100 meters so that it is touching the ground again. You don't see the up and down movement, but it achieves a straight line like you are wanting.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

; Setup collision structures
Collisions 2, 1, 2, 3

;Load terrain
Local terr = LoadTerrain("hmap_1024.bmp")
ScaleEntity terr, 20, 250, 20
PositionEntity terr, -20*512, 0, -20*512
EntityFX terr, 1
EntityType terr, 1
EntityPickMode terr, 2

;apply textures to terrain	
Local tex1 = LoadTexture("coolgrass2.bmp", 1)
ScaleTexture tex1, 10, 10
Local tex2 = LoadTexture("lmap_256.bmp")
ScaleTexture tex2, TerrainSize(terr), TerrainSize(terr)
EntityTexture terr, tex1, 0, 0
EntityTexture terr, tex2, 0, 1



; Create camera
Global cam = CreateCamera()
PositionEntity cam, 500, 1500, -500
; Create a pivot at the center of the world and point the camera to it
Local center = CreatePivot()
PointEntity cam, center
CameraRange cam, 10.0, 5000.0



; Setup character
Global Char = CreateSphere()
ScaleEntity Char, 25, 25, 25
EntityColor Char, 255, 0, 0
PositionEntity Char, 0.0, 1000.0, 0.0
EntityType Char, 2
EntityRadius Char, 25, 25
TranslateEntity Char, 0.0, -1000.0, 0.0



; Setup mouse coordinates
MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2
Local mousespeed#       = 0.5 
Local camerasmoothness# = 4.5



; The target entity to which the character should move in a straight line
Global target



; Main loop
While Not KeyHit(1)
	; Check If the Left-mouse-button has been clicked
	Local LMBHit = MouseHit(1)

	Local mxs#
	Local mys#
	Local camxa#
	Local camya#
	mxs# = CurveValue(MouseXSpeed() * mousespeed, mxs, camerasmoothness)
	mys# = CurveValue(MouseYSpeed() * mousespeed, mys, camerasmoothness)
	camxa# = camxa - mxs Mod 360
	camya# = camya + mys
	If camya &lt; -89 Then camya = -89
	If camya &gt;  89 Then camya =  89
	MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2
	RotateEntity cam, camya, camxa, 0.0

	; Try picking an entity where the player clicks the mouse
	If LMBHit &gt; 0 Then
		Local PickedMesh = CameraPick(cam, MouseX(), MouseY())
		If PickedMesh Then
			If target &lt;&gt; 0 Then FreeEntity target
			target = CreateSphere()
			ScaleEntity target, 25, 25, 25
			PositionEntity target, PickedX(), PickedY(), PickedZ()
		EndIf
	EndIf

	Local time = MilliSecs() ;time check
	; Check If there is a target set To move To
	If target &lt;&gt; 0 Then
		PointEntity Char, target
		TranslateEntity Char,0,100,0 ;ignore collisions for now
		MoveEntity Char, 0, 0, 10.0
		Local touchedground = 0
		While Not touchedground ;gravity in an odd way
			If KeyDown(1) Then End
			TranslateEntity Char,0,-100,0
			If EntityCollided(Char,1)
				touchedground = 1
			EndIf
			UpdateWorld
		Wend
		
		If EntityDistance(Char, target) &lt; 30.0 Then
			FreeEntity target
			target = 0
		EndIf
	EndIf
	Local finaltime
	finaltime = MilliSecs() - time

	; Apply gravity To the character
	;TranslateEntity Char, 0.0, -25.0, 0.0 ;This is done above

	UpdateWorld
	RenderWorld
	Text 0,0,"TIME TAKEN: " + finaltime
	Flip
Wend

End




; For camera mouse look
Function CurveValue#(newvalue#, oldvalue#, increments)
	If increments &gt;  1 Then oldvalue# = oldvalue# - (oldvalue# - newvalue#) / increments 
	If increments &lt;= 1 Then oldvalue# = newvalue# 
	Return oldvalue# 
End Function
</textarea><br>Let me know if this helps. Hopefully, the time is ok for more enemies. It takes about 1 millisecond on my machine, but my machine is slow.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yo!<br><br><div class="quote"> I wonder how other games of this type do this efficiently, processing over a few hundred monsters at once without a big performance-hit. <br></div><br>@PowerPC603: One thing you might want to do is <b>split</b> your terrain into several chunks in your modelling application (each being a different object, but all with the same brush). <br>If you send a single mesh with tons of polygons Blitz3D will test each one against the ray for picking. <br>I'm thinking with several chunks, Blitz3D will first test if the ray intersects each chunk's <b>bounding-box</b>, then proceed to deep polygon testing. <br>This may improve things a bit. With your 20k poly level you can start at a number of 20 chunks and see how things go (in 3DS Max it's a matter of selecting polygons and clicking Detach -&gt; To Object until you have 20 objects that represent the whole level together).<br><br>Not only that, but when you get to Xors3D + BMax make sure to use the <b>physics</b> engine to do the picking. Blitz3D's ray\line picking may be a bit slow and may not have the same optimizations that a fully dedicated physics engine accumulated through time. <br><br></td></tr></table><br>
<a name="1128441"></a>

<a name="1128443"></a>

<a name="1128444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kryzon,<br><br>I already moved to BMax + Xors3D to use type-methods to do everything.<br>Xors3D's linepick seems to be slow as well. The fps mentioned above was with BMax + Xors3D.<br>I'm not really familiar with physics engines (I think they use alot of high-level math, correct me if I'm wrong). I wouldn't know how to set things up.<br><br>I was thinking about the same idea to move the player up, then forwards and then drop his back down onto the terrain using plain collisions.<br>After alot of error and trial, it works as good as the linepick, only alot faster.<br><br>I applied collisions again (the terrain has type 1, the monsters have type 2).<br>The response for the collisions is STOP.<br>Using the other responses still resulted in the monsters being pushed sideways when translating them downwards.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' Setup a monster
Type TMonster
	Field Entity
	Field ReturnPoint
	Field MonsterType:TMonsterType
	Field SpawnX:Float, SpawnY:Float, SpawnZ:Float
	Field State

	Method New()
	End Method

	Method SpawnMonster()
		Entity = xCreateSphere()
		xPositionEntity Entity, SpawnX, SpawnY + 2.0, SpawnZ, True
		xEntityColor Entity, 255, 0, 0
		xEntityType Entity, 2
		xEntityRadius Entity, 0.75, 0.75

		ReturnPoint = xCreateSphere()
		xPositionEntity ReturnPoint, SpawnX, SpawnY, SpawnZ
		xScaleEntity ReturnPoint, 0.5, 0.5, 0.5, True
	End Method

	Method Process()
		Select State
			Case 1 ' If the monster is currently "Idle" (State = 1)
				If xEntityDistance(Entity, player.entity) &lt; MonsterType.AggroRange Then
					' Set "state" to Follow Player (2)
					State = 2
				EndIf

			Case 2 ' If the monster is currently "Following Player" (State = 2)
				' Point monster to player
				xTurnEntity Entity, 0.0, xDeltaYaw(Entity, player.Entity), 0.0

				' Move the monster 5 meters upwards to put it in mid-air
				xTranslateEntity Entity, 0.0, 5.0, 0.0
				xUpdateWorld
				' Move the monster towards the player
				xMoveEntity Entity, 0.0, 0.0, MonsterType.MovingSpeed
				' Move the monster downwards again (10 meters now to allow him going downwards off a hill) to let him collide with the terrain
				xTranslateEntity Entity, 0.0, -10.0, 0.0
				xUpdateWorld

				' After moving the monster, check if the player out-ran the monster (player too far away)
				If xEntityDistance(Entity, player.entity) &gt; 20.0
					State = 3 ' Set "state" to "Return to spawn-point"
				EndIf

			Case 3 ' If the monster has been following the player, but lost him, he should return to his spawn-point
				' Point monster to return-point
				xTurnEntity Entity, 0.0, xDeltaYaw(Entity, ReturnPoint), 0.0

				' Move the monster 5 meters upwards to put it in mid-air
				xTranslateEntity Entity, 0.0, 5.0, 0.0
				xUpdateWorld
				' Move the monster towards the return-point
				xMoveEntity Entity, 0.0, 0.0, MonsterType.MovingSpeed
				' Move the monster downwards again (10 meters now to allow him going downwards off a hill) to let him collide with the terrain
				xTranslateEntity Entity, 0.0, -10.0, 0.0
				xUpdateWorld

				' After moving the monster, check if he reached his spawn-point
				If xEntityDistance(Entity, ReturnPoint) &lt; 2.0
					State = 1 ' Set "state" to "Idle"
				EndIf
		End Select
	End Method
End Type
</textarea><br>This is my code now using BMax + Xors3D.<br><br>Both UpdateWorlds are needed apparently to get the proper results.<br>Now it processes 50 monsters at 155fps when they're moving (following the player or returning to their spawnpoint).<br>When they are idling, I have 185fps.<br>So not a big performance loss anymore.<br><br>Each monster also has a sphere to indicate it's return-point, which will be replaced by a pivot of course.<br><br>So, with 50 monsters in view and the player (also with his target-point), I'm rendering 102 sphere's (50 monsters, 50 return points, the player and his target point) and a big landscape.<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um, just wondering. isnt this supposed to be Blitz3D ONLY? :) <br><br></td></tr></table><br>
<a name="1128445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> This test started using B3D and it gave me about the same results. <br><br></td></tr></table><br>
<a name="1128446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I wonder how other games of this type do this efficiently, processing over a few hundred monsters at once without a big performance-hit <br></div><br><br>I think you'll find it's very rare to actually use collisions for this sort of thing. It's much, <i>much</i> easier to ditch the collision system, move your characters in X and Z as though on a grid, and get their Y using simple, pure mathematical operations. If you need them to collide with or at least avoid each other too, you can use a very simple radial system.<br><br>(Of course I say this without knowing what else you want to use collisions for, but if all they're doing is stopping things going through the floor, you would do a lot better to not use them at all, as what they're <i>intended</i> for is correctly applying the sliding movement.)<br><br>Also, Blitz3D's collision system is quite slow by the standards of other, newer physics engines and collision systems, and you may experience quite a speed up just from moving.<br><br><br><div class="quote"> isnt this supposed to be Blitz3D ONLY? :)  <br></div><br><br>You jealous or something?<br><br>Xors3D is directly based on Blitz3D's command set. This is the best place on the Blitz forums to discuss it. <br><br></td></tr></table><br>
<a name="1128447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well exCUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUSE me, princess -.-<br><br><br>I was just asking -.- <br><br></td></tr></table><br>
<a name="1128448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm not really familiar with physics engines (I think they use alot of high-level math, correct me if I'm wrong). I wouldn't know how to set things up. <br></div><br>Their purpose is to make all the calculations for you, so you're only required to set things up such as values and create bodies (it's painless, minimal testing required). <br>These engines are especially useful when they come bundled with a game engine such as Xors3D, which means they are totally integrated with how it works.<br><br>In this case <a href="http://xors3d.com/xors3d/xors3d-features/physics" target="_blank">Xors3D uses Bullet</a>, a tried-and-true physics engine used in several AAA games, so you can totally rely on it. It's lightning fast.<br><br>I'm glad it's working with the collisions, but in that case you're spending two transformations (the Translates), plus the double calls to UpdateWorld (also take a look at xResetEntity, might be good). <br>You'll need this performance later on for animations and AI.<br><br>Using Bullet, you'd just need a Trimesh rigid-body for the environment and then you'd be ready to raycast it, which is the equivalent of LinePicking (I'm sure this is documented or exemplified with Xors3D). <br>Then retrieve the raycast <b>contact information</b> from Bullet and use these values. You can even keep using Xors3D native collisions with it. <br><br></td></tr></table><br>
<a name="1128449"></a>

<a name="1128450"></a>

<a name="1128451"></a>

<a name="1128452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, collisions in my game will be used to prevent the monsters (and your character) from falling through the ground.<br><br>They will also be used when I have buildings, rocks, trees and alot more stuff on the map.<br>So all these things would need collisions as well.<br><br>After all, I would still need collisions when I have a collision-mesh to prevent monsters/players moving up/down a hill where they're not supposed to come.<br>The character is not supposed to be able to fall down a cliff or walk up very steep hills (over 60 degrees upwards).<br>So it's easy to use a collision-mesh (just vertically positioned quads, all merged together in one single mesh) to block certain areas.<br><br>Doing all these checks using maths would make the code huge (as you need to calculate your position against everything else in the world).<br><br><br><br>No offense, but I'd rather use collisions which give me a good performance instead of calculating the position of a monster with poor results, even if it's not the "default" way of doing it.<br><br>I cannot sell it when the game is running at 5fps with the excuse that I've used mathematical calculations to prevent bugs instead of standard collisions, just because it's THE way to do it.<br><br><div class="quote"> <br>Xors3D is directly based on Blitz3D's command set. This is the best place on the Blitz forums to discuss it. <br> <br></div><br>My thought exactly.<br>There is no sub-forum for BMax using Xors3D, and asking this in the BMax forums isn't correct either, as it has more to do with Blitz3D than BMax, given the nature of the topic (3D collisions or calculations).<br><br><div class="quote"> <br>I'm glad it's working with the collisions, but in that case you're spending two transformations (the Translates), plus the double calls to UpdateWorld (also take a look at xResetEntity, might be good).<br>You'll need this performance later on for animations and AI.<br> <br></div><br>I tested some more and I could already get rid of the second UpdateWorld.<br>Won't ResetEntity clear the collision-data from the entity?<br><br>EDIT: just tested by adding xResetEntity.<br>Removing the first xUpdateWorld and putting xResetEntity instead works as a charm as well.<br>Now both xUpdateWorld commands are gone.<br><br>There is only one left in the main loop, executed only once per frame.<br><br><br><br>Since this game is still in a very early development status, I could spend some time to learn how to use physics.<br>I could make a backup of the current code and try to get it done with physics.<br><br><br><br>I wanted to make a game like GTA, combined with some features of X3: Terran Conflict (a 3D spacegame, made by Egosoft).<br>To build a big world where the player could do missions and build his own factories to make his own products and sell them to the AI.<br>But it seemed to difficult because of all the physics any vehicle would need.<br><br>Since I also like to play games like WoW, LineAgeII and RF Online, it seemed easier to make a game like that.<br>It would only involve simple collisions to prevent the player and monsters falling through the ground and to collide with buildings and other stuff like trees and rocks.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128458"></a>

<a name="1128459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> collisions which give me a good performance instead of calculating the position of a monster with poor results <br></div><br><br>Um... I think you took the opposite of what I meant...<br><br>The mathematical solution would be faster, since it would involve doing less work (collisions after all use the same logic, they just do it within the B3D/Xors library), and would be more accurate since you wouldn't have to deal with the sliding issue that's been a problem for you so far.<br><br>The thing with game development is actually very much <i>not</i> to find the rigorously "correct" solution, but to find the fastest way to cheat and get approximately suitable results. I agree entirely with your desire to ship something fast!<br><br><br>So the obvious area where we can ask the "How can we <b>cheat</b>?" question is: do we really need three dimensional collisions for this game engine? For GTA, yes, you need a full physics system for all objects (since cars will spin in midair and whatnot). If we assume you're going for the WoW route though... in truth, no you don't really need a 3D system.<br><br><br>Note this:<br><br><div class="quote"> I would still need collisions when I have a collision-mesh to prevent monsters/players moving up/down a hill where they're not supposed to come <br></div><br><br>If you want to stop people moving over cliffs in <i>both</i> directions, then you're already moving away from the idea of full 3D simulation. The type of game this sounds like it's describing would be more suited to having an invisible "map" built with 2D boundaries. You could then simulate the characters' movement in X and Z using this invisible map and a <b>2D</b> physics engine, and use a completely separate heightmap-based system for placing them in the Y.<br><br>It's not a serious suggestion that you should make the game this way (you'd need to do something else for buildings), but to point out that the most generic toolset - the 3D collision engine - shouldn't constrain your design process. Generic tools are always the slowest, but you can always come up with something better.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128460"></a>

<a name="1128461"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> The gameworld won't just be a 2D terrain with some slopes on it.<br>There could also be buildings where you can walk through on several levels or even on the roof.<br>Bridges will also be there to allow the player to move over a cliff.<br><br>There will also be caves underground where monsters live, as well as on the surface (right above the cave, or even several caves below eachother, each one connected by tunnels or corridors).<br>Using a 2D boundaries map would block a player inside the cave from running up a stalagmite somewhere, that would be good.<br>But it would also block the same 2D area on top of the cave (the surface of the world) where everything is nearly flat and passable.<br><br>So, using a 2D physics engine and calculating the Y won't help in this case, as there will be multiple Y-values on some locations.<br><br><br>I tried using maths (isn't linepick pure math?), but the results were alot slower than using collisions.<br>Linepick with 20 monsters following the player = 20fps (only one linepick per monster per frame).<br>Collisions with 195 monsters following the player = 27fps (just tested).<br><br>Or are you talking about other math which doesn't involve linepicks or something similar?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128463"></a>

<a name="1128464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Or are you talking about other math which doesn't involve linepicks or something similar? <br></div><br><br>Yeah, I just meant get the Y heights of the vertices of the triangle the character is standing on, and use the character's X and Z to get their height on said polygon interpolated between the corners. This is based on your statement much higher up that you had a "terrain mesh", indicating a regular grid (it would work without a grid too, just be a little less efficient since you couldn't simplify everything assuming you know where the verts are). This is more or less what the TerrainHeight function does with builtin (non-mesh) terrains.<br><br>LinePick by contrast is quite a slow command (counts as part of the collision system, by the way - it uses the same backend)... <i>but</i> this is only true of the Blitz3D version so you may well find other collision engines give a massive speed boost to your existing setup. (I would expect Bullet, as suggested by Kryzon above, to be pretty good at this.)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128471"></a>

<a name="1128472"></a>

<a name="1128473"></a>

<a name="1128474"></a>

<a name="1128475"></a>

<a name="1128476"></a>

<a name="1128477"></a>

<a name="1128478"></a>

<a name="1128479"></a>

<a name="1128480"></a>

<a name="1128481"></a>

<a name="1128482"></a>

<a name="1128483"></a>

<a name="1128486"></a>

<a name="1128526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've just tested it again with 190 monsters, using the physics.<br>It was actually very simple to setup, just as Kryzon said.<br><br>I just applied xEntityAddTriMeshShape to the terrain mesh.<br>Every frame, the monster uses this code to perform it's movement:<br><pre class=code>
				' Calculate monster's next position based on speed
				xTFormPoint 0.0, 0.0, MonsterType.MovingSpeed, Entity, 0
				x = xTFormedX()
				y = xTFormedY()
				z = xTFormedZ()
				xPhysicsRayCast x, y + 5.0, z, x, y - 5.0, z
				' Move monster to new position
				xPositionEntity Entity, x, xPhysicsGetHitPointY(), z
</pre><br><br>It checks the terrain from 5 meters above and below the monster's calculated 2D movement, using a raycast.<br><br>Now, when the monsters are idle at their spawn-point, I get 70 fps. I'm rendering 383 surfaces at the screen (190 monsters, 190 spheres for the return points, 1 player, one sphere for the player's target position and the terrain itself).<br>The raycasting doesn't do anything yet, because that code isn't in the idle-state.<br><br>When I get close to a monster, it changes it's state to "follow", which uses the raycast to determine it's position.<br><br>The result is remarkably: absolutely no drop in fps.<br>It stays at 70fps, even when all 190 monsters are raycasting the terrain to determine their position every frame to follow the player.<br>Using collisions, my result dropped to 27fps using 195 monsters. So physics are even better than collisions.<br><br>Thanks for the idea and a little knowledge on how to get started using the physics stuff, Kryzon.<br><br><br>After replacing the return-point spheres by pivots, fps went even higher to 120fps. Which also stays the same in both idle state and follow state of all 190 monsters.<br><br><br><br>I wonder why linepick is so damn slow and a raycast is extremely fast.<br>I even don't have multithreading enabled (I don't know if it would give a speed boost).<br><br>Correct me if I'm wrong, but from what I understood about reading something about raycasting, is that models are actually split up in octrees.<br>My guess would be that each branch (the smallest part of the octree) or whatever they are called, of the octree holds only a few polygons.<br>And where linepick scans the entire mesh, raycast could only scan the branches where the ray exists. Maybe that could explain why raycasting is alot faster than linepick.<br><br>It doesn't really matter how it works. The most important thing is to get fast code and the proper results :)<br><br><br><br>I could still use the normal collisions for bumping into buildings, rocks, trees and all the other stuff if needed.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, that's awesome! I didn't know it'd be that fast. Congrats on getting it to run. <br><br></td></tr></table><br>
<a name="1128504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very interesting thread, been toying with an idea which requires this kinda lgic, thx. <br><br></td></tr></table><br>
<a name="1128524"></a>

<a name="1128525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also didn't expect a raycast to be that fast. It's doing 190 raycasts per frame, without even 1 fps performance-hit. Talk about speed of physics engines.<br><br>Of course, the player won't be able to engage 190 monsters at once to fight them during the entire game.<br><br>But I definately need high amounts of monsters to fill the map (between 100 and 500 monsters, based on the layout and size of the map).<br>There will be added checks to prevent processing monsters on the other side of the map (which are too far away from the player).<br><br>At some point, there will be a large amount of monsters near the player (about 50).<br>I'm planning an event in the game where, at certain intervals, packs of monsters attack your home town.<br>In the beginning, there won't be many monsters and they will be weak, but later on, the strength and amount of monsters will go up.<br>The home town will have automatic defense towers at the gates which can hold off a few monsters, but as the game progresses and the player becomes stronger, he'll have to fight to help protecting the town and avoid an invasion.<br><br>It's only during such an event where the player will have large amounts of monsters near his location, all moving and doing stuff like attacking the gates, the player or other NPC's in town.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1128626"></a>

<a name="1128627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did some more testing to compare linepicks between Blitz3D, BMax + Xors3D and physics raycasting.<br><br>Blitz3D code:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

cube = LoadMesh("d:\programming\blitzmax\mygame\models\landscape01.b3d")
EntityPickMode cube, 2

cam = CreateCamera()
PositionEntity cam, 200, 200, -400
PointEntity cam, cube



quantlinepick = 1000

While Not KeyHit(1)
	starttime = MilliSecs()
	For i = 1 To quantlinepick
		LinePick 0.0, 10.0, 0.0, 0.0, -20.0, 0.0
	Next
	stoptime = MilliSecs()

	UpdateWorld
	RenderWorld

	Text 10, 10, "Time for " + quantlinepick + " linepicks: " + (stoptime - starttime) + "ms"

	Flip
Wend


End
</textarea><br><br>BMax + Xors3D code:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Import xorsteam.xors3d

xGraphics3D 800, 600, 32, False, False

Global cube = xLoadMesh("d:\programming\blitzmax\mygame\models\landscape01.b3d")
If cube = 0 Then RuntimeError("failed to load landscape")
xEntityPickMode cube, 2

cam = xCreateCamera()
xPositionEntity cam, 200, 200, -400
xPointEntity cam, cube



Global quantlinepick = 1000

While Not xKeyHit(1)
	starttime = xMillisecs()
	For i = 1 To quantlinepick
		xLinePick 0.0, 10.0, 0.0, 0.0, -20.0, 0.0
	Next
	stoptime = xMillisecs()

	xUpdateWorld
	xRenderWorld

	xText 10, 10, "Time for " + quantlinepick + " linepicks: " + (stoptime - starttime) + "ms"

	xFlip
Wend


End
</textarea><br><br>BMax + Xors3D using physics:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Import xorsteam.xors3d

xGraphics3D 800, 600, 32, False, False

Global cube = xLoadMesh("d:\programming\blitzmax\mygame\models\landscape01.b3d")
If cube = 0 Then RuntimeError("failed to load landscape")
xEntityAddTriMeshShape cube

cam = xCreateCamera()
xPositionEntity cam, 200, 200, -400
xPointEntity cam, cube



Global quantraycasts = 1000

While Not xKeyHit(1)
	starttime = xMillisecs()
	For i = 1 To quantraycasts
		xPhysicsRayCast 0.0, 10.0, 0.0, 0.0, -10.0, 0.0
	Next
	stoptime = xMillisecs()

	xUpdateWorld
	xRenderWorld

	xText 10, 10, "Time for " + quantraycasts + " raycasts: " + (stoptime - starttime) + "ms"

	xFlip
Wend


End
</textarea><br><br>With this quick test, I got these results:<br>Blitz3D using 1000 linepicks on the terrain: 8ms<br>BMax + Xors3D using 1000 linepicks: 2240ms<br>BMax + Xors3D using 1000 raycasts: 7ms<br><br>So it seems Xors3D's linepick is way slower than blitz3D's linepick.<br>B3D's linepick seems to be as fast as Xors3D's (or better, Bullet's) physics engine.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
