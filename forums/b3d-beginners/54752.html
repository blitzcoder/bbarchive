<!DOCTYPE html><html lang="en" ><head ><title >LOD Calculations?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >LOD Calculations?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >LOD Calculations?</a><br><br>
<a name="610178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dripht</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe calculations is the wrong word, but:<br><br>I know the basics of how LOD works, the further a mesh is away from view, the less polygonal detail it should have.<br><br>But how do you do this is blitz? Use an EntityDistance() check for the object to the camera entity and change the mesh based on that? But I wouldn't want to do that for every entity right, just the ones that are within the cameras view. So I'd loop through all the entities to check if they are EntityInView to the camera?<br><br>I've used inview and entitydistance before and I know they aren't exactly fast.<br><br>Surely doing all that would slow the game down much more than simply drawing all the meshes at full detail would?<br><br>What's the most efficient method for checking for LOD changes in Blitz3d? <br><br></td></tr></table><br>
<a name="610212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> correct me if I'm wrong, but entitydistance if pretty fast,<br>all it has to do is a calculation like<br><br>d=sqr((a*a)+(b*b)+(c*c))<br><br>It's surely a lot faster than rendering several thousand triangles.<br><br>What's tricky with a lod system if you once got the models in the required various LODs, is to sync them. While static models don't need to be synced, LOD is especially useful for animated models such as characters.<br><br>Some engines use a VIS system for static content and LOD for the animated parts.<br><br>I wouldn't worry too much about the speed of entitydistance, it's a simple calcualtion, compared to the millions of operations that need to be performed to render a scene. <br><br></td></tr></table><br>
<a name="610270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Couldn't you optimize that furthur by performing a LOD check only every other frame or something like that? <br><br></td></tr></table><br>
<a name="610272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've seen some games do a LOD refresh every half a second but what you've got to bear in mind is that if you <i>do</i> do something like that, is that particular frame going to lag?<br><br>A better but more difficult option is to check <i>half</i> the scene every frame, causing a full LOD refresh every other frame but spreading the load more evenly. Obviously this then extends to checking a tenth of the screen every frame for a full update in ten frames.<br><br>You would have to have a very specific reason for going to all that trouble of course :) <br><br></td></tr></table><br>
<a name="610274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's no way you're going to have enough entities in your scene that you need to worry about optimizing a distance check to each one.  Even if you had a thousand entities, that's only a thousand square roots each frame, which on today's PC's is nothing.  <br><br>But if you are that concerned about it, it's trivial to optimize out the square root simply by calculating the square of the distance and using that instead.<br><br>Let's say the max distance your first LOD should be visible is 100 meters.  You can easily calculate the LOD to use like so:<br><br><pre class=code>
MinDist# = 100

Exyz = Entity xyz
Cxyz = Camera xyz

DistSquared# = (Ex#-Cx#)^2 + (Ey#-Cy#)^2 + (Ez#-Cz#)^2

LOD = 4
For Loop = 0 to 4
  If DistSquared# &lt; (MinDist# * 2^Loop)^2
     LOD = Loop
     Exit
   EndIf
Next
</pre> <br><br></td></tr></table><br>
<a name="610528"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Umm, what's a LOD? (I'm a newbie at 3d). <br><br></td></tr></table><br>
<a name="610531"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Level Of Detail <br><br></td></tr></table><br>
<a name="610533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. <br><br></td></tr></table><br>
<a name="610556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sir:<br>Sometimes, when you have really detailed meshes, and a long view distance, you might want to use meshes with fewer polygons as the object moves into the distance.  That's what LOD is all about.  Switching between those meshes at the right time. <br><br></td></tr></table><br>
<a name="610683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, using a proper 3d program, you could create two version of a 3d model, and reduce the polygon count for the distant view, thereby reducing the workload on Blitz? <br><br></td></tr></table><br>
<a name="610694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep <br><br></td></tr></table><br>
<a name="610754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> But, you should make sure you need to do it before you go to all that trouble.  If your model only has say 1000 polygons to begin with, it's quite possible that making a bunch of lower detail versions isn't going to increase speed at all.  Each model has a base cost for rendering it regardless of the number of polygons.  Or more specifically, each surface in each model.  The polygons contribute only a little time each, so you might have to have 1000 just to equal the cost of the one surface alone, and halving the number of polygons might only reduce the cost of rendering the model to 75%.<br><br>These are all just guesses of course.<br><br>I made a foliage system which got around this issue by combining meshes in the distance to reduce the surface count as well as reducing the polygons, but that resulted in the use of tons of video memory for storing the meshes, as every single tree on the terrain had to be a unique mesh, so it was only good for relatively small maps. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
