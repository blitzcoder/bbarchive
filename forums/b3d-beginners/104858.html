<!DOCTYPE html><html lang="en" ><head ><title >EntityX, Y, and Z return NaN</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >EntityX, Y, and Z return NaN</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >EntityX, Y, and Z return NaN</a><br><br>
<a name="1273049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ColeE</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This function that I wrote seems fine to me and I've been looking at it for hours and I can't find the problem. I have an opponent ship in a game I'm working on and this function is supposed to be used to have it rotate and maneuver toward the player ship.  However when using it, the opponent ship is nowhere to be found, so, just now, I decided to display its coordinated on the screen, and I got NaN for each of them, which I find very confusing (This does not occur if the function is not called just to clarify).  So, here it is... and sorry it's so ugly looking... hopefully you can infer enough about the types and variable to understand it...<br><br>[code]<br>Function EnemyControl()<br>	TurnEntity enemyShip, (DeltaPitch(enemyShip, myShip)/Abs(DeltaPitch(enemyShip, myShip)))*NPCShip(currentEnemyShip%)\turnSpeed#, (DeltaYaw(enemyShip, myShip)/Abs(DeltaYaw(enemyShip, myShip)))*NPCShip(currentEnemyShip%)\turnSpeed#, (DeltaYaw(enemyShip, myShip)/Abs(DeltaYaw(enemyShip, myShip)))*NPCShip(currentEnemyShip%)\turnSpeed#<br>	If Abs(EntityRoll(enemyShip))&gt;Abs(NPCShip(currentEnemyShip%)\maxTurnAngle%) Then RotateEntity enemyShip, EntityPitch(enemyShip), EntityYaw(enemyShip), EntityRoll(enemyShip)/Abs(EntityRoll(enemyShip))*NPCShip(currentEnemyShip%)\maxTurnAngle%<br>	If Abs(EntityPitch(enemyShip))&gt;Abs(NPCShip(currentEnemyShip%)\maxTurnAngle%) Then RotateEntity enemyShip,EntityPitch(enemyShip)/Abs(EntityPitch(enemyShip))*NPCShip(currentEnemyShip%)\maxTurnAngle%, EntityYaw(enemyShip), EntityRoll(enemyShip)<br>	If EntityDistance(enemyShip, myShip) &gt; 24 Then MoveEntity enemyShip, 0, 0, NPCShip(currentEnemyShip%)\speed#<br>End Function <br><br></td></tr></table><br>
<a name="1273050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You will get a division by zero on the first Turnentity if the deltapitch or deltayaw is zero.  This would cause a Nan which will then cause the entity position to become a Nan.  Do you pick anything up when running in debug mode?  You could easily test for and catch this scenario. <br><br>It may be unrelated but I have found that if you use a global helper pivot and rotate and position this to calculate things hundred of times each frame it will eventually result in NAN's.  The solution for me was to reset the position and rotation of this pivot each frame, i.e. Rotateentity Pivot, 0,0,0, PositionEntity Pivot,0,0,0 and scaleentity Pivot,0,0,0. <br><br>Stevie <br><br></td></tr></table><br>
<a name="1273089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ColeE</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, very helpful <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
