<!DOCTYPE html><html lang="en" ><head ><title >moving objects 'away'/'toward' camera</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >moving objects 'away'/'toward' camera</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >moving objects 'away'/'toward' camera</a><br><br>
<a name="607683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> i have a camera that moves around independently of the player's ship.<br><br>i am wondering how i can make it so that when the player presses the UP key, the ship moves 'away' from the camera, how do i translate to the X,Z that i need to move the ship?<br><br>the ship doesn't always face 'forward', so i can't just add to Z.  the ship faces various directions independently of the direction you push, so i'm moving the pivot x,z along the terrain plane.<br><br>if the camera first starts out, the up arrow moving 0,Z+1 works fine.  But if the camera moves 90 degrees to the side but is still pointing at the ship, then UP means X+1,0<br><br>and so on, for all the possible angles.<br><br>how then to get the correct X,Z for the ship based on where the camera is? <br><br></td></tr></table><br>
<a name="607706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you making a 3D app in Blitz plus? <br><br></td></tr></table><br>
<a name="607730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ryan - this is the 4th post of yours in the last week or two I have had to move to the correct forum! <br><br></td></tr></table><br>
<a name="607857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something like this should work ....<br><br><pre class=code>
Dx# = ( keydown( 203) - keydown(205) ) * speed#
Dz# = ( keydown( 200) - keydown(208) ) * Speed#
tformvector Dx,0,Dz, CAMERA, 0
translateentity SHIP , tformedx() , 0 ,  tformedz()
</pre><br><br>Cheers<br>Stevie <br><br></td></tr></table><br>
<a name="607964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks beaker <br><br>i'm sorry i might have had multiple windows open to blitzbasic.com and posted one window after i had switched forums in another.  :/  I was researching while composing the post.   I'll have to make sure i don't do that.  <br><br>thanks Stevie G!<br><br>this definitely seems to move the ship in the right direction, but at inconsistent speeds.  depending on the rotation of the camera, the ship moves much more quickly left/right, or if you rotate the cam a little, forward/back.  about 5* faster<br><br>is there a way to compensate?  it seems that * speed doesn't translate right here.  I want it to move * speed on the ground, and it seems that * speed here causes tformedx()/z() to be far more and far less than speed.  <br><br>example output printing them:<br><br>t_x()  t_z()<br>going away:<br>0.0   -1.74218<br>going left<br>-10.0   0<br><br>so it zooms left and right, crawls forward and back.  :?<br><br>even when the cam is directly above the ship it doesn't behave consistently on the different axes.  <br><br>hmm i have no ideas here, any clues? <br><br></td></tr></table><br>
<a name="608007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Baystep Productions</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really, I'd just get the yaw and pitch of the camera, match it to the ship using some rotational tweaning like in the smart camera, or the tracking functions, so that the ship in the end has the rotational values as the camera, then just moveentity on it.<br><br><pre class=code>
RotateEntity ship,EntityPitch(camera),EntityYaw(camera),0
MoveEntity ship,0,0,1
</pre> <br><br></td></tr></table><br>
<a name="608018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you scaleentity the camera at all?  This will also scale tformvector results.  Try tformnormal ...<br><br>Dx# = ( keydown( 203) - keydown(205) ) <br>Dz# = ( keydown( 200) - keydown(208) ) <br>tformnormal Dx,0,Dz, CAMERA, 0<br>translateentity SHIP , tformedx()*speed , 0 ,  tformedz()*speed <br><br></td></tr></table><br>
<a name="608548"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stevie G<br><br>i don't scale the cam.<br><br>the code you provided returns value for x,y and z.  Not just x and z.   <br><br>I think maybe i'm not clear on the setup.  The camera is way above, and slightly behind the ship.  but you can move it anywhere in relation to the ship, to the side, whatever.  The terrain slopes off into the distance.  ship sits flat on it.  to move ship left, i moveentity ship,-speed,0,0. to move up/forward/away, whatever you want to call it, moveentity ship,0,0,speed.  ship does not face where it moves, so i don't rotate and move forward.<br><br>When the player presses up, it should move the car what appears to be 'away' (if the car were facing that direction it would drive 'forward').  i need to get an x and z as far as the car is concerned.  doing anything to car's Y makes it float up or sink down into the terrain.<br><br>That Y component is taking away from x and z. <br><br>i'm perplexed.  there is no example of this anywhere i can find.<br><br>i tried translating from screen to the terrain the ship is on, that produces the same answers (car is aligned to that terrain anyway so it should)<br><br>if you put a piece of paper on the screen, and drew a line from the ship straight up, when player presses UP and the ship moves, it should be moving a combination of x and z that follows that line.  of course you're looking at a terrain on the y plane so it would move the car along that terrain.<br><br>does this make sense? <br><br></td></tr></table><br>
<a name="608563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm doesn't the camera's Y translate to up and down on your screen?  not z...  ?  z means in and out or forward/back.  if you move camera by -Y it moves up your screen. <br><br>so i think this is doing what i want.<br><br><pre class=code>
x# = ( keydown( 203) - keydown(205) ) 
z# = ( keydown( 200) - keydown(208) ) 
If x Or z  ; if you don't do this then tformedy, etc is NaN so we get bad values
TFormVector x,z,0, cam, carpiv ; note the position of Z!!
; now convert the x and z components into a normal.  we don't want the Y part.  x and z too small because Y takes away from the 1
TFormNormal TFormedX(),0,TFormedZ(),carpiv,carpiv  ; zero out y and get a normal. yes carpiv to carpiv
MoveEntity carpiv , TFormedX()*carspeed , 0 , TFormedZ()*carspeed 
							
DebugLog TFormedX()+" "+TFormedY()+" "+TFormedZ() 
EndIf
</pre><br><br>now i occasionally get Y values but they appear to be due to floating point precision errors and are very tiny.<br><br>this appears to work no matter position of cam.  at least so far. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
