<!DOCTYPE html><html lang="en" ><head ><title >How do you save a mesh made from blitz 3D?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How do you save a mesh made from blitz 3D?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >How do you save a mesh made from blitz 3D?</a><br><br>
<a name="347081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiverRatt</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to make a 3d terrain generator and have gotten as far as I will go till I have the most important part working, saving.<br>and mabye exporting.<br>Does anyone have any suggestions? tuts? Intrist? <br><br></td></tr></table><br>
<a name="347086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> This might help: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=866" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=866</a> <br><br></td></tr></table><br>
<a name="347448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiverRatt</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, so where do I plug it in at?<br><br>; ModifyTerrain Example<br>; ---------------------<br><br>Graphics3D 640,480<br>SetBuffer BackBuffer()<br>SeedRnd MilliSecs()<br><br>terra_size=32 ; initial size of terrain, and no. of grids segments, along each  side<br>x_scale=10 ; x scale of terrain<br>y_scale=50 ; y scale of terrain<br>z_scale=10 ; z scale of terrain<br>marker_x=terra_size/2 ; initial x position of marker<br>marker_z=terra_size/2 ; initial z position of marker<br>Global camangle<br><br><br><br><br><br>Global camera=CreateCamera()<br>PositionEntity camera,(terra_size*x_scale)/2,50,0 ; position wherever; just  try and get good view of terrain!<br>RotateEntity camera,30,0,0 ; again, try and get good view of terrain<br><br>lite=CreateLight(3)<br>RotateEntity lite,90,0,0<br>; Create terrain<br>Global terra=CreateTerrain(terra_size)<br>ScaleEntity terra,x_scale,y_scale,z_scale<br> <br><br><br>;change texture button<br>cycle_tex = 3<br><br>;wall_texrure.bmp<br>wall_tex = LoadTexture("data/wall_texture.bmp")<br>EntityTexture terra,wall_tex<br> <br><br>; Texture terrain<br>glassgrid_tex=LoadTexture("data/crossgrid.bmp")<br>;EntityTexture terra,grass_tex<br>EntityAlpha terra,.5<br>brownstone_tex=LoadTexture("data/brownstone.bmp")<br><br><br>; Create marker<br> markerI=CreateSphere()<br>Global marker=markerI<br>ScaleEntity marker,1,1,1<br>EntityColor marker,255,0,0<br>	;Data marker_x<br>	;Data marker_y<br>	; Create array<br>; texture terrain-1.jpg<br>terrainA = LoadTexture("data/terrain-1.jpg")<br>ScaleTexture terrainA,4,4 <br>PointEntity lite,marker<br><br>Dim nums(9)<br><br><br>; Fill each element with a random number<br>For i = 0 To 9<br>nums(i) = Rand(1,10)<br>nums(i) = nums(i) + 1<br>Next<br><br>Global tracknum#<br>Global 	varX=Rnd(1,5)<br>Global	varY=Rnd(1,5)<br>Global	varZ=Rnd(1,5)<br>Global Markercube<br> Markercube = LoadMesh("data/Dir_Box.b3d")<br>;RotateEntity Markercube,90,0,0<br>RotateEntity Markercube,0,0,90<br>ScaleEntity MarkerCube,.5,.5,.5 <br>;ScaleEntity Markercube,4.75,1,4.75<br>EntityColor MarkerCube,100,0,50<br>EntityAlpha MarkerCube,.5<br>Global Mode<br>Mode = 0<br>	<br>vertex_morph=True<br><br>leavelight = 0<br>cam_turn_speed=0<br>; Set initial uv scale values<br>u_scale#=1<br>v_scale#=1<br><br>;start of mainloopVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVv<br>While Not KeyDown(1)<br><br>;entity free flight mode a second camera?<br><br><br><br><br>;light mode l key<br>If KeyHit (38) = True  Then leavelight = leavelight+ 1<br>If leavelight =&gt; 3 leavelight = 1<br> If leavelight = 1 Then<br>	PositionEntity lite,EntityX(marker),EntityY(marker)+20,EntityZ(marker)+20<br>;PointEntity lite,marker<br>    End If <br> ;If leavelight = 2 Then<br>	<br><br>If KeyHit(74) Then ; press + to randomly change the 'cone' of light <br>LightConeAngles lite, Rand(120),Rand(120)<br>LightRange lite,Rnd(1000,2000)<br>PointEntity lite,marker<br><br>End If<br><br><br>If KeyHit(79) Then <br>LightColor lite,Rnd(-255,255),Rnd(-255,255),Rnd(-255,255)<br>;EntityColor marker,<br>End If<br> <br>;check for change of texture<br><br>If KeyHit(78) = True Then cycle_tex = cycle_tex + 1<br>If cycle_tex &gt; 4 Then cycle_tex = 1<br>		If cycle_tex = 1 Then EntityTexture terra,wall_tex <br>		If cycle_tex = 1 Then EntityAlpha terra,.5<br>		<br>		If cycle_tex = 2 Then EntityTexture terra,glassgrid_tex<br>		If cycle_tex = 2 Then EntityAlpha terra,.5<br>		 <br>        If cycle_tex = 3 Then EntityTexture terra,terrainA<br>		If cycle_tex = 3 Then EntityAlpha terra,1<br>		<br>		If cycle_tex = 4 Then EntityTexture terra,brownstone_tex<br>		If cycle_tex = 4 Then EntityAlpha terra,1<br>		;If cycle_tex = 4 Then ScaleTexture brownstone_tex,2,2<br>		;up on numberpad = 72<br>		;down on mumberpad = 80<br>		;left on numberpad = 75<br>		;right on mumberpad = 77 <br>				If KeyDown( 80 )=True Then u_scale#=u_scale#-0.01 <br>				If KeyDown( 72 )=True Then u_scale#=u_scale#+0.01 <br>				If KeyDown( 75 )=True Then v_scale#=v_scale#-0.01 <br>				If KeyDown( 77 )=True Then v_scale#=v_scale#+0.01 <br><br>		; Scale texture <br>		If cycle_tex = 4 Then ScaleTexture brownstone_tex,u_scale#,v_scale# <br><br><br><br><br><br>;If KeyHit(78)=True Then <br><br>; Change marker position values depending on cursor key pressed<br>If KeyDown(205)=True Then marker_x=marker_x+1<br>If KeyDown(203)=True Then marker_x=marker_x-1<br>If KeyDown(208)=True Then marker_z=marker_z-1<br>If KeyDown(200)=True Then marker_z=marker_z+1<br><br>If KeyHit(2) Then <br>camangle = camangle + 1 <br>End If<br>If camangle =&gt; 6 Then camangle = 1<br> <br>		<br> <br>updatePosition(camera) <br>;TurnEntity camera,0,0,cam_turn_speed<br>;if key hit spacebar then remember current marker position for manipulation<br>;call it marked point m_point<br>	<br>If KeyHit(57)=True Then <br>	<br><br>	;markpoint<br>	<br>;startpoint<br>Gosub startData<br>Read somthing$ <br>tracknum#=0+1<br><br><br>;Restore startData <br> <br>EndIf<br> <br>	<br><br>;different efects<br>;different efects ;random terrain<br>If KeyHit(59) Then<br>Mode = 1<br>;get 3 random variables from a function<br>marker_Vars()<br>terra_detail=4000 <br><br>End If<br><br>If KeyHit(60)= True  Then enable=1-enable <br><br>; Enable/disable wireframe rendering <br>WireFrame enable <br><br><br> <br><br>If Mode = 3  Then<br><br>PositionEntity MarkerCube,EntityX(marker)-1.1,EntityY(marker)+1,EntityZ(marker)-.6<br>EndIf<br><br><br>; Get terrain height at marker position<br>marker_y#=TerrainHeight(terra,marker_x,marker_z)<br><br>; If A pressed then increase marker_y value and modify terrain<br>If KeyDown(30)=True<br>	If marker_y#&lt;1 Then marker_y#=marker_y#+0.005<br>		If Mode = 0 Then<br>			ModifyTerrain terra,marker_x,marker_z,marker_y#<br>		EndIf<br><br>EndIf<br>If KeyHit(59)=True Then<br> Mode = 1<br>EndIf<br>If KeyHit(60) = True Then<br> Mode = 2<br>EndIf<br>If KeyHit(61) = True Then <br> Mode = 3<br>EndIf <br>If KeyHit(62)=True Then<br> Mode = 4<br>EndIf<br>If KeyHit(63)=True Then<br> Mode = 5<br>EndIf<br>If Mode = 1 Then <br>; Position marker, taking into account x, y and z scales of terrain<br>PositionEntity marker,marker_x*x_scale,marker_y#*y_scale,marker_z*z_scale<br><br>End If<br><br><br><br>If Mode = 3 Then<br>	ModifyTerrain terra,marker_x,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x-1,marker_z-1,marker_y#<br>	ModifyTerrain terra,marker_x-1,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x,marker_z-1,marker_y#<br>EndIf<br>	<br>If Mode = 4 Then<br>	ModifyTerrain terra,marker_x,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x+1,marker_z+1,marker_y#<br>	ModifyTerrain terra,marker_x+1,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x,marker_z+1,marker_y#<br>EndIf<br><br>If Mode = 5 Then<br>	ModifyTerrain terra,marker_x,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x-1,marker_z-1,marker_y#<br>	ModifyTerrain terra,marker_x-1,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x,marker_z-1,marker_y#<br><br>	ModifyTerrain terra,marker_x,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x+1,marker_z+1,marker_y#<br>	ModifyTerrain terra,marker_x+1,marker_z,marker_y#<br>	ModifyTerrain terra,marker_x,marker_z+1,marker_y#<br><br><br><br><br><br><br><br><br><br>EndIf<br><br><br><br><br><br><br><br><br>; If Z pressed then decrease marker_y value and modify terrain<br>If KeyDown(44)=True<br>If marker_y#&gt;0 Then marker_y#=marker_y#-0.005<br>ModifyTerrain terra,marker_x,marker_z,marker_y#<br>EndIf<br><br>; Position marker, taking into account x, y and z scales of terrain<br>PositionEntity marker,marker_x*x_scale,marker_y#*y_scale,marker_z*z_scale<br><br><br>RenderWorld<br>Color 150,150,200<br>Text 0,0,"Use cursor keys to move marker over the terrain"<br>Text 0,20,"Press A or Z to alter height of terrain at marker's position"<br>Text 0,40,"Terrain Height: "+ marker_y<br>Text 0,60,somthing$ + marker_y<br>Text 0,70,(varX) <br>Text 0,90,"Drawing_Mode :"+ Mode<br>Text 0,100,"cycle_tex" + cycle_tex<br>Text 400,0,"camangle ;" + camangle<br>Text 400,70,"leavelight" + leavelight<br>Text 0,120,"marker xyz: x: " +EntityX(marker)+" y: "+ EntityY(marker)+" z: "+EntityZ(marker)<br>Text 0,140,"MarkerCube xyz: x: " +EntityX(MarkerCube)+" y: "+ EntityY(MarkerCube)+" z: "+EntityZ(MarkerCube)<br><br><br>Flip<br><br>Wend<br><br>End<br>.startData<br>	Data 1 + "Tips? Press spacebare to see a small set of instructions."<br>	Data 2 + "keypresses; f1-f5 are drawing modes. + = changetexture "<br>	Data 3 + "- = change lightconeangle,shift = change camera angle"<br>	Data 4 + "f = toggle free light mode, esc = exit,1 on numberpad = changelightcolor"<br>	Data 5 + "control c= toggle freeflight mode or drawing mode." <br>	Data 6 + "It just takes 1 tool to rule! F9 to save"<br>	Data 7 + " for now on data statments shoud be numberd"<br>	Data 8 + " need to figure out how to save a terrain made with this program"<br>	Data 9 + "marker placed"<br>	<br>Function updatePosition(camera) <br><br> <br>If camangle=1 Then <br>PositionEntity camera,EntityX(marker),60,EntityZ(marker)-60<br>If camangle=1 Then PointEntity camera,marker<br> <br>EndIf <br>If camangle = 2 Then <br>PositionEntity camera,EntityX(marker),120,EntityZ(marker) <br>If camangle=2 Then PointEntity camera,marker<br><br>End If<br>If camangle = 3 Then<br>PositionEntity camera,EntityX(marker),80,EntityZ(marker)+30<br>If camangle=3 Then PointEntity camera,marker<br> <br>End If<br>If camangle = 4 Then<br>PositionEntity camera,EntityX(marker)-30,80,EntityZ(marker)<br>If camangle=4 Then PointEntity camera,marker<br> <br>End If<br>If camangle = 5 Then<br>cam_speed = cam_speed + 1<br> <br>	PositionEntity camera,EntityX(marker),80,EntityZ(marker) + cam_speed<br> ;RotateEntity camera,0,-180,0<br><br>;PointEntity camera,marker<br>	 <br> <br><br>End If<br> <br>End Function<br><br>Function marker_Vars()<br><br>	varX=Rnd(1,20)<br>	varY=Rnd(1,3)<br>	varZ=Rnd(1,20)<br>	; Here we itterate through all the cells on the terrain grid (switch wireframe on to<br>	; see them) and then make them simply bounce up and down.<br>	<br>	;For z = 0 To terra_size -1 <br>		;For x = 0 To terra_size-1<br>			;hite# = Sin(TerraY(z,x))<br>			;ModifyTerrain terra,x,z,Abs(hite#/2)+.5,False<br>			;TerraY(z,x) = TerraY(z,x) + 1<br>		;Next<br>	;Next<br><br>	<br>;ModifyTerrain terra,marker_x+varX,marker_z+varY,marker_y#+varZ<br>	<br>End Function<br><br>;Function makebox()<br>;Mode = 3<br>;PositionEntity MarkerCube,EntityX(marker)+15,EntityY(marker),EntityZ(marker)+15<br>;End Function <br><br></td></tr></table><br>
<a name="347616"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neo Genesis10</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are saving terrain files, it is best you save them as an image file of TerrainSize by TerrainSize. Each pixel is then calculated to be of the same brightness as the height. An example would be a height of 126, so you would plot color 126, 126, 126 at the same coordinates. You cannot use WriteBB3D on terrains - they are NOT true meshes!<br><br>Anyway, if you read the code archives correctly, you'd notice there was a function called "WriteBB3D(Filename, mesh)". Make sure you include the "b3dfile.bb" file in your source (used for b3dWriteFloat et al) and call WriteBB3D whenever you need to save the mesh.<br><br>Oh, and one other thing - The file it saves is a B3D file, so no special loader is needed to reload it into Blitz. All you need do is use LoadMesh( filename ).<br><br>Some untested source code for you...<pre class=code>Function SaveTerrain( terra, filename$ )

	If terra = 0 Return False

	sze = TerrainSize(terra)	; width of terrain
	img = CreateImage(sze, sze)	; Create image used for heightmap

	buff = GraphicsBuffer()
	SetBuffer ImageBuffer(img)

	For x = 0 To (sze - 1)
		For y = 0 To (sze - 1)
			
			hgt = Floor(TerrainHeight#(terra, x, y))
			Color hgt, hgt, hgt
			Plot x, y
		Next
	Next

	SetBuffer buff

	SaveBuffer ImageBuffer(img), filename$

	Return True

End Function</pre> <br><br></td></tr></table><br>
<a name="347932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiverRatt</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> So if a terrain is not a mesh, what is it?<br>I have put your code in but I can't see it doing anything.<br>I am not getting any error messages, thats good. <br>Is this code to be used with "WriteBB3D(Filename, mesh)" and "b3dfile.bb"? Do I have to change any code in "WriteBB3D(Filename, mesh)" and "b3dfile.bb"? Are you saying that I can only use WriteBB3D if I turn the terrain into a hightmap and save that and blitz will know how to rebuild it by calling  LoadMesh( filename )? So its saved as an image but translate int a mesh with these functions? <br><br></td></tr></table><br>
<a name="349674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;&gt;Are you saying that I can only use WriteBB3D if I turn the terrain into a hightmap and save that and blitz will know how to rebuild it by calling LoadMesh( filename )? So its saved as an image but translate int a mesh with these functions? &lt;&lt;<br>No. you could only use writeBB3D if you turn the terrain into a mesh. Then you could use LoadMesh() to load it later.<br>If you save it as an Image, you will need to use LoadTerrain later. It is true,Blitz is converting this Image to SOME KIND OF mesh, but it cannot be accessed as a Mesh, instead there is a seperate Command Family for Terrains, check out the command reference &gt; Help.<br><br>It isn't that easy to convert a terain to a mesh. personally I wouldn't do this. Imagine a Terrain is made of a heightmap. A heightmap is a BMP with bright and dark zones. the brighter a zone is, the higher will th terrain be at that position. Each pixel of a heightmap is representing one Location on the terrain.<br><br>Neos Example is making such a heightmap out of a Terrain and save it as a BMP. Let's assume your Terrain Handle is "terrain", then you can<br><br>SaveTerrain( terrain, "myheightmap.bmp" )<br>...<br>terrain2=loadterrain("myheightmap.bmp")<br><br>Neos Function is useful when you have created the terrain inside Blitz, using the commands CreateTerrain and so on.<br><br>It is not very useful if you just loaded the Terrain using LoadTerrain because then you already got that BMP on your harddrive anyway.<br><br>The WriteBB3D Example mentioned earlier is useful for real Meshes made with CreateCube, CreateSphere, CreateMesh etc. It can also be used to load a .3DS or .X File and save it as .B3D<br><br>Terrains are not real Meshes. Sprites aren't real Meshes too, as well as MD2 Animations. They don't work with the Mesh Command Family (Addmesh, Rotatemesh, Scalemesh, Loadmesh aso.).<br><br>Most of these Families DO work with the Entity Command Set, PositionEntity, TurnEntity and so on. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
