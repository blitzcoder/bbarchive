<!DOCTYPE html><html lang="en" ><head ><title >TCP Chat client</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TCP Chat client</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >TCP Chat client</a><br><br>
<a name="351472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrmango</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I created a small client to allow TCP chat.. mainly to play with the idea of chating duting games.<br><br>Whilst it is quite a nasty through together code wise. This is my first attempt at anything in Blitz since my days of Stos.<br><br>The problems I have is that the client seems to crash when I click away from the window and also if you run the client on seperate machines and not loopback, then it seems unstable.<br><br>I know its nasty, but where am I going wrong?<br><br>Code===<br><br>;<br>AppTitle "Msg Client V 0.1 - Type exit on cmd Line To quit"<br><br>;-----------&gt;&gt;set main global variables&lt;&lt;----------<br><br>	;client variables<br><br>Global sendpinger$<br>Global timer<br>Global username$<br>Global otherip$<br>Global startsession$<br>Global msgsend$<br>Global msgreceive$<br><br>	;server variables<br><br>Global connectclient$<br>Global connecturl1$<br>Global inputentry$<br>Global timergap$<br>Global entryfield$<br><br>	;misc variables<br>	<br>Global linenumber<br><br>;-----------&gt;&gt;init and set the pinger/server&lt;&lt;-----------<br><br>Graphics 640,260,16,2<br>linenumber=10<br>connecturl1$=CreateTCPServer(8080)<br><br><br>username$=Input$("Username: ")<br>otherip$=Input$("IP: ")<br><br><br>sendpinger$=OpenTCPStream(otherip$,8080)<br>Cls<br>.startagain<br><br>;If linenumber =230 Then <br>;linenumber=10<br>;Cls<br>;EndIf<br><br><br>Locate 0,240<br>msgsend$=Input$("&gt;: "):msgsent=1<br>Cls<br>If msgsend$="exit" Then End<br><br>If msgsent=1<br>WriteString sendpinger$,"Message: "+msgsend$+" from "+username$<br>Chr$(10)<br>msgsent=0<br>EndIf<br><br>;CloseTCPStream = sendpinger$<br><br>sendpinger$=OpenTCPStream(otherip$,8080)<br><br>connectclient$=AcceptTCPStream(connecturl1$)<br>	If connectclient$ Then<br>	inputentry$=ReadString$ (connectclient$)<br>	<br>	Locate 0, linenumber<br>	Print inputentry$+" "+CurrentDate()+" "+CurrentTime$()<br>;	linenumber=linenumber+10<br>	EndIf<br><br>Goto startagain <br><br></td></tr></table><br>
<a name="351485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'm making a chat program, maybe someday it will be better than AIM (dream on :) ) and i found out a lot of stuff while making it.<br><br>First, it's good to have a central server, you just send the ID of the person your message is for, and then the message, and the server handles getting it there. That way you only have to worry about 1 ip address, since they change often and are hard to find.<br><br>Also, textareas are better for displaying and text, or conversation in my case, because they have built in scrolling. Canvases are difficult to scroll, and there is a lib by nullmind that makes textareas uneditable.<br><br>Some problems i see are:<br>- you make a new stream every time. Not a good idea. Keep the same one until program is done executing.<br>- some bad code, typos, etc. i dont know if thats just while posting. I dont know why you have ';' in front of some commands.<br><br>Try telling exactly what goes wrong, ie. error messages, debuging messages, etc.<br><br>I can show you some of my code if you want, just ask.<br><br>Hope it helps! <br><br></td></tr></table><br>
<a name="351537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Welcome to the forum :)<br><br>Don't store your handles as strings, use integers.<br>Using port 8080 you are likely to collide with some browser stream.<br><br>Looks a lot like my first attemp at using TCP streams. If want to see a regular example then download my 5InARow, or look at one of the many examples in the archive. <br><br></td></tr></table><br>
<a name="351675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrmango</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Firstly thanks all for replying :-))<br><br>I will see if I can get a better error msg.. sorry.<br><br>I was trying to avoid a server. I had built it originally that way, but just wanted to be able to have one .exe. Though I think you are right. I may pull out the server code ;-)<br><br>textareas? Are these Blitz Plus commands? If not I will have a play with those. Sounds better than the way I am doing it now.<br><br>I will remove the new stream command. Thought I'd gone wrong there...<br><br>I have some commands with a ; in front, so if what's wrong with the program isn't that particular command, I can just comment it back in. I use it alot whilst learning.<br><br>I have a crack at using integers. ;-)<br><br>I thought the port may conflict. I'll have a look for another.<br><br>Thanks for you help <br><br></td></tr></table><br>
<a name="351871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm afraid textareas can only be found in Blitz Plus. Anyway you won't need two different programs, just let the user choose if want to wait for an incomming stream, or connect to an other ip.<pre class=code>;Make the user choose here
If choice=0 Then
	server=CreateTCPServer(45211);I guess this port is not in use
	While stream=0
		stream=AcceptTCPStream(server)
	Wend
Else
	ip$=Input("Ip: ")
	stream=OpenTCPStream(ip,45211)
End If
;From this point you can use the same code for both computers</pre> <br><br></td></tr></table><br>
<a name="351964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whichever way works for you im sure is good, thats just the way i like to do it. Servers seem easier so that you dont have to deal with multiple ip addresses.<br><br>And yes textareas are blitzplus, which i thought you were using. Guess not.<br><br>For ports, i use 10000, use something up there and it wont conflict with other progs.<br><br>And i c what your doing with the ;'s i just didnt get it.<br><br>good luck with your prog! Unfortunatly you wil be competing with my RichChat! ;) <br><br></td></tr></table><br>
<a name="354638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrmango</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Compete? Ahh well, I am not wanting to develop a full APP as it were. I just wanted to apply my knowledge to a task like a tcp client, so I could test how information gets passed via tcp. Its mainly for my multiplayer game I am planning to do.<br><br>Yeah, I noticed less problems when allocating to higher ports thanks :-)<br><br>Mango <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
