<!DOCTYPE html><html lang="en" ><head ><title >Desktop resolution?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Desktop resolution?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Desktop resolution?</a><br><br>
<a name="236572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Al Mackey</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there an easy way to determine the user's desktop resolution from within a Blitz app?  I'm making a resolution selector for a B3D app, and want to make sure that it can't offer a windowed resolution larger than the screen. <br><br></td></tr></table><br>
<a name="236628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Be more specific.  Do you want to know the max resolution available or the resolution at the time the program is executed?<br><br>You can always set the actual resolution of the screen larger first and then create a windowed resolution that will fit :) <br><br></td></tr></table><br>
<a name="236631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Al Mackey</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just want to know how to find the resolution of the user's desktop is.  That is, the resolution that the screen will be in if I don't make my own fullscreen mode.  It seems to me that this would be really basic and useful info for any kind of program, but there's no mention of it in the BB docs. <br><br></td></tr></table><br>
<a name="236632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> In b+ you can do it. Using clientwidth(desktop()), and clientheight(desktop()). Not in b3d though... <br><br></td></tr></table><br>
<a name="236826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can do it with a userlib<br><br>www.blitzbasic.com/bbs/posts.php?topic=22132 <br><br></td></tr></table><br>
<a name="236904"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Al Mackey</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmmm...  I don't have much experience with userlibs, but they connect Blitz with calls to DLLs, right?  So the "user32.decl" file will call from "user32.dll", I assume.<br><br>Anyway, I made a user32.decl file with that line from the other tread in it, but when I try to start up Blitz now it says "Compiler environment error: Error in userlib 'user32.decls' - function decl without lib irective".  What am I doing wrong? <br><br></td></tr></table><br>
<a name="236976"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oldefoxx</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The DECLS files must be in the UserLibs folder.  That is hardcoded.  Then the DLL file(s) being referenced need to either be located/copied to the same folder, or need to be somewhere where Windows normally would look for it, such as in the \Windows\System32 folder (or \WinNT\System32 folder for WindowsNt/2000/XP).  You can also hardcode the .LIB statement in the DECLS file to point to a specific location where the DLL can be found, such as .LIB "c:\MyDir\MyLib.DLL".  Note that you have the burden of making sure that the Function statements in the DECLS file correspond exactly to the requirements of the routines you are trying to reference in the DLLs, which means some further research on your part to find out what they are.<br><br>As to the error you are getting, I am assuming that the cause is related to something along these lines.  I haven't experienced it myself, and don't intend to if I can help it. <br><br></td></tr></table><br>
<a name="237085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Al Mackey</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahhh, okay.  It works now that I've added a line that says .Lib "user32.dll".  Thanks!! <br><br></td></tr></table><br>
<a name="237086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> [Whoops, it took too long to type this lengthy post... =) I'll leave it anyway...]<br><br>To give an example, here's a very simple decls file:<br><br>"[blitzpath]\userlibs\user32.decls":<br><pre class=code>
.lib "user32.dll"
MessageBox%(hWnd%, mytext$, mycaption$, utype%):"MessageBoxA"
</pre><br><br>...and some .bb code to test it:<br><pre class=code>
MessageBox(0, "Patchwerk is great!", "Hi Al", 0)
</pre><br><br>If you haven't guessed, this is an easy way to interface with the Windows' MessageBox function.  Great for those Blitz3D users without "Notify" (BlitzPlus function).<br><br>In the user32.decls file:<br><pre class=code>.lib "user32.dll"</pre><br>.lib is the directive that needs a parameter of a valid dll in the current path.  It is only used once for each dll.  <br><br>After that come the declarations for the exported functions of the particular dll, i.e.<br><pre class=code>
GetForegroundWindow%():"GetForegroundWindow"
GetWindowText%(hWnd%, lpString$, nMaxCount%):"GetWindowTextA"
MessageBox%(hWnd%, mytext$, mycaption$, utype%):"MessageBoxA"
</pre><br><br>The first name can be anything you want (what you call in Blitz), but the last name (in quotes) has to match the exported DLL function name.<br><br>Some people like to put DLL-specific function declarations into separate files (i.e. one decls file for kernel32 functions, one for user32 functions, one for msvcrt functions, etc) and others like to put them all in one file, sepearated by the appropriate ".lib" directive, i.e.:<br><br>mydecls.decls:<br><pre class=code>
.lib "user32.dll"
&lt;function1&gt;
&lt;function2&gt;
...etc

.lib "NTDLL.dll" 
&lt;function1&gt;
&lt;function2&gt;
...etc
</pre><br><br>A way I've figured out to find native Windows functions to use as userlibs is this:<br>1) Get a list of the exported functions of the DLL (I use dumpbin.exe from MSVC++)<br>2) Look them up in MSDN library<br>3) Then it's easy to match up Blitz types with Windows types for the parameters<br><br>Some userlibs caveats:<br>1) A particular function may not be compatible with all versions of Windows.  Make note from the documentation in MSDN.<br>2) There's not an easy way to debug them, since you're calling an external DLL.  If you crash, it's your fault (usually), but you may not easily know why.<br>3) When a DLL function calls for a pointer to a struct, just pass in bank from CreateBank.  Figure out the needed size in bytes from the documentation.<br>4) If a parameter can be either a pointer OR NULL, it causes a small problem.  To pass NULL, you must declare the parameter as % in the decls file and pass 0 in your call.  Conversely, to pass a pointer, you must declare the parameter as * in the decls file.  This means you either have to decide which one you want when you're writing the decls file, or if you want both, you have to have two different Blitz Function Declarations for the same DLL function.<br>5) An constant (and there are many) that's defined in another include file will not be understood by Blitz (obviously).  This means you have to look up the value in the .h file yourself, or on the web, or in a pickle, guess, and then declare the constant yourself, or just pass the value itself (as I did above in the MessageBox function).<br><br>That's it off the top of my head...  let us know how it works out. <br><br></td></tr></table><br>
<a name="237143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Al Mackey</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, that's exactly the sort of meaty userlib info I've been looking for, Soja!  They should put something like that in the docs somewhere. :&gt; <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
