<!DOCTYPE html><html lang="en" ><head ><title >Regarding variables and stuff</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Regarding variables and stuff</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Regarding variables and stuff</a><br><br>
<a name="249543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JBR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I have a few questions about variables in general.<br><br>1) Is there any speed benefits by using global variables over local ones. I tend to use local ones in functions but this would require the creation and deletion which will slow it down?<br><br>2) I have found that 'Abs' is slower than doing a simple check myself. ( if a%&lt;0 then a%=-a% ). I'm using integer and just wonder if using floating point variables would be faster? I understand an integer &amp; float operation can take place at the same time?<br><br>I'm just trying to speed up inner loop to be as fast as possible so any advice would be appreciated.<br><br>Thanks<br>Marg <br><br></td></tr></table><br>
<a name="249562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robleong</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might be splitting hairs there. A quicker way of speeding up your inner loop would be to get rid of it altogether. Sure the program will be longer and less elegant, but it will be faster! Don't understand question 2 - as far as I'm aware, floating point operations are slower than integer ones. If you don't need to use floating point, don't. Good luck. <br><br></td></tr></table><br>
<a name="249574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Curtastic</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> wow the if is twice as fast a abs().<br>these thing can make a huge defference in the speed of some programs, like ones that do it for every pixel drawn and draw the whole screen every loop.<br><br>ints are faster floats in blitz<br>using globals and locals are the same speed in whether in a function or not in blitz. but allocating locals takes time <br><br></td></tr></table><br>
<a name="249763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's worth noting that variables are Local by default.  Even those outside of any Functions, which are only known by the main program.  If anything needs to be known inside a Function from outide of it, then variables need to be defined as Global at the beginning of your code.<br><br>The only time I use Local is when defining a Blitz array for use within a Function. <br><br></td></tr></table><br>
<a name="250579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anyone ever compiled a list of these speed comparisons..?<br><br>It's good to know about  ABS()  being slower than an explicit comparison.<br><br>How about others like that..?<br><br>For example, I've read in the forums that Functions are marginally slower than Subroutines.<br><br>Might not matter in a game of "Hangman", but it could just possibly make the difference between playable and unplayably slow.<br><br>Has anyone ever done any testing on anything else like that..?<br><br>Would this be a good subject for a new Topic..? <br><br></td></tr></table><br>
<a name="250596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;Has anyone ever compiled a list of these speed <br>&gt;comparisons..?<br><br>That would be rather pointless, since much of it would be dependant on the CPU. <br><br>&gt;For example, I've read in the forums that Functions are <br>&gt;marginally slower than Subroutines. <br><br>True.<br><br>&gt;Might not matter in a game of "Hangman", but it could just <br>&gt;possibly make the difference between playable and <br>&gt;unplayably slow. <br><br>I don't think so... If that were the case, you would need a major overhaul of the logic.<br><br>Andy <br><br></td></tr></table><br>
<a name="250612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suggest before spending lots of time speeding certain program areas up you first write the program.<br><br>Then and only then should you spend time speeding it up IF it requires speeding up at all!<br><br>Optimizing is all very well, just make sure you aren't wasting your time on something that's not going to be a problem anyway. <br><br></td></tr></table><br>
<a name="250626"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;&gt;Has anyone ever compiled a list of these speed <br>&gt;&gt;comparisons..? <br><br>&gt;That would be rather pointless, since much of it would be &gt;dependant on the CPU. <br><br><br>Not at all-  if one function runs twice as fast as another function on a 500Mhz CPU it will STILL run twice as fast on a 2Ghz CPU.<br><br>Coorae reported the ABS() function took twice as long as an explicit comparison.   If your program required many such tests, you'd be far better off using the faster method, regardless of what speed the CPU might be.<br><br>Too many programs assume the user is going to have the baddest CPU on the block, making optimization unnecessary.  But that's a BAD assumption to make, and limits your eventual market for the final program.<br><br>&gt;&gt;For example, I've read in the forums that Functions are <br>&gt;&gt;marginally slower than Subroutines. <br><br>&gt;True. <br><br><br>Well, then if you have a time-critical program, why not use the method that's going to run faster..?<br><br>The original question in this thread was asking about speeding up a time-critical loop.  If it needed to call several funtions, then maybe the increased speed of calling them as subroutines instead would make the difference.<br><br><br>&gt;&gt;Might not matter in a game of "Hangman", but it could just <br>&gt;&gt;possibly make the difference between playable and <br>&gt;&gt;unplayably slow. <br><br>&gt;I don't think so... If that were the case, you would need &gt;a major overhaul of the logic. <br><br><br>Which is why it would be nice to have a compilation of speed comparisons   BEFORE   you code the logic.<br><br>If you knew, for example, that  ABS()  was slower than an IF/THEN comparison, you could code for that in the first place.  No "overhauls" needed.<br><br><br>It's just that you hear every now and then about some function or statement being faster than some other one, but as far as I've ever seen there is no "central" resource that lists all of these.<br><br>I for one would like to know the most advantageous approach before I end up HAVING to waste time overhauling the code. <br><br></td></tr></table><br>
<a name="250653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;Not at all- if one function runs twice as fast as another <br>&gt;function on a 500Mhz CPU it will STILL run twice as fast <br>&gt;on a 2Ghz CPU. <br><br>That is certainly not the case... Core version/CPU speed/FSB speed/cache and even brand has a great influence on the results. The results on a 2GHz P4 is quite different from those of a 2GHz Athlon... And how about the P3 1.4GHz which will compete against the 2GHz P4 in some tests and won't in other tests and then there is the VIA C3... And what about drivers...<br><br>Andy <br><br></td></tr></table><br>
<a name="250692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry... you're still comparing apples and oranges.<br><br>You're confusing hardware speed with software execution speed.<br><br>If function "A" takes 8ms to execute on a 500Mhz CPU, and<br>function "B" takes 16ms to execute on a 500Mhz CPU, then<br><br>Function A will run 2x as fast as Function B, no matter what speed CPU they're running on.<br><br><br>The ACTUAL speeds will vary depending on the CPU, but<br>The RELATIVE execution speeds will be the same.<br><br><br>So...  running on a 2Ghz CPU, Function A will take approximately  2ms to complete and Function B will take approximately 4ms to complete.<br><br>They run faster because the CPU is 4x faster, but Function A still is 2x as fast as Function B.<br><br><br>Any hardware differences between CPU brands or core technology only affects the overall processing speed of the hardware.<br><br><br>The relative speed differences between the software functions would remain constant.<br><br><br>So-  if  IF/THEN  is twice as fast as  ABS()  on one computer, it will be twice as fast as ABS() on ANY computer.<br><br><br>The point is,  BOTH  methods will achieve the same result.<br><br>Why not use the method that's faster..? <br><br></td></tr></table><br>
<a name="250702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> only thing is, that this will not make the loop twice as fast, but it would be interesting to see a comparison. i believe most of the time consumed is to do with texturing and displaying polys. tho, i could be wrong, have been in the past :S <br><br></td></tr></table><br>
<a name="250748"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;If function "A" takes 8ms to execute on a 500Mhz CPU, and <br>&gt;function "B" takes 16ms to execute on a 500Mhz CPU, then <br>&gt;<br>&gt;Function A will run 2x as fast as Function B, no matter <br>&gt;what speed CPU they're running on. <br><br>No they won't... You are arguing that all parts of the CPU(ALU; FPU, BPU etc)are equally fast on different CPUs, regardless of the core, the number of stages, the number of units, cache size and speed and busspeed... <br><br>Andy <br><br></td></tr></table><br>
<a name="250780"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Get a load of this optimization:<br>A ONE pixel wide RECTangle (basically a line) will draw 70% faster than an orthogonal LINE the same length even though the rectangle is actually drawing 4 lines.<br>Note that RECT's can't draw angled lines but if you were going to draw a straight up/down or left/right line anyways, why not draw a rectangle? <br><br></td></tr></table><br>
<a name="250792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> WolRon:<br>Very interesting.  You would think that they would code special cases into LINE so that it would be optimized for straight lines, but on second thought, perhaps that was left out becuase on the average, it would take longer to make the "is this line straight?" check.  And on the contrary, it's taken for granted that a RECT always consists of straight lines.  (And perhaps there's an optimization in RECT that detects 1-pixel-wide rectangles and only draws one side.)  That's what I'm guessing, anyway. <br><br></td></tr></table><br>
<a name="250795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool..!<br><br>That's the kind of thing I'm interested in finding out, and perhaps compiling into a list of comparative features like that.<br><br>If a game requires a lot of orthagonal lines, the time savings by actually using RECTs might be considerable.<br><br>Many of the differences are pretty intuitive-  for example, ImagesOverlap() is faster than ImagesCollide() because it's obvious the first doesn't compare ALL the pixels in the images.<br><br>So if you don't need perfect collision checking you can use the faster function.<br><br>But using a RECT instead of a LINE for speed is something nobody is ever going to think to do-  unless they can read about it somewhere... like a list of speed comparisons.<br><br><br>Andy-  I'm sorry you're not understanding what I'm saying.   None of what you said has any bearing on whether or not one function runs faster than another function on ANY computer. <br><br></td></tr></table><br>
<a name="250797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Andy- I'm sorry you're not understanding what I'm saying. None of what you said has any bearing on whether or not one function runs faster than another function on ANY computer.  <br></div><br>Allow me to interject.  I think Andy understands exactly what you're saying.  Ok, one function may indeed run faster than another function.  Yes.  His point is that the difference between the two execution speeds is not a 1:1 ratio as CPU frequencies differ.  You do have to take into account how the CPU works.  Remember that Hz (MHz, GHz) is not a measurement of speed, though many treat it as such.<br><br>I do not understand what you say here:<br><div class="quote"> <br>Any hardware differences between CPU brands or core technology only affects the overall processing speed of the hardware. <br><br>The relative speed differences between the software functions would remain constant. <br> <br></div><br>There's no such thing as a "software" function, really.  Software runs on hardware, and it is calculated by SOME processor somewhere.  In this case, either the GPU or CPU.  So what he said seems to apply.  The only place where I see that something "runs in software" is where a differentiation is being made for graphics functions being computed by the CPU ("software") as opposed to the GPU ("hardware-accelerated"). <br><br></td></tr></table><br>
<a name="250801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But using a RECT instead of a LINE for speed is something nobody is ever going to think to do- unless they can read about it somewhere... like a list of speed comparisons <br></div><br>Umm..., I did. <br><br></td></tr></table><br>
<a name="250802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Posted by Andy:<br>&gt;Has anyone ever compiled a list of these speed <br>&gt;comparisons..? <br><br>That would be rather pointless, since much of it would be dependant on the CPU. <br></div><br>So, basically my RECT for LINE optimization is hardware dependent?<br><br>Yeah right. <br><br></td></tr></table><br>
<a name="250808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, first- anything external to the CPU will have NO effect on the relative execution speed of two software functions like  ABS()  and  IF/THEN comparisons.<br><br><br>There MAY be a slight effect on processing speed if a specific CPU core implements the way it processes a certain operation differently than some other CPU.  Not likely, and any effect would be small relative to the overall difference in speeds between two software functions.<br><br>For example, if the Athlon Thorobred core processes bitwise comparisons more efficiently than a PIII/Celeron, then MAYBE the relative speed between  ABS()  and  IF/THEN  MIGHT be affected.    Slightly.  Not likely.<br><br><br>If Blitz Basic could run on an 80286 CPU at 10Mhz, it would run very slowly- <br><br>But-   ABS()  would  STILL  run more slowly than  IF/THEN.<br><br><br><br>&gt;There's no such thing as a "software" function, really.<br><br><br>Umm.. not sure how to respond to that.<br><br><br>Hardware by itself can't do anything.  With the exception of micro-coded low-level activity, hardware is "brain dead" without software instructions to tell it what to do.<br><br><br>What I'm trying to say here is that the same string of software commands (a software "function") will execute approximately the same no matter what CPU you run it on.<br><br>A faster CPU will execute them more quickly, but the operations will be pretty much the same.<br><br>(We're assuming the CPUs are compatible here.  We're not comparing Apples and IBMs for example.)<br><br><br>So two software functions will run at approximately the same relative ratio on one CPU as they do on any different CPU.<br><br>The actual execution speeds may vary, but the relative ratio of the execution time will remain constant.<br><br><br>If  ABS() runs slower than  IF/THEN  on one CPU, it will run slower on  ANY  CPU.<br><br><br>Thus, if I was writing a game that I wanted to sell to the largest possible market, I would use  IF/THEN  instead of  ABS().  That would help guarantee it would run at the best possible speed on   ANY  computer.<br><br>I would also use Subroutines instead of Functions and ImagesOverlap instead of ImagesCollide (as much as possible), along with any other similar speed comparison "tricks" we can come up with like RECTs instead of orthagonal LINEs.<br><br>The point is not that ONE such "trick" would make much of a differnce, but that ALL the "tricks" we can find  MIGHT  make enough of a difference to matter. <br><br></td></tr></table><br>
<a name="250811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> WolRon - you mean you just tried RECT instead of using LINE one day..?<br><br>That's pretty good..!  I know I never would have thought of trying that.<br><br>That's the kind of thing I think we need to compile into a reference on speed comparisons of different ways of accomplishing the same things.<br><br>As people discover stuff like this, it would be good to keep it all together so we don't all have to keep re-inventing the wheel. <br><br></td></tr></table><br>
<a name="250812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;Andy- I'm sorry you're not understanding what I'm saying. <br>&gt;None of what you said has any bearing on whether or not <br>&gt;one function runs faster than another function on ANY <br>&gt;computer.<br><br>I do understand, and from what you have said 3 times, you're wrong. I guarantee you'll look at things differently if you try to use the same harware except for CPU... Use an intel P3 900MHz and a VIA C3 900MHz, and do the calcs.<br><br>soja actually has a point with the graphics being handled by the GPU... I only dealt with the logic and number-crunching done by the CPU previously, but the GPU adds more variables.  <br><br>&gt;So, basically my RECT for LINE optimization is hardware <br>&gt;dependent?<br>&gt;Yeah right. <br><br>What did you expect it to be dependant on? Voodoo? Black Magick? Witchcraft? Government spending? Astrology?<br><br>Yes, the speed of the individual commands in B3D can vary and their speed in relation to other commands certainly vary across different hardware.<br><br>Andy <br><br></td></tr></table><br>
<a name="250820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;Yes, the speed of the individual commands in B3D can vary &gt;and their speed in relation to other commands certainly &gt;vary across different hardware. <br><br><br>Not the things we were talking about earlier.<br><br>A P3 vs VIA C3  would make  NO  discernable difference to the ratio between execution times of two internal Blitz functions.<br><br>GPU, FSB, Cache, drivers, none of that external stuff has ANY bearing on the execution speed ratio between two functions like we're discussing here.<br><br><br>Things that draw to the screen probably WOULD be affected by the video card's hardware, so possibly a video card that can handle primitives like lines and rectangles MIGHT have an effect on the speed of those particular commands.<br><br><br>But for the kinds of things that started this thread, Blitz commands that run entirely inside the CPU, there should be no effect on the relative efficiency of the commands on different CPUs.<br><br><br>Perhaps you can explain how a video card or driver can affect how fast  ABS()  runs..? <br><br></td></tr></table><br>
<a name="250870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Umm..., I did. <br></div>I did that too (using rect instead of line)! It was in an attempt at a Pole Position style racing game. I had to draw the road horizontal line by horizontal line (decreasing the length of the line as it got closer to the horizon to get the 3D effect). First I used lines. Then I switched to rects. Apart from the better performance I did this because now I could choose a different "resolution" (for even more speed): suppose I use rects of height 2, that means I have to draw only half the number of rects! The road side gets chunkier but who cares, it's the speed that counts. Anyway I gave up when objects started to float into the air due to a mistake somewhere in my pseudo-3D code. ;) <br><br></td></tr></table><br>
<a name="250914"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Bob,<br><br>Call me confused.  It sounds to me as if you're saying there are calculations ("software functions") which do not rely on any processing unit (like the CPU) to be computed.  (?!) <br><br>All software, inlcuding the OS, must run on hardware.  All functions (even the simplest, including ABS) must be computed by some processor (usually the CPU).  So tell me why or how any function's computation wouldn't rely on the hardware that was computing it...?<br><br>One point of interesting comparison are the Athlons and Pentiums of the last couple years or so.  In general, the Athlon has had a much lower comparable clock speed and yet it is able to perform at approximately the same level as a Pentium with a much higher frequency (e.g. 1533 MHz Athlon vs. 2000 MHz Pentium).  This alone should reveal that there are many other factors besides clock speed which affect the whole processing performance of a CPU.  For those interested, there are some nice CPU Pipeline tutorials found on Google (search for "CPU Pipeline").<br><br>WolRon:<br>It's pretty creative to imagine that Rect might work faster than Line for certain cases.  It's counter-intuitive at first, but begins to make sense after some thought.  It makes one want to think creatively about other functions too.  Cool. <br><br></td></tr></table><br>
<a name="251035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK-  I'm going to make up some numbers to illustrate what I've been saying.  Don't take them as anything but illustrations.  I haven't had a chance to code up any "benchmarks" to do actual timing, but this should help explain things:<br><br><br>Suppose you were to write a loop that takes a Random number and does nothing but do  ABS(number)  on it.   Run the loop 10,000 times and time how long it takes to run.<br><br><br>Then write a loop that takes a Random number and does<br><br>IF number &lt;0  THEN number = -number ; (Does the same thing as ABS() does)<br><br>and run it 10,000 times, timing how long THAT takes to run.<br><br><br>When you run the loops, you'll find out how long it takes to run  ABS()  10,000 times,  compared to running the  IF/THEN  line  10,000 times,   on WHATEVER computer you're running them on.<br><br>The loop that takes less time to run will show which method of finding the Absolute Value of a number is faster.<br><br><br>Now take the program to a different computer.  One with a far different CPU, a different video card, different RAM, completely different.   (Still IBM compatible though.)<br><br><br>Now run the loops again.  The time it takes to run 10,000  ABS() on the new computer  WILL  be different.<br><br><br>This is what you've been saying.   A different computer WILL run the code faster or slower than the first one.  No problem.<br><br><br>But-   what I've been saying is that the second computer will run the  OTHER  loop,  the  IF/THEN  loop  at a different speed too...   but they will BOTH be in the SAME RELATIONSHIP  as they were on the first computer.<br><br><br>Let me make up some numbers to illustrate this:<br><br>Suppose the first computer was a PIII  with a so-so video card and 256MB of RAM.  Nothing special.<br><br><br>Loop 1  (the ABS function) takes  8  seconds to run 10,000 times.<br>Loop 2  (the IF/THEN statemsnt) takes  4  seconds to run 10,000 times.<br><br><br>So the first loop takes twice as long as the second loop.<br><br>(That means that doing an  IF/THEN  test is twice as fast as doing an  ABS()  to get the Absolute Value of a number. Both get exactly the same results, but one method is faster.)<br><br><br>Now go to your friend's "super bleeding edge" game computer.  An Athlon 2800XP+ with a top-end Radeon video card, a Gig of RAM and a 333Mhz FSB.   Run both loops on that computer.<br><br><br>Loop 1 takes  3  seconds to run on this computer.<br>Loop 2 takes  1.5  seconds  to run on this computer.<br><br><br>You see,  you're right-  the other computer runs the loops faster.<br><br><br>But notice that Loop 1 is   STILL  TWICE   as fast as loop 2.<br><br><br>Now take the two loops to your grandmother's house and run them on her old P150 computer that she uses to send e-mail with.   No special video card and 32MB of RAM.  Pretty pathetic.<br><br><br>Loop 1 takes  20  seconds to run on this computer.<br>Loop 2 takes  10  seconds to run on this computer.<br><br><br>Again, you're right-  the slower computer runs the loops slower.<br><br>But again-  notice that Loop 1 is   STILL  TWICE   as fast as loop 2.<br><br><br>This is what I've been trying to say all along.  YES, different hardware runs code at different speeds.  YES, the hardware makes a difference how fast code will run.<br><br><br>BUT-  code which runs slower than other code on one machine will STILL  run slower than that other code on a different machine if it runs without using any external devices.<br><br>Even though BOTH  sets of code run faster than when they were on the other computer.<br><br>The KIND of hardware won't change that.<br><br>Loop 1 will  ALWAYS  be faster than  Loop 2  no matter WHAT hardware you run them both on.<br><br><br>The whole point of this whole thing is that if we can find out more of these speed comparisons between equivalent code, then we could use the faster code to make programs run faster on  ANY  computer than they would with the other (slower) code.<br><br><br><br>To answer your question:<br><br>The code that does both the ABS() and the IF/THEN runs in the CPU chip of the computer.<br><br>These are probably good choices of code to use for this discussion because NOTHING ELSE will affect how fast they run on any particular computer.<br><br><br>The machine code that perfoms the  ABS()  runs entirely inside the CPU.  It doesn't use the video card and it doesn't need to use external RAM or the FrontSide Bus.  Nothing outside the CPU will affect how fast it completes its task.<br><br><br>The only real factors affecting it are the speed of the CPU and the efficiency of the coding. (That's up to Mark Sibly in the case of Blitz Basic.)<br><br><br>So when you execute  ABS()  and then the  IF/THEN  statement, the speed of the CPU chip will be the same (since you're running them both on the same machine), and it won't affect the difference between the two methods of taking the Absolute Value of a number.<br><br>The ONLY difference between how fast they run will be the efficiency of the code Mark Sibly wrote.<br><br><br>THAT'S what we're actually trying to get to here-  what functions or commands are coded "better" than other equivalent functions or commande.<br><br><br><br>Now-  the  LINE  versus  RECT  issue is different.<br><br><br>In that case more of what Andy has said comes into play.<br><br>The CPU will have to do calculations on where the points are located, but it will have to involve the video card into actually displaying the line or rectangle.<br><br><br>IF   the video card can draw rectangles or lines by itself, then all the CPU has to do is tell it where the starting and ending points are, and the video card hardware will do the rest.<br><br>This is very fast and lets the CPU go on and calculate other things while the video card is drawing and displaying the lines and rectangles.<br><br><br>BUT-  if the video card can't draw the lines and rectangles by itself (older video cards didn't have as much functionality as newer video cards do these days),  then the CPU  will have to calculate  EVERY  point on the line or rectangle and send it to the video card, pixel by pixel.<br><br>All the video card would do in this case would be to display the pixels on the screen after the CPU has told it where they need to be to form a picture of a line or rectangle.<br><br><br>So in this case, Andy is right-  the different hardware may treat  LINE  and  RECT  differently,  so maybe one video card would draw lines faster, and another might draw rectangles faster, and we wouldn't be able to know which one to use to make our programs run faster on whatever video card the user owns.<br><br><br>The only way to tell for sure is to actually run tests like I talked about back at the top of this, on a lot of different computers and list the results for people to read and try on their own computers.<br><br><br>And maybe Shambler is right-  maybe it would turn out that the differences between equivalent methods of doing the same things isn't enough to bother worrying about them. <br><br>But it would be nice to know for certain. <br><br></td></tr></table><br>
<a name="251044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BobR</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh-  before anyone says anything...   none of this is intended to be critical of Mark, or his programming of Blitz Basic.<br><br>EVERY computer language has things like this, and programmers have always taken advantage of them to make their programs just a little bit faster or better or whatever.<br><br>It's called "Undocumented Features" and it's sort of "beyond the fringe".<br><br><br>One other thing-<br><br>Using "features" like this can be dangerous too.<br><br>There's no guarantee that a "trick" like using IF/THEN instead of ABS() will be faster in the NEXT version of Blitz.<br><br>Mark might make a change which doesn't affect the functionality of the language, but DOES make ABS() every bit as fast, or even faster than any alternatives.<br><br>If that happened, a program which relied on this particular "Undocumented Feature" would end up actually being SLOWER than it could have been.<br><br>So you have to be careful about what "tricks" you use... <br><br></td></tr></table><br>
<a name="251052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It's good to know about ABS() being slower than an explicit comparison. <br></div>Yep. Except it isn't. It depends on what kind of numbers you have, and what CPU you have. Andy is correct.<br><br>Consider the following: Your ABS() statement is being compiled into one, maybe two calls to the ALU/FPU. The IF statement is compiled to at least five instuctions, probably more. Now the thing is the conditional branch (IF) will only effect some of the numbers, namely the negative ones, so depending on your numbers this will result in executing a fast compare (that will normally fail). Let's say for arguments sake, that the cost is 100 clock cycles for the low cost IF branch, 300 for the high cost IF branch and 200 for the ABS. Obviously executing the low cost IF branch 10K times is going to be faster than ABS, but ABS will still be faster than the high cost IF branch. Now you run the same program on a different CPU, with updated microcode that greatly reduces the cost of ABS() functions so that they only take 50 clock cycles. And the ratio will be all wrong. You cannot assume that on CPU's, even CPU's that are compatible, instructions will execute at the same relative speed.<br><br>Also tests like the "10000 loops" are seriously flawed, and it is prone to memory allignment issues, cache sizes (a small test loop will easily fit into a cache, your main game loop probably won't) and memory hits. Because of the genious  decision to only use 4 CPU registers, Intel and compatible processors must access memory quite frequently. This means that memory speed and bandwidth quickly becomes an issue. While your test loop will probably never have to wait for data (as it doesn't use more variables than can comfortably fit in 4 registers) your main game loop will, and your previous optimization may be canceled by the memory bottleneck. This is also why you should write logic first, and optimize later.<br><div class="quote"> So, basically my RECT for LINE optimization is hardware dependent?  <br></div>Ofcourse it is. Rect uses the hardware accelerated functionality of DirectX, where as Line AFAIK uses an assembly optimized software function. If Line is faster on your machine, then it's because your GPU is more powerful than your CPU. Try it on a laptop or server configuration instead. Ofcourse filling a rectangle will by default be faster, because you can assume block copies, but if you have a particularily bad gfx card, the difference will be negligable.<br><br>And that's really the problem with optimization these days. Unless you're calling a function 1000 times or more a frame, there really isn't much point in optimizing it. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
