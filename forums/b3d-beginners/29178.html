<!DOCTYPE html><html lang="en" ><head ><title >Clipboard</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Clipboard</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Clipboard</a><br><br>
<a name="308304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi all<br><br>is it possible to access the windows clipboard? <br><br></td></tr></table><br>
<a name="308310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Cliff<br><br>try and have a look here : <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=699" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=699</a> <br><br></td></tr></table><br>
<a name="308635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanx mate <br><br></td></tr></table><br>
<a name="309144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Darkuni</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm going to post this to each message that discusses the clipboard and references this code snippet because I've spent HOURS banging my head on why it was causing crashes, and since I have it figured out, I figured I better share it.<br><br>The clipboard requires proper opening and closing, just like any other 'stream' in the Windows world.  The OS does NOT control the 'locking' or 'unlocking' of this stream, so its ENTIRELY possible to have COLLISIONS in requests for the clipboard.<br><br>The OPENCLIPBOARD command used in the sample isn't checked to be SURE that the clipboard was opened correctly.  Because of that, it allows EXAMINECLIPBOARD to execute EVEN THOUGH YOU DON'T HAVE A HANDLE TO IT!<br><br>This will blow up your Blitz program - and the debugger won't help you at all.<br><br>I know what you're thinking .. what are the CHANCES of clipboard collision?  BETTER THAN YOU THINK.  If you're polling it every loop, you WILL eventually collide with another program using the clipboard.<br><br>What sucks is, you don't have to USE the clipboard for a collision to occur.  Seems many programs (like IE) does SOMETHING with the clipboard when you close it.  So, your program is happily polling away ... and you close IE ... and BOOM, your program blows up.<br><br>My first solution was to poll LESS often, say every half a second.  My crash rate went down DRAMATICALLY, but didn't end .. just made it harder to pin down.<br><br>Finally I did some research on the clipboard API and figured out that OPENCLIPBOARD will return a true/false to let you know what the status is on the open command.  From there, of course, you can control whether or not you actually perform another command that will crash the program or not.<br><br>Here is some slightly revised code that compensates for that.<br><br>Once this code was in place, my crashes stopped. :)  GOD I hope I save someone the hours of headache I spent on this.<br><br>Function ReadClipboardText$()<br>Local cb_TEXT=1<br>Local txt$=""<br>If OpenClipboard(0) Then<br>	If ExamineClipboard(cb_TEXT) <br>		txt$=GetClipboardData$(cb_TEXT)<br>	EndIf<br>	CloseClipboard<br>End If<br>Return txt$<br>End Function <br><br></td></tr></table><br>
<a name="309196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm probably going to add clipboard functionality to my printer userlib too so that will be another option.  :) <br><br></td></tr></table><br>
<a name="309218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanx Darkuni it works a treat now :) <br><br></td></tr></table><br>
<a name="309224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for figuring that out, Shane. I was wondering if that could be the case, but I thought to myself, "no, it's not a problem; I'm not using the clipboard anywhere else!"  It's good to know not to take this for granted. <br><br></td></tr></table><br>
<a name="309274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeraBit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Shane. I was just starting to get a headache with this one! <br><br></td></tr></table><br>
<a name="309320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Shane,<br>Thankyou for finding that potential collision problem. I have updated the code snippet.<br>Sorry for causing you all that 'head banging'. I'll send you some headache pills :-/<br><br><a href="/codearcs.php?code=699" target="_blank">Clipboard - Text Copy &amp; Paste *Updated*</a> <br><br></td></tr></table><br>
<a name="312179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Darkuni</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad I could give back!  No asprin required.  You got me started ... I'm just glad I could do it - it GREATLY enhanced my app ... oh, which is public now, BTW ...<br><br><a href="http://www.hostsfileeditor.com" target="_blank">http://www.hostsfileeditor.com</a><br><br>Thanks to everyone. <br><br></td></tr></table><br>
<a name="312498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wiebo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> heh. I use notepad for that. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
