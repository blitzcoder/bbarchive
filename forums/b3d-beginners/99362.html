<!DOCTYPE html><html lang="en" ><head ><title >Loading and saving "Map" files...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Loading and saving "Map" files...</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Loading and saving "Map" files...</a><br><br>
<a name="1165951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok so recently i was told that i should focus more on my editor for my game than pathfinding so i am switching gears to that for awhile  now. I don't mean to just ask a question and expect you guys to "baby me" but I am indeed only posting when I get super lost so please bare with me.<br><br>I am currently trying to find a way that I can create a map by placing a set of entitys in my Map-Editor, and then load them into my "Game". I obviously know i will be writing to and reading from some files haha but other than that i am kinda lost on what to do, am I looking at types in types to transfer everything well? alright, thank you ahead of time for everyone's patience with me. <br><br></td></tr></table><br>
<a name="1165996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> My assumption was that you use your editor to create geometry, then export it to either an .x file, .3ds file, or b3d file, and that anything other than geometry should go into a separate data file that you then read/parse into your b3d program.<br><br>But here's a tip:<br>Don't make your geometry too large or things may seem to vanish on you.<br>See my threads below.<br><br>Some of these folks seem to be 'algorithm huggers' for geometry creation--- Not that there's anything wrong with that, but... <br><br></td></tr></table><br>
<a name="1166004"></a>

<a name="1166164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, it will actually be used to place geometry not create it. I.E. i have a torch that i want to place on a wall and save the wall x,y,z ect. and then the torches x,y,z ect. into a text file so that i can reload into the game.<br>using this text file  (load/save)  so i am coding my own editor and in it i will make it so you place entitys and save them to a text probably using types. any hel? :D<br><br><b>EDIT:</b> oops actually you were right i just skipped over the part about parsing code on accident But so far i am having no luck with this venture..<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166032"></a>

<a name="1166033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> here this may help you understand, i need to be able to place cubes on the grid (LMB) and save all of them to a file to be reloaded in at another time.<br> <br><b> main.bb </b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Type World_objects
 Field x#,y#,z#,mesh
End Type

Global GWidth% = 800  
Global GHeight% = 600  
GColors% = 32
GMode% = 2  
Graphics3D(GWidth,GHeight,GColors,GMode) 
SetBuffer(BackBuffer()) 
HidePointer()  
SeedRnd(MilliSecs())

Include "world.bb"
Include "updates.bb"

 Pre_Editor_Functions()

While Closed = False

Update_Editor()

 Cls()  
 
 CameraUpdate()  
 

 RenderWorld()  

 Color(255,255,255)
 Text(0,0,"Tris : "+TrisRendered())
 
 Flip(True)  
  
Wend

End

</textarea><br><b> world.bb </b><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Global Camera = CreateCamera()  
CameraRange(Camera,0.1,500)
CameraClsColor(Camera,000,000,000)  
Global Closed = False
Global x#
Global y#
Global z#

Origine = CreateCube()  
ScaleMesh(Origine,0.1/2,1000.0,0.1/2)
PositionEntity(Origine,0,0,0) 
EntityColor(Origine,255,000,000)

Global LevelMaxWidth% = 100
Global LevelMaxDepth% = 100

Global DebugGridMesh = CreateMesh()
DebugGridSurface = CreateSurface(DebugGridMesh)
AddVertex(DebugGridSurface, 0.0, 0.0, 0.0, 0.000, 1.000)
AddVertex(DebugGridSurface, 0.0, 0.0, 1.0, 0.000, 0.000)
AddVertex(DebugGridSurface, 1.0, 0.0, 1.0, 1.000, 0.000)
AddVertex(DebugGridSurface, 1.0, 0.0, 0.0, 1.000, 1.000)
AddTriangle(DebugGridSurface,0,1,2)
AddTriangle(DebugGridSurface,0,2,3)
UpdateNormals(DebugGridMesh)
ScaleEntity(DebugGridMesh,LevelMaxWidth,1.0,LevelMaxDepth)
PositionEntity(DebugGridMesh,0,0-0.01,0)
EntityColor(DebugGridMesh,255,255,255)
EntityFX(DebugGridMesh,1)
;EntityPickMode(DebugGridMesh,2)
DebugGridTex = CreateTexture(16,16)
SetBuffer(TextureBuffer(DebugGridTex))
ClsColor(000,000,000)
Cls()
Color(255,255,255)
Line(0,15,0,0)
Line(0,0,15,0)
Line(15,0,15,15)
Line(15,15,0,15)
SetBuffer(BackBuffer())
ScaleTexture(DebugGridTex,1.0/LevelMaxWidth,1.0/LevelMaxDepth)
EntityPickMode(DebugGridMesh,2)
EntityTexture(DebugGridMesh,DebugGridTex,0,0)

Global DebugFeet = CreatePivot()  
  
Global DebugEyes = CreatePivot()
PositionEntity(DebugEyes,EntityX(DebugFeet,True),EntityY(DebugFeet,True),EntityZ(DebugFeet,True))
RotateEntity(DebugEyes,EntityPitch(DebugFeet,True),EntityYaw(DebugFeet,True),EntityRoll(DebugFeet,True))
MoveEntity(DebugEyes,0,1.7,0.25)
EntityParent(DebugEyes,DebugFeet,True)

DebugMesh = CreateCube()
ScaleMesh(DebugMesh,0.5/2,1.8/2,0.25/2)
PositionMesh(DebugMesh,0,1.8/2,0)
PositionEntity(DebugMesh,EntityX(DebugFeet,True),EntityY(DebugFeet,True),EntityZ(DebugFeet,True))
RotateEntity(DebugMesh,EntityPitch(DebugFeet,True),EntityYaw(DebugFeet,True),EntityRoll(DebugFeet,True))
EntityParent(DebugMesh,DebugFeet,True)
EntityColor(DebugMesh,000,000,255)

EntityParent(Camera,0)
PositionEntity(Camera,EntityX(DebugEyes,True),EntityY(DebugEyes,True),EntityZ(DebugEyes,True))
RotateEntity(Camera,EntityPitch(DebugEyes,True),EntityYaw(DebugEyes,True),EntityRoll(DebugEyes,True))  
EntityParent(Camera,DebugEyes,True)

Global MXSpeed# = 0
Global MYSpeed# = 0
Global DebugFeetYaw# = 0
Global DebugEyesPitch# = 0

PositionEntity(DebugFeet,5,0,-5)

CellSelector = CreateCube()
ScaleMesh(CellSelector,1.0/2,3.0/2,1.0/2)
PositionMesh(CellSelector,1.0/2,3.0/2,1.0/2)
PositionEntity(CellSelector,0,0,0)
EntityColor(CellSelector,125,125,125)
EntityAlpha(CellSelector,0.2)

Global DirectLight = CreateLight(2)
LightColor(DirectLight,255,255,255)
PositionEntity(DirectLight,-100,100,-100)
RotateEntity(DirectLight,45,-45,0)
AmbientLight(125,125,125)


Global G_cube = CreateCube()
ScaleMesh G_cube, 1.0/2, 0.01/2, 1.0/2
PositionMesh G_cube, 1.0/2, 0.01/2, 1.0/2
EntityColor G_cube,80,0,255
EntityAlpha G_cube ,1
Global G_picked_entity

</textarea><br><br><b> updates.bb </b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Function CameraUpdate()
 MXSpeed = MouseXSpeed()  
 MYSpeed = MouseYSpeed()   
 MoveMouse(GWidth/2,GHeight/2)  
 DebugEyesPitch = DebugEyesPitch+MYSpeed*0.1 
 If(DebugEyesPitch &gt; 89)
  DebugEyesPitch = 89
 EndIf
 If(DebugEyesPitch &lt; -89)
  DebugEyesPitch = -89
 EndIf
 DebugFeetYaw = DebugFeetYaw-MXSpeed*0.1   
 RotateEntity(DebugEyes,DebugEyesPitch,0,0)
 RotateEntity(DebugFeet,0,DebugFeetYaw,0)   
 If(KeyDown(17)&gt;0)  
  MoveEntity(DebugFeet,0,0,0.1)  
 EndIf  
 If(KeyDown(31)&gt;0)  
  MoveEntity(DebugFeet,0,0,-0.1)  
 EndIf  
 If(KeyDown(30)&gt;0)  
  MoveEntity(DebugFeet,-0.1,0,0)  
 EndIf  
 If(KeyDown(32)&gt;0)  
  MoveEntity(DebugFeet,0.1,0,0)  
 EndIf  
 If(KeyDown(16)&gt;0)  
  MoveEntity(DebugFeet,0,-0.1,0)  
 EndIf 
 If(KeyDown(18)&gt;0)  
  MoveEntity(DebugFeet,0,0.1,0)  
 EndIf 
End Function

Function Update_Pick()
 G_picked_entity = CameraPick( camera, MouseX(), MouseY() )

If G_picked_entity 

x# = Floor (PickedX())
z# = Floor (PickedZ())	
y# = Floor (PickedY())
PositionEntity G_cube, x#, 0, z#

If MouseHit(1)
	w.World_Objects = New World_Objects
	    w\mesh = CreateCube()
	    ScaleMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
        PositionMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
		w\x# = x#
		w\y# = y#
		w\z# = z#
		PositionEntity w\mesh ,w\x#,0,w\z#

EndIf

EndIf


 If(KeyDown(2)&gt;0)  
  WireFrame(True)  
 Else  
  WireFrame(False)  
 EndIf  
End Function 


Function Pre_Editor_Functions()

	Print "What size would you like your current map to be?"
	Print""
	AnswerSize%= Input()
	LevelMaxWidth%=AnswerSize
	LevelMaxDepth%=AnswerSize
	Update_Grid()

End Function

Function Update_Grid()

  ScaleEntity(DebugGridMesh,LevelMaxWidth,1,LevelMaxDepth)
  DebugGridTex = CreateTexture(16,16)
SetBuffer(TextureBuffer(DebugGridTex))
ClsColor(000,000,000)
Cls()
Color(255,0,0)
Line(0,15,0,0)
Line(0,0,15,0)
Line(15,0,15,15)
Line(15,15,0,15)
SetBuffer(BackBuffer())
ScaleTexture(DebugGridTex,1.0/LevelMaxWidth,1.0/LevelMaxDepth)
EntityPickMode(DebugGridMesh,2)
EntityTexture(DebugGridMesh,DebugGridTex,0,0)


End Function

Function GUI()

  If KeyHit(1)
   
    EndIf


End Function 

Function Update_Editor()
 If KeyHit(1) 
	closed = True
 EndIf

 Update_Pick()
 GUI()

Cls()
End Function

</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >stanrol</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> you seem to have quite the nack for it. <br><br></td></tr></table><br>
<a name="1166074"></a>

<a name="1166075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> For what?<br><br>Edit: credit to RemiD for the neat grid :D<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166199"></a>

<a name="1166200"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, Well i took a crack at it and kinda got loading and saving working... i Don't think this code is very flexible though... cause say i wanted to add a torch then i would want the torch to be lit on fire with an animation but idk where i would even start with loading and saving that information...<br><br><b> LOAD|SAVE FUNCTIONS... </b><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function load_file()
FlushKeys()
mapname$=Input$()
mapname$=Replace$(mapname$," ","_")

load_World_Info(mapname$)
load_objects(mapname$)
FlushKeys()
End Function 




Function save_file()
FlushKeys()
mapname$=Input$()
mapname$=Replace$(mapname$," ","_")
create_save_dir(mapname$)

save_objects(mapname$)
save_World_Info(mapname$)
FlushKeys()
End Function 

Function create_save_dir(mapname$)
CreateDir("maps\"+mapname$)
    CreateDir("maps\"+mapname$+"\Objects")
End Function

Function Save_World_Info(mapname$)
	fileout = WriteFile("maps\"+mapname+"\World_Info.dat")
WriteLine fileout,LevelMaxWidth%
WriteLine fileout,LevelMaxDepth%	
WriteLine fileout,GlobeID
CloseFile(fileout)
End Function

Function Save_Objects(mapname$)
For i = 1 To GlobeID
 For w.World_Objects = Each World_Objects

If w\id = i
    CreateDir("maps\"+mapname$)
    CreateDir("maps\"+mapname$+"\Objects")
	fileout = WriteFile("maps\"+mapname+"\Objects\"+mapname+"Object"+w\id+".dat")

WriteLine fileout,w\x#
WriteLine fileout,w\y#
WriteLine fileout,w\z#
WriteLine fileout,w\id
CloseFile(fileout)
EndIf
Next
Next

End Function
Function Load_World_Info(mapname$)
	Inputfile = ReadFile("maps\"+mapname$+"\World_Info.dat")
	
	  LevelMaxWidth% = ReadLine(Inputfile)
        LevelMaxDepth% = ReadLine(Inputfile)
        GlobeID = ReadLine(Inputfile)
	
    CloseFile Inputfile
End Function
Function Load_Objects(mapname$)
object_dir$ = "maps\"+mapname$+"\Objects"

    	filein = ReadDir(object_dir$)
For i = 1 To GlobeID
w.World_Objects = New World_Objects
; Assign the next entry in the folder to file$
file$=NextFile$(filein)


DebugLog "file$: " +file$
DebugLog "globeId: "+Globeid
; Use FileType to determine if it is a folder (value 2) or a file and print results
DebugLog "filetype: "+FileType(file$) 
If FileType(file$) &lt;&gt;2

DebugLog "file: "+file$
DebugLog "Directory: "+object_dir$
ran=ran+1
 Inputfile = ReadFile(object_dir$+"\"+file$)


; Properly close the open folder


DebugLog "fileread: "+inputfile
DebugLog " "



w\x# = ReadLine(Inputfile)
w\y# = ReadLine(Inputfile)
w\z# = ReadLine(Inputfile)
w\ID = ReadLine(Inputfile)
CloseFile(Inputfile)
w\mesh = CreateCube()
ScaleMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
PositionMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
PositionEntity w\mesh ,w\x#,0,w\z#

Else 
GlobeID = GlobeID + 1
Correction_number = Correction_number + 1
EndIf
Next
GlobeID = GlobeID - Correction_number
CloseDir filein




End Function

</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want a simple, generic data file reader/writer, you can use this: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2863" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2863</a><br><br>There are also XML and JSON libs floating around somewhere, but I haven't used them and therefore won't make a recommendation. <br><br></td></tr></table><br>
<a name="1166214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> i looked into it a bit and to be honest don't totally understand it haha im but as i search around it looks like im not going to be getting much help on this and im gonna have to figure it out on my own. <br><br></td></tr></table><br>
<a name="1166244"></a>

<a name="1166245"></a>

<a name="1166249"></a>

<a name="1166250"></a>

<a name="1166251"></a>

<a name="1166254"></a>

<a name="1166255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are interested in a very simple data system, I would suggest to write TXT-files. The advantage is, that you can control and manipulate them with any txt-EDITOR.<br><br>I would suggest: One line is one object. The paramters are separated by semikolons or TAB:<br><br><pre class=code>ID=1;MESH=Cube;X=3;Y=2.4;COLOR=244;.....
ID=2;MESH=Tree.3ds;X=3;Y=2.4;SIZE=3.4;.....</pre><br><br>This is very easy to handle, but flexible in parameters. Not each line must have the same number of parameter nether the same parameters<br><br>You can add as many lines as you want. After a test run you can have a look on the script and see, whether the save functions are working perfect.<br><br>You can enter new lines, or sort the line without loosing the logic during reading back into Blitz3D<br><br>In Blitz3D you would have to ReadLine(), then divide the string by semikolons in "parameter pairs", then divide each parameter pair by "=" into PARAMETERNAME and VALUE. <br><br>if you are interested, I would write some sample code lines here...<br><br>Well writing in BlitzBasic is easy:<br><br><pre class=code>WriteLine "ID=" +id+ ";MESH=" +"Cube"+  ";X=" + x + ".....</pre><br><br>The reading is more complicated:<br><br><pre class=code>; just a test string:
WholeString$="a=1;b=333;CC=12"

; a aray for our parameters:
Dim Parameter$(99)
Local i%=0

While WholeString&lt;&gt;""
	; find the position of the next semikolon:
	Cut=Instr(WholeString,";")
	If Cut=0 Then
		; if none take the whole string
		Cut=Len(WholeString)+1
	EndIf

	; now save the left part as one parameter pair
	Parameter(i)=Left(WholeString,Cut-1)
  
	; keep only the rest of the string for the next round:
	WholeString=Mid(WholeString,Cut+1,-1)
	Print Parameter(i)
	i=i+1
Wend
</pre><br><br><br>to divide paramatername from value:<br><pre class=code>; through all parameter pairs:
For j=0 To i

	; find the next "=":
	Cut=Instr(Parameter(j),"=")

	; left side will become name:
	ParameterName$=Left(Parameter(j),Cut-1)

	;right side will become value:
	Value=Mid(Parameter(j),Cut+1,-1)
	Print "Name=" + ParameterName + "       Value=" + Value
Next

</pre><br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166279"></a>

<a name="1166280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> so from brushing over it, i write actual code into the file of which is then read then directly executed, i assume this would not only be neater but far faster than say reading 3000 files like i have done in my tests? :P<br><br>So this is kinda off topic but is there a way to hide Tris that the camera cannot see I.E. behind another entity, from what i see blitz will only load tris that the camera is facing but still loads them even if they are behind other things.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166283"></a>

<a name="1166285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b> Bug? </b> i think i found a bug. when i run it it gives me correct results BUT it ends the program with an error "parameter must be posative" on the line "ParameterName$=Left(Parameter(j),Cut-1)" i did some debugging and found it was trying to add an invisible variable to the end of the original input string at the top of the code. i fixed it by changing <br><br>	For j=0 To i<br><br><br>to<br><br>	For j=0 To i-1<br><br><br>cant seem to find a way around it... any help?<br><br><br>also i am actually a GIANT fan of this simple data solution but i have a few simple questions about it.<br><br><br>is there a way to store variables that contain strings in the files this way? (along with int and floats) also i am having trouble actually using the variables that i store with this, cause although they are saved when i load in, for example, "ID=24" then when i say 'Print ""+ID' i would like it to print "24" but i can't seem to find a way to do that. sorry about all the questions, i have a lot i know. i really like this and hope i can use it.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166291"></a>

<a name="1166292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps the CR/LF symbols or a terminating 0 cause your woes here.<br>I agree with midimaster. It is the method I use - even for my .ani files.<br>Str(number)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, how do you make it actually effect your variables though? say i wanted to save "ID=24" how can i load that in so that "ID" actually = 24 cause right now it saves id as a temporary variable and same with the actual id(24)<br><br>e.g  parametername = id<br>     parameter = 24<br><br>i need some sort of function that would make blitz actually RUN the code "ID = 24"<br><br>maybe i am missing something here but i dont see a way of doing this <br><br></td></tr></table><br>
<a name="1166302"></a>

<a name="1166303"></a>

<a name="1166304"></a>

<a name="1166305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry I'm brief - many pots on the fire...<br>What you're writing is a script parser then...<br>Some pseudo code:<br>a=replace(a," ","")  ;pulls out the spaces<br>i=instr(a,"ID=")<br>if i&lt;&gt;0 then ID=floor(mid(a,i+3))<br><br>floor, ceil, or float to convert strings to numbers here...  No Val function...<br>str(value) converts numerics to strings for output....<br>Instr searches for occurrences within a string<br>Left,Mid,Right for pieces of a string...<br><br>Careful how you order your script files, too much flexibility can lead to too much complexity in the parser.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166306"></a>

<a name="1166307"></a>

<a name="1166309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another method is to output your data in a known size and loop it.<br><br>x=24<br>a=writefile("test.dat")<br>writestring(a,x)<br>for t=0 to x:writestring(a,str(ID(t)):next<br>closefile(a)<br><br>(Haven't tested the read)<br><br>x=-1;Not necessary<br>a=readfile("test.dat")<br>readstring(a,b)<br>x=floor(b)<br>for t=0 to x:readstring(a,b)<br>ID(t)=floor(b)<br>next<br>closefile(a)<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166308"></a>

<a name="1166311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm i am kinda lost... what is a? cause it seems you have it as two seperate variables? "replace(a," ","") but you use a as another variable in there? excuse my lack of knowledge on this topic please, I am just starting to branch out in blitz and learn new things so im not too good at it yet<br><br>EDIT: sorry i haven't ready your last post i posted this then saw that<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> a is your file channel id number <br><br></td></tr></table><br>
<a name="1166312"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> a is a placeholder reference that is returned by bb when you open a file to read or write, just like when you create an entity, only this is a file stream. <br><br></td></tr></table><br>
<a name="1166313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Be sure to reload this page since I made numerous changes to my example (there might still be mistakes, heh) <br><br></td></tr></table><br>
<a name="1166314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> in original basic, the a would be the #1 in print#1<br>Open "test.dat" for output as #1<br>print #1,x<br>close#1<br>heh. <br><br></td></tr></table><br>
<a name="1166315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hope I helped. <br><br></td></tr></table><br>
<a name="1166316"></a>

<a name="1166324"></a>

<a name="1166325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> You are right: It has to be  "to j=i-1". My mistake!<br><br>Strings?<br><br>Yes you already see it in the sample. There are parts which are strings:<br><br><div class="quote"> ID=1;MESH=Cube;X=3;Y=2.4;COLOR=244;..... <br></div><br><br>"Cube" is a string. You can store it with <br><pre class=code>WriteLine "MESH" + Any$ + ";X=....</pre><br><br>and there should no problem in re-reading it again. As long as you know, which paramter is String and which is number you can care about it:<br><br><pre class=code>	; left side will become name:
	ParameterName$=Left(Parameter(j),Cut-1)

	;right side will become value:
	Value$=Mid(Parameter(j),Cut+1,-1)
	Print "Name=" + ParameterName + "       Value=" + Value

	; now care about the values:
	Select ParameterName
		Case "ID"
			Id%=Int(Value)
		Case "X"
			X#=Float(Value)
		Case "MESH"
			MeshTyp$=Value
	End Select
</pre><br><br><br>In your case you would use my example lines modified into functions that handle the object properties:<br><br><pre class=code>Type World_objects
 Field x#,y#,z#,mesh,ID%
End Type

.....
If MouseHit(1)
	w.World_Objects = New World_Objects
	    w\mesh = CreateCube()
	    ScaleMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
        PositionMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
		w\x# = x#
		w\y# = y#
		w\z# = z#
		PositionEntity w\mesh ,w\x#,0,w\z#
       SavingAll()
EndIf

Function SavingAll()
	;openfile
	....

	; now write all lines:
	For w.World_Objects = each w.World_Objects
		tempString$= "ID=" + w\ID + ";MESH=Cube" + ";X=" + w\X
                WriteLine tempString.....
	Next

	;closefile
End Function
</pre><br><br>And reading them back like this:<br><br><pre class=code>For j=0 To i
	; left side will become name:
	ParameterName$=Left(Parameter(j),Cut-1)

	;right side will become value:
	Value$=Mid(Parameter(j),Cut+1,-1)
	Print "Name=" + ParameterName + "       Value=" + Value

	; now care about the values:
	Select ParameterName
		Case "ID"
			locId%=Int(Value)
		Case "X"
			locX#=Float(Value)
		Case "MESH"
			locMeshTyp$=Value
	End Select
Next

Select locMeshTyp

Case "Cube"
	w.World_Objects = New World_Objects
	    w\mesh = CreateCube()
	    w\ID=locID
	    ScaleMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
        PositionMesh w\mesh, 1.0/2, 1.0/2, 1.0/2
		w\x# = locX#
		w\y# = locY#
		w\z# = locZ#
		PositionEntity w\mesh ,w\x#,0,w\z#

End Select

</pre><br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166319"></a>

<a name="1166320"></a>

<a name="1166322"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm now im lost on "b" what is that a var for? :P sorry haha<br><br>P.S. i have managed to under stand how to read and write in single lines per object and then parse them apart using this (below), but i am still not understanding how to make it actually change the variable....<br><br><b> heres an example of what i mean </b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
	
	
	; just a test string:
	WholeString$="a=1;b=333;CC=12;ID=256;"
	
	; a aray for our parameters:
	Dim Parameter$(99)
	Global i=0
	
	While WholeString&lt;&gt;""
		; find the position of the next semikolon:
		Cut=Instr(WholeString,";")
		If Cut=0 Then
			; if none take the whole string
			Cut=Len(WholeString)+1
		EndIf
	
		; now save the left part as one parameter pair
		Parameter(i)=Left(WholeString,Cut-1)
	  
		; keep only the rest of the string for the next round:
		WholeString=Mid(WholeString,Cut+1,-1)
		Print Parameter(i)
			i=i+1
		
	Wend
	
	; through all parameter pairs:
	For j=0 To i-1
	
		; find the next "=":
		Cut=Instr(Parameter(j),"=")
	
		; left side will become name:
		
		DebugLog "Parameter(j): "+Parameter(j)
		ParameterName$=Left(Parameter(j),Cut-1)
		DebugLog "ParameterName$: "+ParameterName$
	
		;right side will become value:
		Value=Mid(Parameter(j),Cut+1,-1)
		Print "Name=" + ParameterName + "       Value=" + Value
	
	Next
	Print "ID SHOULD BE 256: "+ID

</textarea><br><br><b> I Edited the code so make sure you refresh and get the new one </b><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166326"></a>

<a name="1166328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> the "asigning" of values back to variable names is the last step.<br><br>You only have to do it:<br><br><pre class=code>		DebugLog "Parameter(j): "+Parameter(j)
		ParameterName$=Left(Parameter(j),Cut-1)
		DebugLog "ParameterName$: "+ParameterName$
	
		;right side will become value:
		Value=Mid(Parameter(j),Cut+1,-1)
		Print "Name=" + ParameterName + "       Value=" + Value

		If ParameterName="ID" Then
			Id=Value
		Endif

</pre><br><br>But in my post #23 you already can find more about this.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166377"></a>

<a name="1166378"></a>

<a name="1166379"></a>

<a name="1166382"></a>

<a name="1166383"></a>

<a name="1166384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Snort...   Gmph?   I'm awake now, sorry...<br>Oh.   B was because you're bringing in a string from the file.<br>X gets set to the value of the b string.<br>Bear in mind you might need to use float instead of floor if you need a decimal point type of value.<br><br>Normal basic used to have a split function that does what you've written.<br>You're doing fine bottle...  I haven't examined midimaster's article yet...<br><br>Ah..  Yes.  Quite correct.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> so i will infact need to type a snippet of code for each variable i want to load in? Eg: If ParameterName="ID" Then<br>			Id=Value    hmm... unfortunate, i was hoping this would be very flexible but! what must be done must be done. <br><br></td></tr></table><br>
<a name="1166393"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not that I want to toot my own horn, but the library I linked in post #8 literally does all of this stuff for you. No extra code necessary. <br><br></td></tr></table><br>
<a name="1166394"></a>

<a name="1166395"></a>

<a name="1166399"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heh, Yasha is the local genius around here.  I think it's a bit much for psychicbottle to utilize yet.  I hope he can figure this all out.<br>Tell us what troubles you next, 'bottle.  Midimaster 'n I 'll help you figure it out somehow.<br><br>I saw that midimaster mentioned in the data file having:<br>ID=1;MESH=Cube;X=3;Y=2.4;COLOR=244;.....<br>ID=2;MESH=Tree.3ds;X=3;Y=2.4;SIZE=3.4;...<br><br>What he's implied is that you're using an array to hold the relevant data much like the array I suggested in my post #16<br><br>An array can hold entire scenes if you used something like<br>scene(t)=loadanimmesh(b)<br>and then the other parameters on that line would be applied to THAT array item as you load the lines of text from the data file.<br>You mightn't even need to parse parameters at all if you leave blanks in the line.<br><br>Think like you're making a list or table:<br>Scenename    xpos   ypos   zpos   xrot    yrot   zpos   xsca   ysca   zsca<br>==================================================<br>tree.3ds         5         0        -5       0        0       0         1        1        1<br><br>Notable here is that the data line in the file aways has a fixed number of parameters.<br>readstring and writestring just use a terminating 0 to mark where each part of the data ends.<br>If you're not editing the data file with notepad or something, it doesn't matter what the text in it actually looks like, does it?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166396"></a>

<a name="1166397"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you use the help file-&gt;Command reference-&gt;2D- category and examine:<br>File<br>Filestream<br>String<br>Maths<br><br>If you haven't tried this yet, I use it all the time.<br><br>You can put your data in a binary file in any format you like, sir.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166398"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> mmk i will look into Yasha's library, and yes i understand how it parses and stores all the data, that is my current problem and i guess i will just either take the long way around or if i can im going to use yasha's library. the next problem im gonna have here is creating versatile GUI for my map editor... <br><br></td></tr></table><br>
<a name="1166400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mikorians</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> May I recommend DevilGUI <br><br></td></tr></table><br>
<a name="1166401"></a>

<a name="1166402"></a>

<a name="1166404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have looked into it and that should work for most of the editors assuming it is simple enough, but is there any way of "re-skinning" the GUI or no? i couldn't see a way to do so.<br><br>hmm i dont see FileStream in there.. but i use that all the time, my problem isn't exactly the functions. it's combining them :)-EDIT never mind.<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >psychicbottle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yasha, your library apears to be perfect but i don't see how i could "reload" these back into the game. i know im being a pain but any chance you could give me a really quick Tut on it? :D just like how i would write to a "file" and then read the variables and load them in, <br><br></td></tr></table><br>
<a name="1166448"></a>

<a name="1166449"></a>

<a name="1166450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here ya go! Hopefully this is fairly self-documenting.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; INI save/load demonstration

Include "INI.bb"	;Include the library


; First let's write some data

; Create a new INI struct to hold the data: this lives in memory
Local file.INI_File = INI_Create("This is our output file")

; Sections are optional but they keep things mor organised when there are a lot of similar objects
; This section will go at the top and just store information about the whole scene
INI_AddSection file, "SceneInfo", "Basic level setup stuffs"

Local objC = Rand(6, 12)	;How many cubes do we want?

; Add some actual data keys
INI_AddProperty file, "SceneInfo", "ObjCount", objC, "Total no. objects"		;...this many
INI_AddProperty file, "SceneInfo", "LevelName", "INI demo!"

Local i : For i = 0 To objC - 1
	Local size# = Rnd(1., 3.)		;Generate some object data for each of the cubes in our scene
	Local colRed = Rand(0, 255), colGrn = Rand(0, 255), colBlu = Rand(0, 255)
	Local posX# = Rnd(-25., 25.), posY# = Rnd(10., 15.), posZ# = Rnd(-25., 25.)
	
	Local secName$ = "Cube." + Str i
	INI_AddSection file, secName, ""	;Create a new section for each object (no comment, we're boring)
	INI_AddProperty file, secName, "size", size
	INI_AddProperty file, secName, "col.R", colRed
	INI_AddProperty file, secName, "col.G", colGrn
	INI_AddProperty file, secName, "col.B", colBlu
	INI_AddProperty file, secName, "pos.X", posX
	INI_AddProperty file, secName, "pos.Y", posY
	INI_AddProperty file, secName, "pos.Z", posZ
Next

; All of the objects have now been stored in the INI struct, so we can "commit" it to disk
INI_Write file, "INI demo data.ini"
; ...and throw it away, to prove that reloading works
INI_Free file


; There should now be a file in the project folder called "INI demo data.ini".
; Open it with a text editor, tweak the values if you like, and observe the structure


; ## Scene (not relevant to example)
Const SC_FPS=60	;Desired framerate
Local rtime = Floor(1000.0 / SC_FPS), limited = True

Graphics3D 1024, 768, 32,6
SetBuffer BackBuffer()

Local centrecam = CreatePivot(), camera=CreateCamera(centrecam)
PositionEntity centrecam, 0, 25, 0 : PositionEntity camera, 0, 20, -50, 1
Local sun = CreateLight() : PositionEntity sun, -100, 400, 0 : PointEntity sun, centrecam

Local ground = CreateMesh(), tile = CreateSurface(ground), block = CreateCube()
AddVertex tile, -125, 0, 150 : AddVertex tile, 125, 0, 150 : AddVertex tile, 125, 0, -100 : AddVertex tile, -125, 0, -100
AddTriangle tile, 0, 1, 2 : AddTriangle tile, 0, 2, 3
EntityColor ground, 0, 0, 255 : ScaleMesh block, 20, 5, 20
; ## (End of background scene stuff)


; Now let's load the data to make a scene!

Local scene.INI_File = INI_Load("INI demo data.ini")	;Load the data from file into an INI struct

; Get the information about the whole scene first
objC = INI_GetValue(scene, "SceneInfo", "ObjCount")
Local levelName$ = INI_GetValue(scene, "SceneInfo", "LevelName")

; Act on it!
AppTitle levelName, "Are you sure you want to quit the awesome '" + levelName + "'?"

For i = 0 To objC - 1	;Count through the list of objects
	
	Local objName$ = "Cube." + i	;See we can dynamically generate key names using string operations, making it work like an array
	
	Local cube = CreateCube(), sz#, pX#, pY#, pZ#, cR, cG, cB
	
	sz = INI_GetValue(scene, objName, "size")	;Read the size key for this object name
	ScaleEntity cube, sz, sz, sz				;Apply the key to the ingame object in a relevant way
	
	pX = INI_GetValue(scene, objName, "pos.X")	;etc.
	pY = INI_GetValue(scene, objName, "pos.Y")
	pZ = INI_GetValue(scene, objName, "pos.Z")
	PositionEntity cube, pX, pY, pZ
	
	cR = INI_GetValue(scene, objName, "col.R")
	cG = INI_GetValue(scene, objName, "col.G")
	cB = INI_GetValue(scene, objName, "col.B")
	EntityColor cube, cR, cG, cB
Next

; ...and now we have a scene, loaded from a file!


; Nothing of interest in the main loop
While Not KeyDown(1)
	Local cTime = MilliSecs()
	
	MoveEntity camera, 0, KeyDown(200) - KeyDown(208), KeyDown(30) - KeyDown(44)	;Move camera
	TurnEntity centrecam, 0, KeyDown(203) - KeyDown(205), 0
	PointEntity camera, centrecam
	
	RenderWorld
	
	Delay rtime - (MilliSecs() - cTime) - (limited + 1)		;Free spare CPU time
	Flip limited
Wend

End


; The library demands that we provide this function to deal with errors
; (because it doesn't know how we want to handle them)
Function LogError(err$)
	RuntimeError "INI error: " + err	;Simple for the example
End Function


;~IDEal Editor Parameters:
;~C#Blitz3D</textarea><br><br>Take note of the LogError function that has to be provided to suit your program's error handling system.<br><br>Do take a look at the outputted data file. If you open it in something like Notepad++, it should be automatically syntax-highlighted and so on for you.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gradualcheetah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am currently having issues with my account but just a heads up i am psychicbottle still here just on a different account since mine has been possibly hacked..? im not sure. Yasha, i don't suppose there is an easy way to make this work with types is there? :) i use types a lot and prefer them over Arrays mainly cause i know how to use them ;) <br><br></td></tr></table><br>
<a name="1166490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eh? The code above doesn't use an array...?<br><br>Fields of a type and cells of an array are just value slots like variables. You put values in and take 'em out. You'll have to give an example of what you want done, because "working with" types in general shouldn't involve any significant changes to the above. <br><br></td></tr></table><br>
<a name="1166491"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gradualcheetah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm i may have jumped to conclusions from too quick a glance at the code... one moment please :D haha sorry for being so "questiony", by the way. <br><br></td></tr></table><br>
<a name="1166492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gradualcheetah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok some small tweaks to the demo here:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

; INI save/load demonstration

Include "INI.bb"	;Include the library
SeedRnd MilliSecs()

Type cube
	Field size,colred,colGrn,colBlu,posx,posy,posz,secName$
End Type

; First let's write some data

; Create a new INI struct to hold the data: this lives in memory
Local file.INI_File = INI_Create("This is our output file")

; Sections are optional but they keep things mor organised when there are a lot of similar objects
; This section will go at the top and just store information about the whole scene
INI_AddSection file, "SceneInfo", "Basic level setup stuffs"

Local objC = Rand(6, 9)	;How many cubes do we want?

; Add some actual data keys
INI_AddProperty file, "SceneInfo", "ObjCount", objC, "Total no. objects"		;...this many
INI_AddProperty file, "SceneInfo", "LevelName", "INI demo!"


Local i : For i = 0 To objC - 1
  c.cube = New cube
	 c\size# = Rnd(1., 3.)		;Generate some object data for each of the cubes in our scene
	 c\colRed = Rand(0, 255): c\colGrn = Rand(0, 255): c\colBlu = Rand(0, 255)
	c\posX# = Rnd(-25., 25.): c\posY# = Rnd(10., 15.): c\posZ# = Rnd(-25., 25.)
	
	c\secName$ = "Cube." + Str i
	INI_AddSection file, c\secName, "hm"	;Create a new section for each object (no comment, we're boring)
	INI_AddProperty file, c\secName, "size", c\size
	INI_AddProperty file, c\secName, "col.R", c\colRed
	INI_AddProperty file, c\secName, "col.G", c\colGrn
	INI_AddProperty file, c\secName, "col.B", c\colBlu
	INI_AddProperty file, c\secName, "pos.X", c\posX
	INI_AddProperty file, c\secName, "pos.Y", c\posY
	INI_AddProperty file, c\secName, "pos.Z", c\posZ
  
Next

; All of the objects have now been stored in the INI struct, so we can "commit" it to disk
INI_Write file, "INI demo data.ini"
; ...and throw it away, to prove that reloading works
INI_Free file


; There should now be a file in the project folder called "INI demo data.ini".
; Open it with a text editor, tweak the values if you like, and observe the structure


; ## Scene (not relevant to example)
Const SC_FPS=60	;Desired framerate
Local rtime = Floor(1000.0 / SC_FPS), limited = True

Graphics3D 1024, 768, 32,6
SetBuffer BackBuffer()

Local centrecam = CreatePivot(), camera=CreateCamera(centrecam)
PositionEntity centrecam, 0, 25, 0 : PositionEntity camera, 0, 20, -50, 1
Local sun = CreateLight() : PositionEntity sun, -100, 400, 0 : PointEntity sun, centrecam

Local ground = CreateMesh(), tile = CreateSurface(ground), block = CreateCube()
AddVertex tile, -125, 0, 150 : AddVertex tile, 125, 0, 150 : AddVertex tile, 125, 0, -100 : AddVertex tile, -125, 0, -100
AddTriangle tile, 0, 1, 2 : AddTriangle tile, 0, 2, 3
EntityColor ground, 0, 0, 255 : ScaleMesh block, 20, 5, 20
; ## (End of background scene stuff)


; Now let's load the data to make a scene!

Local scene.INI_File = INI_Load("INI demo data.ini")	;Load the data from file into an INI struct

; Get the information about the whole scene first
objC = INI_GetValue(scene, "SceneInfo", "ObjCount")
Local levelName$ = INI_GetValue(scene, "SceneInfo", "LevelName")

; Act on it!
AppTitle levelName, "Are you sure you want to quit the awesome '" + levelName + "'?"

For i = 0 To objC - 1	;Count through the list of objects
	
	Local objName$ = "Cube." + i	;See we can dynamically generate key names using string operations, making it work like an array
	
	Local cube = CreateCube(), sz#, pX#, pY#, pZ#, cR, cG, cB
	
	sz = INI_GetValue(scene, objName, "size")	;Read the size key for this object name
	ScaleEntity cube, sz, sz, sz				;Apply the key to the ingame object in a relevant way
	
	pX = INI_GetValue(scene, objName, "pos.X")	;etc.
	pY = INI_GetValue(scene, objName, "pos.Y")
	pZ = INI_GetValue(scene, objName, "pos.Z")
	PositionEntity cube, pX, pY, pZ
	
	cR = INI_GetValue(scene, objName, "col.R")
	cG = INI_GetValue(scene, objName, "col.G")
	cB = INI_GetValue(scene, objName, "col.B")
	EntityColor cube, cR, cG, cB
Next

; ...and now we have a scene, loaded from a file!


; Nothing of interest in the main loop
While Not KeyDown(1)
	Local cTime = MilliSecs()
	
	MoveEntity camera, 0, KeyDown(200) - KeyDown(208), KeyDown(30) - KeyDown(44)	;Move camera
	TurnEntity centrecam, 0, KeyDown(203) - KeyDown(205), 0
	PointEntity camera, centrecam
	
	RenderWorld
	
	Delay rtime - (MilliSecs() - cTime) - (limited + 1)		;Free spare CPU time
	Flip limited
Wend

End


; The library demands that we provide this function to deal with errors
; (because it doesn't know how we want to handle them)
Function LogError(err$)
	RuntimeError "INI error: " + err	;Simple for the example
End Function


;~IDEal Editor Parameters:
;~C#Blitz3D

</textarea><br><br>my question now is, say in my game engine(the place i will load and run my maps) if i create a cube and give it <b>"c\secName$ = "Cube.01"</b> then can i manipulate that type in the engine (after it has been loaded in) by going mmm <b>for c.cube = each cube<br>           if c\secName = cube.01 then positionentity c\mesh,100,100,100<br>           next</b> <br><br></td></tr></table><br>
<a name="1166494"></a>

<a name="1166495"></a>

<a name="1166496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gradualcheetah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> holy crap you are a local genius here. im kinda slow at first haha but im wipping through the library so i can grasp it, and i think i found a way to do what i need :) ill get back to you in a sec, if you are still up/on<br><br><b>EDIT:</b> hmmm is there any way through this problem: i want to add a variable called c\meshhandle with the value of CreateCube() any way i could do this or not really?<br>thanks for all your help so far!<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166497"></a>

<a name="1166498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> hmmm is there any way through this problem: i want to add a variable called c\meshhandle with the value of CreateCube() any way i could do this or not really? <br></div><br><br>To the data file?<br><br>(Adding a variable to a section is as easy as calling INI_AddProperty with whatever key name you want, but -)<br><br>Saving the handle of a 3D entity (or for that matter any asset represented by a handle) is a really bad idea: the entity won't have been created next time the program is run, so the value won't refer to anything unless CreateCube runs again anyway; and if it does run again, it probably won't return the same handle because the engine isn't required to be at all consistent about that (handles aren't <i>really</i> numbers, they're memory addresses, which happen to be representable as numbers so B3D does that for simplicity; you should never depend on a newly-returned address being anything specific).<br><br>The only true way to "save" an entity is to save all of the "constant" information needed in order to recreate it.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1166507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gradualcheetah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, thank you very much. I think i know basically what i need to so i can write some simple save/load functions for my Map-Editor.then im on to trying to use the devil GUI system... oofta.<br><br>one last question, so say i want to be able to manipulate the physical mesh later on. even though i cant actually put the function "createcube()" in and rely on it to create a cube to the variable, would it work to make a field "meshhandle" save it as zero always then after loading in all properties do c\meshhandle = createcube()<br>and apply all properties to that mesh?<br><br>P.S. bwahaha i love you this is seeming to work very very well...(No homo) but for real this is a very nice system and it is really quite flexible, you should maybe consider making it into a DLL and what not to add to the userlib in the Blitz3d files (i would but i dont know how to) <br><br></td></tr></table><br>
<a name="1166512"></a>

<a name="1166515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gradualcheetah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm im not trying to be picky but it seems very slow... any way to speed it up or any tips on how to? or not really<br><br>Nevermind, i had a glitch in my code that was saving all the data for EACH cube (cube.1,cube.2,cube.3 ect.) to the first cube. im not sure why it lagged  the process so much... but just thought id let you know i did a comparison of my old method and my optimized version of yours, and it runs more than ten times faster. Great work there :)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
