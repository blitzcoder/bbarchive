<!DOCTYPE html><html lang="en" ><head ><title >3D Sprites - any gotchas?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >3D Sprites - any gotchas?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >3D Sprites - any gotchas?</a><br><br>
<a name="785606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jazz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Currently I'm just testing out a few bits and pieces to see if I can do what I want with the 3D sprites side of Blitz3D.  To start with I used some code from the Code Archives to get it up and running.  Anyway I seem to have hit a snag.  I've created a square mesh which I intend to use as a background, coloured it red and placed it behind my sprite.  However the sprite seems to blend with the red mesh as if alpha is set on the sprite (although it shouldn't be, and isn't as far as I can see).  So it's a good bet I've done something to the original code that I shouldn't have. :)  Please forgive the mess, this is just a test and an attempt to get it straight in my head as to how Blitz3D does certain things.  I also apologise in advance to the guy I borrowed the code from and mangled.<br><br>Global WIDTH = 600<br>Global HEIGHT = 600<br>Global halfWIDTH = WIDTH/2<br>Global halfHEIGHT = HEIGHT/2<br><br>; Seed the random number generator<br>SeedRnd(MilliSecs())<br><br>; Program start<br>Graphics3D WIDTH,HEIGHT,16,2<br>;SetBuffer BackBuffer()<br><br>; Create and set camera<br>camera = CreateCamera()<br>camzoom#=1.0 ; this is default. Other values work as well.<br>CameraZoom camera,camzoom#<br>CameraRange camera,1,(halfWIDTH * camzoom#)+1000<br><br>; Starfield settings<br>Global StarsMinSpeed = 1<br>Global StarsMaxSpeed = 8<br>Global StarsTotal = 400<br>; Starfield data<br>Type StarData<br>	Field X#<br>	Field Y#<br>	Field Speed#<br>	Field Colour<br>End Type<br>Dim Starfield.StarData(StarsTotal)<br><br>; Load and setup our sprite<br>sprite=LoadSprite("PS1.bmp")<br>; if you want the sprite to be 48*48 Pixels:<br>ScaleSprite sprite,48/2,48/2<br>x# = 300<br>y# = 300<br><br>; Set the sprite start angle<br>ang#=90<br><br>; Initialise the starfield<br>InitStarField(StarsTotal,StarsMinSpeed,StarsMaxSpeed)<br>; Create test brush<br>brush = CreateBrush()<br>BrushColor brush,255,0,0<br>; Create a blank empty mesh<br>buffer = CreateMesh()<br>; Create blank surface which is attached to mesh<br>surface = CreateSurface(buffer,brush)<br>; Give the mesh and surface a shape - it's just a square<br>v0 = AddVertex(surface,-200,200,0)<br>v1 = AddVertex(surface,200,200,0)<br>v2 = AddVertex(surface,200,-200,0)<br>v3 = AddVertex(surface,-200,-200,0)<br>; Now add triangles to make it solid and visible<br>t0 = AddTriangle(surface,v0,v1,v2)<br>t1 = AddTriangle(surface,v0,v2,v3)<br>UpdateNormals buffer<br><br>; Set initial facing of player ship<br>RotateSprite sprite,ang<br>;EntityOrder sprite,-1<br>;EntityAlpha sprite,1<br><br>; Main loop<br>While KeyDown(1)=0<br>	; Draw our red box which will become our background<br>	PositionEntity buffer,x-halfWIDTH,halfHEIGHT-y,halfWIDTH * camzoom# + 50<br>	<br>	; Draw the players ship<br>	PositionEntity sprite,x-halfWIDTH,halfHEIGHT-y,halfWIDTH * camzoom#<br>	<br>	; Turn left<br>	If KeyDown(203)<br>		ang = ang + 3<br>		RotateSprite sprite,ang<br>	; Turn right<br>	ElseIf KeyDown(205)<br>		ang = ang - 3<br>		RotateSprite sprite,ang<br>	EndIf<br>	<br>	; Roll the angle value around<br>	If ang &lt; 0<br>		ang = 360 + ang<br>	ElseIf ang &gt; 359<br>		ang = ang - 360<br>	EndIf<br>	<br>	UpdateWorld<br>	RenderWorld<br>	; Draw starfield<br>	; 2D commands should be drawn after updateworld/renderworld but before flip<br>	DrawStarField(ang)<br>	Flip<br>Wend<br>EndGraphics<br>End<br><br>; Initalise starfield<br>Function InitStarField(amount,min,max)<br>	; Set starfield to initial values<br>	For i = 0 To amount<br>		; Initialise entry in array<br>		Starfield.StarData(i) = New StarData<br>		; Set fields in entry<br>		Starfield(i)\X = Rand(0,GraphicsWidth())<br>		Starfield(i)\Y = Rand(0,GraphicsHeight())<br>		Starfield(i)\Speed = Rand(min,max)<br>		; We want grey scale without having stars too dark to see.<br>		; So we force the colour range into the 61 - 255 bracket.<br>		c = Rand(60,195)<br>		; Convert from RGB into argb for writepixel etc. and store in array<br>		Starfield(i)\Colour = (c Or (c Shl 8) Or (c Shl 16) Or ($ff000000))<br>	Next<br>End Function<br><br>; Starfield display routine<br>Function DrawStarField(direction#)<br>	; We lock the screen buffer for drawing, to speed it all up<br>	LockBuffer<br>	; Update starfield array<br>	For i = 0 To StarsTotal<br>		; Move the star in the given direction and the given speed<br>		X# = (Starfield(i)\X) - (Starfield(i)\Speed * Cos(direction))<br>		Y# = (Starfield(i)\Y) + (Starfield(i)\Speed * Sin(direction))<br>		<br>		; If star has moved off screen, relocate it<br>		If X &lt; 0<br>			X = GraphicsWidth()<br>			Y = Rand(0,GraphicsHeight())<br>		ElseIf X &gt;= GraphicsWidth()<br>			X = 0<br>			Y = Rand(0,GraphicsHeight())<br>		EndIf<br>		If Y &lt; 0<br>			Y = GraphicsHeight()<br>			X = Rand(0,GraphicsWidth())<br>		ElseIf Y &gt;= GraphicsHeight()<br>			Y = 0<br>			X = Rand(0,GraphicsWidth())<br>		EndIf<br>		<br>		; Draw the star<br>		WritePixelFast X,Y,Starfield(i)\Colour<br>		; Update the starfield entry<br>		Starfield(i)\X = X<br>		Starfield(i)\Y = Y<br>	Next<br>	UnlockBuffer<br>End Function <br><br></td></tr></table><br>
<a name="786151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >thelizardking</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> well the default sprite loading is where black is totally transparent, white is totally visible, and the alpha is adjusted for each color in between. what you can do is do LoadSprite("PS1.bmp",4) which just sets black as transparent. <br><br></td></tr></table><br>
<a name="786175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jazz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok thanks, you hit the nail on the head.  That's what was going on.  Now I just have to clean the image up so that having black as transparent doesn't uglify it completely. :) <br><br></td></tr></table><br>
<a name="786180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> that or load it with flag 2 instead of flag 4 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
