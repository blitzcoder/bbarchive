<!DOCTYPE html><html lang="en" ><head ><title >Closest Waypoint?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Closest Waypoint?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Closest Waypoint?</a><br><br>
<a name="1096196"></a>

<a name="1096197"></a>

<a name="1096198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all, how can I make it so that if the enemy is currently chasing my character or it gets too far from its point, it goes back to the waypoint it came from?<br><br>Here's my function so far: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function GoBackToWaypoint(enemy, wp)
oldwp = wp
If EntityDistance(enemy, wp) &gt; 10 And oldwp&lt;&gt;wp Then
PointEntity enemy, wp
MoveEntity enemy, 0, 0, .1
EndIf
End Function</textarea><br><br>Thanks! :)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1096314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >stayne</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you trying to make another WoW?  Text above the head, chasing the player, chat box, huge terrains, etc.  Just seems like you are to me.  Not a mean question I am just curious. <br><br></td></tr></table><br>
<a name="1096315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something better, and much more quality specific. HOWEVER, some of these functions I'm asking for are for my gothic game :) <br><br></td></tr></table><br>
<a name="1096997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> This question had been answered before, and I believe I wrote this example for you earlier.<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=89386" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=89386</a> <br><br></td></tr></table><br>
<a name="1098907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you mean this ?<br><br>Select Mode<br><br>Case Mode=1<br>  Guarding... looking for enemys around.. ahh a enemy, target ,set mode 2<br><br>Case Mode=2<br>  Follow player, if close engouth bit it. <br>  if player dies then mode=3<br>  if player is to faraway then mode=3<br>  if orginx,y is to faraway then mode=3<br>case mode=3<br> Walk to Orgin X,Y<br><br>Case mode=4<br> Playe dead..<br><br>End select <br><br></td></tr></table><br>
<a name="1098913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, I have this so far<pre class=code>Select Mode

Case Mode=1
Guarding... looking for enemys around.. ahh a enemy, target ,set mode 2

Case Mode=2
Follow player, if close engouth bit it. 
if player dies then mode=3
if player is to faraway then mode=3
if orginx,y is to faraway then mode=3
case mode=3
Walk to Orgin X,Y

Case mode=4
Playe dead..

End select</pre>It doesnt work. Any Ideas <br><br></td></tr></table><br>
<a name="1098949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >stayne</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Typed this up, is some old simple AI code I wrote.  Threw in some chasecam code in the archives.  Hopefully this will give you some ideas.<br><br><pre class=code>


Global gameFPS = 50

Graphics3D 1024,768,32,2
SetBuffer BackBuffer()

SeedRnd MilliSecs()

Global camera = CreateCamera ()
CameraZoom camera,1.6
CameraRange camera,.1,100000
CameraClsColor camera,50,50,50

Global player = CreateCube()
ScaleEntity player,4,10,4
PositionEntity player,0,10,-600

Global PlayerHP = 100

AmbientLight 150,150,150

light = CreateLight()
PositionEntity light,0,0,0

quit = False

framePeriod = 1000 / gameFPS
frameTime = MilliSecs () - framePeriod

redhome = CreateSphere()
ScaleEntity redhome,6,6,6
PositionEntity redhome,-400,10,0

Type CSys
	Field cx#, cy#, cz#
	Field mx#, my#, sps%
End Type

Type cube
	Field mesh
	Field walktimer
	Field turntimer
	Field moving
	Field decision
	Field distfromhome
	Field id
	Field team
	Field level
	Field strength
	Field stamina
	Field dmg
	Field dly
	Field hp
	Field home
	Field angry
	Field timer
	Field dice
	Field damage
	Field alive
End Type

For i = 1 To 10
	c.cube = New cube
	c\id = i
	c\team = 1
	c\hp = 100
	c\dmg = 8
	c\dly = 2000
	c\stamina = 18
	c\strength = 12
	c\level = 3
	c\alive = True
	c\home = redhome
	c\mesh = CreateCube()
	EntityColor c\mesh,255,0,0
	ScaleEntity c\mesh,4,4,4
	PositionEntity c\mesh,EntityX(c\home),EntityY(c\home),EntityZ(c\home)
	d.cube = c.cube
Next

Plane=CreatePlane()
EntityAlpha plane,.8
EntityColor plane,50,50,50
CreateMirror()

Repeat

	Repeat
		frameElapsed = MilliSecs () - frameTime
	Until frameElapsed

	frameTicks = frameElapsed / framePeriod

	frameTween# = Float (frameElapsed Mod framePeriod) / Float (framePeriod)

	For frameLimit = 1 To frameTicks

		If frameLimit = frameTicks Then CaptureWorld
		frameTime = frameTime + framePeriod
		
		ChaseCam(camera, player, 0, 4, -40, .1)
		
		If KeyHit(1) Then quit = True

		If KeyDown(17) Then MoveEntity player,0,0,4
		If KeyDown(31) Then MoveEntity player,0,0,-4
		If KeyDown(32) Then MoveEntity player,4,0,0
		If KeyDown(30) Then MoveEntity player,-4,0,0
				
		TurnEntity player,0,-MouseXSpeed()/2,0
		
		For c.cube = Each cube
	
			If c\alive = True

				If EntityDistance (c\mesh,player) &lt; 500
					c\angry = True
					dy#=DeltaYaw(c\mesh,player)*.1
					TurnEntity c\mesh,0,dy,0
					
					If EntityDistance (c\mesh,player) &gt; 300
						MoveEntity c\mesh,0,0,3
					EndIf
					
					If c\timer + c\dly &lt; MilliSecs()
					
						c\dice = Rnd(1,5)
						c\damage = Ceil((c\strength * c\stamina * c\dmg) * c\dice * c\level / 10000)
						playerhp = playerhp - c\damage
						c\timer = MilliSecs()
						
					EndIf
					
					If c\hp &lt;=0 Then c\alive = False
					
				Else
					c\angry = False
				EndIf
			
				c\distfromhome = EntityDistance(c\mesh,c\home)
					
				If c\angry = False
					
					If c\moving = False
						c\decision = Rand(1,200)
						Select True
							Case c\decision = 10
								c\walktimer = MilliSecs() + 3000
							Case c\decision = 100
								c\turntimer = MilliSecs() + 1000
						End Select
					EndIf
			
					If c\walktimer &gt; MilliSecs() 
						c\moving = True
						MoveEntity c\mesh,0,0,3
					Else If c\turntimer &gt; MilliSecs()
						c\moving = True
						TurnEntity c\mesh,0,2,0
					Else
						c\moving = False
					EndIf
			
					If c\distfromhome &gt; 400
						dy#=DeltaYaw(c\mesh,c\home)*.04
						TurnEntity c\mesh,0,dy,0
					EndIf
				
				EndIf
			Else
				FreeEntity c\mesh
				Delete c
			EndIf
			
		Next

		UpdateWorld

	Next
	
	RenderWorld frameTween
	
	For c.cube = Each cube
		CameraProject(camera,EntityX(c\mesh),EntityY(c\mesh),EntityZ(c\mesh))
		
		Color 0,255,0
			
		Rect ProjectedX()-25,ProjectedY()-20,c\hp/2,4

	Next
	
	Text 10,10,PlayerHP
	
	Flip

Until quit = True

End

Function ChaseCam(cam, Entity, XOff#, YOff# = 2, ZOff# = -5, Spd# = 0.8)

	Local sys.csys = First csys
	Local nx#, ny#, nz#
	Local dx#, dy#, dz#
	Local ex#, ey#, ez#
	Local hit%
	
	If sys = Null 
		sys = New cSys
		sys\sps = CreatePivot()
	EndIf
	
	sys\mx = MouseX()
	sys\my = MouseY()
	sps = sys\sps
	PositionEntity sps, EntityX(entity), EntityY(entity), EntityZ(entity)
	TFormVector xOff, yOff, zOff, entity, 0
	ex# = EntityX(entity)
	ey# = EntityY(entity)
	ez# = EntityZ(entity)
	nx# = ex+TFormedX()
	ny# = ey+TFormedY()
	nz# = ez+TFormedZ()
	dx# = nx-ex
	dy# = ny-ey
	dz# = nz-ez
	hit = LinePick(ex, ey, ez, dx, dy, dz, 0.2)
	
	If hit
		nx = PickedX()
		ny = PickedY()
		nz = PickedZ()
	EndIf
	
	sys\cx = sys\cx+(nx-sys\cx)*spd
	sys\cy = sys\cy+(ny-sys\cy)*spd
	sys\cz = sys\cz+(nz-sys\cz)*Spd
	
	PositionEntity cam, sys\cx, sys\cy, sys\cz
	PointEntity Cam, Entity, 0

End Function
</pre> <br><br></td></tr></table><br>
<a name="1099096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's MY code... well, it looks a bit like it but I was too embarrassed to post it here. <br><br></td></tr></table><br>
<a name="1099134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Rez, if you are having learning difficulty and you've not always been like that you need to see a doctor. I did - after I collapsed. I didn't like what I heard but it did very neatly explain a very great many things. <br><br></td></tr></table><br>
<a name="1099136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think Rez may be suspended? <br><br></td></tr></table><br>
<a name="1099138"></a>

<a name="1099147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Censored<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1099142"></a>

<a name="1099146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Censored<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1099143"></a>

<a name="1099145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Censored<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1099148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure you understand... I meant no harm or insult...<br><br>Last point... Flameduck. Please send him my regards and apologies for all those years ago <br><br></td></tr></table><br>
<a name="1099185"></a>

<a name="1099198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> EDIT - ignore me then :)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1099192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was/am puzzled by this too, but with it beeing the first yesterday and the forum does like screwing around then, perhaps the last comment was a multiple repost and nor harm or insult aimed at rez re the previous not edited post. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
