<!DOCTYPE html><html lang="en" ><head ><title >EntityOrder problems? Typical....</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >EntityOrder problems? Typical....</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >EntityOrder problems? Typical....</a><br><br>
<a name="456338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, here I am again with yet another problem.<br><br>Here's a screenshot without making "rifle\entityhandle" ordered:<br><img src="http://www.noenemies.com/srn2.JPG"><br><br>And here's one where it IS ordered (at -4)<br><img src="http://www.noenemies.com/messedup2.JPG"><br><br>What's wrong? <br><br></td></tr></table><br>
<a name="456366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The near clipping plane is clipping the rifle.<br>Set your near clipping plane to something less.<br>Looking at your other post, you have it set to .1, try .05. <br><br></td></tr></table><br>
<a name="456371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> no, that's an old screenshot above. disregard the near clipping - it's fixed. what I want you to look at is the fact that the rifle in the second picutre is dissected.<br><br>eh? <br><br></td></tr></table><br>
<a name="456390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> looks like some of the normals have been flipped. <br><br></td></tr></table><br>
<a name="456391"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like the entity order command has only affect some of the rifle. Is it made up of many parts? Different meshes? <br><br></td></tr></table><br>
<a name="456394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> nope - one single mesh - "w_xm1014.3ds" <br><br></td></tr></table><br>
<a name="456400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that part of the gun is actualy behind the camera, but, is being forced to be rendered anyway. I think that's whats causing the order problem.<br><br>Try this. Hide the gun. Render the world. Set the cam mode to NOT clear the Z-Buffer (cameraclsmode) then, hide the world, and render just the gun. That way, it will always be on top. You can either hide the world, move the camera out of the world, or set the camerarange really small, so your only rendering the gun, in the second render. <br><br></td></tr></table><br>
<a name="456472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eh? That didn't work at all.<br><pre class=code>
While Not KeyDown(1)
UpdateCamera()
RenderWorld
CameraClsMode camera, 1, 0
HideEntity level1 
UpdateGun()
UpdateBullets()
UpdateWorld
ShowEntity level1
UpdateParticles()
UpdateEnemies()
UpdateMiscActions()
;draw crosshairs
RenderWorld
DrawImage hairs, 400, 300
UpdateGUI()
Flip
Wend
</pre> <br><br></td></tr></table><br>
<a name="456489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Setting an entity's order to non-0 also disables z-buffering for the entity, so should be only used for simple, convex entities like skyboxes, sprites etc. <br><br></td></tr></table><br>
<a name="456502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rhyolite</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Errr, I am probably thick, but why do you need to set the entity order on the rifle at all? If it is positioned correctly in your world, then it should render correctly? <br><br></td></tr></table><br>
<a name="456577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it is positioned correctly, it goes through walls. I want to render the gun first. <br><br></td></tr></table><br>
<a name="456593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> "what I want you to look at is the fact that the rifle in the second picutre is dissected."<br>You should have mentioned this right off the bat.  It both amuses and annoys me when people do stuff like posting some random code and asking "what's wrong?" or they don't say anything because they think the subject line is enough information.<br><br>At any rate, WolRon is right about the z-buffering.  That is, when you use EntityOrder you turn off z-buffering for the object, so polygons within the object are no longer sorted correctly.  This doesn't matter for seamless convex models (since polygons on the far side of the model are all facing away and thus culled,) but for models with overlapping parts this will screw up rendering.  Without z-buffering the renderer won't know which polygons are on top of which.  The solution is to redo your model so that it is convex and parts aren't overlapping. <br><br></td></tr></table><br>
<a name="456652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> The old second camera trick works for me.<br><br>Create a second camera and position it far away from your arena using similar code to that below. Parent the gun to the camera in the same relative position as it would be to the player character's main camera. When the player character rotates, also rotate the second camera to get correct lighting on the gun.<br><br>Global HUD_camera<br><br>Function CreateHUD()<br>	; -- Setup HUD camera<br>	HUD_camera = CreateCamera()<br>	PositionEntity HUD_camera, 0.0, -500.0, 0.0<br>	CameraRange HUD_camera, 0.2, 3.0<br>	CameraZoom HUD_camera, 1.6<br>	CameraClsMode HUD_camera, False, True<br>	EntityOrder HUD_camera, -1<br>End Function <br><br></td></tr></table><br>
<a name="456803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm thinking, would you be seeing the gun at any other angle?  Why not just make it into a sprite or textured quad?  Then you wouldn't have to worry about z buffer problems with entity order. <br><br></td></tr></table><br>
<a name="456825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wepaon changing might be a problem, if you move the weapon out of view, and move a new one in :o) The second camera trick certainly does the trick tho. <br><br></td></tr></table><br>
<a name="456834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not just set the collison sphere so that the weapon can't go through the wall????  Easiest solution yet. <br><br></td></tr></table><br>
<a name="456864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Trouble with making the collision sphere that large is that the player won't be able to fit into spaces he ought to.  The gun is a narrow protrusion out front, so encompassing it into the collision radius would mean the collision sphere would extend way out from the player in all directions. <br><br></td></tr></table><br>
<a name="456913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not if you use a seperate sphere for the weapon... <br><br></td></tr></table><br>
<a name="456922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then the weapon would move away from the player if it hit a wall. <br><br></td></tr></table><br>
<a name="457547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess you used LoadAnimMesh for the Gun? Well, probably you simply want or need to use an animated Mesh for the gun, as I do too. I had this Problem too, when I worked on my first FPS Demo. My solution was to downscale the weapon that much that it never would sink into a wall or something. Of course, this also requires to position it closer to the camera center. Probably, when the weapon looks too long-stretched this way, you need to scale the depth of it even smaller than the rest (a camera-zoom issue) <br><br></td></tr></table><br>
<a name="462078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >doctorskully</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> My understanding of using the EntityOrder command is that it disregards which triangles come first (from greater distance to lesser distance) and instead draws the triangles in the order they are read from the file.  Therefore, perspective remains, but triangles that are supposed to be behind something are in front of it sometimes, for example.  At least, I think this is how it causes the problems.<br><br>My only suggestion is to do this: Completely get rid of the EntityOrder, as it only messes up the meshes.  To solve the problem involving guns stuck in walls, try attaching an invisible sphere as a parent entity to the camera.  Position it in front of the camera and scale so it creates a semi-'shield' in front of the camera.  Then, perform sphere collision testing (as accurately as possible with both x and y radii) with your invisible sphere, and therefore the camera's regular radius remains except for the 'shield' in the front.<br><br>So, basically, it'll be shielding your player from moving into a wall too far forward, yet allowing the usual radius collision testing for +y,-y,+x,-x, and -z.<br><br>Sorry if it's counfusing.  I'd make some code for you, but I haven't the faintest idea how big the gun is, your usual player radius, and other stuff like that. <br><br></td></tr></table><br>
<a name="462087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's called "EntityRadius."<br><br>But the guns always go through the walls, no matter ho much I try.<br><br>Axeman - you rock. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
