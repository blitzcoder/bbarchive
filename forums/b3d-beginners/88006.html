<!DOCTYPE html><html lang="en" ><head ><title >Set window to taskbar?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Set window to taskbar?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Set window to taskbar?</a><br><br>
<a name="998739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all. How can I make it so that if I minimize my window it will become a taskbar icon?<br><br>can i see an example? <br><br></td></tr></table><br>
<a name="998846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You mean system tray, right? <br><br></td></tr></table><br>
<a name="998847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> yea. my bad <br><br></td></tr></table><br>
<a name="999068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJ00200</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is some stuff in the Code Archives, but the websites the files are hosted on are down.<br>If you find a way, I would like to know also. <br><br></td></tr></table><br>
<a name="999170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kevin's DLL is here:<br><a href="http://blitzmirror.ueuo.com/taskbar.zip" target="_blank">http://blitzmirror.ueuo.com/taskbar.zip</a> <br><br></td></tr></table><br>
<a name="999191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> link didnt work. <br><br></td></tr></table><br>
<a name="999197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> aye i get <pre class=code>http://e.freewebhostingarea.com/outside-access-blocked/insert-it-into-a-webpage-under-the-same-account.gif</pre> <br><br></td></tr></table><br>
<a name="999203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JA2</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm no example of how to use it either... <br><br></td></tr></table><br>
<a name="999204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you guys find the link yet? <br><br></td></tr></table><br>
<a name="999207"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JA2</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Did you guys find the link yet? <br></div><br>Yes, this is the link:<br><br><a href="http://blitzmirror.ueuo.com/taskbar.zip" target="_blank">http://blitzmirror.ueuo.com/taskbar.zip</a><br><br>It doesn't work tho... <br><br></td></tr></table><br>
<a name="999213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> If anyone else has the link, plz post it. <br><br></td></tr></table><br>
<a name="999228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok direct linking gives that gif url i posted<br>so i went to<br><a href="http://blitzmirror.ueuo.com/" target="_blank">http://blitzmirror.ueuo.com/</a><br>and then clicked the taskbar.zip and it downloaded<br>see also <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=959" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=959</a><br>although some of the comments seem to say it isnt compatible with b3d and only for blitz+<br>no idea if that is true or not though <br><br></td></tr></table><br>
<a name="1000261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> It uses B+ code for gadgets and such, so to use it in b3d you'd need some API dll calls, which I imagine defeat the object, since if you use the API Dlls, you should be able to do systray stuff anyway... <br><br></td></tr></table><br>
<a name="1000263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> i just want SOMETHING to work. I don't care HOW / what it works w/. <br><br></td></tr></table><br>
<a name="1000699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> i downloaded it from <a href="http://blitzmirror.ueuo.com/" target="_blank">http://blitzmirror.ueuo.com/</a> and test it under Vista Home Basic with no problems.<br>I was trying to code my own one, but thank's for that link!, for me is ok.<br><br>Juan <br><br></td></tr></table><br>
<a name="1001265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry to keep you waiting!<br><br>here a code that works in blitz3d:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;
; FILENAME: TaskBarTrayExample.bb
;		    Copyright 2003, Kevin Poole.
; 		                    
; modified by Charrua (jio@...): Juan Ignacio Odriozola
; using only one additional api call to hide/show the blitz window.
; and taskbar_dll.dll by Kevin Poole (kevin.poole@...)
;
;
; you need: TaskBar_Dll.Dll, TaskBar_Dll.decls
; and if you don't have one, create: user32.dels
; with:
;		.lib "user32.dll"
;		api_ShowWindow% (hwnd%, nCmdShow%) : "ShowWindow"


; these belong to .dll for using the tray icon.
Const NIM_ADD = $0
Const NIM_DELETE = $2
Const NIF_MESSAGE = $1
Const NIF_ICON = $2
Const NIF_TIP = $4


;api_ShowWindow params
Const SW_HIDE = 0
Const SW_SHOW = 5

;other constants that should be used by api_ShowWindow()
;Const SW_MAXIMIZE = 3
;Const SW_MINIMIZE = 6
;Const SW_RESTORE = 9
;Const SW_SHOWDEFAULT = 10
;Const SW_SHOWMAXIMIZED = 3
;Const SW_SHOWMINIMIZED = 2
;Const SW_SHOWMINNOACTIVE = 7
;Const SW_SHOWNA = 8
;Const SW_SHOWNOACTIVATE = 4
;Const SW_SHOWNORMAL = 1


Graphics 640,480,0,2

; when app in tray its set to 1.
Global IN_Tray=0

; the window's address.
Global hWnd
hwnd = SystemProperty("appHWND")	;handle to blitz window

; holds a bank containg the icons data.
Global IconData

; holds a bank for reiceving messeges from the taskbar icon.
Global Events=CreateBank(256)

; add a popup menu to the taskbar icon.
Add_Icon_Menu(1,"Show TaskBar Window")
Add_Icon_Menu(2,"Menu option 2")
; add a menu devide.
Add_Icon_Menu(0,"")
; add a popup menu to the taskbar icon.
Add_Icon_Menu(3,"Menu option 3")
Add_Icon_Menu(4,"Quit")


; to display when over sys icon.
Global tool_tip$="TaskBar Tray Example"+Chr$(0)
	
; the icon to display.
Global file_icon$="TaskBarTrayExample.ico"

Global Quit=False

Print "Hit F1 to minimize to Tray, F2 to quit "

While Not(Quit)

	If KeyHit(59) Then
		; hide the window.
		api_ShowWindow(hwnd,SW_HIDE)
		
		Add_Tray_Icon(tool_tip$,hwnd,file_icon$)
		Modify_Tray_Icon(NIM_ADD,"") 
		
		IN_Tray=1
		
		;sets focus on the taskbar
		FocusTaskBar(hwnd,0)
		; clear any old task tray icon events.
		PokeInt events,0,0
	Else
		If IN_Tray=1 Then
			sys_tray	;process taskbar events
		End If
	End If

	If KeyHit(60) Then
		Quit=True
	End If
	
Wend

DeleteIconMenu()

FlushKeys()
Print
Print "press any key to quit!"
WaitKey()

End


;
; wait for events from the taskbar.
;

Function sys_tray()

		
	; do we have any events.
	Action = PeekInt(events,0)
	
	Select Action
	
		Case 1 ; Icon left button double click.
			
			; set the status of the taskbar.
			IN_Tray=0
			
			; delete the icon from the taskbar tray.	
			Modify_Tray_Icon(NIM_DELETE,"")
			
			; show the window.	
			api_ShowWindow(hwnd,SW_SHOW)
			Print "double click"
									
			
		Case 2 ; Icon right click.

			MenuEvent = TaskBarMenuEvent(hWnd)
			Select MenuEvent

				Case 1 ; Show TaskBar Window.	
				
					; set the status of the taskbar.
					IN_Tray=0
					
					; delete the icon from the taskbar tray.	
					Modify_Tray_Icon(NIM_DELETE,"")

					; show the example window.
					api_ShowWindow(hwnd,SW_SHOW)
					Print "show window"

				Case 2 ; About TaskBar .dll.

					Print "Option 2 clicked!"
					FocusTaskBar(hWnd,0)
					
					
				Case 3 ; See TaskBar Commands.

					Print "Option 3 clicked!"
					FocusTaskBar(hWnd,0)
		
				Case 4 ; quit menu.
				
					
					Modify_Tray_Icon(NIM_DELETE,"")
					IN_Tray=0
					Quit=True
					api_ShowWindow(hwnd,SW_SHOW)
					Print "quit!"
				
			Default
				Print "MenuEvent rx: "+MenuEvent
				FocusTaskBar(hWnd,0)
			End Select
		
		Case 3,4,5,6,7 ; other menu events, that are not used.       
		
			Print "Event rx from the task bar: "+Action
			FocusTaskBar(hWnd,0)
			
	End Select
	
	; store taskbar icon event.	
	PokeInt events,0,TaskBarEvent(hWnd,0,0,0,0)
	

End Function

;this 3 functions unmodified

;
; add a menu items to the taskbar icon. 
;

Function Add_Icon_Menu(menuID,menuTXT$)

	menuTXT$=menuTXT$+Chr$(0)
	
	; add new menu item to taskbar icon.
	added=AddIconMenu(menuID,menuTXT$)

End Function

;
; used to modify the taskbar icon.
;

Function Modify_Tray_Icon(modify,new_tip$)

	; we want to modify the tool tip string data.
	If new_tip$&lt;&gt;"" Then
		
		; get the length of the tool tip.
		strlen = Len(new_tip$)
		
		; resize the bank to fit new tool tip.
		ResizeBank IconData,24+strLen
		
		; modify the tool tip text.
		For strlen=1 To Len(new_tip$)
			PokeByte IconData,24+strlen-1,Asc(Mid$(new_tip$,strlen,1))
		Next
		
	EndIf
	
	;modify the taskbar icon.
	taskbar=TaskBarIcon(modify, IconData)
	
End Function

; tool_tip$ - tool tip string.
; hWin      - the window that recives messages from the tray icon.
; icon$     - filename of icon to use.
	
Function Add_Tray_Icon(tip$,hWnd,icon$)

	; fill the bank up with taskbar tray icon details
	IconData=CreateBank(24+Len(tip$))
	PokeInt IconData,00,BankSize(IconData)
	PokeInt IconData,04,hWnd
	PokeInt IconData,08,1
	PokeInt IconData,12,NIF_ICON Or NIF_TIP Or NIF_MESSAGE 
	PokeInt IconData,16,100
	PokeInt IconData,20,LoadTaskIcon(hWnd,icon$,0)

	; now fill the rest with the tool tip text.
	For strlen=1 To Len(tip$)
		PokeByte IconData,24+strlen-1,Asc(Mid$(tip$,strlen,1))
	Next
		
End Function

</textarea><br><br>hope that helps<br><br>Juan <br><br></td></tr></table><br>
<a name="1001620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks juan <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
