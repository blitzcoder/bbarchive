<!DOCTYPE html><html lang="en" ><head ><title >video memory loss problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >video memory loss problem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >video memory loss problem</a><br><br>
<a name="475113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a way to recover video memory when hiding objects?<br><br>I have a 32MB Nvidia Riva graphics card.<br>After my game is loaded, I see that the available memory is 22MB.<br><br>When the player starts walking around in the game, the available memory drops down too 18MB as soon as the trees are drawn.<br><br>When the camera goes under water and starts drawing the fish, the available memory drops down to 16MB.<br><br>When I hide the all trees on the surface, the available memory stays at 16MB.<br><br>I've noticed that each time I show an object, the video memory gets lower and lower.<br>I assumed that the memory would get higher when I hide the objects. But it is not the case.<br><br>Anybody have any ideas?<br><br>Thanks<br>Conrad <br><br></td></tr></table><br>
<a name="475162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would assume that this is controlled automatically, so the oldest stuff that is not needed is deleted from the card to make room for new stuff. The more stuff that is left on the card the better because moving stuff to the card is slow.  Also, just because something is hidden in one frame does not mean it might not be shown again in the very next frame, so this sort of first in first out approach should really pay dividends performance wise. <br><br></td></tr></table><br>
<a name="475167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >767pilot</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> or you could just buy a new 256mb video card :) <br><br></td></tr></table><br>
<a name="475273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> AGP, Windows and Blitz3D manages your memory - don't worry. VRAM and AGP downloads and uploads textures and geometry all the time... but if you have some memory left there is no need to manage it. So basically if you don't use much big textures even 16meg will be okay. If you use constantly more VRAM than you have the AGP swapping will make things jerky and you need more of it to be able to play smoothly. Also note that higher screen resolutions will take bigger chunk of your VRAM permanently... I posted recently formulas how to calculate VRAM usage, it's here somewhere... <br><br></td></tr></table><br>
<a name="475307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackD</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah.. here: :)<br><br><a href="http://www.blitzbasic.co.nz/Community/posts.php?topic=24157" target="_blank">http://www.blitzbasic.co.nz/Community/posts.php?topic=24157</a><br><br>The best explanation I've seen yet.. In all my calc's I forgot about MIPs altogether. Nice one Mustang.<br><br>+BlackD <br><br></td></tr></table><br>
<a name="476761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for the useful info Mustang.<br><br>Looks like my game will not be playing on screen<br>cards with less than 32 MB. <br><br></td></tr></table><br>
<a name="477705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HappyCat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I'm seeing is with the code below, just intialising Graphics3D eats up 22Mb on my video card (it's a 128Mb). Is that normal? Seems a bit excessive - or is it just because the card has so much it takes a bigger chunk? I don't actually have any PCs with less than a 128 Mb graphics card to test it on.<br><pre class=code>
Start = AvailVidMem()
Print "Free = " + Start + " = " + Start / 1024 / 1024 + "Mb(ish)"
WaitKey()

Graphics3D 800, 600, 32, 2

Free = AvailVidMem()
Used = Start - Free
Text 0, 0, "Free = " + Free + " = " + Free / 1024 / 1024 + "Mb(ish)"
Text 0, 20, "Used = " + Used + " = " + Used / 1024 / 1024 + "Mb(ish)"

Flip

WaitKey()
End
</pre>I understand that Blitz tries it's best to manage gfx card memory useage when you load and use textures, but 22Mb before I do anything seems a bit excessive.<br><br>Edit: By my calculations it should be using 5760000 bytes or about 5.5 Mb (or is my maths crap?)<br><br>Edit: Should have said that the figures I get are:<br>Free = 121901056 = 116Mb(ish)<br>Hit a key and ...<br>Free = 97882112 = 93Mb(ish)<br>Used = 24018944 = 22Mb(ish) <br><br></td></tr></table><br>
<a name="477716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> My 64M graphics card shows about 4MB used, as expected.<br><br>Roughly: 600*800 = 'half a million'. Then 4 bytes per pixel and two buffers.<br><br>Why does yours show 22MB used? It's hard to say. I assume it's just the way the driver manages things. Maybe it allocates a block of memory to itself as a kind of graphics 'swap file'. <br><br></td></tr></table><br>
<a name="477754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HappyCat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, just tried on my other PC (has a 128Mb GeForce 4) and it says ~4Mb used. The other PC (the one I use for most of my development and the one that reported 22Mb used) has a 128Mb Intel thingy - you're right, must be drivers and not Blitz. Guess I'll do memory useage monitoring on the PC with the GeForce then  :-) <br><br></td></tr></table><br>
<a name="478149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Strider Centaur</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Happy Cat, maybe you have something else stored in VRAM from another application at the time, like virtual desktops, windows, etc, etc? <br><br></td></tr></table><br>
<a name="478162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HappyCat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking at the vid card properties (which lists memory used), before I run the above proggie, there's 11Mb used (presumably by desktop etc.), after there's 34Mb used. So it is Blitz - but as I said, it looks like it's the Intel drivers so I'm not terribly worried anymore. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
