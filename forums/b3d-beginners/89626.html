<!DOCTYPE html><html lang="en" ><head ><title >Vista, Windows 7 and even 64-bit OS (inc. XP)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Vista, Windows 7 and even 64-bit OS (inc. XP)</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Vista, Windows 7 and even 64-bit OS (inc. XP)</a><br><br>
<a name="1018176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please could you test this, and even if possibole, add insight if you know more about the issue:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2676" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2676</a> <br><br></td></tr></table><br>
<a name="1018187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> use the windows api MoveFile() it can be used to rename files also, requres two LPCTSTR param set them up as banks and pass them. MoveFile can be found in Kernel32.dll <br><br>kev <br><br></td></tr></table><br>
<a name="1018203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Kev I wanted to try and do something quick without invoking dll's though.<br>Still, setting up banks means that CallDll will work rather than needing to add decls. :) <br><br></td></tr></table><br>
<a name="1018208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Invoking a system DLL that is MADE to perform the job would be vastly preferable to trying to mickey-mouse something through an external command prompt, in my book... I mean, you're already seeing compatibility issues with the command prompt here.<br><br>Even if you get them squared away now, there's still a good chance that it will break again when Windows 8 comes around, and windows 9, and... <br><br>Using the proper Windows API instead greatly increases the chances that your programs continue to function properly in the long run. <br><br></td></tr></table><br>
<a name="1019700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see the sense in that ;)<br><br>I tried to write a decls to utilise the Windows api function, but I can't get it to work. I'm no good at this kinda stuff, so I'm not even sure where I'm going wrong...<br><br>Here's what I have so far:<br><br><pre class=code>
.Lib "Kernel32.dll"
Api_CopyFile%(lpExistingFileName$,lpNewFileName$,bFailIfExists%) : "CopyFile"
</pre><br><br>But I receive a "User lib function not found" error when I tery to use it:<br><br><pre class=code>Api_CopyFile%("C:\Program Files\Blitz3D\Bin\test.txt","test2.txt",1)</pre> <br><br></td></tr></table><br>
<a name="1019712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br>the correct sintax in the decls is:<br><br>api_CopyFile% (lpExistingFileName$, lpNewFileName$, bFailIfExists%) : "CopyFileA"<br><br>(pay attention at the end: "CopyFileA")<br><br>Juan <br><br></td></tr></table><br>
<a name="1019722"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Charrua that works fine :)<br><br>I was close ;) <br><br></td></tr></table><br>
<a name="1019724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> very,<br><br>many headaches wiht missmatching decls, when to include an asterisk?, when not?, when the "$"?, some times, (many) this is the only distance from a working code and a MAV.<br><br>Juan <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
