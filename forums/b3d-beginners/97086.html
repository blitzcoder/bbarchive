<!DOCTYPE html><html lang="en" ><head ><title >Help with enemy player detection?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Help with enemy player detection?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Help with enemy player detection?</a><br><br>
<a name="1125744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, Drak. I got a quick question for ya. Why is there only ONE circle showing up under the player, as opposed to 0 because i used hideentity to hide them until the player is close?<br><br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;Waypoint Example By Drak, 3/8/2010
;UPDATED 2/4/2012
;************************************************************
;THIS PROGRAM WILL:											*
;Create a player mesh (a square)							*
;Create some enemies (some spheres)							*
;Make on-the-fly waypoints for the enemies to return to		*
;Return the enemies to the waypoints						*
;Also shows some some rudimentary AI						*
;Shows some very simple particle effects as well			*
;************************************************************



;-------------------------------------------------------------------------------------------------------
;INITIALIZATION
;-------------------------------------------------------------------------------------------------------
Graphics3D 800,600,0,2
SetBuffer BackBuffer()
SeedRnd MilliSecs()

AmbientLight 255, 255, 255

Global type_player 	= 1
Global type_land 	= 2
Global type_obj 	= 3

Collisions type_player, type_land, 2, 3
Collisions type_player, type_obj, 2, 3
Collisions type_obj, type_obj, 2, 3
Collisions type_obj, type_land, 2,3

;WireFrame 1
Global player = LoadAnimMesh("models\dwarf1.b3d")	;create a cube for the player
EntityColor player, 0,0,200		;we'll make the player blue
ScaleEntity player, .1, .1, .1
EntityType player, type_player
PositionEntity player, 0,2,0

Global player_hp = 10			;give the player 10 hit points
Global player_alive = 1			;player is indeed alive

Global camera = CreateCamera()	;create a camera
CameraRange camera, .1, 999999999

Global sky = CreateCube()
ScaleEntity sky, 10000, 10000, 10000
EntityColor sky, 102, 102, 255
FlipMesh sky

Global Land = CreatePlane()
EntityColor Land, 0, 64, 0
EntityType Land, type_land

Global circle

;-------------------------------------------------------------------------------------------------------
;TYPES
;-------------------------------------------------------------------------------------------------------
Type enemy
	Field mesh				;will hold the actual mesh
	Field return_waypoint	;will hold the handle of the return waypoint
	Field status			;holds a # referring to the enemies status
	Field speed#			;this will hold the speed of the enemy
	Field timer				;2/3/12 This will be a counter
	Field timer_max			;2/3/12 This is the counter's maximum
	Field steer_angle#		;2/3/12 This holds the enemy's steering angle
End Type

Type particle				
	Field mesh				;holds mesh
	Field alpha#			;holds alpha
	Field speed_x#			;speed x
	Field speed_y#			;same
	Field speed_z#			;same...
	Field fade_speed#		;fade_speed
End Type

;-------------------------------------------------------------------------------------------------------
;LETS CREATE SOME PRIMITIVES TO USE LATER	
;-------------------------------------------------------------------------------------------------------

Global spark = CreateCube()
ScaleEntity spark, .25,.25,.25
EntityColor spark, 255,168,0
HideEntity spark

Global waypoint = CreateSphere()
ScaleEntity waypoint, .5,.5,.5
EntityColor waypoint, 0,200,0
HideEntity waypoint

;-------------------------------------------------------------------------------------------------------
;CREATE SOME ENEMIES
;-------------------------------------------------------------------------------------------------------
For num = 1 To 5
	e.enemy = New enemy				;new enemy
	e\mesh = LoadAnimMesh("models\dwarf1.b3d") ;CreateSphere(16)		;create a sphere and store it in e\mesh
	e\speed = .1					;set the speed of each enemy
	e\status = 1					;set status to 1
	e\timer = 0						;2/3/12	set timer to 0
	e\timer_max = Rand(400,1000)	;2/3/12	pick a maximum timer
	PositionEntity e\mesh, Rand(-20,20),1,Rand(-20,20)	;place the enemies randomly
	;EntityAlpha e\mesh, .5
	RotateEntity e\mesh, 0,Rand(360),0
	ScaleEntity e\mesh, .1, .1, .1
	EntityType e\mesh, type_obj
	circle = CreateSphere(16)
	ScaleEntity circle, 7, .01, 7
	HideEntity circle
Next

Global turnonanim = False

;-------------------------------------------------------------------------------------------------------
;MAIN LOOP
;-------------------------------------------------------------------------------------------------------
While Not KeyHit(1)
	
	
	
	For e.enemy = Each enemy
		PositionEntity circle, EntityX#(e\mesh, True), EntityY#(e\mesh, True), EntityZ#(e\mesh, True)
		If EntityDistance(player, e\mesh)&lt;=7 Then ShowEntity circle
		If turnonanim  = True Then Animate e\mesh, 1, .1, 1, 15
	Next
	SuperCam(camera,player,.02,200,4,0,0)
	
	;-------------------------------------------
	;This crap was screwing up the collisions:
	;py# = EntityY#(player, True)
	;DebugLog "py# = " + py
	;If py# &lt; 1.0 Then py# = 1.0
	;If py# &gt; 1.0 Then gravity# = gravity# - .1
	;PositionEntity player, EntityX#(player, True), py#+gravity#, EntityZ#(player, True)
	;-------------------------------------------
	
	;simple gravity:
	MoveEntity player , 0,-.1,0
	For e.enemy = Each enemy
		MoveEntity e\mesh, 0,-.1,0
	Next
	
	
	get_input()
	run_enemies()
	run_particles()
	check_hp()
	
	
	UpdateWorld
	RenderWorld
	
	gui()
	Flip
	
Wend
;-------------------------------------------------------------------------------------------------------
;END MAIN LOOP
;-------------------------------------------------------------------------------------------------------


;-------------------------------------------------------------------------------------------------------
;FUNCTION GET_INPUT &lt;--- GRABS INPUT FOR THE PLAYER
;-------------------------------------------------------------------------------------------------------
Function get_input()
	If player_alive = 1
		MoveEntity player, 0, 0, (KeyDown(17)-KeyDown(31) Or KeyDown(200)-KeyDown(208))*.5
		TurnEntity player, 0, (KeyDown(30)-KeyDown(32) Or KeyDown(203)-KeyDown(205))*1, 0
	End If 
End Function 


;-----------------------------------------------------------------------------------------------------
;FUNCTION RUN_ENEMIES   &lt;---EXOCUTES ACTIONS FOR EACH ENEMY
;-----------------------------------------------------------------------------------------------------
Function run_enemies()
	For e.enemy = Each enemy	;for each enemy
		;regardless of case, the distance to the player must be known, so we'll check it here
		
		Local dist# = EntityDistance(e\mesh,player)
		;This also tells you ALOT:
		DebugLog "e\status is " + e\status + " Dist is " + dist
		Select e\status			;select it's status
				
			Case 1 ;ON GUARD
				EntityColor e\mesh, 200,200,0
				If dist# &lt;= 10		;if the distance is less than 10 or equal to it
					If player_alive = 1
						e\status = 2	;switch to state 2
					End If
					Else e\timer = e\timer + 1
					If e\timer &gt;= e\timer_max
						e\status = 6 ;switch to quick wander
						e\timer = 0	 ;reset the timer to 0
					End If
				End If 
				;Animate e\mesh, 1, 1, 15, .1
				
			Case 2 ;DROP NEW WAYPOINT
				Local x# = EntityX(e\mesh)	;grab the enemies' coordinates
				Local y# = EntityY(e\mesh)
				Local z# = EntityZ(e\mesh)
				
						;place the waypoint at the location
				e\return_waypoint = CopyEntity(waypoint)
				PositionEntity e\return_waypoint,x#,y#,z#
				
				e\status = 3	;then switch to case 3, which is pursue
				
			Case 3 ;PURSUE THE PLAYER
				EntityColor e\mesh, 200,0,0	;red
				If dist# &lt; 1	;then attack!
					e\status = 4;change to attack
					Exit 		;exit the loop
				End If 
				
				If dist# &lt; 12	;first, check to see if we're 12 units away or less....
					PointEntity e\mesh, player		;point enemy at the player
					MoveEntity e\mesh, 0,0,e\speed	;then make the enemy move in the pointed direction
				Else
					e\status = 5	;set to status 5, which is return to waypoint
				End If 	
				
			Case 4 ;ATTACK
				player_hp = player_hp - 1	;take 1 hp from the player
				Local s_x# = EntityX(player)
				Local s_y# = EntityY(player)
				Local s_z# = EntityZ(player)
				Local num = Rand(3,8)
						;create some effects
				create_particles(num,s_x,s_y,s_z)
				e\status = 5				;now return to the waypoint
				
			Case 5	;RETURN TO WAYPOINT
				EntityColor e\mesh, 200,0,200
				Local dist_home# = EntityDistance(e\mesh,e\return_waypoint)	;get the distance home
				If dist_home# &gt; .2							;If we're further than .2 away...
					PointEntity e\mesh, e\return_waypoint	;point at home waypoint
					MoveEntity e\mesh, 0,0,e\speed			;move them forward
				Else If dist_home# &lt;= .2
					RotateEntity e\mesh, 0, 0, 0
					FreeEntity e\return_waypoint			;get rid of the waypoint mesh
					e\status = 1							;and return to idle again
				End If
				
				;CASE 6 ADDED ON 2/3/12
			Case 6	;WANDER
				EntityColor e\mesh, 0,200,0	;turn it green
						;KEEP THE WANDERING SIMPLE!!!! DON'T OVERCOMPLICATE THIS!!!!!
				
				e\timer = e\timer + 1
				If e\timer &lt;= e\timer_max
					e\steer_angle = e\steer_angle + Rnd(-.1,.1)
					If e\steer_angle &gt; 1 Then e\steer_angle = 1
					If e\steer_angle &lt; -1 Then e\steer_angle = -1
					TurnEntity e\mesh, 0,e\steer_angle,0
					MoveEntity e\mesh, 0,0,e\speed/5
				Else 
					e\timer = 0
					RotateEntity e\mesh, 0,Rand(360),0
					e\status = 1
				End If 
				
					;keep checking to see if the player is close enough to follow
				If dist# &lt;= 10		;if the distance is less than 10 or equal to it
					If player_alive = 1
						e\status = 2	;switch to state 2
					End If
				End If 
				
				
			Default
				e\status = 1	;if somehow e\status = anything else, we'll set it to 1
				
				
		End Select
	Next
End Function 

;-----------------------------------------------------------------------------------------------------
;GRAPHIC READOUTS   &lt;---This function prints readouts to the screen
;-----------------------------------------------------------------------------------------------------
Function gui()
	Text 0,0, "Use WASD keys to move around."
	Text 0,10,"Don't let the spheres touch you or you'll lose hitpoints."
	Text 0,20,"Remaining HP: " + player_hp
	
	If player_alive = 0
		Text 350,290,"You are DEAD!"
	End If 
End Function 


;-----------------------------------------------------------------------------------------------------
;RUN PARTICLES	   &lt;---This function runs the particles if there are any
;-----------------------------------------------------------------------------------------------------
Function run_particles()
	For p.particle = Each particle
		p\alpha = p\alpha - p\fade_speed	;take fade speed from alpha
		EntityAlpha p\mesh, p\alpha			;set alpha to p\alpha
		If p\alpha &lt;= 0					;if alpha is &lt;= 0
			FreeEntity p\mesh			;free it
			Delete p				
			Exit						;exit the loop
		Else
			p\speed_y = p\speed_y - .01							;subtract from y speed
			MoveEntity p\mesh, p\speed_x, p\speed_y,p\speed_z	;move the particle
		End If
		
		
	Next
End Function  


;-----------------------------------------------------------------------------------------------------
;CREATE PARTICLES	&lt;--- THis is called when we need to create particles
;-----------------------------------------------------------------------------------------------------
Function create_particles(num,x#,y#,z#)
	For s = 1 To num
		p.particle = New particle
		p\mesh = CopyEntity(spark)
		p\speed_x# = Rnd(-.2,.2)
		p\speed_y# = Rnd(.3)
		p\speed_z# = Rnd(-.2,.2)
		p\alpha = 1
		p\fade_speed# = Rnd(.1)
		PositionEntity p\mesh, x,y,z
	Next
End Function 

;-----------------------------------------------------------------------------------------------------
;CHECK HP	&lt;---This checks the player's HEALTH each frame
;-----------------------------------------------------------------------------------------------------
Function check_hp()
	If player_hp &lt;= 0
		player_hp = 0
		If player_alive = 1
			Local s_x# = EntityX(player)
			Local s_y# = EntityY(player)
			Local s_z# = EntityZ(player)
			Local num = Rand(15)
		;create some effects
			create_particles(num,s_x,s_y,s_z)
			player_alive = 0
		End If
	End If 
End Function 



Function SuperCam(cam,ent,cspeed#,dist#,hite#,xrot#,tilt#)
	
	TFormPoint 0,hite#,-dist#,ent,0
	
	cx#=(TFormedX()-EntityX(cam))*cspeed#
	cy#=(TFormedY()-EntityY(cam))*cspeed#
	cz#=(TFormedZ()-EntityZ(cam))*cspeed#
	
	TranslateEntity cam,cx,cy,cz
	PointEntity cam,ent
	RotateEntity cam,xrot#,EntityYaw(cam),tilt#
	
End Function
;~IDEal Editor Parameters:
;~C#Blitz3D</textarea><br><br><br><br>U will need the media i sent u :)<br><br><br><br>Thanks, Drak <br><br></td></tr></table><br>
<a name="1125757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jack</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> jeez,,,,,,,,,,,,,,,,,,,,, <br><br></td></tr></table><br>
<a name="1125764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ignoring that last person, can u please help me with this, Drak? :) <br><br></td></tr></table><br>
<a name="1125789"></a>

<a name="1125790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason you get replies like that is because you abuse the forum for help beyond the norm.<br><br>Typically a user will ask for clarification on basic commands or concepts, you on the other hand post massive code blocks or entire programs and ask someone to "fix it" for you. Once in awhile, people probably would not pay any attention but you chronically ask people to sift through all your code and make your changes and fixes for you, and when they finally do you just add another fix for them to the list and keep going This makes you appear very juvenile and lazy.<br><br>Good luck<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't believe I was talking to u, tyvm. :) <br><br></td></tr></table><br>
<a name="1125808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, I am not aware of him posting in any of your recent threads (without looking myself), but he is vocalising what many others here have belived for some time.<br><br><div class="quote"> Hi, Drak. I got a quick question for ya. Why is there only ONE circle showing up under the player, as opposed to 0 because i used hideentity to hide them until the player is close?<br><br>U will need the media i sent u :)<br><br>Thanks, Drak <br></div><br><br>basically you have singled out Drak as your code saviour of the week, you could have worded that generically and linked to the media in question, probably the same media from the other thread.<br><br>But no, you chose to address it to Drak and Drak alone, that alone would have me running for the hills if I were him.<br><br>Anyone else wanting to help would go "where is the media?" not knowing if it is genuinly the media from the other thread and think, well eff it, not much to do without that now is there? <br><br></td></tr></table><br>
<a name="1125811"></a>

<a name="1125812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fine... -.- HERE is the media.<br><br><br><a href="http://www.mediafire.com/?do051b8fw2h5tyj" target="_blank">http://www.mediafire.com/?do051b8fw2h5tyj</a><br><br><br>Anything else, my queen? -.-<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes its Queen not queen, now run allong <br><br></td></tr></table><br>
<a name="1125815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> HAHAHAHA! XD <br><br></td></tr></table><br>
<a name="1125816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyway, lets try to keep this conversation on topic, ppl.<br><br><br>Thank you. <br><br></td></tr></table><br>
<a name="1125841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Hi, Drak. I got a quick question for ya. Why is there only ONE circle showing up under the player, as opposed to 0 because i used hideentity to hide them until the player is close?<br><br> <br></div><br>3 hous later:<br><div class="quote"> <br>Ignoring that last person, can u please help me with this, Drak? :) <br><br> <br></div><br>Christ man, I have a job during the day.  I'm not waiting in the Blitz3D forums all day waiting to help people.  I do coding voluntarily and I help voluntarily.  This is not a personal forum so please don't single people out unless you have a specific question about code they have written.  The code you are using was based off of mine, yes, but I have no idea what your question is about because it's about code you added to it.<br><br>Now, do some problem solving.  Just remember, there are no glitches, errors,etc.  Code only does EXACTLY what you tell it to do.<br><br>AND I don't understand your original question either.<br><div class="quote"> <br>Why is there only ONE circle showing up under the player, as opposed to 0 <br> <br></div><br>That question makes no sense.  "Only ONE" implies there should be more, but it's also opposed to 0?  <b>Non sequitur.</b> <br><br></td></tr></table><br>
<a name="1125842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes. There is only 1 circle, when there should be 1 under EACH dwarf. it is gonna be used as a better enemy AI detection :) <br><br></td></tr></table><br>
<a name="1125847"></a>

<a name="1125848"></a>

<a name="1125849"></a>

<a name="1125850"></a>

<a name="1125852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dude read your code.  It's blatently apparent why that's happening.  Like I stated earlier:<br><br><div class="quote"> <br>Now, do some problem solving. Just remember, there are no glitches, errors,etc. Code only does EXACTLY what you tell it to do.<br><br> <br></div><br>You can't create a variable named "circle" 5 times.  You can't access the first 4 then.<br><br>This is what you're doing:<br>I'm making a sphere and I'm naming it "Circle" and hiding it.<br>I'm making a second sphere and I'm naming this one "Circle" and hiding it. The previous sphere will have no name now.<br>I'm making a third sphere and I'm naming this one "Circle" and hiding it. The previous sphere will have no name now.<br>I'm making a fourth sphere and I'm naming this one "Circle" and hiding it.The previous sphere will have no name now.<br>I'm making a fifth sphere and I'm naming this one "Circle" and hiding it.  The previous sphere will have no name now.<br><br><br>Where's my sphere named "Circle"?  Oh it's right here but I can't find the first four because they don't have names anymore.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexus6</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Drak,<br><br>Im trying to make a Call of Duty style game, ive got most of it coded (see below) can you fill in the missing bits please. <br><br>Thanks Drak<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;Call of Duty beater Copyright Nexus6 2012
;with a little bit of help from Drak
Graphics3D 800,600,0,2
While Not KeyHit(1)
;
;
;
;
;
;
;
Wend
</textarea> <br><br></td></tr></table><br>
<a name="1125962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nexus, stop hijacking my thread u jerk! :&lt; <br><br></td></tr></table><br>
<a name="1125969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexus6</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol :) <br><br></td></tr></table><br>
<a name="1126246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updating Code, as u now use the Restore command to place their waypoints: <br><br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;Waypoint Example By Drak, 3/8/2010
;UPDATED 2/4/2012
;************************************************************
;THIS PROGRAM WILL:											*
;Create a player mesh (a square)							*
;Create some enemies (some spheres)							*
;Make on-the-fly waypoints for the enemies to return to		*
;Return the enemies to the waypoints						*
;Also shows some some rudimentary AI						*
;Shows some very simple particle effects as well			*
;************************************************************



;-------------------------------------------------------------------------------------------------------
;INITIALIZATION
;-------------------------------------------------------------------------------------------------------
Graphics3D 800,600,0,2
SetBuffer BackBuffer()
SeedRnd MilliSecs()

AmbientLight 255, 255, 255

Global type_player 	= 1
Global type_land 	= 2
Global type_obj 	= 3

Collisions type_player, type_land, 2, 3
Collisions type_player, type_obj, 2, 3
Collisions type_obj, type_obj, 2, 3
Collisions type_obj, type_land, 2,3

;WireFrame 1
Global player = LoadAnimMesh("models\dwarf1.b3d")	;create a cube for the player
EntityColor player, 0,0,200		;we'll make the player blue
ScaleEntity player, .1, .1, .1
EntityType player, type_player
PositionEntity player, 0,2,0

Global player_hp = 10			;give the player 10 hit points
Global player_alive = 1			;player is indeed alive

Global camera = CreateCamera()	;create a camera
CameraRange camera, .1, 999999999

Global sky = CreateCube()
ScaleEntity sky, 10000, 10000, 10000
EntityColor sky, 102, 102, 255
FlipMesh sky

Global Land = CreatePlane()
EntityColor Land, 0, 64, 0
EntityType Land, type_land

Global circle

;-------------------------------------------------------------------------------------------------------
;TYPES
;-------------------------------------------------------------------------------------------------------
Type enemy
	Field mesh				;will hold the actual mesh
	Field return_waypoint	;will hold the handle of the return waypoint
	Field status			;holds a # referring to the enemies status
	Field speed#			;this will hold the speed of the enemy
	Field timer				;2/3/12 This will be a counter
	Field timer_max			;2/3/12 This is the counter's maximum
	Field steer_angle#		;2/3/12 This holds the enemy's steering angle
End Type

Type particle				
	Field mesh				;holds mesh
	Field alpha#			;holds alpha
	Field speed_x#			;speed x
	Field speed_y#			;same
	Field speed_z#			;same...
	Field fade_speed#		;fade_speed
End Type

;-------------------------------------------------------------------------------------------------------
;LETS CREATE SOME PRIMITIVES TO USE LATER	
;-------------------------------------------------------------------------------------------------------

Global spark = CreateCube()
ScaleEntity spark, .25,.25,.25
EntityColor spark, 255,168,0
HideEntity spark

Global waypoint = CreateSphere()
ScaleEntity waypoint, .5,.5,.5
EntityColor waypoint, 0,200,0
HideEntity waypoint

;-------------------------------------------------------------------------------------------------------
;CREATE SOME ENEMIES
;-------------------------------------------------------------------------------------------------------
Restore waypointdata
circle = CreateSphere(16)
For num = 1 To 5
	e.enemy = New enemy				;new enemy
	e\mesh = LoadAnimMesh("models\dwarf1.b3d") ;CreateSphere(16)		;create a sphere and store it in e\mesh
	e\speed = .1					;set the speed of each enemy
	e\status = 1					;set status to 1
	e\timer = 0						;2/3/12	set timer to 0
	e\timer_max = Rand(400,1000)	;2/3/12	pick a maximum timer
	Read pxpos#
	Read pypos#
	Read pzpos#
	PositionEntity e\mesh, pxpos#, pypos#, pzpos#	;place the enemies randomly
	RotateEntity e\mesh, 0,Rand(360),0
	ScaleEntity e\mesh, .1, .1, .1
	EntityType e\mesh, type_obj
	circle2 = CopyEntity(circle)
	ScaleEntity circle2, 7, .01, 7
	EntityParent circle2, e\mesh
	HideEntity circle2
Next

Global turnonanim = False

;-------------------------------------------------------------------------------------------------------
;MAIN LOOP
;-------------------------------------------------------------------------------------------------------
While Not KeyHit(1)
	
	
	
	For e.enemy = Each enemy
		PositionEntity circle, EntityX#(e\mesh, True), EntityY#(e\mesh, True), EntityZ#(e\mesh, True)
		If EntityDistance(player, e\mesh)&lt;=7 Then ShowEntity circle
		If turnonanim  = True Then Animate e\mesh, 1, .1, 1, 15
	Next
	
	
	
	
	
	
	
	
	
	SuperCam(camera,player,.02,200,4,0,0)
	
	
	
	
	
	
	;simple gravity:
	MoveEntity player , 0,-.1,0
	For e.enemy = Each enemy
		MoveEntity e\mesh, 0,-.1,0
	Next
	
	
	get_input()
	run_enemies()
	run_particles()
	check_hp()
	
	
	UpdateWorld
	RenderWorld
	
	gui()
	Flip
	
Wend
;-------------------------------------------------------------------------------------------------------
;END MAIN LOOP
;-------------------------------------------------------------------------------------------------------


;-------------------------------------------------------------------------------------------------------
;FUNCTION GET_INPUT &lt;--- GRABS INPUT FOR THE PLAYER
;-------------------------------------------------------------------------------------------------------
Function get_input()
	If player_alive = 1
		MoveEntity player, 0, 0, (KeyDown(17)-KeyDown(31) Or KeyDown(200)-KeyDown(208))*.5
		TurnEntity player, 0, (KeyDown(30)-KeyDown(32) Or KeyDown(203)-KeyDown(205))*1, 0
	End If 
End Function 


;-----------------------------------------------------------------------------------------------------
;FUNCTION RUN_ENEMIES   &lt;---EXOCUTES ACTIONS FOR EACH ENEMY
;-----------------------------------------------------------------------------------------------------
Function run_enemies()
	For e.enemy = Each enemy	;for each enemy
		;regardless of case, the distance to the player must be known, so we'll check it here
		
		Local dist# = EntityDistance(e\mesh,player)
		;This also tells you ALOT:
		DebugLog "e\status is " + e\status + " Dist is " + dist
		Select e\status			;select it's status
				
			Case 1 ;ON GUARD
				EntityColor e\mesh, 200,200,0
				If dist# &lt;= 10		;if the distance is less than 10 or equal to it
					If player_alive = 1
						e\status = 2	;switch to state 2
					End If
					Else e\timer = e\timer + 1
					If e\timer &gt;= e\timer_max
						e\status = 6 ;switch to quick wander
						e\timer = 0	 ;reset the timer to 0
					End If
				End If 
				;Animate e\mesh, 1, 1, 15, .1
				
			Case 2 ;DROP NEW WAYPOINT
				Local x# = EntityX(e\mesh)	;grab the enemies' coordinates
				Local y# = EntityY(e\mesh)
				Local z# = EntityZ(e\mesh)
				
						;place the waypoint at the location
				e\return_waypoint = CopyEntity(waypoint)
				PositionEntity e\return_waypoint,x#,y#,z#
				
				e\status = 3	;then switch to case 3, which is pursue
				
			Case 3 ;PURSUE THE PLAYER
				EntityColor e\mesh, 200,0,0	;red
				If dist# &lt; 1	;then attack!
					e\status = 4;change to attack
					Exit 		;exit the loop
				End If 
				
				If dist# &lt; 12	;first, check to see if we're 12 units away or less....
					PointEntity e\mesh, player		;point enemy at the player
					MoveEntity e\mesh, 0,0,e\speed	;then make the enemy move in the pointed direction
				Else
					e\status = 5	;set to status 5, which is return to waypoint
				End If 	
				
			Case 4 ;ATTACK
				player_hp = player_hp - 1	;take 1 hp from the player
				Local s_x# = EntityX(player)
				Local s_y# = EntityY(player)
				Local s_z# = EntityZ(player)
				Local num = Rand(3,8)
						;create some effects
				create_particles(num,s_x,s_y,s_z)
				e\status = 5				;now return to the waypoint
				
			Case 5	;RETURN TO WAYPOINT
				EntityColor e\mesh, 200,0,200
				Local dist_home# = EntityDistance(e\mesh,e\return_waypoint)	;get the distance home
				If dist_home# &gt; .2							;If we're further than .2 away...
					PointEntity e\mesh, e\return_waypoint	;point at home waypoint
					MoveEntity e\mesh, 0,0,e\speed			;move them forward
				Else If dist_home# &lt;= .2
					RotateEntity e\mesh, 0, 0, 0
					FreeEntity e\return_waypoint			;get rid of the waypoint mesh
					e\status = 1							;and return to idle again
				End If
				
				;CASE 6 ADDED ON 2/3/12
			Case 6	;WANDER
				EntityColor e\mesh, 0,200,0	;turn it green
						;KEEP THE WANDERING SIMPLE!!!! DON'T OVERCOMPLICATE THIS!!!!!
				
				e\timer = e\timer + 1
				If e\timer &lt;= e\timer_max
					e\steer_angle = e\steer_angle + Rnd(-.1,.1)
					If e\steer_angle &gt; 1 Then e\steer_angle = 1
					If e\steer_angle &lt; -1 Then e\steer_angle = -1
					TurnEntity e\mesh, 0,e\steer_angle,0
					MoveEntity e\mesh, 0,0,e\speed/5
				Else 
					e\timer = 0
					RotateEntity e\mesh, 0,Rand(360),0
					e\status = 1
				End If 
				
					;keep checking to see if the player is close enough to follow
				If dist# &lt;= 10		;if the distance is less than 10 or equal to it
					If player_alive = 1
						e\status = 2	;switch to state 2
					End If
				End If 
				
				
			Default
				e\status = 1	;if somehow e\status = anything else, we'll set it to 1
				
				
		End Select
	Next
End Function 

;-----------------------------------------------------------------------------------------------------
;GRAPHIC READOUTS   &lt;---This function prints readouts to the screen
;-----------------------------------------------------------------------------------------------------
Function gui()
	Text 0,0, "Use WASD keys to move around."
	Text 0,10,"Don't let the spheres touch you or you'll lose hitpoints."
	Text 0,20,"Remaining HP: " + player_hp
	
	If player_alive = 0
		Text 350,290,"You are DEAD!"
	End If 
End Function 


;-----------------------------------------------------------------------------------------------------
;RUN PARTICLES	   &lt;---This function runs the particles if there are any
;-----------------------------------------------------------------------------------------------------
Function run_particles()
	For p.particle = Each particle
		p\alpha = p\alpha - p\fade_speed	;take fade speed from alpha
		EntityAlpha p\mesh, p\alpha			;set alpha to p\alpha
		If p\alpha &lt;= 0					;if alpha is &lt;= 0
			FreeEntity p\mesh			;free it
			Delete p				
			Exit						;exit the loop
		Else
			p\speed_y = p\speed_y - .01							;subtract from y speed
			MoveEntity p\mesh, p\speed_x, p\speed_y,p\speed_z	;move the particle
		End If
		
		
	Next
End Function  


;-----------------------------------------------------------------------------------------------------
;CREATE PARTICLES	&lt;--- THis is called when we need to create particles
;-----------------------------------------------------------------------------------------------------
Function create_particles(num,x#,y#,z#)
	For s = 1 To num
		p.particle = New particle
		p\mesh = CopyEntity(spark)
		p\speed_x# = Rnd(-.2,.2)
		p\speed_y# = Rnd(.3)
		p\speed_z# = Rnd(-.2,.2)
		p\alpha = 1
		p\fade_speed# = Rnd(.1)
		PositionEntity p\mesh, x,y,z
	Next
End Function 

;-----------------------------------------------------------------------------------------------------
;CHECK HP	&lt;---This checks the player's HEALTH each frame
;-----------------------------------------------------------------------------------------------------
Function check_hp()
	If player_hp &lt;= 0
		player_hp = 0
		If player_alive = 1
			Local s_x# = EntityX(player)
			Local s_y# = EntityY(player)
			Local s_z# = EntityZ(player)
			Local num = Rand(15)
		;create some effects
			create_particles(num,s_x,s_y,s_z)
			player_alive = 0
		End If
	End If 
End Function 



Function SuperCam(cam,ent,cspeed#,dist#,hite#,xrot#,tilt#)
	
	TFormPoint 0,hite#,-dist#,ent,0
	
	cx#=(TFormedX()-EntityX(cam))*cspeed#
	cy#=(TFormedY()-EntityY(cam))*cspeed#
	cz#=(TFormedZ()-EntityZ(cam))*cspeed#
	
	TranslateEntity cam,cx,cy,cz
	PointEntity cam,ent
	RotateEntity cam,xrot#,EntityYaw(cam),tilt#
	
End Function




.waypointdata
Data 20.0, 1.0, 10.0
Data 40.0, 1.0, 10.0
Data 60.0, 1.0, 10.0
Data 80.0, 1.0, 10.0
Data 100.0, 1.0, 10.0
;~IDEal Editor Parameters:
;~C#Blitz3D</textarea><br><br><br><br>Ok, still having the same problem with circle. <br><br></td></tr></table><br>
<a name="1126262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Drak said from upon high<br><div class="quote"> You can't create a variable named "circle" 5 times. You can't access the first 4 then.<br><br>This is what you're doing:<br>I'm making a sphere and I'm naming it "Circle" and hiding it.<br>I'm making a second sphere and I'm naming this one "Circle" and hiding it. The previous sphere will have no name now.<br>I'm making a third sphere and I'm naming this one "Circle" and hiding it. The previous sphere will have no name now.<br>I'm making a fourth sphere and I'm naming this one "Circle" and hiding it.The previous sphere will have no name now.<br>I'm making a fifth sphere and I'm naming this one "Circle" and hiding it. The previous sphere will have no name now.<br><br><br>Where's my sphere named "Circle"? Oh it's right here but I can't find the first four because they don't have names anymore.<br> <br></div> <br><br></td></tr></table><br>
<a name="1126265"></a>

<a name="1126267"></a>

<a name="1126325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem now is the circle2 variable is being overwritten. You have created a circle(sphere) and are copying in into circle2. Circle2 now holds a copy of the circle. Then you loop through again and copy circle into circle2, losing your last reference to circle2.<br><br>I don't think you understand types very well. If you want to store the circle with each type object, you'll have to assign a field for it.<br><br>Why not just turn round and say,<br><br>"Look guys, I don't understand how types work. I've made an ass of something."<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1126298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Instead of being a smart ***, u could have just said, "use a type for the circle".... jesus... -.- <br><br></td></tr></table><br>
<a name="1126301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you're not willing to even try to learn or understand what you're doing wrong, that's all you can expect.<br><br>That's also not what he said, and not the answer to your problem. <br><br></td></tr></table><br>
<a name="1126311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I already know how to do types.... -.- <br><br></td></tr></table><br>
<a name="1126312"></a>

<a name="1126331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> You really need to learn basic coding concepts before trying to tackle a complete program project.  Start with "hello world" and work your way up.  Im sure some blitzers can recommend a book or two, theres even a book made for learning Blitz3D.<br><br><br>Im not saying to be rude, but most coding forums assume you have the fundamental understanding of coding basics to at least read and understand step by step instructions that may be given to you, you lack these fundamental understandings in many cases to follow the instructions given here, and so you ask and ask until the code is made for you and handed over in a plug and play , work out of the box fashion.<br><br>It may be helpful to check out books that cover these basics, such as variable assignment, and stuff like that.  A real life tutor or class might be very helpful as well, these forums as helpful as they  will never pass for a tutor or teacher.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1126324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I already know how to do types.... -.- <br> <br></div><br>But if you did, you would know how to <b>add</b> a field to hold that circle mesh to that enemy Type.  That's all you need to do. <br><br></td></tr></table><br>
<a name="1126326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Instead of being a smart ***, u could have just said, "use a type for the circle".... jesus... -.-<br> <br></div><br><br>One of us has to... <br><br></td></tr></table><br>
<a name="1126327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why does anybody still bother to try to help this guy?? <br><br></td></tr></table><br>
<a name="1126335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good question... <br><br></td></tr></table><br>
<a name="1126350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Why does anybody still bother to try to help this guy?? <br><br> <br></div><br><br>I'm not giving him any more code, only explanations because he obviously doesn't even read or understand how the code works.  I enjoy helping people learn, but as he doesn't seem to actually <i>learn </i> much. <br><br></td></tr></table><br>
<a name="1126353"></a>

<a name="1126354"></a>

<a name="1126364"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> LOL Nexus6<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
