<!DOCTYPE html><html lang="en" ><head ><title >Scrolling map works up and down but not left and right! ???</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Scrolling map works up and down but not left and right! ???</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Scrolling map works up and down but not left and right! ???</a><br><br>
<a name="214660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uraliss</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi folks,<br>I am working on some code that loads in a level of map tiles and scrolls one block at a time using the arrow keys. Thing is... i cant get left and right to scroll correctly, all the tiles are jumbled up - rather than scrolling they appear random.<br><br>Any help would be appreciated. <br>heres the code:<br><br><br>global tileset<br>global locationx<br>global locationy<br>locationx=100 : locationy=100<br>dim tile_position_array(500,500)<br><br>;### Load in Level<br>myfile = ReadFile("D:\Projects\Learning\Level1.dat")<br>For i = 0 to 500<br>	For j = 0 to 500<br>		Tile_Position_Array(i,j) = ReadByte (myfile)<br>Next<br>Next<br>Closefile myfile<br><br>graphics 1024,768,32,1<br>setbuffer backbuffer()<br>tileset=LoadanimImage("d:\projects\game graphics\tileset2.bmp",64,64,0,50)<br><br>while not keyhit(1)<br>a=0<br>b=0<br>for x=0 to 1024 step 64<br>for y=0 to 768 step 64<br>bob = Tile_Position_Array(locationx +a,locationy +b)<br>drawimage tileset,x,y,bob<br>a=a+1<br>next<br>b=b+1<br>next<br>flip<br>if locationx&lt;500 and keyhit(208) then locationx=locationx+1<br>if locationx&gt;0 and keyhit(200) then locationx=locationx-1<br>if locationy&lt;500 and keyhit(205) then locationy=locationy+1<br>if locationy&gt;0 and keyhit(203) then locationy=locationy-1<br><br>wend <br><br></td></tr></table><br>
<a name="214673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >QuietBloke</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Having a quick look at your code I see something that doesnt quite look right. In the loops to draw the tiles you are incrementing a in the innner y loop and b in the outer x loop but you are using them the other way around then using the Thle_Position_array. So if you swap the lines a=a+1 and b=b+1 over. You should also be reseting the b variable at the start of the y loop.<br><br>I think your code should be something like :<br><br>a=0 <br>for x=0 to 1024 step 64 <br> b=0 <br> for y=0 to 768 step 64 <br>  bob = Tile_Position_Array(locationx +a,locationy +b) <br>  drawimage tileset,x,y,bob <br>  b=b+1 <br> next <br> a=a+1<br>next <br><br></td></tr></table><br>
<a name="214677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uraliss</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well That now works!<br>Thanks John.<br><br>I dont quite understand what i was doing wrong and my head is really fried trying to grasp this problem for a few hours!<br><br>Wait - i think i got it now.<br>Many thanks! <br><br></td></tr></table><br>
<a name="214718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >QuietBloke</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im glad to hear that fixed it for you.<br>Feel free to ask if you are still not sure about why the new code now works. <br><br></td></tr></table><br>
<a name="214840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uraliss</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks John<br>my next task (now that I kind of understand whats going on) is to work out how to make it scroll smoothly as opposed to block scrolling as it does now.<br><br>My initial idea on this one is to have some kind of offset value and use origin.<br><br>Any thoughts? <br><br></td></tr></table><br>
<a name="214901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >QuietBloke</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes.. that is just how I would do it. store a locationXOffset, locationYOffset.<br><br>Then when checking for the keypresses add/subtract values from the offset values.<br><br>Then add some code to check the offset values to decide if the locationX, locationY values need to be changed.<br><br>eg.<br><br>if locationXOffset &lt; 0 then<br> locationXOffset = locationXOffset + 64<br> locationX = locationX - 1<br>end if<br><br>if locationXOffset &gt; 63 then<br> locationXOffset = locationXOffset - 64<br> locationX = locationX + 1<br>end if<br> <br>and the same from the y values.<br><br>If you are wondering why I am checking for &lt; 0 and adding 64 or checking for &gt; 63 and subtracting 64 I have found its a nice way to cater for various speeds of scrolling.<br>That code will work even if you move 2,3,4 + pixels at a time up to a maximum of a full tile size. <br><br></td></tr></table><br>
<a name="214908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uraliss</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks John<br>Will check this out.<br>Im starting to learn this stuff at last! <br><br></td></tr></table><br>
<a name="214926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uraliss</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks to John (QuietBloke) I have created my first scrolling tilemap program!!!<br><br>Woohoo! The code is a bit rough and ready at the moment and it needs some checks putting in so that it cannot scroll out of the map area but appart from that I am well chuffed.<br>I am looking at using it for a Rebelstar Raiders game on the old speccy!<br><br>Anyway, heres the code:<br>______________________________________________________<br><br><br><br>;### Initialisation of Variables<br>global tileset<br>global locationx<br>global locationy<br>global locationxoffset<br>Global locationyoffset<br>dim tile_position_array(500,500)<br>locationxoffset=0<br>locationyoffset=0<br>locationx=100<br>locationy=100<br><br>;### Load in level data from a dat file created earlier<br>myfile = ReadFile("D:\Projects\Learning\Level1.dat")<br>For i = 0 to 500<br>For j = 0 to 500<br>Tile_Position_Array(i,j) = ReadByte (myfile)<br>Next<br>Next<br>Closefile myfile<br><br>;### Initialise Screen and load in tileset created earlier<br>graphics 1024,768,32,1<br>setbuffer backbuffer()<br>tileset=LoadanimImage("d:\projects\game graphics\tileset2.bmp",64,64,0,50)<br><br>;### Main program loop<br>while not keyhit(1)<br><br>;### calculate screen offset for initial placement of tiles<br>if locationXOffset &lt; 0 then<br>locationXOffset = locationXOffset + 64<br>locationX = locationX + 1<br>end if<br><br>if locationXOffset &gt; 63 then<br>locationXOffset = locationXOffset - 64<br>locationX = locationX - 1<br>end if<br><br>if locationyOffset &lt; 0 then<br>locationyOffset = locationyOffset + 64<br>locationy = locationy + 1<br>end if<br><br>if locationyOffset &gt; 63 then<br>locationyOffset = locationyOffset - 64<br>locationy = locationy - 1<br>end if<br><br><br>;### Display tiles from calculated offset using origin command<br>origin locationxoffset,locationyoffset<br>a=0<br>for x=-64 to 1024 step 64<br>b=0<br>for y=-64 to 768 step 64<br>bob = Tile_Position_Array(locationx +a,locationy +b)<br>drawimage tileset,x,y,bob<br>b=b+1<br>next<br>a=a+1<br>next<br><br>;### Just in case... reset the origin to 0,0<br>origin 0,0<br><br>;### Bring created screen to the front<br>flip<br><br>;### Process Inputs and continue looping<br>if locationy&lt;500 and keydown(208) then locationyoffset=locationyoffset+8<br>if locationy&gt;0 and keydown(200) then locationyoffset=locationyoffset-8<br>if locationx&lt;500 and keydown(205) then locationxoffset=locationxoffset+8<br>if locationx&gt;0 and keydown(203) then locationxoffset=locationxoffset-8<br>wend <br><br></td></tr></table><br>
<a name="214928"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uraliss</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I forgot to mention that you will obviously need the tileset2.bmp and the level1.dat files to get this working - email me on uraliss@... if you need these. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
