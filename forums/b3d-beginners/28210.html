<!DOCTYPE html><html lang="en" ><head ><title >Visual Basic DLL- It Does  Work</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Visual Basic DLL- It Does  Work</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Visual Basic DLL- It Does  Work</a><br><br>
<a name="296506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am Including an Email I sent to Sergio.Hopefully to get some of you really bright folks interested in playing with using VB6 written DLLs with Blitz3D..It works...<br>the Vb6 Addin vbAdvance is at www.vbAdvance.com..and is free to try...<br>=Email:<br>Sergio:<br>The Code is so short I am sending in the Email.. Cut/Paste...<br> Note: Got Forms working ... Except can only use MODAL..if you figure<br>              out how to use MODELESS please let me know...<br>Project:<br> 1. Download and install vbAdvance..it is an ADDIN.. <br> 2. Create VBProject.. Activex DLL...Namethe prj "ExportTest" (Name is used in code)<br> 3. Create Module MExports.. paste MEXPORTS code below<br> 4. Create FORM name FORM1 add text box (text1)..Command (Command1)..Paste form1 <br>    Code below<br> 5.  VB Tools/Add In Manager.. Select VbAvance.. a Floating toolbar (VbAdvance) <br>           will show up... select the first button (Advanced options) then select<br>    the DLL tab and Check the Functions/Subs to EXPORT ...<br>    Note you DO NOT have to select InitVBEngine and Cleanup..only the Subs/Functions<br>    you will be calling from Blitz3D...<br> 6. Save the Project as ExportExample<br> 7. Vb6 Files/  Make EXPORTEXAMPLE.DLL ... make sure the DLL is created in<br>    Blitz3ds USERLIBS dir...<br> 8. Create the Blitz3d code below<br> 9. Create the ExportExample.decls in the blitz3d USERLIBS dir..<br> 10. Run the blitz program<br> <br> in testing /Using .. I saw MEMORY ACCESS VIOLATION alot...<br> usually meant I did NOT select the Function/Sub in step 5 or my Blitz Decls<br> were wrong.. OR..<br>      I did not INITIALIZE THE VB ENGINE.. the Code InitVbEngine / Cleanup <br>      has to be used...Read the explanation in the vbAdvance documentation<br>  Also I put MsgBox code in the vb6 to let me know where it is.. did not bother to cleanup<br>happy coding...<br> <br>Marv<br> <br>;=========================================================================<br>;Blitz3d Code for using VB6 DLL <br>Const class$="Blitz Runtime Class"    ; &lt;- Blitz3D<br>Global title$="VB DLL" ; starting title<br>AppTitle title$<br> <br> <br>;Goto tint  ; test Function/sub<br> <br>;==== Std Hello Pass String to VB Sub<br>smsg$= "Str for VB Sub"<br>SayHello (smsg)<br>Goto tend<br> <br>;==== Tested Vb DLL String function = Send/Receive"<br>.tStr<br> inpStr$="Send to vb function"          <br> rtnst$ = vbStringFunction$( inpstr$) <br>Print inpStr$ <br>Print Len(rtnst$)<br>Print rtnst$<br>Goto tEnd<br> <br>;==== Send/Receive Float =====<br>.tfloat<br>inno# = 10<br> otNo#=vbFloatFunction#(inno#)<br>Print otno#<br>Goto tEnd<br> <br>; ==== send/Receive Integer using Form ====<br>.tInt<br>inInt% = 1562<br>otInt%=vbIntegerFunction%(inInt%)<br>Print otint%<br>Goto tEnd<br> <br>.tEnd<br>WaitKey()<br> <br>End <br> <br>;========= UserLibs Decls File=ExportExample.decls<br>;.lib "ExportExample.dll"<br>;vbStringFunction$ (z1$):"vbStringFunction"<br>;vbFloatFunction#(inNo#):"vbFloatFunction"<br>;vbIntegerFunction%(inNo%):"vbIntegerFunction"<br>;SayHello(Instr$):"SayHello"<br>;======End blitz ========================================<br>;<br>;<br>;===========Vb6<br>Project: ExportTest Active X DLL functions/Subs called by Blitz3d<br>Form1 Code:<br>'=======<br>Option Explicit<br> <br>Private Sub Command1_Click()<br>Unload Me<br>End Sub<br>'=============<br> <br><br>Module MExports Code<br>Option Explicit<br>'Required for initializing the VB engine:<br>Public pUnk As IUnknown<br> <br>Public Function vbFloatFunction(ByVal inNo As Single) As Single<br>Dim sMsg As String<br>    InitVBEngine "ExportTest.class1"<br>   sMsg = "Rcvd= " &amp; Str(inNo)<br> MessageBox 0&amp;, sMsg, "Sub 04", 0&amp;<br>vbFloatFunction = inNo * 10<br> <br><br>CleanUp<br>End Function<br> <br>Public Function vbIntegerFunction(ByVal inInt As Integer) As Integer<br>Dim sMsg As String<br>    InitVBEngine "ExportTest.class1"<br>   sMsg = "Rcvd= " &amp; Str(inInt)<br> MessageBox 0&amp;, sMsg, "Sub 04", 0&amp;<br>vbIntegerFunction = inInt * 10<br>vbShowRcvd sMsg<br> <br><br>CleanUp<br> <br>End Function<br> <br>Public Function vbStringFunction(ByVal lpMsg As Long) As String<br>' lpMsg is Ptr to C Style Str<br>Dim sMsg As String<br>Static stMsg As String<br> <br>'Because the DLL is now registered, we can instantiate an object from this<br>    'DLL, which will result in the VB runtime engine intializing:<br>    InitVBEngine "ExportTest.class1"<br> 'conv incoming str From UniCode (C style String using _StdCall)<br>    sMsg = StrConv(SysAllocStringByteLen(lpMsg, lstrlen(lpMsg)), vbUnicode)<br>    <br>  <br> MessageBox 0&amp;, sMsg, "Sub 04", 0&amp;<br>'Insure null terminated<br>  stMsg = "X23456789" + vbNullString<br>'Convert to ANSI (C style)<br>   vbStringFunction = StrConv(stMsg, vbFromUnicode)<br>  <br>  MessageBox 0&amp;, stMsg, "Sub 04", 0&amp;<br>' shut down VbRuntime Engine<br> CleanUp<br> <br> <br>    <br>  <br> <br>End Function<br>Public Sub SayHello(ByVal lpMessage As Long)<br>    <br>    Dim sMsg As String<br>        InitVBEngine "ExportTest.class1"<br> <br>    'Convert the passed pointer to an ansi string into a VB String:<br>    sMsg = StrConv(SysAllocStringByteLen(lpMessage, lstrlen(lpMessage)), vbUnicode)<br>    <br>    'Pop a message box displaying the passed String:<br>    MessageBox 0&amp;, sMsg, "ExportExample", 0&amp;<br>   CleanUp<br>End Sub<br> <br><br>Private Sub vbShowRcvd(sT As String)<br>On Error GoTo myError<br>Form1.Text1.Text = "Rcvd= " &amp; sT<br>Form1.Show vbModal<br>Exit Sub<br>myError:<br>MsgBox "Error= " &amp; Error$<br> <br>End Sub<br>Public Function CleanUp()<br>    <br>    'Release our object:<br>    Set pUnk = Nothing<br>    <br>    'And un-initialize OLE:<br>    CoUninitialize<br>    <br>End Function<br> <br>Public Sub InitVBEngine(sProgID As String)<br>    <br>    Dim IID_IUnknown As VBGUID<br>    Dim hr As Long<br>    Dim CLSID As CLSID<br>    Const FailBit As Long = &amp;H80000000<br>    Dim sMsg As String<br>    sMsg = "In InitVB"<br>     MessageBox 0&amp;, sMsg, "Sub 04", 0&amp;<br>    <br>    'Initialize OLE:<br>    hr = CoInitialize(0)<br>    If hr And FailBit Then<br>           MessageBox 0&amp;, Error$, "Init Error", 0&amp;<br> <br><br>        Exit Sub<br>    End If<br>     <br>    <br> <br>    With IID_IUnknown<br>        .Data4(0) = &amp;HC0<br>        .Data4(7) = &amp;H46<br>    End With<br>    <br>    'Get the CLSID for the helper interface:<br>    CLSID = CLSIDFromProgID(sProgID)<br>    <br>    'Create the object:<br>    hr = CoCreateInstance(CLSID, Nothing, CLSCTX_INPROC_SERVER, IID_IUnknown, pUnk)<br>    If hr And FailBit Then<br>       MsgBox Error$<br>        CoUninitialize<br>        Exit Sub<br>    End If<br>    <br>    'If we made it this far, then we can start using normal VB calls<br>    'because we have an initialized VB object on this thread.<br>    On Error GoTo myError<br>    ' Form1.Show (vbModal)<br>    MsgBox "Leaving INITVB"<br>    Exit Sub<br>myError:<br>MsgBox "Error= " &amp; Error$<br>End Sub<br>'============================================<br>Code for CLASS1 class Module<br>No Code is needed for the Class1 (Class Module) but it must exist<br> '=========== EndCode===================<br>Answer to your other Questions:<br>&gt; Would be possible, for example, to write a VB DLL wrapper for database use, <br>&gt; ODBC, and so on.. extremely useful.<br>     Answer: I have not tried it.. however vbAdvance is USING VB6.. it is not a seperate compiler...should work...<br>&gt; Only a question though. You know already that a VB6 application needs lots <br>&gt; of other DLLs and  runtime library in order to work. Is that the same for a <br>&gt; 'pure' "VB6 VB Advance" created DLL ?<br>    Answer:  the key to understanding what vbAdvance is doing .. VB6 from Msft has ALWAYS HAD the Capability<br>                  of Exporting Standard DLLs.. when Msft came up with ACTIVEX DLLs they simply did not give<br>                  us programmers the capability of Creating them.. the folks from vbAdvance fiquered that out and<br>                  are simply using VB6 compile options in the background to create Standard (Exported fucntions/Subs) DLLs<br>                  Therfore ALL VB6 capabilities are in the DLLs... vbAdvance is NOT GENERATING THE CODE..Msft VB6 is...<br>&gt; In other words, if on the target pc there's no DLL and no library about VB6, <br>&gt; would the DLL created using VB Advance work, as the Kernel32 or other basic <br>&gt; DLL would ?<br>    Answer:  The VB RUNTIMES ARE NEEDED.....but it is free and could be included in your INSTALL..<br>                  I <br><br></td></tr></table><br>
<a name="296513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kurtz,<br>Thanks a lot m8 !<br><br>:)<br><br>Sergio. <br><br></td></tr></table><br>
<a name="296562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1. solved the MODAL problem use following to show MODELESS:<br>Private Declare Function ShowWindow&amp; Lib "user32" (ByVal hwnd As Long, ByVal nCmdShow As Long)<br>Private Const SW_SHOWNORMAL&amp; = 1<br>-and to display form as Modeless-<br>Load Form1<br>lRes = ShowWindow(Form1.hwnd, SW_SHOWNORMAL)<br><br>2. Wrote a quick blitz pgm to pass a "Name" and random no. to a vb6 dll function that stores in MS Access Data base..works fine..iterated 1000 times..ran fast...used ADO <br><br></td></tr></table><br>
<a name="296574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great that it can be done, and I'm sure there are good reasons for doing it, but, what are they? <br><br></td></tr></table><br>
<a name="296578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Masterbreaker...<br>well.. instead of using C,Purebasic etc pgm langs. to write DLLs for use in Blitz this opens up msft VISUAL BASIC for use..VB pretty much allows programmers to do ANYTHING within the Windows OS.. there are alot of VB programmers out there...some who do not do game pgming (like me) but might want to use BLITZ to  EASILY  Show  3D representations of real world situations.. <br>I have followed your posts.. you , Dr Av and others are bright folks..your thoughts and comments are appreciated...<br>one example (from a Non Gamer) suppose you wanted to keep scores for a game.. lots of ways to do it.. free with windows is ODBC (Jet/ADO) Data Base.. ..Yes a dll in C++,Others could be written.. But it was Designed to be used by VB, easily and little code.. or (another example) suppose you want to(from within Blitz) EMAIL "something" to a given list..can do..or (another example) I want to add PopUp menus to my Blitz app-can't do easily in Blitz so I'll use a VB DLL to do it.. SQL,DirectX internals,Sockets, ENTIRE WINDOWS API is Easily accessible from VB. You want FAST CALCULATIONS..ASM can be imbeded within VB.. What can it do?  What do you want to do..there is so much VB code out there I would guess someone found a way to do it...do you want your Blitz code to interface to Msft Access,Excel,Outlook..ANY MSFT (and other) products?..or do you have a Non Blitz app that you want to interface to Blitz...I don't know why you would (it's your imagination not mine)..but if you want to you can through a VB DLL.... <br><br></td></tr></table><br>
<a name="296744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suspected database stuff might come into it.  Thanks for your explanation. <br><br></td></tr></table><br>
<a name="296842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers Kurtz,<br>your progressing in this field are very interesting and really promising.<br><br>I'll try to be as productive as you in this field..<br><br>Best Regards,<br>Sergio.<br><br>P.S.<br>The only drawback about a VB6 DLL is that it needs the VB runtime DLLs to run, while a DLL written in C++ does not... <br><br></td></tr></table><br>
<a name="297215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy_A</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kurtz,<br><br>Nicely done.<br><br>Using this method of accessing the VB runtime DLL, would it be possible to create a print dialog window generated in a Blitz program to print .bmp's in color? Or better still, to format the print output like one does in MS Access form generator with graphics, fonts, and page orientation? <br><br></td></tr></table><br>
<a name="297422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Andy_A<br>Yes...<br><br>I have not played with printing yet..will need to at some point.. at this time I am adding standard windows menus to my blitz app..(popups) and changing my app to use MDB instead of INI's ... <br><br></td></tr></table><br>
<a name="307697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jcosch</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would like to use a dll created in VB6  with Blitz so Kurt's procedure above is very interesting.  I have tried following the procedure step by step, but I am having a lot of trouble getting the dll to compile without error.  The errors I get are from functions and data types not recognized by VB6.  I beleive the functions are API functions like SysAllocStringByteLen and data types like VBGUID. I think there may be some declaration statements missing. Is the additional code available so the dll compiles without error? <br><br></td></tr></table><br>
<a name="307718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh I'm buying this RIGHT NOW.......... <br><br></td></tr></table><br>
<a name="307776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...And I did.  28 dollars is more than worth it to create a true DLL with exportable functions from VB6.  Now it looks like I'm gonna have to go back and rewrite the BlitzPrinter Userlib one more time.<br><br>Kanati <br><br></td></tr></table><br>
<a name="307867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @JOSCH<br>SysallocStringByteLen is included with vbAdvance in   vbadvance.tlb  .. in your vb project add reference (project/references) to vbAdance...sorry..should have included in above.. you can then see the refs using object browser...Note: you need to bring down vbAdance and install.. It is FREE to try...<br><br>@Kanati..<br>  I agree.. I added context vb PopUp menus to my B3d app..25 mins. work... heavenly..<br><br>if You both get an example working ..plse post with the OS/Hardware you are using..so I know which (98/Me/2000/XP) seem to work ok.. I am using XP Pro..on an eT1855 ,128M devel mch. <br><br></td></tr></table><br>
<a name="308523"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kurtz and I have been playing with this thing and... <br><br>It works.   Kinda.   Mostly.   Sometimes.   :)<br><br>There's still some issues.<br> <br>  A) Blitz+ flat out crashes on things that Blitz3D responds with intelligent errors (ok, Unhandled Exception isn't exactly intelligent, but it's better than a GPF in blitzcc.exe.)<br>  B) It appears that plain-jane-vanilla VB works fine but when you start accessing other objects (printer, clipboard, etc) then you start running into some problems.  And I'm guessing it's because those objects are also COM objects and aren't getting initialized correctly, but I haven't yet tracked it down that far.<br><br>So while I still think this tool is well worth the 28 dollars they are charging...  I recommend it with some reservations.<br><br>Kanati <br><br></td></tr></table><br>
<a name="308568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok...  let me revise this...<br><br>A) is still valid.  Blitz+ internal error checking kinda sucks.<br><br>B) COM objects can be used just fine.  But you cannot call them the same as the code above demonstrates.  You need to call the InitVBEngine() and immediately Cleanup().  ONCE.  That's all you need to do it.  After that you can call com objects all you want so far as I can ascertain currently.<br><br>So my reservations about recommending it are starting to disappear ever so slowly.  The docs definitely need a bit of work though.  A lot of this is becoming trial and error.<br><br>Kanati<br>estout@... <br><br></td></tr></table><br>
<a name="308722"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another update...  <br><br>Simply moving the decls and dll to another machine results in crashing.  I'm not so sure this is going to work out.  I'm confused at the very least.  :/<br><br>Kanati<br><br>[edit] I just noticed that I'm running 1.37 of blitz+ here and THINK I was running 1.11 on the other machine.  That might have something to do with it.<br><br>[edit] Oh...  and I was running on Win2000 and now I'm on XP...  Recompiling doesn't work.  Can't seem to get it to work period now................................ <br><br></td></tr></table><br>
<a name="308747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AbbaRue</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Keeping all this in mind, I suppose dlls written in MASM32 could also be incorperated into Blitz3D. <br>Anyone given that a try yet? <br><br></td></tr></table><br>
<a name="309030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kanati<br>Rem Windows requires DLLs to be registered...I moved our test rtns to my other mch (Sony Viao w/2000).. used msft Install to package it.. ran ok... <br><br></td></tr></table><br>
<a name="309080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> @AbbaRue<br>I don't do ASM on x86 machines.  Never bothered to learn.  I can look at it and understand on a basic level what it's doing, but I couldn't create something from scratch.  In theory of course MASM could indeed be used to create DLLs for blitz.  I don't know anyone that has done so though.<br><br>@Kurtz<br>I didn't have a problem with registering the dll.  Being a real dll it really shouldn't require it and that IS the case on a 2000 machine.  But just to test, I went ahead and tested the dll you sent me after registering it on Windows XP Pro.  The program dies as soon as it tries to access any dll functionality.  Even the simple string and integer functions.  This is something totally different going on here.  I am waiting on a response from the vbadvance tech support as to any known issues with WinXP and I'll keep you informed.<br><br>Kanati <br><br></td></tr></table><br>
<a name="309195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was unaware that VB automagically registers dll's upon compile.  So they ARE getting registered.  So that's the source of a few crashes I'm sure.  But not all.  I'm going to compile on XP from now on and test on other OS' to make sure it works.  <br><br>These dll's will need an install which I really didn't want to do if I didn't have to since the end user will have to have the dll registered as well, but it's a small price to pay for the flexibility that VB gives compared to purebasic and powerbasic.  Not to mention C++.  <br><br>Kanati <br><br></td></tr></table><br>
<a name="310111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kanati,<br>I *guess* it is also possible to register the dll from within a blitz program, by calling the appropriate API - don't recall which one, but if you dig in the API world I'm sure you will find it.<br><br>I don't know if it would work though; registering a dll from within the program who makes use of it, while the program itself is already running.. hum....<br><br>Another solution is to use an installer - like installshield for example - which will install the game and eventually register the requested dlls.<br><br>Please keep on this interesting job m8 !<br><br>Regards,<br>Sergio. <br><br></td></tr></table><br>
<a name="310152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig Watson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> A quick call to regsvr32.exe shouldn't be too hard, right?<br><br>Would it work though? <br><br></td></tr></table><br>
<a name="310231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LostCargo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> regsvr32 called from a batch file setup.bat would work. just make sure u have the dlls saved in the right spot first. Also most applications will look for the dll in the same directory then in the windows/system directory next. Having the dlls in the same directory as the exe might save u from having to register them at all. <br><br></td></tr></table><br>
<a name="310280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a way to register a dll upon creation of the thread...  It's described in the vbadvance samples...  but it's really a moot point.  You should just include the requirements and crate an installer for the dll.  Then when you distribute the blitz program/game then you also create an installer that will register the dll.<br><br>I've run into another snag with the blitz printer userlib too...  For some as yet unknown reason, after the printer dialog is released, the dll resets the printer back to the default.  If I don't get that figured soon then it might not be worth pursuing for a printer userlib without creating my own printer dialog.  Which I really don't want to do.  Printer dialogs that aren't the system dialog tend to look........  cheap.   <br><br>Kanati <br><br></td></tr></table><br>
<a name="310293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >augGa</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Semar--Glad to see u back Sergio... I have some pretty good luck with it.. Kanati is becoming the resident expert..(smart guy)...Rcvd the following from The developer of vbAdvance (Pete)...sounds like he is willing to assist...With all u bright folks working with this I think I will go 'back to sleep..' Got Speech working with Msagents (Sapi4) and Sapi5 on XPpro..<br>Little guy (Merlin) pops up and tells me where my mouse is when I right click..geez..I have too much time on my hands...<br><br>Email From Pete:<br>Hi Eric,<br><br>I've managed to eliminate the registration requirement for<br>standard DLLs created with vbAdvance. Not only that, but<br>the new release adds support for DllMain. This means the<br>runtime initialization can happen in DllMain, which is<br>called automatically when the DLL is loaded by Blitz.<br><br>This completely removes the runtime initialization code<br>requirements from your exports, which is not only simpler<br>for you, but also much more efficient from a performance<br>perspective.<br><br>If you and/or Marv Kurtz would like to try a beta copy of<br>the new release to test this out, just say the word and<br>I'll send you the download link.<br><br>Best,<br>Pete <br><br></td></tr></table><br>
<a name="310444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> heh...  definitely not a resident expert...  but I'm certainly pouring some time into it.  :)<br><br>I've figured a way around the whole printer dialog issue I was having.  Had to do some direct API calling to do it but I think it's gonna work fine now.  First time I've thought that since starting the printer userlib in vb.  :)<br><br>Now I just gotta convince the "small code is the only way to go" crowd that 1.8 meg for the userlib isn't too large.  I think the featureset I'm tossing into this thing might win em over though.  :)<br><br>Kanati <br><br></td></tr></table><br>
<a name="321753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zace</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Arghhh - i followed this letter for letter and get an error trying to make the DLL saying that the function/sub MessageBox is not found!!!<br><br>Any ideas as to what I'm doing worng ?  Im using VB6sp5. <br><br></td></tr></table><br>
<a name="321760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >StOrM3</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kurtz can you email me your database example code, I want to use access to store my game highscores and inventory etc..  Any code you can email me showing how to do it would be greatly appreciated. <br><br>storm3@...  Thanks!<br><br>Ken <br><br></td></tr></table><br>
<a name="321828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> haven't heard from kurtz in a while...  but I'm nearly finished with an ADO dll I plan to sell for a measly 10 bux.<br><br>If you are interested lemme know. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
