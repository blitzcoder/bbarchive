<!DOCTYPE html><html lang="en" ><head ><title >Getting Colours from Read Pixel</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Getting Colours from Read Pixel</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Getting Colours from Read Pixel</a><br><br>
<a name="476335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cancerian</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I am having some strange results from the Read Pixel command and I was hoping someone could help me.<br><br>Basically what I have is a fullscreen JPEG image as the background and sprites falling from the top of the screen and bouncing off objects in the background image.  The collision check with the background is simply to use Read Pixel to get the colour value of the background at the falling object's location.  Anything other than pure white results in a collision.<br><br>The problem is that different computers produce different values as the Read Pixel result.  On my test computer, white comes back as something like "-65000", so I set the check for any values less than that.  However other computers give completely different results and the sprites are bouncing off the white background that they are supposed to pass through.<br><br>Basically, I'd like to know how to extrapolate the RGB value of the pixel from whatever Read Pixel is spitting out.  Also, are there any known issues of different video cards producing wildly different color values - even if they are set to the same resolution and bitrate?<br><br>Thanks for any help or advice! <br><br></td></tr></table><br>
<a name="476347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cermit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dont think you should use a jpeg image for collision check (the pixels get wierd when jpeg is compressed), try with bmp or png you might get better results.<br>If you're still having trouble post some code, it'll be easier to see what the problem is. <br><br></td></tr></table><br>
<a name="476351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cancerian</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found the source of the problem!  Ends up the other test computers had their desktops set to 16bit mode and I had only tested running the game in a window.  When run at fullscreen (where I set the value to 32bit in Blitz) the effect works fine.<br><br>So I guess I have to find a value that will work whether the game is running in 16bit or 32bit - hence the need to break it down into RGB values.  Regardless of bitdepth, white is always RGB 255,255,255 right?<br><br>Here's a paraphrased version of my code:<br><br><pre class=code>
DrawImage background,0,0
LockBuffer BackBuffer()

;Cycle through each of the active objects
For object.object = Each object

;Check the background pixel for anything other than white.
bg_check = ReadPixel(object\x_pos,object\y_pos)

;If another color is detected, create a bounce effect
If bg_check &lt; -66000
     ;Collision bounce code goes here
EndIf

;Unlock the backbuffer from the collision checks
UnlockBuffer BackBuffer()
</pre> <br><br></td></tr></table><br>
<a name="476358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It might me easier to use a 256 greyscale mask image.  Basically, you load and display the background image normally, but you load another image which isn't displayed with white as normal sections and black lined up to the obstructions, then you check colisions on the mask instead of the 32 bit color image.  You can also use various shades of grey to identify the degree of obstruction, for instance white = roads, light grey = dirt paths, med grey = swamps, black = boulders, etc... <br><br></td></tr></table><br>
<a name="476410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chris_b</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just store whatever ReadPixel returns for a white pixel in a variable before you start your main game loop.<br><br>eg:<br><br><pre class=code>global white%
color 255,255,255
plot 0,0
white=ReadPixel(0,0)</pre><br>and then compare bg_check to your "white" variable <br><br></td></tr></table><br>
<a name="476419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The most significant byte of the long integer that is returned by readpixel may be a random value (AFAIK). since you won't need that byte anyway, I'd suggest to mask it out from beginning on:<br><br>rgb=ReadPixel(0,0) And $FFFFFF <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
