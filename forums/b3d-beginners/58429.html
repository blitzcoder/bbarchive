<!DOCTYPE html><html lang="en" ><head ><title >Automatic place char. into keyboard buffer?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Automatic place char. into keyboard buffer?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Automatic place char. into keyboard buffer?</a><br><br>
<a name="649912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>We could use keydown/keyhit to check if a key is pressed.<br>If we want to create a automatic run demo and want<br>blitz3D automatic place char. into keyboard buffer,<br>how to do this?<br>(eg. Blitz3D automatically "press" S to start demo.<br>"press" X to exit, etc., instead of manually pressing<br>S and X directly) <br><br>Any ideas?<br><br>Thanks in advance.<br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="649920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think it's a bit overkill trying to put chars into the keyboard buffer without keypresses.  Why not simply set a constant to determine whether in demo mode or not.  <br><br>const Demo = true<br>StartGame = ( keydown( S_Key ) or Demo )<br>EndGame = ( keydown( X_Key ) or Demo )<br><br>Stevie <br><br></td></tr></table><br>
<a name="650177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Stevie G,<br><br>Thank you for your reply.<br>Here is the solution:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1227" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1227</a><br><br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="650195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using a DLL for something which can be acheived with a simple workaround is OTT if you ask me.  Whatever floats your boat though. <br><br></td></tr></table><br>
<a name="650232"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jams</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Agreed, it's completely unnecessary, if you're having to manually input data into the keyboard buffer, you probably need to rethink the whole problem and start again from a different angle... <br><br></td></tr></table><br>
<a name="650269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Stevie G and Jams,<br><br>The virtual key is needed because I DON'T want<br>to manually input data into the keyboard buffer.<br>I don't type 'S' and 'X'. Let Blitz3D do it for me.<br><br>The function is useful when you run a auto-play demo.<br>eg. when you enter old doom game and leave it there,<br>after a while, it will play automatically.<br><br>Thanks<br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="650277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jams</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's not what i meant!<br><br>Think of it like this.... pressing a key on the keyboard invokes some kind of response in your code (a function or whatever).<br><br>Now you want to have that same response without a keypress.... so just call the function! <br><br></td></tr></table><br>
<a name="650282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> sometimes it's useful when you want to control an external exe. Like clicking away a welcome message popup etc. <br><br></td></tr></table><br>
<a name="650353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>The function is useful when you run a auto-play demo.<br>eg. when you enter old doom game and leave it there,<br>after a while, it will play automatically.<br> <br></div><br><br>I fail to see how this relies on writing virtual keypresses to the keyboard buffer.  The doom demo started after a certain period of time ... it's that simple.<br><br>I can see the relevance of using this DLL in Jfk's example above as you can not do this without an external library. However, for your usage I have to agree completely with Jams. <br><br><div class="quote"> <br>Now you want to have that same response without a keypress.... so just call the function! <br> <br></div><br><br>Stevie <br><br></td></tr></table><br>
<a name="650396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;The virtual key is needed because I DON'T want<br>&gt;to manually input data into the keyboard buffer.<br>&gt;I don't type 'S' and 'X'. Let Blitz3D do it for me.<br><br>The virtual key is not needed in that situation. You simply do as Stevie G suggested above.<br><br>&gt;The function is useful when you run a auto-play demo.<br>&gt;eg. when you enter old doom game and leave it there,<br>&gt;after a while, it will play automatically.<br><br>You just use a timer and act on this timer in an IF...THEN structure. <br><br>The reason people are all over you, is because you are using a complicated and unnessesary solution instead of a few lines of B3D code.<br><br><br>Andy <br><br></td></tr></table><br>
<a name="650450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think there are many misunderstandings in this thread. I guess Sammy was talking about a replay mode as seen in certain games.<br><br>Replay or demo modes simply emulate keyhits and mouse action by "feeding" their Input Routines alternatively with data when in demo mode instead of user input.<br><br>eg:<br><pre class=code>
if replay_mode=0
 mxs#=mousexspeed()/4.0
 turnentity camera,0,mxs#,0
 mxs_array#(c)=mxs#
 c=c+1
else
 mxs#=mxs_array#(c)
 turnentity camera,0,mxs#,0
 c=c+1
endif
</pre><br><br>In the first case (play mode) the camera rotation is controlled by the mouse, additionally the rotation is stored in an array<br><br>In the ELSE case (replay mode) the camera rotation is controlled by the array data, containing previously stored mouse actions.<br><br>Every User Action can be stored this way. When recording and replaying, the same constant framerate should be used to keep things simple. If delta timing etc. is used and a constant framerate is not possible, a slightly more complicated solution is required, utilizing realtime sequencing.<br><br>Furthermore the usage of random values (Rand and Rnd) can be tricky. In theory they can be used if they are initialized with the same seed everytime, but that's probably only theory :)<br><br>For a fixed demomode sequence the array may be saved to a file that is loaded by default. <br><br></td></tr></table><br>
<a name="650494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jams</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Even with your example, there's still no need to shove the data into the keyboard buffer, it's completely unnecessary.<br><br>I think it's a symptom of a poorly coded engine... if all your actions lie inside "if Keyhit(blah) then" blocks then this would seem like the obvious solution.<br><br>Far better would be to bind keyhits to specific functions, then when you want to simulate a keyhit, just call that function... <br><br></td></tr></table><br>
<a name="650516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>Thank you for your reply.<br><br>If I MANUALLY input data into the program, <br>I would use "if keyhit(blah) then" blocks for data input.<br><br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="650559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;If I MANUALLY input data into the program, <br>&gt;I would use "if keyhit(blah) then" blocks for data input.<br><br>You are not understanding what people are saying to you.<br><br>There is no difference whether is is MANUAL or AUTOMATIC.<br>If you have a variable called demo, and you add something like what Stevie G suggested, then you get automatic demo mode without using a DLL.<br><br>When you use a dll, you inherit a lot of properties. You become responsible to your customers for the dll and what it does to the customers system.<br><br>Programming is not just about making the computer do what you want, but also to do it in a way which is simple and efficient both to you and to the user. <br><br>You won't notice the difference now, and you propably don't understand why people are all over you for this, but using a DLL for something which can easilly be achieved with a few lines of code is silly, inefficient and a waste of your time.<br><br>If you don't understand how to do the same in B3D without using a DLL, then just ask. I'm sure everyone here would be more than helpful in that case.<br><br>Simple beats complex almost every time.<br><br>I applaud your effort to learn B3D.<br><br><br>Andy <br><br></td></tr></table><br>
<a name="650582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>Thank you for your reply and patience.<br><br>Assuming the following configuration:<br>W - move forward<br>A - move left<br>S - move backward<br>D - move right<br><br>Assuming you want your player to move in this way..<br>WWASSSDWWWWWWWWWWAAWWWWAAAASSWWDDD.... (2000 keystrokes)<br>(forward, forward, left, backward, backward, backward, right, forward,...)<br><br>This keystrokes are saved in a file.<br>The pseduo code should be something like this:<br><br>while not end of file<br>reading a char. into letter$ <br>select letter$<br>	case "W"<br>	; codes for moving forward <br>	case "A"<br>	; codes for moving left<br>	case "S"<br>	; codes for moving backward<br>	case "D"<br>	; codes for moving right<br>end select<br>wend<br><br>Later, you change your mind, you want this:<br>SWSDDSSDASSSSSSSSSSDDDSSSWWWSSDDD........ (2000 keystrokes)<br>(backward, forward, backward, right, right, ...)<br><br>With virtual key, you do NOT need to change a <br>single line of code. You just change the file content <br>with keystrokes, then ok.<br>It seems that with other method mentioned, <br>I have to change large amount of codes to do<br>the same thing.<br><br>This is how I understand the use of virtual key.<br><br>Thanks in advance.<br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="650588"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> No you don't have to change the code at all.  All you have to change is the file.  <br><br>In my Blood and Plunder Gauntlet Clone for the replay I did as the others have suggested:<br><br>In 'record' mode store each action/button press in a 'type', at the end of the session save the data out to a file.  Then when in demo mode it would read in the data into a 'type' then act on those actions in sequence during the demo.<br><br>No code needs to be changed.  You will have to change the data file's contents regardless of whether you use virtual key or generate the data file by playing the game yourself or simply changing them in a text file. <br><br></td></tr></table><br>
<a name="650591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>In that case, what is the use of virtual key?<br>I am confused??!!<br><br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="650888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jams</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no use in this situation, that's what we've been trying to tell you...<br><br>Please study this example:<br><br><pre class=code>
If DemoMode = True
    Command$ = ReadCommandFromFile() ;Get the next command
    PushKeyboardBuffer( Command$ ) ;Put data into the keyboard buffer
Endif

If KeyDown( KEY_UP )
        Player\Y = Player\Y -1
Endif
...
</pre><br><br>A much better way to do it would be like this:<br><br><pre class=code>
If DemoMode = True
    Command$ = ReadCommandFromFile() ;Get the next command.
    Select Command$
        Case "KEY_UP" : PlayerMoveUp() ;Interpret command.
        ...
    End Select
else
    If KeyDown( KEY_UP )
        PlayerMoveUp() ;interpret command.
    Endif
    ...
endif

Function PlayerMoveUp()
        Player\Y = Player\Y -1
End Function
...
</pre><br><br>Another problem you'll run into if you want to use the keyboard buffer to automate the demo, is that the user can still press keys on the keyboard, and they'll still get put in the buffer along with all your data. <br><br></td></tr></table><br>
<a name="650919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jams you forgot to say what function "pushkeybordbuffer()" does, and the first<br><br>If KeyDown( KEY_UP )<br>        Player\Y = Player\Y -1<br>Endif<br><br>doesn't make sense since you have that function "PlayerMoveUp" unless I misunderstood something.<br><br>However, it may be most simple if you add a second valid condition like<br><br><pre class=code>
if ((keydown(Key_UP)) and (demo=0))   or   ((k(c)=KEY_UP) and (demo=1))
</pre><br>where k(c) is a value taken from a file or array.<br><br>Plus: I totally agree, with your second point. Also consider that keydown cannot be replaced by "inserted virtual keyhits" and keydown allows multiple keys to be pressed simultanously. <br><br></td></tr></table><br>
<a name="650930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jams</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops, should have mentioned that 2 codeboxes are completely seperate. &lt;Edited  :) <br><br></td></tr></table><br>
<a name="651579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>Thanks a lot.<br>If I have more questions, I would post again.<br><br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
