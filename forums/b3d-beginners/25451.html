<!DOCTYPE html><html lang="en" ><head ><title >Collision Question</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Collision Question</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Collision Question</a><br><br>
<a name="264516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AbbaRue</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do you set (CollisionX,CollisionY,CollisionZ)'s Index?<br> <br>I keep getting an "Index out of range" Error. <br>And there are no examples with these functions in the command reference.  <br>Also, As I move across a 3D terrain every time I get to a steep hill the camera shows <br>the inside of the hill instead of the surface. <br>I use the collision command slide2 mode.  <br>How would I get the camera to automatically go up when it gets to a steep hill <br>and then decend again when I go down, I think checking CollisionY is the way to go.  <br>What is the best way to do it.  Thanks in advance. <br><br></td></tr></table><br>
<a name="264866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> well, give the camera an EntityType number then set up collisions between it and the landscape, so that the camera will collide and slide, and shouldn't go thru the landscape. Write back if you need any code :D <br><br></td></tr></table><br>
<a name="264881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AbbaRue</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I already have the collision checking between camera and landscape set up for slide2 mode. But sometimes when I go up a hill at a slight angle I see the inside of the hill instead of the surface.  I need a means of checking the terrain height infront of me instead of right where I am. <br><br></td></tr></table><br>
<a name="264884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> before you try checking the height in front of you, try changing the camera range. It's default setting is 1,1000.<br><br>change the near value (1), to 0.1. see if that helps. <br><br></td></tr></table><br>
<a name="264906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> maybe set a bigger entity radius. <br><br></td></tr></table><br>
<a name="264978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AbbaRue</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I walk across my terrain I keep 15 above the terrain surface. But when I come to a hill I need a way to stay 15 away from the surface in front of me.  I changed the camera min. range to 0.1 and it did help lessen the problem but I still get it on some hills. <br>Am I the only one that has this problem? <br>No other terrain walkers out there? <br><br></td></tr></table><br>
<a name="265225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> have you tried sinu's idea of increasing the entityradius? You should also try parenting the camera to a pivot that is on the surface of the terrain and give it collision properties. Then when the pivot goes over a hill the camera will follow it up and down. Create the pivot, give it collision properties. Then create the camera, parent the camera to the pivot then set the camera to the desired height and move the pivot about.<br><br>Do you have any code you could show. it will help me to understand what exactly is happening :D <br><br></td></tr></table><br>
<a name="265440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AbbaRue</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is my code so far:<br><br><br>Graphics3D 1024,768,32,1<br><br>	Global frame_count%<br>	Global fps%<br>	Global fps_timeout%<br>	Global frame_time%<br>	Global slowest_frame%<br>	Global frame_start%<br>	Global sped#=0.1<br>	Global sp#=1		;speed walking<br>	Global Angl#=30.0	;max angle of up down look<br>	Global cr=10000 	;camera distance<br>	Global rd=127000		;Rand max distance<br>	Global strt=0		;Were to place camera at start<br>	Global af=30000		;Auto fade distance<br>	Global ab=1700<br>	Global x#=2<br>	Global y#=15<br>	Global z#=2<br>	Global h#=15		;Height above the ground<br>	Global MMY=-45<br>	Global trees=5000	<br>	Dim treeb(Trees*4)<br>	Dim treec(Trees*4)<br>	Dim grass(500)<br>	c=1<br>; Set collision type value<br>ground=1 <br>character=2 <br>scenery=3 <br><br>ClearTextureFilters<br>SetBuffer BackBuffer()<br>ClearWorld<br>SeedRnd 32287 ;usual 32587<br><br>camera=CreateCamera()<br>CameraRange(camera, 0.1, cr)<br>CameraClsColor camera,40,40,190<br>RotateEntity camera , MMP,MMY,EntityRoll(camera)<br>EntityType camera,character ;set camera for collision<br><br>temp = MouseZSpeed()<br>PositionEntity camera,x#,y#,z#<br><br><br>light=CreateLight()<br>RotateEntity light,90,0,0<br>Terrain=LoadTerrain( "media/D16.jpg" )<br><br>EntityType Terrain,ground ;set ground for collision<br><br>Collisions character,ground,2,3<br>Collisions character,scenery,2,2	;set collision response<br><br>TerrainDetail terrain,600,True<br>ScaleEntity terrain,500,3200,500<br>Ent02=LoadMesh("media/cantree.x")    ;206 324 34<br>Ent01=LoadMesh("media/PineTree.x")<br>Ent04=LoadMesh("media/deadtree.x")	;Bent Tree Trunk<br>Ent03=LoadMesh("media/Trunk01.x")	;Streight Tree Trunk<br><br>Tex90=LoadTexture( "media/1567.bmp",9) ;terrain tex<br>Tex91=LoadTexture( "media/720.bmp",2) ;terrain tex<br><br><br>Tex01=LoadTexture( "media/720.bmp",15)<br>Tex02=LoadTexture( "media/721.bmp",15)<br>Tex03=LoadTexture( "media/722.bmp",15)<br>Tex04=LoadTexture( "media/713.bmp",15)<br>Tex05=LoadTexture( "media/713.bmp",15)<br>Tex07=LoadTexture( "media/1567.bmp",15)<br>Tex08=LoadTexture( "media/cedar.jpg",9)<br><br>sky=LoadTexture( "media/sky.bmp",9)<br><br>TerrainShading terrain,True<br><br>; Texture terrain<br>EntityTexture terrain,Tex90,0,1<br><br><br>;*************************************************************************<br>;Test Stuff Starts Here<br>;*************************************************************************<br><br><br>EntityTexture Ent03,Tex08 ;This is a Tree Trunk<br>FitMesh Ent03,-1,-1,-1,2,2,2,True<br>ScaleMesh Ent03,1,1,1<br>TurnEntity Ent03,0,0,0 <br>te = 80<br>ScaleEntity Ent03,14,24,14<br>EntityAutoFade Ent03,ab,ab+300 ;These are not effected by dynamic EntityAutoFade<br>EntityType Ent03,scenery	;set trunk for collision<br><br><br>EntityTexture Ent04,Tex08 ;This is a Tree Trunk<br>FitMesh Ent04,-1,-1,-1,2,2,2,True<br>ScaleMesh Ent04,2,2,2.5<br>TurnEntity Ent04,0,0,10 <br>te = 80<br>PositionEntity Ent04 ,-2,-2,-0<br>RotateEntity(Ent04,0,0,0)<br>ScaleEntity Ent04,2,8,2<br>EntityAutoFade Ent04,ab,ab+300<br>EntityType Ent04,scenery	;set trunk for collision<br><br><br>EntityTexture Ent01,Tex01<br>FitMesh Ent01,-1,-1,-1,2,2,2,True<br>ScaleMesh Ent01,24,24,20<br>TurnEntity Ent01,0,0,0 <br>te = 80<br>PositionEntity Ent01 ,te,TerrainY(Terrain,te,0,te)+42,te<br>ScaleEntity Ent01,2,2,2<br><br>EntityTexture Ent02,Tex01<br>FitMesh Ent02,-1,-1,-1,2,2,2,True<br>ScaleMesh Ent02,20,20,20<br>TurnEntity Ent02,0,0,0 <br>te = 140<br>PositionEntity Ent02 ,te,TerrainY(Terrain,te,0,te)+28,te<br>ScaleEntity Ent02,2,2,2<br>Gosub fade1<br><br>.skippit<br><br>;<br><br>Tree2 = CopyEntity(Ent03,Ent01)	;another tree<br><br>;EntityType Ent01,scenery<br>For tt = 1 To trees<br>	Treeb(tt) = CopyEntity(Ent01)	;another tree<br>	RotateEntity(Treeb(tt),0,Rnd(0,320),0)<br>	xx=Rnd(10,rd)<br>	zz=Rnd(10,rd)<br>	ScaleEntity Treeb(tt),4,4,4<br>;	EntityType Treeb(tt),scenery<br>	PositionEntity Treeb(tt),xx,TerrainY(Terrain,xx,0,zz)+80,zz<br><br>Next<br><br>Tree3 = CopyEntity(Ent04,Ent02)	;another tree<br>For tt = 1 To trees<br>	Treec(tt) = CopyEntity(Ent02)	;another tree<br>	RotateEntity(Treec(tt),0,Rnd(0,320),0)<br>	xx=Rnd(10,rd)<br>	zz=Rnd(10,rd)<br>	ScaleEntity Treec(tt),4,4,4<br>	PositionEntity Treec(tt),xx,TerrainY(Terrain,xx,0,zz)+70,zz<br>Next<br><br><br>Gosub fade1<br><br><br>Gosub fade2<br><br><br><br><br>;*************************************************************************<br>;Main Loop Starts Here<br>;*************************************************************************<br><br>ty=0	;tree update count<br>tey1#=5<br>h#=15<br>LP=0	;lap count<br><br>While Not KeyDown( 1 )<br><br>frame_start = MilliSecs()<br>;Keyboard control<br>sped#=sp# + 0.1<br>tey1#=tey#<br><br>If KeyDown( 31 ) Then sped#=0.1 ;S key<br>If KeyDown( 16 ) Then sp#=sp#+0.1 ;Q key<br>If KeyDown( 17 ) Then sp#=0.1 ;W key<br>If KeyDown( 18 ) Then sp#=-0.09 ;E key<br>If KeyDown( 42 ) Or KeyDown( 54 ) Then sped# = 1 ;L &amp; R Shift<br>If KeyDown( 29 ) Or KeyDown( 157 ) Then sped# = 5 ;L &amp; R Ctrl<br>If KeyDown( 44 )=True Then h#=h#-sped# 	;Z key<br>If KeyDown( 30 )=True Then h#=h#+sped# 	;A key<br>If KeyDown( 31 )=True Then h#=20		;S key<br>If KeyDown( 205 )=True Then TurnEntity camera,0,-1,0		;Right<br>If KeyDown( 203 )=True Then TurnEntity camera,0,1,0			;Left<br>If KeyDown( 208 )=True Then MoveEntity camera,0,0,-sped#	;Down<br>If KeyDown( 200 )=True Then MoveEntity camera,0,0,+sped#	;up<br>If KeyDown( 45 ) Then PositionEntity camera,strt,90,strt ;X Key<br>If KeyDown( 32 )=True Then cr=cr-10 Gosub cam01;<br>If KeyDown( 33 )=True Then cr=cr+10 Gosub cam01;<br><br><br>;If KeyDown( 46 ) Then CameraRange(camera, 1, cr)<br><br>If KeyDown( 46 ) Then cr=10000 Gosub cam01<br>If KeyDown( 47 ) Then cr=100000 Gosub cam01<br>If KeyDown( 48 ) Then ModifyTerrain Terrain,2,2,0.9,False <br>If KeyDown( 49 ) Then ModifyTerrain Terrain,2,2,0.0,False <br><br><br>;Mouse Control<br>MMP=EntityPitch(camera)+MouseYSpeed()<br>MMY=EntityYaw(camera)-MouseXSpeed() ;turning<br><br><br><br>If MMP &gt;angl# ;Looking down<br>MMP=angl#<br>ElseIf MMP &lt; -angl# ;Looking up<br>MMP=-angl#<br>EndIf<br><br>RotateEntity camera , MMP,MMy,EntityRoll(camera)<br><br><br>If Abs(mmy - ty)&gt;1 Then Gosub fade3<br>ty=MMy<br><br><br>If MouseDown(2) ;move forward<br>	y#=y#+sped#<br>	MoveEntity camera,0,0,sped#<br>EndIf<br><br>If MouseDown(1) ;move backard<br>	y#=y#-sped#<br>	MoveEntity camera,0,0,-sped#<br>EndIf<br><br><br>If MouseX() &lt; 2<br>		MoveMouse GraphicsWidth()-2, MouseY()<br>		tempX = MouseX()<br>	ElseIf MouseX() &gt; GraphicsWidth()-2<br>		MoveMouse 1, MouseY()<br>		tempX = MouseX()<br>	EndIf<br>	If MouseY() &lt; 2<br>		MoveMouse MouseX(), GraphicsHeight()-2<br>		tempY = MouseY()<br>	ElseIf MouseY() &gt; GraphicsHeight()-2<br>		MoveMouse MouseX(), GraphicsHeight()-2<br>		tempY = MouseY()<br>	EndIf<br><br>.tst<br>;Camera rendering<br><br><br>x#=EntityX(camera)If x#&lt;0 Then x#=128000 ElseIf x#&gt;128000 Then x#=0 <br>y#=EntityY(camera)<br>z#=EntityZ(camera)If z#&lt;0 Then z#=128000 ElseIf z#&gt;128000 Then z#=0<br>tey1#=TerrainY(terrain,x#,y#,z#)+h#<br><br><br>;auto camera ranging here<br>If y1#&lt;&gt;y# Then LP=0<br>If LP =199 Then  cr=120000 Gosub cam01<br>If LP &gt;200 LP=200 Goto sk01<br><br>If TrisRendered()&gt;56000 Then cr=cr-1000 Gosub cam01<br><br>.sk01<br>y1#=y#<br>PositionEntity camera,x#,tey1#,z#<br>UpdateWorld <br>RenderWorld<br>		frame_time = MilliSecs() - frame_start	<br>		show_info()<br><br>		Text 10,0, "direction: " + (EntityYaw(camera)+180)<br>		Text 10,48," X: "+x#+" Y: "+y#+"  Z: "+z#+" CR: "+CR+" AF: "+af<br>;	    Text 0,72,"Height : "+H#<br>	    Text 10,60,"Distance : "+ EntityDistance(Terrain,Camera)+"  Height : "+h#<br><br>Flip False <br>lp=lp+1<br>Wend<br><br>End<br><br><br><br>.Fade1<br>EntityAutoFade Ent01,af,af+600 <br>EntityAutoFade Ent02,af,af+600 <br>EntityAutoFade Ent03,af,af+600 <br>EntityAutoFade Ent04,af,af+600 <br>RenderWorld 0<br>Return<br><br>.Fade2<br><br>For tt = 1 To trees<br>ShowEntity treeb(tt)<br>ShowEntity treec(tt)<br>	If Not EntityInView(Treeb(tt),camera) Then HideEntity Treeb(tt) <br>	If Not EntityInView(Treec(tt),camera) Then HideEntity Treec(tt)<br><br>EntityAutoFade Treeb(tt),af,af+300 <br>EntityAutoFade Treec(tt),af,af+300 <br>Next <br>Return<br><br><br>.Fade3<br>For tt = 1 To trees<br>	If Not EntityInView(Treeb(tt),camera) Then HideEntity Treeb(tt) Else ShowEntity treeb(tt)<br>	If Not EntityInView(Treec(tt),camera) Then HideEntity Treec(tt) Else ShowEntity treec(tt)<br>Next <br>Return<br>.cam01<br>CameraRange (camera,0.1,cr)<br>Return<br><br>.cam02<br>CameraRange (camera,0.1,100000)<br>Return<br><br>Function show_info()<br>	<br>	frame_count = frame_count + 1<br><br>	If MilliSecs() &gt; fps_timeout Then<br>		fps_timeout = MilliSecs() + 1000 <br>		fps = frame_count <br>		frame_count = 0 <br>	EndIf <br>	<br>	If frame_time &gt; slowest_frame Then slowest_frame = frame_time<br>	<br>;	Text 10,0, "direction: " + (EntityYaw(camera)+180)<br>	Text 10,12," Triangles: " + TrisRendered()<br>	Text 10,24," Millisecs: " + frame_time<br>	Text 10,36,"       FPS: " + fps<br>;	Text 10,48," X: "+x#+" Y: "+y#+"  Z: "+z#+" CR: "+CR<br><br>End Function<br><br>;End <br><br>You will need your own trees, trunks, and textures for leaves though. <br><br></td></tr></table><br>
<a name="265706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any chance you could e-mail me the source code and the media files. Send to<br><br>rosscrooks@... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
