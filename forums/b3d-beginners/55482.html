<!DOCTYPE html><html lang="en" ><head ><title >Slowing down ??</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Slowing down ??</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Slowing down ??</a><br><br>
<a name="617572"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Simmo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>Having trouble with my attempt at a game slowing down ? even if I just sit and move the ship left and right without firing a shot it suddenly slows right down ?...The other thing I was scratching my head about was the fact that when I put my Setbuffer backbuffer() command at the top of the code the gamescreen flickered terribly...Moved it to the main game loop and its fine ?...Scuse the code in general..its my first attempt at something a bit bigger than "Hello World " !!  Any constructive critisism will be very welcome as it will of course help me learn !!<br><br><br>Code as follows:<br><br><br><br><br>;Space invaders....First attempt!!<br>;By Dave Simmonite<br>;21st Dec 2005<br><br><br>;------------<br>;Stuff to do-<br>;------------<br><br>;Sort out the alien movement !!...............<br>;Draw the images..............................DONE<br>;draw the titlescreen.........................DONE<br>;Sort out ther types and their fields.........DONE<br>;Define the correct functions ................ONGOING<br>;Sort out the Music...........................SOON<br>;Sort out constants - variables etc...........ADDING AS REQ<br>;Do a screen for the keymapping...............DONE<br><br><br>;Functions:<br><br>;drawtitlescreen().........Draws the titlescreen and play music intro<br>;drawgamescreen()..........Draws the game<br>;Checkinput()..............Check for movement and collisions<br>;update()..................Move the missile upwards<br>;Drawenemy()...............Draw the aliens<br>;Movealien()...............Move the aliens accros and down<br>;Check_Collision().........Check for missile hitting alien<br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br>;------------------------<br>;Variables and constants-<br>;------------------------<br><br>Const width = 1024        ;Graphics height<br>Const height = 768        ;Graphics width<br>Const quit =1             ;Escape key scancode<br>Const leftkey = 203       ;left arrow key scancode<br>Const rightkey = 205      ;right arrow key scancode<br>Const firekey = 57        ;spacebar scancode<br>Const playerspeed = 7     ;Speed that player moves<br>Const enemyspeed = 5      ;Speed that alien moves<br>Const missilespeed = 20   ;Speed of bullet<br>Global xorigin = 24       ;Origin of first alien x position<br>Global yorigin = 12       ;Origin of first alien y position<br>Const  score = 0          ;Starting score <br>Const lives = 3           ;Starting lives<br> <br>;---------------------------------------------------------------------------------------------------------------|<br><br><br><br>;--------------<br>;SOUND EFFECTS-<br>;--------------<br><br><br>Global clip=LoadSound ("C:\blitzsounds/assholes.wav") <br>Global gunshot=LoadSound ("C:/blitzsounds/gunshot.wav")<br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br><br><br>Graphics width,height,32,1  ; set graphics to 1024 x 768 and run at 32 bit colour in fullscreen mode<br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br>;------<br>;TYPES-<br>;------<br><br><br>Type ship<br><br>	Field xpos<br>	Field ypos<br>	Field hits<br>	Field image<br><br>End Type<br><br><br>Type alien<br><br>	Field x,y<br>	<br>	Field hits<br>	<br>	<br>End Type<br><br><br>Type bullet<br><br>	Field x<br>	Field y<br>	 <br><br>End Type<br><br><br>Global player.ship = New ship<br><br>	player\xpos=512<br>	player\ypos =650<br>	player\hits = 0<br>	player\image = LoadImage("spaceship001.jpg")<br>	 <br><br><br>	<br>;---------------------------------------------------------------------------------------------------------------|<br><br><br>;---------------<br>;Main game loop-<br>;---------------<br><br><br>drawtitlescreen()   ; call the drawtitlescreen function<br><br>SetBuffer BackBuffer()  ; Make sure that this is put in the correct place or it screws the game up !!!! <br>                        ; It causes the gamescreen to flicker ...Dont know why yet ??<br><br><br>While Not KeyHit(quit)<br><br><br><br>drawgamescreen()    ; call the drawgamescreen function<br><br>checkInput()<br><br>update()<br><br>drawenemy()<br><br>movealien()<br><br>Flip<br><br>Wend<br><br>;-------------------<br>;End main game loop-<br>;-------------------<br><br>;---------------------------------------------------------------------------------------------------------------|<br><br><br>;----------<br>;FUNCTIONS-<br>;----------<br><br><br>Function drawtitlescreen()   ; Define function for the titlescreen<br><br>	<br>	titlescreen =  LoadImage("titlescreen.jpg")<br>	<br>	DrawImage titlescreen,0,0<br>	<br>	    <br>	PlaySound clip                                   <br>	<br>	Delay 5000<br>	<br>	Text 80,60,"RIGHT ARROW KEY TO MOVE SHIP RIGHT"<br>	Delay 2000<br>	Text 80,80,"LEFT ARROW KEY TO MOVE SHIP LEFT "<br>	Delay 2000<br>	Text 80,100,"SPACE TO FIRE"	<br>	Delay 2000<br>	Text 80,140,"ESCAPE KEY WILL QUIT IF YOU CANT TAKE IT!!!" <br>	Delay 2000<br>	Text 80,180,"PRESS ANY KEY TO CONTINUE....."	<br>	WaitKey<br><br>	<br>	<br>	<br>End Function<br><br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br><br><br>Function drawgamescreen()   ; Draw the starting screen<br><br>	Cls<br>	<br>	<br>	DrawImage player\image,player\xpos,player\ypos<br>	<br>	<br>	Text 50,730,"SCORE..." + score<br>	Text 850,730, "LIVES LEFT..." + lives<br>End Function<br><br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br><br><br><br>Function checkinput()  ; Check for keys pressed...<br><br><br><br>	If KeyHit(firekey)  	<br>		<br>		PlaySound gunshot		<br>		<br>		bullet.bullet= New bullet<br>		<br>		bullet\x =player\xpos -5<br>		bullet\y = player\ypos-15<br>		<br>			<br>	EndIf<br><br><br><br><br>	If KeyDown (rightkey)            ;Move ship to the right<br>	<br>	<br>	<br>	 player\xpos = player\xpos + playerspeed<br>	<br>	<br>		If player\xpos &gt; width - 80  ; 80 is the player image width...this stops it going offscreen  <br>			player\xpos= width -80<br>			<br>		EndIf<br>		<br>	<br>		<br>	EndIf<br>	<br>	<br>	<br>	<br>	<br>	<br>	If KeyDown (leftkey)             ; Move ship left<br>	<br>	 player\xpos = player\xpos - playerspeed<br>	<br>		If player\xpos &lt;0<br>			player\xpos=0<br>			<br>		EndIf<br>		<br>		<br>	EndIf	<br>	<br>	<br>	<br>End Function<br><br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br><br><br><br>Function update()                 ; This moves the bullet upwards<br><br>	missile = LoadImage ("c:\blitzpics\missile.jpg")<br><br>	For bullet.bullet=Each bullet<br>		 bullet\y = bullet\y -10          ; -10 is the speed it will travel...this can be altered to suit<br>		<br>		If bullet\y &lt; 0<br>			Delete bullet<br>			Else DrawImage missile,bullet\x,bullet\y<br><br>		EndIf<br><br><br>	Next<br><br>End Function<br><br><br><br><br>Function drawenemy()<br><br>	<br><br>	enemyship = LoadImage ("C:\blitzpics\alien.jpg")<br>	<br>	enemy.alien = New alien<br>	<br>	enemy\x = xorigin<br>	enemy\y = yorigin<br><br>	For numenemy = 0 To 59<br>	<br>		DrawImage enemyship,enemy\x,enemy\y<br>	enemy\x = enemy\x + 80<br>	<br>	If enemy\x &gt;width - 64<br>		enemy\x = xorigin<br>		enemy\y = enemy\y + 64<br>		<br>		EndIf<br><br>	<br>	<br>	<br><br>	Next<br><br><br><br><br>End Function<br><br><br><br>;---------------------------------------------------------------------------------------------------------------|<br><br><br><br>Function movealien()   ; Need to sort this out not finished yet !<br><br><br><br>	For enemy.alien = Each alien<br>	    <br>	enemy\x = enemy\x + 16<br>	<br>	If enemy\x &gt;width - 32<br>	<br>		enemy\y = enemy\y + 64<br>		<br>		enemy\x = enemy\x - 16<br><br>	EndIf<br><br><br>	Next<br><br><br>End Function<br><br><br><br><br>;--------------------------------------------------------------------------------------------------------------|<br><br><br><br>Function check_collision ()  ;This the next step to work on<br><br><br>End Function<br><br><br>;--------------------------------------------------------------------------------------------------------------| <br><br></td></tr></table><br>
<a name="617583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >W</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> For being one of your first programs I think your on the right track!! At a glance, your game could be slowing down because you are loading things in your functions and not in your initialization section before the main loop.<br><br>for example in this function you loaded enemyship in your function, which I have learned is a bad thing<br>;=======================<br>Function drawenemy()<br><br><br><br>enemyship = LoadImage ("C:\blitzpics\alien.jpg")<br>;=========================<br><br>as for the flickering, I myself have always set my buffer right after the initial graphicsmode call. I have encountered screen flickering like you described and it was when I had used the flip command too much or in an inconvenient place. <br>-Soo hope any of this helps some <br><br></td></tr></table><br>
<a name="617586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's OK to load your your titlescreen in the function like you do, because it only occurs once during the game.  You should however, free the image from memory (with FreeImage) at the end of your titlescreen function, because you are done using it.<br><br>However, as W pointed out, loading images (or any external files) in a function that is repeatedly called (like your drawenemy() and update() functions) is an extremely bad idea.  You are calling those functions at the speed that your monitor updates (at least 50 times a second) and you are just filling up all the ram in your computer with useless images.<br><br>Move the loading routines to the beginning of the program and make their variable Global, so that you can use them in your functions.  Like so:<pre class=code>Global enemyship = LoadImage ("C:\blitzpics\alien.jpg")</pre><br><br>Also, where you place SetBuffer BackBuffer() is not of any real concern as long as it's after the Graphics call, but it doesn't need to be in your main game loop.  Just move it to just before your game loop and everything will be fine.<br>Just so you realize it, you've already placed that command<br> BEFORE your game loop so there's no need to move it (Your ;Main game loop- comment is not in the correct place).<br><br>By the way, when posting code, use the forum tags: <a href="/faq/faq_entry.php?id=2" >What are the forum codes?</a> <br><br></td></tr></table><br>
<a name="617654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I noticed that you are intermixing forward-slash and backward-slash characters in your load commands.  Maybe Blitz doesn't care which one you use, but you might want to be at least consistent:<br><pre class=code>Global clip=LoadSound ("C:\blitzsounds/assholes.wav") 
Global gunshot=LoadSound ("C:/blitzsounds/gunshot.wav")
</pre> <br><br></td></tr></table><br>
<a name="617692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You flickering problem is really strange since it seems you really use FLIP only one time in the whole program, as well as SETBUFFER.<br><br>you may try to replace<br><br>FLIP<br>by<br>VWAIT:FLIP 0<br><br>and see it it helps <br><br></td></tr></table><br>
<a name="617699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1) use Setbuffer Backbuffer() Immediately AFTER calling the Graphics command, and nowhere else. (to get the above working)<br><br>2) Inside your Drawtitlescreen, use FLIP before the DELAY 5000 line. Because you've set the current buffer to BackBuffer, all images will have been drawn "behind he scenes" and will need to be bought forward with FLIP.<br><br>3) Load ALL media outside of functions and loops- In an INIT section of code. This will fix the slowdown issue.<br><br>and what the others said :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
