<!DOCTYPE html><html lang="en" ><head ><title >2D Lighting</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >2D Lighting</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >2D Lighting</a><br><br>
<a name="1090538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello guys, its been quite awhile since I took the time to come on here and post, or messed with B3D for that matter. I've mostly been learning C++ and now my B3D code even has the habit of adding ; at the end of it.<br>Anyway, enough about what I've been up to. I'm trying to create 2D lighting in Blitz3D, I know that the Read and Write Pixel commands are slowish, but I'm sure we could find a work around, my main problem is coming up with a algorithm to get the pixels.<br><br><br><br><br>Any help would be appreciated. <br>Thanks,<br>        Zac <br><br></td></tr></table><br>
<a name="1090545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean by 2D lighting?<br><br>Are we talking lighting of a 2D top down scene? Isometric? <br><br></td></tr></table><br>
<a name="1090546"></a>

<a name="1090547"></a>

<a name="1090548"></a>

<a name="1090549"></a>

<a name="1090550"></a>

<a name="1090551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> 2D top down or side ways, no isometric what so ever.<br>Sorry for the slowish reply.<br><br><br>I'm currently TRYING something along these lines.<br><br><pre class=code>

;Lighting
Function Maximum(Arg1,Arg2)

If(Arg1 &gt; Arg2)
Return Arg1 
Else 
Return Arg2
EndIf 

End Function 

Function Minimum(Arg1,Arg2)

If(Arg1 &lt; Arg2)
Return Arg1
Else 
Return Arg2
EndIf 

End Function 

Function Calculate(Object1X,Object1Y,Object1W,Object1H,Object2X,Object2Y,Object2W,Object2H)


X1 = Maximum(Object1X,Object2X)
Y1 = Maximum(Object1Y,Object2Y)
X2 = Minimum(Object1X + Object1W, Object2X + Object2W)
Y2 = Minimum(Object1Y + Object1H, Object2Y + Object2H)


Width = X2 - X1
Height = Y2 - Y1

If Width &gt; 0 And Height &gt; 0

ReturnBank = CreateBank(15)
PokeInt ReturnBank,0,X1
PokeInt ReturnBank,4,Y1
PokeInt ReturnBank,8,Width
PokeInt ReturnBank,12,Height

Return ReturnBank 

Else 

ReturnBank = CreateBank(15)

Return ReturnBank 

EndIf 

End Function 

</pre><br><br>Look at the math, I'm not sure if this is anywhere, near correct,<br>but its close to what I did in SDL, to get Per-Pixel Collision, using<br>SDL Tutorials. <br><br>I would get the X and Y of the object and the width and height.<br>Then I would go through a For loop, for X = 0 to Width <br>and For Y = 0 to Height, to get each individual pixel at X,Y<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090574"></a>

<a name="1090578"></a>

<a name="1090583"></a>

<a name="1090585"></a>

<a name="1090587"></a>

<a name="1090588"></a>

<a name="1090589"></a>

<a name="1090591"></a>

<a name="1090595"></a>

<a name="1090609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, that'll work for getting if the pixels are in range. I now just need to read and write per a pixel at that point. Wish me luck.<br><br>Right, so either I completely, don't understand pixel editing with Blitz3D or something about this code isn't 100% correct.<br><br>I borrowed code from Ross C, at this thread: <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=64678" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=64678</a><br>Complete credit goes to him for that, I'm just using it for <br>testing. I used his Pixel editing.<br><br><pre class=code>

;Lighting
Function Maximum(Arg1,Arg2)

If(Arg1 &gt; Arg2)
Return Arg1 
Else 
Return Arg2
EndIf 

End Function 

Function Minimum(Arg1,Arg2)

If(Arg1 &lt; Arg2)
Return Arg1
Else 
Return Arg2
EndIf 

End Function 

Function Calculate(Object1X,Object1Y,Object1W,Object1H,Object2X,Object2Y,Object2W,Object2H)


X1 = Maximum(Object1X,Object2X)
Y1 = Maximum(Object1Y,Object2Y)
X2 = Minimum(Object1X + Object1W, Object2X + Object2W)
Y2 = Minimum(Object1Y + Object1H, Object2Y + Object2H)


Width = X2 - X1
Height = Y2 - Y1

If Width &gt; 0 And Height &gt; 0

ReturnBank = CreateBank(16)
PokeInt ReturnBank,0,X1
PokeInt ReturnBank,4,Y1
PokeInt ReturnBank,8,Width
PokeInt ReturnBank,12,Height

Return ReturnBank 

Else 

ReturnBank = CreateBank(16)

Return ReturnBank 

EndIf 

End Function 

Function EditAlpha(X,Y,Alpha)

RGB1=ReadPixel(X,Y)
r=(RGB1 And $FF0000)Shr 16
g=(RGB1 And $FF00) Shr 8
b=RGB1 And $FF
a=(RGB1 And $FF000000)Shr 24

a=Alpha

Return newrgb = (a Shl 24) Or (r Shl 16) Or (g Shl 8) Or b

End Function 

;End Functions;

Graphics 800,600
CakeImg = LoadImage("Cake1.bmp")
CakeImg2 = LoadImage("Cake2.bmp")
MaskImage CakeImg,255,0,0

Lolz = Maximum(200,180) ;Object 1 = 100 X, Object 2 = 68 X
Lolz2 = Maximum(200,180) ; Object 1 = 100 Y, Object 2 = 68 Y
Lolz3 = Minimum(232,212); Object 1 Y + H = 132, Object 2 Y + H = 100
Lolz4 = Minimum(132,212)
Col = Calculate(200,200,32,32,180,180,32,32)

While Not KeyHit(1)
Cls 
DrawImage CakeImg,200,200
DrawImage CakeImg2,180,180

Text 0,12,"Maximum X:" + Lolz
Text 0,24,"Maximum Y:" + Lolz2
Text 0,36, "Minimum Y + H:" + Lolz3
Text 0,48, "Minimum X + W:" + Lolz4
Text 0,60, "Collision Pos X:" + PeekInt(Col,0)
Text 0,72, "Collision Pos Y:" + PeekInt(Col,4)
Text 0,84, "Collision Pixel W:" + PeekInt(Col,8)
Text 0,96, "Collision Pixel H:" + PeekInt(Col,12)

For x = PeekInt(Col,0)  To PeekInt(Col,0) + PeekInt(Col,8)  
For y =  PeekInt(Col,4) To PeekInt(Col,4) + PeekInt(Col,12)  
EditAlpha(x,y,0)
Next
Next 

Flip 

Wend 

</pre><br><br>Right, so my entire basis, is futile. In Blitz3D it seems alpha is ALWAYS<br>set to 255. I don't wanna switch to 3D, so any suggestions to where, I won't have too are really appreciated.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matt Vinyl</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Naïvely or not, one of the key reasons I moved over to BMax was the ease of it's blending modes (Alpha, Colour, etc.) A shame there was no similar functionality in B3D. <br><br></td></tr></table><br>
<a name="1090621"></a>

<a name="1090622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> For, I have also considered moving over to BMax, but I don't have much experience with it, yet, nor do I have the money to purchase it right now.<br><br>I like doing things in C++, but without using all these libraries, that<br>either cost or make it where you can only  create non-commercial products,<br>I have to create collision functions and what not myself, which<br>takes me a good bit of math and greatly decreases productivity.<br><br>Then again, I had to use the same collision code, I used for per-pixel collision(I learned it at SDL tutorials(giving credit, so I aint "stealing"))<br>to check if the "light" intersects with the image, on this code.<br><br>Decisions, decisions.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090627"></a>

<a name="1090628"></a>

<a name="1090630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, writing this tile map editor, having "moving tiles" translate<br>to on screen, if the "camera" is over them, made Blitz3D freeze to death<br>and my CPU (Quad Core 3.2..) fan's speed up, because it got hotter,<br>really fast too.<br><br>Edit: Ah, the "Print" command I had trying to keep up with it,<br>is what froze everything. Fail print..<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Remember, if the screen is of high enough resolution, you may get away with a checkered pattern shadow. Just a checkered pattern of black pixels and masked pixels. This will appear as a shadow effect. At low resolutions, it looks bad though... :) <br><br></td></tr></table><br>
<a name="1090801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think it is easiest to use 2D-in-3D graphics if you need special effects, such as alpha blending, rotation, scaling and additive blend. <br><br></td></tr></table><br>
<a name="1090828"></a>

<a name="1090829"></a>

<a name="1090830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> It more then likely is, I'm probably going to be stick to plain 2D till I get ALL this tile mapper done. I'm adding in a basic button system, cause hitting 20 different keys to assign values, is tiring. After I do that, I think I'm going to look into Blitz3D's Camera's ortho projection. <br><br>Using the ortho projection and sprites, I could get a kick ass look, because even though I really didn't wanna use 2D-in-3D, it'll be better for effects and speed. So, no reason not too. Lolz<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090833"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> In that case, the following archive entry provides functions that should make such a transistion (from 2d to 3d) easier: <a href="http://www.blitzmax.com/codearcs/codearcs.php?code=2680" target="_blank">http://www.blitzmax.com/codearcs/codearcs.php?code=2680</a> <br><br></td></tr></table><br>
<a name="1090838"></a>

<a name="1090842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats pretty good looking, thanks :)<br><br>Yo, for the record, MouseHit can cause some funk errors. Having it check if images over lap AND mousehit(1) will only make my first "button" react, but if I change it to if ImagesOverlap then if mousehit(1) they all react.<br>Just something interesting I found to share..<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Store MouseHit in a variable, then use that variable. Basically, it should only be used once a loop. <br><br></td></tr></table><br>
<a name="1090855"></a>

<a name="1090857"></a>

<a name="1090858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good point I didn't think about that, but just throwing it after the for loop, fixes that. :) I'm now working on converting this while tile mapper to 2D-in-3D, wish me luck. I probably won't get far to day, but I'm a try.<br><br>Right, so sprites aren't the way for things like this I hear. So, I'm hearing using quads is the way to go. <br><br>If I'm not mistaken(which I might be) a quad is just 2 triangles in a flat surface, yes?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090861"></a>

<a name="1090862"></a>

<a name="1090863"></a>

<a name="1090865"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> How does one go about a quad? because trying my method: <br><br>Type Quad<br>Field X<br>Field Y<br>Field Z<br>Field Width<br>Field Height<br>Field Mesh <br>End Type <br><br>Function CreateQuad(X,Y,W,H,Z)<br>Q.Quad = New Quad<br>Q\X = X<br>Q\Y = Y <br>Q\Z = Z<br>Q\Width = W<br>Q\Height = H<br>Q\Mesh = CreateMesh()<br>End Function <br><br><br>Function DrawQuads()<br>For Q.Quad = Each Quad <br>TempSurface = CreateSurface(Q\Mesh)<br><br>Vertex1 = AddVertex(TempSurface,Q\X,Q\Y,Q\Z)<br>Vertex2 = AddVertex(TempSurface,Q\X + Q\Width,Q\Y,Q\Z)<br>Vertex3 = AddVertex(TempSurface,Q\X,Q\Y + Q\Height,Q\Z)<br>Vertex4 = AddVertex(TempSurface,Q\X + Q\Width,Q\Y + Q\Height,Q\Z)<br><br>AddTriangle(TempSurface,Vertex1,Vertex2,Vertex3)<br>AddTriangle(TempSurface,Vertex4,Vertex2,Vertex3)<br><br>PositionEntity Q\Mesh,Q\X,Q\Y,Q\Z<br>Next <br>End Function <br><br><br>this doesn't do anything at all. Do I use a single mesh or a single surface per a quad? I really have no clue how to go about this.<br>Lolz <br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your method seems to work, it only shows one triangle instead of two, because the second triangle you add isn't right. It should be Vertex3,Vertex2,Vertex4<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Type Quad
Field X
Field Y
Field Z
Field Width
Field Height
Field Mesh
End Type

Function CreateQuad(X,Y,W,H,Z)
Q.Quad = New Quad
Q\X = X
Q\Y = Y
Q\Z = Z
Q\Width = W
Q\Height = H
Q\Mesh = CreateMesh()
End Function


Function DrawQuads()
	For Q.Quad = Each Quad
		TempSurface = CreateSurface(Q\Mesh)

		Vertex1 = AddVertex(TempSurface,Q\X,Q\Y,Q\Z)
		Vertex2 = AddVertex(TempSurface,Q\X + Q\Width,Q\Y,Q\Z)
		Vertex3 = AddVertex(TempSurface,Q\X,Q\Y - Q\Height,Q\Z)
		Vertex4 = AddVertex(TempSurface,Q\X + Q\Width,Q\Y - Q\Height,Q\Z)


		AddTriangle(TempSurface,Vertex1,Vertex2,Vertex3)
		AddTriangle(TempSurface,Vertex4,Vertex2,Vertex2)

		PositionEntity Q\Mesh,Q\X,Q\Y,Q\Z
	Next
End Function 

Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

cam = CreateCamera()
MoveEntity cam, 0, 0, -15

CreateQuad(0, 0, 1, 1, 1)
DrawQuads()

Repeat


	RenderWorld
	Flip
	
Until KeyHit(1)

End

</textarea><br>You can, however, use a single mesh for all quads. That is faster than using one mesh pro quad. First, add vertices+triangles for each quad, and remember their vertex index (store Vertex1,2,3,4)<br>Later on, when updating the quads, use VertexCoords to change the position of the existing vertices. <br><br></td></tr></table><br>
<a name="1090866"></a>

<a name="1090868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, thanks Warner, you're a life saver.<br><br>I was misunderstanding how the triangles are drawn, I suppose.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090867"></a>

<a name="1090869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I posted a tilemap type thing in another thread, creating a tilemap mesh, giving each quad the ability to display different parts of a texture:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Global screen_resolution_width = 800
Global screen_resolution_height = 600

Graphics3D screen_resolution_width,screen_resolution_height
SetBuffer BackBuffer()


Global camera = CreateCamera()
PositionEntity camera,screen_resolution_width*0.5,-screen_resolution_height*0.5,-screen_resolution_width*0.5
CameraRange camera,0.1,1000


s = CreateSphere()

EntityColor s,255,0,0
PositionEntity s,400,-300,0


Global texture_width# = 512
Global texture_height# = 512

Global num_tiles_wide = 12
Global num_tiles_high = 12

Global tile_width# = texture_width/num_tiles_wide
Global tile_height# = texture_height/num_tiles_high


;DebugLog("tile width = "+tile_width)

texture = CreateTexture(texture_width,texture_height)
SetBuffer TextureBuffer(texture)

For xloop = 0 To num_tiles_wide-1
	For yloop = 0 To num_tiles_wide-1
		Color Rand(0,255),Rand(0,255),Rand(0,255)
		Rect xloop*tile_width, yloop*tile_height,tile_width,tile_height
		;DebugLog("Rect("+(xloop*tile_width)+","+(yloop*tile_height)+","+tile_width+","+tile_height)
	Next
Next

SetBuffer BackBuffer()



Dim tilemap(num_tiles_wide,num_tiles_high,4)

tile_mesh = CreateMesh()
tile_surf = CreateSurface(tile_mesh)
create_mesh_tilemap(tile_mesh,tile_surf,num_tiles_wide,num_tiles_high,tile_width,tile_height)

EntityTexture tile_mesh,texture


While Not KeyHit(1)

	frame_time = MilliSecs() - temp_time
	temp_time = MilliSecs()


	For loop = 1 To 100
		change_tile(tile_surf,Rand(0,11),Rand(0,11),Rand(0,11),Rand(0,11))
	Next
	
	

	UpdateWorld
	RenderWorld
	Color 255,255,255
	Text 0,0,"frame time - "+frame_time
	Flip
	
Wend
End


Function create_mesh_tilemap(mesh,surf,num_x,num_y,width#,height#)

	Local index = -4

	For xloop = 0 To num_x-1
	
		For yloop = 0 To num_y-1
		
			index = index + 4
			tilemap(xloop,yloop,4) = index
			tilemap(xloop,yloop,0) = AddVertex(surf,xloop*width        ,-yloop*height         ,0, (1.0/num_x)*xloop            ,(1.0/num_y)*yloop            ) ; top left
			tilemap(xloop,yloop,1) = AddVertex(surf,xloop*width + width,-yloop*height         ,0, (1.0/num_x)*xloop+(1.0/num_x),(1.0/num_y)*yloop            ) ; lop right
			tilemap(xloop,yloop,2) = AddVertex(surf,xloop*width        ,-yloop*height - height,0, (1.0/num_x)*xloop            ,(1.0/num_y)*yloop+(1.0/num_y)) ; bottom left
			tilemap(xloop,yloop,3) = AddVertex(surf,xloop*width + width,-yloop*height - height,0, (1.0/num_x)*xloop+(1.0/num_x),(1.0/num_y)*yloop+(1.0/num_y)) ; bottom right
			
			;s = CreateSphere()
			;PositionEntity s,xloop*width        ,-yloop*height         ,0
			;s = CreateSphere()
			;PositionEntity s,xloop*width + width,-yloop*height         ,0
			;s = CreateSphere()
			;PositionEntity s,xloop*width        ,-yloop*height - height,0
			;s = CreateSphere()
			;PositionEntity s,xloop*width + width,-yloop*height - height,0
			
			;DebugLog("-----------------------------------")
			;DebugLog(" xloop("+xloop+") yloop("+yloop+")")
			;DebugLog("v0("+( xloop*width)       +","+( -yloop*height)        +",0)"+"("+((1.0/num_x)*xloop)+")")
			;DebugLog("v1("+((xloop*width)+width)+","+( -yloop*height)        +",0)"+"("+( ((1.0/num_x)*xloop)+1.0/num_x)+")")
			;DebugLog("v2("+( xloop*width)       +","+((-yloop*height)-height)+",0)")
			;DebugLog("v3("+((xloop*width)+width)+","+((-yloop*height)-height)+",0)")
			AddTriangle surf,tilemap(xloop,yloop,0),tilemap(xloop,yloop,1),tilemap(xloop,yloop,2)
			AddTriangle surf,tilemap(xloop,yloop,2),tilemap(xloop,yloop,1),tilemap(xloop,yloop,3)

		Next
		
	Next
	UpdateNormals mesh
	
End Function

;function to change the texture showing in tile (x,y) to texture tile (tx,ty)
Function change_tile(surf,x,y,tx,ty)

	VertexTexCoords (surf,tilemap(x,y,4)  ,(1.0/num_tiles_wide)*tx                     ,(1.0/num_tiles_high)*ty                     )
	VertexTexCoords (surf,tilemap(x,y,4)+1,(1.0/num_tiles_wide)*tx+(1.0/num_tiles_wide),(1.0/num_tiles_high)*ty                     )
	VertexTexCoords (surf,tilemap(x,y,4)+2,(1.0/num_tiles_wide)*tx                     ,(1.0/num_tiles_high)*ty+(1.0/num_tiles_high))
	VertexTexCoords (surf,tilemap(x,y,4)+3,(1.0/num_tiles_wide)*tx+(1.0/num_tiles_wide),(1.0/num_tiles_high)*ty+(1.0/num_tiles_high))
	
End Function
</textarea><br><br>There's even a function to change the vertex co-ords of any of the tiles.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090870"></a>

<a name="1090871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you, Ross :D, I'll look into something close to that, the only thing is I'm going to be using, Types for my Tiles. :)<br><br>I have to stop working for now, the girlfriend is coming over, I'll get back to yall at what I experience in this, deep thrilling task, once I get a chance to start back on it.<br><br>:)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090894"></a>

<a name="1090895"></a>

<a name="1090897"></a>

<a name="1090900"></a>

<a name="1090903"></a>

<a name="1090938"></a>

<a name="1090942"></a>

<a name="1090945"></a>

<a name="1090946"></a>

<a name="1090947"></a>

<a name="1090959"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, so going about texturing, any enlightenment on how to do it would be nice. I'm figuring I should, get the textures X,Y,W,H and do it with vertextexcoords, the same way I did it with, the Quad, X,Y,W,H<br><br>Ross' code was good reference, but some more enlightenment on exactly how it works and how to go about it, would be appreciated.<br><br><br>Sorry to ask so many questions, but I'm like learning and feel like a student, so I'm asking the teachers here. Haha..man.<br><br>@Ross: I'm looking at your vertextexcoords and I think when you divide 1.0/12(num tiles wide) and multiply it by TX, it gets the coresponding texture "frame" and starts it there?<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090969"></a>

<a name="1090970"></a>

<a name="1090971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> First you would need to create a texture that contains the tiles. Since textures should have both a width+height that is a power of two, <br>it might be best to base your tilesize on it.<br>The following texture contains a 4x4 grid of tiles. Each tile is 32x32:<br><img src="http://i54.tinypic.com/211kqki.png"><br><br>Then you would need to create a mesh that contains quads. Each quad should <br>use it's own vertices, because texture coordinates are set pro vertex. <br>So don't reuse vertices for multiple quads (no welding).<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

cam = CreateCamera()
MoveEntity cam, 0, 0, -15

screen = CreateMesh()
surf = CreateSurface(screen)

tex = LoadTexture("tiles.png")
EntityTexture screen, tex

For x = 0 To 14
For y = 0 To 9

	AddQuad(surf, x, y)
	
Next
Next

Repeat


	RenderWorld
	Flip
	
Until KeyHit(1)

End

Function AddQuad(surf, qx, qy)

	x# = qx - 7.5
	y# = qy - 4.5
	v0=AddVertex (surf, x + 0, y + 1, 0,   0.0, 0.0)
	v1=AddVertex (surf, x + 1, y + 1, 0,   1.0, 0.0)
	v2=AddVertex (surf, x + 1, y + 0, 0,   1.0, 1.0)
	v3=AddVertex (surf, x + 0, y + 0, 0,   0.0, 1.0)
	AddTriangle surf, v0, v1, v2
	AddTriangle surf, v0, v2, v3
	
End Function</textarea><br>The uv coordinates for each quad are set to the range 0.0 to 1.0<br>This means on each quad, the entire texture is rendered.<br>If you want only one of the tiles to be placed on the quad, change the <br>coordiates to the range 0 to 0.25 instead.<br>Both the width and the height of the texture should be divided into 4 <br>parts:  1 / 4 = 0.25<br><br>If you need more tiles, double both the width and height of the texture, <br>and change 0.25 to 0.125<br>It might be a good idea to make this value a Global variable (or Const) so <br>you can change it later on.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I get it, I'm going to experiment a bit, then see how this works out. Thanks for clarifying that. <br><br></td></tr></table><br>
<a name="1090996"></a>

<a name="1090997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right so sorry to double post, but again no one will know that I answered, unless I do it. Anyway, I have been trying my best at this and well.<br>Without setting the vertex coords at the creation of a vertex, I could apply a texture with my texture function, but it wouldn't draw at the correct<br>position. So, I added vertex coords, then it wouldn't draw a new texture.<br><br>Then I took a break and came back and now, I get a MAV error for the TextureQuad function. I know<br>what a Memory Access Violation is, but I don't see why, I'm getting one.<br>If it was the Q\Surface, then I'd get a MAV for the DrawQuads function,<br>but I don't. I know the Q\VertStart Exist, so I donno why, I'm being<br>thrown a MAV error, because it was working at first, it just didn't draw<br>the new texture, lolz. I followed your suggestion, Warner and did 4x1 because that is easily dividable, I only have 1 Y because, its a old habbit of making straight strips out of my tiles. <br><br><pre class=code>
Type Quad
Field Surface
Field Vertex1X,Vertex1Y,Vertex1Z
Field Vertex2X,Vertex2Y,Vertex2Z
Field Vertex3X,Vertex3Y,Vertex3Z
Field Vertex4X,Vertex4Y,Vertex4Z
Field VertStart
End Type 

Function CreateQuad(Mesh,VStart,X,Y,Z,W,H) 
Q.Quad = New Quad
Q\Surface = CreateSurface(Mesh)
Q\Vertex1X = X 
Q\Vertex1Y = Y
Q\Vertex1Z = Z
Q\Vertex2X = X + W
Q\Vertex2Y = Y
Q\Vertex2Z = Z
Q\Vertex3X = X
Q\Vertex3Y = Y - H
Q\Vertex3Z = Z
Q\Vertex4X = X + W
Q\Vertex4Y = Y - H
Q\Vertex4Z = Z
Q\VertStart = VStart
End Function 


Function DrawQuads() 

For Q.Quad = Each Quad
Vert1 = AddVertex(Q\Surface,Q\Vertex1X,Q\Vertex1Y,Q\Vertex1Z,.25,0)
Vert2 = AddVertex(Q\Surface,Q\Vertex2X,Q\Vertex2Y,Q\Vertex2Z,.25,0)
Vert3 = AddVertex(Q\Surface,Q\Vertex3X,Q\Vertex3Y,Q\Vertex3Z,.25,1)
Vert4 = AddVertex(Q\Surface,Q\Vertex4X,Q\Vertex4Y,Q\Vertex4Z,.25,1)


AddTriangle(Q\Surface,Vert1,Vert2,Vert3)
AddTriangle(Q\Surface,Vert3,Vert2,Vert4)
Next 

End Function 

Function TextureQuad(Mesh,Texture,VStart,Frame)

For Q.Quad = Each Quad 

If Q\VertStart = VStart
VertexTexCoords Q\Surface,Q\VertStart   ,.25 * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +1,.25 * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +2,.25 * Frame,1
VertexTexCoords Q\Surface,Q\VertStart +3,.25 * Frame,1
EndIf 
Next 

EntityTexture Mesh,Texture
End Function 


Graphics3D 800,600
SetBuffer BackBuffer()

Cam = CreateCamera()
MoveEntity Cam,0,0,-15

TileMesh = CreateMesh() 
Sur = CreateSurface(TileMesh)
Texture = LoadTexture("Art/TM/TileSheet.bmp",4)
CreateQuad(TileMesh,1,1,1,0,1,1)
TextureQuad(TileMesh,Texture,1,2)

While Not KeyHit(1)

DrawQuads()


RenderWorld
Flip
Wend 
</pre><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091028"></a>

<a name="1091031"></a>

<a name="1091033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a animated guf I did in another thread explaining the theory behind this:<br><br>www.rcsolutions.webspace.virginmedia.com/3duvcoords.gif<br><br>I'll take a look at your code.<br><br>EDIT what i notice first is your "drawing" your quads every frame. Once a mesh is created, it is there. Just point the camera at it RenderWorld(), and it will appear. It's not like 2d graphics in that respect.<br><br>Secondly, remember textures for 3d graphics need to be in power of 2's. so 32x512 etc. Try to keep at maximum, a 8:1 or 1:8 ratio between the width and height of the texture.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, in the texturequad function:<br><br><pre class=code>
VertexTexCoords Q\Surface,Q\VertStart   ,.25 * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +1,.25 * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +2,.25 * Frame,1
VertexTexCoords Q\Surface,Q\VertStart +3,.25 * Frame,1
</pre><br><br>Your vertex co-ords are, assuming frame = 1: v1(.25,0) v2(.25,0) v3(.25,1) v4(.25,1)<br><br>Which would make your texture a flat line, and would be starting from 1/4 the way from the textures left. You need something like:<br><br><pre class=code>
VertexTexCoords Q\Surface,Q\VertStart   ,0   * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +1,.25 * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +2,.0  * Frame,1
VertexTexCoords Q\Surface,Q\VertStart +3,.25 * Frame,1
</pre> <br><br></td></tr></table><br>
<a name="1091049"></a>

<a name="1091050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
VertexTexCoords Q\Surface,Q\VertStart   ,0   * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +1,.25 * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +2,.0  * Frame,1
VertexTexCoords Q\Surface,Q\VertStart +3,.25 * Frame,1
</pre><br><br>Will make the texture sideways, sorry. Thats my bad for posting that untested code, because of the darn MAV. Thanks for helping me solve that too.<br>--This Part--<br><pre class=code>
VertexTexCoords Q\Surface,Q\VertStart   ,0   * Frame,0
VertexTexCoords Q\Surface,Q\VertStart +1,.25 * Frame,1
VertexTexCoords Q\Surface,Q\VertStart +2,.0  * Frame,1
VertexTexCoords Q\Surface,Q\VertStart +3,.25 * Frame,0
</pre><br><br>Makes the texture upright, but, when I try to increase the "Frame" it still doesn't display the correct texture. It rips the first and the texture and the "frame" texture together. At first, the first UVs made when the vertices are made, made it where you couldn't display anywhere after the first "frame". So I removed them, now it tears the first texture<br>and the "frame" texture together. I tried changing all the coords over and over and that got me no where, then I tried moving the "entitytexture" portion around, also no changes. Hm...a interesting day.<br><br>-All the Codes the same, just the "--This Part--" thing is different from yours-<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you provide the texture your using? Also, did you take the drawquads() function out, because that shouldn't be there. <br><br></td></tr></table><br>
<a name="1091163"></a>

<a name="1091164"></a>

<a name="1091165"></a>

<a name="1091166"></a>

<a name="1091167"></a>

<a name="1091169"></a>

<a name="1091170"></a>

<a name="1091171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I took drawquads out of the game loop, if thats what you mean. <br><br><a href="http://imageshack.us/photo/my-images/804/tilesheetz.png/" target="_blank">http://imageshack.us/photo/my-images/804/tilesheetz.png/</a><br><br><br>Thats the re-done image, I cleaned out the old one yesterday, it is the exact same width and height and does the same thing. Image shack turned it into a .png its original a .bmp.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091188"></a>

<a name="1091189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've noticed a couple of things. Firstly, your creating a new surface for every quad you create. And you create a surface before that:<br><br><pre class=code>
Sur = CreateSurface(TileMesh)
</pre><br><br>You only need to create this surface above. Creating a surface in your createquad function isn't needed. Following on from this, you only need to texture your mesh once also, so that doesn't need a seperate function. I have converted your texturequad function, into set frame. You simply pass across a vstart (a multiple of 4, you will need to keep track of them), and a frame, from 0 to 3 in this case.<br><br>Secondly, based on the above, you need to keep a global index counter. Everytime you create a quad, assign this index to your type field "vstart", then increment this counter forward by 4.<br><br>Also, pass across your surface to the createquad and texturequad function. The mesh is of no relevance, as each surface is unique and can only be associated with one mesh.<br><br>Additionally, make your mesh and surface you create global variables, same with your texture, so they don't get lost.<br><br>Also, put the contents of your drawquad into the createquad function, so you are creating the vertices and creating the triangles all in the one place.<br><br>Lastly, I buggered up when suggesting the UV co-ords. It should have been:<br><br><pre class=code>
	Vert1 = AddVertex(Q\Surface,Q\Vertex1X,Q\Vertex1Y,Q\Vertex1Z,.25 * Frame        ,0)
	Vert2 = AddVertex(Q\Surface,Q\Vertex2X,Q\Vertex2Y,Q\Vertex2Z,(.25 * Frame) + .25,0)
	Vert3 = AddVertex(Q\Surface,Q\Vertex3X,Q\Vertex3Y,Q\Vertex3Z,.25 * Frame        ,1)
	Vert4 = AddVertex(Q\Surface,Q\Vertex4X,Q\Vertex4Y,Q\Vertex4Z,(.25 * Frame) + .25,1)
</pre><br><br>Because 0 * anything, is always going to be zero. So you need to say, 0.25 (the frame x size) * frame. the exact same goes for the far right vertex, except you add on the width of a frame.<br><br>So, the full code is:<br><br><pre class=code>
Type Quad
Field Surface
Field Vertex1X,Vertex1Y,Vertex1Z
Field Vertex2X,Vertex2Y,Vertex2Z
Field Vertex3X,Vertex3Y,Vertex3Z
Field Vertex4X,Vertex4Y,Vertex4Z
Field VertStart
End Type 

Function CreateQuad(Surface,X,Y,Z,W,H) 
	Q.Quad = New Quad
	Q\Surface = surface
	Q\Vertex1X = X 
	Q\Vertex1Y = Y
	Q\Vertex1Z = Z
	Q\Vertex2X = X + W
	Q\Vertex2Y = Y
	Q\Vertex2Z = Z
	Q\Vertex3X = X
	Q\Vertex3Y = Y - H
	Q\Vertex3Z = Z
	Q\Vertex4X = X + W
	Q\Vertex4Y = Y - H
	Q\Vertex4Z = Z
	Q\VertStart = vertex_index
	vertex_index = vertex_index + 4
	
	Vert1 = AddVertex(Q\Surface,Q\Vertex1X,Q\Vertex1Y,Q\Vertex1Z,.25 * Frame        ,0)
	Vert2 = AddVertex(Q\Surface,Q\Vertex2X,Q\Vertex2Y,Q\Vertex2Z,(.25 * Frame) + .25,0)
	Vert3 = AddVertex(Q\Surface,Q\Vertex3X,Q\Vertex3Y,Q\Vertex3Z,.25 * Frame        ,1)
	Vert4 = AddVertex(Q\Surface,Q\Vertex4X,Q\Vertex4Y,Q\Vertex4Z,(.25 * Frame) + .25,1)
		
	
	AddTriangle(Q\Surface,Vert1,Vert2,Vert3)
	AddTriangle(Q\Surface,Vert3,Vert2,Vert4)
	
End Function 



Function SetFrame(VStart,Frame)

	For Q.Quad = Each Quad 
	
		If Q\VertStart = VStart
			VertexTexCoords Q\Surface,Q\VertStart   ,.25 * Frame        ,0
			VertexTexCoords Q\Surface,Q\VertStart +1,(.25 * Frame) + .25,0
			VertexTexCoords Q\Surface,Q\VertStart +2,.25 * Frame        ,1
			VertexTexCoords Q\Surface,Q\VertStart +3,(.25 * Frame) + .25,1
		EndIf 
	Next 
	
End Function 


Graphics3D 800,600
SetBuffer BackBuffer()

Cam = CreateCamera()
MoveEntity Cam,0,0,-5

Global vertex_index = 0
Global TileMesh = CreateMesh() 
Global Sur = CreateSurface(TileMesh)
Global Texture = LoadTexture("Art/TM/TileSheet.bmp",4)
EntityTexture TileMesh,Texture

CreateQuad(Sur,1,1,0,1,1)
SetFrame(0,0)

While Not KeyHit(1)



	RenderWorld
	Flip
Wend
End
</pre><br><br>Sorry if you didn't won't single surface, but I think this will really drag without it.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091193"></a>

<a name="1091195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, see when this topic started out, it was about lighting, then finding out 2D cannot do much at all(lolz). Then it turned into talking about quads, so its not what I "want" I'm just trying to learn new techniques in B3D.<br><br>I owe ya one Ross, I'm a check this out.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> No bother man. Once you get the basics for the 2d tile map, you can get shadows working :) <br><br></td></tr></table><br>
<a name="1091198"></a>

<a name="1091199"></a>

<a name="1091200"></a>

<a name="1091201"></a>

<a name="1091202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> ^^ I think, I'm going to make the "global vertex counter" thing, be timed by the number of quads. So that if I have to delete a quad on the fly, then all the vertices would be translated over.<br><br>Example:<br><pre class=code>
Global Quads = 0
Global Vertices = Quads * 4

CreateQuad(somesurface,somex,somey,somez,somewidth,someheight) &lt;-1
CreateQuad(somesurface,somex,somey,somez,somewidth,someheight) &lt;-2

RemoveQuad(2)
</pre> <br><br>Would translating vertices when a quad gets deleted, be a smart idea?<br>That way, theres no gaps.<br><br>Like this would cause:<br><pre class=code>
CreateQuad(somesurface,somex,somey,somez,somewidth,someheight) &lt;-1
CreateQuad(somesurface,somex,somey,somez,somewidth,someheight) &lt;-2
CreateQuad(somesurface,somex,somey,somez,somewidth,someheight) &lt;-3

RemoveQuad(2)
</pre><br><br>Because doing this, without translating the vertices over, Quad 3's<br>vertices would be 8-11 and Quad 1's would be 0-3. But if that doesn't really matter..I donno lolz. I just think it'd be a good idea.<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dunno. Why would you want to delete a quad, or a tile, in a tilemap engine? You could always just hide it, by setting the VertexAlpha on each of it's 4 vertices. And remember, deleting vertices requires the whole mesh to be rebuilt.<br><br>You could house all your vertex index data in an array:<br><br>tile(1,0) = vertex_index<br><br>etc,<br><br>that way when you want to access a tile, you simple call the tiles(x,y) location:<br><br>SetFrame(x,y,frame)<br><br><pre class=code>
Function SetFrame(x,y,Frame)

	Vstart = tile(x,y)  

	For Q.Quad = Each Quad 
	
		If Q\VertStart = VStart
			VertexTexCoords Q\Surface,Q\VertStart   ,.25 * Frame        ,0
			VertexTexCoords Q\Surface,Q\VertStart +1,(.25 * Frame) + .25,0
			VertexTexCoords Q\Surface,Q\VertStart +2,.25 * Frame        ,1
			VertexTexCoords Q\Surface,Q\VertStart +3,(.25 * Frame) + .25,1
		EndIf 
	Next 
	
End Function
</pre><br><br>That way you don't need to concern yourself with vertex indices, just the x,y location of the tile within the tilemap.<br><br><pre class=code>
Function CreateQuad(Surface,X,Y,Z,W,H,tilex,tiley) 
	Q.Quad = New Quad
	Q\Surface = surface
	Q\Vertex1X = X 
	Q\Vertex1Y = Y
	Q\Vertex1Z = Z
	Q\Vertex2X = X + W
	Q\Vertex2Y = Y
	Q\Vertex2Z = Z
	Q\Vertex3X = X
	Q\Vertex3Y = Y - H
	Q\Vertex3Z = Z
	Q\Vertex4X = X + W
	Q\Vertex4Y = Y - H
	Q\Vertex4Z = Z
	Q\VertStart = vertex_index
	tile(tilex,tiley) = vertex_index
	vertex_index = vertex_index + 4
	
	Vert1 = AddVertex(Q\Surface,Q\Vertex1X,Q\Vertex1Y,Q\Vertex1Z,.25 * Frame        ,0)
	Vert2 = AddVertex(Q\Surface,Q\Vertex2X,Q\Vertex2Y,Q\Vertex2Z,(.25 * Frame) + .25,0)
	Vert3 = AddVertex(Q\Surface,Q\Vertex3X,Q\Vertex3Y,Q\Vertex3Z,.25 * Frame        ,1)
	Vert4 = AddVertex(Q\Surface,Q\Vertex4X,Q\Vertex4Y,Q\Vertex4Z,(.25 * Frame) + .25,1)
		
	
	AddTriangle(Q\Surface,Vert1,Vert2,Vert3)
	AddTriangle(Q\Surface,Vert3,Vert2,Vert4)
	
End Function
</pre><br><br>As above, you'd need to pass across the x,y co-ords of the tile within the tilemap, so the index could be stored within the array.<br><br>Again, ask yourself, do you need to delete tiles from the tilemap? I've never really seen that happen... <br><br></td></tr></table><br>
<a name="1091206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, in a tile map, when first creating it, I create quads when I click, then I remove quads when I right click, so I can remove something from the tile map, but then again, I could just probably hide that one, then reposition it on my next click. <br><br></td></tr></table><br>
<a name="1091207"></a>

<a name="1091208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, I thought the idea of tilemaps, was you had the grid structure in place, and you click to paint a tile, and right click to maybe remove the paint from that tile. The quads should always be there, just with a different texture assigned to them, or made invisible? Do you have an example of what kind of tilemap your creating? That means your going to have the black of nothingness showing through. I'm confused slightly :)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091211"></a>

<a name="1091212"></a>

<a name="1091213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, in like a side scroller, you would have areas with no "tiles", there, <br>so the background would be, for example, blue, so it looks like sky, but I guess if I just set alpha to 0 on those, it'd work, but wouldn't that be a problem. For example, say you have a large size game map, 1000x1000<br>in size. You have 20 tiles(quads), per every 100x100, and 10 of those tiles are just invisible or display the blue background. You would be using 200 Left to right and 200 up to down, 400 total. Which is 1600 Vertices, 200 triangles. If I didn't have 10 of those quads existing, I could save you, 800 Vertices, 100 triangles and just have the camera display the blue background.<br><br>-Lets say those 10 that are just masked out, were accidently placed and since I couldn't delete them, I just masked them out- <br><br>I hope that accurately describes it...<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> But in tilemap games, everything is made from tiles, even the sky. Just paint those tiles blue :) And saving 100 triangles isn't much, if anything. Plus, most tilemaps engines work, by only actually creating the tiles on the screen. You would have your grid of quads, and simply scroll the tile grid, the width of a tile, snap it back, repaint all the tiles with the tiles left of each other, and it gives the illusion of scrolling.<br><br>I'm not sure what your 20 tiles per every 100,100 means though? Each tile is a quad. The quad is textured with the image of that particular tile. <br><br></td></tr></table><br>
<a name="1091221"></a>

<a name="1091223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> I meant 1000x1000 width and length in map size. So, you had 20 quads aka 20 tiles. Lolz<br><br>Thanks Ross.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091224"></a>

<a name="1091225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you don't need to create a 100x100 tiles. Instead, create only say 20x15 tiles. Then, make it look as if they are scrolling by alternating the texture that is applied to the tiles.<br>Think of it like this: (2d example, needs tiles.png from post above)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

img = LoadImage("tiles.png")

Dim level(99, 14)
For x = 0 To 99
For y = 0 To 14
	level(x, y) = Rand(13)
Next
Next

Repeat

	Cls
	For x = 0 To 19 ;draw only 20x15 tiles
	For y = 0 To 14
		tile = level(x + scroll, y) ;scrolling is applied here - will give error after a while, because is reads beyond array size (99 width)
		tilex = (tile Mod 4) * 32 ;get tile x,y (set of 4x4, each 32x32 in size)
		tiley = (tile / 4) * 32
		DrawImageRect img, x * 32, y * 32, tilex, tiley, 32, 32 ;draw only one 32x32 tile from the image 
	Next
	Next
	
	scroll = scroll + 1
	
	Flip
	
	Delay 75 ;else it goes too fast
	
Until KeyHit(1)
</textarea><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091227"></a>

<a name="1091228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats actually a amazingly epic idea, never thought about that. Also the 100x100 tiles was only a example and truth if I only had the tiles scrolling and the character never actually moving from them, then I could never actually get to a real existing place in the. Thats still a amazing idea though.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091286"></a>

<a name="1091292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kenshin Yurihara</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> I implemented a simple single surface, collision using the same method I used to check for image collision at the start of this thread.<br><br>It seems to work, maybe not 100% perfect, but none the less, it does<br>it decently.<br><br>I'll be working on Collisions with other objects next, after I fix up the few errors in my collision code.<br><br>Again, thanks for the help thus far guys.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1093310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mv333</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can do 2d alpha blending in Blitz3d, using the Extended B2D dll. <br><br></td></tr></table><br>
<a name="1093311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mv333</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But in tilemap games, everything is made from tiles, even the sky. <br></div><br><br>What if you're using parallax scrolling? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
