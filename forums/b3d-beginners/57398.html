<!DOCTYPE html><html lang="en" ><head ><title >simple multiplayer FPS</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >simple multiplayer FPS</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >simple multiplayer FPS</a><br><br>
<a name="638260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I understand the basics of both multiplayer and first-person-shooters.  My question is, how do I combine them?<br><br>How do you send the positions of bullets ext.?<br><br>A realy simple example of this would be greatly appreciated!!! <br><br></td></tr></table><br>
<a name="638267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There aren't too much in the way of simple examples, as it's not a particular simple concept.  However, if you're into learning from other people's well-commented code (and if you're not, you should be), then here's an excellent example from the exceedingly generous Jeremy Alessi.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1142" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1142</a> <br><br></td></tr></table><br>
<a name="638273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I am sure that will help me out eventually, but right now I think that that is a littlebit too advanced for me.  I know that this is not a simple consept, but surely there is more simple example out there, mabe one that just uses startnetgame instead of gnet? <br><br></td></tr></table><br>
<a name="638278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, and I tried that example and it says "Failed to Create Server" when I try to create my own game.  When I try to join a game, it just sits there and doesn't do anything. <br><br></td></tr></table><br>
<a name="638294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why do the bullets not match up with the target if you aim different directions in this little example of mine?<br><br><a href="http://www.freewebs.com/blitznerd/FPS/FPS.zip" target="_blank">http://www.freewebs.com/blitznerd/FPS/FPS.zip</a> <br><br></td></tr></table><br>
<a name="638299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Granted, that didn't work quite as well as it used to.  Was a fun lil game too - not sure what changed, but the problems I'm having seem to be GNet-related... like the files it's looking for on the blitzbasic.com server are... in different places to where they were, or malformed... or something.  Still, knowing that it worked fine means it's not unuseful for poring over to learn how to combine an FPS with netcode.<br><br>The thing is, there are plenty of examples around on how to do working netcode, and how to do FPSes.  If you know how to do the FPS stuff, then adapting one of the 2D netcode methods should be (relatively) a doddle.  If you aren't too comfortable with coding a 3D FPS but know all about netcode, then you have bigger fish to fry before you need to worry about adding network multiplayer.<br><br>Back to the code supplied though:  I know it works (as I said, I've played it more than once), so if you just ignore all the GNet stuff (which only involves adding and listing servers from the remove masterserver, and none of the nitty gritty) then you'll find a great deal in there about how to "send the positions of bullets" etc.<br><br>You can also check out the netcode example that comes with BlitzPlay Lite (available <a href="http://www.blitzcoder.com/blitzplay/downloads.shtml" target="_blank">here</a>) - but again, you're going to have to study source code.  This one doesn't involve GNet at all.  Nor does the example netcode that comes with Blitz3D itself (in the command reference).<br><br>I have a sneaking suspicion though that there are probably a couple of things you could work on before you tackle implementing network multiplayer in an FPS. <br><br></td></tr></table><br>
<a name="638300"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Clicking on that link opens a copy of this thread (?) <br><br></td></tr></table><br>
<a name="638308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know, I don't know how to do links in this forum.??<br>If you copy and paste the url into your browser it should work. <br><br></td></tr></table><br>
<a name="638409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> This code runs very slow on my network.  It has fine frames per second on both computers, but it takes about two minutes to register what happened on one computer on the other.<br>Does anybody know why it is so slow?<br>How can I make it faster?<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
StartNetGame()
name=Input("Name:")
id=CreateNetPlayer(name)
Graphics3D 640,480
SetBuffer BackBuffer()
target=LoadImage("target.bmp")
light=CreateLight()

ground=LoadTerrain("ground.bmp")
ScaleEntity ground,2,50,2
PositionEntity ground,-256,-75,-256
groundtex=LoadTexture("groundtex.bmp")
ScaleTexture groundtex,10,10
EntityTexture ground,groundtex
EntityType ground,2

guy=CreateCube()
PositionEntity guy,100,0,100
ScaleEntity guy,1,2,1
EntityRadius guy,1,4
EntityType guy,1
camera=CreateCamera(guy)
PositionEntity camera,EntityX(guy),EntityY(guy)+.5,EntityZ(guy)-1,1
PointEntity camera,guy
CameraClsColor camera,0,100,255
gravity#=0
health=100

otherguy=CreateCube()

Type youbullet
	Field mesh
	Field time
End Type

Collisions 1,2,2,2
Collisions 3,2,2,1
Collisions 3,6,1,1
Collisions 5,1,1,1

MoveMouse 200,200
While Not KeyDown(1)
mxs#=MouseXSpeed()
mys#=MouseYSpeed()
MoveMouse 200,200
TurnEntity guy,0,-mxs,0
TurnEntity camera,mys,0,0
If EntityCollided(guy,2)
	gravity=-.2
	If KeyDown(17) Then MoveEntity guy,0,0,.5
	If KeyDown(31) Then MoveEntity guy,0,0,-.5
	If KeyDown(32) Then MoveEntity guy,.5,0,0
	If KeyDown(30) Then MoveEntity guy,-.5,0,0
	TranslateEntity guy,0,gravity,0
Else
	gravity=gravity+(-1-gravity)/50
	TranslateEntity guy,0,gravity,0
EndIf
If MouseHit(1)
	b.youbullet=New youbullet
	b\mesh=CreateSphere()
	ScaleMesh b\mesh,.1,.1,.1
	b\time=300
	PositionEntity b\mesh,EntityX(camera,1),EntityY(camera,1),EntityZ(camera,1),1
	RotateEntity b\mesh,EntityPitch(camera,1),EntityYaw(camera,1),EntityRoll(camera,1),1
	EntityType b\mesh,3
	EntityRadius b\mesh,.1
EndIf

For b.youbullet=Each youbullet
	MoveEntity b\mesh,0,0,1
	TranslateEntity b\mesh,0,-.01,0
	If EntityCollided(b\mesh,2) Then b\time=0
	b\time=b\time-1
	If b\time&lt;0
		FreeEntity b\mesh
		Delete b
	EndIf
Next
sendx$=LSet(EntityX(guy),10)
sendy$=LSet(EntityY(guy),10)
sendz$=LSet(EntityZ(guy),10)
sendpi$=LSet(EntityPitch(guy),10)
sendya$=LSet(EntityYaw(guy),10)
sendro$=LSet(EntityRoll(guy),10)
SendNetMsg(1,sendx+sendy+sendz+sendpi+sendya+sendro,id,0,0)
If RecvNetMsg()
	msg$=NetMsgData()
	PositionEntity otherguy,Left(msg,10),Mid(msg,11,20),Mid(msg,21,40)
	RotateEntity otherguy,Mid(msg,31,10),Mid(msg,41,10),Right(msg,10)
EndIf

If health&lt;0 Then CameraClsColor camera,255,0,0

UpdateWorld
RenderWorld
Text 0,0,health
DrawImage target,(GraphicsWidth()/2)-32,(GraphicsHeight()/2)-32
Flip
Wend
End
</textarea> <br><br></td></tr></table><br>
<a name="638480"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try adding Delay 1 at the start of your main loop. <br><br></td></tr></table><br>
<a name="638660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why does that help? <br><br></td></tr></table><br>
<a name="638703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I tried that, and it goes a bit faster, but the network still slows down about 9 seconds per minute that the game runs.  Any other usefull tricks? <br><br></td></tr></table><br>
<a name="639214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steven Noyce</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that I am going to switch from DirectPlay to UDP.  I have looked through some code and things and I think that I understand the basics of how to use UDP.  There is one thing I am not sure about, is there a way to brodcast a UDP message?  If not, then how do I get all of the participating players IP addresses?<br><br>A simpe fps exampe like the one that follows (that doesn't work, it is just to show you what I am after) would help me a LOT!!!<br><pre class=code>
sendudpstream=CreateUDPStream()
recvudpstream=CreateUDPStream()

;set graphics

;load stuff

;main loop

message$=blablabla ; your message
WriteLine sendudpstream,message
SendUDPMsg sendudpstream,destip

recvmessage=RecvUDPMsg(recvudpstream)

;interpret the message

;end
</pre> <br><br></td></tr></table><br>
<a name="641022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmm this seams to work..<br><br><br><a href="http://server.voidrpg.com/network" target="_blank">http://server.voidrpg.com/network</a> test2.rar <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
