<!DOCTYPE html><html lang="en" ><head ><title >Need help placing trees</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need help placing trees</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Need help placing trees</a><br><br>
<a name="897659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flyingrob</td><td align="right"><font class=tiny>(Posted -0001)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Worked out how to use treeparty a bit, I have a tree situated above the ground ready to drop to ground. Haven't done the collision bit yet but I can't seem to get the tree to drop yet. Can you look at my code and tell me why it's not dropping.   Thanks.<br><br>Graphics3D 800,600,16,1<br>SetBuffer BackBuffer()<br><br>Include "Include_treeParty.bb"<br>tpLoadEngine()<br><br>tree=tpLoadtree("tree1.tp",2)<br>PositionEntity tree, Rnd(-10,0),12,Rnd(-10,10)<br><br>Function touchground(n$)<br>If Not EntityCollided (n$,ground)<br>PositionEntity (n$,EntityX(n$),EntityY(n$)-0.1,EntityZ(n$))<br>End If<br>End Function	<br>                         <br>Cam=CreateCamera()<br>PositionEntity Cam,0,4,-20<br><br>light=CreateLight()<br><br>ground=CreateTerrain(512)<br>PositionEntity ground, -500,0,-500<br>ScaleEntity ground, 10,15,10<br>tex=LoadTexture( "greenery.jpg" )<br>EntityTexture ground, tex<br><br>While Not KeyDown( 1 )<br><br>touchground(tree)<br><br>If KeyDown( 205 )=True Then TurnEntity cam,0,-1,0<br>If KeyDown( 203 )=True Then TurnEntity cam,0,1,0<br>If KeyDown( 208 )=True Then MoveEntity cam,0,0,-0.05<br>If KeyDown( 200 )=True Then MoveEntity cam,0,0,0.05<br>If KeyDown( 30 )=True Then MoveEntity cam,.3,0,0<br>If KeyDown( 44 )=True Then MoveEntity cam,-.3,0,0<br>If KeyDown( 31 )=True Then TurnEntity&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533;&amp;#65533; <br><br></td></tr></table><br>
<a name="896167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flyingrob</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>       I've been learning with the demo version for a while and have just bought the the full version. (if you're thinking of buying full version, do it, there's lots of help and it's much easier to learn)  <br>       I'd like a bit of help if anyone can. I'm placing a group of trees randomly on a hill and want them all to automatically place themselves at ground level. I can't set a specific "Y" level  because of the slope and the random spacing. I've tried various ways using TranslateEntity which tells me I'm out of bounds using it with an array. I've been trying different things in the "y" of the PositionEntity tree using TerrainY also. <br><br>Dim tree (5)<br>For t = 0 To 5<br>tree(t) = LoadMesh("tree-snowy.x")<br>tex=LoadTexture("tree-snowy-uv.png",4)<br>EntityTexture tree(t),tex<br>PositionEntity tree(t),Rnd(-70,80),Rnd(50,60),Rnd(400,490)<br>RotateEntity tree(t),0,Rnd(0,360),0 <br>ScaleEntity tree(t),Rnd(.75,1),Rnd(.75,2),Rnd(.75,1)<br>EntityType tree(t), type_ob <br><br></td></tr></table><br>
<a name="896172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is often done with collisions - you drop your trees into your terrain, checking for a collision with the terrain, then you generally position your tree in the ground just a bit below the original Y collision - just to make sure the whole trunk is planted into the ground.  Some AAA games forget the last part - such as Oblivion, and you can find trees not properly seated into the ground all the way round the trunk. <br><br></td></tr></table><br>
<a name="896229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Billp</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are using a mesh terrain you can use linepick (your mesh must be pickable) to find the height at a given x,z coord<br><br><pre class=code>Function MeshTerrainY#( Entity, Pick_Top#, Pick_Distance# )
	pick=LinePick( EntityX( Entity ), EntityY( Entity )+Pick_Top#, EntityZ(Entity), 0, Pick_Distance#, 0 )
	Return (PickedY())
End Function</pre><br><br>if using a blitz terrain then <br><br><pre class=code>TerrainHeight# ( terrain,grid_x,grid_z )</pre><br><br>then as puki mentions position them a bit lower on the y axis to allow for terrain varition <br><br></td></tr></table><br>
<a name="896865"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flyingrob</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the replies, I'm working on them but went and bought treeparty a few days ago so I'm also spending a bit of time getting to know that. <br><br></td></tr></table><br>
<a name="897662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> another solution is to simply determine the y coordinate of the heightmap's pixel in question.  In other words, if the x and z of the tree are at 12, 57 on the terrain (heightmap-wise), you just read the brightness of the pixel on the heightmap at that location, and turn it into a 3d Y value. <br><br></td></tr></table><br>
<a name="897703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flyingrob</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something wrong happened when I tried to upload this last time. I've only just found out how to work the code box. Worked out how to use treeparty a bit, I have a tree situated above the ground ready to drop to ground. Haven't done the collision bit yet but I can't seem to get the tree to drop yet. Can you look at my code and tell me why it's not dropping. Thanks.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Graphics3D 800,600,16,1
SetBuffer BackBuffer()

Include "Include_treeParty.bb"
tpLoadEngine()

tree=tpLoadtree("tree1.tp",2)
PositionEntity tree, Rnd(-10,0),12,Rnd(-10,10)

Function touchground(n$)
If Not EntityCollided (n$,ground)
PositionEntity (n$,EntityX(n$),EntityY(n$)-0.1,EntityZ(n$))
End If
End Function	
                         
Cam=CreateCamera()
PositionEntity Cam,0,4,-20

light=CreateLight()

ground=CreateTerrain(512)
PositionEntity ground, -500,0,-500
ScaleEntity ground, 10,15,10
tex=LoadTexture( "greenery.jpg" )
EntityTexture ground, tex

While Not KeyDown( 1 )

touchground (tree)

If KeyDown( 205 )=True Then TurnEntity cam,0,-1,0
If KeyDown( 203 )=True Then TurnEntity cam,0,1,0
If KeyDown( 208 )=True Then MoveEntity cam,0,0,-0.05
If KeyDown( 200 )=True Then MoveEntity cam,0,0,0.05
If KeyDown( 30 )=True Then MoveEntity cam,.3,0,0
If KeyDown( 44 )=True Then MoveEntity cam,-.3,0,0
If KeyDown( 31 )=True Then TurnEntity cam,.3,0,0
If KeyDown( 45 )=True Then TurnEntity cam,-.3,0,0

tpUpdateEngine(Cam)
UpdateWorld()

RenderWorld
Flip
Wend
End</textarea> <br><br></td></tr></table><br>
<a name="897705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flyingrob</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks chwaga, but what I originally was trying to do was to get a group of trees to plant themselves automatically on very uneven ground but I don't know how to code this yet, I'm an old newbie trying to learn coding and not quite up to this level of coding yet. <br><br></td></tr></table><br>
<a name="897706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mtnhome3d</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> look in the mak directory of the samples and find the markio example, in it there is code that places about 50 trees automatically. it uses types and searches the terrain for anything above a certain point(waterline) and below a certain height and puts trees randomly throughout the prescribed area.<br>&lt;edit&gt; this can also be modified to use linepicks to find the height and check whether or not it s in the height range and the place the trees.&lt;/edit&gt; <br><br></td></tr></table><br>
<a name="897790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> what you're missing there is a loop in the touchground function, however, I think I have a simpler solution, lemme just try it first. <br><br></td></tr></table><br>
<a name="897792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> here we go, this works:<br><br><pre class=code>
Function touchground(entity, terrain)
Local lx = EntityX(entity) : Local lz = EntityZ(entity)
PositionEntity entity, lx, TerrainHeight(terrain, lx, lz), lz
End Function
</pre><br><br>note:  this could also easily be turned into a create and drop function. <br><br></td></tr></table><br>
<a name="897803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flyingrob</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks to both mtnhome3d (will check that soon) and chwaga.  I've now got the code I was using before to drop a single tree onto the ground. This is when the tree is a "x" mesh. If I try to do exactly the same with a treeparty tree it just stays in the air and dosn't drop. The tp tree loads alright and animates but won't descend. Any ideas why the treeparty tree won't work ? <br>      Here's the working code with the x mesh, and below that, the code with the treeparty loaded.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Graphics3D 800,600,16,1
SetBuffer BackBuffer()
type_t=1
type_g=2

Collisions type_t,type_g,2,1

tree =LoadMesh ("tree.x")
PositionEntity tree, 10,20,10
ScaleEntity tree, .3,.3,.3
EntityType tree,type_t

ground=CreateTerrain(512)
PositionEntity ground, -500,0,-500
ScaleEntity ground, 10,15,10
tex=LoadTexture( "greenery.jpg" )
EntityTexture ground, tex
EntityType ground, type_g

Function touchground(n$)
If Not EntityCollided (n$,ground)
PositionEntity (n$,EntityX(n$),EntityY(n$)-0.1,EntityZ(n$)) 
End If
End Function	
                         
Cam=CreateCamera()
PositionEntity Cam,0,4,-10

light=CreateLight()

While Not KeyDown( 1 )

touchground (tree)

If KeyDown( 205 )=True Then TurnEntity cam,0,-1,0
If KeyDown( 203 )=True Then TurnEntity cam,0,1,0
If KeyDown( 208 )=True Then MoveEntity cam,0,0,-0.05
If KeyDown( 200 )=True Then MoveEntity cam,0,0,0.05
If KeyDown( 30 )=True Then MoveEntity cam,.3,0,0
If KeyDown( 44 )=True Then MoveEntity cam,-.3,0,0
If KeyDown( 31 )=True Then TurnEntity cam,.3,0,0
If KeyDown( 45 )=True Then TurnEntity cam,-.3,0,0

UpdateWorld()

RenderWorld
Flip
Wend
End</textarea><br><br>-----------------------------------------------------------------------<br>-----------------------------------------------------------------------<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Graphics3D 800,600,16,1
SetBuffer BackBuffer()
type_t=1
type_g=2

Collisions type_t,type_g,2,1

Include "Include_treeParty.bb"
tpLoadEngine()
tree=tpLoadtree("tree1.tp",2)
PositionEntity tree, 0,5,10
EntityType tree,type_t

ground=CreateTerrain(512)
PositionEntity ground, -500,0,-500
ScaleEntity ground, 10,15,10
tex=LoadTexture( "greenery.jpg" )
EntityTexture ground, tex
EntityType ground, type_g

Function touchground(n$)
If Not EntityCollided (n$,ground)
PositionEntity (n$,EntityX(n$),EntityY(n$)-0.1,EntityZ(n$)) 
End If
End Function	
                         
Cam=CreateCamera()
PositionEntity Cam,0,4,-10

light=CreateLight()

While Not KeyDown( 1 )

touchground (tree)

If KeyDown( 205 )=True Then TurnEntity cam,0,-1,0
If KeyDown( 203 )=True Then TurnEntity cam,0,1,0
If KeyDown( 208 )=True Then MoveEntity cam,0,0,-0.05
If KeyDown( 200 )=True Then MoveEntity cam,0,0,0.05
If KeyDown( 30 )=True Then MoveEntity cam,.3,0,0
If KeyDown( 44 )=True Then MoveEntity cam,-.3,0,0
If KeyDown( 31 )=True Then TurnEntity cam,.3,0,0
If KeyDown( 45 )=True Then TurnEntity cam,-.3,0,0

tpUpdateEngine(Cam)
UpdateWorld()

RenderWorld
Flip
Wend
End</textarea> <br><br></td></tr></table><br>
<a name="897825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> looks like it's something to do with how treeparty works.  Are you sure the entity you should be dropping is 'tree'?  Also, I still think my way is better :D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
