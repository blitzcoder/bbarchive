<!DOCTYPE html><html lang="en" ><head ><title >cameraviewport help plz?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >cameraviewport help plz?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >cameraviewport help plz?</a><br><br>
<a name="437355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Viperfish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi folks,<br><br>After downloading B3d about 2 weeks ago, I'm now well and truly into my first project.<br><br>It's a 3d fly anywhere space shooter and I'm amazed at how easy this language is to use. <br><br>Here's a problem which I hope someone with more brains than me can help me with. <br><br>I've set up a camera with it's own viewport which occupies the bottom right corner of the screen. For some reason I cant get it to work with my main camera(called 'fwdcam'). When I switch to cockpit view(cockpitcam) by pressing '4' or actioncam by pressing '3' my radar is working perfectly with these cameras but it will not work when the forward camera is selected. I've been trying to figure this one out for about 5 hours now.<br>Here is the code<br>________________________<br><br>Global X3D#,Y3D#,Z3D#,resx,resy<br>SetBuffer BackBuffer()<br>Global xrotation#,zrotation#,acceleration#,roll#,pitch#,a,campoint%,shippoint%,firedn#,enemycount<br>Global rview,HitEntity#,HitDistance#,shield,mineshield,enemybullet,center,msight,msight1<br>Global fwdcam,rvcam,actioncam1,cockpitcam,camera,pvt,radarcam,sph,bullet,wehit,explodevol#,expl,trails,radarship<br>Global missile,msite,srotation,missSpd#,mrot#,launched%,target,sight%,targetent<br>Global rkeydown,rzoom#,timer,fps,temp,gtime,buldist,ship<br><br>Include "intro.bb"<br><br>resx=1024<br>resy=768<br>Graphics3D resx,resy,32,1<br><br>;GLOBAL SOUND FILES<br>Global sndshoot,chnship,sndexplode,sndwehit,sndwoosh<br><br>Type t2dI3d<br>	Field X#,Y#,Z#,W#,H#,Camera%<br>End Type<br>Type particle<br>	Field mx#,my#,mz#,count,entity<br>End Type<br>Type explode<br>	Field mx#,my#,mz#,count#,entity<br>End Type<br>Type missile<br>	Field targetent,entity<br>	End Type<br>Type bullet<br>	Field mx#,my#,count,entity<br>End Type<br>Type enemybullet<br>	Field ebx#,eby#,count,entity,sndplayed<br>End Type<br>Type enemy<br>	Field entity,ca%,ct%,spx#,spd#,spz#<br>End Type<br>Type radarpoint<br>	Field parent, entity<br>End Type<br><br>;CONSTANTS<br>Const player = 1, land = 2, lazer = 3, aliens = 4,enbullet = 5, mine = 6<br>Const chase = 1, goback = 2, climb = 3, base = 4, loopleft = 5, loopright = 6<br>Const ExplodeSize = 20, ExplodeIntensity = 70, ExplodeScale = 50<br>Const radarht = 155000, radarrange = 15000<br><br>;Create CENTER<br>center = CreatePivot()<br>MoveEntity center,0,7000,0<br><br>;CREATE PVT<br>pvt = CreatePivot()<br>EntityType pvt,player<br>EntityRadius pvt,25<br><br>;CREATE PARTICLE<br>Print "Loading particle meshes."<br>sph = LoadSprite( "media/exhaust.bmp" )<br>ScaleSprite sph,1,1<br>HideEntity sph<br><br>;CREATE TRAILS<br>trails = LoadSprite("media/trail.bmp")<br>ScaleSprite trails,3,3<br>HideEntity trails<br><br>;CREATE EXPLOSION PARTICLES<br>expl = LoadSprite( "media/exhaust.bmp" )<br>ScaleSprite expl,10,10<br>HideEntity expl<br><br>;CREATE BULLET<br>Print "Loading weapon meshes."<br>bullet = LoadMesh("media/bullets.3ds")<br>RotateMesh bullet,-90,180,0<br>EntityType bullet, lazer<br>ScaleEntity bullet,3.5,3.5,5<br>EntityColor bullet,255,255,0<br>EntityRadius bullet,8<br>HideEntity bullet<br><br>;CREATE MISSILE<br>missile = LoadMesh ("media/missile.3ds")<br>RotateMesh missile,90,180,0<br>EntityType missile, lazer<br>EntityRadius missile, 6<br>HideEntity missile<br><br>;CREATE ENEMYBULLET<br>enemybullet = LoadMesh("media/enemybullet.3ds")<br>RotateMesh enemybullet,-90,180,0<br>EntityType enemybullet, enbullet<br>ScaleEntity enemybullet,.2,.2,3<br>EntityRadius enemybullet,2<br>EntityColor enemybullet,255,255,100<br>HideEntity enemybullet<br><br>;CREATE SHIP<br>Print "Loading craft meshes."<br>ship = LoadMesh("media/ship.3ds",pvt)<br>EntityShininess ship,1<br>RotateMesh ship,-90,180,0<br>ScaleEntity ship,1.5,1.5,1.5<br><br>;CREATE TARGETING SPOT<br>tget = LoadSprite ("media/radarenemy.jpg",1,pvt)<br>ScaleSprite tget,30,30<br>MoveEntity tget,0,0,10000<br>EntityColor tget,120,255,120<br>EntityOrder tget,-1<br><br>;CREATE MISSILE SIGHT<br>msight = LoadSprite("media/missilesight.bmp")<br>ScaleSprite msight,.3,.3<br>EntityColor msight,255,0,0<br>msight1 = CopyEntity (msight)<br>ScaleSprite msight1,.5,.5<br>EntityColor msight1,255,180,0<br><br>Print "Creating radar sprites."<br>;CREATE RADAR<br>radarcam = CreateCamera()<br>CameraZoom radarcam,1<br>PositionEntity radarcam,0,radarht,0<br>CameraRange radarcam,1,radarrange<br>PointEntity radarcam,center<br>CameraViewport radarcam,(resx/4)*3,(resy/4)*3,resx/4,resy/4 <br>radarship = LoadSprite ("media/radarship.jpg")<br>ScaleSprite radarship,700,700<br><br>;CREATE RADAR POINTS<br>radarenemy = LoadSprite ("media/radarenemy.jpg")<br>EntityColor radarenemy,255,0,0<br>ScaleSprite radarenemy,200,200<br>HideEntity radarenemy<br><br>Print "Setting up cameras."<br>;CREATE FWDCAM<br>fwdcam = CreatePivot()<br><br>;CREATE RVCAM<br>rvcam=CreatePivot(fwdcam)<br>MoveEntity rvcam,0,10,70<br>PointEntity rvcam,ship<br><br>;CREATE actioncam1<br>actioncam1=CreatePivot(pvt)<br>MoveEntity actioncam1,50,10,-70<br>PointEntity actioncam1,ship<br><br>;CREATE cockpitcam<br>cockpitcam=CreatePivot(pvt)<br>MoveEntity cockpitcam,0,0,3<br>;PointEntity cockpitcam,ship<br><br>;CREATE CAMERA<br>camera = CreateCamera(fwdcam)<br>MoveEntity camera,0,7,-8<br>CameraRange camera,1,20000<br><br><br>Print"Creating light source."<br>;CREATE LIGHT<br>light = CreateLight()<br>LightColor light,255,255,255<br>PositionEntity light,0,100000,0<br>RotateEntity light,90,0,0<br><br>;WIREFRAME<br>WireFrame 0<br><br>Print "Loading Terrain."<br>;CREATE TERRAIN	<br>;terrain = LoadTerrain("media/hmap_1024.jpg")<br>;TerrainShading terrain,False<br>;ScaleEntity terrain,12,1400,12<br>;TerrainDetail terrain,4000,True<br>;PositionEntity terrain,-24000,-1000,-24000<br><br>terrain = CreatePlane()<br>PositionEntity terrain,0,-1000,0<br><br>terrain_tex = LoadTexture("media/grass.bmp",1)<br>ScaleTexture terrain_tex,100,100<br><br>EntityTexture terrain,terrain_tex<br>EntityType terrain,land<br><br><br>;CREATE MINESITE<br>msite = LoadMesh("media/minesite.3ds")<br>tex = LoadTexture("media/metal027.jpg")<br>EntityTexture msite,tex<br>RotateMesh msite,-90,180,0<br>ScaleMesh msite,250,250,250<br>EntityColor msite,50,50,50<br>EntityType msite,mine<br>;EntityRadius msite,300<br>PositionEntity msite,0,-1000,0<br>;PositionEntity msite,0,TerrainY(terrain,0,0,0),0<br>EntityColor msite,255,255,255<br><br>Print "Loading enemy meshes."<br>;CREATE ENEMY<br>enemy1 = LoadMesh("media/enemy.3ds",center)<br>RotateMesh enemy1,-90,180,0<br>ScaleEntity enemy1,5,5,5<br>EntityRadius enemy1,40<br>EntityType enemy1, aliens<br>HideEntity enemy1<br><br><br>Print "Loading sounds."<br>;LOADSOUNDS<br>sndshoot = LoadSound ("media/sounds/pshoot.wav")<br>sndexplode = LoadSound ("media/sounds/explode.wav")<br>sndwehit = LoadSound ("media/sounds/hit.wav")<br>sndship = LoadSound ("media/sounds/Cabin.wav")<br>sndwoosh = LoadSound ("media/sounds/email.wav")<br><br>;Initialise<br>Print "Initialising"<br>Collisions player,land,2,2<br>Collisions lazer,aliens,1,2<br>Collisions enbullet,player,1,2<br>Collisions enbullet,mine,2,2<br>Collisions aliens,land,2,2<br>Collisions aliens,aliens,1,2<br>init2Din3D(camera,15,resx,resy)<br>shield = 100<br>rzoom = 1<br>;chnMusic = PlayMusic("media/sounds/guitar.wav")<br>LoopSound sndship<br>SoundVolume sndship,1<br>chnship =PlaySound(sndship)<br>acceleration = 10<br>PositionEntity pvt,4000,7000,14000<br>PointEntity pvt,msite<br>NoOfEnemy = 50 ;As many as you like. If your system can handle it, try 300 + :)<br><br>;GAME LOOP&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;<br>While Not KeyDown(1)<br>	gtime = gtime +1<br>	;SPAWN ENEMY<br>	If EnemyGenCount&lt;NoOfEnemy And gtime Mod 5 =0<br>		EnemyGenCount = EnemyGenCount +1<br>		e.enemy = New enemy<br>		e\entity = CopyEntity(enemy1)<br>		EntityParent e\entity,0<br>		e\ca% = base<br>		e\ct%= 30000<br>		e\spx = .6 ;climb speed<br>		e\spz = 1.3  ;roll speed<br>		e\spd = 16;forward speed<br>		PositionEntity e\entity,Rnd(10,500),7000,9000<br>		Ra.radarpoint = New radarpoint<br>		Ra\parent = e\entity<br>		Ra\entity = CopyEntity(radarenemy)<br><br>	End If<br><br>	EnemyAI()<br>	CheckChangeCamera()<br>	UpdateBullets()<br>	MoveShip()<br>	UpdateEnemyBullets()	<br>	UpdateExplosions()<br>	UpdateExhaustParticles()<br>	ShipRoll(xrotation#,zrotation#)<br>	UpdateRadar()<br>	MoveCamera()<br>	LaunchAndControlMissiles()<br><br>	UpdateWorld<br>	RenderWorld<br>	Text 0,FontHeight(),"Enemy Count: "+enemycount<br>	Text 0,FontHeight()*2, "Roll:"+r#<br>	Text 0,FontHeight()*4, "Mine Shileds: "+mineshield<br>	Text 0,FontHeight()*5,"Shield:"+shield<br><br>	GetFPS()<br>	Text 0,FontHeight()*7,"fps:"+fps<br>	Text 0,FontHeight()*8,"distance: "+buldist<br>	Flip<br>Wend<br>End<br><br>;____________________________________________________________________________________________<br>Function LaunchAndControlMissiles()<br>	If KeyDown(20)And sight=0 Then<br>		sight = 1;this variable is set when the sights are displayed<br>		ShowEntity msight<br>		ShowEntity msight1<br>	End If<br>	If sight = 1<br>		srotation=srotation+2<br>		If srotation &gt; 360 Then srotation = 1<br>		RotateSprite msight,srotation<br>		RotateSprite msight1,-srotation<br>		If target= 0 Then;This variable is set to 1 when a target is selected.<br>			To3d(resx/2,resy/2);center the sight on the screen.<br>			PositionEntity msight,x3d,y3d,z3d<br>			PositionEntity msight1,x3d,y3d,z3d<br>			For e.enemy = Each enemy	;cycle through each enemy and determine if they are in the sights.<br>				EntityParent e\entity,pvt<br>				pvtx=EntityX(e\entity,False)<br>				pvty=EntityY(e\entity,False)<br>				pvtz=EntityZ(e\entity,False)<br>				If pvtx&gt;-30 And pvtx&lt;30 And pvty&gt;-30 And pvty&lt;30 And pvtz &gt;30 <br>					target = 1; set the target variable.<br>					targetent = e\entity<br>				End If<br>				EntityParent e\entity,0<br>			Next<br>		Else<br>			If EntityInView(targetent,camera) = True<br>				CameraProject(camera,EntityX(targetent),EntityY(targetent),EntityZ(targetent))<br>				to3d(ProjectedX(),ProjectedY());position the sight over the target.<br>				PositionEntity msight,x3d,y3d,z3d<br>				PositionEntity msight1,x3d,y3d,z3d<br>			End If<br>		End If<br>	End If<br>	If KeyDown(57) And target = 1 And launched = 0<br>		launched = 1;this variable is set when a missile is in flight<br>		<br>		missSpd# = 15 +acceleration#<br>		m.missile = New missile<br>		m\entity = CopyEntity(missile,pvt)<br>		m\targetent = targetent<br>		mrot# = 0.05 ;this variable controls the amount of turn.Ensuring it starts of flying very straight for a short distance before turning towards the target.<br>		chnMissile = PlaySound(sndshoot)<br>		ChannelPitch chnMissile,9000<br>		EntityParent(m\entity,0)<br>	End If<br>	If launched = 1<br>		For m.missile = Each missile<br>			EntityParent m\targetent,m\entity<br>			mpvtx=EntityX(m\targetent,False)<br>			mpvty=EntityY(m\targetent,False)<br>			If mrot &lt; 1 Then<br>				mrot# = mrot# * 1.05<br>			End If<br>			;Rotate z							;<br>			If mpvtx&lt;-2							;<br>				msy#=mrot#							;<br>			Else 								;<br>				If mpvtx&gt;2						;<br>					msy#=-mrot#					;This code rotates the missile towards its target.<br>				End If							;<br>			End If								;<br>			;rotate x 							;<br>			If mpvty&lt;-2 						;<br>				msx#=mrot#							;<br>			Else 								;<br>				If mpvty&gt;2 						;<br>					msx#=-mrot#						;<br>				End If							;<br>			End If								;<br>			EntityParent m\targetent,0			;<br>			TurnEntity m\entity,msx#,msy#,msz#	;<br>			If EntityDistance(m\targetent,m\entity) &lt;50 Then PointEntity m\entity,m\targetent<br>			missSpd# = missSpd#*1.005<br>			If missSpd#&gt;20 Then missSpd# = 20<br>			MoveEntity m\entity,0,0,missSpd#<br>			;Check for collision with target and explode.<br>			cc= CountCollisions(m\entity)<br>			If cc&lt;&gt;0<br>				HitEntity = m\targetent<br>				launched = 0<br>				target = 0<br>				targetent = 0<br>				sight = 0<br>				missSpd = 0<br>				FreeEntity m\entity<br>				Delete m<br>				HideEntity msight<br>				HideEntity msight1<br>				chnexplode = PlaySound(sndexplode)<br>				CreateExplosion(HitEntity,ExplodeSize,ExplodeIntensity,ExplodeScale)<br>			End If<br>		Next<br>	End If	<br>End Function<br><br><br>Function ShipRoll(xrotate#,zrotate#)<br>	roll#=roll#+zrotate#<br>	pitch#=pitch#+xrotate#<br>	roll#=roll#*.9<br>	pitch# = pitch# *.9<br>	TurnEntity pvt,pitch#,0,roll#<br>	xrotation# = 0<br>	zrotation# = 0	<br>	;accelerate the ship<br>	MoveEntity pvt,0,0,acceleration#	<br>End Function<br><br>Function MoveCamera()<br>	fparent=GetParent(fwdcam)<br>	EntityParent(fwdcam,pvt,True)<br>	dx#=EntityX(fwdcam)<br>	dy#=EntityY(fwdcam)<br>	dz#=EntityZ(fwdcam)<br>	r#=EntityRoll(fwdcam)<br>	p#=EntityPitch(fwdcam)<br>	y#=EntityYaw(fwdcam)<br>	If r# =&gt; 180 Then r# = r# - 360<br>	If r# =&lt; -180 Then r# = r# + 360<br>	TurnEntity fwdcam,-p#,-y#,-r#*.03<br>	TranslateEntity fwdcam,-dx*.1,-dy*.1,-(dz+10)*.5<br>	EntityParent(fwdcam,0)<br><br>End Function<br><br>Function CreateBullet()<br>		b.bullet = New bullet<br>		b\count = 200<br>		b\mx# = Rnd(-1.1,1.1)<br>		b\my# = Rnd(-1.1,1.1)<br>		b\entity = CopyEntity(bullet,pvt)<br>		MoveEntity b\entity,0,0,15<br>		EntityParent b\entity,0<br>		TurnEntity b\entity,b\mx#,b\my#,0<br>		ScaleEntity b\entity,3.5,3.5,35<br>		PlaySound(sndshoot)<br>End Function<br><br>Function UpdateEnemyBullets()<br>	For eb.enemybullet = Each enemybullet;MOVE ENEMY BULLETS<br>		eb\count = eb\count - 1<br>			;Check distance of bullet to player. Play woosh sound if close.<br>			buldist = EntityDistance(eb\entity,pvt)<br>			If buldist &lt; 125 And eb\sndplayed = False Then<br>				eb\sndplayed = True<br>				StopChannel chnwoosh<br>				chnwoosh = PlaySound(sndwoosh)<br>				ChannelPitch chnwoosh,5000<br>			End If<br>			;Check for collision with player<br>			If EntityCollided(eb\entity,player) Then<br>				wehit = CollisionEntity(eb\entity,1)<br>				shield = shield - 5<br>				cc = 0<br>				For q=1 To 30<br>					f1.explode=New explode<br>					f1\count=50<br>					f1\mx#=Rnd(-2,2)<br>					f1\my#=Rnd(-2,2)<br>					f1\mz#=10<br>					f1\entity=CopyEntity(expl,eb\entity)<br>					EntityColor f1\entity,255,0,0<br>					ScaleSprite f1\entity,2,2<br>					EntityParent f1\entity,0<br>				Next<br>				PlaySound(sndwehit)<br>				TurnEntity pvt,Rnd(-15,15),Rnd(-15,15),Rnd(-15,15)<br>				;createexplosion(wehit,ExplodeSize,ExplodeIntensity)<br>			End If<br>			;Check for collision with Base<br>			If EntityCollided(eb\entity,mine) Then<br>				eb\count = 0<br>				mineshield = mineshield - 10<br>				createexplosion(eb\entity,20,20,45)			<br>				;PlaySound(sndwehit)<br>				<br>			End If<br><br>		If eb\count Mod 5 = 1<br>			f1.explode=New explode<br>			f1\count=40<br>			f1\entity=CopyEntity(trails,eb\entity)<br>			EntityColor f1\entity,255,0,255<br>			ScaleSprite f1\entity,4,4<br>			EntityParent f1\entity,0<br>		End If	<br>		If eb\count &gt; 1 Then<br>			MoveEntity eb\entity,eb\ebx#,eb\eby#,90<br>		Else<br>			FreeEntity eb\entity<br>			Delete eb<br>		End If	<br>	Next<br>End Function<br><br>Function UpdateRadar()<br>	If KeyDown(19) And rkeydown = 0<br>		rzoom = rzoom + 0.5<br>		rkeydown = 1;This variable prevents this routine from running continuously while the r key is held down<br>		If rzoom &gt;3 Then <br>			rzoom = 1<br>		End If<br>		CameraZoom radarcam,rzoom<br>	End If<br>	If (Not KeyDown(19)) And rkeydown = 1<br>		rkeydown = 0<br>	End If<br>	For ra.radarpoint = Each radarpoint<br>		PositionEntity ra\entity,EntityX(ra\parent),radarht-(radarrange-1000),EntityZ(ra\parent),True<br>	Next<br>	RotateEntity (radarcam,90,EntityYaw#(pvt,True),0,True)<br>	PositionEntity (radarcam,EntityX(pvt,True),radarht,EntityZ(pvt,True),True)<br>	PositionEntity (radarship,EntityX(pvt,True),radarht-1000,EntityZ(pvt,True),True)<br>End Function<br>		<br>		<br>		<br>Function CheckChangeCamera()<br>		If KeyDown(2) Then <br>			FreeEntity camera<br>			camera = CreateCamera(fwdcam)<br>			MoveEntity camera,0,7,-8<br>			CameraRange camera,1,20000		<br>		End If<br>		If KeyDown(3) Then<br>			FreeEntity camera<br>			camera = CreateCamera(rvcam)<br>			CameraRange camera,1,20000<br>		End If<br>		If KeyDown(4) Then<br>			FreeEntity camera<br>			camera = CreateCamera(actioncam1)<br>			CameraRange camera,1,20000<br>		End If<br>		If KeyDown(5) Then<br>			FreeEntity camera<br>			camera = CreateCamera(cockpitcam)<br>			CameraRange camera,1,20000<br>		End If<br><br>End Function<br><br>Function MoveShip()<br>	If KeyDown(200);x rotation(pitch)<br>		xrotation# = .15<br>	Else If KeyDown(208)<br>		xrotation# = -.15<br>	EndIf<br>	If KeyDown(203);z rotation(roll)<br>		zrotation# = .15<br>	Else If KeyDown(205)<br>		zrotation# = -.15<br>	EndIf<br>	If KeyDown(30);Distance (z) movement<br>		acceleration# =acceleration# +.3<br>		If acceleration#&gt;17 Then acceleration =17<br>	Else If KeyDown(44)<br>		acceleration# = acceleration# -.3<br>		If acceleration &lt;.3 Then acceleration = 0.3<br>	EndIf<br>	ChannelPitch chnship,2000+(acceleration# * 600)<br>	;create bullet if fire pressed.<br>	If KeyDown(29) And firedn = 0 Then<br>		CreateBullet()<br>		firedn = 1<br>	End If	<br>	If (Not KeyDown(29)) And firedn = 1<br>		CreateBullet()<br>		firedn = 0<br>	End If	<br>End Function<br><br>Function CreateExplosion(HitEntity,ES,EI,ESC)<br>	If HitEntity&lt;&gt;0 Then <br>		m.missile = First missile<br>		If HitEntity = targetent<br>			launched = 0<br>			target = 0<br>			targetent = 0<br>			sight = 0<br>			missSpd = 0<br>			If m.missile &lt;&gt; Null<br>				FreeEntity m\entity<br>				Delete m<br>			End If<br>			HideEntity msight<br>			HideEntity msight1<br>		End If<br>		For h = 1 To EI<br>			f1.explode=New explode<br>			f1\count=Rnd(20,100)<br>			f1\mx#=Rnd(-ES,ES)<br>			f1\my#=Rnd(-ES,ES)<br>			f1\mz#=Rnd(-ES,ES)<br>			f1\entity=CopyEntity(expl,HitEntity)<br>			ScaleSprite f1\entity,ESc,ESc<br>			If Rnd(0,6)&gt;5 Then<br>				EntityColor f1\entity,Rnd(0,128),Rnd(0,128),255<br>			Else<br>				EntityColor f1\entity,255,Rnd(255),0<br>			End If<br>			EntityParent f1\entity,0		<br>		Next<br><br>		For del.enemy = Each enemy<br>			If del\entity = HitEntity<br>				For delra.radarpoint = Each radarpoint<br>					If delra\parent = HitEntity<br>						FreeEntity delra\entity<br>						Delete delra<br>					End If<br>				Next<br>				FreeEntity del\entity<br>				Delete del	<br>			EndIf	<br>		Next<br>		If hitentity = pvt Then<br>			dead = 1<br>		End If		<br>		;HitEntity = 0<br>	End If	<br>End Function<br><br>Function UpdateExplosions()<br>	For f1.explode=Each explode<br>		f1\count = f1\count -1<br>		If f1\count&gt;0<br>			MoveEntity f1\entity,f1\mx#*(f1\count/60),f1\my#*(f1\count/60),f1\mz#*(f1\count/60)<br>			RotateSprite f1\entity,f1\count*3<br>			alph# = f1\count/40<br>			EntityAlpha f1\entity,alph#<br>			f1\mx#=f1\mx#/1.2<br>			f1\my#=f1\my#/1.2<br>			f1\mz#=f1\mz#/1.2<br>		Else<br>			FreeEntity f1\entity<br>			Delete f1<br>		EndIf<br>	Next	<br>End Function<br>	<br>Function UpdateBullets()<br>	For b.bullet = Each bullet;MOVE BULLETS<br>		b\count = b\count - 1<br>		If b\count &gt; 1 Then<br>			MoveEntity b\entity,0,0,200<br>		cc = CountCollisions(b\entity)<br>			If cc&gt;0 Then<br>				HitEntity = CollisionEntity(b\entity,1)<br>				hitdistance = b\count<br>				b\count = 1<br>				cc = 0<br>				ChannelVolume chnexplode,1<br>				chnexplode = PlaySound(sndexplode)<br>				CreateExplosion(HitEntity,ExplodeSize,ExplodeIntensity,ExplodeScale)<br>			End If<br>		Else<br>			FreeEntity b\entity<br>			Delete b<br>		End If		<br>	Next<br>End Function<br><br>Function UpdateExhaustParticles()<br>	If acceleration#&gt;1 Then<br>		For h = 1 To 1<br>			f.particle=New particle<br>			f\count#=10<br>			f\mx#=Rnd(-0.05,.05)<br>			f\my#=Rnd(-0.05,.05)<br>			f\mz#=-1<br>			f\entity=CopyEntity(sph,pvt)<br>			EntityColor f\entity,100,100,255<br>			<br>			MoveEntity f\entity,Rnd(-.1,.1),.05,-4<br>		Next <br>	End If<br>	For f.particle=Each particle<br>		f\count# = f\count# -1<br>		If f\count&gt;0<br>			EntityAlpha f\entity,(f\count#*.1)<br>			MoveEntity f\entity,f\mx#,f\my#,f\mz#-(acceleration*.04)<br>		Else<br>			FreeEntity f\entity<br>			Delete f<br>		EndIf<br>	Next<br>End Function<br><br>Function Init2DIn3D(Camera,Z#=4,ResW=0,ResH=0)<br>	If ResW &lt;= 0 Then ResW = GraphicsWidth()<br>	If ResH &lt;= 0 Then ResH = GraphicsHeight()<br>	P = CreatePlane(1)<br>	EntityPickMode P,2<br>	PositionEntity P,EntityX(Camera,1),EntityY(Camera,1),EntityZ(Camera,1),1<br>	RotateEntity P,EntityPitch(Camera,1),EntityYaw(Camera,1),EntityRoll(Camera,1),1<br>	MoveEntity P,0,0,Z#<br>	TurnEntity P,-90,0,0<br>	CameraPick Camera,0,0<br>	While PickedEntity() &lt;&gt; P And Z# &gt; 1.0<br>		Z# = Z# - .1<br>		MoveEntity P,0,.1,0<br>		CameraPick Camera,0,0<br>	Wend<br>	If Z &lt; 1.0 Or PickedEntity() &lt;&gt; P Then RuntimeError "2d in 3d error"<br>	TFormPoint PickedX(),PickedY(),Z,0,Camera<br>	X# = Abs TFormedX()<br>	Y# = Abs TFormedY()<br>	i.t2dI3d = New t2dI3d<br>	i\X = X : i\Y = Y : i\Z = Z : i\W = ResW : i\H = ResH : i\Camera = Camera<br>	FreeEntity P<br>End Function<br>Function To3D(X#,Y#,TFormGlobal = 0,TFormTo=0)<br>	i.t2dI3d = First t2dI3d<br>	X# = -i\X + ((X# / i\W) * (i\X * 2))<br>	Y# = i\Y - ((Y# / i\H) * (i\Y * 2))<br>	If TFormGlobal = 0 Then<br>		TFormPoint X,Y,i\Z,i\Camera,TFormTo<br>		X3D = TFormedX() : Y3D = TFormedY() : Z3D = TFormedZ()<br>		Return<br>	EndIf<br>	X3D = X : Y3D = Y : Z3D = i\Z<br>	Return<br>End Function<br><br>Function GetFPS()<br>	If timer + 1000 &lt;= MilliSecs()<br>		timer = MilliSecs()<br>		fps = temp-gtime<br>		temp = gtime<br>	End If<br>End Function<br>	<br><br>Function EnemyAI()<br>	;ENEMY AI***************<br>	enemycount = 0<br>	;e\ca - enemy's current action<br>	;e\ct - enemy's time left performing current action<br>	For e.enemy = Each enemy	<br>		If e\ca% = chase;CHASE<br>			EntityParent ship,e\entity<br>			pvtx=EntityX(ship,False)<br>			pvty=EntityY(ship,False)<br>			;Rotate z based on x position<br>			If pvtx&lt;10<br>				tz#=e\spz<br>			Else <br>				If pvtx&gt;10<br>					tz#=-e\spz<br>				End If<br>			End If<br>			;rotate x based on y<br>				If pvty&lt;10 <br>					tx#=e\spx<br>				Else <br>					If pvty&gt;10 <br>						tx#=-e\spx<br>					End If<br>				End If<br>			EntityParent ship,pvt<br>			TurnEntity e\entity,tx#,ty#,tz#<br>			;if facing player fire bullet.<br>			If pvtx&gt;-20 And pvtx&lt;20 And pvty&gt;-20 And pvty&lt;20 And Rnd(1,200)&gt;180<br>				eb.enemybullet = New enemybullet<br>				eb\count = 100<br>				eb\ebx# = Rnd(-2.5,2.5)<br>				eb\eby# = Rnd(-2.5,2.5)<br>				eb\entity = CopyEntity(enemybullet,e\entity)<br>				eb\sndplayed = False<br>				EntityParent eb\entity,0<br>			End If<br>			tx#=0<br>			ty#=0<br>			tz#=0<br>		End If <br>		If e\ca% = goback;GOBACK<br>			EntityParent center,e\entity<br>			pvtx=EntityX(center,False)<br>			pvty=EntityY(center,False)<br>			;Rotate z based on x position<br>			If pvtx&lt;-2<br>				tz#=e\spz<br>			Else <br>				If pvtx&gt;2<br>					tz#=-e\spz<br>				End If<br>			End If<br>			;rotate x based on y<br>				If pvty&lt;-2 <br>					tx#=e\spx<br>				Else <br>					If pvty&gt;2 <br>						tx#=-e\spx<br>					End If<br>				End If<br>			EntityParent center,0<br>			TurnEntity e\entity,tx#,ty#,tz#<br>		End If<br>		<br>		If e\ca% = base;Attack Base<br>			EntityParent msite,e\entity<br>			pvtx=EntityX(msite,False)<br>			pvty=EntityY(msite,False)<br>			;Rotate z based on x position<br>			If pvtx&lt;20<br>				tz#=e\spz<br>			Else <br>				If pvtx&gt;20<br>					tz#=-e\spz<br>				End If<br>			End If<br>			;rotate x based on y<br>				If pvty&lt;20 <br>					tx#=e\spx<br>				Else <br>					If pvty&gt;20 <br>						tx#=-e\spx<br>					End If<br>				End If<br>			EntityParent msite,0<br>			TurnEntity e\entity,tx#,ty#,tz#<br>			;if facing base fire bullet.<br>			If pvtx&gt;-40 And pvtx&lt;40 And pvty&gt;-40 And pvty&lt;40 And Rnd(1,200)&gt;198<br>				eb.enemybullet = New enemybullet<br>				eb\count = 150<br>				eb\ebx# = Rnd(-3.5,3.5)<br>				eb\eby# = Rnd(-3.5,3.5)<br>				eb\entity = CopyEntity(enemybullet,e\entity)<br>				EntityParent eb\entity,0<br>			End If<br>			tx#=0<br>			ty#=0<br>			tz#=0<br>		End If <br><br>		<br>		If e\ca% = climb;CLIMB<br>			If EntityPitch(e\entity,True)&gt;-65<br>				TurnEntity e\entity,-e\spx,0,0<br>			End If<br>			If EntityRoll(e\entity,True)&lt;-10<br>				TurnEntity e\entity,0,0,e\spz<br>			Else <br>				If EntityRoll(e\entity,True)&gt;10<br>					TurnEntity e\entity,0,0,-e\spz<br>				End If<br>			End If<br>		End If<br><br>		If e\ca% = loopleft ;LOOPLEFT<br>			If EntityRoll(e\entity,True)&lt;-90<br>				TurnEntity e\entity,0,0,e\spz<br>			End If<br>			If EntityRoll(e\entity,True)&gt;-90<br>				TurnEntity e\entity,0,0,-e\spz				<br>			End If<br>			If EntityPitch(e\entity,True)&lt;0<br>				TurnEntity e\entity,0,0,e\spz<br>			End If<br>			If EntityPitch(e\entity,True)&gt;0<br>				TurnEntity e\entity,0,0,-e\spz<br>			End If<br>			TurnEntity e\entity,e\spx,0,0<br>			<br>		End If<br>		If e\ca% = loopright ;LOOPRIGHT<br>			If EntityRoll(e\entity,True)&lt;90<br>				TurnEntity e\entity,0,0,e\spz<br>			End If<br>			If EntityRoll(e\entity,True)&gt;90<br>				TurnEntity e\entity,0,0,-e\spz				<br>			End If<br>			If EntityPitch(e\entity,True)&lt;0<br>				TurnEntity e\entity,0,0,-e\spz<br>			End If<br>			If EntityPitch(e\entity,True)&gt;0<br>				TurnEntity e\entity,0,0,e\spz<br>			End If<br>			TurnEntity e\entity,e\spx,0,0<br>		End If		<br>		e\ct%=e\ct% - 1<br>		If EntityY(e\entity,True) &lt; 2000 And e\ca &lt;&gt; chase;CLIMB IF TOO LOW<br>			e\ca%=climb<br>			e\ct%=500<br>		End If<br>		If e\ct% &lt; 1<br>			;current action time expired so select new action<br>			e\ca%=Rnd(1,6)<br>			e\ct%=500<br>			If e\ca% = chase <br>				e\ct% = 4000<br>			End If<br>			If e\ca% = goback<br>				e\ct% = 1000<br>			End If<br>			If e\ca% = climb <br>				;any climb code here<br>			End If<br>			If e\ca% = base<br>				e\ct% = 4000<br>			End If<br>			If e\ca% = loopleft Or e\ca% = loopright<br>				;code here<br>			End If<br>		End If	<br>		MoveEntity e\entity,0,0,e\spd	<br>		enemycount = enemycount +1<br>	Next<br>End Function	<br><br>__________________________<br> <br><br>However, when I comment out the following line from the MoveCamera function, <br><br>;EntityParent(fwdcam,0)<br><br>the radar camera works but my camera movement is affected negatively. I can't understand how this line affects the radar as the radar camera is not parented to fwdcam nor vice versa.<br><br>Can anyone help me with this one?<br><br>Regards <br>Johnno <br><br></td></tr></table><br>
<a name="437365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 5 hours .. is that all ... I've spent days trying to trace 1 bug ;)   I think you need to be more specific about what doesn't work though as I doubt anyone is going to trawl through all you're code without media and anything to try it with.  <br><br>I did notice that you're creating a camera every time you change the view.  Not sure of the overheads here but doesn't seem like a good idea.  Why not just reposition one camera to where you need it depending on the view?<br>Also, the way you're doing the camera stuff with a load of pivots seems overcomplicated to me - maybe if you simplify this it would help.<br><br>Stevie <br><br></td></tr></table><br>
<a name="437468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackD</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Woah.. thats complicated. :) Let me get this straight. You're using PVT as a pivot for the player. Then you're creating FWDCAM as a pivot for the camera, and parenting it to PVT. Then you're creating a camera and parenting it to FWDCAM which is parented to PVT?<br><br>Try eliminating the FWDCAM pivot altogether (backup your code first, because it'll take too long to change back afterward). The camera should be following PVT anyway, so theres no need for ANOTHER pivot, its useless and can just introduce problems. if fowardcam is active, parent the camera to PVT and just set the child in the correct position relative to PVT to get the view you want.<br><br>In addition, your forwardcam code is like this:<br><pre class=code>
Function MoveCamera() 
fparent=GetParent(fwdcam) 
EntityParent(fwdcam,pvt,True) 
dx#=EntityX(fwdcam) 
dy#=EntityY(fwdcam) 
dz#=EntityZ(fwdcam) 
r#=EntityRoll(fwdcam) 
p#=EntityPitch(fwdcam) 
y#=EntityYaw(fwdcam) 
If r# =&gt; 180 Then r# = r# - 360 
If r# =&lt; -180 Then r# = r# + 360 
TurnEntity fwdcam,-p#,-y#,-r#*.03 
TranslateEntity fwdcam,-dx*.1,-dy*.1,-(dz+10)*.5 
EntityParent(fwdcam,0) 
End Function 
</pre><br>In the beginning you use fpparent to find the parent of fwdcam. Why is this? Because you just set the parent for fwdcam to 0 without using fpparent in the rest of the code there. Is there something you meant to do with that information and forgot to?<br><br>+BlackD <br><br></td></tr></table><br>
<a name="437773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeppe Nielsen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try using an EntityOrder with a larger number than 0, for your radar camera, this might do the trick, although I haven't looked at your code. <br><br></td></tr></table><br>
<a name="438771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Check out the current Source for <a href="http://www.bloodwych.netfirms.com/Galactic/Galactic.htm" target="_blank">Galactic</a> so far there is a multiple camera-view option which alternates between:<br><br>in-cockpit camera<br>rear-view cam,<br>view from just behind,<br>external, rotational - mouse controlled view<br><br>The radar has a separate camera render visible when in cockpitview mode.<br><br>Although it's quite messy and maybe not so clear to discern if you've only had 2 weeks worth of Blitzing ;-) <br><br></td></tr></table><br>
<a name="438774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Without reading through your code...you can create a bunch of cameras then show/hide the ones you're interested in or not.<br><br>If you want a smaller camera viewport rendered over your main camera do something like<br><pre class=code>hideentity littlecam
showentity maincam
renderworld
showentity littlecam
hideentity maincam
renderworld
flip</pre><br>This will render your main scene then render your extra cam afterwards (ie overlay it) then flip the backbuffer.<br><br>Also look at using the {codebox}{/codebox} tags (with [] instead of {}) to maintain your code formatting. The code you've posted looks horrible due to lack of indenting. <br><br></td></tr></table><br>
<a name="438813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Viperfish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks everyone for your replies. I think my code is a bit all over the place. I've got a lot to learn.<br>The following line;<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">entityorder radarcam,-1</textarea><br>has fixed the problem.<br><br>As for the reason I've changed cameras this way... It was the first way I tried it and it worked. As I said I've got a lot to learn :)<br><br>Thanks for your help.<br>Regards<br>Johnno <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
