<!DOCTYPE html><html lang="en" ><head ><title >CallDll</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >CallDll</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >CallDll</a><br><br>
<a name="444650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RestKrat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have created a DLL with Delphi.  It is a file requestor. It works fine with Darkbasic (the fileselector dialog appears, I can select a file,  The file path and name are returned to darkbasic) , but when I try to use it with BlitzBasic it works up to the point of selecting a file.   The file path and name do not return to Blitzbasic.   Only a number is returned.  I can select the same file over and over again and get a different number each time.  How do I get Blitzbasic to return a string from a dll?  What am I doing wrong.<br><br>Thanks<br>RestKrat <br><br></td></tr></table><br>
<a name="444657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Post some code. <br><br></td></tr></table><br>
<a name="444665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RestKrat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is the delphi code:<br><br>library FormDLL;<br><br>uses<br>  Unit1 in 'Unit1.pas' {Form1};<br><br>exports<br>  getfile;<br><br>end.<br><br><br>unit Unit1;<br><br>interface<br><br>uses<br>  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,<br>  StdCtrls;<br><br>type<br>  TForm1 = class(TForm)<br>    OpenDialog1: TOpenDialog;<br>    Button1: TButton;<br>    procedure Button1Click(Sender: TObject);<br>  private<br>    { Private declarations }<br>  public<br>    { Public declarations }<br>  end;<br><br>function  getfile (fis: Pchar) : pchar; stdcall;<br><br>var<br>  Form1: TForm1;<br><br>implementation<br><br>{$R *.DFM}<br><br>procedure TForm1.Button1Click(Sender: TObject);<br>begin<br>opendialog1.Execute;<br>end;<br><br>function  getfile (fis: Pchar) : pchar; stdcall<br>var<br>Form1 : TForm1;<br>begin<br>Form1 := Tform1.Create (application);<br>form1.OpenDialog1.Execute;<br>end;<br><br>end.<br><br><br>Here is the Blitzbasic code:<br><br>While Not KeyHit(1)<br><br>If KeyDown ( 32 )=True Then <br>s$=CallDLL("i:\programs code\darkpro\testdll\FormDll.dll","getfile")<br>EndIf<br><br>Text 10,130,"Return " + s$<br>Flip<br>Wend<br>End <br><br></td></tr></table><br>
<a name="444726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's probably a pointer to a string (character).  If you absolutely must use CallDLL (i.e. if you just have BlitzBasic) then you'll probably have to use RtlMoveMemory (kernel32) to copy the contents of the memory buffer that's being pointed to. <br><br></td></tr></table><br>
<a name="444772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Seldon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If he has just BlitzBasic, he can't use RtlMoveMemory() as it hasn't WinAPI support either. :) <br><br></td></tr></table><br>
<a name="444908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I'm glad we have userlib support now.<br><br>CallDLL, I never knew thee, and never I shall... <br><br></td></tr></table><br>
<a name="444922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackD</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> wouldn't he have to create a user.decls file with the "getfile" call? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
