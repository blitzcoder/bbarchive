<!DOCTYPE html><html lang="en" ><head ><title >Animation Probs</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Animation Probs</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Animation Probs</a><br><br>
<a name="263474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sigi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>i have an animated Raptor loaded with "LoadAnimMesh" and<br>added AnimSequences with "LoadAnimSeq".<br>First i animate the Raptor with this:<br>Animate raptor,1,0.4,2,1.<br>Now i shoot at the Raptor and countdown a raptorhealth variable(from 100).<br>If the Variable=0 the Raptor should play another AnimSequence. But after the Raptorhealth Variable reaches 0<br>the first Anim stops and if i shoot one more time (raptorhealth=-10) the next animseq is playing. Why this?<br><br>If raptorhealth=0 ;Animation Stops - if raptorhealth is -10<br>                  ;the next animation plays <br>  Animate raptor,3,0.4,3,0<br>  ;EntityAlpha raptor,0.5<br>  ;HideEntity raptor<br>  ;PlaySound(raptordie)<br>  ChannelVolume raptorchannel,0<br>EndIf<br><br>Thank you <br><br></td></tr></table><br>
<a name="263486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd have to see the rest of your code to be sure but it looks like you are calling the Animate command every frame while raptorhealth=0.  What you want is to only call Animate once to start playing the animation.  In other words have your If statement check if the animation is already playing. <br><br></td></tr></table><br>
<a name="263490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sigi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok,<br>Here is the whole Code without Includes, can you please<br>look at it? Thank you.<br>Include "functions.bb"<br>Include "constants.bb"<br>Include "types.bb"<br>Include "globals.bb"<br><br>Graphics3D 1024,768,32<br>SetBuffer BackBuffer()<br><br>HidePointer() ; löscht mauszeiger im windows-modus<br><br>Collisions COLLISION_PLAYER,COLLISION_OBSTICLE,2,2<br>Collisions COLLISION_BULLET,COLLISION_OBSTICLE,2,1<br>Collisions COLLISION_BULLET,COLLISION_RAPTOR,2,1<br>Collisions COLLISION_PLAYER,COLLISION_RAPTOR,2,2<br><br>;setup lighting<br>;Global light=CreateLight()<br>;RotateEntity light,45,45,0<br>;LightColor light,126,126,126<br>;AmbientLight 70,70,70<br><br><br>;himmel<br>Global skytexture=LoadTexture("textures/myclouds1.bmp")<br>ScaleTexture skytexture,4000,4000<br>Global skyplane1=CreatePlane()<br>PositionEntity skyplane1,0,400,0<br>EntityTexture skyplane1,skytexture<br>;FreeTexture skytexture - nicht freigeben, wird zur bewegung gebraucht<br>RotateEntity skyplane1,0,0,180<br>EntityFX skyplane1,8<br>;EntityBlend skyplane1,4<br>EntityType skyplane1,COLLISION_OBSTICLE<br>EntityPickMode skyplane1,2<br><br>;boden<br>plane=CreatePlane()<br>EntityType plane,COLLISION_OBSTICLE<br>EntityPickMode plane,2<br><br>Global grass_tex=LoadTexture( "textures/gras_1.bmp");terrain-1.jpg" )<br>EntityTexture plane,grass_tex<br>FreeTexture grass_tex<br><br>;player<br>player=CreatePivot() ; pivot fuer kamera = player<br>EntityRadius player,0.85 ; radius fuer kollision<br>PositionEntity player,0,0.85,0 ; eyes height<br>EntityType player,COLLISION_PLAYER<br><br>;camera<br>camera=CreateCamera(player) ; kamera an pivot binden<br>TranslateEntity camera,0,0.85,0<br>CameraRange camera,0.2,4000<br>CameraFogMode camera,1<br>CameraFogRange camera,1,80<br>CameraFogColor camera,100,110,100<br>CameraClsColor camera,100,100,110<br>ears=CreateListener(camera)<br><br>backgrsound=LoadSound("sounds/wind.wav")<br>LoopSound backgrsound<br>PlaySound backgrsound<br><br>raptorwav=Load3DSound("sounds/db_growler2.wav")<br>raptordie=Load3DSound("sounds/db_runtaur.wav")<br><br>gunfire=LoadSound("sounds/db_gun1.wav")<br>jumpsound=LoadSound("sounds/jump.wav")<br><br>fort=LoadMesh("models/fort1.3ds")<br>EntityType fort,COLLISION_OBSTICLE<br>PositionEntity fort,5,0,0<br>EntityPickMode fort,2<br><br>;Global raptor2=LoadMesh("models/L-Thug-Attack1.x")<br>;EntityType raptor2,COLLISION_RAPTOR<br>;PositionEntity raptor2,-10,0,0<br>;EntityPickMode raptor2,2<br><br>raptor=LoadAnimMesh("models/raptor_static.3ds")        <br>LoadAnimSeq(raptor,"models/raptor_attack.3ds")<br>LoadAnimSeq(raptor,"models/raptor_idle.3ds")<br>LoadAnimSeq(raptor,"models/raptor_die.3ds")<br>LoadAnimSeq(raptor,"models/raptor_move.3ds")<br>LoadAnimSeq(raptor,"models/raptor_impact.3ds")<br>EntityType raptor,COLLISION_RAPTOR,True ; ohne True keine Kollision bei AnimMeshes<br>ScaleEntity raptor,1.1,1.1,1.1<br>PositionEntity raptor,20,0.1,10<br>EntityRadius raptor,1.5<br>EntityPickMode raptor,2<br><br>LoopSound raptorwav<br>raptorchannel=EmitSound(raptorwav,raptor)<br><br>Animate raptor,1,0.4,2,1<br><br>mp5.gun = New gun ; create a new gun (mp5)<br>mp5\gun_handle = LoadMesh("models/mp5.3ds",camera) ;waffe gunpivot zugeordnet<br>ScaleEntity mp5\gun_handle,1.2,1.2,1.2 ; scale mp5-gun<br>mp5\gun_x# = 0.15 ; set gun coordinates<br>mp5\gun_y# = -0.22<br>mp5\gun_z# = 0.33<br>PositionEntity mp5\gun_handle,mp5\gun_x#,mp5\gun_y#,mp5\gun_z#<br>TurnEntity mp5\gun_handle,0,4,5<br>mp5\gun_pivot = CreatePivot(mp5\gun_handle) ; pivot for the mp5-gun<br>PositionEntity mp5\gun_pivot,0,0,0.2<br><br>colt.gun = New gun ; create a new gun (colt)<br>colt\gun_handle = LoadMesh("models/colt.3ds") ;waffe gunpivot zugeordnet<br>ScaleEntity colt\gun_handle,1.8,1.8,1.8 <br>colt\gun_x# = 10 ; set gun coordinates<br>colt\gun_y# = 0.5<br>colt\gun_z# = 10<br>PositionEntity colt\gun_handle,colt\gun_x#,colt\gun_y#,colt\gun_z#<br>TurnEntity colt\gun_handle,0,4,0<br><br>muzzle1=LoadSprite("textures/muzzleflash_front_2.jpg",2,mp5\gun_pivot)<br>PositionEntity muzzle1,0,0.1,0.4<br>ScaleSprite muzzle1,0.2,0.2<br>EntityAlpha muzzle1,0.0<br>EntityFX muzzle1,1<br><br>Global mousepointer=LoadSprite("textures/my_crosshair_2.bmp",2,camera)<br>PositionEntity mousepointer,0.008,-0.013,1.5;0.8<br>ScaleSprite mousepointer,0.02,0.02<br>EntityBlend mousepointer,3 ; macht crosshair besser sichtbar, auch in der Entfernung<br><br><br>mypanelleft=LoadImage("textures/mypanel_left.bmp")<br>MaskImage mypanelleft,0,0,0<br><br>sniperpanel=LoadImage("textures/sniper.tga")<br><br><br>While Not KeyDown( 1 )<br>    <br>;Framecounter_nur fuer FPS-Anzeige<br>Framecounter_counter=Framecounter_counter+1<br>If Framecounter_time=0 Then Framecounter_time=MilliSecs()<br>If Framecounter_time+1001 &lt;MilliSecs() Then<br>Framecounter_framerate=Framecounter_counter<br>Framecounter_counter=0<br>Framecounter_time=MilliSecs()<br>EndIf<br>;End Framecounter<br><br><br>If KeyHit(17)= True Then enable=1 - enable ; W-Taste ist wireframe<br>	WireFrame enable<br><br><br>  Repeat <br>    elapsed=MilliSecs()-time <br>  Until elapsed <br><br>    ticks=elapsed/period <br><br>    tween#=Float(elapsed Mod period)/Float(period) <br><br>; -------------------------------------------------------------- <br>; Update game and world state <br>; -------------------------------------------------------------- <br><br>  For k=1 To ticks <br><br>    time=time+period<br>	If k=ticks Then CaptureWorld<br>	  UpdateGame ()<br>      UpdateWorld<br><br>  Next<br>	 <br>	RenderWorld tween# <br>     <br>	; 2D drawing<br>	DrawImage mypanelleft,20,GraphicsHeight()-40<br>	<br>	If MouseDown(2)<br>	  DrawImage sniperpanel,0,0<br>	  CameraZoom camera,3<br>	  HideEntity mousepointer<br>	Else<br>	  CameraZoom camera,1<br>	  ShowEntity mousepointer<br>	EndIf<br>		<br>	;Text GraphicsWidth()/2,GraphicsHeight()/2,"+"<br>	;Text 10,0,"y-achse: " +cy<br>	;Text 10,20,"x-achse: " +cx	<br>	Text 10,40,"Hoehe: "+EntityY(player)<br>	Text 10,80,"fps: "+Framecounter_framerate<br>	Text 10,120,"raptorhealth "+raptorhealth<br>	; end 2D drawing<br>	<br>	Flip<br>	<br>Wend<br><br>End<br><br>Function UpdateGame()<br>  <br>  rot#=rot#+0.7 ; rotate colt<br>  RotateEntity colt\gun_handle,0,rot#,0 ; rotate colt<br>  ;MoveEntity colt\gun_handle,0,(Rnd(0,0.1)),0<br>  <br>      <br>  skytex_x#=skytex_x# + .0002 ;wolken bewegen<br>  PositionTexture skytexture,skytex_x#,0 ;wolken bewegen<br>    <br>  ;jumping<br>  If jumping=0<br>    If KeyDown(57) Then yvel#=jumpvel#  ; leertaste<br>      If KeyDown(57) =True Then PlaySound(jumpsound)<br>      jumping=1<br>      gravity#=0.09 ; verringert gravity, player kann hoeher springen<br>  EndIf<br><br>  If jumping=1 <br>    yvel#=yvel#-jumpgravity#<br>    by#=by#+yvel#<br>  EndIf<br><br>  If by#&lt;1 Then by#=1 yvel#=0 jumping=0 gravity#=0.3<br>    <br>  ;speed#=speed# * .99<br>  TranslateEntity player,0,yvel#,speed#<br>  ;end jumping<br><br><br>	If KeyDown( 205 )=True Then MoveEntity player,backwardspeed#,0,0 ;right arrow key<br>	If KeyDown( 203 )=True Then MoveEntity player,-backwardspeed#,0,0 ;left arrow key<br>	If KeyDown( 208 )=True Then MoveEntity player,0,0,-backwardspeed# ; down arrow key<br>	If KeyDown( 200 )=True Then MoveEntity player,0,0,forwardspeed# ; up arrow key<br>	<br>	 ;mit shift-taste<br>	If KeyDown( 205 ) And KeyDown(54) = True Then MoveEntity player,backwardspeed#/2,0,0 ;right arrow key<br>	If KeyDown( 203 ) And KeyDown(54) = True Then MoveEntity player,-backwardspeed#/2,0,0 ;left arrow key<br>	If KeyDown( 208 ) And KeyDown(54) = True Then MoveEntity player,0,0,-backwardspeed#/2 ; down arrow key<br>	If KeyDown( 200 ) And KeyDown(54) = True Then MoveEntity player,0,0,forwardspeed#/2 ; up arrow key<br>			<br>	;kriechen<br>	If KeyDown(157) = True<br>	  PositionEntity camera,0,0.2,0 ; eyes height<br>	Else<br>	  PositionEntity camera,0,1,0<br>	EndIf ; kriechen ende<br>	  <br>	;mouselook<br>	cx=(cx-(MouseX()-(GraphicsWidth()/2))) Mod 360	<br>	cy=(cy+(MouseY()-(GraphicsHeight()/2))) Mod 360<br><br>	If cy&lt;-90 Then cy=-90<br>	If cy&gt;80 Then cy=80<br><br>	RotateEntity player,cy,cx,0<br><br>	MoveMouse GraphicsWidth()/2,GraphicsHeight()/2 ; muss hier stehen, sonst unter 360 Grad <br>	<br>	TranslateEntity player,0,-gravity#,0 ; gravity<br>	;end mouselook<br>			<br>	If raptorhealth=0<br>	  Animate raptor,3,0.4,3,0<br>	  ;EntityAlpha raptor,0.5<br>	  ;HideEntity raptor<br>	  ;PlaySound(raptordie)<br>	  ChannelVolume raptorchannel,0<br>	EndIf<br>	<br>	If MouseHit(1)=True <br>			<br>	target=CameraPick(camera,GraphicsWidth()/2,GraphicsHeight()/2)<br>	mytarget=CreatePivot()<br>	PositionEntity mytarget,PickedX(),PickedY(),PickedZ()<br>				<br>	shootbullet()<br>		 	<br>	PlaySound(gunfire)<br>	EntityAlpha muzzle1,0.9<br>	Else<br>	EntityAlpha muzzle1,0.0<br>	EndIf<br>			<br>	updatebullets() <br><br></td></tr></table><br>
<a name="263533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sigi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any Help, please?<br>Thanks <br><br></td></tr></table><br>
<a name="265608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you checked what I mentioned above?  When I said I would need to see the rest of your code to be sure I didn't mean I want to (frankly I don't have time) but that I'm not 100% sure.  Still it strikes me as a pretty likely reason for your problem: instead of calling Animate just once to start playing the animation, you call it every frame raptorhealth=0 (which is every frame until it is hit again) thus resetting the animation every frame. <br><br></td></tr></table><br>
<a name="265654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sigi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you for your help jhocking.<br><br>I will rewrite the complete code,<br>because i have found another bug that makes me crazy.<br>Some Codepieces are grabbed from the Forum and the Archives.<br>But i will understand every single peace of the Code, so i<br>am starting new. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
