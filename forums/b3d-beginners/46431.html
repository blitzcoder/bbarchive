<!DOCTYPE html><html lang="en" ><head ><title >Open files</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Open files</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Open files</a><br><br>
<a name="516554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My program is constantly opening and closing files, and several times now I've run into serious bugs because I'd forgotten to close a file, which was then opened over and over and eventually caused a crash (too many open files).<br><br>To help me spot these bugs before they happen, I'm thinking of putting a something on the screen to tell me how many open files I have, so that I can spot problems before they start, but is there any way of doing it? Is there some way to check how many files are currently open? <br><br></td></tr></table><br>
<a name="516596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you should store all filenames, their handles and a flag that signals if they're open for writing or readin in some arrays or types, so when you open a file, simply parse the array ant see if it's already open. If you close a File, simply remove it from the arrays. You can do this by replacing the OpenFile and CloseFile Commands by a Functioncall that will do both, store infos in arrays plus open or close the files. So all you have to do is writing two functions, then use the Replace Tool to replace eg. every "CloseFile(" by "MyCloseFile(". <br><br></td></tr></table><br>
<a name="516633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rook Zimbabwe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can also increment a count by one... ex:<br><pre class=code>foo=loadimage("idiot.png")
loadfiles = loadfiles+1
foo2=loadimage("idiot2.png")
loadfiles=loadfiles+1
etc...
</pre>I mean that seems to be what you are asking... <br>I think there is a way to check for fileopen using one of the DLLs in the toolbox. Look undeer File Utilitys and MISC.<br><br>Maybe...<br><br>Rook <br><br></td></tr></table><br>
<a name="516874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, can't find that dll.<br><br>Strange little problem has occured, which I'm pretty sure is due to too many open files (does Blitz give a specific error about too many open files or does it just act strangely?). If I leave my program running for about 20-30 minutes, it eventually crashes, which I suspect is because some file is being constantly opened but never closed. The odd thing is, when I look at the debug list, the variable to open the file isn't on the list at all.<br><br>In other words, I have the line.....<br><br>PlayerFile=ReadFile("gamedata\players\playerdata.txt")<br><br>But when I look at the debug window, 'Playerfile' isn't even listed. Surely it should just be listed, but show a zero (meaning it failed to open). Right? <br><br></td></tr></table><br>
<a name="517505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes. How many files is "many"? Probably it's a windows problem. Also, you should not open a file twice without to close it. Of course there must be some stack that stores what files are open, and if you open the same file again and again, there may be some kind of stack overflow the sooner or the later.<br><br>Again, if you open a file twice, what for do you open it? Reading or wrinting? And if you open it for writing, do you want to overwrite it, or are you working with seek etc? <br><br></td></tr></table><br>
<a name="517547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> whenever I use a command that requires a closing command (i.e. OpenFile), I immediately below it put the closing command and then add the code I need to inbetween.  This way, I never have these issues. <br><br></td></tr></table><br>
<a name="518489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I'm starting to learn that the hard way. Luckily I found the last problem just by luck - I'll be more careful from now on when opening files. <br><br></td></tr></table><br>
<a name="518505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> does Blitz give a specific error about too many open files or does it just act strangely <br></div><br>It acts strangely.  It might even be a Windows problem maybe.  I learnt very quickly that's a really good idea not to open or close files in a main loop ;] ie it's not a good idea to constantly open files even if you are not leaving any open!  Not only is it a slow operation, but Windows does -not- like it... <br><br></td></tr></table><br>
<a name="518967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows also uses optimized File access, such as delayed writing or cached reading. I'm afraid this won't work 100% accurately in heavy stress situations. <br><br></td></tr></table><br>
<a name="519011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a bit of a worry because my server program is very heavy on disk usage. Is there some way to catch Windows erros without the program stopping? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
