<!DOCTYPE html><html lang="en" ><head ><title >EntityPick example please</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >EntityPick example please</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >EntityPick example please</a><br><br>
<a name="927919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fox95871</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would someone mind making an example using EntityPick, LinePick, CameraPick, and EntityPickMode? None of the docs have examples for them, though they all refer to each other for reference!? CameraPick has an example, but it doesn't use the other 3 in it, so I don't understand how it relates. Hope someone here can help :) <br><br></td></tr></table><br>
<a name="927944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't have examples, but EntityPick, LinePick and CameraPick all fundamentally do the same thing. EntityPick does a line pick from the position of the entity (0,0,0) to infinity in front of the entity (0,0,infinity). LinePick is the same but picks from the x,y,z position to an offset position dx,dy,dz relative to the start point.<br><br>EntityPickMode chooses whether an entity is picked as an imaginary sphere, imaginary cube, or using the triangles of the mesh.<br><br>Hope this helps (a little). <br><br></td></tr></table><br>
<a name="927946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> They're all basically raycasting. It casts a ray from any given point in 3D space to any given point in 3D space, and tells you if it hit anything along the way. If it did, it tells you what it hit and where. <br><br></td></tr></table><br>
<a name="927947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait wait, I thought entitypick used a sphere, as you can specify the range# of the picking to do. The way you described it's nothing but another linepick in the Z Axis. Is that so? <br><br></td></tr></table><br>
<a name="927948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xtremegamr</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a simple example. Basically, if the user clicks the sphere with his\her mouse, a message will be displayed.<br><br><pre class=code>

graphics3d 800,600,0,2

cam=createcamera()
s=createsphere()

;main loop
while not keyhit(1)

setbuffer backbuffer()
cls

if mousehit(1) then
     e=camerapick(cam,mousex(),mousey())
     if e=s then ;if the selected entity is the sphere...
         msg=true ;display a message
     end if
end if

updateworld
renderworld

if msg=true then
     text 0,0,"Ow! That hurt!"
end if

flip
wend

</pre> <br><br></td></tr></table><br>
<a name="927949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mortiis</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Wait wait, I thought entitypick used a sphere, as you can specify the range# of the picking to do. The way you described it's nothing but another linepick in the Z Axis. Is that so? <br></div><br><br>It's up to EntityPickMode. If you set the picking mode to sphere for that specific entity, then it shall use sphere. <br><br></td></tr></table><br>
<a name="927974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Wait wait, I thought entitypick used a sphere, as you can specify the range# of the picking to do. The way you described it's nothing but another linepick in the Z Axis. Is that so? <br></div><br><br>It is just another linepick along the local Z axis of the source entity.  <br><br><a href="http://www.blitzbasic.com/b3ddocs/command.php?name=EntityPick&amp;ref=3d_a-z" target="_blank">http://www.blitzbasic.com/b3ddocs/command.php?name=EntityPick&amp;ref=3d_a-z</a> <br><br></td></tr></table><br>
<a name="928037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> My mistake. You are right: EntityPick does have a range. I've never actually used it, cos I use LinePick for most things (more flexible). Your picking can also have a radius which helps prevent lines 'missing' the target with gaps (and math errors) and the like. <br><br></td></tr></table><br>
<a name="928047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note that increasing the raduis also increases the time taken to do the pick. <br><br></td></tr></table><br>
<a name="930712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fox95871</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, this didn't seem to work:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 640,480,32,2
SetBuffer BackBuffer()

camera=CreateCamera()
light=CreateLight()
sphere=CreateSphere()
MoveEntity sphere,0,0,10

While Not KeyHit(1)
Cls

If MouseHit(1)
e=CameraPick(camera,MouseX(),MouseY())

; If the selected entity is the sphere, display a message.
If e=sphere Then
message=1
EndIf

EndIf

UpdateWorld
RenderWorld

If message=1 Then
Text 0,0,"Ow! That hurt!"
EndIf

Flip
Wend
End
</textarea><br><br>Am I missing something? <br><br></td></tr></table><br>
<a name="930720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, you need to set the entitypickmode of the sphere to 1 or 2.<br><br>Stevie <br><br></td></tr></table><br>
<a name="930721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
e=CameraPick(camera,MouseX(),MouseY())
</pre><br><br>Won't work. You need to do the pick:<br><br><pre class=code>
CameraPick(camera,MouseX(),MouseY())
e = PickedEntity()
</pre><br><br>CameraPick simple executes the linepick. Using Pickedx(), pickedy() etc etc (read the manual) you can get data from the pick. If pickedentity() returns 0, nothing has been picked. <br><br></td></tr></table><br>
<a name="930757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Ross,  you're wrong.  If you run the example above and apply an entitypickmode to the sphere it works just fine.   I guess it makes PickedEntity() somewhat redundant. <br><br></td></tr></table><br>
<a name="930929"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fox95871</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried both and neither work. Is there some assumptive thing I'm supposed to already know about? I thought clicking on the sphere was supposed to make the message appear. <br><br></td></tr></table><br>
<a name="930947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I mentioned in post 11, you need to set the entitypickmode of the sphere.  Add this line after the "moveentity sphere ..." line :<br><br><pre class=code>
EntityPickMode sphere, 1
</pre><br><br>Works just fine here.<br><br>Stevie <br><br></td></tr></table><br>
<a name="931374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fox95871</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh okay, thanks for explaining that. I was just putting in the code snippets. <br><br></td></tr></table><br>
<a name="932044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fox95871</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> The only thing I don't understand now is how to make the last parameter of EntityPickMode work in conjunction with EntityVisible, so cube2 will obscure the ghost cube even though it's behind it. I've got cube2 setup as transparent, but I don't know how to do the rest.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 640,480,32,2
SetBuffer BackBuffer()

camera=CreateCamera()
MoveEntity camera,0,1,-10
TurnEntity camera,0,0,0
CameraClsColor camera,127,234,255

ground=CreateCube()
ScaleEntity ground,100,.1,100
EntityColor ground,85,160,79

cube1=CreateCube()
MoveEntity cube1,-1,1,0
EntityPickMode cube1,1,0

cube2=CreateCube()
MoveEntity cube2,0,1,-2
EntityPickMode cube2,2,1

ghostcube=CreateCube()
MoveEntity ghostcube,1,1,-4
EntityPickMode ghostcube,2,0
EntityAlpha ghostcube,.5

While Not KeyHit(1)
Cls

If MouseHit(1)
entitylastclicked=CameraPick(camera,MouseX(),MouseY())

If entitylastclicked=cube1 message=1
If entitylastclicked=cube2 message=2
If entitylastclicked=ghostcube message=3
If entitylastclicked=0 message=0

EndIf

UpdateWorld
RenderWorld

Color 0,0,0
Text 0,0,"Click the cubes in left to right succession."
If message=1 Text 0,15,"This cube is set as a sphere, so you can't touch it's corners."
If message=2 Text 0,15,"This one's set as a mesh, so you can. Setting it as a box would work too."
If message=3 Text 0,15,"This one is supposed to be partly obscured, so you can click any part of cube2."
If message=0 Text 0,15,""

Flip
Wend
End
</textarea> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
