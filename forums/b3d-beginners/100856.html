<!DOCTYPE html><html lang="en" ><head ><title >Blitz3D: links to DLL function lists.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Blitz3D: links to DLL function lists.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Blitz3D: links to DLL function lists.</a><br><br>
<a name="1194060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leafus</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heyawl,<br><br>Blitz3D has the CallDLL command and I can't figure out:<br><br>a) a good place to look for DLL filenames with a description of what they do. (without installing any programs I can't see source of to compile myself)<br><br>b) the functions within those DLL files once found, along with parameters and return values.<br><br>For myself, I am wanting to do what I am sure will prove to be a simple thing that will involve nothing more than a standard System32 DLL, but I have no knowledge of such things, nor much of languages outside of the Blitz range. I want to know the Application Folder of the calling program (ie. my blitz game). I know it is a simple command in BlitzMax, and when I went looking in the System topic of the Blitz3D inline 2D help page I figured the only way around it's absence would be to use the CallDLL function I saw in there. I would also appeciate a breakdown of DLL variable structures (ie bytes per float/int/string/pointers/any types I don't know about... how strings work... how pointers work... anything that would be helpful to do with DLLs really).<br><br>Anyway, I've waffled on for long enough. If nothing else I hope my thought that this would make a good resource topic for posting of external DLL related links etcetera may prove fruitful.<br><br>Also any help with my personal problem would be appreciated please.<br><br>Thanking yaz all for reading and in advance for any help offered.<br><br>-Leafus :oD <br><br></td></tr></table><br>
<a name="1194113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The first thing is that the CallDLL command is more or less obsolete. It's been replaced by the rather superior "userlibs" system, which is handy because due to the limitations of CallDLL it can't actually do what you want anyway (it requires functions to have a different signature from the Windows API, so it definitively can't be used to call Windows system functions).<br><br>(CallDLL does have one use that userlibs can't achieve easily, which is that since it takes the function name as a string you can technically use it to dynamically select a function by name - 99% of the time, and in your use case, this isn't necessary or relevant.)<br><br><br>The "userlibs" system lets you make Blitz3D aware of your DLL and the functions it contains at compile-time. It can find and link to them internally and make the DLL functions usable like any other B3D command or user-defined function. As you can imagine this is much more useful than messing around with banks.<br><br>To set up a userlib, all you need is to create a .decls file with the name of the DLL and declarations for the functions you want it to export, and place this file in your Blitz3D/userlibs folder. When you restart the compiler (or, in IDEal, tell it to "refresh definitions"), it will be aware of the newly added functions and you can treat them as integrated commands. The DLL itself can be placed in your /userlibs folder, or in your project folder (the latter might be better, so you don't forget that the DLL has to go with the program when it's compiled and ready to distribute).<br><br>Windows system DLLs do <i>not</i> need to be copied (in fact, doing so is an <i>incredibly</i> bad idea and will ruin your system, plus redistributing them is illegal), because the third location the program knows how to search is the Windows System folder. Just trust that it will find any DLLs located there on its own (this includes kernel32, user32, OpenGL, etc.). Since you want a system function, this means that the DLL will be provided and you don't need to copy or move that file - you only need the .decls.<br><br>There are examples of .decls files in the code archives: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?cat=14" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?cat=14</a><br><br>In fact you'll find .decls there for the kernel32 and user32 libraries so those are probably what you want anyway - just copy them to your Blitz3D/userlibs folder and restart, and the functions will be available.<br><br>Documentation for Windows system functions can be found at MSDN: <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa904962.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/aa904962.aspx</a><br><br>The documentation for each function is good, but actually browsing MSDN is a nightmare (and they keep changing the layout!) - better to just stick the function name you want into Google and follow the MSDN result link. Once you get "into" the API docs there are plenty of crosslinks to narrow down your search.<br><br><br>Be warned that the Windows API is designed for people writing in C, which has a larger range of data types than Blitz3D, so not all Windows functions are usable directly. B3D <i>only</i> supports 32-bit integers ("DWORD" on MSDN), single-precision floats, char* (strings), and void* (which is specific to .decls functions and slightly complicated compared to B3D user-defined functions - don't be afraid to ask for help if this becomes relevant).<br><br><br>I actually have no idea how to do the specific thing you want to do, but I hope the above helps you find out. <br><br></td></tr></table><br>
<a name="1195069"></a>

<a name="1195071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> One thing that usually sucks is the lack of information about those windows constants, that are mentioned in all those help files. The easiest way to determine their values is: Get a copy of microsoft visual C, then copy all ,H files and all .CHM files (actually all header files and help files. The help files will explain each DLL,  eg. there may be kernel32.chm for kernel32.dll) and the .h files contain the immediate values for even the most exotic, ungooglable constant. Then you can search the constant, using a search tool, but ironicly the system search is too stupid to find anything and claims that there ain't no matches, which is absolutely crappy, so I wrote myself a lil search tool that searches all .h files and lists the line(s) that contains the wanted constant. took me 10 minutes. I wonder what those highly paid guys at microsoft do all the time, or if they maybe wanna prevent us from finding things for some sick reason. But the real sad part is: android is even worse. <br><br></td></tr></table><br>
<a name="1195109"></a>

<a name="1195111"></a>

<a name="1195112"></a>

<a name="1195123"></a>

<a name="1195225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Leafus, The <b>CallDLL</b> function is rather obsolete.<br><br>I've listed some sample programs that use CallDll, in case you'd want. ::<br>-----------------------------------------------------------------------------<br>Title: <b>Getting Drive Info with KERNEL32.DLL</b><br>created by author Klaas, in 2003, uses CallDLL (....) command.<br><br><font class="tiny"> source code: <a href="https://www.dropbox.com/s/9efaoqjhxf1jh0l/Getting%20Drive%20Info%20with%20KERNEL32.DLL_549.bb" target="_blank">https://www.dropbox.com/s/9efaoqjhxf1jh0l/Getting%20Drive%20Info%20with%20KERNEL32.DLL_549.bb</a> </font><br>-----------------------------------------------------------------------------<br>The old <b>BlitzSys</b> package uses CallDLL :: <br>; BLITZ SYS INCLUDE - V1.05<br>; ----<br>; Simple Win32 API Function Support! - Written by Rob Hutchinson &amp; Joseph Cox 2001-2002<br><br><font class="tiny"> download link: <a href="http://uploadingit.com/file/oufitjhfvxgvj1tk/BlitzSys%20V1.05%20(complete).zip" target="_blank">http://uploadingit.com/file/oufitjhfvxgvj1tk/BlitzSys%20V1.05%20(complete).zip</a> </font><br>-----------------------------------------------------------------------------<br>; Title: <b>CPU Info</b><br>; Author: BlitzSupport<br>; Date: 2002-08-23 01:32:40<br><br><font class="tiny"> link: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=403" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=403</a> </font> <br><br>code snippet:::  size = CallDLL (dll$, "_FindCPUNameLength") <br>( It is missing its DLL. )<br>-----------------------------------------------------------------------------<br><div class="quote"> The "userlibs" system lets you make Blitz3D aware of your DLL and the functions it contains at compile-time. <br></div><br>As Yasha said, 'userlibs' are superior.  The only downside with 'userlibs' <br>is that if your program can't detect a customized DLL immediately at <u>startup</u>, it will crash.<br><br>If you're thinking of using techniques like packing DLLs into <br>your main program, so that your program is advanced enough to <b>self-install</b>, that won't work,<br>because the moment your program starts up and detects that a DLL is missing, it will crash, <br>(even if those DLLs are already packed inside). <br>Therefore, you'll need to create a special installer.<br>__ I learned that logic bug the hard way. __ <img src="http://pcpuzzle.com/forum/images/smiles/icon_smile.gif">  <br><br>{ THat was so funnny, it took me a couple of days to find that bug. }<br>-----------------------------------------------------------------------------<br>Said jfk EO-11110, <div class="quote"> One thing that usually sucks is the lack of information about those windows constants <br></div><br> In many cases, various languages keep their constants a secret,  or try to make it hard,<br> <br> ..because they DON'T WANT YOU TO KNOW what their constants are. <img src="http://www.pcpuzzle.com/forum/images/smiles/icon_wink.gif"><br><br> So, a clever tactic I learned is to force the programming language to "print" its own constants.<br><br> In a PureBasic example, I wanted to know the constant values of ::<br> #PB_Keyboard_Qwerty, #PB_Keyboard_International, #PB_Keyboard_AllowSystemKeys<br><br> <img src="http://imageshack.us/a/img843/7379/g243.png"><br><br> I think that can work with Windows Constants too, I'm not sure.<br> Just print them to the screen, and you'll not need to search through <b>.h</b> files. <br><br></td></tr></table><br>
<a name="1195151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess you're wrong about that. they are included in the dlls at compilation time and windows, even if it was smart, could know only those of the active dlls. <br><br></td></tr></table><br>
<a name="1195224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I guess you're wrong about that. they are included in the dlls  <br></div><br>Please clarify, wrong about which ?  What's included in the dlls? <br><br></td></tr></table><br>
<a name="1195271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> the .h files are included in the dll sourcecode, like<br><br>INCLUDE "myconstants.bb"<br><br>, hence named header files.  dlls are just some sort of compiled exes. <br><br></td></tr></table><br>
<a name="1195398"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <b>...could know only those of the active dlls. </b> <br></div>I see. <br><br></td></tr></table><br>
<a name="1196254"></a>

<a name="1196255"></a>

<a name="1196256"></a>

<a name="1196257"></a>

<a name="1196258"></a>

<a name="1196260"></a>

<a name="1196261"></a>

<a name="1196263"></a>

<a name="1196264"></a>

<a name="1196265"></a>

<a name="1196266"></a>

<a name="1196325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I finally got this to work. <img src="http://i37.photobucket.com/albums/e73/VirtLands/emoticons/FaceBook%20Emoticons/pacman.png">  <br><br>(I only started to learn Pelles-C a few days ago...I'm a noob, (or newbie?) .)<br><br> Here's a simple DLL created in <b>Pelles C</b> that works in <b>Blitz3D</b>:<br><br> -- Pelles-C source Code for SampleDLL --<br> <a href="https://www.dropbox.com/s/90tvvcnw3t1ttuf/SampleDLL.zip" target="_blank">https://www.dropbox.com/s/90tvvcnw3t1ttuf/SampleDLL.zip</a>  <br><br> The DLL function is named <b>f1</b> ; all it does is add two numbers together.<br><br> <img src="http://imageshack.us/a/img14/5549/z1r7.jpg"><br><br> The Blitz3D usage is simple: { 7 = f1(3,4) }<br><br> <img src="http://uploadingit.com/file/pambrpkofbuvvlb1/0hej.jpg"><br><br> ----------------------------------------------------<br> You'll need to create some <b>DECLS</b> information, as follows:<br><br><b> .lib "SampleDLL.dll" </b><br><b> f1%(a%,b%) : "_f1@8" </b><br><br> (You can name it SampleDLL.DECLS if you wish.)<br> ----------------------------------------------------<br><br> If you want to download <b>Pelles C</b>, here is their link:<br> <a href="http://www.smorgasbordet.com/pellesc/" target="_blank">http://www.smorgasbordet.com/pellesc/</a><br> <br> Pelles-C apparently makes it easy to create DLLs.<br> I used the <u>New-Project-Win32 DLL Wizard</u> menu; That's likely the best way to do it.<br><br> Some bonus points on Pelles C that I like:<br> (<b>a</b>) There are apparently no license restrictions on sharing/distributing  DLLs  created in Pelles C. <br> (<b>b</b>) Pelles C supports Assembly language. <img src="http://i37.photobucket.com/albums/e73/VirtLands/emoticons/FaceBook%20Emoticons/squint.png"><br> ------------------------------------------------------<br> I also have <b>TinyC</b> installed.  <br> TinyC's assembly language syntax is something I'm not used to (called GNU assembler), so I won't touch that for now.  <img src="http://i37.photobucket.com/albums/e73/VirtLands/emoticons/Yahoo%20emoticons/28.gif"> <br><br></td></tr></table><br>
<a name="1339245"></a>

<a name="1339255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leafus</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi guys,<br><br>thanks for replying. I tend to be scatty and unfocused and I just came on here to download BlitzMax and was surprised to see I've left 7 or 9 posts at some points (most of which I am the thread creator of) and decided to investigate.<br><br>Don't worry there is nothing funny afoot here or expected elsewhere. I am just scatty. Just writing this to say thank yous.<br><br>I'm sorry to say I can't remember what I wanted it for. I'm not that clever and have had no success with programming ever and what's more I very rarely go anywhere near forums let alone post on them.<br><br>Thank you. :)<br><br>I hope at least that others may have benefitted from your contribution here.<br><br>I have benefitted from your kindness.<br><br>If anyone replies to this please expect none from me (certainly not for another inappropriate amount of time anyway). Thank you.<br><br>[edit 1/4hr later - further uselessy waffling] just the 3 threads infected, not so bad, 4 posts me replying on own thread. the other was a tantrum on blitz3dsdk owner headcount poll that this other thread of mine (a few years later!) addressed in a slightly (underlined) more composed fashion. But forums and I equals bad idea! Best wishes to you all (including Mark Sibley (sorry if misspelled) who did do his best to address the very problem I had, probably solved it, I guess others had that problem too). Like I say, I'm just not that clever nor should I be let loose on forums haha. Hopefully I'll remember that in the future. Where do I want to be 26 years from now Skidracer? Haha. Where is it that I am now exactly? I guess I don't know is the correct answer to both of those. ;op Good luck   - Leafus &lt;3 xx <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
