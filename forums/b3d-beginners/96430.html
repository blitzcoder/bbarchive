<!DOCTYPE html><html lang="en" ><head ><title >Force signed Bytes wuith Peek/Poke</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Force signed Bytes wuith Peek/Poke</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Force signed Bytes wuith Peek/Poke</a><br><br>
<a name="1115910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey folks, does anyone know a means of 'forcing' the use of 'Signed' bytes when using Peek/PokeByte commands?<br><br>The reason for asking is that I seem to getting some unexpected values when I Peek some results back, these results are typically 200+ and ought to be negative and smaller in magnitude than 50.<br>The only explanations I can think of for this occurrence, is that Peek does not result signed bytes, or that the memory I am accessing is already used. I've re-run the program a few times etc. restarted PC even so I doubt it's a  memory issue there. <br><br></td></tr></table><br>
<a name="1115913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> hrm... Sorry! never mind!<br><br>I really only need to worry about small magnitude values (Abs(n) &lt; 90 ) or so, which means that I can just add in a quick check:<br><br><pre class=code>
n=PeekByte(Bank)
If (n&gt;127) Then n=(n-255)
</pre><br><br>Yet again, I'm cursed by late-night-coder fatigue and missed the obvious! :D <br><br></td></tr></table><br>
<a name="1115915"></a>

<a name="1115917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The simple answer is that yes, bytes and shorts do not preserve sign. The upper three bytes of the value passed to PokeByte will be ignored.<br><br>The slightly longer answer is that there is no difference between signed and unsigned numbers, only the interpretation of them in certain special contexts. In "two's complement", the negative numbers are simply represented by the same bit patterns as the upper half of the unsigned range (which is why -1 has the bit pattern of the highest unsigned value).<br><br>Anyway, what this means is that if you want signed bytes, all you have to do is detect whether the byte value falls in the upper half of the "Byte" range, and if so, wrap it around. There are a couple of ways to do this:<br><br><pre class=code>If bVal &gt; 127 Then bVal = bVal - 256
...or...
If bVal And 128 Then bVal = bVal Or $FFFFFF00</pre><br><br>...etc.<br><br><b>EDIT:</b> eh, ninja'd. But note that you should subtract 256, not 255.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1116004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> :)<br><br>Thanks Yasha, and yeah, as soon as I first ran my code with the change I picked up on the error of using 255, byut thanks for noticing! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
