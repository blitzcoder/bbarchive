<!DOCTYPE html><html lang="en" ><head ><title >Making mouse-detectable zones</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Making mouse-detectable zones</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Making mouse-detectable zones</a><br><br>
<a name="552120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >XE800</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi. I'm trying to make a map editor for an isometric RPG, and need to know the most effecient way of having the mouse interact with the map fields.<br><br>Currently I use this:<br><br> If MouseDown(1)=True And MouseX()&gt;383 And MouseX()&lt;415 And MouseY()&gt;349 And MouseY()&lt;381 Then Bonx=0 : Bony=0 : AddTile()<br><br>The visible part of the map is 12x12 blocks, so I need to make 143 more lines in the same vein. Something tells me there's a more rational way of doing this? Any input appreciated.<br><br>XE <br><br></td></tr></table><br>
<a name="552122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why yes, there is:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=597" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=597</a> <br><br></td></tr></table><br>
<a name="552190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try Mappy. You can get it here I think.<br><br><a href="http://www.tilemap.co.uk/" target="_blank">http://www.tilemap.co.uk/</a><br><br>Look below in the mappy playback libraries.<br>There is ready to use code for blitz <br><br></td></tr></table><br>
<a name="552228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >XE800</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, both of you. "Zones.bb" made life a lot easier. I also realized I could save the actual zone data in a seperate file, so my source got really trimmed down.<br><br>Mappy doesn't like my gfx, it seems. Kept crashing me to desktop :/ The error msg seemed somewhat generic, so not sure what caused it. Probably need to check the docs. But doesn't really matter, I'm very happy with my own editor now that I halved the source :)<br><br>XE <br><br></td></tr></table><br>
<a name="552244"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your tiles are arranged in a grid and won't be moving around or changing shape along the X and Y axis, you should be able to determine which tile was clicked on by simply dividing by the size of the tiles (and acounting for the map offset).<br><pre class=code>; 2d example
const map_origin_x = 383, map_origin_y = 389
const map_tile_width = 32, map_tile_height = 32
;;;
tile_x = floor((mousex()-map_origin_x) / map_tile_width)
tile_y = floor((mousey()-map_origin_y) / map_tile_height)</pre><pre class=code>; 3d example
const map_origin_x = 0, map_origin_y = 0
const map_tile_width = 32, map_tile_height = 32
entitypickmode(map_entity, 2) ; 2=polygon
;;;
mouseover_entity = camerapick(global_camera, mousex(), mousey())
if mouseover_entity = map_entity then
	tile_x = floor((pickedx()-map_origin_x) / map_tile_width)
	tile_y = floor((pickedy()-map_origin_y) / map_tile_height)
endif</pre> <br><br></td></tr></table><br>
<a name="552254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >XE800</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I save the zone data like this:<br><br>Function SaveZones()<br> fo=WriteFile("Zones.dat")<br> For z=1 To 181<br>  WriteInt(fo,ZoneProperty(z,1))<br>  WriteInt(fo,ZoneProperty(z,2))<br>  WriteInt(fo,ZoneProperty(z,3))<br>  WriteInt(fo,ZoneProperty(z,4))<br> Next<br> CloseFile(fo)<br>End Function<br><br>But when using THIS to load:<br><br>Function LoadZones()<br> fi=ReadFile("Zones.dat")<br> For z=1 To 181<br>  ZoneProperty(z,1)=ReadInt(fi)<br>  ZoneProperty(z,1)=ReadInt(fi)<br>  ZoneProperty(z,1)=ReadInt(fi)<br>  ZoneProperty(z,1)=ReadInt(fi)<br> Next<br> CloseFile(fi)<br>End Function<br><br>... a Blitz alert-box shows up with the msg "  Expecting ')'   "<br><br>Why is this? I can't see any missing ')' anywhere :/ When removing the LoadZones function from the code, I get no alert. <br><br></td></tr></table><br>
<a name="552258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ZoneProperty() is a function, and as such, you cannot treat it as an lvalue (meaning you can't assign to it with "=").  I think you want to use the CreateZone() function when loading information from a file.<br><br>Out of curiousity, why can't an isometric tile-based RPG use the division solution I outlined above?  It would be a substantially simpler approach if it could be made to work for you. <br><br></td></tr></table><br>
<a name="552264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >XE800</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh yeah. First time I use a library, so I totally forgot that in Zones.bb it is a function. I treated it as a normal array. <br><br>I changed the names in the LoadZones function to ZoneProperty1(z), ZoneProperty2(z) etc. and now the values are loaded without problem. <br><br>But since it seems saving ZoneProperty(z,x) worked well, I will leave that one as it is. <br><br>Thx for your help! <br><br></td></tr></table><br>
<a name="552282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >XE800</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Out of curiousity, why can't an isometric tile-based RPG use the division solution I outlined above? It would be a substantially simpler approach if it could be made to work for you"<br><br>I tried it, but I guess it doesn't work well in a diamond shaped map. Instead of reading from the top and to the left, it read from the top and straight down. What was originally 1,1 became 0,0 and what was 2,2 became 0,1 :) And if I moved pointer to the left, I would soon get negatives. <br><br>I will investigate it further tomorrow though, as it would be great to get something like this working.<br><br>XE <br><br></td></tr></table><br>
<a name="552296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> It'll work, you just need slightly more complicated math.  I'm using the same approach with the hexagon tiles in my game.<br><br>For a diamond-shaped map, you'll need to take into account both the X and Y position of the mouse when determining each of tile_x and tile_y.  Something like this should work for you:<br><pre class=code>Const map_tile_offset_x = 32, map_tile_offset_y = 16
x_off# = MouseX() - map_origin_x
y_off# = MouseY() - map_origin_y
tile_x = Floor(x_off/map_tile_offset_x + y_off/map_tile_offset_y)
tile_y = Floor(y_off/map_tile_offset_y - x_off/map_tile_offset_x)</pre>You'll also need to add 1 to both tile coordinates if your map originates at (1,1) instead of (0,0). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
