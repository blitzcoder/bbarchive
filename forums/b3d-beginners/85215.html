<!DOCTYPE html><html lang="en" ><head ><title >Obtain the OS name?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Obtain the OS name?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Obtain the OS name?</a><br><br>
<a name="963613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any means to acquire the name of the OS that a B3D app is run on?<br><br>Alternatively, does Vista have a "winver.exe" file?<br>What about Windows 7 or perhaps, non-Microsoft OS... ? <br><br></td></tr></table><br>
<a name="963635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> non-Microsoft OS... <br></div><br>Blitz3D and BlitzPlus are Windows-only. <br><br></td></tr></table><br>
<a name="963637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> That helps some, so what values does GetEnv$("OS") reyturn by default on Vista or Windows 7? Anyone know? <br><br></td></tr></table><br>
<a name="963644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> On Windows 7 it returns Windows_NT like Windows XP, so I think Windows Vista will do the same.<br><br>I remember something being posted in the code archives that will do what you are asking, but it was BlitzMax code. It should be portable to B3D. <br><br></td></tr></table><br>
<a name="963646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe this archive entry can do that?<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=922" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=922</a> <br><br></td></tr></table><br>
<a name="963667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows NT, 2000, XP, Vista and 7 will all return Windows_NT as the OS.<br>You can tell them apart base don the version number:<br><br>NT = 4.0<br>2000 = 5.0<br>XP = 5.1<br>Vista = 6.0<br>Windows 7 = 6.1 (Gotta love that one -- It does show that MS considers it to be an incremental Vista update, not an new product line)<br><br>There's some windows API's that will return the actual version number. <br><br></td></tr></table><br>
<a name="963703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barnabius</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Windows 7 = 6.1 (Gotta love that one -- It does show that MS considers it to be an incremental Vista update, not an new product line) <br></div><br><br>Actually, the reason is completely different and it has to do with the silly programs written by everyone else, which check only for the numbers they know about. Some of them even check the first digit only. Therefore a decision was made to have Windows 7 respond with 6.1. A far more plausible reason than the Vista update...<br><br>Barney <br><br></td></tr></table><br>
<a name="963718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Still, calling version 6.1 "version 7" seems ambiguous at best. <br><br></td></tr></table><br>
<a name="963757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Barnabius, that makes as much sense as the internal name for the XP Start Bar being Program Manager.<br><br>Your explanation sounds like an MS 'whoops, found out' explanation.<br><br>No programmer would only get the first digit of an OS version. <br><br></td></tr></table><br>
<a name="963803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Exceellent stuff, Thanks a lot folks. Seems I have something. Warner's link was really handy and I don't even need to be fluent in Deutsch :D<br><br>It correctly returns Windows XP for me.<br><br>So going by the info from Ked and Xlsior: <br><div class="quote"> <br>NT = 4.0<br>2000 = 5.0<br>XP = 5.1<br>Vista = 6.0<br>Windows 7 = 6.1<br> <br></div><br><br>The following (Ive altered the code archives stuff a little to include (hopefully) Windows Vista and Win7...<br><br>Would anyone mind testing this for me? You will need the "decls" in your userlibs folder:<br><pre class=code>
.lib "kernel32.dll"
api_GetVersionEx% (lpVersionInformation*) : "GetVersionExA"
api_RtlMoveMemory(Destination*,Source,Length) : "RtlMoveMemory"

.lib "comdlg32.dll"
api_GetOpenFileName% (pOpenfilename*) : "GetOpenFileNameA"
api_GetSaveFileName% (pOpenfilename*) : "GetSaveFileNameA"
</pre><br><br>I'm particularly interested now, having noticed, whether the "Platform" Identification makes any difference if the OS is 64-bit. Any results people can post will be really helpful, thanks :D<br><br>And here's the bb test:<br><br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=922#comments" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=922#comments</a> <br><br></td></tr></table><br>
<a name="963887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows Vista 32-bit seems to be returned correctly <br><br></td></tr></table><br>
<a name="964046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone with Windows 7, please?<br><br>There's really not much involved, jsut a tiny .decls  file and the BB code. <br><br></td></tr></table><br>
<a name="969479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nawi</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Blitz3D and BlitzPlus are Windows-only.  <br></div><br>Not really, wine can run Blitz3D/+ apps quite well. I think wine returns Windows-something depending on the config though. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
