<!DOCTYPE html><html lang="en" ><head ><title >Flip screen woes</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Flip screen woes</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Flip screen woes</a><br><br>
<a name="561155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Roe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello,<br><br>I've got a problem with my screen update. I had a few sprites moving around in a windowed 1024, 768 environment and everything was going well. In the code, I clear the screen, tell the code to draw the sprites in their respective places in the backbuffer and then I flip the screen; so far, so what, but when I took my code into work to test it on another machine, the frame rate looked really low and laggy. However my framerate display shows it's running at a consistent 75 frames per seocnd; the same as back home. <br><br>Now we use two monitors in work; back home I have recently installed a second monitor and guess what? The lag has started to appear here too.<br><br>Something wierd is going on with the screen refresh, it seems to be out of sync with my game. Could it be related to the dual monitor setup? Even if I turn the monitor off it still lags. If it is a monitor problem, how can I sync up the refresh to the game so that it runs fine?<br><br>I'm quite new to coding, but if I take out the 'Flip' function from my code, shouldn't this stop anything appearing in the window? Because when I take it out, the game still shows the sprites on the screen, but they flash on badly and tear down the screen as if they were being drawn straight onto the screen and not the backbuffer; is that right? I've set it up so that the back buffer is the buffer used, but it looks like something is overriding when the buffer gets drawn to the screen,<br><br>Sorry for the mumbling, I'll try and explain better if you need me to. Any ideas?<br><br>Cheers <br><br></td></tr></table><br>
<a name="561180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> We really need to see some code.<br><br>How are you using Flip? Are you locking it to the monitor refresh rate (i.e. Flip True)? Try using 'VWait : Flip False' instead.<br><br>Just guessing here. Like I say, we need the codez. :) <br><br></td></tr></table><br>
<a name="561396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Roe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is my main loop<br><br>Include "globals.bb"<br>Include "leveldata.bb"<br>Include "Movement.bb"<br>Include "graphics.bb"<br>Include "debug.bb"<br>Include "render.bb"<br>Include "framespeed.bb"<br><br>;---------------------------------------------------------------------<br>;---------------------------MAIN LOOP---------------------------------<br>;---------------------------------------------------------------------<br><br>While Not KeyHit(1)<br><br>framespeed() ;checks the frames per second (only for debug display, it doesn't limit or lock it)<br><br>keycheck() ;this is for playermovement<br><br>render() ; draws everything to the screen<br><br>updateplayerongrid() ;updates the array<br><br>Wend<br><br>End<br><br>;--------------------------------------------------------------------<br><br><br><br>This is the render loop:<br><br>Cls ; clear the screen<br>	<br>	DrawImage (ibckgrnd, centerx+gridsize, centery+gridsize); draws the background <br>	<br>	debug() ; adds any debug text displays<br>	<br>		For b = 1 To 15		; main render loop for drawing all the sprites<br>			For a = 1 To 15<br>			<br>			x = centerx+a*gridsize-(gridsize)<br>			y = centery+b*gridsize-(gridsize)<br>			<br>			;Text centerx+a*gridsize, centery+b*gridsize, ""+grid(a,b,1)<br>			If grid(a,b,1) = 1 Then DrawImage (iblock, x, y)<br>			If grid(a,b,1) = 2 Then DrawImage (dblock, (a*gridsize)+centerx-gridsize, (b*gridsize)+centery-gridsize)<br>			Next<br>			<br>		Next<br><br>DrawImage (iplayer, player1\X, player1\Y) ; and lastly the player!<br><br><br><br>Flip ; update the screen<br><br><br><br>The debug functionis just drawing some text:<br><br>Function debug()<br><br>Text 20, 50, grid((player1\gridx - 1), (player1\gridy-1),1)+" "+grid((player1\gridx), (player1\gridy-1),1)+" "+grid((player1\gridx + 1), (player1\gridy-1),1) ;debug<br>Text 20, 65, grid((player1\gridx - 1), (player1\gridy),1)+" "+grid((player1\gridx), (player1\gridy),1)+" "+grid((player1\gridx + 1), (player1\gridy),1);debug<br>Text 20, 80, grid((player1\gridx - 1), (player1\gridy+1),1)+" "+grid((player1\gridx), (player1\gridy+1),1)+" "+grid((player1\gridx + 1), (player1\gridy+1),1) ;debug	<br><br>Text 0, 5, player1\gridxvalue+ " gridxvalue   "+(player1\gridxvalue - spriteoffset)+" spriteoffset   "+player1\x+ " "+fps+" fps "<br><br>End function <br><br></td></tr></table><br>
<a name="561537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Roe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've tried the same code in BlitzPlus and it works fine. It's only a problem in Blitz3D. Furthermore, the Flip command does indeed prohibit the drawing of anything to the screen when it's commented out but in Blitz3D the screen still get's refreshed.<br><br>Any ideas? <br><br></td></tr></table><br>
<a name="561606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That is weird. Indeed, nothing should be displayed until Flip is executed. From what you've said, I think it must be something to do with your dual screen setup - maybe a setting in your driver? I've never used a dual screen setup so can't really say. If you can't get it sorted, post in the bug report forum. <br><br></td></tr></table><br>
<a name="561632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Roe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Big, I think I will submit a bug report. I tried running the game in fullscreen mode and it runs smoothly then, but the top of the screen flickers a little bit. Definately not right :(<br><br>Cheers <br><br></td></tr></table><br>
<a name="561645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds to me like you forgot to set the buffer:<br><br>Graphics3d 1024,768,32,2<br>setbuffer backbuffer() ; &lt;&lt;&lt;&lt;&lt;&lt;&lt; <br><br></td></tr></table><br>
<a name="561654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are seeing stuff as soon as it is drawn, then it is drawing to the frontbuffer.  What jfk said should help, but in the case of double buffering not being supported for some reason, you...  may just have to work around it.  I know windowed mode doesn't support double buffering, but I still thought it didn't show the buffer until you used Flip...  but...  that could just be because the drawing commands are so damn fast... <br><br></td></tr></table><br>
<a name="561826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Roe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, the Backbuffer is being set, I have it setup at the start.<br><br>As I said, this only became an issue when I installed nView Dual Monitor Support. <br><br></td></tr></table><br>
<a name="562363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You should see what happens when you try to use 3d glasss ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
