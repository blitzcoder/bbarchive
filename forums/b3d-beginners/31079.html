<!DOCTYPE html><html lang="en" ><head ><title >Gravity on round object ';..;'</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Gravity on round object ';..;'</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Gravity on round object ';..;'</a><br><br>
<a name="331466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FunTex</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having some problems with my gravity code, I've made a planet and i want a object to fall to the planet surface, not just down. I was almost succesful, but when a object moves near a pole of the planet, the screen starts to rotate, please give some help and sudgestions.<br><br>Best regards, Thomas <br><br></td></tr></table><br>
<a name="331469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 2D or 3D?<br><br>[edit]<br>sounds like 3D... also sound like you're detailing with the camera trying to keep itself upright.<br><br>You need to attach the camera to a pivot, rotate one axis with the camera and the other from the pivot. <br><br></td></tr></table><br>
<a name="331470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>when a object moves near a pole of the planet, the screen starts to rotate,<br> <br></div><br><br>Please could you be a bit more specific? Or maybe even post some code. As Rob says, 2D or 3D first, and how have you made this planet? <br><br></td></tr></table><br>
<a name="333665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Avrigus</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I assume Thomas means he's made a 3D sphere (the planet) and wants his object to be attacted to the center of the sphere no matter where it is on the surface, like a giant walking around a small moon. Much like the games Populous 3 or the mini game in the latest Ratchet and Clank game.<br><br>I too would like to get some tips on how this could be done   :-) <br><br></td></tr></table><br>
<a name="333676"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suppose you could point the entity at the planet and then just move the entity forwards, that would make it fall toward the centre of the planet all the time. <br><br></td></tr></table><br>
<a name="333735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> For the sake of simplicity, you can assume the center of mass is at the center of an object.<br><br>Oxyz  = Object center of mass <br>Pxyz  = Planet center of mass <br>Gvxyz = Gravity vector<br>Gdxyz = Gravity direction<br>Gm    = Gravity magnitude<br><br>; Units per meter.<br>; The number of units in a meter in your game.<br>; I like a distance of 1 to equal a meter, but in a space game that would be far too large a number to use for one meter.<br>UnitsPerMeter# = 1.0<br><br>; Set gravity to 9.8 meters per second squared.<br>Gravity# = 9.8<br><br>; Set this to the number of seconds which has passed since the last frame.  This number is most likely to be less than 1.  If you are running at a constant 60 frames per second, 1.0 / 60.0 = 0.0166 seconds per frame.  You will want to calcualte this each frame probably if the frame times are different.  <br>Time_Delta_Sec# = 0.166<br><br>; Calculate vector from object to planet.<br>Gvx# = Px# - Ox#<br>Gvy# = Py# - Oy#<br>Gvz# = Pz# - Oz#<br><br>; Calculate legth of vector.<br>; This is the distance between object and planet.<br>; The m stands for magnitude. <br>; A vecotr has a direction, and a magnitude.  The magnitude is the length of the vector.  <br>Gm# = Sqr(Gvx#*Gvx# + Gvy#*Gvy# + Gvz#*Gvz#)<br><br>; Divide vector by length of vector, to make it a normal.<br>; A normal is a vector with a length of 1. <br>; This is the DIRECTION in which gravity is pulling.  It is also the gravity's "normal" or "normal direction".<br>Gdx# = Gvx# / Gm#<br>Gdy# = Gvy# / Gm#<br>Gdz# = Gvz# / Gm#<br><br><br>;Now you have a normal indicating in which DIRECTION gravity<br>;is pulling. <br><br>;Now you just need to calculate how much gravity is pulling<br>;on your object.<br><br>; Calculate how much velocity to add this frame.<br>; Ie, 9.8 meters per second, * 10 units per meter = 98.0 units per second.  Then multiply by the number of seconds which have passed this frame, which we will say is 0.01, which would be 100 frames per second, and the result would be that we should move the object 0.98 units this frame.<br><br>Gm# = (Gravity# * UnitsPerMeter#) * Time_Delta_Sec#<br><br>; Multiply this velocity by the how much the gravity is pulling in each direction, and add the resulting velocity vector to your object's veloicity vector.<br><br>Ovx# = Ovx# + Gdx#*Gm#<br>Ovy# = Ovy# + Gdy#*Gm#<br>Ovz# = Ovz# + Gdz#*Gm#<br><br>; Finally, move your object according to it's velocity, and how many seconds the last frame took to render.<br><br>Ox# = Ox# + Ovx#*Time_Delta_Sec#<br>Oy# = Oy# + Ovy#*Time_Delta_Sec#<br>Oz# = Oz# + Ovz#*Time_Delta_Sec#<br><br>; Make sure you store Oxyz and Ovxyz with your object... you must retain it from one frame to the next! <br><br></td></tr></table><br>
<a name="333752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neo Genesis10</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simplicity... love it. Okay, I hit just this snag at one time and here's how I got around the problem (this assumes you're using Blitz 3D).<br><br>1) Create a pivot which is the PARENT of the object you are applying gravity to.<br>2) Then in each loop:<br>3) De-parent the object.<br>4) Point the pivot at the target sphere./<br>5) Re-parent the object.<br>6) Move the pivot by gravity speed.<br><br>Heres some code in action:<pre class=code>Graphics3D 640, 480
SetBuffer BackBuffer()

Global pivot = CreatePivot()
Global cube = CreateCube(pivot)
Global world = CreateSphere(16)
Global cam = CreateCamera()

Global gravity# = 0.01

Repeat
	EntityParent pivot, 0
	If KeyDown(200) MoveEntity cube, 0, 0, .01
	If KeyDown(208) MoveEntity cube, 0, 0, -0.01

	
	; The following simulates thrusters for moving away from the surface
	; NOTE: this is an example. Fiddling with gravity is not recommended :)
	If KeyDown(57)
		gravity# = -0.01
	Else
		gravity# = 0.01
	EndIf

	; Position the entity at our cubes exact position
	PositionEntity pivot, EntityX#(cube,1), EntityY#(cube,1), EntityZ#(cube,1)

	; Point the pivot at the planet
	PointEntity pivot, world

	; Re-parent the cube
	Entityparent cube, pivot

	; Move the objects
	MoveEntity pivot, 0, 0, gravity#

Until Keyhit(1)</pre>This is similar to Shamblers suggestion, but it allows you to retain the current rotation of your object. <br><br></td></tr></table><br>
<a name="333753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> My way's the "right" way and in the long run you'll be far better off knowing how to do things with vectors. :-) <br><br></td></tr></table><br>
<a name="333754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> This simpler method will work if you don't want variable framerates, and you can live without gravity making an object fall faster and faster.<br><br><br>; Distance to move object each frame towards planet.<br>Gravity# = 10.0<br><br>Ox# = EntityX#(Ship)<br>Oy# = EntityY#(Ship)<br>Oz# = EntityZ#(Ship)<br><br>Px# = EntityX#(Planet)<br>Py# = EntityY#(Planet)<br>Pz# = EntityZ#(Planet)<br><br>; Calculate vector from object to planet.<br>Gvx# = Px# - Ox#<br>Gvy# = Py# - Oy#<br>Gvz# = Pz# - Oz#<br><br>; Shorten vector until it's one unit long.<br>Gm# = Sqr(Gvx#*Gvx# + Gvy#*Gvy# + Gvz#*Gvz#)<br>Gdx# = Gvx# / Gm#<br>Gdy# = Gvy# / Gm#<br>Gdz# = Gvz# / Gm#<br><br>; Move object towards planet.<br>Ox# = Ox# + Gdx#*Gravity#<br>Oy# = Oy# + Gdy#*Gravity#<br>Oz# = Oz# + Gdz#*Gravity#<br><br>PositionEntity Ship, Ox#, Oy#, Oz# <br><br></td></tr></table><br>
<a name="333761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neo Genesis10</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I still prefer simplicity. Besides, its all very well having a piece of code but its pretty useless unless you know what its actually doing. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
