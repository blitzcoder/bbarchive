<!DOCTYPE html><html lang="en" ><head ><title >End one program and start another</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >End one program and start another</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >End one program and start another</a><br><br>
<a name="989675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IcyDefiance</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, my programming experience from other languages is starting to kick in with this one, and I'm starting on a few more complicated things.  I'm in the middle of programming an automatic updater for that FPS I'm working on, and I have a simple problem that's making it hard for me to update the main executable.<br><br>For reasons that will take too long to go through in this post, I need to be able to end one program (usually accomplished by just using the End command) and start another (usually accomplished with the ExecFile() command).  The problem is that ExecFile() pauses the program until the file that is executed ends, so if I put ExecFile() then End, the program doesn't close until the other one does.  If I put End first, then it never gets to the ExecFile() command.<br><br>The best solution I have so far is to make the update manager a separate file from the main executable so I don't have to restart the main exe when it's updated.  I can clear the graphics mode and all variables to save the RAM and the average user would never know the difference.  But the program would still be dormant in the background, which would simply be annoying, and what happens when I want to update the update manager?  I would have to just end the program and have the user restart it manually.  Again, not a huge deal, but it's certainly an annoyance.<br><br>I'm willing to use a DLL or something if I need it, but there really should be a simple solution that I haven't seen yet. <br><br></td></tr></table><br>
<a name="989737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amanda Dearheart</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't understand much of Blitz3d commands, but many languages have a system that can handle Window Messages.  In the days of DOS, we called them Dos Interrupts or TSR (Terminate and stay Resident) programs.  What you can do is place a function in a code block that checks to see if the execfile statement was executed, and if so end the program, like this piece of pseudocode<br><br>Begin Window Message<br><br>     void   function  that handles Execfile check<br><br>end  Window Message<br><br><br>function  that handles Execfile check<br><br>    if  (execfile == 0 )<br>          end<br>end function<br><br>Its just an idea.  I don't even know if Blitz3d has a system that supports just such a command.  Perhaps you might be able to acheive just such an result through the .dll as you have said! <br><br></td></tr></table><br>
<a name="989741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ExecFile() pauses the program until the file that is executed ends <br></div><br><br>Intriguing. Have you tested this thoroughly? Because on my system, it seems to fire-and-forget, and the parent program ends as expected.<br><br>In any case, Mikhail's FastLibs (www.fastlibs.com) do include an explicit ExecOnEnd (not sure if that's the exact name) function. Although this might not be in the free one. <br><br></td></tr></table><br>
<a name="989754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes execfile will halt your program, use this api call<br><br>Decls<br><pre class=code>

.lib "Shell32.dll"

ShellExecuteA(hwnd%,op$,file$,params$,dir$,showcmd%)
</pre><br><br>when your game is ready to launch another exe and end you call it like this<br><br>; at the top of your program you have to record the window handle<br><pre class=code>
Global hwnd%=SystemProperty("apphwnd")
</pre><br><br>;later when you are executing another program just call<br><pre class=code>
ShellExecuteA(hwnd%,"open","whatever.Exe","","",1)
</pre><br><br>edit : the last parameter indicates how the new window will behave. 1 and 9 bring it to top and max size, 0 hides it.. even from the process window. 2-8 do stuff too but I forgot what. <br><br></td></tr></table><br>
<a name="989826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IcyDefiance</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Amanda: Something like that would probably work, but like I said, the ExecFile() command pauses the entire program.  My code looks like this:<br><br><pre class=code>ExecFile("fps.exe")
End</pre><br><br>It executes the file, but doesn't end.<br><br>@Yasha: Very strange...  Yeah, I've tested this thoroughly, and it does it every time.  I can't even start to offer an explanation for that.  And I looked up that FastLibs thing, but I really don't want to use another block of another person's code if I don't have to.  Keeping track of 3 different licenses and trying to stay within their boundaries is tough enough, I don't even want to look at another one.  I would use it if I had to, but RifRaf had a better idea.<br><br>@RifRaf: Thank you so much, that works perfectly.  I'll have to figure out what all those numbers do, maybe I could use them to have a bit more fun, but that'll come later.  Anyway, now my update manager works just about perfectly, and I'll be posting a download link on my worklog sometime soon.  I just have to do a little more bugtesting with it first... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
