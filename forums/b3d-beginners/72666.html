<!DOCTYPE html><html lang="en" ><head ><title >doors</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >doors</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >doors</a><br><br>
<a name="812025"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm stuck at the most boring part of a game engine: doors.  How exciting!!  Anyways:<br><br>I need to have a door system (with an infinite amount of possible doors) with which using a function:<br><br><pre class=code>
Function createdoor(x, y, z, mesh, texture, radius)
;-----???
End Function
</pre><br><br>these doors are automatic sliding doors with a given radius in XZ distance (I've got an "algorithm" for finding that) where if the player gets close enough in xz, then it slides up (using an updatedoors() function called in every game loop).  <br><br>I tried using types but got stumped when it comes to making a type into an in-game mesh.  It must be a type so that I can use <br><br><pre class=code>For door.doors = each door ... Next</pre><br><br>Making it possible to run through and update each door, dispite whether there are 2 or 463,345,950 doors.<br><br>Thanks for any help you can give! <br><br></td></tr></table><br>
<a name="812058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yo! Wazzup?</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/codearcs.php?code=1880" target="_blank">It's a pretty good door thingie, with 4 different kinds of doors.</a><br><br><br><br>You either want the movement or movement and rotation? <br><br></td></tr></table><br>
<a name="812094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> movement, like sliding doors <br><br></td></tr></table><br>
<a name="812356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm...I may be able to use that...but I think if somebody could just answer how I can use types as meshes, I could make a more efficient one myself. <br><br></td></tr></table><br>
<a name="812363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> couldent you just make type 'door' with mesh and x,y,z fields:<br><pre class=code>
type door
 field mesh
 field x,y,z
 field etc
end type
</pre><br>and then just make the doors<br><pre class=code>
Function createdoor(x, y, z, mesh, texture, radius)
 door.door=new door
 door\mesh=copyentity(mesh)
 entitytexture door\mesh,texture
 scaleentity door\mesh,radius,radius,radius ;(if this is   what you mean to use radius for)
 positionentity door\mesh,x,y,z
End Function
</pre><br>you cant make an unlimitid amout, it would just get too slow eventually, but it should work<br><br>...or am I just TOTALLY missing your point... <br><br></td></tr></table><br>
<a name="812378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> OH!!! copyentity! thanks!<br><br>EDIT:  Also, I meant with the radius, how close in xz distance you have to get, before the door slides up (automatic sliding doors) <br><br></td></tr></table><br>
<a name="812385"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> glad to help <br><br></td></tr></table><br>
<a name="812389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> This appeared recently in the code archives (well, it got bumped) - I've not even looked at it:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1970#comments" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1970#comments</a> <br><br></td></tr></table><br>
<a name="812506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll use Jsoren's method, but in the "Updatedoors()" function, I'll hide any doors that are n far away (or out of view?).  That oughta speed it up? <br><br></td></tr></table><br>
<a name="812510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK: I'm having a few bugs, this won't work, I get runtime error: entity does not exhist on the Copyentity line.  Here's the code<br><br><pre class=code>
Function CreateDoor(door_x, door_y, door_z, door_mesh, door_tex)

	door.doors = New doors
	Local d_m  = LoadMesh(door_mesh)
	door\doormesh = CopyEntity(d_m)
	If door_tex &lt;&gt; "" Then 
	Local d_t = LoadTexture(door_tex)
	EntityTexture door\doormesh, d_t
	EndIf 
	door\doorx = door_x
	door\doory = door_y
	door\doorz = door_z
	PositionEntity door\doormesh, door\doorx, door\doory, door\doorz
	
	;FreeTexture d_t
	;FreeEntity d_m


End Function 
</pre> <br><br></td></tr></table><br>
<a name="812513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, has door_mesh been declared as a string?<br>and is door_mesh a valid path to a mesh when you call the createdoor(x,y,z,mesh,tex) function?<br>thats all I can think of atm. <br><br></td></tr></table><br>
<a name="812514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> heh, forgot about the string thing, thanks... <br><br></td></tr></table><br>
<a name="812528"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> ah well, nothing is ever too easy, I've got another bug with the distance in x and z registerring:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function CreateDoor(door_x#, door_y#, door_z#, door_mesh$, door_tex$)

	door.doors = New doors
	Local d_m  = LoadMesh(door_mesh)
	door\doormesh = CopyEntity(d_m)
	If door_tex &lt;&gt; "" Then 
	Local d_t = LoadTexture(door_tex)
	EntityTexture door\doormesh, d_t
	EndIf 
	door\doorx = door_x
	door\doory = door_y
	door\doorz = door_z
	PositionEntity door\doormesh, door\doorx, door\doory, door\doorz

	
	FreeTexture d_t
	FreeEntity d_m


End Function 

Function distxz(entity1, entity2)
distx# = EntityX(entity1) - EntityX(entity2)
distz# = EntityZ(entity1) - EntityZ(entity2)
distxz# = Sqr(x*x + z*z)
Return distxz#



End Function 

Function updatedoors()

For door.doors = Each doors

If EntityInView (door\doormesh, cam) And EntityVisible (door\doormesh, cam) Then


If distxz(door\doormesh, man) &lt; 5 Then

EndIf 
Text 10, 860, "distance between man and door = " + distxz(door\doormesh, man)
EndIf 

Next

End Function 
</textarea><br><br>when i run it in my program with a door in-game, the text saying what xz distance is will ALWAYS be zero, whether or not the the man is placed at 0, 0, 0 and the door at 10000, 0, 10000.  The rest of the code is functioning, if the door goes out of view, it won't draw the text (meaning the in-view thing is working).<br><br>Any ideas? <br><br></td></tr></table><br>
<a name="812533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, as far as I can tell your problem is here:<br><pre class=code>
distxz# = Sqr(x*x + z*z)
</pre><br>you havent used the 'x' and 'y' variables anywhere else that i can see, so it seems that it should read<br><pre class=code>
distxz# = Sqr(distx*distx + distz*distz)
</pre> <br><br></td></tr></table><br>
<a name="812534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> dang!! those typos!! lol I need more sleep, thanks!<br><br>by the way, If i'm reading the xz code correctly...is that pythagora's theorum?? <br><br></td></tr></table><br>
<a name="812535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol, I was just about to say, these are exactaly the kinda mistakes I make when Ive been up too long working on something too boring ;P <br><br></td></tr></table><br>
<a name="812536"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> definately the boring-ness, I'm doing my combat engine next ( i hope) though, so uber-exciting!  I just noticed, the ^ carrot works in blitz...that saves some time...<br><br>It's funny, whenever I post a question here, I check on the thread every 5-10 minutes to see if there's been a response, and whenever I find that somebody has responded, It's usually just happened 10 seconds ago. <br><br></td></tr></table><br>
<a name="812538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> it works!  thanks! <br><br></td></tr></table><br>
<a name="812550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, small ditto: how do I add sound?  Each door must be able to have its own individual sound <br><br></td></tr></table><br>
<a name="812562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> do you mean each door needs to have a different sound or all the same?<br>if their all the same just loadsound() in the beginning of your program and play it everytime you open/close the door, all the commands are in the b3d command ref. <br><br></td></tr></table><br>
<a name="812567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> hehe, I said <b>"EACH DOOR MUST BE ABLE TO HAVE ITS OWN INDIVIDUAL SOUND"</b> :)  which answers your question <br><br></td></tr></table><br>
<a name="812582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah but if you have 100-1000+ doors....thats alot of sounds <br><br></td></tr></table><br>
<a name="812590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know...I'll just load a global set of door sounds and call them according to the sound # assigned to each door as a field. thanks! <br><br></td></tr></table><br>
<a name="812604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK!! sound works!  It's funny, cause I'm using a dummy mesh of a person as a door ATM, it's hilarious to hear door sounds when watching a person slide up.  <br><br>However, there is one more small problem that needs fixing.  using entityinview and entityvisible don't quite work with what I need.  I use if entityinview and visible then do the updatedoors on that door (saving speed and memory).  However, many times will a person walk through a door, but be moving fast enough to have the door out of view before it can finish opening and closing, so many times will a door just be hanging there, and when a person looks back at the door, finally, the door closes with the sound...  ditto! <br><br>What commands/methods could I use to say, If a 3d line is drawn between the camera and the door without colliding into any other objects, then do the doorupdates for that door.  If this is possible, it should mainly fix the bug. <br><br></td></tr></table><br>
<a name="812610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jsoren</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> well, im not sure why your not using just entitydistance, using entitydistance along with entityvisable and entityinview shoudl be the same as using a 3d line. otherwise you can either use timers, or you can use a true\false value to decide whether the door is finished opening\closing or not. <br><br></td></tr></table><br>
<a name="812611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> k thanks, I'll use distance with it, forgot about that :)<br><br>OK it works, I used :<br><br><pre class=code>
If EntityInView (door\doormesh, cam) And EntityVisible (door\doormesh, cam) Or distxz (door\doormesh, cam) &lt; door\doorradius*3 Then

</pre><br><br>in case you're interested <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
