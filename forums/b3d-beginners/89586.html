<!DOCTYPE html><html lang="en" ><head ><title >align a quad to camera</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >align a quad to camera</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >align a quad to camera</a><br><br>
<a name="1017597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> im trying to align a quad thats part of a mesh to the camera, i dont want to turn the entity just a quad<br><br><br>; i need understand/figure out how to make x#,y#,z# = camera view, i got this out of the code archives ive picked it to pieces so i can get the quad i want, but aligning it is proving a pain <br><br>the stuff in the archives is not very well documented for novices<br><br>x#=VertexX(s,i+0)+1 : y#=VertexY(s,i+0)+1 : z#=VertexZ(s,i+0)+1<br>	<br>	VertexCoords s,i+0,x#,y#,z#<br>	VertexCoords s,i+1,x#,y#,z#<br>	VertexCoords s,i+2,x#,y#,z#<br>	VertexCoords s,i+3,x#,y#,z#<br>	;<br><br><br>any help/ideas or point me in the right direction<br><br>thanks <br><br></td></tr></table><br>
<a name="1017654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What i would do, is get the height and width of the quad (By getting the distances between the vetices. Now, take any vertex, and tform the co-ords of the vertices in the cameras space, using the distances. I'm struggling to explain this any better i'm afraid. I will knock up a code smaple when i get home. My computer is running in safe mode, as it's completely buggered and still haven't got the cash for a new one :'( I have no sound!! <br><br></td></tr></table><br>
<a name="1017657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks ross<br>evertime i googled this your posts came up form years ago ,lol<br><br>cashless i know that feeling :(<br><br>dont laugh ;)<br>but this is where im upto<br><br><a href="http://homepage.ntlworld.com/david.howe50/zips/Quads.zip" target="_blank">......--&gt;...zip file Clicky....&lt;--.....</a> <br><br></td></tr></table><br>
<a name="1017675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Np's, i'll have a look when i get home (about 5 ish) <br><br></td></tr></table><br>
<a name="1017883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, i've had a look. Are you just creating this one quad? If so, aren't you easier using a sprite? The .3ds file only contains one quad :)<br><br>If you have a model, and it has a quad in there already, you'll need to know the vertex index of each of the 4 vertices.<br><br>Can you expand upon what y9our trying to achieve? <br><br></td></tr></table><br>
<a name="1017902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> no theres a plane with quads on, in the zip<br><br>press "w" for wireframe<br><br>a big plane and one selected quad attached to the mouse<br><br>its going to be part of an explosion entity/animation<br>i just need to align the quads to the camera, i suppose its the same principle as aligning sprites to the camera<br><br>ive manged to pick apart the code from archives that selects the quad<br>i just can not for life of me figure out how to align it<br><br><br><br><br><br>thanks for taking look man ;) <br><br></td></tr></table><br>
<a name="1017934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nps, how can you isolate the quad though? <br><br></td></tr></table><br>
<a name="1017936"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> its this bit<br><br>try changing "mainquad = 8"<br><br> ;quad index multiples of 4 ie: 0,4,8,16,32....up to last quad 252<br> ; postions bottom right--&gt; 0, 4 , 8 , 12, 16 , 20 ---&gt; 252 top left<br><br>Function PositionQuad(s%,i%,x#,y#,z#=0.0) ; at mouse x,y<br>	Local dx#,dy#,dz# , o%<br>	dx=x-VertexX(s,i)<br>	dy=y-VertexY(s,i)<br>	dz=z-VertexZ(s,i)<br>	For o=0 To 3<br>		VertexCoords s,i+o,VertexX(s,i+o)+dx,VertexY(s,i+o)+dy,VertexZ(s,i+o)+dz<br>	Next<br>End Function<br><br><br>i dont realy understand what the its doing, but im fighting my way thru it ;) <br><br></td></tr></table><br>
<a name="1017937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, if the quad isn't rotated on any other axis, other than the Y axis, this should be verrrrrrrry simple. Can you clarify that? <br><br></td></tr></table><br>
<a name="1017941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> no its all , player could be left/right or going under or over it, i have a feeling that  makes it very hard <br><br>damn impossible for me man, i gota change hobbies ;) <br><br></td></tr></table><br>
<a name="1018498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> this is doing head in<br><br>nearest thing i can find in the archives, it picks quads , but no align to camera<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;
Graphics3D 640,480,0,2

cam = CreateCamera()
MoveEntity cam,0,0,-6

lit = CreateLight()
TurnEntity lit,30,45,0

ball = CreateSphere(10)
PositionEntity ball,3,0,0
EntityPickMode ball,2

cube = CreateCube()
EntityPickMode cube,2

cone = CreateCylinder(14)
PositionEntity cone,-3,0,0
EntityPickMode cone,2

Local tfx#[4]
Local tfy#[4]
Local tfz#[4]

cursor = CreateMesh()
cursorsurf = CreateSurface(cursor)
EntityColor cursor,255,0,0
EntityOrder cursor,-9

While Not KeyDown(1)

	RenderWorld
	If PickedEntity()
		Text 5,5,"picked quad = "+PickedQuad()+"/"+CountQuads(PickedSurface())
		Text 5,35,"quad verts:"
		Text 15,50,QuadVertex(PickedSurface(),PickedQuad(),0)
		Text 15,65,QuadVertex(PickedSurface(),PickedQuad(),1)
		Text 15,80,QuadVertex(PickedSurface(),PickedQuad(),2)
		Text 15,95,QuadVertex(PickedSurface(),PickedQuad(),3)
	EndIf

	Text 320,440,"Use mouse to click on objects",True

	Flip
	
	If MouseDown(1)
		CameraPick cam,MouseX(),MouseY()
		If PickedEntity()
			surf = PickedSurface()
		
			For f = 0 To 3
				qv = QuadVertex(surf,PickedQuad(),f)
				TFormPoint VertexX(surf,qv),VertexY(surf,qv),VertexZ(surf,qv),PickedEntity(),0
				tfx[f] = TFormedX()
				tfy[f] = TFormedY()
				tfz[f] = TFormedZ()
			Next
			
			ClearSurface cursorsurf
			AddQuad2(cursorsurf, tfx[0],tfy[0],tfz[0], tfx[1],tfy[1],tfz[1], tfx[2],tfy[2],tfz[2], tfx[3],tfy[3],tfz[3])
			UpdateNormals cursor

		EndIf
	Else
		ClearSurface cursorsurf
	EndIf
	
	TurnEntity cube,0.3,0.4,0
Wend
End


Function AddQuad(surf,v0,v1,v2,v3)	; similar to AddTriangle()
	Local tri = AddTriangle(surf,v0,v1,v2)
	AddTriangle(surf,v0,v2,v3)
	Return tri / 2
End Function

Function AddQuad2(surf, x0#,y0#,z0#, x1#,y1#,z1#, x2#,y2#,z2#, x3#,y3#,z3#)	; alternative to above func
	Local v0 = AddVertex(surf,x0,y0,z0, 0,0)
	Local v1 = AddVertex(surf,x1,y1,z1, 1,0)
	Local v2 = AddVertex(surf,x2,y2,z2, 1,1)
	Local v3 = AddVertex(surf,x3,y3,z3, 0,1)
	Local tri = AddTriangle(surf,v0,v1,v2)
	AddTriangle(surf,v0,v2,v3)
	Return tri / 2
End Function


Function CountQuads(surf)	; similar to CountTriangles()
	Return CountTriangles(surf) / 2
End Function

Function QuadVertex(surf,index,vertex) ; similar to TriangleVertex()
	If vertex &lt; 3
		Return TriangleVertex(surf,index*2,vertex)
	EndIf
	Return TriangleVertex(surf,index*2+1,2)
End Function


Function PickedQuad()	; similar to PickedTriangle()
	Return PickedTriangle() / 2
End Function



Function PickedVertex()	; similar to PickedTriangle()/PickedSurface() etc
	Local f, pv
	Local dx#,dy#,dz#
	Local vert, dist#, nearest# = -1.0
	Local surf = PickedSurface()
	
	TFormPoint PickedX(),PickedY(),PickedZ(),0,PickedEntity()
	For f = 0 To 2
		vert = TriangleVertex(surf,PickedTriangle(),f)
		dx = TFormedX()-VertexX(surf,vert)
		dy = TFormedY()-VertexY(surf,vert)
		dz = TFormedZ()-VertexZ(surf,vert)
		dist = dx*dx + dy*dy + dz*dz
		If dist &lt; nearest Or nearest &lt; 0.0
			pv = vert
			nearest = dist
		EndIf
	Next
	Return pv
End Function
;
</textarea><br><br><br>i thought it might be something to do with entityyaw, pitch,roll of camera, lol but i think im out of my depth<br><br>this must be like align polys in a particle engine<br><br><a href="http://homepage.ntlworld.com/david.howe50/zips/Quads.zip" target="_blank">......--&gt;...zip file Clicky....&lt;--.....</a><br><br><br>.... any ideas welcome <br><br></td></tr></table><br>
<a name="1018504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's exactly it, like aligning particles in a single surface engine.<br><br>What you need to do is calculate the center of that polygon\quad (averaging the XYZ of all 4 vertices), placing a pivot at that averaged position, and then spinning the pivot to the cameras global Pitch, Yaw and Roll.<br><br>Then, you use TFormVector from that pivot like with this:<br><pre class=code>
;After positioning the pivot at the averaged XYZ of all 4 vertices:

RotateEntity Pivot,EntityPitch(Camera,True),EntityYaw(Camera,True),EntityRoll(Camera,True),True

TFormVector sx#, -sy#, 0, Pivot, 0
v1x# = TFormedX()
v1y# = TFormedY() 
v1z# = TFormedZ()
TFormVector -sx#, -sy#, 0, Pivot, 0
v2x# = TFormedX() 
v2y# = TFormedY()
v2z# = TFormedZ() 
TFormVector sx#, sy#, 0, Pivot, 0
v3x# = TFormedX() 
v3y# = TFormedY() 
v3z# = TFormedZ() 
TFormVector -sx#, sy#, 0, Pivot, 0
v4x# = TFormedX() 
v4y# = TFormedY() 
v4z# = TFormedZ() 
</pre><br><br>Then you use each set of v#XYZ variables for each vertice.<br>Problem is, you have to find out the sx and sy values, which are the size of the quad. <br>For that you'll probably have to take the difference from each vertice's coordinates regarding to that averaged center of the quad. That will be your sx and sy (you should calculate a sx and sy for each vertice, to avoid deforming the quad).<br>Then you simply place the 4 vertices with the calculated v-1234-XYZ variables, and you have yourself a camera-aligned quad. <br><br></td></tr></table><br>
<a name="1018506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> i knew it would complicated, thats guna take some time to understand,  if at all<br><br>but at least i know its doable, thanks <br><br></td></tr></table><br>
<a name="1018525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I made this diagram, hope it helps:<br><br><img src="http://img695.imageshack.us/img695/8291/aligndiagram.png"> <br><br></td></tr></table><br>
<a name="1018612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive got something going on , nothing like the way your suggesting, perhaps I need to spend another few weeks learning what the hell is going on,<br><br><a href="http://homepage.ntlworld.com/david.howe50/zips/Quads.zip" target="_blank">......--&gt;...zip file Clicky....&lt;--.....</a><br><br>Thanks for trying Kryzon but I just don’t have the brain pan<br>Its like trying to show a baboon how to drive a car, he gets in pushes a few buttons, waves his arms around &amp; gets out<br><br>I think I will just go back to my crayons &amp; colouring books<br><br><br><br>The problem is ive dragged something out of the code archives and pulled it apart thinking I could follow it<br><br>This is going to sound long winded and a strange way of doing things to most people,<br>The thing started because in no way could I code a particle engine, I have particle candy but don’t like it, <br>so I came up with a more visual way of doing things and a lot easier for me.<br>What I wanted to do was create an explosion as an md2 file, 1 entity 1 surface<br>So I could do the explosion in lightwave with a plane full of quads I can pick each quad  and position it. <br>With its own explostion sprite on, so I would end up with an md2 file with lots of different explosion anims on, simple place entity and run an anim<br><br><img src="http://homepage.ntlworld.com/david.howe50/boomspritespic.png"><br><br>My only issue is aligning each quad to the camera while the anim is playing<br><br><br>thanks for trying, get out while ya can ;) <br><br></td></tr></table><br>
<a name="1018622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can maybe knock something simple particle wise to do this some time this week. <br><br></td></tr></table><br>
<a name="1018701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >scribbla</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> cheers Ross <br><br>you know im not the greatest at understanding this sort of thing<br><br>i owe you a beer, or six, just something i can pull apart and ruin ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
