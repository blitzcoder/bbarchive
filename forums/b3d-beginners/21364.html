<!DOCTYPE html><html lang="en" ><head ><title >Array vs. Data Bank</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Array vs. Data Bank</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Array vs. Data Bank</a><br><br>
<a name="218721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drankin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello Everybody,<br><br>I've only had Blitz3D and Plus for about 6 weeks, but as my first learning experiment, I wrote a simple 2D copy of the "Snake (Race)" game.  Anyway, it runs great on my 1200 Mhz/128 Mb RAM system, but it's so slow you can't play it on my friend's 400 Mhz/64 Mb RAM system.  I've narrowed the problem down to my snake drawing/shrinking/growing algorithm.  I keep the coordinates for each "block" of the snakes body in a two dimensional array which gets copied and updated every loop of the game.  I'm wondering if I'd be better off switching all the array data to a data bank.  Krylar's book says, " . . . they [data banks] tend to be quick."  Does this mean quicker than arrays?  Significantly quicker?  I've just been struggling to figure out what could be slowing it down, so I was hoping someone could let me know if this is even going down the right path or if arrays and data banks are really about as fast as each other and it's just my algorithm that needs re-working.<br><br>Thanks in advance for any suggestions or ideas anyone can offer!<br><br>-Dave <br><br></td></tr></table><br>
<a name="218742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Curtastic</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> what I did when I made snake on my TI 89, was have the direction of the head set into a map array, and move the eraser (which is at the tail) each loop, to the direction stored in that map position when the head was there, so the eraser will act as the tail and erase the snake.<br><br>that has to be the fastest way, because it runs fast on my TI 89 calculator, made in the interpreted basic. <br><br></td></tr></table><br>
<a name="218843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Most likely, your program in general is inefficient.  I own a PIII-450 and it can play well beyond a simple 'snake' game.  I know because I've written many variations through the years and my original (and successful) attempts were on an ADAM computer system 20 years ago which probably only ran at about 8 MHz. <br><br></td></tr></table><br>
<a name="219011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bank access is (or was - I see there are B3D updates available) slower than simple variables/arrays. However they are much more flexible. As WolRon stated it is very likely an inefficiency that is causing the slowdown. Why not post the suspect code for inspection? I've seen some truly impressive optimisations on these forums. <br><br></td></tr></table><br>
<a name="219018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drankin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for all the comments everybody.  Since I first posted, I tried two new variations:  data banks, which seemed to be a little slower, and a comma-delimited string in which I parsed every loop (in place of the array) and that was WAY too slow.  The basic layout of what I'm doing is this:<br><br>1. Create a 2 dimensional array at the start of the level where array$(1,1) through array$(1,8) hold x coords and array$(2,1) through array$(2,8) hold y coords for the snake's body.<br><br>2.  Each loop, I determine the direction the snake is heading (n,s,e,w), and then I add +1 body block to array$(1,1) while removing the values at array$(1,8) and array$(2,8).  (In other words, I push a new value to the first index of the array and pop the last value off.)<br><br>3. I do a For loop on the array and draw a rectangle at every x,y coord in the array.<br><br>Ex.<br>For i% = 1 To 8<br>x% = array$(1,i%)<br>y% = array$(2,i%)<br>Rect x%,y%,8,8,1<br>Next<br><br><br>When the game starts the snake's body is 8 "blocks."  This works fine and is fast.  But, as the snake eats food, it grows, and when the snake grows to 60+ "blocks" the whole thing starts to slow down to an unplayable crawl on the less powerful machine.  I wish I had a way to test if this is a problem with the algorithm or BlitzPlus.  None of the demo games that come with BlitzPlus are playable on this machine either, but they are on my faster one.  For example, the "Insectoids" game that came with BlitzPlus runs close to one frame/second on this machine.  That doesn't seem right even on a PII 400Mhz with 64Mb of RAM, does it?  I like B3D a lot, but I was hoping to be able to let people without 3D video cards play this.  <br><br>Thanks again for all the comments so far, and I'd love to hear any other thoughts or suggestions.<br><br>-Dave <br><br></td></tr></table><br>
<a name="219306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Curtastic</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> you have way more than enough speed in blitz on that computer to do it.<br><br>the easiest way is to use a type and its fast,<br>every loop create a New position<br>Insert it Before First position<br>Delete Last position<br>and draw with a For Each loop. <br><br></td></tr></table><br>
<a name="219917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robleong</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dave,<br><br>Blitz can do hundreds of sprites almost instantly, so it is probably a problem with your implementation. If you post a copy of your source here, or send me a copy of your source, I/we should be able to sort it out for you.<br><br>Question - why did you use a string array? That might be the problem, or part of it anyway. <br><br></td></tr></table><br>
<a name="220013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't see anything in your general method which suggests a problem. It's probably a little glitchy bug that you're missing. There are a thousand and one possibilities so it's difficult to guess without seeing the code. <br><br></td></tr></table><br>
<a name="220058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, the drivers for the 'slow' machine may be inadequit.  Try your code on a third 'slow' machine and see what the results are. <br><br></td></tr></table><br>
<a name="220160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Michael Reitzenstein</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or your game may be running at thousands of FPS on your better computer but only hundreds of FPS on the slower one. <br><br></td></tr></table><br>
<a name="220520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drankin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Again Everybody,<br><br>Well, thank you all very much for all the suggestions so far.  Unfortunately, I haven't been able to solve the problem yet.  The string array I used in the example code was just a mistake.  The actual code uses an integer array.  I would like to try the code on a third 'slow' machine, but I don't have another one to try it on.  But, like I mentioned, one of the things that makes me suspicious of this machine as a whole is that it can't run any of the demo games that came with Blitz Plus.  But if it is some hardware issue, is that something I need to be concerned about when trying to distribute Blitz Plus games to the general public?  I thought Blitz Plus was supposed to run on all Win95+ systems?<br><br>Anyway, I've narrowed the problem down to something that happens in one of the following functions.  I apologize for posting so much code, and if there's a more appropriate way to post code to this site, please just let me know.<br><br>Although I said the game involved a "snake" that was just for simplicity.  It's exactly like the "snake" game, except that mine uses Dachshunds.  Below you'll find the type declaration for the dogs, the initial array I use for the starting body coordinates and the three functions that move, update and draw the dog.  The rest of the game involves drawing a perimiter and maze of walls to go through, a computer opponent dog, and bowls and bones for eating.  I've even tried taking away all the walls and opponent dog, but I get the same problem, when the dog eats about 10 bowls, he grows to an array of 58 blocks and he just slows down way too much to play.  I think the probem may be in the "update_hund()" function below, but maybe my whole approach is flawed.  Again, thanks for any help or suggestions.<br><br>-Dave<br><br>-----------------------------------------------------------<br>Code<br>-----------------------------------------------------------<br><br>Type Hunden<br>Field head%	; anim image index<br>Field head_x%	; X value of head image<br>Field head_y%	; Y value of head image<br>Field tail%	; anim image index<br>Field tail_x%	; X value of tail image<br>Field tail_y%	; Y value of tail image<br>Field red%	; red value of the dog<br>Field blue%	; blue value of the dog<br>Field green%	; green value of the dog<br>Field heading$	; v|h which way's the dog heading<br>Field x_incr%	; how many x increments to go each move<br>Field y_incr%	; how many y increments to go each move<br>Field id%       ; ID of dog : Black = 0, Brown = 8, <br>                ; Red = 16, Tan = 24<br>Field owner$	; (h|c) human or computer<br>Field grow%	; how many blocks to let the dog grow by               <br>                ; from eating food<br>Field shrink%	; how many blocks to let the dog shrink by <br>                ; from eating a bone<br>End Type<br><br><br>; Beginning body block locations for this dog<br>Dim my_coords%(2,8)<br>my_coords%(1,1) = 645<br>my_coords%(2,1) = 196<br>my_coords%(1,2) = 650<br>my_coords%(2,2) = 196<br>my_coords%(1,3) = 655<br>my_coords%(2,3) = 196<br>my_coords%(1,4) = 660<br>my_coords%(2,4) = 196<br>my_coords%(1,5) = 665<br>my_coords%(2,5) = 196<br>my_coords%(1,6) = 670<br>my_coords%(2,6) = 196<br>my_coords%(1,7) = 675<br>my_coords%(2,7) = 196<br>my_coords%(1,8) = 680<br>my_coords%(2,8) = 196<br>LAST_INDEX% = 8<br><br><br>; This is called when the user presses one of the arrow <br>; keys.<br>Function move_my_hund(hund.Hunden,direction$)<br><br>; Get beginning and ending body array values before we <br>; update so we can compare and turn the the tail the right <br>; direction.<br> old_first_x% = my_coords%(1,1)<br> old_first_y% = my_coords%(2,1)<br> last_x% = my_coords%(1,LAST_INDEX%)<br> last_y% = my_coords%(2,LAST_INDEX%)<br>	<br>; Move the direction that was passed to this function<br> Select direction$<br>  Case "up"<br><br>  hund\y_incr% = Abs(hund\y_incr%) * -1<br>  next_x% = last_x% <br><br>; Check top perimiter<br>  If last_y% &lt; 12<br>   lose_life()<br>  Else<br>  ; No problem, go up one<br>   next_y% = last_y% + hund\y_incr%<br>   hund\heading$ = "v"<br>  EndIf<br>		<br>; Animation<br>  If hund\head% = 2 + hund\id%<br>   hund\head% = 3 + hund\id%<br>  Else <br>   hund\head% = 2 + hund\id%<br>  EndIf <br><br>		<br>  Case "down"<br>   hund\y_incr% = Abs(hund\y_incr%)<br>   next_x% = last_x% <br><br>; Check bottom perimiter<br>   If last_y% &gt; 397<br>    lose_life()<br>   Else<br>    ; No problem, go down one<br>    next_y% = last_y% + hund\y_incr%<br>    hund\heading$ = "v"<br>   EndIf<br>		<br>; Animation<br>   If hund\head% = hund\id%<br>    hund\head% = 1 + hund\id%<br>   Else <br>    hund\head% = hund\id%<br>   EndIf<br><br>	<br> Case "left"<br><br>  next_y% = last_y%<br>; Check left perimiter<br>  If last_x% &lt; 11 And gate_state$ = "closed"<br>   lose_life()<br>  Else<br>   ; No problem, go right one<br>   hund\x_incr% = Abs(hund\x_incr%) * -1<br>   next_x% = last_x% + hund\x_incr%<br>   hund\heading$ = "h"<br>  EndIf<br>		<br>; Animation<br>  If hund\head% = 6 + hund\id%<br>   hund\head% = 7 + hund\id%<br>  Else <br>   hund\head% = 6 + hund\id%<br>  EndIf<br><br>		 <br> Case "right"<br><br>  next_y% = last_y%<br>; Check right perimiter<br>  If last_x% &gt; 621 And gate_state$ = "closed"<br>   lose_life()<br>  Else<br>   ; No problem, go right one<br>   hund\x_incr% = Abs(hund\x_incr%)<br>   next_x% = last_x% + hund\x_incr%<br>   hund\heading$ = "h"<br>  EndIf<br>					<br>; Animation<br>  If hund\head% = 4 + hund\id%<br>   hund\head% = 5 + hund\id%<br>  Else <br>   hund\head% = 4 + hund\id%<br>  EndIf <br><br> End Select<br><br>; Update the dog's body coords<br> update_hund(hund.Hunden, next_x%,next_y%)<br>	<br>; Compare new first x,y to old first x,y and see what way <br>; the last block moved and display the<br>; appropriate dog butt.	<br> new_first_x% = my_coords%(1,1)<br> new_first_y% = my_coords%(2,1)<br><br> If new_first_y% &lt; old_first_y% ; UP<br>  hund\tail_x% = my_coords%(1,1) - 5<br>  hund\tail_y% = my_coords%(2,1) + 8<br>	<br>; Animation<br>  If hund\tail% = 4 + (hund\id% * 2)<br>   hund\tail% = 5 + (hund\id% * 2)<br>  ElseIf hund\tail% = 5 + (hund\id% * 2)<br>   hund\tail% = 6 + (hund\id% * 2)<br>  ElseIf hund\tail% = 6 + (hund\id% * 2)<br>   hund\tail% = 4 + (hund\id% * 2)<br>  Else <br>   hund\tail% = 4 + (hund\id% * 2)<br>  EndIf 	<br><br>		<br> ElseIf new_first_y% &gt; old_first_y% ; DOWN<br>	<br>  hund\tail_x% = my_coords%(1,1) - 5<br>  hund\tail_y% = my_coords%(2,1) - 16<br><br>; Animation<br>  If hund\tail% = hund\id% * 2<br>   hund\tail% = 1 + (hund\id% * 2)<br>  ElseIf hund\tail% = 1 + (hund\id% * 2)<br>   hund\tail% = 2 + (hund\id% * 2)<br>  ElseIf hund\tail% = 2 + (hund\id% * 2)<br>   hund\tail% = 3 + (hund\id% * 2)<br>  Else<br>   hund\tail% = hund\id% * 2<br>  EndIf<br>	<br> ElseIf new_first_x% &lt; old_first_x% ; LEFT<br><br>  hund\tail_x% = my_coords%(1,1) + 5<br>  hund\tail_y% = my_coords%(2,1) - 5<br><br>; Animation<br>  If hund\tail% = 12 + (hund\id% * 2)<br>   hund\tail% = 13 + (hund\id% * 2)<br>  ElseIf hund\tail% = 13 + (hund\id% * 2)<br>   hund\tail% = 14 + (hund\id% * 2)<br>  ElseIf hund\tail% = 14 + (hund\id% * 2)<br>   hund\tail% = 15 + (hund\id% * 2)<br>  Else<br>   hund\tail% = 12 + (hund\id% * 2)<br>  EndIf<br>	<br> ElseIf new_first_x% &gt; old_first_x% ; RIGHT<br>	<br>  hund\tail_x% = my_coords%(1,1) - 17<br>  hund\tail_y% = my_coords%(2,1) - 5<br><br>; Animation<br>  If hund\tail% = 8 + (hund\id% * 2)<br>   hund\tail% = 9 + (hund\id% * 2)<br>  ElseIf hund\tail% = 9 + (hund\id% * 2)<br>   hund\tail% = 10 + (hund\id% * 2)<br>  ElseIf hund\tail% = 10 + (hund\id% * 2)<br>   hund\tail% = 11 + (hund\id% * 2)<br>  Else<br>   hund\tail% = 8 + (hund\id% * 2)<br>  EndIf<br> EndIf<br>End Function<br><br><br><br>; Updates the body coordinates of the requested dog<br>Function update_hund(hund.Hunden, next_x%,next_y%)<br><br>; First figure out if we're growing, shrinking or neither<br> If hund\grow% &gt; 0 ; Growing<br>  start% = 1<br>  end_point% = LAST_INDEX% + 1<br>  hund\grow% = hund\grow% - 1<br><br>; This is so that when we return to normal, we don't have a  <br>; LAST_INDEX% 1 too high<br> If hund\grow% &gt; 1<br>  new_last_index% = LAST_INDEX% + 1<br> Else<br>  new_last_index% = LAST_INDEX%<br> EndIf<br>				<br> ElseIf hund\shrink% &gt; 0 ; Shrinking<br>  start% = 3<br>  end_point% = LAST_INDEX% + 1<br>  hund\shrink% = hund\shrink% - 1<br>  new_last_index% = LAST_INDEX% - 1<br> <br>  If start% &gt; end_point%<br>   start% = end_point% - 1<br>   new_last_index% = LAST_INDEX%<br>  EndIf<br><br> Else ; Not shrinking or growing<br>  start% = 2<br>  end_point% = LAST_INDEX%<br>  new_last_index% = LAST_INDEX%<br> EndIf <br><br>; Now, if we're growing or shrinking copy current  <br>; my_coords%() to loc_coords%()<br> If hund\grow% &gt; 0 Or hund\shrink% &gt; 0<br>  Dim loc_coords%(2,end_point%)<br>  For i% = 1 To LAST_INDEX%<br>   loc_coords%(1,i%) = my_coords%(1,i%)<br>   loc_coords%(2,i%) = my_coords%(2,i%)<br>  Next<br><br>; Re-dimension my_coords and re-populate<br>  Dim my_coords%(2,end_point%)<br>  For i% = 1 To LAST_INDEX%<br>   my_coords%(1,i%) = loc_coords%(1,i%)<br>   my_coords%(2,i%) = loc_coords%(2,i%)<br>  Next<br> EndIf <br><br>; Cut out or add to the appropriate places for the new body<br> For i% = start% To LAST_INDEX%<br>  n% = i% - 1<br>  my_coords%(1,n%) = my_coords%(1,i%)<br>  my_coords%(2,n%) = my_coords%(2,i%)		<br> Next<br>		<br>; Add the new next x,y<br> my_coords%(1,end_point%) = next_x%<br> my_coords%(2,end_point%) = next_y%<br>		<br>; Update LAST_INDEX% for new DIM<br> LAST_INDEX% = new_last_index%<br><br>End Function	<br><br><br>; Draw a dog<br>Function draw_hund(hund.Hunden)<br><br>; Whose dog (and coords) is this?<br> If hund\owner$ = "h" ; Human's<br><br>; Prepare loc_coords%() for human data and load<br>  Dim loc_coords%(2,LAST_INDEX%)<br>  For i% = 1 To LAST_INDEX%<br>   loc_coords%(1,i%) = my_coords%(1,i%)<br>   loc_coords%(2,i%) = my_coords%(2,i%)<br>  Next	<br><br> Else ; Computer's<br><br>; Prepare loc_coords%() for computer data and load<br>  Dim loc_coords%(2,LAST_INDEXC%)<br>  For i% = 1 To LAST_INDEXC%<br>   loc_coords%(1,i%) = your_coords%(1,i%)<br>   loc_coords%(2,i%) = your_coords%(2,i%)<br>  Next<br>		<br> EndIf<br>	<br>; Set drawing color to dog color and draw body<br> Color hund\red%, hund\green%, hund\blue%<br> If hund\owner$ = "h"<br>  end_body% = LAST_INDEX%<br> Else<br>  end_body% = LAST_INDEXC%<br> EndIf<br><br> For i% = 1 To end_body%<br>  x% = loc_coords%(1,i%)<br>  y% = loc_coords%(2,i%)<br>  Rect(x%, y%, 8, 8, 1)<br> Next<br><br>; Draw head in right location<br> If hund\heading$ = "h"<br>  If hund\x_incr% &gt; 0 ; Moving horizontally right<br>   hund\head_x% = loc_coords%(1,end_body%) + 8<br>   hund\head_y% = loc_coords%(2,end_body%) - 6<br>  ElseIf hund\x_incr% &lt; 0 ; Moving horizontally left<br>   hund\head_x% = loc_coords%(1,end_body%) - 16<br>   hund\head_y% = loc_coords%(2,end_body%) - 6<br>  EndIf <br> EndIf<br>	<br> If hund\heading$ = "v"<br>  If hund\y_incr% &lt; 0 ; Moving vertically up<br>   hund\head_x% = loc_coords%(1,end_body%) - 5<br>   hund\head_y% = loc_coords%(2,end_body%) - 16<br>  ElseIf hund\y_incr% &gt; 0 ; Moving vertically down<br>   hund\head_x% = loc_coords%(1,end_body%) - 5<br>   hund\head_y% = loc_coords%(2,end_body%) + 8<br>  EndIf<br> EndIf<br><br><br>; Draw head and tail for this dog at the right locations<br> DrawImage heads, hund\head_x%, hund\head_y%, hund\head%<br> DrawImage tails, hund\tail_x%, hund\tail_y%, hund\tail%	<br><br>End Function <br><br></td></tr></table><br>
<a name="220578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robleong</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dave, I must admit that I have difficulty reading so much code, especially if it is written by someone else than me! Besides, all that % is distracting - unlike other Basics that I've used, Blitz uses integer variables by default and doesn't need the % symbol. The code can't be run too, so that makes it even more difficult for someone else to debug for you.<br><br>Can you maybe post a (minimal) source code that can be run and yet contain the problem to be solved? Or maybe try starting off with a predefined 58-block snake without all the rest of the code (to make it grow in length), and see whether that is a problem? <br><br></td></tr></table><br>
<a name="220734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drankin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I had a feeling it was probably too long to be much good.  It's gonna be tough to get it much smaller I think without potentially cutting out the problem.  I did try starting off with a predefined 58-block snake, and the problem still existed.<br><br>But, as I was reviewing everything just now to see if I couldn't find a shorter sample to post, I came across something unexpected that leads me to believe I just don't get arrays in Blitz . . . which is probably causing my problem.<br><br>I thought that when you Dim an array, whatever you Dim it at is the highest index in the array that Blitz is storing.  For example, if you say:<br><br>Dim array%(2)<br>Then array%(3) should say something like "out of bounds."<br><br>But, this isn't the case.  I wrote a little test:<br><br>Graphics 640,480<br>Dim array%(1)<br>array%(1) = 1<br>array%(2) = 2<br>array%(3) = 3<br>array%(4) = 4<br><br>next_y = 0<br>For i = 1 To 10<br>Text 0,next_y%, i + ": " + array%(i%)<br>next_y = next_y + 15<br>Next<br><br>WaitKey()<br>End<br><br>On my computers, this repeatedly prints out the same thing:<br><br>1: 1<br>2: 2<br>3: 3<br>4: 4<br>5: 524544<br>6: 24495808<br>7: 11286568<br>8: 11333336<br>9: 0<br>10: 197152<br><br>First off, what are all these values at index 5 and above?  I even tried going up to index 100 and it just kept spitting back numbers.  Is it affecting memory usage if Blitz is storing all these values that I didn't even define?  Secondly, if I can just add values at indeces higher than the Dim, then what's the point in ever saying anything other than Dim array%(1) and then just letting Blitz dynamically resize as I add more values?  I guess I just really don't get arrays in Blitz.  I've read the chapter about them in Krylar's book, but I guess I need more info.  Can anyone explain this or point somewhere that I can read more about them?<br><br>Sorry to keep posting questions, but I really do appreciate everyone's help!<br><br>-Dave <br><br></td></tr></table><br>
<a name="220758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Delete all the '%' from your code, then try it again.<br><br>As robleong has stated, they are completely useless, because they indicates an integer declaration, which is the default.<br><br>So when you declare<br>Global abc% <br>is exactly the same of<br>Global abc<br><br>Only, abc is more readable than abc%.<br><br>Try.<br><br>One more thing.<br>I think, if I recall well, than if you declare an array with:<br>Dim arr(0)<br>then you can later re-dim the array like<br>dim arr(5)<br><br>But I'm not 100% sure. Argh ! I've typed a '%'.. !<br><br>;) <br><br></td></tr></table><br>
<a name="220768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drankin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the '%' suggestion.  I took them all out, but I get the same results.<br><br>Dim'ing and then re-Dim'ing an array makes sense to me, but I still don't get why after only one Dim, there are all kinds of values being stored above the original Dim declaration.<br><br>Thanks again!<br><br>-Dave <br><br></td></tr></table><br>
<a name="220815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robleong</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Drankin,<br><br>As to your question about arrays, actually, I get an "Array index out of bounds" error when I run your code, but I'm using Blitz3D. So, not sure whether you're using Blitz+; if that's the case, some error-checking code might be missing in Blitz+... As to why you're getting all those weird values, I think it's simply interpreting any value that's left in memory (and not cleared), offset by so many bytes as pointed to by your array value (which it shouldn't!). <br><br></td></tr></table><br>
<a name="220835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robleong</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, and Drankin, can you just recreate and post an executable/'runnable' source code with just the 58-block predefined snake (maybe just going automatically around a square area) and we can try to see why there's a problem even with this? <br><br></td></tr></table><br>
<a name="220997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drankin</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, like I've been saying all along, I really do appreciate all the help.  But, I do have to admit that I figured something out when I was trying to give you what you asked for (a runnable 58 block snake with just the necessary code).  There was a problem with my implementation.  The slow down didn't start at 58 blocks, it started at 580 blocks.  Technically, it's when there are about 600 sprites being updated per frame.  Also, I've been using Blitz Plus for this, but this afternoon, I made a Blitz 3D copy and ran it on another machine that was also only 400Mhz/64Mb RAM and the B3D copy ran fine--even with 600 sprites/fame.  I guess I figured at least in terms of speed, Blitz Plus and B3D would be the same.  I would just use B3D, but it seems kind of silly to me that I'd make a 2D game that would require a 3D video card.<br><br>Anyway, I corrected the implementation in the Blitz Plus version and now in its corrected state it only ever gets to about 70 sprites per frame and it runs just fine like that.  I still don't know why I'm able to do that array stuff I mentioned two posts ago in Blitz Plus, but I guess I won't worry about it for now.<br><br>Well, thank you again everyone for all your help, and thank you robleong for all the suggestions and asking me to do the thing that led to me finding my error.<br><br>I'm really very happy that I decided to get into Blitz.  So far I love it, and the Blitz community has been great.<br><br>-Dave <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
