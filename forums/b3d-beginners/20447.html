<!DOCTYPE html><html lang="en" ><head ><title >Animation help plz!!!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Animation help plz!!!</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Animation help plz!!!</a><br><br>
<a name="208656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIMPY73</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi <br><br>Im doing a cannon fodder clone in Blitz3d tho the game is 2d<br><br>ive got the mouse routine working fine the main character can move in 8 directions and is controled by the mouse <br>left mouse button moves the character to where you clicked right mouse button fire's a bullet<br><br>The problem im having is this <br><br>My character has 24 frames of animation (0-23) and there is 3 frames per direction so if he moves up screen his back is towards you etc etc<br><br>What i need is some animation code so when i click my character walks towards where i clicked instead of sliding<br><br>I just cant get my head around it any help plz<br><br>i can post the code if needed but you will need to make some of your own graphics cos i ripped the graphics out of the amiga version of cannon fodder as test graphics<br><br><br>Thanks<br>GIMPY <br><br></td></tr></table><br>
<a name="208734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gauge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Assum CharX,CharY as the characters position.<br>Then your using mousex,mousey to pick the spot.  If your not using tiles just the x/y pos figure use mousex/mousey and use these next ifs to figure the direction.  If your using tiles...youll have to write a slightly more advanced code, cause if you click 3 tiles right)(east) and 1 tile(north) your anim string would be loaded as ne, and you would move 1ne, and then 2e all as anim ne direction.<br><br>If charX=ClickX Andif CharY&lt;ClickY then "anim string south"<br>If charX=clickX andif chary&gt;clicky then "anim string north"<br>If charX&gt;clickx andif chary=Clicky then "anim string east"<br>if charX&lt;clickx andif chary=clicky then "anim string east"<br>;Note if your not using a tile system, you'll probably want <br>;to add a 20 or 30 degree pixel varriance on clickx/clicky<br>;otherwise it'll only pick e/n/s/w on line of pixels<br>If CharX&lt;ClickX Andif CharY&lt;ClickY then "anim string nw"<br>if charX&gt;ClickX andif CharY&lt;ClickY then "anim string ne"<br>if CharX&gt;ClickX andif CharY&gt;ClickY then "anim string se"<br>if charx&lt;ClickX andif CharY&gt;Clicky then "anim string sw"<br><br>I don't know if this helps, but post up your code and i'll try to get it to work for ya <br><br></td></tr></table><br>
<a name="208747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIMPY73</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> K thanks m8 here is my code<br><br>;*****************<br>;* Mouse Routine *<br>;* Cannon Fodder *<br>;*     Style     *<br>;*****************<br><br>Graphics 640,480,16<br>SetBuffer BackBuffer()<br> <br>;-Types-----------------------------------------------------<br><br>Type bullet<br>	Field x#,y#<br>	Field ang#,speed#<br>	Field img<br>	Field life#<br>End Type<br><br>Type player<br>	Field x#,y#<br>	Field ang#,speed#<br>	Field frm	;animation frame<br>End Type<br><br>Type particle<br>	Field x#,y#<br>	Field dx#,dy#<br>	Field size#<br>	Field r,g,b<br>End Type<br><br>;-Globals-------------------------------------------------------<br><br>Global me.player=New player<br>Global clickedx#,clickedy#<br>Global imgplayer<br>Global imgshot<br>Global sndshot<br>Global sndgun<br>Global fps = CreateTimer(60)<br><br>;-Graphics+Sounds-----------------------------------------------<br><br>imgplayer=LoadAnimImage("fodman3.png",15,14,0,23)<br>imgshot=LoadImage("shot.bmp")<br>sndshot=LoadSound("shot.wav")<br>sndgun=LoadSound("gun.wav")<br>MaskImage imgplayer,255,0,255<br>MidHandle imgplayer<br>MidHandle imgshot<br>me\x=160<br>me\y=100<br><br>;-Main loop-------------------------------------------------<br><br>While Not KeyHit(1)<br>	<br>	Cls<br>	<br>	Color 50,100,150<br>	Rect 0,0,640,480,1<br>	<br>	angle=ATan2(MouseX()-me\x,MouseY()-me\y)<br><br>	If Angle&lt;0 Angle=Angle+360<br><br>	<br>	If MouseHit(2)<br>	<br>		clickedx=MouseX()<br>		clickedy=MouseY()<br>		me\ang=ATan2(clickedx-me\x,clickedy-me\y)<br>		me\speed=2<br>		<br>	EndIf<br>	<br>	If Sqr(me\x-clickedx)^2+(me\y-clickedy)^2&lt;9<br>   		me\speed=0<br>	EndIf<br>	<br>	If KeyDown(42) And MouseDown(2)<br>	me\speed=6<br>	End If<br><br>	If MouseHit(1) <br>		<br>		b.bullet = New bullet ;Create bullet<br>		b\x = me\x : b\y = me\y<br>		b\ang= ATan2(MouseX()-b\x,MouseY()-b\y)+Rnd(-3,6)<br>		b\speed=6<br>		b\life=30<br>		b\img=imgshot<br>		PlaySound(sndgun)	<br>			<br>	End If<br>		<br>	For b.bullet = Each bullet<br>			movebullet(b)			<br>	Next<br>	If angle&lt;0 angle=angle+360<br><br>	If angle&gt;160 And angle&lt;200 <br>		 me\frm=4;up<br>	EndIf<br>	<br>	If angle&gt;110 And angle&lt;160<br>		me\frm=22;up right<br>	EndIf<br>		<br>	If angle&gt;70 And angle&lt;110<br>	   	me\frm=10;right<br>	EndIf<br>	<br>	If angle&gt;20 And angle&lt;70<br>		me\frm=16;down right<br>	EndIf<br>		<br>	If angle&gt;345 Or angle&lt;15 Or angle=0<br>    	me\frm=1;down<br>  	EndIf<br>	<br>	If angle&lt;335 And angle&gt;290<br>		me\frm=13 ;down left<br>	EndIf<br>		<br>	If angle&lt;290 And angle&gt;245<br>		me\frm=7 ;left<br>	EndIf<br>	<br>	If angle&lt;245 And angle&gt;200<br>		me\frm=19 ;up left<br>	EndIf<br>	<br>;-Move particles----------------------------------------------<br>	For pt.particle = Each particle<br>		<br>		pt\x = pt\x + pt\dx<br>		pt\y = pt\y + pt\dy<br>		pt\size = pt\size - .6<br><br>	If pt\size=&lt;0 Then Delete pt<br>	<br>	Next<br>	<br>		me\y=me\y+(Cos(me\ang)*me\speed)<br>		me\x=me\x+(Sin(me\ang)*me\speed)<br>		    					<br>	For pt.particle = Each particle<br>		<br>		Color pt\r,pt\g,pt\b<br>		Oval pt\x-pt\size/2,pt\y-pt\size/2,pt\size,pt\size<br>	<br>	Next<br>	<br>	Color 255,255,255<br>	DrawImage imgplayer,me\x,me\y,me\frm;player gfx<br>	<br>	Color 255,25,25<br>	Rect MouseX(),MouseY(),2,2; mouse gfx<br><br>	Flip<br>	Wend<br><br>End<br><br>;-Functions-------------------------------------------------<br><br><br>Function MoveBullet(b.bullet)<br>	<br><br>		<br>		b\y=b\y+(Cos(b\ang)*b\speed)<br>		b\x=b\x+(Sin(b\ang)*b\speed)<br>		<br>				<br>		DrawImage b\img,b\x,b\y,0<br>		<br>			<br>		b\life=b\life-1<br>		<br>			<br>		If b\life&lt;0 ;Then Delete b.bullet<br>			For i=1 To 50<br>				<br>				pt.particle = New particle<br>				pt\x = b\x<br>				pt\y = b\y<br>				pt\dx = Rnd(-2,2):pt\dy=Rnd(-2,2)<br>				pt\size = Rnd(2,4)<br>				col# = Rnd(48,128)<br>				pt\r = col: pt\g = col: pt\b = col<br>				<br>				If i&gt;30 Then<br>				<br>				pt\r=255: pt\g=300-pt\size*40: pt\b=0 ;colour it red/yellow<br>				pt\dx=pt\dx/2 ;slow it down<br>				pt\dy=pt\dy/2<br>				<br>				End If<br>			Next<br>			<br> 			Delete b.bullet<br>			chnwave1=PlaySound(sndshot)<br>			ChannelVolume chnwave1,.2<br><br>			<br>		End If<br><br>End Function <br><br></td></tr></table><br>
<a name="208983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gauge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alright i got the code this morning its about 7am central time here.  I'll work on it tonight when i get outta work(6p or so).  I noticed a few little things. <br><br></td></tr></table><br>
<a name="208987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIMPY73</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Gauge for atleast looking at my code :)<br><br><br><br><br><br><br>Thanks<br>GIMPY <br><br></td></tr></table><br>
<a name="210324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gauge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm back, sorry it tooke me so long...heres a few things.<br>1. Instead of Rect 0,0,,640,480 each frame, use Clscolor 50,100,150..it'll auto clear the screen to that color...<br>2. Each time it loops right now it reads the angle every time and changes the animation loop back to the first frame of whichever direction the mouse is from the char.  To toggle the the three frames, use me\frm=me\frm+1 after flip and before the wend.  Then run a few ifs if frame is 4,7,10 the end of that loop then restart ie If me\frm=4 then me\frm=1,etc.  You should be able to check this without half a dozen ifs with left$ and divided it by 3 though but i haven't tried it.,If you want the character to always look in the direction of the mouse, you'll have to keep two angles, the angle its currently moving, vs the angle its facing.  Or use If me\speed=0(for the char not moving) me\frm=(1,4 etc from the angle). <br>3.  I would function this out so your main loop looks like the following.  <br><pre class=code>
Main Loop()
Cls
ReadAngle Me
If Mousehit(2) MovePlayer me
If Mousehit(1) Shoot
UpdateBullets
Color 255,255,255 
DrawImage imgplayer,me\x,me\y,me\frm;player gfx 
Color 255,25,25 
Rect MouseX(),MouseY(),2,2; mouse gfx
Flip
Wend
</pre><br><br>Of course i tend to over function things too....I didn't have an aniimage so i couldn't test it totally though, and for some reason my old testfile of this got deleted *growl*<br>I used text 10,10,angle and test 10,50,me\frm add those in before flip and you'll see what its doing.  I always add text, such and such a spot so i can track everything.<br><br>You may also want to use the field bullet and use it as a type in player also.  Well good luck, hope that helps <br><br></td></tr></table><br>
<a name="210650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIMPY73</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks M8 ill give it a try 2night and c wot i can come up with <br><br><br><br><br>GIMPY :) <br><br></td></tr></table><br>
<a name="210707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr Derek Doctors</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Spooky! I'm writing Cannon Fodder in B2D! That's kinda' scary... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
