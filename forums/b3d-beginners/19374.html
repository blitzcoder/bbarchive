<!DOCTYPE html><html lang="en" ><head ><title >buffer/debug question</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >buffer/debug question</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >buffer/debug question</a><br><br>
<a name="197698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I ran into some odd (to me) behavior while experimenting with a program to generate random abstract art to the screen.  The part I don't understand is that when I run the code with debug enabled and hit spacebar a few times, everything seems to go directly to the foreground (which is what I want), but if I run it without debug enabled it seems like output is alternating between foreground and background.<br><br>If I take out the flip command, and run with debug NOT enabled, I'll see the output only after I hit the escape key.  With debug enabled, I'll NEVER see the output.<br><br>--------------------------------------<br>Graphics 1024,768<br>SetBuffer FrontBuffer() <br>Cls<br><br>While Not KeyHit(1) <br>  Color Rand(1,255),Rand(1,255),Rand(1,255)<br>  For I= 1 To 100 Step 10<br>    Oval 200,350+Rand(1,50), I,I,0<br>  Next<br>  Flip<br>  WaitKey<br>Wend<br>--------------------------------------<br><br>Any thoughts? <br><br></td></tr></table><br>
<a name="197712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >makakoman</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> change SetBuffer FrontBuffer() to SetBuffer BackBuffer().<br><br>YOu are always writing to the frontbuffer and then copying the empty backbuffer over it when you call flip.  You should 'almost always' write to the backbuffer, and then flip swaps the backbuffer to the front, thus showing what you have drawn.<br><br>Good Luck,<br>MK <br><br></td></tr></table><br>
<a name="197723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the suggestion, MK, but oddly enough it seems to behave exactly the same even after changing SetBuffer FrontBuffer to SetBuffer BackBuffer().  It still works fine with debug on, but as soon as I set debug off, it seems to be switching back and forth.<br><br>Just to be clear what I mean by that, I took out the for next loop and adjusted the oval statement (see code below) and got the following sequence:<br><br>(1) I run it - a small filled circle is displayed.<br>(2) I press spacebar to loop again - The first circle disappears, and a different circle is displayed.<br>(3) Spacebar again - The 2nd circle dissappears, the 1st one comes back, and a 3rd (new) one comes on (for a total of 2 on screen now)<br>(4) Spacebar again - Circles 1 and 3 dissappear, 2 comes back, and new once comes on (still two on screen).<br>(5) "" - circles 2 and 4 gone, 1 and 3 come back joined by 5 for total of 3 circles<br>... and so on ad infinitum.<br><br>--------------------------------------<br>Graphics 1024,768<br>SetBuffer BackBuffer() <br>Cls<br><br>While Not KeyHit(1) <br>  Color Rand(1,255),Rand(1,255),Rand(1,255)<br>  Oval 200+Rand(1,50),350+Rand(1,50), 5,5,1<br>  Delay 100 <br>  Flip<br>  WaitKey<br>Wend<br>--------------------------------------<br><br>So I don't know - Does the above code work for someone else running with debug on?  Could it be a Windows XP problem?  My video card? (64mb NVidea GeForce2 MX with TV Out).<br><br>Frustrated but not discouraged,<br><br>Ted <br><br></td></tr></table><br>
<a name="197730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> put the cls inside the loop <br><br></td></tr></table><br>
<a name="197734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the idea skidracer, but I'm afraid putting the cls inside the loop would defeat my purpose (I tried it just to be sure and yes, it does).<br><br>The program I am creating generates various effects on the screen.  With each press of the spacebar (or key other than Esc), the user can ADD to the previous effects.  Putting the cls inside the loop just erases everything to a clean slate.<br><br>Ted <br><br></td></tr></table><br>
<a name="197736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> In windowed mode there isn't really a seperate front and back buffer.  To solve your problem just remove the Flip command. <br><br></td></tr></table><br>
<a name="197738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> OH!<br><br>I think I just came up with a solution. If I add a second Flip AFTER the WaitKey like so ...<br><br>-----------------------------------<br>Graphics 1024,768<br>SetBuffer FrontBuffer() <br>Cls<br>While Not KeyHit(1) <br>  Color Rand(1,255),Rand(1,255),Rand(1,255)<br>  Oval 200+Rand(1,50),350+Rand(1,50), 5,5,1<br>  Delay 100 <br>  Flip<br>  WaitKey<br>  Flip<br>Wend<br>-----------------------------------<br>... then it works fine with or without debug on.  The only difference is that it does blank the screen and then bring it back with debug off, but I can live with that.  For this particular application, it might even be a good thing.<br><br>I'm still curious about the hows and whys (and this behaviour is particular to Windows XP) - Supposedly one can draw directly to the frontbuffer, but I haven't seen it so far.  Oh well, I'm learning.<br><br>Ted <br><br></td></tr></table><br>
<a name="197739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;&gt; In windowed mode there isn't really a seperate front and back buffer. To solve your problem just remove the Flip command. &lt;&lt;<br><br>Doesn't work for me, MasterBeaker - If I do that I don't see anything but a blank screen until I hit the Esc key (and not even then if debug is on).<br><br>Fortunately, adding the second Flip command solved the problem. <br><br></td></tr></table><br>
<a name="197746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> AhHa, from the blitzplus user guide (migrating to blitzplus section):<br><br><div class="quote"> <br>All graphics are now double buffered, so you must use Flip or FlipCanvas to show any rendering. <br> <br></div><br><br>Sorry, this has been a waste of time for you, the FrontBuffer() command should have been more obviously deprecated. <br><br>Also, your double flip cludge is not guaranteed to work on all machines as many 3D cards are set to triple buffering by default. <br><br></td></tr></table><br>
<a name="197771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Augh!!!  Well, thanks Skidracer.  Better to find out about the potential triple buffering problem now than (the hard way) later.<br><br>I guess I could try grabbing the whole screen after each update and then copying it to the backbuffer prior to the next drawing operation - Seems like it should be possible to just incrementally update the backbuffer somehow though.<br><br>And not a waste of time for me, just a "Learning Experience" :) <br><br></td></tr></table><br>
<a name="197785"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, here's solution #2:<br><br>-------------------------------------<br>Graphics 1024,768<br>ScreenHolderHandle=CreateImage(1024,768) <br>While Not KeyHit(1) <br>    SetBuffer ImageBuffer(ScreenHolderHandle) <br>  Color Rand(1,255),Rand(1,255),Rand(1,255)<br>  Oval 200+Rand(1,50),350+Rand(1,50), 5,5,1<br>  SetBuffer BackBuffer() <br>  Cls<br>  TileImage ScreenHolderHandle,0,0<br>  Delay 100 <br>  Flip<br>  WaitKey<br>Wend<br>-------------------------------------<br> <br>This seems to work with or without debug, doesn't produce any flicker, and (I presume) will not be a problem for those with #D cards set to triple buffering. <br><br></td></tr></table><br>
<a name="197961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >makakoman</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @PT, I think that solution is going to be dog-slow.  It really should work by writing to the backbuffer and using flip.  Do the example programs work for you?  What version of BB are you using?  Are you running windowed or fullscreen?  If the example programs work on your machine, I would start from there.  If not, then you need to check your graphic drivers or test it on another machine.  Something's not right.<br><br>Good luck,<br>MK <br><br></td></tr></table><br>
<a name="198069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, the frontbuffer in BlitzPlus is definately not usable. <br><br></td></tr></table><br>
<a name="198070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProgrammerTed</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, MK, speed is not much of a problem for that particular application, at least not on my machine (1.7 ghz), but of course I am concerned with speed for other programs (as well as potential other users of this one on slower machines).<br><br>I am running BlitzPlus ver 1.11, which I believe is the current version.  Most of my test programs start with "Graphics 1024, 768" which I presume is considered running in full screen mode (it's what I have my screen res set to anyway).<br><br>As for the example programs, they work more or less with two caveats:<br><br>(1) They usually seem geared towards getting something on the screen and that's it, whereas what I have been doing is drawing some graphics on the screen, pausing for the user to press a key, and then adding more graphics WITHOUT erasing the first graphics, etc.<br><br>(2) As Skidracer was kind enough to point out:<br>"All graphics are now double buffered, so you must use Flip or FlipCanvas to show any rendering." - I think some of the examples were created prior to that being true and thus do not work the same way they once did.<br><br>All of the games that came with Blitz Plus seem to work fine for me, so I don't think my drivers are too bad.  Thanks for the idea of trying it on another machine though.  I'll try a small exe on my mom's computer (which used to be mine) this weekend.<br><br>In the meantime if you (or anyone) would be kind enough to  paste the following into BlitzPlus and try to run it (with debug NOT enabled), I would be very interested to see if you get the same results as me.  What I would be AIMING for would be for the first line to display, then after the user hits a key the second line displays (without the first one disappearing!)   What DOES happen is that when the second line displays, the first one disappears.<br><br>----------------------------------<br>Graphics 800,600<br>Cls<br>SetBuffer BackBuffer() <br>Line 100,50,500,55<br>Flip<br>Delay 200<br>WaitKey<br>Line 100,70,500,55<br>Delay 200<br>Flip<br>WaitKey <br><br></td></tr></table><br>
<a name="209753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Psycoach</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just had exactly the same kind of problem like you : a character is walking in my game, and when the level is won, my character stops and look at the player... in debug mode.<br>I "real" mode, the level stopped as the character was walking still (one frame behind ?)...<br><br>THAT was a real fight before I have the idea to look here and finaly find your post!...<br><br>It seems to work now, but I am not completely satisfied, because I haven't understood the reason of this different behaviour in debug and real mode... :-(<br><br>So my questions to the Blitz-experts :<br>- what is the best thing to do to avoid those discrepancies between debug and real modes<br>- is this problem XP related (I use XP pro) and/or graphic cards related<br>- I use Blitz2D now, but I will buy Blitz3D : is it the same for Blitz3D ?<br><br>Thanks a lot in advance ! <br><br></td></tr></table><br>
<a name="211527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Debug mode has error-trapping engaged.  It runs the code slower, but is more likely to catch a bug so that your cpu doesn't crash.  "Real" mode does not have this "safety net", so it runs faster; it throws the requirement to have crash-free code on you, the programmer.   Maybe you can work out a compromise: try new code in debug mode.  If it does not crash your computer, then switch off the debug so you can run your prog in "real" mode. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
