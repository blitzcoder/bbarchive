<!DOCTYPE html><html lang="en" ><head ><title >Rotation Problems</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Rotation Problems</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Rotation Problems</a><br><br>
<a name="464894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Black Hydra</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've looked over this code for awhile now and I can't figure out what I've done wrong.  Obviously my formula I am using isn't good as this code just doesn't work.<br><br>I'm trying to get the camera (attatched to the camerapivot entity) to stay behind the object, but I want it to reach that point slowly, that is, I don't want it locked behind my object.  The code works fine, except when my object and my camera are in a particular angle range and then everything screws up.  I assume this angle range is when one object is close to 360 and the other is close to 0 as in:  Object Angle = 359,  CameraPivot Angle = 2.  I've tried many different means to get them to round inbetween these values but I still have the same problem.<br><br>If anyone knows of a good way to have the camera follow behind an object with some speed lag then be my guest.  If you know what I've done wrong in my formula's then I'd be even more grateful.  <br><br>Here is the movement code as is:<br><br>  M# = User\Manuever<br>  ;Movement style using mouse speed rather than position <br>  YAng# = WrapAngle(EntityYaw(User\ObjectNum)-M#*MouseXSpeed())<br>  XAng# = WrapAngle(EntityPitch(User\ObjectNum)+M#*MouseYSpeed())<br>  If XAng# &gt; 70 And XAng# &lt; 180 Then XAng# = 70<br>  If XAng# &lt; 290 And XAng# &gt; 180 Then XAng# = 290<br>  PitchAverage# = ((EntityPitch(User\ObjectNum)*.5)+(EntityPitch(User\CameraPivot)*1.5))/2<br>  YawAverage# = ((EntityYaw(User\ObjectNum)*.5)+(EntityYaw(User\CameraPivot)*1.5))/2<br>  ;You must also take the possible negative average of the value if the shortest distance would cross <br>  ;the 360//0 degree connection<br>  If EntityPitch(User\CameraPivot) &gt; 180<br>   NPitchAverage# = ((EntityPitch(User\ObjectNum)*.5)+(EntityPitch(User\CameraPivot)-360)*1.5)/2<br>  Else<br>   NPitchAverage# = ((EntityPitch(User\ObjectNum)*.5)+(360-EntityPitch(User\CameraPivot))*1.5)/2<br>  EndIf<br>  If EntityYaw(User\CameraPivot) &gt; 180<br>   NYawAverage# = ((EntityYaw(User\ObjectNum)*.5)+(EntityYaw(User\CameraPivot)-360)*1.5)/2<br>  Else<br>   NYawAverage# = ((EntityYaw(User\ObjectNum)*.5)+(360-EntityYaw(User\CameraPivot))*1.5)/2<br>  EndIf<br>  ;Run a check to see if these negative alternate values are more reasonable<br>  If Abs(PitchAverage#-EntityPitch(User\ObjectNum)) &gt; 180 Then PitchAverage# = NPitchAverage#<br>  If Abs(YawAverage#-EntityYaw(User\ObjectNum)) &gt; 180 Then YawAverage# = NYawAverage#<br>  RotateEntity User\ObjectNum, XAng#, YAng#, 0<br>  RotateEntity User\CameraPivot, WrapAngle(PitchAverage#), WrapAngle(YawAverage#), 0<br>  If KeyDown(2) Then DebugLog "YAng: "+YAng#+" YawAvg: "+YawAverage#<br>  ;Set the rotation vector to the current orientation<br>  User\Rotation = AngToVect(WrapAngle(YAng#-90), XAng#, User\Rotation) <br><br></td></tr></table><br>
<a name="464900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>If anyone knows of a good way to have the camera follow behind an object with some speed lag then be my guest.<br> <br></div><br><br>Fix a pivot behind your player and have the camera follow that while looking at the player (camera could have its own pivot which continually points at the trail pivot). If your camera cannot "see" the player then jump it to the trail pivot because it means it may have got snagged on something (I take it you don't want it floating through walls).<br><br>That would be my thinking. <br><br></td></tr></table><br>
<a name="464902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Black Hydra</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> That isn't really my problem.  I have a method that provides the camera to lock onto the player.<br><br>I also have a method that allows me to have some speed lag so that it isn't constantly locked to the player.<br><br>My problem is that when the object hits these odd angle values like 359 and 2 it finds the new camera angle to be something like 256.  I have tried getting the negatives of the angles and using them as a method to get the true angle average, but it isn't working.<br><br>So if you have some code examples, or perhaps know of a method to get averaging of a circular number set (i.e. angles) that would solve my problem.<br><br>Thanks anyways, though. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
