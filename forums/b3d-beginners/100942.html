<!DOCTYPE html><html lang="en" ><head ><title >normal of a triangle of a skinned animated mesh</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >normal of a triangle of a skinned animated mesh</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >normal of a triangle of a skinned animated mesh</a><br><br>
<a name="1195948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello,<br><br>Do you know if the normal of a triangle of a skinned animated mesh is recalculated each frame ?<br>I guess that yes because some vertices may change their positions and thus the triangle will change its shape and its orientation.<br><br>So i guess that there is not point to try to precalculate the normals of the triangles of a skinned animated mesh because i will need to recalculate it each frame if the mesh is animated (most of the time it is...)<br><br>I will do some tests, but if you know, please let me know.<br><br>Thanks, <br><br></td></tr></table><br>
<a name="1195949"></a>

<a name="1195950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another question related to the previous one please :<br><br>If a mesh is not skinned, not animated, but its orientation changes, then all the normals of all the triangles have to be recalculated even if the mesh has not changed its shape ?<br><br>I am not sure, on one side i think that the normals of the triangles of the mesh have not changed locally but globally they have, and for vertex lighting, it is important to consider this.<br><br>I ask this because i am trying to create a custom vertex lighting system.<br><br>Thanks, <br><br></td></tr></table><br>
<a name="1195956"></a>

<a name="1195957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Do you know if the normal of a triangle of a skinned animated mesh is recalculated each frame ? <br></div><br><br>Triangles don't have normals (as far as the engine is concerned - obviously a mathematical one exists); normals are a property of vertices. The vertex normals are internally translated and rotated for lighting in exactly the same way as their positions.<br><br>Since there's no way to get the calculated vertex position and normal out of the system again, this is pretty much meaningless info - you'll need to manage the skinning yourself in Blitz code if you want to keep track of vertex positions in order to work out the triangle normal.<br><br><br><div class="quote"> If a mesh is not skinned, not animated, but its orientation changes, then all the normals of all the triangles have to be recalculated even if the mesh has not changed its shape ? <br></div><br><br>1) as above, triangles do not have normals<br><br>2) recalculating a vertex's global normal vector for lighting purposes is one of the things that's done entirely in hardware. You give DirectX a mesh with local normals and tell it the mesh's orientation in global space, and it does the magic itself (exactly the same as it would for vertex position). The global normal vectors (and vertex positions) never even exist on the CPU.<br><br>This also means that doing this in software might incur a major performance penalty, since it's something the system wasn't doing before.<br><br><br>I'm not sure I really understood the questions but you might find what you're looking for by browsing through the code of an existing engine: miniB3D should show you how to recalculate vertex position and normal data (or you could look at bOGL, which is simpler but still demonstrates lighting and skinning).<br><br>If you want to do anything particularly exotic with the lighting, you may need to work with an engine that lets you use vertex shaders, though. <br><br></td></tr></table><br>
<a name="1195975"></a>

<a name="1195976"></a>

<a name="1195977"></a>

<a name="1195978"></a>

<a name="1195979"></a>

<a name="1195980"></a>

<a name="1195981"></a>

<a name="1195999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Yasha, i understand what you mean, my questions should have been about vertices normals instead of triangles normals.<br><br><div class="quote"> <br>The vertex normals are internally translated and rotated for lighting in exactly the same way as their positions.<br> <br></div><br>As i understand, a vertex normal is recalculated depending on its vertex position and depending on the position of the other vertices composing the triangles which use this vertex. <br>So the vertices normals of a skinned animated mesh will have to be recalculated each frame. Ok.<br><br><br><br><div class="quote"> <br>recalculating a vertex's global normal vector for lighting purposes is one of the things that's done entirely in hardware. You give DirectX a mesh with local normals and tell it the mesh's orientation in global space, and it does the magic itself (exactly the same as it would for vertex position). The global normal vectors (and vertex positions) never even exist on the CPU.<br> <br></div><br>Ok that's what i thought. The global vertices normals are calculated by the Blitz3d engine. (or by Direct3d ?)<br><br><br><br>Another question please :<br>If i use Minib3d, is there a way to change the way each normal is calculated and how the light affects each vertex ? I mean to modify the instructions of OpenGL so that the OpenGL always calculates the vertex lighting this way (like if i wa able to modify how Direct3d calculates the vertex lighting).<br>I guess that Minib3d uses the same lighting equation than Blitz3d ?<br><br>Thanks, <br><br></td></tr></table><br>
<a name="1196023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If i use Minib3d, is there a way to change the way each normal is calculated and how the light affects each vertex ? I mean to modify the instructions of OpenGL so that the OpenGL always calculates the vertex lighting this way (like if i wa able to modify how Direct3d calculates the vertex lighting). <br></div><br><br>There are <i>some</i> things you can change. Since miniB3D (like B3D) does its skinning in software, you can change te way bones affect vertices, for instance. There are several different lighting formulas for you to use too.<br><br>This depends a huge amount on what you want to achieve though. OpenGL 1.1 is like DirectX7: fixed pipeline only. You can do some imaginative things by moving vertices around but it's fundamentally quite limited. For a truly <i>different</i> lighting engine you'll still need to be able to use shaders, which aren't made available in miniB3D either.<br><br>E.g. Using miniB3D, you can change the way bones scale normals or where they point; using shaders, you can ditch the concept of a normal altogether and use something completely different to control your lighting. <br><br></td></tr></table><br>
<a name="1196047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to finish a complex 3d game with Blitz3d first, so i guess i will have to play with vertex normals and vertex colors to achieve the lighting i want.<br><br>But then i will have to take a look at shaders.<br>Thanks for the infos, :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
