<!DOCTYPE html><html lang="en" ><head ><title >Sin and Cos Slow?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Sin and Cos Slow?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Sin and Cos Slow?</a><br><br>
<a name="270276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> If i use these ever frame, will it be slower than storing a precalculated array of values. Slower as in being worth while to do it because any good-ish speed boost :) <br><br></td></tr></table><br>
<a name="270308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, it will definitely be slower.<br><br>However, whether it's "worth it", it will depend on your program and target platform as to whether you'd want to use a lookup table versus calculating the values in realtime.<br><br>If you call it a lot, I would say it would behoove you to use lookup tables.  It's not hard, it's accurate enough, and it's faster.  What could be wrong with that?<br><br>Alternatively, you can just use the Sin and Cos commands, see if it's fast enough for your needs, then change it later if you want. <br><br></td></tr></table><br>
<a name="270325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Measure, measure and measure again.  There is no point in implementing things like lookup tables and other optimizations if that isn't what's slowing your program down.<br><br>It's like spending hours tweaking the starter on your car.  If it starts up like lightning but runs like crap, was it time well spent? <br><br></td></tr></table><br>
<a name="270342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, cool, thanks. This is all for the single surface stuff. I use that to rotate my particle, and it gets called very often. Just trying to pack as many optimisations in as possible. And i was a bit lazy to test the speed :) Thanks for your replys. appreciated! <br><br></td></tr></table><br>
<a name="270352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matt2222</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use a lookup table like soja said.<br><br>Try this:<br>dim sintable#(360)<br><br>for x = 1 to 360<br>sintable(x) = sin(x)<br>next<br><br>then, later in your code, use sintable(60) instead of sin(60).  It ends up being much faster.<br><br><br>-Later <br><br></td></tr></table><br>
<a name="270357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> IMHO it's almost completely pointless on a reasonably modern processor (say, 400MHz+); you don't generally use tight loops like the above in a real game, and will usually have more than enough spare processor time per frame so that pre-calc'ing isn't worth the effort. <br><br></td></tr></table><br>
<a name="270373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> well, i'm gonna have maybe 300 odd particles going on at the same time, and looping thru them once every frame to rotate them and stuff. Maybe save some fps by updating once ever 2 frames or something. I'll tryy both methods for speed :) thanks again! <br><br></td></tr></table><br>
<a name="270382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, your right James. It doesn't seem to be any slower. It is slower if you call it 100,000 times compared to using a lookup table, but that's not a true test. <br><br></td></tr></table><br>
<a name="270479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Most of the old optimizations are somewhat pointless on todays PCs ... unrolling loops, look up tables, fixed point math, etc.  These things are still recommended to people on forums but I think it's more out of knee jerk reflex than any kind of actual thoughr process or testing. <br><br></td></tr></table><br>
<a name="270511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >podperson</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Optimizing techniques are *always* worthwhile if they're applied to the *right* piece of code. The point is you need to figure out what to optimize. Optimizing for its own sake just makes your code worse.<br><br>That said, Blitz could use profiling tools ;) -- not a priority, it's easy enough to roll your own. <br><br></td></tr></table><br>
<a name="270515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Michael Reitzenstein</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, if only there was a preprocessor that had a code profiling option. <br><br></td></tr></table><br>
<a name="270521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> [q]Optimizing techniques are *always* worthwhile if they're applied to the *right* piece of code.[/q]<br>Yes, but my point is that optimization techniques DO go out of style and usefulness.  Things like look up tables are becoming less and less useful with todays processors.<br><br>So, as podperson said, determine if the piece of code you're looking at is slow to begin with.  After that, carefully consider if it's executed often enough to be worth optimizing.  THEN start looking into techniques. <br><br></td></tr></table><br>
<a name="270524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Codemonger</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Optimizations are they key to a fast game ... I remember playing quake 3, five years ago (I think) ... I don't recall seeing 3ghz systems out at that time, and yet I haven't seen anything like quake 3 yet done in blitz.<br><br>So if anyone tries telling you that optimizations are irrelevent because of processor speed, I wouldn't waste my time listening to them. I would waste it on optimizing :) <br><br></td></tr></table><br>
<a name="270526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Codemonger</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok maybe not five years ago, but anyway, I think optimization is always a key factor regardless of how fast your target system is. Anything that saves on CPU time is always great.  Then you can spend more CPU time on more important things such as path finding for AI ... <br><br>  Just remember as system specs. grow that means more ram, and more ram means larger lookup tables, so why not use them if you can ? <br><br></td></tr></table><br>
<a name="270643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you even reading what I'm writing? <br><br></td></tr></table><br>
<a name="270647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Michael Reitzenstein</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So if anyone tries telling you that optimizations are irrelevent because of processor speed, <br></div><br>Did you hear EpicBoy say that? The fastest methods of doing things usually stop being the fastest with new technology. Things like lookup tables save infinitisimal amounts of time on older CPUs, and are *SLOWER* on new CPUs. <br><br>You would be much better off looking at why your game has to call Sin/Cos millions of times a second rather than speeding up the calls themselves, ie optomising your algorithm rather than its implementation. <br><br>And Sin/Cos lookup tables isn't the only thing that is out of date anymore, far from it, it is just a classic example. <br><br></td></tr></table><br>
<a name="270659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, from my tests, i'd say there is absolutly no real difference between the two. Tried setting up a loop with a fps counter and doing 700 sin calculations and 700 ones using a lookup table. Didn't see any fps difference. Tried using millisecs to see how long say 5000 sin calculations took, then seeing how long 5000 lookup table calculations took. No noticable difference.<br><br>So sorry for wasting your time with this question when i could have easily done the test myself. ^_^ <br><br></td></tr></table><br>
<a name="270673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is all pretty interesting to me.  This is really the first time I've paid much attention to this kind of optimization.  (I haven't really felt the need to do any actual tests yet.)<br><br>Why do you suppose that they take the same amount of time?  Are the values calculated once and then just stored in L2 cache for quick retrieval? <br><br></td></tr></table><br>
<a name="270695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a 2700+ Athlon XP and Sin and Cos lookup tables are considerably faster with my single surface stuff. More so if you can precalculate the multiplier too, but even without that, it's a worthwhile optimisation and takes about 5 minutes to do. <br><br></td></tr></table><br>
<a name="270735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> How many times are you calling your lookup tables per frame? <br><br></td></tr></table><br>
<a name="270771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Codemonger</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok sorry guys, I was a little hard on the optimization bit, had a long night Saturday night at a wedding, still feeling the effects. :)<br><br>  To do massive number crunching with super high end cpu's for testing purposes is almost irrelevent, because the amount of cpu cycles the processor can do in a second is huge ... but remember when you have other things in your game that start to slow things down like traversing a bsp tree, a quadtree, a surface, or hiding/unhiding objects etc. then those massive amounts of cpu cycles get eaten up pretty quick.  <br><br>  You are then left with little cpu cycles compared to what you have started with and that is where lookup tables help out, so you can spend those cycles doing other things like AI, hit detection, physics etc..<br><br>  @Michael: Agreed their are better ways, but Jokers question was about sin/cos and if a lookup table offered any speed increase.  Otherwise you are right, maybe we could help joker optimize his code by reduction of code, and un-needed code. <br><br></td></tr></table><br>
<a name="270772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you wanna help me out :o) go here:<br><br><a href="http://www.blitzbasic.com/bbs/posts.php?topic=25932" target="_blank">http://www.blitzbasic.com/bbs/posts.php?topic=25932</a><br><br>thanks! <br><br></td></tr></table><br>
<a name="270888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> How many times are you calling your lookup tables per frame? <br></div><br><br>It was for a set of functions rather than a game. I tested it with a few hundred vertices, each requiring, I guess six calls to the lookup tables.<br><br>Then I cranked it up so high it was creating more than 65535 vertices at one point ( which is the DirectX per-surface vertex limit, I believe )<br><br>It was worth doing in either case. That's not to say there aren't better ways to do this. But it's still worth doing, and I've yet to find any high end PC for which it was slower. I tested on a lot of different machines. <br><br></td></tr></table><br>
<a name="270930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, well i'm working on some optimsations that will be instantly visible, and the  i'll try out the different moethods once its all integrated into the game :) Thanks! <br><br></td></tr></table><br>
<a name="271308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Loocipher</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've only found two things that actually slow down anything I write.<br><br>1. Lots of maths (such as Picks, TerrainY#(), TForms) in long loops (hundreds or thousands per frame).<br>2. Rendering loads of little fiddly objects or objects with funny blending modes (alpha &lt; 1, add/multiply blending).<br><br>The second one is generally by *far* the worse problem. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
