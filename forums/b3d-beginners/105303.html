<!DOCTYPE html><html lang="en" ><head ><title >File not found - possible bug in Readfile/Openfile</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >File not found - possible bug in Readfile/Openfile</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >File not found - possible bug in Readfile/Openfile</a><br><br>
<a name="1282410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rocys</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi there,<br>I'm having a problem which drives me crazy. I'd appreciate any help. Please excuse my poor english.<br><br>My program is supposed to download a bunch of files (around 2.500) from the web (works finde with CURL). The files are analyzed then via readfile.<br><br>It works pretty well for a while. But as soon as a certain number of files is analyzed, the program seems to not be able to open any new streams. Readfile allways returns 0. <br><br>The strange thing is: Filytype returns 1.<br><br>The streams are definetely closed. To make sure, I added a little code that closes the streams right before opening a new one:<br><br>[Code]<br><br>If ProfilStream&gt;&lt;0 Then<br>   CloseFile ProfilStream<br>   ProfilStream=0<br>End If<br>            <br>ProfilStream=ReadFile("temp\"+DatumAktuell+"\profil_"+name+"_profil.txt")<br>            <br>If ProfilStream=0 Then RuntimeError ("Profil nicht gefunden: "+name)+Chr$(13)+"temp\"+DatumAktuell+"\profil_"+name+"_profil.txt"+Chr$(13)+FileType("temp\"+DatumAktuell+"\profil_"+name+"_profil.txt")<br><br>[/code]<br><br>DatumAktuell is a Global. Name is a string which is read from a different file. The error doesn't happen while reading name: the names are right and filetype returns 1. <br><br>The same error happens, when I use openfile instead of readfile. Also, if i manually skip the file which causes the error, the next file will cause the error too.<br><br>I have not the slightest idea what is going on. Can you help me? Thanks in advance! <br><br></td></tr></table><br>
<a name="1282418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a test for you to do if you can reproduce the error.<br><br>Download the files manually.<br><br>Put them in a folder (alll 2,500 of them).<br><br>rename them with a batch program to something simple like 1.txt, 2.txt, 3.txt etc.<br><br>Run your blitz program on that simply something like:<br><br>infile = readfile(filename$)<br>if(infile=0) then runtimeerror("your message")<br>closefile infile<br><br>see if the problems happens....<br><br>I've never had an issue with it before however the problem may lie somewhere else in your code - for example if you are chewing up memory then you may get to a point where there is insufficient memory to open another file although you can verify its existence. Unlikely if things are done correctly unless you have a memory leak somewhere else. <br><br></td></tr></table><br>
<a name="1282428"></a>

<a name="1282429"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah you're maxing-out your memory, just like Matty said. May be better to throttle back the amount of files downloaded at any one time, proccess and then close them one at a time, then repeat until all files are downloaded and dealt with. <br><br></td></tr></table><br>
<a name="1282467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rocys</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you guys - you showed me the right direction.<br>Problem is solved. <br><br>During the loop I was not only reading the 2.500 files but also writing the results of the analysis into new files. Guess what: I forgot to close the streams from the writefile... My guess is that blitzbasic shuts down, when 1024 streams are open. I corrected the code and now it works.<br><br>Thanks again and sorry for bothering you with my inattention... <br><br></td></tr></table><br>
<a name="1282543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad it is fixed. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
