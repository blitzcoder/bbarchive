<!DOCTYPE html><html lang="en" ><head ><title >character home attack not working?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >character home attack not working?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >character home attack not working?</a><br><br>
<a name="1013237"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My player for some reason cannot tell which robot is which if there are 2 robots which are next to each other, and when within a certain distance, home attack and destroy the robot. and my player won't turn at the angle he's automatically homing attacking into he instead has the same yaw angle yet still gets automatically homed in on the object. the pickmode of the player is set to polygon (2), and obscurer is true. a1\Motion\Speed x,y,z are the speeds he is running or homing at. the pick is an attempt to make him see EXACTLY what is in front of him. the point entity points him in the direction of the robot. and the a1\homing is when he is in actual home attack mode. also, when he DOES home attack, he circles AROUND the enemy, rather than follow the enemy no matter what x,y,z the enemy is at. how can i fix this?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">For a1.tPlayer = Each tPlayer
For o1.tObject = Each tObject
If o1\Objtype = OBJTYPE_ROBOT

rpick=EntityPick(o1\Entity,Range)

If EntityDistance(a1\Objects\Entity,o1\Entity) &lt;= 500 And (a1\Action = ACTION_HOMING)

If rpick

IsAttacking = True
		
HideEntity a1\Objects\Mesh_HomingAura

a1\Motion\Speed\x# = 1
a1\Motion\Speed\y# = 0
a1\Motion\Speed\z# = 1

PointEntity a1\Objects\Entity,o1\Entity

EndIf

EndIf

EndIf

Next
Next</textarea> <br><br></td></tr></table><br>
<a name="1013253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> *Scratches head* Can you simplify the problem your having? I couldn't really make too much sense out of the description. <br><br></td></tr></table><br>
<a name="1013255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> well, basically when the player home attacks, and he is within a certain distance of the enemy, he should search for ONE ENEMY ONLY the closest one that is in front of him EVEN IF there are 2 or more NEXT to that robot, then he should point AND rotate towards the enemy that was chosen, and when he comes within a certain range, blow up the enemy, bounce after destroying the enemy, bounce by 2 units, and allow for a 2nd attack if there is 2 or more robots nearby. think of it as the character finding his enemy with his site, pointing AND rotating towards him, and heat-seeking his target until his target explodes, then basically allowing for another home attack IF any other enemies are nearby, and pointing towards the closest 1. <br><br></td></tr></table><br>
<a name="1013369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's alot of code to write for that. It's not exactly a problem, more like you want someone to write a big chunk of code. Do you have any more code, or, is that all you have? <br><br></td></tr></table><br>
<a name="1013382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> that is all i have. i already wrote the code TO home attack. just not to target the enemy closest. <br><br></td></tr></table><br>
<a name="1013390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Add in a clause to your If statement for "Not(IsAttacking)" then Exit before the first EndIf<br>This should ensure that the iteration stops once the first valid candidate is found. <br><br></td></tr></table><br>
<a name="1013434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks malice, its working now i think..... <br><br></td></tr></table><br>
<a name="1013436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok how would i figure out if my player is LOOKING AT the enemy? <br><br></td></tr></table><br>
<a name="1013456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> EntityInView ? <br><br></td></tr></table><br>
<a name="1013457"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> i mean, not if its in view, if the player is actually turned TOWARDS the enemy? <br><br></td></tr></table><br>
<a name="1013460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then use DeltaYaw and see if the result is wider than x degrees. Where x is based on a ratio between the CameraZoom and the EntityDistance, like parallax. <br><br></td></tr></table><br>
<a name="1013510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use TFormNormal to see if one entity is pointing towards another...<br><br>;robot = robot being looked at<br>;me = the thing doing the looking<br><br>TFormNormal entityx(robot)-entityx(me),entityy(robot)-entityy(me),entityz(robot)-entityz(me),0,me<br><br>;this works out the normalised vector (ie direction only) from 'me' to 'robot' in "me's" space.<br><br>if tformedz()&gt;0.7 then <br>    ;robot is in the front 90degree arc of me...<br>endif <br><br>;tformedz()&gt;0 means in front 180 degree arc,<br>;tformedz()=1 means 'dead in front'...not that useful as highly unlikley.<br>;tformedz()&lt;0 means in rear 180 degree arc. <br><br></td></tr></table><br>
<a name="1013597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> where did u get 0.7? <br><br></td></tr></table><br>
<a name="1013605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> here is what i got: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">		;Homing Attack!

For p.tPlayer = Each tPlayer
For o.tObject = Each tObject
If o\Objtype = OBJTYPE_ROBOT

	If EntityDistance(p\Objects\Entity,o\Entity) &lt;= 70.0 And (p\Action = ACTION_HOMING)
	
	xx# = EntityX(p\Objects\Entity)
	yy# = EntityY(p\Objects\Entity)
	zz# = EntityZ(p\Objects\Entity)
	
	rx# = EntityX(o\Entity)
	ry# = EntityY(o\Entity)
	rz# = EntityZ(o\Entity)
	
	rrxx# = rx#-xx#
	rryy# = ry#-yy#
	rrzz# = rz#-zz#
	
	IsAttacking = True

	If Not IsAttacking
	Exit
	EndIf

	If IsAttacking
			
	;if me facing the robot of choice
	
        TFormNormal rrxx#,rryy#,rrzz#,0,p\Objects\Entity

        If TFormedZ()&gt;0.7 Then
        ;robot is in the front 90degree arc of me...

   	    PointEntity p\Objects\Entity,o\Entity

	    p\Motion\Speed\x# = 0
	    p\Motion\Speed\y# = 1
  	    p\Motion\Speed\z# = 7
	
	    HideEntity p\Objects\Mesh_HomingAura

	    EndIf

	EndIf
		
	EndIf

EndIf

Next
Next</textarea><br><br>is this correct for when the me model is looking straight at the robot, within a few degrees? <br><br></td></tr></table><br>
<a name="1013610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> 0.7 represents a ratio value, the vector angle from the player to the target in this case, is within 3 tenths of facing dead-on. This is effectively 30 Gradiens or 180/10 * 3 = 54 degrees either side of 'dead-on).<br><br>The following should show this relationship:<br><br><pre class=code>
Graphics3D 1024,768,32,6
SetBuffer BackBuffer()

SeedRnd MilliSecs()

AmbientLight 100,100,160
Global Sun=CreateLight()

PositionEntity Sun,-20,20,40

Global Cam=CreateCamera()

Global P1=CreateCone(3)
ScaleMesh P1,1,2,1
RotateMesh P1,90,0,0
EntityColor P1,255,32,32

Global P2=CreateCone(3)
ScaleMesh P2,1,2,1
RotateMesh P2,90,0,0
EntityColor P2,32,255,32

PointEntity sun,Cam

	;Put the pointers at random locations
PositionEntity P1,Rand(-5,5),0,Rand(3,15)
PositionEntity P2,Rand(-5,5),0,Rand(3,5)

	;Red P1 Is rotated about Y Axis
TurnEntity P1,0,Rand(360),0,True
	
	;Green P2 Is facing P1
PointEntity P2,P1

While (Not (EntityInView(P1,Cam) And EntityInView(P2,Cam)))
	;Position camera so both opinters are visible
	MoveEntity Cam,0,0,-1
Wend

MoveEntity Cam,0,4,-5
PointEntity Cam,P2

While Not KeyDown(1)

	;Rotate P1 with the arrow keys &lt;- and -&gt;
	TurnEntity P1,0,(KeyDown(205)-KeyDown(203))*5,0,True

	UpdateWorld
	RenderWorld


	Color 255,0,0
	; Get the Normal vector between P2 and P1s' orientations
	TFormNormal EntityX(P2)-EntityX(P1),EntityY(P2)-EntityY(P1),EntityZ(P2)-EntityZ(P1),0,P1
	Text 10,20,"Vector Angle Ratio: "+Str(TFormedZ())
	
	Text 10,40,"Equivalent angleoffset: "+Str((Abs(TFormedZ()*180)))

	Flip

Wend
	FreeEntity P1
	FreeEntity P2
	FreeEntity cam
	ClearWorld
	EndGraphics
</pre> <br><br></td></tr></table><br>
<a name="1013657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's what I have: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;Homing Attack on robots!

For p.tPlayer = Each tPlayer
For o.tObject = Each tObject
If o\Objtype = OBJTYPE_ROBOT

	If EntityDistance(p\Objects\Entity,o\Entity) &lt;= 70.0 And (p\Action = ACTION_HOMING)
		
	IsAttacking = True

	If Not IsAttacking
	Exit
	EndIf

	If IsAttacking
	
	xx# = EntityX(p\Objects\Entity)
	yy# = EntityY(p\Objects\Entity)
	zz# = EntityZ(p\Objects\Entity)
	
	rx# = EntityX(o\Entity)
	ry# = EntityY(o\Entity)
	rz# = EntityZ(o\Entity)
	
	rrxx# = rx#-xx#
	rryy# = ry#-yy#
	rrzz# = rz#-zz#
			
	;if me is facing the robot of choice
	
        TFormNormal rrxx#,rryy#,rrzz#,0,p\Objects\Entity

        If TFormedZ()&gt;0.7 And TFormedZ()&lt;1 Then
        ;robot is in the front 90degree arc of me...

   	    PointEntity p\Objects\Entity,o\Entity

	    p\Motion\Speed\x# = 0
	    p\Motion\Speed\y# = 1
  	    p\Motion\Speed\z# = 7
	
	    HideEntity p\Objects\Mesh_HomingAura

	    EndIf

	EndIf
		
	EndIf

EndIf

Next
Next</textarea><br><br>Is this good if my player needs to see if the robot is within an acute angle of 45 and -45 degrees? in other words, "line of sight" <br><br></td></tr></table><br>
<a name="1013700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> For an angle of 45 degrees either side, the ratio should be:<br><br>((180/10) * x ) = 45<br><br>I'll let you figure it out ;) <br><br></td></tr></table><br>
<a name="1013708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Forget all that math mumbo jumbo.  There's easier ways to do this that has already been stated.  Simply use the DeltaYaw() command.  DeltaYaw will tell you exactly how many degrees entity A would have to be rotated to point directly at entity B.  What this means is that if it returns a value of say 71 degrees, is would be out of your -45 to 45 degree arc, and not visible. <br><br>Here is an example:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800,600
SeedRnd MilliSecs()
SetBuffer BackBuffer()

camera = CreateCamera()
PositionEntity camera, 0,50,0
RotateEntity camera, 90,0,0

Global target_pivot = CreatePivot()					;create a pivot
Global target = CreateSphere(16,target_pivot)		;create a sphere to look at
PositionEntity target, 0,0,20						;move the sphere out 20 units



Global sight = CreateSphere()						;create a sphere to see from
Global eye = CreateSphere(16,sight)					;place an eye to tell which way it's facing
ScaleEntity eye,.25,.25,.25							;scale the eye down
MoveEntity eye, 0,0,1.25							;move it out to make it visible



;--------------------
;LOOP
While Not KeyHit(1)


TurnEntity sight,0,.5,0		;turn the sight to make it interesting

If KeyDown(205) = 1 Then TurnEntity target_pivot,0, 1,0	;right arrow
If KeyDown(203) = 1 Then TurnEntity target_pivot,0,-1,0	;left arrow

Local delta_yaw = DeltaYaw(sight,target)					;this will get the angle to make the sight face the target

RenderWorld
UpdateWorld

Text 0,0,"Angle from sight to target: " + delta_yaw			;text displays 
	If delta_yaw &gt;= -45 And delta_yaw &lt;= 45					;if between -45 and 45
		Text 0,10, "The sphere is in view!"					;it is visible!
	End If 

Flip
Wend

;--------------------
;END LOOP
</textarea> <br><br></td></tr></table><br>
<a name="1013758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> omg! thanks drak! THIS is PERFECT! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
