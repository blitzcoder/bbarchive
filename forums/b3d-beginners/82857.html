<!DOCTYPE html><html lang="en" ><head ><title >Is there a way to get amount of frames in Image?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is there a way to get amount of frames in Image?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Is there a way to get amount of frames in Image?</a><br><br>
<a name="934934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lets say I do:<br>img=createimage(31,31,rand(1,4))<br>how many frames does img have? <br><br></td></tr></table><br>
<a name="934935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
frames=rand(1,4)
img=createimage(31,31,frames)
</pre> <br><br></td></tr></table><br>
<a name="934938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> hehe..Attempt number two!<br>Lets say I do:<br>img=CreateImage(31,31,Asc(Left$(Input$("please enter a number between 1 And 4..."),1))-48)<br>How many frames does img have? :0) <br><br></td></tr></table><br>
<a name="934939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabriel's answer still holds. Just read the amount of frames into a variable before actually creating the image. <br><br></td></tr></table><br>
<a name="934944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I appreciate your efforts to try and give me an answer guys.<br>But... Gabriel did not answer my question.<br>My question was: "Is there a way to get the amount of frames in an Image?" <br>The answer could be: no. (witch I presume)<br>Or perhaps: yes. (unlikely, but perhaps someone found an "easter-egg" or something. Or some kind of workaround?<br>I find it annoyingly strange that we have the commands: imagewidth and imageheight, but not imageframes.<br>If you want to parse the handle of an image to a function, you don't have to supply the width or height neither. <br><br></td></tr></table><br>
<a name="934948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dont see what use such a command would have since you need to specify the number of frames when calling LoadAnimImage. <br><br></td></tr></table><br>
<a name="934952"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, If you create an image you also have to specify the width and height.<br>I don't see a practical difference. <br><br></td></tr></table><br>
<a name="934955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Well, If you create an image you also have to specify the width and height. I don't see a practical difference.  <br></div><br>There's a huge difference. Images can be loaded, in which case you don't have to specify the width or height, and you need some way to retrieve it. Animated images can only be loaded by specifying the number of frames, so there should never be a situation where you don't know how many frames there are in an animated image. <br><br></td></tr></table><br>
<a name="934963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> That doesn't make my point less valid. It sustains the impracticality of the whole.<br>Reasoning like that one could also say that "loadimage" should have the width and height specified, because we need certain dimensions to fit in our 2d-map or other framework.<br>Or, i.o.w. If I can keep track of the number of frames, why cant Blitz?! <br><br></td></tr></table><br>
<a name="934966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> That doesn't make my point less valid. <br></div><br>Sorry, but the fact that there is a practical difference does make your point less valid if your point was that there is no practical difference.<br><br><div class="quote"> It sustains the impracticality of the whole. <br></div><br>Are you using Babelfish? That makes no sense in this context.<br><br><div class="quote"> Reasoning like that one could also say that "loadimage" should have the width and height specified, because we need certain dimensions to fit in our 2d-map or other framework. <br></div><br>No, that would be completely different reasoning. The width and height don't have to be specified, because they are specified in the image. There is only one possible width and height. Number of frames does have to be specified because it is *not* specified in the image. An image of 1024x1024 could include 4 512x512 frames, 16 256x256 frames or endless other combinations. <br><br><div class="quote"> Or, i.o.w. If I can keep track of the number of frames, why cant Blitz?!  <br></div><br>It would be more pertinent to ask if you can keep track of the number of frames, why don't you? Blitz *is* keeping track of the number of frames. If it wasn't your animations would show up all wrong. It just isn't bloating the API with a hundred commands to get things you should already have. There are many, many extra needless functions like this which could be added simply to retrieve data you must already have.<br><br>Seriously, do you need help or are you just looking for an argument over something trivial? If it's the former, I'm happy to take time to help. With the latter, you can play alone. <br><br></td></tr></table><br>
<a name="934972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's how I normally do it, if I have understood what you are after.<br><br><br><pre class=code>

Global image_strip = LoadAnim("tiles.bmp", 32, 32, 0)

anim_size = GetAnimSize(image_strip)

Print anim_size

WaitKey()
End


Function LoadAnim(file$, tile_w, tile_h, first_frame)
	temp_image = LoadImage(file$)
	across = ImageWidth(temp_image) / tile_w
	down = ImageHeight(temp_image) / tile_h
	anim_size = across * down
	anim_strip = LoadAnimImage(file$, tile_w, tile_h, first_frame, anim_size)
	Return anim_strip
End Function


Function GetAnimSize(image)
	frames = 0
	Repeat
		If Not ImageBuffer(image, frames) Then Exit
		frames = frames + 1
	Forever
	Return frames
End Function

</pre> <br><br></td></tr></table><br>
<a name="934983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could have written your own custom image type (including frame counter) in less time than its taken to write this thread. <br><br></td></tr></table><br>
<a name="934984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> GfK... I did think of using a Type, but I thought I would try to be cocky instead. LOL<br><br>Your way does sound better though. <br><br></td></tr></table><br>
<a name="935022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Steve.. your loadanim-function works fine. And I was trying to use Imagebuffer the way you do in GetAnimSize, but I get  a "Image frame out of range" if I try it like that. If it DOES work, it would be my salvation. ;)<br><br>Pardon me for my bad Engrish, my babelfish drowned last night. ;)<br>Let me assure you that my question is meant sincerely. It's just that I have the tendency to annoy people, by criticizing their well meant comments and advice. Sorry about that, for now and for in the future.(it's a bad habit)<br>Not that I didn't mean what I said, because I do... It depends with what assumptions someone takes on a certain problem, that someone else can measure the meaning of his words.<br><br>And so... Up to the problem at hand.<br>I'm working with a few of my friends on a few projects, and the guy that does most of the file-handling and Imagework, return his functions with pointers to banks, in witch he stores all kind of things, including imagehandles. And now we have come to the conclusion that it is necessary <br>to use Anim-images as well... ;/<br>Well... and there you have it. Of course we could rewrite stuff so we would take handles to anim-images into  account, but that would be a LARGE amount of work.<br>Is it silly to do it like this? Yes, but it's a hobby, not a profession. So to have something like Steve's GetAnimSize, would be a great help. <br><br></td></tr></table><br>
<a name="935115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I never thought it was any use but here.<pre class=code>image=CreateImage(width,height,frames)
BufferList=PeekI(image+4) ;pImageBufferList
BufferListEnd=PeekI(image+8) ;pImageBufferListEnd
numframes=(BufferListEnd-BufferList)/4 ;Number of image frames</pre>From: <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1751" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1751</a> <br><br></td></tr></table><br>
<a name="935117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Abomination.<br><br>Thank you for the kind reply, I use them two functions on regular occasions. GfK is a more experienced programmer than me though, and his work is very impressive. <br><br></td></tr></table><br>
<a name="935175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> markcw... That works like a charm! You have my utmost gratitude. Realy!<br>This will save us weeks of work.<br>One 'little' thing though.. your "peekpoke example" only works for me correctly, if I add width and height(when loading "test.bmp") and lower 'UnlockBuffer buffer' to in-between 'endif' and 'While Not KeyDown(1) ;Esc key'<br>Thought I'd mention it...<br>cheers! <br><br></td></tr></table><br>
<a name="935188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice to know it's useful to someone.<br><br>Never noticed the loadimage section doesn't work, oops. The lock/unlock buffer thing is an internal thing, if you don't lock you won't get a valid pointer to the stuff after it. Unlocking straight after worked when I wrote it, but yeah, to ensure the stuff is valid when accessing it unlock after. <br><br></td></tr></table><br>
<a name="935264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is another one of my functions, I sometimes use.<br><br><pre class=code>
Function GetTileCount(filename$, tw, th)
	temp_image = LoadImage(filename$)
	across = (ImageWidth(temp_image) / tw)
	down = (ImageHeight(temp_image) / th)
	count = (across * down)
	FreeImage temp_image
	Return count
End Function
</pre><br><br><br>Usage of the function would be something like....<br><br><pre class=code>
Global anim_strip = LoadAnimImage(file$, tile_w, tile_h, first, GetTileCount(file$, tile_w, tile_h))
</pre> <br><br></td></tr></table><br>
<a name="935450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> An image of 1024x1024 could include 4 512x512 frames, 16 256x256 frames or endless other combinations.  <br></div><br><br>I think you answered your own question right there.<br><br>An image CAN conceiveably contain dozens of different frame counts limited only by your use of them.<br><br>So, an exact frame count is not really possible unless YOU specify frame dimensions. <br><br></td></tr></table><br>
<a name="935471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> normally blitz needs you to tell you how many frames, hence why the first posts were more WTF?<br>and yes an image can have more combinations of frames<br><br>this method only works if you have a constant size of frames throughout the image and when loading the image define the frame size and it will tell you (or itself) how many possible frames can be made<br>but is it in a way still more of a WTF? you have the image you have the number of frames on it, you have animstrip<br>but hey you can program things to seem like there going the wrong way about it or reinventing the wheel, but if it works it works <br><br></td></tr></table><br>
<a name="935543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just wrote this quickly:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Graphics 800,600
SetBuffer BackBuffer()
Global framecnt

animImage = easyLoadAnimImage("mysprite1.png")

Local frame = 0
While Not KeyDown(1)
	Cls
	
	DrawImage animImage,50,50,frame
	frame = frame + 1
	If frame = framecnt Then frame = 0
	
	Flip

Wend
End


Function easyLoadAnimImage(fname$)
	Local begin,cnt
	
	Local temp = LoadImage(fname)
	Local tempbuff = ImageBuffer(temp)
	Local bgColor = ReadPixel(0,0,tempbuff)
	
	Local xs = 8
	Local ys = 8
	Local x,y
		
	Local done = False
	While done = False
		done = True
		x=xs
		While x &lt; ImageWidth(temp)
			For y = 0 To ImageHeight(temp)-1
				If ReadPixel(x,y,tempbuff) &lt;&gt; bgColor Then
					done = False
					xs = xs + 1
					x = 0
				EndIf
			Next
			x = x + xs
		Wend
	Wend

	done = False
	While done = False
		done = True
		y=ys
		While y &lt; ImageHeight(temp)
			For x = 0 To ImageWidth(temp)-1
				If ReadPixel(x,y,tempbuff) &lt;&gt; bgColor Then
					done = False
					ys = ys + 1
					y=0
				EndIf
			Next
			y = y + ys		
		Wend
	Wend

	cnt = (ImageWidth(temp) / xs) * (ImageHeight(temp) / ys)
	FreeImage temp
	
	
	framecnt = cnt
	Return LoadAnimImage(fname,xs,ys,0,cnt)
End Function</textarea><br><br>Seems to work fine for this image:<br><img src="http://goldenstudios.or.id/shared/2dcharactermodel/mysprite1.png"><br><br>Should work for lots of sprite images. It could be improved by:<br>1) ignoring any blank frames towards the end.<br>2) locking buffers and using readpixelfast. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
