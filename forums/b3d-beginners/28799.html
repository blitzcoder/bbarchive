<!DOCTYPE html><html lang="en" ><head ><title >REad *.doc</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >REad *.doc</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >REad *.doc</a><br><br>
<a name="303541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Agamer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to read a word document file ino blitz and get the text contained I know how to open and read files but I wonder how to do it from word! <br><br></td></tr></table><br>
<a name="303559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> hm.. iirc there's no LoadDoc(file$,flags) command yet :)<br><br>I guess you have to find out how the word fileformat works and make your own doc-importer. <br><br></td></tr></table><br>
<a name="303571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ford escort</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> you can find more info about the .doc fileformat at <a href="http://www.wotsit.org/search.asp?s=text" target="_blank"> wotsit's format </a> hope this help you :) <br><br></td></tr></table><br>
<a name="303656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hansie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> An alternative is to convert the word doc into a plain textfile (.txt), which removes all the header info a word doc contains ... <br><br></td></tr></table><br>
<a name="303673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> But then again I wonder why Agamer didn't use notepad orso in the first place.. if he really wants those bold/italic/underlined/font/color things, then converting to .txt doesn't help much here.. <br><br></td></tr></table><br>
<a name="303735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> RTF is an alternative (and easier to code since it's just tags). <br><br></td></tr></table><br>
<a name="304173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >aCiD2</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> rtf is tags? nice :) thats gonna come in handy hehe <br><br></td></tr></table><br>
<a name="304198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Agamer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeh I am using it in a program I'm writing at the moment it already ses .txt but it is still nrrd to be able to resad .doc <br><br></td></tr></table><br>
<a name="304323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Part of the problem of .doc is that Microsoft never fully released all specifications of word files -- which is why 3rd party word processors like Open Office, Word Perfect, etc. all have minor problems with certain documents.<br><br>It is probably a lot easier to use RTF, which is what Microsoft used with Write/Wordpad, and MS Word 2.0.<br>This is a much easier markup language, and has much more complete documentation.<br><br>Anyway, for pretty much any file format description this is the place to go: <a href="http://www.wotsit.org" target="_blank">http://www.wotsit.org</a><br>Hundreds upon hundreds of file format documents can be found there. Great resource. <br><br></td></tr></table><br>
<a name="304621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Agamer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks but I can't find the file format for ms word 200 and above <br><br></td></tr></table><br>
<a name="304623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Huh, that's a lot of file formats, why didn't anybody tell me about that site before I started cracking various formats? Anyway pretty usefull :) <br><br></td></tr></table><br>
<a name="304842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> to my knowledge, Microsoft never released the file format for Word 2000/2003.<br>They don't want people to be able to open them with different programs, they want those people to buy word as well.<br><br>Microsoft simply has too much to lose if other programs like OpenOffice can read/write word documents flawlessly.<br><br>OpenOffice is free. Would you buy Microsoft office for $$extortion$$ if you could get a completely free, legal alternative that can do the same thing? No. and microsoft knows that too, hence they simply don't release the specifications for their document formats anymore.<br><br>Any info on Word 2000/2003 you'll find has been obtained by people painstakingly tring to reverse engineer the document format... and still not perfect.<br><br>bottom line: I don't think that a Word 2000/2003 document viewer in blitz is going to be a realistic expectation... Or in *any* language any time soon, for that matter. <br><br></td></tr></table><br>
<a name="306653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Agamer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ohh I don't want to be able to view it or retain the font/bold/italic/size settings all I want do s read the text some one must of used it my program can import from notpwead text but it would be nice to import documnets <br><br></td></tr></table><br>
<a name="306706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy_A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you just want the text from a Word doc, try this:<br>(it's easier to show you the code than to type in the explanation)<br><br><pre class=code>
Graphics 800,600

SetBuffer BackBuffer()

; Open the file to Read 
filein% = ReadFile("C:\My Documents\Blitz test.doc") 
;Just copied and pasted this code into a Word document

; Loop this until we reach the end of file 
While Not Eof(filein)
 
	GetByte% = ReadByte( filein )
	;count the bytes as you read them in
	count = count + 1

	;The Word doc header is 1,536 characters, so just skip past them
	;BTW, the header length is the same for both Word 97 and Word 2000
	If count &gt; 1536 Then

		;Chr$(13) is the next line character, so print the current line, and reset "Word$" to null
		If GetByte = 13 Then
			Text 0,spacing,Word$
			spacing = spacing + 15
			Word$ = ""
		End If

		;If valid ASCII character then continue adding to Word$
		If GetByte &gt; 31 And GetByte &lt; 128 Then
			Word$ = Word$ + Chr$(GetByte)
		End If

	End If

Wend

Flip

WaitKey()

CloseFile filein

End

</pre><br><br>The straggler characters at the end can be ignored, or I'll leave it to you to figure the rest (cuz I don't know how).<br><br>As you can see in the code, the header data is skipped and any valid ASCII character is concatenated to the "Word$" variable. I haven't checked to see if the length of the "footer" data is the same length for every document, but this may be a way to eliminate the stray characters at the end of the text.<br><br>Andy <br><br></td></tr></table><br>
<a name="307091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Agamer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> With this I stilll get 3 lines of jumbo afterwards <br><br></td></tr></table><br>
<a name="307197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy_A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I know, that's what I said in my previous post.<br><br>Let me think about it a while. (you can too!)<br><br>There's bound to be a way around this. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
