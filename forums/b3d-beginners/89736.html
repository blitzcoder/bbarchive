<!DOCTYPE html><html lang="en" ><head ><title >Faster entity information</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Faster entity information</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Faster entity information</a><br><br>
<a name="1019622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> One way I have stored certain information about entities, such as, mass and elasticity for physical properties, is to use a Type like so:<br><br><pre class=code>
Type PhysObj
Field EntityHandle
Field Phys_Mass
Field Phys_Elast
Field Surf_Friction
Field Aero_X_l
Field Aero_Y_l
Field Aero_Z_l
End Type
</pre><br><br>What I'm wondering, is, if in generlal, simplified cases where there may be a HUGE number of such entities, would it be faster to iterate through the type for the correct entity, or, perhaps, to make use of simething like EntityName() that could store the information in an encoded format, and decode the string?<br><br>Of course string manipulation is comparitively slow, in the case of, first, identifying the srelaevant segments, then decoding the string into the correct value, I am curious to if anyone knows whether this method may be faster than iterating through a huge Type list, containing over, say, 500 entities? <br><br></td></tr></table><br>
<a name="1019631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The common way to associate a particular type instance with an entity is to use Handle() and Object().<br><br><pre class=code>
; Store type handle as entity name.
NameEntity entity,Str$(Handle(this.myType))

; Retrieve type from handle, stored as entity name.
this.myType = Object.myType(EntityName(entity))
</pre> <br><br></td></tr></table><br>
<a name="1019633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Even so, iteration would still be required, even if 'behind the scenes', for both the entity "pointer list" and the Type lists. <br><br></td></tr></table><br>
<a name="1019638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure I follow. If you have the entity, you have the type. No iteration required. <br><br></td></tr></table><br>
<a name="1019641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> In B3D copde, you have <pre class=code>
this.myType = Object.myType(EntityName(entity))
</pre><br>However, on compilation, assuming the machine code would be commpiled similar to C structs, the cpu will still need to iterate through some register to identify the correct address, since there's no metadata compiled with the Types. <br><br></td></tr></table><br>
<a name="1019645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Surely, when calling Object with the integer ID handle, it just retrieves the associated type pointer via some kind of lookup table?<br><br>Maybe I'm just misunderstanding what you mean. <br><br></td></tr></table><br>
<a name="1019653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah i'm sure just retrieves the pointer. Besides, it's fastest way to jump straight to a type object in blitz. I certainly would think parsing a string for this field data would be a good bit slower. <br><br></td></tr></table><br>
<a name="1019655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> it just retrieves the associated type pointer via some kind of lookup table?<br> <br></div><br>Computers CANNOT just look up numbers.<br>Any interaction with tabular information requires starting at the beginning and going through each entry until it reaches the required one.<br><br><div class="quote"> Besides, it's fastest way to jump straight to a type object in blitz. <br></div><br>That's my point, might it be faster to just use the entity and its name, rather than a Type structure? <br><br></td></tr></table><br>
<a name="1019663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Orca</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Computers CANNOT just look up numbers. <br></div><br>Erm, yes they can. Its called a pointer.<br><br>To answer the original question: <br><br>I definitely wouldn't parse a string. If fast searching is needed, you may want to keep references to your types in a dictionary/tree structure of some sort. <br><br></td></tr></table><br>
<a name="1019664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Computers CANNOT just look up numbers.<br>Any interaction with tabular information requires starting at the beginning and going through each entry until it reaches the required one. <br></div>What? You think, for example, accessing a specific array element requires iterating through the entire array until the correct element is reached?<br><br>It's simply a matter of pointer arithmetic. <br><br></td></tr></table><br>
<a name="1019665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bye</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> CANNOT <br></div><br><br>ugh.. <br><br></td></tr></table><br>
<a name="1019669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, all tsorry for the misunderstanding. Yeah I see how it works with Handle() now :) <br><br></td></tr></table><br>
<a name="1019765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> See also hashing and search trees. Iterating through a list is not only not the only way to access data, it's very often a pretty poor way to do it. <br><br></td></tr></table><br>
<a name="1021663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> [quopte]<br> Iterating through a list is not only not the only way to access data, it's very often a pretty poor way to do it. <br>[/quote]<br>Yeah, that was my main reason for posting. Though I hadn't correctly understood how pointers work, which certainly speed things up there.<br><br>As for hashing at least, that's something I have seen and heard a lot about but definitely need to read up on <br><br></td></tr></table><br>
<a name="1023092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, well kinda following on from the above, how "bad" is it to keep switching between, Type objects and handles, or is there really no real difference?<br><br>For example, say I have functions that work in this way:<br><pre class=code>
Function GetInformationA(Instance.MyType)
Return Instance\A_Field
End Function
</pre><br>Is it significantly 'worse' to use:<br><pre class=code>
Function GetInformationA(MyHandle)
Local Instance.MyType=Object.MyType(MyHandle)
Return Instance\A_Field
End Function
</pre><br><br>In theory it should be basically the same, right? <br><br></td></tr></table><br>
<a name="1023095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Everytime you create a handle, you actually increment a counter in blitz. In theory, you could be storing references to objects, that could get over written if you generate enough handles to roll over the maximum value of an integer.<br><br>With regards to your question, i really doubt the actual speed difference matters. <br><br></td></tr></table><br>
<a name="1023102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Ross, memory is important as well as speed, so the counter thing is intriguing. Sure, it's probably unlikely that other memory would be overwritten unless a ridiculous number of separate handles were used.<br><br>Would this counter still increment even if you are re-using the same handle?<br><br>Say, for example, <br><br>Function One(blah)<br>Local ReUseHandle=LoadWhatever(blah)<br>End Funciton<br><br>Function Two(bling)<br>Local ReUseHandle=LoadWhatever(bling)<br>End Function<br><br>[/code]<br>Now imagine calling either or both One() and Two() multiple times, not sure how many, but a lot, perhaps if every time some data needs to be looked at or worked with...<br><br><br>Again, I'm guessing it should be safe enough, since the handle will always return the same value, and naturally would be overwriting itself? <br><br></td></tr></table><br>
<a name="1023124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> The speed difference is about one order of magnitude, so it's negligible if your list is only a few hundred items long, or you're not checking every item every loop. Wouldn't worry about this for 3D entities as the number of 3D objects will slow down your scene long before the Object/Handle operations will!<br><br>Handle() provides a unique integer for every type object (of all types). If LoadWhatever returns the same object, it will have the same handle; if it doesn't, it won't. So you re-use handles by re-using type objects; otherwise there's no way to control it.<br><br>Has anyone actually tested what happens when you overflow the counter? I wasn't patient enough to wait for my test to allocate and deallocate objects four billion times (my programs have so far operated on the assumption that this wouldn't occur). I live in hope that Mark did something really clever (once again) and that the Handles will seek out "dead" slots past a certain point... <br><br></td></tr></table><br>
<a name="1023876"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> the number of 3D objects will slow down your scene long before the Object/Handle operations will! <br></div><br>That's a good point :)<br><br>Thanks Yasha. I am curretnly just dealing with a few hundred instances, and all my functions are referring to Handles as far as return values and parameters, with the guts of the functions performing any necessary Object.MyType(MyHandle%) 'conversions'.<br><br><div class="quote"> Has anyone actually tested what happens when you overflow the counter? I wasn't patient enough to wait for my test to allocate and deallocate objects four billion times (my programs have so far operated on the assumption that this wouldn't occur). I live in hope that Mark did something really clever (once again) and that the Handles will seek out "dead" slots past a certain point... <br> <br></div><br>Presumably, this could also occur with ANY handles (i.e. those from LoadImage or LoadSound etc. too) Any instance where there's more than 4 billion or so individual 'objects'. Maybe there's some form of internal 'checking' that can differentiate the 'class' of an object, such as whether it's a Sound or an Image which could then hopefully mean that a duplicate handle 'value' could be usedprovided the objects are a different class?<br>i.e.<br><br>a=LoadImage("pic.bmp")<br>b=LoadSound("sound.wav")<br><br>where (a = b)<br><br>Who  knows? In all likelihood, any program that DOES have that many currently "active" handles could benefit from some optimisation, so I think it's extremely unlikely to be an issue <br><br></td></tr></table><br>
<a name="1024034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> This has been tested before. I ran some tests, as did someone on an IRC channel.<br><br>The counter overflows goes from (just making up numbers to illustrate the point) 0 to 2336373829 to - 2336373828 back to 0. Upon reaching 0 it will overwrite the existing counters. There is no seeking out dead slots. It would be wise to keep track of this yourself, if you intend to use generate and discard lots and lots of handles. <br><br></td></tr></table><br>
<a name="1024035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Ross that's handy to know! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
