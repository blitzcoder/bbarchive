<!DOCTYPE html><html lang="en" ><head ><title >Verlet car help</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Verlet car help</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Verlet car help</a><br><br>
<a name="713048"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys. I'v been away for a while but now I'v started a new project. <br><br>Its a car game using one of the open source verlet car physics demos. Its not a usual car game though, instead it's car trials. The main aim being climbing over objects and completeing courses without rolling your car. <br><br>You can check out what I have so far: <br><a href="http://rapidshare.de/files/35567267/005.zip.html" target="_blank">http://rapidshare.de/files/35567267/005.zip.html</a><br><br>My question is, whats the best way to make the car body rigid?, because right now the verlets just make a cube shape. Should i just add more velets? <br><br>Any help and comments are much apreciated :P I'll make a working journal for it later which will describe the game in full. <br><br></td></tr></table><br>
<a name="713073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mindstorms</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are a lot of things like this already out there, just look throught the forums...I like the one with the download called wxRacer, although I can't remember who wrote it...<br><br>edit: here is the forumn topic, it seems to be a good start.<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=24611#259058" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=24611#259058</a> <br><br></td></tr></table><br>
<a name="713077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks :P, Like I said I am using a demo for the basis and that happens to be it. <br><br>My question was to make the "roof" of the car, or really just shape the car better would I add more verlets to create the rigid body? Is there any better faster way? <br><br></td></tr></table><br>
<a name="713081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mindstorms</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not an expert, talk to others for better information, but I think that you would want to do something like the wheels on the roof, except positioned so that the radius of the verlets don't go outside the car body... make four verlets for each corner of the top would be what I would do. <br><br></td></tr></table><br>
<a name="713098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Ill wait for some more replys but if it comes down to that I suppose I will. <br><br></td></tr></table><br>
<a name="713131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Weetbix,<br><br>No reason to add more pointmasses for a vehicle. With my engine every object is basically a cube consisting of 9pointmasses and 36 constraints.  I only need 3 iterations for the constraint phase to get stability.   I can't divulage me methods for creating unbreakable structures atm I'm afraid but I guess it's not rocket science.  Basically you'll need to find a method of detecting the break and then correcting.<br><br>To get subtle tilting and rocking when accelerating breaking etc..., the trick is to set the roof pointmasses to be heavier than the wheelbase pointmasses, obviously the center pointmass should be lower than center and heaviest of all for stability.  I found that it was not necessary to use an elastic factor for the constraints but instead used an vector mass factor so that xz axis can differ from the Y axis.  This takes effect during the constraint phase if you use InvMass proportioning anyway and simulates elasticity and suspension quite well.<br><br>If you do not need this best to have the wheelbase heavier than the roof and the vehicle will keep it's shape in the air.<br><br>I haven't really looked at the old demo in the thread mindstorms posted. TBH, the code is a bit of a mess and not very well structured even after Sean cleaned it up.  I assume it uses a similar approach though.<br><br>The biggest problem you'll have is finding that sweet spot for everything, dealing with friction and other external forces  .... it took me many months of tweeking to get to the stage I am.  <br><br>Happy to help with anything else if I can.  Must keep my hard earned secrets though ;)<br><br>Stevie <br><br></td></tr></table><br>
<a name="713139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks alot stevie, although you lost me on most of the complicated points ;). I'm really quite new to this, Right now im just modding the demo and having a play with it. But the reason I want to add more points is so the collisions dont go straight through the car etc. <br><br>Thanks for pointing out the stability options that is very helpful because I wasn't even thinking like that before :P<br><br>By the way, I dont mind you keepin your secrets ;) <br><br></td></tr></table><br>
<a name="713144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> No worries, assume you're talking about vehicle -----&gt; geometry rather than vehicle ---&gt; vehicle?<br><br>If you increase the collision radius of the roof parts but move them more toward center by the same amount you increase their radius by this will give you a better collision model.<br><br>Stevie <br><br></td></tr></table><br>
<a name="713308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think i fixed my problem.  But now I have a new one , how do i get the wheels to move slower? they rotate way to fast and it looks unrealistic. <br><br></td></tr></table><br>
<a name="713335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The tires should rotate based on the speed of the wheel pointmass in it's forward direction so you should increment the rotation each frame by ...<br><br>PointMassSpeed# * 90.0 / ( Pi * TireRadius# ) <br><br>Stevie <br><br></td></tr></table><br>
<a name="713403"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I...ummm...I....<br><br>What... I cant find any place in the code that rotates the tires anyway, i think they are parented to the pivot..<br><br>Never mind got it :D <br><br></td></tr></table><br>
<a name="713474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Weetbix,<br><br>I had a quick look at the VXrace1 code - assume this is what your using?  The code is messy and hard to follow so I don't envy you!!<br><br>Anywho,  change the last 4 lines of the DoVerlet function seems to do what you're after  ...<br><br><pre class=code>
TurnEntity name\v[1]\entity, TFormedZ() * 90.0 / (Pi * name\v[1]\radius ) , 0, 0, False 
	TurnEntity name\v[2]\entity, TFormedZ() * 90.0 / (Pi * name\v[2]\radius ) , 0, 0, False
	TurnEntity name\v[5]\entity, TFormedZ() * 90.0 / (Pi * name\v[5]\radius ) , 0, 0, False
	TurnEntity name\v[6]\entity, TFormedZ() * 90.0 / (Pi * name\v[6]\radius ) , 0, 0, False
</pre><br><br>Hope this helps.<br>Stevie <br><br></td></tr></table><br>
<a name="713487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stevie i was one step ahead, thanks anyway :P By the way all you have to do (for some reason) is TFormedZ() * Pi And it works just fine. <br><br>Heres another problem to ponder. How do I make breaks for the car? I can set the acceleration to 0 but this just stops the wheels spinning, the car still slides off slopes etc? <br><br></td></tr></table><br>
<a name="713500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  By the way all you have to do (for some reason) is TFormedZ() * Pi And it works just fine.   <br></div>  I need the * 90.0 and tire radius in my version.  I guess this one is just set up differently.  Probably the tire is scaled using scaleentity so the tform commands will take this into consideration.<br><br>Logically, you would set the acceleration to be -ve to decelerate ;)  I'll leave that one with you.<br><br>Stevie <br><br></td></tr></table><br>
<a name="713645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> But how do I get the velocity of the car? <br><br></td></tr></table><br>
<a name="713651"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> The overall velocity would be implied by the difference between the current and old pointmass position of the central pointmass.<br><br>If you then use ...  tformvector velocityx, velocityy, velocityz, 0 , centralpointmassmesh .....  the resulting tformedz() will give you the forward velocity in local space.  If the tformedz() &gt; 0 then the car is moving forward relative to it's chassis otherwise reversing.<br><br>I do not have the time to trawl through badly commented code so not much more I can help with I'm afraid.<br><br>Hope this helps.<br><br>Stevie <br><br></td></tr></table><br>
<a name="713663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Weetbix</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Iv just spent a while trying to piece code from the new demos into the old one (personally the old physics suits my needs) and trying to get a velocity value. None of that help at all -,- <br><br>But now, thanks to you stevie I can try that :p Ill get back to you soon thanks for the help.<br><br>edit: <br>stevie, So I had a fiddle around and this is what I came up with for working out the velocity, and Iv put this in the doverlet function. <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">TFormVector car\v[0]\current\x-car\v[0]\old\x,car\v[0]\current\y-car\v[0]\old\y,car\v[0]\current\z-car\v[0]\old\z,0,car\v[0]\entity
	velo# = TFormedZ()
</textarea><br><br>The number it returns doesnt really give me much stopping power, and the car still rolls down slopes when the "breaks" are on. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
