<!DOCTYPE html><html lang="en" ><head ><title >Weekday</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Weekday</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Weekday</a><br><br>
<a name="314863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps strange to see me posting here, since I'm everything but a beginner, but I don't know where to post it else.<br><br>One week ago I started to convert and old production I wrote in Visual Basic into Blitz. The huge RPG Game "Power Of The Rings II"... I encountered one problem, though.<br><br>This RPG game has a puzzle based on the days of the week, in which the clue lies in the setting of the computer clock, however Blitz does not appear to have a feature to get the day of the week (unless there's an undocumented feature for that, or my version is plainly too old).<br><br>Do you guys know any sort of trick to get that one solved? <br><br></td></tr></table><br>
<a name="314871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess a simple API call would do the trick, the problem is that I don't know actually which API to call...<br><br>However, if you need to retrieve the day of the week only at the beginning of the game, then you may run an external app first - like a VB app for example - which will write in a file the day of the week info, and then read that file from within your program.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="314874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maverick</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> there are comands in blitz to get both the current date and time<br><br>variable$=currentdate()<br>variable$=currenttime() <br><br></td></tr></table><br>
<a name="314878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure Snarty wrote a set of functions to do this.  Try the code archives on blitzcoder.com. <br><br></td></tr></table><br>
<a name="314879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's also a vb script solution. If you put this line:<br><pre class=code>
call msgbox(weekday(now))
</pre><br>in a .vbs file, and call it, it will provide a message box with a number between 1 and 7 (1 being sunday, and 7 saturday).<br><br>Would be easy to add some line and write a vbscript code that will write that info to a file...<br><br>Sergio. <br><br></td></tr></table><br>
<a name="314885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  I'm sure Snarty wrote a set of functions to do this. Try the code archives on blitzcoder.com.  <br></div><br><br>I'll surely take a look, thanks <img src="http://www.tbbs.nl/Smiley/Wink.gif"><br><br><br>@semar<br>Writing a VBScript code to write it into a file is easy, I've coded sites in VBScript (like the old version of TBBS, the current version is in php, but the old was in vbs), I'm not quite sure how to combine VBScript with Blitz, though...<br><img src="http://www.tbbs.nl/Smiley/Lill_Confused.gif"><br><br>Anyway, I'll keep the VB solution in mind as long as I don't have a better solution, but first I'll try GFK's idea to search the BlitzCoder archives...<br><br>Thank you for you quick responses, guys <img src="http://www.tbbs.nl/Smiley/Lill_4.gif"> <br><br></td></tr></table><br>
<a name="314893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm not quite sure how to combine VBScript with Blitz, though <br></div><br>Just call it from within blitz, like you would do with an exe.. you can also use the CreateProcess command, and try to get the output from the external application.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="314896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> ExecFile I suppose, I can try that, and er, the "CreateProcess" is not taken as a command in the version of Blitz I use. Guess that is because I ain't got Blitz+, I only got Blitz2D and Blitz3D. (money problems <img src="http://www.tbbs.nl/Smiley/Lill_Ashamed.gif">) <br><br></td></tr></table><br>
<a name="314905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, ExecFile is the command, while CreateProcess works only with Blitz+.<br><br>Here is a sample of a vbscript which writes in a file the day of week:<br><br><pre class=code>
createfile(weekdayname(weekday(now)))

Sub CreateFile(day)
   Dim fso, tf
   'open the file
   Set fso = CreateObject("Scripting.FileSystemObject")
   Set tf = fso.CreateTextFile(".\weekday.txt", True)
   ' Write a line with a newline character.
   tf.WriteLine(day)
   tf.Close
End Sub
</pre><br><br>However, I would use only the weekday function, and retrieve the number of the day of the week; this because on an english O.S. you get, for example, 'Thursday', while on a german, the string written on the file would be 'Donnerstag'.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="314934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You guys are trying to hack your way through... why don't you just make a straight call to the Windows API?<br><br>Something like this:<br><pre class=code>
;.lib "Kernel32.dll"
;GetDateFormat%(iLocale%, iFlags%, iDate%, iFormat$, oDateBuf*, iSizeBuf%):"GetDateFormatA"

date = CreateBank(256)
size = GetDateFormat(0, 0, 0, "dddd", date, BankSize(date))
Print BankToString(date, size)
Delay 1000
End

Function BankToString$(b, size)
	For i = 0 To size-2 ; (null-terminated)
		s$ = s$ + Chr$(PeekByte(b,i))
	Next
	Return "Today is "+s$+"."
End Function
</pre><br>Output:<br><pre class=code>
Today is Thursday.
</pre><br>You can even specify different locales if you want.  This works in Win95 and up. <br><br></td></tr></table><br>
<a name="314958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> why don't you just make a straight call to the Windows API <br></div><br>Because I didn't know actually which API to call... now yes - thanks soja. :)<br><br>A question though.<br><br>Is there a list of all the functions (and descriptions) contained in the DLLs ?<br><br>For example, how do you know that the function GetDateFormat exists, and is located in the Kernel32.DLL ?<br><br>Or, to be more specific, is there a list of all the functions which are accessible from within each DLL ?<br><br>I think that there's a lack of such a documentation... or perhaps there *IS*, but... where the hell is it ?!?!?<br><br>Sergio. <br><br></td></tr></table><br>
<a name="314971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I used DumpBin (included with VC++) to get a list of all the exported functions of a DLL.  There are probably other programs that do this.  <br><br>For just the WinAPI, you might try API-Guide from allapi.net.  It has a search function so you can search on titles, etc.<br><br>You can also just search MSDN for any function (not method) in the Platform SDK.  Any of them should list the library (i.e. dll) that they're included in. <br><br></td></tr></table><br>
<a name="315015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Klaas</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> you can do it in Blitz aswell :<br><pre class=code>
Dim splitresult$(100)
Dim monthname$(12)
monthname(1)="Jan"
monthname(2)="Feb"
monthname(3)="Mar"
monthname(4)="Apr"
monthname(5)="May"
monthname(6)="Jun"
monthname(7)="Jul"
monthname(8)="Aug"
monthname(9)="Sep"
monthname(10)="Okt"
monthname(11)="Nov"
monthname(12)="Dec"

Dim dayname$(7)
dayname(0)="Monday"
dayname(1)="Tuesday"
dayname(2)="Wednesday"
dayname(3)="Thursday"
dayname(4)="Friday"
dayname(5)="Saturday"
dayname(6)="Sunday"

;first split the currentdate into Day, month and year
split(" ",CurrentDate())

Global SDP_day = splitresult(0)
Global SDP_month = FindMonth(splitresult(1)) ;becaus month is not a number .. convert
Global SDP_year = splitresult(2)

days = weekday(SDP_day,SDP_month,SDP_year)
Print "Day: "+days
Print "Dayname:"+dayname(days)
WaitKey

Function FindMonth(fm$)
  For i=1 To 12
  If fm$=monthname(i) Then Return i
  Next
End Function

Function weekday(d,m,y)
  jd=( 1461 * ( y + 4800 + ( m - 14 ) / 12 ) ) / 4 + ( 367 * ( m - 2 - 12 * ( ( m - 14 ) / 12 ) ) ) / 12 - ( 3 * ( ( y + 4900 + ( m - 14 ) / 12 ) / 100 ) ) / 4 + d - 32075
  Return jd Mod 7
End Function

Function split(seperator$,txt$)
	pos=Instr(txt$,seperator$,1)	
	While (pos)
		splitresult(count)=Left(txt$,pos-Len(seperator))
		
		txt$=Right(txt$,Len(txt$)-pos-Len(seperator)+1)
		pos=Instr(txt$,seperator$,1)
		count=count+1
	Wend
	splitresult(count)=txt$
	
	Return count
End Function
</pre> <br><br></td></tr></table><br>
<a name="315017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Soja<br><br>Your method didn't compile in my Blitz. Is it because I don't have B+? (Never experimented with .dlls you see)<br><br>@Semar<br>That was the method I have in mind myself (Gives me rememberance when I coded TBBS in VBScript), since I couldn't get the API method on I think that is my best alternative... :-/<br><br>Thank you guys ;)<br><br>@Klaas (Put in later on, as I didn't see it when writing the messages above)<br>Hmmm.... That is quite some calculation you got there. If it works, I may take it :) <br><br></td></tr></table><br>
<a name="315076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Your method didn't compile in my Blitz. <br></div><br><br>It's probably because you didn't set up the .decls file.  Create a plain text file with the extension name ".decls" (for example, "kernel32.decls") and put it in the blitz\userlibs folder.  Then write these two lines:<br><pre class=code>
.lib "Kernel32.dll"
GetDateFormat%(iLocale%, iFlags%, iDate%, iFormat$, oDateBuf*, iSizeBuf%):"GetDateFormatA"
</pre><br>(I'm assuming you don't already have a '.lib "Kernel32.dll"' line anywhere else in any other decls file.)<br><br>Once you put in that GetDateFormat declaration underneath the .lib declaration, it should compile and run fine, assuming your Blitz version is up-to-date. <br><br></td></tr></table><br>
<a name="315507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tricky</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see... I'll take a look into that, thank you ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
