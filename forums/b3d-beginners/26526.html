<!DOCTYPE html><html lang="en" ><head ><title >Floating point problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Floating point problem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Floating point problem</a><br><br>
<a name="276433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a problem with floating point numbers? I'm trying to get a number to increase by a tiny amount with each loop, but I want it to stay steady, so I'm using a millisecond timer to keep it accurate. Each pass, I use the command x=x+(timer*0.001). The timer is generally about 20, since that's how long a loop is taking, but it fails to increment the variable properly (yes, they are both FP vars). If I pause the main loop slightly, it does work properly, or if a huge amount is happening on the screen and the loop takes a bit longer, the variable starts increasing, but when the timer is 20 or so milliseconds, it does nothing.<br><br>Is this a known problem and is there a way I can fix it? <br><br></td></tr></table><br>
<a name="276519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/bbs/posts.php?topic=26011" target="_blank">http://www.blitzbasic.com/bbs/posts.php?topic=26011</a><br><br>Andy <br><br></td></tr></table><br>
<a name="276615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The "problem" with floating point numbers is that you have an infinite ammount of number (all possible real numbers) that you want represented using a finite ammount of bytes (namely 4). General mathematical considerations rule this out as impossible, as there is no way to "fit" an infinite ammount of apples into 4 billion crates.<br><br>The immediate solution to your problem is to scale your variable by a factor 1000 and use integers instead. <br><br></td></tr></table><br>
<a name="276804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SJT</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm getting old and can't remember very well now but didn't the old ZX81/Spectrum handle FP numbers to high accuracy in a few bytes (32 bits)? I have the books in the loft and may get them out later.<br><br>My ZX81 had 1k ram about 12k rom and would handle FP maths far better than B+ with thousands of times more memory and power! I was in heaven when the 48k Spectrum came out:)<br><br>When I was a lad........<br><br>SJT <br><br></td></tr></table><br>
<a name="276845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I started on a Spectrum too. Such happy memories :)  Having said that, it makes you appreciate the power of B+, when you'd spend weeks programming a sprite handler on the Spectrum in assembler, and then you'd get 6 sprites moving very slowly and flickery, whereas now you can get 1000 moving smoothly in a couple of minutes :)<br><br>I remember the first 3d program I ever saw - a program that drew a 3d cup (in black and white) and took about 30 minutes to do it. And even then, it didn't look 3d :p <br><br></td></tr></table><br>
<a name="276847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not B+, it's the intel CPUs. And the floats used on these CPUs are standard (an IEEE standard). For higher accuracy there are double precision floats, but I doubt the ZX81 had such floats :)<br>You must also note that the float to string conversion will only take into account 6 decimals (meaning by example that "Print Str(1.0/3)" displays "0.333333"), but internally the number of decimals is slightly higher. <br><br></td></tr></table><br>
<a name="276978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> My ZX81 had 1k ram about 12k rom and would handle FP maths far better than B+ with thousands of times more memory and power! <br></div>Your ZX81 wasn't using *floating* point maths, it was (probably) using *fixed* point math. Which is more accurate, but cannot represent really large numbers. It also cannot represent irrational numbers nearly as accurately as floating point numbers. Or they could have used BCDs. <br><br></td></tr></table><br>
<a name="277314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SJT</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah! BCDs that rings a bell, but I don't remember the details. Was the number split in two around the decimal point or is that fixed point?<br><br>SJT <br><br></td></tr></table><br>
<a name="277318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Was the number split in two around the decimal point or is that fixed point?  <br></div>That's fixed point. :o&gt; <br><br></td></tr></table><br>
<a name="277325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> BCD stands for Binary Coded Decimal: take the decimals and encode them in 4 bits each (thus wasting 6 of the 16 values). This had the advantage of being simpler to display (no divisions, just take a block of four bits and it's your decimal), and also for float numbers that can be accurately represented with a decimal radix (as 0.01), then it can also (set aprat the overflow issue) be accurately represented in BCD format. <br><br></td></tr></table><br>
<a name="279796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mag.</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I read some book said that intel FPU will convert any bit to 64bit during loading to FPU register, and its even faster to use 64bit fp because no convertion needed. The FPU will calculate any calculation in 64bit only and when sending back to memory 32bit its has to convert back. Is this true?.. I wonder why blitz use only 32bit, if 32bit won't help in term of speed. Its really really cool to have 64bit fp. It's make me forgot the fp limition.... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
