<!DOCTYPE html><html lang="en" ><head ><title >AddMesh and Reduce Draw Calls?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >AddMesh and Reduce Draw Calls?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >AddMesh and Reduce Draw Calls?</a><br><br>
<a name="1319033"></a>

<a name="1319034"></a>

<a name="1319035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have meshes with alpha textures, is using AddMesh and combining them going to reduce my draw calls and improve framerate? <br><br></td></tr></table><br>
<a name="1319039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the surfaces use the same material, they 'll be mixed into a single surface, then you'll gain performance.<br>Else, it will juste add another surface to the mesh = same amount of draw calls (but less matrix transformations, so it's a gain too, but almost insignificant)<br><br>Now, the problem with alpha stuff : intersection in the same mesh using alpha will result in z-fighting issue. Generally, we try to explode alpha meshes into several meshes that don't intersect the one on the others.<br>So, it's another aspect you should take care. <br><br></td></tr></table><br>
<a name="1319119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks bobysait. I did notice that if you keep camera distance to a minimum, z-fighting is ok.<br><br>I would just like to optimize performance with dynamic geometry or primitives created at runtime. <br><br></td></tr></table><br>
<a name="1319132"></a>

<a name="1319133"></a>

<a name="1319134"></a>

<a name="1319135"></a>

<a name="1319286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The less surfaces the less time it takes to render, but only if the scene is organised in different zones so that some zones which are not in the fov or masked (occluded by a wall or a big shape) can be hidden., There has been several discussions and demonstrations about this on these forums, maybe do a search... <br>But sometimes it is more practical to use copyentity, especially for turning/moving/animating entities.<br>For example, in my snowfall snowaccumulation demo, the falling snowflakes use copyentity (but i could have used a single surface particles system) and the melted snowflakes on the ground are merged in one mesh a few surfaces (because there is a maximum number of vertices/triangles per surface or you will get a mav on some graphics cards) <br><br></td></tr></table><br>
<a name="1319143"></a>

<a name="1319144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> btw I did not know b3d supports occlusion culling, not the camera not in view thing.<br><br>so completely hidden meshes are not rendered?<br><br>I found one of these topics and assume nothing has changed in regard to handling occlusion<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=26335" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=26335</a> <br><br></td></tr></table><br>
<a name="1319148"></a>

<a name="1319150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I did not know b3d supports occlusion culling<br> <br></div><br>it does not by default, but you can create your own system (using zones and passages) <br><br></td></tr></table><br>
<a name="1319170"></a>

<a name="1319226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>thanks bobysait. I did notice that if you keep camera distance to a minimum, z-fighting is ok.<br> <br></div><br>My bad, I was talking about z-order (not z-fighting)<br>The z-order problem with the alpha surface can't be fixed by setting the camera's depth <br><br></td></tr></table><br>
<a name="1319195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank you for that. For some reason, some of my models are ok with z-order (I just put in entity order 0) and this is with alpha surfaces as you mentioned. I don't know why but it works.<br><br>If I combined multiple objects with alpha surf on them (ie bunch of trees) it does have z-order or fighting whatever problem it is but it does not look good. <br><br></td></tr></table><br>
<a name="1319203"></a>

<a name="1319204"></a>

<a name="1319227"></a>

<a name="1319228"></a>

<a name="1319229"></a>

<a name="1319230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> problem with alpha comes when you have a surface that is rendered, at the same time, before AND after another. As mentionned, the z buffer can only store a single value, so what happens is :<br><br>- for each pixels from the first surface, it writes the alpha on the z buffer<br>- for each pixels of the second surface, if it finds that there are already a pixel at a point that is nearer than the pixel you want to add, it will skip it. So it doesn't add it with a blending mode or else (while, it's true that the previous pixel was nearer, it doesn't care it was an "alpha" pixel, so the alpha will override a solid pixel making it not being drawn at all - and here is the glitch of the z-order)<br>And that's what make the thing goes wrong.<br><br>So, in some case, you won't notice it because surfaces are well sorted or does not "intersect" with an other surface depth. But for trees, (it's probably the most frequent case where it happens) it's a real problem. For now, we generally solve this by not using "Alpha" flag on texture for the leaves, but use the "Mask" flag. So the leaves are actually rendered as "0" alpha or "1".<br>(It's also a common problem with terrain splatting when you want to add a plane to modelise water, but it's still a problem because it can't be solved with a simple Mask -&gt; so we need to split the plane into several polygons with holes that follows the terrain "beach") <br><br></td></tr></table><br>
<a name="1319219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  in some case, you won't notice it because surfaces are well sorted or does not "intersect" with an other surface depth. <br></div><br><br>yes, maybe this is the case. At least I can conform that this is not a glitch or anomaly inside b3d. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
