<!DOCTYPE html><html lang="en" ><head ><title >Keeping MD2 animations in time</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Keeping MD2 animations in time</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Keeping MD2 animations in time</a><br><br>
<a name="667039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bankie</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've created my first ever animated MD2 model (using Milkshape) and looking at the available commands it seems that Blitz may be a little lacking. I understand that I need to call AnimateMD2 before hitting the main game loop, but the problem is that I don't know at that point what the delta time is going to be on the target PC (i.e. I don't know the frame rate), and there don't appear to be any commands that will allow me to dynamically alter the animation speed. So, what is the best way to deal with this?<br><br>The only way I can think of is to start the animations after a short period (say, 5 seconds) and use an average delta time to work out how fast to play the animation.<br><br>So my question: Is there another (better) way of working out how fast to make the animation, or better, change it on the fly? Or is Blitz simply too crap with MD2s and I should be learning to use B3D models instead? <br><br></td></tr></table><br>
<a name="667820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bankie</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I haven't had any replies, I've tried exporting as a b3d instead, and of course altering the command to loadanimmesh for loading the mesh:<br><br>test = LoadAnimMesh("models\test.b3d")<br><br>However, I get a memory access violation followed by "Entity does not exist" on the above line. However, if I remove all joints/animations and export again, I don't get an error and the model loads successfully.<br><br>Are there restrictions on how you can carry out animations with b3d models? For my test, all I did was add a box, assign the vertices to a joint, then add a sphere and add those vertices to another joint. Finally I created a couple of keyframes, moving one of the joints for a very simple animation. Exporting to an MD2 works, but to a b3d gives the aforementioned error. Does anyone have any suggestions? <br><br></td></tr></table><br>
<a name="667907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Bankie,<br><br>I can't answer the second post, but the first post I have an idea for:<br><br>When animating your md2 model set it to '1 shot' animation, and specify the exact frame (firstframe=lastframe) that you want it to play rather than a range of first to last.  Specify a transition value other than 0.0.  If you want it to animate faster then simply progress through the frames faster.<br><br>Alternatively, if you do use b3d models then you can use setanimtime to specify the exact position in the models animation sequence that you want it to play. <br><br></td></tr></table><br>
<a name="668039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bankie</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the reply Matty. Your suggestion sounds pretty good, though it means a few more lines of code to keep everything organised. I think I'd rather use B3Ds if I can find a way of exporting them from Milkshape in a way that Blitz can read them, but at least with your method I can fall back on the more stable MD2s if I can't suss this problem out. <br><br></td></tr></table><br>
<a name="668266"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've had no problems exporting b3d from milkshape (with animation).  I am using Milkshape 3d version 1.7.4 which may be a little older though. <br><br></td></tr></table><br>
<a name="668541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bankie</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have at last solved the B3D file problem. It seems you have to regroup all your groups together before exporting. It's a bit queer, and means having to remember to save the Milkshape file before doing this process, but at least it works. <br><br></td></tr></table><br>
<a name="668862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dustin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Depending on the number of animated characters you might want to rethink the B3D anim approach.  You'll know when you've reached the limit when your FPS drop like a rock.  But you can have 3x or 4x as many MD2 characters without the slowdown.<br><br>I mentioned in a previous thread that I'm sticking with one animated B3D character (to allow the user to select the character but still use the same boned animations) and use MD2 for all other anims.  Just my $.02. <br><br></td></tr></table><br>
<a name="668923"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BIG BUG</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your first problem, model animation with delta timing isn't solved by just using b3d files. The Animate command works similar to AnimateMD2.<br><br>To set animation speed depending on your framerate, use the additional parameter of UpdateWorld.<br><br><pre class=code>
   time_new   = MilliSecs()
   time_diff# = (time_new - time_old) / 1000.0
   time_old   = time_new

  UpdateWorld time_diff#
</pre> <br><br></td></tr></table><br>
<a name="669625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bankie</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Dustin &amp; Big Bug for the replies.<br><br>I had read elsewhere that B3Ds were more efficient than MD2s, but if this is not the case, then I think I'll just stick with the MD2 format.<br><br>As for the additional parameter of UpdateWorld, I didn't have a clue. For me it has always been something you just stick near the end of your main loop to make sure everything gets displayed. The additional parameter looks like it will also affect all of my animations (i.e. MoveEntity, TurnEntity, etc), so I believe I'll need to remove my use of delta throughout the rest of the code. <br><br></td></tr></table><br>
<a name="669629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are going for a game where the player can see the character models up close then b3ds can look much better than md2s - md2s in my opinion are better for RTS type games or other games with lots of low detail models. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
