<!DOCTYPE html><html lang="en" ><head ><title >drive object along surface, sticking to it</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >drive object along surface, sticking to it</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >drive object along surface, sticking to it</a><br><br>
<a name="607346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> i want to drive a 'car' along an object's faces.  i can do this by pulling the car down (relative to car), and if there's an incline, he collides and slides up<br><br>but i want him to be able to drive on any surface, even the outside of a sphere or inside a twisty track with loops.  so, the car needs to align itself with the surface it is driving on.<br><br>What is the fastest (processor time) way to do this?  <br><br>somehow measure distance from edges of car down to surface, and adjust the vehicle so that those edges are about even somehow?  i am not certain how to do this.<br><br>i explored the car demo, i understand basically how it works, but is that the best way - with 4 collision pivots at the wheels?  (I don't have wheels on the vehicle but just the same)  <br><br>my vehicle does collide already in one spot with the object its riding on, can i somehow align with the surface i've collided with?<br><br>a little clueless as what to try!<br><br>thanks <br><br></td></tr></table><br>
<a name="607423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Find the collision normal (collisionnx,collisionny,collisionnz) commands,<br>then use aligntovector on your object, aligning the y-axis of your object to the collision normals. <br><br></td></tr></table><br>
<a name="607510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks!<br><br>i wonder though - how come just the y axis?  it seems that if the road is going not just up and down but twisting around (barrel rolls), i'd need to align every axis?<br><br>hmm ok maybe not roll.<br><br>is there code for this somewhere? <br><br></td></tr></table><br>
<a name="607518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm baffled<br><br>i've got this<br><br>		ny#=CollisionNY#(carpiv,1)		<br>		nz#=CollisionNZ#(carpiv,1)		<br>		nx#=CollisionNX#(carpiv,1)	<br>		AlignToVector carpiv,nx,ny,nz,0 <br><br>i've tried every number at the end and various combinations of them, sort of just guessing here.<br><br>mostly what happens is the car at start gets flipped on its side, or up.  I think I see some angling of the car on inclines though.<br><br>the carpiv is located below the car.  it's facing 'forward' just like the car.  it touches the ground.  to move forward I add to Z.  I assume that's relevant to what we align.<br><br>when i move the car, i actually move carpiv because carpiv is parent.  i rotate the car to turn, but never rotate the carpiv because i wanted left and right and up and down on keyboard to match the carpiv's movement (so that when you push up no matter how car is rotated, the car moves 'forward' as far as the camera is concerned)<br><br>i am lost as to how to make this right. <br><br></td></tr></table><br>
<a name="607540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You've used 0 for the axis param - it should be 2, for the y axis. Also, I think you may need to invert the normal: AlignToVector carpiv,-nx,-ny,-nz,2.<br><br>[edit] actually, I'm not sure about the inverting the normal thing - my brain is currently working on minimum power, for various reasons. :) <br><br></td></tr></table><br>
<a name="607562"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm no, that doesn't seem to do it either.<br><br><br>i tried  AlignToVector carpiv,-nx, ny,-nz,2<br><br>because -ny makes the car flip upside down.  <br><br>but it's still not doing the trick.  any ideas? <br><br></td></tr></table><br>
<a name="607569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> well, i got other objects in my game to work using <br> <br>								nx#=CollisionNX(e\piv,1)<br>								ny#=CollisionNY(e\piv,1)<br>								nz#=CollisionNZ(e\piv,1)<br>								AlignToVector e\piv,nx,ny,nz,2,1<br><br>but not my car, so must be something with the goofy way i set up the car! <br><br></td></tr></table><br>
<a name="607607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> i am completely baffled.<br><br>some objects seem to be controlled by this properly and others are not.  the ones that are not controlled properly are angling about half the amount they should.<br><br>i know this isn't much to go on but is there any way i could be getting about half the amount from the collisionNX/NY, etc than I expect? <br><br></td></tr></table><br>
<a name="607617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> try a linepick? <br><br></td></tr></table><br>
<a name="607619"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Firstly, you need to make your track pickable, by giving it and EntityPickMode of 2. Then, every loop, do a linepick straight down from the entity's position. Use TFormVector, to make sure the linepick points downards, relative to the entity. <br><br></td></tr></table><br>
<a name="607621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your collision index is constant - if there's any way that collision 1 might not actually be between a particular object and the scenery (say object to object instead) then that might explain it. Also, I would make the rate correlate to the velocity of the object to be aligned. <br><br></td></tr></table><br>
<a name="607996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> i don't see where entitycollided comes into play.  here's basically what i've got<br><br><pre class=code>
cc=CountCollisions(carpiv)
If cc&gt;0
   If cc &gt; 1
     DebugLog cc+" collisions for car"
     delay 500	
   EndIf
for i=1 To cc
   obj=CollisionEntity(carpiv,i)
   t=GetEntityType(obj)
   Select t
   Case T_WALL,T_PLATFORM
	;align to this obj
        nx#=CollisionNX(carpiv,i)
	ny#=CollisionNY(carpiv,i)
	nz#=CollisionNZ(carpiv,i)
	AlignToVector carpiv,nx,ny,nz,2,1
        ;now i do basic movement 
    end select
etc
</pre><br><br>i'm not using entitycollided, should i be?  <br><br>there doesn't seem to be any clear examples of how to do collisions correctly and completely.<br><br>by the way i do get multiple collisions with carpiv and ground/walls, at the same time. <br><br></td></tr></table><br>
<a name="608152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
   t=GetEntityType(obj)
   Select t
   Case T_WALL,T_PLATFORM
</pre><br><br>I'm pretty sure EntityType doesn't return an entity... <br><br></td></tr></table><br>
<a name="608169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should be ok Ross, it just references the collision type of that entity.  Show us the code and we'll try and fix it. <br><br></td></tr></table><br>
<a name="608241"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>is there code for this somewhere? <br> <br></div><br><br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=1069" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=1069</a> <br><br></td></tr></table><br>
<a name="608829"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ryan scott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm using exactly that same technique, however my car falls through 'vertical' walls once they reach a certain steepness, it seems.  <br><br>it loses collision detection of the wall that it is on.<br><br>it's pushing 'down' on it (which is against the vertical wall) just slightly (simulating a local gravity)<br><br>i checked the normals, the object is not inside out.<br><br>very confused.  i see that the example works but can't figure why mine does not. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
