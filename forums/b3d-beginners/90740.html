<!DOCTYPE html><html lang="en" ><head ><title >Is this a bug?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is this a bug?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >Is this a bug?</a><br><br>
<a name="1032370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Josaih6/10</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> ;It looks like GetColor() is alway looking at black!!!<br><br><br><br>Graphics 1000,700<br>Global avgRed<br>Global avgGreen <br>Global avgBlue<br><br>Const maxVary = 20<br><br>Type block<br>	Field x,y<br>	Field size<br>	Field r,g,b<br>End Type <br><br>Global image = LoadImage("X:\100_3060.jpg")<br>Global iw = ImageWidth(image)<br>SetBuffer(ImageBuffer(image))<br><br><br><br><br><br><br><br><br>MakeBlocks()<br>Draw()<br>End <br><br><br><br><br><br><br><br><br><br><br>Function MakeBlocks()<br><br>For x = 0 To ImageWidth(image)<br>	Cls <br>	Locate 0,0<br>	Print x+"/"+iw<br>	For y = 0 To ImageHeight(image)<br>		s = 0<br>		GetColor(x,y)<br>		r = ColorRed()<br>		g = ColorGreen()<br>		b = ColorBlue()<br>		Repeat <br>			s = s + 1<br>			GetAvgs(x,y,s)<br>			Color 255,255,255<br>			Print GetColorDif(avgRed,avgGreen,avgBlue,r,g,b)+" at "+s +"|orig rgb: "+r+","+g+","+b+"|"+s+":"+avgRed+","+avgGreen+","+avgBlue+"| x,y:"+x+","+y<br>			If s = 10 Then Stop <br>			If GetColorDif(avgRed,avgGreen,avgBlue,r,g,b) &gt;= maxVary Or CheckOverlap(x,y,s) Then Exit<br>		Forever <br>		l.block = New block<br>		l\x = x<br>		l\y = y<br>		l\r = avgRed<br>		l\g = avgGreen<br>		l\b = avgBlue<br>		l\size = s - 1<br>		If y = 10 Then Stop <br>	Next <br>Next <br><br>End Function <br><br><br><br><br><br><br>Function GetAvgs(x1,y1,s)<br><br>For x = x1 To x1 + s<br>	For y = y1 To y1 + s<br>		GetColor(x,y)<br>		r = r + ColorRed()<br>		g = g + ColorGreen()<br>		b = b + ColorBlue()<br>	Next <br>Next <br>avgRed = r/(s^2)<br>avgGreen = g/(s^2)<br>avgBlue = b/(s^2)<br><br><br>End Function <br><br><br><br><br><br><br><br>Function GetColorDif(r1,g1,b1,r2,g2,b2)<br><br>r = Abs(r1-r2)<br>g = Abs(g1-g2)<br>b = Abs(b1-b2)<br>Return r+g+b<br> <br>End Function <br><br><br><br><br><br><br><br><br>Function CheckOverlap(x,y,s)<br><br>For b.block = Each block<br>	If RectsOverlap(x,y,s,s,b\x,b\y,b\size,b\size) Then Return True <br>Next <br>Return False<br><br>End Function <br><br><br><br><br><br><br><br>Function Draw()<br><br>bImage = CreateBlockImage()<br>DrawImage image,0,0<br>WaitKey()<br>DrawImage bImage,0,0<br>WaitKey()<br><br>End Function <br><br><br><br><br><br><br>Function CreateBlockImage()<br><br>blockImage = CreateImage(ImageWidth(image),ImageHeight(image))<br>SetBuffer(ImageBuffer(blockImage))<br>For b.block = Each block<br>	Color b\r,b\g,b\b<br>	Rect(b\x,b\y,b\size,b\size)<br>Next <br>Return blockImage<br><br>End Function <br><br></td></tr></table><br>
<a name="1032372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Considering you never draw to the backbuffer, and never flip the backbuffer into view, it's not surprising you don't see anything.<br><br>I had a brief look over your code, but couldn't quite work out what you were trying to do? <br><br></td></tr></table><br>
<a name="1032373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br><br>you do a "CLS" inside the MakeBlocks that result in ImageBuffer cleared!<br><br>Juan <br><br></td></tr></table><br>
<a name="1032377"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Josaih6/10</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Charrua. I thought Cls would clear the screen, not the current buffer.<br><br>Sorry Matty, I should have said what I was doing. In short, I'm trying too make an image compressor. I saw pretty early that it wasn't going to save much (if any) space but wanted to finish it just for the fun of it. Before I made my own format however, I wanted to make sure it looked alright. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
