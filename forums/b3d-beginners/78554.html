<!DOCTYPE html><html lang="en" ><head ><title >how to animate a tile in a mesh?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >how to animate a tile in a mesh?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=5" >Blitz3D Beginners Area</a>/<a href="#bottom" >how to animate a tile in a mesh?</a><br><br>
<a name="881441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not this far in my game yet (not by a longshot!), but somewhere along the way I need to find a way to animate a tile in a mesh.<br>The mesh is quite large, since it represents a terrain. The tiles would be waving grass or rippling water etc.<br>Perhaps I could switch UVs in a singelesurface, or change brushes somehow? <br>I was hoping there was a function like loadanimbrush(), but there isn't, or is there?<br>I would sure appreciate if someone could guide me in a doable direction. I don't need full working code (though that would be nice); just some advice on what way would be fast or simple. (simple? yeah right!)<br>greets. <br><br></td></tr></table><br>
<a name="881445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cp</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> maybe you could make a animated gif image and load it into a brush.<br>I actually forgot whether or not gifs are supported. <br><br></td></tr></table><br>
<a name="881751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dont think they are, however you can use animated texture strips in jpg or png format. <br><br></td></tr></table><br>
<a name="881788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes; but how to apply them to a specific tile? <br><br></td></tr></table><br>
<a name="881859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> By tile im assuming you mean 1 quad (2 triangles) right? <br>If so, you could;<br><br>1) track down those 4 vertices coords and add new surface geometry to texture with the other texture, <br><br>or:<br><br>2)use 2 texture indexes on the same brush with separate UV sets (however there are only 2 sets of UVs per brush and 1 brush per surface AFAIK so doing this would make lightmapping difficult) This method is not geometry bound like the other so you could use the UVs to position it anywhere you like.<br><br><br>However, i notice you are talking about rippling grass. Why not just use crossplanes with a png alpha texture on certain vertex positions? You could make the system dynamic by using copyentity and freeentity when in and out of camera range/view. <br><br>For the copyentity you would use a sourcemesh which never gets freed and is invisible (use hideentity) but copies itself where and when needed. <br><br></td></tr></table><br>
<a name="881967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ehm... This is the beginners area, wright? Ha! <br>Thanks D4NM4N; I sure don't understand everything of your advice, but enough to get me going. <br>Except for the first one, those  methods would not be something I would have  thought of myself. <br><br></td></tr></table><br>
<a name="882116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> (Sorry :)<br><br>For the grass crossplane bit, it is simply an X shaped wall mesh, double sided with a texture on it. For testing, just use a cube for now.<br>Unfortunately, the following is out of my head and i am not on a windows machine at the moment, so cannot test it for you, but it should work,  (may need a syntax correction or two :) <br><br>It would be loaded with something like: <br><pre class=code>
;set color+alpha+mipmap on any texture with grass in name (must be 32bit PNG or TGA!)
texturefilter ("grass",1+2+8)   

;load the textured X mesh
global sourcegrass=loadmesh("mygrass.png")   

;enable backfaces so both sides of all 4 triangles of the crossplane are visible from both sides.
entityfx (sourcegrass, 16)  
</pre><br><br><br>Then using an array or custom type to store the data something like:<br>(assuming you use custom types rather than an array)<br><br><pre class=code>
type Tgrass
    field handle%
    field X#
    field Y#
    field Z#
end type
</pre>(arrays are faster tho but not as 'pretty' :)<br><br><br>You obviously need to fill the above structure with some virtual 'grass' objects (each one will be a desired location). This structure could be filled in many ways, for example;<br>- by simply hard-coding them(yuck!), <br>- placement maps (a hidden image with different colors for different things)<br>- using a placement script from a level or terrain editor, <br>- by 'intelligent' mesh analysis of the terrain itself (ie. record pos. of 'random verticies that have the vertexcolor green').<br><br>Either way, object creation would be done by:<br><pre class=code>
g.Tgrass=new Tgrass
   g\handle=0   ;(no need for a value here yet, this will store the copy's pointer or 'handle')
   g\x = 342    ;&lt;--example coords
   g\y = 32
   g\z = 100
</pre><br><br><br>Then in your <b>main loop</b> add the dynamic placement code. I have used a reference pivot here for simplicity but using maths (*may*) be faster :/ <br><br>Something like this in the main loop:<br><pre class=code>
;create our reference object
refpoint=createpivot()

;iterate through all "grass" objects
for g.Tgrass = each Tgrass;
    
    ;position reference at position stored in the object "g" of type Tgrass 
    positionentity refpoint(g\x, g\y, g\z)

    ;work out how far away from camera the position of the reference is
    if entitydistance(camera,refpoint) &lt; visiblerange then
         ;if it doesn't already exist make an "instance" and position it 
         if not g\handle then 
             g\handle=copyentity(sourcegrass)
             positionentity (g\handle, g\x, g\y, g\z)
         endif
    else
         ; if not in range and an instance exists then delete it, freeing precious resources!.
         if g\handle then
               freeentity g\handle : 
               g\handle=0  ;&lt;---important, freeentity does not delete the pointer's value
         endif
    endif

next

;delete the refpoint (important!)
freeentity refpoint : refpoint = 0
</pre><br><br>Hope this helps and works ok, as i say, i cant test it for you im afraid. However the 'theory' is there to give you some ideas. <br><br>ps: This same kind of system can be used for pretty much anything, monsters, items, buildings etc.. <br><br></td></tr></table><br>
<a name="882208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abomination</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes; this really helps. Thanks for giving this so much thought. -an explanation even I could understand- :0<br>I will try to implement this 'theory' in my 'terrain-mesh'.<br>sure hope it's fast enough; there is a LOT of grass in my game. ;) <br><br></td></tr></table><br>
<a name="884505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive just realised i used the BMAX syntax standard ie, "g.handle" rather than "g\handle"<br><br>Only use . when assigning the type object (eg. "g.Tgrass = each") for field access you need to use "\" not a "."<br><br>Sorry about that, but im sure you worked it out ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
