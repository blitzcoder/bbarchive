<!DOCTYPE html><html lang="en" ><head ><title >CanvasGraphics on OSX Yosemite</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >CanvasGraphics on OSX Yosemite</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=107" >MacOS X Discussion</a>/<a href="#bottom" >CanvasGraphics on OSX Yosemite</a><br><br>
<a name="1268512"></a>

<a name="1268513"></a>

<a name="1268514"></a>

<a name="1268515"></a>

<a name="1268516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am writing a music utility in BlitzMax which runs absolutely fine on Windows XP (and 7 and 8.1):<br><img src="http://retroclonez.co.uk/Z9aY0bX8cW1dV7eU2f/Screenshot_WinXP.png"><br><br>But on OSX looks like this:<br><img src="http://retroclonez.co.uk/Z9aY0bX8cW1dV7eU2f/Screenshot_OSX_1.png"><br><br>I traced the problem with the main window to "HideGadget" (I originally hid the canvas while I drew it), so commented it out, resulting in this:<br><img src="http://retroclonez.co.uk/Z9aY0bX8cW1dV7eU2f/Screenshot_OSX_2.png"><br><br>However, the canvases on the child window simply refuse to update - even though the code is exactly the same (using "SetGraphicsDriver GLMax2DDriver()" and "GLShareContexts()") on both Windows and OSX.<br><br>The only difference I can think of is that the child window is updated via DrawImage whereas the main window is drawn using DrawRect and DrawText. Although this suggests a failed LoadImage, the image objects are not Null. Is there something I need to do differently on OSX in order to be able to draw images to a canvas? <br><br></td></tr></table><br>
<a name="1268518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are using EVENT_GADGETPAINT check that you are calling SetViewport before any drawing calls.<br><br>If you are using multiple windows there may be an issue as I am not aware of any MaxGUI apps that draw to both. <br><br></td></tr></table><br>
<a name="1268555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi skidracer. I am using EVENT_GADGETPAINT so have just tried adding SetViewport but this didn't fix the issue. I'm also using multiple windows. The images are definitely loaded because I can draw them on the main window canvas without problems - it's only the child window (I'm calling it child as it has the main window as its parent) which refuses to update. In fact, no drawing commands update the child window (DrawRect, DrawText, DrawImage) at all on OSX, yet the exact same code works fine on Windows. <br><br></td></tr></table><br>
<a name="1268602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> don't know if it affects canvases as well or not, but... Have you tried putting a GLShareContexts() after creating the window? <br><br></td></tr></table><br>
<a name="1268604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I already have GLShareContexts() at the top of my code (without it the main window graphics were corrupted).<br><br>I'm beginning to think this is not canvas-related, as I created a version of the program which only generated the child window (parent=Null) and the canvases still did not render. Maybe it's because the canvases are contained within a Type - each with a Paint() method? In the screenshots there are 4 instances of the Type - all of which update fine in Windows, but none in OSX.  I have deliberately not included any OS-specific code in my program so as to make porting across systems as simple as possible, so don't understand why the same code works on one but not another.<br><br>I have now spent over a week trying to get this to work on OSX without success. Since all image objects load successfully, the canvases are created ok (i.e. not Null) and there are no errors generated, I have no clues as to what is wrong and therefore have to accept that I am unlikely to ever get it working. Thank you for the suggestions. <br><br></td></tr></table><br>
<a name="1268605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> GLShareContexts seems like a good suggestion.<br><br>The MaGUI example also calls SetGraphics CanvasGraphics(canvas) at the beginning of the EVENT_GADGETPAINT handler which may also be required in a multi window config. <br><br></td></tr></table><br>
<a name="1268606"></a>

<a name="1268610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi skidracer.<br><br>I already have GLShareContexts() at the top of my code - and adding another after the creation of each window made no difference. I also have a SetGraphics CanvasGraphics(&lt;canvasname&gt;) at the top of every Paint() method - and these are called whenever EVENT_GADGETPAINT is raised (via a Hook).<br><br>The thing I don't understand (I know I'm sounding like a parrot here) is the fact the the code works on Windows - so why not OSX? <br><br></td></tr></table><br>
<a name="1268613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would be happy to take a closer look if you want to send me a zip.<br><br>Under neath the hood MaxGUI is a VERY different beast on each OS and yes, it still seems to have some issues. <br><br></td></tr></table><br>
<a name="1268614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chalky</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow - thank you - zip sent. <br><br></td></tr></table><br>
<a name="1268704"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Started looking into this last night. <br><br>Able to run and reproduce issue as described in OP.<br><br>Definitely want to fix the HideGadget side effect in which resources become unbound and the main screen fails to draw.<br><br>Hopefully will also suss why Live Set window is coming up blank tonight. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
