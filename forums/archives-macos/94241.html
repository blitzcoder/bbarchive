<!DOCTYPE html><html lang="en" ><head ><title >Proper location for shared files &amp; AppStore</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Proper location for shared files &amp; AppStore</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=107" >MacOS X Discussion</a>/<a href="#bottom" >Proper location for shared files &amp; AppStore</a><br><br>
<a name="1080355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry to start another thread, but the other one turned into a discussion about signing up as an Apple Developer and AppStore submissions.  Anyways...<br><br>Part of the other thread goes into where to store files, but the question I need to ask was not answered.  Where can I store files that need to be accessed by all users, such as a high score table?  I've just discovered that the Library/Application Support folder is read-only for restricted users.  Is there another location that is AppStore friendly?  I believe the Shared folder is a no-go as far as the store is concerned.<br><br>Also, is there an official word on whether the features required by the AppStore will be built into a BlitzMax update, or do we have to use the work-a-rounds instead.  I'm talking about full-screen quitting, and so on. <br><br></td></tr></table><br>
<a name="1080381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPFileSystem/Articles/WhereToPutFiles.html" target="_blank">http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPFileSystem/Articles/WhereToPutFiles.html</a><br><br>It *should* be /Library/Application Support in theory. I think asking on the official apple forum would get you more valid info for this.<br><br>I doubt that BlitzMax will get rebuilt around app store politeness any time soon so I would recommend building a list of the relevant additions you will need to make for your current project. Note also that you have to do certain things, however HOW you do them is still totally up to you. e.g. command Q has to quit, however you can do that by trapping the event, triggering app terminate, or just simply using polled input etc. there's no right way (though some are obviously much easier than others depending on how you lay things out). <br><br></td></tr></table><br>
<a name="1080467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem with that location is that restricted users can only read from that location, whereas I need them to write as well.  I was using the /Users/Shared location, but this is not allowed, apparently.  I'll see if I can find something in the information you've linked to.<br><br>And yes, if there are no official changes to the modules for AppStore compliance then I'll have to code it in myself.  Just wondering if there was any word on this.<br><br>Cheers. <br><br></td></tr></table><br>
<a name="1080473"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would head to the apple forums for a solution to this personally. It's a matter of permissions management and app store compliance and they'll know a lot more about it over there. Of note because un-priviledged users can't write there doesn't mean they can't modify an existing file there if they have permission... unix style permission controls can get weird... Again apple forums will have people with more specific knowledge (I've never bothered with a shared local highscores table myself, either per user or global via the internet...). The official docs state, according to my interpretation (section 2, "Support Files") that It's supposed to go in "/Library/Application Support" but if you're encountering permission issues with this you'll need some more skilled help. You may for example need to build a blank or starter highscore table, and setup the signed installer to place that in the right location with the appropriate permissions (no clue how to do this specifically but should be possible, someone with more experience with the command line package builder should know) which in turn will trigger the OS for an administrator password to complete the installation... just a theory <br><br></td></tr></table><br>
<a name="1080685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used to use Users/Shared as it was most logical for all profiles to be able to use the same data, but complied with the path required by the app store.  I also used a shared folder in Vista even though most games don't.  It seems crazy to me as in the old days when you could store data in the game folder, anyone who logged on could share the same high scores etc. <br><br></td></tr></table><br>
<a name="1080687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh yeah you can do this on the data folder and files: SetFileMode(Filename,%111111111) <br><br></td></tr></table><br>
<a name="1080864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers Grey.  Was going to look into that SetFileMode thing, as I know I had to do something with it anyway with some sort of weirdness happening when switching users.  Even happened in Vista!<br><br>So does that work in the shared App Support folder? <br><br></td></tr></table><br>
<a name="1080885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know for sure that code worked on the old Users/Shared location I was using, and it's still running in that Library path and doesn't crash, so I guess it's OK.<br><br>I never used that code in Vista, I used some horrible complex thing to set permissions to Everyone.  It's on the forums somewhere. <br><br></td></tr></table><br>
<a name="1080891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks again.  I'll give it a go later and report back.  Got a feeling the game may first need to run from an admin account, as it also acts as a kind of installer the first time it runs, but we'll see.<br><br>I did get Vista to behave in the end using just SetFileMode, so hopefully I can bring OS X into line as well. <br><br></td></tr></table><br>
<a name="1080933"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> To remain app store compatible here's a couple thoughts:<br>Switch the "creating" (possibly just placing an empty copy) of the needed file(s) to the actual bundle installer. This is what apple intends so it's going to be the most by the book approach. However Making the installer do that... I have no idea via the command line tools that have to be used...<br><br>or<br><br>As you mentioned, require the first run to take place from an administrator account... this however is likely to run against the app store rules.<br><br>or<br><br>Store the highscores locally per user UNTIL it's running on an account with permissions, then merge the high scores from local to the global list... this will let it run within app store guidelines and, if possible, let you share the high scores... not totally elegant but it should satisfy everyone with minimal code (opening local library if the global library fails to open...). <br><br></td></tr></table><br>
<a name="1080961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for you thoughts.<br><br>Didn't think about the first run being from an admin account being against the App Store requirements, so must look into that.<br><br>Was actually thinking along the lines of your third idea, but not too sure how to do this at the moment so will have to give it some thought. <br><br></td></tr></table><br>
<a name="1081298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, so I finally got around to doing some testing and feel like a bit of a prat right now...<br><br>When I develop my games everything is stored in the documents folder of my admin account, naturally.  So when it comes to testing under a restricted account I copy the app to the Applications folder, swap accounts, and test from there.  The reason why my game crashed was not to do with permissions, but simply to do with me forgetting to copy the game data with it!  The final version of the game will have the data contained within the App bundle.  Anyways, to answer all of the above...<br><br>You can use the shared App Support folder without any issue.  The only thing to remember is that whenever you create any files to use SetFileMode filename,%111111111 as soon as the file is created to maintain access for everyone, as Grey has already mentioned.<br><br>Glad that's sorted now. <br><br></td></tr></table><br>
<a name="1082032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Phew, glad you sorted it out! <br><br></td></tr></table><br>
<a name="1082058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does SetFileMode() work on folders?  Just wondering if all that fannying about with folder permissions a couple of years back couldn't have been solved with the same function. <br><br></td></tr></table><br>
<a name="1082059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad it's sorted and documented, thanks! <br><br></td></tr></table><br>
<a name="1082124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does SetFileMode() work on folders? Just wondering if all that fannying about with folder permissions a couple of years back couldn't have been solved with the same function. <br></div><br>Not sure, but it is how I've done it and it seems OK.  I think I did have some issues with Vista, but it was some time ago now since I worked on this part of the code for Vista so can't remember the issues I had and how exactly I got around them.  It may have needed a first run from an admin account or the installer to set everything up properly.  I will be testing all of this again before release though. <br><br></td></tr></table><br>
<a name="1082138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aye, Vista was where all the problems started! <br><br></td></tr></table><br>
<a name="1082213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @GfK: Yeah I wondered the same thing when I posted that command the other day but then I'm pretty sure I wouldn't have done all that horrible file permissions stuff if this worked.  It's so long ago I don't know the real answer...  I suppose it could be tested, but I haven't inclination currently.  That folder permissions did stuff like add Everyone and Users to the folder which I'm not convinced is the same as simple file permissions.  I'm actually only using that command on Macs since a framework customer discovered it was needed in order to change users and still be able to play the game (which is really what my code is for on PC). <br><br></td></tr></table><br>
<a name="1082280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bare in mind you can only read from the app bundle when you package for the app store. packagebuild changes the permissions and you can't change them back. It's fine to read data from the app bundle, but not write to it. you have to save to somewhere like Application Support.<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1083218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I'm definitely only reading from it.  All writing is in the approved path (on Mac and PC). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
