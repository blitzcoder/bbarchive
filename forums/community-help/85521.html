<!DOCTYPE html><html lang="en" ><head ><title >C/C++: Returning References?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >C/C++: Returning References?</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=125" >General Help</a>/<a href="#bottom" >C/C++: Returning References?</a><br><br>
<a name="967670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been having a look at Ogre, possibly with a view to wrapping it for BlitzMax, but I'm finding it very much designed for C++ and kinda hard to make a C wrapper for. Aside from templates and returning UDT's by value, I've found this function declaration.<br><br>const PluginInstanceList&amp; Ogre::Root::getInstalledPlugins  (   )  const <br><br><br>Two things immediately strike me about this.<br><br>1) I have no idea what returning a reference is all about. I don't know what it does or why. A pointer to a PluginInstanceList would make sense, but returning a reference, nope, don't get it. I can't find it in my books either, although it's probably there somewhere.<br><br>2) How do I give that a C wrapper?<br><br>My first instinct is to do this:<br><br><pre class=code>
OGREEXPORT const PluginInstanceList&amp; OgreRoot_GetInstalledPlugins(Root* Ha) {
	return Ha-&gt;getInstalledPlugins();
}
</pre><br><br>But that tells me I'm missing a type specifier. Possibly because of the const in the return? If I remove the const, I get a syntax error before the &amp; character, so it doesn't like that either. <br><br></td></tr></table><br>
<a name="967693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The '&amp;' is the reference operator and can be read as 'address of variable' whereas the '*' is the dereference operator and can read as 'value pointed by variable'.<br><br>This <a href="http://www.cplusplus.com/doc/tutorial/pointers/" target="_blank">pointers tutorial</a> should clarify and this <a href="http://www.embedded.com/story/OEG20010311S0024" target="_blank">references tutorial</a> is also worth a read.<br><br>Consts in C++ are really confusing so you should look it up if you're not sure. There was a good const tutorial I read but can't seem to find it now. Anyway, here's a good const tutorial on <a href="http://en.wikipedia.org/wiki/Const_correctness" target="_blank">wikipedia</a> and another on:<br>http://www.parashift.com/c++-faq-lite/const-correctness.html <br><br></td></tr></table><br>
<a name="967701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I understand what references and pointers are, I just don't understand returning a reference, conceptually. It seems like you would end up with a ghastly syntax in order to use it.<br><br>It would be something like:<br><br><pre class=code>
DoSomethingWithA(A)=B;
</pre><br>Wouldn't it? I'd have hated C++ even more if I'd known this was possible.<br><br>I think my mistake in wrapping the function comes down to a scope problem. I assumed that PluginInstanceList was a class of it's own, but it appears to be a vector of plugins within the Root class, so I needed to add Root:: in the function prototype.<br><br>So I think I'll either have to wrap vectors as well, or just create an array of the plugins C-side and return a pointer to it. <br><br></td></tr></table><br>
<a name="967721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Returning references are fun in BlitzMax... until you actually return it, and it goes out of scope :-) <br><br></td></tr></table><br>
<a name="967751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> For references on references, see wxBitmap, wxColour, wxBrush, wxPen etc in wxMax.<br><br>Well, it's one way around the issue, and works for me.<br><br>On a different note, all wxEvents are actually return using their reference, rather than a pointer. I can do that, because I know the event will remain in scope for the duration that it is used. (i.e. directly after being raised by the system). Once the event callback returns though, the memory for the event will be undefined, having gone out of scope in the library.<br><br>Fun fun.<br><br>And of course, different libraries work in different ways, which just adds to the overall general fun-ness :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
