<!DOCTYPE html><html lang="en" ><head ><title >Compiler question - what are 'side effects'?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Compiler question - what are 'side effects'?</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=125" >General Help</a>/<a href="#bottom" >Compiler question - what are 'side effects'?</a><br><br>
<a name="1213966"></a>

<a name="1213968"></a>

<a name="1213969"></a>

<a name="1213970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya all,<br><br>Within the world of the compilers and the semanting phase I've seen mentions of expressions/functions having possible side effects and I'm trying to fully and completely understand what these are. I've done the usual googling and found some resources that relate 'side effects' as say a global variable ( declared outside of a function ) being altered inside a function, or in the case of cpp 'b = ++a' which I see b is assigned to the value of a with the side effect of a being incremented first, but I don't understand how this matters during compilation/semanting :/<br>So, using BlitzMax as the source language is it possible for these 'side effects' to be of concern?, if so could someone show an example with an explanation please? <br>Would it be something like say converting an rvalue of type Int into a type of String so as to allow a valid expression for an assign statement which has an lvalue of type String?<br><br>Many thanks! <br><br></td></tr></table><br>
<a name="1213972"></a>

<a name="1213974"></a>

<a name="1213975"></a>

<a name="1213977"></a>

<a name="1213978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> A "side effect" means that the function "does" something, has a lasting "effect" on the world as a result of being called. It mutates some global resource - but that doesn't just mean global variables, it means <i>any</i> global resources: files, streams, buffers, objects passed in by reference, etc.<br><br>The alternative to a side-effecting function is a "pure" function, so called because it is pure in the mathematical sense of simply mapping input values to a returned value. Pure functions do not touch anything outside of their own internal variables, and do not read anything other than their parameters. Pure functions by definition do not manipulate BlitzMax-style objects since a referenced object is a global resource, but they can potentially read an object's fields.<br><br>Side effects aren't really important to the compiler, so much as their absence: if you can prove there are <i>no</i> side effects and that a function is pure you can do a lot of useful things:<br><br>-- you can usually inline it much more easily<br>-- you can remove dead code more easily<br>-- you can evaluate any pure functions called with constant values at compile-time, and treat the results as constant because you know the value will never be affected by anything else that happens<br>-- you can <i>partially</i> inline or specialize pure functions called with semiconstant arguments<br>-- you can automatically parallelize/multithread it as much as you like<br>-- you can try to work out the underlying algorithm and rewrite the actual logic to something more efficient<br><br>... whereas a side-effecting function leaves the world in a different state after it runs, and you can't get rid of it or change it very easily at all because if you move or remove it, the changes to the world won't have happened, or won't have happened in the right order.<br><br>BlitzMax is an inherently effectful language because it's based on the notion of a series of instructions that modify the world, so this analysis is only vaguely useful because almost everything will be effectful and it's almost easier to just assume everything has a side effect. Pure functions are mostly interesting in mathematically-focused languages like Haskell and ML (where the program is more like an operation mapping input to output, than an instruction stream), where variables are usually immutable. Such languages are also usually more reliant on the compiler to produce efficient code at all, whereas BlitzMax programs are usually straightforward enough not to need these things.<br><br><br>Note however that functional languages also usually operate at a higher abstraction level and don't make things like memory allocation visible to the user, so your example would usually be considered "pure" even though it allocates a string object behind the scenes. Since BlitzMax also has the option to work at the level of raw memory, it's near impossible for anything <i>in BlitzMax</i> to be pure that isn't limited to integers and floats only. So what specifically counts as an effect is also to an extent determined by the language; ones that completely hide all low-level memory work from the user have a great deal more freedom to rewrite code dealing with objects (usually don't draw a distinction between objects and values at all). <br><br></td></tr></table><br>
<a name="1213980"></a>

<a name="1213981"></a>

<a name="1213982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Yasha, it's very easy for me to understand the way you have explained them.<br><br>So with that in mind, out of curiosity, does the same analogy apply to Objects? if you have well designed OO objects that have a well designed interface of methods that only work on the objects private member variables ( and the private variables are not accessible from outside the object, so you would have setters/getters ) - how would such an object be classified ? Can it be classified in the same way? <br><br></td></tr></table><br>
<a name="1213987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ....<i>yeeeees</i> but probably not in the way you're looking for.<br><br>I think to have a meaningful equivalent for objects you'd need the object itself to be immutable (all fields const), which guarantees that every call to its methods doesn't involve changing state in the form of setting or updating fields of the object. If there are "setters", then the system is not pure: something gets changed.<br><br>There <i>are</i> so-called OOP systems that work this way (here's one courtesy of the great Oleg: <a href="http://okmij.org/ftp/Scheme/#pure-oo" target="_blank">http://okmij.org/ftp/Scheme/#pure-oo</a> ), but since they don't allow objects to be updated, the code you would end up writing is very different from idiomatic BlitzMax: "update"/"modification" is achieved by returning a new, slightly different, copy of an object; there are no setters as normally understood. <br><br></td></tr></table><br>
<a name="1214006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I was thinking of the same analogy applying at the 'object level'. In a sense the same as you have a 'pure function' not effecting anything outside of itself, if you scale the analogy up to the 'object level' whereby only fields/variables within itself are altered and no 'outside' code/objects are effected by any code within it, giving a 'pure object' in essence.<br><br>Does such a system not qualify because each method/function alters variables outside of itself ( therefore breaking the concept ), even though its still within the object? Or is it called something else? <br><br></td></tr></table><br>
<a name="1214027"></a>

<a name="1214029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does such a system not qualify because each method/function alters variables outside of itself ( therefore breaking the concept ), even though its still within the object? Or is it called something else?  <br></div><br><br>Depends on one big question. Do you allow sharing of resources/references? (At the <i>semantic</i> level: whether you implement it with pointers is immaterial.)<br><br>In the normal OO model, if you passed an object as a parameter to a setter and it was added as a property of the main object, that parameter is still (potentially) referenced from outside. It can still be internally modified by calls to its own methods, which means that changes can happen without the knowledge of the "owning" object. This system is not "pure" in the above sense, as the same method call could have different results depending upon what happened to an invisible value in between.<br><br>If however you do something different, things get interesting.<br><br>Firstly, if all setters copy (or implicitly copy) their arguments - imagine passing every struct by value in C++ - then whatever gets passed in is separated from the outside world and any external references are cut off from it. This system does have the <i>potential</i> to be pure because running a setter is implicitly the same as returning a copied, modified owner object (methods could implicitly reassign to the same lvalue they were called on; rvalues can't call setters). You could build a normal language using an OO system a bit like Oleg's in this way.<br><br>Secondly, and even more interestingly: if anything passed as an argument <i>stops existing in its original scope</i>, you have an enforced single-ownership system called "linear typing". Not only does this potentially allow for purity, it also <i>completely removes</i> the need for any form of GC, because the lifetime of every object can be predicted by the compiler. (Some things in this system get a bit weird, e.g. You have to have a "swap" operator to switch the values of a variable and an array slot or you'd get an array with holes in it.) Linear types a very interesting to people developing new system languages at the moment because of this property of allowing for perfect memory management without a GC.<br><br><br>Purity in the functional sense is also called "referential transparency". You can call whatever you want "pure", but I don't think it's ever the same thing in OO; there just happen to be some systems (like Oleg's) that are isomorphic to a functional representation. Most aren't.<br><br>To actually answer the question I think what you described is more just "good design". Without some additional constraint though it provides little useful information to the compiler (e.g. Smalltalk, Lua both already do this). <br><br></td></tr></table><br>
<a name="1214093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The feeling is the same when you see playing two great champions of chess, understand nothing but I think it's wonderful to see sintelectuales do talk about a topic, and you always learn something new. <br><br></td></tr></table><br>
<a name="1214141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's strange that you mention garbage collection as that was where my thoughts were going, and you've already briefly explained what would need to happen to get it work reliably without a GC.<br><br>Thankyou Yasha for the little lecture, it's been very interesting. I'll leave things here for the mean time and carry on with my compiler before I end up wondering off on a tangent from my original project goal :D<br><br>I remember reading sometime ago that you are CS undergraduate, are you still studying or have you now graduated and moved on? <br><br></td></tr></table><br>
<a name="1214235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you're actually interested in alternative memory management techniques, another one to look into (unrelated to the above) is "region inference". Unlike linear typing it has the advantage of working with "normal" program code, although you need to tweak it a bit to prevent space leaks (the original ML version has a few critical flaws, but people have it working for Java now - for RTJ that doesn't allow for a GC - so it must be more or less fixed).<br><br><br>I did a CS postgraduate degree a while back. Still thinking about going back for a PhD. Finally now working on a paper of my own. etc. <br><br></td></tr></table><br>
<a name="1214391"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am interested in memory management that doesn't require the use of a 'traditional' GC mechanism, especially one that fits naturally into a multi-processor environment.<br><br>I wish you all the best with the thesis. I know of a few friends who are going for a PhD ( not CS related ) and although they really enjoy it they say it is long hard work. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
