<!DOCTYPE html><html lang="en" ><head ><title >Operators priority when designing a language?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Operators priority when designing a language?</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=125" >General Help</a>/<a href="#bottom" >Operators priority when designing a language?</a><br><br>
<a name="1133639"></a>

<a name="1133641"></a>

<a name="1133642"></a>

<a name="1133644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The POW operator is very weird.<br>I'm right to assume that the unnary - operator should have less preference than the POW operator, when it is placed at the left of the operator, and have more preference than it when it is at the right?<br><br>I mean:<br>-2^2 should be -4<br>2^-2 should be 0.25<br>Does this lookd right? I'm finding it a bit weird that the operators execution prefence depends on possition, but this is what looks much more natural to me. Any ideas? I'm doing it this properly?<br><br>Also, currently I'm processing operators in this order:<br>( ) parenthesis<br>+, -, ~  unnary when are part of an exponent on a POW operation<br>^   POW<br>+, -, ~  unnary when are NOT part of an exponent on a POW operation<br>*, /, %  Multiplication, division and modulus, in order from left to right<br>+, -  Addition and substraction in order from left to right<br>++  String concatenation in order from left to right<br>&amp;  Bitwise AND operator<br>|, ~  Bitwise or and xor operators<br>shl, shr  Butwise shift operators<br>=, &gt;, &lt;, &gt;=, &lt;=, &lt;&gt; Comparison operators<br>And  Logical AND operator<br>Or  Logical OR operator<br><br>Does this order makes sense? I'm doing it based on my experience using compilers, so I always have the feeling that I'm missing something...<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1133646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does this order makes sense? <br></div><br><br>No, for one very simple reason:<br><br>Each operator should appear in the list once and only once.<br><br>By making unary operators apply to the whole of a POW expression, you are creating an unnecessary inconsistency, and increasing the complexity of the grammar, because they need to appear in the second position below it as well, and then you <i>also</i> need more contextual information to decide which way things should be parsed...<br><br>It would make a whole lot more sense to just leave them at the top (which is the only place where they can really be consistent), and have (- 2 ^ 2) = 4.<br><br>Also, consider the expanded versions. Which of these looks more awkward:<br><br>(- 2) ^ 2<br>- (2 ^ 2)<br><br>To me, the first one looks silly, and shouldn't appear unless the programmer has an unnatural love of parens, because the parens don't <i>look</i> like they're grouping anything. In the second, the parens are visually clearly fulfilling their usual role. Therefore the first one would be the one to make the implicit order of operations, so it doesn't have to ever be written out.<br><br><br>...of course, as always, order of operations is just a convention, not a mathematical law. If your language isn't directly based on another one, you can get away with changing it (conversely, if your language is based on e.g. C you should copy C, <i>whether you think it's right or not</i>, or people will have a touch time using it easily, because they will expect it to work in a different way). <br><br></td></tr></table><br>
<a name="1133652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The windows calculator tells me that -2^2 is 4.<br>Blitzmax thinks it's 4.<br>Online-calculator.com thinks it's 4.<br><br><a href="http://en.wikipedia.org/wiki/Order_of_operations" target="_blank">http://en.wikipedia.org/wiki/Order_of_operations</a> <br><br></td></tr></table><br>
<a name="1133653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Also, currently I'm processing operators in this order:<br>( ) parenthesis<br>+, -, ~ unnary when are part of an exponent on a POW operation<br>^ POW<br>+, -, ~ unnary when are NOT part of an exponent on a POW operation <br></div><br>Even in your definition -2^2 is 4 <br><br></td></tr></table><br>
<a name="1133654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok in other words:<br>X = 2<br>Y = - X ^ 2<br>Are you sure you would expect Y to be 4 instead of -4 ? <br><br></td></tr></table><br>
<a name="1133656"></a>

<a name="1133658"></a>

<a name="1133659"></a>

<a name="1133662"></a>

<a name="1133664"></a>

<a name="1133665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I believe theri is a bug in BMax as these 2 equations should produce the same result but they dont:<br>0-x^2<br>-x^2<br><br>the correct result should be the top one.<br><br>-2^2 should be 4 not  negative 4 and is the same as (-2*-2)<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1133666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> these 2 equations should produce the same result but they dont: <br></div><br><br>No, they shouldn't. They're completely different operations, as discussed above. 0 - x is a <i>binary</i> minus, which is of lower precedence than ^. - x is a <i>unary</i> minus, which is of higher precedence then ^. In BlitzMax this is not a bug, it is entirely as the Good Docs say.<br><br>The discussion is about whether it would be sensible to change this behaviour in Ziggy's language.<br><br>Incidentally, what is the language like/based on? Suggestions on this sort of topic should take into account what your design goals are, and who is supposed to use it.<br><br><br>So...<br><div class="quote"> Are you sure you would expect Y to be 4 instead of -4 ?  <br></div><br><br>...definitely. I would expect a good design-related reason for breaking convention. Otherwise, you're just changing the precedence rules users are expecting. <br><br></td></tr></table><br>
<a name="1133667"></a>

<a name="1133670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I believe theri is a bug in BMax as these 2 equations should produce the same result but they dont <br></div>No it's not a bug, the first example, the - is a substraction, the second example the - is a unnary operator (negative of). The unnary operator has higher prefence on the calculation chain, so it is set before the POW happens, and the final result is possitive, while in the substraction sample, the POW happens before than the substraction, leaving a negative result.<br>I'm just seeing that BlitzMax does give higher priority to unnary operators always and if that has worked for this long, I supose it's the way to go<br><br><div class="quote"> I would expect a good design-related reason for breaking convention <br></div>Of course. I was just thinking on some comments made by Floyd here: <a href="http://www.blitzmax.com/Community/posts.php?topic=97373#1130844" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=97373#1130844</a><br>But, after making some tests, I do not think it was a good idea in the first place, so I think I'll leave unnary operators only at the first level, just after ( ).<br><br>Other than that, do you think the operators processing order is the one you would expect on a general purpose language?<br><br>The language I'm designing is just an interpreted basic-like language written in Monkey with the idea that it can then run in any kind of device. It's just a sort of research project, not a commercial one, and it is still in very early status (more info here: <a href="http://code.google.com/p/harpl-project/wiki/WhatsHarpl" target="_blank">http://code.google.com/p/harpl-project/wiki/WhatsHarpl</a> )<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1133671"></a>

<a name="1133672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>No it's not a bug, the first example<br> <br></div><br>I got that from Yasha  and since I didn't know for sure and I wasn't convinced I looked it up:<br><a href="http://en.wikipedia.org/wiki/Order_of_operations" target="_blank">http://en.wikipedia.org/wiki/Order_of_operations</a><br><br>He is right.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1133673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Other than that, do you think the operators processing order is the one you would expect on a general purpose language? <br></div><br><br>Pretty much. Seems fairly conventional. You've got an unusual precedence for shift operators, but that seems to vary anyway (different between BlitzMax, Blitz3D, and C), so could be a non-issue.<br><br>I definitely like the choice to make string concatenation a distinct operation from addition. That might make things a little cleaner and eradicate some weird bugs for beginners... and it makes more logical sense.<br><br>Looks like a cool project. <br><br></td></tr></table><br>
<a name="1133675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>-2^2 should be -4<br>2^-2 should be 0.25 <br></div><br><br>Both are correct.<br><br>The POW operator ^ should have higher precedence than unary minus. Thus -2^2 is -(2^2).<br><br>In the second example 2^-2 is 2^(-2). This is not because unary - suddenly has higher precedence. It is because there is no other possible interpretation.<br><br>^ has two operands so an expression must be of the form<br><br>op^op<br><br>Unary minus has one operand and an expression must be<br><br>-op<br><br>In the first example we must choose between (-2)^2 and -(2^2). We choose -(2^2) because ^ has higher precedence.<br><br>In the second example we get 2^(-2). It can't be anything else no matter what precedence we use. <br><br></td></tr></table><br>
<a name="1133678"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Looks like a cool project.  <br></div><br>Thanks, we'll see where it ends...<br><br>Do you think using the ~ operator both for xor and for unary compliment is a good idea? (I really don't like using the same operator for 2 different things, except in cases like unary and binary operators, but in this case, I'm not sure it is a good idea.) <br><br></td></tr></table><br>
<a name="1133680"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This is not because unary - suddenly has higher precedence. It is because there is no other possible interpretation. <br></div><br><br>This is exactly why unary minus conventionally has higher precedence than ^. Because in your example, putting it on the right argument means <i>it suddenly has higher precedence</i>.<br><br>Your rule is flat-out inconsistent. It's arbitrarily changing the precedence of an operator based on the expression around it, which violates the whole point of operator precedence. Operators should appear once and only once in the table.<br><br><div class="quote"> Do you think using the ~ operator both for xor and for unary compliment is a good idea? <br></div><br><br>It seems to work well enough for BlitzMax...<br><br>Your other option is to invent a new operator, or use a text operator (advise against, would introduce confusion with the logical operators). As far as I know the only other "standard" is to use ^, which you're already using for something more intuitive. <br><br></td></tr></table><br>
<a name="1133681"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll go for unary higher preference than ^ for the compiler, and maybe provide a POW function too, just to help preventing this confusion (lots of languages do it as a funtion too, so I supose it's also a good idea). <br><br></td></tr></table><br>
<a name="1133687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This is exactly why unary minus conventionally has higher precedence than ^. Because in your example, putting it on the right argument means it suddenly has higher precedence. <br></div><br><br>My example was 2^-2 being evaluated as 2^(-2). That's not operator precedence. It's simply because the single operand of unary minus must be to the right of the - symbol.<br><br>What else could 2^-2 be? The only other choice is to do first ^ and then -, yielding -(2^2), which is obvious nonsense. <br><br></td></tr></table><br>
<a name="1133690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ...and maybe provide a POW function too... <br></div><br>That's a reasonable workaround, but I've never liked it. I prefer mathematical expressions to look as much like handwritten work as possible.<br><pre class=code>
x² + y²                would be ideal
x^2 + y^2              is acceptable
pow(x,2) + pow(y,2)    well, I can live with it if necessary
</pre> <br><br></td></tr></table><br>
<a name="1133691"></a>

<a name="1133693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> The fact that the alternative is obvious nonsense is <i>why</i> unary minus has a higher precedence; there's no other alternative.<br><br>A system which follows your proposed rule could be entirely legitimate, but it wouldn't be a precedence-based system, and mixing it with operator precedence wouldn't make any sense. If you use operator precedence, -2^2 has to equal 4, or the system is inconsistent. If unary minus has a lower precedence than ^, you'd better get to work finding a way to make that ^ come first in 2^-2.<br><br>...which is why every other precedence-based notation follows this rule.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1133692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK<br>Its because 2^-2 doesn't exist<br><br>Its just that on a keyboard its a pain to type 1/2^2 or 1/(2^2) and it be obvious what belongs to which.<br>So the negative POW is taken to mean one over the positive power answer <br><br></td></tr></table><br>
<a name="1133697"></a>

<a name="1133698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ...which is why every other precedence-based notation follows this rule. <br></div><br>That is certainly not true. I've seen both ways, but prefer exponentiation to have higher precedence than unary minus.<br><br>That's the way it is with my TI calculator, or with Visual Basic.<br><br>I just checked -2^2 on the calculator. It evaluates as -4.<br><br>By the way, the calculator makes it's own life easier by having separate symbols for unary minus and subtractions, which I don't really like, but can tolerate.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1134098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shortwind</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> A review of how negative numbers actually work would be in order here:<br><br><a href="http://mathforum.org/library/drmath/view/57866.html" target="_blank">http://mathforum.org/library/drmath/view/57866.html</a> <br><br></td></tr></table><br>
<a name="1134125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> We know how do they work, it is a mather of how the compiler should organize its calculation. As instance; BlitzMax, VB.net and C do evaluate negative signs and exponents differently, so not really 100% clear.<br>For my small compiler, I'm going to priorize unary operators over any other operator. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
