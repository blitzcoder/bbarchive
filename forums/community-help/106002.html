<!DOCTYPE html><html lang="en" ><head ><title >how to exit a double for next loop ?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >how to exit a double for next loop ?</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=125" >General Help</a>/<a href="#bottom" >how to exit a double for next loop ?</a><br><br>
<a name="1300164"></a>

<a name="1300165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, :)<br><br>I am curious which method you use to exit a double for next loop ?<br>In the past i used "Goto .Line", it worked well.<br>Then i learned about "Exit", and it worked well for unique for next loop.<br>But when you want to exit a double for next loop, using "Exit" is not enough because it only exits the current for next loop...<br>See :<br><pre class=code>
Graphics(640,480,32,2)

Global ncount%
Global nncount
For n% = 1 To 10 Step 1
 ncount = ncount + 1
 For nn% = 1 To 10 Step 1
  nncount = nncount + 1
  If( nncount =&gt; 5 )
   ;Exit
   ;Goto LineEndProcedure 
  EndIf
 Next
 If( ncount =&gt; 5 )
  ;Exit
  ;Goto LineEndProcedure
 EndIf
Next
.LineEndProcedure
DebugLog("ncount = "+ncount)
DebugLog("nncount = "+nncount)

WaitKey()

End()
</pre><br><br>"Goto .Line" works well but some say it is bad to use this (i don't agree, if you know how your code flows, and you know how to debug your code, there is no problem)<br><br>Is there another method to achieve the same thing ? (exit a double for next loop)<br><br>Thanks, <br><br></td></tr></table><br>
<a name="1300170"></a>

<a name="1300175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Generally I use a flag variable.<br><br><pre class=code>
exit_flag = False
For y = 1 To 10
	For x = 1 To 10
		If x = 5 Then exit_flag = True : Exit
	Next
	If exit_flag Then Exit
Next

Print x

WaitKey
End
</pre><br><br>Using Goto to jump out of a loop would probably lead to the resources for the loop not being freed, resulting in memory leaks and other issues. It's likely a prime example of why the use of Goto is discouraged. <br><br></td></tr></table><br>
<a name="1300171"></a>

<a name="1300172"></a>

<a name="1300173"></a>

<a name="1300220"></a>

<a name="1300221"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im afraid not. Using a label and goto is the only way for Blitz3D and BlitzPlus.<br><br><strike>BlitzMax has this:<pre class=code>
#top
For y = 0 To 480-1
	For x = 0 To 640-1
		If y = 240 Then Exit top
	Next
Next
</pre>which isnt much different than putting a label at the bottom and using a goto instead.</strike><br>Turns out i remembered wrong ;) At least While/Repeat has it. For really should have this too!<br><br>Dont fuss about using Gotos. Anyone who says they are bad are simply parroting a paper from the 1968 in a time where people used ONLY gotos and line numbers for flow control.<br>IE it doesnt apply today, unless perhaps for complete beginners.<br><br>EDIT: I was too slow ;)  The flag thing works too. But if your in tight loops, having to add an additional compare might make things a tad slower. <br><br></td></tr></table><br>
<a name="1300180"></a>

<a name="1300181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for your examples.<br><br><br><div class="quote"> <br>Using Goto to jump out of a loop would probably lead to the resources for the loop not being freed, resulting in memory leaks and other issues.<br> <br></div><br>@Zethrax&gt;&gt;What "ressources" ? you mean n% and nn% ? <br><br></td></tr></table><br>
<a name="1300185"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> simple answer:<br>don't use for/next, use while/wend or repeat/until with a trip variable so it can exit <br><br></td></tr></table><br>
<a name="1300187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Using Goto to jump out of a loop would probably lead to the resources for the loop not being freed, resulting in memory leaks and other issues. <br></div>The same could be said for any exiting flow control, like Return or Exit too.<br>If some resources does leak, its fully a fault of the programmer for forgetting to Free them, which would happen with or without a Goto.<br><br>And im quite sure the blitz family of languages cleans up its stack scopes (if it even has them) when doing Goto.<br>Most if not all languages do, even C if it goes deep enough. <br><br></td></tr></table><br>
<a name="1300188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, if you use nested For..Eachin (list) the flag/exit solution its still the best one.<br>I'm quite sure that Exit #Label works only in debug mode (never used so this could be just my wrong memory!) <br><br></td></tr></table><br>
<a name="1300189"></a>

<a name="1300190"></a>

<a name="1300191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bmax could definitly have use for a EXIT #, I've needed it several times already and just got tired to need patch every FOR NEXT into a ugly WHILE/REPEAT, same goes with using variables in FOR NEXT LOOPs. It seems like everything needs to become an WHILE/REPEAT in the end to get enough flexibility.<br><br>Using flag variables would add more logic and noise and not a good solution.<br><br>The GOTO HELL era was more about using GOTO as the *fundamental* construct* in program design, and ya that creates nothing but spaghetti code. <br>But to use GOTO in an orderly fashion within a block of code, that's perfectly okay. That's still structure.<br><br>(btw a EXIT label command is nothing but a GOTO, so i just look at GOTO as a missnamed "EXIT label") <br><br></td></tr></table><br>
<a name="1300192"></a>

<a name="1300193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I must say, old instincts creates something disturbing with having to exit a for next loop using a GOTO.. <br>as you never know what happens underneath the surface. The documentation should take care of to make the programmer confident that.. "it's okay". <br><br></td></tr></table><br>
<a name="1300222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems i remembered wrong about #labels and For in BlitzMax :/ Now i want it!<br><br>I rarely use Goto in BlitzMax to be honest, as i code primarily in SuperStrict where its disallowed for some oddball reason.<br>I could just go Strict, but i still like being in SuperStrict nonetheless.<br><br>In C though, i use it all the time. Nothing beats it when you have multiple exit points that do virtually the same thing (usually error handling).<br>Im especially fond of Computed Gotos for manual jump tables, great for building state machines, lexers, virtual machines etc. <br><br></td></tr></table><br>
<a name="1300225"></a>

<a name="1300226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Im especially fond of Computed Gotos for manual jump tables <br></div><br><br>Be sure to check your output assembly if you use this. GCC has a <i>pessimization</i> pass that sometimes runs to convert `goto *label` into the equivalent of a while/switch construct. I don't know why it does this, nor exactly what conditions trigger it, but the GCC developers seemed to think that having `goto *label` actually compile down to a `jmp *register` was a bad idea in certain circumstances.<br><br><div class="quote"> Dont fuss about using Gotos. Anyone who says they are bad are simply parroting a paper from the 1968 in a time where people used ONLY gotos and line numbers for flow control. <br></div><br><br>I disagree heartily with this, for the very simple reason that adopting this attitude will usually end up with the code degenerating across the board. e.g. for the original problem in this thread, goto is <i>not</i> the simplest solution, return is. The programmer who objects to moving the loops into a separate function needs to get over their aversion to abstractions, not to find ways to avoid refactoring. A well-designed function doesn't have these nested-layers-of-control problems in the first place - it's short and flat and constructs flow out of single blocks, or by composing higher-level abstractions (i.e. map).<br><br>By taking the shortcut and using a goto here, you're ignoring a sign that the code was badly structured and too deeply nested in the first place. Goto is harmful for this reason alone. Use more functions. Never repeat a control structure if you can help it. <br><br></td></tr></table><br>
<a name="1300228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alternatively you could turn it into a single for loop and calculate your x and y each iteration and jump out of just one loop with a flag/exit. <br><br></td></tr></table><br>
<a name="1300234"></a>

<a name="1300235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like to use goto label in some cases because it follows the way i think and it simplifies the code (imo).<br>If you understand how your code flows and how to debug it, then there is no reason to have mysterious errors when using goto label.<br>I really don't understand why goto label has such a bad reputation... (especially in small procedures functions = no "spaghetti code")<br><br>Anyway, thanks for your suggestions.<br><br>I like the alternative that Zethrax suggested, even if it is not simpler to use imo. <br><br></td></tr></table><br>
<a name="1300240"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Be sure to check your output assembly if you use this <br></div>I dit not know that, but i havent noticed it either to be honest. And i always check the assembly of critical code like that ;)<br><br>About Goto, well im glad i have the option of using it when i need to. I find the religious disdain for it laughable really.<br>If you consider it harmful and/or are unable to use it properly, then dont. But dont keep spreading FUD and in effect scaring people off it for no good reason.<br>Its a tool like any other, and requires its operator to use it properly.<br><br>Its becomes kinda like that <a href="https://skeptics.stackexchange.com/questions/6828/was-the-experiment-with-five-monkeys-a-ladder-a-banana-and-a-water-spray-condu" target="_blank">monkey experiment</a> ;) <br><br></td></tr></table><br>
<a name="1300247"></a>

<a name="1300249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> spreading FUD <br></div><br><br>The negative effect of working with goto is <b>literally demonstrated in action</b> in the thread above where you're advocating using goto as an escape-hatch to ignore poor structure instead of refactoring. Hardly dogma when it comes from empirical evidence that this usage directly harms code quality (in a way that can be objectively measured via code metrics, no less!).<br><br>I'mma revise my own recommendation back to "never use goto", since Dijkstra's lesson apparently <i>still</i> hasn't sunk in despite it being 48 years old and counting. The attitude expressed above is <i>exactly</i> the problem: if you start to "make exceptions" when you "know what you're doing", you write measurably poorer quality code than if you had the discipline to rewrite without it. <br><br></td></tr></table><br>
<a name="1300255"></a>

<a name="1300256"></a>

<a name="1300257"></a>

<a name="1300258"></a>

<a name="1300260"></a>

<a name="1300262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using code metrics is a pretty good straw man, since they add low scores for using goto on purpose!<br><br>So a double for loop is poor structure? Give me a break.<br><br>Good code:<br><pre class=code>
#outer
While i &lt; 10
  While j &lt; 10
    j :+ 1
    If j = 5 Then Exit outer
  Wend
  i :+ 1
Wend
</pre>Bad code:<pre class=code>
While i &lt; 10
  While j &lt; 10
    j :+ 1
    If j = 5 Then Goto done
  Wend
  i :+ 1
Wend
#done
</pre><br>Sorry, i see no difference between using Exit or Goto, they do the exact same thing. Even at the assmebly level. Its just one is more powerful than the other.<br><br>And no, im not making exceptions since i dont ascribe to the notion its harmful in the first place.<br>What im saying is know how to use it properly, apparently it has taken 48 years and people STILL dont know how ;) <br><br></td></tr></table><br>
<a name="1300263"></a>

<a name="1300264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nested loops <i>are</i> poor structure. Not cripplingly poor on their own, but <i>all</i> explicit control statements add complexity and potential confusion to code. So the problem with the example above is that you're trying to find a way to inline the loops into the surrounding body code, rather than factoring out the loop machinery. <i>Goto is enabling you to do this</i> and encouraging you not to excise explicit use of nested loops from your code, which would make it better by reducing the amount of explicit control machinery interleaved with your logic flow. Idealized code does not mix abstraction levels.<br><br>There is no difference between Goto and named-Exit in this scenario. The code is identical. There is no reason to use either of them because you should be moving the loop and loop-exit operation away from the operational code that makes up the loop body. If you need two loops, find a way to cleanly compose them into one operation first, then apply it to the operations it's supposed to control.<br><br>Again: the insistence that the above constitutes "proper use" <i>is the entire problem</i>. It obstructs the option to ditch nested control structures altogether and use a clean design for the program instead. The above <i>is</i> a pathological usage. <br><br></td></tr></table><br>
<a name="1300268"></a>

<a name="1300269"></a>

<a name="1300270"></a>

<a name="1300271"></a>

<a name="1300274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> A case which is more meaningful that the code that i have posted in post#1 is if i want to determine if one entity of a list occupiesthesameplace/intersects with another entity of another list, and if i find that yes, i can exit the double for next loop more quickly (with goto label or 2 exit + a state variable as Zethrax suggested)<br><br><br>@grable&gt;&gt;good examples, some fanatics will probably bug when they see that ;)<br><br><br>@Yasha&gt;&gt;I have no idea what you are talking about, all i know is that my code represents my thinking and works fast enough and has no bug... (i know that i am not at your level, but i can still code some good things you know, even if the form is not ideal) <br><br></td></tr></table><br>
<a name="1300275"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then what would you consider a "clean" design?  There is such a thing as over-engineering or over-abstractionism in this case.<br>Sometimes a loop is just that, a loop.<br><br>No need use fancy functional programing aspects like Map, Fold, Zip and the like. <br>Yes, they make some code look pretty nice, and for the most part, "when used properly ;)" they do their job with enough efficiency.<br><br>But all abstractions carry with them a cost, in either memory or cycles. And i care about my code enough to limit the amount and especially levels of abstractions. Because i find too much abstraction is even worse for readability than piling it all into one function (not that i do that very often mind)<br><br>Im a low-level guy and smell of assembly when coming home from work, so that may be the reason i dont ascribe to all these "x considered harmful" things.<br>Give me ANY primitive and i can probably find multiple ways to abuse them, but that doesnt mean we should get rid of them!<br><br>Right tool for the right job and all that :p <br><br></td></tr></table><br>
<a name="1300285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I disagree. Coding is an art. Code the way YOU want to code! Do NOT listen to their programming standards bullshit! As long as it works, it's clean, fast, &amp; efficient then do it the way YOU feel is best for YOU! Stop taking pointers from "the man" on syntax positioning &amp; come up with your OWN style of coding! SCREW THE MAN! &lt;3<br><br>~GF <br><br></td></tr></table><br>
<a name="1300286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Yasha<br><div class="quote"> Nested loops are poor structure. <br></div><br><br>Ok... What would be good structure/less confusing code when iterating through all tiles on a map without using a nested x and y loop for example? <br><br></td></tr></table><br>
<a name="1300292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Computed GOTO's are not a good idea I think, and I've thought long and hard about that bc I used to love it too, CASE replaces that technique COMPLETELY and using a better approach IMO. CASE is a beituful thing when used right. <br><br></td></tr></table><br>
<a name="1300294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just on a related note.. <br><br>I divide code golfing into two categories.. tricks that actually REVEALS meaning, and tricks that HIDES it. <br><br>I love the 1st kind. That's what code is all about. <br><br></td></tr></table><br>
<a name="1300298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, switch/case does look better. But doesnt always perform great.<br><br>One can hide computed gotos pretty good using macros though. Enabling swapping it out for a switch/case or even an if/else chain without changing any of the code if need be. And with XMacros that pesky table goes away too ;)<br><br>For building VMs it cant be beat. Ive not seen GCC build a jump table out of my dispatch loops even once :(<br>And when that opcode list goes above 100+ its going start taking its toll on a switch/case.<br><br>Of course it cant beat a hand made VM in assembly, no compiler can. But making and debugging (the most important part) a pure assembly VM is painfull, and ive done my fair share of that so C it is hehe <br><br></td></tr></table><br>
<a name="1300315"></a>

<a name="1300316"></a>

<a name="1300317"></a>

<a name="1300318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure about how effecient CASE  is nowadays, but I would not say they are bad hardware wise if done correctly. <br><br>That made me think of something, haha anyone want to see a NES emulator handcoded in 30min from scratch every line hardcoded (speeded up abit).<br><br><iframe width="560" height="345" src="http://www.youtube.com/embed/y71lli8MS8s" frameborder="0" allowfullscreen></iframe><br><br>Most ppl shush about showing their code until their finished. You never see the actual WORK. All that sweat is the interesting stuff. Not the finished product.<br><br>Code style is such a personal thing, one should never do something just bc everyone else does it.<br>Find your own way that way you also might discover things others will not. <br><br></td></tr></table><br>
<a name="1300322"></a>

<a name="1300324"></a>

<a name="1300325"></a>

<a name="1300326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Find your own way that way you also might discover things others will not. <br> <br></div><br>like new ways to provoke errors/crashes/freezes ? ;) (just joking) <br><br></td></tr></table><br>
<a name="1300327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> That too, everything goes you know ;)<br><br>It's a package deal. <br><br></td></tr></table><br>
<a name="1300328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> @grable<br><div class="quote"> And when that opcode list goes above 100+ its going start taking its toll on a switch/case. <br></div><br>Sometimes i smell of assembler too.<br>Here's a dirty solution for BIG list based if/case statements<br><br>1. we need to have one thing in place. we will be making decisions of a number based options. E.G. opcodes from 1 to 2000<br>2. we now use a binary if ladder this is for 0 or 1:<br><br><pre class=code>
if opcode = 0
  do opcode0
else
  do opcode1
end if
</pre><br><br>now if there were 4 opcodes we extend the ladder by ONE if:<br><pre class=code>
if opcode &lt; 2
  if opcode = 0
    do opcode0
  else
    do opcode1
  end if
else
  if opcode = 2
    do opcode2
  else
    do opcode3
  end if
end if
</pre><br>finally lets do 8 opcodes with 3 IF commands<br><pre class=code>
if opcode &lt; 4
  if opcode &lt; 2
    if opcode = 0
      do opcode0
    else
      do opcode1
    end if
  else
    if opcode = 2
      do opcode2
    else
      do opcode3
    end if
  end if
else
  if opcode &lt; 6
    if opcode = 4
      do opcode4
    else
      do opcode5
    end if
  else
    if opcode = 6
      do opcode6
    else
      do opcode7
    end if
  end if
end if
</pre><br><br>it's dirty to look at but very efficient ;) <br><br></td></tr></table><br>
<a name="1300329"></a>

<a name="1300330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> When you code together in a big group it's important to speak the same style and not just the same language, <br>or to have the time to convert back and forth your private style and an outward/common style.<br><br>But when you code and need to connect yourself to solve something, you should just do whatever feels best for *you*, <br>and the rest of the world may aswell go to hell with their opionions. (Opionions which they have for the same reasons on their behalf).<br><br>That's important stuff. That's religous, in that you do something you feel good with in life. Not to be toyed with. That would just be respectless and tactless. <br><br></td></tr></table><br>
<a name="1300332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Those IF ELSE would make any processor puke cycles. I can't remember how SWITCH CASE are implemented.<br><br>Tables, Indirect jumps, but those are nonos with modern processors. But It would be far better than lots of sequential branches. <br>Somehow it minimise branches, you don't want branches. A good implemented SWITCH is powerful. I need to check how Bmax implements it later on.<br><br>But the outside is equally important, LOVE how it eliminates the noise of deep ELSIF clauses sometimes.<br><br>Select True<br>Case something = 5<br>Case something &gt; 10 And something =&lt; 20<br>Case something &gt;1000<br>.. 10 miles more of this would be no problem.. not for the programmer, not for the processor<br>Default<br>End Select <br><br></td></tr></table><br>
<a name="1300353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> @AdamStrange<br>Yeah, binary search does help somewhat. But its a bitch to code up manually ;)<br>Id much rather generate something like that, and when one is generating stuff one might as well generate the fastest code even if it looks horrible :p<br><br>I would expect a static binary search to be faster than a dynamic one.<br>But depending on the usage, the tests ive seen show that anyting less than 256 items and a linear search beats it (on relatively modern hardware).<br><br>@Casaber<br>BlitzMax is especially bad at Select/Case, it gets converted to an If/ElseIf chain at the assembly level. <br><br></td></tr></table><br>
<a name="1300354"></a>

<a name="1300358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is Bmax that cheesy in how it compiles? That's the output of a cheesy translator.<br><br>EDIT<br>Started reading how other does it, MS's compiler seem to be doing a good job.<br><br><a href="https://news.ycombinator.com/item?id=1301529" target="_blank">https://news.ycombinator.com/item?id=1301529</a><br><br><a href="http://www.codeproject.com/Articles/100473/Something-You-May-Not-Know-About-the-Switch-Statem" target="_blank">http://www.codeproject.com/Articles/100473/Something-You-May-Not-Know-About-the-Switch-Statem</a><br><a href="http://encosia.com/first-class-functions-as-an-alternative-to-javascripts-switch-statement/" target="_blank">http://encosia.com/first-class-functions-as-an-alternative-to-javascripts-switch-statement/</a><br><a href="http://embeddedgurus.com/stack-overflow/2010/04/efficient-c-tip-12-be-wary-of-switch-statements/" target="_blank">http://embeddedgurus.com/stack-overflow/2010/04/efficient-c-tip-12-be-wary-of-switch-statements/</a><br><a href="http://stackoverflow.com/questions/14067547/how-switch-case-statement-implemented-or-works-internally" target="_blank">http://stackoverflow.com/questions/14067547/how-switch-case-statement-implemented-or-works-internally</a><br><a href="https://sourcemaking.com/refactoring/replace-conditional-with-polymorphism" target="_blank">https://sourcemaking.com/refactoring/replace-conditional-with-polymorphism</a><br><a href="http://archive.oreilly.com/pub/a/server-administration/excerpts/even-faster-websites/writing-efficient-javascript.html" target="_blank">http://archive.oreilly.com/pub/a/server-administration/excerpts/even-faster-websites/writing-efficient-javascript.html</a><br><a href="http://www.embedded.com/design/programming-languages-and-tools/4397803/Interrupts-short-and-simple--Part-1---Good-programming-practices" target="_blank">http://www.embedded.com/design/programming-languages-and-tools/4397803/Interrupts-short-and-simple--Part-1---Good-programming-practices</a><br><a href="http://code.activestate.com/recipes/410692-readable-switch-construction-without-lambdas-or-di/" target="_blank">http://code.activestate.com/recipes/410692-readable-switch-construction-without-lambdas-or-di/</a><br><a href="http://www.dreamincode.net/forums/topic/172744-stack-implementation-using-arraydo-while-and-switch-case/" target="_blank">http://www.dreamincode.net/forums/topic/172744-stack-implementation-using-arraydo-while-and-switch-case/</a> <br><br></td></tr></table><br>
<a name="1300357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamStrange</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Those IF ELSE would make any processor puke cycles <br></div><br><br>You have to really look at what is happening in there:<br>In the above example for any of the 8 opcodes, there are only EVER 3 IF commands<br><br>it scales by a factor of 2<br><br>so for 16 opcodes, you would have 4 IF's<br>32 opcodes 5 IF's<br>..<br>256 opcodes would be 8 IF's<br><br>the more you have the more efficient it becomes<br><br>It looks awful, but the logic translates directly into assembler nicely <br><br></td></tr></table><br>
<a name="1300359"></a>

<a name="1300360"></a>

<a name="1300362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya It will be no problem whatsoever to translate that into assembler, it is 1:1. You could basically do it using search &amp; replace.<br>But to branch is not cheap you want to minimize jumps.<br><br>EDIT<br>Extreme tricks aside.. I guess it's down to 1 Indirect jump versus a few say 2-8 serialized branches, <br>I wonder which one messes up cache and prediction mostly. I couldn't say without testing as processors change so rapidly. It could be that the naive solution wins. If so then Bmax CASE will do great. <br><br></td></tr></table><br>
<a name="1300367"></a>

<a name="1300368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Control instructions are interesting, If that's bad then everything goes bad.<br><br>To exit double loops I guess you could use trick like setting the variables aswell, but that would not be an imm exit. I guess interesting in some cases. Less flags and you reuse the "if inside NEXT".<br><br>for temp  = 1 to 25<br>for temp2 =1 to 10<br><br>temp2=10 ; temp = temp = 25 ' make both happy, exit but finish the code from here<br><br>next ' exit when reached here<br>next ' exit when reached here <br><br></td></tr></table><br>
<a name="1300387"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't really get the problem here... <br>Code like that never just occurs "in the wild" in your program. If you've created a nested loop you'll need to break out of, it will basically always mean you were looking for something and found it, right? <br><br><pre class=code>
Function ValueExists:Int(value:Int)
	
	For Local x:Int = 0 To mapWidth - 1
		For Local y:Int = 0 To mapHeigth - 1
			If map[x, y] = value Return 1
		Next
	Next
	Return 0

End Function
</pre><br><br>I don't see how this can be optimized or cleared up any further? <br><br></td></tr></table><br>
<a name="1300404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Cocopino Rather late in the conversation, but since you asked...<br><br><div class="quote"> What would be good structure/less confusing code when iterating through all tiles on a map without using a nested x and y loop for example? <br></div><br><br><a href="https://en.wikipedia.org/wiki/Map_%28higher-order_function%29" target="_blank">Map</a>/Foreach:<br><pre class=code>for_each(tiles, do_work_on_tile)</pre><br>...where `tiles` if your set of tiles in the game-map, and `do_work_on_tile` is your loop body. NB that in most languages you can inline the do_work function as a lambda, which makes this a lot clearer to look at; however, if you've really separated your concerns, even this call will be "away" from the per-tile work because the best code operating on collections will try to avoid thinking about the existence of other elements in the collection, so the definition of "what to do to one tile" shouldn't need to be written out anywhere near the code that asks it to be applied to all of them.<br><br>With a good modern compiler, there is zero overhead to this approach. Even with BlitzMax, there is very little, because modern processors are rather good at calling functions. Either way, it doesn't matter much because you can always convert to a clunkier design <i>after you have evidence</i> that the cleaner design is too slow; but 99% of the time performance doesn't matter anywhere near as much as readability.<br><br>You can't write code like this in Blitz3D because of the lack of any kind of support for first-class functions or callable objects, but you <i>can</i> a) factor out the loop from the surrounding code, b) factor out the loop body to its own function, and c) redesign the data structures to only require one tier of control (e.g. is there anything intrinsic to the tiles requiring a two-level loop, or are you just letting presentation dictate how you manage the collection? Normally a single loop would make more sense, even for something to eventually be displayed in 2D space).<br><br><div class="quote"> you don't want branches <br></div><br><br>What you want to avoid are <i>inconsistent</i> branches. A branch or indirect jump that goes the same way each time is almost free. Code with more branch instructions <i>can</i> be faster than code with just one point of dispatch if it means that the prediction for the single point of dispatch is always going to be wrong due to having a different target each time.<br><br>The thing with using computed gotos for a VM above, for instance, gives each virtual instruction its own jump point - and in so doing improves the prediction failure rate from &gt;99% to somewhere in the region of 50% (IIRC), with dramatic consequences for the VM's performance because suddenly it's magically getting hardware prediction for virtual instructions. Similarly with the nested vs. linear if-chain: a processor could get moderately good performance out of a short, linear chain simply by predicting "no" for every branch, for instance, and the chance of failure is still only 1/Length, whereas the chance of failure in a binary search is ~50% for each branch unless your data is very unevenly distributed.<br><br>Every processor is different, but we're well past the era when <i>all</i> jumps were bad news. <br><br></td></tr></table><br>
<a name="1300406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Yasha<br><div class="quote"> With a good modern compiler, there is zero overhead to this approach. Even with BlitzMax, there is very little, because modern processors are rather good at calling functions <br></div><br><br>I have no compiler knowledge so correct me if I'm wrong, but to be able to use "for_each(tiles, do_work_on_tile)", doesn't that mean:<br>1. we still need a container/list to store the tiles<br>2. we still need to store the grid location somewhere - the tiles now need to be objects/types?<br>3. the amount of iterations needed will stay the same<br><br>I fail to see how this approach would be less overhead...? <br><br></td></tr></table><br>
<a name="1300407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> It wouldn't be less - by "zero" I mean "zero in addition to". i.e. not actively losing anything.<br><br>I'd assume the tiles are already objects of some sort? But you can generalize this to cover anything. You can have versions of `map` that accept lazy/implicit/range-type values so that they don't actually need e.g. an array of the numbers from 1 to 1000. Depends what you'd want it to do. <br><br></td></tr></table><br>
<a name="1300416"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> grable:<br><div class="quote"> Im afraid not. Using a label and goto is the only way for Blitz3D and BlitzPlus. <br></div><br>I beg to differ, I use a flag variable just like Zethrax. <br><br></td></tr></table><br>
<a name="1300417"></a>

<a name="1300418"></a>

<a name="1300419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> @steve_ancell<br>He was asking about an equivalent to Exit, which the Goto is the only option.<br><br>I assumed he didnt want to use an exit flag, which is why i worded it like that.<br>Besides im sure the concept of an exit flag is quite obvious to anyone who has coded for more than 5 minutes ;)<br><br>Personally i dont like exit flags, it adds clutter to the algorithm and it adds an additional compare which will slow down tight loops. <br><br></td></tr></table><br>
<a name="1300426"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> @grable&gt;&gt;i didn't know about the exit flag, that's why i used goto label... :P <br><br></td></tr></table><br>
<a name="1300427"></a>

<a name="1300431"></a>

<a name="1300432"></a>

<a name="1300433"></a>

<a name="1300434"></a>

<a name="1300435"></a>

<a name="1300436"></a>

<a name="1300437"></a>

<a name="1300438"></a>

<a name="1300439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yasha Ya but it's not very viable for a human to know the periods of branches. You can use the aspects how often branches are taken and place them using some priority I guess and make it easier for the cache. But all those are things that you want a compiler to do ,or it just won´t be done. Those details are not humane. Branches are evil.<br><br>EDIT I guess I just don´t trust caches / prediction very much, they have some clever pattern reconition, but I´ve seen too much slowdowns (2012-2015 era of processors) to believe in them completetely.<br><br><br>But I know that the #1 what makes a expansive computer faster is just that; improved predictions and caches.<br><br>For example my i3 3Ghz is no match for my i5 1.9Ghz. I guess that proves that they do something. But not everyone has amazing machines. <br>The actual difference I measured for that was (same graphics performance and DDR3 etc), but logic  and conditionals perform 20-40% better (1.9Ghz) than the 3Ghz.<br><br>EDIT<br>I've never learned how virtualsing processors affects predictions and caches but I reliase they must play an important role in this game of prediction and caching. They would play a good part, as dividing up everything would make everything more.. I mean at least ONE processor would always have the correct precditcion in what it is executing. So that would make sense to me.<br><br>But still.. bottomlines becomes; The more branching that happens inside code the more you need a high end machine, the Ghz does not mean anything. How branches is handled is everything. <br><br></td></tr></table><br>
<a name="1300428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Which brings us to conditional executable instructions and how lovely they are.<br>ARM survives on them. X86/X64 has them but they are not very much used as the ARM ones I feel.<br><br>I wonder if that's why MIN and MAX is so fast in Bmax. I don´t know. <br><br></td></tr></table><br>
<a name="1300440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> LUA had no Continue and got a GOTO in return of that request.<br><a href="http://stackoverflow.com/questions/3524970/why-does-lua-have-no-continue-statement" target="_blank">http://stackoverflow.com/questions/3524970/why-does-lua-have-no-continue-statement</a><br><br>I guess GOTO replaces both EXIT # and CONT #. <br><br>Would anyone be so kind and unlock GOTO in SUPERSTRICT? Color it red if you want but allow it and it would be wonderful.  Shh I know this GOTO guy, he's a good one. Let him in. <br><br></td></tr></table><br>
<a name="1300485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br> Color it red if you want<br> <br></div><br>Color it flashing glowing red with exclamation marks around it to really remind goto label is bad, really bad. ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
