<!DOCTYPE html><html lang="en" ><head ><title >C++ struct iteration</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >C++ struct iteration</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=125" >General Help</a>/<a href="#bottom" >C++ struct iteration</a><br><br>
<a name="1041890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi peeps, I've been tryiong to get to grips with C++ but one thing has totally eluded me...<br><br>To learn it better, I'm trying to write a simple 'space invader' type game. I have created a struct for the invaders, but I don't know how to access different instances.<br><br>For example:<br><br><pre class=code>
class InvaderClass
{
public:
	struct invader{
		short int x;
		short int y;
		int last_fired;
		short int score;
	};

	struct invader_bullet{
		short int x;
		short int y;
		short int speed;
	};

	const short int initial_invader_speed;

	short int invader_speed_base;
	short int invader_speed;
	short int mothership_speed;

	const short int initial_invader_bullet_speed;

	short int invader_bullet_speed_base;

	void MoveInvaders(){
	// Moves all existing invaders
		invader invaderinstance;
		MoveInvaderInstance(invaderinstance)
	}
};</pre><br><br>For the function MoveInvaderInstance(), how do I loop invaderinstance to point to each invader in turn?<br><br>I know to use invaderinstance.fieldname to get the fields.<br><br>To help explain where I'm stuck, In Blitz, the equivalent (using a custom Type) would be:<br><br><pre class=code>

	Function MoveInvaders()
	; Moves all existing invaders
		For invaderinstance.invader = Each invader
		 MoveInvaderInstance(invaderinstance.invader)
Next
End Function
</pre> <br><br></td></tr></table><br>
<a name="1042056"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CGV</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If InvaderClass defines an invader instance then you wouldn't be updating all of the instances of invaders within it.<br><br>You seem to be trying to create a one class game and that's what's causing your problem.<br><br>You really should have an InvaderClass which defines the invader and a seperate BulletClass which defines the bullet and in your main game class create lists of both and just iterate through them each loop to handle movement and collisions etc. <br><br></td></tr></table><br>
<a name="1042058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  in your main game class create lists of both and just iterate through them  <br></div><br>This is what I am having trouble with.<br>How do I 'create' these lists?<br><br>Thanks for the help, as you can probably tell, there's a lot I'm really not familiar with when it comes to OOP stuff.<br>I was under the impression that Classes ought to contain all the functions and definitions etc. relevant to each object. I concede the Invader_Bullets should then have a class of their own, but I understood that EVERYTHING to do with the invaders being kept in a single class (Invader Class) would mean that's where I would define them all, not just One Instance???<br><br>I hope you can understand what I'm geting at, and that you can reply again, even if to tell me Ive gotten it very wrong indeed :) <br><br></td></tr></table><br>
<a name="1042059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is interesting learning for someone who want do C++ class with Struct..<br><br>Not sure about C++ making Link lists and removing them.... <br><br></td></tr></table><br>
<a name="1042066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CGV</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lists are not a part of the C++ core language, they're a part of the STL so google for that and you'll find plenty of tuts.<br><br><div class="quote"> but I understood that EVERYTHING to do with the invaders being kept in a single class (Invader Class) would mean that's where I would define them all, not just One Instance??? <br></div><br>Right, but your InvaderClass defines a single invader so all of the code in your InvaderClass has to apply only to that one instance.<br><br>You can then make a whole bunch of invader instances and add them to a list or an array.<br><br>Each instance is independent of the others so your MoveInvader() method would only move the one invader that's currently being referenced, not all of the invaders. That's why in your main game loop you have to manually iterate through them all, one after another, and call each of their MoveInvader() methods in turn.<br><br>EDIT: Here's a link. <a href="http://www.sgi.com/tech/stl/" target="_blank">STL Guide</a><br><br>EDIT2: You can also get a really good free C++ ebook from <a href="http://www.mindview.net/Books/TICPP/ThinkingInCPP2e.html" target="_blank">here</a> <br><br></td></tr></table><br>
<a name="1042077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Right, but your InvaderClass defines a single invader so all of the code in your InvaderClass has to apply only to that one instance.<br><br>You can then make a whole bunch of invader instances and add them to a list or an array.<br><br>Each instance is independent of the others so your MoveInvader() method would only move the one invader that's currently being referenced, not all of the invaders. That's why in your main game loop you have to manually iterate through them all, one after another, and call each of their MoveInvader() methods in turn.<br> <br></div><br><br>The same issue of creatring a list and iterating would be done for defining the invaders. The 'invaderinstance' is simply a temporary 'local'   placeholder to representwhatever "current" instance from the list.<br>It's how to define new instances and iterate through them I am unable to find.<br>Yopu refer to arrays, that seems to defeat the point of using 'struct' in the first place?<br>Also, for things like bullets etc. I would need to track HOW MANY bullets there are and ensure the arrays are of relevant size. Agaoin, this seems to defeat the point of structs which I had hoped would wpork like B3~<br>D Custom Types and allow for easy iteration and creation of instances without ever needing to know how many instances there are.<br><br>Thanks for the links, It's a little late for me know, but I'll have a good look over the stuff tomorrow and see if I can figure it out. Thanks for the help :D <br><br></td></tr></table><br>
<a name="1042089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Untested and it's been a while since I did this but something like this should work...<br><br><pre class=code>
#include &lt;list&gt;
using namespace std;

Class Invader{
public:
   Invader(){
   }

   void Update(){
      //blah...
   }
};

list&lt;Invader*&gt; invaders;

void CreateInvaders( int count ){
   for( int i=0;i&lt;count;++i ){
      invaders.push_back( new Invader );
   }
}

void DestroyAllInvaders(){
   while( !invaders.empty() ){
      delete invaders.back();
      invaders.pop_back();
   }
}

void UpdateInvaders(){
   for( list&lt;Invader&gt;::iterator it=invaders.begin();it!=invaders.end(); ){
      Invader *invader=*it;

      invader-&gt;Update();

      if( invader-&gt;WantsToBeRemoved() ){
         it=invaders.erase( it );
      }else{
         ++it;
      }
   }
}
</pre><br><br>Note: This also shows you how to safely erase something from a list while iterating through it, which is why the '++it' is in a funny place, not in the for loop.<br><br>I'd also recommend using C++ namespaces if you want to enclose a bunch of symbols in a single scope, not a class eg:<br><br><pre class=code>
namespace SpaceInvaders{

   class Invader{
   };

   class Player{
   };

   class Missile{
   };

   class Bullet{
   };

   void CreateInvaders( int count ){
   }

   void UpdateInvaders(){
   }
   ...etc...
}
</pre><br><br>namespaces are 'open' so you can add different symbols to them in different files which can be useful on big jobs! <br><br></td></tr></table><br>
<a name="1042140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Mark! I've learned a little on the use of namespaces, I see pointers being used in there too. It looks a lot like it has what I'm looking for, so I'll see how it works pout. Thanks again. <br><br></td></tr></table><br>
<a name="1042183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CGV</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Even after seeing that code you still want to learn C++ :)<br><br>That's the reason I and a lot of other people switched to Blitz. <br><br></td></tr></table><br>
<a name="1042300"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I'd rather stick with Blitz, I certainly prefer it's ease of accessibility despite obvious inadequacies vs C++ for many situations, but I'm prepared to struggle on for a while yet :)<br><br>I'm hoping to get work with a friend of mine too, so C++ is a must unfortunately since it's become so standardised. <br><br></td></tr></table><br>
<a name="1042326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I picked up class definition and list population in C++ from the iMiniB3D examples -- they're very instructive. <br><br></td></tr></table><br>
<a name="1042358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CGV</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I learned OOP from Java just a few months ago after struggling for years with it. I would never recommend C++ to any who's just getting started in OOP.<br><br>Just something for you to consider. <br><br></td></tr></table><br>
<a name="1042373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I would never recommend C++ to any who's just getting started in OOP. <br></div>I can only agree with this -- I learned OOP with BlitzMax and, given how much rope C++ gives you to hang yourself with, I'm very glad I did so. Starting with a higher level language lets you work out what it is that you actually need to know, so you can be much more focused when it comes to adopting the C++ equivalents. <br><br></td></tr></table><br>
<a name="1042469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Some pennies have dropped into place.<br>I finally understand now how by declaring member vars within a Class actually means those vars apply to instances of the class objects - meaning I don't need to define structs, since the struct fields could just be vars within the class. Iteration then, is, (as I see explained above now a lot more clearly) done when the objects in the class are iterated themselves!<br><br>That makes a lot more of the comments above easier to understand too.<br><br>-------<br><br>Yeah, Coming from a higher level, procedural background straight to C++ is dainting at the least, it's amazing how different it can be, despite so much being essentially familiar, but I've started now, and I really believe I sould keep going, it's harder for me already to absorb new learning, so I am trying to keep at it enough for what I HAVE learned to stick. <br><br>One thing I do see a lot, though, is that many books and tutorials etc. all seem to start in different places, making it difficult to see where abouts a real beginner should start at, the nature of C++ with all its header files and what not, plus the 'standard' libraries that might be needed for one thing or another make even the simplest examples rather clutttered and confusing. Still, things seem to be moving forwards again, so thanks once more to all of you :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
