<!DOCTYPE html><html lang="en" ><head ><title >Prevent Windows Screensaver</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='A simple way to prevent windows screensavers from becoming active, language=bb, category=User Input'><meta name='author' content='jfk EO-11110'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=5>User Input</a>/Prevent Windows Screensaver</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="1366.bb">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Prevent Windows Screensaver by jfk EO-11110</td><td align="right">2005 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> Sometimes you don't want Windows screensavers to become active, like when the window is not restored after the screensaver in some OSes or for some other reason. You don't need to mess with windows Api stuff, there is a much simpler way to do this. </td></tr><tr ><td class="cell"><pre class="code">; prevent windows screensaver

; the following code should be executed in the mainloop, or 
; may be in a function when the variable is global.

if millisecs()&gt;prevent_screensaver
 prevent_screensaver=millisecs()+30000
 movemouse mousex(),mousey()
endif</pre></td></tr></table><br><a name="comments">Comments</a><br><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> Or just turn it off :D. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>2006</font></td></tr></table></td></tr><tr ><td class="posttext"> Well I think you should not alter the screensaver settings on the machine of a user of your program... :D <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vic 3 Babes</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> I tried this recently, but it didn't work - I'll have to try it again now that I've seen this posting - Windows doesn't detect input from joypads, and the screen saver comes on in the middle of a game - really annoying.<br><br>I could have sworn it didn't work though. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> joypad? But you still got a mouse, do you? One reason why it probably didn't work is: in this example the mouse is moved to the current mouseposition. So basicly it isn't moved at all. Although, when I wrote this on Win98se, windows thought the mouse was moved noless, because the MoveMouse command was used . Maybe other OSes won't work this way. But I'm positive if you move it eg. by one pixel then it should work in every situation. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vic 3 Babes</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> Sorry - I tried it again - it definitely doesn't work?<br><br>Yeah - joypad - it's for a Pac Man variant in a window - but the screensaver comes on - I've written a routine to put up an icon to warn the player that the screensaver is due - based on their settings in the settings screen.<br><br>Works well enough - but Microsoft should have sorted this problem out by now. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Microsoft should have sorted this problem out by now <br></div><br>They allready have ;) check here for more options:<br><a href="http://msdn2.microsoft.com/en-us/library/ms724947.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/ms724947.aspx</a><br><pre class=code>
Private
Const SPI_GETSCREENSAVEACTIVE:Int = 16
Const SPI_SETSCREENSAVEACTIVE:Int = 17

Extern "Win32"
	Function SystemParametersInfoA:Int( action:Int, param:Int, param2:Byte Ptr, winini:Int)
EndExtern

Global ScreenSaveActive:Int
Public

Function DisableScreenSaver()
	' store original setting
	SystemParametersInfoA( SPI_GETSCREENSAVEACTIVE, 0, Varptr ScreenSaveActive, 0)
	SystemParametersInfoA( SPI_SETSCREENSAVEACTIVE, False, Null, 0)
EndFunction

Function EnableScreenSaver()
	' restore original setting
	SystemParametersInfoA( SPI_SETSCREENSAVEACTIVE, ScreenSaveActive, Null, 0)
EndFunction
</pre> <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vic 3 Babes</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> Thanks very much for going to the trouble of finding this out.<br><br>Unfortunately, I'm using B2D and don't recognize some of the commands you've used, and don't really like the idea of disabling someone's screensaver - they may leave their PC whilst the game is still running - in which case the screensaver should be allowed to appear.<br><br>Besides they haven't really fixed it - they should change the code that resets the screensaver timer to include input from joypads - that would make the most sense.<br><br>I think they didn't do this because they expect joypad-led games to be run full-screen.<br><br>Thanks <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> About the mouse trick: So you say there's no mouse connected to your machine? This could be a reason why the said mouse trick doesn't work.<br><br><br>I think grable meant you could use a winApi function named SystemParametersInfo (part of user32.dll, as far as I see). You have to declare this in a "user32.decls" file in the "userlibs" folder of your blitz installation. As far as I know BLitz2D does support userlibs as well.<br>You may find some help on how to declare windows functions for blitz as userlibs in the blitz3D userlibs forum section.<br><br>Note Grable's example code may show you how to use it, but actually the code is not Blitz code, so you may have to tweak it a little. <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> Its BlitzMax. i keep forgetting that the other blitzes exist  since max is just that good ;) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vic 3 Babes</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> Who said I had no mouse attached?<br><br>Since I'm using B2D instead of B+, I don't think I can use CallDLL, because there doesn't seem to be any way to pass parameters to the function called - will have a mess with it today though.<br><br>As for BlitzMax - I think all the Oop stuff is just OTT, and mostly just a way of writing slow code.  I'm sure there are uses for Oop, but I'm also pretty sure that those uses should be a lot rarer than they are - which is why I just upgraded to B+ instead of BMax.<br><br>If I wanted to go that route, I'd probably code in C++ <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I think all the Oop stuff is just OTT, and mostly just a way of writing slow code. <br></div><br><br>Who said you HAVE to use OOP? Btw OOP isn't the only thing max brings to the table, its more like a real language. Function pointers/pointers, better arrays, can compile and link with C/C++/ASM (thats what i like the best about it).<br><br>To each his own i guess =) <br><br></td></tr></table><br><table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>2007</font></td></tr></table></td></tr><tr ><td class="posttext"> Vic I wasn't talking about CallDLL, but about the userlibs extension of blitz: open your blitz installation folder, when there's a folder named "userlibs" then it should work. <br><br></td></tr></table><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
