<!DOCTYPE html><html lang="en" ><head ><title >Functional Features</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Functional Features</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Functional Features</a><br><br>
<a name="2045071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any chance we will ever see anonymous functions and or closures in monkey? Personally I would love to see them, but I understand it might be a tricky feature to implement at present. Having said that, Java 8 will have support for these (it could also be done via some Scala/Java interop, I imagine), C++11 already supports them, javascript does, no idea about flash/AS (a quick google search implies that it does) but C# certainly does (XNA). So maybe a year or two down the track?<br><br>Also, it is my understanding that rudimentary support for anonymous functions can be achieved by converting them to actual functions at compile time, then just providing a reference to them when they are used. Of course this would mean adding a native type for functions (I have no idea how this would be done), or perhaps representing them as objects (though this might slow down the GC a lot on mobile devices). Similarly closures can be implemented as a big state table for your compile time created anonymous functions.<br><br>Does anyone else think this would be a cool feature, or is it just me? Maybe I've missed something and it might be much harder than I think--to clarify, I think this would be /very hard/ to implement, but definitely possible. Is there are way I can create my own compiler extension of trans to attempt to support them on say javascript as a proof of concept? I do of course worry about making 'function' a primitive type; I have no idea how to do this, but I am willing to try.<br><br>P.S. Obviously you can fake these things using objects, I am talking about native support that won't kill the GC and/or has a nice syntax. <br><br></td></tr></table><br>
<a name="2045070"></a>

<a name="2045069"></a>

<a name="2045084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I got it that you like these? But for what do you need these? Can you explain it in some pseudo code?<br><br>From what I take of wikipedia explainations is, that you want to be able to access fields/objects that are outside of the scope a current function/method. I wonder why? <br><br></td></tr></table><br>
<a name="2045087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Java 8's closure support is a dirty hack that generates anonymous classes.  I'm quite disappointed with it actually :( <br><br></td></tr></table><br>
<a name="2045089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Samah: Oh I didn't know that! That is appalling, but I guess it means I could claim these features are possible for the trans compiler in the current versions of Java by just using an anonymous class, however I still think compiling a bit of Scala and grafting it onto the Java is a better idea. I have all but given up on Java. Clojure or Scala for me on the JVM.<br><br>@MikeHart: What you have described is one small aspect of what you can do with closures. Monkey is a turing complete language (at a glance..?), and functional languages are based on lambda calculus which was proved by Alonzo Church and Alan Turing to be equivalent to turing complete. So there is nothing you can't do in Monkey now that you could do with these features. However that is also true for objects and generics. Like those lambdas would make certain things much more succinct.<br><br>Basically a lambda is a function that is defined on the fly, here is a classic example:<br><pre class=code>
function map:int[](elems:int[], f:function)
    for local i:= 0 until elems.Length
        elems[i]=f(elems[i])
    next
    return elems
end
local myArray := map([1,2,3,4], fn (i) -&gt; i+1)
' myArray contains 2, 3, 4, 5
</pre><br>jQuery is pretty much built on anonymous functions. Haskell is an entire language (which I personally love and use quite a lot) based on immutability, lambda functions, algebraic data types and lazy evaluation. Most languages these days support lambda functions because they can be so useful. Off the top of my head one could change the Map and List classes to take a comparator function as an argument in sort so you don have to extend the classes and write it yourself!<br><br><pre class=code>
local sorter:function = fn (a:int, b:int) -&gt;
    return a &gt; b
end
local l:=new List&lt;Int&gt;
'add stuff to l
l.Sort(sorter)
</pre><br><br>Note: I just wrote this code on the fly and made up some syntax. It might be a bit dodgy, but you should get the idea.<br><br>More Info and proof that almost all mainstream languages support lambda functions: <a href="http://en.wikipedia.org/wiki/Anonymous_function" target="_blank">http://en.wikipedia.org/wiki/Anonymous_function</a> <br><br></td></tr></table><br>
<a name="2045090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >frank</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> In Javascript/Jquery you have things like: <br><br>$.get("http://google.com", function(result) {<br> console.log(result);<br>}); <br><br>Which you automatically (have to) use all the time, while most people don't know that's an anonymous function (and, to some extend, don't need to know this). <br><br>But there are a lot of constructs from functional programming which benefit Monkey devs which result in cleaner, better code in general:<br><br>- map functions to a list<br><br>map([1, 2, 3], function(num){ return num * 3; });<br>=&gt; [3, 6, 9]<br><br>- each; iterate over each element<br><br>each([1, 2, 3], Print);<br>=&gt; 1<br>=&gt; 2<br>=&gt; 3<br><br>- reduce (foldl) turns a list into 1 value <br><br>reduce([1, 2, 3], function(memo, num){ return memo + num; }, 0);<br>=&gt; 6<br><br>- find ; returns the first value in the list which results in true from the function<br><br>find([1, 2, 3, 4, 5, 6], function(num){ return num % 2 == 0; });<br>=&gt; 2<br><br>- filter all values for which the function returns true <br><br>filter([1, 2, 3, 4, 5, 6], function(num){ return num % 2 == 0; });<br>=&gt; [2, 4, 6]<br><br><br>Etc. These functions save a LOT of code when used properly and make code very readable instead of, for instance, making nested loops to try to recreate the same behavior or writing elaborate classes/methods to try to make them generic. <br><br></td></tr></table><br>
<a name="2045093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shinkiro1</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Recently learned javascript/jQuery in school and anonymous functions really impressed me.<br><br>The coolest thing I think is that you can do something like this:<br><pre class=code>
//moveObject(x, y, onFinished)
moveObject(10, 20, function() {
	// Execute when finished moving
});
</pre><br>You don't have to design an extra event system and scatter your code all around.<br>To me it feels very natural to write this way.<br><br>But I think to implement this monkey would have to treat functions as first class citizens? <br><br></td></tr></table><br>
<a name="2045109"></a>

<a name="2045110"></a>

<a name="2045111"></a>

<a name="2045112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Shinkiro1: Yes, to have anonymous functions, we need to treat them as a data type, a first class citizen. You've also highlighted another reason why they can be useful: callbacks. For example, instead of extended the App class, or the DiddyApp class (or whatever framework you are using) you could simply create an instance then pass it your update and render functions. On top of that, there are continuations, I've always found continuation passing comes in handy when you least expect it.<br><br>One could also make a component based system using functions as little packets of behaviour, then gluing together an entity using currying and function composition. The cool thing about this is you could change the definition of what a type of entity is /at runtime/ with very little overhead. It would also make for really clean reusable code! With immutable data structures you could even start doing some FRP (although I would advise against it).<br><br>eg.<br><pre class=code>
local anEntity:= composeFn([renderable(theScreen), followAI(player), particleEmitter(FAIRY_DUST)])

'---update/render/everyhing loop
for local e:=eachin Entities
    e()

</pre> <br><br></td></tr></table><br>
<a name="2045136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @maltic: On top of that, there are continuations <br></div><br>There's a simple coroutine/continuation implementation in Diddy if you want to use the threading module. <br><br></td></tr></table><br>
<a name="2045144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Samah: I did not know that, I will have to check it out. <br><br></td></tr></table><br>
<a name="2045147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mark said one time that we won't get pointers so how does this affect this? <br><br></td></tr></table><br>
<a name="2045150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @MikeHart: Not in the slightest. Pointers are an imperative concept. <br><br></td></tr></table><br>
<a name="2045152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> We do have them. Object instances are pointers, just give it a bit of imagination and you can do almost anything but, with a proper delegates implementation, you would need a lot less of imagination and everything would be much more straight forward but I feel a bit alone on this feature request for Monkey <br><br></td></tr></table><br>
<a name="2045153"></a>

<a name="2045154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maltic</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Correct me if I'm wrong, but I am pretty sure objects in Monkey are handled by reference, and are not by pointer (using C/C++ nomenclature). <br><br></td></tr></table><br>
<a name="2045155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're not wrong, but a reference and a pointer are sort of the same, except that a reference is cooler as it allows languages to have a garbage collector. That was what I was meaning, but maybe it was not very well written or explained. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
