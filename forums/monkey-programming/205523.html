<!DOCTYPE html><html lang="en" ><head ><title >Creating Random Dungeon Using BSP</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Creating Random Dungeon Using BSP</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Creating Random Dungeon Using BSP</a><br><br>
<a name="2061847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all.  I am working on dungeon creation and I would like to use the method described here:<br><br><a href="http://7yrl.com/2009/04/10/7/" target="_blank">http://7yrl.com/2009/04/10/7/</a><br><br>I have spent several hours working on it and am not really making much headway.  The code has gotten long and I just can't seem to get it right.  Does anyone have an example in Monkey or can give me a hand?<br><br>Thanks... <br><br></td></tr></table><br>
<a name="2061854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have a look at RogueBasin under Articles/Map.  There's one on the BSP method.  Not in Monkey but it goes through the algorithm step by step, with pictures. <br><br></td></tr></table><br>
<a name="2061855"></a>

<a name="2061856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have looked at it.  I just can't seem to get it.  I have read pretty much everything I can find.  Found code in Java and C++ too and just can't get it converted properly.<br><br>I split it and I stored the completed squares that were the right size in a different array.  I guess I just can't get the continuing iteration and the links right. <br><br></td></tr></table><br>
<a name="2061870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Go to bed and when you look at it tomorrow you will probably see your mistake! <br><br></td></tr></table><br>
<a name="2061885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hang on I can send you my code, you can check a running apk for Android here: <a href="http://www.codeknitters.com/dl/dungeon/dungeon_b32.apk" target="_blank">http://www.codeknitters.com/dl/dungeon/dungeon_b32.apk</a><br><br>It looks like:<br><img src="http://www.codeknitters.com/dl/dungeon/screenshots/b30.jpg"> <br><br></td></tr></table><br>
<a name="2061884"></a>

<a name="2061892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Xaron, thanks!  That is a good foundation.  What method are you using?  Looks like maybe a maze generator with rooms placed on top? <br><br></td></tr></table><br>
<a name="2061893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raul</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Xaron: I am also interested in your example :) <br><br></td></tr></table><br>
<a name="2061936"></a>

<a name="2061937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> One method I did for this years ago was I made two functions which called each other recursively, vrect and hrect.  Each one took a rectangle as input, split it in two either horizontally or vertically, and then called the other function on the two sub-rects it had just created (hrect called vrect, vrect called hrect.)  When the rectangle was below size limits the recursion bailed out.<br><br>The code for that was much, MUCH simpler than the BSP dungeon code linked above. <br><br></td></tr></table><br>
<a name="2061938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> zoqfotpik, your way is a better way.  Gerry provided me with some code that works the same way.  I also found a java example that did it the way that you mentioned.  I was making it too difficult. <br><br></td></tr></table><br>
<a name="2061939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lots of people are scared of recursion but it's an incredibly powerful technique.<br><br>You could probably simplify it further but the way I did it is basically the oldstyle LISP way-- there is some code duplication but it's trivial and conceptually much easier. <br><br></td></tr></table><br>
<a name="2061959"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hang on guys, still had a lot of family workload this weekend. lol<br><br>Will post it soon... <br><br></td></tr></table><br>
<a name="2061969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just posted a complete BSP-tree dungeon generator in the code forum. <br><br></td></tr></table><br>
<a name="2061981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >impixi</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Lots of people are scared of recursion but it's an incredibly powerful technique.<br> <br></div><br><br>That's true, but you need to be wary of your stack's capacity, depending on the language, OS and hardware platform. It's nowhere near as problematic as the 'old days' (late 80s for me), though occasionally you hit a limit. My most recent 'stack overflow' barrier occurred a few years ago when implementing a recursive midpoint displacement algorithm in JavaScript. Sometimes you just have to use the iterative version of an algorithm (usually there is minimal performance penalty, sometimes even a gain). <br><br></td></tr></table><br>
<a name="2061980"></a>

<a name="2061992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> The only time recursion bit me recently was when I was creating puzzles for my game Detective Chess, which involves searching a tree of piece permutations.  It wasn't especially deep, so memory wasn't an issue, but it could take up to 20 seconds on large puzzles.  The problem was that Monkey is single-threaded, so I had to switch to what might be called an iterative method in order to jump out periodically and show a progress bar.  Strictly speaking, I'd still call it recursive, but I was managing my own stacks and context switches, so from a naïve point of view you could argue that the algorithm was iterative. <br><br></td></tr></table><br>
<a name="2062069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is why it's important to have a bailout value.  For certain applications you could probably have an exception block to automatically bail out if the stack broke. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
