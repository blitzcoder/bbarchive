<!DOCTYPE html><html lang="en" ><head ><title >Game crashing in Chrome.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Game crashing in Chrome.</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Game crashing in Chrome.</a><br><br>
<a name="2013641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> can people try this game and see if it crashes in your browser:<br><a href="http://www.hexobot.com/html5/MonkeyGame.html" target="_blank">http://www.hexobot.com/html5/MonkeyGame.html</a><br>Actually, it crashes the browser.<br>I have been trying to figure out why it crashes on my computer when I run it in Chrome.<br>I can run it in Safari and it works fine.<br><br>the Flash version seems to be fine also: <br><a href="http://www.hexobot.com/flash/MonkeyGame.html" target="_blank">http://www.hexobot.com/flash/MonkeyGame.html</a><br><br>I am using sounds as ogg and wav and are only supposed to play on supported browsers. <br><br></td></tr></table><br>
<a name="2013639"></a>

<a name="2013640"></a>

<a name="2013642"></a>

<a name="2013643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Runs without crashing for me on Windows Chrome 13.0.782.218.<br><br>Edit: <br>Also runs okay on FF6.<br>Runs without crashing on IE9, but the cushion collisions appear to add energy rather than dissipate it. One shot and all the balls bounce around faster and faster until they're potted or fly off the screen. <br><br></td></tr></table><br>
<a name="2013647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine here runnng Chrome and IE9.<br><br>Looking good btw Jesse :) <br><br></td></tr></table><br>
<a name="2013648"></a>

<a name="2013649"></a>

<a name="2013650"></a>

<a name="2013651"></a>

<a name="2013652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://i.imgur.com/5Sx9L.png"><br>:) <br><br></td></tr></table><br>
<a name="2013653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> It crashed with the following error when I tried it in Firefox 6.0. I know you wanted people to try it in Chrome, but you might want to know that it can crash in other browsers as well.<br><br>[Exception... "An invalid or illegal string was specified"  code: "12" nsresult: "0x8053000c (NS_ERROR_DOM_SYNTAX_ERR)"  location: "http://www.hexobot.com/html5/main.js Line: 856"] <br><br></td></tr></table><br>
<a name="2013654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Volker</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works in chrome and firefox 6.01 here. <br><br></td></tr></table><br>
<a name="2013672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all of you! <br>it doesn't crash consistently or in the same place/time, I have gotten to play it for a couple of minutes and then it crashes. <br><br>Thanks zawran. I don't know what that means but I'll take a look into that.<br><br>I am surprised it hasn't crashed on Chrome. Hmm!<br>What to do? What to do?<br><br>[edited]<br><br>Thank's therevills, glad you like it. <br><br></td></tr></table><br>
<a name="2013659"></a>

<a name="2013663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I checked the line 856 in main.js. it's the marked line in this function:<br><pre class=code>

gxtkGraphics.prototype.DrawImageTinted=function( image,dx,dy,sx,sy,sw,sh ){

    if( !this.tmpCanvas ){
        this.tmpCanvas=document.createElement( "canvas" );
    }

    if( sw&gt;this.tmpCanvas.width || sh&gt;this.tmpCanvas.height ){
        this.tmpCanvas.width=Math.max( sw,this.tmpCanvas.width );
        this.tmpCanvas.height=Math.max( sh,this.tmpCanvas.height );
    }
    
    var tgc=this.tmpCanvas.getContext( "2d" );
    
    tgc.globalCompositeOperation="copy";

    tgc.drawImage( image,sx,sy,sw,sh,0,0,sw,sh );
    
    var imgData=tgc.getImageData( 0,0,sw,sh );
    
    var p=imgData.data,sz=sw*sh*4,i;
    
    for( i=0;i&lt;sz;i+=4 ){
        p[i]=p[i]*this.r/255;
        p[i+1]=p[i+1]*this.g/255;
        p[i+2]=p[i+2]*this.b/255;
    }
    
    tgc.putImageData( imgData,0,0 );
    
    this.gc.drawImage( this.tmpCanvas,0,0,sw,sh,dx,dy,sw,sh ); &lt;-*******************************
}
</pre><br><br>it's the drawimage line but I don't have that problem here everything displays fine. I don't see anything missing either. I have a suspicion that it might be the way firefox handles 'zero' scaled images. I don't have firefox so I am going to have to install it to do some tests. darn It!<br><br>I did noticed that the mserver is reporting  that its trying to play wav files in Chrome so that might be the cause of the crash but since no one else seems to be reporting the crash, I am at a loss here. I don't know what to do. <br><br></td></tr></table><br>
<a name="2013673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> In my own game I have seen crashes which has refered to a line with "drawImage" as well, but I could not figure out why it crashes, but you might be right that it could have something to do with zero scale images.<br><br>The flash version seems to be working just fine. I have tried the html version several times just now and it seems like it might have something to do with when a ball is taken away from the table. One error mentioned line 805 instead of 856?<br><br>Monkey is not the easiest thing to debug thats for sure. <br><br></td></tr></table><br>
<a name="2013721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matty</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have noticed in the past that on firefox 3.5 (old I know) scaling images to 0 in either width or height didn't crash but simply caused no graphics at all to be displayed...which was difficult to debug at first.... <br><br></td></tr></table><br>
<a name="2013737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> after several hours of head banging, I think I solved it. there were three things that seem to have been wrong with the game:<br><br>first I made custom list class by adding some extra functionality to the original which was pretty limited for my  use. I made some errors in adding the logic. I added a firstnode/lastNode and were not returning the correct node when the list was empty. that's fixed now(I think). this was the error that was being displayed in the Firefox Browser. surprisingly it seems to be the only browser doing the right thing.<br><br>the other was the 0 scale image. I limit the size to 1 pixel in size and that solved the problem.<br><br>the third thing was that the wav files seem to be crashing the Google Chrome browser. but what is odd is that neither of the other browsers were crashing. maybe it's an operating system thing.<br>Mine is Apple but I don't know anyone else's system. So far it's just a guess. <br><br>I posted a new link for html5 in the post above. Any one that tries it please report any bugs please.<br><br><br>I notice while running the html version on my Macbook the performance from best to worst:<br> Safari, Chrome,Firefox, Opera.  Opera almost being unplayable at times. <br><br></td></tr></table><br>
<a name="2013736"></a>

<a name="2013734"></a>

<a name="2013731"></a>

<a name="2013732"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
