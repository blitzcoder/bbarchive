<!DOCTYPE html><html lang="en" ><head ><title >Object Pooling?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Object Pooling?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Object Pooling?</a><br><br>
<a name="2011889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anybody have a basic idea of implementing this for bullet firing? Am I correct in thinking that I can just stop the bullet moving when offscreen, making sure it has an ID first, then send it back to say the ships current coordinates to be used again?<br><br>Is this what is meant by Object Pooling? <br><br>Reason I ask is because I noticed some lag when lots of bullets were fired from my ships position; I then researched why and found out that creating new objects on the fly is a performance hit for phones and to use object pooling, object pooling being the reuse of objects already created. <br><br></td></tr></table><br>
<a name="2011892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I used a for-next loop to find an empty spot, say a "dead" bullet from a class array[] of however many bullets (20-30?).<br><br>bullet.alive = 0 ''dead from hitting something or offscreen<br>bullet.alive = 1 ''moving or begin firing<br><br><br>I guess another method would be to keep two Lists&lt;&gt;, one would be live bullets, the other is dead bullets. You would still use a class array[] for all the bullets. Move the bullets from list to list as they change state. (although one thought is that lists may be making and destroying objects as well, probably not as much overhead). <br><br></td></tr></table><br>
<a name="2011894"></a>

<a name="2011896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Basically create all your objects (ships, bullets, aliens, particles etc) before your game is in its main loop, in Monkey (if using mojo) you would want to do this in the OnCreate method.<br><br>So say you know that there are only every going to be 10 bullets on screen, create 10 bullets in OnCreate - then when the player fires a bullet use the first one, if the player fires a second one use the second one - then the first bullet goes off the screen and the player fires another bullet reuse the first bullet again. This way you are never creating a new object at runtime...<br><br>Mark actually posted a couple of examples:<br><br>A Linked list approach<br><a href="http://www.monkeycoder.co.nz/Community/post.php?topic=860&amp;post=7067" target="_blank">http://www.monkeycoder.co.nz/Community/post.php?topic=860&amp;post=7067</a><br><br>A Double buffered approach:<br><a href="http://www.monkeycoder.co.nz/Community/post.php?topic=860&amp;post=7069" target="_blank">http://www.monkeycoder.co.nz/Community/post.php?topic=860&amp;post=7069</a> <br><br></td></tr></table><br>
<a name="2012154"></a>

<a name="2012156"></a>

<a name="2012157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Playniax</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone know for certain when an object is removed from a list but 'kept alive' in another list if this causes a performance hit also? <br><br></td></tr></table><br>
<a name="2012158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> On XNA it does not cause any performance hit. <br><br></td></tr></table><br>
<a name="2012159"></a>

<a name="2012160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The way I do it:<br><br>Instead of: new Bullet<br>I go: Bullet newBullet = BulletPool.Pop()<br><br>After removing it from the list I go:<br>BulletPool.Push(newBullet) and since not all references is remove no GC action is taken<br><br>However I do this as little as possible since this is effectivly the same as using pointers - you need to micromanage your memory. It gives speed in some situations, but it does take more time and can lead to hard to catch bugs since you are re-using old objects, and if an "dead" object is reused and some other thing in your game still references it even tough it should not, you are in trouble ;)<br><br>For particle systems I have found this especially beneficial. And are not bullets "almost" particles? :) <br><br></td></tr></table><br>
<a name="2012161"></a>

<a name="2012162"></a>

<a name="2012163"></a>

<a name="2012164"></a>

<a name="2012165"></a>

<a name="2012166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>and since not all references is remove no GC action is taken<br> <br></div><br>you are forgetting that whenever you add an item to a list, a node is created and a node is deleted when the object is removed.<br><br>on the game <a href="http://www.monkeycoder.co.nz/Community/topics.php?forum=1048&amp;app_id=48" target="_blank">SURVIBALL</a> I submitted here. I use a "storage List" and a "in use list" and move them as needed. I use it for the particles. although there are no noticeable hiccups I am sure that if the game runs long enough all of the residue memory holes left from the node removal will eventually start to cause problems with performance. <br><br></td></tr></table><br>
<a name="2012167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jesse, good point. I do not use a linked list. I use an Array, Queue or Stack.<br><br>As a sidenote I did make a pooled linked list, solving the problem once and for all :) <br><br></td></tr></table><br>
<a name="2012201"></a>

<a name="2012202"></a>

<a name="2012203"></a>

<a name="2012204"></a>

<a name="2012209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Playniax</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, as long as you keep a reference to an object the GC doesn't free it and your safe on this part (common knowledge I guess). And better to use a Stack instead of a List. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
