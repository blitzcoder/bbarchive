<!DOCTYPE html><html lang="en" ><head ><title >Internal/Protected Keywords</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Internal/Protected Keywords</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Internal/Protected Keywords</a><br><br>
<a name="2100739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> All,<br><br>I've forked trans and added two new keywords for encapsulation.  Pending Mark's response, I will submit a pull request.<br><br><b>Protected:</b> Acts similarly to both C#'s and Java's "protected" keywords, where the field/function/method is visible to the current module and any subclasses of that class (regardless of module).<br><br><b>Internal:</b> Acts similarly to C#'s "internal" keyword and Java's "default" visibility, where the class/function/method/field is only visible to modules within the same "package" (directory, for Monkey).<br><br><b>GitHub fork:</b> <a href="https://github.com/swoolcock/monkey" target="_blank">https://github.com/swoolcock/monkey</a><br><b>Download (MinGW):</b> <a href="https://dl.dropboxusercontent.com/u/20511758/trans.zip" target="_blank">https://dl.dropboxusercontent.com/u/20511758/trans.zip</a><br><br>Original post:<br><i>I decided to have a go at improving Monkey's encapsulation, so I've introduced a new keyword "Internal".  It works basically the same way as in C#, and similarly to Java's "default" visibility.  If a field/class/method/etc. is declared as internal, it can only be referenced by monkey files in the same directory.</i><br><br><i>main.monkey:</i><br><pre class=code>Import foo.one
Function Main()
	Local h:=New Hello
	Print "Main: "+h.bar
	' doesn't compile, because bar is internal and "main.monkey" is not in the "foo" directory
	TestFunc()
End</pre><br><br><i>foo\one.monkey:</i><br><pre class=code>Class Hello
Internal
	Field bar:Int = 10
End</pre><br><br><i>foo\two.monkey:</i><br><pre class=code>Private
Import one

Public
Function TestFunc()
	Local h:=New Hello
	Print "TestFunc: "+h.bar
	' compiles because "two.monkey" is in the same directory as "one.monkey"
End</pre><br><br><i>So what does this mean?  It means that framework/module developers can now make things "public" within their framework without actually sharing them to the end user.  Got a funky ugly utility method in one of your modules that the user should never ever see?  Now you don't need to make it public.<br>I've got it working locally in a forked version of trans, and once I'm sure it's all good I'll push it to my GitHub fork.  If people are interested (especially Mark), I'll submit a pull request.</i><br><br><i>And get this... I made the changes to trans in Notepad++ with no syntax highlighting and it compiled first shot.  And worked first shot.  I'm scared... D:</i> <br><br></td></tr></table><br>
<a name="2100738"></a>

<a name="2100737"></a>

<a name="2100736"></a>

<a name="2100735"></a>

<a name="2100513"></a>

<a name="2100512"></a>

<a name="2100511"></a>

<a name="2100510"></a>

<a name="2100497"></a>

<a name="2100293"></a>

<a name="2100292"></a>

<a name="2100294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does it work for files in subfolders too? <br><br></td></tr></table><br>
<a name="2100295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am definitely for this. In fact, this is what a few people wanted as a "Protected" keyword. Basically, what C++ has for friend classes and inheriting classes, only with module-level behavior as well. <br><br></td></tr></table><br>
<a name="2100296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @ziggy: Does it work for files in subfolders too? <br></div><br>When you try to reference anything flagged as internal, it will not compile unless the source is in the same folder.  This goes for any code in any module.<br><br><div class="quote"> @ImmutableOctet: I am definitely for this. In fact, this is what a few people wanted as a "Protected" keyword. <br></div><br>The protected keyword works slightly differently in Java.  It gives you package/default visibility (like internal) but also visibility to subclasses.  Personally I don't like the latter case.  It seems like a cheap trick the developer can use to get access to things they shouldn't. <br><br></td></tr></table><br>
<a name="2100298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Personally I don't like the latter case. It seems like a cheap trick the developer can use to get access to things they shouldn't. <br></div><br>What!? Like "setAccessible(true)" ;P <br><br></td></tr></table><br>
<a name="2100299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @therevills: What!? Like "setAccessible(true)" ;P <br></div><br>You love the reflection. :)<br>Besides, if Sunacle really cared about it they'd put in a more restrictive classloader that would prevent it. <br><br></td></tr></table><br>
<a name="2100325"></a>

<a name="2100326"></a>

<a name="2100327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is pretty awesome, but it's not a replacement for Protected -- I'm personally not too thrilled about keywords that enforce rules about how source files should be stored on-disk, but that's just my style;  I don't know why, but that seems rigid and arbitrary (actually, a lot like how Java is in general).  It's a step in the right direction, though.  <br><br>So module developers can extend their own classes in other files and still be able to keep them away from people who aren't hacking the module itself.  Woo-hoo, a win for encapsulation on the part of module developers, right?  But only for ones who code in a certain way!  This helps the ones who were having woes extending their own classes that had Private fields, not necessarily the ones who want to offer the ability to extend their classes to others.<br><br>Even if it's basically just a 6" tall fence, Protected's main purpose is to enhance encapsulation in the same kinda way Internal does, but without the rigidity -- So, if you design a module with classes that you're encouraging people to extend in their own projects, they don't have to hack the module to do it, but still gain the benefits of having dirty-looking class members tucked away (and in the case of a proper IDE, neatly hidden from autoComplete) should they not want to extend the existing classes the module developer included.<br><br><b>Edit</b>:  Anyway, if this goes over without a hitch, I'd love to see exactly where you needed to edit to get this working.  I'd still love to see a Protected keyword available, and both of the keywords can actually work together in other languages, but until now, all of the scope directives were mutually exclusive.  This is definitely something to think about seeing as how there appear to be different camps of people who are gonna prefer one style or the other of shielding class members from being accessed outside of their "proper place".  Syntax-wise, you can't stack scope directives in Monkey right now, and it would be very confusing to have rules where they do, unless all scope directives which can combine with another need to be placed on the same line where any directive is called, and each new line with a directive resets everything else. <br><br></td></tr></table><br>
<a name="2100323"></a>

<a name="2100324"></a>

<a name="2100334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tiresius</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> How is this different than Private ?  Does Private only allow access within the monkey file itself? <br><br></td></tr></table><br>
<a name="2100338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> in my ideal world, a Friend keyword that exposes functionality only to the modules I'm importing, and not to the modules that import me, would be the best encapsulation model to develop modules, but I guess it's quite difficult to implement. However, this is anyway a nice addition to the language. <br><br></td></tr></table><br>
<a name="2100340"></a>

<a name="2100341"></a>

<a name="2100343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Nobuyuki: ...but it's not a replacement for Protected... <br></div><br>It's not intended to be a replacement for protected.  Protected could still be added, but increases the visibility of internal slightly.<br><br>Visibility would go:<br>Private &lt; Internal &lt; Protected &lt; Public<br><br>Private: Can only be seen within the same source file.<br>Internal: Same as private, but can also be seen in source files at the same level/directory.<br>Protected: Same as internal, but can also be seen by any subclass regardless of source file.<br>Public: Can be seen everywhere.<br><br><div class="quote"> @Nobuyuki: I'm personally not too thrilled about keywords that enforce rules about how source files should be stored on-disk... <br></div><br>This was the easiest way to ensure that source was at the same module "level" as others.  This problem would be alleviated if Monkey source required a package/namespace definition at the top of the file, but ehhh.<br><br><div class="quote"> @Nobuyuki: Woo-hoo, a win for encapsulation on the part of module developers, right? But only for ones who code in a certain way! <br></div><br>All module developers should code in this way.  If you don't want your user to see it, you shouldn't make it public.  Internal and/or Protected keywords allow a little more flexibility for those that code their current way.  It actually helps those module developers! :)<br><br><div class="quote"> @Nobuyuki: Anyway, if this goes over without a hitch, I'd love to see exactly where you needed to edit to get this working. <br></div><br>Some very minor changes to decl.monkey, parser.monkey, preprocessor.monkey, and toker.monkey.  I can quite easily extend my changes to include protected too.<br><br><div class="quote"> @tiresius: How is this different than Private ? Does Private only allow access within the monkey file itself? <br></div><br>Correct.<br><br><div class="quote"> @ziggy: ...in my ideal world, a Friend keyword that exposes functionality only to the modules I'm importing, and not to the modules that import me, would be the best encapsulation model to develop modules, but I guess it's quite difficult to implement. <br></div><br>This is still possible, but now we get into the world of conflicting visibilities.  I'd rather leave that alone for the time being.  The more I change, the more testing would be required, which reduces my chance of getting a pull request accepted.  Something to think about though.<br><br>Edit: Pushed.<br><a href="https://github.com/swoolcock/monkey/commit/1f930f79cc4b2390a797cfb503de2e070ea8f6ac" target="_blank">https://github.com/swoolcock/monkey/commit/1f930f79cc4b2390a797cfb503de2e070ea8f6ac</a> <br><br></td></tr></table><br>
<a name="2100372"></a>

<a name="2100373"></a>

<a name="2100374"></a>

<a name="2100375"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Some very minor changes to decl.monkey, parser.monkey, preprocessor.monkey, and toker.monkey. I can quite easily extend my changes to include protected too. <br></div><br><br>I would really appreciate you doing that if you're up to implementing it;  I don't know about anyone else, but I'd definitely use it.  There's already a bunch of lines scattered throughout my modules where I wrote "Protected" and commented it out hoping one day that Mark would include that directive :)<br><br>Still, though, the thing about the syntax is something to be aware of.  C# allows you to define members to be <i>both</i> Protected and Internal, which basically widens the restrictions to subclasses or modules, whichever one applies.  I have no idea how this would be easiest to implement in Monkey, since I've never really dug around in there, but probably the most rational thing syntax-wise seems to be to limit scope directives to their own line, and allow someone to declare "Internal Protected" or "Protected Internal" on that line, but presume neither whenever a scope directive is encountered encountered unless explicitly specified.  Again, not sure how this will work out, because it seems like syntax for scope directives is handled completely differently from most other keywords, but I guess the easiest thing to do would be to let any scope directive override all the others "just to be safe" at first since that's how it sounds like Monkey currently handles it.  (Remember "Interfaces can't be Generic" ?) <br><br></td></tr></table><br>
<a name="2100380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>Wait a minute, Samah, if all you want is to restrict files, why not just use private imports?</b> They already work in Monkey. A private import just stops something from being auto-imported  when someone imports your module. There's also "Extern Private", but that's basically a hack to make 'Private' work with external/native code.<br><br>Seriously, though, couldn't you just import a module, have that module privately import its local sub-modules, then only delegate what you want to be public? To me, a "Protected" keyword makes a bit more sense. Just some food for thought, but I think we really just need an "inheritance only" keyword, which makes things private to everything but derived classes. Technically, you could just privately import / not import the base-class's module, then simply force the user to import the module with the base-class, and extend from there (Making things private as the user see fit...?). But that can get overly complicated. I honestly think "Protected" and private imports are all we need, and we all ready have the latter.<br><br>MSDN's documentation is pretty inconsistent at times, but <a href="https://msdn.microsoft.com/en-us/library/e761de5s.aspx" target="_blank">here's their page on C++'s 'protected' keyword</a>. Basically all we need, from what I can see. There is some need for 'Internal', but I'm fine with just getting 'Protected'.<br><br>Having both would still be ideal, though. I just think 'Internal' is going against Monkey's "location doesn't matter" mindset, so we might need real "packages". <br><br></td></tr></table><br>
<a name="2100379"></a>

<a name="2100382"></a>

<a name="2100383"></a>

<a name="2100384"></a>

<a name="2100385"></a>

<a name="2100386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Nobuyuki: I would really appreciate you doing that if you're up to implementing it; <br></div><br>Already in the process. :)<br><br><div class="quote"> @Nobuyuki: C# allows you to define members to be both Protected and Internal... <br></div><br>This starts to get messy to implement, which is why I've opted to go for Java's "protected = package + subclasses" model.<br><br><div class="quote"> @ImmutableOctet: Wait a minute, Samah, if all you want is to restrict files, why not just use private imports? <br></div><br>Because the developer could still manually import that file.  The point of encapsulation is to give the module creator the freedom to change any and all internal implementation with little fear of breaking backward compatibility.  As soon as a developer misuses part of your framework, they'll come back at you with "why doesn't this work".  It's easier to deny them in the first place than have to reply "don't do that" every time.  That and I'm an evil overlord. &gt;:D<br><br>Edit: Additionally, your suggestion of private imports only applies to classes and top level functions.  Using the Internal keyword on methods/fields etc. is not something you can achieve through private imports.  You may want to make the class public, but some of its members internal.<br><br>Edit 2: The beauty of open source is that if the developer really wants to be naughty, they can just hack the framework anyway. :) <br><br></td></tr></table><br>
<a name="2100477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've got protected working separately to internal, and they can be used separately or together.  If something is "internal" it can only be used within the same directory.  If it's protected, it can only be accessed by subclasses.  However, you can define things as both internal and protected to get both functionalities.<br><br>Once I've fully tested it I'll push the changes. <br><br></td></tr></table><br>
<a name="2100489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does this work on methods as well as fields?  As I understand it, Monkey's Private qualifier only works on fields.<br><br>(Personally I prefer the C++ system.) <br><br></td></tr></table><br>
<a name="2100490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >computercoder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good work Samah! I look forward to having this type of encapsulation in Monkey :) Keep up the excellent efforts! <br><br></td></tr></table><br>
<a name="2100495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pushed.<br>Please test it for me, because I'm lazy. XD<br><a href="https://dl.dropboxusercontent.com/u/20511758/trans.zip" target="_blank">https://dl.dropboxusercontent.com/u/20511758/trans.zip</a><br>Built using MinGW because I couldn't get VC++ to work on my PC.<br><br><div class="quote"> @Gerry Quinn: Does this work on methods as well as fields? As I understand it, Monkey's Private qualifier only works on fields. <br></div><br>Monkey's Private keyword actually works on everything.  If you look in the CheckAccess method in trans, it does a check for every Decl (class/method/function/etc.) of a program.  If it's private, it checks to see that it's the current module.<br>As for the new keywords, internal works on everything.  Protected only works on class members (methods/functions/globals/fields).  It makes no sense to use protected outside the scope of a class.<br><br><div class="quote"> @computercoder: Good work Samah! I look forward to having this type of encapsulation in Monkey :) Keep up the excellent efforts! <br></div><br>&lt;3<br><br>Edit: Be aware that because protected and internal can be used together, you cannot switch between them without first resetting the visibility.  You will need to set Private or Public to reset it, then choose the one you want.  I may change it in the future to check if the keywords are together, or replace them with a standalone keyword "ProtectedInternal".<br><br><pre class=code>Public
  Field a ' public
Internal
  Field b ' internal
Protected
  Field c ' protected AND internal
Internal
  Field d ' still protected AND internal
Private ' resets the protected and internal bits
Internal
  Field e ' only internal</pre><br><br>Edit 2: Can I get opinions on this?  Which way would you prefer to force both internal and protected at once?<br>a) Keywords must be next to each other (no variable/method declarations between them)<br>b) Need to use another keyword like ProtectedInternal.<br>c) Something else?<br><br>a) is tricky, b) is a lot easier. <br><br></td></tr></table><br>
<a name="2100494"></a>

<a name="2100493"></a>

<a name="2100492"></a>

<a name="2100502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool!  Hopefully Mark takes a look at this.  The "reset" issue definitely would benefit from having both words work together, though obviously that would be more work.  ProtectedInternal seems like a good-enough solution,  but of course adds to the reserved keyword soup... Crossing my fingers a pull request will spur Mark to implement the elegant solution himself....!<br><br>My list of preferred implementations, in order from "most wanted" to least-wanted:<br>1.  "Protected" and "Internal" reset each other's bits as do Public/Private, but "Protected Internal"  or "Internal Protected" is its own scope level above either individually (just below Public).<br>2.  Same as above, but with a new keyword "ProtectedInternal", which is easier to implement.<br>3.  "Protected" and "Internal" have bits that are only reset on Public/Private directives  (how it currently is with this fork)<br>4.  Not having either of these features (current mainline) <br><br></td></tr></table><br>
<a name="2100505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Nobuyuki: 1. "Protected" and "Internal" reset each other's bits as do Public/Private, but "Protected Internal" or "Internal Protected" is its own scope level above either individually (just below Public). <br></div><br>The problem with that is, do I allow newlines?  Should "Protected (newline) Internal" count as "protected internal" or as only internal?  The tokeniser is currently designed to ignore newlines for those keywords, and I REALLY don't want to change that.<br><br><div class="quote"> @Nobuyuki: 2. Same as above, but with a new keyword "ProtectedInternal", which is easier to implement. <br></div><br>This is my preference.<br><br><div class="quote"> @Nobuyuki: Crossing my fingers a pull request will spur Mark to implement the elegant solution himself....! <br></div><br>The point of a pull request is to have the changes merged with the mainline, not for the mainline developer to say "hey that's a good idea" and just do it himself. :|<br>Otherwise I wouldn't have bothered, and just spam Mark with emails instead.<br><br>Edit: I've changed it to use a ProtectedInternal keyword.  Using Protected or Internal by themselves will now do ONLY those visibilities.  "ProtectedInternal" is the least ambiguous keyword I can think of without inventing a new term.  Private, Public, Protected, Internal, ProtectedInternal are more than enough. <br><br></td></tr></table><br>
<a name="2100503"></a>

<a name="2100504"></a>

<a name="2100508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see your point.  I wasn't aware that prefixing a declaration with a scope directive on the same line was valid Monkey code.  I'm assuming that this sets the directive for everything below it, regardless of the fact it's on the same line.  I don't know if anyone uses this coding style, but it's a serious "gotcha" for VB coders, because member declarations inside a class or module which aren't explicitly scoped are automatically assumed to be Private in VB.  It's not very pretty Monkey syntax, either, seeing as how for consistency you'd have to make sure every declare line had the directive in front of it.<br><br>"Elegant" in my mind means 1., but again I wasn't aware that putting scope directives on the same line as a declare was valid syntax.  In that case, "elegant" in my mind would ideally mean changing the syntax to be scoped only to the  line it's on if anything else occurs on that line.  That doesn't sound feasible if <i>anyone</i> has code that relies on "VB-as-written, Monkey as interpreted" style declarations, though, because it could break their code in subtle ways....  Alternatively, throwing a compile error if a scope directive is on the same line as a declaration would break their code in a very explicit way.  Either way it could get ugly...<br><br>I guess I'm just not a fan of a keyword that is the portmanteau of two other keywords that already have the same functionality in the language.  Should more scoping directives be implemented in the future (someone in another thread mentioned Friend?), combining them would end up requiring even more keywords.  Then again, what other access levels can exist?  If the issue's really just a tempest in a teapot, then ProtectedInternal would be perfectly fine with me;  just wanted to bring up what I thought could possibly be a future issue. <br><br></td></tr></table><br>
<a name="2100507"></a>

<a name="2100506"></a>

<a name="2100514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Nobuyuki: I guess I'm just not a fan of a keyword that is the portmanteau of two other keywords that already have the same functionality in the language. <br></div><br>I agree, but as I said in my edit, it's the least ambiguous thing I could think of.  Bringing in a third visibility name that = protected+internal is just something else to remember and makes the language more confusing. <br><br></td></tr></table><br>
<a name="2100528"></a>

<a name="2100529"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> The more I think about it, the more I'm wondering if ProtectedInternal is even needed.  I can't off the top of my head think of a situation that it would be useful.  I may just drop the whole idea and leave Protected and Internal as mutually exclusive. <br><br></td></tr></table><br>
<a name="2100563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> seems safer to do that to start with;  if someone has a use-case scenario for it, I guess it would end up being a future feature request, huh? <br><br></td></tr></table><br>
<a name="2100593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> ProtectedInternal removed, changes pushed, hosted binary updated.<br>If you guys can do some testing I might make a pull request at some point, but I want a response from Mark first. <br><br></td></tr></table><br>
<a name="2100827"></a>

<a name="2100828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well this post was about to fall off the page, so instead of just bumping it, I've submitted the pull request.<br><a href="https://github.com/blitz-research/monkey/pull/74" target="_blank">https://github.com/blitz-research/monkey/pull/74</a> <br><br></td></tr></table><br>
<a name="2100848"></a>

<a name="2100849"></a>

<a name="2100850"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> good!  Sorry that I didn't do any rigorous testing.  I wouldn't be able to tell what problems were related to the IDE not supporting the modifications, and what problems were related to the patch, so I'm waiting for this to get pulled into the develop branch and for ziggy to make the Jungle inline compiler be aware of it before I start putting it through the ringer. <br><br></td></tr></table><br>
<a name="2100872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, so I was naughty and made these commits on the develop branch rather than a feature branch.  Now that I'm going to strip out all the Internal stuff and just leave the Protected keyword, I'm considering making a new feature branch from the original clone point.<br>However... should I also strip the other commits?  I know it's very naughty to rewrite public history, but I feel bad for putting yucky commits on a main branch.  Maybe I should just delete the repo and reclone? <br><br></td></tr></table><br>
<a name="2101046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mark has now added Protected and Friend. :)<br><a href="https://github.com/blitz-research/monkey/commit/4e42bae58122397697e0256060560bdeee34cb02" target="_blank">https://github.com/blitz-research/monkey/commit/4e42bae58122397697e0256060560bdeee34cb02</a> <br><br></td></tr></table><br>
<a name="2101061"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Friend"??? <br><br></td></tr></table><br>
<a name="2101063"></a>

<a name="2101070"></a>

<a name="2101071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> <strike>A module explicitly states which other modules are allowed to import it.</strike><br>Edit: I misunderstood Mark's implementation of Friend. <br><br></td></tr></table><br>
<a name="2101066"></a>

<a name="2101068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> A quick rundown on friend...<br><br>Friend grants 'private access' to a module. Friend statements must appear at the top of file along with imports, eg:<br><br><pre class=code>
'----- test1 -----

Import test2

Function Main()
   Print strange
End

'----- test2 -----

Friend test1   'doesn't actually import test1, just declares it as a 'friend'. If you want test1, you still need to import it.

Private

Global strange:Int   'private, except to this module and friend modules.
</pre><br><br>Note though that since test1 hasn't declared test2 as a friend, test2 still cannot access private stuff in test1.<br><br>This serves a similar purpose to 'internal' in c# (apparently, never used it), 'friend' in c++ and the idea of 'package scope' in Java.<br><br>It's basically away to let external (but trusted/known) code access some of the nitty gritty bits of a module.<br><br>An example of this would be in mojo.graphics, where there's a public function called SetGraphicsContext or similar. I really didn't want this to be public, but had no choice since it's basically there for mojo.app to call. With Friend, I can now make it private, add Friend mojo.app to mojo.graphics and all is groovy. <br><br>As for protected, this works the same way it does in c#, c++, java (sort of) - it makes class members accessible to derived classes, eg:<br><br><pre class=code>
'----- test1 -----

Import test2

Class D Extends C

	Method Test:Void()
		Helper()
	End
End

Function Main()
	Local t:=New D
	t.Test
End

'----- test2 -----

Class C

Protected

	'can only be called by C or derived classes.
	Method Helper:Void()
		Print "Help!"
	End

End
</pre> <br><br></td></tr></table><br>
<a name="2101069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @marksibly: As for protected, this works the same way it does in c#, c++, java (sort of) - it makes class members accessible to derived classes, eg: <br></div><br>Java's "protected" expands "package scope" to also include subclasses.<br><br>private: Only the current compilation unit<br>(package): The current compilation unit, plus all classes in the same package.<br>protected: The current compilation unit, all classes in the same package, and any subclasses from any package.<br>public: Everything. <br><br></td></tr></table><br>
<a name="2101091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great news - I've always wanted a Protected access qualifier!<br><br>Will this be moved into any Monkey language stuff?  List and Node in particular have always seemed to me a natural fit for the use of Protected instead of Private, <br><br></td></tr></table><br>
<a name="2101114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Gerry Quinn:  +1 to that , I always wanted to be able to extend Stacks to access the raw array on occasion.  Would definitely make it cleaner to pack in extensions to the native containers for things like better sorting / collating capability and etc <br><br></td></tr></table><br>
<a name="2101125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Nobuyuki: @Gerry Quinn: +1 to that , I always wanted to be able to extend Stacks to access the raw array on occasion. Would definitely make it cleaner to pack in extensions to the native containers for things like better sorting / collating capability and etc <br></div><br>Yeah, I will be going through the Diddy container classes to improve their sorting performance, etc. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
