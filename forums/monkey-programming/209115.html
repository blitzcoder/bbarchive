<!DOCTYPE html><html lang="en" ><head ><title >User Module mixed C++</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >User Module mixed C++</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >User Module mixed C++</a><br><br>
<a name="2095564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nigelibrown</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My module has the structure:<br><br>modules/module/module.monkey<br>modules/module/native/module.cpp<br>modules/module/module.h<br><br>in my module.cpp I include the header with #include "../../module.h" but it is not looking for the header file in the module directory, it is looking for it in my project folder.<br><br>Question: How can I include the module.h file in my module.cpp from the module structure? Else I have to copy the module.h file into all of my projects and it is no longer modular. I would like to store it in the native folder along with the cpp files. <br><br></td></tr></table><br>
<a name="2095571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> ../../ means it goes 2 levels up which is your modules folder. <br><br></td></tr></table><br>
<a name="2095577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nigelibrown</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mike, thats the problem its not! "../../module.h" is actually looking in the project that imports the module using "Import module.module' it will find the module.h file if you place it inside the project? <br><br></td></tr></table><br>
<a name="2095579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sub_Zero</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @nigelBrown: If that is the problem, you can copy files to the project folder during build time (or else they always get overwritten):<br><br><a href="http://www.monkey-x.com/Community/posts.php?topic=3377#36970" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=3377#36970</a> <br><br></td></tr></table><br>
<a name="2095608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nigelibrown</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Best solution I have found to date is to use an absolute path i.e "#include "c:\Monkey81b\modules\module\native\module.h" not a very modular approach i know! There must be a better way of achieving this? <br><br></td></tr></table><br>
<a name="2095618"></a>

<a name="2095619"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can't you get trans to import (inline) the header just like it is doing with the cpp? You could then remove the #include altogether.<br><br>Or just paste your header into your cpp, .h files don't really make sense in monkey modules. <br><br>I found for serious native code development with monkey, using my own target was best. I would typically attach some test cases and use a native IDE to debug the native code / target before adding any monkey apps to the mix. <br><br></td></tr></table><br>
<a name="2095616"></a>

<a name="2095617"></a>

<a name="2095623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImmutableOctet(SKNG)</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I remember right, Monkey doesn't play well with header files. I'd say your best bet for this effect is to just rename the headers to CPP files (Possibly "*.h.cpp"; that's what I usually go with), then you just import them first. It's a bit of a hack, but it works pretty well. I ended up doing this with symbolic links in the past. Well, either that, or you make a new target. I just use the C/C++ preprocessor for projects that are for standard C/C++ and Monkey at the same time. I simply don't import any of the project-local header files if a custom Monkey flag/variable is enabled/defined (Which I obviously define myself). I honestly think we should patch 'Trans' to just support header files, at least then we wouldn't have to add ".cpp" to everything. Or maybe we could add something for getting the module's global path from C++ (Maybe through the Monkey and C++ preprocessors)? That's a bit of a stretch, though.<br><br>The thing is, Monkey isn't the best at producing the most optimal structure for its generated code (Unless it's JavaScript, then it's not bad). With the C/C++ based targets, it simply adds it all to one file. That being said, this approach is actually pretty good performance-wise. The issues really start coming in when you have 20+ large modules on top of the default modules along with the reflection filter set to everything ("*"). Then you end up having GCC/MinGW sit there for 20 minutes using 800+ MB of RAM, doing effectively nothing. But, that could technically be seen as an optimization issue with the standard 'reflection' module.<br><br>Anyway, the point I'm trying to make is that external C/C++ code in Monkey is <i>overall different</i>. You can use anything you want, but if you delegate it to Monkey, you could run into issues. If you want a really nice experience with this, you'll probably just want to either have your users grab the C/C++ version, set it up with their compiler's includes and what-not, then use the library normally from external C or C++ code at Monkey's level. Either that, or what I said earlier (Which is more hassle for you, but less hassle for them).<br><br>And don't get me started on adopting Monkey's "object model" for the sake of supporting the garbage collector without using a wrapper (It's not that bad, it's just annoying; only really needed for the classes being directly worked with, though).<br><br>You basically need to pick a trade-off. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
