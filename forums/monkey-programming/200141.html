<!DOCTYPE html><html lang="en" ><head ><title >Angelfont Bitmap font library</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Angelfont Bitmap font library</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Angelfont Bitmap font library</a><br><br>
<a name="2042767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> You may've noticed my bitmap font library (Angelfont) in the bananas\beaker folder in your monkey installation.<br>Latest version here:<br><a href="http://beaker.powweb.com/monkey_beaker_angelfont.zip" target="_blank">http://beaker.powweb.com/monkey_beaker_angelfont.zip</a><br><br>You make your fonts using one of the tools below:<br><br>AngelCode Bitmap Font Tool (PC only):<br><a href="http://www.angelcode.com/products/bmfont/" target="_blank">http://www.angelcode.com/products/bmfont/</a><br><br>Hiero Bitmap Font Tool (Mac/PC):<br><a href="http://slick.cokeandcode.com/" target="_blank">http://slick.cokeandcode.com/</a><br>Direct link to java app:<br><a href="http://slick.cokeandcode.com/demos/hiero.jnlp" target="_blank">http://slick.cokeandcode.com/demos/hiero.jnlp</a> <br>Lion fix here:<br><a href="http://www.cocos2d-iphone.org/forum/topic/220/page/2" target="_blank">http://www.cocos2d-iphone.org/forum/topic/220/page/2</a><br><br>BMGlyph (Mac only):<br><a href="http://www.bmglyph.com/" target="_blank">http://www.bmglyph.com/</a><br>Cheap but paid option.<br><br>Glyph designer (Mac only):<br><a href="http://glyphdesigner.71squared.com/" target="_blank">http://glyphdesigner.71squared.com/</a><br>This is definitely the best (and most expensive) Mac tool. :)<br><br><br>Features of this library include:<br>Alignment (left, right and center).<br>Draw text justified to a box.<br>Simple italic &amp; bold (with embedded HTML codes).<br>Kerning (on by default, turn it off for more speed).<br>Simple input box.<br><br><br>[deprecated - You don't need this stuff anymore. But you might find it useful if you want your font data file to be smaller and not XML.]<br>You need to export an XML .fnt file (and PNG bitmap) from AngelCodes BFG and then convert it by dropping the .fnt file onto the "drop_angelfont_xml_here.exe" (bmx sourcefile is there also). There's a similar bmx tool for Hiero fonts.<br>Compiled versions here:<br><a href="http://beaker.powweb.com/dragangelfont.zip" target="_blank">http://beaker.powweb.com/dragangelfont.zip</a><br>[/deprecated]<br><br><br>Let me know how you get on. Any feedback welcome. If you make any enhancements then please share them. <br><br></td></tr></table><br>
<a name="2031459"></a>

<a name="2031385"></a>

<a name="2031366"></a>

<a name="2031309"></a>

<a name="2000713"></a>

<a name="2000714"></a>

<a name="2000715"></a>

<a name="2007309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker, just started implementing this and in your example, I see that it wraps to a new line. However I can't seem to get this to work for me? (Just carries on writing from the start at the same line)<br><br>Should I be doing anything in particular?<br><br>Ta :)<br>-Chris <br><br></td></tr></table><br>
<a name="2007310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> To carry on, I put the text I am trying to write directly in to your example.<br><br>textBoxText = "You will notice you are unable to move. Your only ability is the ninjah rope for this level. At the bottom right of the screen you will see three ability icons. Move, lets you move left and right. Rope, lets you use your ninjah rope. Gun, lets you boost."<br><br>Causes the following...<br><br><img src="http://i.imgur.com/o10CC.png"> <br><br></td></tr></table><br>
<a name="2009255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >luggage</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought I'd have a go at putting a nicer font in, I have my font ready to go but there's no sign of the exes.  I can see the bmx files but I don't have Blitz installed.  Is there another location to get them from?<br><br>Thanks! <br><br></td></tr></table><br>
<a name="2009273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xzess</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @raz this is a very good question, i couldn't also find out yet<br><br>how to wrap to a new line?<br>like in the angelfont example? <br><br></td></tr></table><br>
<a name="2009448"></a>

<a name="2009463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The hiero java tool doesn't seem to work on Win7x64.<br><br>EDIT: scratch that, you can't SAVE the java file, you need to run it right there off the website. <br><br></td></tr></table><br>
<a name="2009470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> BTW- new line is :<br>Case 10	' newline<br><br>which may be a ~n <br><br></td></tr></table><br>
<a name="2015152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please note that the <a href="http://slick.cokeandcode.com/demos/hiero.jnlp" target="_blank">http://slick.cokeandcode.com/demos/hiero.jnlp</a>  tool saves the bitmaps upside down on (some?) Macs. <br><br>Simply flip the png in Preview, and you're fine. :-) <br><br></td></tr></table><br>
<a name="2015428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >siread</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do you create the XML file? I only get a .fnt and .png when saving from bfg. <br><br></td></tr></table><br>
<a name="2015431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hima</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @siread<br>You can set the format to be xml from the export option, I think. The result will still be .fnt, but the actual content is an xml file so you can rename it just fine.<br><br>Then go into the source code, there's a Blitzmax project file you can build. Build it and you'll get an executable that you can just drop .xml file on the executable to get a formatted xml that can be used with this AngelFont library <br><br></td></tr></table><br>
<a name="2015433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >siread</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, got it. Thanks.<br><br>One thing - the png file is appended with _0 which I needed to remove.<br>Also, in Class AngelFont, "Field chars:Char[256]" is too small for unicode.<br><br>:) <br><br></td></tr></table><br>
<a name="2015441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hima</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @siread<br>No problem :)<br><br>I wonder if it would be better to use Map instead of array. Like you said, the default size is too small for unicode. For some languages like Japanese, it goes to like 13000 or something, if I recall correctly. <br><br></td></tr></table><br>
<a name="2015525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where is the "drop_angelfont_xml_here.exe" file located?  I don't have Blitz, is this something I need to get somewhere? <br><br></td></tr></table><br>
<a name="2015526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, is there a license for using AngelFont module? <br><br></td></tr></table><br>
<a name="2015544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hima</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @benmc<br>You can get blitzmax 30 day trial from here <a href="http://www.blitzbasic.com/Products/_index_.php" target="_blank">http://www.blitzbasic.com/Products/_index_.php</a> <br><br></td></tr></table><br>
<a name="2020062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >luggage</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Argh, I installed that a while ago and now it's expired.  Any chance of someone hosting the exe versions please? <br><br></td></tr></table><br>
<a name="2020067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Give these a go:<br><a href="http://beaker.powweb.com/dragangelfont.zip" target="_blank">http://beaker.powweb.com/dragangelfont.zip</a><br><br>benmc - the license for the AngelFont module is the same as that for monkey. <br><br></td></tr></table><br>
<a name="2020071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Beaker, just want to thank you for AngelFont.  Diddy is great too, but yours is the only module I absolutely couldn't live without! <br><br></td></tr></table><br>
<a name="2021135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function Draw:Void(text:String, x:Int, y:Int, width:Int)	
	Local thisLine:String = ""
	Local charOffset:Int = 0

	Local wordLen:Int = 0
	Local word:String = ""
		
	yOffset = 0
	For Local i := 0 Until text.Length
	If y+yOffset &gt; DeviceHeight()
		Return
	Endif		
		
	Local asc:Int = text[i]
	Select asc
		Case 32	' space
			wordLen = font.TextWidth(word)
			If charOffset + wordLen &gt; width
				DrawTextLine(thisLine, x,y+yOffset)
				thisLine = ""
				charOffset = 0
			Endif
'			Local chars:Char[] = font.GetChars()
			charOffset += wordLen+font.GetChars()[32].xAdvance
			thisLine += word + " "

			word = ""
			'wordLen = 0
		Case 10	' newline
			wordLen = font.TextWidth(word)
			If charOffset + wordLen &gt; width
				DrawTextLine(thisLine, x,y+yOffset)
				thisLine = ""
			Endif
			thisLine += word

			DrawTextLine(thisLine, x,y+yOffset)

			thisLine = ""
			charOffset = 0
			word = ""
		Default
			Local ch:Char = font.GetChars()[asc]
			word += String.FromChar(asc)
		End Select
	Next

	If word &lt;&gt; ""
		wordLen = font.TextWidth(word)
		If charOffset + wordLen &gt; width
			DrawTextLine(thisLine, x,y+yOffset)
			thisLine = ""
		Endif
		thisLine += word
	Endif
	If thisLine &lt;&gt; ""
		DrawTextLine(thisLine, x,y+yOffset)
	Endif
End
</textarea><br>This should fix the SimpleTextBox's newline problem. Apparently some of the yOffsets were misplaced. :P <br><br></td></tr></table><br>
<a name="2021134"></a>

<a name="2021875"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul - Taiphoz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> is this still being developed ? <br><br></td></tr></table><br>
<a name="2021880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not actively. It's complete as is. What did you have in mind? <br><br></td></tr></table><br>
<a name="2021902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul - Taiphoz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> a few things actually, but first of all fonts that are not packed, not sure if the code can handle them at the moment cant seem to find the option if it can.<br><br>Having the font unpacked and in a nice grid makes it easier for us to then create a sweet looking font in some other art tool, but when their all packed in tight it does not leave much room for glow's or other effects. <br><br></td></tr></table><br>
<a name="2021907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure that the tools for creating fonts allow you to add padding space around each font character, so that you can later edit the font in photoshop etc.<br><br>-----------------------------------------------------<br><br>This app also exports to an AngelFont compatible format (EZGui export):<br><a href="http://www.bmglyph.com/" target="_blank">http://www.bmglyph.com/</a> <br><br></td></tr></table><br>
<a name="2021908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> This one works as well:<br><a href="http://glyphdesigner.71squared.com/" target="_blank">http://glyphdesigner.71squared.com/</a> <br><br></td></tr></table><br>
<a name="2022000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Texpac in my sig allows you to increase the padding space.  I could add an export to AngelFont if there's interest? <br><br></td></tr></table><br>
<a name="2027168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is great, thanks. <br>The SimpleTextBox.DrawHTML routine however, is too slow to be able to scroll/swipe the text when rebuilding the textbox every frame on a different horizontal offset. Is there some workaround for that? Maybe caching it to a single image, is that possible?<br><br>Edit: found the reason, using SetColor slows things down tremendously. When using white text all is fine. <br><br></td></tr></table><br>
<a name="2026928"></a>

<a name="2026941"></a>

<a name="2026942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This one works as well:<br><a href="http://glyphdesigner.71squared.com/" target="_blank">http://glyphdesigner.71squared.com/</a> <br></div><br>Yea glyph designer is awesome, I really like it. If anyone is interested I can sort out my glyph designer module and post it on the code archives. Its a very simple loader that can store multiple fonts, draw dynamic strings and static strings with alignment. However I doubt it has the functionality of this module... <br><br></td></tr></table><br>
<a name="2029092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> From here:<br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=2833" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=2833</a><br><br><div class="quote"> Maybe many of you already know the free Hiero font tool with which you can export bitmap fonts.<br>Since OSX Lion however there seems to be a problem with the official version (preview not working). I searched around and found out many people have this problem but there is a solution: <a href="http://www.cocos2d-iphone.org/forum/topic/220/page/2" target="_blank">http://www.cocos2d-iphone.org/forum/topic/220/page/2</a><br>The second to last post contains a download which works on 10.7 (for me). <br></div> <br><br></td></tr></table><br>
<a name="2031263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rebelas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to thank you for AngelFont library. Using blitzmax tool above and AngelCode and the AngelFont library, now I am free from Monkey's default font. <br><br></td></tr></table><br>
<a name="2031308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> This works as well and is inexpensive and nice:<br><a href="http://www.bmglyph.com/" target="_blank">http://www.bmglyph.com/</a><br>Mac only tho. <br><br></td></tr></table><br>
<a name="2031336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> A big thums up to bmglyph,<br>That's what I'm using. <br><br></td></tr></table><br>
<a name="2031361"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neuro</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are some nice font tools available for the Mac (i'm using Glyphdesigner myself), but besides that buggy Heiro app and the AngelCode Bitmap tool are there any others available for the PC? <br><br></td></tr></table><br>
<a name="2031396"></a>

<a name="2031406"></a>

<a name="2031407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mulawa1</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Help!<br><br>AngelCode works fine for me using Beaker's sample fonts.<br><br>Now I'm trying to use the AngelCode Bitmap Font Tool to generate a larger font. But no matter what I do I end up with a totally transparent png file even though the Preview looks fine.<br><br>Perhaps some kind soul could provide screen grabs of the Font &amp; Export windows that will produce a non-empty png file.<br><br>Peter<br><br>Later: I think I may have solved my problem - I had "Pack chars in multiple channels" ticked - unticked it seemd to work ok. <br><br></td></tr></table><br>
<a name="2031447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is very likely the ARGB channel settings as shown here:<br><img src="http://www.angelcode.com/products/bmfont/images/exportsettings.png"><br>Trying fiddling around with the alpha one. <br><br></td></tr></table><br>
<a name="2038114"></a>

<a name="2038115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please help me!<br><br>Now I'm struggling around for nearly one hour of experiments with the angelfont tool to get a complete VERDANA font with 255 ASCII signs.<br><br>Sometime I get empty Texts, sometime I get black boxes instead of text. And the best I got, was a visible text with really rough letters.<br><br>Can somebody please tell me how I can transfer VERDANA.TTF to VERDANA.TXT and VERDANA.PNG and having the same quality like it was in beakers example?<br><br>I tried the following settings:<br><br>Font Setting:<br>------------------<br>font=Verdana<br>Add font file: &lt;empty&gt;<br>Charset=OEM ANSI<br>Size=32<br>Height=100%<br>Font smoothing= YES<br>Clear Type=YES<br>Match, bold, Italic,Output..., Do not..., Render..., Super...   NO<br><br>Export Options:<br>------------------<br>Padding=  0 0 0 0<br>Spacing= 1 1<br>With=256<br>Height=256<br>Bit depth=32<br><br>Channel A=outline<br>Channel R,G,B = glyph<br><br>Preset=Custom<br>Font Descriptor=XML<br>Textures=png<br>Compression=Deflate<br><br>Equalize..., Force..., Pack..., Invert all NO<br><br>I did "Save bitmap..." and then drag the "VERDANA.FNT" over "drag_angelfont_xml_here.exe". Then renamed "VERDANA_0.PNG" to "VERDANA.PNG" and copied "VERDANA.PNG" and "VERDANA.TXT" to the "MyGame.data"<br><br>here the screenshots:<br><img src="http://www.blitzforum.de/upload/file.php?id=11977"> <br><br></td></tr></table><br>
<a name="2038113"></a>

<a name="2038533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Next problem with german umlauts and Angelfont:<br><br>The sample above runs on HTM5, but if you try to draw a german "Ü" with angelfont on Android the folloeing error appears:<br><br>If I code...<br>[monkeycode]Font.DrawText "Ü",50,50[/monkeycode]<br><br>...I get something looks like an "Äoe" with oe closed togehter.<br><br>If my app receive the "Ü" via MNet-Http and I now want to draw it in Angelfont, the debugger says:<br><br><div class="quote"> "Array index out of bounds" in "...angelfont.monkey&lt;138&gt;" <br></div><br><br><br>It looks like Angelfont does not handle right the ASCII values or UniCode values.<br><br>Or what do I do wrong? <br><br></td></tr></table><br>
<a name="2042613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've sent an updated AngelFont folder to Mark. Hopefully it will make it into the next monkey release.<br><br>Changes include:<br>Bugfix for razs problem above.<br>You no longer need to (but still can) process the .fnt file using the blitzmax app/sourcecode. You can now load the .fnt file directly, using skn3s config banana code (included) and the new LoadFontXml() method.<br><br>Should generally be a nicer experience.<br><br>Merry christmas. <br><br></td></tr></table><br>
<a name="2042634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Merry christmas.  <br></div><br><br>any chance to get the code? <br><br></td></tr></table><br>
<a name="2042766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here you go:<br><a href="http://beaker.powweb.com/monkey_beaker_angelfont.zip" target="_blank">http://beaker.powweb.com/monkey_beaker_angelfont.zip</a><br><br>I've added some more optimizations and bug fixes in the last hour after trawling through the forum for complaints etc (some quite unjustified!). <br><br></td></tr></table><br>
<a name="2042764"></a>

<a name="2042642"></a>

<a name="2042686"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent! <br>Looks like "Sparrow" is the font format to use from bmGlyph, will test... <br><br></td></tr></table><br>
<a name="2042725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sparrow looks like it should work with the new LoadFontXml() method.<br><br>I've just added support for paged font textures which BMFont supports, but it doesn't look like bmGlyph or GlyphDesigner do, which is a shame.<br><br>I've also optimized more and added a small fix to the simpleinputbox that Mark suggested.<br><br>I will put a new upload here tomorrow. <br><br></td></tr></table><br>
<a name="2042747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking cool.  I used the AngelCode app with BlitzMax for my last 3 casual games, it's very good.<br><br>Quick question: How did you do the italics? I didn't know there was any kind of skew texture command in Monkey. <br><br></td></tr></table><br>
<a name="2042746"></a>

<a name="2042753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey - I skewed the matrix using the Transform command. <br><br></td></tr></table><br>
<a name="2042756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Holy crap I didn't know you could do that.  This could be cool.  Can any other deforms be done? For example get a 2D texture and make it look like it's rotating in 3D by bringing in the corners on one edge?  Sorry for off-topicness. <br><br></td></tr></table><br>
<a name="2042765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is the very latest version:<br><a href="http://beaker.powweb.com/monkey_beaker_angelfont.zip" target="_blank">http://beaker.powweb.com/monkey_beaker_angelfont.zip</a><br><br>Grey - take a look at bananas/warpy/transform/transform.monkey and you will see that you can't do what you are thinking. <br><br></td></tr></table><br>
<a name="2042763"></a>

<a name="2042794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Beaker.  Shame. <br><br></td></tr></table><br>
<a name="2051721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> I created a bitmap font generator for this module its in Blitzmax in the code archives.I don't know if any changes have been made to the bitmap font text file but it works with the version I have. <br><br> useful for those that have Blitzmax. since there is no GUI, it all has to be modified with in code.<br><br>the source is here:<br><br><a href="http://www.blitzmax.com/codearcs/codearcs.php?code=3005" target="_blank">http://www.blitzmax.com/codearcs/codearcs.php?code=3005</a><br><br><br>It works in Mac  for most ttf fonts. the program had problems loading some of them but with most  it worked fine. I don't have a windows PC so if anybody tries it let me know how it worked.  <br><br>if any body is willing to take the time and write a gui it would be great. I might create one if I have some time next week. <br><br></td></tr></table><br>
<a name="2043494"></a>

<a name="2043493"></a>

<a name="2043518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> I havent changed the format of the text files at all, but now you can import BMFont format (.fnt) XML files as well. <br><br></td></tr></table><br>
<a name="2046362"></a>

<a name="2046364"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> hey Beaker,<br><br>I was looking at your module today to compare between the other font solutions. You might want to switch the XML parsing to: <a href="https://github.com/skn3/monkeymodules/tree/master/skn3/xml" target="_blank">https://github.com/skn3/monkeymodules/tree/master/skn3/xml</a><br><br>It is a lot faster and device memory friendly. <br><br></td></tr></table><br>
<a name="2046379"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Skn3. I'll take a look when I get a bit of time. <br><br></td></tr></table><br>
<a name="2046573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >c.k.</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker, I added Delete, End, and Home key functionality. Would be a useful addition to simpleinput.<br><br>[monkeycode]<br>Select asc<br>	Case 8	' backspace<br>		If cursorPos &gt; 0	'And text.Length &gt; 0<br>			text = text[..cursorPos-1]+text[cursorPos..]<br>			cursorPos -= 1<br>			Exit<br>		EndIf<br>		<br>	Case 127 ' delete<br>		If cursorPos &lt; text.Length Then<br>			text = text[ .. cursorPos] + text[cursorPos + 1 ..]<br>		EndIf<br>	<br>	Case 13<br><br>	Case 65572 ' cursor home<br>		cursorPos = 0<br>		<br>	Case 65571 ' cursor end<br>		cursorPos = text.Length<br>								<br>	Case 65573	' cursor left<br>		cursorPos -= 1<br>		If cursorPos &lt; 0 cursorPos = 0<br>		Exit<br>	Case 65575	' cursor right<br>		cursorPos += 1<br>		If cursorPos &gt; text.Length cursorPos = text.Length<br>		Exit<br>End<br>[/monkeycode] <br><br></td></tr></table><br>
<a name="2046584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice addition. Will add it soon. <br><br></td></tr></table><br>
<a name="2046844"></a>

<a name="2046845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've recently added text image cacheing to AngelFont. It definitely speeds up drawing in HTML5 and GLFW (and very likely other targets too). There are two new base commands:<br>[cacheImage = ]DrawTextCache(txt,x,y[, alphaColor[, cacheImage]])<br>[cacheImage = ]DrawHtmlCache(txt,x,y[, alphaColor[, cacheImage]])<br><br>As you can see you can store the image created and even optionally pass it back into the method for maximum speed. If you don't pass the cacheImage back in to the method then it looks up the text in a table (StringMap for now) to find the relevant image.<br><br>You can also optionally tell it to alpha out a background color to reduce pixels drawn.<br><br>Works nice. <br><br></td></tr></table><br>
<a name="2046843"></a>

<a name="2046894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice so it pastes it into an image? This sounds quite a nice idea! <br><br></td></tr></table><br>
<a name="2047351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've added some more stuff (no release ETA yet tho):<br><br>1) Cached text images are now packed into an atlas (for fast single surface drawing). WIP.<br>2) Added support for BMFonts color channel packed fonts. This is an image where each color channel stores a seperate image, so one image can store your font in a third of the space. Font images created this way take up much less room, meaning faster downloads and smaller app package sizes. Also good if you need a very large typeface, many fonts, or many characters (Asian character sets for example). The font image below is only 17kb:<br><img src="http://beaker.powweb.com/packedverdana_0.png"><br><br><br>Other changes:<br>1) Added fontHeight property.<br>2) DrawHTML() etc now changed to DrawHtml().<br>3) All drawing command x,y parameters switched to Floats. Not sure if this is a good idea or not (thoughts?). <br><br></td></tr></table><br>
<a name="2047218"></a>

<a name="2047238"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds great. <br><br>ad 3) Floats are cool. I draw nothing at integer positions anymore, because of the gazillion device sizes and resolutions. <br><br></td></tr></table><br>
<a name="2047265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Verrrrrrrrrrrrryyyy nice, any chance of putting this on a bitbucket/git account early? would be nice to have a play!<br><br>Here is a MAXRECTS packer for blitzmax if it helps, I am sure it could be quite easily converted to monkey.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">' --- this is a packer class that should be extended with other algorithms---
Type Skn3Packer Abstract
	Field algorithm:String
	Field canRotate:Int = False'can rotate items
	Field canSplit:Int = False'can split onto a new file
	Field border:Int = 3
	Field spacing:Int = 3
	Field errorsTotal:Int = 0
	Field Width:Int = TEXTURE_SIZE_DEFAULT
	Field Height:Int = TEXTURE_SIZE_DEFAULT
	Field rects:TList = CreateList()
	Field sheetTotal:Int = 0
	
	'hooks/callbacks
	Function CompareByArea:Int(o1:Object,o2:Object)
		Local rect1:Skn3PackerRect = Skn3PackerRect(o1)
		Local rect2:Skn3PackerRect = Skn3PackerRect(o2)
		Assert rect1 And rect2
		If rect1.area &lt; rect2.area Return -1
		If rect1.area &gt; rect2.area Return 1
	End Function
	
	'api
	Method Reset() Abstract
	
	Method Repack() Abstract
	
	Method PackRect:Int(Rect:Skn3PackerRect) Abstract
	
	Method AttemptPack:Int(Rect:Skn3PackerRect) Abstract
	
	Method AddRect:Skn3PackerRect(width:Int,Height:Int,extra:Object=Null,pack:Int=True)
		' --- add a rect that should be packed ---
		'create a new rect
		Local Rect:Skn3PackerRect = New Skn3PackerRect
		
		'set it up
		Rect.X = 0
		Rect.Y = 0
		Rect.width = width
		Rect.Height = Height
		Rect.area = Rect.width * Rect.Height
		Rect.extra = extra
		
		'add it to the packer list of rects
		rects.AddLast(Rect)
		
		'sort the rects by largest area first
		rects.Sort(False,Skn3Packer.CompareByArea)
		
		'insert teh pack into the rect
		If pack
			'Local score1:Int
			'Local score2:Int
			AttemptPack(Rect)',score1,score2)
		EndIf
		
		'return the rect
		Return Rect
	End Method
	
	Method CopyRects:TList()
		' --- return a copy of the rects ---
		Local list:TList = CreateList()
		Local link:TLink = rects.FirstLink()
		Local rect:Skn3PackerRect
		
		While link
			rect = Skn3PackerRect(link.value())
			list.AddLast(rect.copy())
			link = link.NextLink()
		Wend
		
		Return list
	End Method
	
	Method RemoveRect(Rect:Skn3PackerRect,pack:Int=True)
		' --- remove a rect fro mthe packer ---
		If rects.Contains(Rect)
			If rect.error errorsTotal:-1
			rects.Remove(Rect)
			If pack Repack()
		EndIf
	End Method
	
	Method hasError:Int(Code:Int=0)
		' --- returns true if there was an error packing one of the rects ---
		If Code = 0
			'general error check
			Return errorsTotal &gt; 0
		Else
			'speciffic error check
			Local link:TLink = rects.FirstLink()
			Local rect:Skn3PackerRect
			While link
				rect = Skn3PackerRect(link.value())
				If rect.error = Code Return True
				link = link.NextLink()
			Wend
		EndIf
	End Method
	
	Method BestFit:Int(split:Int=True,guideSize:Int=TEXTURE_SIZE_DEFAULT,minSize:Int=TEXTURE_SIZE_MIN,maxSize:Int=TEXTURE_SIZE_MAX)
		' --- this will best fit the packer ---
		Local oldWidth:Int = Width
		Local oldHeight:Int = Height
		Local oldCanSplit:Int = cansplit
		Local oldSheetsTotal:Int = sheetTotal
		Local oldRects:TList = CopyRects()
		
		Local smallestSize:Int
		
		'fix size params to correct texture sizes
		If guideSize &lt;&gt; TEXTURE_SIZE_DEFAULT guideSize = SizeToPowerOf2(guideSize)
		If minSize &lt;&gt; TEXTURE_SIZE_MIN minSize = SizeToPowerOf2(minSize)
		If maxSize &lt;&gt; TEXTURE_SIZE_MAX maxSize = SizeToPowerOf2(maxSize)
		
		'figure out the largest item size so we know the minimum the texture can be
		Local link:TLink = rects.FirstLink()
		Local rect:Skn3PackerRect
		While link
			'get rect
			rect = Skn3PackerRect(link.value())
			
			If rect.Width &gt; smallestSize smallestSize = rect.Width
			If rect.Height &gt; smallestSize smallestSize = rect.Height
			
			'next rect
			link = link.NextLink()
		Wend
		
		'convert smallestSize size into power of 2
		smallestSize = SizeToPowerOf2(smallestSize+border+border+spacing+spacing)
		
		'find size that fits without splitting
		Local scanSize:Int = max(smallestSize,minSize)
		Local scanFound:Int = False
		canSplit = False
		While scanSize &lt;= maxSize
			'test this size
			Width = scanSize
			Height = scanSize
			Repack()
			If errorsTotal = 0
				'found a size that works
				scanFound = True
				Exit
			EndIf
			
			scanSize = scanSize * 2
		Wend
		
		'split if not found
		If scanFound = False
			Width = maxSize
			Height = maxSize
			canSplit = True
			Repack()
			If errorsTotal = 0 scanFound = True
		EndIf
		
		'what action to return
		If scanFound = False
			'no success return fail
			Width = oldWidth
			Height = oldHeight
			canSplit = oldCanSplit
			sheetTotal = oldSheetsTotal
			rects = oldRects
			Return False
		Else
			'return success and keep changes
			oldRects = Null
			Return True
		EndIf
	End Method
End Type

Type Skn3PackerRect
	Field error:Int = 0
	Field sheet:Int=-1
	Field X:Int = 0
	Field Y:Int = 0
	Field width:Int = 0
	Field Height:Int = 0
	Field area:Int = 0
	Field flipped:Int = False
	Field extra:Object = Null
	
	'api
	Method copy:Skn3PackerRect()
		' --- return copy of this rect ---
		Local rect:Skn3PackerRect = New Skn3PackerRect
		rect.error = error
		rect.sheet = sheet
		rect.X = x
		rect.Y = y
		rect.Width = Width
		rect.Height = Height
		rect.Area = Area
		rect.flipped = flipped
		rect.extra = extra
		Return rect
	End Method
End Type

Function CreatePacker:Skn3Packer(algorithm:String,Width:Int,Height:Int,border:Int=3,spacing:Int=3,canSplit:Int=False,canRotate:Int=False)
	' --- create a packer of a given algorithm ---
	'create packer
	Local packer:Skn3Packer
	Select algorithm.ToLower()
		Case "maxrects"
			packer = New Skn3PackerMaxRects
	End Select
	
	'setup packer
	If packer
		packer.canRotate = canRotate
		packer.canSplit = canSplit
		packer.border = border
		packer.spacing = spacing
		packer.Width = Width
		packer.Height = Height
		
		'return packer
		Return packer
	EndIf
End Function

' --- max rects ---
Type Skn3PackerMaxRectsSheet
	'helper type for max rects sheet
	Field index:Int
	Field usedList:TList = CreateList()
	Field freeList:TList = CreateList()
End Type

Type Skn3PackerMaxRects Extends Skn3Packer
	Field hasFirstInit:Int = False
	Field sheet:Skn3PackerMaxRectsSheet
	Field sheets:Skn3PackerMaxRectsSheet[]
	
	'constructor/destructor
	Method New()
		algorithm = "maxrects"
	End Method
	
	'api
	Method Init()
		' --- init the packer ---
		hasFirstInit = True
		
		'resize/create array
		sheets = New Skn3PackerMaxRectsSheet[1]
		
		'create first sheet
		sheets[0] = New Skn3PackerMaxRectsSheet
		sheets[0].index = 0
		
		'setup the packer with this sheet
		sheetTotal = 1
		sheet = sheets[0]
		
		'create an intital rect for the texture (use border here sneaky sneaky)
		Local rect:Skn3PackerRect = New Skn3PackerRect
		rect.X = border + spacing
		rect.Y = border + spacing
		rect.width = Self.width - border - border - spacing - spacing
		rect.Height = Self.Height - border - border - spacing - spacing
		sheet.freeList.AddLast(rect)
		
		'reset all rects
		errorsTotal = 0
		Local link:TLink = rects.FirstLink()
		While link
			rect = Skn3PackerRect(link.value())
			rect.error = False
			rect.sheet = -1
			link = link.NextLink()
		Wend
	End Method
	
	Method Reset()
		' -- this resets all rects to not packed ---
		Init()
	End Method
	
	Method Repack()
		' --- do the maxrects pack ---
		Local scanRect:Skn3PackerRect
		Local rect:Skn3PackerRect
		
		'Init packer
		Init()
				
		'need to repack all of the rects again
		Local sheetIndex:Int
		Local scanLink:TLink = rects.FirstLink()
		While scanLink
			scanRect = Skn3PackerRect(scanLink.value())
			'check to see if this rect is too large to fit
			
			'set the current sheet to first one (there still might be space)
			sheetIndex = 0
			sheet = sheets[0]
			
			'loop through until the item is packed
			While AttemptPack(scanRect) = False And scanRect.error = False
				'keep the system alive
				KeepSystemAlive()
				
				'increase sheet index
				sheetIndex :+ 1
				
				'check if the sheet data index slot exists
				If sheetIndex &gt; sheetTotal-1
					'resize sheets array
					sheets = sheets[..sheetIndex+1]
					sheetTotal = sheetIndex+1
					
					'create new sheet
					sheets[sheetIndex] = New Skn3PackerMaxRectsSheet
					sheets[sheetIndex].index = sheetIndex
					
					'create empty rect
					rect = New Skn3PackerRect
					rect.X = border + spacing
					rect.Y = border + spacing
					rect.width = width - border - border - spacing - spacing
					rect.Height = Height - border - border - spacing - spacing
					
					'add empty rect to sheet
					sheets[sheetIndex].freeList.AddLast(rect)
				EndIf
				
				'change the active sheet
				sheet = sheets[sheetTotal-1]
			Wend
			
			'next scan rect
			scanLink = scanLink.NextLink()
		Wend
	End Method
	
	Method PackRect:Int(rect:Skn3PackerRect)
		' --- pack this rect ---
		If hasFirstInit = False Init()
		
		'set the current sheet to first one (there still might be space)
		Local tempRect:Skn3PackerRect
		Local sheetIndex:Int = 0
		sheet = sheets[0]
				
		'loop through until the item is packed
		While AttemptPack(rect) = False And rect.error
			'keep the system alive
			KeepSystemAlive()
			
			'increase sheet index
			sheetIndex :+ 1
			
			'check if the sheet data index slot exists
			If sheetIndex &gt; sheetTotal-1
				'resize sheets array
				sheets = sheets[..sheetIndex+1]
				sheetTotal = sheetIndex+1
				
				'create new sheet
				sheets[sheetIndex] = New Skn3PackerMaxRectsSheet
				sheets[sheetIndex].index = sheetIndex
				
				'create empty rect
				tempRect = New Skn3PackerRect
				tempRect.X = border + spacing
				tempRect.Y = border + spacing
				tempRect.width = width - border - border - spacing - spacing
				tempRect.Height = Height - border - border - spacing - spacing
				
				'add empty rect to sheet
				sheets[sheetIndex].freeList.AddLast(tempRect)
			EndIf
			
			'change the active sheet
			sheet = sheets[sheetTotal-1]
		Wend
		
		'return the success of the operation
		Return Rect.error
	End Method
	
	Method AttemptPack:Int(Rect:Skn3PackerRect)
		' --- attmept a pack ---
		'remove error count as we are essentially repacking
		If Rect.error errorsTotal:-1
		
		'check for skipping
		If rect.Width = 0 Or rect.Height = 0
			Rect.error = True
			Rect.sheet = -1
			Rect.X = 0
			Rect.Y = 0
			Rect.flipped = False
			
			'increase error count
			errorsTotal :+ 1
			
			Return False
		EndIf
		
		'check to see if the rect is out of bounds to start with
		'checking for too large
		Local maxWidth:Int = Width - border - border - spacing - spacing
		Local maxHeight:Int = Height - border - border - spacing - spacing
		If (canRotate = False And (Rect.width &gt; maxWidth Or Rect.Height &gt; maxHeight)) Or (canRotate = True And Not((Rect.width &lt;= maxWidth And Rect.Height &lt;= maxHeight) Or (Rect.Height &lt;= maxWidth And Rect.width &lt;= maxHeight)))
			'setup rect with error
			Rect.error = True
			Rect.sheet = -1
			Rect.X = 0
			Rect.Y = 0
			Rect.flipped = False
			
			'increase error count
			errorsTotal :+ 1
			
			Return False
		EndIf
		
		'process this item as it can fit
		Local findRect:Skn3PackerRect
		Local scanRect:Skn3PackerRect
		Local scanLink1:TLink
		Local scanLastLink:TLink
		
		Local score1:Int
		Local score2:Int
		findRect = FindPositionForNewNodeBestShortSideFit(Rect.width,Rect.Height,score1,score2)
		'findRect = FindPositionForNewNodeBottomLeft(Rect.width,Rect.Height,score1,score2)
		'findRect = FindPositionForNewNodeContactPoint(Rect.width,Rect.Height,score1)
		'findRect = FindPositionForNewNodeBestLongSideFit(Rect.width,Rect.Height,score2,score1)
		'findRect = FindPositionForNewNodeBestAreaFit(Rect.width,Rect.Height,score1,score2)
		
		'a space could not be found so how do we proceed
		If findRect.Height = 0
			If canSplit
				'ONLY return false so the texture is split in teh next attempt
				Return False
			Else
				'can't split onto multiple sheets
				'setup rect with error
				Rect.error = True
				Rect.sheet = -1
				Rect.X = 0
				Rect.Y = 0
				Rect.flipped = False
				
				'increase error count
				errorsTotal :+ 1
				
				Return False
			EndIf
		EndIf
		
		'slice and prune existing free nodes
		scanLink1 = sheet.freeList.FirstLink()
		scanLastLink = sheet.freeList.LastLink()
		While scanLink1
			'get teh rect from teh link
			scanRect = Skn3PackerRect(scanLink1.value())
			
			'do some slicing on the rect if it returns true it means that the rect was infact sliced (so remove it)
			If SplitFreeNode(scanRect,findRect) scanLink1.Remove()
			
			'exit loop if got to end (determined before starting the loop)
			If scanLink1 = scanLastLink Exit
			
			'move to next rect
			scanLink1 = scanLink1.NextLink()
		Wend
		PruneFreeList()
		
		'add self to used rectangles
		sheet.usedList.AddLast(findRect)
		
		'update the passed in rect position
		rect.sheet = sheet.index
		Rect.X = findRect.X
		Rect.Y = findRect.Y
		Rect.flipped = findRect.flipped
		
		'return success
		Return True
	End Method
	
	Method FindPositionForNewNodeBestShortSideFit:Skn3PackerRect(width:Int,Height:Int,bestShortSideFit:Int Var,bestLongSideFit:Int Var)
		Local scanLink:TLink
		Local scanRect:Skn3PackerRect
		Local bestNode:Skn3PackerRect = New Skn3PackerRect
		Local leftoverHoriz:Int
		Local leftoverVert:Int
		Local shortSideFit:Int
		Local longSideFit:Int
		Local flippedLeftoverHoriz:Int
		Local flippedLeftoverVert:Int
		Local flippedShortSideFit:Int
		Local flippedLongSideFit:Int

		bestShortSideFit = 2147483647
	
		scanLink = sheet.freeList.FirstLink()
		While scanLink
			scanRect = Skn3PackerRect(scanLink.value())
			
			'Try To place the Rectangle in upright (non-flipped) orientation.
			If scanRect.width &gt;= width And scanRect.Height &gt;= Height
				leftoverHoriz = Abs(scanRect.width - width)
				leftoverVert = Abs(scanRect.Height - Height)
				shortSideFit = Min(leftoverHoriz, leftoverVert)
				longSideFit = Max(leftoverHoriz, leftoverVert)
	
				If shortSideFit &lt; bestShortSideFit Or (shortSideFit = bestShortSideFit And longSideFit &lt; bestLongSideFit)
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = width
					bestNode.Height = Height
					bestNode.flipped = False
					
					bestShortSideFit = shortSideFit
					bestLongSideFit = longSideFit
				End If
			End If
			
			If canRotate And scanRect.width &gt;= Height And scanRect.Height &gt;= width
				flippedLeftoverHoriz = Abs(scanRect.width - Height)
				flippedLeftoverVert = Abs(scanRect.Height - width)
				flippedShortSideFit = Min(flippedLeftoverHoriz, flippedLeftoverVert)
				flippedLongSideFit = Max(flippedLeftoverHoriz, flippedLeftoverVert)
	
				If flippedShortSideFit &lt; bestShortSideFit Or (flippedShortSideFit = bestShortSideFit And flippedLongSideFit &lt; bestLongSideFit)
					bestNode.X = scanRect.X
					bestNode.Y = scanRect.Y
					bestNode.width = Height
					bestNode.Height = width
					bestNode.flipped = True
					
					bestShortSideFit = flippedShortSideFit
					bestLongSideFit = flippedLongSideFit
				End If
			End If
		
			scanLink = scanLink.NextLink()
		Wend
		
		Return bestNode
	End Method
	
	Method FindPositionForNewNodeBottomLeft:Skn3PackerRect(width:Int,Height:Int,bestY:Int Var,bestX:Int Var)
		Local scanLink:TLink
		Local scanRect:Skn3PackerRect
		Local bestNode:Skn3PackerRect = New Skn3PackerRect
		Local topSideY:Int
		
		bestY = 2147483647
		
		scanLink = sheet.freeList.FirstLink()
		While scanLink
			scanRect = Skn3PackerRect(scanLink.value())	
		
			'Try To place the Rectangle in upright (non-flipped) orientation.
			If scanRect.width &gt;= width And scanRect.Height &gt;= Height
				topSideY = scanRect.Y + Height
				If topSideY &lt; bestY Or (topSideY = bestY And scanRect.X &lt; bestX)
					bestNode.X = scanRect.X
					bestNode.Y = scanRect.Y
					bestNode.width = width
					bestNode.Height = Height
					bestNode.flipped = False
					
					bestY = topSideY
					bestX = scanRect.X
				EndIf
			EndIf
			
			If canRotate And scanRect.width &gt;= Height And scanRect.Height &gt;= width
				topSideY = scanRect.Y + width
				If topSideY &lt; bestY Or (topSideY = bestY And scanRect.X &lt; bestX)
					bestNode.X = scanRect.X
					bestNode.Y = scanRect.Y
					bestNode.width = height
					bestNode.Height = width
					bestNode.flipped = True
					
					bestY = topSideY
					bestX = scanRect.X
				End If
			End If
			
			scanLink = scanLink.NextLink()
		Wend
		
		Return bestNode
	End Method
	
	Method FindPositionForNewNodeBestLongSideFit:Skn3PackerRect(width:Int,Height:Int,bestShortSideFit:Int Var,bestLongSideFit:Int Var)
		Local scanLink:TLink
		Local scanRect:Skn3PackerRect
		Local bestNode:Skn3PackerRect = New Skn3PackerRect
		Local leftoverHoriz:Int
		Local leftoverVert:Int
		Local shortSideFit:Int
		Local longSideFit:Int
		
		bestLongSideFit = 2147483647
	
		scanLink = sheet.freeList.FirstLink()
		While scanLink
			scanRect = Skn3PackerRect(scanLink.Value())
			
			'Try To place the Rectangle in upright (non-flipped) orientation.
			If scanRect.width &gt;= width And scanRect.Height &gt;= Height
				leftoverHoriz = Abs(scanRect.width - width)
				leftoverVert = Abs(scanRect.Height - Height)
				shortSideFit = min(leftoverHoriz, leftoverVert)
				longSideFit = max(leftoverHoriz, leftoverVert)
	
				If longSideFit &lt; bestLongSideFit Or (longSideFit = bestLongSideFit And shortSideFit &lt; bestShortSideFit)
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = width
					bestNode.Height = Height
					bestNode.flipped = False
					
					bestShortSideFit = shortSideFit
					bestLongSideFit = longSideFit
				End If
			End If
	
			If canRotate And scanRect.width &gt;= Height And scanRect.Height &gt;= width
				leftoverHoriz = Abs(scanRect.width - Height)
				leftoverVert = Abs(scanRect.Height - width)
				shortSideFit = min(leftoverHoriz, leftoverVert)
				longSideFit = max(leftoverHoriz, leftoverVert)
	
				If longSideFit &lt; bestLongSideFit Or (longSideFit = bestLongSideFit And shortSideFit &lt; bestShortSideFit)
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = height
					bestNode.Height = width
					bestNode.flipped = True
					
					bestShortSideFit = shortSideFit
					bestLongSideFit = longSideFit
				End If
			End If
		
			scanLink = scanLink.NextLink()
		Wend
		return bestNode
	End Method
	
	Method FindPositionForNewNodeBestAreaFit:Skn3PackerRect(width:Int,Height:Int,bestAreaFit:Int Var,bestShortSideFit:Int Var)
		Local scanLink:TLink
		Local scanRect:Skn3PackerRect
		Local bestNode:Skn3PackerRect = New Skn3PackerRect
		Local areaFit:Int
		Local leftoverHoriz:Int
		Local leftoverVert:Int
		Local shortSideFit:Int
		
		bestAreaFit = 2147483647
	
		scanLink = sheet.freeList.FirstLink()
		While scanLink
			scanRect = Skn3PackerRect(scanLink.Value())
			
			areaFit = scanRect.width * scanRect.Height - width * Height
	
			'Try to place the rectangle in upright (non-flipped) orientation.
			If scanRect.width &gt;= width And scanRect.Height &gt;= Height
				leftoverHoriz = Abs(scanRect.width - width)
				leftoverVert = Abs(scanRect.Height - Height)
				shortSideFit = min(leftoverHoriz, leftoverVert)
	
				If areaFit &lt; bestAreaFit Or (areaFit = bestAreaFit And shortSideFit &lt; bestShortSideFit)
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = width
					bestNode.Height = Height
					bestNode.flipped = False
					
					bestShortSideFit = shortSideFit
					bestAreaFit = areaFit
				End If
			End If
	
			If canRotate And scanRect.width &gt;= Height And scanRect.Height &gt;= width
				leftoverHoriz = Abs(scanRect.width - Height)
				leftoverVert = Abs(scanRect.Height - width)
				shortSideFit = min(leftoverHoriz, leftoverVert)
	
				If areaFit &lt; bestAreaFit Or (areaFit = bestAreaFit And shortSideFit &lt; bestShortSideFit)
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = height
					bestNode.Height = width
					bestNode.flipped = True
					
					bestShortSideFit = shortSideFit
					bestAreaFit = areaFit
				End If
			End If
		
			scanLink = scanLink.NextLink()
		Wend
		return bestNode
	End Method
	
	Method FindPositionForNewNodeContactPoint:Skn3PackerRect(width:Int,Height:Int,bestContactScore:Int Var)
		Local scanLink:TLink
		Local scanRect:Skn3PackerRect
		Local bestNode:Skn3PackerRect = New Skn3PackerRect
		Local score:Int
		
		bestContactScore = -1
	
		scanLink = sheet.freeList.FirstLink()
		While scanLink
			scanRect = Skn3PackerRect(scanLink.Value())
			
			'Try To place the Rectangle in upright (non-flipped) orientation.
			If scanRect.width &gt;= width And scanRect.Height &gt;= Height
				score = ContactPointScoreNode(scanRect.X, scanRect.Y, width, Height)
				If score &gt; bestContactScore
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = width
					bestNode.Height = Height
					bestNode.flipped = False
					
					bestContactScore = score
				End If
			End If
			
			If canRotate And scanRect.width &gt;= Height And scanRect.Height &gt;= width
				score = ContactPointScoreNode(scanRect.X, scanRect.Y, width, Height)
				If score &gt; bestContactScore
					bestNode.X = scanRect.X
					bestNode.y = scanRect.y
					bestNode.width = height
					bestNode.Height = width
					bestNode.flipped = True
					
					bestContactScore = score
				End If
			End If
		
			scanLink = scanLink.NextLink()
		Wend
		return bestNode
	End Method
	
	Method CommonIntervalLength:Int(i1start:Int,i1end:Int,i2start:Int,i2end:Int)
		If i1end &lt; i2start Or i2end &lt; i1start Return 0
		Return min(i1end, i2end) - max(i1start, i2start)
	End Method
	
	Method ContactPointScoreNode:Int(X:Int,Y:Int,width:Int,Height:Int)
		Local score:Int = 0
	
		If X = 0 Or X + width = Self.width score :+ Height
		If Y = 0 Or Y + Height = Self.Height score :+ width
		
		Local link:TLink = sheet.usedList.FirstLink()
		Local scanRect:Skn3PackerRect
		While link
			scanRect = Skn3PackerRect(link.value())
			If scanRect.X = X + Width Or scanRect.X + scanRect.Width = X score :+ CommonIntervalLength(scanRect.Y, scanRect.Y + scanRect.Height, Y, Y + Height)
			
			If scanRect.Y = Y + Height Or scanRect.Y + scanRect.Height = Y score :+ CommonIntervalLength(scanRect.X, scanRect.X + scanRect.Width, X, X + Width)
			link = link.NextLink()
		Wend
		return score
	End Method
	
	Method SplitFreeNode:Int(freeNode:Skn3PackerRect,usedNode:Skn3PackerRect)
		Local newRect:Skn3PackerRect
		Local newSize:Int
		
		'Test with SAT If the rectangles Even Intersect.
		If usedNode.X - spacing &gt;= freeNode.X + freeNode.width Or usedNode.X + usedNode.width + spacing &lt;= freeNode.X Or usedNode.Y - spacing &gt;= freeNode.Y + freeNode.Height Or usedNode.Y + usedNode.Height + spacing &lt;= freeNode.Y Return False
		
		If usedNode.X &lt; freeNode.X + freeNode.width And usedNode.X + usedNode.width &gt; freeNode.X
			' New node at the top side of the used node.
			If usedNode.Y &gt; freeNode.Y And usedNode.Y &lt; freeNode.Y + freeNode.Height
				newSize = usedNode.Y - freeNode.Y - spacing
				If newSize &gt; 0
					newRect = New Skn3PackerRect
					
					newRect.X = freeNode.X
					newRect.Y = freeNode.Y
					newRect.width = freeNode.width
					newRect.Height = newSize
					
					sheet.freeList.AddLast(newRect)
				End If
			End If
	
			' New node at the bottom side of the used node.
			If usedNode.Y + usedNode.Height &lt; freeNode.Y + freeNode.Height
				newSize = freeNode.Y + freeNode.Height - (usedNode.Y + usedNode.Height) - spacing
				If newSize &gt; 0
					newRect = New Skn3PackerRect
					
					newRect.X = freeNode.X
					newRect.Y = usedNode.Y + usedNode.Height + spacing
					newRect.width = freeNode.width
					newRect.Height = newSize
					
					sheet.freeList.AddLast(newRect)
				End If
			End If
		End If
	
		If usedNode.Y &lt; freeNode.Y + freeNode.Height And usedNode.Y + usedNode.Height &gt; freeNode.Y
			' New node at the left side of the used node.
			If usedNode.X &gt; freeNode.X And usedNode.X &lt; freeNode.X + freeNode.width
				newSize = usedNode.X - freeNode.X - spacing
				If newSize
					newRect = New Skn3PackerRect
					
					newRect.X = freeNode.X
					newRect.Y = freeNode.Y
					newRect.width = newSize
					newRect.Height = freeNode.Height
					
					sheet.freeList.AddLast(newRect)
				End If
			End If
	
			' New node at the right side of the used node.
			If usedNode.X + usedNode.width &lt; freeNode.X + freeNode.width
				newSize = freeNode.X + freeNode.width - (usedNode.X + usedNode.width) - spacing
				If newSize
					newRect = New Skn3PackerRect
					
					newRect.X = usedNode.X + usedNode.width + spacing
					newRect.Y = freeNode.Y
					newRect.width = newSize
					newRect.Height = freeNode.Height
					
					sheet.freeList.AddLast(newRect)
				End If
			End If
		End If
	
		return true
	End Method

	Method SplitFreeNodeWithoutSpacing:Int(freeNode:Skn3PackerRect,usedNode:Skn3PackerRect)
		Local newRect:Skn3PackerRect
		
		'Test with SAT If the rectangles Even Intersect.
		If usedNode.X &gt;= freeNode.X + freeNode.width Or usedNode.X + usedNode.width &lt;= freeNode.X Or usedNode.Y &gt;= freeNode.Y + freeNode.Height Or usedNode.Y + usedNode.Height &lt;= freeNode.Y Return False
		
		If usedNode.X &lt; freeNode.X + freeNode.width And usedNode.X + usedNode.width &gt; freeNode.X
			' New node at the top side of the used node.
			If usedNode.Y &gt; freeNode.Y And usedNode.Y &lt; freeNode.Y + freeNode.Height
				newRect = New Skn3PackerRect
				
				newRect.X = freeNode.X
				newRect.Y = freeNode.Y
				newRect.width = freeNode.width
				newRect.Height = usedNode.Y - newRect.Y
				
				sheet.freeList.AddLast(newRect)
			End If
	
			' New node at the bottom side of the used node.
			If usedNode.Y + usedNode.Height &lt; freeNode.Y + freeNode.Height
				newRect = New Skn3PackerRect
				
				newRect.X = freeNode.X
				newRect.Y = usedNode.Y + usedNode.Height
				newRect.width = freeNode.width
				newRect.Height = freeNode.Y + freeNode.Height - (usedNode.Y + usedNode.Height)
				
				sheet.freeList.AddLast(newRect)
			End If
		End If
	
		If usedNode.Y &lt; freeNode.Y + freeNode.Height And usedNode.Y + usedNode.Height &gt; freeNode.Y
			' New node at the left side of the used node.
			If usedNode.X &gt; freeNode.X And usedNode.X &lt; freeNode.X + freeNode.width
				newRect = New Skn3PackerRect
				
				newRect.X = freeNode.X
				newRect.Y = freeNode.Y
				newRect.width = usedNode.X - newRect.X
				newRect.Height = freeNode.Height
				
				sheet.freeList.AddLast(newRect)
			End If
	
			' New node at the right side of the used node.
			If usedNode.X + usedNode.width &lt; freeNode.X + freeNode.width
				newRect = New Skn3PackerRect
				
				newRect.X = usedNode.X + usedNode.width
				newRect.Y = freeNode.Y
				newRect.width = freeNode.X + freeNode.width - (usedNode.X + usedNode.width)
				newRect.Height = freeNode.Height
				
				sheet.freeList.AddLast(newRect)
			End If
		End If
	
		return true
	End Method
		
	Method PruneFreeList:Int()
		Local scanLink1:TLink
		Local scanLink2:TLink
		Local scanRect1:Skn3PackerRect
		Local scanRect2:Skn3PackerRect
		
		'go through each free rectangle
		scanLink1 = sheet.freeList.FirstLink()
		While scanLink1
			'get the rect from teh tlink
			scanRect1 = Skn3PackerRect(scanLink1.value())
			
			'test self against all over free rectangles
			scanLink2 = sheet.freeList.FirstLink()
			While scanLink2
				'dont bother testing against self.. duh!
				If scanLink1 &lt;&gt; scanLink2
					'get rect from link
					scanRect2 = Skn3PackerRect(scanLink2.value())
					
					'check to see if the rect1 is inside rect2
					If (IsContainedIn(scanRect1, scanRect2))
						scanLink1.Remove()
						Exit
					End If
					
					'check to see if the rect2 is inside rect1
					If (IsContainedIn(scanRect2, scanRect1)) scanLink2.Remove()
				EndIf
				
				'get next link
				scanLink2 = scanLink2.NextLink()
			Wend
			
			'get the next link
			scanLink1 = scanLink1.NextLink()
		Wend
	End Method
	
	Method IsContainedIn:Int(a:Skn3PackerRect,b:Skn3PackerRect)
		Return a.X &gt;= b.X And a.Y &gt;= b.Y And a.X+a.width &lt;= b.X+b.width And a.Y+a.Height &lt;= b.Y+b.Height
	End Method
End Type</textarea> <br><br></td></tr></table><br>
<a name="2047263"></a>

<a name="2047258"></a>

<a name="2047260"></a>

<a name="2047262"></a>

<a name="2047541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Skn3 - you can take a look here:<br><a href="http://beaker.powweb.com/angelfont_with_packing_and_cacheing_wip.zip" target="_blank">http://beaker.powweb.com/angelfont_with_packing_and_cacheing_wip.zip</a><br>[edit: just noticed, you will need to comment out the line: "Import angelfontanim"]<br><br>Let me know how you get on.<br><br>Also, would you consider making the necessary changes to make it use your new xml module? I took a look but wasn't able to work out how to set it up.<br><br>Thanks for the packer code but I use my own packing routine which I translated from a C example I found online. It works well, is simple and very compact.<br><br>Note: there is some BlitzMax source in the data folder (alphawriter.bmx) that is needed to tweak color channel packed images from BMFont because you can't adjust the alpha of images in Monkey itself.<br><br>Cheers. <br><br></td></tr></table><br>
<a name="2047540"></a>

<a name="2047542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wiebow</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really interesting, Robin. I look forward to the release. <br><br></td></tr></table><br>
<a name="2047549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome thanks, I will have a look tomorrow :D <br><br></td></tr></table><br>
<a name="2047802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey beaker thanks for posting this. I only had a chance to look at it tonight. Definitely some nice improvements in there :D<br><br>I take it when you use color chan packing you don't have teh ability for the font chars to be anti-aliased? <br><br></td></tr></table><br>
<a name="2047848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Currently color chan packing assumes that the alpha is represented by the brightness of the pixel (I think). It also means that you can only have white (or black) as the base color of the font (ie. no multicolour fonts).<br><br>Also there are issues with caching and color. I'm not sure it properly supports switching the color using SetColor. <strike>Also, some transforms like rotation and caching won't work at all.</strike> &lt;- I was wrong, it supports rotations fine. I'm cleverer than I thought.<br><br>With caching you can choose wether to copy the text and background, or just the text, to the cache. If you use the latter it makes some assumptions based on the passed in color about how to create the alpha (sorta more like a mask).<br><br>Overall you have to be pretty selective about how and when to use these new features. <br><br></td></tr></table><br>
<a name="2047804"></a>

<a name="2047849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was wrong, it supports rotations fine. I'm cleverer than I thought. :) <br><br></td></tr></table><br>
<a name="2049172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >frank</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> What version of the lib contains correct wrap ? The one which comes with Monkey seems to not have that; well it does, but I cannot for the life of me get it to run except when I use text from textfiles, but not if I use programmatically defined strings. <br><br>Aka:<br><br>ab := "Something ~n something" <br><br>doesn't work and I cannot find, in my version of the library, any reference to 0x10 (~n)?<br><br>Edit: couldn't get the example to work properly (even the soap one had really weird behavior, maybe that's because I use Diddy virtual resolution for everything?) in my app so made my own <a href="https://gist.github.com/tluyben/4977254" target="_blank">https://gist.github.com/tluyben/4977254</a> <br><br></td></tr></table><br>
<a name="2049162"></a>

<a name="2049219"></a>

<a name="2049222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> The link at the top of this thread should do what you want. Works fine here.<br><br>0x10 is 16 in decimal which is DLE (Data Link Escape)in ascii. Did you mean 10? You can find that in simpletextbox.monkey (around line 47).<br><a href="http://www.asciitable.com/" target="_blank">http://www.asciitable.com/</a><br><br>In your code that you linked to you might want to use font.DrawText() instead of font.DrawHtml() because it is faster.<br><br>What is the soap one? <br><br></td></tr></table><br>
<a name="2049266"></a>

<a name="2049268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >frank</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> User Soap in the thread here had a fixed version of the wrapping code (read above :) ; couldn't get that to work :) <br><br>Speed is not really an object yet; when there is text to be drawn in my game, there is no other drawing / animation going on. But it will be so thanks for that; i'll just make it a flag; I do use HTML as well (i and b) sometimes so I need both. <br><br>The code works fine in your example (simpletextbox) but it doesn't when I use it separately; wouldn't it be better to make a lib for wrap code with angelfont; I think most people would need it? Anyway; I spent more time trying to get it to work than rolling myself; thanks for your help anyway. <br><br>And  yeah I didn't mean the hex ; didn't think too much about it. Sorry for that. <br><br>I have one other problem; with some sentences (sentences without *visible* hidden chars) angelfont conks out with a Null reference when trying to resolve the char index; it is always 160 which it cannot find. Even after retyping the text it gave me the same error, with, again visibly, completely sane text. If I let it ignore the error, it works fine and the text looks fine; nothing missing. I was thinking some unicode char in my text, but it seems really impossible as I checked and retyped in vi (where you can clearly see everything) for instance which gives me only chars I expect. Sounds anywhere familiar? I think, for production purposes, it's better to ignore illegal chars than present the user with some intelligible error message anyway.<br><br>Edit: Hiero seems to save .fnt as txt instead of XML; any way to change that? <br><br></td></tr></table><br>
<a name="2049273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if the latest version ignores invalid characters, but for speed sake I originally assumed you would have the correct characters in your font.<br><br>For Hiero files you should be able to convert them using the dragangelfont.zip tools linked in the top post. <br><br></td></tr></table><br>
<a name="2049275"></a>

<a name="2049276"></a>

<a name="2049277"></a>

<a name="2049278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >frank</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> There seem to be only .exe files in there :) I have a mac. Guess I'll buy the bmGlyph tool or something. <br><br>I made a convertor myself (small perl file; <a href="https://gist.github.com/tluyben/4984856" target="_blank">https://gist.github.com/tluyben/4984856</a> ) which works fine unless the font has multiple pages; Hiero only seems to write 1 png of the many required :) If the font is the original size and it exports one page it works fine.<br><br>And yeah, again, I have all characters; I cannot find where this character '160' comes from; it's not there. It also ONLY dies when calling the  TextHeight, never the TextWidth. So no idea what's going on. <br><br></td></tr></table><br>
<a name="2051712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> again the problem with german umlauts.....<br><br>if I write a "ü" inside a string "Gemüse" in monkey code, and I print it with AngelFont it is recognized as ASCII=252 and printed well. The same if I load it from a txt file.<br><br>But if this "Gemüse" comes from a server, the "ü" has a ASCII value of 65533 and AngelFont crashes with "Array index out of range" at line 235.<br><br>1.<br>In the next update of angelfont.monkey there should be added a check "ASCII&gt;256" and in case of this a replacement with any placeholder sign...<br><br><br>2.<br>The version of Angelfont packed into current Monkey Banana is not up-to-date. You should talk to Mark!<br><br><br>3.<br>Or is there perhaps a posibility of using something like a "translation schema" to redefine certain UTF-character? <br><br></td></tr></table><br>
<a name="2051760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting.<br><br>1) Can you not convert the unicode 65533 to ascii on the server, or even change your server monkey code to catch these? I may look at this more when I get some free time.<br><br>2) I will when I get time to fully update the latest version. The one Mark supplies should be quite useable tho. <br><br></td></tr></table><br>
<a name="2051817"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> meanwhile I found out, that my server php script SCORE.PHP sends a correct "ü", when I call it from a browser window<br><br>here ist the adress:<br><br><a href="http://www.midimaster.de/temp/score.php?L=1001" target="_blank">http://www.midimaster.de/temp/score.php?L=1001</a><br><br>the Answer should be <br><br><div class="quote"> Gemüse <br></div><br><br>but if I call it from monkey MNET module the answer contains the Unicode 65533, which is the sign for "unknown character" know as &amp;#xfffd; this sign:<br><pre class=code>  <u>  </u>
 |FF|
 |<u>FD</u>|
</pre><br><br>so now I think the problem is more a MNET problem<br><br>Can sombody, who is experienced with a the new V67 or V68 feature "monkey http request", check for me, what the php script returns at his computer? <br><br></td></tr></table><br>
<a name="2053709"></a>

<a name="2053711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yo!   <br><br>I just upgraded to Monkey v69, and now my project won't compile on Android.  The trace points the blame (a NullPointerException) to AngelFont, for this block:<br><br><pre class=code>
		If pageCount = 0
			image[0] = LoadImage(url+".png")
			If image[0] = Null image[0] = LoadImage(url+"_0.png")
		Else
			For Local page:= 0 To pageCount
				If image.Length &lt; page+1 image = image.Resize(page+1)
				image[page] = LoadImage(url+"_"+page+".png")
			End
		End	
</pre><br><br>Line 180, specifically where it tries to load first an image that doesn't exist (for example,  font.fnt generating an imagemap called font_0.png), will <b>crash</b> on this target when attempting to perform LoadImage, because mojo graphics attempts (and fails) to load a GraphicsContext.<br><br>I can manually hack this line out as a workaround; however, it gets rid of some of the versatility of this function (and in some ways, makes it more fragile on the targets which don't freak out from this trick, since whether or not a single-page font has a _0 suffix probably depends on BMFont).  Any suggestions?<br><br>Edit:  Actually, the correct behavior is probably to not make special exceptions for single-page XML outputs at all.  I'm guessing this is a backwards-compatibility thing (once again?) for older versions of bmFont, or possibly a leftover from switching to XML --  Anyway, this block of code causes Android to choke. <br><br></td></tr></table><br>
<a name="2054436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've written a routine for the current stable version of AngelFont which is meant to increase the speed of loading times for .fnt files which are encoded plaintext (ie:  not xml-encoded).  If you are suffering slow loading times with AngelFonts on Android, please see this thread:<br><br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=4964" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=4964</a> <br><br></td></tr></table><br>
<a name="2054610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> I work a lot with your module, but I always have to do a hack to not get a crash with unicode fonts.<br><br>Now I want to know, if I do something wrong, or if it is really a bug in "angelcode.monkey"<br><br>this is the "bug":<br><pre class=code>Class AngelFont
	Private	
	Global _list:StringMap&lt;AngelFont&gt; = New StringMap&lt;AngelFont&gt;
	
	Field image:Image[] = New Image[1]	
	Field chars:Char[256]
....
</pre> <br><br>Isn't this hardcoded 256 a bug? If I use an imagefont with more than 256 characters I will get a crash "array out of bounds".<br><br>As a workaround I always change it this way, but normally the number of character should be counted and defined in the LoadFont() function, or?<br><br><pre class=code>Class AngelFont
	Private
	Const MAX_CHAR%=8500
	Global _list:StringMap&lt;AngelFont&gt; = New StringMap&lt;AngelFont&gt;
	
	Field image:Image[] = New Image[1]	
	Field chars:Char[MAX_CHAR+1]
....

	Method DrawText:Void(txt:String, x:Int, y:Int)
	...		
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			If asc&gt;MAX_CHARS Then asc= "*"[0]

</pre> <br><br></td></tr></table><br>
<a name="2054615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not really a bug, but a feature. :)<br><br>I realise it is biased towards english speakers, but it's only really meant as a starting point to get you going.<br><br>You might want to consider using an IntMap to store your chars. It will be slower but you will save lots of memory. This is your decision of course. <br><br></td></tr></table><br>
<a name="2054629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>Midimaster:</b>  I used an IntMap&lt;Char&gt; for the utf8 hack of Angelfont, but kept the chars[256] array, because I assumed Beaker made it that way for speed purposes.  doing a Get() on a Map can incur some extra overhead that can slow AngelFont down, especially if you're calling it text.Length times each frame.  That being said, resizing chars with a unicode length has a <i>serious</i> RAM overhead! The hacky solution in monkey-utf8's angelFont was to have both, and only call from the Map if Unicode chars are in use.<br><br>I would recommend that if you designed your version of AngelFont to cache the text and only draw a surface when text is changed, then using a Map would be just fine. You'd only be calling Get() when you need to redraw the surface, so the speed penalty won't affect you as much.<br><br><br>On a somewhat-related note, I've started a document outlining my plans to rewrite AngelFont.  Since Beaker claims that AngelFont's always been intended to be only a starting point, I'm sure he won't mind ;)<br><br>Here are my proposals... don't expect this to be done within a specific timeframe!  <br><a href="https://www.evernote.com/shard/s257/sh/e3bb83bd-9c91-487d-85d1-d7871e91d8b8/9c6b477aafa5f65917477438fe9de836" target="_blank">https://www.evernote.com/shard/s257/sh/e3bb83bd-9c91-487d-85d1-d7871e91d8b8/9c6b477aafa5f65917477438fe9de836</a> <br><br></td></tr></table><br>
<a name="2054627"></a>

<a name="2054626"></a>

<a name="2054625"></a>

<a name="2054624"></a>

<a name="2054623"></a>

<a name="2054641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds good. Something I wanted to do but never got round to was using Skn3s newer XML parser which might be faster on android. Would you consider adding it to your list? <br><br></td></tr></table><br>
<a name="2054661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought that's what you were using!  But, as someone who typically tends to avoid XML like the plague, I had no idea that there was a new version.  If it has a similar interface, I don't think it would be much of a problem.  But if it were that simple, I'd have figured you'd have done it by now :B<br><br>Anyway, whatever the case may be, I'll keep my eye open for any updates to the "stable" version of AngelFont before kicking this off, so that I don't re-use anything that you wouldn't use anymore yourself. <br><br></td></tr></table><br>
<a name="2054660"></a>

<a name="2054892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker:<br><br>Here is an updated version of angelfont.monkey which uses skn3's xml.monkey instead of config.monkey.  As little code was changed as possible to make it a drop-in replacement, and therefore it still has the same hacks (ie: it checks for paged bitmaps the "wrong" way instead of asking the xml metadata).  It does, however, work.  <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
#TEXT_FILES="*.txt|*.xml|*.json|*.fnt"

Strict

Import mojo

Import char
Import kernpair

'Import config	'thanks to skn3 - you can find the latest version of this file in bananas/skn3/config folder.
Import xml      'Let's use skn3's xml lib instead of the config lib and see how much faster it is.

'Bitmap font tools:
'PC: <a href="http://www.angelcode.com/products/bmfont/" target="_blank">http://www.angelcode.com/products/bmfont/</a>
'Mac/PC: <a href="http://slick.cokeandcode.com/demos/hiero.jnlp" target="_blank">http://slick.cokeandcode.com/demos/hiero.jnlp</a>
'Mac (paid): <a href="http://www.bmglyph.com/" target="_blank">http://www.bmglyph.com/</a> - cheapest
'Mac (paid): <a href="http://glyphdesigner.71squared.com/" target="_blank">http://glyphdesigner.71squared.com/</a> - best

'For more information about AngelFont look here: <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=141" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=141</a>


Class AngelFont
	Private
	
	Global _list:StringMap&lt;AngelFont&gt; = New StringMap&lt;AngelFont&gt;
	
	Field image:Image[] = New Image[1]	
'	Field blockSize:Int
	Field chars:Char[256]
	
'	Field kernPairs:StringMap&lt;KernPair&gt; = New StringMap&lt;KernPair&gt;
	Field kernPairs:IntMap&lt;IntMap&lt;KernPair&gt;&gt; = New IntMap&lt;IntMap&lt;KernPair&gt;&gt;
	Global firstKp:IntMap&lt;KernPair&gt;
	Global secondKp:KernPair
	
'	Field section:String
	Field iniText:String

	Field xOffset:Int
	Field yOffset:Int
	
	Field prevMouseDown:Bool = False

	Public
	Const ALIGN_LEFT:Int = 0
	Const ALIGN_CENTER:Int = 1
	Const ALIGN_RIGHT:Int = 2
	Const ALIGN_FULL:Int = 3
	
	Global current:AngelFont
	Global err:String
	
	Field name:String
	Field useKerning:Bool = True

	Field lineGap:Int = 5
	Field height:Int = 0
	Field heightOffset:Int = 9999
	Field scrollY:Int = 0
	
	Field italicSkew:Float = 0.25
	
	Method New(url:String="")
		If url &lt;&gt; ""
			Self.LoadFont(url)
			Self.name = url
			_list.Insert(url,Self)
		Endif
	End Method
	
	Method GetChars:Char[]()
		Return chars
	End

	Method LoadFont:Void(url:String)			'deprecated
		
		err = ""
		current = Self
		iniText = LoadString(url+".txt")
		Local lines:= iniText.Split(String.FromChar(10))
		For Local line:= Eachin lines
		
			line=line.Trim()
			
			If line.StartsWith("id,") Or line = "" Continue
			If line.StartsWith("first,")
'				kernPairs = New StringMap&lt;KernPair&gt;
				Continue
			Endif
			Local data$[] = line.Split(",")
			
			For Local i:=0 Until data.Length
				data[i]=data[i].Trim()
			Next
			
			err += data.Length+","	'+"-"+line
			If data.Length &gt; 0
				If data.Length = 3
	'				kerning.Insert(data[0]+"_"+data[1], New Kerning(Int(data[0]), Int(data[1]), Int(data[2]))
'					kernPairs.Add(String.FromChar(Int(data[0]))+"_"+String.FromChar(Int(data[1])), New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
'					kernPairs.Add(Int(data[0])*10000+Int(data[1]), New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
					
					Local first:Int = Int(data[0])
					firstKp = kernPairs.Get(first)
					If firstKp = Null
						kernPairs.Add(first, New IntMap&lt;KernPair&gt;)
						firstKp = kernPairs.Get(first)
					End
					
					Local second:Int = Int(data[1])
					
					firstKp.Add(second, New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
					
				Else
					If data.Length &gt;= 8
						chars[Int(data[0])] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]), Int(data[8]))
						Local ch := chars[Int(data[0])]
						If ch.height &gt; Self.height Self.height = ch.height
						If ch.yOffset &lt; Self.heightOffset Self.heightOffset = ch.yOffset
		'				ch.asc = Int(data[0])
					Endif
				Endif
			Endif
		Next
		
		image[0] = LoadImage(url+".png")
	End Method
	
	Method LoadFontXml:Void(url:String)
		current = Self
		
		iniText = LoadString(url + ".fnt")
		Local error:= New XMLError

'		Local lines:String[] = iniText.Split(String.FromChar(10))
'		Local firstLine:String = lines[0]
''		Print "lines count="+lines.Length
'		If firstLine.Contains("&lt;?xml")
'			Local lineList:List&lt;String&gt; = New List&lt;String&gt;(lines)
'			lineList.RemoveFirst()
'			lines = lineList.ToArray()
'			iniText = "~n".Join(lines)
'		End	
'		
		
		Local pageCount:Int = 0
		
		Local config:= ParseXML(iniText)
		If config = Null and error.error
		        'error
		        Print error.ToString()
		Else
						
			Local nodes:= config.GetChildrenAtPath("chars/char")
			For Local node:XMLNode = EachIn nodes			
				Local id:Int = Int(node.GetAttribute("id"))
				Local page:Int = Int(node.GetAttribute("page"))
				If pageCount &lt; page pageCount = page
				chars[id] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")), page)
				Local ch := chars[id]
				If ch.height &gt; Self.height Self.height = ch.height
				If ch.yOffset &lt; Self.heightOffset Self.heightOffset = ch.yOffset
			Next
			
			nodes = config.GetChildrenAtPath("kernings/kerning")
			For Local node:XMLNode = EachIn nodes
				'If node.name &lt;&gt; "kerning" Then Continue
				Local first:Int = Int(node.GetAttribute("first")) '* 10000
				firstKp = kernPairs.Get(first)
				If firstKp = Null
					kernPairs.Add(first, New IntMap&lt;KernPair&gt;)
					firstKp = kernPairs.Get(first)
				End
				
				Local second:Int = Int(node.GetAttribute("second"))
				
				firstKp.Add(second, New KernPair(first, second, Int(node.GetAttribute("amount"))))
			End
			
			If pageCount = 0
				image[0] = LoadImage(url+".png")
				If image[0] = Null image[0] = LoadImage(url+"_0.png")
			Else
				For Local page:= 0 To pageCount
					If image.Length &lt; page+1 image = image.Resize(page+1)
					image[page] = LoadImage(url+"_"+page+".png")
				End
			End					
		End
	End
	
	
	Method Use:Void()
		current = Self
	End Method
	
	Function GetCurrent:AngelFont()
		Return current
	End
	
#rem	
	Function Use:AngelFont(name:String)
		For Local af := Eachin _list
			If af.name = name
				current = af
				Return af
			End
		Next
		Return Null
	End
#end
	
	Method DrawItalic:Void(txt$,x#,y#)
		Local th#=TextHeight(txt)
		
		PushMatrix
			Transform 1,0,-italicSkew,1, x+th*italicSkew,y
			DrawText txt,0,0
		PopMatrix		
	End 
	
	Method DrawBold:Void(txt:String, x:Int, y:Int)
		DrawText(txt, x,y)
		DrawText(txt, x+1,y)
	End
	
	
	Method DrawText:Void(txt:String, x:Int, y:Int)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		xOffset = 0
		
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					firstKp = kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						secondKp = firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
'							Print prevChar+","+thisChar
						End
					Endif
				Endif
				ac.Draw(image[ac.page], x+xOffset,y)
				xOffset += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
	End Method
	
	Method DrawText:Void(txt:String, x:Int, y:Int, align:Int)
		xOffset = 0
		Select align
			Case ALIGN_CENTER
				DrawText(txt,x-(TextWidth(txt)/2),y)
			Case ALIGN_RIGHT
				DrawText(txt,x-TextWidth(txt),y)
			Case ALIGN_LEFT
				DrawText(txt,x,y)
		End Select
	End Method

	Method DrawHTML:Void(txt:String, x:Int, y:Int)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		xOffset = 0
		Local italic:Bool = False
		Local bold:Bool = False
		Local th#=TextHeight(txt)
		
		For Local i:= 0 Until txt.Length
			'err += txt[i..i+1]
			
			While txt[i..i+1] = "&lt;"
				Select txt[i+1..i+3]
					Case "i&gt;"
						italic = True
						i += 3
					Case "b&gt;"
						bold = True
						i += 3
					Default
						Select txt[i+1..i+4]
							Case "/i&gt;"
								italic = False
								i += 4
							Case "/b&gt;"
								bold = False
								i += 4
							Default
								i += 1
						End
				End
				If i &gt;= txt.Length
					Return
				End
			Wend
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					firstKp = kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						secondKp = firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
'							Print prevChar+","+thisChar+"  "+String.FromChar(prevChar)+","+String.FromChar(thisChar)
						End							
					Endif
				Endif
				If italic = False
					ac.Draw(image[ac.page], x+xOffset,y)
					If bold
						ac.Draw(image[ac.page], x+xOffset+1,y)
					End
				Else
					PushMatrix
						Transform 1,0,-italicSkew,1, (x+xOffset)+th*italicSkew,y
						ac.Draw(image[ac.page], 0,0)
						If bold
							ac.Draw(image[ac.page], 1,0)
						Endif					
					PopMatrix		
				End	
				xOffset += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
	End Method
	
	Method DrawHTML:Void(txt:String, x:Int, y:Int, align:Int)
		xOffset = 0
		Select align
			Case ALIGN_CENTER
				DrawHTML(txt,x-(TextWidth(StripHTML(txt))/2),y)
			Case ALIGN_RIGHT
				DrawHTML(txt,x-TextWidth(StripHTML(txt)),y)
			Case ALIGN_LEFT
				DrawHTML(txt,x,y)
		End Select
	End Method
	
	Function StripHTML:String(txt:String)
		Local plainText:String = txt.Replace("&lt;/","&lt;")
		plainText = plainText.Replace("&lt;b&gt;","")
		Return plainText.Replace("&lt;i&gt;","")
	End

	Method TextWidth:Int(txt:String)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		Local width:Int = 0
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					Local firstKp:= kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						Local secondKp:= firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
						End							
					Endif
				Endif
				'ch.Draw(image, x+xOffset,y)
				width += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
		Return width
	End Method
	
	Method TextHeight:Int(txt:String)
		Local h:Int = 0
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
			If ac.height+ac.yOffset &gt; h h = ac.height+ac.yOffset
		Next
		Return h
	End

End Class
</textarea><br><br>You'll need to swap out config.monkey and add xml.monkey instead to the example project for it to work.  I have not yet tested it for speed on Android, but it should be faster than the previous version.  Would you mind updating the link to your latest "stable" version to this? <br><br></td></tr></table><br>
<a name="2054891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker:<br><br>Here is an updated version of angelfont.monkey which uses skn3's xml.monkey instead of config.monkey.  As little code was changed as possible to make it a drop-in replacement, and therefore it still has the same hacks (ie: it checks for paged bitmaps the "wrong" way instead of asking the xml metadata).  It does, however, work.  No other bugfixes or changes were done to AngelFont, to make merging to the mainline as painless as possible.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
#TEXT_FILES="*.txt|*.xml|*.json|*.fnt"

Strict

Import mojo

Import char
Import kernpair

'Import config	'thanks to skn3 - you can find the latest version of this file in bananas/skn3/config folder.
Import xml      'Let's use skn3's xml lib instead of the config lib and see how much faster it is.

'Bitmap font tools:
'PC: <a href="http://www.angelcode.com/products/bmfont/" target="_blank">http://www.angelcode.com/products/bmfont/</a>
'Mac/PC: <a href="http://slick.cokeandcode.com/demos/hiero.jnlp" target="_blank">http://slick.cokeandcode.com/demos/hiero.jnlp</a>
'Mac (paid): <a href="http://www.bmglyph.com/" target="_blank">http://www.bmglyph.com/</a> - cheapest
'Mac (paid): <a href="http://glyphdesigner.71squared.com/" target="_blank">http://glyphdesigner.71squared.com/</a> - best

'For more information about AngelFont look here: <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=141" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=141</a>


Class AngelFont
	Private
	
	Global _list:StringMap&lt;AngelFont&gt; = New StringMap&lt;AngelFont&gt;
	
	Field image:Image[] = New Image[1]	
'	Field blockSize:Int
	Field chars:Char[256]
	
'	Field kernPairs:StringMap&lt;KernPair&gt; = New StringMap&lt;KernPair&gt;
	Field kernPairs:IntMap&lt;IntMap&lt;KernPair&gt;&gt; = New IntMap&lt;IntMap&lt;KernPair&gt;&gt;
	Global firstKp:IntMap&lt;KernPair&gt;
	Global secondKp:KernPair
	
'	Field section:String
	Field iniText:String

	Field xOffset:Int
	Field yOffset:Int
	
	Field prevMouseDown:Bool = False

	Public
	Const ALIGN_LEFT:Int = 0
	Const ALIGN_CENTER:Int = 1
	Const ALIGN_RIGHT:Int = 2
	Const ALIGN_FULL:Int = 3
	
	Global current:AngelFont
	Global err:String
	
	Field name:String
	Field useKerning:Bool = True

	Field lineGap:Int = 5
	Field height:Int = 0
	Field heightOffset:Int = 9999
	Field scrollY:Int = 0
	
	Field italicSkew:Float = 0.25
	
	Method New(url:String="")
		If url &lt;&gt; ""
			Self.LoadFont(url)
			Self.name = url
			_list.Insert(url,Self)
		Endif
	End Method
	
	Method GetChars:Char[]()
		Return chars
	End

	Method LoadFont:Void(url:String)			'deprecated
		
		err = ""
		current = Self
		iniText = LoadString(url+".txt")
		Local lines:= iniText.Split(String.FromChar(10))
		For Local line:= Eachin lines
		
			line=line.Trim()
			
			If line.StartsWith("id,") Or line = "" Continue
			If line.StartsWith("first,")
'				kernPairs = New StringMap&lt;KernPair&gt;
				Continue
			Endif
			Local data$[] = line.Split(",")
			
			For Local i:=0 Until data.Length
				data[i]=data[i].Trim()
			Next
			
			err += data.Length+","	'+"-"+line
			If data.Length &gt; 0
				If data.Length = 3
	'				kerning.Insert(data[0]+"_"+data[1], New Kerning(Int(data[0]), Int(data[1]), Int(data[2]))
'					kernPairs.Add(String.FromChar(Int(data[0]))+"_"+String.FromChar(Int(data[1])), New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
'					kernPairs.Add(Int(data[0])*10000+Int(data[1]), New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
					
					Local first:Int = Int(data[0])
					firstKp = kernPairs.Get(first)
					If firstKp = Null
						kernPairs.Add(first, New IntMap&lt;KernPair&gt;)
						firstKp = kernPairs.Get(first)
					End
					
					Local second:Int = Int(data[1])
					
					firstKp.Add(second, New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
					
				Else
					If data.Length &gt;= 8
						chars[Int(data[0])] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]), Int(data[8]))
						Local ch := chars[Int(data[0])]
						If ch.height &gt; Self.height Self.height = ch.height
						If ch.yOffset &lt; Self.heightOffset Self.heightOffset = ch.yOffset
		'				ch.asc = Int(data[0])
					Endif
				Endif
			Endif
		Next
		
		image[0] = LoadImage(url+".png")
	End Method
	
	Method LoadFontXml:Void(url:String)
		current = Self
		
		iniText = LoadString(url + ".fnt")
		Local error:= New XMLError

'		Local lines:String[] = iniText.Split(String.FromChar(10))
'		Local firstLine:String = lines[0]
''		Print "lines count="+lines.Length
'		If firstLine.Contains("&lt;?xml")
'			Local lineList:List&lt;String&gt; = New List&lt;String&gt;(lines)
'			lineList.RemoveFirst()
'			lines = lineList.ToArray()
'			iniText = "~n".Join(lines)
'		End	
'		
		
		Local pageCount:Int = 0
		
		Local config:= ParseXML(iniText)
		If config = Null and error.error
		        'error
		        Print error.ToString()
		Else
						
			Local nodes:= config.GetChildrenAtPath("chars/char")
			For Local node:XMLNode = EachIn nodes			
				Local id:Int = Int(node.GetAttribute("id"))
				Local page:Int = Int(node.GetAttribute("page"))
				If pageCount &lt; page pageCount = page
				chars[id] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")), page)
				Local ch := chars[id]
				If ch.height &gt; Self.height Self.height = ch.height
				If ch.yOffset &lt; Self.heightOffset Self.heightOffset = ch.yOffset
			Next
			
			nodes = config.GetChildrenAtPath("kernings/kerning")
			For Local node:XMLNode = EachIn nodes
				'If node.name &lt;&gt; "kerning" Then Continue
				Local first:Int = Int(node.GetAttribute("first")) '* 10000
				firstKp = kernPairs.Get(first)
				If firstKp = Null
					kernPairs.Add(first, New IntMap&lt;KernPair&gt;)
					firstKp = kernPairs.Get(first)
				End
				
				Local second:Int = Int(node.GetAttribute("second"))
				
				firstKp.Add(second, New KernPair(first, second, Int(node.GetAttribute("amount"))))
			End
			
			If pageCount = 0
				image[0] = LoadImage(url+".png")
				If image[0] = Null image[0] = LoadImage(url+"_0.png")
			Else
				For Local page:= 0 To pageCount
					If image.Length &lt; page+1 image = image.Resize(page+1)
					image[page] = LoadImage(url+"_"+page+".png")
				End
			End					
		End
	End
	
	
	Method Use:Void()
		current = Self
	End Method
	
	Function GetCurrent:AngelFont()
		Return current
	End
	
#rem	
	Function Use:AngelFont(name:String)
		For Local af := Eachin _list
			If af.name = name
				current = af
				Return af
			End
		Next
		Return Null
	End
#end
	
	Method DrawItalic:Void(txt$,x#,y#)
		Local th#=TextHeight(txt)
		
		PushMatrix
			Transform 1,0,-italicSkew,1, x+th*italicSkew,y
			DrawText txt,0,0
		PopMatrix		
	End 
	
	Method DrawBold:Void(txt:String, x:Int, y:Int)
		DrawText(txt, x,y)
		DrawText(txt, x+1,y)
	End
	
	
	Method DrawText:Void(txt:String, x:Int, y:Int)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		xOffset = 0
		
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					firstKp = kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						secondKp = firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
'							Print prevChar+","+thisChar
						End
					Endif
				Endif
				ac.Draw(image[ac.page], x+xOffset,y)
				xOffset += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
	End Method
	
	Method DrawText:Void(txt:String, x:Int, y:Int, align:Int)
		xOffset = 0
		Select align
			Case ALIGN_CENTER
				DrawText(txt,x-(TextWidth(txt)/2),y)
			Case ALIGN_RIGHT
				DrawText(txt,x-TextWidth(txt),y)
			Case ALIGN_LEFT
				DrawText(txt,x,y)
		End Select
	End Method

	Method DrawHTML:Void(txt:String, x:Int, y:Int)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		xOffset = 0
		Local italic:Bool = False
		Local bold:Bool = False
		Local th#=TextHeight(txt)
		
		For Local i:= 0 Until txt.Length
			'err += txt[i..i+1]
			
			While txt[i..i+1] = "&lt;"
				Select txt[i+1..i+3]
					Case "i&gt;"
						italic = True
						i += 3
					Case "b&gt;"
						bold = True
						i += 3
					Default
						Select txt[i+1..i+4]
							Case "/i&gt;"
								italic = False
								i += 4
							Case "/b&gt;"
								bold = False
								i += 4
							Default
								i += 1
						End
				End
				If i &gt;= txt.Length
					Return
				End
			Wend
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					firstKp = kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						secondKp = firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
'							Print prevChar+","+thisChar+"  "+String.FromChar(prevChar)+","+String.FromChar(thisChar)
						End							
					Endif
				Endif
				If italic = False
					ac.Draw(image[ac.page], x+xOffset,y)
					If bold
						ac.Draw(image[ac.page], x+xOffset+1,y)
					End
				Else
					PushMatrix
						Transform 1,0,-italicSkew,1, (x+xOffset)+th*italicSkew,y
						ac.Draw(image[ac.page], 0,0)
						If bold
							ac.Draw(image[ac.page], 1,0)
						Endif					
					PopMatrix		
				End	
				xOffset += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
	End Method
	
	Method DrawHTML:Void(txt:String, x:Int, y:Int, align:Int)
		xOffset = 0
		Select align
			Case ALIGN_CENTER
				DrawHTML(txt,x-(TextWidth(StripHTML(txt))/2),y)
			Case ALIGN_RIGHT
				DrawHTML(txt,x-TextWidth(StripHTML(txt)),y)
			Case ALIGN_LEFT
				DrawHTML(txt,x,y)
		End Select
	End Method
	
	Function StripHTML:String(txt:String)
		Local plainText:String = txt.Replace("&lt;/","&lt;")
		plainText = plainText.Replace("&lt;b&gt;","")
		Return plainText.Replace("&lt;i&gt;","")
	End

	Method TextWidth:Int(txt:String)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		Local width:Int = 0
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					Local firstKp:= kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						Local secondKp:= firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
						End							
					Endif
				Endif
				'ch.Draw(image, x+xOffset,y)
				width += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
		Return width
	End Method
	
	Method TextHeight:Int(txt:String)
		Local h:Int = 0
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
			If ac.height+ac.yOffset &gt; h h = ac.height+ac.yOffset
		Next
		Return h
	End

End Class
</textarea><br><br>You'll need to swap out config.monkey and add xml.monkey instead to the example project for it to work.  I have not yet tested it for speed on Android, but it should be faster than the previous version.  Would you mind updating your latest "stable" version to this? <br><br></td></tr></table><br>
<a name="2054890"></a>

<a name="2054889"></a>

<a name="2055832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Nobuyuki<br><br>Sorry, I've been very busy and completely missed this. It looks good, I'll give it a go soon. Thanks! <br><br></td></tr></table><br>
<a name="2055879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> One question Beaker; how do you set the font size? <br><br></td></tr></table><br>
<a name="2055883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> Chroma:  Font size is determined by the size of the font you import.  If you want to dynamically scale it at runtime, you have to use a matrix operation. <br><br></td></tr></table><br>
<a name="2055888"></a>

<a name="2055889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, by using Scale.  But it makes is kinda hard to read when scaled down.  I supposed I need to learn how to make AngelFonts.  I'm coding an eBook reader right now so I have to get this nailed soon. <br><br></td></tr></table><br>
<a name="2055890"></a>

<a name="2055892"></a>

<a name="2055896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm..not having much luck making my own bitmap font here with the BMTool from AngelCode.com.  I select XML out put and it puts out the .fnt and the .png but no accompanying .txt file like with the other fonts.<br><br>Ah..didn't see the drag and drop converter...got it now.<br><br>Hmm...says can't read property of f_height of null.  Anyone else having problems with AngelFont? <br><br></td></tr></table><br>
<a name="2055894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> as far as I know the txt file is no longer necessary in the new version of angelfont.<br><br>But I prefer to do it with txt file. It is rather tricky to get it. In the angelfont package there is a Bmax file named "drag_angefont_xml_here.bmx". Load this into BlitzMax and let it run once. Now when you return to your angefont dir there is a new "drag_angefont_xml_here.exe". Now drag your XML file over this exe and remove it. Two seconds later you will have a corresponding txt file in the same folder. <br><br></td></tr></table><br>
<a name="2055898"></a>

<a name="2055899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right i'm doing that but it's giving me that error.  Is there some guide for export settings for when you're using BMTool?<br><br>The BMTool also puts a weird graying border when you select "Smoothing". <br><br></td></tr></table><br>
<a name="2055903"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok finally got this working.  Nice that we don't need the converter anymore too! <br><br></td></tr></table><br>
<a name="2055911"></a>

<a name="2055912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> One last question.  Is there a feature where it will space the words and letters out to fill up the entire line? (kerning) <br><br></td></tr></table><br>
<a name="2055921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not yet. Btw it's called full justify. Kerning is the unique spacing between character pairs. <br><br></td></tr></table><br>
<a name="2055955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would like to use AngelFont for an eReader and full justify is an absolute necessity.  I will start tinkering about to see what I can do. <br><br></td></tr></table><br>
<a name="2056107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> Chroma - try this for full justify (replace simpletextbox.monkey file):<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

'Import mojo
Import angelfont

Class SimpleTextBox
	Global lineGap:Int = 5
	
	Global yOffset:Int = 0
	
	Global font:AngelFont
	
	Global align:Int = AngelFont.ALIGN_LEFT
	
	Function Draw:Void(text:String, x:Int, y:Int, width:Int, alignment:Int = AngelFont.ALIGN_LEFT)	
		
		Local thisLine:String = ""
		Local charOffset:Int = 0
		
		Local wordLen:Int = 0
		Local word:String = ""
		
		font = AngelFont.current
		align = alignment
		
		yOffset = 0
		For Local i := 0 Until text.Length
			If y+yOffset &gt; DeviceHeight()
				Return
			Endif		
		
			Local asc:Int = text[i]
			Select asc
				Case 32	' space
					wordLen = font.TextWidth(word)
					If charOffset + wordLen &gt; width
						DrawTextLine(thisLine, x,y+yOffset, width)
						thisLine = ""
						charOffset = 0
					Endif
'					Local chars:Char[] = font.GetChars()
					charOffset += wordLen+font.GetChars()[32].xAdvance
					thisLine += word + " "
					
					word = ""
					'wordLen = 0
				Case 10	' newline or "~n"
					wordLen = font.TextWidth(word)
					If charOffset + wordLen &gt; width
						DrawTextLine(thisLine, x,y+yOffset, width)
						thisLine = ""
					Endif
					thisLine += word
				
					Local prevAlign:Int = align
					If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
					DrawTextLine(thisLine, x,y+yOffset,width)
					align = prevAlign
					
					thisLine = ""
					charOffset = 0
					word = ""
				Default
					'Local ch:Char = font.GetChars()[asc]
					word += String.FromChar(asc)
			End Select
		Next

		If word &lt;&gt; ""
			wordLen = font.TextWidth(word)
			If charOffset + wordLen &gt; width
				DrawTextLine(thisLine, x,y+yOffset, width)
				thisLine = ""
			Endif
			thisLine += word
		Endif
		If thisLine &lt;&gt; ""
			If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
			DrawTextLine(thisLine, x,y+yOffset, width)
		Endif
	End
	
	Function DrawHTML:Void(text:String, x:Int, y:Int, width:Int, alignment:Int = AngelFont.ALIGN_LEFT)	
		Local thisLine:String = ""
		Local charOffset:Int = 0
		
		Local wordLen:Int = 0
		Local word:String = ""
		
		font = AngelFont.current
		align = alignment
		
		yOffset = 0
		For Local i := 0 Until text.Length
			If y+yOffset &gt; DeviceHeight()
				Return
			Endif		
		
			Local asc:Int = text[i]
			Select asc
				Case 32	' space
					wordLen = font.TextWidth(AngelFont.StripHTML(word))
					If charOffset + wordLen &gt; width
						DrawTextLineHTML(thisLine, x,y+yOffset, width)
						thisLine = ""
						charOffset = 0
					Endif
'					Local chars:Char[] = font.GetChars()
					charOffset += wordLen+font.GetChars()[32].xAdvance
					thisLine += word + " "
					
					word = ""
					'wordLen = 0
				Case 10	' newline or "~n"
					wordLen = font.TextWidth(AngelFont.StripHTML(word))
					If charOffset + wordLen &gt; width
						DrawTextLineHTML(thisLine, x,y+yOffset, width)
						thisLine = ""
					Endif
					thisLine += word
				
					Local prevAlign:Int = align
					If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
					DrawTextLineHTML(thisLine, x,y+yOffset, width)
					align = prevAlign

					thisLine = ""
					charOffset = 0
					word = ""
				Case 60	' &lt;
					If text[i+1..i+3] = "i&gt;" Or text[i+1..i+3] = "b&gt;"
						word += text[i..i+3]
						i += 2
					Else
						If text[i+1..i+4] = "/i&gt;" Or text[i+1..i+4] = "/b&gt;"
							word += text[i..i+4]
							i += 3
						End
					End
				Default
					'Local ch:Char = font.GetChars()[asc]
					word += String.FromChar(asc)
			End Select
		Next

		If word &lt;&gt; ""
			wordLen = font.TextWidth(AngelFont.StripHTML(word))
			If charOffset + wordLen &gt; width
				DrawTextLineHTML(thisLine, x,y+yOffset, width)
				thisLine = ""
			Endif
			thisLine += word
		Endif
		If thisLine &lt;&gt; ""
			If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
			DrawTextLineHTML(thisLine, x,y+yOffset, width)
		Endif
	End
	
	Function DrawTextLine:Void(txt:String, x:Int,y:Int, width:Float)
		If align = AngelFont.ALIGN_FULL
			Local words:= txt.Split(" ")
			Local noSpacesWidth:Float = 0
			Local wordWidths:Float[] = New Float[words.Length]
			Local wordCount:Int = 0
			For Local i:=0 Until words.Length
				wordWidths[i] = font.TextWidth(words[i])
				If wordWidths[i] &gt; 0 wordCount += 1
				noSpacesWidth += wordWidths[i]
			End
			Local spaceWidth:Float = (width-noSpacesWidth) / Float(wordCount-1)
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				If wordWidths[i] = 0 Continue
				font.DrawText(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+wordWidths[i]
			End
		Else
			font.DrawText(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End
	
	Function DrawTextLineHTML:Void(txt:String, x:Int,y:Int, width:Float)
		If align = AngelFont.ALIGN_FULL
			Local words:= AngelFont.StripHTML(txt).Split(" ")
			Local noSpacesWidth:Float = 0
			Local wordWidths:Float[] = New Float[words.Length]
			Local wordCount:Int = 0
			For Local i:=0 Until words.Length
				wordWidths[i] = font.TextWidth(words[i])
				If wordWidths[i] &gt; 0 wordCount += 1
				noSpacesWidth += wordWidths[i]
			End
			Local spaceWidth:Float = (width-noSpacesWidth) / Float(wordCount-1)
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				If wordWidths[i] = 0 Continue
				font.DrawHTML(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+wordWidths[i]
			End
		Else
			font.DrawHTML(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End


End Class</textarea><br><br>It's a quick and dirty hack but should work well. <br><br></td></tr></table><br>
<a name="2056022"></a>

<a name="2056023"></a>

<a name="2056020"></a>

<a name="2056021"></a>

<a name="2056019"></a>

<a name="2056093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Beaker, much appreciated. It works but it does have some lines where it doesn't completely fill up the line.  Trying to figure out what's up. <br><br></td></tr></table><br>
<a name="2056095"></a>

<a name="2056102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you post the text and a screen grab? Do you have any double spaces? <br><br></td></tr></table><br>
<a name="2056106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> I do have double spaces after each period. <br><br></td></tr></table><br>
<a name="2056108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've added a fix to the code above to handle multiple spaces between words. I hope this fixes your problem. <br><br></td></tr></table><br>
<a name="2056133"></a>

<a name="2056134"></a>

<a name="2056135"></a>

<a name="2056136"></a>

<a name="2056137"></a>

<a name="2056138"></a>

<a name="2056139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker you got it.  I didn't realize I had to set align to AngelFont.ALIGN_FULL.  It works a treat!  Thanks. <br><br></td></tr></table><br>
<a name="2056229"></a>

<a name="2056231"></a>

<a name="2056233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker, is there a way to force a new line or paragraph?  Also, my indents disappear when I load but I suspect that's coming from Skn3s XML loader stripping away white spaces? <br><br></td></tr></table><br>
<a name="2056244"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can force a newline with "~n". I'll try and add tabs sometime today. <br><br></td></tr></table><br>
<a name="2056247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> Easiest way to add tabs is to open angelfont.monkey and change some lines:<br>Add this line to the Public section of the fields:<br><pre class=code>Field tabSize:Int = 5</pre><br><br>Then change this line in LoadFont method:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">chars[Int(data[0])] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]), Int(data[8]))</textarea><br>to..<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">chars[Int(data[0])] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]), Int(data[8]))
If Int(data[0]) = 32
	chars[9] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]) * tabSize, Int(data[8]))
End</textarea><br><br>and this line in LoadFontXml method:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">chars[id] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")), page)</textarea><br>to..<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">chars[id] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")), page)
If id = 32
	chars[9] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")) * tabSize, page)
End</textarea><br><br>All this does is add a special new tab character to the font that is tabSize times bigger than a space. If you need to change the tabSize you must hardcode it in the Class itself, or change the value before you actually load the font (but after you create a new AngelFont).<br><br>Hope it helps. Let me know how you get on. <br><br></td></tr></table><br>
<a name="2056274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got the changes in and 5 spaces is acting the same.  Is the tab a special character or how would I generate a tab with these changes?<br><br>Hmm... ~n isn't making a new line here...tried it by itself and in quotes. <br><br></td></tr></table><br>
<a name="2056267"></a>

<a name="2056268"></a>

<a name="2056269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> "~t" - ie. standard BlitzMax/monkey characters. <br><br></td></tr></table><br>
<a name="2056277"></a>

<a name="2056278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm...is it working for you Beaker?  I'm having no luck here.<br><br>Could something in SimpleTextBox be canceling it out? <br><br></td></tr></table><br>
<a name="2056284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> Shouldn't be, it works for me. Can you send me some sample text and/or your version of simpletextbox.monkey and angelfont.monkey? <br><br></td></tr></table><br>
<a name="2056285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's my angelfont.monkey.  I put the simpletext box inside it too.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
#TEXT_FILES="*.txt|*.xml|*.json|*.fnt"

Strict

Import mojo

Import char
Import kernpair

Import config	'thanks to skn3 - you can find the latest version of this file in bananas/skn3/config folder.

'Bitmap font tools:
'PC: <a href="http://www.angelcode.com/products/bmfont/" target="_blank">http://www.angelcode.com/products/bmfont/</a>
'Mac/PC: <a href="http://slick.cokeandcode.com/demos/hiero.jnlp" target="_blank">http://slick.cokeandcode.com/demos/hiero.jnlp</a>
'Mac (paid): <a href="http://www.bmglyph.com/" target="_blank">http://www.bmglyph.com/</a> - cheapest
'Mac (paid): <a href="http://glyphdesigner.71squared.com/" target="_blank">http://glyphdesigner.71squared.com/</a> - best

'For more information about AngelFont look here: <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=141" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=141</a>


Class AngelFont
	Private
	
	Global _list:StringMap&lt;AngelFont&gt; = New StringMap&lt;AngelFont&gt;
	
	Field image:Image[] = New Image[1]	
'	Field blockSize:Int
	Field chars:Char[256]
	
'	Field kernPairs:StringMap&lt;KernPair&gt; = New StringMap&lt;KernPair&gt;
	Field kernPairs:IntMap&lt;IntMap&lt;KernPair&gt;&gt; = New IntMap&lt;IntMap&lt;KernPair&gt;&gt;
	Global firstKp:IntMap&lt;KernPair&gt;
	Global secondKp:KernPair
	
'	Field section:String
	Field iniText:String
	Field tabSize:Int = 5
	Field xOffset:Int
	Field yOffset:Int
	
	Field prevMouseDown:Bool = False

	Public
	Const ALIGN_LEFT:Int = 0
	Const ALIGN_CENTER:Int = 1
	Const ALIGN_RIGHT:Int = 2
	Const ALIGN_FULL:Int = 3
	
	Global current:AngelFont
	Global err:String
	
	Field name:String
	Field useKerning:Bool = True

	Field lineGap:Int = 5
	Field height:Int = 0
	Field heightOffset:Int = 9999
	Field scrollY:Int = 0
	
	Field italicSkew:Float = 0.25
	
	Method New(url:String="")
		If url &lt;&gt; ""
			Self.LoadFont(url)
			Self.name = url
			_list.Insert(url,Self)
		Endif
	End Method
	
	Method GetChars:Char[]()
		Return chars
	End

	Method LoadFont:Void(url:String)			'deprecated
		
		err = ""
		current = Self
		iniText = LoadString(url+".txt")
		Local lines:= iniText.Split(String.FromChar(10))
		For Local line:= Eachin lines
		
			line=line.Trim()
			
			If line.StartsWith("id,") Or line = "" Continue
			If line.StartsWith("first,")
'				kernPairs = New StringMap&lt;KernPair&gt;
				Continue
			Endif
			Local data$[] = line.Split(",")
			
			For Local i:=0 Until data.Length
				data[i]=data[i].Trim()
			Next
			
			err += data.Length+","	'+"-"+line
			If data.Length &gt; 0
				If data.Length = 3
	'				kerning.Insert(data[0]+"_"+data[1], New Kerning(Int(data[0]), Int(data[1]), Int(data[2]))
'					kernPairs.Add(String.FromChar(Int(data[0]))+"_"+String.FromChar(Int(data[1])), New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
'					kernPairs.Add(Int(data[0])*10000+Int(data[1]), New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
					
					Local first:Int = Int(data[0])
					firstKp = kernPairs.Get(first)
					If firstKp = Null
						kernPairs.Add(first, New IntMap&lt;KernPair&gt;)
						firstKp = kernPairs.Get(first)
					End
					
					Local second:Int = Int(data[1])
					
					firstKp.Add(second, New KernPair(Int(data[0]), Int(data[1]), Int(data[2])))
					
				Else
					If data.Length &gt;= 8
						'change
						'chars[Int(data[0])] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]), Int(data[8]))
						chars[Int(data[0])] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]), Int(data[8]))
						If Int(data[0]) = 32
							chars[9] = New Char(Int(data[1]), Int(data[2]), Int(data[3]), Int(data[4]),  Int(data[5]),  Int(data[6]),  Int(data[7]) * tabSize, Int(data[8]))
						End
						'change
						Local ch := chars[Int(data[0])]
						If ch.height &gt; Self.height Self.height = ch.height
						If ch.yOffset &lt; Self.heightOffset Self.heightOffset = ch.yOffset
		'				ch.asc = Int(data[0])
					Endif
				Endif
			Endif
		Next
		
		image[0] = LoadImage(url+".png")
	End Method
	
	Method LoadFontXml:Void(url:String)
		current = Self
		
		iniText = LoadString(url+".fnt")
		Local lines:String[] = iniText.Split(String.FromChar(10))
		Local firstLine:String = lines[0]
'		Print "lines count="+lines.Length
		If firstLine.Contains("&lt;?xml")
			Local lineList:List&lt;String&gt; = New List&lt;String&gt;(lines)
			lineList.RemoveFirst()
			lines = lineList.ToArray()
			iniText = "~n".Join(lines)
		End	
		
		
		Local pageCount:Int = 0
		
		Local config:= LoadConfig(iniText)
		
		Local nodes := config.FindNodesByPath("font/chars/char")
		For Local node := Eachin nodes
'			Print " -&gt; "+node.GetName()+"(id="+node.GetAttribute("id")+" x="+node.GetAttribute("x")+" y="+node.GetAttribute("y")+" width="+node.GetAttribute("width")+" height="+node.GetAttribute("height")+" )"
			'Print " -&gt; "+node.GetName()+" = "+node.GetValue()
			Local id:Int = Int(node.GetAttribute("id"))
			Local page:Int = Int(node.GetAttribute("page"))
			If pageCount &lt; page pageCount = page
			'change
			'chars[id] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")), page)
			
			chars[id] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")), page)
			If id = 32
				chars[9] = New Char(Int(node.GetAttribute("x")), Int(node.GetAttribute("y")), Int(node.GetAttribute("width")), Int(node.GetAttribute("height")),  Int(node.GetAttribute("xoffset")),  Int(node.GetAttribute("yoffset")),  Int(node.GetAttribute("xadvance")) * tabSize, page)
			End
			'change
			Local ch := chars[id]
			If ch.height &gt; Self.height Self.height = ch.height
			If ch.yOffset &lt; Self.heightOffset Self.heightOffset = ch.yOffset
		Next
		
		nodes = config.FindNodesByPath("font/kernings/kerning")
		For Local node := Eachin nodes
'			Local first:String = String.FromChar(Int(node.GetAttribute("first")))
'			Local second:String = String.FromChar(Int(node.GetAttribute("second")))
			Local first:Int = Int(node.GetAttribute("first")) '* 10000
			firstKp = kernPairs.Get(first)
			If firstKp = Null
				kernPairs.Add(first, New IntMap&lt;KernPair&gt;)
				firstKp = kernPairs.Get(first)
			End
			
			Local second:Int = Int(node.GetAttribute("second"))
			
'			kernPairs.Add(first+"_"+second, New KernPair(Int(first), Int(second), Int(node.GetAttribute("amount"))))
'			kernPairs.Add(first+second, New KernPair(first, second, Int(node.GetAttribute("amount"))))
			firstKp.Add(second, New KernPair(first, second, Int(node.GetAttribute("amount"))))
			'Print "adding kerning "+ String.FromChar(first)+" "+String.FromChar(second)
		End
		
		If pageCount = 0
			image[0] = LoadImage(url+".png")
			If image[0] = Null image[0] = LoadImage(url+"_0.png")
		Else
			For Local page:= 0 To pageCount
				If image.Length &lt; page+1 image = image.Resize(page+1)
				image[page] = LoadImage(url+"_"+page+".png")
			End
		End					
'		Print iniText
	End
	
	
	Method Use:Void()
		current = Self
	End Method
	
	Function GetCurrent:AngelFont()
		Return current
	End
	
#rem	
	Function Use:AngelFont(name:String)
		For Local af := Eachin _list
			If af.name = name
				current = af
				Return af
			End
		Next
		Return Null
	End
#end
	
	Method DrawItalic:Void(txt$,x#,y#)
		Local th#=TextHeight(txt)
		
		PushMatrix
			Transform 1,0,-italicSkew,1, x+th*italicSkew,y
			DrawText txt,0,0
		PopMatrix		
	End 
	
	Method DrawBold:Void(txt:String, x:Int, y:Int)
		DrawText(txt, x,y)
		DrawText(txt, x+1,y)
	End
	
	
	Method DrawText:Void(txt:String, x:Int, y:Int)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		xOffset = 0
		
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					firstKp = kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						secondKp = firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
'							Print prevChar+","+thisChar
						End
					Endif
				Endif
				ac.Draw(image[ac.page], x+xOffset,y)
				xOffset += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
	End Method
	
	Method DrawText:Void(txt:String, x:Int, y:Int, align:Int)
		xOffset = 0
		Select align
			Case ALIGN_CENTER
				DrawText(txt,x-(TextWidth(txt)/2),y)
			Case ALIGN_RIGHT
				DrawText(txt,x-TextWidth(txt),y)
			Case ALIGN_LEFT
				DrawText(txt,x,y)
		End Select
	End Method

	Method DrawHTML:Void(txt:String, x:Int, y:Int)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		xOffset = 0
		Local italic:Bool = False
		Local bold:Bool = False
		Local th#=TextHeight(txt)
		
		For Local i:= 0 Until txt.Length
			'err += txt[i..i+1]
			
			While txt[i..i+1] = "&lt;"
				Select txt[i+1..i+3]
					Case "i&gt;"
						italic = True
						i += 3
					Case "b&gt;"
						bold = True
						i += 3
					Default
						Select txt[i+1..i+4]
							Case "/i&gt;"
								italic = False
								i += 4
							Case "/b&gt;"
								bold = False
								i += 4
							Default
								i += 1
						End
				End
				If i &gt;= txt.Length
					Return
				End
			Wend
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					firstKp = kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						secondKp = firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
'							Print prevChar+","+thisChar+"  "+String.FromChar(prevChar)+","+String.FromChar(thisChar)
						End							
					Endif
				Endif
				If italic = False
					ac.Draw(image[ac.page], x+xOffset,y)
					If bold
						ac.Draw(image[ac.page], x+xOffset+1,y)
					End
				Else
					PushMatrix
						Transform 1,0,-italicSkew,1, (x+xOffset)+th*italicSkew,y
						ac.Draw(image[ac.page], 0,0)
						If bold
							ac.Draw(image[ac.page], 1,0)
						Endif					
					PopMatrix		
				End	
				xOffset += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
	End Method
	
	Method DrawHTML:Void(txt:String, x:Int, y:Int, align:Int)
		xOffset = 0
		Select align
			Case ALIGN_CENTER
				DrawHTML(txt,x-(TextWidth(StripHTML(txt))/2),y)
			Case ALIGN_RIGHT
				DrawHTML(txt,x-TextWidth(StripHTML(txt)),y)
			Case ALIGN_LEFT
				DrawHTML(txt,x,y)
		End Select
	End Method
	
	Function StripHTML:String(txt:String)
		Local plainText:String = txt.Replace("&lt;/","&lt;")
		plainText = plainText.Replace("&lt;b&gt;","")
		Return plainText.Replace("&lt;i&gt;","")
	End

	Method TextWidth:Int(txt:String)
'		Local prevChar:String = ""
		Local prevChar:Int = 0
		Local width:Int = 0
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
'			Local thisChar:String = String.FromChar(asc)
			Local thisChar:Int = asc
			If ac  &lt;&gt; Null
				If useKerning
					Local firstKp:= kernPairs.Get(prevChar)
					If firstKp &lt;&gt; Null
						Local secondKp:= firstKp.Get(thisChar)
						If secondKp &lt;&gt; Null
							xOffset += secondKp.amount
						End							
					Endif
				Endif
				'ch.Draw(image, x+xOffset,y)
				width += ac.xAdvance
				prevChar = thisChar
			Endif
		Next
		Return width
	End Method
	
	Method TextHeight:Int(txt:String)
		Local h:Int = 0
		For Local i:= 0 Until txt.Length
			Local asc:Int = txt[i]
			Local ac:Char = chars[asc]
			If ac.height+ac.yOffset &gt; h h = ac.height+ac.yOffset
		Next
		Return h
	End

End Class


'Text Box
Class SimpleTextBox

	Global lineGap:Int = 5
	
	Global yOffset:Int = 0
	
	Global font:AngelFont
	
	Global align:Int = AngelFont.ALIGN_LEFT
	
	Function Draw:Void(text:String, x:Int, y:Int, width:Int, alignment:Int = AngelFont.ALIGN_LEFT)	
		
		Local thisLine:String = ""
		Local charOffset:Int = 0
		
		Local wordLen:Int = 0
		Local word:String = ""
		
		font = AngelFont.current
		align = alignment
		
		yOffset = 0
		For Local i := 0 Until text.Length
			If y+yOffset &gt; DeviceHeight()
				Return
			Endif		
		
			Local asc:Int = text[i]
			Select asc
				Case 32	' space
					wordLen = font.TextWidth(word)
					If charOffset + wordLen &gt; width
						DrawTextLine(thisLine, x,y+yOffset, width)
						thisLine = ""
						charOffset = 0
					Endif
'					Local chars:Char[] = font.GetChars()
					charOffset += wordLen+font.GetChars()[32].xAdvance
					thisLine += word + " "
					
					word = ""
					'wordLen = 0
				Case 10	' newline or "~n"
					wordLen = font.TextWidth(word)
					If charOffset + wordLen &gt; width
						DrawTextLine(thisLine, x,y+yOffset, width)
						thisLine = ""
					Endif
					thisLine += word
				
					Local prevAlign:Int = align
					If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
					DrawTextLine(thisLine, x,y+yOffset,width)
					align = prevAlign
					
					thisLine = ""
					charOffset = 0
					word = ""
				Default
					'Local ch:Char = font.GetChars()[asc]
					word += String.FromChar(asc)
			End Select
		Next

		If word &lt;&gt; ""
			wordLen = font.TextWidth(word)
			If charOffset + wordLen &gt; width
				DrawTextLine(thisLine, x,y+yOffset, width)
				thisLine = ""
			Endif
			thisLine += word
		Endif
		If thisLine &lt;&gt; ""
			If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
			DrawTextLine(thisLine, x,y+yOffset, width)
		Endif
	End
	
	Function DrawHTML:Void(text:String, x:Int, y:Int, width:Int, alignment:Int = AngelFont.ALIGN_LEFT)	
		Local thisLine:String = ""
		Local charOffset:Int = 0
		
		Local wordLen:Int = 0
		Local word:String = ""
		
		font = AngelFont.current
		align = alignment
		
		yOffset = 0
		For Local i := 0 Until text.Length
			If y+yOffset &gt; DeviceHeight()
				Return
			Endif		
		
			Local asc:Int = text[i]
			Select asc
				Case 32	' space
					wordLen = font.TextWidth(AngelFont.StripHTML(word))
					If charOffset + wordLen &gt; width
						DrawTextLineHTML(thisLine, x,y+yOffset, width)
						thisLine = ""
						charOffset = 0
					Endif
'					Local chars:Char[] = font.GetChars()
					charOffset += wordLen+font.GetChars()[32].xAdvance
					thisLine += word + " "
					
					word = ""
					'wordLen = 0
				Case 10	' newline or "~n"
					wordLen = font.TextWidth(AngelFont.StripHTML(word))
					If charOffset + wordLen &gt; width
						DrawTextLineHTML(thisLine, x,y+yOffset, width)
						thisLine = ""
					Endif
					thisLine += word
				
					Local prevAlign:Int = align
					If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
					DrawTextLineHTML(thisLine, x,y+yOffset, width)
					align = prevAlign

					thisLine = ""
					charOffset = 0
					word = ""
				Case 60	' &lt;
					If text[i+1..i+3] = "i&gt;" Or text[i+1..i+3] = "b&gt;"
						word += text[i..i+3]
						i += 2
					Else
						If text[i+1..i+4] = "/i&gt;" Or text[i+1..i+4] = "/b&gt;"
							word += text[i..i+4]
							i += 3
						End
					End
				Default
					'Local ch:Char = font.GetChars()[asc]
					word += String.FromChar(asc)
			End Select
		Next

		If word &lt;&gt; ""
			wordLen = font.TextWidth(AngelFont.StripHTML(word))
			If charOffset + wordLen &gt; width
				DrawTextLineHTML(thisLine, x,y+yOffset, width)
				thisLine = ""
			Endif
			thisLine += word
		Endif
		If thisLine &lt;&gt; ""
			If align = AngelFont.ALIGN_FULL align = AngelFont.ALIGN_LEFT
			DrawTextLineHTML(thisLine, x,y+yOffset, width)
		Endif
	End
	
	Function DrawTextLine:Void(txt:String, x:Int,y:Int, width:Float)
		If align = AngelFont.ALIGN_FULL
			Local words:= txt.Split(" ")
			Local noSpacesWidth:Float = 0
			Local wordWidths:Float[] = New Float[words.Length]
			Local wordCount:Int = 0
			For Local i:=0 Until words.Length
				wordWidths[i] = font.TextWidth(words[i])
				If wordWidths[i] &gt; 0 wordCount += 1
				noSpacesWidth += wordWidths[i]
			End
			Local spaceWidth:Float = (width-noSpacesWidth) / Float(wordCount-1)
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				If wordWidths[i] = 0 Continue
				font.DrawText(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+wordWidths[i]
			End
		Else
			font.DrawText(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End
	
	Function DrawTextLineHTML:Void(txt:String, x:Int,y:Int, width:Float)
		If align = AngelFont.ALIGN_FULL
			Local words:= AngelFont.StripHTML(txt).Split(" ")
			Local noSpacesWidth:Float = 0
			Local wordWidths:Float[] = New Float[words.Length]
			Local wordCount:Int = 0
			For Local i:=0 Until words.Length
				wordWidths[i] = font.TextWidth(words[i])
				If wordWidths[i] &gt; 0 wordCount += 1
				noSpacesWidth += wordWidths[i]
			End
			Local spaceWidth:Float = (width-noSpacesWidth) / Float(wordCount-1)
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				If wordWidths[i] = 0 Continue
				font.DrawHTML(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+wordWidths[i]
			End
		Else
			font.DrawHTML(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End

End Class
</textarea><br><br>and my sample text is some text between two xml tags that is loaded by skn3 xml loader.<br><br>The body of that text is:<br><pre class=code>
&lt;body&gt;~tHere is some sample test to test out how the full
justify is going to work.  I am going to force a new line
right here~n and this is the start of the new line.  The
quick brown fox jumped over the lazy dogs.  The lazy dogs
couldn't catch the quick brown fox.&lt;/body&gt;
</pre><br><br><br><br><br><br><br><br>[/code] <br><br></td></tr></table><br>
<a name="2056288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> All seems to work fine here. Are you sure you aren't actually using/importing a different version or something? <br><br></td></tr></table><br>
<a name="2056322"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> My code above works for you? <br><br></td></tr></table><br>
<a name="2056340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep. What computer are you on, and which target are you trying? Could it be an XML problem? Can you also just try putting real tabs and returns in the string if you are loading it? <br><br></td></tr></table><br>
<a name="2056343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you display the text with angelfont or simpletextbox? <br><br></td></tr></table><br>
<a name="2056344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> Both. <br><br></td></tr></table><br>
<a name="2056351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah you're right, it works but not when I'm not loading text via xml.monkey.  If I just create a string in the program itself with ~t and ~n, it works just dandy.  Weird!  I'll get it sorted and thanks for helping me out Beaker. <br><br></td></tr></table><br>
<a name="2056354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm...when a ~t and ~n is used in a text string mativiely inside Monkey it works fine and when you do a Print it actually does the tabs and new lines in the text window under the screen.  When it's loaded externally, it just treats it as text and prints it...  No idea here...<br><br>Beaker if you get time, take the test text above that worked fine and load it from an external text file with the LoadString command then you'll see what I'm up against. <br><br></td></tr></table><br>
<a name="2056353"></a>

<a name="2056357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> For external files you will probably have to swap the ~n and ~t to actual tabs and returns. <br><br></td></tr></table><br>
<a name="2056356"></a>

<a name="2056359"></a>

<a name="2056361"></a>

<a name="2056362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#114">[#114]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I just saw that if I put in a @t in the external text file and then do a  text = text.Replace("@t","~t") that it puts the tab in correctly.  For sake of control, I'll probably just insert a manual symbol and "fix" it in code as above.  Thanks again for your patience.<br><br>EDIT:  Ok I went with \t \n and \r for tab, newline, and return.  Basically the \r just lets me chop the sentence but it just adds a space in and keeps it one long sentence.  This part is all done.<br><br>Thank you Beaker and Skn3.  Now, can you make it do (voice trails off...just kidding!)<br><br>Thanks again. <br><br></td></tr></table><br>
<a name="2056423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#115">[#115]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beaker, for some reason the double space after a period is pretty small almost like a single space.  What would I change to  make it a little bigger? <br><br></td></tr></table><br>
<a name="2056518"></a>

<a name="2056519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#116">[#116]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try replacing these in simpletextbox.monkey:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">	removed</textarea> <br><br></td></tr></table><br>
<a name="2056429"></a>

<a name="2056437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#117">[#117]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something isn't right with that. Will take another look later. <br><br></td></tr></table><br>
<a name="2056438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#118">[#118]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is better (and faster):<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">	Function DrawTextLine:Void(txt:String, x:Int,y:Int, width:int)
		If align = AngelFont.ALIGN_FULL
			Local words:= txt.Trim().Split(" ")
			Local noSpacesWidth:= font.TextWidth("".Join(words))
			
			Local spaceWidth:Float = Float(width-noSpacesWidth) / Float(words.Length-1)
			
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				font.DrawText(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+font.TextWidth(words[i])	'wordWidths[i]
			End
		Else
			font.DrawText(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End
	
	Function DrawTextLineHTML:Void(txt:String, x:Int,y:Int, width:int)
		If align = AngelFont.ALIGN_FULL
			Local words:= AngelFont.StripHTML(txt.Trim()).Split(" ")
			Local noSpacesWidth:= font.TextWidth("".Join(words))
			
			Local spaceWidth:Float = Float(width-noSpacesWidth) / Float(words.Length-1)
			
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				'If wordWidths[i] = 0 Continue
				font.DrawHTML(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+font.TextWidth(words[i])	'wordWidths[i]
			End
		Else
			font.DrawHTML(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End</textarea> <br><br></td></tr></table><br>
<a name="2057004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#119">[#119]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I tried that and now the tabs have disappeared. <br><br></td></tr></table><br>
<a name="2057007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#120">[#120]</a></td></tr></table></td></tr><tr ><td class="posttext"> How does this work for you?<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">	Function DrawTextLine:Void(txt:String, x:Int,y:Int, width:int)
		If align = AngelFont.ALIGN_FULL
			'Local words:= txt.Trim().Split(" ")
			Local words:= txt.Split(" ")
			words[words.Length-1] = words[words.Length-1].Trim()
			Local noSpacesWidth:= font.TextWidth("".Join(words))
			
			Local spaceWidth:Float = Float(width-noSpacesWidth) / Float(words.Length-1)
			
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				font.DrawText(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+font.TextWidth(words[i])	'wordWidths[i]
			End
		Else
			font.DrawText(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End
	
	Function DrawTextLineHTML:Void(txt:String, x:Int,y:Int, width:int)
		If align = AngelFont.ALIGN_FULL
			'Local words:= AngelFont.StripHTML(txt.Trim()).Split(" ")
			Local words:= AngelFont.StripHTML(txt).Split(" ")
			words[words.Length-1] = words[words.Length-1].Trim()
			Local noSpacesWidth:= font.TextWidth("".Join(words))
			
			Local spaceWidth:Float = Float(width-noSpacesWidth) / Float(words.Length-1)
			
			Local xOffset:Float = 0
			For Local i:=0 Until words.Length
				'If wordWidths[i] = 0 Continue
				font.DrawHTML(words[i],x+Floor(xOffset),y)
				xOffset += spaceWidth+font.TextWidth(words[i])	'wordWidths[i]
			End
		Else
			font.DrawHTML(txt, x,y, align)
		End
		yOffset += lineGap+font.height
	End</textarea> <br><br></td></tr></table><br>
<a name="2059401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#121">[#121]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>Here's a small fix to simpletextbox.monkey that makes it more compatible with AngelFont wrappers that scale the font using the global matrix.  Change Line 28 of simpletextbox.monkey, from this:<br><br><pre class=code>
		yOffset = 0
		For Local i := 0 Until text.Length
			If y + yOffset &gt; DeviceHeight() '&lt;---- THIS LINE
				Return
			Endif		
</pre><br><br>To this:<br><pre class=code>
		yOffset = 0
		For Local i := 0 Until text.Length
			If (y + yOffset) * GetMatrix()[3] &gt; DeviceHeight()
				Return
			Endif		
</pre><br><br>Now the code won't exit early -- it will continue to draw until it reaches the "true" DeviceHeight, based on the current matrix yScale. <br><br></td></tr></table><br>
<a name="2059400"></a>

<a name="2069764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >David Casual Box</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#122">[#122]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Not sure it has been discussed but for some reasons, some fonts do not export any kernings infos (I use GlyphDesigner). Some does, some don't...<br><br>While kernings can be turned off in the AngelFont module (useKerning), it still tries to load the kerning and crash. I had to add a condition to avoid the kernings to be loaded if useKerning is off. <br><br></td></tr></table><br>
<a name="2069795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >necky</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#123">[#123]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br>      Firstly, I'd like to say that this is a brilliant module and will be perfect for my text editor I'm working on right now! :D So thankyou! :D<br> <br>But (there's always a 'but' isn't there! LOL!) I'm having trouble creating my own fonts at the moment.<br><br>I've followed the process above in exactly the same way it is explained in creating a new font (well I think I have), but for some reason when I try to create a new font it crashes!(I'm using Beakers example that's in the examples directory). All I get a 'memory violation' error.<br><br>To save my sanity can someone outline the exact export settings they use in bmfont and anything else they do in creating a new font? I don't believe anyone has done this yet and it would be extremely helpful to have. :)<br><br>All the best!<br><br>               Mike <br><br></td></tr></table><br>
<a name="2069814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#124">[#124]</a></td></tr></table></td></tr><tr ><td class="posttext"> @necky<br>export as xml, then try loading using LoadFontXML() instead.  Don't run any conversion tools!  And remember that this is slow on Android unless you're using the version that doesn't utilize config.monkey :)<br><br><a href="https://github.com/nobuyukinyuu/angelfont-tryouts" target="_blank">https://github.com/nobuyukinyuu/angelfont-tryouts</a> <br><br></td></tr></table><br>
<a name="2075617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#125">[#125]</a></td></tr></table></td></tr><tr ><td class="posttext"> I couldn't see any way to get exports straight out of bmGlyph and into AngelFont so I wrote a rough 'n' ready convertor that takes a Coronna format export (*.fnt) and spits out a compatible .txt file. Source <a href="http://www.into-games.com/index.php?id=tappy-feats&amp;post=bmglyph-fonts-angelfont" target="_blank">here</a>, it's written in BlitzMax. <br><br></td></tr></table><br>
<a name="2075535"></a>

<a name="2075534"></a>

<a name="2075565"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#126">[#126]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Sledge<br><br>the export .fnt files aren't compatible with the type of .fnt file angelfont can take?  If it is compatible with bmfont, angelfont should take it.  The only exception are binary-encoded .fnt files. <br><br></td></tr></table><br>
<a name="2075621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#127">[#127]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope. AngelFont expects .fnt files to be xml (I'm inferring this from the fact that it's the LoadFontXml() command that specifically looks for a file with the .fnt suffix while LoadFont() looks for a file with the .txt suffix). When you publish a BMFont from bmGlyph the .fnt file isn't xml...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
info face="American Typewriter" size=50 bold=0 italic=0 charset="" unicode=0 stretchH=100 smooth=1 aa=1 padding=0,0,0,0 spacing=0,0
common lineHeight=59 base=48 scaleW=384 scaleH=384 pages=1 packed=0
page id=0 file="at.png"
chars count=95
char id=32 x=376 y=2 width=0 height=0 xoffset=0 yoffset=45 xadvance=13 page=0 chnl=0
char id=33 x=220 y=218 width=10 height=40 xoffset=9 yoffset=9 xadvance=21 page=0 chnl=0
char id=34 x=276 y=192 width=12 height=18 xoffset=4 yoffset=11 xadvance=13 page=0 chnl=0
char id=35 x=182 y=118 width=30 height=38 xoffset=3 yoffset=11 xadvance=30 page=0 chnl=0
char id=36 x=2 y=140 width=28 height=50 xoffset=5 yoffset=4 xadvance=31 page=0 chnl=0
char id=37 x=190 y=2 width=42 height=40 xoffset=2 yoffset=9 xadvance=41 page=0 chnl=0
char id=38 x=146 y=2 width=42 height=40 xoffset=3 yoffset=9 xadvance=41 page=0 chnl=0
char id=39 x=30 y=356 width=6 height=18 xoffset=4 yoffset=11 xadvance=8 page=0 chnl=0
char id=40 x=150 y=310 width=20 height=50 xoffset=3 yoffset=8 xadvance=20 page=0 chnl=0
char id=41 x=150 y=258 width=20 height=50 xoffset=2 yoffset=8 xadvance=20 page=0 chnl=0
char id=42 x=178 y=348 width=20 height=20 xoffset=9 yoffset=11 xadvance=31 page=0 chnl=0
char id=43 x=248 y=192 width=26 height=24 xoffset=2 yoffset=18 xadvance=25 page=0 chnl=0
char id=44 x=290 y=192 width=10 height=20 xoffset=3 yoffset=39 xadvance=11 page=0 chnl=0
char id=45 x=178 y=370 width=20 height=6 xoffset=2 yoffset=30 xadvance=20 page=0 chnl=0
char id=46 x=68 y=370 width=10 height=10 xoffset=4 yoffset=39 xadvance=11 page=0 chnl=0
char id=47 x=150 y=208 width=24 height=48 xoffset=-1 yoffset=10 xadvance=20 page=0 chnl=0
char id=48 x=82 y=286 width=32 height=40 xoffset=3 yoffset=9 xadvance=31 page=0 chnl=0
char id=49 x=330 y=118 width=22 height=40 xoffset=8 yoffset=9 xadvance=31 page=0 chnl=0
char id=50 x=150 y=118 width=30 height=40 xoffset=3 yoffset=9 xadvance=31 page=0 chnl=0
char id=51 x=116 y=326 width=30 height=40 xoffset=4 yoffset=9 xadvance=31 page=0 chnl=0
char id=52 x=82 y=244 width=32 height=40 xoffset=2 yoffset=9 xadvance=31 page=0 chnl=0
char id=53 x=116 y=284 width=30 height=40 xoffset=4 yoffset=9 xadvance=31 page=0 chnl=0
char id=54 x=116 y=242 width=30 height=40 xoffset=3 yoffset=9 xadvance=31 page=0 chnl=0
char id=55 x=274 y=118 width=28 height=40 xoffset=4 yoffset=9 xadvance=31 page=0 chnl=0
char id=56 x=116 y=200 width=30 height=40 xoffset=3 yoffset=9 xadvance=31 page=0 chnl=0
char id=57 x=116 y=158 width=30 height=40 xoffset=3 yoffset=9 xadvance=31 page=0 chnl=0
char id=58 x=366 y=44 width=10 height=30 xoffset=4 yoffset=19 xadvance=11 page=0 chnl=0
char id=59 x=364 y=2 width=10 height=40 xoffset=3 yoffset=19 xadvance=11 page=0 chnl=0
char id=60 x=220 y=192 width=26 height=24 xoffset=2 yoffset=18 xadvance=25 page=0 chnl=0
char id=61 x=82 y=368 width=26 height=12 xoffset=2 yoffset=23 xadvance=25 page=0 chnl=0
char id=62 x=2 y=356 width=26 height=24 xoffset=2 yoffset=18 xadvance=25 page=0 chnl=0
char id=63 x=244 y=118 width=28 height=40 xoffset=3 yoffset=9 xadvance=29 page=0 chnl=0
char id=64 x=158 y=76 width=38 height=36 xoffset=1 yoffset=12 xadvance=34 page=0 chnl=0
char id=65 x=38 y=84 width=42 height=38 xoffset=0 yoffset=11 xadvance=37 page=0 chnl=0
char id=66 x=270 y=76 width=34 height=38 xoffset=2 yoffset=11 xadvance=35 page=0 chnl=0
char id=67 x=82 y=202 width=32 height=40 xoffset=3 yoffset=9 xadvance=32 page=0 chnl=0
char id=68 x=38 y=288 width=38 height=38 xoffset=2 yoffset=11 xadvance=37 page=0 chnl=0
char id=69 x=234 y=76 width=34 height=38 xoffset=2 yoffset=11 xadvance=34 page=0 chnl=0
char id=70 x=198 y=76 width=34 height=38 xoffset=2 yoffset=11 xadvance=31 page=0 chnl=0
char id=71 x=38 y=206 width=38 height=40 xoffset=3 yoffset=9 xadvance=37 page=0 chnl=0
char id=72 x=38 y=166 width=40 height=38 xoffset=2 yoffset=11 xadvance=40 page=0 chnl=0
char id=73 x=178 y=308 width=20 height=38 xoffset=2 yoffset=11 xadvance=18 page=0 chnl=0
char id=74 x=2 y=234 width=34 height=40 xoffset=1 yoffset=9 xadvance=31 page=0 chnl=0
char id=75 x=38 y=44 width=42 height=38 xoffset=2 yoffset=11 xadvance=39 page=0 chnl=0
char id=76 x=2 y=316 width=34 height=38 xoffset=2 yoffset=11 xadvance=31 page=0 chnl=0
char id=77 x=52 y=2 width=48 height=38 xoffset=2 yoffset=11 xadvance=46 page=0 chnl=0
char id=78 x=320 y=2 width=42 height=38 xoffset=2 yoffset=11 xadvance=40 page=0 chnl=0
char id=79 x=2 y=192 width=34 height=40 xoffset=3 yoffset=9 xadvance=34 page=0 chnl=0
char id=80 x=2 y=276 width=34 height=38 xoffset=2 yoffset=11 xadvance=32 page=0 chnl=0
char id=81 x=2 y=44 width=34 height=48 xoffset=3 yoffset=10 xadvance=34 page=0 chnl=0
char id=82 x=234 y=2 width=40 height=40 xoffset=2 yoffset=9 xadvance=38 page=0 chnl=0
char id=83 x=214 y=118 width=28 height=40 xoffset=3 yoffset=9 xadvance=30 page=0 chnl=0
char id=84 x=116 y=118 width=32 height=38 xoffset=2 yoffset=11 xadvance=31 page=0 chnl=0
char id=85 x=102 y=2 width=42 height=40 xoffset=1 yoffset=9 xadvance=38 page=0 chnl=0
char id=86 x=38 y=124 width=38 height=40 xoffset=0 yoffset=9 xadvance=32 page=0 chnl=0
char id=87 x=2 y=2 width=48 height=40 xoffset=0 yoffset=9 xadvance=42 page=0 chnl=0
char id=88 x=276 y=2 width=42 height=38 xoffset=0 yoffset=11 xadvance=37 page=0 chnl=0
char id=89 x=38 y=248 width=38 height=38 xoffset=-1 yoffset=11 xadvance=31 page=0 chnl=0
char id=90 x=82 y=328 width=32 height=38 xoffset=2 yoffset=11 xadvance=31 page=0 chnl=0
char id=91 x=178 y=258 width=16 height=48 xoffset=4 yoffset=10 xadvance=17 page=0 chnl=0
char id=92 x=150 y=160 width=26 height=46 xoffset=2 yoffset=7 xadvance=25 page=0 chnl=0
char id=93 x=178 y=208 width=16 height=48 xoffset=2 yoffset=10 xadvance=17 page=0 chnl=0
char id=94 x=150 y=362 width=26 height=18 xoffset=3 yoffset=11 xadvance=25 page=0 chnl=0
char id=95 x=116 y=368 width=30 height=6 xoffset=0 yoffset=48 xadvance=25 page=0 chnl=0
char id=96 x=302 y=192 width=14 height=12 xoffset=7 yoffset=8 xadvance=25 page=0 chnl=0
char id=97 x=334 y=44 width=30 height=30 xoffset=2 yoffset=19 xadvance=28 page=0 chnl=0
char id=98 x=82 y=160 width=32 height=40 xoffset=0 yoffset=9 xadvance=29 page=0 chnl=0
char id=99 x=318 y=160 width=26 height=30 xoffset=2 yoffset=19 xadvance=26 page=0 chnl=0
char id=100 x=82 y=118 width=32 height=40 xoffset=2 yoffset=9 xadvance=30 page=0 chnl=0
char id=101 x=260 y=160 width=28 height=30 xoffset=2 yoffset=19 xadvance=27 page=0 chnl=0
char id=102 x=304 y=118 width=24 height=40 xoffset=2 yoffset=9 xadvance=18 page=0 chnl=0
char id=103 x=2 y=94 width=32 height=44 xoffset=2 yoffset=14 xadvance=30 page=0 chnl=0
char id=104 x=120 y=76 width=36 height=40 xoffset=1 yoffset=9 xadvance=32 page=0 chnl=0
char id=105 x=200 y=234 width=18 height=38 xoffset=2 yoffset=11 xadvance=16 page=0 chnl=0
char id=106 x=178 y=160 width=20 height=46 xoffset=-5 yoffset=12 xadvance=14 page=0 chnl=0
char id=107 x=82 y=76 width=36 height=40 xoffset=1 yoffset=9 xadvance=31 page=0 chnl=0
char id=108 x=200 y=192 width=18 height=40 xoffset=1 yoffset=9 xadvance=15 page=0 chnl=0
char id=109 x=82 y=44 width=52 height=30 xoffset=2 yoffset=19 xadvance=49 page=0 chnl=0
char id=110 x=182 y=44 width=38 height=30 xoffset=2 yoffset=19 xadvance=34 page=0 chnl=0
char id=111 x=230 y=160 width=28 height=30 xoffset=2 yoffset=19 xadvance=28 page=0 chnl=0
char id=112 x=340 y=76 width=32 height=40 xoffset=1 yoffset=18 xadvance=30 page=0 chnl=0
char id=113 x=306 y=76 width=32 height=40 xoffset=2 yoffset=18 xadvance=28 page=0 chnl=0
char id=114 x=200 y=160 width=28 height=30 xoffset=2 yoffset=19 xadvance=25 page=0 chnl=0
char id=115 x=346 y=160 width=24 height=30 xoffset=3 yoffset=19 xadvance=25 page=0 chnl=0
char id=116 x=354 y=118 width=22 height=36 xoffset=1 yoffset=13 xadvance=19 page=0 chnl=0
char id=117 x=260 y=44 width=36 height=30 xoffset=1 yoffset=19 xadvance=32 page=0 chnl=0
char id=118 x=298 y=44 width=34 height=30 xoffset=0 yoffset=19 xadvance=29 page=0 chnl=0
char id=119 x=136 y=44 width=44 height=30 xoffset=0 yoffset=19 xadvance=40 page=0 chnl=0
char id=120 x=222 y=44 width=36 height=30 xoffset=0 yoffset=19 xadvance=31 page=0 chnl=0
char id=121 x=38 y=328 width=36 height=40 xoffset=-1 yoffset=18 xadvance=29 page=0 chnl=0
char id=122 x=290 y=160 width=26 height=30 xoffset=2 yoffset=19 xadvance=27 page=0 chnl=0
char id=123 x=200 y=324 width=14 height=48 xoffset=9 yoffset=10 xadvance=25 page=0 chnl=0
char id=124 x=220 y=260 width=6 height=54 xoffset=12 yoffset=7 xadvance=25 page=0 chnl=0
char id=125 x=200 y=274 width=14 height=48 xoffset=8 yoffset=10 xadvance=25 page=0 chnl=0
char id=126 x=38 y=370 width=28 height=10 xoffset=5 yoffset=8 xadvance=34 page=0 chnl=0
</textarea><br><br>...and neither is it in the precise .txt format you see in the bundled AngelFont fonts (so you can't just change it to .txt and have it work).<br><br>Coronna export: .fnt file is not xml<br>Sparrow export: .fnt file IS xml :D Memory Access Violation :(<br>Unity export: .txt file. Different formatting to examples. (Note that I'd gotten this and the Coronna export mixed up, so I've corrected those references now.)<br>uvCoords (top left) export: .fnt file, not xml.<br>uvCoords (bottom left) export: ditto<br>SpriteKit export: .xml file that IS xml (non surprisingly!) along with a bunch of separate character images. Memory Access Violation if renamed as *.fnt and loaded with LoadFontXml().<br><br>If I've missed something then cool, otherwise bmGlyph users at least have a convertor now :D <br><br></td></tr></table><br>
<a name="2075619"></a>

<a name="2075624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#128">[#128]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try loading the BMFont() .fnt export with the LoadPlain() method instead. (It's in AngelFont-tryouts, which is more recently updated and fixes bugs in the original) <br><br></td></tr></table><br>
<a name="2075623"></a>

<a name="2075655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#129">[#129]</a></td></tr></table></td></tr><tr ><td class="posttext"> Loading a BMFont export from bmGlyph with LoadPlain() gives a memory access violation error when you attempt to use DrawText(). <br><br></td></tr></table><br>
<a name="2075673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#130">[#130]</a></td></tr></table></td></tr><tr ><td class="posttext"> mind giving me an example .fnt file and associated resources so I can test it? <br><br></td></tr></table><br>
<a name="2075679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#131">[#131]</a></td></tr></table></td></tr><tr ><td class="posttext"> Example font: <a href="http://into-games.com/extra/temp/SSPro.zip" target="_blank">http://into-games.com/extra/temp/SSPro.zip</a><br><br>I just dumped it in the AngelFontsTryouts.data folder and altered the code to load it instead of hightower36. Get the error:<br><br><pre class=code>
Monkey Runtime Error : Memory access violation
/Applications/MonkeyPro/modules/mojo/graphics.monkey&lt;496&gt;
/Users/Sledge/Downloads/angelfont-tryouts-master/AngelFont/char.monkey&lt;31&gt;
/Users/Sledge/Downloads/angelfont-tryouts-master/AngelFont/angelfont.monkey&lt;343&gt;
/Users/Sledge/Downloads/angelfont-tryouts-master/AngelFontTryouts.monkey&lt;34&gt;
/Applications/MonkeyPro/modules/mojo/app.monkey&lt;65&gt;
</pre><br><br>This is with 76d on Mavericks.<br><br>If I run my convertor over the .fnt file then change the loading code to...<br><pre class=code>
plainfont = New AngelFont()
plainfont.LoadFont("SSPro")
</pre><br>...all is well. <br><br></td></tr></table><br>
<a name="2075758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#132">[#132]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I'll check it out soon.<br><br>Edit:  The problem stems from how AngelFont loads images.  It presumes certain things about the file naming scheme which it shouldn't -- I'm thinking this was either a hack originally, or was made this way because there was no metadata tag to specify paged images correctly originally.  I will fix this and post again when an update is available. <br><br></td></tr></table><br>
<a name="2075714"></a>

<a name="2075713"></a>

<a name="2075711"></a>

<a name="2075720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#133">[#133]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've pushed a commit through to angelfont-tryouts which should fix your issue.  Please let me know if you have any other problems loading the file.<br><br><a href="https://github.com/nobuyukinyuu/angelfont-tryouts" target="_blank">https://github.com/nobuyukinyuu/angelfont-tryouts</a> <br><br></td></tr></table><br>
<a name="2075753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#134">[#134]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent stuff -- seems to work perfectly. Thanks for that! <br><br></td></tr></table><br>
<a name="2081989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#135">[#135]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there anyway to add an outline around my text? Or should this be done when generating the bitmap font? <br><br></td></tr></table><br>
<a name="2082009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#136">[#136]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do it in the initial generation of the font (bake it in), otherwise you can do a silly trick:   Render the font multiple times in a very tight circle from your render origin after using SetColor() to your border outline color, then render the font without tinting on top.  This can be very slow on some targets, but it will provide a pretty convincing illusion of an outline.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Method DrawFontOutline:Void(font:AngelFont, txt:String, x:Float, y:Float, r = 0, g = 0, b = 0, thickness:Float = 2, segments = 8)
		SetColor(r, g, b)
		For Local i:Int = 0 Until segments
			Local xo:Int = Cos(i * (360 / float(segments))) * thickness
			Local yo:Int = Sin(i * (360 / float(segments))) * thickness
			font.DrawText(txt, x + xo, y + yo)
		Next
		SetColor(255, 255, 255)
End Method
</textarea><br><br>The result:  <img src="http://i.imgur.com/NT0hfPH.png"> <br><br></td></tr></table><br>
<a name="2082007"></a>

<a name="2082006"></a>

<a name="2082008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ben</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#137">[#137]</a></td></tr></table></td></tr><tr ><td class="posttext"> Remember though that using SetColor for the html5 target will have a big impact upon performance. <br><br></td></tr></table><br>
<a name="2082061"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#138">[#138]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, I would rather bake it into the font than do it via code. I also want to change the color of my font but I don't know how to do this with BMFont (from angelcode) <br><br></td></tr></table><br>
<a name="2082080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#139">[#139]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can take the image from BMFont and paint it in various ways if you want, though it can be a bit of a pain doing it character by character. <br><br></td></tr></table><br>
<a name="2082082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#140">[#140]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh that is depressing, I have been downloading all these bitmap font generator programs for Windows.<br>"SpriteFont 2.0" seems to be a nice one, but it only exports to xml :( <br><br>To bad there isn't a windows one that supports coloring and effects like that and exports to plain text as well so I can use LoadPlain. <br><br></td></tr></table><br>
<a name="2082097"></a>

<a name="2082098"></a>

<a name="2082102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#141">[#141]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want simple functionality like that without having to open up Photoshop, I suggest looking at FontMachine by ziggy.  Some people here use it and are pleased with it.  AngelFont / BMFont are free, so you gotta work a little harder to get what you want out of it :)<br><br>I made a program a long, long time ago that did something similar to FontMachine's standalone product called <a href="http://community.clickteam.com/threads/63226-CharImages-Font-Maker?highlight=charImages" target="_blank">CharImages Font Maker</a> , but the format it exports is not compatible with AngelFont today, and was limited to TrueType fonts and unicode 5, so I wouldn't recommend it these days.  BMFont 1.14 is what I use now to render out glyph shapes, and Photoshop does the rest.<br><br>Edit:  I'd be willing to put the code up on GitHub if anyone's interested in getting it to export AngelFont compatible metadata. <br><br></td></tr></table><br>
<a name="2082127"></a>

<a name="2082128"></a>

<a name="2082129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >erebel55</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#142">[#142]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Nobuyuki.  I was trying to take this <a href="http://www.fontspace.com/allen-r-walden/african" target="_blank">font</a> and change the white inner section to be yellow (instead of white), that is it.  However, when I try and use BMFont to export the bitmap font it either adds alpha to the inner white section or some other type of antialiasing.  I have tried all different values for bit depth, A, R, G, and B within the export settings.  This is making it difficult to edit within Paint.NET to change the colors.  All I want BMFont is to generate the font with the black outline and white fill as it is seen in the link I showed. Then I would replace the white with yellow within Paint.NET. <br><br></td></tr></table><br>
<a name="2082130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#143">[#143]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> To bad there isn't a windows one that supports coloring and effects like that <br></div><br>Why not write one yourself?  That kind of program is typically pretty interesting.  After you do that you can write a routine that replaces all internal pixels of the image (all the pixels that don't have a neighbor that is the background color) with a color like fullbright magenta.  Then you put something in your text display routine that cycles or otherwise changes the fullbright pink to some other color, at runtime... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
