<!DOCTYPE html><html lang="en" ><head ><title >ReadPixels Offscreen</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ReadPixels Offscreen</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >ReadPixels Offscreen</a><br><br>
<a name="2044701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PoliteProgrammer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all, I have a quick question regarding ReadPixels(). I am happily able to create an image on the fly using something like:<br><pre class=code>
local img:Image = CreateImage(w,h)
local buffer:Int[] = New Int[w*h]
ReadPixels(buffer,0.0,0.0,w,h)
img.WritePixels(buffer,0.0,0.0,w,h)
</pre><br>But how do I create an image bigger than DeviceWidth()xDeviceHeight() using the same technique? My first attempt was to play with SetScissor(), but that didn't seem to do anything.<br><br>Does anyone have any advice? :) <br><br></td></tr></table><br>
<a name="2044700"></a>

<a name="2044699"></a>

<a name="2044698"></a>

<a name="2044715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You cannot without external libraries because of the way Mojo works. <br><br></td></tr></table><br>
<a name="2044742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> not strictly true you can write a work around.<br><br>CreateImage can create images larger than the screens width and height. You can only read the current screen rectangle using ReadPixels. To copy a larger area requires a trick:<br><br>To get a larger copy of the entire game field you would need to divide the world into screen rectangles and then render your world many times at that grid location x,y. Each time you read the pixels you would add them the to the created images stored pixel array.<br><br>Inserting the read pixels is easier than it sounds, only need to worry about correctly offsetting each row. This is done by incrementing the startIndex by width. This will now point to x, y + 1.<br>I posted some code that does similar:<br><br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=3495" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=3495</a> <br><br></td></tr></table><br>
<a name="2044741"></a>

<a name="2044744"></a>

<a name="2044745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PoliteProgrammer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, so the idea is just to create the image piecewise and tack it all together? Thanks, just gave it a try and it works fine!<br><br>So, I guess this leads me to another question; I am using this sort of thing to construct a large, scrollable pre-rendered map for my game. This large image creation stuff therefore has to be done ONCE before loading a selected game level, but can't be done in OnCreate() because the levels are defined on-the-fly. Is there a way to get it to work on this stuff in the background while a simple, but dynamic 'loading' screen plays in the foreground?<br><br>In other words, I don't want to have a black screen for several seconds while it generates the map. <br><br></td></tr></table><br>
<a name="2044751"></a>

<a name="2044752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> In other words, I don't want to have a black screen for several seconds while it generates the map.  <br></div><br>Yea this is a problem, I overcame it in some of my projects by converting my images to text files containing pixel data. I loaded the pixel data into a created Image which meant I had access to the pixel data inside OnCreate bypassing the need for a special loading screen (which is not possible without hacking around under the hood).<br><br>It does require a bit of work to get it all working (making a tool to convert images to txt data, saving and loading) but it gives a huge amount of flexibility and control. I also compressed my data and managed to more than half the file size of the same image png format! <br><br></td></tr></table><br>
<a name="2044750"></a>

<a name="2044766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I also compressed my data and managed to more than half the file size of the same image png format! <br></div><br><br>You managed to get a reliable compression advantage of 50% over PNG via text representation and compression? Care to go into more detail? That's more than a little eyebrow raising unless there's something specific about the nature of your images that you're taking advantage of. <br><br></td></tr></table><br>
<a name="2044768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shinkiro1</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That would be really impressive.<br>I mean png does some really clever checking under the hood and then evaluates the best compression model to use, even replacing whole blocks of pixels with mathematical representations. <br><br></td></tr></table><br>
<a name="2044788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was suprised, I finally opted for base64 as I use it for other parts of my framework and it is 40% smaller than the corresponding png file which is great. This is the case for the tests I have done which don't go above 128 px * 128 px. I was pretty surprised to see the smaller file size as well, almost expected them to be twice as big! (I was playing around with dynamically changing colour palettes to add more variety with less artwork!) The pngs were default settings saved from Photoshop so they may not be optimised at all which is why I'm seeing these results! <br><br></td></tr></table><br>
<a name="2044787"></a>

<a name="2044784"></a>

<a name="2044783"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
