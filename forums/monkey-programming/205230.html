<!DOCTYPE html><html lang="en" ><head ><title >Draw concave polygon</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Draw concave polygon</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Draw concave polygon</a><br><br>
<a name="2057788"></a>

<a name="2057789"></a>

<a name="2057790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> DrawPoly is designed for convex polygons.<br>I need a idea, how i can draw a concave polygon.<br><br>For my game, i can split such polygon in "quads"<br>So drawing in not the problem.<br>But i have another problem.<br><br>I have some space between quads, if they are rotated/scaled.<br>i can see some "background-lines" on Flash and HTML,<br>due to antialiasing effects<br><br>i can also not size up quads,<br>because i use half-transparent alpha <br><br></td></tr></table><br>
<a name="2057793"></a>

<a name="2057794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think there's an easy way to avoid the background lines, unless you do some custom work in the back buffer to make images of polygons.<br><br>Have you looked to see if there's a native way of drawing concave polygons on your target? <br><br></td></tr></table><br>
<a name="2057797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://monkeycoder.co.nz/Community/posts.php?topic=1994" target="_blank">http://monkeycoder.co.nz/Community/posts.php?topic=1994</a><br><br>Tada! :) <br><br></td></tr></table><br>
<a name="2057831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @JIM<br>your code do not work:<br>i get this result on HTML (firefox)<br><br><a href="http://www.pasteall.org/pic/show.php?id=51707" target="_blank">http://www.pasteall.org/pic/show.php?id=51707</a><br><br>do you see, lines between triangles? <br><br></td></tr></table><br>
<a name="2057832"></a>

<a name="2057833"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to draw all the triangles in a single path to avoid the canvas anti-aliasing causing problems (although behaviour across browsers may not be consistent).<br><br>Some code was posted here that you can repurpose:<br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=2469" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=2469</a> <br><br></td></tr></table><br>
<a name="2057841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> it is funny, that DrawPoly work with concave and convex polys on HTML &amp; Flash. This is by design of it - and should work for every browser.<br><br>But on DX/OpenGL this is not by design - so concave poly is wrong and must splitted to tris. Interesting is also, that on DX/OpenGL i do not see space between polys. <br><br></td></tr></table><br>
<a name="2057879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, in my game I actually left the DrawPoly as it was for HTML5, and used my function for all other targets.<br><br>The difference is that in HTML5, antialiasing is enabled by default, whereas on the others it is disabled. Those errors are caused by antialiasing and the code muddy_shoes posted should do the trick in case you want to enable antialiasing on other targets. <br><br></td></tr></table><br>
<a name="2057882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dragon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> i tested on XNA/Glfw/Android with AA and without,<br>and it works fine...<br><br>FF/HTML5 do AA a bit different <br><br></td></tr></table><br>
<a name="2057895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The difference is the lack of batching in the HTML5 mojo code. When you draw polygons they are rendered immediately and AA applied at that point. As such there's no way for the renderer to know that it's creating a seam. The code I referenced includes all the triangles in one path, so AA occurs on the whole render and internal seams can be eliminated. <br><br></td></tr></table><br>
<a name="2057896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul - Taiphoz</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not done anything in 3D yet but the sounds increadibly inefficient would it not be many times faster to only apply the aa etc once the rendering is done or is there a reason marks done it like that ? <br><br></td></tr></table><br>
<a name="2057897"></a>

<a name="2057898"></a>

<a name="2057899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> The Canvas renderer doesn't "naturally" batch primitives, while OpenGL pushes that model. Things like varying the colour across primitive batches isn't possible in basic HTML5 rendering but can be done in OGL.<br><br>Shifting the HTML5 renderer to webGL would probably make it possible to smooth out these differences but any other/future target that focused on immediate rendering rather than batched would have the same issue. Not sure what Flash does behind the scenes for instance or if Stage3D would be a possible route to homogenising the behaviour.<br><br>Oh, and this isn't a 3D issue. Most people who spot the issue are doing 2D with vector graphics/tiled engines. <br><br></td></tr></table><br>
<a name="2057970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think Monkey needs a VectorImage object just like it has an Image object.<br><br>This will allow the best drawing method for each target.<br><br>I've experimented quite a bit with this and I think a VectorImage/Shape thingy will be the best solution, because the optimal drawing methods are very different across targets.<br><br>Hopefully this could open up for SVG support too.<br><br>I also think it would be a good base for vector fonts.<br><br>I'm currently using hacked in versions of:<br><pre class=code>
DrawTriangles(verts:Float[],indexes:int[]) '( for concave polyguns )
DrawTrinagleStrip(verts:Float[]) '( for thick lines )
</pre><br>It works ok. but it does not make much sense on HTML5 where it's faster to use other methods. <br><br></td></tr></table><br>
<a name="2057972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> VectorImage looks like a good idea. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
