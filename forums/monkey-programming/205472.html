<!DOCTYPE html><html lang="en" ><head ><title >Baking the Backgrounds</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Baking the Backgrounds</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Baking the Backgrounds</a><br><br>
<a name="2061148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm interested in baking background images constructed from tilemaps into large images that I can scroll for parallax, with the middleground image being partly transparent so the background can show through.  I want to eke out every bit of speed that I can so I don't want to draw two layers of background tiles.<br><br>Does anyone have any suggestions and/or code for doing this?  I figured I would draw the background to a buffer, then use grabimage to pull the whole thing into a texture. <br><br>Thoughts? <br><br></td></tr></table><br>
<a name="2061168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ElectricBoogaloo</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would theoretically work, but not well on all targets.<br>From my experience with Androids, the Alpha channel isn't kept when using GrabImage, (although I've not used it for a while, recent updates might've fixed that) so your parallax might not end up looking too good on Android targets.<br><br>Best bet, give it a whirl, see how well it works, but be sure you test it on as many things as possible.<br><br>(Don't forget to try switching Windows to 16-bit mode. That's buggered a few of my graphical effects up!) <br><br></td></tr></table><br>
<a name="2061177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> GrabImage is fine with alpha; I take it you mean ReadPixels.  I suspect the issue is that the Android back buffer may only have 24-bits in the first place; there's no reason for it to be transparent.  So you'll have to get the alpha data into your int array in some other way, e.g. by passing the alpha channel as a separate image. <br><br></td></tr></table><br>
<a name="2061338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gerry, can you expand on that at all?<br><br>I just need to throw together a prototype and experiment, I suppose.  I don't have easy access to an Android device-- how good is the Android emulator? <br><br></td></tr></table><br>
<a name="2061339"></a>

<a name="2061340"></a>

<a name="2061341"></a>

<a name="2061342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure how much, if at all, this will ultimately benefit you. If you create huge images to move about you'll be limited by texture memory and risking texture thrash. I suppose it depends on how large these composite images that you intend to create are going to be and how your scrolling works.<br><br>Have you just tried rendering the tiles and found that it's amazingly slow? On OGL targets mojo batches the render operations if the texture doesn't change so as long as you're using sensible texture atlases it really shouldn't be slow. With batched vertex loads it mostly comes down to straight fill-rate and that's the same for tiles or one image. <br><br></td></tr></table><br>
<a name="2061363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Have you just tried rendering the tiles and found that it's amazingly slow?  <br></div><br><br>No.  :(  I just assumed that it would be too slow.  Other people who have tried multi-level parallax (like the guy at OrangePixel) have said that it is too slow but probably I should try it.  If it is too slow there are a few ways I could drastically lower the number of draws by batching multiple tiles onto smaller images that would then form part of a mosaic.<br><br>Edit:  I am actually getting a pretty good framerate.  I presume that it's faster with fewer draws and that the tile size shouldn't matter too much so I will create tiles twice the dimensions with all 2x2 permutations and then use those to construct backgrounds. <br><br></td></tr></table><br>
<a name="2061343"></a>

<a name="2061360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> zoqfotpik wrote:<br><br>"Gerry, can you expand on that at all?"<br><br>I'm just going by what people have posted in threads that say, for example, "Cls doesn't clear the back buffer to transparency, but fills it with the background colour".  I'm guessing that the reason is that on some systems there is no such thing as a back buffer alpha, i.e. you are drawing to a 24-bit buffer.  If this is the case, you'll need to get alpha into your arrays in some more convoluted fashion than a simple draw and read.<br><br>"I just need to throw together a prototype and experiment, I suppose. I don't have easy access to an Android device-- how good is the Android emulator?"<br><br>It works okay for me (except no sound, and sometimes a program I send it just doesn't start up for no apparent reason) but is very slow on my i3 laptop.  Things can run at 3 FPS that run fine on a cheap tablet.  I still use it for testing non-time critical stuff, though, because I don't need to plug anything in.<br><br>So you can test your algorithms okay, and if they work at a fifth of the speed you need, you can be reasonably optimistic that they will work fine on a real machine. <br><br></td></tr></table><br>
<a name="2061364"></a>

<a name="2061365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zoqfotpik</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see what you're getting at about the alpha, I will have to experiment.  Currently I am indeed getting good framerates just by drawing tiles and there are a number of ways I can batch tiles to decrease number of draws.<br><br>One other thing about the emulator: how well does it predict readability on various devices?  I have 15,000 downloads on one of my previous games but I've received zero feedback from any users and I really don't know if it looks ok on android devices.  I suppose it must be all right.<br><br>What would you suggest for a cheapie android pad? <br><br></td></tr></table><br>
<a name="2061376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are lots of tablets for $100 now and they will do the job unless you need high resolution.  Check out eBay or your local electronic store.<br><br>I would guess that performance will be about the same on a cheap 800x480 as on an expensive hi-res tablet anyway, and you can use the emulator to play with different layouts.<br><br>In my experience, the real thing tends to look better than the emulated version. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
