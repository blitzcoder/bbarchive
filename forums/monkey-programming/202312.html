<!DOCTYPE html><html lang="en" ><head ><title >Accelerometer - Get corrected values when tilted?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Accelerometer - Get corrected values when tilted?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Accelerometer - Get corrected values when tilted?</a><br><br>
<a name="2022595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi folks,<br><br>I am cracking my brain and can't seem to find a simple solution.<br><br>If your device lays flat infront of you, using the Y value is no problem at all. But if you have a more natural, means tilted starting position of your device, then you will head straight into the simple problem, that once the Y value reaches it maximum value (around 0.999), it goes back. Evne if oyu tilt the device further. I know that I need to take Z into the calculation somehow. But I can't find the solution.<br><br>Does anyone has solved this problem where you "calibrate/store" the values at start of a game/level and then correctly calculate the difference for Y and X each time you retrieve these values? If yes, I would be very happy to know how you did it.<br><br>Cheers<br>Michael <br><br></td></tr></table><br>
<a name="2022750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No one ran into this problem before and has a solution. <br><br></td></tr></table><br>
<a name="2022755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't fully understand your problem, but you can try 2 things:<br><br>1. Maybe accel values are incremental (like the name says). So your code should go like X_angle += AccelX() instead of X_angle = AccelX()<br><br>2. Maybe they are absolute, but not normalized. In this case, you need to make a vector out of the acceleration values and normalize it.<br><br>Sure hope that helps <br><br></td></tr></table><br>
<a name="2022764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Aman</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I do not get the problem you're having but I will tell my experience with Accelerometer.<br><br>What I did is set default values that works for me and provide an option for the users to calibrate the device and save the new default values. I used all  3 axes. I also provided a virtual control option for those who don't like tilting their devices.<br><br>I got great feedback on the game. Some are using the virtual controls but the majority are using tilt and they love it.<br><br>My only problem is that AccelX() &amp; AccelY() are reversed on either android or iOS so I had to make AccelH() and AccelW() that return the proper value depending on the Target. <br><br></td></tr></table><br>
<a name="2022765"></a>

<a name="2022766"></a>

<a name="2022767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless you get really wild with your device (drop, throw, kick) you are effectively only measuring gravity on all three axis (how much x, y and z axis are pointing directly towards the ground) with an accelerometer.<br><br><img src="https://developer.apple.com/library/ios/documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/Art/acceleration_axes.jpg"><br><br>Check the apple docs for some more interesting reading<br><br><a href="https://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MotionEvents/MotionEvents.html" target="_blank">https://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/MotionEvents/MotionEvents.html</a><br><br>My experience is unless you force user to hold device face up only x tilt is that useful. In Driller Bunny I reversed the x value if z was negative (user is playing lying on their back).<br><br>Detecting change in the y tilt is useful but I could never get to feel right. Having user dictate a rest angle didn't work that well either. <br><br>The ultimate problem is of course when the device is vertical (tilt y = 1) the other sensors are effectively gimble locked (x and z lock to 0) so you need compass or gyroscope support to do anything creative at that orientation. <br><br>As these sensors are now standard on most devices it is possibly time mojo got support also. <br><br></td></tr></table><br>
<a name="2022779"></a>

<a name="2022780"></a>

<a name="2022781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dopeyrulz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> WP7 Mango includes reading the compass and gyroscope (if included):<br><br><a href="http://msdn.microsoft.com/en-us/library/hh202968(v=vs.92).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/hh202968(v=vs.92).aspx</a><br><br>For first gen devices, the gyroscope is simulated using readings from the compass and accelerator:<br><a href="http://pocketnow.com/windows-phone/windows-phone-gyroscope-support-not-for-first-gen-wp7-hardware" target="_blank">http://pocketnow.com/windows-phone/windows-phone-gyroscope-support-not-for-first-gen-wp7-hardware</a><br><br>I posted some info for the accelerator recently - will have a look at what's required for reading the compass and gyroscope. <br><br></td></tr></table><br>
<a name="2022778"></a>

<a name="2022796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks folks for all the input.<br><br>@JIM, the problem is about virtual calibration. Not everyone wants to play the game with tilt controls only with an orientation where Z = -1. The problem with the accelerometer values is that they have a natural range of 1 to -1. You can see values higher than this but it is rare. When you tilt the device more and more in one direction, at one point the corresponding axxis values becomes smaller again. But depending on where your initial (calibrated) value is, you still need it virtually to grow. I went myself now with a brute force method for portrait mode. Once it is done, I will post the result here. <br><br></td></tr></table><br>
<a name="2022798"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I understand it now. Perhaps matrices can help here:<br><br>Use a matrix to define your default calibration (define the axes when you start the game for example).<br><br>Then when the device is tilted, you get the new matrix based on current coordinates and multiply it with the inverse of your calibration matrix.<br><br>That will give you the current device orientation relative to your original calibration. Now you can just test for the angle of the axes. Unless the device is tilted 180 degrees from the original calibration, you should get accurate results.<br><br>If however you want it to work with more than 180 (I'd like to see that person playing the game :)) ) you can remember the angle somehow (if differences are greater than 90 degrees from last frame, then use the angle as 360 - angle) or anything similar.<br><br>After thinking about it a little bit, I came up with this: Keep a variable for "Rolls". Start with zero. If current angle is positive and the next one negative, increment. If current angle is negative and next one positive, decrement. Angle = current angle + 360 * Rolls.<br><br>Let me know if this works :) <br><br></td></tr></table><br>
<a name="2022906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> That sounds good JIM. I will try that in the next days. <br><br></td></tr></table><br>
<a name="2060248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fly-Games</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anyone solved this problem? <br><br></td></tr></table><br>
<a name="2060405"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> This issue is dependent on orientation.  Really, I believe that we'd all benefit from functions that read from the gyro rather than the accelo, or use the gyros/global gravity sensor to modify accelo values, since the accelo values are locked to an orientation.<br><br>I don't know about ios, but for android it <i>shouldn't</i> be that hard to hack up the mojo commands for accel and get gyro data instead.  I may look into this, if samah and revills haven't already incorporated it into diddy.  (If they have, you should just nick the source code from diddy!) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
