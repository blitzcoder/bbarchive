<!DOCTYPE html><html lang="en" ><head ><title >How to set a variable to the nearest multiple</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to set a variable to the nearest multiple</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >How to set a variable to the nearest multiple</a><br><br>
<a name="2068860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello everybody.<br>I was wondering how is the best way to set a variable to the nearest multiple of another variable.<br>I will describe the scenario that is giving me troubles...<br>I am making a grid based game, where all the actors can move in every direction on a 32*32 grid; the actors can move on the grid in a fluid motion, but they are restricted by the amount they can move each turn (hope i described it properly).<br>When an actor gets shot it freeze in place.<br>The problem is, if actor 1 shoots actor 2, the collision can happen when actor 2 is still moving, so actor 2 will freeze in mid air...<br>Is there a way to tell actor 2 that when shot it's position has to be the nearest multiple of 32?<br>I tried to put an extra condition in the collision detection function (like "check collision only if actor is not moving") but the check , due to the speed of the bullets, can be skipped entirely if the collision happen when the actor has just moved, and by the time the 32 pixel movement stops, the bullet has gone past the actor detection zone (hope i made it clear).<br>So i thought it would be much easier to check for collision and replace the collided actor in the nearest grid (i haven't actually implemented a grid class, i just make the movements step by step). <br><br></td></tr></table><br>
<a name="2068866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> probably something like:<br><pre class=code>x = x - (x Mod 32)</pre> <br><br></td></tr></table><br>
<a name="2068865"></a>

<a name="2068882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It sounds like the actors are moving automatic from one grid to the next...<br>And it sound like you would like to have, that the actor should continue the move it makes at this moment.<br><br>So create a property flag of the actor "WillBeDead%" and set it to TRUE, when the actor is shoot. Next time, when the actor reaches its grid position, stop the movement.<br><br><br><br>Another idea is to move it quickly the rest of the way to the next grid position:<br><pre class=code>TargetX=(ActorX+SpeedX*32) Mod 32
DiffX=TargetX-ActorX
ActorX= ActorX + DiffX

TargetY=(ActorY+SpeedY*32) Mod 32
DiffY=TargetY-ActorY
ActorY= ActorY + DiffY</pre> <br><br></td></tr></table><br>
<a name="2068950"></a>

<a name="2068951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Edit, I made a hames of my calculations, of course the standard method is simply x -= x Mod 32.  However, the method described below still works:<br><br><br>Since 32 is a power of two, you can use the following bit of trickery instead:<br><br><pre class=code>
x = ( x + 16 ) &amp; $FFFFFFE0
</pre><br><br>It runs fast and works for positive or negative values of x, but it does depend on x being an integer.<br><br>$FFFFFFE0 is how -32 is written in hexadecimal.  By doing a bitwise and operation with it, you chop off the least significant binary digits of the result, i.e. 16/8/4/2/1, which for integers is the same as a sign-independent mod 32. <br><br></td></tr></table><br>
<a name="2068891"></a>

<a name="2068889"></a>

<a name="2068890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks!<br>I tried using mod and it worked, but i haven't thought about giving it an extra flag.<br>Ill try both solutions and see which one gives the better results.<br>Thank you Gfk and Midimaster. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
