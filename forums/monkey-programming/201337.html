<!DOCTYPE html><html lang="en" ><head ><title >Byte datatype</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Byte datatype</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Byte datatype</a><br><br>
<a name="2012080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amnesia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>I was wondering if it was possible for Monkey to have a 8-bit integer (usually known as Byte) datatype. Used in the correct places Bytes may greatly reduce the memory footprint of our games broadening the range of devices our games could run on.<br><br>By example, I usually work with maps which are stored as a matrix of tile indexes (inside a tileset). My tilesets are restricted to contain no more than 255 tiles (reserving 1 index for "no tile").<br><br>While I can of course use Ints (and I'm currently using them) the memory usage gets large with ease. Maps have 4 layers (which is a reasonable number of layers to store information for most type of 2D games).<br>For a 256x256 map, the number of cells stored is 256*256*4 = 262144 (counting all layers). Using bytes for each cell, that is exactly 256KB. The Monkey Docs state that Ints are "at least 32 bits", so if we use Ints to store the cell information we have 4 bytes per cell. What could have been 256KB (storing cells as Bytes) becomes *at least* 1MB in size.<br><br>Of course, there are other cases when bytes are more than enough for a task. In fact, in some cases it may become desirable to use them.<br><br>Please bear in mind that not all Android phones are high-end devices with plenty of RAM.<br><br>So, anyone else thinks this would be a great addition to Monkey? <br><br></td></tr></table><br>
<a name="2012082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> do all the target languages support bytes? <br><br></td></tr></table><br>
<a name="2012084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> While I thing having a Byte datatype could be great, in the scenario you're describing,a 65536 length string of 8 bits chars could contain your "bytes" array, and you can check string[index] to get the numeric value (byte) of the given "char" position. Unless Mark has added unicode support to strings in Monkey, this should bring a nice mem reduction at (I think) zero performance cost. You could even read the whole map in a single pass. <br><br></td></tr></table><br>
<a name="2012085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amnesia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Java has byte, C++ has unsigned char. Javascript doesn't have different types of "Number" so I assume bytes there should be handled in a similar way as Integers. <br><br></td></tr></table><br>
<a name="2012089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suppose you could handle bytes as Ints in javascript 'behind the scenes' and switch to byte if the target language has them. <br><br></td></tr></table><br>
<a name="2012092"></a>

<a name="2012093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amnesia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> About using strings, already tried for other part of the code, but it looked like Strings in Monkey have some sort of encoding support at least in some platforms like iOS where they are mapped to NSString. On iPhone when I tried reading string[n] I got nothing like what it was supposed to be there, although the same did work on the other platforms (but I can't assure they were single-byte readings at all.. or stored as a single byte per character). <br><br></td></tr></table><br>
<a name="2012094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe Monkey has partial unicode support then. Anyway, you could pack your bytes in integers, each 4 bytes into an integer variable, but I supose you've already done this. <br><br></td></tr></table><br>
<a name="2012099"></a>

<a name="2012100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amnesia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's not a good solution at all since Integers seems to be of different size depending on the platform. Also, additional bitwise operations (like masking and shifting) are required to then read the values.<br>I'm using Ints for each cell currently, but as I said, it's using more memory than it should.<br><br>EDIT: I really tried a few options but found no simple solution that provides a good implementation. It's not a big deal anyway. The game will use more memory and that's about it.<br>The problem here is not what I wanted the Bytes for, but the advantages/disadvantages of having them implemented on Monkey. <br><br></td></tr></table><br>
<a name="2012117"></a>

<a name="2012118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Java has byte, C++ has unsigned char... <br></div><br>Unfortunately, Java does not have an unsigned keyword - all numeric types are inherently signed.  This is why when you read a byte from an InputStream, you actually get an int (since the byte type can't represent values 128-255).<br><br>Trying to do any kind of fancy conversion in the translated code would become a nightmare to maintain and would probably end up being a performance hit if you're trying to use signed bytes across your entire app. <br><br></td></tr></table><br>
<a name="2012197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amnesia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, forgot about java types being signed. A bit of casting (to int) may be needed when evaluating expressions and that may become messy.<br><br>I guess I'll try to optimize the map representation, but that's another story... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
