<!DOCTYPE html><html lang="en" ><head ><title >Create Enemy Path / AI</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Create Enemy Path / AI</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Create Enemy Path / AI</a><br><br>
<a name="2059751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Monking</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm new to Monkey Programming so by now I've no idea what to start with.<br>I read the book and get the simple knowledge.<br><br>But now, I wish to study my first game, simplest one, maze like Pacman.<br>Well, I face the problem of creating enemy.<br><br>There are two type of enemy, first is move with path, <br>eg: this enemy is move from position 0,0 to 128,0 then move back and vice versa<br><br>The second enermy could be A.I, like finding a way to go..and when meet player..he will chase it..some sort of that..<br><br>I'm using fantomEngine..is that fantomEngine can do some sort like this..<br>as I tried to create 2 classes, like for example<br>Class game Extends App and another Class Enermy..<br>it would not draw out the image..<br>so I was running out of idea..<br><br>Any Relevant example ?? Example codes is preferable, Thank You. <br><br></td></tr></table><br>
<a name="2059764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I haven't the time to post any code but <a href="http://gameinternals.com/post/2072558330/understanding-pac-man-ghost-behavior" target="_blank">GameInternals</a> should give you some ideas as it's what they did with pacman.<br><br>My advice to anyone new to Monkey ( or any programming language ) is not to use any engine until you can write some code of your own as it can take some understanding when things go wrong and make it had for anyone who hasn't got said engine to help out..<br><br>An object that moves back and forth is one of the easiest things to do.<br>You have a direction value that you flip when your object have reached it's objective.<br><br>give x a start position say 400<br>give d a direction as -5<br><br>in a loop<br>if x &lt; 200 Or x &gt; 600 Then d = -d<br>x+=d<br><br>Problem you will find with this approach is when you try and go diagonally. Then your better off using vectors. Have a look on google there should be plenty of tutorials out the for sprite movement that can be easily adapted to work with monkey.<br><br>Check out these <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=3318" target="_blank">Invader Jim tutorials</a>. <br><br></td></tr></table><br>
<a name="2059761"></a>

<a name="2059757"></a>

<a name="2059763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Definitely watch the excellent tutorial videos by Invader Jim:<br><br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=3318" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=3318</a> <br><br></td></tr></table><br>
<a name="2059767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> fantomEngine supports something like a pacman game definately very well with its path finding methods and the waypoints.<br><br>If you want to create own classes for each different object, you can do this with customclasses (user defined classes) which extend ftObject. There is already an example shipping with fE that shows how to use a cusotm class but I will upload a multiclass example soon too. <br><br></td></tr></table><br>
<a name="2059768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> And please post the code you have so me or someone else can try to help you. <br><br></td></tr></table><br>
<a name="2059771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is an example with multiple classes and custom objects:<br><br><a href="http://www.fantomgl.com/?p=521" target="_blank">http://www.fantomgl.com/?p=521</a> <br><br></td></tr></table><br>
<a name="2059773"></a>

<a name="2059774"></a>

<a name="2059775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Supertino</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fantastic A* *path finding) tutorial here <a href="http://www.policyalmanac.org/games/aStarTutorial.htm" target="_blank">http://www.policyalmanac.org/games/aStarTutorial.htm</a> very useful for maze/pacman games - if you can't follow this you'll struggle with AI. <br><br></td></tr></table><br>
<a name="2059779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Monking</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you for everyone comments,<br>I guess I've more to learn..<br><br>By the way, respond to MikeHart,<br>I should upload my demo coding..here:<br><a href="https://www.dropbox.com/s/9gbr65kazvyllk2/First_Maze.zip" target="_blank">https://www.dropbox.com/s/9gbr65kazvyllk2/First_Maze.zip</a><br><br>I'm using the latest fantomEngine from here:<br><a href="http://code.google.com/p/fantomengine/" target="_blank">http://code.google.com/p/fantomengine/</a><br><br>Well, before viewing the coding of this demo..<br>I suggest anyone who downloaded has some preparation to view this horrible coding..<br><br>Well, maybe dawlane is right..<br>I should learn the basic instead of using any engine..<br><br>I know my coding and programming skill is horrible,<br>so I can accept any suggestion.<br>Any suggestion is appreciated.<br>Thank you very much. <br><br></td></tr></table><br>
<a name="2059790"></a>

<a name="2059791"></a>

<a name="2059792"></a>

<a name="2059793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> One suggestion I would make is modularise your code as it does three things<br><br>1) Makes it easier to read<br>2) Easier to mantain<br>3) Easier to debug.<br><br>And always use Strict<br>Try and keep your game enemies, players, maze/levels, etc as separate classes from your main Game class. All your main game class needs to do is control when to do what. <br><br></td></tr></table><br>
<a name="2059816"></a>

<a name="2059820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> And another thing learn about functions methods and return types<br><br>Something that wont work but should give you some ideas. Can't give a proper example as I'm on a machine that has got monkey installed.<br>In One file called sprites.monkey<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
Import mojo
Class CSprite
    Global sprite_list:= New List&lt;CSprite&gt;
    Field x:Int
    Field y:Int
    Field image:Image
    
    Method New( x:Int = 0, y:Int = 0 ) ' = makes sure that the constructor has values
           Self.x = x
           Self.y = y
    End Method

    Function CreateSprite:Void( x:Int, y:Int, image:Image )
        Local sp:CSprite = New CSprite( x, y )
        sp.image = image
        sprite_list.AddLast(sp)
    End Function
   
    Function CreateSprite:CSprite( x:Int, y:Int, image:Image )
        Local sp:CSprite = New CSprite( x, y )
        sp.image = image
        Return sp
    End Function

    Function Update:Int()
        ' Do Some Code
        'Call a Method
        ' If task didn't go as planed then exit with a error or whatever
        If Not Self.Task() Then Return 1
        Return 0
    End Function

    Method Task:bool()
       'Do some checking code Return False if failed
       Return True
    End Method

   Method DrawSprite:Void()
      'Draw a sprite
   End Method

   Function DrawSprites:Void()
       For Local i:CSprite= EachIn sprite_list
         i.DrawSprite()
       Next
   End Function

End Class</textarea><br><br>In monkeygame.monkey<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
Import mojo
Import sprites

Class Game Extends App
    Field sp:CSprite

    Method OnCreate:Int()

        sp = CSprite.Creat( 20, 20, sprite_image ) ' Return a sprite
        CSprite.Create( 20, 20, sprite_image )  ' Add a sprite to the sprite list

        Return 0
    End Method

    Method OnUpdate:Int()

        If CSprite.Update &gt; 0
           'Do Some Code
        EndIf

        Return 0
    End Method
       
    Method OnRender:Int()

        Self.sp.DrawSprite()
        CSprite.DrawSprites()

        Return 0
    End Method

End Class</textarea> <br><br></td></tr></table><br>
<a name="2059794"></a>

<a name="2059795"></a>

<a name="2059796"></a>

<a name="2059798"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello.<br>Here there some code for a simple "follow path" movement type.<br>The path is stored in an array that you can modify (just change the values!).<br>It has some simple object structures and object creation, also it will react to user input to change speed and curve approximation.<br>It has some math but hopefully you will understand it.<br>I don't use strict mode yet, and it's pretty well explained (hopefully).<br>This can be the basis for a simple AI, it's not a pathfinding routine but its a start!<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
#rem
simple waypoint movement,
10/4/2013
#end

Import mojo

Global max_path_points:int = 20
Global pathx:Int[max_path_points]				' set up 20 path points
Global pathy:Int[max_path_points]				' -1 because arrays start at zero
Global Gspeed:Float
Global CSmoothness:Int

Function Main()
	New Game
End Function
	
Class Game Extends App
	Field movement_started:Bool
	Method OnCreate()
		CSmoothness = 3
		Gspeed = 4
		movement_started = False
		arrayFilling()
		SetUpdateRate(60)
	End Method
	Method OnRender()
		Cls
		DrawText "Waypoints player....for testing enemy movements!Space to start, enter to stop!", 0, 0
		DrawText "Pressing the right mouse button will create objects!", 0, 20
		DrawText "Press up&amp;down arrows keys To increase/decrease speed", 0, 30
		DrawText "Press right&amp;left arrow keys to increase/decrease curve approximation", 0, 40
		DrawText "Speed: " + Gspeed, 320, 60
		DrawText "Curve smoothness: " + CSmoothness, 400, 60
		draw_path_points()
		enemy.RenderAll()
	End Method
	Method OnUpdate()
		If MouseHit(1) 
			enemy.CreateEnemy(pathx[0], pathy[0])
		EndIf
		
		If KeyHit(KEY_UP) Then Gspeed = Gspeed + 1
		If KeyHit(KEY_DOWN) Then Gspeed = Gspeed - 1
		If KeyHit(KEY_LEFT) Then CSmoothness = CSmoothness - 1
		If KeyHit(KEY_RIGHT) Then CSmoothness = CSmoothness + 1

		If KeyHit(KEY_1) Then enemy.CreateEnemy(pathx[0], pathy[0])
		If KeyHit(KEY_SPACE) And movement_started = False Then		'space bar start the movement
			movement_started = True								   	'set flag for movement started
		End If
		If KeyHit(KEY_ENTER) Then									'enter stop the movement
			movement_started = False								'clear flag for movement
		End If
		If movement_started = True Then enemy.UpdateAll()					'start updating the object position
	End Method
End Class

Class actor
	Field nextx:Float		'next x position
	Field nexty:Float		'next y position
	Field posx:Float		'x coord
	Field posy:Float		'y coord
	Field speed:float		'speed
	Const Lbound:Int=0		'left boundary
	Const Rbound:Int = 640	'right boundary
	Const Ubound:Int=0		'up boundary
	Const Dbound:Int=480	'down boundary
End Class

Class enemy Extends actor
	Global nemico:= New List&lt;enemy&gt;			'list that holds all enemy instances
	Field curveSmoothness:Int	'the curve approxximation smoothness
	Field ANGLE:Float			'used to check for position
	Field dist:Float			'distance between current and next coords
	Field ang:Float				'used to check for path points	
	Field current_path:Int		'current path node pointer
	Method init(x:Float, y:Float)
		current_path = 0
		curveSmoothness = CSmoothness
		posx = x 	'x position is equal from start position,otherwise everything will start at 0
		posy = y 	'same as above
		nextx = pathx[current_path]
		nexty = pathy[current_path]
		speed = Gspeed
	End Method
	Method update()
		curveSmoothness = CSmoothness				'we have to check the curve smoothness for every update
		speed = Gspeed								'same for speed
		If current_path = max_path_points - 1		'when the path reaches the max path
			current_path = 0						'this repeat the movement by resetting the node to the first one
			nextx = pathx[current_path]				'these lines set the target path to the first one
			nexty = pathy[current_path]				'same as above
		EndIf
		If current_path &lt; max_path_points - 1		'if target path is less than maximum
			ang = ATan2(pathy[current_path + 1] - pathy[current_path], pathx[current_path + 1] - pathx[current_path])	'arc tangent of the distance between current and next nodes
			nextx = nextx + Cos(ang) * speed			'update target x pos based on speed
			nexty = nexty + Sin(ang) * speed			'update target y pos based on speed
			If Abs(nextx - pathx[current_path + 1]) &lt; 15 And Abs(nexty - pathy[current_path + 1]) &lt; 15	'when the absolute value of the 2 points is less than 15
				current_path = current_path + 1													'the current path become the next one
				nextx = pathx[current_path]																'the target pos become the current node
				nexty = pathy[current_path]																'same as above
			EndIf
		EndIf
		ANGLE = ATan2(nexty - posy, nextx - posx)			'arc tangent of the distance between target node and current position
		dist = Sqrt( (posx - nextx) * (posx - nextx) + (posy - nexty) * (posy - nexty))		'dist is the square root of the difference between position and target node
		posx = posx + (Cos(ANGLE) / curveSmoothness) * (dist / curveSmoothness)				'update posx based on smoothness
		posy = posy + (Sin(ANGLE) / curveSmoothness) * (dist / curveSmoothness)				'update posy based on smoothness
	End Method
	
	Method render()
		DrawCircle posx, posy, 20									'draw the object
	End Method
	
	Function CreateEnemy(x, y)
		Local n:enemy = New enemy()
		n.init(x, y)
		nemico.AddLast(n)
	End Function

	Function UpdateAll()
		For Local n:= EachIn nemico
			n.update()
		Next
	End Function

	Function RenderAll()
		For Local n:= EachIn nemico
			n.render()
		Next
	End Function
End Class

Function draw_path_points()
	Local loop
	For loop = 0 To max_path_points - 1									'loop through all the path points
		DrawRect pathx[loop], pathy[loop], 2, 2
		If loop &lt; max_path_points - 1 Then								'do this loop while the loop value is less than the highest path value
			DrawRect pathx[loop + 1] - 1, pathy[loop + 1] - 1, 2, 2				'draw a rectangle at the path point so its central
			DrawLine pathx[loop], pathy[loop], pathx[loop + 1], pathy[loop + 1]	'draw a line between the current point and the next one
		End If
	Next
End Function

Function arrayFilling()
	pathx[0] = 31
	pathy[0] = 54
	pathx[1] = 82
	pathy[1] = 127
	pathx[2] = 171
	pathy[2] = 145
	pathx[3] = 294
	pathy[3] = 138
	pathx[4] = 362
	pathy[4] = 163
	pathx[5] = 420
	pathy[5] = 221
	pathx[6] = 425
	pathy[6] = 295
	pathx[7] = 388
	pathy[7] = 311
	pathx[8] = 330
	pathy[8] = 274
	pathx[9] = 316
	pathy[9] = 219
	pathx[10] = 338
	pathy[10] = 176
	pathx[11] = 401
	pathy[11] = 112
	pathx[12] = 271
	pathy[12] = 59
	pathx[13] = 191
	pathy[13] = 91
	pathx[14] = 133
	pathy[14] = 187
	pathx[15] = 136
	pathy[15] = 276
	pathx[16] = 58
	pathy[16] = 316
	pathx[17] = 33
	pathy[17] = 229
	pathx[18] = 13
	pathy[18] = 119
	pathx[19] = 12
	pathy[19] = 76
End Function


Function round:Int(_value:Float)	'it rounds a variable to the nearest integer (ex:1.3 to 1)
	Return _value + (Sgn(_value) * 0.5)
End Function
</textarea> <br><br></td></tr></table><br>
<a name="2059799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mteo77</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for my english but i am tired and ready to hit the sack... <br><br></td></tr></table><br>
<a name="2059819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Monking</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay thanks, I try my best. <br><br></td></tr></table><br>
<a name="2059830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> When doing AI it's easiest to start with a really simple one (e.g. never change direction and turn at random at any corner).  Then you can ensure that everything is working before slotting in more elaborate ones. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
