<!DOCTYPE html><html lang="en" ><head ><title >Adding an object to a list while looping the list</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Adding an object to a list while looping the list</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Adding an object to a list while looping the list</a><br><br>
<a name="2025257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if I have another error, or if this is something I don't understand about the For Eachin loop so it'd be nice to know how this works.<br><br>I'm looping through a list of objects. Whilst inside the loop, I'm occasionally needing to add another object to the list. I'm not sure how that affects the current loop. Will it now just continue to the end, including the newly added object, or only as far as the object which was the final object when the loop started? <br><br></td></tr></table><br>
<a name="2025264"></a>

<a name="2025265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> specifically List&lt;type&gt; would be myList.AddLast(object) or myList.AddFirst(object) to add objects. You could also add objects using nodes. It updates instantly, so therefore you could loop to infinity.<br><br>BUT-- here's something interesting. a one-item list does not repeat infinitely using FOREACH, but a 2-item list does.<br><br><pre class=code>
Local mylist:List&lt;Int&gt; = New List&lt;Int&gt;
Local q:Int=1
mylist.AddLast(q)
'mylist.AddLast(q) ''will run until q&gt;100
		
For Local me:= Eachin mylist
		
	Print q
		
	mylist.AddLast(q)
	q +=1
		
	If q&gt;100 Then Exit
Next
</pre> possible bug? possible feature? a REPEAT-UNTIL loop would be able to get around this anomaly. <br><br></td></tr></table><br>
<a name="2025271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a matter of where the enumerator "pointer" is when you do the add. <br><br>The list enumerator updates the pointer on entering the loop as you retrieve the next item. When there's only one item, that pointer is immediately set to the special "head" node. That means that adding to the list won't extend the loop because the addition is behind the enumerator. When you have more than one item, AddLast is adding after the enumerator's current item, so it's possible to keep laying track in front of the train, as it were.<br><br>I guess it's a bug of the "possibly unexpected side-effect" variety. You could argue that it's just a quirk of the implementation though. <br><br></td></tr></table><br>
<a name="2025281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since Diddy's ArrayList uses an indexed array rather than node objects, it's impossible for the enumerator to keep track of where it's up to if the list is modified between calls to HasNext/NextObject.  That's why I put a modification semaphore on it, and it raises an error if you try to use it after the list has been modified.<br><br>Slightly annoying, but it's the price you pay for using an indexed array.  You can still remove items by manually holding the enumerator object and calling Remove() to remove an object from the ArrayList (the object from the most recent call to NextObject). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
