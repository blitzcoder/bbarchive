<!DOCTYPE html><html lang="en" ><head ><title >Synced actions with audio?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Synced actions with audio?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Synced actions with audio?</a><br><br>
<a name="2045674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone know for sure if Monkey has enough by default to reliably sync actions with how long audio has been playing on a timeline? We have done our own tests and they are inconclusive.<br><br>Like with any rhythm based game the beats you hit line up with a song. <br><br></td></tr></table><br>
<a name="2045675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Monkey can't offer exact equivalence across targets for audio latency (or other low-level functions). Some platforms might be fine, others not. <br><br></td></tr></table><br>
<a name="2045681"></a>

<a name="2045682"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Does anyone know for sure if Monkey has enough by default to reliably sync actions with how long audio has been playing on a timeline? <br> <br></div><br><br>I doubt it will matter how long the music has been playing. The question is on which targets does MusicState return an honest value so you can timestamp when exactly the music began playing out the speakers (after network, decompression lead times and system latency are taken into account). <br><br></td></tr></table><br>
<a name="2045699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> in my DUETT project ( <a href="http://www.monkeycoder.co.nz/Apps/app.php?id=182" target="_blank">http://www.monkeycoder.co.nz/Apps/app.php?id=182</a> ) I recognized (and you can hear it) that the HTML5 target has big problems in starting sounds at a certain point. Sometimes it sounds exact sometimes not! We recognized differences of 100msec. I seems not to be a fixed latency, but a hickup, that sometimes happens.<br><br>The Android target is much better.<br><br>For long audios I can conclude, that a already running sound never broke on any target. So you only have the problem of max 100msec offset at the start moment. <br><br></td></tr></table><br>
<a name="2045701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Midimaster: The Android target is much better. <br></div><br>Huh?  Android is terrible.  The getCurrentPosition() method on MediaPlayer can't be trusted at all (I've seen differences up to 600ms), and the latency with playing sound samples is atrocious.<br><a href="http://code.google.com/p/android/issues/detail?id=3434" target="_blank">http://code.google.com/p/android/issues/detail?id=3434</a><br><br>On the other hand, I've found the HTML5 audio to be quite good.  Check out the Diddy storyboard example.  I can't vouch for its latency since I haven't tested that, but it has to be more reliable than Android. <br><br></td></tr></table><br>
<a name="2045700"></a>

<a name="2045703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems to be the death of a rhythm based game which relies on correct timing in relation to the music then. :( <br><br></td></tr></table><br>
<a name="2045711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Soap: Seems to be the death of a rhythm based game which relies on correct timing in relation to the music then. :( <br></div><br>Which is why there aren't many of them, and partly why I gave up on my osu! port. <br><br></td></tr></table><br>
<a name="2045728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> thats exactly what we trying to do: rhythm based games. But I still believe in browser developers. They decided to improve the audio drivers.<br><br>On my Android target (a small, slow Samsung with 2.3) I can say, that it is good enough.<br><br>And if CPU speed rises, those problems getting smaller over device generations. <br><br></td></tr></table><br>
<a name="2045744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I think maybe later this year even it may be more viable. Things change fast. <br><br></td></tr></table><br>
<a name="2045746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you could make a rhythm-based game using sounds instead of music.  What I mean is that the music track would be broken down into short sounds which are assumed to fire at the time they are played. <br><br></td></tr></table><br>
<a name="2045748"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> That would work for tracker based music, but there would still be problems if you wanted to do anything complex.<br><br>The plan b we are taking is to divorce the patterns from the music completely. And if that doesn't work out to being fun we have a plan c too.<br><br>Maybe later this year if things are different we will risk having them in sync - or at least closer to being more viable. Chrome auto updates and that's the only HTML5 browser we care about, so when it's fixed it will be fixed for everyone, and Android devices break over time and need to be replaced so eventually everyone will be on newer Android versions which also have the problem fixed. <br><br></td></tr></table><br>
<a name="2045752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @gerry<br>I'm only talking about music we diveded into sounds and try to fire them in the right moment. Exactly here we have the problems of different latency from sound to sound. So a beat of four sounds fired at...<br><br>000msec-250msec-500msec-750msec-1000msec<br>...sometimes reaches the ear at...<br>010msec-333msec-510msec-888msec-1010msec<br><br>do you see the always changing latency?<br>+10msec +83msec +10msec +133msec +10msec<br><br>What we can recognize is, if you fire 5 sounds at the same moment, they all have the same latency and reach the ear together.<br><br>What about chrome browsers. Does somebody have experience with sound latency on it? I always test on Firefox. <br><br></td></tr></table><br>
<a name="2045766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Soap</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> We were testing on Chrome and there was up to 100ms latency with playing audio on localhost, and Chrome lied about the audio actually being played - or at least the Monkey language doesn't account for possible latency and says the audio is playing instantly when it is not. I should look into that. It may be that Monkey assumes it is playing instantly but not that the browser actually is playing instantly, and modifications could be made to make tracking more accurate. <br><br></td></tr></table><br>
<a name="2045764"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
