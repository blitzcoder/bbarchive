<!DOCTYPE html><html lang="en" ><head ><title >Render once to a bitmap, then re-render</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Render once to a bitmap, then re-render</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Render once to a bitmap, then re-render</a><br><br>
<a name="2028958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's hard for me to put this question into words...<br><br>It it possible in Monkey to render tiles to a Bitmap, then just re-render that 1 bitmap over and over again?<br><br>On my older Android games I made in Java, I was able to load up my tile map, then create a single Bitmap from those tiles, then I would just render that one bitmap on each render as my background.<br><br>The reason for this is that I have 10x10 tiles, and drawing all 1536 of them on every render is going just a little too slow.  But if I could render them to a single Bitmap, and just re-render that 1 bitmap over and over again it would go really fast. <br><br></td></tr></table><br>
<a name="2028960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rex Rhino</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> As far as I understand it, no... There is no way of rendering to an image and redrawing. <br><br></td></tr></table><br>
<a name="2028961"></a>

<a name="2028962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dang.  I feel like I could put together a module to do this for Android from my previous experience, but I'd be at a loss of all other targets.<br><br>The only other thing I was wondering is if I could push a render onto a Matrix of some kind, and then re-pop that Matrix each time before I do my other drawing.  Or am I not understanding how Matrix's work? <br><br></td></tr></table><br>
<a name="2028963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rex Rhino</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is a significant restriction, no doubt. My guess is that because there is no way to do it in HTML5, it wasn't included for any platform. <br><br></td></tr></table><br>
<a name="2028967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> My guess is that because there is no way to do it in HTML5, it wasn't included for any platform.  <br></div><br>you are correct (although the w3c is looking into this):<br><a href="http://stackoverflow.com/questions/2688987/imagedata-of-an-externally-loaded-image" target="_blank">http://stackoverflow.com/questions/2688987/imagedata-of-an-externally-loaded-image</a><br><br>But... if you are OK with only Opengl targets, you can use databuffers for your raw data and upload this to a texture and render a quad. <br><br></td></tr></table><br>
<a name="2028965"></a>

<a name="2028966"></a>

<a name="2028968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I am only concerned with iOS and Android at the moment.  I wish I understood what uploading to a texture and rendering to a quad was :)  I'll search the forums....  Do you know of anywhere this was previously discussed? <br><br></td></tr></table><br>
<a name="2028970"></a>

<a name="2028971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can do this with HTML5 as long as you don't mean rendering to an actual image that you save as a file. HTML5 allows you to create more than one canvas and render one canvas onto another.<br><br>If anything, Android is the trickier platform as you can't trust that the OpenGL implementation supports render to texture. You can use the non-OGL graphics API instead, but that's too slow to do much image construction on the fly. <br><br></td></tr></table><br>
<a name="2028996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I wish I understood what uploading to a texture and rendering to a quad was :) <br></div><br><br>see monkey/bananas/mak/opengltest (in latest monkey) <br><br></td></tr></table><br>
<a name="2029171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You can do this with HTML5 <br></div><br>you're right! getImageData() setImageData(). Even IE supports this. I'm confused, not sure why there's no ReadPixel() and WritePixel() in monkey now... <br><br></td></tr></table><br>
<a name="2029183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rex Rhino</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> you're right! getImageData() setImageData(). Even IE supports this. I'm confused, not sure why there's no ReadPixel() and WritePixel() in monkey now...  <br></div><br><br>Yep. And I double checked, and it is possible in XNA for Xbox360 as well.<br><br>I think it would probably be good for us to respectfully and enthusiastically encourage Mark to work on that feature. This is something that can drastically improve performance... especially on low-end mobile devices. We *NEED* this feature. <br><br></td></tr></table><br>
<a name="2029197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It has been mentioned/requested multiple times in various forms since Monkey was released. <br><br></td></tr></table><br>
<a name="2029198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> This post derailed a little from what I was originally asking, though I would love a get/set pixel option :)<br><br>I was just wondering if it was possible to turn a bunch of tiles in one image into another single image created dynamically for re-rendering, or to be able to create an off-screen canvas from those sprites/images that I could re-draw over and over again.<br><br>In Java, I would create an empty Bitmap.<br><br>Draw my tiles to that Bitmap.<br><br>Then onDraw, I would just re-draw that pre-created Bitmap instead of redrawing every tile every time.  <br><br>Was hoping for something similar being possible in Monkey town. <br><br></td></tr></table><br>
<a name="2029199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> That is what I'm talking about. Render to texture, render to bitmap, off-screen buffer with grab/copy. They're all routes to being able to create composite images at runtime and then re-use them.<br><br>Some of the dozen or so previous mentions of wanting some form of this feature:<br><br><a href="http://monkeycoder.co.nz/Community/posts.php?topic=612" target="_blank">http://monkeycoder.co.nz/Community/posts.php?topic=612</a><br><a href="http://monkeycoder.co.nz/Community/posts.php?topic=2321" target="_blank">http://monkeycoder.co.nz/Community/posts.php?topic=2321</a><br><a href="http://monkeycoder.co.nz/Community/posts.php?topic=1369" target="_blank">http://monkeycoder.co.nz/Community/posts.php?topic=1369</a> <br><br></td></tr></table><br>
<a name="2029202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Those posts are all from 8 months to almost a year ago, so I don't know if they are still relevant.  <br><br>I was searching for combining images, or pre-rendering, of which none of these posts showed up, so my terminology must be wrong I guess.<br><br>Those threads seem to have been left hanging too, I can't tell if it's possible with the new functionality that's been added to Monkey since then or not.<br><br>I looked at the examples in Bananas, and I didn't see where textures were combined into a single texture to be re-drawn.<br><br>I did just find this thread linked to from another:<br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=263" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=263</a><br><br>It too is from a year ago but Mark says it'll never happen.  Wish I had seen that 6 months ago when I started using Monkey :(  Things change tho, hoping for a miracle. <br><br></td></tr></table><br>
<a name="2029203"></a>

<a name="2029204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> They're relevant in that they show that the feature has been repeatedly requested already. You're right that the response you link to from Mark is probably the only response that has ever occurred.<br><br>The fact is that it can be done but implementations end up bound with the existing mojo library and therefore can't be distributed. My own libraries include this functionality and I'm sure several other people have done it in some way too but, for whatever reason, it's not something that Mark wants to put into the standard package. <br><br></td></tr></table><br>
<a name="2029206"></a>

<a name="2029207"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> One of the reasons read/write pixels is not in there is that mojo loads image files and then flushes them from memory. They are retained by the graphics chip. Saves on memory.<br><br>With the opengl.monkey and LoadImageData(), you could add a function in mojo that takes a DataBuffer and creates a surface. This would be your best bet for image manipulation/image combination and keeping in line with Mark's original intentions.<br><br>It would be similar to each native gtkSurface's LoadSurface, but with data (from the databuffer) instead of the path. You'd also have to create a public function from the monkey side as well.<br><br>I'll see if I can't convince him to make DataBuffer available to all targets, and add a function in mojo, but it'll take time to produce *convincing* examples (as I did with monkeyGL). <br><br></td></tr></table><br>
<a name="2029205"></a>

<a name="2029208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would have thought that the utility of this is pretty obvious. It's useful for on-the-fly construction of game elements (e.g. different equipment on your RPG avatar). Also, as benmc is talking about here, it's a way of speeding up rendering by constructing a composite image once and then stamping it out repeatedly, e.g. <a href="http://www.stickydesigns.com/monkey/offscreen/MonkeyGame.html" target="_blank">http://www.stickydesigns.com/monkey/offscreen/MonkeyGame.html</a> <br><br></td></tr></table><br>
<a name="2029209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >benmc</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @muddy_shoes is the off-screen buffering of text example a custom hack you made to mojo or is it already possible? <br><br></td></tr></table><br>
<a name="2029210"></a>

<a name="2029213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's my own fork of mojo that allows you to define off-screen buffers.<br><br>Edit: And I've changed the example to colorise the text and make the potential speed difference clearer. <br><br></td></tr></table><br>
<a name="2029585"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OvineByDesign</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats perfect - just need one for IOS and Android :)<br><br>/StuC <br><br></td></tr></table><br>
<a name="2029595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Aman</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> InvaderJim created something useful and similar to what you are asking but it had the same problem as muddy_shoes. Although it also sounds really useful, it won't be of any use to us unless Mark implement them in the official version of mojo.<br> <br><a href="http://monkeycoder.co.nz/Community/posts.php?topic=2687#27108" target="_blank">http://monkeycoder.co.nz/Community/posts.php?topic=2687#27108</a> <br><br></td></tr></table><br>
<a name="2029597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> DataBuffers and LoadImageData. All targets are capable of this and this would allow us to do what we're after.<br><br>It's in opengl, but needs to be in the rest. <br><br></td></tr></table><br>
<a name="2029613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OvineByDesign</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Id be happy with it just being in IOS/Android/Windows Mobile ! actually IOS would just do :)<br><br>I understand why people keep their routines close to their chests - just hope one day it can be released to the masses<br><br>/StuC<br>www.ovine.net <br><br></td></tr></table><br>
<a name="2036306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @muddy_shoes<br><br>your demo...<br><br><a href="http://www.stickydesigns.com/monkey/offscreen/MonkeyGame.html" target="_blank">http://www.stickydesigns.com/monkey/offscreen/MonkeyGame.html</a> <br><br>...of rendering text to an image is perfect. I need something like this for speeding up performance in my music education games. Here I often have the problem of displaying changing text elements (f.e. chord of a song) together with low latency music output. This is not possible with the classical way of dispalying the text letter by letter.<br><br>Do you see a chance for adding your code as a module? What about android target? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
