<!DOCTYPE html><html lang="en" ><head ><title >Adding to float gives inaccurate results?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Adding to float gives inaccurate results?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Adding to float gives inaccurate results?</a><br><br>
<a name="2089764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have declared a float...<br>Global gasSale:Float = 0.0<br><br>In my update loop under certain circumstances, I will increment this variable like this...<br>gasSale += 0.4<br><br>or like this...<br>gasSale = gasSale + 0.4<br><br>Both giving the result of this in the first iteration...<br>0.40000000596046448<br><br>Is this common core math?<br><br>Lol, jk, but am I missing something? <br><br></td></tr></table><br>
<a name="2089766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pharmhaus</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Is this common core math?<br> <br></div><br>Yes, Float is never precise. This is not only true for Monkey X but for every other language too.<br>The tiny value differences are most of the time irrelavant except for networking and fast cycles that could go crazy.<br>You only need to be careful with = because it might not work as expected. <br><br></td></tr></table><br>
<a name="2089765"></a>

<a name="2089768"></a>

<a name="2089772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol, ok<br>I've read about it before in other languages, but never ran into it so blatantly like this.<br><br>What I don't understand is how adding 0.4 can lead to this though since it shouldn't be rounding or leading to an excessively long float requiring some kind of rounding.<br><br>So would a double type lead to this kind of inaccuracy? <br><br>Thanks for the info.<br>I'll see what kind of work around I can use.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="2089790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, testing this in Java produced these results...<br>tFloat = (float) (tFloat + 0.4);<br>tDbl = tDbl + 0.4;<br>System.out.println("tFloat: "+tFloat);<br>System.out.println("tDbl: "+tDbl);<br><br>Starting game...<br>tFloat: 0.4<br>tDbl: 0.4<br>tFloat: 0.8<br>tDbl: 0.8<br>tFloat: 1.2<br>tDbl: 1.2000000000000002<br>tFloat: 1.6<br>tDbl: 1.6<br>tFloat: 2.0<br>tDbl: 2.0<br>tFloat: 2.4<br>tDbl: 2.4<br>tFloat: 2.8000002<br>tDbl: 2.8<br>tFloat: 3.2000003<br><br>So it seems that both data types produce inaccurate returns.<br>I get the same results using Float in MonkeyX since double is not available. <br><br>This is hard for me to understand why something so simple can lead to these kinds of outcomes. <br><br></td></tr></table><br>
<a name="2089810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's how floats are.  They have two parts, a binary part that represents a number, and an exponent that it is multiplied by.  Not all numbers can be represented, just a sample of values which get further apart as the value increases.<br><br>Doubles use 64 bits instead of 32, so they are much more accurate.  They put some of the extra bits into storing the exponent, so they have a wider range too.  But no matter how big the float is, the issue will always be there.<br><br>In the old days, people were taught never to treat floats as exact, and always use integers when exact numbers are required.  For example, if you were writing code to take account of currency in a bank, you would use a long integer to track every cent.  And you would never simply test equality between two floats.  I think people do the latter now because it seems to work for smallish integers.  But down the line it can cause problems.<br><br>Your 0.4 is not all that inaccurate; it is correct to better than one part in ten million. <br><br></td></tr></table><br>
<a name="2089839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xyle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the input!<br><br>I really did quite a bit of reading. I've always heard about the inaccuracy but never ran into it, of course I'm getting old and can't really remember if I intentionally stayed away from floats or not over the past 10 years. I believe I normally used ints.<br><br>I just can't grasp that just adding 4 tenths to a number can cause these kinds of numbers to jump around. Its just... weird for such a small number.<br><br>Thanks again! <br><br></td></tr></table><br>
<a name="2089840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Welcome to the wonderful world of signs, exponents, mantissas and values. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
