<!DOCTYPE html><html lang="en" ><head ><title >External Library Integration inside Mojo</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >External Library Integration inside Mojo</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >External Library Integration inside Mojo</a><br><br>
<a name="2030037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> We have not found a way to integrate certain libraries into Monkey on iOS (as a specific example) that require access to this that are inside mojo.<br><br>For example some libraries require that one implements an Interface on the ViewController (iOS). So the way we solved this was to manually edit the translated code. Which works, but it is crazy since all changes are overwritten every time and the code cannot be reused - so it needs to be copied or rewritten every compile (on that target).<br><br>Is there any possibility to work around this? It really hampers our ability to use external libraries.<br><br>We are using external libraries. Such as Chartboost (which unfortunately requires access to the ViewController) and I assume it would benifit everyone if there was a way we could create a module or so for this, but since it requires changing the translated code, that is not possible.<br><br>This is a big time-obstacle in implementing 3rd party things. <br><br>Please any help appreciated! <br><br></td></tr></table><br>
<a name="2030039"></a>

<a name="2030040"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gekkonier</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you considered to create an own build chain?<br>I think with a good scripting language (just think about ruby, especially rake) it should be easy to first build with the monkey tools and then alter the source automatically? <br><br></td></tr></table><br>
<a name="2030047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using an a simple external tool that we build you mean? <br><br></td></tr></table><br>
<a name="2030052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gekkonier</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it's a repetitive task after building in monkey to adjust the resulting files in exact the same way every time, then it looks like an ideal task for a scripting language like ruby or perl. <br><br></td></tr></table><br>
<a name="2030134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jpoag</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could edit the target source files.<br><br>monkey/targets/ios/main.h(mm)<br><br>Create a patch file from your edits and the original, then whenever you update monkey, patch the target source.  Then every build will generate the modified source. <br><br></td></tr></table><br>
<a name="2030133"></a>

<a name="2030177"></a>

<a name="2030178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure that would work so well for other people using our framework/engine. One benefit of having the engine in a module is so that it can be used in multiple projects on multiple computers using multiple monkey installations.<br><br>I feel like this is a "glitch" in monkey.<br><br>If there was only a way to add these kinds of libraries in Monkey code it would not be a small feature thing, it would be a huge benefit! :)<br><br>Not necessarily because everyone will use it, but because everyone writing a  more complex module could share it with everyone else - meaning that many would benefit from this.<br><br>What I want is both as a module user and module creator to be able to add a module, and that module can (in what ever way) modify the end project automatically so that more complex features "just work" out of the box. <br><br></td></tr></table><br>
<a name="2030176"></a>

<a name="2030183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> This comes up all the time, and it's not an easy issue.  Hacking mojo works okay if you just want to get at something simple for your own code, though it's inelegant.  Your requirement for third party access is more complicated.<br><br>The problem is: how can mojo become infinitely flexible and still exist as a library at all?  There are always going to be some limits.<br><br>I would like for example if mojo had a GetBitmap() function that would return a reference to the drawing surface in each target.  That might be workable (I'm not sure).  But certainly there must be things that you would like to access that only exist in one target, like maybe your ViewController whatever it is.<br><br>Maybe there could be something like GetObjectReference( objectType ) that returns a specific object (objectType is a const or a string) that might or might not exist in every target.  If it doesn't exist in the current target it would return null.  You would have to cast the returned object to whatever it was supposed to be.<br><br>I think we need some brainstorming on how mojo could practically be made more extensible. <br><br></td></tr></table><br>
<a name="2030184"></a>

<a name="2030185"></a>

<a name="2030186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good points.<br><br>Need more brainstorming, both to uncover what the real problem to be solved is and how to solve it.<br><br>Yeah I almost forgot mojo is "only" a module. But that is true. <br><br>The awesome thing would be if a change could be made so that any module could be more flexible in this regard, and mojo could implement that to solve this.<br><br>It feels like it is when inheritance comes into the mix (on the target platform) that things gets more or less annoying. However we cannot do much about the design of the platform target.<br><br>Any suggestions on what exactly mojo or monkey could do? some kind of Translation-Meta-Hooks maybe? <br><br></td></tr></table><br>
<a name="2031002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kalakian</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you considered not using Mojo for iOS?  That may not be an option for you, but thought I'd throw the idea out there.<br><br>Let me explain...<br><br>I'm still quite a newbie to Monkey, but I've got some experience with writing XNA programs.  This has been a bit problematic for me as I find that I'm giving up some features I was used to with XNA, in exchange for the cross-platform functionality Monkey provides.  Yes, I want my cake and to eat it as well ;)<br><br>After spending a bit of time doing some tests and examining the exported XNA code, I've come to the realisation that Mojo is my biggest hurdle (for XNA, not altogether).  My potential solution is to develop a wrapper around the Mojo functionality, but only for non-XNA targets (using the preprocessor).  For the XNA target, I will define the same API as the Mojo wrapper but use External declarations so the "wrapper" is actually defined in native XNA code.<br><br>This, in theory, will allow me to continue using Mojo for platforms I don't have as much knowledge of, while gaining access to the specific features I want from XNA.<br><br>Perhaps this would work for your iOS target?  Like I said, it may not suit what you want to do, but no harm in suggesting it just in case. <br><br></td></tr></table><br>
<a name="2031003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >pantson</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been looking at the auto building of the external files for android. <br>I see that trans would need editing to merge or create xml files and to copy the relevant jars to the libs folder.<br>Maybe this would be the same for other targets.<br>Its also something I will have a look at when I finish the current game. <br><br></td></tr></table><br>
<a name="2031009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I see that trans would need editing to merge or create xml files and to copy the relevant jars to the libs folder. <br></div>Yes. It would be enough if trans was change only with the option to output data that an IDE could hook onto.<br><br><div class="quote"> Have you considered not using Mojo for iOS? <br></div><br>True I do want to eat the cake and still save it for later. I agree mojo is the biggest hurdle, and maybe it is simple enough to just "wrap" things up. That would make little sense in terms of adding External libraries and such, however it is something I have considered for future projects so that I can get better performance (and some features) out of each platform. <br><br>However writing a mojo from scratch is probably easier said than done. Mark is quite skilled if I'd say so myself, and even tough Monkey &amp; mojo isn't perfect yet, it is pretty good :) I mean writing a wrapper for one target is simple, writing it for 7, not so much.<br><br>I'm happy to write external tools to fix things like this. If only trans had more hooks/options for such tools.<br><br><div class="quote"> Its also something I will have a look at when I finish the current game. <br></div>Awesome! Keep me updated! :) <br><br></td></tr></table><br>
<a name="2031008"></a>

<a name="2031007"></a>

<a name="2031044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>&gt; For example some libraries require that one implements an Interface on the ViewController (iOS).<br><br>I think the best way to deal with things like gamecenter/ads/etc that want to mess with the ViewController is to create a custom target.<br><br>This is a little hard to do right now, but could be made easier. One approach I can think of would be to provide support for something like TARGET=... in target CONFIG.TXT files. Trans could then scan for this in all target/ subdirs, allowing you to create 'ios_gamecenter' style targets that can be easily redistributed.<br><br>Trying to 'modularize' ViewController would I think cause more hassles than it'd solve. In fact, I think in general any app related 'singleton' objects like ViewController (and AppDelegate, MonkeyView in Android, more?) are probably better off in the target code, not Mojo, as such objects are  intimately bound to the target (and each other) in fiddly, low level ways.<br><br>Note that I am NOT saying here that Monkey shouldn't support 'libraries/headers etc in modules' or anything like that - it should (and will eventually), but I think this stuff is a special case.<br><br>Another simple-but-flexible tweak for trans I've been thinking about would be for trans to check for a trans.exe inside each target and to use that instead of itself to build! A bit nasty, but it'd at least allow for custom translators etc to be redistributed without the need for an interpreter yet.<br><br>&gt; I would like for example if mojo had a GetBitmap() function that would return a reference to the drawing surface in each target.<br><br>I think this is a different problem - ie: how do you extend Mojo?<br><br>The current situation is that Mojo isn't really extensible, and if you want to use it on a native level you need to hack it! But the alternative (ie: provide a nice API for native Mojo so it can be extended cleanly) kind of involves writing 5+ APIs - not gonna happen sorry.<br><br>But there are probably some additions that could help people at least mix Mojo graphics with 3rd party native code - something like PushState/PopState perhaps? This would allow you to write native graphics code that didn't have to hack Mojo just to draw something.<br><br>Not sure about GetBitmap() - it can mean very different things on different targets and at the moment I'd probably be more comfortable with people just Mojo-hacking. <br><br></td></tr></table><br>
<a name="2031047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kalakian</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ... allowing you to create 'ios_gamecenter' style targets that can be easily redistributed. <br></div><br><br>Are you ok then with us taking an existing target, hacking the code a bit, and redistributing it as a new target?  Not saying that's my plan right now, but it's something to consider rather than by-passing mojo altogether. <br><br></td></tr></table><br>
<a name="2031124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>&gt; Are you ok then with us taking an existing target, hacking the code a bit, and redistributing it as a new target? <br><br>Yes, that's fine - Mojo is the only closed/proprietary part of Monkey. <br><br></td></tr></table><br>
<a name="2031130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But there are probably some additions that could help people at least mix Mojo graphics with 3rd party native code - something like PushState/PopState perhaps? This would allow you to write native graphics code that didn't have to hack Mojo just to draw something. <br></div><br><br>BIG YES Please! :-)<br><br>This is number one on my Monkey wishlist.<br>I'm currently hacking my drawing routines into every new version, and it slows updating to new versions down. <br><br></td></tr></table><br>
<a name="2031958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Definitely please do open up a channel to the mojo graphics innards! I have been dancing around the closed bmax 2d commands for months but there have been times when I am forced to modify the core modules. Monkey needs to lose some of this restriction, otherwise it's a massive pain in the bum!<br><br>At least provide api functions to hook into the protected fields. GetGraphicsContext() GetImageContext(image) or something like that. <br><br></td></tr></table><br>
<a name="2031949"></a>

<a name="2031948"></a>

<a name="2035148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> At least provide api functions to hook into the protected fields. GetGraphicsContext() GetImageContext(image) or something like that.  <br></div><br>+1 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
