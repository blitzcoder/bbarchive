<!DOCTYPE html><html lang="en" ><head ><title >mojo2: MAV error , failing to compile shader.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >mojo2: MAV error , failing to compile shader.</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >mojo2: MAV error , failing to compile shader.</a><br><br>
<a name="2108173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I am converting some code to mojo2 and I get an error in 'glutil.monkey'. It appears that a shader can not be compiled. I was wondering what might be causing this (I have deleted the build directory). I am using 84e and TDM-GCC-64 with Glfw3. My other code and bananas seem to build OK.<br><br>Edit- Line 910 is "New MyApp" from my code. Compiler output is from MinGW32, but it fails the same way on TDM-GCC-64.<br><br><br>Glfw3+Angle<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
TRANS monkey compiler V1.85
Parsing...
Semanting...
Translating...
Building...
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/context.o ../glfw3/src/context.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/init.o ../glfw3/src/init.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/input.o ../glfw3/src/input.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/monitor.o ../glfw3/src/monitor.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/egl_context.o ../glfw3/src/egl_context.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/win32_init.o ../glfw3/src/win32_init.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/win32_monitor.o ../glfw3/src/win32_monitor.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/win32_time.o ../glfw3/src/win32_time.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/win32_tls.o ../glfw3/src/win32_tls.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/win32_window.o ../glfw3/src/win32_window.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/window.o ../glfw3/src/window.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/winmm_joystick.o ../glfw3/src/winmm_joystick.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/stb_vorbis.o ../stb/stb_vorbis.c
gcc  -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610 -c -o build/Debug/stb_image.o ../stb/stb_image.c
g++ -O0 -Wno-free-nonheap-object -I../angle/include -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610  -c -o build/Debug/main.o ../main.cpp
g++ -Wl,--subsystem,windows -L../openal/libs/Win32 -L../openal/libs/Win64 -L../angle/lib -o Debug/MonkeyGame build/Debug/context.o build/Debug/init.o build/Debug/input.o build/Debug/monitor.o build/Debug/egl_context.o build/Debug/win32_init.o build/Debug/win32_monitor.o build/Debug/win32_time.o build/Debug/win32_tls.o build/Debug/win32_window.o build/Debug/window.o build/Debug/winmm_joystick.o build/Debug/stb_vorbis.o build/Debug/stb_image.o build/Debug/main.o -llibEGL -llibGLESv2 -lcomdlg32 -lgdi32 -lOpenAL32 -lws2_32
copy ..\angle\bin\libEGL.dll Debug\
        1 file(s) copied.
copy ..\angle\bin\libGLESv2.dll Debug\
        1 file(s) copied.
copy ..\angle\bin\d3dcompiler_47.dll Debug\
        1 file(s) copied.
Failed to compile fragment shader:
1:	precision mediump float;
2:	#define NUM_LIGHTS 0
3:	#define B3D_ALPHA 1
4:	#define B3D_AMBIENT 1
5:	#define B3D_COLOR 1
6:	#define B3D_TEXCOORD0 1
7:	
8:	/Killing process...
/***** Mojo2 Mega Shader *****
9:	
10:	//make sure shadows are working!
11:	#define DEBUG_SHADOWS 0
12:	
13:	//Apply cheesy_hdr to lighting - slower
14:	#define CHEESY_HDR 1
15:	
16:	//enable ortho lighting - faster + makes lights easier to position
17:	#define ORTHO_LIGHTING 1
18:	
19:	//enable fresnel effect - slower
20:	#define FRESNEL_EFFECT 1
21:	
22:	//enable gamma correction - slower. Don't use yet! Messes up with &gt;4 lights...
23:	#define GAMMA_CORRECTION 0
24:	
25:	#if NUM_LIGHTS &amp;&amp; !defined(B3D_CLIPPOSITION)
26:	#define B3D_CLIPPOSITION 1
27:	#endif
28:	
29:	#if NUM_LIGHTS &amp;&amp; !defined(B3D_VIEWPOSITION)
30:	#define B3D_VIEWPOSITION 1
31:	#endif
32:	
33:	#ifdef B3D_TEXCOORD0
34:	varying vec2 b3d_Texcoord0;
35:	#endif
36:	
37:	#ifdef B3D_COLOR
38:	varying vec4 b3d_Color;
39:	#endif
40:	
41:	#ifdef B3D_VIEWPOSITION
42:	varying vec3 b3d_ViewPosition;
43:	#endif
44:	
45:	#ifdef B3D_VIEWNORMAL
46:	varying vec3 b3d_ViewNormal;
47:	#endif
48:	
49:	#ifdef B3D_CLIPPOSITION
50:	varying vec4 b3d_ClipPosition;
51:	#endif
52:	
53:	//@vertex
54:	
55:	uniform mat4 ModelViewProjectionMatrix;
56:	uniform mat4 ModelViewMatrix;
57:	uniform vec4 ClipPosScale;	//hack to handle inverted y when rendering to display
58:	uniform vec4 GlobalColor;
59:	
60:	attribute vec4 Position;
61:	attribute vec2 Texcoord0;
62:	attribute vec4 Color;
63:	
64:	void main(){
65:	
66:		gl_Position=ModelViewProjectionMatrix * Position;
67:		
68:		gl_PointSize=1.0;
69:		
70:	#ifdef B3D_CLIPPOSITION
71:		b3d_ClipPosition=gl_Position * ClipPosScale;
72:	#endif
73:	
74:	#ifdef B3D_VIEWPOSITION
75:		b3d_ViewPosition=(ModelViewMatrix * Position).xyz;
76:	#endif
77:		
78:	#ifdef B3D_VIEWNORMAL
79:		b3d_ViewNormal=(ModelViewMatrix * vec4( 0.0,0.0,-1.0 )).xyz;
80:	#endif
81:	
82:	#ifdef B3D_TEXCOORD0
83:		b3d_Texcoord0=Texcoord0;
84:	#endif
85:	
86:	#ifdef B3D_COLOR
87:		b3d_Color=Color * GlobalColor;
88:	#endif
89:			
90:	}
91:	
92:	
Monkey Runtime Error : Compile fragment shader failed
C:/MonkeyXPro84e_MX1/modules/mojo2/glutil.monkey&lt;50&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;687&gt;
STOPPED
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;769&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;630&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;589&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;159&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;1322&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;2061&gt;
C:/Programming/phoenix2d - mojo2/phoenixusc.monkey&lt;910&gt;

Done.
</textarea><br><br>Glfw3<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
TRANS monkey compiler V1.85
Parsing...
Semanting...
Translating...
Building...
g++ -O0 -Wno-free-nonheap-object -I../glfw3/include -I../glfw3/src -I../openal/include -I../stb -I../zlib-1.2.8 -I../lpng1610  -c -o build/Debug/main.o ../main.cpp
g++ -Wl,--subsystem,windows -L../openal/libs/Win32 -L../openal/libs/Win64 -o Debug/MonkeyGame build/Debug/context.o build/Debug/init.o build/Debug/input.o build/Debug/monitor.o build/Debug/wgl_context.o build/Debug/win32_init.o build/Debug/win32_monitor.o build/Debug/win32_time.o build/Debug/win32_tls.o build/Debug/win32_window.o build/Debug/window.o build/Debug/winmm_joystick.o build/Debug/stb_vorbis.o build/Debug/stb_image.o build/Debug/main.o -lcomdlg32 -lgdi32 -lopengl32 -lOpenAL32 -lws2_32
Monkey Runtime Error : Memory access violation
C:/MonkeyXPro84e_MX1/modules/mojo2/glutil.monkey&lt;40&gt;
STOPPED
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;687&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;769&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;630&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;589&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;159&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;1322&gt;
C:/MonkeyXPro84e_MX1/modules/mojo2/graphics.monkey&lt;2061&gt;
C:/Programming/phoenix2d - mojo2/phoenixusc.monkey&lt;910&gt;
</textarea> <br><br></td></tr></table><br>
<a name="2108171"></a>

<a name="2108168"></a>

<a name="2108167"></a>

<a name="2108166"></a>

<a name="2108165"></a>

<a name="2108164"></a>

<a name="2108163"></a>

<a name="2108240"></a>

<a name="2108241"></a>

<a name="2108242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apparently you have to create a new canvas in OnCreate(). This will not work with mojo2 and will cause the above error. It might be nice to spit out some error text in console that the canvas context/object has not been created.<br><pre class=code>
Class MyApp Extends App
     Field canvas:Canvas=New Canvas
End Class
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
