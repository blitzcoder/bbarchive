<!DOCTYPE html><html lang="en" ><head ><title >Feature Request: sockets / networking</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Feature Request: sockets / networking</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Feature Request: sockets / networking</a><br><br>
<a name="2015637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought it would be good to get a discussion going.<br><br>At some point in the coming months I want to have a look at wrapping iOS networking code to use in monkey. I already had a look into this and it seems like it will be an interesting project. Now this isn't something that is uncommon, multiplayer is essential for games these days. I really think monkey could benefit if some consideration was taken on adding support for networking/sockets to the mojo framework. <br><br>Naturally html5 sockets are not very well supported but could this not be implemented so that when the browser does not support sockets, simply return null/false/error for the commands. That way at least the game designer can add in a notification to the user to "Please try in a browser that supports sockets". <br><br>I think to cover all bases there would need to be a game match-up API and socket API and then let the programmer do the rest. Maybe the html5 match-up service could use something similar to the gnet system. Naturally iOS could default to the gamecenter service...<br><br>Something like:<br><pre class=code>Local matchup := CreateGameFinder()
If FoundGameServer(matchup)
	Print "Found Game Server: "+GameServerName(matchup)
	Local Socket := CreateUDPSocket(GameServerIp(matchup),GameServerPort(matchup))
	SendInt(Socket,5)
	CloseSocket(Socket)
EndIf</pre><br><br>It could be made more flexible by adding match-up "drivers" e.g. CreateOpenFeintGameFinder() so that future game services could be added. The CreateGameFinder() would use the default match-up driver which is  specific to the target being compiled to...<br><br>This is hopefully similar to the design I will follow and I will have to fill in the blanks for platforms as I release to them. I am by no means an expert in most of the platforms so I suspect my efforts will be very slow in development and probably a bit rubbish. The trouble is I can't afford the time to support such a module and I need to partially hard-code this into my engine. So I wont be much use to the community...<br><br>What are peoples thoughts on a networking API, how should it work? should it be an official module? What are monkeys plans for such a module? <br><br></td></tr></table><br>
<a name="2015636"></a>

<a name="2015635"></a>

<a name="2015627"></a>

<a name="2015628"></a>

<a name="2015626"></a>

<a name="2015625"></a>

<a name="2015624"></a>

<a name="2015622"></a>

<a name="2015620"></a>

<a name="2015621"></a>

<a name="2015619"></a>

<a name="2015618"></a>

<a name="2015617"></a>

<a name="2015615"></a>

<a name="2015616"></a>

<a name="2015632"></a>

<a name="2015633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I will very much need this in the upcoming months as well.<br><br>However I do not want a gnet system. I have not intention to offend Mark or anyone else, but since I built a network library in BlitzMax I know from experience that having bare socket-functionality is enough.<br><br>I don't know how many countless e-mail I got from users who could not get gnet to work, and I myself had problem with it. And I have found that high-level libraries can be nice, they do also limit you a lot. <br><br>So I much prefer if monkey implements just the essentials socket functions. SendTo/Recv UDP and for TCP send/recv. The closer to the bare minimum we can get the better performance and usability will networklibraries built upon it be.<br><br>My view is this. Yes Monkey NEEDS networking - but only very simple stuff. <br><br>Skn3, if Mark does not want to add networking basics to monkey in the foreseeable future then maybe we can work together on this? I can provide an SVN server. I'm happy to share my code public if we do this as some kind of community project. <br><br></td></tr></table><br>
<a name="2015655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TeaBoy</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, PLEASE :o) Monkey NEEEEEEEEEEEEEEEDS this feature! <br><br></td></tr></table><br>
<a name="2015677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just out of curiosity, what are you specifically going to use the networking for?<br><br>I'll use it primarily for remote updating of in-game stuff from my server. <br><br></td></tr></table><br>
<a name="2015701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Two things.<br><br>1) I agree with Tibit that the game-matching is a bad thing to include in your network, unless you want to foot the bill for the infrastructure. You can always use a third party system if you really need it, and if you depend on (for instance) a PHP/MySQL solution, that's not going to work at all on my Google App Engine/BigTable setup.<br><br>2) For the network side of thing, take a look at <a href="http://twistedmatrix.com/trac/" target="_blank">Twisted</a>. While I realize porting that beast to Monkey would be an astronomical (if not impossible) task, you should definitely be inspired by how it works. I mean a library where writing a (simple) server is 20 lines of code? Yes please. I'll take 2. <br><br></td></tr></table><br>
<a name="2015708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That would be awesome!<br><br>Actually I already started a network module: <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=725" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=725</a><br><br>Maybe we could just integrate everything there? I'd like to create some socket communication as well, which won't be available for all targets of course. <br><br></td></tr></table><br>
<a name="2015715"></a>

<a name="2015716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Tibit I would love to say yes but I am hella busy and I think it would unavoidably eat up time in development. I would be happy to try and contribute some code/knowledge/discussions as I go along but I don't think I could be a founder of the project.<br><br><div class="quote"> 1) I agree with Tibit that the game-matching is a bad thing to include in your network, unless you want to foot the bill for the infrastructure. You can always use a third party system if you really need it, and if you depend on (for instance) a PHP/MySQL solution, that's not going to work at all on my Google App Engine/BigTable setup. <br></div><br><br>Yeah it would most definitely be a bad idea to rely on a gnet system as the primary game service, however it would be a good solution for html5. As long as there was a flexible way to add new services that is...<br><br>Xaron, aside from plans etc have you got anything running with sockets? Would be interesting to see your progress. <br><br></td></tr></table><br>
<a name="2015717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> To be honest my only experience with socket programming is using C++ and Windows. Can't be so different on other platforms though. ;) <br><br></td></tr></table><br>
<a name="2015721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If someone is bored, maybe they could create a module for using Pubnub.<br><br>Seems that this could be easily ported/imported.<br><br><a href="http://www.pubnub.com" target="_blank">http://www.pubnub.com</a> <br><br></td></tr></table><br>
<a name="2015931"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I started having a play around today on my lunch break with html5. I have not done any part of the sockets itself, instead was experimenting with how the data could be handled.<br><br>Just playing around for now so its nothing serious! I have been looking at the websockets support:<br><a href="https://developer.mozilla.org/en/WebSockets/WebSockets_reference/WebSocket#send%28%29" target="_blank">https://developer.mozilla.org/en/WebSockets/WebSockets_reference/WebSocket#send%28%29</a><br><br>There is not really a sensible way to handle data yet in javascript. There is a ArrayBuffer object in javascript but that has fixed width (you wouldn't be able to mix bytes, ints and floats in one buffer). There is a DataView object but this is not supported very well so finally the solution is to manage the packing into a string.<br><br>I had started writing a binary packer but found a nice one already done via the interweb!<br><br>sockets.monkey<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">' Module skn3.sockets
'
' Copyright 2011 Jonathan Pittock, all rights reserved.
' No warranty implied; use at your own risk.

#If TARGET&lt;&gt;"html5"
#Error "Mojo is not currently available for target '${TARGET}'."
#End

'import the native code please :D
Import "native/sockets.${TARGET}.${LANG}"

'there finished

Extern

Class Packet="Skn3SocketPacket"
	Method GetLength:Int()
	Method ToString:String()
	
	Method AddByte:Bool(value:Int)
	Method AddShort:Bool(value:Int)
	Method AddInt:Bool(value:Int)
	Method AddFloat:Bool(value:Float)
	Method AddString:Bool(value:String)
End

Function CreatePacket:Packet(size:Int) = "Skn3SocketCreatePacket"

Public

Function Main()
	Local packet := CreatePacket(1024)
	packet.AddByte(255)
	packet.AddByte(128)
	packet.AddByte(64)
	packet.AddShort(12345)
	packet.AddInt(1111234511)
	packet.AddFloat(1.2345)
	
	Print packet.ToString()
End</textarea><br><br>native/sockets.html.js<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">// --- dependancies ---
//+ Jonas Raoni Soares Silva
//@ <a href="http://jsfromhell.com/classes/binary-parser" target="_blank">http://jsfromhell.com/classes/binary-parser</a> [v1.0]
BinaryParser = function( bigEndian, allowExceptions ){
	this.bigEndian = bigEndian;
	this.allowExceptions = allowExceptions;
};
with( { p: BinaryParser.prototype } ){
	with( {p: ( p.Buffer = function( bigEndian, buffer ){ this.bigEndian = bigEndian || 0; this.buffer = []; this.setBuffer( buffer ); } ).prototype } ){
		p.setBuffer = function( data ){
			if( data ){
				for( var l, i = l = data.length, b = this.buffer = new Array( l ); i; b[l - i] = data.charCodeAt( --i ) );
				this.bigEndian &amp;&amp; b.reverse();
			}
		};
		p.hasNeededBits = function( neededBits ){
			return this.buffer.length &gt;= -( -neededBits &gt;&gt; 3 );
		};
		p.checkBuffer = function( neededBits ){
			if( !this.hasNeededBits( neededBits ) )
				throw new Error( "checkBuffer::missing bytes" );
		};
		p.readBits = function( start, length ){
			//shl fix: Henri Torgemane ~1996 (compressed by Jonas Raoni)
			function shl( a, b ){
				for( ; b--; a = ( ( a %= 0x7fffffff + 1 ) &amp; 0x40000000 ) == 0x40000000 ? a * 2 : ( a - 0x40000000 ) * 2 + 0x7fffffff + 1 );
				return a;
			}
			if( start &lt; 0 || length &lt;= 0 )
				return 0;
			this.checkBuffer( start + length );
			for( var offsetLeft, offsetRight = start % 8, curByte = this.buffer.length - ( start &gt;&gt; 3 ) - 1, lastByte = this.buffer.length + ( -( start + length ) &gt;&gt; 3 ), diff = curByte - lastByte, sum = ( ( this.buffer[ curByte ] &gt;&gt; offsetRight ) &amp; ( ( 1 &lt;&lt; ( diff ? 8 - offsetRight : length ) ) - 1 ) ) + ( diff &amp;&amp; ( offsetLeft = ( start + length ) % 8 ) ? ( this.buffer[ lastByte++ ] &amp; ( ( 1 &lt;&lt; offsetLeft ) - 1 ) ) &lt;&lt; ( diff-- &lt;&lt; 3 ) - offsetRight : 0 ); diff; sum += shl( this.buffer[ lastByte++ ], ( diff-- &lt;&lt; 3 ) - offsetRight ) );
			return sum;
		};
	}
	p.warn = function( msg ){
		if( this.allowExceptions )
			throw new Error( msg );
		return 1;
	};
	p.decodeFloat = function( data, precisionBits, exponentBits ){
		var b = new this.Buffer( this.bigEndian, data );
		b.checkBuffer( precisionBits + exponentBits + 1 );
		var bias = Math.pow( 2, exponentBits - 1 ) - 1, signal = b.readBits( precisionBits + exponentBits, 1 ), exponent = b.readBits( precisionBits, exponentBits ), significand = 0,
		divisor = 2, curByte = b.buffer.length + ( -precisionBits &gt;&gt; 3 ) - 1;
		do
			for( var byteValue = b.buffer[ ++curByte ], startBit = precisionBits % 8 || 8, mask = 1 &lt;&lt; startBit; mask &gt;&gt;= 1; ( byteValue &amp; mask ) &amp;&amp; ( significand += 1 / divisor ), divisor *= 2 );
		while( precisionBits -= startBit );
		return exponent == ( bias &lt;&lt; 1 ) + 1 ? significand ? NaN : signal ? -Infinity : +Infinity : ( 1 + signal * -2 ) * ( exponent || significand ? !exponent ? Math.pow( 2, -bias + 1 ) * significand : Math.pow( 2, exponent - bias ) * ( 1 + significand ) : 0 );
	};
	p.decodeInt = function( data, bits, signed ){
		var b = new this.Buffer( this.bigEndian, data ), x = b.readBits( 0, bits ), max = Math.pow( 2, bits );
		return signed &amp;&amp; x &gt;= max / 2 ? x - max : x;
	};
	p.encodeFloat = function( data, precisionBits, exponentBits ){
		var bias = Math.pow( 2, exponentBits - 1 ) - 1, minExp = -bias + 1, maxExp = bias, minUnnormExp = minExp - precisionBits,
		status = isNaN( n = parseFloat( data ) ) || n == -Infinity || n == +Infinity ? n : 0,
		exp = 0, len = 2 * bias + 1 + precisionBits + 3, bin = new Array( len ),
		signal = ( n = status !== 0 ? 0 : n ) &lt; 0, n = Math.abs( n ), intPart = Math.floor( n ), floatPart = n - intPart,
		i, lastBit, rounded, j, result;
		for( i = len; i; bin[--i] = 0 );
		for( i = bias + 2; intPart &amp;&amp; i; bin[--i] = intPart % 2, intPart = Math.floor( intPart / 2 ) );
		for( i = bias + 1; floatPart &gt; 0 &amp;&amp; i; ( bin[++i] = ( ( floatPart *= 2 ) &gt;= 1 ) - 0 ) &amp;&amp; --floatPart );
		for( i = -1; ++i &lt; len &amp;&amp; !bin[i]; );
		if( bin[( lastBit = precisionBits - 1 + ( i = ( exp = bias + 1 - i ) &gt;= minExp &amp;&amp; exp &lt;= maxExp ? i + 1 : bias + 1 - ( exp = minExp - 1 ) ) ) + 1] ){
			if( !( rounded = bin[lastBit] ) )
				for( j = lastBit + 2; !rounded &amp;&amp; j &lt; len; rounded = bin[j++] );
			for( j = lastBit + 1; rounded &amp;&amp; --j &gt;= 0; ( bin[j] = !bin[j] - 0 ) &amp;&amp; ( rounded = 0 ) );
		}
		for( i = i - 2 &lt; 0 ? -1 : i - 3; ++i &lt; len &amp;&amp; !bin[i]; );
		if( ( exp = bias + 1 - i ) &gt;= minExp &amp;&amp; exp &lt;= maxExp )
			++i;
		else if( exp &lt; minExp ){
			exp != bias + 1 - len &amp;&amp; exp &lt; minUnnormExp &amp;&amp; this.warn( "encodeFloat::float underflow" );
			i = bias + 1 - ( exp = minExp - 1 );
		}
		if( intPart || status !== 0 ){
			this.warn( intPart ? "encodeFloat::float overflow" : "encodeFloat::" + status );
			exp = maxExp + 1;
			i = bias + 2;
			if( status == -Infinity )
				signal = 1;
			else if( isNaN( status ) )
				bin[i] = 1;
		}
		for( n = Math.abs( exp + bias ), j = exponentBits + 1, result = ""; --j; result = ( n % 2 ) + result, n = n &gt;&gt;= 1 );
		for( n = 0, j = 0, i = ( result = ( signal ? "1" : "0" ) + result + bin.slice( i, i + precisionBits ).join( "" ) ).length, r = []; i; j = ( j + 1 ) % 8 ){
			n += ( 1 &lt;&lt; j ) * result.charAt( --i );
			if( j == 7 ){
				r[r.length] = String.fromCharCode( n );
				n = 0;
			}
		}
		r[r.length] = n ? String.fromCharCode( n ) : "";
		return ( this.bigEndian ? r.reverse() : r ).join( "" );
	};
	p.encodeInt = function( data, bits, signed ){
		var max = Math.pow( 2, bits );
		( data &gt;= max || data &lt; -( max &gt;&gt; 1 ) ) &amp;&amp; this.warn( "encodeInt::overflow" ) &amp;&amp; ( data = 0 );
		data &lt; 0 &amp;&amp; ( data += max );
		for( var r = []; data; r[r.length] = String.fromCharCode( data % 256 ), data = Math.floor( data / 256 ) );
		for( bits = -( -bits &gt;&gt; 3 ) - r.length; bits--; r[r.length] = "\0" );
		return ( this.bigEndian ? r.reverse() : r ).join( "" );
	};
	p.toSmall    = function( data ){ return this.decodeInt( data,  8, true  ); };
	p.fromSmall  = function( data ){ return this.encodeInt( data,  8, true  ); };
	p.toByte     = function( data ){ return this.decodeInt( data,  8, false ); };
	p.fromByte   = function( data ){ return this.encodeInt( data,  8, false ); };
	p.toShort    = function( data ){ return this.decodeInt( data, 16, true  ); };
	p.fromShort  = function( data ){ return this.encodeInt( data, 16, true  ); };
	p.toWord     = function( data ){ return this.decodeInt( data, 16, false ); };
	p.fromWord   = function( data ){ return this.encodeInt( data, 16, false ); };
	p.toInt      = function( data ){ return this.decodeInt( data, 32, true  ); };
	p.fromInt    = function( data ){ return this.encodeInt( data, 32, true  ); };
	p.toDWord    = function( data ){ return this.decodeInt( data, 32, false ); };
	p.fromDWord  = function( data ){ return this.encodeInt( data, 32, false ); };
	p.toFloat    = function( data ){ return this.decodeFloat( data, 23, 8   ); };
	p.fromFloat  = function( data ){ return this.encodeFloat( data, 23, 8   ); };
	p.toDouble   = function( data ){ return this.decodeFloat( data, 52, 11  ); };
	p.fromDouble = function( data ){ return this.encodeFloat( data, 52, 11  ); };
}

// --- globals ---
var globalBinaryParser = undefined;

// --- class: socket packet ---
function Skn3SocketPacket(size) {
	//create teh binary parser if it has not already been created
	if (typeof globalBinaryParser == "undefined") { globalBinaryParser = new BinaryParser(false,true); }
	
	//setup fields
	this.length = 0;
	this.size = size;
	this.buffer = "";
}

function Skn3SocketCreatePacket(size) {
	return new Skn3SocketPacket(size);
}

	Skn3SocketPacket.prototype.GetLength = function() {
		// --- get the length of the written data ---
		return this.buffer.length;
	}
	
	Skn3SocketPacket.prototype.ToString = function() {
		return this.buffer;
	}
	
	Skn3SocketPacket.prototype.AddByte = function(value) {
		// --- add a byte to the packet ---
		if (this.length+1 &lt;= this.size) {
			this.buffer += globalBinaryParser.fromByte(value);
			this.length += 1;
			return true;
		}
	}
	
	Skn3SocketPacket.prototype.AddShort = function(value) {
		// --- add a short to the packet ---
		if (this.length+2 &lt; this.size) {
			this.buffer += globalBinaryParser.fromShort(value);
			this.length += 2;
			return true;
		}
	}
	
	Skn3SocketPacket.prototype.AddInt = function(value) {
		// --- add a int to the packet ---
		if (this.length+4 &lt; this.size) {
			this.buffer += globalBinaryParser.fromInt(value);
			this.length += 4;
			return true;
		}
	}
	
	Skn3SocketPacket.prototype.AddFloat = function(value) {
		// --- add a float to the packet ---
		if (this.length+4 &lt; this.size) {
			this.buffer += globalBinaryParser.fromFloat(value);
			this.length += 4;
			return true;
		}
	}
	
	Skn3SocketPacket.prototype.AddString = function(value) {
		// --- add a string to the packet ---
		//this.buffer += globalBinaryParser.fromShort(value);
	}</textarea> <br><br></td></tr></table><br>
<a name="2015930"></a>

<a name="2015929"></a>

<a name="2015928"></a>

<a name="2015927"></a>

<a name="2015966"></a>

<a name="2015967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool!<br><br>Good start :)<br><br>Is the packing done using some specific standard?<br><br>Since the only thing to do next then is to be able to unpack the data (and pack it) on all other platforms. I know .Net has built-in functions for all those toByte toInt and so on. <br><br>It seems to me at first look that packing into a byteArray (using the same means) would be better than using strings since they are often 16bit and that can mean wierdness and inconsitencies depending on language. <br><br>However with that said, I have some awesome bitPacking functions from TNet in BlitzMax that I should thank Koriolis for. <br><br>And converting these to Monkey would mean that if we ONLY get string-sending to work across all platforms then we will be able to pack anything (int,float,and so on) into that string if that makes sense?<br><br>It is the String to ByteArray and ByteArray to String conversions that should be the hardest part of that?<br><br>Also another note, html5 sockets are like awesome, however unlike other sockets they require a "initialization" procedure. This needs to be taken into account on the serverside of things as well. <br><br>I was also thinking that it might become popular to have the server in PHP, so maybe we should consider that as well? The problem there is only that Monkey does not built to php yet ;) <br><br></td></tr></table><br>
<a name="2015987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The packing is done using standards as far as I can see. The library supports little/big endian and also specific variable types eg short, long, float, etc<br><br>It would probably be sensible to convert the code in the binary packer to write to a uint8 ArrayBuffer so I guess that is the next step. Once that is done it would be possible to just deal with sending data via packets.. (banks) in the same way other blitz languages do things. Avoiding strings on certain targets is a must!<br><br><div class="quote"> Also another note, html5 sockets are like awesome, however unlike other sockets they require a "initialization" procedure. This needs to be taken into account on the serverside of things as well. <br></div><br><br>How do you mean? I have only read the documentation of the api and not really tried to get anything running yet.<br><br>A php server would be a bit mental and awesome :D as would a monkey php target ;) <br><br></td></tr></table><br>
<a name="2016024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd go with a Socket-Class, and my suggestion is that it has a SocketSettings Property which the user can optionally set with data such as initialization data for html5.<br><br>Hm.. You have a good idea how we can write a simple test to verify bitPacking rutines across platforms?<br><br>Here is a html5 socket example. I haven't tested it but at first glance it looked promising.<br><br>* <a href="http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/" target="_blank">http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/</a><br><br>AND<br><br>* <a href="http://www.codeproject.com/KB/HTML/Web-Socket-in-Essence.aspx" target="_blank">http://www.codeproject.com/KB/HTML/Web-Socket-in-Essence.aspx</a><br><br>This is made for a php server, but just replace the php-server with an IP and you should be set!<br><br>Websockets are so awesome I so want them to be a reality among the larger part of the internet population. <br><br></td></tr></table><br>
<a name="2016023"></a>

<a name="2016039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah I see, there is no peer 2 peer communication with websockets yet. Interesting that it is so limited. It wouldn't be that hard to write a router. I understand what you were referring to now with the php server!<br><br>It could also be a possibility to embed a flash movie to deal with network and let it communicate to javascript. Although that is a bit nasty.<br><br>What do you think the best course of action would be. Ignore html5 sockets for now, use flash, write/port a websocket server in blitzmax or use something like node.js? <br><br></td></tr></table><br>
<a name="2016057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think most times you want a server-client solution, unless the concern i latency. For P2P then going bluetooth or built-in wifi is probably a better bet for low latency.<br><br>btw talked to the founder of Atari last night, Nolan Bushnell. And He was sure that picoNets (small local wireless networks) will be huge in the future.<br><br>I buy that theory since if one game comes out that is popular - and you can play it locally (realtime) with anyone who has a smartphone, its a viral spread setup :) <br><br></td></tr></table><br>
<a name="2016058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Playniax</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice how you just casually slipped that in, 'btw talked to the founder of Atari last night, Nolan Bushnell.'<br><br>He is your neighbour or what?<br><br>Just kidding, no harm intended :) <br><br></td></tr></table><br>
<a name="2016062"></a>

<a name="2016063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> He was in town, GameConference, he is pretty cool, gave an awesome keynote ;)<br><br>I actually asked him about it, and we discussed when it would happen. Do we have to wait until there is only one ubiquitous platform or could it work by doing like we are doing on here, cross-platform stuff. <br><br></td></tr></table><br>
<a name="2019727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kieryn</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any updates to this?   I'm new to Monkey and http requests were one of the first things I was looking to try out...  how else can you take advantage of web services etc? <br><br></td></tr></table><br>
<a name="2019745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I work on that atm... :) <br><br></td></tr></table><br>
<a name="2019780"></a>

<a name="2019781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Xaron, please tell more, also do you got anything to share perhaps?<br><br>Atm I don't want to start wrapping native code, but I'm very happy to get going building simple networking and testing once there are some raw socket commands. <br><br></td></tr></table><br>
<a name="2019803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> No update from me for socket stuff I'm afraid! <br><br></td></tr></table><br>
<a name="2019937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Xaron, you got an update? <br><br>I started building a TCP Server in C# to test against but also to start working on an API that will work across all platforms.<br><br>I was thinking that send/receive use byte arrays or strings. So you can send a byte-array or a string, and you can receive a byte-array or a string. Obviously the byte-array allows you to pack and unpack stuff however you want. The String stuff does a simple string conversion and also allows you to pack data into a string-format.<br><br>Here is some progress on the Interface Side for TCP. It could look like this (just pseudo code):<br><br>TCP.StartServer:TCPServer( port:int, networkInterfaceID:int = 0 )<br><br>'Create and Listen to a post is as simple as this:<br>Local myServer:TCPServer = TCP.StartServer( 5555 )<br><br>in OnUpdate:<br><pre class=code>
If myServer.Pending
   Local newConnection:TCPConnection = myServer.AcceptConnection()
   If newConnection.Availible
      newConnection.Read() 'Read to buffer
      Local byteArray:byte[] = newConnection.ReadBuffer
      Local text:string = newConnection.ReadString
   End
End
</pre><br><br>In this case it is using blocking sockets, however it does not block anything since we check Pending and Available before calling Accept or Read, and when we do we only read the amount we have - so there is no waiting!<br><br>Unless someone intends to host a MMO server on their iPad I strongly suspect a synchronous approach like this will be simpler, easier to code, easier to debug, easier to use and in some cases faster, yet might not be supported on all platforms.<br><br>UDP will be slightly different due to not requiring Accept, however TCP will require more work than this on a higher level for normal game traffic due to it being a stream protocol - packets are never guaranteed to be complete - they can be cutoff anywhere. However I would not suggest adding a check for this in the lowest level of the library since if someone ever is going to use a server on another platform - then they will be dependent on our protocol.<br><br>Good to hear comments on where people here wants and what kind of support in sockets you seek. We'll make this a free-community module. <br><br></td></tr></table><br>
<a name="2019936"></a>

<a name="2019934"></a>

<a name="2019933"></a>

<a name="2021550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> No update yet, my time is limited but it becomes more and more urgent for me as well so I HAVE to implement more networking, lol.<br><br>So what I'm on is: Bluetooth, Socket communication (TCP) for Android, iPhone and Windows Phone 7. <br><br></td></tr></table><br>
<a name="2021612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Xaron, if you send me what you have - even if just the interface - names of functions/methods &amp; classes - I'll see if I can help in any way!<br><br>This project has so big potential, multiplayer on mobile is the future imo :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
