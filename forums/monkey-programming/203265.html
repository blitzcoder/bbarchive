<!DOCTYPE html><html lang="en" ><head ><title >Getting frame dimensions from Image</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Getting frame dimensions from Image</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Getting frame dimensions from Image</a><br><br>
<a name="2034151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there any way to get the internal, individual frameWidth and frameHeight values from an Image object after it's been created?  I'm writing something to parse in and display complex strings on screen, and the font being displayed is not guaranteed at runtime.  <br><br>At first, I thought I could avoid requiring extra arguments to specify the character size of the font using GetFont(), but that would require Image objects have public members that specify the frame size.  I don't see this in the documentation!  Short of requiring those extra arguments, or storing the frame sizes for my fonts in keypairs associated with the Image, what would be a good way to approach this?<br><br>I guess the problem stems from assuming that user fontmaps will always be loaded in strip form, and that .Height can reasonably be assumed to be the character height.  This isn't true in my case.  I guess they could be derived from frame numbers and the dimensions, though...<br><br>Anyway, please consider this a request to expose more members of Image :) <br><br></td></tr></table><br>
<a name="2034149"></a>

<a name="2034156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gil</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> So...<br><br>[monkeycode]w = Image.Width()<br>h = Image.Height()[/monkeycode]<br><br><br>...doesn't return what you need? <br><br></td></tr></table><br>
<a name="2034158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gil</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> In looking over graphics.monkey, I see that the Frame class only has two fields - x and y. The frame size is derived from the Image width and height that contains it, so they are the same thing, thus Image.Width() should return the frame width and the same for the height.<br><br>Hope that helps, or maybe I don't quite understand your question. :) <br><br></td></tr></table><br>
<a name="2034161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> SetFont Description:<br><div class="quote"> <br><br>Sets the font for use with DrawText.<br><br>The font parameter may be Null, in which case an internal 7x11 white-on-black font is used and the firstChar parameter is ignored.<br><br>Note: The font functionality in mojo is very limited and intended mainly for debugging purposes<br> <br></div><br><br>it uses mono space mono size fonts. so all of the images are equal size. made from a strip of images.<br><br>so if you want to do parsing and formatting of variable width/height fonts, you are going to have to use one of the custom modules already created such as Angel font, Font Machine, or your own custom made module. <br><br></td></tr></table><br>
<a name="2034170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gil:  The frame size is definitely not the image's width and height.  In the larger overload for LoadImage, you actually must specify frameWidth and frameHeight in addition to frameCount.  I haven't looked at graphics.monkey to see if it retains these values or not, but it would seem to make sense for Image to do so rather than derive the frame size each time it needs to get it for displaying a slice.<br><br>Jesse:  I'm writing my own function based on DrawText.  DrawText is a built-in draw routine, which is why I'm using it.  I'm not using AngelFont or FontMachine in this project because they can incur large overheads and complicate my codebase.  I've already written a monospace character map with ligatures for thin characters, so there's no point to switching to a variable-width font now.  I merely want the frame size to properly adjust paragraph line tracking in my display routine without requiring an argument specifying the font's character height. <br><br></td></tr></table><br>
<a name="2034169"></a>

<a name="2034175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes but DrawText is based on the SetFont function and therefore uses the same rules. if you are extending it you are going to have to modify the load font function<br><br>this is the loadFon:<br>[monkeycode]<br>Function SetFont( font:Image,firstChar=32 )<br>	If Not font<br>		If Not context.defaultFont<br>			context.defaultFont=LoadImage( "mojo_font.png",96,Image.XPadding )<br>		Endif<br>		font=context.defaultFont<br>		firstChar=32<br>	Endif<br>	context.font=font<br>	context.firstChar=firstChar<br>End<br>[/monkeycode]<br>and the DrawText:<br>[monkeycode]<br>Function DrawText( text$,x#,y#,xalign#=0,yalign#=0 )<br>#If CONFIG="debug"<br>	DebugRenderDevice<br>#End<br>	If Not context.font Return<br>	<br>	Local w=context.font.Width<br>	Local h=context.font.Height<br>	<br>	x-=Floor( w * text.Length * xalign )<br>	y-=Floor( h * yalign )<br>	<br>	For Local i=0 Until text.Length<br>		Local ch=text[i]-context.firstChar<br>		If ch&gt;=0 And ch&lt;context.font.Frames<br>			DrawImage context.font,x+i*w,y,ch<br>		Endif<br>	Next<br><br>End<br>[/monkeycode]<br><br>as you can see the frame width is the context font width and is the same for all of the characters in the text.<br><br>it gets the width from the stored standard character width and uses if for every character in the string. it doesn't do variable text width or text height.  and furthermore <b> frame size is the image width and image height of the characters in the font.</b> as stated by Gil<br><br>and is why in the quote above on post #4 it says:<br><div class="quote"> <br>Note: The font functionality in mojo is very limited and intended mainly for debugging purposes<br> <br></div> <br><br></td></tr></table><br>
<a name="2034174"></a>

<a name="2034178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gil</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nobuyuki: Actually the frame size IS the image width and height. :)<br><br>If you are using the simple version of LoadImage(), which assumes a horizontal strip of length frameCount, in which case the frame height is the same as the image height and the frame width is expected to be the image width / frameCount. The Load() method sets the Images width and height to reflect this.<br><br>The extended version of LoadImage() allows you to specify the width and height and number of frames in the case that you are NOT using a horizontal strip but rather an image atlas, in which case it needs to know the exact measurements of the frames beforehand so it can correctly extract each frame from the total image area.<br><br>In either case, the Image field vars <i>width</i> and <i>height</i> will reflect the frame size of the images contained within the larger Image.<br>Don't take my word for it...take a look at graphics.monkey. :)<br><br>Cheers! <br><br></td></tr></table><br>
<a name="2034187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gil:  Thanks.  I wouldn't have expected it, but I looked at graphics.monkey, and you're right.  Based on the documentation, I would've expected Width and Height to return the total texture size!<br><br>Anyway, my code isn't very complex yet, it's just an easy way to display a paragraph using string literals, but I'm going to be adding in some String.Replace stuff to replace characters with ligatures, which will do for my purposes.  Just in case it's useful to anyone who (understandably) isn't using AngelFont/Fontmachine:<br><br>[monkeycode]<br>	Method DrawParagraph:Void(input:String, x:Float, y:Float, xAlign:Float=0, yAlign:Float=0)<br>		Local piece:String[] = input.Split("~n")<br><br>		For Local i:Int = 0 Until piece.Length<br>			DrawText(piece[i], x, y + (i*GetFont().Height), xAlign, yAlign)<br>		Next <br>	End Method <br>[/monkeycode]<br><br>no tracking is required, nor is it provided in this example since it's baked into my font, but it could easily be added, and I suppose the call to GetFont() removed in the process, if made a mandatory argument. <br><br></td></tr></table><br>
<a name="2034189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gil</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're welcome. I've found that reading through the code is the BEST documentation. :) <br><br></td></tr></table><br>
<a name="2034190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, thanks for ignoring me too. ;) <br><br></td></tr></table><br>
<a name="2034196"></a>

<a name="2034197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jesse:  I didn't end up having to directly modify any built-in mojo routines in order to achieve what I was looking to do.  Gil was very helpful.  Thanks for trying, but it wasn't what I was looking for.<br><br>(P.S.  order of ligaturization matters!)<br><img src="http://i.imgur.com/Z82gu.png"> <br><br></td></tr></table><br>
<a name="2034199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry, I guess I wasn't helpful even if I was pointing out the same thing Gil was. <br>Just ignore. I guess my explanation was lost in the translation. ;) <br><br></td></tr></table><br>
<a name="2034200"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't worry about it.  I think my explanation in the original post could've been better. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
