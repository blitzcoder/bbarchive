<!DOCTYPE html><html lang="en" ><head ><title >Levels using Diddy.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Levels using Diddy.</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Levels using Diddy.</a><br><br>
<a name="2044352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redbeer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just wanted to say that Monkey is looking great, as is Diddy.  People have obviously put a lot of work into this, and it shows.  I have a feeling that the tile system, the screen system, and Monkey itself are going to save me a lot of time on the platformer I'm working on.<br><br>That said, I have one thing I'd like some input on, that wasn't obvious to me from the example files.<br>Ideally I will have multiple levels in my platformer, and it seems as though making diddy screens would be the best way to accomplish that.<br><br>However, given that I have many levels, should I create some sort of game manager that checks the current state of say a level_loaded variable with select/case and then null out the previously loaded level/screen object?<br><br>In the example files it loads all the screens at once, and they seem to persist until the game is closed.  For a title screen and one level, this is no problem, but generally I would say that is a bad approach if I'm loading multilayer tiled levels in quantities of 5 or more at application startup.<br><br>The second question I have is, is there a way to make sure the GC runs between levels, rather than during playtime in another level, to free up memory from the previous level?<br><br>Any input on a system that might be appropriate to accomplish this and minimize problems with program performance and memory use, would be appreciated. :D <br><br></td></tr></table><br>
<a name="2044369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Why0Why</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The screen system is designed to be used for different portions of your game.  So you would have a screen for main menu, options, your game and an end of game for example.  You wouldn't use a different screen for each level.  You would load the level in the game screen and clear it out and load the next level in the same game screen. <br><br></td></tr></table><br>
<a name="2044377"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kauffy</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, +1 for not using screens (or layers) to hold different levels.<br><br>Layers or screens (depending upon the framework) are designed to contain different elements that you would show at different times back and forth. This makes it easy to move around your state engine (menu mode, play mode, game over mode, enter high score mode, etc.). This lets you ignore objects and things that are not in the layer/screen you're currently interested in without having to think about them at the time you need them-- just design your individual layers and show/hide them as you need them. This is totally distinct from what you're doing.<br><br>To do what you're doing, you would have just one gameplay layer (or screen) in which all your action happens and takes place. When your level ends, you would show your interstitial or load screen (if you like), zero out the gameplay layer, and then reinitialize it with the next level (whether that's from data in the program or read in from a file).<br><br>I do not know enough about GC to know when or how it runs, but I do believe it's slightly platform dependent.<br><br>Personally, I'm not thinking about this until I start to see problems. :) <br><br></td></tr></table><br>
<a name="2044378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why0Why is correct, you wouldnt have a screen per level.<br><br>Check out the platformer example:<br><br><a href="http://code.google.com/p/diddy/source/browse/trunk/examples/Platformer/screens.monkey" target="_blank">http://code.google.com/p/diddy/source/browse/trunk/examples/Platformer/screens.monkey</a><br><br>Within the GameScreen class we have this line:<br><pre class=code>Local tm:TileMap = reader.LoadMap("levels/level1.tmx")</pre><br>This could easily be changed to:<br><pre class=code>Local tm:TileMap = reader.LoadMap("levels/level"+player.level+".tmx")</pre><br>So every time a player gets to the next level (player.level+=1) and the GameScreen is displayed the level would change. <br><br></td></tr></table><br>
<a name="2044401"></a>

<a name="2044402"></a>

<a name="2044403"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tiresius</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used one screen for all my levels, but I used a separate screen for the inbetween areas and fading.  it seemed to work out well and was easy to move between screens.  I don't know if it is the best use of these things but you can check out the source <a href="http://www.monkeycoder.co.nz/Apps/app.php?id=194" target="_blank">here</a>. <br><br></td></tr></table><br>
<a name="2044406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redbeer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, thanks for the advice.  I can certainly setup a "level screen" and load/unload that way, then just use the screen system to handle the menu or options windows and such.  Makes sense, and now I'm glad I asked. :D<br><br>However, the main concern I have here is avoiding a GC during the process of gameplay.  Is there any way to trigger the garbage collector (on any system), after the destruction of the previous level, and before the creation of the next level?<br><br>My thinking here is that I can make a very memory static level to level game, by loading at level start, creating object pools for everything that spawns and despawns, then just dump all of that at the end of the level, which seems the ideal time to GC the memory.  <br><br>I guess another question would be, what are the best ways to store information that minimize the amount of GC that needs to run (on any system), given that not a lot of data will be persistent from level to level, and I don't want to be freeing memory from the previous level, or many previous levels, while playing another? <br><br></td></tr></table><br>
<a name="2044433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redbeer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Based on therevills post...and some more thought, essentially you're saying to instantiate the game screen, but then call the Gamescreen Start method with a different value for a level variable.  This will load new data into the existing Gamescreen object, which should write over top of the current tile/level data...<br><br>Is that correct?<br><br>If that's true, I think I see the light, as all I need to do is manage one state variable to control what level the player should currently be in, and memory is only a function of how big I make each level because the object is being overwritten with new information... <br><br></td></tr></table><br>
<a name="2044453"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> his will load new data into the existing Gamescreen object, which should write over top of the current tile/level data...<br><br>Is that correct? <br></div><br><br>Bingo :D <br><br></td></tr></table><br>
<a name="2044456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redbeer</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the help. :D <br><br></td></tr></table><br>
<a name="2044464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ordigdug</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> tiresius,<br><br>No source code is available for download on the Google Code Project site.<br><br>"This project currently has no downloads." <br><br></td></tr></table><br>
<a name="2044465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> No source code is available for download on the Google Code Project site. <br></div><br>Check the source code:<br><br><a href="https://code.google.com/p/the-lost-wand/source/browse/#svn%2Ftrunk" target="_blank">https://code.google.com/p/the-lost-wand/source/browse/#svn%2Ftrunk</a> <br><br></td></tr></table><br>
<a name="2044496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ordigdug</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you therevills,<br><br>I forgot to click on "Browse" in the Source Tab. <br><br></td></tr></table><br>
<a name="2044514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tiresius</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use a global to track current level but I like the idea of sending it as an argument to Start() method, I'll have to try that out sometime.<br><br><div class="quote"> This will load new data into the existing Gamescreen object, which should write over top of the current tile/level data... <br></div><br>Also having a level as its own object might be easier as you just instantiate a New level object and the old one will be GC'd away on its own.  At least that worked for me where levels were not cached. <br><br></td></tr></table><br>
<a name="2044546"></a>

<a name="2044547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I usually use an Init() function which regenerates the level in place. Making an entirely new one is fine too, but you need to remember to tell anything that holds a pointer to the level object.  If you just make a single level object at the start, you don't have to worry about it moving. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
