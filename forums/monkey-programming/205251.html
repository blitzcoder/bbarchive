<!DOCTYPE html><html lang="en" ><head ><title >Bitwise operators</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Bitwise operators</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Bitwise operators</a><br><br>
<a name="2058042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm going to really show myself up here a bit, but.... I don't use bitwise operators. I understand them, but what I don't understand is how they are considered useful?<br><br>Can anyone give me some game development related examples of where they are useful? <br><br></td></tr></table><br>
<a name="2058043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The example below is probably one of the more common uses.<br><pre class=code>Const OPTION_1:= 1
Const OPTION_2:= 2
Const OPTION_3:= 4
Const OPTION_4:= 8
Const OPTION_5:= 16
Const OPTION_6:= 32

Function DoSomething:Void(options:Int)
	If options &amp; OPTION_1
		'do option 1
		Print "Option 1"
	EndIf
	
	If options &amp; OPTION_2
		'do option 2
		Print "Option 2"
	EndIf
	
	If options &amp; OPTION_3
		'do option 3
		Print "Option 3"
	EndIf
	
	If options &amp; OPTION_4
		'do option 4
		Print "Option 4"
	EndIf
	
	If options &amp; OPTION_5
		'do option 5
		Print "Option 5"
	EndIf
	
	If options &amp; OPTION_6
		'do option 6
		Print "Option 6"
	EndIf
End

Function Main:Int()
	DoSomething(OPTION_1 | OPTION_3 | OPTION_6)
	Return 0
End</pre><br><br>If you are storing stuff in a database or sending over a network this is very useful. You can pack a lot of options into one integer instead of 1 byte per option. <br><br>It's good in object initialization as you can create a generic object create api with a single options or style param. Each object class can then decide how to interpret the options to create an object. <br><br></td></tr></table><br>
<a name="2058071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well one example is to use them for game flags in stead of using bool data types (saves some memory as bool would be 4 bytes in size). Use an int data type and use bitwise OR to set an individual bit and then use a bitwise AND to see if it's set.<br><br>You could then do something like use individual bits of a int as a method to determine what direction a player is to move when a button or key has been pressed just by setting it and then checking for it in your programme loop.<br>You can also use bitwise data for compressing your game level data. Just like it was done on the old 8bit computers where memory was tight. See <a href="http://www.icemark.com/dataformats/alien8/" target="_blank">here</a> for how Alien 8 for the ZX Spectrum was done. <br><br>The bit wise shift functions can be used as a fast method for multiplication/division.<br><br>If you do a bit of googling you should find plenty of examples for other uses.<br><br>Read through skids code <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=56" target="_blank">here</a> for a another. <br><br></td></tr></table><br>
<a name="2058067"></a>

<a name="2058068"></a>

<a name="2058070"></a>

<a name="2058065"></a>

<a name="2058066"></a>

<a name="2058044"></a>

<a name="2058076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks you two :D<br><br>That data packer looks like it could be useful for level file downloading too :) <br><br></td></tr></table><br>
<a name="2058080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> They can be useful for fast AI algorithms as well.  For example, most professional chess programs use 'bitfields' for representing board positions.  Like with the flags, the object is to get the most value out of an int, and you have the ability to use logical operations which can operate on 32/64 bits at once.<br><br>You can have examples of this with the flags, as well.  If you had a series of Bools storing flags to mean different things, then if you wanted to know if conditions 1, 4 and 5 are true you have to do three tests.  But if they are packed into a single int as bits, you can do all sorts of such tests in one or two operations.<br><br>Flags 0..9 = 1, 2, 4, 8, 16, 32, 64, 128, 256. 512<br><br>Say I have an int with all these flags set or unset.  I want to know if at least one of flags 1, 2 and 4 (values 2, 4, 16) is set.  All I need to do is say:<br><br>If ( flags &amp; 22 ) &lt;&gt; 0<br>   ' At least one is set<br>End<br><br>And if I want to know if all of them are set:<br><br>If ( flags &amp; 22 ) = 22<br>   ' All three are set<br>End <br><br></td></tr></table><br>
<a name="2058122"></a>

<a name="2058123"></a>

<a name="2058124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> That data packer looks like it could be useful for level file downloading too :)<br> <br></div>Be careful when using data compressed as strings as Apple OS's don't like custom string encoding.<br><br><div class="quote"> If ( flags &amp; 22 ) &lt;&gt; 0<br>' At least one is set<br>End <br></div>Just to point out. You wouldn't need to add &lt;&gt; 0 as any condition other than zero value equates to a bool value of TRUE. So any bit "trapped" would give a value greater than zero. You would only use the equals to check if a specific bit or number of bits are set.<br><br>A few things to remember when dealing with binary operations. It's a lot easer representing numbers in hexadecimal format than in decimal (or any other) due to the relationship that each character ( 0-9 with A-F representing 10-15) would be bits or the sum of 4 bits (a nibble) within a byte.<br>E.G. $FFE61216 is a lot easier to break down than 4293267990 or 11111111111001100001001000010110.<br><br>And rather than trying to remember what bit(s) is is meant to do what. You could assign a constant variable to represent it. As if I remember constant variables get hard coded into your code at compile time.<br><br>You could check for what bit(s) are set like so<br><br>Const bit4=$10 '16<br>Const bit2=$04 '4<br>Const bit1=$02 '2<br>If (flags &amp; (bit4|bit2|bit1)) = $16<br><br>But once your program is complete you should add the values together and change (bit4|bit2|bit1) to that added value to do a bit of optimising. <br><br></td></tr></table><br>
<a name="2058121"></a>

<a name="2058136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Just to point out. You wouldn't need to add &lt;&gt; 0 as any condition other than zero value equates to a bool value of TRUE. So any bit "trapped" would give a value greater than zero. You would only use the equals to check if a specific bit or number of bits are set."<br><br>Yeah, I know, but I like to make it explicit.  I suppose I should probably write:<br><br>If Bool( flags &amp; 22 )<br><br>..just to make sure it gets optimised away.<br><br>With the flags you can also optimise like:<br><br>Const BIT1:Int = 2<br>Const BIT2:Int = 4<br>Const BIT4:Int = 16<br>Const MYCOMBO:Int = BIT1 | BIT2 | BIT4 <br><br></td></tr></table><br>
<a name="2058178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dawlane</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Const MYCOMBO:Int = BIT1 | BIT2 | BIT4 <br></div>Only problem with that method is giving it a meaningful name for what it does that you can remember off the top of you head. I tend to stick to a strict naming, ordering and coding method and when I'm happy I let find and replace do all the work.<br><br><div class="quote"> Yeah, I know, but I like to make it explicit. I suppose I should probably write:<br><br>If Bool( flags &amp; 22 )<br><br>..just to make sure it gets optimised away. <br></div>Yeah know what you mean. But sometimes I find it just too much hard work typing those extra keywords.<br><br>Edit:<br>@RAZ here's a naff demo of what you could do<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">'Naff level demo
Strict
Import mojo

Function Main:Int()
	New CGame()
	Return 0
End Function

#Rem
	One way to store a level. 
	It's not the best way as there are a number of ways you
	could do it depending on the size of the playing area and the 
	complexity of the level.
	
	A block is 40x30 pixels (as the display is 640x480 pixels)
	and we want to place a block of a certain type in to a 16x16 grid.
	It can be crunched down into 2 bytes (16 bits)
	so we could get 2 blocks into a integer (usually 32 bits on a 32bit CPU)

        Using little-endian hi byte block type, low byte position.
	The first byte would be the X/Y position in the grid
	stored as Y/X. The second would be the block type. Each bit
	represents a colour here with the left most bit as a brighten
	colour flag. This byte could be use as a index to look up a number
	from 0-255 to give you more blocks etc.
	Then use a shift right function to get the other block data.
#End

Class CBlock
	Const BLUE:Int = $01
	Const RED:Int = $02
	Const MAGENTA:Int = $04
	Const GREEN:Int = $08
	Const CYAN:Int = $10
	Const YELLOW:Int = $20
	Const WHITE:Int = $40
	Const BRIGHT:Int = $80
	Field x:Int, y:Int, type:Int
	
	Method New(word:Int)
		Self.type = (word &amp; $FF00)Shr 8
		Self.x = (word &amp; $0F) * 40
		Self.y = ((word &amp; $F0) Shr 4) * 30	
	End Method
	
	Method Draw:Void()
		Local r:Int=0, g:Int=0,b:Int=0
		If (Self.type &amp; BLUE) Then r=0;g=0;b=160
		If (Self.type &amp; RED) Then r=160;g=0;b=0
		If (Self.type &amp; MAGENTA) Then r=160;g=0;b=160
		If (Self.type &amp; GREEN) Then r=0;g=160;b=0
		If (Self.type &amp; YELLOW) Then r=160;g=160;b=0
		If (Self.type &amp; WHITE) Then r=160;g=160;b=160
		If (Self.type &amp; BRIGHT)
			If r&gt;0 Then r+=95
			If g&gt;0 Then g+=95
			If b&gt;0 Then b+=95
		EndIf
		SetColor(r,g,b)
		DrawRect(Self.x,Self.y,40,30)
		SetColor(255,255,255)
	End Method	
End Class

Class CLevel
	Field blocks:CBlock[]
	
	Method ReadLevelData:Void(data:Int[])
		Local current_block:Int = 0
		Self.blocks = Self.blocks.Resize(data.Length()*2)
		For Local i:Int = 0 To data.Length()-1
			Self.blocks[current_block] = New CBlock((data[i] &amp; $FFFF0000) Shr 16)' trap 2 high bytes And shift right 16 bits	
			Self.blocks[current_block+1] = New CBlock(data[i]&amp;$0000FFFF)
			current_block+=2
		Next
	End Method
	
	Method Draw:Void()
		For Local i:Int = 0 To Self.blocks.Length()-1
			Self.blocks[i].Draw()
		Next
	End Method
End Class

Class CGame Extends App
	Field level_data:Int[]
	Field level_control:CLevel
	
	Method OnCreate:Int()
		SetUpdateRate(30)
		Self.level_control = New CLevel
		'Level 26 blocks with colour compressed into 13 ints (13*4) = 52 bytes
		Self.level_data = [$02218222,$08238824,$04770178,$0479847A,$20B2A0BD,$04F004F1,$02F202F3,$20F420F5,$40F682F7,$04F804F9,$08FA08FB,$01FC81FD,$08FE88FF]
		Self.level_control.ReadLevelData(Self.level_data)
		Return 0
	End Method
	
	Method OnRender:Int()
		Cls
		Self.level_control.Draw()
		For Local x:Int = 0 To 640 Step 40
			DrawLine(x,0,x,480)
		Next
		For Local y:Int = 0 To 480 Step 30
			DrawLine(0,y,640,y)
		Next
		Return 0
	End Method
End Class</textarea><br>I could think of a few ways on how to do it for a static platform game (think Manic Miner/<a href="http://www.icemark.com/dataformats/mirrors/JSW%20Tech%20Page_files/tech.html" target="_blank">Jet Set Willy</a>)<br><a href="http://www.icemark.com/dataformats/" target="_blank">Here's</a> the home page to some of the data formats for old ZX Spectrum games to give you some ideas. <br><br></td></tr></table><br>
<a name="2058177"></a>

<a name="2058152"></a>

<a name="2058151"></a>

<a name="2058148"></a>

<a name="2058147"></a>

<a name="2058138"></a>

<a name="2058139"></a>

<a name="2058142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Base 64 encoding. I created my own functions to do that, before realizing it was a very common thing and even had a name.<br><br>like, in binary (a byte is made of 8 bits): 11100000, 10001000, 10101010<br>this would become in base 64: 111000, 001000, 100010, 101010<br><br>With that you can choose an ASCII character to represent those.<br><br>Pro:<br>Copy-pastable anywhere you want<br>URL safe<br><br>Con:<br>33% larger (4 characters to represent 3 bytes)<br>A little processing is needed to pack/unpack data<br><br>I use it to save, pack, transfer data without fear a character would cause a mess. :D <br><br></td></tr></table><br>
<a name="2058141"></a>

<a name="2058149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also since I'm a big fan of game replays I also use bitwise operation to store and retrieve commands from a particular frame. This way, if you did something really awesome, you can re-watch yourself in action or share it with other people. Example: <a href="http://www.youtube.com/watch?v=l3JHfQ3c6HE" target="_blank">http://www.youtube.com/watch?v=l3JHfQ3c6HE</a><br><br>That concept works pretty much like Skn3's Function "DoSomething", you pass an integer to the function, and you check which bits are set to determine which keys are being pressed during a particular frame.<br><br>---<br><br>And if you like encryption you can try the xor bitwise operation too <a href="http://en.wikipedia.org/wiki/XOR_cipher" target="_blank">http://en.wikipedia.org/wiki/XOR_cipher</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
