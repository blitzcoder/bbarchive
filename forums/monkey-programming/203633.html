<!DOCTYPE html><html lang="en" ><head ><title >My concave polygon trick VS other platforms...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >My concave polygon trick VS other platforms...</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >My concave polygon trick VS other platforms...</a><br><br>
<a name="2038789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> In my portal engine ( <a href="http://www.monkeycoder.co.nz/Community/topics.php?forum=1168&amp;app_id=168" target="_blank">http://www.monkeycoder.co.nz/Community/topics.php?forum=1168&amp;app_id=168</a> ) I achieve the "line of sight view" by covering everything you don't see with a massive concave polygon.<br><br>[monkeycode]<br>	Function updateview(x#,y#,angle#)<br>		Local i<br>		For i=0 To accuracy<br>			l[i].update(x,y,(Float(i)*360/accuracy))<br>			coordinates[(i*2)+12] = l[i].endx<br>			coordinates[(i*2)+13] = l[i].endy<br>		Next<br>		<br>		coordinates[0]=x   ;coordinates[1]=y-10<br>		coordinates[2]=x-10;coordinates[3]=y-10<br>		coordinates[4]=x-10;coordinates[5]=y+10<br>		coordinates[6]=x+10;coordinates[7]=y+10<br>		coordinates[8]=x+10;coordinates[9]=y-10<br>		coordinates[10]=x   ;coordinates[11]=y-10<br>	End Function<br>[/monkeycode]<br><br>I simplified the above function to show the essentials.<br>- The program fires lasers around the player and spread them evenly around 360°<br>- It notes down where each lasers end. It forms some of the coordinates for a nice polygon.<br>- the first coordinates of the polygons are then defined and I end up with the inverse shape (a massive square far bigger than the screen that has a hole, this is what you see)<br><br>============<br><br>This is the solution I came up with to create this app.<br>It works well, smooth and fast in Flash and HTML5, but for Android (and possibly some other platforms, since I've been searching around already) That polygon will just create a big mess, usually making your whole screen black.<br><br>I tried using Triangulate Poly, it just freeze the app. I haven't found any other option. But I quite want this thing to work on my android tablet :( Anyone have an alternative implementation idea? <br><br></td></tr></table><br>
<a name="2038795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wrote an app in monkey that projects shadows from concave polygons which works on all platforms. I first determined forward facing edges, I then projected these vertices onto axis perpendicular to light ray to to find min and max. These are the vertices the shadow volume will extend from. Works nicely and is very quick. It sounds like it could work with your portal engine... <br><br></td></tr></table><br>
<a name="2038803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If triangulating is freezing the app then the algorithm is probably stuck in a while loop. I'd guess it's a loop like "while verts.Length &gt; 3" and it's just failing to find ears to clip. If that's the case then you've probably got an issue with the vertex ordering.<br><br>I'm doing something similar to you where I fill the outside of a level. The fill is done by creating a polygon from the level boundary out beyond the rendered area and triangulating that using ear-clipping code ported from libgdx. It works fine. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
