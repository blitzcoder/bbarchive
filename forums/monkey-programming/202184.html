<!DOCTYPE html><html lang="en" ><head ><title >fog problem on ios</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >fog problem on ios</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >fog problem on ios</a><br><br>
<a name="2021214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a weird problem with fog at the moment. I have created a cube and scaled it to 100,1,100 and set the fog range to 25 near and 50 far. On GLFW this works fine but on the iPhone the floor object appeared faded. It fades in and out depending on the camera yaw which is baffling me.<br><br>google provided this <a href="http://s231.codeinspot.com/q/1779029" target="_blank">http://s231.codeinspot.com/q/1779029</a> but I would have expected the same behaviour on both targets. I'd like to think that this is a problem with the way I have done something... I don't want my floor to be made up using lots of quads!  Anyone have any ideas what could be causing it?<br><br><pre class=code>
	'/ Do fog
	If Self.fogMode = 1
		glEnable( GL_FOG )		
		glFogf( GL_FOG_MODE, GL_LINEAR )
		glFogf( GL_FOG_START, Self.fogNear )
		glFogf( GL_FOG_END, Self.fogFar )
		glFogfv( GL_FOG_COLOR, [ self.fogR, self.fogG, self.fogB ])
	Else
		glDisable( GL_FOG )
	Endif
</pre><br><br>As you can see in the screenshot below, the floor has been affected by the fog. If the camera was to rotate more this effect fades in and out. Very strange!<br><br><img src="http://i40.tinypic.com/dblh61.png"> <br><br></td></tr></table><br>
<a name="2021212"></a>

<a name="2021213"></a>

<a name="2021211"></a>

<a name="2021224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not 100% sure on this one, btu the fog might be computed on a per-vertex basis in this case. Since the fog is computed using a "plane" parallel to the camera viewport, the angle of the camera will definitely alter the stat of the furthest vertices (e.g: If you're looking up or down, then the whole floor wil be outside the fog. If you looks straight ahead, the fog will affect half of the floor).<br><br>Since you only have 4 (actually 8, but for the sake of the explanation keep it to 4) vertices that define the floor, and the color is just interpolated, you get this undesired effect. If two of the vertices are at maximum range in the fog (which is the case here) then the floor is strongly affected by this. Even moreso if somehow the fog is computed behind the camera as well (though I doubt it).<br><br>If my theory is right, you should see the floor normally if you look directly down.<br><br>EDIT: In this case the fix would be to either use more polygons for the floor (not necesarily a grid. you could use lods for this. I'll link the paper if I can find it) OR you could make sure you compute the fog per-pixel (GLES 2.0) <br><br></td></tr></table><br>
<a name="2021223"></a>

<a name="2021245"></a>

<a name="2021246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks JIM, I was really hoping that wasn't the case as it doesn't do it on GLFW target. I would have liked the behaviour to be the same for both so that people wouldn't need to alter the code too much. Also as this is a 1.1 engine I don't have the option to do fog per-pixel which is a shame! Lighting per pixel would be nice as well!<br><br>That paper sounds interesting, I don't think I have come across that before, definitely interested in the link if you can find it :)<br><br>[edit] Just tried pointing the Camera down and the result is as you suspected... <br><br></td></tr></table><br>
<a name="2021243"></a>

<a name="2021250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JIM</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> There we go <a href="http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter02.html" target="_blank">http://http.developer.nvidia.com/GPUGems2/gpugems2_chapter02.html</a><br><br>Part of the GPU Gems. I totally recommend reading them all :)<br><br>The techniques there are GPU-based, but the main layout of the terrain could be inspired from there. Especially useful if the area you move around is rather small.<br><br>It would be great if things would just run the same on all targets, but once in a while you hit a difference like this sadly :(<br><br>One other option I can think of right now (if and only if your terrain is flat) is to disable fog completely on the ground, and use another large quad with a circular gradient on it. That way you'd "manually" do fog on the ground.<br><br>This could also work with non-frat ground with texture projection I would assume, but it will be slower :) <br><br></td></tr></table><br>
<a name="2021256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you JIM, I'll give that a read! I've been meaning on reading the entire series but I've got so many other books I'm halfway through, I need more hours in my days!!<br><br><div class="quote"> One other option I can think of right now (if and only if your terrain is flat) is to disable fog completely on the ground, and use another large quad with a circular gradient on it. That way you'd "manually" do fog on the ground. <br></div><br><br>Yea that sounds like a good idea. I'll have to have a play around with that and see what it looks like. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
