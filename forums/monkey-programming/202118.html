<!DOCTYPE html><html lang="en" ><head ><title >GC overhead... where?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >GC overhead... where?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >GC overhead... where?</a><br><br>
<a name="2020302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, I've been experimenting with pre-allocating objects versus <i>New</i>-ing them on-the-fly, based on the idea that "creating new objects is bad", in the hope of understanding and improving performance on more limited platforms.<br><br>First of all, I <i>do</i> understand that it apparently makes a difference in some situations, or on particular platforms (eg. XNA on 360, which I haven't tried but understand to be particularly sensitive), so I'm not putting down the 'received wisdom'.<br><br>However, <a href="http://www.hi-toro.com/monkey/explode.zip" target="_blank">this example</a> seems to run pretty much the same whether I use a fixed, pre-allocated array of objects or just generate them on the fly in a list, and that's on my fairly modest Android phone (<a href="http://www.gsmarena.com/zte_blade-3391.php" target="_blank">Orange San Francisco/ZTE Blade</a>, 600 MHz ARM CPU), as well as HTML5, GLFW, etc.<br><br><div class="quote"> <br>Examples in zip:<br><br>explode.monkey - fixed array version<br>explode2.monkey - careless list version<br> <br></div><br><br>It may be that it's a bad example, but I've made the array version stick to a fixed 500 object array (with 5 elements filled in per MouseDown'd frame, <i>if slots are available</i>), and left the list version to its own devices in terms of maximum allocation (still generating 5 objects per frame).<br><br>(I'm not saying it necessarily runs totally smoothly, BTW, just that it seems no worse in either case.)<br><br>I know others have seen great improvements in avoiding creating new objects, so I'm really just interested in why I'm not seeing any difference! Is the 'avoid New' thing somewhat overstated, or is this example just too simple? Is there something else I might be missing? <br><br></td></tr></table><br>
<a name="2020300"></a>

<a name="2020301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to clarify, this isn't meant to be troll-y or antagonistic! I was just expecting a noticeable difference when I tried this and didn't see any. <br><br></td></tr></table><br>
<a name="2020304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> 5 objects per frame is nothing on any platform and is not a reason to pre allocate.   it' when you create say 50 particles in a frame which themselves create another 50 vectors and/or additional objects per frame, that's how you should be testing. <br><br></td></tr></table><br>
<a name="2020307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dave.h</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> i just get module autofit not found <br><br></td></tr></table><br>
<a name="2020308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, Dave, stick this in the same folder as the source files:<br><br><a href="http://www.hi-toro.com/monkey/autofit.monkey" target="_blank">http://www.hi-toro.com/monkey/autofit.monkey</a><br><br>(If that fails, create a folder called autofit in Monkey/modules and place it there.) <br><br></td></tr></table><br>
<a name="2020351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dave.h</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi,well i tested it on html and android and explode2 always has a worse framerate.i Changed the setupdaterate to 600 to get these results but on android there could be as much as 15 fps difference between explode and explode2.On html it was around 10 fps.You only notice it though when you got loads on the screen.I tested it on a galaxy tab 7". <br><br></td></tr></table><br>
<a name="2020366"></a>

<a name="2020367"></a>

<a name="2020368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think it is really good that you don't take it for granted, but actually test the difference!<br><br>Some pointers:<br><br>* Test Allocation<br>* Test Deallocation <br>* Test for Jitter (unwanted changes in FPS)<br><br>Usually jitter is the problem. And Jitter is what tends to happen with garbage collectors - They are usually not that wise, so they do "chunks" of deallocation that halts the program. And they tend to deallocate more often when you have less memory availible. Good for boring Apps. Often not so good for realtime Apps. However there is a balance here when those chunks gets so big that one starts to notice lag - and I have no idea what that size is when it starts to become noticable - but it would be cool to know! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
