<!DOCTYPE html><html lang="en" ><head ><title >problems with scaled blurring...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >problems with scaled blurring...</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >problems with scaled blurring...</a><br><br>
<a name="2078507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've already searched the forums trying to figure out a way to do away with the texture blurring [mipmapping] of each image. It seems it cant be done with Monkey for some reason...<br><br>I was going to just let it be at that until I realized that you could blatantly see the edges of certain tiled images.<br><br>Here's my current project [wip] : <a href="http://misterbull.hostkart.net/" target="_blank">http://misterbull.hostkart.net/</a><br><br>Look at the water... each water tile is programmed to loop when it reaches the right edge of the screen (putting it back behind the left edge). I suppose it may have to do with the fact that the x position of these tiles is a floating point.<br><br>I was hoping there could be some sort of fix for this little eye-sore :P <br><br></td></tr></table><br>
<a name="2078413"></a>

<a name="2078498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rIKmAN</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try adding this to the top of your code...<br><pre class=code>#MOJO_IMAGE_FILTERING_ENABLED = False</pre><br><br>Have a look at App Config Settings in the docs for more directives. <br><br></td></tr></table><br>
<a name="2078501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, that doesn't seem to work. I've skimmed the docs and it said that these commands only work for certain platforms... I'm guessing html5 isn't one of them :P <br><br></td></tr></table><br>
<a name="2078722"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> *bump*<br><br>this is still a problem, guys. :(<br>is there not a solution? <br><br></td></tr></table><br>
<a name="2078723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >darky000</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've read similar topics about your problem and was my solution before. <br><br>Are your images handled with paddings? If not, you should try adding them. iirc, the reason behind was it sometimes produces leak in rendering which the paddings prevent. <br><br></td></tr></table><br>
<a name="2078724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> paddings? Is that an image editor thing or is that actually handled in the code somewhere? <br><br></td></tr></table><br>
<a name="2078725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> nevermind, I figured it out via Google :P<br><br>thanks for the advise, I'll toy with it a bit ^^ <br><br></td></tr></table><br>
<a name="2078728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >darky000</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is the "flag" parameter when you do createImage or LoadImage. Try searching them on the doc<br><br>It basically includes padding in your images. Just remember to adjust your spritesheet with the changes you make though.<br><br>EDIT: Yeah do that. I have similar problems with yours before so it might be it.<br><br>Nice game btw. Reminds me of the game in family computer, balloon fight. ;) <br><br></td></tr></table><br>
<a name="2078726"></a>

<a name="2078727"></a>

<a name="2078748"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mat</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Out of interest, why isn't "#MOJO_IMAGE_FILTERING_ENABLED = False" supported on HTML5 to give sharp retro-style upscaling of images? There is an example of drawimage upscaling and the css and javascript required on <a href="http://vaughnroyko.com/state-of-nearest-neighbor-interpolation-in-canvas/" target="_blank">this page</a>, or is there more to it than this? <br><br></td></tr></table><br>
<a name="2078752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Powelly</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm guessing that it's not supported on HTML5 because, as the page you linked to shows, there is no way to do it programmatically that works across all browsers. I assume it was best not to support it, rather than having it only work sometimes depending on what browser the player was using.<br><br>It seems the only way to have sharp (retro) pixels on all browsers is to manually pre-scale up all the images you use in an art package and use those instead of asking the browser to scale them up. <br><br></td></tr></table><br>
<a name="2078753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> which would be an okay solution if you didnt want to enable the option to select different screen resolutions (which is something I kinda want to do with my project)<br><br>I suppose one possible way of using that solution would be to upscale the images to the desired maximum scale for the max res and allow the program to downscale it with the lower resolution options.<br><br>I would do that if only it didnt mean I had to rework my code entirely to fit the new high-res structure. :P <br><br></td></tr></table><br>
<a name="2078755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mat</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Powelly, i can see that is a good argument.<br><br>I would, however, prefer it was supported and up to the programmer to decide. Personally, i'm only using HTML5 for testing purposes so there would be no problem. For others, perhaps they would be happy to live with the limitation that not all browsers will be supported (the page i linked to shows a good list of supported browsers though).<br><br>Pre-scaling the images is fine, but when catering for multiple resolutions you could end up with a fair few different image sizes to handle, plus i'm lazy :-) <br><br></td></tr></table><br>
<a name="2078884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know that Google Chrome on Windows still can't do this -- it's been a reported bug for a couple of years now. Really weird that given the popularity of 'retro' graphics they apparently couldn't care less. <br><br></td></tr></table><br>
<a name="2078885"></a>

<a name="2078886"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mat</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works ok here on Windows with Chrome (v32). You can try it <a href="http://vaughnroyko.com/jsfiddle/nearest-neighbor.html" target="_blank">here</a> and <a href="http://jsfiddle.net/VAXrL/190/" target="_blank">here</a>. I think it is just css sharp image upscaling that isn't supported. <br><br></td></tr></table><br>
<a name="2078887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sweet, so we have a solution! Now to figure out how to apply the upscale code to your monkey project :P<br><br>I'd look into it but I'm busy working on other things atm, anybody wanna post a code snippet that would work? <br><br></td></tr></table><br>
<a name="2079104"></a>

<a name="2079106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >impixi</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, you could alter and wrap the JavaScript in mat's second link above:<br><br>crisp.js<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
function enableCrispEdges()
{
	var cnv = document.getElementById("GameCanvas");
	var ctx = cnv.getContext("2d");
	ctx.imageSmoothingEnabled = false;
       ctx.webkitImageSmoothingEnabled = false;
       ctx.mozImageSmoothingEnabled = false;
       ctx.msImageSmoothingEnabled = false;
}
</textarea><br><br>crisp.monkey<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import mojo
Import "crisp.js"
Import "tv.png"

Extern

Function enableCrispEdges:Void()

Public

Function Main:Int()
	New MyApp

	Return 0
End

Class MyApp Extends App
	
	Field img:Image
	
	Method OnCreate:Int()
	
		img = LoadImage("tv.png")
	
		enableCrispEdges()
	
		SetUpdateRate(60)
		
		Return 0
	End
	
	Method OnRender:Int()
		Cls (128, 128, 128)
		
		Scale 1.0, 1.0
		DrawImage (img, 0, 0)
		
		Scale 2.0, 2.0
		DrawImage (img, 64, 64)
		
		Return 0
	End
	
End
</textarea><br><br>But this will apply the effect to *all* images drawn onto the canvas. For an image-level solution you'd need a deeper Mojo hack.<br> <br><strike>PS: The solution doesn't work for IE11, even with the relevant CSS style extensions specified.</strike> <br><br></td></tr></table><br>
<a name="2079015"></a>

<a name="2079016"></a>

<a name="2079035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> that works perfectly, thanks! :) <br><br></td></tr></table><br>
<a name="2079052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>It works ok here on Windows with Chrome (v32)<br> <br></div><br><br>@Mat: Whoa, finally! That second example is the one I've been trying for the last year or two -- I gave up checking a few updates ago! <br><br></td></tr></table><br>
<a name="2079053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, no it's not -- it was this one, which still doesn't work:<br><br><a href="http://jsfiddle.net/VAXrL/21/" target="_blank">http://jsfiddle.net/VAXrL/21/</a><br><br>I think it might be canvas vs. image scaling at play here... <br><br></td></tr></table><br>
<a name="2079054"></a>

<a name="2079055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mat</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> @DruggedBunny - Do any of the links work for you? The magic javascript is missing from the link you posted.<br><br>@impixi - Thanks! That works great! It even works in IE11 if you add "ctx.msImageSmoothingEnabled = false;". <br><br></td></tr></table><br>
<a name="2079057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MisterBull</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I decided to re-upload my project to test the results. It works fine for me with Chrome.<br><br>here's the link again: <a href="http://misterbull.hostkart.net/" target="_blank">http://misterbull.hostkart.net/</a><br><br>project controls:<br> Z or X : Elevation<br> Left or Right : Movement while Elevating<br>Space or Esc or Enter : Pause Game <br><br></td></tr></table><br>
<a name="2079105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >impixi</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> @mat: Thanks. I've updated my example above. It's hard to keep track of all the vendor-specific properties and extensions. <br><br></td></tr></table><br>
<a name="2079109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DruggedBunny</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> @mat: Your links both worked for me, but mine didn't (it does show a JS section for me, though, in the lower-left quarter!). Your demo above certainly works for me as well.<br><br>(<a href="https://code.google.com/p/chromium/issues/detail?id=106662" target="_blank">This is the bug report</a> I was referring to, and where my link came from. However, as long as there's a way to do it, that's really cool... need to get Mark to add it if it's working across the board!) <br><br></td></tr></table><br>
<a name="2079107"></a>

<a name="2079108"></a>

<a name="2079113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mat</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @DruggedBunny: Thanks for clearing that up. I meant the javascript section doesn't contain the code to turn off the smoothing in your link. I'm glad the other links are working though!<br><br>@Everyone: Thanks for your help in getting this working! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
