<!DOCTYPE html><html lang="en" ><head ><title >Diddy and Tiled: how to save or convert to xml?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Diddy and Tiled: how to save or convert to xml?</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=507" >Monkey Programming</a>/<a href="#bottom" >Diddy and Tiled: how to save or convert to xml?</a><br><br>
<a name="2044158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is the Diddy capable of loading maps saved with Tiled? If so what preferences should be set in Tiled in order to successfully load a tilemap in to my Monkey project?<br><br>Also, I have not seen an xml export so how would I go about converting Tiled Exported maps to xml and allowing them to be readable by Diddy's Map Loading routines?<br><br>1024 Thank Yous! <br><br></td></tr></table><br>
<a name="2044160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, Diddy can load in a Tiled map. Samah did a great job there. Check out the platformer example and also the tiled example included in Diddy.<br><br>When you save your map in Tiled, it saves it as an TMX file, which is just a XML file. <br><br></td></tr></table><br>
<a name="2044180"></a>

<a name="2044181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey! I'm consistently getting the same error when trying to load the map. It keeps pointing to this line in tile.monkey: line 452:<br><br><pre class=code>
If tl.maxTileWidth &lt; tiles[tl.mapData.tiles[i] - 1].width Then tl.maxTileWidth = tiles[tl.mapData.tiles[i] - 1].width
</pre><br><br><pre class=code>
		' calculate the max tile size per layer
		For Local l:TileMapLayer = Eachin layers
			If TileMapTileLayer(l) &lt;&gt; Null Then
				Local tl:TileMapTileLayer = TileMapTileLayer(l)
				For Local i% = 0 Until tl.mapData.tiles.Length
					If tl.mapData.tiles[i] &gt; 0 Then
						If tl.maxTileWidth &lt; tiles[tl.mapData.tiles[i] - 1].width Then tl.maxTileWidth = tiles[tl.mapData.tiles[i] - 1].width
						If tl.maxTileHeight &lt; tiles[tl.mapData.tiles[i] - 1].height Then tl.maxTileHeight = tiles[tl.mapData.tiles[i] - 1].height
					End
				Next
			End
		Next
	End
</pre><br><br>I've looked at the examples and I'm sure it should work but I'm unable to figure out yet what I'm doing wrong. To make sure it does work I'll try the platform example and will edit this post with the result.<br><br>While this has been bugging me I've made a lot of progress on other parts of the game but ideally I'd like to return to this and start making the levels.<br><br>Ta!<br><br>[edit]Yeh those examples work fine. Gonna study the preferences used for the level.tmx in the platform example. I know Raw XML is not supported so will try csv or one of the 3 Base64 Encoders to see what config works. <br><br></td></tr></table><br>
<a name="2044179"></a>

<a name="2044217"></a>

<a name="2044218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi amon, I have written a TMX loader for my framework (still not released yet unfortunately). I was wondering if you would mind If I tried to load your map with my code? It might highlight an issue with Diddy or with how the map has been constructed. Will be interesting to see if my loader crashes too! If you want to and don't mind sending me the files, you can use the email in my profile. (My loader can handle raw xml, csv or base64 so as long as the data is in one of those formats it will be fine.) <br><br></td></tr></table><br>
<a name="2044247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could you post the TMX file here (with codebox tags)?<br><br>We originally didnt support the Raw XML output due to the slowness of the XML parser, I can't remember if that was changed after Samah gave it a speed boost... <br><br></td></tr></table><br>
<a name="2044267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi! Here is a test .tmx? <a href="http://www.amon.co/storage/test.tmx" target="_blank">http://www.amon.co/storage/test.tmx</a><br><br>Even this simple one fails! Thanks for having a look. <br><br></td></tr></table><br>
<a name="2044268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange... works fine here. What is the exact error you are getting?<br><br>Also can you post your source code? <br><br></td></tr></table><br>
<a name="2044269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm! I get an 'Array Index Out of Bounds Error'. I am using a nightly build of Tiled though for windows. <br><br>I'll post the code I'm using in a bit; got to do a few things on some other part of the game for now. Won't be long!<br><br>Thanks for testing it though anyway. <br><br></td></tr></table><br>
<a name="2044301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im not familiar with Diddy's TMX loader but I wondered if the image source could be pointing to an invalid location?<br><pre class=code>image source="../graphics/mblocks.png</pre> <br><br></td></tr></table><br>
<a name="2044309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope thats fine, and if the Tile loader can not load the resource you get a nice error message saying so ;) <br><br></td></tr></table><br>
<a name="2044312"></a>

<a name="2044313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok! I figured out what was going on. If I load the images in with game.images.Load at the start of my code where I load all other graphics then I get the 'out of bounds' error.<br><br>If I comment out the loading of the tileset image and leave it for Diddy to load the gfx with the map then it works without error.<br><br><pre class=code>
game.images.LoadAnim("mblocks.png", 96, 96, 12, tmpImage, True, False)
</pre><br><br>So commenting out the above from "loadImages" will make it compile, run and lets me see the TileMap.<br><br>Why? Dunno! <br><br></td></tr></table><br>
<a name="2044329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, I'll look into it as it shouldn't crash like it did. Glad you worked it out though :) <br><br></td></tr></table><br>
<a name="2044330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking forward to the update because as it stands I have to have 2 sets of the same image. One set for Diddy to load automatically with the Tiled tilemap and another to use in LoadImage.<br><br>I need the one in loadimage for things not associated with the tilemap. <br><br></td></tr></table><br>
<a name="2044405"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fixed.<br><br>Now if you load in the image via:<br>[monkeycode]game.images.LoadAnim("mblocks.png", 96, 96, 12, tmpImage, True, False)[/monkeycode]<br><br>And if you use the same image in your Tile map, Diddy will overwrite the previously loaded image with the one in the XML. <br><br></td></tr></table><br>
<a name="2044411"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool! Thanks! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
