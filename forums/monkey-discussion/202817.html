<!DOCTYPE html><html lang="en" ><head ><title >Would this be possible?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Would this be possible?</h1><a href="forums.php" >Monkey Archive Forums</a>/<a href="topics.php?forum=510" >Monkey Discussion</a>/<a href="#bottom" >Would this be possible?</a><br><br>
<a name="2028732"></a>

<a name="2028738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Terrible thread title I know but:<br><br>I'm getting back to my top view golf game and I want to add terrain elevation and friction for ground collisions. I'm thinking I could have a color image that represents the course nice and pretty, a grayscale image for terrain height and another image that represents the different surfaces. Then I would get the color of the pixel under the ball for the terrain and friction when the ball hits the ground. Something like SetImage() and then GetColor(). Is this feasible? <br><br></td></tr></table><br>
<a name="2028740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The GetColor() command only gets the current colour set by SetColor().<br><br>You would need something like GetPixel(), which isnt included with Monkey/Mojo... I have added it to Diddy, but I wouldnt use it in a game as it seems pretty slow. <br><br></td></tr></table><br>
<a name="2028747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >invaderJim</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I set out to come up with a really fast way to do this with Diddy's GetPixel function, but it doesn't seem to be fully implemented, and what you really need is a way to get pixels of images instead of the entire screen, so I made a little getimagepixel module!<br><br>I've got it working with all targets except iOS. iOS is going to be tricky...<br><br>Performance seems fairly decent on my machine. HTML5 is definitely the slowest, but that can be remedied by breaking the image up into smaller ones and then getting their pixels using a grid system.<br><br>Also, if you want to build for GLFW, you have to hack graphics.monkey by changing "Extern Private" to "Extern" before "Class Surface=..." and then adding the following to the Public section of the Image class:<br><br><pre class=code>
	Method GetSurface:Surface()
		Return surface
	End
</pre><br><br>Here is an example of the HTML5 version in action:<br><br><a href="http://www.invaderjim.com/games/GetPixelTest/MonkeyGame.html" target="_blank">http://www.invaderjim.com/games/GetPixelTest/MonkeyGame.html</a><br><br>My fabulous golf course image is somewhat big (640 x 960), so the "GetImagePixel Time" might not be ideal, but, as a I said, smaller images go much, much faster.<br><br>Enough babble.<br><br>Here's the download: <a href="http://www.invaderjim.com/games/GetPixelTest/GetPixelTest.zip" target="_blank">http://www.invaderjim.com/games/GetPixelTest/GetPixelTest.zip</a><br><br>This is my example with the getimagepixel module included. Let me know if this helps you out any.<br><br>-Jim <br><br></td></tr></table><br>
<a name="2028764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MikeHart</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about predetermine the colors of an image and store it inside a 2D array. Then instead reading the color from the image, you read it from the array which should be blazing fast. <br><br></td></tr></table><br>
<a name="2028765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul - Taiphoz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are going to dump the level data into an array, then you could do that before hand and save the level hight friction data out to a textfile , then all your doing is loading that data into the array for each level.<br><br>I would also only read the height data from every third or fourth pixel, there really is not need to read every single pixel and your ball will probably sit over a number of pixels anyway.<br><br>Cutting down the number of pixels you read into your array will speed things up and make your arrays smaller and easier to manage. <br><br></td></tr></table><br>
<a name="2028769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, this helps a great deal. <br><br></td></tr></table><br>
<a name="2029158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> invaderJim do you think iOS will be doable for your getimagepixel module? I am liking how it works for the targets it supports so far. Reading the data in to an array is still an option but I am finding that a nested loop is really slow. For example:<br><br><pre class=code>

For y = 0 To 150
     For x = 0 To 100
	Print "Hi"
     Next
Next

</pre><br><br>...takes forever or never appears to run at all in an HTML5 test. I can do this ahead of time with a B3D or other app and create a text file to read from but for an image with the dimensions given in the nested loop above the filesize is 256k - not enormous but not tidy either. <br><br></td></tr></table><br>
<a name="2029153"></a>

<a name="2029154"></a>

<a name="2029170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is what you posted what you actually mean? There's no reason why that would "never appear to run at all" on HTML5 unless there's something about the rest of your code that means it never gets called.<br><br>It will be slow because you're printing thousands of lines into the console and that's slow. Simply doing a loop isn't. <br><br></td></tr></table><br>
<a name="2029173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> To time it:<br><br><pre class=code>
Local start:Int = Millisecs()
Local counter:Int = 0
For y = 0 To 150
     For x = 0 To 100
	counter+=1
     Next
Next
Print "Time taken ="+(Millisecs() - start)+"ms"
</pre> <br><br></td></tr></table><br>
<a name="2029172"></a>

<a name="2029179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You are right muddy_shoes, it does run - just takes a long time when printing to the console. My test wasn't very good as therevills demonstrated. <br><br></td></tr></table><br>
<a name="2029497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I have something working, thanks all for the tips, now I can get on with the rest of the development. You can check it out below.<br><br>While invaderJim's solution is very fast and would work well for me, I decided to go the route of predetermining the colors with a custom utility, storing them in a text file and then reading them into an array when the game loads. This appears to be the best way to maintain cross platform compatibility. The image used to define the surfaces (green, sand etc) is actually 1/4 of the size of the course image to keep the array as small as possible. The demo does not yet do bounce and roll but it will tell you what surface the ball is on based on the above (have not defined terrain height yet). I defined the green, sand and fairway area for this par 3.<br><br>To play:<br><br>1. Change your club to a 5 or 6 iron.<br>2. Click on the center of the green.<br>2. Hold the left mouse button and swipe upwards from the bottom of the screen, release mouse button. Deviating from center imparts side spin.<br><br><a href="http://www.maasscreativelabs.com/gtest/" target="_blank">http://www.maasscreativelabs.com/gtest/</a> <br><br></td></tr></table><br>
<a name="2029490"></a>

<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
