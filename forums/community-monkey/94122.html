<!DOCTYPE html><html lang="en" ><head ><title >MonkeyPong!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >MonkeyPong!</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=201" >Monkey Talk</a>/<a href="#bottom" >MonkeyPong!</a><br><br>
<a name="1078641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.therevillsgames.com/monkey/monkeyDoc.html" target="_blank">http://www.therevillsgames.com/monkey/monkeyDoc.html</a><br><br>Compiled for Flash, HTML5, Windows(exe) and Android!<br><br><img src="http://www.therevillsgames.com/monkey/monkeypong.png"> <br><br></td></tr></table><br>
<a name="1078649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works ok on my Galaxy S although juddery. Can you compile a non-debug version?<br>Also, there is no proper way to quit the app though (I.E, via the back button) <br><br></td></tr></table><br>
<a name="1078652"></a>

<a name="1078659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Galaxy S although juddery<br> <br></div><br>Im suprised, since your device has a 1Ghz CPU - my Android phone is the LG Optimus One with a 600Mhz CPU and the game is smooth...<br><br><div class="quote"> <br>non-debug version?<br> <br></div><br>non-debug version... yeah... hmmm.... I change the option in Monk and JungleIDE from debug to release, but it always builds a debug version - I think... well the apk name is always MonkeyGame-debug.apk....<br><br>[Edit - Ive uploaded the release version... Monkey names it -debug even though you select Release. Ive renamed it.]<br><br><div class="quote"> <br>no proper way to quit the app though <br> <br></div><br>Im not sure yet how to do this in Monkey :P<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1078671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. That's better. The movement is very erratic for 5 seconds or so before things settle down<br><br>I am happy to see phone orientation is automatically handled but it leads to another problem - There is no <b>OnOrientationChanged()</b> (or GetOrientation() function) therefore no way to dictate how to handle the accelerometer values. For example in your game the player bat control works nicely in Portrait mode. Rotating to Landscape means that you effectively control the paddle by tilting the phone left/right<br><br>As for quitting the app, there needs to be something like:<br><pre class=code>
Function OnEnd()
  #If TARGET="android" Then AppClose
End
</pre>Right now pressing HOME leaves the app running and I can only close it properly via Manage Apps &gt; Force Stop 'app in question'<br><br>Could you highlight these issues in the Monkey forums? I am not registering or buying into Monkey just yet due to the current shortcomings <br><br></td></tr></table><br>
<a name="1078688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >taumel</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice, i was surprised that the HTML-5 version is performing better than the Flash version. <br><br></td></tr></table><br>
<a name="1078691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> @therevills<br><br>I've tested you app on my Android device (I've too an LG Optimus one, an the app is very smooth)<br><br>Only one thing: how do you play it? Tilting the device forces a change on the screen-layout too... not very handy!<br><br>I've made this app for test - it should move a ball based on the accelerometers... (tested on V30... downloading now V31)<br>of course you need a 'ball.png' in the name.data folder<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import mojo
Global app:MyApp
Global SCREEN_WIDTH%
Global SCREEN_HEIGHT%
Global dt:DeltaTimer


Function Main:Int()
	app=New MyApp()
	Return 0	
End

Class Sprite
	Field x#,y#
	Field dx#, dy#
	Field speedX#, speedY#
	Field maxXSpeed#, maxYSpeed#
	Field image:Image
	Field scaleX# = 1, scaleY# = 1
	Field rotation#
	Field red%, green%, blue%
	Field w%, h%
	Field w2%, h2%
	Field score%
	Field accumulator:Int
	
	Method New(img:Image,x#, y#)
		Self.image = img
		Self.x = x
		Self.y = y
		Self.w = img.Width()
		Self.h = img.Height()
		Self.w2 = Self.w/2
		Self.h2 = Self.h/2
	End
	
	Method setRGB:Void(r%,g%,b%)
		Self.red = r
		Self.green = g
		Self.blue = b
	End
	
	Method move:Void()
		Self.x+=Self.dx * dt.delta
		Self.y+=Self.dy * dt.delta
	End
	
	Method draw:Void()
		DrawImage(image, x, y, rotation, scaleX, scaleY)
		SetColor 255, 255, 255
	End
End


Class DeltaTimer
	
	Field targetfps:Float = 60
	Field currentticks:Float
	Field lastticks:Float
	Field frametime:Float
	Field delta:Float
	
	Method New (fps:Float)
		targetfps = fps
		lastticks = Millisecs()
	End
	
	Method UpdateDelta:Void()
		currentticks = Millisecs()
		frametime = currentticks - lastticks
		delta = frametime / (1000.0 / targetfps)
		lastticks = currentticks
	End
	
End
		


Class MyApp Extends App

	Field ball:Sprite

	Method OnCreate:Int()
		
		SCREEN_WIDTH = DeviceWidth()
		SCREEN_HEIGHT = DeviceHeight()
		
		Seed = Millisecs()
		dt = New DeltaTimer (60)

		ball=New Sprite(LoadImage("ball.png", 1),SCREEN_WIDTH/2,SCREEN_HEIGHT/2)
		ball.speedX=1
		ball.speedY=1
		ball.maxXSpeed=5
		ball.maxYSpeed=5
		ball.accumulator=100
		
		SetUpdateRate 60
	Return 0
	End
	
	Method OnUpdate:Int()
		dt.UpdateDelta
		controls()
		Return 0

	End
	
	Method grid:Int()
		SetColor 200,200,200
		DrawLine SCREEN_WIDTH/2,0,SCREEN_WIDTH/2,SCREEN_HEIGHT
		DrawLine 0,SCREEN_HEIGHT/2,SCREEN_WIDTH,SCREEN_HEIGHT/2
		Return 0
	End	
	Method OnRender:Int()
		Cls
		grid()
		ball.draw()
		DrawText ball.dx,SCREEN_WIDTH/2,1
		
	Return 0
	End 
	

	Method controls:Void()
		#If TARGET="android" Then
			ball.y +=(AccelY()*ball.speedY)*dt.delta
			ball.x +=(AccelX()*ball.speedX)*dt.delta
					
		#Else
			If KeyDown(KEY_LEFT)
				ball.dx-=ball.speedX
				If ball.dx&lt;-ball.maxXSpeed Then ball.dy = -ball.maxXSpeed
				ball.accumulator=1000
			Else If KeyDown(KEY_RIGHT)
				ball.dx+=ball.speedX
				If ball.dx&gt;ball.maxXSpeed Then ball.dy = ball.maxXSpeed
				ball.accumulator=1000
			Else If KeyDown(KEY_UP)
				ball.dy-=ball.speedY
				If ball.dy&lt;-ball.maxYSpeed Then ball.dy = -ball.maxYSpeed
				ball.accumulator=1000
			Else If KeyDown(KEY_DOWN)
				ball.dy+=ball.speedY
				If ball.dy&gt;ball.maxYSpeed Then ball.dy = ball.maxYSpeed
				ball.accumulator=1000
			Else
				ball.dy*=0.95 
				ball.dx*=0.95
			End
		#Endif
		
		If ball.y &lt; 0
			ball.y = 0
			ball.dy = 0
		End
		If ball.y &gt; SCREEN_HEIGHT-8
			ball.y = SCREEN_HEIGHT-8
			ball.dy = 0
		End		
		
		If ball.x&lt;0
			ball.x=0
			ball.dx=0
		End
		
		If ball.x&gt;SCREEN_WIDTH-8
			ball.x=SCREEN_WIDTH-8
			ball.dx=0
		End If
		
		ball.move()
	End
End
</textarea><br><br>ps: I tried to compile my app and install it over the old one (as they have the same MonkeyGame.apk)<br>AndroidOS tells me that the install will write the previous up... but then I get an error: I need to manually uninstall the previous one and then install the last one.<br>Did you have the same behaviour?<br><br>(I will post this on the monkey.forum too)<br><br>Cheers <br><br></td></tr></table><br>
<a name="1078692"></a>

<a name="1078693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The movement is very erratic for 5 seconds or so before things settle down <br></div><br><br>I get that kind of behaviour when playing Angry Birds :/<br><br><div class="quote"> There is no OnOrientationChanged() (or GetOrientation() function) <br></div><br><br>I believe (but dont quote me :P) is that you can do this yourself in the build files Monkey generates.<br><br>Mark has release recently v31 just includes: "Added OnSuspend/OnResume - XNA/iOS/Android only for now" - I havent played around with them yet.<br><br><div class="quote"> HTML-5 version is performing better than the Flash version  <br></div><br><br>I think its all due to the browser and PC - if the Flash and HTML5 were on different pages you might see Flash being better...<br><br><div class="quote"> Tilting the device forces a change on the screen-layout too... not very handy! <br></div><br><br>The idea is that it is meant to be played landscape mode and you tilt left and right to move the left bat... but yeah the auto layout thing messes it up... need to find a way to stop that! :P<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1078702"></a>

<a name="1078703"></a>

<a name="1078704"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can edit the Android projects manifest file * to lock orientation as desired. Weapons of choice being:<br><pre class=code>android:screenOrientation="portrait"
android:screenOrientation="landscape"
android:screenOrientation="portrait|landscape"</pre>* My understanding is Monkey only creates the manifest once and will not overwrite any changes when you re-compile<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1078706"></a>

<a name="1078707"></a>

<a name="1078708"></a>

<a name="1078709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Jim... just found this out myself:<br><br><pre class=code>
&lt;activity android:name="MonkeyGame"
          android:label="@string/app_name"
          android:screenOrientation="landscape"
          android:theme= "@android:style/Theme.NoTitleBar.Fullscreen"&gt;
</pre><br><br>This forces landscape and fullscreen.<br><br><br>Just uploaded a new Android version with fullscreen and landscape mode.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1078715"></a>

<a name="1078723"></a>

<a name="1078724"></a>

<a name="1078725"></a>

<a name="1078726"></a>

<a name="1078727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice<br>Now if you use AccelX() instead of AccelY() it will make more sense for controlling the paddle. Thus, tilting the phone forwards and backwards (whilst in landscape) will make to paddle move as expected<br><br>Could you stick an FPS indicator on screen? It might make for a handy reference as to performance<br><br>Have you tried sound on your LG? Any luck?<br><br><br>EDIT<br>I read your query over at Monkey forums about keeping the screen awake. This is a power management thing and should be created and released in a friendly manor. One for Mark?<br>Example:<br><br><pre class=code>
Function OnCreate()
   PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
   PowerManager.WakeLock wl = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "My Tag");
   wl.acquire()
End

Function OnSuspend()
  wl.Release()
End Function
</pre><br>Also, the manifest would need:<br><b>&lt;uses-permission android:name="android.permission.WAKE_LOCK" /&gt;</b><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1078810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Uploaded new versions with sound and a new font (thanks degac!).<br><br>Also added FPS and changed the controls just for Jim! <br><br></td></tr></table><br>
<a name="1078843"></a>

<a name="1078856"></a>

<a name="1078857"></a>

<a name="1078858"></a>

<a name="1078859"></a>

<a name="1078861"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. Sound works on my Galaxy S. 35FPS<br><br>I am hoping Mark implements a proper "App suspend" system now. Your example still runs in the background (complete with sound effects) when the HOME key is pressed. I see Mark is aware of this though<br><br>He is right in what he says, an app does not have to 'close'. However, when suspended all related sound, timers, and the use of the accelerometer must be suspended too<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1078862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ouch! 35FPS!!!<br><br>On my Optimus One it runs 56FPS - 60FPS... and thats with the slower processor...<br><br>Which Galaxy S have you got?<br><br>http://www.gsmarena.com/results.php3?sQuickSearch=yes&amp;sName=Galaxy+S <br><br></td></tr></table><br>
<a name="1078868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Galaxy S I9000 with custom 'fast' ROM - Darky's Extreme edition<br>I get top scores on the Quandrant test - 1518 (which beats all currently listed phones)<br><br>Other 2D games run fast - HyperJump, Angry Birds, Space Physics, Stupid Zombies<br><br>I don't know why I only get 35 FPS for your example?<br>Perhaps its something to do with the accelerometer polling rate <br><br></td></tr></table><br>
<a name="1078872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested Mark's example Touch Test. I removed the command to create sparks on touch, so it always generates a spark - but as soon as you touch the screen you can see that it slows down... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
