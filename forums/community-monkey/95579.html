<!DOCTYPE html><html lang="en" ><head ><title >Let's say I want to extend the list type...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Let's say I want to extend the list type...</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=201" >Monkey Talk</a>/<a href="#bottom" >Let's say I want to extend the list type...</a><br><br>
<a name="1101780"></a>

<a name="1101781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What syntax would I use to do this, while still retaining the class parameter which allows me to use the class with any type of object?<br><br>In other words, if I have:<br><br>Class List&lt;T&gt;<br><br>Would I do this:<br><br>Class ListB&lt;T&gt; Extends List<br><br>Or this?<br><br>Class ListB&lt;T&gt; Extends List&lt;T&gt;<br><br>Or something else?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101788"></a>

<a name="1101789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> had to do a quick test wasn't sure:<br><pre class=code>

Strict
Import Mojo
Class Blist&lt;T&gt; Extends List&lt;T&gt;

End Class

Class myClass
	Field a:Int = 5
End Class


Function Main:Int()
	Local list := New Blist&lt;myClass&gt;
	Local this := New myClass
	list.AddLast(this)
	Local that:myClass = myClass(list.Last())
	Print that.a
End Function
</pre><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101793"></a>

<a name="1101794"></a>

<a name="1101795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> [edit]<br><br>Nevermind, figured it out.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101796"></a>

<a name="1101797"></a>

<a name="1101798"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get missing return expression when I try to run that.  And when I remove the :Int from main, like in the horsey example, I get a syntax error.<br><br>[edit]<br><br>I think it's the strict setting that causes the error with main.  Horsey doesn't have that.  If I comment out the classes it doesn't error on the main declaration if I put the :Int back.  But of course it errors on the rest of the code.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Strict
Import Mojo


Class Blist&lt;T&gt; Extends List&lt;T&gt;
End 

Class myClass
	Field a:Int = 5
End
 
Function Main:Int()
End
</pre><br><br>"missing return expression" on Function Main:Int() <br><br></td></tr></table><br>
<a name="1101801"></a>

<a name="1101802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, apparently with strict on, I have to have Return 0 in the function.  It won't simply assume I want it to return 0.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well that seems reasonable. If specified the return type as an Int, it expects that you're going to return an Int. Monkey is kind enough to add a Void return type for functions that don't return anything; perhaps you can use that?<br><br>(Haven't tested; some languages don't allow Main to be Void though.) <br><br></td></tr></table><br>
<a name="1101804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, so it's running now, but the output from Print doesn't appear in either the output window or firefox when the app is run. <br><br></td></tr></table><br>
<a name="1101805"></a>

<a name="1101806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Well that seems reasonable. If specified the return type as an Int, it expects that you're going to return an Int."<br><br>No language I've ever used has required me to provide a return value.  And requiring one results in situations like this:<br><br>Function Main:Int()<br>Local a:Int = 5<br>If a = 5 Return 0 Else Return 1<br>End<br><br>That won't compile, even though a value is always returned.  I'm forced to put a return value at the end of the function even though the code will never be executed.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Function Main:Int()<br>Local a:Int = 5<br>If a = 5 Return 0 Else Return 1<br>End<br> <br></div><br><br>Compiles fine for me... <br><br></td></tr></table><br>
<a name="1101808"></a>

<a name="1101809"></a>

<a name="1101810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using the demo.  Perhaps it was fixed?<br><br>[edit]<br><br>No, that particular piece of code compiles fine on my end too.  What the hell...<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101811"></a>

<a name="1101813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> the demo is quite outdated as you can guess my demo works fine here  with the latest version.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, the issue is I didn't put Strict on the example code.<br><br>Try this:<br><pre class=code>
Strict

Function Main:Int()
Local a:Int = 5
If a = 5 Return 0 Else Return 1
End
</pre> <br><br></td></tr></table><br>
<a name="1101814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just because it works fine on your end doesn't mean the demo is broken. Where am I supposed to see the print statements?  If it is in the web browser, then perhaps you're not using Firefox?  I would not expect the print statement of all things to be broken in the demo. <br><br></td></tr></table><br>
<a name="1101815"></a>

<a name="1101816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> it displays on my browser just below 480th pixel. <br>Safari<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101817"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=135" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=135</a><br><br>Print statements should show up under the application in the text area when running HTML5.<br><br>In Flash they appear on top of game. In GLFW, XNA and STDCPP they appear in the console. <br><br></td></tr></table><br>
<a name="1101818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> sswift is using the the demo  but it has no reason to fail. <br><br>What I am wondering is why does it compile if I didn't put a return in the main Function. <br><br></td></tr></table><br>
<a name="1101819"></a>

<a name="1101820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> LOL - I've downloaded the demo and compiled the following code:<br><br><pre class=code>
Strict
Import Mojo


Class Blist&lt;T&gt; Extends List&lt;T&gt;
End 

Class myClass
	Field a:Int = 5
End
 
Function Main:Int()
End
</pre><br><br>In the demo it complains with Missing return expression, in the full version (v44) it compiles fine... I would say its a bug with the new version of Monkey.<br><br>[edit]<br>I've just raised it in Monkey bugs forum:<br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=1370" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=1370</a><br>[/edit]<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is &lt;T&gt; special in some way, or can I use any name there that isn't already assigned to a class? <br><br></td></tr></table><br>
<a name="1101829"></a>

<a name="1101830"></a>

<a name="1101831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> it's not that hard to do some tests:<br><pre class=code>
Strict
Import Mojo
Class Blist&lt;T&gt; Extends List&lt;otherClass&gt;

End Class

Class myClass
	Field a:Int = 5
End Class

Class otherClass
	Field b:String = "ok this is it"
End Class

Function Main:Int()
	Local list := New Blist&lt;otherClass&gt;
	Local foo := New otherClass
	list.AddLast(foo)
	Local that := otherClass(list.Last())
	Print that.b
	Local this := New myClass
	'list.AddLast(this)
	
End Function
</pre><br>uncomment the last line and you will get it.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101832"></a>

<a name="1101833"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ugh.  Trying to extend monkey's list type to fix it's shortcomings is a pain in the ass.  It's quickly 10x as much work as it would be to just copy the type and modify it.<br><br>The whole &lt;T&gt; thing confuses the hell out of me.  I understand how to use it in the simple case of creating a new list of objects, but it's impossible to decide where I need to add it when extending the type to create a new list type.<br><br>Also, I ran into a problem with nodes.  There's no methods to get the next and previous nodes in the list.  And I don't know if I can fix that by extending the node class.  I think maybe if I typecast the new node type over pointers to the nodes, it might work... but... ugh.  <br><br>There is just no good solution.  Adding a new method to a preexisting class should not be this complicated. Why can't I just declare the class again in my code with some other keyword, and stick the new methods and fields in there and be done with it?<br><br>I think I'll just fix the List class and name it something else and wash my hands of the whole thing.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> what exactly are you trying to do? maybe someone here  or I can help. <br><br></td></tr></table><br>
<a name="1101835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am trying to add a merge sort to the List class.  <br><br>I wanted to make it a generic extension to the class so anyone could use it to sort a list of any kind of object, rather than simply copying the list code and making something specific to my needs. <br><br></td></tr></table><br>
<a name="1101836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is the original code in BlitzMax:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">


' Set this function pointer to point to whatever comparison function you wish to use to compare objects in the list during the next call to MergeSort()
Global MergeCompare%(Object1:Object, Object2:Object) = Sprite.CompareOrder 


' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' This function takes a list as input, and returns a new sorted list.
'
' The Size% parameter is for internal use only.  It is the size of the list.  If a size is not passed, the function calculates the size of the list itself.
' Unless you keep track of the size manually, and are working with very large lists, you can safely ignore this parameter.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function MergeSort:TList(A:TList, Size%=-1)
		
		Local B:TList
		
		If Size = -1 Then Size = A.Count()
		If Size &lt;= 1 Return A
		
		B = Split(A, Size) ' Split A in half, and place the second half in B.
				
		A = MergeSort(A, (Size+1)/2) ' List A gets the extra link, if any, during a split of a list with an odd number of elements.
		B = MergeSort(B, Size/2) 
	
		Return Merge(A, B)
	
	End Function


' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' Compare() = A pointer to a function which compares two objects.
' Function should return &lt;0 if Object1 is less than Object2, 0 if they are equal, and &gt;0 if Object1 is greater than Object2.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function Merge:TList(A:TList, B:TList)
	
		Local C:TList = CreateList()
	
		' If we always make sure list B is the smaller of the two, then we need not check to see if A is empty.
		' There's gotta be some way to avoid the need for list C here, but would doing so improve performance significantly?
				
		While Not A.IsEmpty() And Not B.IsEmpty()			' While neither list is empty:
			Select MergeCompare(A.First(), B.First()) &lt;= 0		' Is the value of the first link in list A &lt;= the value of the first link in list B?
				Case True  MoveLink(A.FirstLink(), A, C) ' C.AddLast(A.RemoveFirst())		' Yes:  Move the first link in list A to list C.
				Case False MoveLink(B.FirstLink(), B, C) ' C.AddLast(B.RemoveFirst())		' No:   Move the first link in list B to list C.
			End Select
		Wend

		Append(A, C)
		Append(B, C) 

		Return C

	End Function
	

' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' This function appends one TList onto the end of another.	
' This can be sped up by simply splicing the two lists together.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function Append(A:TList, B:TList)
	
		Local Link:TLink
		Local NextLink:TLink
	
		Link = A.FirstLink() ' Set Link to the first link in list A.
				
		While Link &lt;&gt; Null ' While there are still links in list A we can move...
			NextLink = Link.NextLink() ' Store pointer to link after this link in list A, because once we move this link to list B, the link after it will be one in list B, not A.
			MoveLink(Link, A, B) ' Move Link from list A to list B.
			Link = NextLink 
		Wend

	End Function


' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' This function moves a link from list A to the end of list B.
' This cannot be used in a For Eachin loop, because EachIn will not store the next link before the loop begins, and this will modify the next link pointer.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function MoveLink(Link:TLink, A:TList, B:TList)
	
		' Close hole in list A:
			Link._pred._succ = Link._succ	' Set the link before this link to point forward to the link after this link.
			Link._succ._pred = Link._pred	' Set the link after this link to point back to the link before this link.
		
		' Insert Link in List B:		
			Link._pred = B._head._pred 	' Set this link to point back to the last link in list B.
			Link._succ = B._head 		' Set this link to point forward to the head of list B.
			B._head._pred._succ = Link 	' Set the last link of list B to point forward to this link.
			B._head._pred = Link 		' Set the head of list B to point back to this link.
	
	End Function
	

' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' This function splits a linked list in two, and returns a pointer to a new list containing the second half of the first.
'
' Size% is the number of elements in the original list. If it is not specified, then the function will calculate the size itself. 
' As with the MergeSort() function, this parameter is mainly intended for internal use, and generally you should not need to specify it.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function Split:TList(A:TList, Size%=-1)
	
		Local B:TList = CreateList()
		Local Link:TLink
				
		If Size = -1 Then Size = A.Count()
		If Size &lt;= 1 Then Return Null ' If list is empty or has only one element, return Null.
		
		' Find the middle of the list.
		
			Size = (Size+1)/2 
				
			Link = A.FirstLink() 
		
			While Size &gt; 0
				Link = Link.NextLink()
				Size = Size - 1	
			Wend
		
		' Split list in two.

			Link._pred._succ = A._head 	' Make the link before this one point forward to the head of A.
			B._head._pred = A._head._pred	' Make the head of B point back to the end of A.
			A._head._pred._succ = B._head ' Make the end of A point forward to the head of B.
			A._head._pred = Link._pred 	' Make the head of A point back to the link before this link.
			Link._pred = B._head 		' Make the this link point back to the head of B.
			B._head._succ = Link 		' Make the head of B point forward to this link.		
		
		Return B
		
	End Function
</textarea> <br><br></td></tr></table><br>
<a name="1101837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> And here is the code I've partially converted to Monkey, after I removed all the &lt;T&gt; crap I'd added which was making it impossible for me to follow. (I was gonna try adding it back once I made sure the function actually worked.)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
	' Move this compare function into the sprite object?
	Function Compare:Int(A:Sprite, B:Sprite)

		Local Ao:Float = Sprite(A).Order(True)
		Local Bo:Float = Sprite(B).Order(True)
			
		Select True
			Case Ao &lt; Bo Return -1
			Case Ao = Bo Return 0
			Case Ao &gt; Bo Return 1
		End
						
	End 


Class SpriteList Extends List&lt;Sprite&gt; ' Sortable list class

	Field Size:Int = 0 ' The number of nodes in the list. Updated when nodes are added or removed.
	
	Method Sort:SpriteList(A:SpriteList, Size%=-1) ' This method returns a new sorted list.
		
		Local B:SpriteList
		
		If Size = -1 Then Size = A.Count()
		If Size &lt;= 1 Return A
		
		B = Split(A, Size) ' Split A in half, and place the second half in B.
				
		A = Sort(A, (Size+1)/2) ' List A gets the extra link, if any, during a split of a list with an odd number of elements.
		B = Sort(B, Size/2) 
	
		Return Merge(A, B)
	
	End

	Function Merge:SpriteList(A:SpriteList, B:SpriteList)
	
		Local C:SpriteList = New SpriteList
	
		' If we always make sure list B is the smaller of the two, then we need not check to see if A is empty.
		' There's gotta be some way to avoid the need for list C here, but would doing so improve performance significantly?
				
		While Not A.IsEmpty?() And Not B.IsEmpty?() ' While neither list is empty:
			Select MergeCompare(A.First(), B.First()) &lt;= 0 ' Is the value of the first link in list A &lt;= the value of the first link in list B?
				Case True  MoveNode(A.FirstLink(), A, C) ' C.AddLast(A.RemoveFirst())		' Yes:  Move the first node in list A to list C.
				Case False MoveNode(B.FirstLink(), B, C) ' C.AddLast(B.RemoveFirst())		' No:   Move the first node in list B to list C.
			End Select
		Wend

		Append(A, C)
		Append(B, C) 

		Return C

	End 	

	' This function appends one list onto the end of another.	
	' It could be sped up by splicing the two lists together.

	Function Append(A:TList, B:TList)
	
		Local N:list.Node
		Local NextN:list.Node
	
		N = A.FirstNode() ' Set N to the first node in list A.
				
		While N &lt;&gt; Null ' While there are still nodes in list A we can move...
			NextN = N.NextNode() ' Store pointer to node after this node in list A, because once we move this node to list B, the node after it will be one in list B, not A.
			MoveLink(N, A, B) ' Move N from list A to list B.
			Link = NextLink 
		Wend

	End Function


' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' This function moves a node from list A to the end of list B.
' This cannot be used in a For Eachin loop, because EachIn will not store the next link before the loop begins, and this will modify the next link pointer.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function MoveNode(N:list.Node, A:T, B:T)
	
		' Close hole in list A:
			Link._pred._succ = Link._succ	' Set the link before this link to point forward to the link after this link.
			Link._succ._pred = Link._pred	' Set the link after this link to point back to the link before this link.
		
		' Insert Link in List B:		
			Link._pred = B._head._pred 	' Set this link to point back to the last link in list B.
			Link._succ = B._head 		' Set this link to point forward to the head of list B.
			B._head._pred._succ = Link 	' Set the last link of list B to point forward to this link.
			B._head._pred = Link 		' Set the head of list B to point back to this link.
	
	End Function
	

' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
' This function splits a linked list in two, and returns a pointer to a new list containing the second half of the first.
'
' Size% is the number of elements in the original list. If it is not specified, then the function will calculate the size itself. 
' As with the MergeSort() function, this parameter is mainly intended for internal use, and generally you should not need to specify it.
' -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

	Function Split:TList(A:TList, Size%=-1)
	
		Local B:TList = CreateList()
		Local Link:TLink
				
		If Size = -1 Then Size = A.Count()
		If Size &lt;= 1 Then Return Null ' If list is empty or has only one element, return Null.
		
		' Find the middle of the list.
		
			Size = (Size+1)/2 
				
			Link = A.FirstLink() 
		
			While Size &gt; 0
				Link = Link.NextLink()
				Size = Size - 1	
			Wend
		
		' Split list in two.

			Link._pred._succ = A._head 	' Make the link before this one point forward to the head of A.
			B._head._pred = A._head._pred	' Make the head of B point back to the end of A.
			A._head._pred._succ = B._head ' Make the end of A point forward to the head of B.
			A._head._pred = Link._pred 	' Make the head of A point back to the link before this link.
			Link._pred = B._head 		' Make the this link point back to the head of B.
			B._head._succ = Link 		' Make the head of B point forward to this link.		
		
		Return B
		
	End Function
</textarea> <br><br></td></tr></table><br>
<a name="1101838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm also trying to clean the code up a bit.  <br><br>Where the original function required you to set a function pointer to the compare function, I was gonna require a compare method in the class you have in the list. <br><br>And where there was a parameter in the sort() method where the size of the list was passed internally, I thought it would be better to hide that from the user and store the size of the list in the list for easy retrieval.  But that would require overriding the functions which add and delete nodes and I'm not sure if I can call the original code after I override the method.  If I can't do that to patch my counter in there, then I'd have to copy the code from the original methods.  And I don't like that solution.<br><br>It seems like the easiest thing to do is just copy the list class whole hog, and simply modify it.  Trying to override and extend everything just for the sake of using the original list class just in the off chance Mark at some point decides to add some new functionality is just going to make ugly and hard to maintain code. <br><br></td></tr></table><br>
<a name="1101839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I think I'll just fix the List class and name it something else and wash my hands of the whole thing.<br> <br></div><br><br>I think you are better of that way.<br><br>The thing that makes it hard to extend classes is the use of Private.  I think that when making public modules one should not put/use "Private" specially when declaring the module as public domain.<br>It really makes no cense to me. the only way to resolve the problem is to remove the private from the list. the problem is that every time an update is done we have to make sure the list is modified again.<br><br>What you want to do can be done but  by modifying the List.monkey file. But if you are going to do that, might as well do as you suggested. <br><br></td></tr></table><br>
<a name="1101847"></a>

<a name="1101848"></a>

<a name="1101849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> This was actually a problem I found with the current List Class (v44), having no access to Nodes previous and forward to manually iterate through a list (or partially iterate).<br>I had to create a whole new ListMod with it's own Node Class allowing me to use Node.GetNext() and Node.GetPrev().<br><br>Not hard to do since you basically just copy the file and do an Import, but yes, private fields limit Extendibilty.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did this (created my own list type which was a copy and paste of the Monkey List) when I wanted a sort rountine...<br><br>These days I just use Diddy's Arraylist... since I know when it will create an object or not - which you really need to watch out for on Android. <br><br></td></tr></table><br>
<a name="1101951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> "These days I just use Diddy's Arraylist... since I know when it will create an object or not - which you really need to watch out for on Android."<br><br>Can you elaborate on this? <br><br></td></tr></table><br>
<a name="1101995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Which part? ;)<br><br>Diddy's Arraylist uses an array which you can add to, much like a List, but it doesnt use nodes etc. Its based of the Java ArrayList.<br><br>In Android you dont want to create objects when you are playing your game (in the main gameplay part anyway), as when you call "new" it gives the GC a chance to run and it will hurt your FPS. Its best to set up all your objects before the game starts and reuse them overtime. <br><br></td></tr></table><br>
<a name="1102073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can confirm that you definitely do not want to be creating and destroying objects on a per-frame basis on Android (or iOS for that matter.) Object pooling is a must for dynamic objects. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
