<!DOCTYPE html><html lang="en" ><head ><title >Kongregate API Help</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Kongregate API Help</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=503" >Flash</a>/<a href="#bottom" >Kongregate API Help</a><br><br>
<a name="2051881"></a>

<a name="2051882"></a>

<a name="2051883"></a>

<a name="2051884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PoliteProgrammer</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone! So I've recently finished my first game, and I'd like to incorporate the Kongregate API. I'm completely new to actionscript, so I followed this tutorial:<br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=1825" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=1825</a><br>When I get to step 3, and try to import the Kongregate front-end into my game code, I get the following error(s):<br><br><pre class=code>
MonkeyGame.as(1504):col: 35 Error: Access of undefined property game.

var paramObj:Object = LoaderInfo(game.root.loaderInfo).parameters;

MonkeyGame.as(1510):col: 2 Error: Access of undefined property Security.

Security.allowDomain(apiPath);

MonkeyGame.as(1517):col: 2 Error: Access of undefined property game.

game.addChild(loader);
</pre><br><br>I haven't a clue what I should do to resolve this. Would anyone be able to offer a little help, please? <br><br></td></tr></table><br>
<a name="2052166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PoliteProgrammer</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, it turns out that these errors can be resolved by substituting 'game' for 'this', which I guess is probably the result of changes to Monkey since the tutorial was written, but it still doesn't seem to want to work for me even after this change. Perhaps a more general post is in order... <br><br></td></tr></table><br>
<a name="2052152"></a>

<a name="2052153"></a>

<a name="2052154"></a>

<a name="2052042"></a>

<a name="2052012"></a>

<a name="2052231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I received your e-mail about this (since it is also my tutorial). I have not been using Monkey for a while so it is possible that my code got outdated somehow! :) I will look into it and let you know what I find. <br><br></td></tr></table><br>
<a name="2052232"></a>

<a name="2052233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PoliteProgrammer</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Foppy, I'd really appreciate it! :) <br><br></td></tr></table><br>
<a name="2052251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am sorry, I can't seem to find out what is going on here right away...<br><br>In the old version of "Monkey for Flash" (many months ago) there used to be a variable called "game" which was accessible to the AS code that was added later (in this case, by me). So I could tell "game" to connect to Kongregate. Now in the new version (I just installed v69) this variable is gone. I see that you changed it to use "this" instead, but I have trouble understanding why that would work. I can't find where an instance of the game class (MonkeyGame? BBMonkeyGame?) is created that would then be accessible to my own code.<br><br>I also tried using "this" and indeed it does make the error messages go away. (But I don't understand why.) However, my Monkey Pixels game, compiling correctly to the HTML5 target, now just results in a blue screen for the Flash target (not the Windows kind of blue screen of death, but rather an SWF that just shows a blue rectangle).<br><br>So now I am unsure if this blue screen swf problem is related to the Kongregate problem, or just some other fault in my own game.<br><br>Edit: If I comment out all code in function kongregateInit() in kongregate.as, the game shows up correctly. So it is some problem with the kongregate functionality. I suspect the use of "this" to refer to the flash game is not correct, but I am not certain. <br><br></td></tr></table><br>
<a name="2052250"></a>

<a name="2052255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have reintroduced the variable "game" in file MonkeyGame.as in mygame.build\flash:<br><br><pre class=code>
package{

	import flash.display.*;
	import flash.events.*;

	[SWF(width="640",height="480")]
	
	public class MonkeyGame extends Sprite{
	
		public function MonkeyGame(){
			addEventListener( Event.ADDED_TO_STAGE,OnAddedToStage );
		}
		
		private function OnAddedToStage( e:Event ):void{
		
			// ================
			// ADDED THIS LINE:
			// ================
			game = this;
			
			BBMonkeyGame.Main( this );
		}
	}
}

// ================
// ADDED THIS LINE:
// ================
var game:MonkeyGame;

// rest of the file
// (...)
</pre><br><br>This way I can leave my AS code as it is, refering to game.<br><br>Now I can compile without errors. I am not sure if it actually works as that would require uploading a new version to Kongregate, but at least there are no error messages this way. <br><br></td></tr></table><br>
<a name="2052252"></a>

<a name="2052253"></a>

<a name="2052254"></a>

<a name="2052336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PoliteProgrammer</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, interesting. Does your tutorial .as file work for you with absolutely zero modification after this change? Even though this certainly fixes the unknown 'game' object errors that I got around by just changing 'game' to 'this' directly in my .as file, I still need to change security.allowDomain(apiPath) to this.security.allowDomain(apiPath) to get it to compile without errors. Using game.security.allowDomain(apiPath) still fails to compile with the error "Access of possibly undefined property security through a reference with static type MonkeyGame". I wonder if that's significant.<br><br>But even when I use this.security.allowDomain(apiPath) to make the compiler error go away, I end up with TypeError: Error #1010 at runtime.<br><br>What version of Monkey are you using? I'm on v67f.<br>Edit: Never mind, you said v69 in your other post. I'll update to that now and see if it changes anything. <br><br></td></tr></table><br>
<a name="2052293"></a>

<a name="2052294"></a>

<a name="2052295"></a>

<a name="2052296"></a>

<a name="2065205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Aymes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just in case it helps anyone else who looks at this;<br><br>I added:<br>import flash.system.Security;<br><br>to the top of my kongregate.as file to get around the security issue PoliteProgrammer mentions.<br><br>Foppy - thanks for the tutorial in the first place! Much appreciated :D <br><br></td></tr></table><br>
<a name="2066755"></a>

<a name="2066756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foppy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aymes, thanks for the help! Sorry for not responding before, PoliteProgrammer. I have to admit I am a bit out of Monkey. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
