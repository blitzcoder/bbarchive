<!DOCTYPE html><html lang="en" ><head ><title >Key gets stuck down in Flash sometimes</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Key gets stuck down in Flash sometimes</h1><a href="forums.php" >Monkey Targets Forums</a>/<a href="topics.php?forum=503" >Flash</a>/<a href="#bottom" >Key gets stuck down in Flash sometimes</a><br><br>
<a name="2062051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all, I made a roguelike where you can hold down a key via KeyDown() to move around and it worked great in GLFW but the Flash version had a problem:<br><br>Basically it seemed like the keys (WASD) were "laggy" sometimes and sometimes they would get completely stuck in the down state causing the player to run into a wall forever even though the key was released.  Pressing another key seems to break the repeating key problem. The framerate on my game is set to 60 and my FPS counter says it's running at 60 but sometimes when there's a lot going on this drops to 30FPS. Note that it's almost fine with the cursor keys, just rarely they screw up. Very weird indeed.<br><br>So my theory is that this is a Flash issue (googling reveals other people reporting similar problems and no fixes with other Flash games).  Basically when it gets bogged down with CPU or drawing code it caches a load of keydowns Or maybe it doesn't register key up straight away (or at all).<br><br>Pretty annoying.  So I had to change the game to force you to tap keys (KeyHit) to move around instead.<br><br>By the way I updated Monkey after I read this thread, but it's not this problem: <a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=4827" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=4827</a><br><br>Has anyone else encountered anything similar? Did you figure out a workaround?<br><br>Is there anything Monkey could do when a framerate drop is detected to stop taking in keyboard inputs until everything is caught up? In fact what happens now when monkey drops frames? I believe it skips drawing but keeps processing logic, right? Perhaps I should be using some kind of proper timing system instead now?<br><br>Any advice/discussion most welcome. <br><br></td></tr></table><br>
<a name="2062017"></a>

<a name="2062052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I managed to greatly optimise the drawing in the game and the framerate is much better but still the key sticking problem with WASD persists. Very strange. <br><br></td></tr></table><br>
<a name="2064104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bazmonkey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This bug still exists, as far as I can tell. My latest flash game shows this behavior on Mac/Opera, but not other combinations :/   (tried in monkey 66b and 72b). After 1-2 key presses, the key does not work again. Doesnt seem to affect cursor keys, just other ones, a bit strange. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
