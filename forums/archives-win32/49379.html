<!DOCTYPE html><html lang="en" ><head ><title >Treeview right click</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Treeview right click</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=108" >Win32 Discussion</a>/<a href="#bottom" >Treeview right click</a><br><br>
<a name="549111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yay! A problem, and it's all Windows' fault!<br>Thanks to Kev, I now have popup menus working. However, I still have a problem -- To get them to display, I have to tell Windows to do so myself. I have to call TrackPopupMenu when my program recieves a WM_RButtonUp message. I hope that I am wrong. If I am wrong, please correct me.<br>The problem with using WM_RButtonUp to solve my problem is because, for some stupid reason known only by satan himself, treeviews do not recieve WM_RButtonUp messages whenever they happen. (Generally I have to right click a few times really fast. No, it is not a double-click message). They do, however, always recieve WM_LButtonUp messages whenever they happen.<br>So, I need any of the following:<br>- A simple way to recieve a WM_RBUTTONUP message, whenever it happens, with a treeview.<br>- A way to tell Windows that a popup menu belongs to a gadget, so that I do not need to pop it up myself.<br>- A message that is sent to a window to tell it to open a popup menu. <br><br></td></tr></table><br>
<a name="549911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> MSDN has, by far, the worst documentation I have ever seen.<br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/resources/menus/menureference/menumessages/wm_contextmenu.asp" target="_blank">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/resources/menus/menureference/menumessages/wm_contextmenu.asp</a><br>I found that constant only because it was mentioned quietly in a single article that I happened to come across in a search through a hundred forum discussions with the same problem as me. If context menus didn't have three names, this wouldn't have taken so long. To select the tree node when it's right clicked, I do this:<br>apiSendMessage EventSource(),WM_LBUTTONDOWN,0,PeekInt(WinProcReturn,$0C)<br><br>Still won't do right-click with that function, (so so far the only proper context menu I'm getting is done with the menu key on the keyboard) but the explanation is here:<br><a href="http://www.mvps.org/vcfaq/mfc/6.htm" target="_blank">http://www.mvps.org/vcfaq/mfc/6.htm</a><br><br>I think MS made treeviews like this for publicity... <br><br></td></tr></table><br>
<a name="550192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> this could be done using NM_RCLICK the notification message notifies the parent window of a right click event, its recived under the WM_NOTIFY and obtained from NMHDR structure, ie. pnmh = (NMHDR FAR *) lParam; NMHDR still needs fixing under winblitz3d. <br><br>kev <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
