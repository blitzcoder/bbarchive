<!DOCTYPE html><html lang="en" ><head ><title >Editable List View?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Editable List View?</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=108" >Win32 Discussion</a>/<a href="#bottom" >Editable List View?</a><br><br>
<a name="523876"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am trying to create an editable Windows listview in WinBlitz 3d (like here: <a href="http://www.codeproject.com/listctrl/listeditor.asp" target="_blank">http://www.codeproject.com/listctrl/listeditor.asp</a> ). I have the listview, but I don't know how to make it editable.<br><br>I think that the constant I want to pass to it as a style parameter is LVS_EDITLABELS. I did find the constant. The only place I could find the actual number (rather than just its name) after a 30 minute search all over the Internet was here: <a href="http://vbnet.mvps.org/index.html?code/comctl/lvmembers.htm" target="_blank">http://vbnet.mvps.org/index.html?code/comctl/lvmembers.htm</a><br>Now. VB has the constant written as Const LVS_EDITLABELS = &amp;H200. Blitz does not understand the H part (already changed the &amp; to $). How can I make it so that Blitz knows what it's doing?<br><br>Anyway, here's the main question so you don't forget in the midst of my ramblings: How do I turn a regular listview into an editable listview? I think that it is with the use of the LVS_EDITLABELS, but I can't find out the value for that flag that Blitz would use.<br><br><br>If Win32 just took strings... or normal numbers... none of this rubbish would happen. <br><br></td></tr></table><br>
<a name="523879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Blitz does not understand the H part (already changed the &amp; to $). How can I make it so that Blitz knows what it's doing?<br> <br></div><br>try using decimal 512 instead.<br><br>what about <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/listview/messages/lvm_editlabel.asp" target="_blank">LVM_EDITLABEL</a>?<br><div class="quote"> <br>The LVM_EDITLABEL message begins in-place editing of the specified list view item's text. The message implicitly selects and focuses the specified item. You can send this message explicitly or by using the ListView_EditLabel macro.<br><br>LVM_EDITLABEL  <br>wParam = (WPARAM) (int) iItem; <br>lParam = 0; <br> <br><br>Parameters<br><br>iItem<br><br>Index of the list view item. To cancel editing, set iItem to -1.<br><br> <br><br>Return Values<br><br>Returns the handle of the edit control that is used to edit the item text if successful or NULL otherwise.<br><br>Remarks<br><br>When the user completes or cancels editing, the edit control is destroyed and the handle is no longer valid. You can safely subclass the edit control, but you should not destroy it. <br>The control must have the focus before you send this message to the control. Focus can be set using the SetFocus function.<br><br>See Also<br><br>ListView_EditLabel, WM_CANCELMODE, SetFocus <br> <br></div> <br><br></td></tr></table><br>
<a name="523880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fastest response ever in this section. Even after I spelled Perturbatio wrong :D<br>Thanks!<br>Trying now. <br><br></td></tr></table><br>
<a name="523882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> can't guarantee another fast response for at least 9 hours, it's 5:37am here and I haven't slept yet (I am about to). <br><br></td></tr></table><br>
<a name="523889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean by "try using decimal 512 instead."? (I have tried $512, $0512, $.512, .512). I also tried $200, but it didn't seem to work either. (Note: I am probably missing something here)<br><br>LVM_EDITLABEL looks like it works, but causes me an MAV for some reason. Though, it appears to be a forced thing rather than just the user double clicking on a field and editing it. <br><br></td></tr></table><br>
<a name="523966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> try just 512 instead of $512 (decimal instead of hexadecimal)<br>*EDIT*<br>ah, if you've done $200 then that is 512 as hex. <br><br></td></tr></table><br>
<a name="523994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You want to replace &amp;H with $ in C to Blitz conversions, ie. &amp;H200 becomes $200, &amp;H1AB becomes $1AB, etc -- it's a hexadecimal number. <br><br></td></tr></table><br>
<a name="524013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sweenie</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> What viewtype are you using?<br><br>LargeIcon, SmallIcon, Detail or list?<br><br>LabelEdit will make the main items editable, but not by doubleclicking on them.<br>You edit them by first singleclicking them and singleclick again within a few seconds(just like you rename files in the explorer)<br><br>However, if you are using the details-view, the subitems(the items in the columns next to the first) can't be edited.<br>However, you can detect a mouseclick and display a normal textbox covering the subitems bounding rectangle.<br>Search for Editable Listview on google for tutorials. <br><br></td></tr></table><br>
<a name="524044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, got it all in but it won't work for one reason or another (and I think I know why), so I'll go with Sweenie's advice (which I thankfully know how to do).<br>Thanks a lot for all the help! <br><br></td></tr></table><br>
<a name="524810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did the basic thing, but I have one problem:<br>It does not seem to be possible to delete my text boxes in order to put in new ones when the user clicks on the list in a different spot, unless the text boxes are already unfocussed. I tried to unfocus them using sendmessage and WM_KILLFOCUS. It caused an MAV.<br><br>If a textbox is in focus already, the event of the user clicking on the listview is not registered.<br><br>So... um... My problem entirely pivots around:<br>api_SendMessage VarsList_EditA,WM_KILLFOCUS,0,0<br><br>The constant WM_KILLFOCUS is defined. It equals $0008.<br><br>What am I doing wrong?<br><br><br><br>It looks like, for the more proper plan, I want to do this:<br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemWindowsFormsTreeViewClassLabelEditTopic.asp" target="_blank">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfSystemWindowsFormsTreeViewClassLabelEditTopic.asp</a><br>How do I set that property to true? (or is it just LVS_EDITLABELS?) <br><br></td></tr></table><br>
<a name="524935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where are you setting LVS_EDITLABELS, it should be placed like this ex:<br><pre class=code>
CreateWindowEx(WS_EX_CLIENTEDGE, "SysTreeView32", Null, WS_VISIBLE|WS_CHILD| WS_CLIPSIBLINGS| LVS_EDITLABELS, x, y,
w, h, group, Null ,hInstance, Null)
</pre><br>this is not tested but you have to put it there, and i am pretty sure you cant do it this way Sendmessage( treeview, LVS_EDITLABELS, True, null ) because i think you have to do it when the treeview is created not after. <br><br></td></tr></table><br>
<a name="524987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, yup, I had set that :( <br><br></td></tr></table><br>
<a name="525248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh wow!<br>I just had a hunch, and I was right.<br>I have wasted two days' worth of valuable programming time now (and it's running short because of the blasted sun!!), because of an error in my user32.decls file. The api_sendmessage command would cause an MAV no matter what.<br>I was just thinking "Hey, maybe I'll try the sendmessage that came with winblitz, since I'm out of ideas". So I removed the underscore, tested it, and BANG it worked!<br>So, this is probably the proper user32.decls api_sendmessage declaration:<br>api_SendMessage%(hWnd%,Msg%,wParam%,lParam%):"SendMessageA" <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
