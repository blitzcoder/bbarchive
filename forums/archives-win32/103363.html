<!DOCTYPE html><html lang="en" ><head ><title >Play Videos?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Play Videos?</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=108" >Win32 Discussion</a>/<a href="#bottom" >Play Videos?</a><br><br>
<a name="1243918"></a>

<a name="1243919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone know of a module or script better than the one builtin to winmm.dll? Here's the topic about that dll, but it isn't what I need:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=45546" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=45546</a><br><br>The problem is the video can't loop endlessly (as an option) and can't stretch to fill different aspect ratios and sizes. While the video control can resize, it only can if the destination size is both the same aspect ratio and a multiple of the original video's size.<br><br>DirectShow is the perfect alternative as I've seen C++ examples of what it can do but I have no idea how to incorperate that into blitzmax.<br><br>Any ideas? Thanks. <br><br></td></tr></table><br>
<a name="1243973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What are you hoping to accomplish? <br><br>Do you need a generic video player that can support multiple formats, or do you 'just' need something to play a cutscene video or something where you control the file format yourself?<br><br>Which language are you trying to use it with? blitzmax, b3d, ...?<br><br>If you control the video formats yourself, then there are several video playback modules available for blitzmax: pantsonhead wrote two modules, one to play back Ogg Vorbis (MIT or BSD license, don't remember), and one for MPEG (GPL licensed). IIRC Brucey also has some video playback module somewhere in his SVN repository. <br><br></td></tr></table><br>
<a name="1243974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using blitzmax. I'm trying to create a DLL that can play videos for use in a game engine. AVI, MP4, MPG, and/or WMV are my most preferred formats. <br><br>Apparently there's a QuickTime module too but requires having quick time installed + a lot of other things that are kinda inconvenient.<br><br>Thanks for the info, I have a look at those and will get back to you. :) I've tried Brucey's video player but it can only handle OGG which isn't my preference, but if that turns out to be my only option, it's better than nothing! :) <br><br></td></tr></table><br>
<a name="1244141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya tkg,<br><br>I use directshow at work and I've made complete apps and directshow filters that do all kinds of amazing things. With directshow you can play any audio or video file as long the host machine has the appropriate codecs and DS filters. It can really simple as DS defaults to using an intelligent system to create a playback graph automatically, which means that its actually quite trivial to achieve, or you can also be very specific as to which filters/codecs/media types/media formats are used for recording and playback.<br><br>Youre best to make the dll in c++, as you suggest, then use a simple c style interface as an API to the dll. In 'Max its then trivial to load the dll and create function bindings to the dll functions. If you wanted to you can then wrap those functions in 'Max Types to give you an OO style interface in 'Max.<br><br>What kind of help do you need and I'll help. <br><br></td></tr></table><br>
<a name="1244169"></a>

<a name="1244170"></a>

<a name="1244171"></a>

<a name="1244172"></a>

<a name="1244173"></a>

<a name="1244174"></a>

<a name="1244175"></a>

<a name="1244407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Dave! Here's my current code but I have a long way to go before it will compile without errors, but it least it should show you what I want to achieve function-wise. I personally only care about AVI playback. It doesn't have to be that fancy or support that many potential codecs.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">/** Copyright (C) 2013 Robert B. Colton
***
*** This file is a part of the ENIGMA Development Environment.
***
*** ENIGMA is free software: you can redistribute it and/or modify it under the
*** terms of the GNU General Public License as published by the Free Software
*** Foundation, version 3 of the license or any later version.
***
*** This application and its source code is distributed AS-IS, WITHOUT ANY
*** WARRANTY {
} without even the implied warranty of MERCHANTABILITY or FITNESS
*** FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
*** details.
***
*** You should have received a copy of the GNU General Public License along
*** with this code. If not, see &lt;http://www.gnu.org/licenses/&gt;
**/

#include &lt;windows.h&gt;
#include "VideoStruct.h"
#define DLL extern "C" _declspec(dllexport)

HWND hWnd=NULL;
DLL double video_add(HWND window1,double window2,char *fname) {
	VideoStruct* videoStruct = new VideoStruct();
    IGraphBuilder *pGraph = NULL;

    // Initialize the COM library.
    HRESULT hr = CoInitialize(NULL);
    if (FAILED(hr))
    {
	   MessageBox(NULL, "Failed to initialize COM library.", "ERROR", MB_ICONERROR | MB_OK);
        return -1;
    }

    // Create the filter graph manager and query for interfaces.
    hr = CoCreateInstance(CLSID_FilterGraph, NULL, CLSCTX_INPROC_SERVER,
                        IID_IGraphBuilder, (void **)&amp;pGraph);
    if (FAILED(hr))
    {
		MessageBox(NULL, "Failed to create the Filter Graph Manager.", "ERROR", MB_ICONERROR | MB_OK);
        return -1;
    }


	// Build the graph.
    hr = pGraph-&gt;RenderFile(std::wstring(fname.begin(), fname.end()).c_str(), NULL);

	IVideoWindow *pVidWin = NULL;
	pGraph-&gt;QueryInterface(IID_IVideoWindow, (void **)&amp;pVidWin);

	if (window1!=NULL) hWnd=window1;
	if ((HWND)(DWORD)window2!=NULL) hWnd=(HWND)(DWORD)window2;
	pVidWin-&gt;put_Owner((OAHWND)hWnd);

	pVidWin-&gt;put_WindowStyle(WS_CHILD | WS_CLIPSIBLINGS);

	videoStruct-&gt;pGraph = pGraph;
	videoStructs.push_back(videoStruct);
	return videoStructs.size() - 1;
}

DLL double video_delete(double id) {
	get_video(videoStruct, id);
	delete videoStructs[id];
	return 0;
}

DLL double video_exists(double id) {
	return (videoStructs[id] != NULL);
}

DLL double video_start(double id, double loop) {
	get_video(videoStruct, id);
	IMediaControl *pControl = NULL;
    IMediaEvent   *pEvent = NULL;
    HRESULT hr = videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IMediaControl, (void **)&amp;pControl);
    hr = videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IMediaEvent, (void **)&amp;pEvent);

	// Run the graph.
    hr = pControl-&gt;Run();
    while (SUCCEEDED(hr)) {
        RECT rc;
        GetClientRect(hWnd,&amp;rc);
        video_set_scale(id,0,0,rc.right,rc.bottom);
        if (SUCCEEDED(hr)) {
            // Wait for completion.
            double evCode;
            //pEvent-&gt;WaitForCompletion(INFINITE, &amp;evCode);
        } else {
			MessageBox(NULL, "Failed to run the COM control.", "ERROR", MB_ICONERROR | MB_OK);
			// Don't return so pointers can be released.
		}
        if (video_get_seek(id)==video_get_duration(id)) {
            if (loop) {
                video_set_seek(id, 0);
            } else {
                break;
            }
        }
    }
	if (FAILED(hr)) {
		MessageBox(NULL, "Failed to render the Filter Graph Manager.", "ERROR", MB_ICONERROR | MB_OK);
		// Don't return so pointers can be released.
    }

    pControl-&gt;Release();
	pEvent-&gt;Release();
	return 0;
}

DLL double video_stop(double id) {
	video_set_seek(id, video_get_duration(id)+1);
	return 0;
}

DLL double video_set_seek(double id, double position) {
	get_video(videoStruct, id);
	IMediaSeeking* pSeek;
	HRESULT hr = videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IMediaSeeking, (void**)&amp;pSeek);
	DWORD dwCap = 0;
	hr = pSeek-&gt;GetCapabilities(&amp;dwCap);

	if (AM_SEEKING_CanSeekAbsolute &amp; dwCap)
	{
		// Graph can seek to absolute positions.
		REFERENCE_TIME rtNow = position;
		hr = pSeek-&gt;SetPositions(
			&amp;rtNow, AM_SEEKING_AbsolutePositioning,
			NULL, AM_SEEKING_NoPositioning
			);
	}

	pSeek-&gt;Release();
	return 0;
}

DLL double video_set_rectangle(double id, double x,double y,double width,double height) {
	get_video(videoStruct, id);
	IVideoWindow *pVidWin = NULL;
	videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IVideoWindow, (void **)&amp;pVidWin);
	pVidWin-&gt;SetWindowPosition(x, y, width, height);
	return 0;
}

DLL double video_get_seek(double id) {
	get_videor(videoStruct, id, -1);
	IMediaSeeking* pSeek;
	HRESULT hr = videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IMediaSeeking, (void**)&amp;pSeek);
	DWORD dwCap = 0;
	hr = pSeek-&gt;GetCapabilities(&amp;dwCap);

	double double position = 0;
	if (AM_SEEKING_CanSeekAbsolute &amp; dwCap)
	{
		hr = pSeek-&gt;GetCurrentPosition(&amp;position);
	}

	pSeek-&gt;Release();

	return position;
}

DLL double video_get_duration(double id) {
	get_videor(videoStruct, id, -1);
	IMediaSeeking* pSeek;
	HRESULT hr = videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IMediaSeeking, (void**)&amp;pSeek);
	DWORD dwCap = 0;
	hr = pSeek-&gt;GetCapabilities(&amp;dwCap);

	double double duration = 0;
	if (AM_SEEKING_CanSeekAbsolute &amp; dwCap) //TODO: This if check might not be needed
	{
		hr = pSeek-&gt;GetDuration(&amp;duration);
	}

	pSeek-&gt;Release();

	return duration;
}

DLL double video_get_width(double id) {
	get_videor(videoStruct, id, -1);
	IBasicVideo *pBasicVideo;
	videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IBasicVideo,
	 (LPVOID *)&amp;pBasicVideo);

	// obtain width
	double width;
	pBasicVideo-&gt;get_VideoWidth(&amp;width);

	// release
	pBasicVideo-&gt;Release();

	return width;
}

DLL double video_get_height(double id) {
	get_videor(videoStruct, id, -1);
	IBasicVideo *pBasicVideo;
	videoStruct-&gt;pGraph-&gt;QueryInterface(IID_IBasicVideo,
	 (LPVOID *)&amp;pBasicVideo);

	// obtain height
	double height;
	pBasicVideo-&gt;get_VideoHeight(&amp;height);

	// release
	pBasicVideo-&gt;Release();

	return height;
}</textarea><br><br>I can give you the required headers too if you need it, but it would make things more confusing as my DLL is being based on a DS video player for an open source GPL game engine known as ENIGMA. If you help me with this, and we actually get it working, I'd love to make it as an extension for GameMaker:Studio as I originally planned, but also a BlitzMax module as many people I've seen here have wanted this too.<br><br>I don't know the extent of how much you'd be willing to help me with this, any chance we could discuss this on Facebook, email, or some other means you'd prefer, I can do Skype too, whatever you need. :) Thank you so much! :D<br><br>My email is samuelvenable@... I'll check my spam folder as that's were new mailers end up :) <br><br></td></tr></table><br>
<a name="1244189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  What kind of help do you need and I'll help. <br></div><br>Heh :-)<br><br><div class="quote"> I'd love to make it as an extension for GameMaker:Studio <br></div><br>It seems a bit strange, to me at least, that you continue to try to use BlitzMax to staple things to the side of GameMaker.<br>Maybe you are using the wrong tools to begin with, if GameMaker isn't doing what you want?<br>But I don't think BlitzMax is the ideal tool for making add-ons for GameMaker.<br><br>You'd probably be better off learning C++ properly, perhaps?<br>Or move to a product that does what you need? <br><br></td></tr></table><br>
<a name="1244201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It seems a bit strange, to me at least, that you continue to try to use BlitzMax to staple things to the side of GameMaker. <br></div><br><br>I must have missed those posts :p<br><br>I agree with the rest of what Brucey said:- if is your main goal is writing add-ons for GameMaker then using BlitzMax to do it is double the work. Youd be better off just sinking your teeth into c++, but each to their own.<br><br>On the other hand, having a little DShow module for 'Max would increase choice for the windows users for audio and video playback ( DShow is typical MS overkill and over featured ), but hey even if it is just for Windows and not for the lesser known OSs :0) <br><br></td></tr></table><br>
<a name="1244202"></a>

<a name="1244203"></a>

<a name="1244204"></a>

<a name="1244205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Brucey - The features I'm adding to GameMaker many users complained about because YYG dropped support for them completely. And so I'm adding it all back. I personally don't need it, but it's in high demand at the moment. As I already stated at this point I'll be doing it in c++ instead. Thanks. :)<br><br>@col so you've changed your mind about helping? It's okay, I understand. <br><br></td></tr></table><br>
<a name="1244222"></a>

<a name="1244223"></a>

<a name="1244224"></a>

<a name="1244227"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nah, ive not changed my mind at all :P if you can email the other files over it will be a doddle.<br><br>May as well make the bindings for Max too while we're at it.<br><br>edit:- the email addy is in my profile<br>edit2:- is there any particular reason youre saving the graph instance? do you want to playback more than video at the same time? <br><br></td></tr></table><br>
<a name="1244234"></a>

<a name="1244235"></a>

<a name="1244236"></a>

<a name="1244237"></a>

<a name="1244240"></a>

<a name="1244251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the meantime to whet your appetite you can create and build an extremely basic player using this code...<br><br>compile this code as a dll, say with a silly name like <b>DShowForMax.dll</b> or whatever you want to call it.<br>Ive removed all of the error checking just for clarity. its VERY important to check those hr values in case something has gone wrong.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

#include &lt;windows.h&gt;
#include &lt;DShow.h&gt;

#define DLL extern "C" _declspec(dllexport)

DLL int video_init(){
	// Initialize the COM library.
	if(FAILED(CoInitialize(NULL))){
		MessageBox(NULL,L"Failed to initialize COM library.",L"ERROR", MB_ICONERROR | MB_OK);
		return false;
	}

	return true;
}

DLL void video_uninit(){
	// self explanatory
	CoUninitialize();
}

DLL IGraphBuilder* video_add(HWND window1,double window2,LPCWSTR fname) {
    IGraphBuilder *pGraph = NULL;
	HRESULT hr = S_OK;

    // Create the filter graph manager and query for interfaces.
	hr = CoCreateInstance(CLSID_FilterGraph, NULL, CLSCTX_INPROC_SERVER, IID_IGraphBuilder, (void **)&amp;pGraph);

	// Build the graph.
    hr = pGraph-&gt;RenderFile(fname, NULL);
	if(FAILED(hr)) return NULL;

	IVideoWindow *pVidWin = NULL;
	hr = pGraph-&gt;QueryInterface(IID_IVideoWindow, (void **)&amp;pVidWin);

	hr = pVidWin-&gt;put_Owner((OAHWND)window1);
	hr = pVidWin-&gt;put_WindowStyle(WS_CHILD | WS_CLIPSIBLINGS);
	pVidWin-&gt;Release();

	IMediaControl* pControl = NULL;
	hr = pGraph-&gt;QueryInterface(IID_IMediaControl,(void**)&amp;pControl);
	hr = pControl-&gt;Run();
	hr = pControl-&gt;Pause();

	pControl-&gt;Release();

	return pGraph;
}

DLL void video_start(IGraphBuilder* pGraph) {
	IMediaControl *pControl = NULL;
	HRESULT hr = S_OK;

	hr = pGraph-&gt;QueryInterface(IID_IMediaControl, (void **)&amp;pControl);
	hr = pControl-&gt;Run();
	pControl-&gt;Release();
}

DLL void video_stop(IGraphBuilder* pGraph) {
	IMediaControl* pControl = NULL;
	IMediaSeeking* pSeek = NULL;
	REFERENCE_TIME stoptime = 0;
	HRESULT hr = S_OK;

	hr = pGraph-&gt;QueryInterface(IID_IMediaControl,(void**)&amp;pControl);

	OAFilterState fs;
	hr = pControl-&gt;GetState(100,&amp;fs);
	
	switch(fs){
	case State_Running:
		hr = pControl-&gt;Pause();
		// deliberately let this fall through...
	case State_Paused:
		pGraph-&gt;QueryInterface(IID_IMediaSeeking,(void**)&amp;pSeek);	
		hr = pSeek-&gt;SetPositions(&amp;stoptime,AM_SEEKING_AbsolutePositioning,0,AM_SEEKING_NoPositioning);
	}
	
	pControl-&gt;Release();
	if(pSeek) pSeek-&gt;Release();
}

DLL void video_pause(IGraphBuilder* pGraph){
	IMediaControl* pControl = NULL;
	HRESULT hr = S_OK;

	pGraph-&gt;QueryInterface(IID_IMediaControl,(void**)&amp;pControl);
	hr = pControl-&gt;Pause();
	pControl-&gt;Release();
}

DLL void video_delete(IGraphBuilder* pGraph){
	pGraph-&gt;Release();
}

DLL void video_set_rectangle(IGraphBuilder* pGraph,int x,int y,int w,int h) {
	HRESULT hr = S_OK;
	IVideoWindow *pVidWin = NULL;

	hr = pGraph-&gt;QueryInterface(IID_IVideoWindow,(void**)&amp;pVidWin);
	hr = pVidWin-&gt;SetWindowPosition(x, y, w, h);
	pVidWin-&gt;Release();
}

</textarea><br><br>Maxcode:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import MaxGui.Drivers

' dll stuff
Global DShowForMaxDll = LoadLibraryA("DShowForMax.dll")

Global video_init() = GetProcAddress(DShowForMaxDll,"video_init")
Global video_uninit() = GetProcAddress(DShowForMaxDll,"video_uninit")

Global video_add:Byte Ptr(window1,window2:Double,fname$w)"Win32" = GetProcAddress(DShowForMaxDll,"video_add")
Global video_start(id:Byte Ptr)"Win32" = GetProcAddress(DShowForMaxDll,"video_start")
Global video_stop(id:Byte Ptr)"Win32" = GetProcAddress(DShowForMaxDll,"video_stop")
Global video_pause(id:Byte Ptr)"Win32" = GetProcAddress(DShowForMaxDll,"video_pause")
Global video_delete(id:Byte Ptr)"Win32" = GetProcAddress(DShowForMaxDll,"video_delete")
Global video_set_rectangle(id:Byte Ptr,x,y,w,h)"Win32" = GetProcAddress(DShowForMaxDll,"video_set_rectangle")






' app
Local win:TGadget = CreateWindow("DirectShow in BLitzmax",0,0,800,600,Desktop(),WINDOW_TITLEBAR|WINDOW_CENTER)
Local play:TGadget = CreateButton("Play",10,10,80,20,win)
Local stop:TGadget = CreateButton("Stop",100,10,80,20,win)
Local pause:TGadget = CreateButton("Pause",190,10,80,20,win)
Local video:TGadget = CreatePanel(30,60,800-60,600-120,win)
Local client = QueryGadget(video,QUERY_HWND_CLIENT)

' initialise COM via the dll
video_init

Local avifile$ = "c:\test_file.avi"
Local avi:Byte Ptr = video_add(client,0,avifile) ' make sure the file is there before loading :^)
If Not avi
	Notify "Video "+avifile+" cannot be found!"
	video_uninit
	End
EndIf

video_set_rectangle(avi,0,0,GadgetWidth(video),GadgetHeight(video))

Repeat
	WaitEvent()
	Local ev:TEvent = CurrentEvent
	
	Select ev.id
		Case EVENT_WINDOWCLOSE
			video_stop(avi)
			video_delete(avi)
			video_uninit ' uninit COM via the dll
			End
			
		Case EVENT_GADGETACTION
			If ev.source = play video_start(avi)
			If ev.source = stop video_stop(avi)
			If ev.source = pause video_pause(avi)
			
	EndSelect
Forever



</textarea><br><br><br>Put the dll file in the same folder as the 'max exe so that the 'max exe can find it easily enough. There is a little bit of graph state checking to show you how it can be done.<br><br>It should be a good start to get you going and enough to finish up what you have tried to do so far. It will play any file format that you have codecs and filters for. You can use the same dll for all audio files too ( same applies for codecs/filters ) but you'll just need to make sure the query for the IVideoWindow succeeds or fails and skip the relevant video code path etc.<br><br>I understand that you were putting the graphs into a list but here i use a single graph for a single vid to get something up and running for you. Its trivial enough to do what you were doing before - using a list and an index etc.<br><br>Any probs let me know. <br><br></td></tr></table><br>
<a name="1244396"></a>

<a name="1244397"></a>

<a name="1244405"></a>

<a name="1244406"></a>

<a name="1244416"></a>

<a name="1244417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awsome! This is great! Thank you!!! BTW I reponded to your email :) I'm trying your code as we speak and I'll get back to you asap! :D<br><br>Edit. It gave me errors. Do I need VisualStudio express' headers and compiler for this? I'm using CodeBlocks and MinGW at the moment.<br><br>Edit2. Any chance you could just send me the DLL binary and VS project folder? That would be perfect! I'll be sure to credit you if you don't already mention yourself in the credits. :) <br><br></td></tr></table><br>
<a name="1244422"></a>

<a name="1244424"></a>

<a name="1244433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>You'll need a windows sdk for definite. I dont see why it wouldn't work with express editions of studio and/or code blocks, its mainly MFC components thats missing from the express versions of studio and the sdks anyway.<br><br>I'll send you the binary and project files over now... Sent. <br><br></td></tr></table><br>
<a name="1244632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you so much for all the help col! I did a couple replies to your email be sure to check that when you get the chance! Thank you! :D <br><br></td></tr></table><br>
<a name="1245763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >time-killer-games</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> This topic may be closed. Thanks. <br><br></td></tr></table><br>
<a name="1245792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no "open" or "closed", all postings/threads can be added to indefinitely. <br><br></td></tr></table><br>
<a name="1245818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless it is locked.... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
