<!DOCTYPE html><html lang="en" ><head ><title >Incorrect Windows Version returned</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Incorrect Windows Version returned</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=108" >Win32 Discussion</a>/<a href="#bottom" >Incorrect Windows Version returned</a><br><br>
<a name="1187418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I try obtaining the OS either via (GetEnv("OS")) or by using the AdvApi32.dll registry queries for HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\" I am not getting the expected result.<br><br>Although manually examining the registry with RegEdt32.exe shows that the values ProductName and CurrentVersion etc. are all as expected for Windows 8 (i.e. version = 6.2)<br><br>Whenever I use BlitzPlus with Advapi32.dll decls or the GetEnv("OS") - the result obtained suggests Windows XP!<br><br>It seems to be a similar situation to the one reported by a user of Wise install script:<br><a href="http://www.symantec.com/connect/forums/need-help-identifiying-vista-32bit-machine-my-wisescript-wise-installation-studio-70-0" target="_blank">http://www.symantec.com/connect/forums/need-help-identifiying-vista-32bit-machine-my-wisescript-wise-installation-studio-70-0</a><br><br>I am running 32-bit version of Windows 8 only. <br><br></td></tr></table><br>
<a name="1187427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Vista was 6.0, Windows 7 is 6.1, windows 8 is 6.2 That's correct. They found lots of coders checking WRONG for the major windows version using those calls to ensure that windows was XP (and not older) by checking the major number was 5, so all those badly coded programs did not work on Vista when it reached the "6" so, to survive from bad code, they're now updating the minor number instead, in the hope to maintain a better backwards craptability ups, I meant, compatibility. I supose those coders that just checked equality with major version number, were the same ones that did cause the 2000 effect.... <br><br></td></tr></table><br>
<a name="1187431"></a>

<a name="1187432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ziggy, this was nothing to do with interpretation, the actual values returned were inaccurate, suggesting WIndows XP (5.1) rather than Windows 8 (6.2) that should be returned.<br><br>I even tried "Kernel32.dll" GetVersionEx() but with the same, incorrect results.<br><br><br>edit:<br>PROBLEM SOLVED!<br><br>After all that, the version of IDEal I am using was set to run in WindowsXP Compatibility mode - Interesting point for the future, just how in-depth the compatibility mode actually seems to affect things :) <br><br></td></tr></table><br>
<a name="1187435"></a>

<a name="1187436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Compatibility mode affects SystemProperty("OS") but not GetEnv("OS"), at least on my 64-bit Windows 7 PC. GetEnv("OS") returns "Windows_NT" and that's exactly what cmd.exe shows.<br><br>You can run the command processor on Windows 7 by typing cmd where it says "Search programs and files" in the task bar. To display all environment variables use the Set command with no arguments.<br><br>Or you can use Set OS to show just the OS variable. <br><br></td></tr></table><br>
<a name="1187437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aaah ok, I misread the post! Glad you solved it <br><br></td></tr></table><br>
<a name="1187447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Compatibility mode affects SystemProperty("OS") but not GetEnv("OS") <br></div><br>Yes, sorryt I should have said SystemProperty()<br>Regardless, taht's not really relevant to this situation.<br><br><div class="quote"> <br>You can run the command processor on Windows 7 by typing cmd where it says "Search programs and files" in the task bar. To display all environment variables use the Set command with no arguments.<br><br>Or you can use Set OS to show just the OS variable.  <br></div><br>Not sure how this would help in any way since "Windows_NT" is displayed for all OS since Windows 3.5 <br><br></td></tr></table><br>
<a name="1187448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about this?<br><br><a href="/codearcs/codearcs.php?code=2983" >Windows version detection</a> <br><br></td></tr></table><br>
<a name="1187496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, James - but that would have returned the wrong value too, since that is how Kernel32.dll "GetVersionEx()" operates - Running IDEal without Compatibility mode for XP solves the whole thing though, so no worries. <br><br></td></tr></table><br>
<a name="1187522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> 'incorrect' windows version returned by running in XP compatibility mode is  prett ymuch the entire point of compatibility mode in the first place: It often allows you to run a poorly-written older piece of software that explicitly tests if it's running on XP (or XP + 2000, or...) and would otherwise simply refuse to run because it assumes you're running on something 'not supported', even when there's no technical reason for preventing this.<br><br>Compatibility mode bypasses the OS check by lying to the program about what OS it really runs under, and in most cases it turns out that it will run just fine under Vista / 7 / 8 / whatever. <br><br></td></tr></table><br>
<a name="1190840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> 'incorrect' windows version returned by running in XP compatibility mode is prett ymuch the entire point of compatibility mode in the first place: It often allows you to run a poorly-written older piece of software that explicitly tests if it's running on XP (or XP + 2000, or...) and would otherwise simply refuse to run because it assumes you're running on something 'not supported', even when there's no technical reason for preventing this.<br><br>Compatibility mode bypasses the OS check by lying to the program about what OS it really runs under, and in most cases it turns out that it will run just fine under Vista / 7 / 8 / whatever.  <br></div><br>Oh absolutely, of course it is! And I don't consider this to be a bug or error or issue at all - In fact, it's really reassuring to see the level of 'detail'' that compatibility mode actually infers when considering such things.<br><br>The problem was, that I had forgotten and didn't realise I was running under compatibility mode (Not even sure why I did so in the first place!) and so I was unaware and assumed I was just running IDEal / Blitz normally - which is why I was so puzzled :) <br><br></td></tr></table><br>
<a name="1190861"></a>

<a name="1190868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's very easy to get confused by compatibility issues. I was reminded of this recently when some "drive letter" code showed drive Q, which does not exist. It was a virtual drive created long ago by a trial version of Windows Office.<br><br>I know these things are difficult because even <a href="http://blogs.technet.com/b/markrussinovich/archive/2009/02/03/3174194.aspx" target="_blank">Mark Russinovich</a> runs across behavior he hasn't seen before. <br><br></td></tr></table><br>
<a name="1191331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Incidentally, using the AdvAPI32.dll to query Registry, even when running in compatibility modes in Windows 8, "Windows '95" and "Windows 98" show up as Windows 8. I'm gonna risk a guess that the registry didn't hold the values in the same way pre Windows 2000<br><br>Not that I'm particularly fussed, since I doubt I'd really be too concerned with compatibility for pre-WindowsXP but I thought I'd just mention it, seeing as it's sort of related :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
