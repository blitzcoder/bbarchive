<!DOCTYPE html><html lang="en" ><head ><title >Dual boot Vista and Windows 9x / ME on one drive</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Dual boot Vista and Windows 9x / ME on one drive</h1><a href="forums.php" >Archives Forums</a>/<a href="topics.php?forum=108" >Win32 Discussion</a>/<a href="#bottom" >Dual boot Vista and Windows 9x / ME on one drive</a><br><br>
<a name="708934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had a few probs doing this and there was no real help on the net to do it, so I'll just jot down a few points here in case someone ever needs them.  Hopefully Google will pick this up, making it useful ;]<br><br>The problem: Vista's new improved boot loader can only natively boot Vista, or an NT based system.  Microsoft don't officially support Win9x systems anymore...  but they created the files necessary to do this, so thanks, MS!<br>The solution: Either something like GRUB, but that wasn't available to me (footnote 1), or use Vista's boot loader to load NT's bootloader, which is capable of loading a DOS environment ;]<br>Requirements: On top of Win98 and Vista, you will need one file from Win2000, WinXP or Win2003 for their bootloader.  These can be taken from an existing installation or from the install cd.  Also VistaBoot PRO, unless you know how to use bcdedit manually (shudders).  You can get that for free from www.vistabootpro.org.<br><br>Guide:<br>Win98 can only run from a FAT16 or FAT32 partition and Vista can only run from an NTFS partition, so set up your partitions accordingly - however the FAT32 partition needs to be the first partition on the disc (because of Win98's crappiness).  Install Win98 first, Vista last.  Any NT based OS should be installed in between and will provide you the necessary NTLDR file later on.  Install VistaBoot PRO.  Use it to add a legacy OS on the D drive (footnote 2).  If you go to the top menu tab and the extended description and scroll down to the legacy entry, you will see it points to NTLDR.  This file can be grabbed from the boot partition of an NT install (in which case it's probably in the right place already - the first patition on you drive, the Win98 partition), or from the install cd, in the i386 directory.  Next, in the same directory, you need to create a boot.ini (I will cover a minimal ini for Win98 only, if you have an NT OS installed you will need to tweak this yourself, but there's heaps of info out there on that):<br><pre class=code>
[boot loader]
timeout=0
default=C:\
[operating systems]
</pre><br>Next, you will need the first 512bytes of the Win98 partition for the MSDOS bootstrip, which can be gained in a number of ways, thankfully Vista does this job for you during installation (unless you had some other NT based OS installed) - just rename BOOTSECT.BAK in your Win98 partition to BOOTSECT.DOS - and that's it!  Next boot you should get Vista's boot loader displaying Vista and whatever name you gave the legacy OS ('Microsoft Windows ' by default).  Select the legacy OS and you're in!<br><br>End of guide!  Extra bits:<br>If you change the timeout in boot.ini to something higher, you will see the NT bootloader come up with two entries (the bottom as default) - both named 'Windows (default)'.  The top one will get the system to try and load an NT based OS, which obviously won't work, which is why I set the timeout to 0.<br><br>There may be a way to boot into Win98 without altering Vista's boot loader (no Vistaboot PRO) - I noticed when I had an operating system entry in boot.ini that it actually popped up in Vista's boot loader as well!  You can do this by putting the following line under the [operating systems] entry:<pre class=code>C:\="Windows ladedah"</pre> - sadly, when actually selecting this entry from Vista's bootloader, I was greeted with a blank screen.  I'm not sure why it went wrong, but it probably has something to do with the new bootloader not being able to boot using BOOTSECT.DOS.  Or, maybe it would work if it pointed to D:\ - I didn't test.<br><br><br><br>(Footnote 1: I would have used GRUB, but I used Win98's fdisk which destroyed my partition table and now Ubuntu's live cd hangs during boot)<br>(Footnote 2: For me, I had a FAT32 and then a NTFS partition, since Vista sees itself as the C drive, it configured the FAT32 partition as the D drive.  You need to tell Vistaboot PRO the drive letter for the partition your installation of Win98 appears on under Vista.  Win98 still thinks of itself as a C drive also, but there is no problem here since it can't see Vista's NTFS partition anyway.) <br><br></td></tr></table><br>
<a name="709460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used a third party bootloader, i HAD to... because:<br><br>to boot vista i had to have my Vista CD *OUT* of the cd drive.<br><br>to boot my old os I had to have the vista cd *IN* the drive. lol!<br><br>i got around it by using a third party boot loader to find the correct windows boot for the older OS. If I uninstall this boot-loader, I will not be able to boot windows xp without the vista cd. How blooming strange is that!? <br><br></td></tr></table><br>
<a name="709512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> to boot my old os I had to have the vista cd *IN* the drive. lol! <br></div><br>Mad, the world has gone mad. Have Microsoft done this for some good reason? <br><br></td></tr></table><br>
<a name="709611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's not how it's supposed to work at all.  =] <br><br></td></tr></table><br>
<a name="710483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Mad, the world has gone mad. Have Microsoft done this for some good reason? <br> <br></div><br><br>As Toby said, it's not supposed to work like that, but for some reason the system boots off a different hard drive when the vista cd is in the drive. Totally wierd, and equally backwards!!!<br><br>and now my boot loader is nagging me to purchase lol. Suppose I had better do so. <br><br></td></tr></table><br>
<a name="710757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nagging you to purchase?  Why aren't you just using GRUB or LILO or something?  They're very simple to set up.<br><br>I know back in the 2000/XP/2003 days the CD would check for a harddrive installation and if there was one it would ask to press a key instead of going straight into the installer.  If you didn't press a key it would boot your OS...  bypassing whatever program is stored in the MBR.  I suppose a similar thing is happenning here - the Vista setup DVD is detecting the wrong partition (probably a screwed up Active or Boot setting on the MBR).  It's still odd though.  =] <br><br></td></tr></table><br>
<a name="711498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Why aren't you just using GRUB or LILO or something? They're very simple to set up.<br> <br></div><br><br>I didn't have a Linux distro to spare, and I don't have a floppy drive.<br><br>Of course, they were my first choice. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
