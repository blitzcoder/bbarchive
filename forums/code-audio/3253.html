<!DOCTYPE html><html lang="en" ><head ><title >Play Audio using MCI</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='Playing Audio usinv MCI with BMax, language=bmx, category=Audio'><meta name='author' content='Casaber'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 ><a href=codearcs.php>Code archives</a>/<a href=codearcs.php?cat=3>Audio</a>/Play Audio using MCI</h1><div class="quote">This code has been declared by its author to be Public Domain code.</div><br><a href="3253.bmx">Download source code</a><br><br><table width="100%" cellspacing="0" cellpadding="0"><tr ><td width="100%"><table width=100% cellspacing=0 cellpadding=0><tr ><td class=headleft></td><td class=head><table width=100% cellspacing=0 cellpadding=0><tr ><td >Play Audio using MCI by Casaber</td><td align="right">2016 </td></tr></table></td><td class=headright></td></tr></table></td></tr><tr ><td class="cell"> This is a working example of using MCI to play aswell as set/get position, length, and do perfect looping.<br><br>Windows only. </td></tr><tr ><td class="cell"><pre class="code">rem
   _/\/\/\/\/\____/\/\___________________________
    _/\/\____/\/\__/\/\____/\/\/\______/\/\__/\/\_ 
   _/\/\/\/\/\____/\/\________/\/\____/\/\__/\/\_  
  _/\/\__________/\/\____/\/\/\/\______/\/\/\/\_   
 _/\/\__________/\/\/\__/\/\/\/\/\________/\/\_    
___________________________________/\/\/\/\___  

 MID, OGG, MP3, WMA of any length

 Get the ability to REPEAT, READ position, SET position, get LENGTH etc.

 For Windows only (Bmax)

 ' This is a simple and working Bmax example of MCI usage'

endrem
' ---------------------------------------------------------------------

Extern "win32"
	Function mciSendStringA(cmd$z,resultbuffer:Byte Ptr=Null,buffersize=0,hwndcallback=0)
End Extern

' Init
Graphics 640,480
sound$ = "birds.mp3" ' Any kind of media goes here.
sound$=chr$(34)+sound$+chr$(34)

' Example
mci "open " + sound$ + " type mpegvideo alias sploit" ' Notice mpegvideo is forced as type
mci "play sploit from 0 repeat"

waitkey

'Quick reference of some practical examples of MCI commands :

'mci "set sploit time format ms" ' Use milliseconds instead of PPQN.
'Print "Song length is " + mci("status sploit length") 
'Print "position is " + mci("status sploit position")
'mci "seek sploit to 20" ' Remember a SEEK is needed after a PLAY.
'mci "play sploit"
'mci "pause sploit"
'mci "resume sploit"
'mci "stop sploit"
'mci "close sploit"
’mci "setaudio sploit volume to 50”

len = mci("status sploit length")
pos = mci("status sploit position")

Function mci:String(msg$)
	Local answer$
	Local retmsg:Byte Ptr = MemAlloc(128)
	Local a = mcisendstringa(msg$,retmsg,128)
	answer$ = String.FromCString(retmsg)
	MemFree(retmsg)
	Return answer$
EndFunction

’ An example hoe to pack them inside the exe:
’ incbin ”birds.mp3"
’ CopyFile ”incbin::birds.mp3”,”birds.mp3”</pre></td></tr></table><br><a name="comments">Comments</a><br><br>None.<br><br><a href="codearcs.php" >Code Archives Forum</a><table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
