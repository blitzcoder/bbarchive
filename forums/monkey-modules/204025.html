<!DOCTYPE html><html lang="en" ><head ><title >VRope - cut the rope style, verlet integration</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >VRope - cut the rope style, verlet integration</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=524" >User Modules</a>/<a href="#bottom" >VRope - cut the rope style, verlet integration</a><br><br>
<a name="2060427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I ported the VRope lib to Monkey today. It lets you do a "cheap" rope effect between two points. It is a perfect combo with a box2D joint to achieve something that looks like rope without having to create a complex chain out of many physics bodies.<br><br><img src="http://www.skn3.com/junk/codefun/physics/ropejoint_verlet/screenshot.png"><br><br><a href="http://www.skn3.com/junk/codefun/physics/ropejoint_verlet/MonkeyGame.html" target="_blank">http://www.skn3.com/junk/codefun/physics/ropejoint_verlet/MonkeyGame.html</a><br><br>The demo above consists of two rectangle box2d bodies connected via a RopeJoint and then a VRope layered on top.<br><br>The VRope would be updated like so:<br>[bbcode]Local tempVec1:b2Vec2 = ropeBox1.GetWorldCenter()<br>Local tempVec2:b2Vec2 = ropeBox2.GetWorldCenter()<br>rope.Update(delta, tempVec1.x, tempVec1.y, tempVec2.x, tempVec2.y) 'delta is a float from 0.0 - 1.0 indicating 1 second[/bbcode]<br><br>And rendered like so:<br>[bbcode]For Local index:= 0 Until rope.numPoints - 1<br>	DrawLine(rope.points[index].x, rope.points[index].y, rope.points[index + 1].x, rope.points[index + 1].y)<br>Next[/bbcode]<br><br>Find the module code here:<br><a href="https://github.com/skn3/vrope" target="_blank">https://github.com/skn3/vrope</a><br><br>Enjoy, for free :D<br><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_donations&amp;business=jon%2epittock%40gmail%2ecom&amp;lc=US&amp;item_name=Skn3&amp;no_note=0&amp;currency_code=GBP&amp;bn=PP%2dDonationsBF%3abtn_donate_SM%2egif%3aNonHostedGuest" target="_blank"><img src="http://help.yahoo.com/l/us/yahoo/smallbusiness/webhosting/yss/paypal/media/images/paypal_donate_button.gif"></a> <br><br></td></tr></table><br>
<a name="2057355"></a>

<a name="2043430"></a>

<a name="2043115"></a>

<a name="2043107"></a>

<a name="2043104"></a>

<a name="2043105"></a>

<a name="2043103"></a>

<a name="2043131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dopeyrulz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Terrific! <br><br></td></tr></table><br>
<a name="2043272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice addition. <br><br></td></tr></table><br>
<a name="2043325"></a>

<a name="2043326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Volker</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just played around with it and got:<br>/b2ropejointdef.monkey&lt;41&gt; : Error : Type 'Number' not found<br><br>in:<br>Method Initialize:Void(bA:b2Body, bB:b2Body, anchorA:b2Vec2, anchorB:b2Vec2, maxLength:Number)<br><br>Whats this secret number class? Something you like to share with us?<br>[Edit]<br>Just changed it to float.<br>Got:<br>C:/Monkey/modules/vbox2d/dynamics/joints/b2ropejointdef.monkey&lt;44&gt; : Error : Unable to find overload for GetLocalPoint(b2Vec2).<br><br>Will have to wait for example code for futher investigations... <br><br></td></tr></table><br>
<a name="2043331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> There seems to be a lot of missing code.<br>compared to your demo. ;). (Physics wise).<br><br>Looks good though. <br><br></td></tr></table><br>
<a name="2043347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh the code for the physics is box2d so not technically missing, just me being lazy and not posting a demo hah! <br><br></td></tr></table><br>
<a name="2043349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Volker I tweaked the "number". It was because it was ported from flash where a float is defined as Number (bit weird).<br><br>I also added a basic example to the Vrope repo. <br><br></td></tr></table><br>
<a name="2057356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated repo, anyone following this please update your link. <br><br></td></tr></table><br>
<a name="2086550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PhillipK</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Skn3, <br>i hope you are still active :)<br><br>After trying to port the exactly same code to monkey, i found your version on GitHub.<br>Well, your's way better then my attempt, but still not what i want.<br><br>The reason i ask here, is that i need the Verlet rope as some kind of rope which is defined by a max length (think about the Box2d Joint 'Rope'), so that it will be almost linear, if the distance between two bodys is greater then the intial distance.<br>Unfortunatly, i cant get this to work. <br>Here is a screenshot of the problem (i painted in the red line, its the rope joint almost fully extended) <br><img src="https://dl.dropboxusercontent.com/u/23933800/box2d/verlet%20problem.png"><br><br>Since iam to dumb to understand the algorithm, i really dont know where to "insert" my tweak.<br>I thought about reducing the number of segments - that helps, but not at all (and look stupid in the end) or chaning the point placement (i am confused about the vars at the line)<br><pre class=code>points[index] = New VPoint(x1 + (diffVectorX * (1.0 / ccpLength)) * (multiplier * index * (1 - antiSagHack)), y1 + (diffVectorY * (1.0 / ccpLength)) * (multiplier * index * (1 - antiSagHack)))</pre><br>I inserted here a linear interpolation of the two end points by index / maxPoints. Its still not working.<br>The third thing i tried was to increase the "stiffness" by changing the VStick.Contract() function (the 0.5 factor) - still no success.<br><br>I really dont need any complete code, but i would love to get an idea where i should start to tweak with some variables.<br><br>Btw: Your demo and the rope joint in it is exactly what i try to achieve. Maybe its PixelToMeter scale that fails? Is my whole scene "too small" ? :(<br><br>- Phillipk<br><br><br>Edit:<br><br>After several hours in adjusting values by factors, i found out that this is no behaviour caused by "to long sticks", its a behaviour caused by the gravity.<br>It seems that the preimplemented gravity was way to high :/<br>The Reason for that is simple: I use another scaling than default Box2d "renderer". If anyone else is facing this problem, try to adjust the Gravity FIRST <br><pre class=code>Field gravityY:= 9.8 * Box2Definition.BOX2D_PIXEL_TO_METER_SCALE</pre><br>thats my "solve". This const is defined by 1.0 / 100.0, which means that 100 pixels are 1 meter :) <br><br></td></tr></table><br>
<a name="2086524"></a>

<a name="2089586"></a>

<a name="2089587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skn3</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you get this fully sorted? You could also try decreasing teh number of links in the rope. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
