<!DOCTYPE html><html lang="en" ><head ><title >Loading Custom Images inside OnCreate</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Loading Custom Images inside OnCreate</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=512" >Monkey Code</a>/<a href="#bottom" >Loading Custom Images inside OnCreate</a><br><br>
<a name="2036729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> [edit] forgot to mention it requires v63 to work.<br><br>This is an example with a work around that allows you to load images from either a txt file or a string declared in your code.<br><br>This first bit of code Prints the pixel data, I was going to use SaveString but I didn't want it GLFW dependant as it takes too long to compile. Copy the outputted text and use for your own stuff. Change the file to match your own and you can also change the background_r, g, b. This is the colour that is used to mask the background.<br><br>[monkeycode]<br>Strict<br>Import mojo<br><br>Class MyApp Extends App<br><br>	'// Background Color to mask<br>	Global background_r : Int = 255<br>	Global background_g : Int = 0<br>	Global background_b : Int = 128<br>	<br>	Field sprite : Image<br>	Field saved : Bool = False<br><br>	Method OnCreate : int()<br>		SetUpdateRate( 60 )<br><br>		'// Loads your image<br>		sprite = LoadImage( "sonic.png" )<br>		<br>		Return 0<br>	End Method<br>	<br>	Method OnUpdate : int()<br>		Return 0<br>	End Method<br>	<br>	Method OnRender : int()<br>		Cls background_r, background_g, background_b<br>		DrawImage sprite, 0, 0<br>		If saved = False<br>			saved = True<br>			Local w : Int = sprite.Width()<br>			Local h : Int = sprite.Height()<br>			Local pixels : Int[ w * h ]<br>			ReadPixels( pixels, 0, 0, w, h )<br>			<br>			'// Prints pixel string<br>			PixelArrayPrintData( pixels, w, h )<br>			<br>		Endif<br>		Return 0<br>	End Method<br>	<br>End Class<br><br><br>'// Saves pixels to file<br>Function PixelArrayPrintData : Void( pixels : Int[], w : Int, h : int )<br>	Local out : String = w + "," + h + ","<br>	Local size : Int = pixels.Length<br>	For Local i : Int = 0 Until size<br>		out = out + pixels[ i ]<br>		If i &lt; size - 1 Then out = out + ","<br>	Next<br>	Print out<br>End Function<br><br><br>Function Main : Int()<br>	New MyApp()<br>	Return 0<br>End Function<br>[/monkeycode]<br><br>This next bit loads the data up (functions are provided to load either from a string in code or from a txt file) and provided is a few functions to replace the colours. This can be used to create infinite versions on the same sprite!! The example below requires no media to run.<br><br>Thanks to therevills for writing the colour masking code, gave me this idea and saved me writing it myself<br><br>[monkeycode]<br>Strict<br>Import mojo<br><br><br><br>Class MyApp Extends App<br><br>	'// stores our sprite color information w,h,ARGB...<br>	Global sprite : String = "27,39,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14663488,-14663488,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14663488,-14663488,-14663488,-14663488,-12566304,-12566304,-14663488,-14663488,-14663488,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-14663488,-14663488,-14663488,-14663488,-14663488,-14671712,-14671712,-12566304,-12566304,-12566304,-14663488,-14663488,16711808,16711808,16711808,16711808,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-14671712,-14663488,-14663488,-14671712,-2056064,-14671712,-12566304,-12566304,-12566304,-12566304,-14663488,-14663488,16711808,-14671712,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-6266816,-2056064,-2056064,-14671712,-12566304,-10460960,-12566304,-12566304,-12566304,-14663488,-14671712,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14663488,-14671712,-6266816,-2056064,-2056064,-2056064,-14663488,-10460960,-10460960,-10460960,-12566304,-12566304,-14663488,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14671712,-6266816,-6266816,-12566304,-12566304,-10460960,-10460960,-10460960,-10460960,-10460960,-12566304,-12566304,-14663488,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14671712,-14663488,-14663488,-14663488,-12566304,-12566304,-10460960,-12566304,-12566304,-12566304,-12566304,-10460960,-12566304,-12566304,-14663488,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14663488,-14671712,-14671712,-14663488,-12566304,-10460960,-10460960,-12566304,-12566304,-12566304,-2039584,-2039584,-10460960,-12566304,-10460960,-12566304,-12566304,-14663488,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14663488,-14663488,-14671712,-14671712,-14663488,-10460960,-2039584,-10460960,-12566304,-12566304,-10460960,-2039584,-2039584,-2039584,-10460960,-12566304,-12566304,-12566304,-10460960,16711808,16711808,16711808,16711808,-14663488,-14663488,-14671712,-14671712,-14671712,-14663488,-14671712,-14671712,-14663488,-12566304,-10460960,-10460960,-12566304,-12566304,-10460960,-2039584,-2039584,-2039584,-16644604,-14663488,-12566304,-12566304,-16644604,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14663488,-12566304,-12566304,-12566304,-12566304,-10460960,-2039584,-2039584,-2039584,-16644604,-16644604,-14663488,-12566304,-16644604,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-14671712,-14663488,-14663488,-14663488,-14663488,-12566304,-12566304,-2039584,-2039584,-2039584,-16644604,-16644604,-10460960,-16644604,-16644604,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-14663488,-14663488,-14663488,-14663488,-14663488,-12566304,-2039584,-2039584,-16644604,-16644604,-2039584,-16644604,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14671712,-14671712,-14671712,-14671712,-14663488,-6266816,-2039584,-2039584,-14663488,-10460960,-2039584,-2039584,-2039584,-6266816,-8355712,-16644604,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14663488,-14671712,-14671712,-14671712,-14671712,-6266816,-2056064,-2056064,-2056064,-2236959,-2039584,-2039584,-2039584,-2056064,-2056064,-16644604,-16644604,-16644604,16711808,16711808,16711808,16711808,16711808,-14663488,-14663488,-14663488,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-6266816,-2056064,-2056064,-2056064,-2056064,-2056064,-2056064,-2056064,-2056064,-2056064,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-6266816,-2056064,-2056064,-2056064,-2056064,-2056064,-6266816,-6266816,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14663488,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-14671712,-16644604,-14671712,-14671712,-6266816,-6266816,-6266816,-6266816,-6266816,-8388608,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-14671712,-14671712,-16644604,-16644604,-14671712,-14671712,-14663488,-8388608,-8388608,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-2056064,-2056064,-2056064,-2056064,-14663488,-6266816,-2056064,-2056064,-6266816,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-2056064,-2056064,-6266816,-6266816,-6266816,-14663488,-6266816,-2056064,-2056064,-2056064,-2056064,-6266816,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-2056064,-6266816,-6266816,-14671712,-14671712,-14671712,-14663488,-6266816,-2056064,-2056064,-2056064,-2056064,-6266816,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-2056064,-6266816,-14671712,-14671712,-14671712,-14671712,-14663488,-6266816,-6266816,-2056064,-2056064,-6266816,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-6266816,-2039584,-2039584,-8355712,-2039584,-8355712,-14663488,-14663488,-6266816,-6266816,-6266816,-8388608,-16644604,-12566464,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-8388608,-2039584,-8355712,-2039584,-2039584,-2039584,-14671712,-14663488,-14663488,-14663488,-14663488,-14671712,-12566464,-8355712,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-14671712,-14671712,-8355712,-12566464,-8355712,-8355712,-8355712,-14671712,-14663488,-14671712,-16644604,-14671712,-16644604,-12566464,-8355712,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,16711808,16711808,16711808,-8355712,-8355712,-8355712,-8355712,-12566304,-14663488,16711808,-14671712,-14671712,-16644604,-16644604,-12566464,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-16644604,-8355712,-8355712,-14671712,-12566304,16711808,16711808,-14671712,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-12566304,16711808,16711808,-14671712,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-12566304,16711808,16711808,16711808,-14671712,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-14671712,-12566304,16711808,16711808,16711808,-14671712,-14671712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-8355712,-6250336,-2039584,-2039584,-2039584,16711808,-12566464,-8355712,-8355712,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-8355712,-8355712,-8355712,-6250336,-6250336,16711808,-12566464,-12566464,-12566464,-8355712,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-16644604,-8388608,-8355712,-8355712,-8388608,-8388608,-2039584,-8355712,-12566464,-12566464,-8355712,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-16644604,-8388608,-8388608,-8388608,-6250336,-2039584,-8355712,-8355712,-2097152,-16644604,-16644604,-12566464,-8355712,-8355712,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-16644604,-8388608,-8388608,-8388608,-8355712,-6250336,-2097152,-2097152,-2097152,-2097152,-2097152,-2097152,-16644604,-16644604,-16644604,-8388608,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-16644604,-8388608,-8388608,-8388608,-8355712,-2097152,-2097152,-2097152,-2097152,-2097152,-2097152,-2097152,-2097152,-2097152,-2097152,-16644604,-16644604,-8388608,-8388608,16711808,16711808,16711808,16711808,16711808,16711808,16711808,16711808,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604,-16644604"<br><br>	'// stores two images we will create from the string<br>	Field sprite1 : Image<br>	Field sprite2 : Image<br><br><br>	Method OnCreate : int()<br>		SetUpdateRate( 60 )<br><br>		<br>		'// converts string into a pixel array that we can use<br>		Local dimensions : Int[ 2 ]<br>		Local pixels : Int[] = PixelArrayFromString( sprite, dimensions )<br><br>		<br>		'// creates 1st sprite from the pixel array<br>		sprite1 = PixelArrayCreateImage( pixels, dimensions[ 0 ], dimensions[ 1 ] )<br>		<br>		'// modify the pixels to create a different coloured sprite<br>		'// this is swapping a RGB for a different RGB<br>		'// you could store these colours to create different coloured outfits using the same sprite<br>		PixelArrayReplaceColour( pixels, 32, 32, 160, 160, 160, 32 )<br>		PixelArrayReplaceColour( pixels, 32, 64, 192, 192, 192, 64 )<br>		PixelArrayReplaceColour( pixels, 64, 64, 224, 224, 224, 64 )<br>		PixelArrayReplaceColour( pixels, 96, 96, 224, 224, 224, 96 )<br>		<br>		<br>		'// creates 2nd sprite from the pixel array<br>		sprite2 = PixelArrayCreateImage( pixels, dimensions[ 0 ], dimensions[ 1 ] )<br><br>		Return 0<br>	End Method<br>	<br><br><br>	Method OnUpdate : int()<br>		Return 0<br>	End Method<br>	<br><br><br>	Method OnRender : int()<br>		Cls 0, 0, 0<br><br>		'// scale them up a bit so they are more visible<br>		PushMatrix()<br>		Scale 2, 2<br><br>		'// draws the created sprites<br>		SetColor 255, 255, 255<br>		DrawImage sprite1, 0, 0<br>		DrawImage sprite2, sprite1.Width(), 0<br><br>		PopMatrix()<br><br>		Return 0<br>	End Method<br>	<br><br>End Class<br><br><br><br><br>Function Main : Int()<br>	New MyApp()<br>	Return 0<br>End Function<br><br><br><br><br>'// Creates an image from the pixel array<br>Function PixelArrayCreateImage : Image( pixels : Int[], w : Int, h : Int )<br>	Local this : Image = CreateImage( w, h )<br>	this.WritePixels( pixels, 0, 0, w, h )<br>	Return this<br>End Function<br><br><br>'// Converts a comma separate string to pixel array<br>Function PixelArrayFromString : Int[]( s : String, size : Int[] )<br>	Local this : String[] = s.Split(",")<br>	Local pixels : Int[ this.Length ]<br>	size[ 0 ] = Int( this[ 0 ])<br>	size[ 1 ] = Int( this[ 1 ])<br>	For Local i : Int = 2 Until this.Length<br>		pixels[ i - 2 ] = Int( this[ i ])<br>	Next<br>	Return pixels<br>End Function<br><br><br>'// Loads a comma separate string to pixel array<br>Function PixelArrayLoadString : Int[]( file : String, size : Int[] )<br>	Local this : String[] = LoadString( file ).Split(",")<br>	Local pixels : Int[ this.Length ]<br>	size[ 0 ] = Int( this[ 0 ])<br>	size[ 1 ] = Int( this[ 1 ])<br>	For Local i : Int = 2 Until this.Length<br>		pixels[ i - 2 ] = Int( this[ i ])<br>	Next<br>	Return pixels<br>End Function<br><br><br>'// Replaces a Pixel Colour RGB<br>Function PixelArrayReplaceColour : void( pixels : Int[], old_r : Int, old_g : Int, old_b : Int, new_r : Int, new_g : Int, new_b : Int )<br>	For Local i : Int = 0 Until pixels.Length<br>		Local argb : Int = pixels[ i ]<br>		Local a : Int = ( argb Shr 24 ) &amp; $ff<br>		Local r : Int = ( argb Shr 16 ) &amp; $ff<br>		Local g : Int = ( argb Shr 8 ) &amp; $ff<br>		Local b : Int = argb &amp; $ff<br>		If r = old_r And g = old_g And b = old_b<br>			r = new_r<br>			g = new_g<br>			b = new_b<br>			argb = ( a Shl 24 ) | ( r Shl 16 ) | ( g Shl 8 ) | b<br>			pixels[ i ] = argb<br>		Endif<br>	Next<br>End Function<br><br><br>'// Replaces a Pixel Colour ARGB<br>Function PixelArrayReplaceColour : void( pixels : Int[], old_a : Int, old_r : Int, old_g : Int, old_b : Int, new_a : Int, new_r : Int, new_g : Int, new_b : Int )<br>	For Local i : Int = 0 Until pixels.Length<br>		Local argb : Int = pixels[ i ]<br>		Local a : Int = ( argb Shr 24 ) &amp; $ff<br>		Local r : Int = ( argb Shr 16 ) &amp; $ff<br>		Local g : Int = ( argb Shr 8 ) &amp; $ff<br>		Local b : Int = argb &amp; $ff<br>		If a = old_a And r = old_r And g = old_g And b = old_b<br>			a = new_a<br>			r = new_r<br>			g = new_g<br>			b = new_b<br>			argb = ( a Shl 24 ) | ( r Shl 16 ) | ( g Shl 8 ) | b<br>			pixels[ i ] = argb<br>		Endif<br>	Next<br>End Function<br>[/monkeycode]<br><br>Thought this was kind of cool so sharing :) <br><br></td></tr></table><br>
<a name="2036724"></a>

<a name="2036723"></a>

<a name="2036722"></a>

<a name="2036721"></a>

<a name="2036741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> not working on html5! <br><br></td></tr></table><br>
<a name="2036747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works fine here on HTML5 using Monkey v63b... but I did find out you got an error if you run it in debug mode:<br><a href="http://www.monkeycoder.co.nz/Community/posts.php?topic=3492" target="_blank">http://www.monkeycoder.co.nz/Community/posts.php?topic=3492</a> <br><br></td></tr></table><br>
<a name="2036755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, that was the reason. I used Debug mode. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
