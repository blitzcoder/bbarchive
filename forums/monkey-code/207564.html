<!DOCTYPE html><html lang="en" ><head ><title >Add dictionary to your word games</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Add dictionary to your word games</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=512" >Monkey Code</a>/<a href="#bottom" >Add dictionary to your word games</a><br><br>
<a name="2073285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is what I've come up with for being able to spell check words.   Seems fast enough on HTML, haven't tried it on my tablet yet.<br><br>For this example, I'm using the same dictionary that Words with Friends uses (known as the Enhanced North American Benchmark Lexicon (ENABLE) dictionary) which can be found here:  <a href="https://code.google.com/p/dotnetperls-controls/downloads/detail?name=enable1.txt" target="_blank">https://code.google.com/p/dotnetperls-controls/downloads/detail?name=enable1.txt</a><br><br>The dictionary files is 1,916,146 characters in length, and it loads the file, converts it to individual words and saves them in a Map on my crappy laptop in less than 5 seconds.<br><br>Let me know if I'm doing something the wrong way/slower way.<br><br>EDIT: Updated 9 Dec 13.  Showing changes made by Ziggy.  This code now executes in approximately 21 seconds on a Galaxy Tab 3, original version took approximately 40 seconds.<br><br><pre class=code>
Strict

Import mojo 

Class dictionary Extends App
	
	Field text:String
	Field myMap:= New StringMap&lt;String&gt;

	Method OnCreate:Int()
		SetUpdateRate(60)
		text = LoadString("dictionary.txt")		' Load the complete  dictionary into a string
		
		Local newWord:= New StringStack
		
		' Separate the complete dictionary into individual words (look out for ASCII values 
		' of 10 &amp; 13 as these a CR &amp; LF.  Each word is then added to "myMap"
		
		For Local i:Int = 0 Until text.Length
			If text[i] &lt;&gt; 10 And text[i] &lt;&gt; 13 Then
				newWord.Push(String.FromChar(text[i]))
			Else
				If newWord.Length &gt; 0 Then
					Local data:= newWord.Join()
					myMap.Insert(data, data)
				EndIf
				newWord.Clear()
			End If
		Next
		If IsAWord("test") Then Print "test is a word" Else Print "test is not a word"
		If IsAWord("iowier") Then Print "iowier is a word" Else Print "iowier is not a word"
		
		Return 0
	End Method
	
	Method OnUpdate:Int()
		Return 0
	End Method
	
	Method OnRender:Int()
		Cls(192, 192, 102)
		Return 0
	End Method
	
	Method IsAWord:Bool(s:String)
		Local check:String
		
		check = myMap.Get(s)
		' if the string "s" is not found in myMap, an empty string will be returned (word doesn't exist)
		If check.Length &gt; 0 Then
			Return True
		Else
			Return False
		End If
	End Method

End Class

Function Main:Int()

	Local d:dictionary
	d = New dictionary

	Return 0
End Function
</pre> <br><br></td></tr></table><br>
<a name="2073284"></a>

<a name="2073066"></a>

<a name="2073065"></a>

<a name="2073064"></a>

<a name="2073063"></a>

<a name="2073067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice! <br><br>I just wonder if instead of looping char by char, using text.Split("~n") and then just loop through the array would be faster...? (It will use more memory for sure, but the array would be GC'ed after the function is done processing... <br><br></td></tr></table><br>
<a name="2073068"></a>

<a name="2073069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No idea.  You probably know a lot more about Monkey that I do.   <br><br>I've not mucked around much with String functions, so text.Split("~n") I wasn't aware of.   I might change it to that and see if there is any noticeable speed different.   It's quick enough on the PC, not sure if the speed remains string functions run at similar speeds on the various mobile devices.<br><br>As for arrays, do you mean have an Array of 172,820 Strings?  Again I don't know how Maps "search" for your item when you use .Get - but surely it's quicker than looping through an Array of 172,000+ items.<br><br>EDIT: The code as it stands on my 5 year old desktop PC takes about 680 millisecs to execute, hardly worth worrying about trying to optimize unless mobile devices run way slower. <br><br></td></tr></table><br>
<a name="2073076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You'll make it a lot faster by not making string concatenation this way on non javascript targets. You better use a StringStack, and "join" when your're done. <br><br></td></tr></table><br>
<a name="2073102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>You'll make it a lot faster by not making string concatenation this way on non javascript targets. You better use a StringStack, and "join" when your're done. <br> <br></div><br><br>I have no idea how to implement what you're suggesting - still learning.  Feel free to improve on this code anyone that is capable :) <br><br></td></tr></table><br>
<a name="2073126"></a>

<a name="2073127"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Update:  <br><br>I will have to muck around with this further, I put my unfinished game onto my Galaxy Tab 3 and it takes about 40 seconds to load the dictionary in - obviously this is not desirable.<br><br>Hopefully another way will be a lot quicker, otherwise I guess I could split the dictionary and load little bits at a time.   Load 10%, show title screen, load another 10% etc. - but this seems messy to me.<br><br>Update Again:<br><br>I tried the text.Split("~n") that SLotman suggested to get the words into an Array before looping and putting them into a Map.  It is about 10% faster than the way I was doing it, guessing if I transfer this onto my Tablet I won't seem much overall improvement.<br><br>So my options to try out now are:<br><br>1. Use a loading screen, splash screens and time during menu's to load the dictionary in parts - I don't really like this idea.<br>2. Just put them all in an Array and then search the array for valid words - should be too hard as they are already in alphabetical order &lt;--- this is probably my best bet I think<br>3. Take suggestions from the audience on how I can do it <br><br></td></tr></table><br>
<a name="2073128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snader</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your game is going to use online features, you could put the dictionairy in an online database and query it from within your game every time you need it. <br><br></td></tr></table><br>
<a name="2073129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm using a dictionary by myself I have loading times of about 100-200ms for ~130,000 words.<br><br>And I just do it that way, for every length there is an own file.<br><pre class=code>
_words = New IntMap&lt; String[] &gt;
w = LoadString( "words/" + LANGUAGE + "/3.txt" )
_words3 = w.Split( "~n" )
_words.Set( 3, _words3 )
</pre> <br><br></td></tr></table><br>
<a name="2073130"></a>

<a name="2073131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If your game is going to use online features, you could put the dictionairy in an online database and query it from within your game every time you need it. <br></div><br><br>Yeah that's an option, also means users don't need to redownload the dictionary every time it's updated.   I'll have a think about it.<br><br>I think the Array option might work okay though, if I use a binary search it should take less than 18 attempts to verify a word in a dictionary of 170,000 odd entries.<br><br>I'll play with that tomorrow and a new update to the code if it works.<br><br><div class="quote"> Hmm using a dictionary by myself I have loading times of about 100-200ms for ~130,000 words.<br><br>And I just do it that way, for every length there is an own file. <br></div><br><br>Just so I'm understanding you correctly, you mean you have a file "3.txt" which is every 3 letter word, a file "4.txt" etc. ? <br><br></td></tr></table><br>
<a name="2073132"></a>

<a name="2073133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes! I have seperate files for 3 up to 10 letter words.<br><br>I get the following results:<br>HTML5: Loading time: 78ms for 131401 words.<br>GLFW: Loading time: 34ms for 131401 words.<br>Android: Loading time: 476ms for 131401 words. <br><br></td></tr></table><br>
<a name="2073134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> And Xaron, you say you have loading times of about 100-200ms - I take it that's total for the whole 130k odd dictionary.  Is this running on HTML or running on a mobile device?  <br><br>My loading time of around 600ms was fine on HTML, obviously tablets are a whole different kettle of fish with this sort of stuff which is why the time blows out to 40 seconds. <br><br></td></tr></table><br>
<a name="2073135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wylaryzel</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> How are you going to compare if a word is in the dictionary?<br><br>If you only compare if a word is in the dictionary I would use a StringStack:<br><br>dict:StringStack = New StringStack()<br>dict.Push(LoadString(File).Split("~n"))<br><br>Afterwards you can use the Contains Function of the stack:<br><br>dict.Contains(searchString) &lt;- Returns True if the string is there, False if the string is not there.<br><br><br>The code is untested and you may need a removal function for special chars you don't want to have<br><br>Wyl <br><br></td></tr></table><br>
<a name="2073136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>How are you going to compare if a word is in the dictionary?<br> <br></div><br><br>I'm storing every word in a Map, and then using this function:<br><br><pre class=code>
	Method IsAWord:Bool(s:String)
		Local check:String
		
		check = myMap.Get(s)
		' if the string "s" is not found in myMap, an empty string will be returned (word doesn't exist)
		If check.Length &gt; 0 Then
			Return True
		Else
			Return False
		End If
	End Method
</pre><br><br>Check will either return the word if it's found (i.e. the length will be more than 0 for the word size) or 0 if the word isn't found in the dictionary. <br><br></td></tr></table><br>
<a name="2073140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wylaryzel</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> This could be achieved by:<br><br>dict.Contains(searchString) <br><br></td></tr></table><br>
<a name="2073146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could use a single string or array with a special character for the start of a word.  To do a binary search you just go to a position and then move to the first word you find which you can then compare as normal.<br><br>I wouldn't be surprised if that was the best way for many purposes, as it would have the quickest start-up time and the least memory allocation.  Unless you are really looking up a lot of words, it will probably test words fast enough too.<br><br>Another similar option is two arrays: one containing all the words in one block, and an array of ints containing the offset of the start of each word.  Again, you could pre-generate them so there is no initial processing, and this second method could be searched about as fast as any data structure. <br><br></td></tr></table><br>
<a name="2073145"></a>

<a name="2073142"></a>

<a name="2073143"></a>

<a name="2073144"></a>

<a name="2073154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I have no idea how to implement what you're suggesting - still learning. Feel free to improve on this code anyone that is capable :)  <br></div><br>That's the suggested change. You should see a big difference in Android and iOS.<br><pre class=code>Strict

Import mojo

Class dictionary Extends App
	
	Field text:String
	Field myMap:= New StringMap&lt;String&gt;

	Method OnCreate:Int()
		SetUpdateRate(60)
		text = LoadString("dictionary.txt")		' Load the complete  dictionary into a string
		
		'Local newWord:String = ""
		Local newWord:= New StringStack
		
		' Separate the complete dictionary into individual words (look out for ASCII values 
		' of 10 &amp; 13 as these a CR &amp; LF.  Each word is then added to "myMap"
		
		For Local i:Int = 0 Until text.Length
			If text[i] &lt;&gt; 10 And text[i] &lt;&gt; 13 Then
				newWord.Push(String.FromChar(text[i]))
			Else
				If newWord.Length &gt; 0 Then
					Local data:= newWord.Join()
					myMap.Insert(data, data)
				EndIf
				newWord.Clear()
			End If
		Next
		If IsAWord("test") Then Print "test is a word" Else Print "test is not a word"
		If IsAWord("iowier") Then Print "iowier is a word" Else Print "iowier is not a word"
		
		Return 0
	End Method
	
	Method OnUpdate:Int()
		Return 0
	End Method
	
	Method OnRender:Int()
		Cls(192, 192, 102)
		Return 0
	End Method
	
	Method IsAWord:Bool(s:String)
		Local check:String
		
		check = myMap.Get(s)
		' if the string "s" is not found in myMap, an empty string will be returned (word doesn't exist)
		If check.Length &gt; 0 Then
			Return True
		Else
			Return False
		End If
	End Method

End Class

Function Main:Int()

	Local d:dictionary
	d = New dictionary

	Return 0
End Function</pre> <br><br></td></tr></table><br>
<a name="2073286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> That's the suggested change. You should see a big difference in Android and iOS. <br></div><br><br>Thanks ziggy.  Finally got around to trying out your code, pretty much halves the load time on my Galaxy Tab to about 20 secs.  Guessing this is probably more than acceptable, just need to make a nice loading screen for what I'm writing to let the user know nothing has crashed.<br><br>Thanks for all the help guys.<br><br>I've updated my first post to show the changes ziggy made.   If anyone else can see any other speed improvements just post in here. <br><br></td></tr></table><br>
<a name="2073309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you change the file to not have any CR character, and to have a single char separator (instead of CR and LF) it could be a coma, it would save you some time as you have an extra iteration per separator when a CR &amp; LF char combination is found. You could pre-format the txt document and see if it improves parsing speed (which I supose it'll do). Also, I'm not sure but I *think* having the document pre-sorted alphabetically could improve map insertion time. <br><br></td></tr></table><br>
<a name="2073308"></a>

<a name="2073318"></a>

<a name="2073319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> TBH I think 20 secs is a bit long, and if it were me I would pre-process the data into one of the forms I suggested.  Then it should load as fast as 2 MB of raw data or images.<br><br>I have an idea that on Android a program is always supposed to respond within 4 seconds, isn't that correct?  If so, to do a 20 second load you will need to do it in stages and show a progress bar.<br><br>Anyhoo, if it's working for you you can complete your game and plug in a faster dictionary if needed. <br><br></td></tr></table><br>
<a name="2073317"></a>

<a name="2073316"></a>

<a name="2073346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I have an idea that on Android a program is always supposed to respond within 4 seconds, isn't that correct? If so, to do a 20 second load you will need to do it in stages and show a progress bar. <br></div><br>good point, i think android does kill apps that take about that long.<br><br>i also was attempting to create my own dictionary solution (based on this thread), but rather keep it disk-based as opposed to memory-based. i ran into problems, as it seems monkey+android has problems with random-access to existing asset files in the data folder (i posted a potential fix under bugs). <br><br></td></tr></table><br>
<a name="2073365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> A while back I messed about with a dictionary for word games. I was using a dictionary source with around 180,000 words. I've just dug out the code and given it a run on my Android. The loading of the file via LoadString takes ~3secs and splitting it into a string array takes ~1.5secs. That's on my aged ZTE Blade. A more recent phone should be considerably faster.<br><br>I did a number of tests at the time with compressed files to reduce the load time but found that whatever I managed to gain in load time I lost more in the processing time. You can't generalise that across all Android devices, but it seems likely that there's not much to be won by pursuing something other than raw text.<br><br>Anyway, the result was very simple code.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Class BinaryArraySearch&lt;T&gt;
    Function Find:Int(searchArray:T[], item:T)
        Local low:Int = -1
        Local high:Int = searchArray.Length()
        Local mid:Int
       
	While high-low &gt; 1
            mid = (low + high) Shr 1
			
            If searchArray[mid] &lt; item
                low = mid
            ElseIf searchArray[mid] &gt; item
                high = mid
            Else
                Return mid
            End
            
        End
        
        Return -1
    End
End

Class WordList
    Field listArr:String[]
    
    'Load dict from raw string. Assumes input is upper case and in alphabetical order.
    Method LoadList:Void(rawList:String, sep:String)
        listArr = rawList.Split(sep)
    End
    
    'Find a word, returns the array index if found or -1 if not
    Method FindWord:Int(word:String)
        Return BinaryArraySearch&lt;String&gt;.Find(listArr, word.ToUpper())
    End
    
    Method Clear:Void()
        listArr =[]
    End
End
</textarea><br><br><br><br>And with a test app as a runnable example ( the twl06.txt dictionary file can be found all over the place, e.g. <a href="https://scrabblehelper.googlecode.com/svn/trunk/ScrabbleHelper/src/dictionaries/TWL06.txt" target="_blank">here</a>, just be sure to either change the EOL markers to Unix or change the separator in the code to "~r~n") :<br><br>Edit: Looks like you can use the enable1.txt you're currently using if you make the separator change mentioned above and also change the FindWord code to force the input to lowercase with ToLower rather than uppercase.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict
Import mojo

Class BinaryArraySearch&lt;T&gt;
    Function Find:Int(searchArray:T[], item:T)
        Local low:Int = -1
        Local high:Int = searchArray.Length()
        Local mid:Int
       
	    While high-low &gt; 1
            mid = (low + high) Shr 1
			
            If searchArray[mid] &lt; item
                low = mid
            ElseIf searchArray[mid] &gt; item
                high = mid
            Else
                Return mid
            End
            
        End
        
        Return -1
    End
End

Class WordList
    Field listArr:String[]
    
	'Load dict from raw string. Assumes input is upper case.
    Method LoadList:Void(rawList:String, sep:String)
        listArr = rawList.Split(sep)
    End
    
    Method FindWord:Int(word:String)
        Return BinaryArraySearch&lt;String&gt;.Find(listArr, word.ToUpper())
    End
    
    Method Clear:Void()
        listArr =[]
    End
End




Class Wordy Extends App
    
    Method OnCreate:Int()
        SetUpdateRate(1)
        Return 0
    End
    
    Method OnRender:Int()
        RunTest
        Return 0
    End
    
    Field testCount:Int = 0
    Const NUM_TESTS:Int = 5
    Field rawList:String
    
    Method RunTest:Void()
        
		If testCount &lt; NUM_TESTS
            Print "Run: " + testCount
            Local t:Int = Millisecs()
			
			Local rawDict:String = LoadString("twl06.txt")
			
			Print "Time to load dict file: " + (Millisecs() - t)
			
			t = Millisecs()
			
			Local wordList:WordList = New WordList()
			wordList.LoadList(rawDict,"~n")
			
			Print "Time to parse dict: " + (Millisecs() - t)
		
            Const NUM_SEARCHES:Int = 1000
            Local findWords:String[] = New String[NUM_SEARCHES]
            Local finds:Int[] = New Int[NUM_SEARCHES]
            
            For Local i:Int = 0 Until NUM_SEARCHES
                findWords[i] = wordList.listArr[Rnd(0, wordList.listArr.Length())]
            End
            
	        t = Millisecs()
            For Local i:Int = 0 Until NUM_SEARCHES
                finds[i] = wordList.FindWord(findWords[i])
            End
            
			Print "Time for test searches: " + (Millisecs() - t)
            
			If wordList.FindWord("huhihesdfj") &lt;&gt; -1
				Print "Found non-existent word"
			End
			
            For Local i:Int = 0 Until NUM_SEARCHES
                If finds[i] = -1
                    Print "Didn't find word: " + findWords[i]
               	'Else
                '    Print "Found: " + wordList.listArr[finds[i]]
                End
            End
        
		Else
            Error("")
        End
		
        testCount += 1
    End
        
    Method OnUpdate:Int()
        
       
        Return 0
    End
End

Function Main:Int()
    Local a:App = New Wordy()

    Return 0
End
</textarea><br><br>I never did anything much with it but maybe it's useful to people trying to build something better. <br><br></td></tr></table><br>
<a name="2073353"></a>

<a name="2073352"></a>

<a name="2073351"></a>

<a name="2073350"></a>

<a name="2073349"></a>

<a name="2073348"></a>

<a name="2073514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's my attempt, using the same dictionary from the first post:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Class Game Extends App 

	Global UPDATE_RATE:Int = 60
	Global gameState:Int
	
	'Global dict:StringMap&lt;String&gt; = New StringMap&lt;String&gt;
	Global dict:StringStack = New StringStack()
	
	Global t1:Int, t2:Int, t3:Int

	Method OnCreate()
		SetUpdateRate UPDATE_RATE		
		gameState = 0
	End Method
	
	Method OnUpdate()
		If KeyHit(KEY_ESCAPE) Then Error ""
		
		Select gameState
			Case 0
				Print "loading dictionary..."
				Local timer:Int = Millisecs()
				Local str:String = mojo.LoadString("dict.txt")
				t1 = Millisecs()-timer
				Print "time:" + (t1) + "ms"
				
				timer = Millisecs()
				Print "splitting words..."
				Local arr:String[] = str.Split("~n")
				t2 = Millisecs()-timer
				Print "time:" + (t2) + "ms"

				Print "creating dictionary..."
				timer = Millisecs()
				Local i:Int
				Local size:Int = arr.Length()
				For i=0 Until size
                                    'dict.Add(arr[i].Trim(),arr[i].Trim())
                                    dict.Push(arr[i].Trim())
				Next
				t3 = Millisecs()-timer
				Print "time:" + (t3) + "ms"
				gameState = 1
		End Select
	End Method
	
	Method OnRender()
		If gameState = 1 Then
		   Scale 4,4
			DrawText "Load time:" + t1, 10,10
			DrawText "Parse time:" + t2, 10,30
			DrawText "Dict time:" + t3, 10, 60
			Scale 1,1
		End If
	End Method	
End Class

Function Main()
	New Game()
End Function
</textarea><br><br>On Windows Phone 8 (compiling in *release* mode):<br>Load time: 111 ms<br>Parse time: 236 ms<br>Dict time: 742 ms -&gt; 190ms with StringStack<br><br>So yeah, not much more than a second to load and parse everything. Most in creating the stringmap...<br><br>I don't have an actual android device to test this, but on Bluestack's emulator, I get this:<br>Load time:330ms<br>Pase time:120ms<br>Dict time:440ms -&gt; 140ms with StringStack<br><br>This time, even less than a second :)<br><br>Edit: Changed code to use StringStack, which is much faster! <br><br></td></tr></table><br>
<a name="2073513"></a>

<a name="2073512"></a>

<a name="2073395"></a>

<a name="2073394"></a>

<a name="2073464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wonder why it even should take that time of 40 seconds on Android?! I mean I haven't done any optimization in my code but even this takes only half a second on my mid class Android device.<br><br>So I guess there are some new word games coming soon? ;) <br><br></td></tr></table><br>
<a name="2073478"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wylaryzel</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please apologize if I sidetrack the thread a bit but with all the codes posted I still wonder why the dictionary is stored in an StringMap&lt;String&gt; instead of an StringStack ? <br><br>Without testing, but wouldn't the memory consumption significantly higher? And as the word is stored as key and as value isn't that something doubling?<br><br>Thx in advance <br><br></td></tr></table><br>
<a name="2073490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I wonder why it even should take that time of 40 seconds on Android?! <br></div><br><br>I don't know what the 40 second code did but looking at Arabia's 21 second code the char by char construction of words via a StringStack is going to be notably slower than the "native" Java split to an array. Map construction is going to be a chunk of time too. Building a large RB tree with all that node construction and rebalancing (and in-order insertion may be a worst case for this) isn't free. <br><br>Java on Android on mobile devices is just very poor at this kind of text parsing and manipulation. Code that performs perfectly adequately on other platforms turns out to be a performance catastrophe on Android.<br><br>I'm pretty sure the code I posted above that just loads and splits to an array and then binary searches that array is likely to be about as quick as you can do this at Monkey's level of abstraction. I'd be curious to see if your approach of multiple smaller dictionary files improves the raw string load time somehow, but I imagine you've just got a faster phone than me. <br><br></td></tr></table><br>
<a name="2073488"></a>

<a name="2073487"></a>

<a name="2073495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Please apologize if I sidetrack the thread a bit but with all the codes posted I still wonder why the dictionary is stored in an StringMap&lt;String&gt; instead of an StringStack ?  <br></div><br><br>It's in a Map because that is how I did it :) I am still feeling my way with Monkey and a Map seemed like the logical choice and a nice easy way of checking if a word was in a list of 170,000+ words.  <br><br>Would like to see if someone could compile the code I currently have in the first post onto iOS and see how it performs.<br><br><div class="quote"> <br>I'm pretty sure the code I posted above that just loads and splits to an array and then binary searches that array is likely to be about as quick as you can do this at Monkey's level of abstraction.  <br> <br></div><br><br>For my current level of knowledge, I think your code is probably the way to go.   I haven't implemented the binary search of an Array in my code yet, will try and give it a go later today. <br><br></td></tr></table><br>
<a name="2073510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So I guess there are some new word games coming soon? ;)  <br></div><br>I have one planned for a long time, would even use minib3d/blitzmax to do it... but time/resources are a problem, so at least mine shouldn't see the light of day anytime soon.<br><br>And yeah, I also used a StringMap, because it's what I know... I do not know everything about Monkey yet, even if I completed some games with it :) <br><br></td></tr></table><br>
<a name="2073511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heh, changed my sample to StringStack, and the 'dict time' reduced to 190ms on WP8!<br><br>On Bluestacks, 140ms - so StringStack is definitively faster and better in this case than StringMap :) <br><br></td></tr></table><br>
<a name="2073515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  StringStack is definitively faster and better in this case than StringMap :) <br></div><br><br>At construction, sure. What about actually checking words? There's not much value in quickly constructing a dictionary that then cripples your game at runtime. <br><br>Another quick note on your code. You don't have to Trim the strings if you use the correct separator when splitting the string. Assuming your dict file is using Windows end of line indicators then the separator is "~r~n". <br><br></td></tr></table><br>
<a name="2073522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm  strange. The code runs fine on Bluestacks emulator, but on my crap android tablet, it doesn't seem to be working... it's reporting something like 2ms to load the file.<br><br>Yeah, loadstring is failing on the device...?! dict.txt is inside the apk, it works on the emulator, so what the h3ll is going on?!?!<br><br>Edit: figured out - my tablet is so crappy, it won't load more than 1mb text files with loadstring. Reduced the file to less than 1mb, and I got this:<br><br>load time: 2771ms (yikes! just half the dictionary! just loadstring!)<br>parse time: 1903ms (yikes ^2!)<br>dict time:1649ms (yikes ^3!)<br><br>To load everything (in two passes):<br>load time: 6565ms<br>parse time: 3944ms<br>dict time: 5789<br><br>Almost 17 seconds to load it all! Definitively a loading screen will be necessary...<br><br>Did I mention this tablet was reaaaally crappy?? :)<br><br>So, I would recommend to anyone doing word games to split the word files... will for sure avoid problems with low spec android devices! <br><br></td></tr></table><br>
<a name="2073521"></a>

<a name="2073518"></a>

<a name="2073519"></a>

<a name="2073520"></a>

<a name="2073524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Xaron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well yes, I've splitted my files so I have one for every length (3 to 10). It's coming along nicely. :)<br><br><img src="http://www.leidel.net/dl/words/screenshots/b15.jpg"> <br><br></td></tr></table><br>
<a name="2073532"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Edit: figured out - my tablet is so crappy, it won't load more than 1mb text files with loadstring. Reduced the file to less than 1mb, and I got this: <br></div><br><br>So maybe that is something I need to look out for, devices which impose a 1mb limit?<br><br>How do they test your App when you submit it, I'm guessing they have testers with every imaginable device running Android - in which case my App may fail based on this file size alone.<br><br><div class="quote"> So I guess there are some new word games coming soon? ;)  <br></div><br><br>I'm hoping to get mine submitted before Christmas - I'll post here if/when it gets accepted.  Not really my sort of game, but it's not so much about what you like to play but more about what other people like to play - and similar games have some massive amounts of downloads.   Time will tell if I've wasted my time. <br><br></td></tr></table><br>
<a name="2073533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Supertino</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not adding to the actual topic but;<br><br>&lt; 1MB files and 1024x1024 max textures is what I stick to to ensure older droid devices don't crap out. <br><br></td></tr></table><br>
<a name="2073573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gerry Quinn</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> They won't go overboard testing your app on everything, it just won't work on some devices.<br><br>As for runtime speed, any data structure that you can binary search is going to be blindingly fast unless you are really churning through millions of searches per second. <br><br></td></tr></table><br>
<a name="2073586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> How do they test your App when you submit it <br></div><br>On Google Play? No testing at all. You send your app, it will be live in a couple of hours. <br><br></td></tr></table><br>
<a name="2073619"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Not adding to the actual topic but;<br><br>&lt; 1MB files and 1024x1024 max textures is what I stick to to ensure older droid devices don't crap out. <br> <br></div><br><br>Interesting and worth noting for anyone looking at using a dictionary in their game.  <br><br>So the plans now are:  split the dictionary up into maybe 4 files of &lt; .5Mb each.  <br><br>Implement binary search.<br><br>Just going to focus on getting this thing working on HTML first, will make the final speedup changes before I submit to Google Play.<br><br><div class="quote"> On Google Play? No testing at all. You send your app, it will be live in a couple of hours. <br></div><br><br>Wow that surprises me.   But good to know you can have an App up within hours of submitting. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
