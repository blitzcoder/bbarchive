<!DOCTYPE html><html lang="en" ><head ><title >Basic SVG Parser</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Basic SVG Parser</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=512" >Monkey Code</a>/<a href="#bottom" >Basic SVG Parser</a><br><br>
<a name="2078345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, here is a basic SVG parser/renderer.  My plan was to look at being able to load SVG's, scale them to the size needed and then create an image atlas for the app to use.  For certain types of graphics/UI elements this could be great with all the different device resolutions/sizes.  It could also be used to create fonts at any size.<br><br>Anyway I threw this together and have not had time to take it any further, not all SVG commands have been implemented and there is no triangulation yet so it will only look correct on HTML5.<br><br>It requires SKN3's latest XML module and also contains various code snippets from the monkey forums (thanks to those who's code is used).<br><br><a href="https://github.com/CopperCircle/Monkey-SVG" target="_blank">https://github.com/CopperCircle/Monkey-SVG</a> <br><br></td></tr></table><br>
<a name="2078344"></a>

<a name="2078022"></a>

<a name="2078029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Notes:  <br><br>1.  You need to add the following code to the top of this file in order for it to work correctly, in addition to adding xml.monkey!<br><pre class=code>#TEXT_FILES += "*.svg"</pre><br><br>2.  This is pretty neato, if I don't say so myself;  I was looking into making something a lot like this but ya beat me to it!  <br><br>Two things which I was working on which may help this code snippet out was attempting to implement more advanced bezier rasterization techniques (ie:  a DrawBezier code snippet) such as de Casteljau's method and Hain-Ahmad-Langan rasterization, and decomposition of polygons.  I didn't get very far into it, but here are some of the documents I was using as research:<br><br><a href="http://tinyurl.com/HainBez" target="_blank">http://tinyurl.com/HainBez</a><br><a href="http://cs.gmu.edu/~jmlien/research/app-cd/p218-lien.pdf" target="_blank">http://cs.gmu.edu/~jmlien/research/app-cd/p218-lien.pdf</a> <br><br></td></tr></table><br>
<a name="2078104"></a>

<a name="2078105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdamRedwoods</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice! ambitious project. i would suggest looking at other people's projects and try porting (that is, if your objective is ultimately to get SVG into monkey):<br><a href="https://github.com/memononen/nanosvg" target="_blank">https://github.com/memononen/nanosvg</a><br><a href="https://github.com/pents90/svg-android/tree/master/svgandroid" target="_blank">https://github.com/pents90/svg-android/tree/master/svgandroid</a> <br><br></td></tr></table><br>
<a name="2078130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is definitely a capability that would be great to have. Maybe stick it up on github or similar if you want some collboration? <br><br></td></tr></table><br>
<a name="2078131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is definitely a capability that would be great to have. Maybe stick it up on github or similar if you want some collaboration? <br><br></td></tr></table><br>
<a name="2078250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, thanks for the comments and links, I hope others will look to collaborate on this so I have put it up on github.  I think the next step would be to look at getting the concave polys to draw on all targets, I have started to look at the options for triangulation and maybe something like Triangle could be ported which should be robust enough to handle holes and overlaps.  <a href="http://www.cs.cmu.edu/~quake/triangle.html" target="_blank">http://www.cs.cmu.edu/~quake/triangle.html</a><br><br><a href="https://github.com/CopperCircle/Monkey-SVG" target="_blank">https://github.com/CopperCircle/Monkey-SVG</a> <br><br></td></tr></table><br>
<a name="2078260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unfortunately the license (and projected authorial attitude) for Triangle seems incompatible with making something we could use in games. There are some other options listed here: <a href="http://stackoverflow.com/questions/406301/polygon-triangulation-with-holes?rq=1" target="_blank">http://stackoverflow.com/questions/406301/polygon-triangulation-with-holes?rq=1</a> <br><br></td></tr></table><br>
<a name="2078294"></a>

<a name="2078296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just added a <a href="/posts.php?topic=7911" target="_blank">triangulate function</a> to the code forum, it's just another ear clipper but I am keen on implementing a more advanced algorithm. <br><br></td></tr></table><br>
<a name="2078295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does that deal with holes and overlaps? It doesn't look like it. <br><br></td></tr></table><br>
<a name="2078297"></a>

<a name="2078298"></a>

<a name="2078299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought clipping ears with triangles was OK for holes as long as your ear check included any other verts being inside it. <br><br>Handling overlap needs an improvement to the implementation or second clipping pass.<br><br>It would be helpful to have spec / data / basic description to work with, including interpreting data where first three verts go anti clockwise etc.<br><br>Does html5 solve both issues properly or does it just do basic triangulation? <br><br></td></tr></table><br>
<a name="2078301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ear-clipping doesn't handle holes. The simple solution to using it with polys with holes is to make "cuts" to the hole but working out where to make those cuts is actually not simple for arbitrary shapes.<br><br>As far as a spec, we're talking about SVG, so the spec is up at W3.org. A basic example of the issue would be something like this, which defines an ellipse with two smaller ellipses cut out of it:<br><br><pre class=code>
  &lt;g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1"&gt;
    &lt;path
       style="fill:#000000;fill-opacity:1;fill-rule:evenodd;stroke:#ffffff;stroke-width:4;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-opacity:1;stroke-dasharray:none"
       d="M 408.5625 163.78125 C 234.9873 163.78125 94.28125 314.73864 94.28125 500.9375 C 94.28125 687.13636 234.9873 838.0625 408.5625 838.0625 C 582.1377 838.0625 722.84375 687.13636 722.84375 500.9375 C 722.84375 314.73864 582.1377 163.78125 408.5625 163.78125 z M 481.4375 366.65625 C 515.36356 366.65625 542.84375 398.61359 542.84375 438.0625 C 542.84375 477.51141 515.36356 509.5 481.4375 509.5 C 447.51144 509.5 420 477.51141 420 438.0625 C 420 398.61359 447.51144 366.65625 481.4375 366.65625 z M 344.28125 406.65625 C 382.94118 406.65625 414.28125 469.95366 414.28125 548.0625 C 414.28125 626.17134 382.94118 689.5 344.28125 689.5 C 305.62132 689.5 274.28125 626.17134 274.28125 548.0625 C 274.28125 469.95366 305.62132 406.65625 344.28125 406.65625 z "
       id="path2985" /&gt;
  &lt;/g&gt;
</pre> <br><br></td></tr></table><br>
<a name="2078300"></a>

<a name="2078311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, and DrawPoly on HTML5 doesn't support this either. I think the underlying canvas path stuff can though. <br><br></td></tr></table><br>
<a name="2078369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Muddy, thanks for the reply.<br><br>It is possibly saner to plug SVG into a scan line renderer to reach any kind of spec parity although <a href="https://developer.nvidia.com/nv-path-rendering" target="_blank">nVidia think they can handle such things</a>.<br><br>Living without holes and overlaps for level design seems like a small price to including this kind of format into an asset pipeline. <br><br>I think Mojo support for line width, smoothing and endpoints would be most useful addition to things at this point.. <br><br></td></tr></table><br>
<a name="2078365"></a>

<a name="2078383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> skid, I agree we don't need to support holes/overlaps, you can break shapes up in Illustrator/Inkscape to get over it.  I have quickly added your triangulate method and updated the repo but on my concave test it seems to return an inverted shape? <br><br></td></tr></table><br>
<a name="2078429"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> testing with concave.svg I get a doh error - Monkey Runtime Error : doh! could not read concave.svg<br><br>[edit] fixed by removing some of the header<br><br>also, Error is a reserved word in monkey and is capitalized in Ted so I have renamed it, problem area for me was here:<br><br><pre class=code>
Method LoadSVG:Void(_file:String)
	Local _Error:XMLError
	file = ParseXML(LoadString(_file), _Error)
	If file = Null			
		Error("doh! could not read "+_file+" _Error="+_Error)
	Else
		If file.GetAttribute("width") w=Int(file.GetAttribute("width")) ; width=w
		If file.GetAttribute("height") h=Int(file.GetAttribute("height")) ; height=h
	Endif
End Method
</pre> <br><br></td></tr></table><br>
<a name="2078427"></a>

<a name="2078428"></a>

<a name="2078426"></a>

<a name="2078419"></a>

<a name="2078417"></a>

<a name="2078435"></a>

<a name="2078436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is new version of <a href="/posts.php?topic=7911" target="_blank">triangulate.monkey</a> that passes the mustache test. <br><br>Monkey.svg is looking a bit patchy, I can't say it's obvious what needs fixing next but I'm wondering if it's a clockwise winding thing still.<br><br>I am testing in html5 and it's interesting to see the seams between polygons, i'm pretty sure we can deal to that with new mojo-x that is hopefully due soon. <br><br></td></tr></table><br>
<a name="2078430"></a>

<a name="2078423"></a>

<a name="2078448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I will try the new version, also you need the latest xml from SKN3 as he has fixed it to work with the headers that illustrator produces.  I will change error in the repo <br><br></td></tr></table><br>
<a name="2078459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is great guys!<br><br>For this to reach it's full potential, Mojo Graphics should have at least this function:<br><br><pre class=code>DrawTriangles(trianglevertices:Float[],indexes:Int[]) </pre><br><br>( iOS and desktop targets antialias the edge of polygons, so the DrawPoly(triangle[]) method will show gaps/line artifacts ) .<br><br>I hacked it in this old demo and have been advocating for it since then, I hope that now skid is onboard we can sway mark to putting it in... :-)  <a href="http://scheutz.dk/stuff/monkeyvector.html" target="_blank">http://scheutz.dk/stuff/monkeyvector.html</a><br><br>For thick lines <pre class=code>DrawTriangleStrip:Void(vertices:Float[])</pre> is really usefull and mostly the fastest way.<br><br>BTW: I have a triangulate function I can share if needed? <br><br></td></tr></table><br>
<a name="2078454"></a>

<a name="2078451"></a>

<a name="2078472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Difference, it sounds like the new mojo-x may help with this, but would be great to try your functions in the mean time, feel free to branch the repo? <br><br></td></tr></table><br>
<a name="2078473"></a>

<a name="2078475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess I could for the Desktop target since it's free now? - I'll look into it, but I'd rather just share the code in a post, because I don't have experience with GIT pull requests and such.<br>Problem untill now has been that we are not allowed to share the code for all targets.<br><br>[EDIT]: Where is the desktop mojo target ? <br>Not here: <a href="https://github.com/blitz-research/monkey/tree/develop/modules/mojo" target="_blank">https://github.com/blitz-research/monkey/tree/develop/modules/mojo</a><br><br>and where is mojo-x ? <br><br></td></tr></table><br>
<a name="2078523"></a>

<a name="2078524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mojo-x is not release yet.  Also skid I updated the repo with your newer triangulate method and its getting there, the text.svg example is very broken though... <br><br></td></tr></table><br>
<a name="2078528"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool, thanks for testing - this is quite a challenge. <br><br></td></tr></table><br>
<a name="2078527"></a>

<a name="2078574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Problem untill now has been that we are not allowed to share the code for all targets.<br><br>[EDIT]: Where is the desktop mojo target ?<br>Not here: <a href="https://github.com/blitz-research/monkey/tree/develop/modules/mojo" target="_blank">https://github.com/blitz-research/monkey/tree/develop/modules/mojo</a> <br></div><br><br>Jeez, it's been 2 months already, even.  <a href="https://github.com/blitz-research/monkey/issues/43" target="_blank">https://github.com/blitz-research/monkey/issues/43</a> <br><br></td></tr></table><br>
<a name="2078765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Version 0.5 of triangulate is up which passes the monkey and mustache test.<br><br>I need help with the IsWoundClockwise algorithm as the one I've tried is either broken or just wrong. <br><br>Hopefully if this function can be fixed the text test should be passable also. <br><br></td></tr></table><br>
<a name="2078890"></a>

<a name="2078891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I Use the PolygonArea() function from here: <a href="http://www.monkey-x.com/Community/posts.php?topic=1659&amp;post=15542" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=1659&amp;post=15542</a> to determine winding.<br><br>There is also a function to determine if triangulation is needed or we can just use mojo's DrawPoly() because that works fine with non concave polygons. <br><br></td></tr></table><br>
<a name="2078895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> This could be really useful for me, I'm looking to do some graph rendering :) <br><br></td></tr></table><br>
<a name="2079028"></a>

<a name="2079029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been testing my own Triangulate() routine on this and getting results similar to skids.<br><br>I've made a simple test shape, to experiment with polygons with holes. (A pentagon inside a hexagon) <br><br>This SVG parses to a poly with 15 points. An outer ring that repeats point 0 as point 12 and 14 and an inner ring that repeats the last point. (Point 7,14 and 15 are identical)<br><br>I think it should parse as two separate polygons made of 6 + 5 points and send those to the triangulate routine.<br>I also  think it should NOT duplicate the endpoints and I don't think it should repeat the first point as the last point.<br><br>Splitting paths when the SVG code indicates "Close Path" will allow us to build a solid triangulator that deals with compound paths/holes.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!-- Generator: Adobe Illustrator 15.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --&gt;
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
&lt;svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="127.561px" height="127.561px" viewBox="0 0 127.561 127.561" enable-background="new 0 0 127.561 127.561"
	 xml:space="preserve"&gt;
&lt;path fill="#00AEEF" d="M75.236,10.177l-48.01,14.49L15.77,73.489l36.553,34.333l48.01-14.489L111.79,44.51L75.236,10.177z M74,71
	l-25.872-0.392l-7.623-24.727l21.16-14.89l20.7,15.523L74,71z"/&gt;
&lt;/svg&gt;</textarea> <br><br></td></tr></table><br>
<a name="2079025"></a>

<a name="2079026"></a>

<a name="2079027"></a>

<a name="2079022"></a>

<a name="2079023"></a>

<a name="2079024"></a>

<a name="2079019"></a>

<a name="2079020"></a>

<a name="2079021"></a>

<a name="2079017"></a>

<a name="2079018"></a>

<a name="2079083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I have just updated the repo, I added skid's new v0.6 triangulate function, tweaked the parser to not add extra endpoints and I also added a splitPath bool to the DrawPath method, this will split paths into separate polys when a close path is called.<br>This now draws Difference's test correctly and the text test is almost there, the problem is I am just drawing the extra path polys as white to represent transparent, this wont work if the path is being drawn over another object. <br><br></td></tr></table><br>
<a name="2079129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great work! , multiple polygons are definitely the way to go.<br><br>Theres still one repetition of the endpoint/startpoint that IMO needs to go on the test.svg<br>Test it by using DrawPoly(poly[c][..poly[c].Length()-2]) - will work too on html5,skids triangulate and my own because the parser does not need to add the last point.<br><br>It turns out skids Triangulate() does not triangulate the test.svg at all. It just returns 2 convex polygons. I don't know if this is intentionally?<br>If so skids function should be called Convexyfy() or something similar. :)<br>The n-gons does not need triangulation to look okay with mojos DrawPoly(), but in order to do polygons with holes, we need to triangulate everything.<br><br>PS: I have a glitch where I need to copy paste the test.svg into a new file, or else I get a "doh" error. I'm OS X, so I'm guessing this is a file encoding issue/UTF-8 /lineending .... something [EDIT] : It's the !DOCTYPE tag, but I think I am using version 23 of XML.monkey, will test further. <br><br></td></tr></table><br>
<a name="2079126"></a>

<a name="2079127"></a>

<a name="2079128"></a>

<a name="2079189"></a>

<a name="2079204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, make sure you have the latest XML module, SKN3 updated it to work with Illustrator SVG XML for me.<br>Also do you want to share your triangulate function? the more the merrier, I will look at the final extra point being created.<br>Edit: I was creating and extra point on absolute MoveTo commands, this has been fixed now and the correct amount of points are created in the test.svg <br><br></td></tr></table><br>
<a name="2079208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skid</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I clip an ear I test that no other vertices are inside.  Thinking about it, I should be testing that no edges subdivide the ear. <br><br></td></tr></table><br>
<a name="2079376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll post my triangulator soon, - I'm giving creating holes a go first.<br>I'm using the latest XML version<br>Great: I'll use the new version when testing my tesselator.<br><br>@skid: What I do is test if any points are inside the ear. If the poly is none-selfintersecting that should do it. <br><br></td></tr></table><br>
<a name="2079290"></a>

<a name="2079991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm looking at this now.<br>Using the latest version form github, my simple test.svg is being parsed to 3 polygons, the last one empty<br><br>Try a:  Print "Polygons: " + poly.Length() in DrawTriangulatedPoly to test.<br><br>I'll put in a check for empty polygons, but I it seems the parser is outputting one poly too much <br><br></td></tr></table><br>
<a name="2080006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, yes but only two polys are passed to the DrawPoly or Triangulate functions, the empty poly is created from how I am splitting them in a multi array. <br><br></td></tr></table><br>
<a name="2080007"></a>

<a name="2080008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, I see that now, hence the -2 in the loop.<br>I'll throw away the last poly for now :-) <br><br></td></tr></table><br>
<a name="2080059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Almost there, but made this that doesn't seem to draw with any method (html5, mine, skids)<br><br>mustwithholeanddownarrow.svg : <br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="480px" height="640px" viewBox="0 0 480 640" enable-background="new 0 0 480 640" xml:space="preserve"&gt;
&lt;polygon fill="#FF0000" stroke="#000000" stroke-width="0.7071" stroke-miterlimit="10" points="253.492,234.789 254.04,260.622 
	220.171,299.573 192.628,236.077 223.967,278.251 "/&gt;
&lt;path fill="#FF0000" stroke="#000000" stroke-miterlimit="10" d="M296.199,142.98c-4.383,3.46-3.954,7.833-7.176,12.069
	c-3.274,4.304-8.087,5.691-11.746,9.205c-6.564,6.304-6.41,11.424-15.829,14.991c-16.347,6.191-39.262,2.694-57.345,1.977
	c-14.314-0.568-28.221-0.665-42.107-3.472c-11.896-2.405-14.406-11.697-23.975-17.751c-16.875-10.676-21.673-22-44.021-22L92,139
	c13.914,5.98,12.854,17.065,19.98,28.009c4.679,7.187,13.713,9.729,18.293,16.955c7.312,11.536,10.735,34.341,23.929,42.055
	c7.376,4.313,27.59,2.588,37.052,3.032c10.936,0.513,21.65-1.052,32.646-1.052c11.509,0,23.686,1.228,35.1,0.052
	c6.502-0.67,24.575,0.691,29.996-2.032c4.704-2.363,5.438-11.117,7.757-16.793c3.945-9.658,8.834-18.637,14.543-27.269
	c11.034-16.684,8.676-32.615,12.95-51.148C321.398,129.545,299.778,140.154,296.199,142.98z M284.794,194.9
	c-9.557,19.467-44.598,32.563-66.896,27.608s-54.154-21.945-54.154-21.945s4.955-18.405,26.9-11.326s27.253,31.147,54.507,14.512
	S294.35,175.433,284.794,194.9z"/&gt;
&lt;/svg&gt;</textarea><br><br>[EDIT]<br>This one is ok: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!-- Generator: Adobe Illustrator 15.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --&gt;
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1 Basic//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11-basic.dtd"&gt;
&lt;svg version="1.1" baseProfile="basic" id="Layer_1"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="480px" height="640px"
	 viewBox="0 0 480 640" xml:space="preserve"&gt;
&lt;path fill="#FF0000" stroke="#000000" stroke-miterlimit="10" d="M296.199,142.98c-4.383,3.46-3.954,7.833-7.176,12.069
	c-3.274,4.304-8.087,5.691-11.746,9.205c-6.564,6.304-6.41,11.424-15.829,14.991c-16.347,6.191-39.262,2.694-57.345,1.977
	c-14.314-0.568-28.221-0.665-42.107-3.472c-11.896-2.405-14.406-11.697-23.975-17.751c-16.875-10.676-21.673-22-44.021-22L92,139
	c13.914,5.98,12.854,17.065,19.98,28.009c4.679,7.187,13.713,9.729,18.293,16.955c7.312,11.536,10.735,34.341,23.929,42.055
	c7.376,4.313,27.59,2.588,37.052,3.032c10.936,0.513,21.65-1.052,32.646-1.052c11.509,0,23.686,1.228,35.1,0.052
	c6.502-0.67,24.575,0.691,29.996-2.032c4.704-2.363,5.438-11.117,7.757-16.793c3.945-9.658,8.834-18.637,14.543-27.269
	c11.034-16.684,8.676-32.615,12.95-51.148C321.398,129.545,299.778,140.154,296.199,142.98z M284.794,194.9
	c-9.557,19.467-44.598,32.563-66.896,27.608s-54.154-21.945-54.154-21.945s4.955-18.405,26.9-11.326s27.253,31.147,54.507,14.512
	S294.35,175.433,284.794,194.9z"/&gt;
&lt;/svg&gt;
</textarea><br><br><br>[EDIT2]<br>This one totally explodes: <a href="http://upload.wikimedia.org/wikipedia/commons/f/fd/Ghostscript_Tiger.svg" target="_blank">http://upload.wikimedia.org/wikipedia/commons/f/fd/Ghostscript_Tiger.svg</a> <br><br></td></tr></table><br>
<a name="2080058"></a>

<a name="2080041"></a>

<a name="2080042"></a>

<a name="2080050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.monkey-x.com/Community/posts.php?topic=8035" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8035</a><br><br>^^ My triangulator with initial holes support! :-) <br><br></td></tr></table><br>
<a name="2080072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good work!, I have updated the repo and added your triangulator, I also fixed a bug with the polygon svg command so now your tests both work, the parser only supports SVG v1.1 and has only been tested with SVG output from Adobe Illustrator, I re-saved the tiger svg (check repo) and it works! there are a few elements missing that I have not added to the command processor, so will try and add these soon.<br>This is almost there, would be great to get it all working and then I am thinking of trying to get SVG fonts into angelfont or fontmachine. <br><br></td></tr></table><br>
<a name="2080201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> New tessellate.monkey version up. (v0.3 ) 2014.02.26<br>This one handles tiger, text and monkey :-)<br><a href="http://www.monkey-x.com/Community/posts.php?topic=8035" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8035</a> <br><br></td></tr></table><br>
<a name="2080204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, sounds great :)<br>Just tried the new version and I get Array index out of range in the Tessellate Method, triangleindexes[i] = indexedpoly.ear[0] ?<br>Thanks. <br><br></td></tr></table><br>
<a name="2080289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> [EDIT] : I can reproduce it on Windows Desktop, will fix ASP<br>[EDIT2] : Fix confirmed, and corrected in forum post. :-)<br><br>Sorry, can you try putting If Self.Length() &lt;3 Then Return False<br>as the first line in Method ClipEar:Bool() to see if that fixes it?<br><br>I just re-downloaded from GitHub and updated tessellate.monkey from my from forum post, and I don't get that error.<br>I can see two reasons why it could happen<br><br>Also if the svg you're testing with is not one of the samples, please post it here.<br><br><pre class=code>
	Method ClipEar:Bool()
		If Self.Length() &lt;3 Then Return False
</pre> <br><br></td></tr></table><br>
<a name="2080277"></a>

<a name="2080278"></a>

<a name="2080276"></a>

<a name="2080272"></a>

<a name="2080270"></a>

<a name="2080343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, works now :)  I have updated the repo with your latest build and updated the parser, I added the svg smooth quadratic Bézier curveto commands but there are not perfect yet, they are needed for svg fonts which I am working on.<br>I noticed the nose on the tiger is not the same as HTML5 in GLFW the shape is lost and there are few bits of the poly around the chin.  Monkey.svg and text.svg look great. <br><br></td></tr></table><br>
<a name="2080346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool.  :-)<br>I'm working on improving the holemerger, - maybe that will improve the results.<br>I also added some debugging variables to detect when something is lost.<br><br>I think you should output polylines to a separate function, - then we can make a function that makes fat lines from polygons.<br>I have one I think I can modify to work.<br>I guess stroke could use that too? <br><br></td></tr></table><br>
<a name="2080344"></a>

<a name="2080697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good news. mojo GLFW is here: <a href="https://github.com/blitz-research/monkey/blob/develop/modules/mojo/native/mojo.glfw.cpp" target="_blank">https://github.com/blitz-research/monkey/blob/develop/modules/mojo/native/mojo.glfw.cpp</a><br>I'll hack in a DrawTriangles() ASAP<br><br>My new version of the tesselator seems quite stable and handles multiple holes well. :-)<br>Will post it ASAP<br><br>After examining the tiger.svg in Illustrator, it looks like the problem comes from lines being sent to the tesselator as polygons. <br><br></td></tr></table><br>
<a name="2080711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great, I will look to improve the parser and also output lines/polylines separately. <br><br></td></tr></table><br>
<a name="2080881"></a>

<a name="2080883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> New version is up at <a href="http://www.monkey-x.com/Community/posts.php?topic=8035" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8035</a><br><br>I added a first version of a ThickPolyLine to draw triangulated lines with width.<br><br>Please note that I changed the calling convention a little to:<br>	Tessellator.TriangulateAndDrawPolyline:Void(points:Float[],thickness:Float,closed:Bool)<br> 	Tessellator.TriangulateAndDrawPolygons:Void(polys:Float[][])<br><br><br>Heres a multihole svg for testing:<br><br>gridholes.svg<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;!-- Generator: Adobe Illustrator 15.0.2, SVG Export Plug-In . SVG Version: 6.00 Build 0)  --&gt;
 &lt;svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="566.929px" height="566.929px" viewBox="0 0 566.929 566.929" enable-background="new 0 0 566.929 566.929"
	 xml:space="preserve"&gt;
&lt;path fill="#ED1C24" d="M28.347,28.347v481.89h510.236V28.347H28.347z M56.692,311.811h56.692v56.692H56.692V311.811z
	 M113.386,481.89H56.693v-56.692h56.692V481.89z M113.386,283.465H56.693v-56.692h56.692V283.465z M113.386,198.425H56.693v-56.692
	h56.692V198.425z M113.386,113.386H56.693V56.693h56.692V113.386z M170.078,311.811h56.692v56.692h-56.692V311.811z M226.771,481.89
	h-56.692v-56.692h56.692V481.89z M226.771,283.465h-56.692v-56.692h56.692V283.465z M226.771,198.425h-56.692v-56.692h56.692
	V198.425z M226.771,113.386h-56.692V56.693h56.692V113.386z M283.464,311.811h56.692v56.692h-56.692V311.811z M340.157,481.89
	h-56.692v-56.692h56.692V481.89z M340.157,283.465h-56.692v-56.692h56.692V283.465z M340.157,198.425h-56.692v-56.692h56.692
	V198.425z M340.157,113.386h-56.692V56.693h56.692V113.386z M396.85,311.811h56.692v56.692H396.85V311.811z M453.543,481.89h-56.692
	v-56.692h56.692V481.89z M453.543,283.465h-56.692v-56.692h56.692V283.465z M453.543,198.425h-56.692v-56.692h56.692V198.425z
	 M453.543,113.386h-56.692V56.693h56.692V113.386z"/&gt;
&lt;path fill="#ED1C24" d="M188,72v32h25V72H188z M200.5,91.478c-3.677,0-6.657-2.98-6.657-6.657s2.98-6.657,6.657-6.657
	s6.657,2.98,6.657,6.657S204.177,91.478,200.5,91.478z"/&gt;
&lt;/svg&gt;
</textarea> <br><br></td></tr></table><br>
<a name="2080966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just giving this a proper go now, really impressed with it :)<br><br>I would very much like to use this along with server side generated SVGs, right now I am thinking via the PHP library SVGGraph - <a href="http://www.goat1000.com/svggraph.php" target="_blank">http://www.goat1000.com/svggraph.php</a><br><br>The below SVG generates this through a standard browser<br><br><img src="http://chrismingay.co.uk/screenshots/svggraph.png"><br>and monkey-svg currently generates<br><img src="http://chrismingay.co.uk/screenshots/monkeysvgout.png"><br><br>I did wonder if the parser doesn't work with rgb() colour values, but I get the same when using #FFFFFF format colours.<br><br>Regardless though, really impressed :D<br><br><pre class=code>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;svg width="640" height="480" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"&gt;
	&lt;rect width="100%" height="100%" fill="rgb(240,240,240)" stroke-width="1px" stroke="rgb(0,0,0)"/&gt;
	&lt;path d="M33 458h597M33 435.95h597M33 413.9h597M33 391.85h597M33 369.8h597M33 347.75h597M33 325.7h597M33 303.65h597M33 281.6h597M33 259.55h597M33 237.5h597M33 215.45h597M33 193.4h597M33 171.35h597M33 149.3h597M33 127.25h597M33 105.2h597M33 83.15h597M33 61.1h597M33 39.05h597M33 17h597M33 17v441M232 17v441M431 17v441M630 17v441" stroke="rgb(220,220,220)"/&gt;
	&lt;rect width="189" x="38" y="237.5" height="220.5" id="e2" style="fill:red;stroke:rgb(0,0,0);stroke-width:1px;"/&gt;
	&lt;rect width="189" x="237" y="17" height="441" id="e3" style="fill:green;stroke:rgb(0,0,0);stroke-width:1px;"/&gt;&lt;rect width="189" x="436" y="127.25" height="330.75" id="e4" style="fill:blue;stroke:rgb(0,0,0);stroke-width:1px;"/&gt;
	&lt;path d="M33 461v-3M232 461v-3M431 461v-3M630 461v-3M30 458h3M30 435.95h3M30 413.9h3M30 391.85h3M30 369.8h3M30 347.75h3M30 325.7h3M30 303.65h3M30 281.6h3M30 259.55h3M30 237.5h3M30 215.45h3M30 193.4h3M30 171.35h3M30 149.3h3M30 127.25h3M30 105.2h3M30 83.15h3M30 61.1h3M30 39.05h3M30 17h3" stroke-width="1px" stroke="rgb(0,0,0)"/&gt;
	&lt;g stroke-width="2px" stroke="rgb(0,0,0)"&gt;
		&lt;path d="M28 458h607"/&gt;
		&lt;path d="M33 12v451"/&gt;
	&lt;/g&gt;
	&lt;g font-size="10px" font-family="monospace" fill="rgb(0,0,0)"&gt;
		&lt;g text-anchor="end"&gt;
			&lt;text x="28" y="461"&gt;0&lt;/text&gt;
			&lt;text x="28" y="438.95"&gt;10&lt;/text&gt;
			&lt;text x="28" y="416.9"&gt;20&lt;/text&gt;
			&lt;text x="28" y="394.85"&gt;30&lt;/text&gt;
			&lt;text x="28" y="372.8"&gt;40&lt;/text&gt;
			&lt;text x="28" y="350.75"&gt;50&lt;/text&gt;
			&lt;text x="28" y="328.7"&gt;60&lt;/text&gt;
			&lt;text x="28" y="306.65"&gt;70&lt;/text&gt;
			&lt;text x="28" y="284.6"&gt;80&lt;/text&gt;
			&lt;text x="28" y="262.55"&gt;90&lt;/text&gt;
			&lt;text x="28" y="240.5"&gt;100&lt;/text&gt;
			&lt;text x="28" y="218.45"&gt;110&lt;/text&gt;
			&lt;text x="28" y="196.4"&gt;120&lt;/text&gt;
			&lt;text x="28" y="174.35"&gt;130&lt;/text&gt;
			&lt;text x="28" y="152.3"&gt;140&lt;/text&gt;
			&lt;text x="28" y="130.25"&gt;150&lt;/text&gt;
			&lt;text x="28" y="108.2"&gt;160&lt;/text&gt;
			&lt;text x="28" y="86.15"&gt;170&lt;/text&gt;
			&lt;text x="28" y="64.1"&gt;180&lt;/text&gt;
			&lt;text x="28" y="42.05"&gt;190&lt;/text&gt;
			&lt;text x="28" y="20"&gt;200&lt;/text&gt;
		&lt;/g&gt;
		&lt;g text-anchor="middle"&gt;
			&lt;text y="470" x="132.5"&gt;0&lt;/text&gt;
			&lt;text y="470" x="331.5"&gt;1&lt;/text&gt;
			&lt;text y="470" x="530.5"&gt;2&lt;/text&gt;
		&lt;/g&gt;
	&lt;/g&gt;
&lt;/svg&gt;</pre> <br><br></td></tr></table><br>
<a name="2080972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, yes the trouble with SVG files is there are loads of different attributes to implement!  I am planning to work on the parser over the weekend and will update the git repo, I should be able to add rgb and style attributes, also text is not currently supported. <br><br></td></tr></table><br>
<a name="2081141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> @CopperCircle: sounds great.<br><br>I'm looking into supporting miter, round and bevel joints for the lines, also there will be a miter-limit.<br>Capping will be butt,round and square.<br><br>Will this Function syntax work for you?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' jointype: miter = 0 , round = 1, bevel = 2	  	 
' captype: butt = 0 , round = 1, square = 2	 
Function TriangulateAndDrawPolyline:Void(points:Float[],linewidth:Float,closed:Bool,jointype:Int=0,captype:Int=0,miterlimit:Float=4.0)
</textarea><br><br>[EDIT]: I just forked and added tessellate.monkey as a pull request. Let me know if that's a good way for future updates. <br><br></td></tr></table><br>
<a name="2081140"></a>

<a name="2081052"></a>

<a name="2081051"></a>

<a name="2081050"></a>

<a name="2081049"></a>

<a name="2081238"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, that syntax looks fine and yes adding to the repo with your updates sounds great, I will be updating again this weekend.  Thanks. <br><br></td></tr></table><br>
<a name="2081365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, just updated the repo, this is getting better all the time, great work on the tessellate code :)<br>- Refactored some code, added tesselate v0.6, added support for rgb and named colours, added stroke/polyline, added basic text support.<br><br>I added Raz's graph example and noticed that tessellate polyline is triangulating single straight lines, not sure how's best to handle them... <br><br></td></tr></table><br>
<a name="2081411"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really nice work. Great to see this progressing :-)<br><br>The problem with the graph.svg seems to come from the parser:<br><br>1) The lines are being sent both as polygon and polyline, they should only be polylines ( this seems also to be the case with the little arc below the text in "text.svg" ? )<br><br>2) I think it's the line sent from the parser that is not correct. Try viewing the pointarray with the below function ( you can put in a call in the top of TriangulateAndDrawPolyline )<br>It looks "crosshatched"<br><br><pre class=code>Function DebugDrawFloatPoints :Void(points:Float[])
	SetColor 255,0,0
	For Local p:Int=0 Until  points.Length()-2 Step 2
			DrawLine points[p],points[p+1],points[p+2],points[p+3]
	Next	
End function</pre><br><br>3) The tiger.svg suffers from lack of miter-limit capping, I got this fixed in the next version.<br><br>4)   I'm noticing you're not using the closed = false flag anywhere. The flag is intended for non-closed lines such as the little arc in text.svg.<br><br>Thick lines turns out to be a little more complicated than I first thought due to the deterioration of the inner corners, as the line gets thicker.<br>I got a couple of strategies, and will find the best one ! <br><br>Keep up the good work. :-) <br><br></td></tr></table><br>
<a name="2081410"></a>

<a name="2081409"></a>

<a name="2081453"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome job in getting the graph rendered :D That's really amazing work. <br><br></td></tr></table><br>
<a name="2081454"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll have to start doing some reading on SVG so I can be a little less needy and a little more helpful... but....<br><br><pre class=code>&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;svg width="640" height="480" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"&gt;
	&lt;g&gt;
		&lt;path stroke="rgb(0,0,0)" fill="none" stroke-width="2px" d="M27 441.67 L127 392.67 227 327.33 327 311 427 196.67 527 49.667 627 17 "/&gt;
	&lt;/g&gt;
	
&lt;/svg&gt;</pre><br>Are you able to determine why this only renders the first section of the path? Chrome renders a graph looking line. <br><br></td></tr></table><br>
<a name="2081491"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, yes your right it was passing the same poly twice! doh!  Fixed now and a few more improvements on the repo, but if you try the lines.svg it still triangulates the straight lines?  The tiger.svg is looking almost perfect now :)<br><br>Raz: the parser is not stable yet so I would wait and test each update, it is getting better all the time. <br><br></td></tr></table><br>
<a name="2081517"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Getting good :-)<br><br>These are the lines sent to the Polyline function: <br><br><img src="http://scheutz.dk/stuff/hatchlines.png"><br><br>You can use <br>	Function TriangulateAndDrawPolyline:Void(points:Float[],thickness:Float,closed:Bool)<br>		DebugDrawFloatPoints points<br>		Return<br>with this funtion to view it.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function DebugDrawFloatPoints :Void(points:Float[])
	SetColor 0,100,0
	For Local p:Int=0 Until  points.Length()-2 Step 2
			DrawCircle points[p],points[p+1],5
	Next	

	SetColor 255,0,0
		For Local p:Int=0 Until  points.Length()-2 Step 2
			DrawLine points[p],points[p+1],points[p+2]+Rnd(0),points[p+3]+Rnd(0)
	Next	
End function	</textarea><br><br>[EDIT] : Try this with the tiger.svg too. There's a line across the face: <br><br><img src="http://scheutz.dk/stuff/tigerline.png"> <br><br></td></tr></table><br>
<a name="2081515"></a>

<a name="2081514"></a>

<a name="2081518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Absolutely I love testing each update and will figure out how I can actually help <br><br></td></tr></table><br>
<a name="2081525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I am just passing the points as they are in the file, if you use this debug function you can see the order they are drawn in and if you change the DrawLine step to 4 the grid lines are fine, not sure how to deal with stroke/lines as the behaviour seems to need to change depending on the source?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function DebugDrawFloatPoints :Void(points:Float[], pointNumbers:Bool=False)
	SetColor 0,100,0
	For Local p:Int=0 Until points.Length()-2 Step 2
		DrawCircle points[p],points[p+1],5
		If pointNumbers	DrawText(p, points[p],points[p+1])
	Next

	SetColor 255,0,0
	For Local p:Int=0 Until points.Length()-2 Step 4
		DrawLine points[p], points[p+1], points[p+2], points[p+3]
	Next
End Function
</textarea> <br><br></td></tr></table><br>
<a name="2081526"></a>

<a name="2081527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think it's because you're not starting a new Subpath on the "M" command, resulting in a polyline rather than individual line segments. ?<br><br><a href="http://www.w3.org/TR/SVG/paths.html#PathDataMovetoCommands" target="_blank">http://www.w3.org/TR/SVG/paths.html#PathDataMovetoCommands</a><br><br><div class="quote"> The effect is as if the "pen" were lifted and moved to a new location <br></div> <br><br></td></tr></table><br>
<a name="2081540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> If a path is defined as having fill="none" and/or doesn't end with the Z (closepath) control it would suggest to me that instead of drawing a poly, it should just be a series of drawn lines? This would also allow for proper interpretation of M/m <br><br></td></tr></table><br>
<a name="2081542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> That is what the parser does, I have now added sub paths to M and all is working well, I will update repo later. <br><br></td></tr></table><br>
<a name="2081544"></a>

<a name="2081545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great, will you be using the "closed" flag=false for this?<br><br>[EDIT] or rather (since default is now closed=false, will you send the flag for closed polylines? (It's needed for nice joining of start and end)<br><br>I have a new line function finished that has miter-limit and bevel joins working<br><br>A little thing I have noticed that linewidths are not scaled when zooming in and out, it would be great to have that added. <br><br></td></tr></table><br>
<a name="2081555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh sorry Copper, I look forward to the update :D <br><br></td></tr></table><br>
<a name="2081562"></a>

<a name="2081563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've updated tessellate.monkey to v0.7.<br><br>I added a pull request on github and put it here too : <a href="http://www.monkey-x.com/Community/posts.php?topic=8035" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8035</a><br>I basically rewrote the line generation function. <br><br></td></tr></table><br>
<a name="2081577"></a>

<a name="2081578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, quick update has been posted to the repo, Raz: your graph is working now :) ,  I also added linewidth scaling and tessellate v0.7.  Difference I will add better support for your new line functions soon, thanks for the update.<br><br>[EDIT] Seems Git is playing up and the code did not post...!<br><br>Here is the latest version:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
'--------------------------
' Monkey SVG Parser - v0.8
' By Lee Wade/CopperCircle
'--------------------------

'v0.8 - Fixed split to sub paths on SVG_M, make sure stroke/polylines scale in size/alpha.
'v0.7 - Refactored some code, added tesselate v0.6, added support for rgb and named colours, added stroke/polyline, added basic text support.
'v0.6 - Added tesselate v0.3, added svg T/t commands.
'v0.5 - Added Difference's Triangulator, fixed polygon bug.
'v0.4 - Fix extra point creation on SVG_M commands.
'v0.3 - Tweaked parser, updated triangulate, added split paths.
'v0.2 - Updated skid's triangulate method.
'v0.1 - Added skid's triangulate method. 

#REM
The MIT License (MIT)

Copyright (c) 2014 Lee Wade

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
#END

#TEXT_FILES += "*.svg"

Strict

Import mojo
Import xml
Import tesselate

Class SVG_Demo Extends App
	Field test:SVG = New SVG
	Field testX:Float, testY:Float, testS:Float=1, testRotate:Float
	Field font:Image

	Method OnCreate:Int()
		test.LoadSVG("graph.svg")
		'test.LoadSVG("tiger.svg")
		'test.LoadSVG("monkey.svg")
		'test.LoadSVG("text.svg")
		
		font = LoadImage("font.png", 91)
		SetFont(font)

		SetUpdateRate 60
		Return 0
	End Method

	Method OnUpdate:Int()
		testX=MouseX()-(test.width/2)
		testY=MouseY()-(test.height/2)
	
		If KeyDown(KEY_DOWN) testS-=0.05
		If KeyDown(KEY_UP) testS+=0.05
		If KeyDown(KEY_LEFT) testRotate+=1
		If KeyDown(KEY_RIGHT) testRotate-=1
		
		If KeyHit(KEY_EQUALS) test.curveSegments+=10
		If KeyHit(KEY_MINUS) test.curveSegments-=10
				
		Return 0
	End Method
	
	Method OnRender:Int()
		Cls(255,255,255)

		test.DrawSVG(testX, testY, testRotate, testS)

		DrawText("Cursor keys to rotate/zoom, +/- to change curve resolution", 10, 10)
		
		Return 0
	End Method
End Class

Function Main:Int()
	New SVG_Demo
	Return 0
End Function

'---------
'SVG Class
'---------
Class SVG
	Const SVG_m:Int = 109 ' MoveTo (Relatively Positioned)
	Const SVG_h:Int = 104 ' Horizontal LineTo (Relatively Positioned)
	Const SVG_v:Int = 118 ' Vertical LineTo (Relatively Positioned)
	Const SVG_l:Int = 108 ' LineTo (Relatively Positioned)
	Const SVG_c:Int = 99  ' CurveTo (Relatively Positioned)
	Const SVG_s:Int = 115 ' Smooth CurveTo (Relatively Positioned)
	Const SVG_q:Int = 113 ' Quadratic Bézier Curve (Relatively Positioned)
	Const SVG_t:Int = 116 ' Smooth Quadratic Bézier Curve (Relatively Positioned)
	Const SVG_z:Int = 122 ' Close Path
	Const SVG_M:Int = 77  ' MoveTo (Absolutely Positioned)
	Const SVG_H:Int = 72  ' Horizontal LineTo (Absolutely Positioned)
	Const SVG_V:Int = 86  ' Vertical LineTo (Absolutely Positioned)
	Const SVG_L:Int = 76  ' LineTo (Absolutely Positioned)
	Const SVG_C:Int = 67  ' CurveTo (Absolutely Positioned)
	Const SVG_S:Int = 83  ' Smooth CurveTo (Absolutely Positioned)
	Const SVG_Q:Int = 81  ' Quadratic Bézier Curve (Absolutely Positioned)
	Const SVG_T:Int = 84  ' Smooth Quadratic Bézier Curve (Absolutely Positioned)

	Field file:XMLDoc
	Field x:Float, y:Float, rotation:Float, scale:Float
	Field width:Int, height:Int, w:Int, h:Int
	Field sx1:Float, sy1:Float
	Field poly:Float[1][]
	Field curveSegments:Int=20
	Field groupAttributes:Bool
	
	'Drawing Atrributes
	Field fill:String, fillOpacity:Bool
	Field strokeDraw:Bool, stroke:String, strokeWidth:Float
	Field textAnchor:Float
	Field attX:Float, attY:Float, attW:Float, attH:Float
	
	Method LoadSVG:Void(_file:String)
		Local _Error:XMLError
		file = ParseXML(LoadString(_file), _Error)
		If file = Null
			Error("doh! could not read "+_file)
		Else
			If file.GetAttribute("width") w=Int(file.GetAttribute("width")) ; width=w
			If file.GetAttribute("height") h=Int(file.GetAttribute("height")) ; height=h
		EndIf
	End Method
	
	Method DrawSVG:Void(_x:Float=0, _y:Float=0, _rotation:Float=0, _scale:Float=1)
		x=_x ; y=_y ; rotation=_rotation ; scale=_scale
		width=(w*scale) ; height=(h*scale)
		PushMatrix()
		Rotate(rotation)
		Translate(x,y)
		DrawNodes(file)
		PopMatrix()
	End Method
	
	Method DrawNodes:Void(nodes:XMLNode)	
		For Local node:= EachIn nodes.GetChildren()
			GetAttributes(node)

			Select node.name
				Case "rect"
					If strokeDraw
						SetSVGColor(stroke)
						DrawRect(attX*scale, attY*scale, attW*scale, attH*scale)						
						SetSVGColor(fill)
						DrawRect((attX*scale)+(strokeWidth*scale), (attY*scale)+(strokeWidth*scale), (attW*scale)-((strokeWidth*scale)*2), (attH*scale)-((strokeWidth*scale)*2))						
					Else
						SetSVGColor(fill)
						DrawRect(attX*scale, attY*scale, attW*scale, attH*scale)
					EndIf
					
				Case "circle"
					If strokeDraw
						SetSVGColor(stroke)
						DrawEllipse(Float(node.GetAttribute("cx"))*scale, Float(node.GetAttribute("cy"))*scale, Float(node.GetAttribute("r"))*scale, Float(node.GetAttribute("r"))*scale)
						SetSVGColor(fill)
						DrawEllipse(Float(node.GetAttribute("cx"))*scale, Float(node.GetAttribute("cy"))*scale, (Float(node.GetAttribute("r"))*scale)-(strokeWidth*scale), (Float(node.GetAttribute("r"))*scale)-(strokeWidth*scale))					
					Else
						SetSVGColor(fill)	
						DrawEllipse(Float(node.GetAttribute("cx"))*scale, Float(node.GetAttribute("cy"))*scale, Float(node.GetAttribute("r"))*scale, Float(node.GetAttribute("r"))*scale)
					EndIf

				Case "ellipse"
					If strokeDraw
						SetSVGColor(stroke)
						DrawEllipse(Float(node.GetAttribute("cx"))*scale, Float(node.GetAttribute("cy"))*scale, Float(node.GetAttribute("rx"))*scale, Float(node.GetAttribute("ry"))*scale)
						SetSVGColor(fill)
						DrawEllipse(Float(node.GetAttribute("cx"))*scale, Float(node.GetAttribute("cy"))*scale, (Float(node.GetAttribute("rx"))*scale)-(strokeWidth*scale), (Float(node.GetAttribute("ry"))*scale)-(strokeWidth*scale))					
					Else
						SetSVGColor(fill)			
						DrawEllipse(Float(node.GetAttribute("cx"))*scale, Float(node.GetAttribute("cy"))*scale, Float(node.GetAttribute("rx"))*scale, Float(node.GetAttribute("ry"))*scale)
					EndIf
					
				Case "line"
					SetSVGColor(fill)
					DrawLine(Float(node.GetAttribute("x1"))*scale, Float(node.GetAttribute("y2"))*scale, Float(node.GetAttribute("x2"))*scale, Float(node.GetAttribute("y2"))*scale)
			
				Case "path"
					If fill="none" And strokeDraw=False fill="black"
					ParsePath(node.GetAttribute("d"))

				Case "polygon"
					If fill="none" And strokeDraw=False fill="black"
					DrawPolygon(node.GetAttribute("points"))
					
				Case "polyline"
					DrawPolyline(node.GetAttribute("points"))
					
				Case "text"
					DrawText(node.value, Float(node.GetAttribute("x"))*scale, Float(node.GetAttribute("y"))*scale, textAnchor, 0.8)

				Case "g"
					groupAttributes=True
					DrawNodes(node)
					groupAttributes=False
			End Select
		Next
	End Method
	
	Method GetAttributes:Void(node:XMLNode, group:Bool=False)
		If groupAttributes=False SetColor(0,0,0) ; SetAlpha(1) ; fill="none" ; strokeDraw=False ; strokeWidth=1
		If fillOpacity fillOpacity=False ; SetAlpha(1)
		
		If node.GetAttribute("x") attX=Float(node.GetAttribute("x"))

		If node.GetAttribute("y") attY=Float(node.GetAttribute("y"))

		If node.GetAttribute("width")
			If node.GetAttribute("width").Contains("%")
				attX=0
				attW=(Float(file.GetAttribute("width"))/100.0)*Int(node.GetAttribute("width")[0..node.GetAttribute("width").Length-1])
			Else
				attW=Float(node.GetAttribute("width"))
			EndIf
		EndIf

		If node.GetAttribute("height")
			If node.GetAttribute("height").Contains("%")
				attY=0
				attH=(Float(file.GetAttribute("height"))/100.0)*Int(node.GetAttribute("height")[0..node.GetAttribute("height").Length-1])
			Else
				attH=Float(node.GetAttribute("height"))
			EndIf
		EndIf

		If node.GetAttribute("style")
			Local style:String=node.GetAttribute("style")
			fill=style[style.Find(":")+1..style.Find(";")]
			SetSVGColor(fill)
			If style.Find("stroke") strokeDraw=True ; stroke="#000000"
		EndIf
		
		If node.GetAttribute("text-anchor")
			Select node.GetAttribute("text-anchor")
				Case "start"
					textAnchor=0
				Case "middle"
					textAnchor=0.5
				Case "end"
					textAnchor=1
			End Select
		EndIf

		If node.GetAttribute("fill") fill=node.GetAttribute("fill")

		If node.GetAttribute("fill-opacity") fillOpacity=True ; SetAlpha(Float(node.GetAttribute("fill-opacity")))

		If node.GetAttribute("opacity") SetAlpha(Float(node.GetAttribute("opacity")))

		If node.GetAttribute("stroke")
			strokeDraw=True ; stroke=node.GetAttribute("stroke") ; strokeWidth=1.0
			If node.GetAttribute("stroke-width") strokeWidth=Float(node.GetAttribute("stroke-width"))
		EndIf
	End Method
	
	Method ParsePath:Void(path:String)
		Local command:Int, xy:Float[4], tag:Int
	
		For Local c:Int=0 Until path.Length()
			Select path[c]
				Case SVG_M
					xy=DrawPath(command, xy, path[tag..c])
					command=path[c] ; tag=c+1
					poly=poly.Resize(poly.Length+1) ' Split Paths			
				Case SVG_z
					xy=DrawPath(command, xy, path[tag..c])
					command=path[c] ; tag=0
					poly=poly.Resize(poly.Length+1) ' Split Paths
				Default
					If path[c]&gt;64
						xy=DrawPath(command, xy, path[tag..c])
						command=path[c] ; tag=c+1
					EndIf		
			End Select
		Next
		
		xy=DrawPath(command, xy, path[tag..path.Length])

		DrawTriangulatedPoly(poly)
		poly=New Float[1][]
	End Method
	
	Method DrawPath:Float[](command:Int, xy:Float[], value:String)
		Local px:Float=xy[0], py:Float=xy[1]
		
		Select command
			Case SVG_M
				Local points:Float[]=GetPoints(value)
				px=points[0] ; py=points[1]
				xy[2]=px ; xy[3]=py
				AddToPoly(px, py)

			Case SVG_m
				Local points:Float[]=GetPoints(value)
				px+=points[0] ; py+=points[1]
				AddToPoly(px, py)

			Case SVG_H
				px=Float(value)
				AddToPoly(px, py)
						
			Case SVG_h
				px+=Float(value)
				AddToPoly(px, py)
				
			Case SVG_V
				py=Float(value)	
				AddToPoly(px, py)

			Case SVG_v
				py+=Float(value)
				AddToPoly(px, py)
				
			Case SVG_L
				Local points:Float[]=GetPoints(value)
				px=points[0] ; py=points[1]
				AddToPoly(px, py)		
	
			Case SVG_l
				Local points:Float[]=GetPoints(value)
				px+=points[0] ; py+=points[1]
				AddToPoly(px, py)
				
			Case SVG_C
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayCubic(P2.Create(px, py), P2.Create(points[0], points[1]), P2.Create(points[2], points[3]), P2.Create(points[4], points[5]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)
				Next
				sx1=((2*points[4]) - points[2]) ; sy1=((2*points[5]) - points[3])		
				px=points[4] ; py=points[5]				
	
			Case SVG_c
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayCubic(P2.Create(px, py), P2.Create(px+points[0], py+points[1]), P2.Create(px+points[2], py+points[3]), P2.Create(px+points[4], py+points[5]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)
				Next
				sx1=px+((2*points[4]) - points[2]) ; sy1=py+((2*points[5]) - points[3])		
				px+=points[4] ; py+=points[5]
				
			Case SVG_S
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayCubic(P2.Create(px, py), P2.Create(sx1, sy1), P2.Create(points[0], points[1]), P2.Create(points[2], points[3]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)				
				Next
				sx1=((2*points[2]) - points[0]) ; sy1=((2*points[3]) - points[1])	
				px=points[2] ; py=points[3]			
				
			Case SVG_s
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayCubic(P2.Create(px, py), P2.Create(sx1, sy1), P2.Create(px+points[0], py+points[1]), P2.Create(px+points[2], py+points[3]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)			
				Next
				sx1=px+((2*points[2]) - points[0]) ; sy1=py+((2*points[3]) - points[1])
				px+=points[2] ; py+=points[3]
				
			Case SVG_Q
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayQuadratic(P2.Create(px, py), P2.Create(points[0], points[1]), P2.Create(points[2], points[3]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)			
				Next
				sx1=((2*points[2]) - points[0]) ; sy1=((2*points[3]) - points[1])
				px=points[2] ; py=points[3]
				
			Case SVG_q
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayQuadratic(P2.Create(px, py), P2.Create(px+points[0], py+points[1]), P2.Create(px+points[2], py+points[3]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)
				Next
				sx1=px+((2*points[2]) - points[0]) ; sy1=py+((2*points[3]) - points[1])
				px+=points[2] ; py+=points[3]
				
			Case SVG_T
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayQuadratic(P2.Create(px, py), P2.Create(sx1, sy1), P2.Create(points[0], points[1]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)				
				Next
				px=points[0] ; py=points[1]
				sx1=px; sy1=py
				
			Case SVG_t
				Local points:Float[]=GetPoints(value)
				Local curve:P2[]=BezierArrayQuadratic(P2.Create(px, py), P2.Create(sx1, sy1), P2.Create(px+points[0], py+points[1]), curveSegments)
				For Local l:Int = 0 To curve.Length-1
					AddToPoly(curve[l].X, curve[l].Y)			
				Next
				px+=points[0] ; py+=points[1]
				sx1=px; sy1=py
				
			Case SVG_z
				px=xy[2] ; py=xy[3]
		End Select
		
		Return [px,py,xy[2],xy[3]]
	End Method
	
	Method DrawPolygon:Void(value:String)
		Local points:Float[]=GetPoints(value)
		For Local l:Int=0 To points.Length-2 Step 2
			AddToPoly(points[l], points[l+1])
		Next
		
		DrawTriangulatedPoly(poly, 1)
		poly=New Float[1][]
	End Method
	
	Method DrawPolyline:Void(value:String)
		Local points:Float[]=GetPoints(value)
		For Local l:Int=0 To points.Length-2 Step 2
			AddToPoly(points[l], points[l+1])
		Next
		
		If fill&lt;&gt;"none"
			DrawTriangulatedPoly(poly, 1)
		Else
			Local alpha:Float=GetAlpha()				
			If (strokeWidth*scale)&lt;1 SetAlpha((strokeWidth*scale))
			For Local line:= Eachin poly
				Tessellator.TriangulateAndDrawPolyline(line, (strokeWidth*scale), False)				 
			Next
			If (strokeWidth*scale)&lt;1 SetAlpha(alpha)
		EndIf
		poly=New Float[1][]
	End Method
	
	Method DrawTriangulatedPoly:Void(poly:Float[][], clip:Int=2)
		#IF TARGET="html5"
			'Poly
			If fill&lt;&gt;"none"
				SetSVGColor(fill)
				For Local c:Int=0 to poly.Length-clip
					DrawPoly(poly[c])
				Next
			EndIf

			'Stroke
			If strokeDraw
				SetSVGColor(stroke)
				Local alpha:Float=GetAlpha()				
				If (strokeWidth*scale)&lt;1 SetAlpha((strokeWidth*scale))
				For Local line:= Eachin poly
					Tessellator.TriangulateAndDrawPolyline(line, (strokeWidth*scale), False)				 
				Next
				If (strokeWidth*scale)&lt;1 SetAlpha(alpha)
			EndIf
		#ELSE
			'Poly
			If fill&lt;&gt;"none"
				SetSVGColor(fill)
				Tessellator.TriangulateAndDrawPolygons poly
			EndIf

			'Stroke
			If strokeDraw
				SetSVGColor(stroke)
				Local alpha:Float=GetAlpha()				
				If (strokeWidth*scale)&lt;1 SetAlpha((strokeWidth*scale))
				For Local line:= Eachin poly
					Tessellator.TriangulateAndDrawPolyline(line, (strokeWidth*scale), False)				 
				Next
				If (strokeWidth*scale)&lt;1 SetAlpha(alpha)
			EndIf
		#ENDIF
	End Method
	
	Method AddToPoly:Void(px:Float, py:Float)
		Local polyCount:Int = poly.Length-1
		poly[polyCount]=poly[polyCount].Resize(poly[polyCount].Length+2)
		poly[polyCount][poly[polyCount].Length-2]=(px*scale)
		poly[polyCount][poly[polyCount].Length-1]=(py*scale)
	End Method
	
	Method GetPoints:Float[](value:String)
		Local points:Float[], tag:Int

		For Local c:Int=1 Until value.Length()
			Select value[c]
				Case 44 ',
					points=points.Resize(points.Length+1) ; points[points.Length-1]=Float(value[tag..c]) ; tag=c+1
			
				Case 32 'Space
					If c+1&lt;value.Length And value[c+1]&lt;&gt;45 points=points.Resize(points.Length+1) ; points[points.Length-1]=Float(value[tag..c]) ; tag=c+1
			
				Case 45 '-
					points=points.Resize(points.Length+1) ; points[points.Length-1]=Float(value[tag..c]) ; tag=c
			End Select
		Next

		points=points.Resize(points.Length+1) ; points[points.Length-1]=Float(value[tag..value.Length])
		
		Return points
	End Method
End Class

Class P2
	Field X:Float, Y:Float
	
	Function Create:P2(_X:Float, _Y:Float)
		Local p:P2 = New P2
		p.X	= _X
		p.Y	= _Y

		Return p
	End Function	
End Class


Function BezierArrayQuadratic:P2[](p1:P2,p2:P2,p3:P2,segments:Int)
	Local i:Int
	Local result := New List&lt;P2&gt;()
	Local pbx:Float, pby:Float
	
	For Local i := 0 Until segments
		Local t := Float(i) / segments
		
		Local a := Pow((1.0 - t), 2.0)
		Local b := 2.0 * t * (1.0 - t)
		Local c := Pow(t, 2.0)
		
		Local bx := a * p1.X + b * p2.X + c * p3.X
		Local by := a * p1.Y + b * p2.Y + c * p3.Y
		If PointsAreIdentical(bx, by, pbx, pby)=False result.AddLast(P2.Create(bx,by)) ; pbx=bx ; pby=by
	Next
	
	Return result.ToArray()
End Function

Function BezierArrayCubic:P2[](p1:P2,p2:P2,p3:P2,p4:P2,segments:Int)
	Local i:Int
	Local result := New List&lt;P2&gt;()
	Local pbx:Float, pby:Float	
	
	For Local i := 0 Until segments
	    Local t := Float(i) / segments
	
	    Local a := Pow((1.0 - t), 3.0)
	    Local b := 3.0 * t * Pow((1.0 - t), 2.0)
	    Local c := 3.0 * Pow(t, 2.0) * (1.0 - t)
	    Local d := Pow(t, 3.0)
	
	    Local bx := a * p1.X + b * p2.X + c * p3.X + d * p4.X
	    Local by := a * p1.Y + b * p2.Y + c * p3.Y + d * p4.Y

		If PointsAreIdentical(bx, by, pbx, pby)=False result.AddLast(P2.Create(bx,by)) ; pbx=bx ; pby=by	
	Next
	
	Return result.ToArray()
End Function

Function SetSVGColor:Void(colour:String)
	If colour.Contains("rgb")	'RGB
		Local RGB:String[]=colour[4..colour.Length-1].Split(",")
		SetColor(Int(RGB[0]), Int(RGB[1]), Int(RGB[2]))
	ElseIf colour.Contains("#")	'HEX
		SetColor(HexToDec(colour[1..3]), HexToDec(colour[3..5]), HexToDec(colour[5..7]))
	Else
		Select colour			'Named
			Case "none" SetColor(0,0,0)
			Case "aqua" SetColor(0,255,255)
			Case "black" SetColor(0,0,0)
			Case "fuchsia" SetColor(255,0,255)
			Case "gray" SetColor(128,128,128)
			Case "lime" SetColor(0,255,0)
			Case "maroon" SetColor(128,0,0)
			Case "navy" SetColor(0,0,128)
			Case "olive" SetColor(128,128,0)
			Case "purple" SetColor(128,0,128)
			Case "silver" SetColor(192,192,192)
			Case "teal" SetColor(0,128,128)
			Case "white" SetColor(255,255,255)
			Case "yellow" SetColor(255,255,0)
			Case "red" SetColor(255,0,0)
			Case "green" SetColor(0,128,0)			
			Case "blue" SetColor(0,0,255)
		End Select
	EndIf
End Function

Function HexToDec:Int(Hex:String)
	Local Value:Int = 0
	Local Char:Int =0
	
	If Hex.Length() &lt;8
		'add 0's to beginning of thing so FF becomes 000000FF
		Local TempHex:String = ""
		For Char =Hex.Length() To 7
			TempHex += "0"
		Next
		TempHex += Hex
		Hex = TempHex
	Endif
	
	Local Conversion:Int = 1		'starts at 1 then 16, 256, 4096, 
	'now the characters are 'eight bytes' now begin conversion
	For Char=7 To 0 Step -1
		If Hex[ Char ]&lt;58
			Value += ( ( Hex[ Char ] -48 ) *Conversion )
		Else
			Value += ( ( Hex[ Char ] -55 ) *Conversion )
		Endif			
		Conversion *= 16	'multiply conversion by 16 for next byte
	Next

	Return Value
End Function
</textarea> <br><br></td></tr></table><br>
<a name="2081603"></a>

<a name="2081604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> Theres a small glich with this version: It sends and empty first poly to TriangulateAndDrawPolygons witch causes the function to return without doing anything.<br><br>A quick fix is replacing the array sanity check in TriangulateAndDrawPolygons like this <br><br>replace <br><pre class=code>
If Not newpoints.Length() Return ' no polygons
If Not newpoints[0].Length() Return 'no point in first poly
 </pre><br>with 	<br><pre class=code>	
If Not newpoints.Length() Return ' no polygons
If Not newpoints[0].Length() 
	 'no point in first poly
	If newpoints.Length() =  1 Then Return  			
		'Throw away first poly
		newpoints = newpoints[1..]			
Endif	
</pre><br><br>That said, it's looking good! <br><br></td></tr></table><br>
<a name="2081602"></a>

<a name="2081601"></a>

<a name="2081611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I should have tested first!, I am changing the poly creation so there will be no empty polys soon.  Also just tried the tiger.svg on GFLW and get the Array index error again on the pc?<br><br>		While indexedpoly.ClipEar()<br> 			triangleindexes[i] = indexedpoly.ear[0] <br><br></td></tr></table><br>
<a name="2081625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, I should have tested too! :-)  (well I sort of did, but this error only happens on GLFW Windows, not Mac...)<br><br>It's crashing because I forgot to uncomment If Self.Length() &lt;3 Then Return False in  Method ClipEar:Bool()<br><br>I updated the forum post with this fix, and will be posting a little update later today, where I hopefully found a better fix for inner protrutions in the line thingy. <br><br></td></tr></table><br>
<a name="2081623"></a>

<a name="2081627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fantastic, bar chart fully rendering as expected :) I look forward to seeing the line graph working too. <br><br></td></tr></table><br>
<a name="2081655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated the thick lines with what I think is a good way of catching inner protrusions (when a thick line self intersects itself in a sharp corner)<br><br><a href="http://www.monkey-x.com/Community/posts.php?topic=8035" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8035</a> <br><br></td></tr></table><br>
<a name="2081673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great, GLFW working and the lines look much cleaner, also Raz the line graph SVG uses a multipoint line command which is not yet implement, SVG has so many commands and rules it will take abit of time to get them in. <br><br></td></tr></table><br>
<a name="2081703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> No rush Copper :) <br><br></td></tr></table><br>
<a name="2081709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was a quick addition, repo has been updated. <br><br></td></tr></table><br>
<a name="2081746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh my god, that's amazing thank you :) <br><br></td></tr></table><br>
<a name="2081753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> @CopperCircle - This is all going so well that I'd like to suggest a refactoring of the code! <br><br>I'd like to see the nodes go from SVG into monkey objects.<br>Then these objects generate points and triangles as needed.<br><br>This would allow for a number of enhancements, some of them beeing:<br><br>1) More robust code, easier to maintain.<br>2) Primitives that can be reused not just with SVG but by general monkey code<br>3) Equal point spacing for beziers and other curves<br>4) Robust corner preservation between segments even when changing resolution<br>5) Caching of triangulations, and point generated<br>6) Easy morphing between shapes.<br><br>I have already a little while ago made the beginning of such a system, that I'd be willing to share If you can be persuaded to take the project in that direction.<br><br>My code currently uses "Shapes", a collection of "Shape" made of "Shapesegments".<br><br>Shapesegments are Line, Arc, CubicBezier, etc.<br><br>I realize that this started out as a way to get SVG on the screen for capturing, but that will be totally possible with a refactoring to objects too.<br><br>Tell me your thoughts. :-)<br>If anybody else want's to chip in please do! <br><br></td></tr></table><br>
<a name="2081769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> I actually was waiting for the shapes and path classes to be refactored in a more OO manner or friendly style myself, since I wanted to hack in de casteljau's method to the bezier lines, but it's a bit of a flat mess right now so I couldn't justify the time spent getting up to speed on the code. <br><br>+1 for a refactor,I want to consolidate my work on beziers with this project <br><br></td></tr></table><br>
<a name="2081782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> I definitely agree it needs a big refactor, it was just a proof of concept thrown together over a couple of evenings, but now the triangulation is working well across platforms it would be great to get it up to scratch or port an existing parser.  The problem is I have very little time with work and a family so was hoping others may help with building it, we would then also be able to add SVG fonts which would be great. <br><br></td></tr></table><br>
<a name="2081805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> The way I see it, the following things would be good to separate out:<br><br>1.  Path rendering classes.  The model can be a refresh/invalidate based one, this way a series of points (hereafter referred to as "fast data") can be stored in an array or a stack and reduce object re-instancing on a refresh where points need to be regenerated.  This is more important for objects which need to be broken into discrete pieces manually, like beziers, arcs and the like.  The hierarchy of path segments and compound paths can be interface-based, or based on an abstract base, to allow both types of objects to be rendered either together hierarchically in a list/stack, or individually (like when specifying drawing only a closed path's stroke or fill, and not both).<br><br>2.  Shape / Compound path rendering / fill class.  Probably has the same general interface as the above, but would include important extra components for rendering a compatible fill (abstract/interface), and more importantly, breaking a compound path into convex shapes / triangulating the fill.<br><br>3.  Stroke and mitering classes.  These are supposed to mitigate the "tight loop" problem, and are an accepted and standardized part of path rendering these days.  Implementing recursive bezier rendering at a given resolution using one of the methods I mentioned very early on in the thread is pretty much a prerequisite to this, though, since a static/linear number of rendering points at "even" positions along a bezier is still an issue that no amount of mitering will make look correct at tight loops.<br><br>4.  Parser classes.  An internal object should contain all the metadata needed to render a graphic in the refactored module, agnostic to the serial format, since the format we use internally to display it "fast" is quite different from the underlying serialized format (svg) anyway.  The individual rendering shape/path classes should have a "universal access" pre-generated output in the fast format, whereas it should be able to be fed parameters to generate this fast data in much easier ways.  The purpose of the parser is to translate the language of the serialized format into parameters that the individual shape/path classes can turn into display data.  How much processing the shape classes should do, and where, is a matter of debate.  I'd advocate strongly against tying directly to the constructor, though a ctor can call the actual data-generating mutator with similar parameters.  This is again to reduce the need to create new objects when point data needs to be refreshed.  <br><br><br>Separating this out opens a lot more possibilities for the module than simply displaying vector graphics. Users could choose to create their own simple metadata format, for example, combining JSON with raw beziers to produce paths for game objects to travel.  They could create collision data using the shape's point rasterization functions to automatically break up SVG paths into lines for box2d at low detail levels.  They could use stroke and mitering to generate masks to prevent their objects from getting stuck on sharp points, or in tight squeezes.  They could use it to generate a normal for a bezier curve.  Etc.<br><br>I guess this is pretty much exactly what Difference was saying, only more long-winded, and not elaborating on morph targets or animation at all (since that's a really tough problem, and can probably be extended later).  I'd be interested if we'd be able to tie together spine metadata with SVG and extra joint metadata, though I believe SVG has animation support built in, too.  The latter is just seemingly a very complicated way to describe simple animation scripting, which we are probably gonna do in Monkey ourselves, anyway, since there aren't any good programs to generate SVG animations afaik. <br><br></td></tr></table><br>
<a name="2082236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I am hoping to start refactoring this over the weekend, I will do it in bits as and when I have time. Thanks. <br><br></td></tr></table><br>
<a name="2082550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have made a start on refactoring and improving the parser, the repo has been updated.<br><br>"Refactored code into objects, added all SVG named colours, added W3.org basic SVG examples, added basic Transform Support, modified Tesselate to use scaling, changed basic shapes to use polys." <br><br></td></tr></table><br>
<a name="2082562"></a>

<a name="2082563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking good, man, keep up the good work!  I'm glad to see BezierArrayCubic and similar functions split off.  That should make it substantially easier to modify them with settings for rasterization.  I recommend splitting off the <i>segments</i> arguments to separate "config" variables in the svgFunctions namespace, so that the method signature doesn't have to change when someone does start adding more advanced rasterizations to the bezier functions.  <br><br>Edit:  Segments are still specified in the svgPath class and really the home for it should probably go where all the other rasterization methods would eventually go.  You could theoretically put the functions in a static class and have the settings as fields, but that would just make calling those functions take even more horizontal space, lol.  Though that would keep some Const litter out of the root namespace...  (Alternatively, an svgSettings class could also work) <br><br></td></tr></table><br>
<a name="2082559"></a>

<a name="2082560"></a>

<a name="2082561"></a>

<a name="2083162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking good.<br><br>I have now written my own SVG parser that sends the svg parts to objects , that can then be converted to points and triangulated, because that fit my needs better.<br><br>Can I ask that you keep scaling out of the tessellate code, and more importantly out of DrawTriangles, because I have just finished a generic version that will work on HTML5, GLFW and IOS, and if we're going to have any chance of getting it into mojo, I think it needs to be really basic.<br><br> I'll be posting a new version of tesselate + DrawTriangles for html5, glfw (almost idential to ios) later this week.<br><br>I'd like to put in functions for use with your parser, something like: GetIndexedTriangles() ?<br>I can put in scale and offfset parameters if you would like?<br><br><pre class=code>
Class IndexedTriangles
	Field points:Float[]
	Field indexes:Int[]
End class
</pre><br>[EDIT] removed old code <br><br></td></tr></table><br>
<a name="2082585"></a>

<a name="2082586"></a>

<a name="2082587"></a>

<a name="2082588"></a>

<a name="2082589"></a>

<a name="2082590"></a>

<a name="2082591"></a>

<a name="2082592"></a>

<a name="2082596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds good, scale and offset would be handy thanks.  Look forward to your update. <br><br></td></tr></table><br>
<a name="2083316"></a>

<a name="2083317"></a>

<a name="2083318"></a>

<a name="2083319"></a>

<a name="2083320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've posted a new version of tessellate.monkey here : <a href="http://www.monkey-x.com/Community/posts.php?topic=8035" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8035</a><br><br>Also I posted the DrawTriangles function with native functions for HTML5 and GLFW here: <a href="http://www.monkey-x.com/Community/posts.php?topic=8246" target="_blank">http://www.monkey-x.com/Community/posts.php?topic=8246</a><br><br>I went back to the "index points to x coordinate" offset.<br><br>I made a public section and made most of the code private, so it should be easy to only use the tesselater to get back an instance of IndexedTriangles, and store a reference to that in the calling Class.<br><br>I added two simple functions for offset and scaling.<br><br>Also tessellate now expects nice clean input, but the CleanUpPolygon is included if needed, but you must call it yourself. <br><br></td></tr></table><br>
<a name="2083160"></a>

<a name="2083158"></a>

<a name="2083159"></a>

<a name="2083313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CopperCircle</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the update, sounds great, I will integrate the new version soon when I get some time to work on this. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
