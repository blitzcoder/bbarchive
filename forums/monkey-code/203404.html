<!DOCTYPE html><html lang="en" ><head ><title >Vector Projection with visual example + comments</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Vector Projection with visual example + comments</h1><a href="forums.php" >Monkey Forums</a>/<a href="topics.php?forum=512" >Monkey Code</a>/<a href="#bottom" >Vector Projection with visual example + comments</a><br><br>
<a name="2035639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> As the title says a quick test I wrote to visually check that the projection was working correctly. Currently trying implement SAT Separating Axis Theorem which I will eventually post here when I have finished it. Please excuse my vector class just quickly knocked it up for this test.<br><br>[monkeycode]<br>Import mojo<br><br><br>'/ Quick and dirty Vec2 Class<br>Class Vec2<br><br>	Field x : Float<br>	Field y : Float<br><br>	Method New( x : Float, y : Float )<br>		Self.x = x<br>		Self.y = y<br>	End Method<br>	<br>	Method add : Vec2( other : Vec2 )<br>		Return New Vec2( Self.x + other.x, Self.y + other.y )<br>	End Method<br>	<br>	Method add : Vec2( scalar : Float )<br>		Return New Vec2( Self.x + scalar, Self.y + scalar )<br>	End Method<br>	<br>	Method subtract : Vec2( other : Vec2 )<br>		Return New Vec2( Self.x - other.x, Self.y - other.y )<br>	End Method<br><br>	Method subtract : Vec2( scalar : Float )<br>		Return New Vec2( Self.x - scalar, Self.y - scalar )<br>	End Method<br>	<br>	Method divide : Vec2( other : Vec2 )<br>		Return New Vec2( Self.x / other.x, Self.y / other.y )<br>	End Method<br>	<br>	Method divide : Vec2( scalar : Float )<br>		Return New Vec2( Self.x / scalar, Self.y / scalar )<br>	End Method<br>	<br>	Method multiply : Vec2( other : Vec2 )<br>		Return New Vec2( Self.x * other.x, Self.y * other.y )<br>	End Method<br>	<br>	Method multiply : Vec2( scalar : Float )<br>		Return New Vec2( Self.x * scalar, Self.y * scalar )<br>	End Method<br>	<br>	Method dot : Float( other : Vec2 )<br>		Return ( Self.x * other.x ) + ( Self.y * other.y )<br>	End Method<br>	<br>	Method squaredLength : Float()<br>		Return ( Self.x * Self.x ) + ( Self.y * Self.y )<br>	End Method<br><br>	Method length : Float()<br>		Return Sqrt(( Self.x * Self.x ) + ( Self.y * Self.y ))<br>	End Method<br><br>	Method perpendicular : Vec2()<br>		Return New Vec2( -Self.y, Self.x )<br>	End Method<br><br>	Method unitVector : Vec2()<br>		Local l : Float = Abs( Self.length())<br>		Return New Vec2( x / l, y / l )<br>	End Method<br>	<br>End Class<br>	<br>	<br><br>'/ Simple Touch in Square Rect<br>Function TouchVec2 : Bool( p : Vec2, radius : Float = 25 )<br>	If TouchX() &lt; p.x - radius Or TouchX() &gt; p.x + radius Then Return False<br>	If TouchY() &lt; p.y - radius Or TouchY() &gt; p.y + radius Then Return False	<br>	Return True<br>End Function<br><br><br><br><br>Class MyApp Extends App<br><br>	'/ stores projection result<br>	Field projected : Vec2<br><br>	'/ point to project<br>	Field p0 : Vec2<br><br>	'/ axis to project onto<br>	Field axis : Vec2<br>	<br>	'/ two visual points to represent the axis to project onto<br>	'/ normaly you wouldnt need these points as you would obtain the axis by other means.<br>	Field p1 : Vec2<br>	Field p2 : Vec2<br><br><br>	'/ used to store which point is being dragged around<br>	Field selected : Vec2<br>	<br><br>	Method OnCreate()<br><br>		SetUpdateRate( 60 )<br><br>		<br>		'/ point projection vector<br>		p0 = New Vec2( 100, 100 )<br>		<br>		<br>		'/ line passing through points<br>		p1 = New Vec2( 50, 350 )<br>		p2 = New Vec2( 250, 270 )<br><br><br>		'/** fix for flash **<br>		axis = New Vec2( 0, 0 )<br>		projected = New Vec2( 0, 0 )<br><br>	End Method<br>	<br><br><br>	Method OnUpdate()<br>	<br>		'/ simple touch move interaction with the points<br>		'/ when touch Hit find any rectangle point that the mouse is inside and store it<br>		If TouchHit()<br>			If selected = Null<br>				If TouchVec2( p0, 8 ) Then selected = p0<br>				If TouchVec2( p1, 8 ) Then selected = p1<br>				If TouchVec2( p2, 8 ) Then selected = p2<br>			Endif		<br>		Endif<br>		'/ if still touching and probably moving around and we have found a selected point, move this point to touch location<br>		'/ if not still touching clear selected to check next loop for a new selection<br>		If TouchDown()<br>			If selected<br>				selected.x = TouchX()<br>				selected.y = TouchY()<br>			Endif<br>		Else<br>			selected = Null<br>		Endif<br>		<br>		<br>		'/** Projecting Vector A onto Vector B<br>		'/  -----------------------------------<br>		'/ The formula for projecting vector ( a ) onto vector ( b ) is:<br>		<br>		'  proj.x = ( a.dot( b ) / squaredLength( b )) * b.x<br>		'  proj.y = ( a.dot( b ) / squaredLength( b )) * b.y<br>		<br>		'  we can simplify this further by making ( b ) a unit vector ( b.x * b.x + b.y * b.y ) = 1<br>		'  which becomes:<br>		<br>		' proj.x = a.dot( b ) * b.x<br>		' proj.y = a.dot( b ) * b.y<br>		<br>		<br>		'/ compute Vector B - the unit vector representing the axis.<br>		'  In our case imagine the line that passes through the 2 points represent a horizontal x axis<br>		axis = p2.subtract( p1 ).unitVector()<br>		<br>		'/ computes Vector A - the vector to project p1 -&gt; p0<br>		projected = p0.subtract( p1 )<br>		<br>		'/ computes dot product of this vector and the line, relative orientation.<br>		Local dp : Float = projected.dot( axis )<br>		<br>		'/ multiplies the dot product with the axis<br>		projected = axis.multiply( dp )<br>		<br>		<br>	End Method<br>	<br><br><br>	Method OnRender()<br>		Cls 255, 255, 255<br><br>		'/ Draws Vector from p1 -&gt; p0<br>		SetColor 0, 0, 175<br>		SetAlpha 0.35<br>		DrawLine p0.x, p0.y, p1.x, p1.y<br>		Local testVector : Vec2 = p0.subtract( p1 )<br>		Local tArrow : Vec2 = testVector.subtract( testVector.perpendicular() )<br>		tArrow = tArrow.unitVector()<br>		DrawLine p0.x, p0.y, p0.x - tArrow.x * 10, p0.y - tArrow.y * 10<br>		DrawLine p0.x, p0.y, p0.x - ( -tArrow.y * 10 ), p0.y - tArrow.x * 10<br>		SetAlpha 1.0<br>		DrawRect p0.x - 4, p0.y - 4, 8, 8<br>		<br>		'/ Draws vector thats passes through points p1 and p2<br>		SetColor 175, 0, 0<br>		SetAlpha 0.35<br>		DrawLine p1.x - axis.x * 640, p1.y - axis.y * 640, p2.x + axis.x * 640, p2.y + axis.y * 640<br>		SetAlpha 1.0<br>		<br>		'/ Draws projected vector<br>		SetColor 0, 175, 0<br>		DrawLine p1.x, p1.y, p1.x + projected.x, p1.y + projected.y<br>		Local pArrow : Vec2 = projected.subtract( projected.perpendicular() )<br>		pArrow = pArrow.unitVector()<br>		DrawLine p1.x + projected.x, p1.y + projected.y, p1.x + projected.x - pArrow.x * 10, p1.y + projected.y - pArrow.y * 10<br>		DrawLine p1.x + projected.x, p1.y + projected.y, p1.x + projected.x - ( -pArrow.y * 10 ), p1.y + projected.y - pArrow.x * 10<br>		<br>		SetColor 175, 175, 175<br>		SetAlpha( 0.35 )<br>		DrawLine p1.x + projected.x, p1.y + projected.y, p0.x, p0.y<br>		SetAlpha( 1.0 )<br>		<br>		'/ Draws points that pass through the line vector<br>		SetColor 175, 0, 0<br>		DrawRect p1.x - 4, p1.y - 4, 8, 8<br>		DrawRect p2.x - 4, p2.y - 4, 8, 8<br><br>	End Method<br>	<br><br>End Class<br><br><br>Function Main()<br>	New MyApp()<br>End Function<br>[/monkeycode]<br><br>please let me know if there are any mistakes and I will correct them <br><br></td></tr></table><br>
<a name="2035627"></a>

<a name="2035595"></a>

<a name="2035594"></a>

<a name="2035586"></a>

<a name="2035585"></a>

<a name="2035583"></a>

<a name="2035582"></a>

<a name="2035589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is good. I really think a lot more programmers need to understand this. Projection is really useful for many things game related. When I was doing the research for the pool game I realized I needed to know all of this.  Projection, dot product and pythagoreans theorem is what allowed me to create the pool game.  as well as 3d in 2d but this was just visuals.<br><br>I did several similar test as yours above while I was learning the subject and really help me to understand it.  <br><br>one of the things I realized is that I had to recycle vectors as this has a potential of creating excessive amount of objects when implemented in a game. <br><br></td></tr></table><br>
<a name="2035593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> one of the things I realized is that I had to recycle vectors as this has a potential of creating excessive amount of objects when implemented in a game. <br></div><br>yeah I noticed that when I was knocking up the quick Vec2 class I used in the example above. How did you implement yours?  Is there any advantage to using float arrays over a Vec class? <br><br></td></tr></table><br>
<a name="2035592"></a>

<a name="2035608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't use arrays. I added a couple of fields for temporary vectors in certain classes that I would pass to different functions and classes.  I was going to release it as a library for everybody but I realized that it was too personalized and others would have a hard time understanding it so I didn't. yours looks quite elegant compared to mine. <br><br></td></tr></table><br>
<a name="2035624"></a>

<a name="2035625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok thats cleared that up, I wasn't sure if I should use arrays. Mine turned out to be pretty simple to use and I like how you can stack operations but like you said it will lead to excessive amounts of objects.<br><br>I guess a fairly simple solution would be to create more methods, instead of returning a new vector it alters the calling vector; leaving it up to the user to manage when vector objects are created or not created. Do you think that would work? Im worried it could be confusing when reading code, if the method names weren't obvious it could be hard to differentiate and be unsure if it returned a new vector or not! I can't think of a suitable name extension that would sound obvious for add, subtract, divide etc etc <br><br></td></tr></table><br>
<a name="2035622"></a>

<a name="2035619"></a>

<a name="2035626"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >muddy_shoes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> My experience is that creating functions with an output vector is the most straightforward way to allow the user to avoid generating lots of short-lived objects. I tried pooling and found that the cost of managing the pool was often much higher than the GC it was avoiding. I've moved bits of the box2D module over to output parameters but only the most GC unfriendly stuff. The vector stuff is in common/math: <a href="http://code.google.com/p/monkeybox2d/source/browse/#hg%2Fcommon%2Fmath" target="_blank">http://code.google.com/p/monkeybox2d/source/browse/#hg%2Fcommon%2Fmath</a><br><br>The downside is that the user needs to keep track of their re-used vector instances and can end up running into trouble if methods share them. <br><br></td></tr></table><br>
<a name="2035628"></a>

<a name="2035629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks muddy I really should have thought to check there, doh!<br><br><div class="quote">  and can end up running into trouble if methods share them. <br></div><br>Yea that has happened to me in the past, I made a mistake (more than once :P) and didn't notice it for ages! <br><br></td></tr></table><br>
<a name="2035636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @NoOdle<br>just a heads up. I just tried your code in flash and it crashes. <br><br>using monkey v59. <br><br></td></tr></table><br>
<a name="2035640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >NoOdle</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks Jesse, pretty quick fix, I've updated the code. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
