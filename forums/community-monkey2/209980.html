<!DOCTYPE html><html lang="en" ><head ><title >Feature Request: Have Rnd() use a different PRNG</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Feature Request: Have Rnd() use a different PRNG</h1><a href="forums.php" >Community Forums</a>/<a href="topics.php?forum=530" >Monkey2 Talk</a>/<a href="#bottom" >Feature Request: Have Rnd() use a different PRNG</a><br><br>
<a name="2108438"></a>

<a name="2108439"></a>

<a name="2108440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nobuyuki</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> exactly as it says in the topic, I'd like to see monkey2 use Mersenne Twisters instead of its existing randomizer for the default Rnd() on all targets.  Reasons:<br><br>1.  Now that the focus is on c-based targets, it shouldn't be that difficult to ensure that the seed will remain constant across platforms.  Pick the latest native implementation and stick with it.  Use a "monkey" way to generate floats from the result if absolutely necessary to ensure that the seed doesn't "drift" between implementations if float handling deviates from the IEEE standard, but some implementations can already create doubles from 53-bit ints.<br><br>2. Mersenne Twister ensures a more even frequency distribution of resulting random numbers for a given seed over many iterations.  Monkey's native randomizer isn't <i>terrible</i>, but certain numbers do tend to show up more than others more often and this can mess up games and apps that depend a lot on more reliable randomness.   The uniformity of the resulting number distribution ensures more enjoyment from game players where randomness determines large amounts of the game's events -- certain kinds of events are less likely to happen in clusters compared to others due to the RNG.  <br><br>3.  mt19937's period before repeating numbers is extremely long, ensuring a lot of different numbers before repeats.  In fact it's one of the primary advantages to using it -- it's  2^19937 âˆ’ 1.  I don't know what Monkey's PRNG has for a period, but, this again can affect games and apps where the user feels like they are seeing a "suspiciously similar" course of events happen more often.  In particular, games and apps which set the seed based on a certain time of day, where the user (or scheduled routine) is expected to activate the seed at similar times of the day, can cause lots more of these things to happen given a short repeating period.<br><br>4.  The code for mt19937 is well-examined and well-established.  Problems with its randomness or target implementations can be researched a lot easier than rolling your own.  MT's limitations are also well-known, and subsequent revisions to the core algorithm have produced more efficient and better-initialized routines.<br><br><br>Limitations:<br>It's not as fast as some other generators which have come out since.<br>It's not cryptographically secure.<br>Some other generators have more uniform distributions (I can't confirm this personally)<br><br>Please consider this, or at least adding a better prng to the brl/std if Rng() must maintain backwards compatibility.  Here are a couple other generators which may be of interest:<br><br><a href="https://en.wikipedia.org/wiki/Xorshift" target="_blank">https://en.wikipedia.org/wiki/Xorshift</a>  <br><a href="https://en.wikipedia.org/wiki/Multiply-with-carry" target="_blank">https://en.wikipedia.org/wiki/Multiply-with-carry</a><br><a href="https://en.wikipedia.org/wiki/Well_equidistributed_long-period_linear" target="_blank">https://en.wikipedia.org/wiki/Well_equidistributed_long-period_linear</a><br><br>Edit:  I guess also for the purposes of maintaining concurrent generators, it might be useful to also have generator objects, but I suppose that's not a core language thing as much as a standard library thing.  Sometimes in a game, you want one generator to only be rotated at very specific times, but still want to generate randomness for separate processes without affecting the other generator (say for example to preserve a seed's ability to generate the same levels regardless of how user input affected subsequent calls to the generator)... etc <br><br></td></tr></table><br>
<a name="2108443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Samah</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Nobuyuki: Sometimes in a game, you want one generator to only be rotated at very specific times, but still want to generate randomness for separate processes without affecting the other generator (say for example to preserve a seed's ability to generate the same levels regardless of how user input affected subsequent calls to the generator) <br></div><br>This is why I created the RandomSource class in Diddy.<br><a href="https://github.com/swoolcock/diddy/blob/master/src/diddy/math.monkey" target="_blank">https://github.com/swoolcock/diddy/blob/master/src/diddy/math.monkey</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
