<!DOCTYPE html><html lang="en" ><head ><title >How to do really fast EntityVisible commands</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to do really fast EntityVisible commands</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How to do really fast EntityVisible commands</a><br><br>
<a name="248908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried randomly placing 30 lens flares in the stratus map, which each do one visibility check per loop.  I got 2FPS.  Then I tried checking just the level, without the static meshes, and it was very fast.<br><br>I wrote a fastentityvisible() function that first checks just the level.  If the entities are occluded, you know you can return false.<br><br>Then it goes through each static mesh and checks visibility with the mesh's box.  If the box of the mesh occludes the entities, then it checks against the mesh's actual polygons.<br><br>This allowed me to run 30 flares at the maximum framerate, in a pretty high-poly map.<br><br><br>This will included in the public code I release. <br><br></td></tr></table><br>
<a name="248909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I made the updateflares() function run only before a render, I got 40 fps with 100 flares. <br><br></td></tr></table><br>
<a name="248910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> And 100-300 fps with 20 flares. <br><br></td></tr></table><br>
<a name="248941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> So what you are basically saying is that Mark's function to dtermine is an entity is visible or not does not first check against the object's bounding box before attempting to check against the polygons themselves.<br><br>And that you should check against the level first, because the level will almost always occlude most flares, whereas individual small decorative entities in a level will only very rarely occlude any flares. <br><br></td></tr></table><br>
<a name="249030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1.  Yes<br><br>2.  Yes, and also consider that large decorative meshes might sometimes occlude things often, but if a simpler object also occludes it, it is faster to check the simpler object and not have to check the complex one.<br><br><br>I was a little surprised that the occlusion doesn't check the bounding box first.  This makes a huge speed difference. <br><br></td></tr></table><br>
<a name="249119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrtricks</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would this make any difference to checking if a pivot is visible? <br><br></td></tr></table><br>
<a name="249154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes.<br><br>When you check to see if an entity is visible, it really only looks to see if it's center is visible, or it's bounding sphere, I forget which.  It does not look for the actual polygons.<br><br>But this is checked against the actual polygons of all objects in the world marked as occluders.  <br><br>So only the polygons in the occluders matter. <br><br></td></tr></table><br>
<a name="726176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @leadwerks: sorry for digging out this old thread - but i am in need of a fast entityvisible() command. i have lots of flares in my game, and they are crunching up my framerate. do you have a useful source? <br><br></td></tr></table><br>
<a name="726329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> t3kMac<br><br>I'm going to have look at entity visibility as well - my tank game has a lot of vis checking going on and B3d's standard linepicking is a real bottleneck.<br><br>I'm holding out for the Nuclear Glory collision lib, but in the meantime, I wonder if using Coldet for vis checking might be quicker? <br><br></td></tr></table><br>
<a name="726514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @MadJack:<br><br>LOL!  Great sig!  Adapted from Starship Troopers, right? <br><br></td></tr></table><br>
<a name="726535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I saw an example in the archives last week that freed entities instead of hiding them. The idea was that a lot of entities causes slowdown. However, I couldn't find it anymore. But still it might be a good idea to check the archives. The flares, that are sprites, right ? Otherwise you could try collapsing the flares into a single mesh. <br><br></td></tr></table><br>
<a name="726538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> my flares are sprites (they are added runtime) - its the visibility check which is sooo slow. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
