<!DOCTYPE html><html lang="en" ><head ><title >MIDI input from a keyboard?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >MIDI input from a keyboard?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >MIDI input from a keyboard?</a><br><br>
<a name="520878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone know if it's it possible to capture keyboard midi data into Blitz3d from a soundcard MIDI input port? <br><br>I suspect this is a job for a userlib DLL? Is there one out there? <br><br></td></tr></table><br>
<a name="520898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> *grumbles about HAL and a real Peek/Poke command*<br><br>Poke &amp;H330,&lt;forgot&gt;<br>e=Peek &amp;h331<br><br>*grumbles more about real Peek/Poke command*<br><br>Microsoft killed off an fm synth/sequencer of mine by shoving the HAL into 2000/xp... the buggers.... now i cant access crap :/ <br><br></td></tr></table><br>
<a name="521013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a midi system in the Tools section. <br><br></td></tr></table><br>
<a name="521035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Crikey! Never noticed that. Thanks very much John :) <br><br></td></tr></table><br>
<a name="521041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> And it seems to work very nicely! Thanks Ziltch :) <br><br></td></tr></table><br>
<a name="521683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Before I get over excited and start planning something that is not possible : could I make a midi controller with this? I mean, a program that sends out specific midi messages when certain buttons are pressed, or the mouse wheel is moved, or the joystick?<br>It seems to be the case, but I'm not very familiar with midi (I use it, but I don't know how the actual midi messages work). <br><br></td></tr></table><br>
<a name="521797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ooh, be very careful before you jump in.<br><br>Years ago I wrote a midi-sequencer and it took me some months to get my head around the structure of each type of midi message, before I could even begin programming.<br><br>To complicate matters further, Microsoft then arrived and began to throw their weight around (before, it had just been up to the International Midi Consortium to create and maintain a cross-platform standard), and now I gather that things have changed dramatically with e.g. a channel potential that takes you way past the original 16 standard channels.<br><br>Search the web, download docs, and become very familiar with what you're up against before you start.<br><br>The trouble is, in effect you are in the same position as someone who can code, but wants to hand-code a browser or ftp program. You need all the docs, background and specs before you begin.<br><br>As a final note can I just add that the hub of any midi program is the concept of 'internal clocks' (one for each track) driven by a master sync-clock. <br>Understanding Midi only gets you so far; you will still have to create a helluva realtime framework for it all to hang off.<br><br>The best of luck to you. <br><br></td></tr></table><br>
<a name="521832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to play a 22khz sample at the correct rate for the key pressed... any ideas how to go about this? <br><br>It seems to be a logarithmic effect(or exponential? my mathematics is shocking - apologies).<br><br>The higher/lower the pitch the further 'out' the sound is. ie. it's not just a case of:<br><br>ChannelPitch(chan1, 22000 + midi_pitch) <br><br></td></tr></table><br>
<a name="521860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Caff, sorry if this is news to you:<br><br>1) M.I.D.I. (musical instrument digital interface)<br>and<br>2) 'sample-playing'<br>are two completely different systems.<br><br>If you want to play samples then follow through the Channel commands.<br><br>Trust me, to a programmer midi is more akin to printer control codes than it is to sample pitch or frequency, so don't get sidetracked. <br><br></td></tr></table><br>
<a name="521870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Let me just expand on that:<br><br>With the statement "ChannelPitch(chan1, 22000 + midi_pitch)"<br>-you have mixed up two completely (incompatible) systems.<br><br>1) M.I.D.I. (Musical Instrument Digital Interface)<br>and<br>2) 'Sample-Playing'<br>are two completely different systems.<br><br>To a programmer M.I.D.I. transmissions are closer to printer control codes than to samples.<br>For example Middle C in midi is the value 60, C# is 61, D is 62 etc.<br>Whereas Middle C in sample terms is 384hz (-possibly not, my memory's sketchy, but you get the idea).<br>At this point think of midi as a similar system to teletext, or morse code - merely a way to get one hardware device to send messages to another; not actually a direct way of creating pitched sound.<br><br>The value 22000 that you show is not the 'pitch' of a sample (since a sample can contain many pitches) merely the value of accuracy with which the sample was recorded; similar to the concept of '16 bit color','32 bit color'.<br><br>If you want to play samples (albeit at different pitches) then follow the Channel commands and search the forums. <br><br></td></tr></table><br>
<a name="521925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um, yep I am a grade 8 pianist! So I know what the values of midi 'pitch' represent (ie. 60 = middle C).<br><br>I am attempting to use midi input to play samples at the correct pitch. It's a really rough attempt, and I'm only really doing it for fun. If I increment the sample rate by the difference in midi 'pitch' (ie. 62 = D = 2 above middle C) it's accurate, but the further away I get from middle C, the further out the pitch goes.<br><br>I was wondering if anyone had experimented with sample pitch according to midi pitch before. There must be an accurate way of reproducing a sample at the correct pitch based on input - ok, so it might sound awful due to the pitch-shifting of the sample used, but if I use several samples spread across each region of the keyboard (ala soundfonts) I might be able to get a decent sound.<br><br>I'm a wee bit drunk to play with it again tonight, but maybe tomorrow I'll have another go. I'm sure it's a matter of exponentially increasing the sample pitch. <br><br></td></tr></table><br>
<a name="521992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm going to guess that you have a sample of middle C (midi value 60) recorded at 22000hz.<br><br>C one octave up should be double the pitch (22000 x 2).<br><br>Therefore C# (one note above middle C) should be 22000 + (22000/12).<br>Therefore:<br>D = 22000 + 2x(22000/12)<br>E = 22000 + 3x(22000/12)<br>F = 22000 + 4x(22000/12)<br>etc<br><br>Any use? Worth trying anyway. <br><br></td></tr></table><br>
<a name="522056"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ John Blackledge : Thanks, and I know the complexity of MIDI. However, I'm not going to write a sequencer. Basically what I want to do is create a simple scripting system where you can set up conditions : if I move my joystick right, I want to send midi message x to channel y with the value of the joystick (multiplied by 127 and rounded, so it's in the 0-127 range that midi uses instead of the 0-1 range that the blitz joystick commands return, for instance). Maybe later I'd add a midi learn function or something.<br>So basically deciding what messages to send is up to the user.<br>It will not need to be synchronized to midi either (no time code stuff), it's just a controller, that allows you to send midi messages based on key presses, the mouse wheel and buttons, and the joystick.<br><br>What I'd use it for is controlling a program like ableton live, trough Midi Yoke (great midi interface drivers). I don't have the money to buy a midi controller, but I have a ps2-style controller that would do the job perfectly. There are programs that already do this, but none of the free ones seem to have the flexibility I want. <br><br></td></tr></table><br>
<a name="522114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, I must have been tired.<br>I didn't realise that we were having two separate conversations here.<br><br>@Caff. The question above still stands. You should be able to to get the keyscan code, then tweak your base sample to produce the appropriate pitch.<br><br>@fall_x. Sounds like what you are doing is very much for fun, coz otherwise I think you can buy a small midi-keyboard from as little as £40.<br>As you are aware the midi note range is from 0 to 127, with middle C at 60.<br><br>So a typical 'note-on' message for middle C is:<br>144 + channel (0 to 15), 60, 127 (velocity value).<br>And a typical 'note-off' message for middle C is:<br>128 + channel (0 to 15), 60, 127 (velocity value).<br>(Sorry if I'm 'teaching my grandmother to suck eggs' here.)<br><br>So your only real problem is converting your input device range to a range of 0 to 127. OK? <br><br></td></tr></table><br>
<a name="522133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @John - ok thanks I'll give it a go! Thinking back, I'll need to check my sample again... <br><br></td></tr></table><br>
<a name="522148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wasnt aware that library allows me to directly access midi input.. I'll have to take a peek.. alot of fun to be had here!!!!<br><br>John, lot of useful info there.  We may already know it but i dont doubt other users will find it great to use.<br><br>By the way, i'm used to using hex. If you check the internet, the majority of MIDI file tech details seem to be in hex also.<br><br>I'm yabbering on, so i'll assume you know what and bugger off :) <br><br></td></tr></table><br>
<a name="522157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> "@fall_x. Sounds like what you are doing is very much for fun, coz otherwise I think you can buy a small midi-keyboard from as little as £40."<br>Yes it is, and it's not specifically for controlling notes (but it could be used for that as well), but more for midi control messages, that could be assigned to cut off of a synth for instance. That way I could do filter sweeps with my analog sticks, change the volume (or whatever) with  my mouse wheel, etc.<br>My (very very very basic) scripting language which I'll use for this is almost finished meanwhile, so I'll have a basic version of this up and running in a few days :)<br><br>BTW, sorry for hijacking this topic a bit, but since this topic was midi related I posted here. <br><br></td></tr></table><br>
<a name="522207"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Cygnus: With apologies, I hate hex with a vengeance.<br>It might have been necessary once to get big numbers into a few bytes, but would you rather see FF, or 255?<br><br>"John, lot of useful info there. We may already know it but i dont doubt other users will find it great to use."<br><br>Go for it. Midi is great fun. I still remember the first time I sent a 'note-on' followed by a 'note-off' and my synth (on the other end of the wire) chimed a note!<br>Ah, the heady days of 8-bit.<br><br>Similarly, I guess we've all had a kick from seeing our first revolving cube in 3D.<br>Are we sad, or what? (...Nah.) <br><br></td></tr></table><br>
<a name="522222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> MIDI rocks... :) I used to hook up my Atari ST 1024 to my dad's Yamaha Clavinova!<br><br>Only slight problem with this DLL (not the fault of the DLL though) is that it won't take advantage of ASIO drivers, so the latency's a bit high (I'm guessing about 50ms with my E-MU 0404). <br><br></td></tr></table><br>
<a name="522226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did a beat 'em up with motion detectors, that were hooked up to the computer with midi, for a university project some years ago. It could register punch speed and location with reasonable accuracy. Quite fun :) <br><br></td></tr></table><br>
<a name="522228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> MIDI is to music what word-processing is to literature - the essential composing tool.<br><br>I remember the first time I heard a 'sample-player':<br>My friend said 'I've composed this.'<br>I said 'No, you've dragged some coloured blocks around the screen; and they weren't even yours'.<br>I couldn't help but laugh in his face.<br><br>Modern 'music', eh?<br><br>We better end this thread now before it just becomes a set of remeniscences. <br><br></td></tr></table><br>
<a name="522410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone tried the midi out functions?<br><br>It seems to me that whenever I press a button in my program (which immediately sends a midi note on message, program is running at full speed, just a loop), my midi sequencer plays the note too late, about 1/4 of a second or something.<br><br>Could someone verify please? Could be a problem with the sequencer or my midi drivers (yoke nt).<br><br>Example :<br><br><pre class=code>
Include "MidiLib.bb"

MidiOutDevice = SelectMIDIoutDevice()
MidiOutHandle = OpenMidiOut(MidiOutDevice)


While Not KeyHit(1)

	If KeyHit(30) Then
		SendMidiOut(MidiOutHandle,1,MidiNoteOn,60,127)
	End If

Wend
</pre> <br><br></td></tr></table><br>
<a name="522450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Midi-Yoke always did have a slight delay.<br>Could be that, but more likely these new fangled modern drivers that stack/buffer midi messages.<br><br>Unfortunately this might be the time for you to start frequenting midi forums, rather than asking someone who hasn't programmed midi for 10 years. <br><br></td></tr></table><br>
<a name="522617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used the delay as an advantage... allowed the work to sound more live by introducing natural delays :) 1/4 second is pretty high though.. Yoke wasnt that bad...<br><br><div class="quote"> <br>John Blackledge (Posted 2005-05-19 09:38:51) <br> <br>@Cygnus: With apologies, I hate hex with a vengeance.<br>It might have been necessary once to get big numbers into a few bytes, but would you rather see FF, or 255?<br> <br></div><br><br>yeah, i dont actually like hex, but whenever i do midi, i use it. I'm not even sure why... i suppose, $80+channel (i could decipher $8f to command&lt;channel&gt; pretty easy..)<br><div class="quote"> <br>Similarly, I guess we've all had a kick from seeing our first revolving cube in 3D.<br>Are we sad, or what? (...Nah.) <br> <br></div><br><br>Heh, i was worse. i actually had DREAMS about my little 3d dude running aronud a castle driving a car i put in it and the dragon i put in.... <br><br></td></tr></table><br>
<a name="522935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just found this page...<br><br><a href="http://www.armchairarcade.com/aamain/forum_viewtopic.php?10.13163" target="_blank">http://www.armchairarcade.com/aamain/forum_viewtopic.php?10.13163</a><br><br>hehe<br><br>I'll give it a shot tonight! <br><br></td></tr></table><br>
<a name="523129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange, but that's how I made _my_ TI994A play music!<br>A frequency table, and lots of other lookup tables.<br>Those were the days.<br>(Oh god, there I go again.) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
