<!DOCTYPE html><html lang="en" ><head ><title >get start menu path</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >get start menu path</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >get start menu path</a><br><br>
<a name="736304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a way to get the start menu path from windows? Preferable the all users start menu. I know it may be c:/documents and settings/all users/start menu. The point is, on win9x this may differ, and there are also language diffrences (eg. "Startmenü" etc.).<br><br>There are commands for the system folder, the windows folder, I'm sure there must be one for this. <br><br></td></tr></table><br>
<a name="736309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Uh, I just used to read unless I am using NET there is no simple function for this. So I may check several paths and decide to use an existing folder.<br><br>Could some people with german windows XP or win200 help me?<br><br>How is the path, is it:<br>c:/dokumente und einstellungen/all users/startmenü/<br><br>??<br><br>thanks. <br><br></td></tr></table><br>
<a name="736332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There seems to be a command SHGetSpecialFolderPath in shell32.dll. Not sure if it is .net related. I was able to use it to retreive the startmenu name using this code:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;--------------------------------------------------------------------------------

.lib "shell32.dll"

SHGetSpecialFolderPath%(hwndOwner$,lpszPath*,nFolder%,fCreate%):"SHGetSpecialFolderPathA" 

;--------------------------------------------------------------------------------

Graphics 800, 600, 0, 2

bank = CreateBank(255)
hwnd = SystemProperty$("apphwnd")
SHGetSpecialFolderPath(hwnd, bank, $16, False)

For i = 0 To 254
Write Chr$(PeekByte(bank, i))
Next

Print
WaitKey()
End
</textarea> <br><br></td></tr></table><br>
<a name="736355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks b32, your help is highly appreciated. I think in the decls it should be hwndOwner%, since you hand over an int in blitz. Anyway it didn't work. I then tested other values for the folder parameter (yours was $16, that returned nothing). I used it with a for loop from 0 to 31. The start menu shows up with the value $02 ("...start menu/programs") and $0B (only "...start menu").<br><br>Can you confess this?<br><br>Or does this mean the value depends on the OS version ? o_0<br><br>Thanks again, great work. I'm such a lousy win coder :(. Currently I'm trying to generate a lnk file, thought it's easy, but even the file format description sounds like kind of a quantum physics encyclopedia to me.<br><br>EDIT<br>Currently it seems to me it's easiest to use a vbs script as explained here:<br><a href="http://www.ss64.com/nt/shortcut.html" target="_blank">http://www.ss64.com/nt/shortcut.html</a><br><br>Works nicely.<br><br>So my app will create this vbs file at runtime, using the clients startmenu path etc, then execute it, finally delete it again. <br><br></td></tr></table><br>
<a name="736376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That method looks really great, I should really look into VBscript, because I believe it is really handy. As for the $02 value, I found this thread: <a href="http://www.blitzbasic.com/Community/posts.php?topic=45722" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=45722</a><br>It seems that $02 is the programs folder in the start menu.<br>And I saw that blitzsys has a command concerning special folders. <br><br></td></tr></table><br>
<a name="736532"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Outch, I shoulda have known, good old blitzsys. Now who said beef is harmless :o)<br><br>the temporary vbs works, as long as the OS has Windows Scripting Host active, which is default. Only a few people used to deactivate it for security reasons even for local execution. In my case where it's a lnk to an uninstaller of a screensaver, I think it isn't fatal if the uninstaller is missing on a few machines.<br><br><br>BTW: does value $02 point to your current users startmenu or to the one of All Users? <br><br></td></tr></table><br>
<a name="736611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Arrrrrrrrrgghh!! This is unbelievable. It takes me several days to create a simple screensaver installer/uninstaller :/<br><br>Everything works fine, only problem is:<br><br>When I run a shortcut that uses a commandline argument then this works ok with an ordinary EXE, but refuses to work when I call a SCR that is located in the system folder (as the screensaver.scr is). The idea is to run the original screensaver app with an argument "/UNINSTALL" to remove the whole thing. Currently there's only one file installed, a moleboxed SCR. I'd really like to have not too many files floating around. Any ideas? <br><br></td></tr></table><br>
<a name="736629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried "RunTimeError CommandLine$()", it seems that a .scr file is ran with the /s parameter by default. <br><br></td></tr></table><br>
<a name="736633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're right. Thought windows will start a screensaver with the /s parameter when it automaticly runs the SCR file. I was surprised to see it also altered the commandline of the LNK shortcut from "/UNINSTALL" to "/s" when clicked in the start menu.<br>Ok, currently I ain't see no better solution than an additional exe. <br><br></td></tr></table><br>
<a name="736638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Instead of using the commandline, maybe you could set an environment variable when deinstalling ? <br><br></td></tr></table><br>
<a name="736666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thought I alread answered here... strange...<br>I don't think the LNK file can set an enviroment variable. and it needs to be executed using the LNK shortcut from the startmenu. <br><br></td></tr></table><br>
<a name="739753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems this issue was discussed in two threads. anyhow, the last idea was the desinstaller would first copy itself to the windows TEMP dir, then run this copy, then end itself. The running copy in the TEMP dir would then wait a few seconds and finally delete the uninstaller. The user may delete the content of the TEMP dir from time to time, that's the purpose of it.<br><br>However, I just triedSHGetSpecialFolderPath that worked well for the start menu path etc.. Unfort. it seems it cannot tell me the path of the windows temp dir. Is there an other way to optain the TEMP folder path?<br><br>EDIT uh well never mind, its.<br><br>GetEnv$("TEMP") <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
