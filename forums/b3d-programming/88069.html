<!DOCTYPE html><html lang="en" ><head ><title >'Searching' for games over a LAN network</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >'Searching' for games over a LAN network</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >'Searching' for games over a LAN network</a><br><br>
<a name="999614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone.<br><br>Basically, the question I'm asking is can you 'search' for multiplayer games over a LAN network.<br><br>The only way I currently know of doing this effectively is by using the 'StartNetGame' dialog, but I've been wondering if there is any way to bypass it.  The DirectPlay dialogue searches the LAN network for any running DirectPlay games.<br><br>There are functions that allow you to host a DirectPlay game, or join one (if you know the IP address), but there is nothing that allows you to find other games without knowing the IP addresses of the hosts.<br><br>I have managed to write a short UDP program which finds the current computer's IP address, and just sends messages out to the 255 IPs that can replace the final byte.  It listens for responses, and actually works.  However, I was wondering if there is a better way (probably using DirectPlay) to search the network.  As far as I know, more than the last byte of an IP address can vary from computer to computer (within the LAN network), and it would be impractical to search through more than 65000 IP addresses.<br><br>There should be some easier or at least faster way of doing this as the DirectPlay StartNetGame dialog demonstrates.  I was wondering mainly if there was any way to use an inbuilt DirectPlay function to search the network - as I have seen this used in games like Age Of Empires II.<br><br>Any help or suggestions would be great. <br><br></td></tr></table><br>
<a name="999642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Generally unless its a very large network then games will be in the same IP range within a few numbers using either 192.168.0.x, 192.168.1.x or 10.0.0.x... pretty sure this is what directplay and most games do - just scan the 254 IPs either side of the last set of digits in your IP.<br><br>LAN IPs tho typically are:<br><br>10.0.0.0 - 10.255.255.255<br>172.16.0.0 - 172.31.255.255<br>192.168.0.0 - 192.168.255.255<br><br>Which is a massive range and its possible to have bridged networks, etc. <br><br></td></tr></table><br>
<a name="999665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sub-net broadcast for class C network.<br>Example:<br>Send your packet to (192.168.1.255) <br><br></td></tr></table><br>
<a name="999824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2592" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2592</a> <br><br></td></tr></table><br>
<a name="999918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks.  Haven't heard of broadcasting before - very useful. <br><br></td></tr></table><br>
<a name="999952"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The broadcast to x.x.x.255 only works if you are in a class C ( /24) network segment -- if you're in a smaller segment you need to use a different one. <br><br>To find out the proper broadcast IP you'll need to know both your own IP address AND your netmask, with those two you can calculate the broadcast IP. I'm not aware of any way to determine the netmask from within Blitz, though... :-? <br><br></td></tr></table><br>
<a name="1000149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows definitely knows the network's subnet mask either way (e.g. 'ipconfig' tells you) - is there some API call or etc. that you can make? <br><br></td></tr></table><br>
<a name="1001207"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay - I have found a way to 'find' the broadcast IP without knowing the subnet mask.<br><br>It's messy, but it still works extremely fast and from my knowledge should work in all situations.<br><br>From my research, the subnet mask indicates the number of bits on the end of the IP address that will change.<br><br>For example, the subnet mask '255.255.255.0' would be written in bits as:<br>11111111 11111111 11111111 00000000<br><br>For all of the machines in the subnet, a different code is assigned to them using the 8 bits on the end.<br><br><br><br>To find the broadcast IP, you need to know your IP address and the subnet mask.  In my case, my computer's IP address is 10.1.1.4, and the subnet mask is 255.255.255.0<br><br>'Wikipedia' describes finding the broadcast IP address as conducting a logical OR between the computer's IP address and the complement of the subnet mask - i.e. replace all of the bits that change (as identified by the subnet mask with 0s) in the IP address with 1s.<br><br>E.g.  In my case, I would replace the last 8 bits of my IP address with 1s because that is the amount that changes, leaving me with a broadcast IP address of 10.1.1.255<br><br><br>Searching, I have seen possible ways of calculating the subnet mask from an IP address, but all seem to only work if the subnet mask is left as the default for the network class.<br><br>I realised that you don't need to know the exact subnet mask if there are a limited number of possibilities.  Basically, in order to find another computer hosting a networked game, the program sends a message out to all possible broadcast IPs.  It finds the binary form of the computer's IP address then, in a for-next loop replaces each bit from right to left, one by one, with a '1', and sends a message to the integer form of that IP.<br><br>For example, if the subnet mask (in binary form) was:<br>11111111 11111111 11111111 11110000<br><br>And my IP address was (in binary form):<br>10011101 00000001 00000001 11000011<br><br>The program would systematically go through:<br>10011101 00000001 00000001 11000011<br>10011101 00000001 00000001 11000011<br>10011101 00000001 00000001 11000111<br>10011101 00000001 00000001 11001111<br>10011101 00000001 00000001 11011111<br>etc until:<br>11111111 11111111 11111111 11111111<br><br>One of these will be the broadcast IP because - well, a subnet mask consists of a certain number of bits.<br><br>This method is admittedly slightly messy, but is simple when you understand it and, most importantly, should work no matter what the subnet mask is.<br><br><br>Sorry if my explanation is messy - but the idea is that the program systematically searches through all possible broadcast IPs to ensure that it at one point uses the correct one.  Despite this being a messy approach, it executes in practically no time at all and works. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
