<!DOCTYPE html><html lang="en" ><head ><title >Is there a 3rd party lighting system for Blitz?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is there a 3rd party lighting system for Blitz?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Is there a 3rd party lighting system for Blitz?</a><br><br>
<a name="621481"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Considering all the systems that have been made - is there a 3rd party lighting system?<br><br>I am doing dungeon sections of my RPG and I don't want to use lightmapping too much as I am a fan of unlit tombs/caverns/dungeons, etc - not like in commercial games whereby every place that is uninhabited always seems to, amazingly, have torches burning along the walls.<br><br>I am having completely black/unlit areas where I want the player to carry light with them - which is more realistic.<br><br>The best success I have had so far actually works quite well - I parent a flickering 'Directional' light to the camera.  This sucker works as I have restricted the camera view distance inside the unlit areas - backed up with a bit of black fogging - it works really nicely and reasonably realistically.<br><br>What is good about using the 'Directional' light is it evenly (realistically) lights surfaces as you turn - unlike using point and spotlights that do not always do this.<br><br>The key to my system is the fact that I am restricting the 'CameraRange' which stops the player seeing the fact that the lighting is going on far, far into the distance. It works very well.<br><br>However, I may want NPCs to have their own light in the same way as the player - this presents a problem - I cannot restrict the light given off by an NPC - considering the lighting within Blitz passes through walls, regardless of the type of light, and has a habit of reaching further ahead than what you want it to, etc.<br><br>It's not a major problem - considering the main thing is getting the player's light to work and look okay.<br><br>Anyway, anyone have any lighting tips for me? <br><br></td></tr></table><br>
<a name="621741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Puki,<br><br>I've got a similar problem and demands like you..<br>I agree that the NPC's (or items) should be able to affect the local lighting - just like the player, else it wouldn't make any sense.<br><br>I've done some tests using Sprites to create fake light sources (and not be limited by the 4 or 8 directX lamps). Basically by creating a large soft glow-type additive sprite at the source. Doing this very subtle can create a nice illusion of a light source. <br><br>Another good thing is that you can control the radius, density, even add a bit of texture very accurately. You can animate it's transparency, intensity and color very simply giving a nice optical effect.<br>So for the cliche torch with some particle-flame for example you can have the sprite use the same colors/flicker as the particles giving a really nice effect.<br>Instead of a torch you can use this for a dynamic moving object as well like a candle being held by the player or an NPC.<br><br>But in tight spaces the sprite will start clipping with the walls, unless you hide / fadeout sprites hidden from the camera, the sideeffect of this will be that 'an area around the corner will go dark again' even though it should remain softly lit.<br>Another limitation is that you can't really control it's shape or direction in 3D, it works only as a radial source.<br>So it has it's downsides as well.<br><br>I haven't had time to really test a system like this, but I think it's got some use/potential for sure..<br><br>my 2 cents,<br>Danny <br><br></td></tr></table><br>
<a name="621745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well first off, the problem you are having with things not being evenly lit with point lights is probably due to the fact that vertex lighting needs a lot of vertices to get the light to look proper, and you probably only have vertcies at the corner of each wall.  The more you subdivide each wall, the smoother and more correct your vertex lighting would be.<br><br>Second, and this problem is in direct conflict with the first, the way you "restrict" light cast by NPC's is to have the lights cast shadows.  Now, you can't use a system like my shadow system for this.  We're talking proper shadows here.  And to cast proper shadows what you need to do is light every vertex individually and manually.  But before you calculate how much light is hitting an individual vertex, first you need to dtermine if said vertex can see the light source.  And you can do that by using linepick.  If a linepick from a vertex to a light source picks a polygon, then the light is blocked.<br><br>But that is bound to be really slow.  For one, you've got thousands of vertices you need to do linepicks for.  And for another, you've got thousands of polygons which each of those linepicks must check to determine if a collision has occured.<br><br>Now there are ways to optimize this.  I for one would divide the world into a 3d grid where in each cell I place a list of all polygons that pass through that cell, and then I would dtermine which cells my line passed through which is really fast, and check only those polygons contained in those cells.<br><br>Now if you do that, you're still checking thousands of vertices, just against maybe 10 polygons each instead of thousands.  But this might be fast enough for realtime.  <br><br>HOWEVER, even if you solve that problem, there's another problem, and that is that when you adjust a mesh, the mesh has to be uploaded to the 3D card again.  And that's slow.  Very slow.  Especially if the mesh has thousands of polygons.  Updating a single 64x64 grid containing a mere 8192 polygons is too slow if you intend to do it every frame, and you can't do just part of it one frame and part of it the next, so at best you'll have spikes in your framerate.  That is, unless you divide the mesh up into smaller meshes and cen get away with just altering a small mesh each frame as a result.  But that might be hard or impossible to accomplish depending on how your levels are designed.<br><br>So is there any way you can accomplish this?  Unless your levels are very simple, probably not by altering vertex colors.<br><br>You may however be able to accomplish it with low res lightmaps.  You would basically be calculating lightmaps in realtime.  But they would have to be low res so you don't have to calcualte too many rays, and you would have to implement the system I described above for quickly determining when rays hit walls.  <br><br>I think some user did something like this with lightmaps for their dungeon game, but the shadows were so low res it didn't look very convincing.  I don't know if they optimized it much though the levels were fairly simple.  Anyway, if you kept your lightmap down to say 512x512 for your whole level then that would be a mere 262144 rays that you need to cast each frame to update it. :-) <br><br></td></tr></table><br>
<a name="621747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scherererer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, I tried to do this some time ago... There is a vertex lighting command that I tried to use, however the only way I could think to use it and be able to make walls repel the light was through line picks, which isn't very practical in a large environment. I think you could get away with the DX lighting system (using point lighting), if you made the light ranges a bit shorter and always had a decent amount of space between parallel hallways, atleast enough so that if the torch was near the wall it wouldn't bleed onto another room/hall. <br><br></td></tr></table><br>
<a name="621753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> stencil shadows are your friend! a guy over at codersworkshop has released a system, that will do fine here. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
