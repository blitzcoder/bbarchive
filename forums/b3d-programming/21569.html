<!DOCTYPE html><html lang="en" ><head ><title >Nice cubic mapping function</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Nice cubic mapping function</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Nice cubic mapping function</a><br><br>
<a name="220974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am not sure if this is precisely cubic mapping, but it looks darn good on flat surfaces.  The whole key here is that your vertex normals need to be right.  One face of an object should have all the normals in the same direction, or else you get ugly stretching like when you use sphere mapping on a flat surface.<br><br><img src="http://www.leadwerks.com/storage/shiny.jpg"><br><br>I really recommend viewing this demo first:<br><br><a href="http://www.leadwerks.com/storage/shiny.zip" target="_blank">http://www.leadwerks.com/storage/shiny.zip</a><br><br><pre class=code>
Function cubicmapvertex(surf,v,cam,verts=1)

x#=EntityX(cam)
y#=EntityY(cam)
z#=EntityZ(cam)
pitch#=EntityPitch(cam)
yaw#=EntityYaw(cam)
roll#=EntityRoll(cam)

RotateEntity cam,0,0,0
AlignToVector cam,VertexNX(surf,v),VertexNY(surf,v),VertexNZ(surf,v),3
RotateEntity cam,EntityPitch(cam),EntityYaw(cam),0
TFormPoint 0,0,0,0,cam
tx#=TFormedX()
ty#=TFormedY()	
TFormPoint VertexX(surf,v),VertexY(surf,v),VertexZ(surf,v),m,cam
tz#=TFormedZ()
If tz&lt;100 tz=100
VertexTexCoords surf,v,((TFormedX()-tx/5.0)/tz)/2.0,((TFormedY()-ty/2.0)/tz)/5.0,0,1

PositionEntity cam,x,y,z
RotateEntity cam,pitch,yaw,roll

End Function
</pre> <br><br></td></tr></table><br>
<a name="221009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> "User lib not found". You have one required DLL in your userlibs folder. <br><br></td></tr></table><br>
<a name="221081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Halo, you make me tired. <br><br></td></tr></table><br>
<a name="221292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I added water, with rippling cubic reflections.  It's the best water i have ever seen in Blitz, perhaps the best i have seen in any game.  Same download, source included. <br><br></td></tr></table><br>
<a name="221324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, it's good. <br><br></td></tr></table><br>
<a name="221328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HNPhan</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> very cool indeed <br><br></td></tr></table><br>
<a name="221440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> very nice but whats this Vextorx() command not included in teh sourcecode? <br><br></td></tr></table><br>
<a name="221445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dock</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks really good ^_^ The effect makes everything feel very chrome, and combined with sphere mapping for other objects I'm sure it could look incredibly striking.  Great work! <br><br></td></tr></table><br>
<a name="221484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I included the vector3d lib.  You should be able to run the source. <br><br></td></tr></table><br>
<a name="221487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Framerates?  I get the maximum framerate on my system, but I'd like to hear how it is doing on lower-spec systems. <br><br></td></tr></table><br>
<a name="221510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It looks really lovely, but I'm only getting 30 FPS here. P4 1400 with geforce2 pro. <br><br></td></tr></table><br>
<a name="221516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about changing the water detail until you find the maximum detail where your system still runs at its fastest.<br><br>The detail of the water can be controlled with CreateQuad(1000,50), where 50 indicates that the water is 50x50=2500 quads.  (I can go to about 10,000 quads with no slowdown, or a detail level of 100.)<br><br>This really is meant as a practical, usable effect for games.<br><br>The cubic mapping itself, without the water, should be so fast that it doesn't matter how much you use it. <br><br></td></tr></table><br>
<a name="221548"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't compile the bb - vectorx (and I assume vectory and vectorz) function not found. I guess you made this in your own ide, and forgot to include a lib? <br><br></td></tr></table><br>
<a name="221549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a .decls userlib thing in the archive -- stick it in your userlibs folder... <br><br></td></tr></table><br>
<a name="221578"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> "I added water, with rippling cubic reflections. It's the best water i have ever seen in Blitz, perhaps the best i have seen in any game. Same download, source included."<br><br>sounds interesting, of to d/l it now, thanks halo. <br><br></td></tr></table><br>
<a name="221620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice demo and the water looks good. Not sure what I think about the wall mapping tho, looks nice when you move sideways, but strange when you move in/out.<br><br>It runs at about 30 fps on mine (faster in fullscreen).  Changing the water quad detail makes only a little difference to the speed.  If I change the 50 to a 5 I get 10 more FPS (in fullscreen).<br><br>I'm not sure the water is the best I've ever seen, (limiting myself to water in 'realistic' games) the water in OutCast takes some beating.  And, the flowing water in Vietcong is pretty good. <br><br></td></tr></table><br>
<a name="221726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll check those out.<br><br>Yeah, the reflections move when you move in and out, and they should just scale.  I'm sure it will get better.<br><br>The cubic mapping alone is super-fast, right? <br><br></td></tr></table><br>
<a name="221855"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> The line:<br>cubemap map<br>takes 10 millisecs every frame on my setup.  Which is quite intensive.  That is the thing slowing down the most.<br><br>The water with a setting of 50 takes 9 millisecs, but only 1 if I knock the setting down to 5. <br><br></td></tr></table><br>
<a name="221869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh a userlib. Okay. Never used one o them before. <br><br></td></tr></table><br>
<a name="222439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dock</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would this technique be possible on an animated model?<br><br>Is it possible to adjust the normals of a model to point vertically each frame, and would this be processor intensive? <br><br></td></tr></table><br>
<a name="222555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> it's not possible with a deforming animated model unless you grab a list of frame normals.<br><br>It's always processor intensive. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
