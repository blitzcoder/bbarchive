<!DOCTYPE html><html lang="en" ><head ><title >TypeinsideType ..what's wrong?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TypeinsideType ..what's wrong?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >TypeinsideType ..what's wrong?</a><br><br>
<a name="703360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> --------------------------------------------------------------------<br>Type creature<br>Field name$<br>Field subent.ent<br>End Type<br><br>Type ent<br>Field x<br>Field y<br>Field z<br>End Type<br><br>cr.creature=New creature<br>cr\name="creature1"<br><br>cr\subent.ent = New ent<br>cr\subent\x=1<br>cr\subent\y=2<br>cr\subent\z=3<br><br>cr.creature=New creature<br>cr\name="creature2"<br><br>cr\subent.ent = New ent<br>cr\subent\x=4<br>cr\subent\y=5<br>cr\subent\z=6<br><br>For cr.creature=Each creature<br>	Print cr\name<br>	For cr\subent.ent = Each ent<br>		Print cr\subent\x<br>		Print cr\subent\y<br>		Print cr\subent\z<br>	Next<br>Next<br><br>While Not KeyDown( 1 )<br>Wend<br><br>End<br>--------------------------------------------------------------------<br><br>why the "each loop" displays all ENT and not only the ones inside that creature?<br>thanks <br><br></td></tr></table><br>
<a name="703366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just change your loop to :<br><pre class=code>
For cr.creature=Each creature
Print cr\name
Print cr\subent\x
Print cr\subent\y
Print cr\subent\z
Next
</pre><br> You dont need to loop through all the ents - just those in the creatures. <br><br></td></tr></table><br>
<a name="703368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> uhm ..I need to define more ENT in each creature..and I need to loop through them..<br>what should i do to take only the ENTs defined in the first creature?<br>(p.s. how to display the code on the forum in that way? i'm new here:))<br>---------------------------------------------------------------------<br>Type creature<br>Field name$<br>Field subent.ent<br>End Type<br><br>Type ent<br>Field x<br>Field y<br>Field z<br>End Type<br><br>cr.creature=New creature<br>cr\name="creature1"<br><br>cr\subent.ent = New ent<br>cr\subent\x=1<br>cr\subent\y=2<br>cr\subent\z=3<br><br>cr\subent.ent = New ent<br>cr\subent\x=4<br>cr\subent\y=5<br>cr\subent\z=6<br><br>cr.creature=New creature<br>cr\name="creature2"<br><br>cr\subent.ent = New ent<br>cr\subent\x=7<br>cr\subent\y=8<br>cr\subent\z=9<br><br>For cr.creature=Each creature<br>	Print cr\name<br>	For cr\subent.ent = Each ent<br>		Print cr\subent\x<br>		Print cr\subent\y<br>		Print cr\subent\z<br>	Next<br>Next<br><br>While Not KeyDown( 1 )<br>Wend<br><br>End<br>--------------------------------------------------------------------- <br><br></td></tr></table><br>
<a name="703372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> For your need, you have to create an own linked list type structure and use that. Otherwise you have to loop through all ent and see if the owner (a field you have to add) is the type you are searching from. This is, naturally, not a that good idea on many objects. <br><br></td></tr></table><br>
<a name="703378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>how to display the code on the forum in that way? <br> <br></div><br><br>Just use the tags (code) (/code) around your code but use square brakets. If its very long you can also use (codebox) (/codebox) - square brackets. <br><br></td></tr></table><br>
<a name="703384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> an easy example of linked list? please :)<br>sorry i'm a bit neewbi since i'm a graphic artist mainly <br><br></td></tr></table><br>
<a name="703421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Types can't be used in this way, but I sometimes use them the other way around:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Type creature
Field name$
End Type

Type ent
Field x
Field y
Field z
Field parent.creature
End Type

cr.creature=New creature
cr\name="creature1"

e.ent = New ent
e\x=1
e\y=2
e\z=3
e\parent = cr

e.ent = New ent
e\x=4
e\y=5
e\z=6
e\parent = cr

cr.creature=New creature
cr\name="creature2"

e.ent = New ent
e\x=7
e\y=8
e\z=9
e\parent = cr

For cr.creature=Each creature
	Print cr\name
	For e.ent = Each ent
		If e\parent = cr Then
			Print e\x
			Print e\y
			Print e\z
		End If
	Next
Next

While Not KeyDown( 1 )
Wend

End
</textarea><br>It might be slow, depending on what you need it for.<br>You can also define an array of types:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Type enemy
	Field x
	Field y
	Field z
End Type

Dim p.enemy(100)

For i = 0 To 100
	p.enemy(i) = New enemy
	p(i)\x = i
	p(i)\y = 0
	p(i)\z = 0
Next

Print p(50)\x
</textarea><br>However, using this will limit the flexibility of the type. <br><br></td></tr></table><br>
<a name="703445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> exactly i'm working on a virtual sea simulation.<br>i want to have a type eg:SHARK containing all main characteristics of the creature, like the mesh, the color, speed, behaviour etc and many subtypes that are the fishes on the screen linked to that particular type(shark). They have to be types, because i have to store many parameters, like currentspeed, currentposxyz, currentanim etc...<br>Isn't a way to iterate only through each subtype eg:sharks without any compare instruction and at the same time, continuing using types collection?<br><br>type:Shark<br>     ------shark 1<br>     ------shark 2<br>     ------shark 3<br><br>type:Whale<br>     ------whale 1<br>     ------whale 2<br>     ------whale 3<br><br>sorry for my poor english :) <br><br></td></tr></table><br>
<a name="703448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, you need to generate a lots of different kinds ? Because otherwise, you could to more or less what you describe:<br>Type Shark<br>  field x,y,z<br>  field speed<br>End Type<br><br>Type Whale<br>  field x,y,z<br>  field speed<br>End Type<br><br>..<br>etc.<br><br>And then, use For s.Shark = Each Shark and For w.Whale = each Whale ? <br><br></td></tr></table><br>
<a name="703449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats possible without problems.<br><br>You just have to make Shark, Whale etc all seperate types.<br><br>The other possibility is to implement your own linked list.<br><br>A linked list is a quite easy structure:<br><br>it contains out of containers that point to the next container and to the value they hold.<br>For creature this would be like:<br><br>Type TList<br>  field next.TList<br>  field creature.TCreature<br>end Type<br><br>And now you add a field of type TList to your structure.<br>Whenever a creature of a given type is added you look for this creature type, go manually through the whole list and add the new instance at the end of the list.<br>I think there is a codearchiv entry on that. If not, there are several tousand sites on the net that explain it even with nice Java animations, so you can easily understand how it works if my short description wasn't enough :) <br><br></td></tr></table><br>
<a name="703452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Say, I was thinking about if it is possible to use the type-like properties of Entities. Using the parent-child structure, you can link items very flexible. If you combine this method with types, it is possible to create types within a type:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;-----------------------------------------------------------------------------------------------------
;											   Setup Graphics
;-----------------------------------------------------------------------------------------------------

	;setup graphics
	Graphics3D 800, 600, 0, 2
	SetBuffer BackBuffer()
	
	;setup camera	
	camera = CreateCamera()
	MoveEntity camera, 0, 0, -15

;-----------------------------------------------------------------------------------------------------
;												Setup Pivots
;-----------------------------------------------------------------------------------------------------
	
	;create global parent	
	fish = CreatePivot()
	
	;create parent for sharks/whales
	sharks = CreatePivot(fish)
	whales = CreatePivot(fish)

;-----------------------------------------------------------------------------------------------------
;											   Create Entities
;-----------------------------------------------------------------------------------------------------
	
	;create 10 sharks
	For i = 0 To 9
		
		shark = CreateCube(sharks)
		PositionEntity  shark, Rnd(-10, 10), Rnd(-10, 10), Rnd(-10, 10)
		EntityColor		shark, 0, 0, 255
		RotateEntity	shark, 0, Rand(360), 0
		
	Next
	
	;create 10 whales
	For i = 0 To 9
	
		whale = CreateCube(whales)
		PositionEntity  whale, Rnd(-10, 10), Rnd(-10, 10), Rnd(-10, 10)
		EntityColor		whale, 255, 0, 0
		RotateEntity	whale, 0, Rand(360), 0
		
	Next
	
;-----------------------------------------------------------------------------------------------------
;												   Main Loop	
;-----------------------------------------------------------------------------------------------------
	Repeat


		;handle all sharks	
		For i = 1 To CountChildren(sharks)
			
			shark = GetChild(sharks, i)
			MoveEntity shark, 0, 0, 0.1
			TurnEntity shark, 0, 1, 0
			
		Next

		
		;handle all whales
		time# = MilliSecs() / 40.0		
		For i = 1 To CountChildren(whales)
			
			whale = GetChild(whales, i)
			PositionEntity whale, EntityX(whale), Sin(time + i * 20) * 10, EntityZ(whale)
		
		Next

			
		;render everything
		RenderWorld()	
		Flip
		

	Until KeyHit(1)
	
	End
	
;-----------------------------------------------------------------------------------------------------
;-----------------------------------------------------------------------------------------------------
</textarea> <br><br></td></tr></table><br>
<a name="703475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need to store many parameters for each creature so i must use types..<br><br>it would be:<br><pre class=code>
Type CreatureDefinition
  field name
  field howmany
  field mesh
  field color
  field weight
  field behaviour
  field weight
  field maxspeed
  etc..
end type

Type Creature
  field mesh
  field curposx
  field curposy
  field curposz
  field curspeed
end type

;shark
crdef.CreatureDefinition = new CreatureDefinition
crdef\name="shark"
crdef\howmany=10
crdef\mesh=loadanimmesh("shark.b3d")
etc..

;whale
crdef.CreatureDefinition = new CreatureDefinition
crdef\name="whale"
crdef\howmany=2
crdef\mesh=loadanimmesh("whale.b3d")
etc..

;create the creatures
for crdef.CreatureDefinition = each CreatureDefinition
 for i=1 to crdef\howmany
   cr.creature = new creature
   cr\mesh=copyentity(crdef\mesh)
 next
next
</pre><br><br><br>now i want many sharks and whales on the screen and each of them will have his own cr\speed, cr\posx, cr\posy, cr\posz etc...<br>I thought it was possible to nest many types inside another type...I was wrong :) <br><br></td></tr></table><br>
<a name="703500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try to use Blitz-arrays within objects:<br><pre class=code>
Type creature
	Field name$
	Field subent.ent[5]
End Type

Type ent
	Field x
	Field y
	Field z
End Type

cr.creature=New creature
cr\name="creature1"

cr\subent.ent[1] = New ent
cr\subent[1]\x=1
cr\subent[1]\y=2
cr\subent[1]\z=3

cr\subent.ent[2] = New ent
cr\subent[2]\x = 4
cr\subent[2]\y = 5
cr\subent[2]\z = 6

cr.creature=New creature
cr\name="creature2"

cr\subent.ent[1] = New ent
cr\subent[1]\x=7
cr\subent[1]\y=8
cr\subent[1]\z=9

For cr.creature=Each creature
	Print cr\name

	; Run through all ent's within the current creature (loop through all indexes of the Blitz-array
	For i = 1 To 5
		; Check to see if a valid ent-object exists
		If cr\subent[i] &lt;&gt; Null Then
			Print cr\subent[i]\x
			Print cr\subent[i]\y
			Print cr\subent[i]\z
		EndIf
	Next
Next

While Not KeyDown( 1 )
Wend

End
</pre><br><br>Now you can loop through the Blitz-array within a type, which just holds all ent-objects for that creature.<br><br>Also, in your second example:<br><pre class=code>
Type creature
Field name$
Field subent.ent
End Type

Type ent
Field x
Field y
Field z
End Type

cr.creature=New creature
cr\name="creature1"

cr\subent.ent = New ent
cr\subent\x=1
cr\subent\y=2
cr\subent\z=3

cr\subent.ent = New ent
cr\subent\x=4
cr\subent\y=5
cr\subent\z=6
</pre><br><br>When you declared your first creature, you were trying to add 2 objects to one field-variable.<br>When you create an object using the New keyword, you're creating it and placing the handle (memory-address of the object) in the field-variable.<br>When using it again on the same field-variable, you are overwriting the address of the first object with the address of the second object, leaving the first one somewhere in memory, but you don't have a reference to it, unless you loop through all the objects of that kind (ent in your example).<br>That's called a memory-leak.<br>You had created an object, but you've lost the reference (memory-address) to it, so it's actually floating around somewhere.<br><br>So, in your example, cr\subent.ent will only hold the address to the second ent-object, and lost the address of the first one.<br>You cannot store 2 values in the same field or variable.<br>Like in the real world, you cannot place 2 objects in exactly the same spot, can you? <br><br></td></tr></table><br>
<a name="703509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> A non 'array of types' example using nested types ...  This is the kind of thing I always use and it works well.  Not tested so may be a few typos in there .. sorry.<br><br><pre class=code>
Type CreatureDefinition
  Field name$
  Field mesh
  Field weight#
  Field behaviour
  Field maxspeed#
End Type

Type Creature
  Field mesh
  Field curposx#
  Field curposy#
  Field curposz#
  Field curspeed#
  Field CD.CreatureDefinition
End Type

;create definitions

Global SHARK.creatureDefinition = CREATUREdefinition( "Shark", LoadAnimMesh("shark.b3d") , 10.0 , 2.0 )
Global DOLPHIN.creatureDefinition = CREATUREdefinition( "Whale" , LoadAnimMesh( "whale.b3d") , 80.0 , 1.0 )

;create 10 sharks at random positions

For NO = 1 To 10
	CREATUREcreate( SHARK , Rand(-10,10), Rand(-10,10), Rand(-10,10) )
Next

;create 5 whales at random positions

For NO = 1 To 5
	CREATUREcreate( WHALE, Rand(-10,10), Rand(-10,10), Rand(-10,10 ) )
Next

;MAIN LOOP ETC .......
CREATUREupdate()

;====================================================
;====================================================
;====================================================

Function CREATUREupdate()

	For c.creature = Each creature
		;max speed = c\CD\MaxSpeed
		;weight = c\CD\Weight
				
		Select c\CD\Name
			Case "Shark"
				;do shark specific stuff...
			Case "Whale"
				;do whale specific stuff
		End Select
				
		PositionEntity c\Mesh, c\CurposX, c\CurposY, c\CurposZ
		
	Next
		
End Function
		
;====================================================
;====================================================
;====================================================
		
Function CREATUREdefinition.creaturedefinition( name$, mesh, weight#, maxspeed# )

	cd.CreatureDefinition = New creaturedefinition
	cd\Name = Name
	cd\Mesh = Mesh : HideEntity cd\Mesh
	cd\Weight = Weight
	cd\MaxSpeed = MaxSpeed
	Return CD
	
End Function

;====================================================
;====================================================
;====================================================

Function CREATUREcreate( CD.creaturedefinition , curposx#=0, curposy#=0, curposz#=0, curspeed#=0 )

	c.creature = New creature
	c\Mesh = CopyEntity( CD\Mesh )
	c\Curposx = curposx
	c\Curposy = curposy
	c\Curposz = curposz
	c\Curspeed = 0
	
End Function

</pre><br><br>Give me a shout if there's anything you don't understand.  <br><br>Stevie <br><br></td></tr></table><br>
<a name="703551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> If ou can define the maximum Ent type included in the creature type, you could use the command Object to obtain what you want.<br><br>let 's have a seen :<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Type creature
Field name$
Field NbEnt%
Field handleEnt[1000]
End Type

Type ent
Field x
Field y
Field z
End Type

cr.creature=New creature
	cr\name="creature1"
	subent.ent = New ent
		subent\x=1
		subent\y=2
		subent\z=3
	Cr\NbEnt=Cr\NbEnt+1
	Cr\handleEnt[Cr\NbEnt]=Handle(subent)



cr.creature=New creature
	cr\name="creature2"
	subent.ent = New ent
		subent\x=4
		subent\y=5
		subent\z=6
	Cr\NbEnt=Cr\NbEnt+1
	Cr\handleEnt[Cr\NbEnt]=Handle(subent)



For cr.creature=Each creature
	Print cr\name
	If cr\NbEnt&gt;0
		For nb=1 To cr\NbEnt
			subent.ent=Object.ent(Cr\handleEnt[nb])
			Print subent\x
			Print subent\y
			Print subent\z
		Next
	EndIf
Next

While Not KeyDown( 1 )
Wend

End
</textarea> <br><br></td></tr></table><br>
<a name="703630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> thx everybody for the help :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
