<!DOCTYPE html><html lang="en" ><head ><title >Agonizing slowdowns...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Agonizing slowdowns...</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Agonizing slowdowns...</a><br><br>
<a name="709659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OrcSlayer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, here's a small (performance) problem of mine. Actually it's not that small, it's upwards of 40 FPS loss in the worst case.<br>1: I have a core "skeleton" mesh which has nothing but bones (pivots). It has 13 bones and nothing but a simple box (for some reason it didn't work without SOME mesh data), which I alpha out.<br>2: I attach the pieces of my armor mesh (13 total) to the appropriate bones. The total polycount is about 1300.<br>3: I animate the base skeleton mesh, which causes the pieces to move (obviously, since they are parented to the bones).<br><br>I figured this would be a great way to speed up the game, since there won't be any actual bone vertex manipulation going on, simply pivot rotations.<br><br>It sounded good in theory, but in my engine the results aren't much better than a 1500 poly model with 20-something bones. This just doesn't make sense, can anyone give me a clue as to why this is going so poorly?<br><br>I can have at most 2-4 characters on screen before I start getting slowdowns. At 10 the slowdown is up to 40 FPS, averaging closer to 30. <br><br></td></tr></table><br>
<a name="709663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OrcSlayer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I believe I found out the cause...each of the 13 meshes will obviously have it's own surface...so I had an overload of surfaces.<br><br>So, I suppose the question is in order...can I somehow avoid the vertex manipulation problem (DX7 bone animation being so slow) while still having all pieces be in a single mesh and thus a single surface? <br><br></td></tr></table><br>
<a name="709672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a single surface mesh manipulation library in the archives you could try but ......<br><br>As you mention - each body part has one texture &amp; therefore one surface, to make single surface manipulation possible you'd have to make a larger texture with all the pieces in one and re-do all the uv's for each body part.<br><br>Even then, you would have to manipulate all the vertices a fair bit to achieve the same effect and this is sloooooow.  It would probably be much worse in terms of speed than you already have and not worth the effort.  I wouldn't recommend it.<br><br>I believe someone was working on a single surface animation library which was much faster than your standard animation techniques.. probably in the showcase but not released as yet.<br><br>Sorry I can't be of more help.<br><br>Stevie <br><br></td></tr></table><br>
<a name="709756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dustin</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Welcome to the wonderful world of B3D animations.  Just loading the bone structure shows the hit in FPS.  My workaround (In Bad, Bad Bots!) is to limit the B3D animation to only the player and everything else (including robots) is handled by MD2 anims.  <br><br>Here's a link to the thread that Stevie mentioned:<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=62559#698906" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=62559#698906</a><br>Not sure of the status but I would love to get my hands on this system!!! Dozens of animations with almost no performance hit. <br><br></td></tr></table><br>
<a name="709810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OrcSlayer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I did some more testing...if I load the bones/animation set, but only one of the pieces (actual meshes), I can easily push 20 animated characters with no slowdowns.<br><br>Each piece I add results in fewer characters being possible, so it would seem the problem in this case is entirely related to surface count. Remember that the whole skeleton is loaded and animated, the only difference is how many meshes I attach to the bones.<br><br>However, oddly, if I load the complete mesh (which contains all the pieces in a test mesh, but still uses several textures) it still seems to behave as a single surface mesh, and I can still have upwards of 20 in view with no problems.<br><br>The test mesh is fully rigged, and loaded as an animmesh, by the way.<br><br>This is getting interesting... <br><br></td></tr></table><br>
<a name="709825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Meshes attached to bones is not the problem<br><br>Vertices attached to it is the problem as the whole dynamic skin is done CPU side and needs to be transfered to the GPU for displaying.<br><br>So as long as you don't use vertex weight and bone based deformations (ie as long as you do the bone based animation that you could have done with X models as well), there isn't much of a problem.<br><br>As wel bone based animations aren't the problem ... its normally more the modeller that don't understand the difference from 3d rendering and games and create the models for games like they do their 3d rendering models which tends to create some serious problems. (50 bones are at least 30 too much on most models, 5000 polygons are again at least 3000 too much for bone based CPU animation in realtime) <br><br></td></tr></table><br>
<a name="709829"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OrcSlayer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you are saying that we can do an animating .b3d file that acts exactly the way I'm trying to do it now (movement of seperate pieces without vertex manipulation or other deformations), with all the pieces in the same mesh?<br><br>If so I believe that could easily solve the surface problem (I've done further testing and I can actually get almost ten full characters in view without a terrible slowdown, but this is still pushing it since the full game should be able to push more than that).<br><br>I'll refer this to my artist and see if we can't work something out... <br><br></td></tr></table><br>
<a name="709857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Defoc8</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Meshes attached to bones are not the problem...well,<br>it will have an effect...complex hierarchy setups, means<br>more matrix maths - i dont doubt on most systems this<br>hit probably doesnt seem too big.. but combining this with<br>texture/buffer thrashing, your going to get quite a few<br>stalls... <br><br>If you can get by with simpler meshes, you might want to<br>conisder modeling your character as md2, parenting parts<br>to mesh in your editor + exporting each part and the main<br>character as md2.. again you should try to pack as many<br>images you can into a single texture, using animtextures.<br><br>its ugly, but you can usually get lots of md2's onscreen<br>without all the slowdown associated with b3d..its much<br>simpler - keep in mind md2's store all the verts for every<br>keyframe..so ensure your polycount is quite low.<br><br>goodluck! <br><br></td></tr></table><br>
<a name="709858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OrcSlayer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll just have to get by with the current system then...MD2 is not an option for this project.<br><br>I'll just have to be creative about using respawning enemies, and replace corpses with unanimated static meshes. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
