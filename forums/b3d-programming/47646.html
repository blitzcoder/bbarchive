<!DOCTYPE html><html lang="en" ><head ><title >PositionEntity verticeX/Y/Z</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >PositionEntity verticeX/Y/Z</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >PositionEntity verticeX/Y/Z</a><br><br>
<a name="529343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello<br><br>I'm very stuck on what I thought would be a simple mathematical problem.  I'm trying to bind a gun to a players hand by reading in the vertice information.<br><br>I'm using my own code driven mesh deformation for the animation so there is no other way to read off the position of the characters hand.<br><br>Getting the vertice positions is easy enough, after figuring out the surface/vertex identity<br>	x#=VertexX(surface,vertex)<br>	y#=VertexY(surface,vertex)<br>	z#=VertexZ(surface,vertex)<br><br>I then need to rescale the vertex information because my model is rescaled, so I multiply it by *.01 which should give me the x/y/z of the vertex relative to the objects pivot position.<br><br>The above all works, but now I need it to rotate depending upon the rotateEntity command.  I thought in order to perform the rotation I would simply need to orbit the X/Z around the pivot based on it's distance from the epicentre - like a planet orbits the sun.<br><br>p\facing = the rotation of the character entity:<br><br>	r#=Sqr((x*x)+(z*z))<br>	x=x+(Cos(p\facing)*r)<br>	z=z+(Sin(p\facing)*r)<br><br>If I now add the entities world position with the rescaling for the entityscale command and rotate the gun to the angle of the entity (i'll figure out how to rotate the gun in line with the vertex once this works, probably using normals).<br><br>	PositionEntity p\gunObj,p\x+(x*.01),p\y+(y*.01),p\z+(z*.01)<br>	RotateEntity p\gunObj,0,p\facing,0<br><br>Now the only problem is, this completely doesn't work :(<br><br>Have I done something wrong ? <br><br></td></tr></table><br>
<a name="529357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its a lot simpler than you imagine.  Once you have the local Vertex position you need to translate it into the parent or world space using <a href="/b3ddocs/command.php?name=TFormPoint&amp;ref=3d_cat" target="_blank">TFormPoint</a>.<br><br>You can scale and rotate it by parenting it to the character.<br><br>Although, thinking about it, you are using your own animation, so it might be an idea to create two vertices, one at the position of the hand/gun and the other at a distance of 1.0 away from the first.  Then use TFormVector to adjust your gun scale and rotation.<br><br>Hope this helps. <br><br></td></tr></table><br>
<a name="529360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you very much Beaker, it works a treat :) !  I feel all enlightened now... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
