<!DOCTYPE html><html lang="en" ><head ><title >3D VR Headset</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >3D VR Headset</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >3D VR Headset</a><br><br>
<a name="637092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>i try to use a Cybermaxx VR HMD with BB3D.<br>But my C++ is so Poor that i need your HELP.<br>I have the help of the LIB and the DLL<br><br>Here is what i have:<br><br>int	AutoDetectComPort(void);	Auto-Detects CyberMaxx on COM1 though COM4<br>							returns COM0_ID if not found else COM1_ID though COM4_ID;<br>							Parameters:	NONE<br><br><br>BOOL	OpenCom(const char*);		Opens selected comm port and looks for CyberMaxx.<br>							Auto-Detect calls OpenCom for each port.<br>							If port opened successfully and CyberMaxx found,<br>							function returns TRUE else comm port is closed <br>							and return value is FALSE;<br>							Parameters: COM1,...,COM4;<br><br>BOOL	ReadFromPort(void);		Reads data from port. Use Get_PYR(...) to<br>							access the data. Returns TRUE if successful.<br><br>Void	Get_PYR(int*, int*, int*);	Get Pitch, Yaw, Roll <br>							respectively +45&lt;-&gt;-45, 359&lt;-&gt;0, +45&lt;-&gt;-45 <br><br>char*	Get_Version(void)			Returns firmware version, else NULL if device not found<br><br>BOOL	HardReset(void);			HardReset sets CyberMaxx to power up default state<br><br>BOOL	Set9600(void);				Sets port and CyberMaxx to 9600 bps	(default) <br>BOOL	Set19200(void);				Sets port and CyberMaxx to 19200 bps<br><br>BOOL	SetHysteresisOn(void);			Sets hysteresis on			(prefered)<br>BOOL	SetHysteresisOff(void);			Sets hysteresis off			(default)<br><br>BOOL	CheckSumOn(void);			Enables checksum on. If error occured, then last valid packet<br>							will be used.<br>BOOL	CheckSumOff(void);			Enables checksum off			(default)<br><br>char	GetDataMode(void)			Returns data transmission mode. <br>							BINARY_MODE - faster			(default)<br>							ASCII_MODE - slower, used for debug<br>void	SetDataMode(char)			Sets data transmission mode. Same as above<br><br>char	GetTransMode(void)		Returns  SAMPLE_UPON_REQUEST   (default)<br>							or CONTINOUS_SAMPLE_MODE<br>void	SetTransMode(char)		Sets transmission Mode. Same as above<br>				<br>void	SetSamplingRate(int rate);	Sets CyberMaxx packet sampling rate.<br>							MINPACK &lt;-&gt; MAXPACK increments of 5<br>							default rate is 40 pps<br>int	GetSamplingRate(void)		Returns current sampling rate that CyberMaxx is set to.<br><br>int	GetCurrentSpeed(void)		Returns current comm port speed. 9600 or 19200<br><br>int	GetPortId(void)			Returns port number to which CyberMaxx is attached.<br>							COM1_ID,...,COM4_ID if found, else COM0_ID<br><br><br>Sample code:<br><br><br>// CyberMaxx 2.0 Win95 &amp; NT SDK<br>// Copyright (©) 1996 VictorMaxx Technologies, Inc<br>// Author: Robert J. Gebis<br>// Date: 6 March 96 Ver 1.0<br><br>#include &lt;conio.h&gt;<br>#include &lt;iostream.h&gt;<br>#include "CyberMaxx.h"<br><br>// This has to be linked with MaxxCom.lib<br>// to use MaxxCom.dll<br><br>void main(void)<br>{<br>    MaxxCom     CyberHMD;<br>    int         Pitch, Yaw, Roll;<br><br>    // Start by connecting to the CyberMaxx<br>    if( !CyberHMD.AutoDetectComPort()) {<br><br>        // ERROR CyberMaxx not Found<br>        exit(-1);<br>    }<br><br>    // These are optional<br>    CyberHMD.SetHysteresisOn();     // turn on the hysteresis filter to minimize jittering<br><br>    char    version[10];<br>    strcpy( version, CyberHMD.Get_Version()); <br>	<br>    CyberHMD.SetSamplingRate(50);   // Used only in continous mode<br>                                    // defailt is 40 packets/s<br><br>    // This is how you read<br>    while( !_kbhit()) {<br><br>        // if the CyberMaxx has supplied data, this returns true<br>        if( CyberHMD.ReadFromPort()) {<br><br>            CyberHMD.Get_PYR(&amp;Pitch, &amp;Yaw, &amp;Roll);      // Read data<br>            cout &lt;&lt; "Pitch -&gt; " &lt;&lt; Pitch &lt;&lt; endl;<br>            cout &lt;&lt; "Yaw   -&gt; " &lt;&lt; Yaw &lt;&lt; endl;<br>            cout &lt;&lt; "Roll  -&gt; " &lt;&lt; Roll &lt;&lt; endl &lt;&lt; endl;<br>        }<br>        else { <br>            cout &lt;&lt; "Error" &lt;&lt; endl;<br>        }<br><br>    }   // go until a key is hit<br><br>}   // end of main<br><br>I need help to write my decls, here is my try:<br><br>.lib "maxxcom.dll"<br><br>AutoDetectComPort()<br>Get_PYR(pit%,yaw%,roll%)<br>OpenCom$()<br>ReadFromPort$()<br>Get_Version$()<br>HardReset$()<br>Set9600$()<br>Set19200$()<br>SetHysteresisOn$()<br>SetHysteresisOff$()<br>CheckSumOn$()<br>CheckSumOff$()<br>GetDataMode$()<br>SetDataMode($)<br>GetTransMode%()<br>SetTransMode($)<br>SetSamplingRate(%)<br>GetSamplingRate()<br>GetCurrentSpeed()<br>GetPortId()<br><br>Please Help me. <br><br><br>Greet's <br>MErren <br><br></td></tr></table><br>
<a name="637108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> one thing: it seems to me:<br>void Get_PYR(int*, int*, int*);<br><br>wants some pointers to write the results to. So you need to use 3 blitz bank handles, each bank of 4 bytes size. Once executed the banks should contains pitch yaw and roll.<br><br>so in the decls you also need to use the pointer sign:Get_PYR%(pit*,yaw*,roll*)<br><br>Additionaly:<br>SetTransMode($)<br>SetSamplingRate(%)<br><br>AFAIK you need to use some kind of variable names here, at least:<br>SetTransMode(a$)<br>SetSamplingRate(b%)<br><br>And:<br>you need to define what type of return value will be used, so when it's gonna return a string (char) then you need to declare it as:<br>GetTransMode$()<br>the same for GetDataMode etc. <br><br></td></tr></table><br>
<a name="637227"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> WOW , thank you very much.<br>I ll try my be a long night!!<br>I show results!!! <br><br></td></tr></table><br>
<a name="637270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't you just love the people on this fourm?  Nice one JFK<br><br>IPete2. <br><br></td></tr></table><br>
<a name="637288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, sorry i am to stupid.<br>it won't return anything.<br>I can't read out PYR cause i don't know how to.<br><br>That's to high for me BB and C++ <br><br></td></tr></table><br>
<a name="637344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr. Wildrick</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br>I think I can help you.<br>Your VR system requires a lot more than the detection routines and when turned on - will display in mono (2D) same image in both eyes. What you will need toi do is create a quad buffer system and use the system pointer to pointers to the sepretly rendered views in blitz 3D,<br>In this way, and only this way will you get true 3D.<br>Good luck.<br>Dr, Wildrick<br>Creator of the TruDimension 3D shutter glasses, 3D monitor and VR Headset add-on for Blitz 3D, Intel C++, Java and Add-on Bryce. <br><br></td></tr></table><br>
<a name="637349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dr. Wildrick</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, One final worrd.<br>You may wish to consider how much time you put into the developmet of the srivers as the image quality is BAD with a capital B - worse - its fiels sequential - meaning that you havlve the already very bad resolution rigt from the gate - if your intrested in a "Hey neat!" sort of thing - go for it - If toyr trying to develop a game - any text will be un=readable and forget someting like a HUD, We suppored them becase of popular request - but thety arebt even made any more as far as I know.<br>Let me know how your quest turns out. Best of luck to you.<br>Regards<br>Dr. WIldrick <br><br></td></tr></table><br>
<a name="637567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You are Right, Dr. Wildrick.<br>But the Way is the Target. I want to learn more about Decls and DLL and my Projekt is to make my 3d Architekturprojekts viewable and get a better Feeling for the Dimentions. <br>The Way is the Target. <br>Do you know how to translate the C++ Part into BB? And do you have a Demo of the Interlace DLL u use in your 3dVU? <br><br></td></tr></table><br>
<a name="637628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>it won't return anything.<br>I can't read out PYR cause i don't know how to.<br> <br></div><br> Of course you first need to execute the commands to initialise the device. Then the PYR should work like this (assuming you have declared it in the decls)<br><br>my_pitch=createbank(4)<br>my_yaw=createbank(4)<br>my_roll=createbank(4)<br><br>Get_PYR(my_pitch, my_yaw, my_roll)<br>print peekint(my_pitch,0)<br>print peekint(my_yaw,0)<br>print peekint(my_roll,0)<br><br>as for the C++ code, it looks like everything is pretty simple to convert to blitz:<br><br><br><pre class=code>
my_pitch=createbank(4)
my_yaw=createbank(4)
my_roll=createbank(4)


;// Start by connecting to the CyberMaxx
if AutoDetectComPort()=0
 ;// ERROR CyberMaxx not Found
 runtimeerror "ERROR CyberMaxx not Found"
endif

;// These are optional
;CyberHMD.SetHysteresisOn(); // turn on the hysteresis filter to minimize jittering (try this later)

my_version_adr=Get_Version%() ; returns a pointer to a string

SetSamplingRate(50); // Used only in continous mode
;// default is 40 packets/s

;// This is how you read
while keyhit(1)=0
 ;// if the CyberMaxx has supplied data, this returns true
 if  ReadFromPort()&lt;&gt;0
  Get_PYR(my_pitch, my_yaw, my_roll)
  print peekint(my_pitch,0)
  print peekint(my_yaw,0)
  print peekint(my_roll,0)
 else
  print "Error"
 endif
wend
</pre><br>Of course I doubt it will work  right away, but probably it gives you the direction.<br><br>Again, make sure your decls are using the right function name return types, I see you have a lot of string return types, doublecheck if everything is right<br><br>void dothis() means it won't return anything<br>char dothis() means it will return a string. declare: dothis$()<br>char* dothis() means it will return a (32bit int) pointer to a string, use dothis%() (see below how to use a pointer)<br>int dothis() means it will return an int, use dothis%()<br>BOOL dothis() means it will return true or false, I think you can use an int here.<br><br>The function Get_Version is a bit special, it will return an adress (=Pointer) of a 10 Bytes string. You need to use RTLMemoryMove2 to copy the 10 bytes to a blitz bank. See code archives, userlibs, Avifil32 Frame grabber example on how to declare and use RTLMemoryMove. <br><br></td></tr></table><br>
<a name="638043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> while I'm at it:<br>in a "kernel32.decls" the following lines are required:<br><pre class=code>
.lib "kernel32.dll"
RtlMoveMemory2%(Destination*,Source,Length) : "RtlMoveMemory"
</pre><br>In the app you will have to make a 10 bytes bank ready to retrieve data from the returned adress:<br><pre class=code>
my_buffer=createbank(10)
</pre><br>In blitz you would then:<br><pre class=code>
adr=Get_Version()
rtlMoveMemory2(my_buffer,adr,10)
version$=""
for i=0 to 9
 version$=version$+chr$(peekbyte(my_buffer,i))
next
Print version$
</pre> <br><br></td></tr></table><br>
<a name="639358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow,<br>hey JFK EO-11110 you must come form the c++ Planet. Thank you so far. <br>But i think i must recompile the DLL cause the BB-Mainprogram say's "Function in Lib not found.". then i have downloded a Tool to check DLL's and the Function's are there. The DLLs are in the correct Folder, its a Cross to wear.<br>But I will do. Thank's to JFK.. again. <br><br></td></tr></table><br>
<a name="639408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think the functions of the dll must be declared for shared use in the dll. <br><br></td></tr></table><br>
<a name="639417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Panno</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> JFK  comes from MARS ! <br><br></td></tr></table><br>
<a name="639436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah, just escaped from area 51, btw. <br><br></td></tr></table><br>
<a name="641050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK OK,<br>i must call again.<br>I've downloaded "PE Explorer" and try to declare my dll as an <br>"shared" one. but noting the Gr#*%$%&amp; Blitzbasic says " User lib function not found" and i have no Idea of how to handle. <br>Greet M.Erren <br><br></td></tr></table><br>
<a name="641311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's many years ago since I stopped using C++, so my advice is far from competence. <br><br>In Purebasic one needs to declare a procedure in a special way to allow other apps to access it in a dll, there you have to say<br><br>ProcedureDLL() or ProcedureCDLL(), compared to the ordinary Procedure(), the function declaration. So maybe the functions have to be declared in a special way too. Sorry, I have no better advice. at least the Windows Api DLLs (kernel32.dll, user32.dll etc) can be accessed by blitz.<br><br>Please post your userlib and your blitz sourcecode. <br><br></td></tr></table><br>
<a name="641775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> At First I think its clever to give the Link to the<br>DLL<br><a href="http://www.geocities.com/mellott124/CyberDrivers.htm" target="_blank">http://www.geocities.com/mellott124/CyberDrivers.htm</a><br><br>Here the User lib dir<br><br>09.03.2006  22:02    &lt;DIR&gt;          ..<br>25.07.2002  21:36         1.069.056 3d2.exe<br>20.07.2003  04:45             1.666 blitz_extend.decls<br>20.07.2003  13:53            15.360 blitz_extend.dll<br>20.07.2003  13:53             4.741 blitz_extend.dpr<br>24.02.2003  07:42               564 dlportio.decls<br>27.09.1996  10:29            34.816 DLPORTIO.DLL<br>10.01.1999  11:00             3.584 DLPORTIO.SYS<br>13.10.2004  06:06                54 INPOUT.decl<br>03.12.1996  14:01            27.648 INPOUT32.DLL<br>13.10.2004  12:23                54 K8055d.decl<br>27.04.2004  21:35            46.592 K8055D.dll<br>13.10.2004  06:35             1.047 kernel32.dec<br>09.03.2006  23:09               848 kernel32.decls<br>09.11.2002  17:10            24.576 pbca3d2.dll<br>22.02.2005  06:58            26.998 User32.decls<br>11.02.2003  02:11             4.425 UserLibs.txt<br>09.03.2006  22:56                63 InpOut32.decls<br>28.03.1996  14:43             9.216 MaxxCom.dll<br>28.03.1996  14:43            32.658 MaxxCom.lib<br>26.04.1996  15:01             3.535 MaxxCom.txt<br>28.03.1996  11:30             4.174 MaxxCom.h<br>10.03.2006  08:46               364 MaxxCom.dec.txt<br>10.03.2006  20:44             4.903 newton.decls<br>10.03.2005  13:16           405.504 Newton.dll<br>29.11.2005  21:40            65.024 PEview.exe<br>19.03.2006  17:45               158 trak.decls<br>11.03.2006  22:46             2.352 trak.H<br>11.03.2006  20:08               141 MaxxCom.decls-<br>19.10.1995  15:26            32.256 TRAK-org.DLL<br>19.03.2006  17:44            32.256 TRAK.DLL<br>21.03.2006  16:35                 0 dir.txt<br>              39 Datei(en)      4.490.747 Bytes<br>And one BB sourcecode.<br><br>my_pitch=CreateBank(4)<br>my_yaw=CreateBank(4)<br>my_roll=CreateBank(4)<br> <br>;// Start by connecting to the CyberMaxx<br>If AutoDetectComPort()=0<br> <br>;// ERROR CyberMaxx not Found<br> RuntimeError "ERROR CyberMaxx not Found"<br>EndIf<br><br>;OpenCom(com1)<br>;// These are optional<br>;CyberHMD.SetHysteresisOn(); // turn on the hysteresis filter to minimize jittering (try this later)<br><br>;my_version_adr=Get_Version() ; returns a pointer to a string<br><br>SetSamplingRate(50); // Used only in continous mode<br>;// default is 40 packets/s<br><br>;// This is how you read<br>While KeyHit(1)=0<br> ;// if the CyberMaxx has supplied data, this returns true<br> If  ReadFromPort()&lt;&gt;0<br>  Get_PYR(my_pitch, my_yaw, my_roll)<br>  Print PeekInt(my_pitch,0)<br>  Print PeekInt(my_yaw,0)<br>  Print PeekInt(my_roll,0)<br> Else<br>  Print "Error"<br> EndIf<br>Wend<br><br>And i found no way to use it.<br><br>GreetS <br>Micha <br><br></td></tr></table><br>
<a name="641894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I assume the DLL in question is "MaxxCom.dll" ?<br>MaxxCom.lib and MaxxCom.h are not required there, they are sourcecode (as far as I see). Now tell me why is the decls named: "MaxxCom.decls-" ? what's that minus at the end of the name? If it's really named like this then it's no surprise the functions are not found.<br><br>Please post the content of MaxxCom.decls. Could you upload the MaxxCom.dll somewhere, So I don't have to download the entire SDK thingy. <br><br>However, for debugging purposes first try to make the very first command work:<br><br>print AutoDetectComPort()<br>print "success"<br>waitkey()<br>end<br><br>if this is once working, you'll know the dll can be accessed. <br><br></td></tr></table><br>
<a name="642321"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>it was my false with the "MaxxCom.decls-" cause the maxxcom.dll contains then same functions like trak.dll so i rename the Maxxcom.decls. <br>I tryed the same like your little testprogi, but it's always the same error message.<br>The trak.dll is smaller and contains nearly the same functions. under www.erren3d.de/dll/trak.dll or www.erren3d.de/dll/maxxcom.dll you can download the DLLs. I hope i can help you, to help me. <br>It's very cool that you immolate your time and know how.<br><br>Greet's<br>Micha <br><br></td></tr></table><br>
<a name="642442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried it with the maxxcom dll, but it didn't work. As I said, I don't know much about C++, but I think it has something to do with the way the example makes use of object oriented parenting. As far as I see in cybermaxx.h a custom structure is declared, and an instance named CyberHMD is then created and used as the parent object of any further command calls. Maybe this structure is required, I'm not sure. A little help of one of our C++ gurus may b helpful here (hey!).<br><br>But somehow I also think there must be a way to use it without the object structure. However, could you post the content of cybermaxx.h ? <br><br></td></tr></table><br>
<a name="642753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't have any cybermaxx.h<br><br>here are the *.h that i have<br><br>// MaxxCom.h -- header definitions for CyberMaxx Tracker<br>// Copyright (C) 1995  VictorMaxx Technologies, Inc.<br>// Author: Robert J. Gebis<br>// Date: 2 Oct 95 Ver 1.0<br>// Date: 19 Jan 96 1.0.1<br>// Date: 23 Jan 96 1.0.2<br>// Date: 24 Jan 96 1.0.4<br><br>#ifndef __MAXXCOM_H__<br>  #define __MAXXCOM_H__<br><br>#define ABSOLUTE_MODE					"C"<br>#define RAW_DATA_MODE					"B"<br>#define ASCII_MODE						"E"<br>#define BINARY_MODE						"F"<br>#define SAMPLE_UPON_REQUEST			"G"<br>#define CONTINOUS_SAMPLE_MODE			"H"<br>#define TRANSITION_9600_19200			"K"<br>#define TRANSITION_19200_9600			"L"<br>#define CHECKSUM_ON						"M"<br>#define CHECKSUM_OFF						"N"<br>#define AVERAGE_FILTER_ON				"T"<br>#define AVERAGE_FILTER_OFF				"W"<br>#define HYSTERESIS_FILTER_ON			"P"<br>#define HYSTERESIS_FILTER_OFF			"O"<br>#define HARD_RESET						"R"<br>#define REQUEST_HANDSHAKE				"X"<br>#define REQUEST_VERSION_NUM			"V"<br>#define SEND_CURRENT_COORDINATE		"S"<br>#define SEND_CURRENT_SENSOR_DATA		"S"<br><br>#define MAXPACK				75			// higher sampling mode<br>#define MINPACK				5			// lower sampling mode<br>#define DEFSAMPLE				"40"		// starting sampling speed<br><br>#define COM0_ID				0<br>#define COM1_ID				1<br>#define COM2_ID				2<br>#define COM3_ID				3<br>#define COM4_ID				4<br><br>// Number To Read IN Check Sum Mode<br>#define N2R_INCSM_ON		7<br>#define N2R_INCSM_OFF		6<br><br>const char COM1[5] = "COM1";<br>const char COM2[5] = "COM2";<br>const char COM3[5] = "COM3";<br>const char COM4[5] = "COM4";<br><br>#define DllExport	__declspec( dllexport )<br><br>class DllExport MaxxCom {<br><br>	public:<br>				MaxxCom();<br>				~MaxxCom();<br>		int	AutoDetectComPort(void);<br>		BOOL	OpenCom(const char*);		<br>		BOOL	checkForCyberMaxx(void);<br>		BOOL	Set9600(void);<br>		BOOL	Set19200(void);<br>		BOOL	SetHysteresisOn(void);<br>		BOOL	SetHysteresisOff(void);<br>		BOOL	HardReset(void);<br>		BOOL	CheckSumOff(void);<br>		BOOL	CheckSumOn(void);<br>		BOOL	ReadFromPort(void);<br>		char*				Get_Version(void);				// if not NULL then returns pointer to version<br>		void				Get_PYR(int*, int*, int*);		// Get Pitch,Yaw,Roll<br>		inline char		GetTransMode(void){ return m_TransMode;}<br>		inline void		SetTransMode(char tp){ m_TransMode = tp;}<br>		inline char		GetDataMode(void){ return m_dataType;}<br>		inline void		SetDataMode(char tp){ m_dataType = tp;}<br>		void				CloseCom(void);<br>		void				SetSamplingRate(int rate);		// MINPACK &lt;-&gt; MAXPACK increments of 5<br>		inline int		GetSamplingRate(void){return m_SamplingRate;}<br>		inline int		GetCurrentSpeed(void){return m_iPortSpeed;}<br>		inline int		GetPortId(void){return m_port_ID;}<br><br>		// For internal use only<br>		BOOL	GetDCB(void);<br>		BOOL	DoCheckSum(void);	<br>		BOOL	SendToPort(char*);<br>		inline unsigned char*	GetDataBuffer(void){return m_inBuffer;}<br>		inline HANDLE	GetTempComHandle(void){return m_hConTemp;}<br>		inline BOOL		CheckIfBusy(void){ return m_bPortInUse;}<br>		inline BOOL		GetCheckStatus(void){ return m_bChecksum;}	<br>		inline void		SetPortId(int id){m_port_ID = id;}<br>		inline void		SetTempComHandle( void){m_hConTemp = m_hCom;}<br>		inline void		SetNewComHandle( void){m_hCom = m_hConTemp;}<br>		inline void		SetSpeedFlag(int speed){ m_iPortSpeed = speed;}<br>		inline int		GetBytesRead(void){return m_numOfBytesRead;}<br>		inline HANDLE	GetComHandle(void){return m_hCom;}<br>		BOOL				CloseCom(const HANDLE);<br>		void				errMsgBox(const char*);<br>		void				ResetFIFO(void);			<br><br>	private:			  <br>			int			m_port_ID,						// COM1_ID, COM2_ID, .....<br>							m_SamplingRate,				// default 40 packet/s<br>							m_iCheckSum,					// contains actual checksum	data<br>							m_iPortSpeed,					// 9600 | 19200, 9600 default<br>				 			m_pitch, m_yaw, m_roll;		// -45&lt;-&gt;+45 , 0&lt;-&gt;359, -45&lt;-&gt;+45<br>			char			m_dataType;						// used to flag binary or ascii mode  (BINARY_MODE,ASCII_MODE)<br>			char			m_TransMode;					// used to flag Transfer type (CONTINOUS_SAMPLE_MODE, SAMPLE_UPON_REQUEST)<br>			char			m_version[30];					// HMD version number<br>			unsigned char	m_inBuffer[30];			// Data read from HMD<br>			BOOL			m_bPortInUse,					// True if Port is used<br>							m_bChecksum;					// True if chack sum enabled<br>		  	DCB			m_dcb;<br>			HANDLE		m_hCom, m_hConTemp;<br>			DWORD			m_numOfBytesRead;				// number of bytes read from HMD<br><br>	};<br><br>#endif		// nothing else after this line<br><br><br><br>-----AND the <br><br><br>// CyberTrak.h : main header file for the CYBERTRAK application<br>//<br>#include "MaxxCom.h"<br><br>#ifndef __AFXWIN_H__<br>	#error include 'stdafx.h' before including this file for PCH<br>#endif<br><br>#include "resource.h"		// main symbols<br><br>/////////////////////////////////////////////////////////////////////////////<br>// CCyberTrakApp:<br>// See CyberTrak.cpp for the implementation of this class<br>//<br><br>class CCyberTrakApp : public CWinApp<br>{<br>private:<br>	MaxxCom		maxxcom;<br>public:<br>	CCyberTrakApp();<br><br>// Overrides<br>	// ClassWizard generated virtual function overrides<br>	//{{AFX_VIRTUAL(CCyberTrakApp)<br>	public:<br>	virtual BOOL InitInstance();<br>	virtual int ExitInstance();<br>	//}}AFX_VIRTUAL<br><br>// Implementation<br><br>	//{{AFX_MSG(CCyberTrakApp)<br>		// NOTE - the ClassWizard will add and remove member functions here.<br>		//    DO NOT EDIT what you see in these blocks of generated code !<br>	//}}AFX_MSG<br>	DECLARE_MESSAGE_MAP()<br>};<br><br><br>/////////////////////////////////////////////////////////////////////////////<br><br>But there is no part to declare. <br><br></td></tr></table><br>
<a name="642975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd really like to help you here but it seems I don't really understand C++ (shame on me). All the functions are declared within a class, the MaxxCom Class. They are declared as public, which is good. But I don't know how to create an instance of MaxxCom() to be able to use the commands in blitz, and if this is required at all.<br><br>#define DllExport __declspec( dllexport )<br><br>class DllExport MaxxCom {<br><br>public:<br>MaxxCom();<br>~MaxxCom();<br>int AutoDetectComPort(void);<br>...<br>I also still don't see what MaxxCom() actually is, all I see is it's declared. It's not looking like a function declaration since there is not return type definition (even no void). I also wonder what's that ~ in "~MaxxCom();"<br><br>Sorry, cannot help you here. Somebody who's more familar with C++ is required. Maybe you need to ask in an other thread, eg. in "userlibs". <br><br></td></tr></table><br>
<a name="642982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, of course it is highly recommended to use a userlib instead of the old CallDLL command, but could you test this:<br><pre class=code>
b=CreateBank(1000)
c=CreateBank(1000)
CallDLL("maxxcom.dll","AutoDetectComPort",b,c)
Print PeekInt(c,0)
</pre><br>(save it as test_calldll.bb, maxxcom.dll must be in the same directory). I was able to run it without an error, whatever that means. Of course it returned zero because I ain't got the device. If it returns something other than zero on your machine, then there may be hope :) <br><br></td></tr></table><br>
<a name="643136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi JFK,<br>i ve tested it, but there is allways a 0 returned.<br>then i have changed the Dll to trak.dll and the same.<br>i have made some tests but that calldll won't return anything. <br><br></td></tr></table><br>
<a name="643723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MErren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, i cancel the way over DLL. It's to hard to get data from a extern DLL. Special thanx to JFK <br>The next Way is ro handel it over RS232, here is a system on start and i try to use it. I found in the Net the definition of the pack's and try now to read them out.<br>Just for Fun here ist the definition:<br><br>The CyberMaxx tracker interface, and a proposed extension<br><br>The CyberMaxx runs at 9600, 8 bit, no parity, 1 stop.<br><br>To reset the unit, send it an ascii 'R'; it should respond with a copyright<br>string.  By default the tracker sends data in ascii, so send it an 'F' to go<br>into binary mode.  By default it sends data continuously; if you want to poll<br>it, send it a 'G', then send an 'S' whenever you want to request a packet.<br><br>In binary, the packets consist of 8 bytes.  The first two are 0xFF (to mark<br>the start of the packet).  These are followed by 3 16-bit words (sent<br>high-byte first) giving the yaw, pitch and roll.  The top bit of each<br>16-bit word is zero, so they're really 15-bit words; the fact that the<br>top bit is zero means that you don't have to worry about two consecutive<br>0xFF's occurring in the data and looking like the start of a new packet.<br><br>The yaw is 0-360 degrees (i.e. 0 is zero, and 0x7FFF is 359.959 degrees).<br>The pitch and roll are from -45 degrees to +45 degrees (i.e. 0 is -45,<br>and 0x7FFF is +45).<br><br>That's it.  Pretty simple.<br><br>To summarize, the packet is:<br><br>           1111 1111   1111 1111      (16 bits of 1's)<br>           0yyy yyyy   yyyy yyyy      (15-bit yaw)<br>           0ppp pppp   pppp pppp      (15-bit pitch)<br>           0rrr rrrr   rrrr rrrr      (15-bit roll)<br><br>Software-wise, you send an 'R' followed by an 'F' to initialize the tracker<br>and put it into binary mode.  Your serial interrupt routine should check for <br>two consecutive 0xFF's; when it sees them, it should reset its buffer pointer<br>to zero.  After the number of bytes in the buffer hits 6, just pick up the<br>yaw/pitch/roll and convert.  *Really* simple stuff.<br><br>Here's what I propose to do to extend the packet format:<br><br>Add additional 16-bit words (with the top bit clear, for backwards<br>compatability).  In other words, after the "roll" value, just add<br>more data; old parsers will ignore everything up to the next<br>double 0xFF, and new parsers can use the additional data.  New parsers<br>should probably check the copyright message, to see if they've got an<br>old-format device (like the current CyberMaxx), in which case they read<br>only the yaw/pitch/roll.<br><br>The first additional word (after the roll value) would be:<br><br>           0knn nnnn   cccc cccc<br><br>where the 6-bit 'n' value is the number of 16-bit values that follow, and<br>the 8-bit 'c' value is a channel id (in case the serial devices are<br>daisy-chained).  The data for the additional channels would follow, 15<br>bits for each channel.  The first three should be reserved for position<br>information, the rest will be device-specific (e.g. finger flexion).<br><br>If the 'k' bit is set, the software should expect a 16-bit (really 15-bit)<br>checksum to follow the data; the checksum would be the unsigned sum of all<br>the data values (not including the 0xFF's). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
