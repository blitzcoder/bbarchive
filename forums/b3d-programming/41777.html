<!DOCTYPE html><html lang="en" ><head ><title >Object Problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Object Problem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Object Problem</a><br><br>
<a name="468884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been trying to use "Object" to sort things out, but it isn't working.<br><br>What I've done is I've made a function called "InitLevel." This functions sets up the level and has no errors. But when "InitLevel" calls the function "InitLevelGuns," I recive an error "Entity does not exist."<br><br>I know the problem, but I just don't know how to fix it because this is the first time I've ever needed to use "Object."<br><br>I named all my guns using "EntityName," but I don't know how to utilize this. Please help.<br><br>This is the "InitLevelGuns" function:<br><pre class=code>
Function InitLevelGuns()

	;pistol (gun1)
	pistol.weapon = New weapon
	;lazer (gun2)
	lazer.weapon = New weapon
	;dartgun (gun3)
	dartgun.weapon = New weapon
	;XM1014 (gun4)
	rifle.weapon = New weapon
	;HK-MP5
	mp5.weapon = New weapon
	;SAW
	saw.weapon = New weapon
	
	pistol\category = "C90-KL"
	pistol\index = 1
	pistol\offsetx = .60
	pistol\offsety = -.60
	pistol\offsetz = .9
	pistol\entityhandle = LoadMesh("weapons\pistol1\pistol1.x",camera)
	pistol\gotit = False
	pistol\ammo = 16
	pistol\rounds = 10
	pistol\damage = 7
	NameEntity pistol\entityhandle, "pistol"
	
	lazer\category = "LAS-74"
	lazer\index = 2
	lazer\offsetx = .95
	lazer\offsety = -.63
	lazer\offsetz = 1.3
	lazer\entityhandle = LoadMesh("weapons\lazer\lazer.3ds", camera)
	lazer\gotit = False
	lazer\ammo = 100
	lazer\rounds = 50
	lazer\damage = 10
	NameEntity lazer\entityhandle, "lazer"
	
	dartgun\category = "D4-S"dartgun\index = 3
	dartgun\offsetx = .8
	dartgun\offsety = .64
	dartgun\offsetz = 1.8
	dartgun\entityhandle = LoadMesh("weapons\dartgun\dartgun.x", camera)
	dartgun\gotit = False
	dartgun\ammo = 6
	dartgun\rounds = 5
	dartgun\damage = 7
	NameEntity dartgun\entityhandle, "dartgun"
	
	rifle\category = "Benneli XM1014"
	rifle\index = 4
	rifle\offsetx = .60
	rifle\offsety = -.4
	rifle\offsetz = .8
	rifle\entityhandle = LoadMesh("weapons\xm\w_xm1014.3ds", camera)
	rifle\gotit = False
	rifle\ammo = 12
	rifle\rounds = 16
	rifle\damage = 13
	NameEntity rifle\entityhandle, "rifle"
	
	mp5\category = "HK-MP5"
	mp5\index = 5
	mp5\offsetx = .6
	mp5\offsety = -.5
	mp5\offsetz = .6
	mp5\entityhandle = LoadMesh("weapons\raven\w_mp5.3ds", camera)
	mp5\gotit = False
	mp5\ammo = 80
	mp5\rounds = 12
	mp5\damage = 10
	NameEntity mp5\entityhandle, "MP5"
		
	saw\category = "SAW M-2492
	saw\index = 6
	saw\offsetx = .95
	saw\offsety = -.84
	saw\offsetz = 1
	saw\entityhandle = LoadMesh("weapons\saw\saw.3ds", camera)
	saw\gotit = False	
	saw\ammo = 80
	saw\rounds = 24
	saw\damage = 15
	NameEntity saw\entityhandle, "SAW"
	
	;setup
	ScaleEntity pistol\entityhandle, 1, 1, 1
	ScaleEntity lazer\entityhandle, .08, .08, .08
	ScaleEntity rifle\entityhandle, .027, .027, .027
	ScaleEntity mp5\entityhandle, .05, .05, .05
	ScaleEntity saw\entityhandle, .1, .1, .1
	
	TranslateEntity pistol\entityhandle, pistol\offsetx, pistol\offsety, pistol\offsetz
	TranslateEntity lazer\entityhandle, lazer\offsetx, lazer\offsety, lazer\offsetz
	TranslateEntity dartgun\entityhandle, dartgun\offsetx, dartgun\offsety, dartgun\offsetz
	TranslateEntity rifle\entityhandle, rifle\offsetx, rifle\offsety, rifle\offsetz
	TranslateEntity mp5\entityhandle, mp5\offsetx, mp5\offsety, mp5\offsetz
	TranslateEntity saw\entityhandle, saw\offsetx, saw\offsety, saw\offsetz
	
	RotateEntity rifle\entityhandle, 90, 90, 0
	RotateEntity mp5\entityhandle, 90, 90, 0
	RotateEntity saw\entityhandle, 90, 90, 0

	HideEntity rifle\entityhandle
	HideEntity dartgun\entityhandle
	HideEntity lazer\entityhandle
	HideEntity mp5\entityhandle
	HideEntity saw\entityhandle
	
	;hide weapons that we don't have yet
	For w.weapon = Each weapon
		
		If w\gotit = False
			HideEntity w\entityhandle
		EndIf	
	
	Next
	
End Function
</pre><br><br>Here is "UpdateGun," where the problem is:<br><pre class=code>
Function UpdateGun()
	
	If KeyHit(15)
		gun = gun + 1
		If gun &gt;= 7
			gun = 1
		EndIf
	EndIf
	
	If gun = 1
	;	If pistol\gotit = True
			HideEntity pistol\entityhandle ;&lt;--convert this to "Object"
			HideEntity rifle\entityhandle
			HideEntity mp5\entityhandle
			HideEntity dartgun\entityhandle
			HideEntity saw\entityhandle
			ShowEntity pistol\entityhandle
	;	EndIf
	ElseIf gun = 2
	;	If lazer\gotit = True
			HideEntity pistol\entityhandle
			HideEntity rifle\entityhandle
			HideEntity mp5\entityhandle
			HideEntity dartgun\entityhandle
			HideEntity saw\entityhandle
			ShowEntity lazer\entityhandle
	;	EndIf
	ElseIf gun = 3
	;	If dartgun\gotit = True
			HideEntity lazer\entityhandle
			HideEntity rifle\entityhandle
			HideEntity mp5\entityhandle
			HideEntity pistol\entityhandle
			HideEntity saw\entityhandle
			ShowEntity dartgun\entityhandle
	;	EndIf
	ElseIf gun = 4
	;	If rifle\gotit = True
			HideEntity lazer\entityhandle
			HideEntity pistol\entityhandle
			HideEntity mp5\entityhandle
			HideEntity dartgun\entityhandle
			HideEntity saw\entityhandle
			ShowEntity rifle\entityhandle
	;	EndIf
	ElseIf gun = 5
	;	If mp5\gotit = True 
			HideEntity lazer\entityhandle
			HideEntity rifle\entityhandle
			HideEntity pistol\entityhandle
			HideEntity dartgun\entityhandle
			HideEntity saw\entityhandle
			ShowEntity mp5\entityhandle
	;	EndIf
	ElseIf gun = 6
	;	If saw\gotit = True
			HideEntity lazer\entityhandle
			HideEntity rifle\entityhandle
			HideEntity pistol\entityhandle
			HideEntity dartgun\entityhandle
			HideEntity mp5\entityhandle
			ShowEntity saw\entityhandle
	;	EndIf
	EndIf
	
	;Shoot
	;-----
	If gun=1
	If ammo &gt;= 1
	If MouseHit(1)
		PlaySound shoot
		ammo = ammo - 1
		picked=CameraPick(camera, 400, 300)
		p.hole = New hole
		p\entityhandle = CopyEntity(bullethole)
		p\alpha = 0.9
		p\typething = "pistol"
		PositionEntity p\entityhandle, PickedX(), PickedY(), PickedZ()
		CreateSomeParticles(PickedX(), PickedY(), PickedZ(), 100, 100, 100, 6)
	EndIf
	EndIf
	EndIf
	
	If gun=2
	If ammo &gt;= 1
	If MouseHit(1)
		PlaySound shoot
		ammo = ammo - 1
		picked=CameraPick(camera, 400, 285)
		For i = 1 To 4
		l.laserhole = New laserhole
		l\entityhandle = CopyEntity(laserspark)
		l\alpha = 0.9
		l\typething = "laser"
		PositionEntity l\entityhandle, PickedX(), PickedY(), PickedZ()
		Next
	EndIf
	EndIf
	EndIf
	
	If gun=4
	If ammo &gt;= 1
	If MouseHit(1)
		PlaySound shoot
		ammo = ammo - 1
		For i = 1 To 5
			picked=CameraPick(camera, Rnd(390,410), Rnd(275, 295))
			s.hole = New hole
			s\entityhandle = CopyEntity(bullethole)
			s\alpha = 0.9
			s\typething = "shotgun"
			PositionEntity s\entityhandle, PickedX(), PickedY(), PickedZ()
			CreateSomeParticles(PickedX(), PickedY(), PickedZ(), 100, 100, 100, 6)
		Next
	EndIf
	EndIf
	EndIf
	
	If gun=5
	If ammo &gt;= 1
	If MouseDown(1)
	If MilliSecs() &gt; mp5timer + 160
		PlaySound shoot
		ammo = ammo - 1
		picked=CameraPick(camera, Rnd(390,410), Rnd(275, 295))
		m.hole = New hole
		m\entityhandle = CopyEntity(bullethole)
		m\alpha = 0.9
		m\typething = "mp5"
		PositionEntity m\entityhandle, PickedX(), PickedY(), PickedZ()
		CreateSomeParticles(PickedX(), PickedY(), PickedZ(), 100, 100, 100, 6)
		mp5timer = MilliSecs()
	EndIf 
	EndIf
	EndIf
	EndIf
	
	If gun=6
	If ammo &gt;= 1
	If MouseDown(1)
	If MilliSecs() &gt; sawtimer + 84
		PlaySound shoot
		ammo = ammo - 1
		picked=CameraPick(camera, Rnd(390,410), Rnd(275, 295))
		w.hole = New hole
		w\entityhandle = CopyEntity(bullethole)
		w\alpha = 0.9
		w\typething = "saw"
		PositionEntity w\entityhandle, PickedX(), PickedY(), PickedZ()
		CreateSomeParticles(PickedX(), PickedY(), PickedZ(), 100, 100, 100, 6)
		mp5timer = MilliSecs()
	EndIf 
	EndIf
	EndIf
	EndIf
	
	For b.hole = Each hole
		EntityAlpha b\entityhandle, b\alpha
		b\alpha = b\alpha-0.02
		If b\alpha &lt;= 0
		FreeEntity b\entityhandle
		Delete b
		EndIf
	Next
	
	For k.laserhole = Each laserhole
		EntityAlpha k\entityhandle, k\alpha
		k\alpha = k\alpha-.1
		If k\alpha &lt;= 0
		FreeEntity k\entityhandle
		Delete k
		EndIf
	Next 
	

End Function 
</pre><br><br>The problem is where you switch guns - where all the "HideEntity"'s and "ShowEntity"'s are.<br><br>I need to convert those Hide and ShowEntities to Object, but I don't know how.<br><br>(Sorry this is such a long post - I hope I've made it thorough enough :P) <br><br></td></tr></table><br>
<a name="468912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I DARE you to try and figure it out. <br><br></td></tr></table><br>
<a name="468994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, people - I really need this answer.<br><br>I can't move along until I have the answer.<br><br>Does ANYONE know what OBJECT does?!?!?!?! <br><br></td></tr></table><br>
<a name="469004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ethan3850</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Object?  You use Object() to convert a Handle(), errh.    The Handle() is an integer value that points to a Type structures' memory address and you use Object() to get the pointer back and access the Type structure - that probably doesn't make a lot of sense.<br><br>Your problem is that your loading a mesh that doesn't exist, or you've forget to Global one of the variables that points to your entity. <br><br></td></tr></table><br>
<a name="469006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ezbe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Get the handle of type:<br><pre class=code>
TypeHandle% = Handle(Type.Type)
</pre><br><br>Get the type by handle:<br><br><pre class=code>
Type.Type = Object.Type(TypeHandle%)
</pre><br><br>Someone gave a good tip using NameEntity with Handle(), when creating type which contains entity.<br><br>Simple example:<br><br><br><pre class=code>
;Create an enemy and return the type
Function CreateEnemy.Enemy(Mesh)
  E.Enemy = New Enemy
  E\Entity = CopyEntity(Mesh)
  NameEntity E\Entity, Handle(E.Enemy)
  Return Enemy.Enemy
</pre><br><br>Now, instead of looping through the whole typelist searching for a certain entity (like one which got collisioned with), you just get the typehandle from the entityname and use Object to get the type:<br><br><pre class=code>
;Find the enemy type with the entity
Function FindEnemy.Enemy(Ent%)
   Local TypeHandle% = EntityName(Ent%)
   Enemy.Enemy = Object.Enemy(TypeHandle%)
   If Enemy&lt;&gt;Null Return Enemy.Enemy   ;Or just Return Enemy.Enemy, remember to check for null-type
End Function
</pre> <br><br></td></tr></table><br>
<a name="469009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ethan3850</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might find this <a href="/posts.php?topic=36986" target="_blank">discussion</a> useful.  Ezbe's pretty much said what's there now though. <br><br></td></tr></table><br>
<a name="469011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rambus</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a few pointers,<br>Try using a select case structure rather then<br><br><pre class=code>
If gun = 1
end if
elseif gun = 2
end if
elseif gun = 3
end if</pre><br>vs<br><br><pre class=code>
select gun
	case 1
		break;
	Case 2
		Break;
End select</pre><br><br>Also; this might help make your code more readable.<br>Instead of...<br><br><pre class=code>
If gun=4
If ammo &gt;= 1
If MouseHit(1)</pre><br>do...<br><pre class=code>
If gun=4 and ammo &gt;=1 and mousehit(1)</pre><br><br>I doubt you wanted these pointers, but it's to late to take them back! <br><br></td></tr></table><br>
<a name="469048"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, don't you name an instance of a type (like when I did "NameEntity pistol\entityhandle, "pistol") and then call upon it later using Object? <br><br></td></tr></table><br>
<a name="469156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> And what about my original question - how would I modify my code to make it "work" <br><br></td></tr></table><br>
<a name="469350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Come on, guys, I really need you now. Please!<br><br>@G.0.D - why <i>wouldn't</i> I want the pointers? <br><br></td></tr></table><br>
<a name="469361"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sainfohi already stated what the problem is:<div class="quote">  <br>Your problem is that your loading a mesh that doesn't exist, or you've forget to Global one of the variables that pointers to yur entity.  <br></div><br><br>You stated:<br><div class="quote"> But when "InitLevel" calls the function "InitLevelGuns," I recive an error "Entity does not exist." <br> <br></div>Well, if that's your error message then one of your entities is not being created.  I don't see how this has anything to do with the Object command.<br><br>Do yourself a favor and use the Stop command (during Debug mode) and then step through your code line by line to see which entity doesn't exist.<br><br>Once you find out which one doesn't exist, then go back and figure out why. <br><br></td></tr></table><br>
<a name="469365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> By the way, you are giving your weapons ammo<br><pre class=code>
	rifle\ammo = 12
</pre><br>but you aren't even checking their respective ammo counters<br><pre class=code>
	If ammo &gt;= 1
	If MouseHit(1)
		PlaySound shoot
		ammo = ammo - 1
</pre><br>You need to check each ones individual counter<br><pre class=code>
	If rifle\ammo &gt;= 1
	If MouseHit(1)
		PlaySound shoot
		rifle\ammo = rifle\ammo - 1
</pre><br><br>unless your intent was to pass the rifle ammo count to the function in which case 'ammo' would have to be Global(I can't tell if it's global by the code you posted), or you would need a local 'ammo' variable like this:<br><pre class=code>Function UpdateGun(ammo)
  ;function code here
End Function</pre>and call it like this:<br><pre class=code>UpdateGun(rifle\ammo)</pre> <br><br></td></tr></table><br>
<a name="469389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeppe Nielsen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think, you need to make your pointers to the weapon-type variables global, put this in the top of your code:<br><br><pre class=code>
	Global pistol.weapon
	Global lazer.weapon
	Global dartgun.weapon
	Global rifle.weapon
	Global mp5.weapon
	Global saw.weapon
</pre> <br><br></td></tr></table><br>
<a name="469407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Let's try that! <br><br></td></tr></table><br>
<a name="469410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, WolRon - didn't catch that. <br><br></td></tr></table><br>
<a name="470188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jeppe - it worked! :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
