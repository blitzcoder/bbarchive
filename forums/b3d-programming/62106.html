<!DOCTYPE html><html lang="en" ><head ><title >How to only render part of a mesh</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to only render part of a mesh</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How to only render part of a mesh</a><br><br>
<a name="694189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rad Gravity</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone, just wondering if anyone knows of a way to render part of a mesh?  The reason being I need an entity to appear through a semi-transparent surface without being visible behind the surface, ala stargate etc.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="694190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could do a multi-pass render and switch off z-buffer clearing with CameraClsMode.  I've never done it and don't use Blitz3D any more so can't really offer an example I'm afraid, but I'm pretty sure it could be done in this way. <br><br></td></tr></table><br>
<a name="694191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alternatively, you could clip the mesh, using this code:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1143" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1143</a><br><br>However, this does not work with animated meshes! <br><br></td></tr></table><br>
<a name="694193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rad Gravity</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't fancy doing any multipass renders as framerate tends to suffer too much.<br><br>That code is exactly what I need, thanks big10p, it's a static mesh too so no probs there.  Guess I should have checked the archives first.. <br><br></td></tr></table><br>
<a name="694194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Don't fancy doing any multipass renders as framerate tends to suffer too much. <br></div>Shouldn't do - you're rendering the same amount of stuff, only you're doing it in two parts. <br><br></td></tr></table><br>
<a name="694201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rad Gravity</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Surely you have to do at least two renderworld() calls?  or am I barking up the wrong tree? <br><br></td></tr></table><br>
<a name="694223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Big10P i'm surprised you never linked to the z-clip code, it was you who created it originally wasn't it? :)<br><br>'Fraid I don't have the link here. <br><br></td></tr></table><br>
<a name="694229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Big10P i'm surprised you never linked to the z-clip code, it was you who created it originally wasn't it? :) <br></div>Er, I did! :) Or, are you talking about some other clipping code? <br><br></td></tr></table><br>
<a name="694584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barliesque</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought this new command would do something like that...<br><br><div class="quote"> Added MeshCullBox for manual mesh culling. This allows you to correct some situations where an<br>animated mesh extends beyond the guesstimated bounding box. <br></div><br><br>...maybe it wasn't intended for this purpose exactly, but could be used for the same result? <br><br></td></tr></table><br>
<a name="694588"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Barliesque: Nope, not at all...<br><br>Big10p,I was talking about the DirectX Clip Plane code :) <br><br></td></tr></table><br>
<a name="694590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Big10p,I was talking about the DirectX Clip Plane code :) <br></div>Ah, right. I didn't do that - I think it might have been Tom. Not sure. :) <br><br></td></tr></table><br>
<a name="694591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The include I have has your name on it... :S will source it out later. Maybe I'm getting confused :) <br><br></td></tr></table><br>
<a name="694623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rad Gravity</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's this about DX clip plane code??  sounds interesting. <br><br></td></tr></table><br>
<a name="694625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure what's happened there - I know nowt about DirectX and haven't written a dll in my life. :) <br><br></td></tr></table><br>
<a name="694636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rad, I will post a demo later. I beleive the main function behind it was written by Tom (That's a known fact as it uses DX7) however i was pretty certain the demo code I based my system off was by big10p lol. Apparently not :) <br><br></td></tr></table><br>
<a name="694649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, Tom wrote the clip-plane DX stuff, didn't he? I use it. It's very good.<br><br>The thread author wants a far-side clip, though, and you can do that in B3D without resorting to a dll: Use a black* plane** to clip the object in question; copy the scene to a masked buffer; re-render with the object in question hidden; composite the masked buffer back over the scene; flip.<br><br>EDIT:<br>Like-a-this...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800,600,0,2
SetBuffer BackBuffer()
cam=CreateCamera() : CameraClsColor cam,150,150,230 : CameraRange cam,.1,100


gateSurface=CreateSprite()
SpriteViewMode gateSurface,2
EntityAlpha gateSurface,.25
ScaleSprite gateSurface,2,2
Oval 0,0,64,64

If FileType("gateSurfaceImage.bmp")=0
	gateSurfaceImage=CreateImage(64,64)
	CopyRect 0,0,64,64,0,0,BackBuffer(),ImageBuffer(gateSurfaceImage)
	SaveBuffer (ImageBuffer(gateSurfaceImage),"gateSurfaceImage.bmp")
	FreeImage gateSurfaceImage
EndIf

If FileType("gateSurfaceImage.bmp")=2
	RuntimeError "Expected file but found directory :/"
Else 
	gateSurfaceTex=LoadTexture("gateSurfaceImage.bmp",4)
	SetBuffer TextureBuffer(gateSurfaceTex)
	EntityTexture gateSurface,gateSurfaceTex
EndIf


groundPlane=CreatePlane()
PositionEntity groundPlane,0,-4,0
SetBuffer BackBuffer()
Color 200,200,100
Rect 0,0,64,64,True
Color 100,100,50
For i=0 To 255
	Plot Rand(0,63),Rand(0,63)
Next
groundPlaneTex=CreateTexture(64,64)
ScaleTexture groundPlaneTex,2,2
CopyRect 0,0,64,64,0,0,BackBuffer(),TextureBuffer(groundPlaneTex)
EntityTexture groundPlane,groundPlaneTex

farClipPlane=CreatePlane()
EntityFX farClipPlane,1
EntityColor farClipPlane,0,0,0
RotateEntity farClipPlane,-90,0,0

traveller=CreateCube()
ScaleEntity traveller,1,1,10
Color 255,255,255
Rect 0,0,64,64
Color 0,0,0
Line 0,0,63,0
Line 0,0,0,63
travellerTex=CreateTexture(64,64)
CopyRect 0,0,64,64,0,0,BackBuffer(),TextureBuffer(travellerTex)
EntityTexture traveller,travellerTex
ScaleTexture travellerTex,.01,.2
PositionEntity traveller,0,0,20

clippedBuffer=CreateImage(800,600)

While Not KeyHit(1)
camX=camX+1
PositionEntity cam,Cos(camX)*4,1.5,-10
PointEntity cam,gateSurface

MoveEntity traveller,0,0,-.1
If EntityZ(traveller)&lt;-20 Then PositionEntity traveller,0,0,20

;RENDERING
;1: create clipped object pic
;(a) Hide all but clip-plane and object to be clipped
HideEntity groundPlane
HideEntity gateSurface
ShowEntity traveller
ShowEntity farClipPlane

;(b) Render and copy
RenderWorld
CopyRect 0,0,800,600,0,0,BackBuffer(),ImageBuffer(clippedBuffer)

;2: Create final scene ready for compositing
; Show all regular scene items and hide clip-plane and object to be clipped
ShowEntity groundPlane
ShowEntity gateSurface
HideEntity traveller
HideEntity farClipPlane
RenderWorld

;3: Composite final image and show it
DrawImage clippedBuffer,0,0
Flip


Wend
</textarea><br><br><br>*or whatever mask colour you prefer.<br><br>**entityFX 1, mind. <br><br></td></tr></table><br>
<a name="694717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rad Gravity</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't worry big10, your code archive does the job nicely anyway!  I do like the idea of accessing dx more directly where it's appropriate though.  <br><br>Cygnus, I'd be interested to see that demo.<br><br>Sledge, good to know there's more than one way to skin the cat as it were. <br><br></td></tr></table><br>
<a name="694741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> my little tech demo here demonstrates how to use Tom's DX7 code to split a mesh at rendertime.<br><br>There's an include in there that you can use, at the moment it's got a credit to Big10p as his name was in the original one I modified lol... not sure how all that happened :)<br><br><a href="http://damientsturdy.pwp.blueyonder.co.uk/Craft.zip" target="_blank">http://damientsturdy.pwp.blueyonder.co.uk/Craft.zip</a><br><br>note: Copy the decls file to the blitz Decls folder for it to work. Also, It may have problems with Tom's latest DX7 dll. <br><br></td></tr></table><br>
<a name="694764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can modify the mesh too. if not removing vertex one can just adjust em.. dont ask me how i never done it. <br><br></td></tr></table><br>
<a name="695410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rad Gravity</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the demo cygnus, I may have to use this technique as, unfortunately, big10's algo works really well but is a little too resource intensive for my game (85fps drops to 40fps when using it). <br><br></td></tr></table><br>
<a name="695474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> No prob. Thanks Tom and &lt;unanimous&gt; for the above :) (Will &lt;Unanimous&gt; come forward i wonder? :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
