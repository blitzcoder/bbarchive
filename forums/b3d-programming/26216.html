<!DOCTYPE html><html lang="en" ><head ><title >1.85 release: halo's conclusion</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >1.85 release: halo's conclusion</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >1.85 release: halo's conclusion</a><br><br>
<a name="272654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitz3D rules.  Here's a function to save an environment map.  They look really cool.<br><br><img src="http://www.leadwerks.com/spec.jpg"><br><br><pre class=code>
Function SaveEnvMap(file$,x#=0,y#=0,z#=0,size=256)
camera=CreateCamera()
PositionEntity camera,x,y,z
CameraViewport camera,0,0,size,size
i=CreateImage(size*6,size)
RotateEntity camera,0,90,0 
RenderWorld 
CopyRect 0,0,size,size,size*0,0,BackBuffer(),ImageBuffer(i)
RotateEntity camera,0,0,0 
RenderWorld 
CopyRect 0,0,size,size,size*1,0,BackBuffer(),ImageBuffer(i)
RotateEntity camera,0,-90,0 
RenderWorld 
CopyRect 0,0,size,size,size*2,0,BackBuffer(),ImageBuffer(i)
RotateEntity camera,0,180,0 
RenderWorld 
CopyRect 0,0,size,size,size*3,0,BackBuffer(),ImageBuffer(i)
RotateEntity camera,-90,0,0 
RenderWorld 
CopyRect 0,0,size,size,size*4,0,BackBuffer(),ImageBuffer(i)
RotateEntity camera,90,0,0 
RenderWorld 
CopyRect 0,0,size,size,size*5,0,BackBuffer(),ImageBuffer(i)
SaveBuffer ImageBuffer(i),file
FreeImage i
FreeEntity camera
End Function 
</pre> <br><br></td></tr></table><br>
<a name="272657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks dude! <br><br></td></tr></table><br>
<a name="272658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one, famous stone with ring of light aound him (the coder formerly known as Halo).<br><br>IPete2. <br><br></td></tr></table><br>
<a name="272687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree completely. 1.85 rocks! Cube mapping is completely awesome, and allows you to create awesome reflection and water effects, and the new GetSurfaceBrush() and that commands have made my life a lot easier. TextureName$() rocks!!! <br><br></td></tr></table><br>
<a name="272688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a very handy Function. Good work. You should put it in the code archives. <br><br></td></tr></table><br>
<a name="272726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, this is handy - I was going to do something like this myself, but now there is no need. Thanks! :) <br><br></td></tr></table><br>
<a name="272781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SopiSoft</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah !!!! this totally rox!!! thnx!!! <br><br></td></tr></table><br>
<a name="272839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um, it does rule -- however, can someone please demonstrate with code HOW to do nice water reflections?? All of my attempts do not look right. <br><br></td></tr></table><br>
<a name="272845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob is working on his source code right now i believe. He said he'd release it :) <br><br></td></tr></table><br>
<a name="272871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> For water, I would think that rendering with Halo's setup, with the water hidden, and the camera in the center of the pool, at water level, would work.  Have you tried that?  If so post the code and maybe we can fix it. <br><br></td></tr></table><br>
<a name="272915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, check out the file www.adgames.biz/test.zip<br><br>Basically I've hacked up the code from the docs, commented out the dynamic cube map stuff and used a cube map generated from Halo's function. I get the same behavior both ways though -- the reflection looks incorrect when you start moving the POV camera around. Sorry for the messy hacked up code. I'm wondering if to correct this you have to match the cube map cameras' orientation to that of the POV camera. I tried it but ran into more troubles due to my lack of expertise.<br><br>Whups! The download above has a cube map that was created without the water hidden but it won't make a difference with the problem I'm having. <br><br></td></tr></table><br>
<a name="272919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> water hidden, and the camera in the center of the pool, at water level, would work <br></div><br><br>Yup, that's the correct way to do it... but making the water move realistically is somewhat bigger problem I think. <br><br></td></tr></table><br>
<a name="272923"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> wma:<br>Your demo doesn't work.  I see a couple trees and some ground and a sky, but no water or anyhting else cubic mapped. <br><br></td></tr></table><br>
<a name="272925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> wma:<br>Okay I got your demo to work by uncommenting the commented out stuff but I'm not sure how to go about fixing it.<br><br>I tried a few different cube modes... It seems like there are four or five different modes I think.  Anyhow, none of them gave the desired effect.<br><br>I think maybe you're going to have to render the cubemap from different points of view as the camera moves about.  Which you'd have to do anyway if you want dynamic objects like players and monsters to also be reflected in the water. <br><br></td></tr></table><br>
<a name="272949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can someone clarify for a thicky?<br>I can't see the point of this. Wma's test is nice, but when you move the camera the tree reflections quickly end up in the wrong place. Sswift, is this what you mean about having to recalc the pos of the camera constantly?<br>Also, sorry to be a pain, but what IS environment mapping?<br>What has Rockstar achieved here? What is the point of this code? Thanks. <br><br></td></tr></table><br>
<a name="272971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> John:<br>Yes, what you are seeing is the problem.<br><br>"Environment mapping" is many things.  It can be cubic or spherical.<br><br>What we're trying to do here is get cubic environment maps to work.<br><br>How those work is you have a texture which has six faces of a cube laid out in it, and then these are projected onto the side of the object you apply the map to.  In one of the modes anyways.  This for example gives the appearance that the object is reflecting the image on the right side of the cube map, which ideally is showing what is to the right side of the object in the world.<br><br>See Halo's image above?  That's a cube map, though laid out differently than it is internally.<br><br>That is created by sticking a camera at some point in the world and rendering six 90 degree FOV square camera views pointing in six different directions. <br><br></td></tr></table><br>
<a name="273012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> What if we try to match the cube map cameras' orientation to that of the POV camera, but make its pitch opposite of the POV camera -- will that work? <br><br></td></tr></table><br>
<a name="273053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know.  Try it. :-) <br><br></td></tr></table><br>
<a name="273126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wmaass</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tried it. Either I didn't do it right or its just a plain bad idea cause its still not correct. Anyhow, just for yucks, add the line below into the main loop and comment out the scaleentity command for the teapot -- the texture warping actually makes for semi convincing poor mans water motion. If only the relfection were correct I'd be happy.<br><br>TurnEntity teapot,0,1,0 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
