<!DOCTYPE html><html lang="en" ><head ><title >Incorrect Lighting on Simple Entity</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Incorrect Lighting on Simple Entity</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Incorrect Lighting on Simple Entity</a><br><br>
<a name="282120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a small problem with a transparent textured entity:<br>Example 1: Trees I made with leaf surfaces where TextureFilters "leaves",4 does what it should, and all black pixels are transparent. Hurrah!<br>Example 2: Fences I made with fence textures where TextureFilters "fence",4 does what it should, and all black pixels are transparent. Hurrah!<br>BUT - <br>the lighting (ambient or direct) looks all wrong on the fences! <br>The fences stay very bright (unlike the trees) even when the ambient and direct lights are taken down.<br>The only clue that I can think of is that the fence is the only entity I have which is just a plane (two triangles) with the texture mapped on. <br>The effect is that it looks as if the upper-left and lower-right vertices react correcty to light, but the lower-left and upper-right vertices don't react at all!<br>Anyone got any ideas, or seen this effect before? <br><br></td></tr></table><br>
<a name="282124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to make sure the normals for the vertices are setup correctly.  This might require you to actually make more vertices if you want the fence to be double sided. <br><br></td></tr></table><br>
<a name="282126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, the fence is double-sided. Sorry, can you explain what you mean about normals? I've created plenty of models which react perfectly to light (God, do I realy have 82 entities...!) but none which have just one surface of two triangles, so is this the problem? <br><br></td></tr></table><br>
<a name="282130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your lighting on the triangles is calculated according to the direction of the vertex normals.  If the normals face the wrong way (as they will do for the reverse side of any double sided mesh) then the lighting will be wrong (often dark).<br><br>It's hard to explain it all without pictures, but imagine the Pinhead guy from Hellraiser (movie) the pins represent the normals for his head. :) <br><br></td></tr></table><br>
<a name="282132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try using UpdateNormals() on the mesh. <br><br></td></tr></table><br>
<a name="282135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope. No difference I'm afraid.<br>Imagine the rectangle made of two triangle like so: [/]<br>The top-left and bottom-right vertices react correctly to light.<br>The bottom-left and top-right vertices stay full-bright all the time.<br>(BTW, how do you include images in this forum?) <br><br></td></tr></table><br>
<a name="282153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strange problem.<br><br>To include an image, first you have to host it on a website. then simply write a link to the image, like<br><br>www.domain.com/image <br><br></td></tr></table><br>
<a name="282158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It sounds like your fence is made of 4 triangles, unless the two sides are separate surfaces Blitz will mess up the normals.<br><br>I suggest modelling just one side of the fence with two triangles and use EntityFX fence,16 to make it double sided.<br><br>If this doesn't make sense can you detail how you are creating the mesh, in a modelling program or using CreateSurface? <br><br></td></tr></table><br>
<a name="282231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >iret</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've discovered this problem last year and posted some screenshots in the bugs forum. A lot of answers, even by Mark himself, but no solutions :-(<br><br>It only happens when you load a mesh, when you use CreateCube it will work correctly (maybe because a single side isn't build of two triangles?).<br><br>Can someone tell how to fix this problem by correcting the normals or whatever? Would be really great!<br><br>Btw, unfortunately I cannot find the old thread, seems to be archived elsewhere. <br><br></td></tr></table><br>
<a name="282242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sweenie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well a blitzcube has 24 vertices and 12 triangles.<br>I believe every triangle in a blitzcube has one "private vertex" and shares it's other two vertices with the triangle lying on the same plane.<br><br>However, a cube made in for example 3DS Max, usually have 8 vertices, therefor each vertexnormal will be averaged using the normals of all the triangles it belong to and the lightning will look like crap.<br><br>I don't remember if you can "tell" 3d studio to let every face has it's own vertices or not. <br><br></td></tr></table><br>
<a name="282478"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @bot builder: Thanks. Doh!<br>@skidracer: EntityFx ,16 seems to try to present both faces simultaneously to the camera. Lots of stripey bitmap!<br>@iret: 'A lot of answers, even by Mark himself, but no solutions' kinda says it all.<br>@Sweenie: I use Metasequoia, but export as .X so the modeller as such doesn't matter.<br><br>I've ended up modeling a very thin cube and retextured. It's ok. Thanks to you all for putting your minds to this.<br>It's great to get so much constructive feedback on a problem. Still, it would be nice to find another solution (every fence now has 6 faces, not 2). <br><br></td></tr></table><br>
<a name="282487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> EntityFx ,16 seems to try to present both faces simultaneously to the camera. Lots of stripey bitmap! <br></div><br>It sounds like you are still exporting as a double sided plane. <br><br></td></tr></table><br>
<a name="282496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I see your point.<br>Yes, I'll try that. Thanks. <br><br></td></tr></table><br>
<a name="282505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> couldn't you do it so that there are 8 vertices, 4 tiangles??? twice as many vertices sure, but you have the same number of faces. <br><br></td></tr></table><br>
<a name="283223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @skidracer:<br>A single one-sided plane (2 triangles) works as you say if you use EntityFX ,16 - visually its ok, but, hardly a surprise, you can walk through it from the other side. Not important in some cases, but for a fence....<br>Anyway, I modelled a thin cube then deleted the sides, top and bottom faces. Now it works fine, and only uses 2 faces.<br>Thanks to you all for spending time on getting to the bottom of this problem. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
