<!DOCTYPE html><html lang="en" ><head ><title >two really big problems with decals</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >two really big problems with decals</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >two really big problems with decals</a><br><br>
<a name="375455"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eizdealer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>First of all, it's hard to express such complicated stuff like I am about to do. Especially if you do it in a foreign language. So please let me know if you don't get my problems or if there are any other inaccuracies in my description.<br><br>I'm working on a mesh terrain engine, right now I'm at the decal code. Decals are supposed to be 2d textures that are put on the terrain and fit the terrain's shape.<br>The terrain consists of tiles that are each .5 x .5 blitz units large. All vertex points' heights can be changed.<br>As I wrote before the decals should fit the shape of the terrain. In order to assure this everywhere where<br><br>a) the decal is on a crosspoint of the tiles<br>b) the connections of the edges of the decal overlap a terrain's line<br><br>must be a vertex point of the decal. Yes I know, noone knows what I'm talking about right now. But please have a closer look at the graphic and think a bit about it:<br><br><img src="http://home.arcor.de/madone/decal.gif"><br><br>(the green thingy is the decal, the red circles mark cutting points)<br><br>If I had a plane instead of this and the terrain mesh would be a little higher at this point, the decal would not be visible at all.<br><br>So I'm getting to my first problem at least ;)<br><br>How would you try to get the cutting points described in b) ? I've got the ones described in a). Hint: The coordinates of the 4 edges are given.<br><br><br>Now for my second problem:<br><br>Let's say all the cutpoints are given. I first thought to connect the edges of the decal with 2 triangles, then go for each cutpoint, clip the triangle it is in and create three new triangles so that the cutting point would be a 'real' vertex point of the decal.<br><br>This was the result (wframe):<br><br><img src="http://home.arcor.de/madone/decal2.gif"><br>(note that the only the cutting points described in a) as well as the edges are in this screen)<br><br>Looks OK at first. But imagine if you lifted some of the terrain points - exactly, the terrain would be over the the decal again. Why? Because the grey lines (decal) overlap the brown lines (terrain). This is a result of the rather random clipped triangles. How to fix that? Well, I thought about the same procedure I've just described but for each single tile.<br><br>Now we've got a new situation:<br><br><img src="http://home.arcor.de/madone/decal3.gif"><br><br>Given are the cutpoints of this single tile. But how do I know how to add the tiles without adding too many but still covering the whole area restricted by the cutpoints? This is easy of course with three or four cutpoints. But with a bit of luck I will have to do this with up to 8 of them.<br><br><br><br><br>Now that you're completely confused 8) I want to thank you just for reading till the end. I would very very much appreciate if you told me whether you have understood the text or not. And it would be absolutely perfet if you had any ideas for solutions of the problems. <br><br></td></tr></table><br>
<a name="375468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why bother with all thatr slicing?  Just use texture clamping and apply the texture to the whole terrain, or just to the triangles it affects? <br><br></td></tr></table><br>
<a name="375471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eizdealer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The important thing for the decals is that you can't only have rectangles but also quadrangels (i need that for another function).<br>The whole terrain is much to big to apply a single decal texture on it. And it should be possible to have transparent decals. So you can't put the texture on the triangles it affects because you wouldn't be able to see the textures that are under the decal. <br><br></td></tr></table><br>
<a name="375476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I assume this decal is a blast mark or something with transparency around the edges?<br><br>Just lock clamp the texture and create a mesh using only those triangles that get affected:<br><br><img src="http://www.leadwerks.com/post/Image2.jpg"><br><br>If you just make sure the edges are transparent, the areas of triangle that go way beyond what you actually want will be invisible.  The real deal will look like this:<br><br><img src="http://www.leadwerks.com/post/Image3.jpg"> <br><br></td></tr></table><br>
<a name="375482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eizdealer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is another possibility I have thought about, too. But if you do it this way, you will always have to use textures which are transparant at the edges (what I do not want).<br>Thanks very much though! <br><br></td></tr></table><br>
<a name="375485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1. When you load your decal, enable UV clamping.  Make sure the edges of the decal are transparent if you are using a decal with an alpha map, or black, if you are using a decal you want to multiply with what is behind it.<br><br>2. For each triangle that falls within the decal, copy that triangle to a new mesh or a new surface within your terrain mesh.<br><br>3. Set the texture coordinates for the triangle.  If the trangle falls partially outside your decal region, then your coordinates might be less than 0, or greater than 1.  Pretend that the decal tiles.<br><br><br>The UV clamping ensures that the decal will NOT actually appear to tile.  And if you have a lot of small triangles in your terrain, then it won't really matter if you have a little extra area being textured with an invisible texture.<br><br><br>Where you really need to worry about clipping the triangles so they fit the region exactly is when you have a large flat wall in a first person shooter and you want to put a scorche mark or shadow on that.  Then you'll get a lot of overdraw form the extra invisible areas, and you don't want that.  <br><br>I made a clipping system which can handle clipping polygons so you can do very precise decals with no overlapping stuff.  It's free, and you may request it from me via email, but it's very advanced.  If you don't know what a plane equation is, then you might not be able to figure it out.  I don't want to be proividing lots of support to everyone, but I will answer a question or two.  It's a real nice system though.<br><br>[edit]<br>I see you know aobut that UV clamping method...  Well, you're free to use my lib if you want.  It does "sutherland-hodgeman clipping".  It is the fastest clipping algorithm out there and very robust.  It'll do what you want if you can figure out how to set up the clipping planes.  I'll step you though the basics if you need me to.<br>[/edit]<br><br>[edit2]<br>Oh and btw... The system will automatically build your new polygons for you, and set the UV coordinates as needed based on the originals.<br>And you could use a decal of any shape with any number of sides.<br>[/edit] <br><br></td></tr></table><br>
<a name="375490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eizdealer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now this is an interesting idea sswift, thanks a lot for it!<br><br>Did I get that right - when you have the clamping flag turned on the tris where the u/v coordinates are not between 0 and 1 will be transparent?<br>But the edges of the texture have to be transparent, don't they?<br><br>Edit: It would be very very nice if you could give me the lib you mentioned. I'd say I have a look at it til tomorrow (since it's already late here) and contact you if I need any help.<br>Thanks very very much again, I already thought I'm lost :)<br><br>My mail is eizdealer (a t) web .de <br><br></td></tr></table><br>
<a name="375494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Did I get that right - when you have the clamping flag turned on the tris where the u/v coordinates are not between 0 and 1 will be transparent?"<br><br>Yes.  The edges have to be transparent.  That was what Halo was trying to describe to you.<br><br>When UV clamping isturned on, anything on a texture outside 0..1 will use a color which has been pulled from the edge of the texture.<br><br>If you looked at a texture like this in the middle of a polygon, then you'd see the edge pixel colors stretched vertically and horizontally to infinity.<br><br>You can also position the texture so that instead of the texture being at 0..1, it might be at 2..3.  You can scale it too. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
