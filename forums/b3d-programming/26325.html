<!DOCTYPE html><html lang="en" ><head ><title >hugging models</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >hugging models</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >hugging models</a><br><br>
<a name="273803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do you determine if a vertex of facing up down left or right? is this possible?  I am trying to drop a model onto a mesh terrain and have it deform to the countour of the terrain.  Easy to do if you want to deform all points and flatten the model but I want to deform only the bottom of the model, and then sink the top of the model a bit to match the original thickness of the model and the countour of the mesh terrain. I want to drop crops and foilage onto my mesh terrain and I do not want to be limited to flat areas.   Can anyone help?<br><br>Thanks. <br><br></td></tr></table><br>
<a name="273896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try getting the normals of the triangles. That might be what your after. <br><br></td></tr></table><br>
<a name="274097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know at least 5 ppl here that could solve this in 20 minutes or less.. Any help would be greatly appreciated. Code would be very very appreciated, but gerneral how to go about it info would be much appreciated too. <br><br></td></tr></table><br>
<a name="274133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Damn... From reading the topic, I was expecting something entirely different... I do enjoy hugging models, on the odd occasion when I get the chance :)<br><br>Andy <br><br></td></tr></table><br>
<a name="275039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Damn... From reading the topic, I was expecting something entirely different<br> <br></div><br><br>Tell me about it! <br><br></td></tr></table><br>
<a name="275192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> LOL<br><br>Generaly speaking, a vertex could be said to be facing a particular axis/direction if the absolute value of one of the elements x,y or z is greater than the rest.<br><br><pre class=code>
x#=VertexNX#(surface,vertindex)
y#=VertexNY#(surface,vertindex)
z#=VertexNZ#(surface,vertindex)

; check if x axis is dominant
if (Abs(x) &gt;= Abs(y)) and (Abs(x) &gt;= Abs(z))
  ; vertex is mostly facing X axis
  if x &gt; 0
    ; vertex if facing +X
  else
    ; vertex is facing -X
  end if
else ... check if y is dominant..then Z
</pre><br><br><br>"I want to drop crops and foilage onto my mesh terrain and I do not want to be limited to flat areas. Can anyone help?"<br><br>If they're meshes/sprites, why not align them to the terrain using AlignToVector() ?<br><br>Tom <br><br></td></tr></table><br>
<a name="275201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> First let me apologize for my message title.  LOL.  <br><br>Tom, align to vector wont really hug the surface of my mesh terrain properly, and it wont sink the top of the model down to match the countour and original width of the crop mesh.  Unless I am missing somthing. <br><br>Thanks <br><br></td></tr></table><br>
<a name="275204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you can find any of Robs flex shadows, i believe that does it. It creates a mesh, and basically wraps it around the scenary. I think he creates a mesh, line picks straight down from each vertex on the mesh, and finds the height of nearest vertex, then sets the vertex height to that. <br><br></td></tr></table><br>
<a name="275221"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got it.  I just modified the original flex code.  Thanks to all that responded. This works with models that are square or rectangular.  You will get undesired effects with complex models unless you modify the vertex check to include some instuction of mid range vertecis.  <br><br><pre class=code>
Function UpdateFlex(flexmesh)
    w#=MeshHeight(flexmesh)
	xs#=EntityX(flexmesh):ys#=EntityY(flexmesh):zs#=EntityZ(flexmesh)
	
	;move model To 0,0,0
	PositionMesh flexmesh,0,0,0
	
	;here we just see wich vertices are below 0(top of model) and wich
	;are above 0 (bottom of model)
	s=GetSurface(flexmesh,1)
 	For i=0 To CountVertices(s)-1
            	vx#=VertexX(s,i)
		        vy#=VertexY(s,i)
	        	vz#=VertexZ(s,i)
	    		TFormPoint vx,vy,vz,flexmesh,0
    vy#=TFormedY()
    If vy#&lt;0 Then sorter(i)=1 Else sorter(i)=2 
    Next 
    ;put model in its original position again
    PositionMesh flexmesh,xs,ys,zs

    ;original flex code
	For i=0 To CountVertices(s)-1

		vx#=VertexX(s,i)
		vy#=VertexY(s,i)
		vz#=VertexZ(s,i)
	
	
		TFormPoint vx,vy,vz,flexmesh,0
		vx=TFormedX() : vy=TFormedY() : vz=TFormedZ()
		
		LinePick vx,vy,vz,vx,vy-9000,vz
		vy=PickedY()-.1
		
		TFormPoint vx,vy,vz,0,flexmesh
		vx=TFormedX() : vy=TFormedY() : vz=TFormedZ()
		

        ;we put bottom vertices on ground 
        If sorter(i)=1 Then  		
		VertexCoords s,i,vx,vy,vz
        Else
        ;and just sink the top vertices by original mesh height 
		VertexCoords s,i,vx,vy+w#,vz
        EndIf  
	Next
    ;since mesh is origin is 0,0,0 lets move it 
    ; back up by half its height
	TranslateEntity flexmesh,0,(w#/1.25),0
End Function
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
