<!DOCTYPE html><html lang="en" ><head ><title >PureBasic DLL Usage</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >PureBasic DLL Usage</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >PureBasic DLL Usage</a><br><br>
<a name="386285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robin Hossain</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've created various DLLs in PureBasic to be used by Blitz3D.  Unfortunately, Blitz3D seems to become unstable when using these DLLs.<br><br>I'm using the latest 1.87 B3D update and PureBasic 3.90.<br><br>The types of problems I am having are:<br><br>1. Sometimes - for no reason, Blitz3D will claim 'UserLibs not found' - but if I cut and paste the same code in a new file - it will work. This problem occurs on two PCs I have tested this with.<br><br>2. Calling the DLL will sometimes caused a 'Memory Access Violation Error' also - about 1 in 500 times the DLL is called.<br><br>3. Calling the DLL without opening a screen buffer (e.g. Graphics3D 640,480,16,2) will reduce the likelihood of a 'Memory Access Violation' when calling a DLL.<br><br>4. The type of code in the DLL built in PureBasic accesses the Serial COM ports (via MVCOM) and also allocates memory (RAM).<br><br>5 The same scenario occurs on Win XP Home as well as Win 98 SE.<br><br><br>Does anyone else have the same problems ? <br>Is there some incompatibility with Blitz3D and PureBasic DLLs ? <br><br></td></tr></table><br>
<a name="386637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MRaven</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using some Pure Basic DLLs and only get an error if there is something wrong either in the pure or blitz code. I'm using Win XP Home and the newest versions of both languages too <br><br></td></tr></table><br>
<a name="386857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skitchy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you're peeking and poking memory then you need to be careful. Sounds like you might be changing internals used by either Blitz or Pure, and they're getting confused :) <br><br></td></tr></table><br>
<a name="387268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robin Hossain</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems like the MVCOM serial port library maybe messing with memory when closing a port.  This seems to cause Blitz to lose it...<br><br>MRRaven - if your using PB - could you do a simple test that opens a port from Blitz using a PB dll via MVCOM, and another call to close the same port from Blitz.  e.g.<br><br>PB Code: (compile as PBTest.dll)<br><br>ProcedureCDLL OpenPort(PortDef.s)<br>HCom.l = ComOpen(PortDef,0,1024,1024)<br>ProcedureReturn HCom<br>Endprocedure<br><br>ProcedureCDLL ClosePort(PortID.l)<br>ComClose (PortID)<br>ProcedureReturn 1<br>EndProcedure<br><br>Blitz Decls<br><br>.lib "PBTest.dll"<br><br>OpenPort%(PortID$)<br>ClosePort%(PortID%)<br><br><br>Blitz Code<br><br>PortID=OpenPort("COM2:4800,N,8,1")<br>Delay(1000)<br>ClosePort(HCom)<br><br><br>The 'ClosePort' command will always generate a memory access violation error for me.<br><br>Even if HCom is a Global in PB. <br><br></td></tr></table><br>
<a name="426966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mike0101</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why better a purebasic dll in Blitz3D like a Blitz function?<br>Is this fastest? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
