<!DOCTYPE html><html lang="en" ><head ><title >LinePick - possible speedup?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >LinePick - possible speedup?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >LinePick - possible speedup?</a><br><br>
<a name="435460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skitchy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> In fact this *may* apply to any Pick command on a polygon-enabled mesh.<br>Will chopping a level into sections (different meshes) increase pick speed? It seems that Blitz has to loop through all polys in a picked mesh every time in order to find the relevant tri/normals etc. Therefore (in theory) having more meshes with smaller polycounts instead of 1 big one would give a boost???<br>Of course the balance is between more surfaces vs. pick speedup, and I don't know where the scale tips. If you've got a lot of picks going on it may be worth it though.<br><br>Or am I talking nonsense? <br><br></td></tr></table><br>
<a name="435483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think sswifts shadow system works alot better if the levels are segmented, rather than the one chunk. But, that may have something to do with only visible meshes being checked, i'm not sure... <br><br></td></tr></table><br>
<a name="435492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes.  I actually store one merged copy of the map for rendering, and a separated copy for collision. <br><br></td></tr></table><br>
<a name="435501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skitchy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh yeah, that's a good idea Halo. 1 visible mesh and multiple segments with 0 alpha. Best of both worlds - same surface count + faster picks. Nice. <br><br></td></tr></table><br>
<a name="435503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Assuming that when you do a line pick, Blitz first checks the bounding spheres to see if the line pikc intersects them, then yes, it would speed things up.<br><br>That said, Blitz apparently does not do things in the most optimal way all the time.  For example, hiding entities outside the view of the camera manually is faster than just leaving them visible, even when no collisions are enabled.  This appears to indicate that Blitz doesn't even do basic sphere-frustrum tests before it tries to render the world.<br><br>So it is entirely possible that linepick also does not do such a test.  In which case, you could speed it up by writing a function to determine if a line intersects a sphere, and doing your own culling that way.  I think someone put a function I wrote for them that does line-sphere or maybe it was ray-sphere intersection in the code archives.<br><br>The only way to know unfortunately is to code a test program to see if checking manually is faster than letting bLitz just do it's thing.<br><br>Also, spheres are not the only way to cull secitons of level.  If your level is static it would be possible to build a BSP tree.  A BSP tree might help you do linepicks much faster, though I don't know how. <br><br></td></tr></table><br>
<a name="435649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> For meshes, use a bounding box around the mesh and test each mesh one at a time.  If an EntityVisible() command returns true when the bounding box is visible, you don't even have to test the mesh itself.<br><br>This is how I can put lots of flares in a 15,000 poly room, with picking every render in like 0-1 msecs.  It usually does about 60 box tests, and then maybe like 3 mesh tests out of that...so like 95% of the triangles you would normally have to test are eliminated. <br><br></td></tr></table><br>
<a name="435658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Regarding the offscreen culling, yes, Blitz tests each surface on a per-triangle basis, which is frankly stupider than ****.<br><br>You can do BSP and stuff, but the simplest thing to implement is what I described, and it will yield the same results. <br><br></td></tr></table><br>
<a name="435671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Octrees are great for speeding up line picks. You just check which nodes the pick intersecets with, and check the tris in those. So even if you're checking against what was a single mesh of 200,000 polys, if you pick in the centre of the level where no tris are, it'll check nothing. If it passes 5,000 tris, it'll just check those. <br><br></td></tr></table><br>
<a name="435775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just tried updating my terrain system to hide all entities out of view, but if there is any speed improvement, it's minor at best.  <br><br>I was sure it was going to result in a big speed improvement, since I saw such an improvement when I made a starfield out of a grid of hundreds of copied entities.<br><br>Now I'm not so sure what Blitz is doing as far as culling goes.  It's quite odd that it would have a big effect on one, but not the other.<br><br>Then again the terain system did already hide those entities with the most polygons when they were in the distance, whereas the star field did not attempt to hide any entities itself at all.  <br><br>I'm not convinced though that Halo is right that the system does culling by checking individual polygons.  I think it simply isn't doing any culling at all and instead relies on the 3D card to avoid rendering those entities which are out of view. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
