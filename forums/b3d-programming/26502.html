<!DOCTYPE html><html lang="en" ><head ><title >Why is picking so slow and collisions so fast?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Why is picking so slow and collisions so fast?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Why is picking so slow and collisions so fast?</a><br><br>
<a name="276030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have never come across a situation where I could even get Blitz collisions to slow down...well, maybe a few extreme cases.<br><br>It's well-known that visiblities picks are probabaly the slowest step in a game loop.<br><br>Why?  Would a system that used collision to check visibility be any faster? <br><br></td></tr></table><br>
<a name="276033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>With collisions, the entity is unlikely to have moved far - therefore there is less to check. Most entities are outside the 'movement' bounding box and don't have to be checked. There is a bit of (unintentional) temporal coherence going here.<br><br>But the bounding box for a pick is potentially very large, and many things need to be checked.<br><br>Blitz picking is far from optimal - a BSP tree would speed things up massively, along the lines of Maplet's shadow casting - but to provide good picking with any arbitray scene means you can't really rely on it being 'BSP-able'. <br><br></td></tr></table><br>
<a name="276068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Mark,<br><br>1. I wrote a line pick function in the code archives which you should take a look at.  It has more features than the built in line pick function.  Of course a built in function would be faster, so it would be nice if the built in function did everything that my function did. :-)  <br><br>For example, it is useful in lightmapping to only have the line pick be sucessful if the pick goes through the front side of a face, so when you are inside an object picking the outside world it doesn't pick the object.  Also, my function can cast a ray in one direction or both directions, and the line can be infinite or not.  I don't think my function explicity supports it but it would also be nice to get the exact triangle which was picked, the XYZ coordinate that was picked in world OR model space, and the UV coordinate in the triangle that was picked. (presuming that point 1-&gt;2 = U 0..1 and point 2-&gt;3 = v 0..1 or something like that)  <br><br><br>2. I presume that you attempt to pick bounding spheres for all the entities before you attempt to pick the entities themsevles.  But it seems odd that linepicking would be slow picking a mere 200 spheres...  Hm...<br><br><br>3.<br><br>Why use a BSP tree?  Why not an octree?  Hm...<br><br>Or...  Maybe you could sort the spheres into quadrants around the pick start location and then you would onlly have to check the spheres in one quadrant?  Hm... actually that wouldn't work cause some spheres could overlap more than one quadrant.  Hm.  Well you could always add such spheres to more than one quadrant.  The question then is whether adding the spheres to the quadrants is more expensive than just attempting to line pick them right off the bat.<br><br><br>I also presume you're using this sort of check for the line to sphere checks...<br><br>Of course maybe you're using line to some other shape which is faster than sphere?  Would line to axis aligned bounding box be faster?  That would be surprising.<br><br><br>-----------------------------------------------------<br>Finding the closest point on a line to another point.<br>-----------------------------------------------------<br>(x1, y1, z1), (x2, y2, z2) = ends of line segment<br>(x3, y3, y3) = point<br><br><br>u =<br><br>(x3 - x1)(x2 - x1) + (y3 - y1)(y2 - y1) + (z3 - z1)(z2 - z1)<br>-----------------------------------------------------------<br>(x2 - x1)(x2 - x1) + (y2 - y1)(y2 - y1) + (z2 - z1)(z2 - z1)<br><br><br><br>u = the location between the two end points of the line which is closest to the point.<br><br>If u is not between 0 and 1 then the closest point is not between P1 and P2<br><br><br>----------------------------<br>LINE-SPHERE-INTERSECTION<br>----------------------------<br><br>To find out if a line intersects a sphere, find the closest point on the line to the center of the sphere.<br>Then calculate the location of that point using U.<br>And finally, find out the if the distance from that point to the center of the sphere is less than the radius of the sphere. <br><br></td></tr></table><br>
<a name="277280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I kind of thought linepicks were sphere to poly collision, done fast over distance. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
