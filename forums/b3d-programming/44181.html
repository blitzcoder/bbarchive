<!DOCTYPE html><html lang="en" ><head ><title >ODE Multiplayer Solution</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ODE Multiplayer Solution</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >ODE Multiplayer Solution</a><br><br>
<a name="492310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello friends. I have been working with Ode very hard, and now i have it tuned i have developed a multiplayer racing game with great success.<br><br>Lot of people are asking how to synchronize all the computers. Well, here is my solution:<br><br>Syncronize all computers exactly is almost impossible due to lag. So the way is to synchronize positions with the lag time as difference.<br><br>Use the same time for ODE Step in all computers (of course...). Then you can know the lag (calculate the time between messages). The tricky is to send the actual position, rotation and velocities (angular and lineal) and a vector with the changes to the world (keys pressed normally).<br><br>Then when the client receives the data, Update the position, rotation, etc of the bodies and use the vector to keep upgrading the bodies until the next packet arrives. <br><br>The interpolation is made automatically by ode, because the car (for example a car) will move in response to keys pressed.<br><br>If there is too much lag between connections then you should refresh the car's position later, using the lag time. In this case you will see the other car's move later than the original one, but it will move smooth.<br><br>I will release a short demo soon. I have tested with two computers connected using ADSL and the results are amazing!<br><br>Good Luck! <br><br></td></tr></table><br>
<a name="492314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, of Course the position update and the key pressed updates are not the same. You Update the key's and when new packet arrives, update the old packet position and then keep updating they keys until the next one... <br><br></td></tr></table><br>
<a name="492491"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ICECAP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats awesome, cant wait to see the demo. <br><br></td></tr></table><br>
<a name="492878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PsychicParrot</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ^ second that - can't wait to see the demo :) <br><br></td></tr></table><br>
<a name="492892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> With the Wrapper version i have now i am having a little problem. Getting Body Rotation and Setting it with the values i got gives me different results.<br><br>Seems like a normalization problem. Since Two days i am working on it, hope i don't need to give it much more time... :( :( :( <br><br></td></tr></table><br>
<a name="492907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't forget about these guys:<br><br>const dReal * dBodyGetForce  (dBodyID);<br>const dReal * dBodyGetTorque (dBodyID);<br><br>Return the current accumulated force and torque vector. The returned pointers point to an array of 3 dReals. The returned values are pointers to internal data structures, so the vectors are only valid until any changes are made to the rigid body system.<br><br>void dBodySetForce  (dBodyID b, dReal x, dReal y, dReal z);<br>void dBodySetTorque (dBodyID b, dReal x, dReal y, dReal z);<br><br>Set the body force and torque accumulation vectors. This is mostly useful to zero the force and torque for deactivated bodies before they are reactivated, in the case where the force-adding functions were called on them while they were deactivated. <br><br></td></tr></table><br>
<a name="492940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's some more stuff on this topic:<br><br><a href="http://69.55.229.29/archives/2004/12/zen_of_networke_1.html" target="_blank">http://69.55.229.29/archives/2004/12/zen_of_networke_1.html</a><br>http://www.gaffer.org:8080/articles/ [see bottom article]<br><br>(Both by the same guy.) <br><br></td></tr></table><br>
<a name="492980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @wayne: I don't need to send and receive the acumulate forces, cause this is one different accumulation per frame. Then, cause i send the input, the force is automatically calculated and applied correctly.<br><br>@BlitzSupport: Wow, Great links! Thanks! What the link says is almost what i have been doing! (so i am not so bad...)<br><br>The problem is that is not working in my system:<br><br>rx = dbodygetrotationx(b)<br>ry = dbodygetrotationy(b)<br>rz = dbodygetrotationz(b)<br>dbodysetrotation(b,rx,ry,rz)<br><br>That Rotates the body, instead of doing nothing. <br><br></td></tr></table><br>
<a name="493014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ooooooook, problem solved. I have added quaternion functions, so i use internal quaternions for getting and setting data across the networks, and all ok.<br><br>Now i am working on optimize the input vector. When tested over ADSL with 120ms is good, but i want it very good (collisions included). I am going to try to reduce the float values to 2bytes (lossing accuracy, no problem i think), so i can send larger input vectors. <br><br>Any idea what is a good rate to send the information? (now i send 5 times a second) <br><br></td></tr></table><br>
<a name="494599"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, for those interested i must say that my ODE Multiplayer demo is running perfect in no collision World (any lag, any number of players).<br><br>The problem is that i cannot predict or buffer collision states. I think this is a non solution problem. So most racing games disable collisions for internet playing.<br><br>Anyway, any good idea? <br><br></td></tr></table><br>
<a name="494631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wayne</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I liked this article on the subject.<br>http://www.gaffer.org:8080/articles/NetworkedPhysics.html <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
