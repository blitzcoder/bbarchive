<!DOCTYPE html><html lang="en" ><head ><title >Icons and tabbing</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Icons and tabbing</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Icons and tabbing</a><br><br>
<a name="1253291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do you adjust the icon in the window titlebar? And is there a way to make windows tabable in some way? I don't think they are? <br><br></td></tr></table><br>
<a name="1253293"></a>

<a name="1253294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Jimmy,<br><br>The only quick way I know which has been proven and always discussed here is by the use of Resource Hacker, desktop icon only<br><br>Otherwise, for a fool proof solution is to modify and add icon resources to the latest Blitz3D code available as source code. <br><br></td></tr></table><br>
<a name="1253295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> As for the tabable part, do you mean GUI stuff like WinBlitz3D or switching between windows? <br><br></td></tr></table><br>
<a name="1253297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, ya exactly. When you press tab + shift it does not pop up in the list of apps?.<br><br>I suceeded to change the file icon using resource hacker now but it remains unchanged in the window unfortuntly.<br><br>Also I've never compiled C andthelike, is there aneasier way to change the icon? Diving into the binary or something like that? <br><br></td></tr></table><br>
<a name="1253299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> not sure why this is happening at your end but I can tab switch with my blitz3d window with a scene. Maybe something to do with the mouse pointer?<br><br>I don't know any method on replacing the windowed icon for a blitz3d app, unless you compile it from source which is now at your disposal.<br><br>Here's one I knew and used once but I'm not sure if its still compatible:<br><br><a href="http://www.microangelo.us/icon-editor.asp" target="_blank">http://www.microangelo.us/icon-editor.asp</a> <br><br></td></tr></table><br>
<a name="1253367"></a>

<a name="1253368"></a>

<a name="1253370"></a>

<a name="1253371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bit of a paste and run but this is one way to sort the window icon out:<br><br><pre class=code>
Function icon()
	Local sStart
	Local sEnd
	Local sLen
	Local sCut
	Local temp
	Local hWnd
	Local modname$
	
	hWnd = SystemProperty("AppHWND")
	
	modname$ = GetCommandLine$()
	
	sStart = Instr(modname$,Chr$(34),1)
	sEnd = Instr(modname$,Chr$(34),sStart + 1)
	
	If (sStart = 0 Or sEnd = 0) Then
		conlog "*** Advisory: blank process name! WTF!"
		Return
	EndIf
	
	sCut = sStart
	
	For sCut = sStart To sEnd-1
		If ((Mid$(modname$,sCut,1)="\") Or (Mid$(modname$,sCut,1)="/")) Then
			sStart = sCut
		EndIf
	Next
	
	sStart = sStart + 1
	
	sLen = sEnd - sStart
	
	If (sLen = 0) Then
		conlog "*** Advisory: blank process name! WTF!"
		Return
	EndIf
	
	modname$ = Mid$(modname$,sStart,sLen)

	icon16 = ExtractIcon(hWnd,modname$,0)

	icon32 = icon16

	temp = SendMessage(hWnd,128,0,icon16)
	temp = SendMessage(hWnd,128,1,icon32)
	
	setCvar("sys_proc",modname$,CVAR_PERMA Or CVAR_READONLY)

End Function
</pre><br><br>Theres a bit of extra code in there from my own project and a few API calls I don't remember off the top of my head which system DLLs they are from for userlib purposes - will update later when I have a bit more time with the bare code/userlibs but it should be possible to work it out.<br><br>EDIT:<br><br>For completeness should also delete the icons in your program's exit routine (though they should be unloaded automatically in garbage collection):<br><br><pre class=code>
	If (icon16) Then
		DeleteObject(icon16)
	EndIf

	If (icon32) Then
		DeleteObject(icon32)
	EndIf
</pre><br><br>icon16, etc. would have to be declared global. <br><br></td></tr></table><br>
<a name="1253381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Rroff. Looks like you got something going on here with bb code. May I ask where do you place the icon file name and how do you execute this function?<br><br>Thanks. <br><br></td></tr></table><br>
<a name="1253397"></a>

<a name="1253407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> After you've used resource hacker to push a custom icon into the exe this function then extracts that icon and replaces the default one in the window title (at run time only) - you could also load an external icon file but that is some slightly different code.<br><br>This function should be called as part of your initialisation code near the start of your program.<br><br>Also requires decls for gdi32, shell32 and user32 for the functions ExtractIcon, SendMessage, DeleteObject. <br><br></td></tr></table><br>
<a name="1253496"></a>

<a name="1253497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Rroff but I'm getting a GetCommandLine$ not found and other stuff Error.. Looks like you got some external userlibs in here not posted for clarity.<br><br>I seem to have some of those functions in blitz user libs but its declared as api_GetCommandLine()... <br><br></td></tr></table><br>
<a name="1253500"></a>

<a name="1253501"></a>

<a name="1253502"></a>

<a name="1253504"></a>

<a name="1253505"></a>

<a name="1253506"></a>

<a name="1253507"></a>

<a name="1253508"></a>

<a name="1253509"></a>

<a name="1253510"></a>

<a name="1253515"></a>

<a name="1253516"></a>

<a name="1253517"></a>

<a name="1253518"></a>

<a name="1253520"></a>

<a name="1253521"></a>

<a name="1253522"></a>

<a name="1253523"></a>

<a name="1253524"></a>

<a name="1253525"></a>

<a name="1253526"></a>

<a name="1253530"></a>

<a name="1253531"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok not to overshadow your cool solution Rroff (which I still need to test out :)) but guys I now figured out another way to solve this.. :)<br><br>Since you are setting up a windowed game/app showing title and icon titlebar, I would consider using WinBlitz3D, a very nifty Windows GUI userlib. I'm currently testing this out and I remember there's a set of function that is related to your window icon problem.<br><br>1) Use Resource Hacker to change the icon resource..<br><br>2) Download and install WinBlitz3d 1.1. I posted this resource on the beginners 101 list <a href="/post.php?topic=103736&amp;post=1252535" target="_blank"><b>here</b></a>.<br><br>3) Add this to the init section of your game/app <br><br><pre class=code>
Include "WB3DStyles.bb"

Global window = WB3D_InitializeGUI(SystemProperty("AppHwnd"),0,0,0,0)

;Add icon using bmp icon strip
icons = WB3D_LoadIconStrip("icons.bmp",16,0)
WB3D_SetWindowIcon(window,icons,0)

;AppTitle will be ignored, use this instead
WB3D_SetGadgetText(window,"My Game")
</pre><br><br><b>Icon Option #2</b> No external icon files needed and using standard .ico or icon library files. Replace code lines 2 and 3 of the above with this<br><pre class=code> 
;Match the filename below with your final Game Exe filename or use icon.ico/icon.dll library for icon external file
icon=ExtractIconA(window,"YourGame.exe",0)
SetClassLongA(window,-14,icon)
</pre><br><br>but need to do these items...<br><br>Inside userlibs folder<br><br>Create or add file user32.decls<br><pre class=code>
.lib "user32.dll"
SetClassLongA%(hWnd%,nIndex%,Value%):"SetClassLongA"
</pre><br><br>Create or add file shell32.decls<br><pre class=code>
.lib "shell32.dll"
ExtractIconA%(hWnd%,File$,Index%):"ExtractIconA"
</pre><br><br>The WB3D method icon set is not embedded but it also works ok.<br><br><b>One thing to note:</b> I have noticed when tampering with titlebar objects, the AppTitle command will be ignored. So using WB3D SetGadgetText is one straight solution in doing these changes..<br><br>You could also use the <b>**No DLL version**</b> of WinBlitz3d which I will try to find the link again and update here..<br><br><img src="http://i.imgur.com/ximFPVd.jpg"> <br><br></td></tr></table><br>
<a name="1253608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> "GetCommandLine$()"<br>I think the generic Blitz command CommandLine$() returns exactly the same? If not, then it would be: <pre class=code>Chr(34)+SystemProperty("AppDir")+[executablefilename]+Chr(34)+CommandLine$()</pre><br><br>(I'll have to check this at home when I can access B3D) <br><br></td></tr></table><br>
<a name="1253623"></a>

<a name="1253624"></a>

<a name="1253625"></a>

<a name="1253626"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mine is pretty much the same as option 2 btw I'm just making sure the user hasn't renamed the exe and/or allowing for multiple different exe names without hardcoding it.<br><br>EDIT: As for getcommandline$ its 5+ years since I wrote that code but IIRC its one of the most reliable ways to get the actual executable name as it is on disc to extract the icon without any hardcoding or possible issues with things being renamed either on disc or in memory. <br><br></td></tr></table><br>
<a name="1253869"></a>

<a name="1253870"></a>

<a name="1253872"></a>

<a name="1253873"></a>

<a name="1253874"></a>

<a name="1253875"></a>

<a name="1253876"></a>

<a name="1253877"></a>

<a name="1253878"></a>

<a name="1253879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> That titlebar is stubborn everything else changes allright.<br>Tab works, icon is there, but the icon in the titlebar stucks.<br><br>This is what I think now is the right track. As it is now it changes the tab allright.<br><br>But the actual code that I *think* SHOULD be done instead to be able to change icons in *both places* are marked out.<br>LOADIMAGE win API and It압 just a few lines but I got the API parameters abit wrong, working on it.<br><br><pre class=code>
; Version 1 (working but changes only one icon, the larger one)

seticon("app.exe")
WaitKey

Function SetIcon(iconfile$, iconindex=0, hWnd=0)
GCL_HICON = -14
GCL_HICONSM = -34 ; does not work in B3D at elast, does the same as HICON

hWnd = api_GetActiveWindow()
hIcon = api_ExtractIcon (hWnd, iconfile$, iconindex)
api_SetClassLong(hWnd, GCL_HICON, hIcon)

End Function
</pre><br><br>This one one would love to have working, windows API is complex too me right now so somethings is missing<br><br><pre class=code>
; Version 2 (Will change both icons when working and in a more modern "correct" fashion)
seticon("app.exe")
WaitKey

Function SetIcon(iconfile$, iconindex=0, hWnd=0)
GCL_HICON = -14
GCL_HICONSM = -34
WM_SETICON       = $80 
LR_LOADFROMFILE  = $10
ICON_SMALL       = 0   ; 16x16
ICON_BIG         = 1   ; 32x32
IMAGE_ICON       = 1
LR_DEFAULTSIZE 	 = $40
LR_LOADFROMFILE	 = $10
SM_CXICON  	 	 = 11
SM_CYICON 		 = 12
SM_CXSMICON 	 = 49
SM_CYSMICON 	 = 50
IMAGE_ICON= 1
IMAGE_BITMAP	 = 0

hWnd = api_GetActiveWindow()
hIcon = api_LoadImage(Api_GetModuleHandle_Null(0), iconfile$,MAKE_ICON,api_GetSystemMetrics(SM_CXICON),api_GetSystemMetrics(SM_CYICON),0)
If hIcon Then api_SendMessage(hWnd, WM_SETICON, ICON_BIG, hIcon)
hIcon = api_LoadImage(Api_GetModuleHandle_Null(0), iconfile$,MAKE_ICON, api_GetSystemMetrics(SM_CXSMICON), api_GetSystemMetrics(SM_CYSMICON),0)
If hIcon Then api_SendMessage(hWnd, WM_SETICON, ICON_SMALL, hIcon)

End Function
</pre> <br><br></td></tr></table><br>
<a name="1253887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Jimmy, glad you sorted this out. I already have mine working since I'm also using WinBlitz3D but anyway cool solution you got here. <br><br></td></tr></table><br>
<a name="1253893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Haha maybe I앐 close maybe I앐 not but GOD!! to much energy and time and lack of sleep and health already has gone into an ICON ;) <br><br></td></tr></table><br>
<a name="1253895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol yeah. although the winblitz3d method needs some dlls and includes, its the quickest one I got so far working on my end :) just took me an hour once I remembered that wb3d already got the functions to add this to an app.<br><br>cheers. <br><br></td></tr></table><br>
<a name="1253899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> ;) actually I have a simple dll solution from here already <a href="http://www.blitzforum.de/forum/viewtopic.php?t=14671" target="_blank">http://www.blitzforum.de/forum/viewtopic.php?t=14671</a><br>it압 about 40k compressed I think, Seticon"blah" and then youre done. <br><br>But... ya I went for the adventure to try find a more elegant solution for myself, the hard way.<br><br>But suddenly I think this dll seem like a really really reasonable solution. <br><br></td></tr></table><br>
<a name="1253932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh nice! would check that out too <br><br></td></tr></table><br>
<a name="1254066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> You like that huh? How about something I just succeeded with  ! ;) no dll zip zero nada.<br><br>And I made it minimalistic without xobstants and changes. Got tired of them haha.<br><br>Here you go. Proffesional look on your apps. 4 lines.<br><br>[Code]<br>; Change icon the correct way EVERYWHERE inside an app<br>hwnd = SystemProperty( "AppHWND" ) : icon=api_ExtractIcon(hwnd,"some-exe-or-icon.ico",0)<br>api_SendMessage(hwnd, $80 , 0, icon) : api_SendMessage(hwnd, $80 , 1, icon)<br><br>WaitKey<br><br>; file user32.decls ADD<br>; api_SendMessage% (hwnd%, wMsg%, wParam%, lParam%) : "SendMessageA"<br><br>; file Shell32.decls ADD<br>; api_ExtractIcon% ( hWnd%, File$, Index% ) : "ExtractIconA"<br>[/code] <br><br></td></tr></table><br>
<a name="1254075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> hey thanks Jimmy. I'm trying this out on B3D/B+ but I can't seem to get it to work and I keep getting MAV.. <br><br></td></tr></table><br>
<a name="1254111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using Blitz3D in Windows7 64bit<br>Be sure the api_sendmessage is letter by letter perfect don't rely on other sources. That was the culprit for me.<br><br>They ended in Iparam*<br>it should end in Iparam%<br><br>Try that and tell how that went <br><br></td></tr></table><br>
<a name="1254118"></a>

<a name="1254119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes copied exactly and I put in icon name on my executable after I added my resource hacker icon. I'm also using Win7 64 and Vista.<br><br>I'm trying it on B+, any difference in code? I assume it will work just the same <br><br></td></tr></table><br>
<a name="1254120"></a>

<a name="1254121"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's odd, ya it should work equally well there for all I know.<br><br>you could try use the internal equvivalent I guess if just maybe there are some strange collisions in how it works internally. <br><br>Does Blitzplus have pointer types that B3D does not have? I admit all that is abit stretchy but I have no other idea why it might not work.<br><br>It should work, I tried with clean decls libs now and just that code I gave and it works like charm in blitz3d 1.106 and latest 1.108 <br><br></td></tr></table><br>
<a name="1254128"></a>

<a name="1254129"></a>

<a name="1254131"></a>

<a name="1254132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; get hwnd in blitzplus (tested and works fine, blitz3d and blitz+ needs two diff approaches to get hwnd)<br>Hwnd=QueryObject(createwindow("appname",100,100,400,300,0,5),1) <br><br></td></tr></table><br>
<a name="1254136"></a>

<a name="1254137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> To round up I put both solutions here as there have been much confusion and alot of effort to get these findings.<br><br>Both are tried and works with Blitz3D and BlitzPlus respectively. <br><br>Blitz3D :<br><br><pre class=code>
; Change icon the correct way EVERYWHERE inside an app

hwnd = SystemProperty( "AppHWND" ) : icon=api_ExtractIcon(hwnd,"myapp.exe",0)
api_SendMessage(hwnd, $80 , 0, icon) : api_SendMessage(hwnd, $80 , 1, icon)

WaitKey

; file user32.decls ADD
; api_SendMessage% (hwnd%, wMsg%, wParam%, lParam%) : "SendMessageA"

; file Shell32.decls ADD
; api_ExtractIcon% ( hWnd%, File$, Index% ) : "ExtractIconA"
</pre><br><br>BlitzPlus <br><br><pre class=code>
; Change icon the correct way EVERYWHERE inside an app

Hwnd=QueryObject(createwindow("appname",100,100,400,300,0,5),1) 
icon=api_ExtractIcon(hwnd,"myapp.exe",0)
api_SendMessage(hwnd, $80 , 0, icon) : api_SendMessage(hwnd, $80 , 1, icon)

WaitKey

; file user32.decls ADD
; api_SendMessage% (hwnd%, wMsg%, wParam%, lParam%) : "SendMessageA"

; file Shell32.decls ADD
; api_ExtractIcon% ( hWnd%, File$, Index% ) : "ExtractIconA"
</pre><br><br>Blitzplus running example <br><br><pre class=code>
window=CreateWindow( "Test",ClientWidth(Desktop())/2-96,ClientHeight(Desktop())/2-96,192,192,0,7)
appname$="appname" : AppTitle appname$
hwnd=QueryObject(window,1)
icon=api_ExtractIcon(hwnd,"myapp.exe",0)
api_SendMessage(hwnd, $80 , 0, icon) : api_SendMessage(hwnd, $80 , 1, icon)

width=ClientWidth(window) : height=ClientHeight(window)
canvas=CreateCanvas( 0,0,width,height,window )
SetGadgetLayout canvas,1,1,1,1
SetBuffer CanvasBuffer(canvas)

While WaitEvent(10)&lt;&gt;$803
	mx=MouseX()-width/2: my=MouseY()-height/2
	Cls
	CopyRect mx,my,width,height,0,0,DesktopBuffer()
	FlipCanvas canvas
Wend

End
</pre> <br><br></td></tr></table><br>
<a name="1254143"></a>

<a name="1254145"></a>

<a name="1254146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh yeah. sorry Jimmy. I got confused and forgot the QueryObject thing.<br><br>Problem solved and works great! awesome simple solution :D<br><br>One thing just missing is Rroff's getcommandline and it will be perfect.. <br><br></td></tr></table><br>
<a name="1254155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad to hear it worked out! <br><br></td></tr></table><br>
<a name="1254168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah Jimmy, hey you could also post this to code archives for others to see and benefit from :-)<br><br>cool work <br><br></td></tr></table><br>
<a name="1254189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> I put some links here :)<br><br>Customizing your app icon<br><br>BlitzPlus version<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3173" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3173</a><br><br>Blitz3D version<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3174" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3174</a> <br><br></td></tr></table><br>
<a name="1254240"></a>

<a name="1254241"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> noice! :O <br><br></td></tr></table><br>
<a name="1254385"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Getting "ERROR: Internal error" on the Blitz3d link.. <br><br></td></tr></table><br>
<a name="1254400"></a>

<a name="1254401"></a>

<a name="1254403"></a>

<a name="1254404"></a>

<a name="1254405"></a>

<a name="1254406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> The easiest way to customize your AppIcon in Blitz3D ...<br><br>Use an IconEditor and create your 32x32 Icon ... 8-Bit Colortable ... IconFile must be 2238 Bytes long after saving ... <br><br><br>Write a little Program which includes this Subroutine (works for the most important last Blitz3D Versions):<br><br><pre class=code>.PatchIcon
	ToPatchFile$="runtime.dll"
	Ok=0
	If FileSize(ToPatchFile$)=1290240 Then Ab=$12b134 :Ok=1
	If FileSize(ToPatchFile$)=1314816 Then Ab=$130134 :Ok=1
	If FileSize(ToPatchFile$)=1318912 Then Ab=$131134 :Ok=1
	If FileSize(ToPatchFile$)=1323008 Then Ab=$132134 :Ok=1
	Bis=Ab+2219
	
	If Ok=0
		RuntimeError "Wrong runtime.dll version"
		End
	EndIf
	If UsedIcon$&lt;&gt;""
		x=FileSize(UsedIcon)
		If x&lt;&gt;2238
			Print "Wrong Format - unable to Patch"
			Print "Use 32x32 256color icon"
			Return
		Else
			Print "Icon size "+x+" ok"
		EndIf
		bank=CreateBank(x)
		filein=ReadFile(UsedIcon)
		If filein&lt;&gt;0
			ReadBytes bank,filein,0,x
			CloseFile filein
			Print "Iconfile loaded"
		Else
			Print "Iconfile load failed"
		EndIf
		
		fil=OpenFile(ToPatchFile)
		If fil&lt;&gt;0
			For i=Bis To Ab Step -1
				x=x-1
				SeekFile(fil,i)
				WriteByte fil,PeekByte(bank,x)
			Next
			CloseFile fil
			Print "runtime.dll successfully patched"
		Else
			Print "runtime.dll could not be opened"
			Print "Possible Error:"
			Print "runtime.dll is used by this program"
			Print "Create and run PatchIcon.exe"
		EndIf
		FreeBank bank
		Return
	EndIf
	Print "Nothing done"
Return
</pre><br><br>Use a Filerequester to get the Path and Filename of your Icon File<br>Or load the Path and Filename from an inifile ...<br><br>You must create an exe of this Patchfile ... because you patch the runtime.dll which must not be opened ... and it is open while the Temp.exe (your patcher) is running from the Blitz IDE...<br>Make a Copy of the runtime.dll before you do anything. Because the old icon will be overwritten and every following compiled exe will have your new Icon ...<br><br>I would have provided a complete running program - but the one I have does not work for you ... it's part of a complex preprocessing precompiler system which does patching automatic while creating the final exe ...<br>I use the PureBasic IDE to write Blitz3D-Code in PureBasic Style which gets converted to Blitz3D-Code with a Preprocessor ...<br>If you ask why ... I have autocomplete on all Functions which syntax check, parameters showing at the bottom line, autocomplete on all variables, arrays, types, 4000 custom functions highlighted with parameters showing, included automatic (no includefiles), etc... ;-) <br><br></td></tr></table><br>
<a name="1254408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> I noticed one version is gone?  what압 up with the archives? My name is still there but there압 an error? BlitzSupport? Is it deleted by misstake? <br><br></td></tr></table><br>
<a name="1254409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> RGR, that압 a nice patch I think I will try that aswell. Though sometimes you really want an icon to be set runtime for weird things such as say  modes or convey some info, I wonder if Windows is "up for it" to animate the icon even. It would certainly be an odd thing to do though. But the option is nice. <br><br></td></tr></table><br>
<a name="1254412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess there was an upload error or something. I uploaded it again for anyone who wants it.<br><br>Customizing your app icon<br><br>BlitzPlus version<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3173" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3173</a><br><br>Blitz3D version<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3177" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3177</a> <br><br></td></tr></table><br>
<a name="1254428"></a>

<a name="1254429"></a>

<a name="1254430"></a>

<a name="1254431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the update Jimmy and RGR that looks good to try..<br><br>BUT what I would be interested now in is how do you PROPERLY add the icon resouce like bbexe.ico and a titlebar icon in the BP/B3D sources. No hacks, just straight up icon resource compilation. <br><br>For Blitz3D the destkop icon is already in there in the runtime.dll project. I'm not sure with BPlus, it's showing none or default program win icon.<br><br>VC6 is too old for me (I started VS2008) and I can't seem to find docs or articles for it (at the moment)<br><br>I now think this is the practical way to do it with B3D/BP opensourced. <br><br></td></tr></table><br>
<a name="1254508"></a>

<a name="1254513"></a>

<a name="1254514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason the window used by b3d compiled programs has a default icon is that the window class structure used to register the window class before CreateWindowEx is called lacks entries for hIcon and/or hIconSm.<br><br>There is probably no way to fix the compiled executables short of significant hacking to replace the structure other than recompiling the b3d source itself.<br><br>EDIT: Oh yeah api_getcommandline is probably the same function -  I just manually added the api call to it instead of using one of the pre-built kernel32 decls (I tend to manually add/remove stuff as needed to narrow the scope of where potential errors might be originating from).<br><br>.lib "kernel32.dll"<br>GetCommandLine$ () : "GetCommandLineA" <br><br></td></tr></table><br>
<a name="1254517"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey thanks for the info Rroff! So I get it now that this has something to do with lacking of icon entries and the source is now available.<br><br>Yes, I also did mention that it is now practical to just recompile the source since it is now available. Do you have any idea how to add the icon title in the resource? and also add a default icon to BlitzPlus <br><br>Noted on the api_getcommandline, I will try to add this later. <br><br></td></tr></table><br>
<a name="1254521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't add the title bar icon to the resource file AFAIK (I'm a bit rusty on that) the runtime wndclass structure used to register the window class needs a couple of additional lines so that when CreateWindowEx is called the specified icon is used. <br><br></td></tr></table><br>
<a name="1254523"></a>

<a name="1254524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is definitely possible. I have easily done this with VS2010 and VS2008 projects. I'm not sure about the format and procedure workspace/solution which is currently and apparently in VC6. :/<br><br>It's also a bit weird why the authors at BRL did not upgrade or at least have them update with the latest Visual Studio for their own use. But hey its a big thanks this went open source.<br><br>I'm not complaining, just a minor thing and wanted to scratch this itch. <br><br></td></tr></table><br>
<a name="1254537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can add an icon into the executable via resource editing and later use it as the titlebar icon via the window class structure but I'm not sure you can use the resources to specifically define an icon as the window/title icon without any extra code. <br><br></td></tr></table><br>
<a name="1254539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I guess we could circle back on that part. Anyways, I revised your code and came up with this sample routine to go with Jimmy's code to replace the appname issue and can now deal with renaming the file itself:<br><br><pre class=code>
Function GetExeName$()

	modname$ = GetCommandLine$()
	
	sStart = Instr(modname$,Chr$(34),1)
	sEnd = Instr(modname$,Chr$(34),sStart + 1)
	
	If (sStart = 0 Or sEnd = 0) Then
		;Show console or error log here
		Return
	EndIf
	
	sCut = sStart

	For sCut = sStart To sEnd-1
		If ((Mid$(modname$,sCut,1)="\") Or (Mid$(modname$,sCut,1)="/")) Then
			sStart = sCut
		EndIf
	Next
	
	sStart = sStart + 1
	
	sLen = sEnd - sStart
	
	If (sLen = 0) Then
		;Show console or error log here
		Return
	EndIf
	
	modname$ = Mid$(modname$,sStart,sLen)

	Return modname$

End Function

Graphics 800,600,0,2	

Text 1,1,GetExeName()

WaitKey
</pre> <br><br></td></tr></table><br>
<a name="1254542"></a>

<a name="1254543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Already posted the addendum here:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=3177#comments" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=3177#comments</a> <br><br></td></tr></table><br>
<a name="1254545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> ahhh it check now its own filename. Clever stuff. Great work Videz and Rroff too, very nice.. I would love to look into that later, would it be okay to update the codearchives later perhaps and make it general if it all works out? <br><br></td></tr></table><br>
<a name="1254660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah Jimmy, of course. I already tested this before posting that addendum<br><br>now this can be a final solution :) <br><br></td></tr></table><br>
<a name="1254714"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jimmy</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got it to work, I았e never used BlitzPlus very much and when I should try change the actual exe icon resource in it it seems that it has no icon to replace?  The exe Plus spits out is nowhere like the Blitz3D? Which has a default icon to replace.  What have I missed? I앐 abit peckish to try learn Blitzplus. <br><br></td></tr></table><br>
<a name="1254716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >videz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice. With BlitzPlus, there's really no default icon included in the compiled or runtime dll. I learned a trick somewhere here that you need to create or hack it using ResourceHacker..<br><br>Open exe in reshacker<br>Go to Action-&gt;add new resource<br>Select the desired icon file (.ico)<br>Type ICON as Resource Name in all caps (reshacker auto caps it)<br>Save File Exe<br><br>Done :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
