<!DOCTYPE html><html lang="en" ><head ><title >Save Mesh?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Save Mesh?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Save Mesh?</a><br><br>
<a name="282107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've created a complicated structure ('manually') out of loaded individual entities, a town made out of buildings. Now I'd like to save it out of Blitz as a .X file. (Format doesn't matter so long as I can load it into a modeller and continue work on it.)<br><br>I've tried the code archives '3D Graphics/DirectX Exporter' (multi-surface exporter) in combination with Mark's AddMesh example, but it appears to create a mesh with zero triangles, zero surfaces etc.... Doh!<br><br>Anyone have any _reliable_ code which can do this? <br><br></td></tr></table><br>
<a name="282110"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use these when making my own meshes - you would need to call the function recursively is you wanted to save any child objects though.<br><br>Function save_mesh(mesh,mesh_name$)<br>	UpdateNormals mesh<br>	file=WriteFile(mesh_name)<br>	WriteInt(file,CountSurfaces(mesh))<br>	For surface_num=1 To CountSurfaces(mesh)<br>		temp_surface=GetSurface(mesh,surface_num)<br>		WriteInt(file,CountVertices(temp_surface))<br>		For vertex_num=0 To CountVertices(temp_surface)-1<br>			WriteFloat(file,VertexX#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexY#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexZ#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexNX#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexNY#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexNZ#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexRed#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexGreen#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexBlue#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexU#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexV#(temp_surface,vertex_num))<br>			WriteFloat(file,VertexW#(temp_surface,vertex_num))<br>		Next<br>		WriteInt(file,CountTriangles(temp_surface))<br>		For triangle_num=0 To CountTriangles(temp_surface)-1<br>			WriteInt(file,TriangleVertex(temp_surface,triangle_num,0))<br>			WriteInt(file,TriangleVertex(temp_surface,triangle_num,1))<br>			WriteInt(file,TriangleVertex(temp_surface,triangle_num,2))<br>		Next<br>	Next<br>	CloseFile file<br>End Function<br><br><br><br><br>Function load_mesh(mesh_name$)<br><br>	file=ReadFile(mesh_name$)<br>	<br>	mesh=CreateMesh():surfaces=ReadInt(file)<br>	<br>	For surface_num=1 To surfaces<br>					<br>		temp_surface=CreateSurface(mesh):FreeBrush brush<br>		vertices=ReadInt(file)<br>		For vertex_num=0 To vertices-1<br>			x#=ReadFloat(file):y#=ReadFloat(file):z#=ReadFloat(file)<br>			temp_vertex=AddVertex(temp_surface,x,y,z)<br>			nx#=ReadFloat(file):ny#=ReadFloat(file):nz#=ReadFloat(file)<br>			VertexNormal temp_surface,temp_vertex,nx,ny,nz<br>			r#=ReadFloat(file):g#=ReadFloat(file):b#=ReadFloat(file)<br>			VertexColor temp_surface,temp_vertex,r,g,b<br>			u#=ReadFloat(file):v#=ReadFloat(file):w#=ReadFloat(file)<br>			VertexTexCoords temp_surface,temp_vertex,u,v,w<br>		Next<br>		<br>		triangles=ReadInt(file)<br>		For triangle_num=0 To triangles-1<br>			v0=ReadInt(file):v1=ReadInt(file):v2=ReadInt(file)<br>			AddTriangle(temp_surface,v0,v1,v2)<br>		Next<br>	Next	<br>	<br>	CloseFile file<br>		<br>	Return mesh<br>End Function <br><br></td></tr></table><br>
<a name="282117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the code example, but can we just go over the basics? Suppose I have 3 houses, I want to do something like...<br><br>town = CreateMesh()<br>AddMesh house1, town<br>AddMesh house2, town<br>AddMesh house3, town<br>save_mesh(town,"C;\town.x") <br><br>... does the new mesh not contain all the surfaces that your function needs? <br><br></td></tr></table><br>
<a name="282208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neo Genesis10</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> John, in the case of your example it would be exported and loaded without problems. The only REAL difficulty I can see is that Stevie's code will NOT save texture information. See the GetSurfaceBrush and GetBrushTexture commands for details on how to write that information into your save and load routines. <br><br></td></tr></table><br>
<a name="282403"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great - I don't mind retexturing. But what did Stevie mean by 'you would need to call the function recursively is you wanted to save any child objects'?<br>Stevie? <br><br></td></tr></table><br>
<a name="282414"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the Houses are Children of a Parent Mesh or Pivot, so the whole Scene would contain several Meshes you would have to handle seperately.<br><br>But if you use Addmesh first to add everything to one Mesh (you should check if it looks right) then you don't need to check for children.<br><br>Have a look at the recuriseve Mesh Hierarchy displaying Examples from the 3D Code Archive. <br><br></td></tr></table><br>
<a name="282480"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Err... Stevie G, I just took another look at your code - I don't see any definitions that look like any of the proprietory formats (.X or .3DS).<br>The whole point of this question was 'how can I save out an AddMesh'd entity that I can then load into an external editor?' <br><br></td></tr></table><br>
<a name="282482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You would need to know the specific format and customize the functions accordingly.<br><br><a href="http://astronomy.swin.edu.au/~pbourke/geomformats/directx/" target="_blank">Here's one page that details the .x format</a> - dated 1999 but still useful nonetheless.<br><br>*EDIT*<br>And another at microsoft.com (DX8.0)<br><a href="http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/dx8_c/directx_cpp/graphics_xof_format_1h2e.asp" target="_blank">http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/dx8_c/directx_cpp/graphics_xof_format_1h2e.asp</a><br><br>*EDIT* <br>This might also help, although it's in C, but it's DirectX 7 stuff<br><a href="http://www.gamedev.net/reference/programming/features/d3d7im4/page2.asp" target="_blank">http://www.gamedev.net/reference/programming/features/d3d7im4/page2.asp</a> <br><br></td></tr></table><br>
<a name="282484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wonderful ;)<br><br>So can I just repeat the question one more time -<br>Does ANYBODY have a mesh &gt; .X or mesh &gt; .3DS file saver that actually works?<br>Cheers. <br><br></td></tr></table><br>
<a name="282490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried the .X exporter in the code archives?<br><br><a href="/codearcs.php?code=631" target="_blank">here</a> <br><br></td></tr></table><br>
<a name="282495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's:<br>'Saving meshes x file format'<br><a href="http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=111" target="_blank">http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=111</a><br>which only saves single sirfaces, and<br>'DirectX Exporter'<br><a href="http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=631" target="_blank">http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=631</a><br>which as I said appears to save zero triangles, zero faces etc. Ho-hum. <br><br></td></tr></table><br>
<a name="282498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I should learn to read all of people's posts :) <br><br></td></tr></table><br>
<a name="282502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, just tried:<br>'Save mesh to .asc file format'<br><a href="http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=280" target="_blank">http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=280</a><br>which only saves the first entity in a mesh.<br>Anybody??????? <br><br></td></tr></table><br>
<a name="282624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've just posted a tidied up version of my directX file exporter in the code archives.<br><br>@John if you have a problem with the function please send me the file it saves and I'll see if its something I can fix. email jm.keay@... <br><br></td></tr></table><br>
<a name="282699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>Perhaps I should read your question in future.  You probably wouldn't be able to load this format into an editor.  I just use it to create my own meshes to load into my own B3d programs.<br><br>Sorry.. <br><br></td></tr></table><br>
<a name="283228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Stevie G - understandable, but I have created a complex shape using Blitz primitives.<br>@Shambler - no change on the new code. Zip on its way to you (Mark's Addmesh example + your code with textures defs removed.)<br>Thanks. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
