<!DOCTYPE html><html lang="en" ><head ><title >What is AlignToVector doing under the hood?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >What is AlignToVector doing under the hood?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >What is AlignToVector doing under the hood?</a><br><br>
<a name="579109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure I've used AlignToVector, but I have absolutely no idea what it's doing under the hood. I'm basically trying to emulate all the Blitz commands ( including some I rarely/never use ) and I've done all the TFormVector, TFormPoint, TFormNormal stuff, but AlignToVector is proving a problem, since I don't even know what it does really. <br><br></td></tr></table><br>
<a name="579116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cash</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> All I know is this...<br><br>If I use a pick command for example to select a point on a surface, I can position something at this picked location.<br><br>So I pick a location press a button and a bullrthole appears at this location.<br><br>Problem is in my example the bullrthole will appear, but I cannot guarantee what its orientation will be.  It may be at 90 degrees to the wall.<br><br>If I use the aligntovector command and use the pickednx(),pickedny(),pickednz()co-ordinates, then I can ensure the bullethole is rotated to the same orientation as the surface it has hit.<br><br>Now my bullethole is flat on the wall.<br><br>This is only one example of course.  Shadows etc may be another use.<br><br>Any use ??<br>Or have I completely missed the question... <br><br></td></tr></table><br>
<a name="579142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It makes one of the axis of the entity align to a vector.  A vector being 3 numbers that describe a direction (with a certain length). <br><br></td></tr></table><br>
<a name="579185"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cash: Thanks, but I understand what it does for practical uses. I'm essentially looking for pseudo-code for how to go about doing that.<br><br>Beaker: Yep, I understand that. I just have no idea what process that would involve. TFormPoint, Vector and Normal were dead simple, because I could easily visualize a list of everything that's being done. Then I could just write the code to do it one step a time. I can't really get a grasp on the stages involved in AlignToVector though.<br><br>BTW I'm not interested in the smoothing parameter. I never use that, and I suspect most people are the same as Cash and myself, just using it for a one-off instant alignment. <br><br></td></tr></table><br>
<a name="579212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> All the Blitz3D geometry code is in the sticky at the top of this forum. Have you had a look through that for any clues? <br><br></td></tr></table><br>
<a name="579214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Erm yeah, but I don't see anything related to this. It's just a bunch of maths classes for vector, quaternion and matrix, etc operations, most of which I already have one way or another. Maybe I'm missing something, but I don't see anything which helps me here. <br><br></td></tr></table><br>
<a name="579225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Braincell</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well what i'd do is i'd get the normal of the picked triangle and then set the normal (facing) of the entity (ie bullethole to that normal). <br><br>How to get the normal of the triangle? <br>Get the triangles three verts, figure out a mathematical common plane theyre all on, figure out their clockwise orientation and make a normal in that direction. This should be doable using TFOrmPoints etc.<br><br>How to find out which triangle is picked?<br>Beats me<br><br>How to get the position once you have the orientation?<br>Not sure on the most efficient way but what i think you can do is make a sort of code for mathematically finding and intersection between a line and a triangle in 3d. Thats all maths pretty much. There is a number of approaches. You could look at the triangle from the lines point of view (if youre sure it has collided with the triangle) and determine how far it is from each vert in that perspective. Then multiply those distances to get the real distances depending on the angle of the triangle.... lol ... yeah basically :) Oh and when you get the distances from each vert you should be able to fing its exact position if you know any maths.<br><br>How to check if a line has collided with a triangle?<br>Thats all maths, figure it out yerself! :P <br><br></td></tr></table><br>
<a name="579235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Erm.. thanks? But my question has nothing to do with normals, picks, triangles or bullets. <br><br></td></tr></table><br>
<a name="579263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeppe Nielsen</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> This could be a start:<br><pre class=code>
Function AlignEntity(entity,dx#,dy#,dz#,roll#=0)

	dist#=Sqr#((dx#*dx#)+(dz#*dz#))
	pitch#=ATan2(dy#,dist#)
	yaw#=ATan2(dx#,-dz#)
	
	RotateEntity entity,pitch#,yaw#,roll#

End Function 
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
