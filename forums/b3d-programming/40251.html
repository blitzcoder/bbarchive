<!DOCTYPE html><html lang="en" ><head ><title >Integer  math using floats</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Integer  math using floats</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Integer  math using floats</a><br><br>
<a name="451202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone know for a fact if the following will be a problem?<br><br>I have a multidimensional array P(35, 7) that stores some integer numbers in some subsets (3, 4, 7) and some floating point numbers in the other subsets (1, 2, 5, 6).<br><br>For specific reasons, I do not wish to use seperate arrays nor Types, so don't suggest to use them please. :)<br><br>Because an array can only be declared as integer P(35, 7) or float P#(35, 7), I can't actually have integers in subsets 3, 4, and 7.<br><br>So what I want to know is if I create a float array P#(35, 7) and if I perform only 'integer math' on subsets 3, 4, and 7, is there a possibility that the numbers in those subsets could become non-integers do to floating point inaccuracies?<br><br>I know you're asking yourself what I mean by 'integer math', so I will explain.  For the subsets in question, I will only ever add or subtract exact integer numbers to/from them (i.e. 2.0 + 5.0, or 134.0 - 17.0).<br><br>I may even have to perform multiplication (i.e. 32.0 * 7.0).<br>I probably won't be able however to perform division since that could lead to decimal parts (unless I know in advance that it would not).<br><br><br>So, in other words, if a float variable is set to an integer value (i.e. 4.0), will the zero part of that float always remain zero?  Or is there a possibility that it could become non-zero (i.e 4.0000000000001) due to floating point inaccuracies?<br><br>The reason I am concerned is because I want to perform checks on the 'integer' subsets 3, 4, and 7 to see if they equal certain values (i.e. If P#(12, 3) = 20 Then ...).<br>I am afraid that due to floating point inaccuracies, that the checks could fail (i.e. P#(12, 3) = 19.99999999999).<br><br>So, does anyone know if I will encounter problems if I perform addition or subtraction on the floats?<br><br>Will I encounter problems if I perform multiplication on the floats?<br><br>What about performing division? <br><br></td></tr></table><br>
<a name="451211"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You will encounter the problems. You can avoid most by cashing the floats to interger variables when you do the calculations, and the send the result back as a float.<br><br>The If P#(12, 3) = 20 is not safe and never will be.<br><br>I would avoid doing what you are describing.<br><br>Can't you use intergers as floats instead?<br>I have floats I read from a file as a string, and before using them, I convert *the string* to an interger (well to a string without commas, but you get the drift :) ) . Same way when I write them. <br><br></td></tr></table><br>
<a name="451248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using floats for integers will give exact results if the integers are small enough.<br><br>There are 24 bits available in a float, so the biggest integer is %111111111111111111111111, which is 16777215.<br> The sign is stored separately, so -16777215 is also available.<br><br>Addition, subtraction and multiplication are also exact, provided the results fit into 24 bits.<br><br>Division will work if the division of integers is exact. For example 6.0/3.0 will be the exact value 2.0. <br><br></td></tr></table><br>
<a name="451270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sunteam Software</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or you could do:<br><br><pre class=code>If Int(P#(12,3))=20</pre> <br><br></td></tr></table><br>
<a name="451313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unlike me, Floyd knows what he's talking about, so listen to him. I still wouldn't do it though ;) <br><br></td></tr></table><br>
<a name="451369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, especially Floyd.<br><br>I think I may do what Sunteam suggested though since the Int command in Blitz rounds up or down (Unlike Int command in other Basic languages). <br><br></td></tr></table><br>
<a name="451376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doing some tests, I see that Floyd appears to be correct.<br>This code succeeds:<br><pre class=code>For biter = 1 To 100
  For iter = 1 To 16000000
  	a# = a# + 1.0
  Next
  For iter = 2 To 16000000
  	a# = a# - 1.0
  Next
Next
Print a#
WaitKey()
End</pre><br>and returns the result 100.0<br><br>This code fails:<br><pre class=code>For iter = 1 To 17000000
	a# = a# + 1.0
Next
Print a#
WaitKey()
End</pre><br>and returns the result 16777200.0 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
