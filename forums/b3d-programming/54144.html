<!DOCTYPE html><html lang="en" ><head ><title >AVI manipulation</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >AVI manipulation</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >AVI manipulation</a><br><br>
<a name="604401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chevron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello all, Does anyone know how I could import an avi file and save it out frame for frame to .bmp. Is there a .dll wrapper availible to use with blitz? <br><br></td></tr></table><br>
<a name="604417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a DLL that allows to save an avi. It will save frames as BMP and then tell the DLL to add the bmp to a destination AVI.<br><br>The main problem with saving single frames from an Avi is: BLitz will play the Avi realtime corrected, this means, wen you copy a frame to an imagebufffer and then save the buffer as a BMP, Blitz will miss some frames of the Avi that is playing (using OpenMovie and DrawMovie). There is no Pause function and no seek-Frame function so far.<br>I can tell you the best solution that I have found so far that works reliably (forget MCISendString, seekFrame doesn't work reliably)<br><br>Well I use MCISendString to obtain information about an Avi, all I need to know is: the number of Frames and the Rate it is played. MCISendString can tell you this (see Coder Archives, userlibs)<br><br>Then I have installed Avisynth. It's freeware and acts as a frameserver in the OS. Basicly you can open an Avisynth script as a Movie. The script includes the Avi source path, plus some modification commands etc, like sharpen, or blur, whatever.<br><br>Now I write a temporary avisynth script from within Blitz that look like this:<br><pre class=code>
DirectShowSource("source.avi")
Trim(n,n+32)
</pre><br><br>Where n is the number of the wanted frame. Avisynth will now deliver a snippet of the original source avi, beginning at frame n, containig 32 fames. I am now playing this Movie to the backbuffer. 32 Imagebuffers are ready as a cache buffer. I will then copy the 32 frames to the imagebuffers using copyrect. Copying a frame of 720*576 Pixel (PAL) takes 0 to 1 milliseconds, so it's fast enough not to drop frames.<br><br>Now i can edit the 32 frames and save them to a destination avi, or as BMPs etc.<br>THen I add 32 to n and restart the process with the temporary Avisynth script. This is the fastest reliable method I have found so far. Accesing a single frame by Avisynth may be more simple, but it's also much slower.<br><br>BLitzaviDLL:<br><a href="http://www.blitzcoder.com/cgi-bin/showcase/showcase_showentry.pl?id=pk-studiox6401162003184358&amp;comments=no" target="_blank">http://www.blitzcoder.com/cgi-bin/showcase/showcase_showentry.pl?id=pk-studiox6401162003184358&amp;comments=no</a><br>avisynth:<br><a href="http://www.avisynth.org/" target="_blank">http://www.avisynth.org/</a><br><br>You may automate the installation of Avisynth by testing if OPenMovie an Avisynth script will return zero, and if so, suggest to install Avisynth during the installation of your Tool. <br><br></td></tr></table><br>
<a name="604419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barliesque</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What you need is in two parts:  First, a library function to let you play an AVI into a buffer, and allow you to move to a particular frame.  Then a second function to save the buffer to an image file.  There are a couple of options for both tasks...<br><br>To play a specific frame of an AVI...<br>- BlitzMOVIE<br><a href="http://www.harrimansoftware.com/BlitzMovie.htm" target="_blank">http://www.harrimansoftware.com/BlitzMovie.htm</a><br>-BlitzAVI<br><a href="http://www.studiox64.com/blitzavi.php" target="_blank">http://www.studiox64.com/blitzavi.php</a><br><br><br>To save the image...<br>- You can use Blitz3D's own function SaveBuffer()<br>- or for formats other than BMP, try the FreeImage library:<br><a href="http://www.blitzcoder.com/cgi-bin/showcase/showcase_showentry.pl?id=snarty09252003024804&amp;comments=no" target="_blank">http://www.blitzcoder.com/cgi-bin/showcase/showcase_showentry.pl?id=snarty09252003024804&amp;comments=no</a><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=48558" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=48558</a><br><br>For every application I can think of, PNG is a much better format to use than BMP, since it uses a lossless form of compression and is just as well supported in Blitz and elsewhere.  You can save PNG files with the FreeImage library.<br><br>[EDIT] Pardon redundancies-- JFK and I wrote our replies at the same time.  :) <br><br></td></tr></table><br>
<a name="604422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm afraid BLitzMovie cannot play a specific frame. It can only pause a movie. Also Version 2.0 seems to be not fully stabile.<br>Coppercircle is curretnly developing a solution for the described needs, but since he's busy with other stuff, it's not sure when it will be available. <br><br></td></tr></table><br>
<a name="604438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chevron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks alot JFK. AVIsynth will do the trick, very nice peice of software. <br><br></td></tr></table><br>
<a name="604443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzAvi is good, except for the stupid 80 character filename limit for the generated avi. <br><br></td></tr></table><br>
<a name="604459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blimey, you need to be able to use filenames that are longer than this sentence? <br><br></td></tr></table><br>
<a name="604577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Filenames including filepaths, sweetheart, often exceed 80 bytes. We're in the long filename generation now. <br><br></td></tr></table><br>
<a name="604581"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barliesque</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> LOL <br><br></td></tr></table><br>
<a name="604589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzAviDLL doesn't need a path, you can use a filename only, so it will save the avi in the current folder. BTW I didn't even know it has that limit. Never had any problems. <br><br></td></tr></table><br>
<a name="604628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doggie</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you dear...;) <br><br></td></tr></table><br>
<a name="604649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barliesque</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's another utility you might want to check out:<br><a href="http://www.codersworkshop.com/viewshowcase.php?id=56" target="_blank">http://www.codersworkshop.com/viewshowcase.php?id=56</a><br><br>"Avi4Bmp is a tool to convert an AVI, an MPG or a GIF to one large PNG (or BMP) 32bit file with all the frames in rows and columns.  Perfect for BlitzBasic© LoadAnimImage()!" <br><br></td></tr></table><br>
<a name="604734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, it does have that limit - there's a comment tucked away in the code where the author says he can't be bothered changing it, and I don't think it's possibly to hack it cause the dll is looking for an absolute location in the memory block.<br><br>The pain of this is that (as jfk says) you have to set the current dir to where you want the avi be built, then while recording make sure that no other of your processes tries to access what _was_ the current dir before. <br><br></td></tr></table><br>
<a name="604741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Filenames including filepaths, sweetheart, often exceed 80 bytes. We're in the long filename generation now. <br></div><br>[pedantic mode]<br>Ah...You should have said Filepath if that's what you meant...;op<br>[/pedantic mode]<br><br>/me hides behind the cute fluffy kitten. <br><br></td></tr></table><br>
<a name="605029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> [condescending mode]<br>Sorry for calling you sweetheart. It had been one of those days.<br>[/condescending mode] <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
