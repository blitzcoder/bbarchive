<!DOCTYPE html><html lang="en" ><head ><title >DateDiff/DateAdd functions</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >DateDiff/DateAdd functions</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >DateDiff/DateAdd functions</a><br><br>
<a name="578664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> DateAdd and DateDiff, - Is it possible to call those functions from Blitz? <br><br></td></tr></table><br>
<a name="581920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> *bump* <br><br></td></tr></table><br>
<a name="582083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd be interested in this aswell. I managed to write my own functions for this, but they're not very good and I'd like to see some better ones. Where did you see these? <br><br></td></tr></table><br>
<a name="582087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are these win32 functions, or something? What do they do? <br><br></td></tr></table><br>
<a name="582089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suspect you can know the difference between a date and you can add days to a date respectively. I have used something similar in c++.<br><br>Perhaps you can wrap them from c++, it is easy. <br><br></td></tr></table><br>
<a name="582096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I *think* they're VB functions.<br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/script56/html/vsfctdateadd.asp" target="_blank"> datadd </a> <br><br></td></tr></table><br>
<a name="582102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I believe you'd need to use a userlib to call those functions.<br><br>If you have to start from scratch, a great method I'd like to recommend is the "epoch" approach - keep track of dates as the number of seconds which have elapsed since Jan 1, 1970.  You only need routines to convert epoch time to human readable and vice versa (I'd use a Type with fields for year, month, day, hour, minute, second), diffing and adding become simple mathematical expressions.<br><br>The main drawback of using epoch dates is that they can't describe dates before 1970 or after 2038 (unsigned ints aren't big enough to hold anything larger.)<br><br>P.S. don't forget to get your leap years correct!  I've seen too many date functions which don't respect all the leap year rules.  IIRC: !(y%4) &amp;&amp; !!(y%100) &amp;&amp; !(y%400) <br><br></td></tr></table><br>
<a name="582377"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> These functions are what I've always used with VB/VBA. I believe that SQL and Access users have very similar, if not identical, functions.<br><br>DateDiff can measure the difference between 2 dates and returns a value representing seconds, minutes, hours etc.<br><br>DateAdd, when given a string date and a number representing the number of seconds, minutes or hours to add/subtract will return the resultant date.<br><br>The range of useable dates is limited to a finite span of approx 68 years at second accuracy. Calculation of dates before and after the bounds must either lose accuracy (use minutes instead of seconds) or be performed using recursive techniques (adjusting the reference date) to avoid an overflow and then performing addition or subtraction by a bit of good old fashioned string processing.<br><br>Back in VB3 I'm sure that they were only accessible if an external file was included in the project but can't remember which file (blast my antiquated brain cells). In VB6/VC they're either native or at least apparently seamless.<br><br>Some years ago I checked them for centennial (often wrongly called millennial) compliance when that was all the rage and found them to be sound and capable of accurately returning dates within leap years after the 2k boundry - which rather made me wonder what all that fuss was actually about - I later learned that nearly all comliance issues arose from poorly constructed Excel spreadsheets and not just a little bloody mindedness on the part of M$, who stood to gain the most after all the shouting).<br><br>So, any help for the Klingons? <br><br></td></tr></table><br>
<a name="582392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, I think it's MSAFINX.DLL. My brain might have recovered a lost allocation unit... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
