<!DOCTYPE html><html lang="en" ><head ><title >How to do magic number in a file?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to do magic number in a file?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How to do magic number in a file?</a><br><br>
<a name="1180400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all. How would I create &amp; use a magic number in a file, to check for tampering of the file?<br><br>Thank You! <br><br></td></tr></table><br>
<a name="1180403"></a>

<a name="1180404"></a>

<a name="1180405"></a>

<a name="1180406"></a>

<a name="1180409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You wouldn't.<br><br>1) Completely unrelated to what magic numbers are for<br><br>2) There is no way to check for tampering using a file's contents<br><br>3) For the twelve thousand'th time, <i>stop trying to abuse your users</i>. You have <i>no right</i> to tell people what files they can and can't run, and as a point of principle, this avenue is not one you should be investigating<br><br><br>The correct way to do this would be with a hash or checksum: a mathematical function applied to the complete contents of a data file and the result compared to a value stored safely somewhere else, not part of the data file (if it were part of the file, it would be trivial to change it to match the requirement).<br><br>Doing this is in turn completely pointless unless you have an online verification system that can communicate with a remote server, as if the checksum is stored anywhere in your distributed software (e.g. compiled into the exe), a hacker <i>will</i> find it and will simply hex edit your program to contain the desired value.<br><br>Also, for all but the most advanced hashing functions, there are tools that allow users to tweak data so it produces the right result code because all such functions get reversed eventually. e.g. MD5 is completely useless for security purposes for this reason as it can be broken in a matter of seconds.<br><br><br>So not only is it highly morally questionable, it's also a waste of your time: this is the sort of thing governments and megacorps spend millions of dollars on to try and come up with a security measure that will take the punks at 4chan more than 24 hours to defeat. <br><br></td></tr></table><br>
<a name="1180407"></a>

<a name="1180408"></a>

<a name="1180410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just write the bytes of the file signature on the begening<br><br>For exemple, a b3d start with 4 chars "B"+"B"+"3"+"D"<br>-&gt; MyStream = Writefile("Myb3d.b3d")<br>WriteByte(MyStream,asc("B")<br>WriteByte(MyStream,asc("B")<br>WriteByte(MyStream,asc("3")<br>WriteByte(MyStream,asc("D")<br><br>And Voila.<br><br>To use it, just read the tag byte per byte and check for each loop (until a maximum length) if the tag match with a parser you have.<br>ex: if you find BB3D then you can launch a b3d parser (if you have any)<br><br><br>I remember some file are not "0" offset for the signature (the signature can be somewhere else, but it's really not typical)<br><br><br>for the "tampering", I don't even know what it is ...<br><br>[edit]<br>mmmm ... ok, I just come and see what "tampering" is.<br>unless you use some user32 function to get the timestamps of the file (for edition vs creation) of course, it 's signature are absolutely not relevant. <br><br></td></tr></table><br>
<a name="1180482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Checking for tampering is one thing - tho trying to stop users editing or extracting from datafiles is a complete waste of your time and resources. The only way to effectively do it means low level compromising an end user's machine which is a big no no. I refuse to use any software that has DRM beyond simple stuff for checking for cheating online - anything that uses ring0 IO filtering doesn't get within a mile of my PCs. <br><br></td></tr></table><br>
<a name="1181129"></a>

<a name="1181130"></a>

<a name="1181222"></a>

<a name="1181233"></a>

<a name="1181234"></a>

<a name="1181235"></a>

<a name="1181236"></a>

<a name="1181237"></a>

<a name="1181238"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well Thundros, I haven't had time to study this option in depth, so the following is only a good guess:<br><br>You can do something similar to PureBasic's <b>PureValid</b> library, shown at the link:<br><a href="http://www.purebasic.fr/english/viewtopic.php?t=9825" target="_blank">http://www.purebasic.fr/english/viewtopic.php?t=9825</a><br><br>{ Can ultimately be turned into a DLL, and therefore be accessed by Blitz3D too }<br>;------------------ sample code ------------------<br>PureValid_CheckFile(EncryptionKey.s)<br><br>    Returned values :<br><br>    1 if EXE is valid ;<br>    0 if EXE is corrupt (program stops) .<br>;-------------------------------------------------<br><br>The strong point there is that even if 'hackers' know that the validation <br>info is located at the end of the EXE, there is still the complication that they do not know the Encryption Key.  Hence, any changes made to the 'body' of the program will still have to be encrypted with your special key that they don't know, and will be matched up with the end point validation. <br><br>Or, something like that...   <br><br>Maybe, put several validations, hidden in several places of the body of the program.  Each validation checks on the other validations inclusively as part of the 'body' of the program, etc.  <br><br>Eventually the hackers will get exhausted changing 'validation codes', <br>because there is more than one validation code, and each validation code<br>mutually checks on the validity of every other validation code.  Is that possible?<br>;--------------------------------------------------------------------------<br><br>As an alternative to the "PureValid" idea, you can make your program's code so horrifically cryptic and complex that <br>only <u>you</u> know what the code does and how it does it.<br><br>Therefore anyone else (including hackers) that shall try to decipher your stuff will just give up.   <br><br>I'm sure there are <i>ways</i> to make stuff more complicated than it needs to be.  <br>Maybe you can use <i>random numbers</i> in various obfuscation techniques.  :)<br><br>Integer obfuscation Techniques:<br><a href="http://stackoverflow.com/questions/2565478/integer-id-obfuscation-techniques" target="_blank">http://stackoverflow.com/questions/2565478/integer-id-obfuscation-techniques</a><br><br>How to obfuscate Integers:<br><a href="http://raymorgan.net/web-development/how-to-obfuscate-integer-ids/" target="_blank">http://raymorgan.net/web-development/how-to-obfuscate-integer-ids/</a><br><br>Gray Code:<br><a href="http://en.wikipedia.org/wiki/Gray_code" target="_blank">http://en.wikipedia.org/wiki/Gray_code</a><br><br>Obfuscation:<br><a href="http://en.wikipedia.org/wiki/Obfuscation" target="_blank">http://en.wikipedia.org/wiki/Obfuscation</a><br>;-----------------------------------------------------------<br>Some more options:  You can use various programs to compress your EXE; this will further make your program hard to <i>alter.</i><br><br><b>UPX</b> - executable packer { is free! }<br><a href="http://upx.sourceforge.net/#downloadupx" target="_blank">http://upx.sourceforge.net/#downloadupx</a><br><br><b>PEtite</b> - { very nice &amp; free }<br><a href="http://www.un4seen.com/petite/" target="_blank">http://www.un4seen.com/petite/</a><br><br><b>Expressor</b> v1.8 {is not free}<br><a href="http://www.cgsoftlabs.ro/express.html" target="_blank">http://www.cgsoftlabs.ro/express.html</a><br><br>The <b>AsPack</b> programs for Compression + <u>Protection</u>, { not free }<br><a href="http://www.aspack.com/aspack.html" target="_blank">http://www.aspack.com/aspack.html</a><br><br><b>PEcompact</b> { not free }<br><a href="http://bitsum.com/pecompact.php" target="_blank">http://bitsum.com/pecompact.php</a><br><br>Other <b>EXE</b> file compression comparisons:<br><a href="http://www.maximumcompression.com/data/exe.php" target="_blank">http://www.maximumcompression.com/data/exe.php</a> <br>;----------------------------------------------------------- <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
