<!DOCTYPE html><html lang="en" ><head ><title >Help! 256 flag + crashing on ATI</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Help! 256 flag + crashing on ATI</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Help! 256 flag + crashing on ATI</a><br><br>
<a name="897973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Need some urgent assistance!<br><br>A some of you may know, I've recently had a game published on Steam. This is great but I'm getting a lot of crash reports from people with ATI cards (particulalry X800's), and it seems to be down to using Flag 256 when loading/copying textures.<br><br>I wrote a thread about this yonks ago, but in the end it seemed this wouldn't be a great problem and so I implemented a 'safe' mode and moved on.<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=70527#788441" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=70527#788441</a><br><br>However it seems to be affecting a lot of ATI users (particularly X800's) and although using -safe mode resolves the problem, it still means they'll experience a crash first time and come running to the forums with pitchforks at the ready! I'd like to avoid that!<br><br>I need a reliable way to check if Flag256 is ok and in a way that won't trigger a crash in itself. <br><br>(Note: I was using Tom's DX7test.dll, however this was causing issues with Steam's GUI overlay and so have gone on to using Mikhail's FastExt.)<br><br>Help! <br><br></td></tr></table><br>
<a name="897986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could use GfxDriverName() to see if it's an ATI chipset I suppose. <br><br></td></tr></table><br>
<a name="897993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sledge <br><br>Yes, but I don't want to auto switch all ATI to safe mode by default as that means reduced visuals. I might get accused of being biased towards Nvidia ;-)<br><br>I'm just sorting out a test app now. <br><br></td></tr></table><br>
<a name="898001"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..which particular command from FastLib causing that problem? Or it is B3D Loadtexture commandset with flag 256? <br><br></td></tr></table><br>
<a name="898004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> NA<br><br>It appears to be the B3D loadtexture command (with flag 256)<br><br>I've set up a small test utility. This will test textureloading, copying and a glowfx using flag256 and write logfile.<br><br>Could I ask the community to run the proggy, run it twice (first time answer y to enable flag 256, then n) and send me the two logfiles the programme creates? Or post contents in this thread. They'll be in the same directory as <br>LOGFILE_FLAG256.TXT<br>LOGFILE_FLAG0.TXT<br><br>Nvidia users would be welcome to give it a go too!<br>(It'll just run and render a few spheres on-screen)<br><br><a href="http://madjack.fileburst.com/256_TEST.zip" target="_blank">http://madjack.fileburst.com/256_TEST.zip</a><br><br>Thanks! This could be a big help! <br><br></td></tr></table><br>
<a name="898009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> here is test for nVidia, I dont have here my ATI rig wich running exactly card you did mentioned(X800), as well as ATI MAX 128 (old card), so i will give it a go on monday..<br><br>May I know why you have necessity to load texture with flag 256? <br>---------<br>-Yes log-<br>---------<br>FLAG_256 =256<br>Primary Display Driver<br>INIT FLAG=2<br>BrushBlendsSrc (EntityBlendsSrc): 00001FFF<br>	+ D3DPBLENDCAPS_ZERO<br>	+ D3DPBLENDCAPS_ONE<br>	+ D3DPBLENDCAPS_SRCCOLOR<br>	+ D3DPBLENDCAPS_INVSRCCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHA<br>	+ D3DPBLENDCAPS_INVSRCALPHA<br>	+ D3DPBLENDCAPS_DESTALPHA<br>	+ D3DPBLENDCAPS_INVDESTALPHA<br>	+ D3DPBLENDCAPS_DESTCOLOR<br>	+ D3DPBLENDCAPS_INVDESTCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHASAT<br>	+ D3DPBLENDCAPS_BOTHSRCALPHA<br>	+ D3DPBLENDCAPS_BOTHINVSRCALPHA<br> <br>BrushBlendsDest (EntityBlendsDest): 00001FFF<br>	+ D3DPBLENDCAPS_ZERO<br>	+ D3DPBLENDCAPS_ONE<br>	+ D3DPBLENDCAPS_SRCCOLOR<br>	+ D3DPBLENDCAPS_INVSRCCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHA<br>	+ D3DPBLENDCAPS_INVSRCALPHA<br>	+ D3DPBLENDCAPS_DESTALPHA<br>	+ D3DPBLENDCAPS_INVDESTALPHA<br>	+ D3DPBLENDCAPS_DESTCOLOR<br>	+ D3DPBLENDCAPS_INVDESTCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHASAT<br>	+ D3DPBLENDCAPS_BOTHSRCALPHA<br>	+ D3DPBLENDCAPS_BOTHINVSRCALPHA<br> <br>TextureCaps: 000006CD<br>	+ D3DPTEXTURECAPS_PERSPECTIVE<br>	- D3DPTEXTURECAPS_POW2<br>	+ D3DPTEXTURECAPS_ALPHA<br>	+ D3DPTEXTURECAPS_TRANSPARENCY<br>	- D3DPTEXTURECAPS_BORDER<br>	- D3DPTEXTURECAPS_SQUAREONLY<br>	+ D3DPTEXTURECAPS_TEXREPEATNOTSCALEDBYSIZE<br>	+ D3DPTEXTURECAPS_ALPHAPALETTE<br>	- D3DPTEXTURECAPS_NONPOW2CONDITIONAL<br>	+ D3DPTEXTURECAPS_PROJECTED<br>	+ D3DPTEXTURECAPS_CUBEMAP<br>	- D3DPTEXTURECAPS_COLORKEYBLEND<br> <br>TextureBlends: 00FEFFFF<br>	+ D3DTEXOPCAPS_DISABLE<br>	+ D3DTEXOPCAPS_SELECTARG1<br>	+ D3DTEXOPCAPS_SELECTARG2<br>	+ D3DTEXOPCAPS_MODULATE<br>	+ D3DTEXOPCAPS_MODULATE2X<br>	+ D3DTEXOPCAPS_MODULATE4X<br>	+ D3DTEXOPCAPS_ADD<br>	+ D3DTEXOPCAPS_ADDSIGNED<br>	+ D3DTEXOPCAPS_ADDSIGNED2X<br>	+ D3DTEXOPCAPS_SUBTRACT<br>	+ D3DTEXOPCAPS_ADDSMOOTH<br>	+ D3DTEXOPCAPS_BLENDDIFFUSEALPHA<br>	+ D3DTEXOPCAPS_BLENDTEXTUREALPHA<br>	+ D3DTEXOPCAPS_BLENDFACTORALPHA<br>	+ D3DTEXOPCAPS_BLENDTEXTUREALPHAPM<br>	+ D3DTEXOPCAPS_BLENDCURRENTALPHA<br>	- D3DTEXOPCAPS_PREMODULATE<br>	+ D3DTEXOPCAPS_MODULATEALPHA_ADDCOLOR<br>	+ D3DTEXOPCAPS_MODULATECOLOR_ADDALPHA<br>	+ D3DTEXOPCAPS_MODULATEINVALPHA_ADDCOLOR<br>	+ D3DTEXOPCAPS_MODULATEINVCOLOR_ADDALPHA<br>	+ D3DTEXOPCAPS_BUMPENVMAP<br>	+ D3DTEXOPCAPS_BUMPENVMAPLUMINANCE<br>	+ D3DTEXOPCAPS_DOTPRODUCT3<br> <br>TextureMaxStages: 8<br>TextureMaxWidth: 8192<br>TextureMaxHeight: 8192<br>TextureMaxAspectRatio: 8192<br>ClipplanesMax: 8<br>LightsMax: 8<br>Bump: 1<br>BumpLum: 1<br>AnisotropyMax: 16<br> <br>TEXTURE LOAD - PNG<br>10936448<br>TEXTURE 0 LOAD - DDS<br>10944488<br>TEXTURE 1 LOAD - DDS<br>11614832<br>TEXTURE 2 LOAD - DDS<br>10917264<br>CREATETEXTURE <br>10917832<br>COPY TEXTURE<br>Testing Vram<br>1<br> <br>DDS RENDER TEXTURE TEST<br>OK<br> <br>+PNG RENDER TEXTURE TEST<br>OK<br> <br>HARDWARE GLOWFX<br>...ok<br><br>--------<br>-No Log-<br>--------<br><br>FLAG_256 =0<br>Primary Display Driver<br>INIT FLAG=2<br>BrushBlendsSrc (EntityBlendsSrc): 00001FFF<br>	+ D3DPBLENDCAPS_ZERO<br>	+ D3DPBLENDCAPS_ONE<br>	+ D3DPBLENDCAPS_SRCCOLOR<br>	+ D3DPBLENDCAPS_INVSRCCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHA<br>	+ D3DPBLENDCAPS_INVSRCALPHA<br>	+ D3DPBLENDCAPS_DESTALPHA<br>	+ D3DPBLENDCAPS_INVDESTALPHA<br>	+ D3DPBLENDCAPS_DESTCOLOR<br>	+ D3DPBLENDCAPS_INVDESTCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHASAT<br>	+ D3DPBLENDCAPS_BOTHSRCALPHA<br>	+ D3DPBLENDCAPS_BOTHINVSRCALPHA<br> <br>BrushBlendsDest (EntityBlendsDest): 00001FFF<br>	+ D3DPBLENDCAPS_ZERO<br>	+ D3DPBLENDCAPS_ONE<br>	+ D3DPBLENDCAPS_SRCCOLOR<br>	+ D3DPBLENDCAPS_INVSRCCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHA<br>	+ D3DPBLENDCAPS_INVSRCALPHA<br>	+ D3DPBLENDCAPS_DESTALPHA<br>	+ D3DPBLENDCAPS_INVDESTALPHA<br>	+ D3DPBLENDCAPS_DESTCOLOR<br>	+ D3DPBLENDCAPS_INVDESTCOLOR<br>	+ D3DPBLENDCAPS_SRCALPHASAT<br>	+ D3DPBLENDCAPS_BOTHSRCALPHA<br>	+ D3DPBLENDCAPS_BOTHINVSRCALPHA<br> <br>TextureCaps: 000006CD<br>	+ D3DPTEXTURECAPS_PERSPECTIVE<br>	- D3DPTEXTURECAPS_POW2<br>	+ D3DPTEXTURECAPS_ALPHA<br>	+ D3DPTEXTURECAPS_TRANSPARENCY<br>	- D3DPTEXTURECAPS_BORDER<br>	- D3DPTEXTURECAPS_SQUAREONLY<br>	+ D3DPTEXTURECAPS_TEXREPEATNOTSCALEDBYSIZE<br>	+ D3DPTEXTURECAPS_ALPHAPALETTE<br>	- D3DPTEXTURECAPS_NONPOW2CONDITIONAL<br>	+ D3DPTEXTURECAPS_PROJECTED<br>	+ D3DPTEXTURECAPS_CUBEMAP<br>	- D3DPTEXTURECAPS_COLORKEYBLEND<br> <br>TextureBlends: 00FEFFFF<br>	+ D3DTEXOPCAPS_DISABLE<br>	+ D3DTEXOPCAPS_SELECTARG1<br>	+ D3DTEXOPCAPS_SELECTARG2<br>	+ D3DTEXOPCAPS_MODULATE<br>	+ D3DTEXOPCAPS_MODULATE2X<br>	+ D3DTEXOPCAPS_MODULATE4X<br>	+ D3DTEXOPCAPS_ADD<br>	+ D3DTEXOPCAPS_ADDSIGNED<br>	+ D3DTEXOPCAPS_ADDSIGNED2X<br>	+ D3DTEXOPCAPS_SUBTRACT<br>	+ D3DTEXOPCAPS_ADDSMOOTH<br>	+ D3DTEXOPCAPS_BLENDDIFFUSEALPHA<br>	+ D3DTEXOPCAPS_BLENDTEXTUREALPHA<br>	+ D3DTEXOPCAPS_BLENDFACTORALPHA<br>	+ D3DTEXOPCAPS_BLENDTEXTUREALPHAPM<br>	+ D3DTEXOPCAPS_BLENDCURRENTALPHA<br>	- D3DTEXOPCAPS_PREMODULATE<br>	+ D3DTEXOPCAPS_MODULATEALPHA_ADDCOLOR<br>	+ D3DTEXOPCAPS_MODULATECOLOR_ADDALPHA<br>	+ D3DTEXOPCAPS_MODULATEINVALPHA_ADDCOLOR<br>	+ D3DTEXOPCAPS_MODULATEINVCOLOR_ADDALPHA<br>	+ D3DTEXOPCAPS_BUMPENVMAP<br>	+ D3DTEXOPCAPS_BUMPENVMAPLUMINANCE<br>	+ D3DTEXOPCAPS_DOTPRODUCT3<br> <br>TextureMaxStages: 8<br>TextureMaxWidth: 8192<br>TextureMaxHeight: 8192<br>TextureMaxAspectRatio: 8192<br>ClipplanesMax: 8<br>LightsMax: 8<br>Bump: 1<br>BumpLum: 1<br>AnisotropyMax: 16<br> <br>TEXTURE LOAD - PNG<br>10936448<br>TEXTURE 0 LOAD - DDS<br>10944488<br>TEXTURE 1 LOAD - DDS<br>11614832<br>TEXTURE 2 LOAD - DDS<br>10917264<br>CREATETEXTURE <br>10917832<br>COPY TEXTURE<br>Testing Vram<br>0<br> <br>DDS RENDER TEXTURE TEST<br>OK<br> <br>+PNG RENDER TEXTURE TEST<br>OK<br> <br>HARDWARE GLOWFX<br>...ok <br><br></td></tr></table><br>
<a name="898036"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> LO7 <br>Thanks for that - it didn't highlight the issue,<br><br>However I've since managed to scrounge an older ATI card that is reproducing the error. Just about to go into the code to isolate what's causing the crash.<br><br>Thanks again though <br><br></td></tr></table><br>
<a name="898041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Madjack - please let us know how you resolve this.<br><br>I'm sure I read somewhere that you must set Flags 1+256 for this to work on some cards.  Worth a try if you're not doing it already. <br><br></td></tr></table><br>
<a name="898049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> StevieG<br><br>I've found the problem - turns out it's not the 256 flag, but will discuss it shortly. <br><br></td></tr></table><br>
<a name="898064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know it's moot now but I'm sure someone had code to test for flag 256 compatibility. By jfk maybe - it was a long time ago. <br><br></td></tr></table><br>
<a name="898079"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Appear to have found the problem.<br><br>Fastext's glow post process was having a violent reaction to two of the game's animated models - as in BSOD and reboot! Only affected ATI cards (as far as I can tell) and recompiling those models has appeared to solve the issue!<br><br>Very odd - may fire one of the offending models Mikhail's way.<br>My feeling though is that this is a symptom of both shoehorning extra abilities into DirectX7 Blitz3d and probably some dodgy engineering on ATI's part.<br>Mikhail's stuff seems pretty solid. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
