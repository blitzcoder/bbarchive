<!DOCTYPE html><html lang="en" ><head ><title >Alpha Channel</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Alpha Channel</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Alpha Channel</a><br><br>
<a name="711890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoeGr</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anybody know how to read alpha channel information from a png file? I need my application to be able to create a greyscale 'transparency map' from an image but I can't work out how to get at the required data.<br><br>Loadimage seems to discard alpha information and loadtexture automatically scales images whose dimensions are not powers of two, so it seems I need to read straight from the file. Can anyone help? <br><br></td></tr></table><br>
<a name="711943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> simply load as texture, with flag 2:<br><br><pre class=code>
tex=loadtexture("name.png",2)
setbuffer texturebuffer(tex)
lockbuffer()
for y=0 to textureheight(tex)-1
 for x=0 to texturewidth(tex)-1
  argb=readpixelfast(x,y)
  alpha=(argb shr 24)
 next
next
unlockbuffer()
</pre><br><br>Make sure it's a 32 Bit PNG. <br><br></td></tr></table><br>
<a name="711945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Uhm wait a minute, I just see what you said about the power of two scaling. Well you still could do the following:<br><br>load as texture, then read the alphas as I just described. THEN shift the alpha channel to the blue channel, or to all 3 RGB channels, however. THEN create an image of the same size as the texture, then copyrect the texture to the image, then resize the image to the original size. Now you can access the alpha in the blue channel.<br><br>Sounds complicated, but I guess it's a lot easier than unpacking a PNG, that is compressed with the huffman algorithm I think.<br><br>The only problems I see are:<br>- resizing an image is pretty slow.<br>- no pixelperfect alpha channel due to resize. <br><br></td></tr></table><br>
<a name="711963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoeGr</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks jfk.<br><br><div class="quote"> - resizing an image is pretty slow. <br></div><br>I'm not too worried about speed. I expect any method to be fairly slow.<br><br><div class="quote"> - no pixelperfect alpha channel due to resize <br></div><br>That's the problem right there. If I use, for example, a 600x600 image (or I guess even 513x513), it will be scaled up to 1024*1024 automatically. After scaling it back down again the data is quite badly degraded. I really need the original data for each pixel.<br><br>I can load an alpha channel from a separate 8 bit png and apply it (using your own routine from the code arcs). This works fine but I can't really expect end users to create a separate image for the alpha. Too messy.<br><br>If only loadtexture could be forced to tile or 'pad' a wrong-sized image instead of scaling it I would be sorted, but I don't think that's possible.<br><br>EDIT - Is it my imagination, or does the 'preview' button now actually post what you've written? <br><br></td></tr></table><br>
<a name="711969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> hey wow, preview!<br><br>However, probably you should use a dll to reasd from the png. Wasn't there something, FreeImage.dll or something? It was capable of saving PNG, so maybe it can also read them.<br><br>A further solution would be to use uncompressed TGA instead, they can be read easily. <br><br></td></tr></table><br>
<a name="711972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoeGr</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> hey wow, preview! <br></div><br>Have you not spotted that before? Its been there quite a while. Except now it seems to actually post instead of just previewing as it should.<br><br><div class="quote"> A further solution would be to use uncompressed TGA instead, they can be read easily. <br></div><br>That might do. I forgot about tga as I always use png. How does one 'easily' read the alpha channel from a tga then? <br><br></td></tr></table><br>
<a name="712234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> not sure. but I think I remember there's a save-TGA sourcecode in the archives somewhere. <br><br></td></tr></table><br>
<a name="713603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Graythe</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a `scaleimage_fast` routine in the archive. S'bliddy good! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
