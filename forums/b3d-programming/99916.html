<!DOCTYPE html><html lang="en" ><head ><title >Saving and loading system in game?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Saving and loading system in game?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Saving and loading system in game?</a><br><br>
<a name="1176023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cubed Inc.</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> For my game, I'm trying to implement as simple "save point" system where you'd save in-game via statues (fairly commom trope) and it would save the level's number, player's position and other things like points and health. Another thing is, I'm trying to make a system where once you press start on the title screen, the game will automatically load that saved data from last time, but if the game can't find the save, it would start as if you'd never played it before (everything is default).<br><br>I'm only looking for help with the saving and loading. I've got the entire system of the statues and the title screen set and clear, but saving and loading the data is where I need help in.<br><br>Could someone please help me out? I hope my explaination of my problem wasn't too badly put:/ <br><br></td></tr></table><br>
<a name="1176029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I try to help.<br><br>You must create a file on the hard disk that holds the positions of the player and everything about the game, however the game Begin, that file will be read and if there continue.<br><br>That file can be created with a button "Save Game" or that it automatically each time interval. <br><br></td></tr></table><br>
<a name="1176031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cubed Inc.</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Yue<br>I'm very thankful for your willingness to help me, but I think you misunderstood my question. I want to know how to use the blitz functions of saving and loading. I'm still very grateful for your efforts to aid me:) <br><br></td></tr></table><br>
<a name="1176045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> TaGames&gt;&gt;<br>This is a record+replay example but it shows how to write datas to a file, and then how to read datas from a file.<br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=2944" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=2944</a><br><br>There are several others examples in the code archives,<br>http://www.google.fr/#q=write+read+file+site:blitzbasic.com <br><br></td></tr></table><br>
<a name="1176050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Charrua</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br><br>see: <a href="http://blitzbasic.com/codearcs/codearcs.php?code=2863" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=2863</a><br><br>Juan <br><br></td></tr></table><br>
<a name="1176082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Axel Wheeler</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> One more point:<br><br>If you want a greater level of detail in your saves, consider BlitzXML:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=46647" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=46647</a><br><br>I notice the actual file wasn't at the link in the thread anymore, but if you want it I think I have it. <br><br></td></tr></table><br>
<a name="1176093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cubed Inc.</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, tell me if I'm doing this right or not ( just a brief genearalizition; not made to actually "run" )<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

savefile=WriteFile("savedgame.dat")

;Title screen stuff in here;
If gamestart=true 

saveopen=OpenFile("savedgame.dat")
saveread=ReadFile ("savedgame.dat")
EndIf

If gamestart=true And savefile=false
startgamenew=true
loadgame=false
else
startgamenew=false
loadgame=true
endif

</textarea><br><br>I'm VERY sure I'm not understanding this... <br><br></td></tr></table><br>
<a name="1176105"></a>

<a name="1176106"></a>

<a name="1176107"></a>

<a name="1176108"></a>

<a name="1176233"></a>

<a name="1176234"></a>

<a name="1176235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think you need all those variables. Try something simpler:<br><pre class=code>
Function TitleScreen()
	;Render whatever title\menu graphics you want.
	DrawTitleScreen()

	;If any of the keys assigned to "Start" are pressed, start the game.
	If (KeyHit(...) + KeyHit(...) + ...) Then
		If FileType("savedgame.dat") = 0 Then
			Return BEGIN_NEW_GAME ;No save-game file was found, so start the game from scratch.
		Else
			Return LOAD_GAME ;The file was found, so rebuild whatever level the player was in, down to the last details.
		EndIf
	EndIf
	
	Return TITLE_SCREEN
End Function
</pre><br>In your app's main loop...<br><pre class=code>Select currentState
	Case TITLE_SCREEN
		currentState = TitleScreen()
	Case BEGIN_NEW_GAME
		currentState = BeginNewGame()
	
	Case BUILD_LEVEL_1
		currentState = BuildLevel1()
	Case PLAY_LEVEL_1
		currentState = PlayLevel1()
	
	Case BUILD_LEVEL_2
		currentState = BuildLevel2()
	Case PLAY_LEVEL_2
		currentState = PlayLevel2()
	
	Case LOAD_GAME
		currentState = LoadGame()
End Select</pre>Inside LoadGame() you'd load the file (ReadFile() is fine) and rebuild the state the game was in as it will be described in the file: all actors, props, objects etc. with current healths, frames of animation, positions. <br>When the loading function is done, at the end of it you set the currentState to whatever level the player was in, so that Select block runs the appropriate level function. <br>Thing is, the load function will have already built the level you're going to restore and repositioned everything as it was, so there's no need for the load function to change state to BUILD_LEVEL_#, but rather to PLAY_LEVEL_# so you continue straight into gameplay.<br><br>Consider the BUILD_LEVEL_# functions as code that sets up the levels: loads the environment mesh, creates objects, positions the player, shows level intro cutscenes etc. - These won't be needed if you're loading a game that has a level being played; that's why the saved-game loading function already heads to one of those PLAY_LEVEL_# functions that only let the game run. <br><br></td></tr></table><br>
<a name="1178278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mv333</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I notice the actual file wasn't at the link in the thread anymore <br></div><br><br>http://web.archive.org/web/20100126022607/http://www.alsbonsai.com/john/BlitzXML_v1.71.zip <br><br></td></tr></table><br>
<a name="1178318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Axel Wheeler</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> To the rescue!  Thanks. <br><br></td></tr></table><br>
<a name="1178576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm wondering how to store my save data and read it in banks, so there IS no save file. <br><br></td></tr></table><br>
<a name="1178632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thundros wrote "I'm wondering how to store my save data and read it..."<br><br>I assume that you want to use <i>save-files</i> sometimes, but not all the time.<br>In case you'd want to send the <i>save-file</i> into a bank then you can do something like this:<br><br>;;------------------------------------------------------------------------<br> ;Creates and reads a bank from filename$<br> ;size=file size, pos=file position<br> ;Returns a bank<br><b>Function FiBankFromFile</b>(filename$, size = 0, pos = 0)<br> Local bank, file<br> If size = 0 Then size = FileSize(filename$)<br> bank = CreateBank(size)<br> file = ReadFile(filename$)<br> If file<br>  SeekFile(file, pos)<br>  ReadBytes(bank, file, 0, size)<br>  CloseFile(file)<br> EndIf<br> Return bank<br><b>End Function</b><br><br> ;Appends a bank to filename$<br> ;size=file size, pos=file position<br> ;Returns True if succeeds or False if fails<br><b>Function FiBankToFile</b>(bank, filename$, size = 0, pos = 0)<br> Local file<br> If bank = 0 Then Return 0 ;No bank<br> If size = 0 Then size = FileSize(filename$)<br> file = OpenFile(filename$) ;Existing file<br> If file = 0 Then file = WriteFile(filename$) ;New file<br> If file<br>  SeekFile(file, pos)<br>  WriteBytes(bank, file, 0, size)<br>  CloseFile(file)<br>  file = 1<br> EndIf<br> Return file<br><b>End Function</b><br>;;------------------------------------------------------------------------<br><br>The above functions were taken from the <b>FreeImage.BB</b> package:<br>( Has excellent image functions, along with some functions that don't involve images as well. )<br><br>FreeImage link:  <a href="http://freeimage.sourceforge.net/" target="_blank">http://freeimage.sourceforge.net/</a><br><br>Sorry, the black background hurts my eyes so sometimes I'll just show stuff without using [codebox]. <img src="http://i411.photobucket.com/albums/pp194/aeDream/Yahoo%20emoticons/hypnotized.gif"> <br><br></td></tr></table><br>
<a name="1178640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Sorry, the black background hurts my eyes so sometimes I'll just show stuff without using [codebox]. <br></div><br><br>Try a different theme, I am using default or something, whites and greys, boring to look at but easy on the eyes regarding text.<br><br>Although I do agree that at some point a bank would need to be saved to a file, unless of course you are making more of a checkpoint, in that regard no need to save it if it is a temp and RAM would suffice. <br><br></td></tr></table><br>
<a name="1178644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, actually, I want to save the memory to a memory bank, and somehow have it there next time I open the app so I can load it from memory. <br><br></td></tr></table><br>
<a name="1178645"></a>

<a name="1178647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's what a save file is for.<br><br>Yes I see post #11 where you also specify "no save file". What you are asking for is impossible and defies the entire concept of a filesystem. Memory <i>doesn't work that way</i>. It is reset every time the program runs. This is why your earlier attempt to save entity handles didn't work: the entities stop existing between program runs, and so does <i>everything</i> else that isn't a file.<br><br>Note that you can save the entire contents of a bank in one operation with WriteBytes, and load the entire contents of a file to a bank using CreateBank(FileSize(...)) + ReadBytes. But there's no magic solution that can keep memory valid between program runs without you doing at least that much. <br><br></td></tr></table><br>
<a name="1178646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ginger Tea</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> just for clarification, do you mean saving a memory bank to the hard drive and then retrieving said file upon start up or just assuming that nothing like a pc restart will happen between you exiting the game and then later reentering, cos I'm pretty sure most programs have a house clearance freeing up ram on exit.<br><br>basically for the first option you just need it to auto load a specific file upon start up, basically a save game file ...<br><br>2nd option, fools errand. <br><br></td></tr></table><br>
<a name="1178651"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, relax guys. I was just curious. <br><br></td></tr></table><br>
<a name="1178653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @TaGames...<br><br>First off, and this is only personal opinion, but I would forget XML and INI files for this as I think it complicates the task. The easiest way, is something like this... consider this pseudocode as my B3D is years rusty and it's from memory.<br><br><pre class=code>type tAlien
   field x,y
end type

function writeAlien(alien.tAlien)
    writeInt(alien\x)
    writeInt(alien\y)
end function

function readAlien.tAlien()
     alien.tAlien=new tAlien
     alien\x=readInt()
     alien\y=readInt()
end function</pre><br><br>So if you have a type tAlien, this should write its fields to disc, and recreate it by reading the fields back into a new tAlien. Got a whole bunch of aliens? Write the number of aliens to disc, then call writeAlien for each one. To Recreate them, first read a number from file (this tells you how many aliens to create), then call readAlien that many times. The key here is to ensure you read everything back in the same order you wrote it. Do this by keeping your read and write function next to each other so you can compare orders.<br><br><pre class=code>
function readgame()
      readaliens()
      readplayers()
end function

function writegame()
       writealiens()
       writeplayers()
end function
</pre><br><br>Using this method, you can rebuild all your types. Stuff that isn't based on types can use a similar method.<br><br>Obviously I've missed a few bits out like opening and closing files, but I'm sure you get the idea.<br><br>The advantage of INI files and XML is human readability, but it's all just bloat for a game load/save feature. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
