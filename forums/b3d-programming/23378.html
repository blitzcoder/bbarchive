<!DOCTYPE html><html lang="en" ><head ><title >Sswift's Particle System</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Sswift's Particle System</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Sswift's Particle System</a><br><br>
<a name="241286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lilprog</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> To sswift or anyone else with answers:<br><br>I have tried using sseift's particle system to create the waterfall scene, it works fine, problem is when i leave the level and return to the level, it complains that an entity is missing right  where i try to load the particle system again.  I run the same level init both times, why would it work the first and not the second?<br><br>Ill post code later today if no one knows <br><br></td></tr></table><br>
<a name="241333"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've never used nor seen the code of this systme, but maybe<br>it's because you have Type instances that hold the data for particles that are still alive. If such an instance hold an entity handle, then when you leave the level if you change the resolution all the entities are screwed up, so the handle in the type instance is invalid. Try deleting all the instances of types that holds the particle data when you leave the level, to make sure everything is properly cleaned up.<br>Hop this helps. <br><br></td></tr></table><br>
<a name="241393"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lilprog</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldnt this be cleared up when you run the ClearWorld command? <br><br></td></tr></table><br>
<a name="241426"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Koriolis:<br>Good call.  I would have had a tough time figuring out what he was doing wrong.  That sounds like a plausible explanation.<br><br>Lil:<br>No, types and other memory are not cleared.  So the types for the particles will contain a pointer to an entity which ClearWorld removed.<br><br>Call SPS_OFF() when you change levels, and make sure you fix the particle brushes you created, because when you clearworld, you also delete the entities those pointed to.  So you willl have to create new template particle meshes, and then set the appropriate field of each particle brush so it points to the new copy of the mesh.<br><br>A better game design though would be to keep all your pointers to your level media/entities in an array, and free them individually instead of using clearworld.  Otherwise you will needlessly have to reload/recreate some of your graphics which don't change between levels.<br><br>And even better game design might determine if the new level uses some of the graphics already loaded and does not free those.  If I was making a game that used a lot of textures and models, I'd seriously consider doing this. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
