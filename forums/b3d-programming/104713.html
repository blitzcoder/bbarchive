<!DOCTYPE html><html lang="en" ><head ><title >Auto Detect Resolution</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Auto Detect Resolution</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Auto Detect Resolution</a><br><br>
<a name="1270618"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EpicElrod</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to make my game pretty. How do I make it auto-detect resolution? I don't like messing with menus and stuff when I'm playing, and others don't either. If you can share some code (Blitz3D, btw) that would be awesome. Thanks! <br><br></td></tr></table><br>
<a name="1270637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Flanker512</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can use user32.dll to detect the desktop resolution : <a href="http://www.blitzbasic.com/Community/posts.php?topic=46522" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=46522</a> <br><br></td></tr></table><br>
<a name="1270646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EpicElrod</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. <br><br></td></tr></table><br>
<a name="1270647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EpicElrod</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, every time I use it, it says "Function "getsystemmetrics" Not found."<br>Why? <br><br></td></tr></table><br>
<a name="1270652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you create a file named "user32.decls" inside your "userlibs" folder ? <br><br></td></tr></table><br>
<a name="1270655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EpicElrod</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I did. I followed everything exactly. <br><br></td></tr></table><br>
<a name="1270684"></a>

<a name="1270686"></a>

<a name="1270687"></a>

<a name="1270688"></a>

<a name="1270689"></a>

<a name="1270690"></a>

<a name="1270691"></a>

<a name="1270692"></a>

<a name="1270693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, tested it just now. Working perfectly fine on Blitz3d V1.106 (I didn't update to latest as I have FastExt and not bothered to try the fix yet until I get Windows 10 and break compatibility with it).<br><br>But my user32 file is like this(more stuff in it as you can see). Dunno if that's needed though. There are pretty large versions around if you browse these forums. Probably already clear, but here are some step-by-step instructions:<br> <br>1) Create a notepad text file(disable wordwrap). <br>2) Copy the content from the box below into it. <br><br><i>*Note: Make sure you are showing extensions by disabling the Windows folder layout settings "Hide extensions for known file types" otherwise you'll end up with "user32.decls.text" , but the ".txt" bit won't show up as it's hidden. Then it won't work for Blitz doesn't read that as a decls file.</i><br><br>3) Save as: user32.decls<br>4) Copy the file to your  Blitz3d userlibs folder, e.g: "C:\Program Files (x86)\Blitz3D\userlibs"<br><br><br><b>user32.decls</b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;----------------------------------------------------------------------------
; Filename User32.decls
; Rev 0.5 2003.03.06
;
;----------------------------------------------------------------------------
;
; OpenGL Direct for Blitz ( <a href="http://www.blitzbasic.com" target="_blank">http://www.blitzbasic.com</a> )
; Using OpenGl from Blitz without a wrapper DLL
;
; by Peter Scheutz
;
;----------------------------------------------------------------------------
;
; This file contains the Blitz UserLib for User32.dll, 
; It must be copied to you Userlib directory.
;
;----------------------------------------------------------------------------

.lib "User32.dll"
api_CloseClipboard%():"CloseClipboard"
api_EmptyClipboard%():"EmptyClipboard"
api_ExamineClipboard%(format%):"IsClipboardFormatAvailable" 
api_GetClipboardData%(wFormat%):"GetClipboardData"
api_IsClipboardFormatAvailable%(wFormat%):"IsClipboardFormatAvailable"
api_OpenClipboard%(hwnd%):"OpenClipboard"
api_SetClipboardData%(wFormat%,hMem%):"SetClipboardData" 
;;This is CUSTOM for convenience (should be GetClipboardData, but pointers are no good to ME)
api_GetClipboardText$ (wFormat%) : "GetClipboardData"
apiSendMessage%(hwnd%, wMsg%, wParam%, lParam%) : "SendMessageA"

FindWindow%( class$,Text$ ):"FindWindowA"
GetDC%(hWnd% ):"GetDC"
ReleaseDC (hWnd%,hDC%):"ReleaseDC"
ChildWindowFromPoint%(hWndParent%,x%,y%):"ChildWindowFromPoint"
;SendMessage%(hWnd%,Msg%,wParam%,lParam%):"SendMessageA"
;PostMessage%(hWnd%,Msg%,wParam%,lParam%):"PostMessageA"
GetWindowText%(hwnd%, lpString*, cch%):"GetWindowTextA"
GetWindowTextLength%(hwnd%):"GetWindowTextLengthA" 
GetActiveWindow%():"GetActiveWindow"
SetWindowText(hwnd%,lptext$):"SetWindowTextA"
;GetAncestor%(hwnd%,gaFlags%):"GetAncestor"
GetClassName%(hWnd%,lpClassName*,nMaxCount%):"GetClassNameA"
GetParenthWnd%(hwnd%):"GetParent"
GetSystemMetrics% (nIndex%) : "GetSystemMetrics"

User32_FindWindow%(class$, title$):"FindWindowA"
User32_GetActiveWindow%():"GetActiveWindow"
User32_GetCursorPosition%(point*):"GetCursorPos"
User32_ScreenToClient%(hwnd%, point*):"ScreenToClient"
User32_MapVirtualKeyEx%(code%, mapType%, dwhkl%):"MapVirtualKeyExA"
User32_GetAsyncKeyState%(vkey%):"GetAsyncKeyState"

.lib " "
InputEx_Init()
InputEx_Update()
InputEx_VKeyTime%(VirtualKey%)
InputEx_VKeyDownEx%(VirtualKey%)
InputEx_VKeyDown%(VirtualKey%)
InputEx_VKeyHitEx%(VirtualKey%)
InputEx_VKeyHit%(VirtualKey%)
InputEx_KeyTime%(ScanCode%)
InputEx_KeyDownEx%(ScanCode%)
InputEx_KeyDown%(ScanCode%)
InputEx_KeyHitEx%(ScanCode%)
InputEx_KeyHit%(ScanCode%)
InputEx_MouseTime%(Button%)
InputEx_MouseDownEx%(Button%)
InputEx_MouseDown%(Button%)
InputEx_MouseHitEx%(Button%)
InputEx_MouseHit%(Button%)
KeyTime%(Key%)
KeyDownEx%(Key%)
KeyHitEx%(Key%)
MouseTime%(Button%)
MouseDownEx%(Button%)
MouseHitEx%(Button%)

</textarea><br><br><br>And a little test Blitz3d program:<br><br><b>Detect_Desktop_Res.bb</b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;Detect desktop resolution..

desk_w=GetSystemMetrics(0)
desk_h=GetSystemMetrics(1) 
Graphics3D desk_w,desk_h,32,2

Print "Hello world. Press any key to continue." 

WaitKey()
</textarea> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
