<!DOCTYPE html><html lang="en" ><head ><title >Tokamak Car Demo</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Tokamak Car Demo</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Tokamak Car Demo</a><br><br>
<a name="377657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It uses spheres for the wheels and this seems to defy logic to me.  For one thing the car won't turn unless you are applying torque to the wheels because with a sphere it doesn't actually matter which direction it's facing with no torque being applied to it ... it will just roll opposite the velocity of the rigid body.  Also, the vehicle rolls down hills sideways for obvious reasons.  Now I tried throwing some cylinders on there and the car basically just bounces a lot.  I tried to adjust all the cylinder parameters to be similar to the spheres etc...  has anyone overcome this issue with Tok?<br><br>One thing I have to say is that using Tok for a networked game is actually very easy.  Many people have complained but I'm not sure what all the fuss was about.  Anyway, some insight on the cylinder issue would be nice. <br><br></td></tr></table><br>
<a name="377685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nacra</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt; One thing I have to say is that using Tok for a networked game is actually very easy.<br><br>Jeremy, do you use a single server to run the physics for all cars?  Or do you do more of a peer to peer setup and run physics code on each game client?  Regarding the latter, it seems hard to adjust the positions and velocities of tok objects - tokrb_setposition seems guaranteed to cause a freak out whenever I use it. <br><br></td></tr></table><br>
<a name="377710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sweenie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have tried all possible kind of wheels in Tokamak but the spheres are the only ones that give the car a somewhat good beaviour.<br>Sadly the frictionmodel in tokamak sucks when simulating car-tyres and I think that to get a realistic simulation one has to implement Pacejka's formula or something similar.<br><br>Regarding using Tokamak with network.<br>Couldn't one run the simulation on both the server and the clients?<br>The server handles the "Master simulation" and send updates to the clients simulation every second or less to keep the simulations in synch.<br>The client's simulation will take care of movements while waiting for the next synchronizationevent.<br>A synchronizationblock could contain:<br>Position , 12 Bytes<br>Rotation , 12 Bytes<br>Body linear velocity, 12 Bytes<br>Body angularmomentum, 12 Bytes<br>------<br>48 Bytes (Is this too big?, I've never done any game network coding before) <br><br></td></tr></table><br>
<a name="377732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been doing tokamak networking for a while and it's VERY tricky to get right.<br><br>48 bytes isn't too big. I think you can safely send 300-400 bytes 10 times a second. The main problem is recieving, not sending, but luckily most connections recieve far more than they can send.<br><br>This is where the server has to be very clever and optimise whats sent. <br><br></td></tr></table><br>
<a name="377969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nacra</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe I should move this thought to the TOK support forum but it's network game related.  <br><br>I like the method that Sweenie describes but I get big instabilities when moving a TOK object that's in motion.  And isn't that what you have to do to sync up different clients?  I've even tried, with no success, setting them to zero linear and angular velocity and then moving them.  Rob, do you do physics sim (tok or ode) on the clients? <br><br></td></tr></table><br>
<a name="378041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> the TOKAMAK car demo uses SENSORS I believe. <br><br></td></tr></table><br>
<a name="378242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> For networking, I simply send the position and the velocity (via TOKRB_GetVelocityX() Y() and Z()).  Then on the other end, TOKRB_SetPosition() and TOKRB_SetVelocity().  It comes out really smooth updating only every 100 millisecs().  The simulation advances the rigid bodies automatically without dividing by the time interval difference.  This was with a peer to peer setup.  The only tricky thing is going to be collisions but I think that what I'd do is detect the distance and then apply a force via a packet instead of letting the simulation actually work because it isn't completely accurate.  Basically, it doesn't have to be spot on because we're not testing air bags with crash test dummies ... we're just trying to get a game to be fun and intuitive.  Intuition of course tells you that a crash can happen ;)<br><br>Anyway, I've just begun toying with this stuff.  The first thing I did was throw together a quick network app since that's what I really enjoy making and people seemed to complain the most about ;)  I hope to have a simple game done soon, followed by a decent app for vehicle physics, and then a really nice stunt track racer.  Just hope to get a simulation using cylinders because spheres are just wrong.  Hopefully they'll fix the friction issues for tires.  They need a tire object TOKRB_CreateTire() ;) <br><br></td></tr></table><br>
<a name="378250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, this doesn't solve the friction issue, but a true tire shape could be achieved with a bunch of box geometries.If you have trouble seeing how this works - imagine a wireframe cylinder.  It has a bunch of quads going round in a circle, with a top and a bottom. So, why not just create boxes with one side on the quad, extending out to the other side?  I'm not sure exactly how well the physics will work with it (who knows - might go insane), but it's an idea. <br><br></td></tr></table><br>
<a name="378276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sweenie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Even if you make a wheel that looks like a real tire there are still alot of things that the physicsengine won't handle.<br>Rubber deformation and such.<br>It's like driving a Porche with wooden-tyres.<br><br>The only solution is to "cheat".<br>Even the Tokamakteam "cheats" by using sensors(as Bradford mentioned above) and some custom friction code. <br><br></td></tr></table><br>
<a name="378280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are sensors included in the Tokamak dll yet? <br><br></td></tr></table><br>
<a name="378294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sweenie</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, but I need just a little more time before releasing it.<br>A week or two. <br><br></td></tr></table><br>
<a name="378297"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ah, great...thanks Sweenie. I'm looking forward to that release - sensors should allow a much simpler suspension model. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
