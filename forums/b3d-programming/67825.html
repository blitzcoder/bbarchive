<!DOCTYPE html><html lang="en" ><head ><title >Oblivion style Detail Lowdetail map help.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Oblivion style Detail Lowdetail map help.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Oblivion style Detail Lowdetail map help.</a><br><br>
<a name="757488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everybody.. iam back :)<br><br>Here is a fun problem that iam working on.<br><br>1) Create a detailmesh<br>2) Create a lod mesh<br>3) Join em together using blitz3d vertexX and vertexY<br>4) Have a command that Rerender em both. But LOD detail must sustain stable.<br><br><br>Question:<br>Iam trying to do above. but always run into difirent problems.<br>What do you all other think.<br><br><br>here is some code iam using.. not working propper (Planing to scrap it)<br>[CODE]<br>;Lod experment 2006-12-31 22:16<br><br><br>;********* Treemodels ***************************<br>Type tree<br>	Field root ;Nunber of root tree usaly 1<br>	Field leaf[128] ;Pointer to branch mesh<br>	Field light[128]<br>	Field leafs<br>	Field anim<br>	<br>End Type<br><br>Global tree,t_sprite,t_light<br>Global t_anim,t_leaf<br>;***********************************************<br><br><br><br>;LodVerts 8x<br>Type lodverts8x<br>	Field vert8x<br>End Type<br><br><br><br>;Lodverts 1x<br>Type  lodverts1x<br>	Field vert1x     ;Nev vertices på LOD mesh som ska flyttas till detail verts.<br>	Field detailvert ;Den vertices som den joinar på detail meshen<br>End Type<br><br><br>;Camera thins<br>Global camera<br><br><br>;Datas.<br>Dim verts1(64,64) ;Detail mesh<br>Dim verts2(64,64) ;Lod mesh<br>Dim verts3(64,2) ;Över kopplings pungt på lod.<br>Dim verts4(2,64) ;Vänster kopplings punger på lod.<br>Dim verts5(64,2) ;Nedre kopplings pungt på lod.<br>Dim verts6(2,64) ;Högre kopplings pungter på lod.<br><br>Dim wd#(1025,1025) ; World array height data<br>Global wx=1024,wz=1024<br><br>Graphics3D 1024,768,32,2<br><br>SetBuffer BackBuffer()<br><br>Cls<br><br><br>camera=CreateCamera()<br>CameraViewport camera,0,0,1024,768<br>PositionEntity camera,256,120,256-16<br>CameraClsColor camera,127,128,255<br>CameraFogColor camera,127,128,255<br>CameraFogRange camera,32,250<br>CameraFogMode camera,1<br>CameraRange camera,0.1,500<br>;TurnEntity camera,90,0,0<br><br><br>light=CreateLight()<br><br><br><br><br>;------- Detail mesh --------------<br>mesh=CreateMesh()<br>surf1=CreateSurface(mesh)<br>;Skapar pungterna för detail mapen<br>For x=0 To 64 <br>	For z=0 To 64<br><br>		verts1(x,z)=AddVertex (surf1,x+224,0,z+224,x,z)<br>		<br>	Next <br>Next<br><br><br>;Kopplar polygonerna i meshen<br><br>For x=0 To 63<br>	For z=0 To 63<br><br>		AddTriangle surf1,verts1(x,z),verts1(x,z+1),verts1(x+1,z+1)<br>		AddTriangle surf1,verts1(x,z),verts1(x+1,z+1),verts1(x+1,z)<br>		<br>	Next<br>Next<br><br>;---------------------------------<br><br><br><br><br><br>;---------  LOD mesh ------------------<br>;Skapar LOD mesh som ska kopplas runt detail meshen<br>lodmesh=CreateMesh()<br>surf2=CreateSurface(lodmesh)<br><br>;Skapar lagret som ska vara Högst upp. Aka 512 till 64<br>For x=1 To 63<br>	For z=36 To 64<br>	<br>		verts2(x,z)=AddVertex (surf2,x*8,0,z*8+8,x*8,z*8)<br>		tmp_v8.lodverts8x = New lodverts8x<br>		tmp_v8\vert8x=verts2(x,z)<br>	Next<br>Next<br><br><br><br>For x=1 To 62<br>	For z=36 To 63<br><br>		AddTriangle surf2,verts2(x,z),verts2(x,z+1),verts2(x+1,z+1)<br>		AddTriangle surf2,verts2(x,z),verts2(x+1,z+1),verts2(x+1,z)<br>		<br>	Next<br>Next<br><br><br><br>;Skapar Kopplings pungt 1 vertikal överts<br><br><br>For x=0 To 64 <br>	<br>	verts3(x,1)=AddVertex (surf2,x+224,0,1+228+59)<br>	verts3(x,2)=AddVertex (surf2,x+224,0,2+228+66)<br><br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts3(x,1)<br>	tmp_v1\detailvert = verts1(x,64)<br><br>	;***** Debug code ************************<br>	Goto holycraphigh<br>	sphere=CreateSphere()<br>	ScaleEntity sphere,0.2,0.2,0.2<br>	tx=VertexX(surf1,tmp_v1\detailvert)<br>	tz=VertexZ(surf1,tmp_v1\detailvert)<br>	PositionEntity sphere,tx,0,tz<br>	EntityColor sphere,0,255,0<br>	<br>		<br>	cube=CreateCube()<br>	ScaleEntity cube,0.3,0.3,0.3<br>	tx=VertexX(surf2,tmp_v1\vert1x)<br>	tz=VertexZ(surf2,tmp_v1\vert1x)<br>	PositionEntity cube,tx,0,tz<br>	EntityColor cube,255,0,0<br>	 prerender<br>	.holycraphigh<br>    ;*****************************************<br><br><br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts3(x,2)<br>	<br>	<br>Next<br><br>For x=0 To 63 Step 8<br>	z=1<br>	AddTriangle surf2,verts3(x,z),verts3(x,z+1),verts3(x+1,z)<br>	AddTriangle surf2,verts3(x+1,z),verts3(x,z+1),verts3(x+1+1,z)<br>	AddTriangle surf2,verts3(x+2,z),verts3(x,z+1),verts3(x+1+2,z)<br>	AddTriangle surf2,verts3(x+3,z),verts3(x,z+1),verts3(x+1+3,z)<br><br>	AddTriangle surf2,verts3(x+4,z),verts3(x+8,z+1),verts3(x+1+4,z)<br>	AddTriangle surf2,verts3(x+5,z),verts3(x+8,z+1),verts3(x+1+5,z)<br>	AddTriangle surf2,verts3(x+6,z),verts3(x+8,z+1),verts3(x+1+6,z)<br>	AddTriangle surf2,verts3(x+7,z),verts3(x+8,z+1),verts3(x+1+7,z)<br><br>	AddTriangle surf2,verts3(x+4,z),verts3(x,z+1),verts3(x+8,z+1)<br><br>	;AddTriangle surf2,verts3(x,z),verts3(x+1,z+1),verts3(x+1,z)<br>Next<br><br><br><br>;Skapar vänster övere hörn bit<br><br>AddTriangle surf2,verts2(27,36),verts2(28,36),verts3(0,1)<br><br>;Skapar Höger övre bit<br>AddTriangle surf2,verts2(36,36),verts2(37,36),verts3(64,1)<br><br><br><br>;--------------------------------------<br><br><br><br>;Skapar Resten av Vänster kant<br>For x=0 To 27<br>	For z=0 To 35<br>		verts2(x,z)=AddVertex (surf2,x*8,0,z*8+8)<br>		tmp_v8.lodverts8x = New lodverts8x<br>		tmp_v8\vert8x=verts2(x,z)<br><br>	Next<br>Next<br>For x=1 To 26<br>	For z=1 To 35<br><br>		AddTriangle surf2,verts2(x,z),verts2(x,z+1),verts2(x+1,z+1)<br>		AddTriangle surf2,verts2(x,z),verts2(x+1,z+1),verts2(x+1,z)<br>		<br>	Next<br>Next<br><br><br><br>;Vänster kopplings pungter<br>For z=0 To 64<br>	x=0<br>	verts4(1,z)=AddVertex (surf2,216,0,z+224)<br>	verts4(2,z)=AddVertex (surf2,224,0,z+224)<br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts4(1,z)<br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts4(2,z)<br><br><br>Next<br><br>For z=0 To 63 Step 8<br>	x=1<br>	;AddTriangle surf2,verts4(x,z),verts4(x,z+1),verts4(x+1,z+1)<br>	AddTriangle surf2,verts4(x,z),verts4(x+1,z+1),verts4(x+1,z)<br>	AddTriangle surf2,verts4(x,z),verts4(x+1,z+1+1),verts4(x+1,z+1)<br>	AddTriangle surf2,verts4(x,z),verts4(x+1,z+1+2),verts4(x+1,z+2)<br>	AddTriangle surf2,verts4(x,z),verts4(x+1,z+1+3),verts4(x+1,z+3)<br>	<br><br>	AddTriangle surf2,verts4(x,z+8),verts4(x+1,z+1+4),verts4(x+1,z+4)<br>	AddTriangle surf2,verts4(x,z+8),verts4(x+1,z+1+5),verts4(x+1,z+5)<br>	AddTriangle surf2,verts4(x,z+8),verts4(x+1,z+1+6),verts4(x+1,z+6)<br>	AddTriangle surf2,verts4(x,z+8),verts4(x+1,z+1+7),verts4(x+1,z+7)<br><br><br>	AddTriangle surf2,verts4(x,z),verts4(x,z+8),verts4(x+1,z+4)<br>	<br>	<br>Next<br><br><br>;Skapar vänster övere bit 2<br>AddTriangle surf2,verts2(27,36),verts4(2,64),verts2(27,35)<br><br><br><br>;Skapar resten av nedre lod<br><br>;Skapar lagret som ska vara längst ned. <br>For x=1 To 63<br>	For z=1 To 26<br>	<br>		verts2(x,z)=AddVertex (surf2,x*8,0,z*8+8)<br>		tmp_v8.lodverts8x = New lodverts8x<br>		tmp_v8\vert8x=verts2(x,z)<br><br><br>	Next<br>Next<br><br><br><br>For x=1 To 62<br>	For z=1 To 25<br><br>		AddTriangle surf2,verts2(x,z),verts2(x,z+1),verts2(x+1,z+1)<br>		AddTriangle surf2,verts2(x,z),verts2(x+1,z+1),verts2(x+1,z)<br>		<br>	Next<br>Next<br><br><br><br><br>;Skapar Kopplings pungt 1 vertikal överts<br>For x=0 To 64<br>	verts5(x,1)=AddVertex (surf2,x+224,0,1+215)<br>	verts5(x,2)=AddVertex (surf2,x+224,0,2+215+7)<br>	<br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts5(x,1)<br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts5(x,2)<br><br>	<br>	<br>Next<br><br>For x=0 To 63 Step 8<br>	z=1<br>	AddTriangle surf2,verts5(x,z),verts5(x,z+1),verts5(x+1,z+1)<br>	AddTriangle surf2,verts5(x,z),verts5(x+1,z+1),verts5(x+1+1,z+1)<br>	AddTriangle surf2,verts5(x,z),verts5(x+2,z+1),verts5(x+1+2,z+1)<br>	AddTriangle surf2,verts5(x,z),verts5(x+3,z+1),verts5(x+1+3,z+1)<br>	<br>	AddTriangle surf2,verts5(x+8,z),verts5(x+4,z+1),verts5(x+1+4,z+1)<br>	AddTriangle surf2,verts5(x+8,z),verts5(x+5,z+1),verts5(x+1+5,z+1)<br>	AddTriangle surf2,verts5(x+8,z),verts5(x+6,z+1),verts5(x+1+6,z+1)<br>	AddTriangle surf2,verts5(x+8,z),verts5(x+7,z+1),verts5(x+1+7,z+1)<br><br>	AddTriangle surf2,verts5(x,z),verts5(x+4,z+1),verts5(x+8,z)<br><br>	;AddTriangle surf2,verts5(x,z),verts5(x+1,z+1),verts5(x+1,z)<br>Next<br><br><br>;Kopplar höger nedre kopplings hörn<br>AddTriangle surf2,verts2(27,27),verts4(2,0),verts2(27,26)<br>AddTriangle surf2,verts2(27,26),verts4(2,0),verts2(28,26)<br><br><br><br><br><br><br><br><br>;Skapar resten av högerlod<br>For x=37 To 63<br>	For z=27 To 35<br>	<br>		verts2(x,z)=AddVertex (surf2,x*8,0,z*8+8)<br>		tmp_v8.lodverts8x = New lodverts8x<br>		tmp_v8\vert8x=verts2(x,z)<br><br>	Next<br>Next<br>For x=37 To 62<br>	For z=26 To 35<br><br>		AddTriangle surf2,verts2(x,z),verts2(x,z+1),verts2(x+1,z+1)<br>		AddTriangle surf2,verts2(x,z),verts2(x+1,z+1),verts2(x+1,z)<br>		<br>	Next<br>Next<br><br><br><br><br>;Höger kopplings pungter<br>For z=0 To 64<br>	x=0<br>	verts6(1,z)=AddVertex (surf2,288,0,z+224)<br>	verts6(2,z)=AddVertex (surf2,296,0,z+224)<br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts6(1,z)<br>	tmp_v1.lodverts1x = New lodverts1x<br>	tmp_v1\vert1x=verts6(1,z)<br><br>	<br>	<br>Next<br><br>For z=0 To 63 Step 8<br>	x=1<br>	AddTriangle surf2,verts6(x,z),verts6(x,z+1),verts6(x+1,z)<br>	AddTriangle surf2,verts6(x,z+1),verts6(x,z+1+1),verts6(x+1,z)<br>	AddTriangle surf2,verts6(x,z+2),verts6(x,z+1+2),verts6(x+1,z)<br>	AddTriangle surf2,verts6(x,z+3),verts6(x,z+1+3),verts6(x+1,z)<br>	<br>	AddTriangle surf2,verts6(x,z+4),verts6(x,z+1+4),verts6(x+1,z+8)<br>	AddTriangle surf2,verts6(x,z+5),verts6(x,z+1+5),verts6(x+1,z+8)<br>	AddTriangle surf2,verts6(x,z+6),verts6(x,z+1+6),verts6(x+1,z+8)<br>	AddTriangle surf2,verts6(x,z+7),verts6(x,z+1+7),verts6(x+1,z+8)<br>	<br>	<br>	AddTriangle surf2,verts6(x,z+4),verts6(x+1,z+8),verts6(x+1,z)<br><br><br>	;AddTriangle surf2,verts6(x,z),verts6(x+1,z+1),verts6(x+1,z)<br>Next<br><br><br>;Höger övre kopplings hörn andra tri<br>	AddTriangle surf2,verts6(1,64),verts2(37,36),verts2(37,35)<br><br><br>;Höger nedre kopplings hörn första tri<br>	AddTriangle surf2,verts6(1,0),verts2(37,27),verts2(37,26)<br><br><br>;Höger nedre kopplings hörn andra tri<br>	AddTriangle surf2,verts6(1,0),verts2(37,26),verts2(36,26)<br><br><br><br><br><br><br><br>;Load the height map<br>filein=ReadFile("world.map")<br>sizex=ReadFloat#(filein)<br>sizez=ReadFloat#(filein)<br>For xx=0 To 1023<br>	For zz=0 To 1023<br><br>		wd#(xx,zz)=Float(ReadFloat#(filein))/2<br><br>	Next<br>Next<br>CloseFile filein<br><br>;Global hmap=LoadImage("startworld.bmp")<br>;If Not hmap Then Print "Failed to find bigworld.bmp" : Delay 3000 : End<br><br>;load total height map<br>;For xx=0 To 1023<br>;For zz=0 To 1023<br><br>;	yz#=0<br>;	For x1=0 To 5<br>;		For z1=0 To 5<br>;			y1#=ReadPixel (x1+xx,z1+zz,ImageBuffer(hmap)) And 255<br>;			yz#=yz#+y1#<br>;		Next<br>;	Next<br>	<br>	<br>	;y#=yz#/36.0	<br><br><br><br><br>	;y1#=ReadPixel (xx,zz,ImageBuffer(hmap)) And 255<br>;	yz#=yz#+y1#<br>;	y#=y1#/36.0<br>;	wd#(xx,zz)=y1#<br>;If maxy#&lt;y# Then maxy#=y#<br>;Next<br>;Print xx<br>;Next<br><br><br><br><br>;Set lod heightmap.<br>For i=0 To CountVertices ( surf2 )-1<br>	x=VertexX#(surf2,i)<br>	z=VertexZ#(surf2,i)<br><br>	;yz#=0<br>	;For x1=0 To 5<br>	;	For z2=0 To 5<br>	;		y1#=ReadPixel (x+x1,z+z1,ImageBuffer(hmap)) And 255<br>	;		yz#=yz#+y1#<br>	;	Next<br>	;Next<br><br>	;y#=yz#/36.0<br>	<br>	y#=wd#(x,z)<br><br>	VertexCoords surf2,i,VertexX#(surf2,i),y#,VertexZ#(surf2,i)<br>	VertexTexCoords surf2,i,VertexX#(surf2,i),VertexZ#(surf2,i)<br><br>Next<br><br><br>;Set detail height data<br>For i=0 To CountVertices ( surf1 )-1<br>	x=VertexX#(surf1,i)<br>	z=VertexZ#(surf1,i)<br>	;yz#=0<br>	;For x1=0 To 5<br>	;	For z2=0 To 5<br>	;		y1#=ReadPixel (x+x1,z+z1,ImageBuffer(hmap)) And 255<br>	;		yz#=yz#+y1#<br>	;	Next<br>	;Next<br>	<br>	<br>	y#=yz#/36.0	<br>	y#=wd#(x,z)<br>	VertexCoords surf1,i,VertexX#(surf1,i),y#,VertexZ#(surf1,i)<br><br><br><br><br>Next<br><br>MESHnormals( mesh )<br><br><br><br>texture=LoadTexture("grass.jpg")<br>ScaleTexture texture,2,2<br>EntityTexture mesh,texture<br><br>texture2=LoadTexture("Moss.bmp")<br>ScaleTexture texture2,512,512<br>EntityTexture lodmesh,texture2<br><br>;WireFrame True<br><br>player=CreateSphere()<br>PositionEntity player,EntityX(camera),0,EntityZ(camera)<br>ScaleEntity player,0.5,0.5,0.5<br><br><br>;whater <br>plane=CreatePlane()<br>EntityColor plane,50,50,255<br>PositionEntity plane,0,5,0<br><br><br><br><br>;************* Initziate tree ***************************<br>tree=LoadMesh("tree06.b3d")<br><br><br><br>t_SPRITE=LoadSprite("leaf01_256.tga",1+4)<br>ScaleSprite t_sprite,1,1<br>MoveEntity t_sprite,5,10,5<br>SpriteViewMode t_SPRITE,1<br>t_light=25 ; Default Blade lighnes<br><br><br><br><br>demo_wood()<br><br><br>While Not KeyHit(1)<br>;	MoveEntity camera,0,0,-1<br><br>If KeyDown(17)<br>		MoveEntity camera,0,0,0.1<br>	End If<br>	If KeyDown(31)<br>		MoveEntity camera,0,0,-0.1<br>	End If<br><br>	<br>	smx#=MouseXSpeed()/15<br>	smy#=MouseYSpeed()/15<br>	TurnEntity camera,smy#,-smx#,0<br>	RotateEntity camera,EntityPitch(camera),EntityYaw(camera),0<br>TranslateEntity camera,0,-1,0<br><br>	y#=BilinearInterpValue# ( Float(EntityX(camera)) ,Float(EntityZ(camera)) )<br>	;If y#&lt;&gt;0 Then Stop<br><br>	If y#+0.5&gt;EntityY#(camera) <br>	<br>		PositionEntity camera,EntityX(camera),y#+0.5,EntityZ(camera)			<br>		jumps=0<br>		yspeed#=0<br>				<br>	End If<br>	<br>	<br>	<br>	If KeyDown(200) Then MoveEntity player,0,0,1<br>	If KeyDown(208) Then MoveEntity player,0,0,-1<br>	If KeyDown(203) Then MoveEntity player,-1,0,0<br>	If KeyDown(205) Then MoveEntity player,1,0,0<br><br>	MoveEntity player,0,-1,0<br>	<br>	;Justera Y<br>	y#=BilinearInterpValue# ( Float(EntityX(player)) ,Float(EntityZ(player)) )<br>	;If y#&lt;&gt;0 Then Stop<br><br>	If y#+0.5&gt;EntityY#(player) <br>	<br>		PositionEntity player,EntityX(player),y#+1,EntityZ(player)			<br>		jumps=0<br>		yspeed#=0<br>				<br>	End If<br><br>	;move lod and detail map cords.<br>	If MilliSecs()-oldupd &gt; 2000 And KeyHit(57)<br>	  oldupd=MilliSecs()<br>	;If KeyHit(57)<br>	<br>    	TMP_X=Int(EntityX(camera)-228-32)<br>		TMP_Z=Int(EntityZ(camera)-228-32)<br>		PositionEntity lodmesh,TMP_X,0,TMP_Z<br><br>		<br>		For tmp_v1.lodverts1x = Each lodverts1x<br>		<br>			If tmp_v1\detailvert &lt;&gt;0<br>		<br>		<br>			i=tmp_v1\vert1x<br>			e_tx#=VertexX(surf1,tmp_v1\detailvert);Readxpos of connected detail vertex <br>			e_tz#=VertexZ(surf1,tmp_v1\detailvert);readzpos of connected detail vertex<br>			e_y#=VertexY(surf1,tmp_v1\detailvert)<br>			<br>			;x=VertexX(surf2,i)+ox<br>			;z=VertexZ(surf2,i)+oz<br>			;If z&lt;0 Or z&gt;1023 Then z=0<br>			;If x&lt;0 Or x&gt;1023 Then x=0 <br>			;y#=wd#(x,z)<br>			;VertexCoords surf2,i,VertexX#(surf2,i),y#,VertexZ#(surf2,i)<br>			VertexCoords surf2,i,e_tx#,e_y#,e_tz#<br>			<br><br>			VertexTexCoords surf2,i,x,z<br>			End If<br>		<br>		Next<br>	<br>	<br>	<br>	<br>	<br>	<br>	<br>		TMP_X=Int(EntityX(camera)/8)<br>		TMP_X=TMP_X*8-228-32<br>		TMP_Z=Int(EntityZ(camera)/8)<br>		TMP_Z=TMP_z*8-228-32<br>		PositionEntity lodmesh,TMP_X,0,TMP_Z<br>		<br>		ox=EntityX(lodmesh)<br>		oz=EntityZ(lodmesh)<br>		;Set lod heightmap.<br>		<br>		<br>		For tmp_v8.lodverts8x = Each lodverts8x<br>			i=tmp_v8\vert8x<br>			x=VertexX(surf2,i)+ox<br>			z=VertexZ(surf2,i)+oz<br>			If z&lt;0 Or z&gt;1023 Then z=0<br>			If x&lt;0 Or x&gt;1023 Then x=0 <br>			y#=wd#(x,z)<br>			VertexCoords surf2,i,VertexX#(surf2,i),y#,VertexZ#(surf2,i)<br>			VertexTexCoords surf2,i,x,z<br><br>		<br>		Next<br>		<br>		<br>		<br><br>		<br>		<br>		<br>		;For i=0 To CountVertices ( surf2 )-1<br>		;	x=VertexX(surf2,i)+ox<br>		;	z=VertexZ(surf2,i)+oz<br>		;	If z&lt;0 Or z&gt;1023 Then z=0<br>		;	If x&lt;0 Or x&gt;1023 Then x=0 <br>		;	y#=wd#(x,z)<br>		;	VertexCoords surf2,i,VertexX#(surf2,i),y#,VertexZ#(surf2,i)<br>		;	VertexTexCoords surf2,i,x,z<br>		;Next<br><br>		PositionEntity mesh,Int(EntityX(camera)-228-32),0,Int(EntityZ(camera)-228-32)<br><br>		ox=EntityX(mesh)<br>		oz=EntityZ(mesh)<br>		;Set detail height data<br>		For i=0 To CountVertices ( surf1 )-1<br>			x=VertexX(surf1,i)+ox<br>			z=VertexZ(surf1,i)+oz<br>			If z&lt;0 Or z&gt;1023 Then z=0<br>			If x&lt;0 Or x&gt;1023 Then x=0 <br><br>			y#=yz#/36.0	<br>			y#=wd#(x,z)<br>			VertexCoords surf1,i,VertexX#(surf1,i),y#,VertexZ#(surf1,i)<br>			VertexTexCoords surf1,i,x,z<br>		Next<br><br><br>		MESHnormals( mesh )<br><br>;HideEntity lodmesh<br>	<br>	End If<br><br>animate_leafs()<br><br>	oldms=MilliSecs()<br>	UpdateWorld()<br>	RenderWorld()<br>		MoveMouse 400,300<br><br>	Text 0,0,MilliSecs()-oldms<br>	Text 0,20,y#<br>	Text 0,30,EntityX(player)<br>	Text 50,30,EntityY(player)<br>	Text 100,30,EntityZ(player)<br>	Text 0,50,maxy#<br>	<br>	Flip <br><br>	<br>Wend<br><br><br><br><br><br><br><br><br>Function MESHnormals( tmesh )<br><br>	For l = 1 To CountSurfaces(tmesh )<br>		s = GetSurface( tmesh , l )<br>		For t = 0 To CountTriangles( s )-1<br>			v0 = TriangleVertex( s, t, 0 )<br>			v1 = TriangleVertex( s, t, 1 )<br>			v2 = TriangleVertex( s, t, 2 )<br>			ax# = VertexX( s, v1 ) - VertexX( s, v0 )<br>			ay# = VertexY( s, v1 ) - VertexY( s, v0 )	<br>			az# = VertexZ( s, v1 ) - VertexZ( s, v0 )	<br>			bx# = VertexX( s, v2 ) - VertexX( s, v1 )<br>			by# = VertexY( s, v2 ) - VertexY( s, v1 )	<br>			bz# = VertexZ( s, v2 ) - VertexZ( s, v1 )	<br>			Nx# = ( ay * bz ) - ( az * by )<br>			Ny# = ( az * bx ) - ( ax * bz )<br>			Nz# = ( ax * by ) - ( ay * bx )<br>			Ns# = Sqr( Nx * Nx + Ny*Ny + Nz*Nz )<br>			Nx = Nx / Ns<br>			Ny = Ny / Ns<br>			Nz = Nz / Ns<br>			For v = v0 To v2<br>				VertexNormal s, v, Nx, Ny, Nz <br>			Next<br>		Next<br>	Next<br><br>End Function<br><br><br><br><br><br><br><br><br>;Usefull functions.<br><br>Function BilinearInterpValue# ( x1# , y1# )<br><br>	X_low	= Int ( Floor(x1) )  <br>	X_hi 	= Int ( Ceil (x1) )<br>	Y_low	= Int ( Floor(y1) )<br>	Y_hi	= Int ( Ceil (y1) )<br><br>	;Kepp things in bound :)<br>	If X_low &lt; 0 Or X_low &gt; WX Then x_low=0<br>	If X_hi &lt; 0 Or X_hi &gt; WX Then x_hi=0<br>	If Y_low &lt; 0 Or Y_low &gt; WZ Then Y_low=0<br>	If Y_hi &lt; 0 Or Y_hi &gt; WZ Then Y_hi=0<br><br>	<br>	x_per#	= x1 - x_low<br>	y_per#	= y1 - y_low<br>	<br>	p00# = WD# ( x_low  , y_low  )<br>	p10# = WD# ( x_hi 	, y_low  )<br>	p01# = WD# ( x_low  , y_hi )<br>	p11# = WD# ( x_hi 	, y_hi )	<br><br>	i1# = LinearInterpolate#(p00#,p10#,x_per#)<br>	i2# = LinearInterpolate#(p01#,p11#,x_per#)<br>	<br>	Return LinearInterpolate#(i1#,i2#,y_per#)<br>		<br>End Function<br><br>;thanks too gabrielknight74. philings2@...<br>Function LinearInterpolate#(a#,b#,x#)<br>	Return a#+(b#-a#)*x#<br>End Function<br><br><br><br><br><br>Function animate_leafs()<br><br>	For t_tr.tree=Each tree<br><br>		t_tr\anim=t_tr\anim+1<br>		t_a#=Sin(t_tr\anim)*5<br>	<br>		For i=1 To t_tr\leafs<br>			RotateSprite t_tr\leaf[i],t_a#<br>		Next<br><br>	Next<br>	<br>End Function<br><br><br><br><br><br><br>Function demo_wood()<br>t_area=64<br>For it=1 To 40<br><br>	t_t=CopyEntity(tree)<br>	t_x2#=Rnd(t_area)	+228<br>	t_z2#=Rnd(t_area)+228<br>	t_yy2#=wd#(t_x2,t_z2)<br>	PositionEntity t_t,t_x2,t_yy2,t_z2<br>	<br>	<br>	<br>	t_tr.tree = New tree<br>	t_tr\root=1<br>	<br>	<br>	t_r=Rnd(3)+1<br>	t_filein=ReadFile("tree0"+Str$(t_r)+".t")<br>	<br>	t_tr\root=ReadInt(t_filein)<br>	t_leaf=ReadByte(t_filein)<br>	t_tr\leafs=t_leaf	<br>	For i=1 To t_leaf<br>	    t_obj=ReadInt(t_filein)<br>		t_x#=ReadFloat#(t_filein)<br>		t_y#=ReadFloat#(t_filein)<br>		t_z#=ReadFloat#(t_filein)<br>			<br>		t_tr\leaf[i]=CopyEntity(t_sprite,t_t)<br>		EntityColor t_tr\leaf[i],255,128+Rnd(128),255<br>		<br>		PositionEntity t_tr\leaf[i],t_x#,t_y#,t_z#<br>		<br>		<br>	Next<br>	RotateEntity t_t,Rnd(30)-15,Rnd(360),0<br>	;rad#=Rnd(20)/20.0+0.7<br>	rad#=0.15<br>	ScaleEntity t_t,rad#,rad#,rad#<br>	<br>	<br>	CloseFile t_filein<br>	<br>Next<br><br><br>End Function <br><br><br><br><br><br>;******************************** Pre render *********************<br>Function prerender()<br><br>WireFrame True<br>CameraClsColor camera,0,0,0<br>PositionEntity camera,250,45,300<br>RotateEntity camera,90,0,0<br>UpdateWorld<br>RenderWorld<br>Flip<br>WaitKey<br><br><br>End Function<br>;*****************************************************************<br>[/CODE] <br><br></td></tr></table><br>
<a name="757498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know English isn't your first language but your issue is as clear as mud .. at least to me ;)<br><br>If your code didn't require external files then it'd make more sense once I'd run it.  Can you do a shortened version without this requirement?<br><br>Stevie <br><br></td></tr></table><br>
<a name="757512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> you right.. i restart project..<br><br>i do a better next time :) <br><br></td></tr></table><br>
<a name="757549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now its next time..<br><br>its going well. using entityorder 10 on lod to make it draw on screen first.. thoe got me into trouble.<br><br>some times LOD map dosent clip on right spot. making LOD apear in Air.. verry uggly.. this is common problem.. i thinking of a sollution but never came up with any right now. <br><br><br><br>;Lodworld example v2<br><br>Graphics3D 800,600,16,2<br>SetBuffer BackBuffer()<br><br>camera = CreateCamera()<br>CameraRange camera,0.1,1000<br><br>light = CreateLight()<br><br>Dim verts1(64,64) ; Detail mesh<br>Dim verts2(64,64) ; Lod mesh (Used to display far far landscape)<br><br><br>;------- Detail mesh --------------<br>mesh=CreateMesh()<br>surf1=CreateSurface(mesh)<br>;Skapar pungterna för detail mapen<br>For x=0 To 64 <br>	For z=0 To 64<br><br>		verts1(x,z)=AddVertex (surf1,x,0,z,x,z)<br>		<br>	Next <br>Next<br><br><br>;Kopplar polygonerna i meshen<br><br>For x=0 To 63<br>	For z=0 To 63<br><br>		AddTriangle surf1,verts1(x,z),verts1(x,z+1),verts1(x+1,z+1)<br>		AddTriangle surf1,verts1(x,z),verts1(x+1,z+1),verts1(x+1,z)<br>		<br>	Next<br>Next<br><br>;---------------------------------<br><br><br><br><br>;------- Lod mesh --------------<br>Lodmesh=CreateMesh()<br>surf2=CreateSurface(Lodmesh)<br>;Skapar punkterna för detail mapen<br>For x=0 To 64 <br>	For z=0 To 64<br><br>		verts2(x,z)=AddVertex (surf2,x*10,0,z*10,x,z)<br>		<br>	Next <br>Next<br><br><br>;Kopplar polygonerna i meshen<br><br>For x=0 To 63<br>	For z=0 To 63<br><br>		AddTriangle surf2,verts2(x,z),verts2(x,z+1),verts2(x+1,z+1)<br>		AddTriangle surf2,verts2(x,z),verts2(x+1,z+1),verts2(x+1,z)<br>		<br>	Next<br>Next<br><br>;---------------------------------<br><br><br><br><br><br><br><br>;Loading height map<br>heightmap=LoadImage("heightmap.bmp")<br><br>For x=0 To 64<br>	For z=0 To 64<br>		y=ReadPixel (x,z,ImageBuffer(heightmap)) And 255<br>		y=y/3<br>		<br>		VertexCoords(surf1,verts1(x,z),x,y,z)<br>	Next<br>Next<br><br><br><br><br><br>;Set height map on LOD 10x of detail<br><br><br>For x=0 To 64<br>	For z=0 To 64<br>		y=ReadPixel (x*10,z*10,ImageBuffer(heightmap)) And 255<br>		y=y/3<br>		<br>		VertexCoords(surf2,verts2(x,z),x*10,y,z*10)<br>	Next<br>Next<br><br><br><br><br><br><br><br><br><br><br><br><br>PositionEntity camera,32,50,32<br>;RotateEntity camera,45,0,0<br><br><br><br><br> MESHnormals( mesh )<br><br><br><br>tex_detail0=LoadTexture("grass.jpg")<br>EntityTexture mesh,tex_detail0<br><br><br><br>PositionEntity light,-50000,50000,-50000<br><br><br>EntityOrder lodmesh,10<br><br><br>While Not KeyHit(1)<br><br><br>If KeyDown(17)<br>		MoveEntity camera,0,0,0.1<br>	End If<br>	If KeyDown(31)<br>		MoveEntity camera,0,0,-0.1<br>	End If<br><br>	<br>	smx#=MouseXSpeed()/15<br>	smy#=MouseYSpeed()/15<br>	TurnEntity camera,smy#,-smx#,0<br>	RotateEntity camera,EntityPitch(camera),EntityYaw(camera),0<br><br><br>MoveMouse 400,300<br><br>	UpdateWorld()<br>	RenderWorld()<br>	<br>	Flip<br><br>Wend<br><br><br><br>Function MESHnormals( tmesh )<br><br>	For l = 1 To CountSurfaces(tmesh )<br>		s = GetSurface( tmesh , l )<br>		For t = 0 To CountTriangles( s )-1<br>			v0 = TriangleVertex( s, t, 0 )<br>			v1 = TriangleVertex( s, t, 1 )<br>			v2 = TriangleVertex( s, t, 2 )<br>			ax# = VertexX( s, v1 ) - VertexX( s, v0 )<br>			ay# = VertexY( s, v1 ) - VertexY( s, v0 )	<br>			az# = VertexZ( s, v1 ) - VertexZ( s, v0 )	<br>			bx# = VertexX( s, v2 ) - VertexX( s, v1 )<br>			by# = VertexY( s, v2 ) - VertexY( s, v1 )	<br>			bz# = VertexZ( s, v2 ) - VertexZ( s, v1 )	<br>			Nx# = ( ay * bz ) - ( az * by )<br>			Ny# = ( az * bx ) - ( ax * bz )<br>			Nz# = ( ax * by ) - ( ay * bx )<br>			Ns# = Sqr( Nx * Nx + Ny*Ny + Nz*Nz )<br>			Nx = Nx / Ns<br>			Ny = Ny / Ns<br>			Nz = Nz / Ns<br>			For v = v0 To v2<br>				VertexNormal s, v, Nx, Ny, Nz <br>			Next<br>		Next<br>	Next<br><br>End Function <br><br></td></tr></table><br>
<a name="757947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> (so heightmap.bmp must be 640*640 pixels?)<br><br>I think you should not use EntityOrder 10, nor should you render both. Instead I'd try to use EntityAutofade with both, or if this doesn't work I'd implement a by-vertex entityautofade, based on vertex distance and Vertex Alpha. (altering only vertices alpha that are overlapping detail/LOD areas, noless make sure it's not a bottleneck).<br><br>Basicly I'd suggest to cut huge meshes in pieces. A huge heightmap of say 2560*2560 may render very fast when you make it a grid of individual mesh patches, each one of a few thousand tris.<br><br>Have a look at the ClusterizeMesh sample in the archives. <br><br></td></tr></table><br>
<a name="758216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> what the hell is this?<br>i tested the code and discovered that there are missing external files!<br>and [CODE] or [CoDe] is no tag here.<br><br>if you need webspace uploaders i have one <br><br></td></tr></table><br>
<a name="758303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes ignore this post.<br>i have sen through oblivion trick of lod now.<br><br>they accaly have a kind of entity order trick.<br><br>to solve my above problem was easy.<br><br>just lower the vertex that is under the Detail Mesh. and it shall look just fine.. stay tooned for another post on this matter later.. <br><br></td></tr></table><br>
<a name="758325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey i have ben wrong maby or maby not...<br><br>cause maby i cold just make al vertices of the lod mesh stay under the detail mesh. it can work. :) <br><br></td></tr></table><br>
<a name="808751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ther will be no updates.<br>i have terminted this idea for a while.<br><br>I build gigantic mesh instead. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
