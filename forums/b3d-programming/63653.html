<!DOCTYPE html><html lang="en" ><head ><title >FindChild not working within For loop</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >FindChild not working within For loop</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >FindChild not working within For loop</a><br><br>
<a name="710341"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am currently beating my head against a very annoying problem.  In one place in my code I am using FindChild, and it isn't finding the child.  Thing is, the command works outside the For loop, but inside it doesn't work.  Also, it works the first time through the loop, it's on the second pass that an error happens.  Does anyone have any idea why this would be?<br><br>This is pissing me off, because I'm pretty sure I'm just missing something obvious.  If anyone would like me to send you the code to look at, just email me. <br><br></td></tr></table><br>
<a name="710343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps you are mixing something with the parent you search the child on.<br><br>Normally you need recursion for doing hierarchy research.<br>Without it you can only find the childs of 1 parent, not the child of a child (or only the first child of each child you find which is quite pointless after all)<br><br>Without a code that shows your error, I assume that you assign some bogus to your entity on which you search for childs. (or you search for childs on something you loaded through loadmesh instead of loadanimmesh or on a bone etc) <br><br></td></tr></table><br>
<a name="710344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> try this by skn3[ac]..its really handy..<br>at begin of program put this<br>;This value is used to size the buffer bank below. If the data needs more space,<br>;it will resize the bank in blocks of the amount below. (in bytes, 1k = 1024 bytes)<br>Const recursive_resize=1024<br><br>;This bank is used in each call to the search function. It is outside the function,<br>;as creating and deleting over and over from memory, can cause fragmentation, not...<br>;to mention slow downs.<br>Global recursive_bank=CreateBank(recursive_resize),recursive_size=recursive_resize<br><br>;These are misc values, having them defined as global speeds up the function as...<br>;they don't need to be created/destroyed each time the function is called<br>Global recursive_entity,recursive_parent,recursive_id,recursive_start,recursive_total,recursive_offset<br><br><br><br>;The function<br>;It will return the entity if found, or 0 if not.<br>;MyChild=findchildentity(entity,"child name")<br>Function findchildentity(entity,name$)<br>	name$=Lower$(name$)<br>	recursive_parent=entity<br>	recursive_start=1<br>	recursive_offset=0<br>	.recursive_label<br>		recursive_total=CountChildren(recursive_parent)<br>		For recursive_id=recursive_start To recursive_total<br>			recursive_entity=GetChild(recursive_parent,recursive_id)<br>			If name$=Lower$(EntityName$(recursive_entity))<br>				Return recursive_entity<br>			Else<br>				If recursive_offset+8 &gt; recursive_size-1<br>					ResizeBank(recursive_bank,recursive_size+recursive_resize)<br>					recursive_size=recursive_size+recursive_resize<br>				End If<br>				PokeInt(recursive_bank,recursive_offset,recursive_id+1)<br>				PokeInt(recursive_bank,recursive_offset+4,recursive_parent)<br>				recursive_offset=recursive_offset+8<br>				recursive_start=1<br>				recursive_parent=recursive_entity<br>				Goto recursive_label<br>			End If<br>		Next<br>		If recursive_offset=0<br>			Return 0<br>		Else<br>			recursive_start=PeekInt(recursive_bank,recursive_offset-8)<br>			recursive_parent=PeekInt(recursive_bank,recursive_offset-4)<br>			recursive_offset=recursive_offset-8<br>			Goto recursive_label<br>		End If<br>End Function <br><br></td></tr></table><br>
<a name="710347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> No dude, the need for recursion doesn't apply to FindChild.  As I said, it works fine outside the loop, and even works the first time through the loop, it's on the <i>second</i> pass that it fails.  Specifically, I put a FindChild for testing immediately before For, and then again immediately after, and throw in a Stop so that I can watch the variables changing.<br><br>This would obviously mean that I must be doing something to the parent entity somewhere in the body of the loop, but I cannot find it.  I must be going blind.<br><br>EDIT: Whew, okay after venting a bit I was able to look at my code with calmer eyes, and saw the problem.  Within the loop, I was using EntityParent to reassign the child.  When I commented out that line, FindChild works fine.  Now to figure out how to accomplish what I was trying to do with EntityParent, but in a different way... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
