<!DOCTYPE html><html lang="en" ><head ><title >Triggers (Trigger Events)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Triggers (Trigger Events)</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Triggers (Trigger Events)</a><br><br>
<a name="1004511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DMan</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi guys!<br><br>It's sad to see that my last post was 2 years ago, and I haven't had the time to do anything I wanted in that time, due to lack of time...<br><br>Well, I decided I'll get out of the rat race and rip the time a new a-hole and do something I've always wanted with Blitz :]<br><br>I created a series of portals (two sided vertical  planes) along the level and would like to switch location of an object each time the player goes through these portals, putting the object to different locations depending of the side of the portal entered.<br><br>Also remember that since the portals are two sided, when the player enters the portal from one direction it switches the object to a different location than when the player enters the portal from the opposite direction.<br><br>The problem also arises when the player enters(colides with) the portal and then while remaining mid portal decides he'll go back, how would I make it so it switches the object back to where it was before entering the portal. <br>Could I perform some sort of check like IF the player is more than half way through the plane it would switch the object to the new location otherwise remain at the old location, and switch it back to the old location if he decides to turn around and go back in mid portal position.<br><br>*as a side note - I want the solution to be as fast as possible, no resource hogging (none of the excess vector checks etc.. like with all the portal plane entity distance check for each portal every frame) *<br><br><br>Apart from that, I'm interested in all sorts of triggers to trigger events possible in blitz. I know we can check EntityDistance, <br>we can check for Collision and then trigger something, anything else? <br>Which methods are the fastest?<br>Pseudocode examples of different sorts of triggers would also be welcome for all us blitz users, to come back here and have them all under one topic.<br><br>Thank you guys and looking forward to the answers,<br>I wish you the best in 2010! <br><br></td></tr></table><br>
<a name="1004530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could have two sets of portals. The player has to go through the two sets, a small distance apart (but bigger than the player), in order to trigger the object to get moved. Give each pair of portals it's own flag or variable.<br><br>For instance, he hits the first portal, the portals flag gets set to 1. Upon hitting the next portal, again, the portal flag/variable is set to one, for that portal. You check both flags. If they are both set to 1 then you move the item.<br><br>You need to set the portals though, so the flag toggles everytime you go through it. AND, these portals only work the one way. If you want the item to go somewhere else upon entering from the other direction, set up another 2 portals.<br><br>This method will require more portals, but, you have no vector checking. As long as the player can't fly over the portal areas, or circumvent them, then it should be fine. Oh and i think your best using pivots for portals, and using entity distance to check to see if your withing distance.<br><br>In my last project, i forced the character through narrow area, in order to trigger events, and geometry hiding.<br><br>Oh and entitydistance is stupidly quick. <br><br></td></tr></table><br>
<a name="1004554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DMan</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Ross!<br><br>Thank you for replying.<br>So you think i should use pivots with entitydistance(pivot,player) and choose the nearest one to switch instead of a whole bunch of portals? What do you think is the best way? <br>The problem with checking for distance is wide coridors, <br>where the player could go by the extreme of the wall and get by the pivot activation trigger distance, if for instance the pivot is located in the middle of corridor.<br>Or the distance checked could be too wide for the purpose.<br><br>Could you write a line or two of code, for your two portal method (flag and collision checking)? <br>Also do you think that two sided planes can't be used? And for instance when the player leaves the two portal zone, the last portal left would then be used as the switch for new entity position.<br><br>Thank you bro<br>Greets! <br><br></td></tr></table><br>
<a name="1004586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can have fast portals when you can manage to align them to the world. I mean, If a trigger zone is considered a cube, the Rotation must be 0,0,0. This way you can determine the min and max vertex xyz, store it in an array and do a "is the player inside the trigger box?"-check very quickly. You can visually use these trigger meshboxes in your design app, in the game the box can be deleted after the minmax determination.<br><br>I sometimes use ON and OFF triggers. This may be something as Ross said. To reach a new Section, first the player has to cross the OFF box, then the ON box. Now, when he decides (eg. in the middle of the way between the 2 sections) to go back, he will automaticly turn the thing off as his latest action (no matter if it is on or not) within this 2-Box portal trigger. But when he actually reaches the new section, he must have crossed the ON box.<br><br>I guess you can use the same principle to position things. Especially when you position them back ANYWAY when the player goes trough the OFF Box. <br><br></td></tr></table><br>
<a name="1004596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DMan</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi JFK!<br><br>Thank you for your answer!<br>Could you show me how you do it with simple code please? <br><br></td></tr></table><br>
<a name="1004658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if this is what you're after, but I have some code in the code archives for double-sided triggerplates using proxy collision objects.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1901" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1901</a><br><br>My OBB code may also be useful to you.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1920" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1920</a> <br><br></td></tr></table><br>
<a name="1005970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DMan</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you for replying guys, I'll take a look at your trigger plate system Bill. <br><br></td></tr></table><br>
<a name="1007154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> 3DMan sorry for the delay, I was AFK.<br><br>You really don't need much code. You only need to understand what I mean.<br><br>In my exampe I want to turn on (Showentity) a Mirror (CreateMirror) as soon as the player is getting close to it, but still before he can see it of course, because I don' want it to pop in. So there is a zigzag corridor the player is walking trough. There are two boxes intersecting with the corridor in a way that the player must go trough the boxes (and they must be big enough so he will be at least for one frame inside such a box, even in full running speed or so).<br><br><br>Now the trick is very simple: when the player crosses the first box, we hide the Mirror. The Player will then pass/cross the 2nd box later on his way (note, the 2 boxes may NOT overlap). Now we show the mirror. If the player is going to leave the mirror area later, he will first cross the 2nd Box. This will turn the Mirror on again, regardless of the fact that it IS already turned on (!). Then the player crosses the 1st box and this will finally turn it off (hide) again, as it sould be when the player isn't there anymore, in the mirror section.<br><br>I don't know exactly how your level design works, but as I already suggested, you could use simple box meshes to define the trigger boxes.<br><br>You load them like other map elemets. Then you parse the vertices of these cubes and store the min and max xyz in an array or type.<br><br>Finally you check in your game main loop if the player is located inside one of the boxes, by comparing his location with the xyz min max data.<br><br>What you need it TFormPoint to get the world coordinates of the vertices. This ia all very basic and if you don't know how to code it then you really should learn these Basics first.<br><br>Here's some pseud code:<br><br><pre class=code>

xmax#=-1000000
xmin#= 1000000
for su=1 to countsurfaces(mesh)
 s=getsurface(mesh,su)
 for i=0 to countvertices(s)-1
  x#=vertexX(s,i)
  y#=vertexY(s,i)
  z#=vertexZ(s,i)
  Tformpoint x,y,z,mesh,0
  x=TformedX()
  y=Tformedy()
  z=Tformedz()
  if x&gt;xmax then xmax=x
  if x&lt;xmin then xmin=x
  ...
 next
next
</pre><br><br>so this way you can determine the smallest and the biggest X value of any of the vertices of a mesh. Of course you do the same with y and z. this will give you the coordinates of the 8 corners of such a cube. Once determined, the cube mesh may be removed with FreeEntity.<br><br>Assuming you have stored the min and max data in arrays named minx#, miny#, minz# and maxx#, maxy# and maxz# you would then do something like this:<br><br><pre class=code>
x#=entityx(player)
y#=entityy(player)
z#=entityz(player)

for i=0 to count-1
 if x&gt;minx(i) and x&lt;maxx(i)
  if y&gt;miny(i) and y&lt;maxy(i)
   if z&gt;minz(i) and z&lt;maxz(i)
    ; bingo, we're inside cube number i
   endif
  endif
 endif
next
</pre><br>(note: just fixed a typo so if it didn't work before then try again. And added TFormPoint Sample, btw.) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
