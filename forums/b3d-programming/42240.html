<!DOCTYPE html><html lang="en" ><head ><title >Movement relative to framerate</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Movement relative to framerate</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Movement relative to framerate</a><br><br>
<a name="473363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Originally I programmed my game to run at 40 fps. Then I decided I did not want this limit (mainly because my own computer couldn't run it that fast) and just let it run as fast as possible but then make all the movement relative to the current framerate. This was fairly simple, I have a variable like this :<br><br>unit=Float(frameDuration)/25.0<br><br>(frameduration is the difference between the last time and this time in milliseconds).<br><br>Then if I would want to move a character 0.5 unit every 40 frames, I just move it 0.5*unit. If the game runs at only 20fps, this would move it by 1 each frame, if the game runs at 80fps this will move it by 0.25 - so that's correct.<br><br>The only problem is when jumping. Basically my jumping works like this (simplified) :<br><br>If you press jump :<br>player\dy#=0.55<br><br>Every frame :<br>player\dy#=player\dy#-0.05<br><br>MoveEntity player\entity,0,player\dy#,0<br><br>Now my question is, how do I modify this so it also uses my unit variable, and that the player still jumps equally fast and equally high no matter what the framerate is (just more or less smoothly)? I just can't seem to get my head around this...<br><br>Thanks. <br><br></td></tr></table><br>
<a name="473369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> --==forget it==-- <br><br></td></tr></table><br>
<a name="473370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You may find it easier to use two variables to store the amount that each object ( in this case the player ) has moved this frame. Every time you find yourself modifying the position, just add to or subtract from these variables instead. Then at the end of your update function, right before you moveentity ( you only have to move entity once now ) multiply the change variables by your unit multiplier and move the player. <br><br></td></tr></table><br>
<a name="473377"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> --==forget it==-- <br></div><br>why?<br><br>Sybixsus : I'm not sure if I fully understand, but I'll experiment and see if I get it to work. Thanks! <br><br></td></tr></table><br>
<a name="473384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> multiply both by 1/unit. <br><br></td></tr></table><br>
<a name="473388"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> multiply by 1/unit <br></div><br>Multiple what by 1/unit? The amount I move the player with moveentity? The amount I substract from dy#?<br>Thanks. <br><br></td></tr></table><br>
<a name="473390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, sorry,  both of the forces..<br><br>player\dy#=0.55 * 1 / unit<br><br>Every frame : <br>player\dy#=player\dy#-0.05 * 1 / unit<br><br>Hmm.  No that's not right either.  Back to physics 101 <br><br></td></tr></table><br>
<a name="473392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> why? <br></div>LOL, sorry for not having been crystal clear. I just made a post that I wanted to remove, that's all. <br><br></td></tr></table><br>
<a name="473397"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Sybixsus : I'm not sure if I fully understand, but I'll experiment and see if I get it to work. Thanks! <br></div><br><br>Sorry if my explanation wasn't great. All I'm saying is store up all your movements ( in variables or type fields ) until the end of the game loop. Then combine them all into one single total amount which your character will move on each axis, and multiply *THAT* by your unit multiplier.<br><br>EG: In a complex game, where your character is being affected by all sorts of things, it might be something like this : <br><br>The Y value might be affected by +0.2 due to an airflow from below, -0.05 from gravity, and -0.1 from some other force.<br><br>Total them to make +0.05 and multiply *THAT* number by your multiplier. <br><br></td></tr></table><br>
<a name="473449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, but that wouldn't work. For instance, let's say the multiplier is 1 when it's running at 50fps, and 2 at 25 fps.<br><br>Now after 80 millisecs (4 frames at 50fps or 2 frames at 25fps), I will have added (Y * 1) 4 times at 50fps, and (Y *2) two times at 25fps.<br><br>If I give Y an intial value of 5, and each frame I decrement Y by 1 at 50 fps and by 2 at 25 fps :<br><br>At 50 fps : 4 + 3 + 2 + 1 = 10 total movement<br>At 25 fps : 0 + 3 + 0 + 1 = 4 total movements<br><br>(The zeroes are frames that aren't executed because it runs at half the fps, they're just there as dummy numbers, hope this is clear).<br><br>After Experimenting a lot in excell with collumns showing the progress at different FPS, I figuered out this formula :<br><br>dy=dy-unit<br><br>i=((unit^2)-unit)/2<br><br>(^ couldn't think of a fitting name for this variable :))<br><br>At 50 fps, i will be 0. At 25fps, i will be 1. At 12.5fps, i will be 6, at 100 fps, i will be -0.125.<br><br>movement = (dy*unit)+abs(i)<br><br><br>50.0 fps : 4 + 3 + 2 + 1 = 10 total movement<br>25.0 fps : 0 + 7 + 0 + 3 = 10 total movement<br>12.5 fps : 0 + 0 + 0 + 10 = 10 total movement<br><br><br>Sorry if I didn't explain it clearly, it's a bit complicated, but as far as I can see, it's correct. <br><br></td></tr></table><br>
<a name="473453"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> To clarify, here's an export of my excel document I used :<br><br><a href="http://www.ontspoord.com/stuff/jumpspeed2.htm" target="_blank">http://www.ontspoord.com/stuff/jumpspeed2.htm</a><br><br>The collumn on the left is the milliseconds. The number under the "move"-collumn shows the amount I have to move my player character that frame, and can be calculated with the formula I posted in my last post. <br><br></td></tr></table><br>
<a name="473460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Correction... If you want to modify dy# by another amount than unit, i needs to be multiplied by that amount :<br><br>dy=dy-(AmountToSubstractFromDY*unit)<br><br>i=(((unit^2)-unit)/2)*AmountToSubstractFromDY<br><br>movement = (dy*unit)+abs(i)<br><br>That seems correct, but could still be wrong. I'll do some more testing, if I find something I'll post it here. <br><br></td></tr></table><br>
<a name="473729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> ;-- <br><br></td></tr></table><br>
<a name="473820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> He is talking about jumping.  Now the physics stuff I have seen usually work this out with elapsed time from the start of the event and absolute positioning, so you would have something like :<br><br>Ypos = Inital_Ypos+0.5*gravity*jumptime^2+jumpforce*jumptime <br><br>for instance (which will obviously work well given any reasonable frame time).  <br><br>So the  problem was to get it to work with delta time and relative positioning which I think he has got pretty close to.  It should be possible to convert the above formula to a delta time method, but I have not worked it out yet or improved on what fall_x has come up with.<br><br>I guess you can avoid the problem by running your code at a set frame rate and using render tweening, as seen in the castle demo, although that can introduce other issues. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
