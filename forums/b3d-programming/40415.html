<!DOCTYPE html><html lang="en" ><head ><title >changing textures?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >changing textures?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >changing textures?</a><br><br>
<a name="453592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry this sounds like such a stupid question, but I have not had to do this bit before.<br><br>ok,... so if I assign a texture to an entity like this.<br><pre class=code>
box=createcube()
boxtex=loadtexture("texturename.jpg")
entitytexture box,boxtex
</pre><br>but later want the user to be able to select a different texture, what is the best way to do this?<br><br>freetexture only clears up the texture, but not what has been applied already, so is there a problem with piling this on top of the previous code?<br><pre class=code>
freetexture boxtex
boxtex=loadtexture("texturename2.jpg")
entitytexture box,boxtex
</pre><br>What happens to the original texture? is it overwritten? if not how do I delete it? Or do I need to freeentity and re-texture?<br><br>Edit: one thing I thought of was to simply load the new texture as an image, and copy it to the texture, but that seems clunky, and also brings up the problem of different texture resolutions.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="453600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> you see, blitz has something under the hood called reference counting.  basically this means that each resource, such as meshes, textures, and so on, keeps track of how many things are currently pointing to it.<br><br>when you load a texture, its refcount is set to 1.  then you texture an object with it, and that bumps the refcount to 2.  now, you retexture the object with a new texture, and the old texture's refcount is dropped to 1 - but it's still in memory.   when you call freetexture, it drops the refcount again - and when the refcount reaches 0, it is truly deleted from memory.<br><br>you, as the blitz programmer, don't have to worry about any of this.  all you have to do is just use EntityTexture again on the entity, and blitz will take care of the rest.  believe me - it will not hurt to have two textures for your box in memory.  if you truly don't need the original texture, you can free it. <br><br></td></tr></table><br>
<a name="453621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok,... here's a bit of a followup question then. My biggest concern is having an essential memory leak with textures taking up resources even though they are not used.<br><br>suppose I have another texture overlaid on top of the first one, but the second one is a reflection using additive mode. Now when I apply the new texture, it covers not only the original texture, but also the secondary reflection texture. I hope you can see my problem here. The old textures will still be there on the entity, correct? (even though at this point they are covered over, they are still using resources)<br><br>Ultimately, this is only being used in an editor and only 1 texture and 1 reflection will be saved out, so I don't think it will be much of an issue, but I'm trying to do it the "correct way" if there is such a thing.<br><br>edit: just re-read your post again,... if I understand you correctly, then the old textures will be removed once 1) the texture has been freeTexture'd, and 2) a new texture has been applied? <br><br></td></tr></table><br>
<a name="453639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> your edit is correct.  after you free a texture and retexture any objects that use that texture, it will be freed from memory.  <br><br>just to clarify - when you apply a new texture to an object, the old one has nothing to do with the object anymore - it's just sitting in memory (unless, of course, its refcount is 0, in which case it's destroyed).  so, unless you explicitly free a texture with FreeTexture, it will remain in memory until the end of the program.  if you're doing an editor where you'll only have one texture at a time, then yes, it's a good idea to free the old texture.  if you're reusing the texture handle for the new texture, then it's necessary to delete the old texture before loading a new one into the handle, or else you will in fact get a leak.<br><br>i wasn't sure what your intentions were with your first post, which is why i was somewhat dubious about the texture freeing.. but now that i know that it's a not-so-performance-critical editor, freeing and reloading is fine :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
