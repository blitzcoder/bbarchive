<!DOCTYPE html><html lang="en" ><head ><title >Scripting many levels</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Scripting many levels</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Scripting many levels</a><br><br>
<a name="579607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grovesy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>I'm just wondering how people go about coding the different game levels!<br><br>For example setting up triggers, level objectives etc for each level. I guess one way would be to have some sort of scripting language, but this sounds pretty complicated! isn't it?<br><br>One idea I had was to just hard code the events of each level. But this would result in a hugh select statement, which will be very inefficant. One way to reduce this inefficancy it to have nested select statements, to allow grouping of levels.<br><br>What do you guys think and what do you guys do?<br><br>Cheers <br><br></td></tr></table><br>
<a name="579651"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need a level config file. Your game is then absolutely non-hardcoded (as non-hardcoded as possible!), softcoded sotosay. Whatever content it loads, it's taking the file paths, positions, rotations, scaling etc. from the levelconfig file.<br><br>This way you can have multiple levels with the same EXE. Just make sure the EXE is also capab le of UNLOADING all content of a level properly, so you can load the next level right away.<br><br>Now how is that config file created? I wouldn't write it manually, instead (depending on the kind of game you want to create) you need to build your special Editor that lets you load and organise things for a level and finally save all your actions in the level config file.<br><br>In my case I have a FPS game engine. The Level Editor allows to walk around in the main level mesh. From time to time I drop some things, furniture etc. (hence "dropper"). IT works this way: whenever I feel like this place needs say a chair, I hit the right mouse, choose "chair.3ds" fromthe file requestor and zac there it is, a chair. To make this even faster I can use CTRL-C and CTRL-V to copy paste charis, tables, doors and so on.<br><br>Every object in my data structure has its position coordinates, Rotation, scaling, color, texture, FX etc. etc. etc. Virtually everything that i would probably need to set the properties of some content.<br><br>One additional property is ne so called Action String. It's a string for every object that allows to use some special directives like weapon, key, ammo, medi, bonus, exit etc.<br><br>It is then up to the engine to take special actions when the user clicks or shoots those objects with a special action string.<br><br>While this method still limits a level to use only a number of possible actions (in re- and interactions), it gives the player the feeling of an individual level.<br><br>Just make sure you won't make the same mistake like many publishers: the same goal in every level. That's boring after 3 levels. <br><br></td></tr></table><br>
<a name="579768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grovesy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers jfk, I did already pretty much understand that part, and infact will probably use the ALE to build my levels and drop my meshes in (as ALE will make a text file containing all the information about the object). but what about triggers and action scripts?<br><br>I see you touched on the subject brifely. For example in one level i might want a set of actions like:<br><br>Spawn 100 enemies from location x,y,z;<br>When all ememies are dead spawn 10 enemy vehicles at x,y,z;<br>When all vehicles are dead, create explosion at x,y,z;<br>Wait 10 seconds;<br>Display text "Level complete";<br><br>How would one start to implement something like this?<br><br>Thanks again <br><br></td></tr></table><br>
<a name="579970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're looking for a scripting engine. One easy solution (the best solution I'd say, but I'm pretty biased :) )is to use BVM. Check my sig. <br><br></td></tr></table><br>
<a name="579974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cash</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been using blitz for a while now and also puchased the csp engine (very good)<br><br>how do<br>you read from a text file into Blitz..<br>Well what I mean is <br><br>player=loadanimmesh("the first line from a text file")<br>ammo=loadmesh("the fourth line from a text file")<br><br>what would the syntax be ? <br><br></td></tr></table><br>
<a name="580013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks cash!<br><br><br>That would be something like<br><br><pre class=code>
re=readfile("players.dta")
player_file$=readline(re)
player_name$=readline(re)
player_party$=readline(re)
closefile re

if filetype(player_file$)=1 ; file exists?
 player(count)=loadanimmesh(player_file$)
 name$(count)=player_name$
 party$(count)=player_party$
 count=count+1
endif
</pre><br><br>Assuming there is a file named "players.dta" with the following content:<br><br>myplayer.b3d<br>Freddy<br>Soviet<br><br>The file can be created with notepad, or any other tool.<br><br>Using ReadLine is very straight forward. You won't have to worry about String delimiters etc. simply use 1 line=1parameter. You can also use numeric values that way, they will be converted from strings to float or int automaticly. This method also allows to open the file in a text editor and alter/check things manually.<br><br>Reading things from a file is simple, but you should not put the player and the ammo in an unsorted list. Instead your File(s) need a structure that can be recognized by the engine. There are several methods, one is the fixed LEnght parameter blocks method (that's what I use most times):<br><br>There is a number of objects in a list and each block has a fixed number of lines, eg:<br><br>mesh path<br>position x<br>y<br>z<br>pitch<br>yaw<br>roll<br>scalex<br>scaley<br>scalez<br>entityFX<br>ENtityAlpha<br><br><br>Basicly you should sit down and write your list of parameters you plan to use. It may be a good idea to "wrap" every possible property, simply parse the command reference to see all possible entity Properties. You best add a dozen or so of "reserved" lines to the block structure, for future updates.<br><br>Although this method may seem uneconomical, you will only waste a couple of kilobytes after all, it's a straight forward method. simply read all bocks of a file until EOF is reached.<br><br>An other method will use variable names and values. This way the blocks may have an individual lenght. But it also complicates things.<br><br>FILEPATH<br>ammobox.3ds<br>X-LOCATION<br>312.5<br>and so on...<br>END_OF_OBJECT<br>FILEPATH<br>crate.b3d<br>X_LOCATION<br>...<br><br>You see you need to store only the required parameters, Undefined properties may use default values (like EntityFX or EntityAlpha etc.)<br><br>So the level items can be positioned easily this way, but I would suggest to use a diffrent, special structure for an entity like Player 1, or AI Bots or Multiplayer Chars etc. Maybe you should even use a seperate File for the player info. <br><br></td></tr></table><br>
<a name="580108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paolo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> JFK,<br>in your engine, when you throw things into the scene (chairs and so),<br>how do you handle lightmapping for the whole room and pathfinding for enemies avoiding the furniture?<br>Thanks!. <br><br></td></tr></table><br>
<a name="580109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chad</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey JFK,   the CSP engine is available to purchase??  Since when and where do I get it at? <br><br></td></tr></table><br>
<a name="580169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >lo-tekk</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Grovesy,<br>i have set up an userlib for Lua scripting language. With this<br>is absolutely easy to get any values from a file, you don't even have to care about filehandles or amount of lines.<br>Such a lua file would look like so:<br><pre class=code>
--- screen.ini
screen = { width=800, height=600, depth=16, mode=2 }
</pre><br>Then you call the values from within the file:<br><pre class=code>
Include "BlitzLua.bb"

Function InitGraph3D (state%)
	; Here is the calling code
	LUA_callScript(state, "screen.ini")
	
	scrW = LUA_getKeyInt(state, "screen", "width")
	scrH = LUA_getKeyInt(state, "screen", "height")
	scrD = LUA_getKeyInt(state, "screen", "depth")
	scrM = LUA_getKeyInt(state, "screen", "mode")

	Graphics3D scrW, scrH, scrD, scrM
	SetBuffer BackBuffer()
End Function

luaState = LUA_Init ()
InitGraph3D (luaState)

cube = CreateCube()
light  = CreateLight()
cam  = CreateCamera()

PositionEntity cam,0,0,-10

While Not KeyHit(1)


	TurnEntity cube,0,1,0
	
UpdateWorld
RenderWorld
Flip

Wend

lua_close(luaState)
ClearWorld
End
</pre><br><br>Get it from www.moonworx.de it's free.<br><br>----------------------------------<br>www.moonworx.de <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
