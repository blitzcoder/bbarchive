<!DOCTYPE html><html lang="en" ><head ><title >Room Networks</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Room Networks</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Room Networks</a><br><br>
<a name="1009758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello. I noticed a really useful technique in "Metroid: Prime Hunters" for the DS? If you've played it, you probably wondered why when you shoot a door, sometimes you have to wait for 10 seconds or so until the door finally opens. Then, you might have figured out that each room is a separate model and when you shoot a door, it loads the next room model "on the fly" and when it's finished, it opens the door and displays it. When you go in the next room, the previous room is still visible until you get far enough away from the door for it to close automatically. The instant the door closes, the previous room is unloaded. This is a really useful method to save memory, and stay within your polygon quota with speed and detail in a large building or world. I'm trying to figure out how to reproduce this technique in B3D, but I don't know how to go about it. I know that model children can be taken advantage of in B3D. (can you give children names in modelers?) So, could I make each room with its doors and somehow associate the name of the model each door load with the door child? I thought of using an array, and just say "show current room, +1, and -1", but that would only work if the rooms were in a linear path with no branch-offs. So, any suggestions? <br><br></td></tr></table><br>
<a name="1009759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, comments in the settings of child objects (in DeleD). Just in case that might be useful.. <br><br></td></tr></table><br>
<a name="1009881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've sseen many sugegstions to this kind of "portalling" done by having various 'rooms'* (*and their contents) parented to a pivot, the pivots can be hidden, to remove the rooms* from collision/rendering.<br><br>Modellers do allow for naming, though I'm not sure precisely whihc formats retain the information when loaded into B3D.<br>-----------------------<br>Perhaps giving the spearate doors a name or tracking them in a Type/array structure can allow for the specific 'rooms' to be identified according to the door 'chosen'? <br><br></td></tr></table><br>
<a name="1010022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. I'm going to have the doors open when the distance between the camera and the door is smaller than a value. How would I have it detect which side of the door I'm on? It somehow needs to know which room to hide when it shuts. I'm very reluctant to make a separate model with boxes to tell what room it's in. Is there another way?? <br><br></td></tr></table><br>
<a name="1010042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think your right except for the previous room doesn't unload until you go through a different door. If you walk from Room1 to Room2 and the door shuts, Room1 is still there because you can open the door again and there's no delay. But if you go from Room2 to Room3, Room1 is unloaded. <br><br></td></tr></table><br>
<a name="1010097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you saying I should keep Room1 loaded, or let Room1 keep being rendered? Aside from memory usage, I'm also trying to keep the polygon count down so I can make individual rooms very high quality. There's no need to render the rooms the camera can't see. Just use HideEntity, because you're no longer in the room - no need for collisions, and there's a closed door blocking the room - no need to render. Just don't unload it until you're two rooms away. <br><br></td></tr></table><br>
<a name="1010102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use Tformnormal/vector/point to determine if you are in front of or behind the door.<br><br>ie TformPoint myx,myx,myz,0,door<br><br>where myx-myz are the coordinates of the player or other creature to be checked<br><br>"0" indicated world space<br><br>"door" indicates door local space<br><br>if tformedz()&gt;0 then you are on one side of the door<br>if tformedz()&lt;0 then you are on the other side of the door<br>(assuming forward facing for your door is along the z-axis) <br><br></td></tr></table><br>
<a name="1010126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Just don't unload it until you're two rooms away.  <br></div><br>Exactly.<br><br>Another two ways you could check which side of the door you are on.<br>1. Make a trigger inside the door that checks if your Mesh Intersects with it. If so, it toggles a variable that decides which side you are on.<br>Ex. Variable1 = 0 in Room1<br>When you touch the trigger Variable1 = 1 meaning you're in the next room.<br><br>2. You could place a pivot on either side of the door and get the distance from the player to each pivot and decide which one you are closer to. <br><br></td></tr></table><br>
<a name="1010146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK. I've got SOME stuff so that it works right. Now all I need to know is how to do the door opening and closing stuff. I have everything in the same model with names and I'm just using model children to call things. Unfortunately, the model childrens' XYZ coordinates aren't stored properly or something, so it returns all of their coordinates as 0,0,0. So, does this mean I'll have to use a dropper? I actually think it would be better because then I could put the code in a door type instead of tediously retyping code for each one. <br><br></td></tr></table><br>
<a name="1010177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds to me like a global/local issue.<br><br>The local coordinates of any children will be relative to their parent which is at 0,0,0 whilst the Global coords will be relative to the 'world'<br><br>Functions such as PositionEntity or EntityX() etc have an optional flag to specify whether to use the Global coordinates.<br><br>For example:<br><br><pre class=code>
Graphics3D 800,600,32,6
SetBuffer BackBuffer()


Camera=CreateCamera()

;just create some entities, note, they're not yet parent/child related, so both act as global
;By default EVERYTHING is positioned at 0,0,0 when no parent is specified in Creation

ParentCube=CreateCube()
ChildSphere=CreateSphere()

;The PARENT is going to be at Z=5 (world coords - global)
PositionEntity ParentCube,0,0,5
;The CHILD is still at Z=0 (world coords -global)

;Let's make sure the camera can see the objects
MoveEntity Camera,0,2,-5
PointEntity Camera,ParentCube

; Now the relationship is formed
EntityParent ChildSphere,ParentCube

RenderWorld
Flip

Print "Local Coords of child (local relative to Parent): "+Str(EntityX(ChildSPhere))+" x "+Str(EntityY(ChildSPhere))+" x "+Str(EntityZ(ChildSPhere))
Print "Global Coords of child (local relative to World): "+Str(EntityX(ChildSPhere,True))+" x "+Str(EntityY(ChildSPhere,True))+" x "+Str(EntityZ(ChildSPhere,True))
WaitKey()
</pre><br><br>In the above code, although GLOBALLY the Cube is at +5 on the Z axis and the Sphere is at 0, the LOCAL coordinates display the relationship between the two, so the child Sphere is shown to be at -5<br>as 0 is 5 -5 <br><br></td></tr></table><br>
<a name="1010206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, thanks.. I tried that too. It still thinks that every door is at 0,0,0. Thanks for trying but I think it would be more intelligent to use a dropper. Thanks! <br><br></td></tr></table><br>
<a name="1010208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry to hesar that doesn;'t solve theproblm - not sure what it might be then, unless yyou're not referring to the correct entity?<br><br>Good luck, I think some of the ideas in this thread are really useful.<br>Out of curiosity, what is a dropper? <br><br></td></tr></table><br>
<a name="1010217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if I'm using the right term, but from what I've heard, a "dropper" is a program that makes allows you place objects visually instead of trial and error with coordinates. It's easy enough to make a primitive dropper specifically for the development of your game. <br><br></td></tr></table><br>
<a name="1010219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you basically mean Map Editor. About the door.. when you export it is the model at 0,0,0 in the 3D Modelling Program? When Blitz loads a mesh, it starts at the center so if your vertices aren't there, then it will seem as if the programs are against you and want nothing but to confuse you. <br><br></td></tr></table><br>
<a name="1010257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really don't think it can be a relative positioning problem, because no matter where the door is, it always reads as 0,0,0. <br><br></td></tr></table><br>
<a name="1010280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, so here is what I've gotten so far from this:<br><br><a href="http://host-a.net/ClayPigeon/RoomEngine.zip" target="_blank">http://host-a.net/ClayPigeon/RoomEngine.zip</a><br><br>You can uncomment the Wireframe True part to see the problem.<br>In the CreateDoor function, you specify the two neighboring rooms on either side of the door. But, the way I have it set up, two or more doors won't mix in the same level correctly. How would I fix this??<br><br><b>EDIT: Sorry about that! I wondered why no one was saying anything. I forgot I have a widescreen, and I had it for 1440x900, sorry. Link fixed, also doors are thicker..</b> <br><br></td></tr></table><br>
<a name="1010412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, never mind, people. I FINALLY got it figured out. Thanks for your tremendous help!<br><br>P.S. - Have fun with the non-functional demo! <br><br></td></tr></table><br>
<a name="1010425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just now checked back to this thread, glad you got it figured out ;) <br><br></td></tr></table><br>
<a name="1010495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unfortunately, I have a new problem now. The way I have it set up is:<br>    -I have a door type<br>    -Each frame, it goes through and finds out if you're close enough to a door to open it.<br>    -If there is, then show both of the rooms associated with that door.<br>    -Else, if there isn't, find the closest door to you and use TFormPoint to find out what side of it you're on.<br><br>This works fine for cubic rooms, but what if I have a chunk of room protruding past a door? When you go into the protruding section, *POOF!!* the room you're in is gone, and you fall into the cold, black void. So, what if I found out what side of a door whose face extruded to infinity  the camera is on and colliding with? That would work fine, but what if I didn't intersect with one at all... what?? - I don't know.. <br><br></td></tr></table><br>
<a name="1010499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm glad you got the door oords wokrking.<br><br>From what I understand from your new post, the problem arises since the progeam detects which room the player is in (therefore, which rooms should shown or hidden) only by which side of the nearest door the player is on.<br><br>I can foresee a way around this is to keep a variable or counter that records which room the player is in. This is only updated ONCE THE PLAYER ACTUALLY ENTERS A DOORWAY.<br><br>The checks made on opening a door can then decide which rooms to show, always maintaining the current room is not hidden.<br><br>- In the current setup, I imagine errors might arise if doors are opened on opposite sides of a single room too? <br><br></td></tr></table><br>
<a name="1010503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here, I'll give you an example.<br>The way I've got it set up now, doors work at any angle and any height as long as there are no protrusions. In Room03 I put a protrusion in the wall to demonstrate the problem. (look for the oddly dark polygon).<br><br><a href="http://host-a.net/ClayPigeon/ProtrusionError.zip" target="_blank">http://host-a.net/ClayPigeon/ProtrusionError.zip</a> <br><br></td></tr></table><br>
<a name="1010857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there some way it could detect when I collide with the inside of the door? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
