<!DOCTYPE html><html lang="en" ><head ><title >CameraViewport</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >CameraViewport</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >CameraViewport</a><br><br>
<a name="360787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think I understand this command fully.<br><br>What I would LIKE to do is set up a rectangle and have Blitz clip all drawing to within that rectangle.<br><br>Is CameraViewport the way to do this?  Is there a better way?  CameraViewport will probably work but it's sort of weird trying to get it to behave the way I want. <br><br></td></tr></table><br>
<a name="360790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> YEah CameraViewport sets the frame for the camera view rendering.<br><br>What is weird about it?<br><br>If you are using commands like ProjectedX, ProjectedY, then these are relative to the viewport, not graphics resolution (if I remember correctly!) <br><br></td></tr></table><br>
<a name="360791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Farley</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cameraviewport doesn't clip as such, if you had a cameraviewport camera,0,0,320,240 and a cameraviewport,0,0,640,480 both would show the same thing but the 1/4 screen one would be a low res effectivly. <br><br></td></tr></table><br>
<a name="360806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob<br><br>So there's no way to say, "I want you to draw the scene as normal, but I only want to see this subsection of it"?  Not scaled to a rectangle, but clipped to it.  Am I explaining this right?<br><br>Am I going to have to draw the scene and copyrect the section that I want? <br><br></td></tr></table><br>
<a name="360807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can do it, if the section you want to render is at the center of the viewport. Then you need to compensate for different viewport aspects and the camerazoom.<br><br>I'm not sure it's possible if you want to show something that isn't at the center of where the camera is pointing. <br><br>Did that make any sense?<br><br>I'll put together a small example! <br><br></td></tr></table><br>
<a name="360810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'm locked at 640x480 for this game.<br><br>I want to draw the game board at 208,48 on the screen with a 384x384 size.  I want things to fly in from the sides of the game board, but not overwrite anything outside of that square.  I want them contained and clipped to that area.<br><br>I suppose I'll try using some buffers and a copyrect or two. <br><br></td></tr></table><br>
<a name="360811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh, well that's no problem at all! I thought you wanted to do something else :)<br><br>Just use: CameraViewport camera,208,48,384,384<br><br>What's the problem with that?<br><br>Remember that if you use camerapick or cameraproject you need to compensate for the top left corner of the viewport!<br><br>So if you do a CameraPick camera,mousex(),mousey() it will pick at the wrong place. You need to use:<br><br>CameraPick camera,mousex()-208,mousey()-48 <br><br></td></tr></table><br>
<a name="360813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> (Thats waht I said originally :)  ) <br><br></td></tr></table><br>
<a name="360815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought once too that CameraViewport would just clip the world / camera view or something... I wanted to use it for "widescreen" effect and save some drawing time (top and bottom "border") as well. Then I discovered that it basically just squuezed the view so that the resulting image was... well, squeezed. Now I have black "sprite" borders, stupid way to do "widescreen"... showing less and drawing more. :) <br><br></td></tr></table><br>
<a name="360820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> This shows how you can compensate for any aspect ratio.<pre class=code>Graphics3D 640,480,0,2
SetBuffer BackBuffer()

clipx = 208
clipy = 48
clipw = 384
cliph = 384
origzoom# = 1.0
origclipw# = clipw

camera = CreateCamera()

For i = 0 To 10
	m = CreateCube()
	PositionEntity m,Rnd(-10,10),Rnd(-10,10),Rnd(10,50)
Next

For i = 0 To 10
	m = CreateSphere()
	PositionEntity m,Rnd(-10,10),Rnd(-10,10),Rnd(10,50)
Next


Repeat
	If MouseDown(1)
		If MouseX()-clipx&gt;10 Then clipw = MouseX()-clipx
		If MouseY()-clipy&gt;10 Then cliph = MouseY()-clipy
	EndIf
	If MouseDown(2)
		clipw = clipw+(clipx-MouseX())
		cliph = cliph+(clipy-MouseY())
		clipx = MouseX()
		clipy = MouseY()
	EndIf
		
	Cls
	
	; Compensate for viewport aspect!
	zoom# = origzoom#*(origclipw/clipw)

	Rect clipx-1,clipy-1,clipw+2,cliph+2,False
	CameraViewport camera,clipx,clipy,clipw,cliph
	CameraZoom camera,zoom
	
	RenderWorld
	
	Text GraphicsWidth()/2,0,"Left MB - Set Top Left ("+clipx+","+clipy+") | Right MB - Set Bottom Right ("+(clipx+clipw)+","+(clipy+cliph)+")",True,False
	Flip
	
Until KeyHit(1)</pre> <br><br></td></tr></table><br>
<a name="360822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Fred!  I'll give that a go when I get home tonight...<br><br><div class="quote"> What's the problem with that?  <br></div><br>I'm using screen aligned quads to do psuedo 2D graphics, and when I change the camera viewport they tend to slide around and not be in right place and such.  Your code seems interesting though.  As I said, I'll check it out later tonight... <br><br></td></tr></table><br>
<a name="360824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mustang<br><br>My kingdom for a simple clipper.  :) <br><br></td></tr></table><br>
<a name="360827"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I changed it so it should fully compensate for different aspect ratios now :) <br><br></td></tr></table><br>
<a name="360834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm using screen aligned quads to do psuedo 2D graphics, and when I change the camera viewport they tend to slide around and not be in right place and such.  <br></div><br><br>What do you mean - Screen Aligned?<br>Depends whether aligned to GraphicsWidh()/Height() or ProjectedX etc...<br><br>-------------------<br><br>As far as your frame goes, why not:<br><br><pre class=code>
CameraViewport camera,0,(GraphicsHeight()/ratio#),GraphicsWidth(),(GraphicsHeight()-(GraphicsHeight()/ratio#))

CameraZoom camera,(ratio#/(15*(GraphicsHeight()/GraphicsWidth())))
</pre><br><br>A value of ratio#=15 is 'standard'. <br><br></td></tr></table><br>
<a name="360836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I should be able to piece together something that works from this info guys, thanks!<br><br>It also occured to me halfway to the office that I'm scaling my 2D vertices to a virtual 640x480 screen.  That's screwing things up as well and explains why my drawing swims around the smaller viewport depending on the resolution and ratios of it.<br><br>Ah, fun! <br><br></td></tr></table><br>
<a name="360841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would rely on some nifty variables along the lines of:<br><br><pre class=code>
gwidth=GraphicsWidth()
gheight=GraphicsHeight()

camX=(gwidth/4)
camY=(gheight/4)
camHeight=(gheiht/2)
camWidth=(gwidth/2)

cam_ratio# = (1 / ((Gwidth/camX) * (Gheight/camY)))

;camX,camY= Top Left cameraView
;CamX+camWidth,CamY+CamHeight= Bottom Right cameraView

</pre><br><br>So what would be at x,y on normal 2D screen would be:<br><br>Rect camX+(x*cam_ratio#),(CamY*cam_ratio#),XX * cam_ratio#, YY * cam_ratio#,1,1 <br><br></td></tr></table><br>
<a name="361111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I decided to write my own clipping routine instead of playing with the viewport any longer and it seems to do what I want it to.<br><br>Thanks anyway, guys! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
