<!DOCTYPE html><html lang="en" ><head ><title >UDP: Finding Hosts</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >UDP: Finding Hosts</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >UDP: Finding Hosts</a><br><br>
<a name="976962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nathaniel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been playing around with networking and have successfully implemented UDP into an action game of mine. To join the host, you have to type in the IP address of the host computer. <br><br>So I was wondering:<br>Is there a way to find a remote host without knowing the host's IP address or name? There doesn't seem to be an answer in these forums. The only method I can think of is blindly sending messages to every possible IP address my router will allow. <br><br></td></tr></table><br>
<a name="977016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need a static server with a database to store player's Ips<br><br>So, you 'll need some php codes to communicate between blitz3d and the database. <br><br></td></tr></table><br>
<a name="977028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJ00200</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, thats the only way. <br><br></td></tr></table><br>
<a name="977035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So, you 'll need some php codes to communicate between blitz3d and the database. <br>So, you 'll need some php codes to communicate between blitz3d and the database. <br> <br></div><br><br>theoretically no you dont need php.  You must have a main server and hardcode its ip into your game, then the game can make a request of all of the server names and their ip's and the number of player etc... on the server side, when someone hosts a server, the main server's ip is again hardcoded into it.  It tells the server its ip and its name and the server can then give all of the clients its ip and name so they can join.  once they join that server, they can disconect from the main server as it is no longer needed.<br><br>What I have always wondered is how some games seem to not need a server and can simply find other people on the same local network.  I never understood how they did it though. <br><br></td></tr></table><br>
<a name="977039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You need a static server with a database to store player's Ips<br>So, you 'll need some php codes to communicate between blitz3d and the database.  <br></div><br><br><div class="quote"> You must have a main server and hardcode its ip into your game <br></div><br><br>well you dont have to do this a specific way, there are many options.  While I think a php database connection would be the cleanest way, its not the only way.<br><br>I dont know php at all, so I didnt use it for TinyTanks.  I used BlitzGET from the archives to manage a flatfile system on my webhost(ftp).  Server lists are downloaded from there and dislpayed in the client.   The webhost does get its list from php entry that someone made for me, whereas a server admin can add his server to the list.<br><br>I also made a pingbot that will download the list and ping each server over and over so it can remove anyone from the "active" list that is not online, and reactivate them when it gets a good ping.<br><br>As far as hardcoding any addresses into the client, I would perhaps hardcode a no-ip address so you can reroute it at any time without a client redistribution.<br><br><br>I could go on for pages but the basic notion is there are many ways. <br><br></td></tr></table><br>
<a name="977075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nathaniel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for all the help! <br><br>I should have specified that I'm asking about LAN networking, where the host might be any computer with any IP.<br><br><div class="quote"> What I have always wondered is how some games seem to not need a server and can simply find other people on the same local network. I never understood how they did it though. <br></div> This is where I'm confused. Nearly all modern PC multiplayer games seem to be able to locate remote systems without a problem, without the help of a main host. <br><br></td></tr></table><br>
<a name="977229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think a lot of multiplayer games use a form of specialised lobby server such as Gamespy or  the Valve gameservers.<br>A host sets up their game and the details are sent to the lobby server where clients can browse to find the game they want.<br><br>The suggestions above generally involve providing your own server to use as a lobbying one.<br><br>Otherwise, there's no way a host's IP can be 'stored' for the clients to browse, without, perhaps, a client scanning every possible IP ( !!! ) in the vain hope of stumbling upon a server running the game!<br><br>_______________________________________________________________<br><br>In a LAN environment, scanning local IP ranges is more feasible, and beyond Blitz' native capability, Perhaps, some libraries etc. may be able to detect particular port connections and these ports can be specific to your game. <br><br></td></tr></table><br>
<a name="977446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nathaniel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks again for all the help. Surprisingly, sending messages to all the IPs the router allows <b>is the answer</b> (if I don't want to use the main server concept):<br><br>Server:<br><pre class=code>n = CountHostIPs("")
local_ip = HostIP(1)
Print "Local IP Address: " + DottedIP(local_ip)

Print "Establishing UDP Stream..."
UDP_Stream = CreateUDPStream(8080)
If UDP_Stream Then Print "-Successful"
If Not UDP_Stream Then Print "-Failed":Delay 2000:End

Print "Waiting for contact..."
While Not KeyDown(1)
	message_ip = RecvUDPMsg(UDP_Stream)
	If message_ip
		Print "Found Client at: "+DottedIP(message_ip)
		WriteString(UDP_Stream,"1")
		SendUDPMsg(UDP_Stream,message_ip,8080)
	EndIf
Wend
CloseUDPStream(UDP_Stream)
End</pre><br>Client:<br><pre class=code>n = CountHostIPs("")
local_ip = HostIP(1)
Print "Local IP Address: " + DottedIP(local_ip)

Print "Establishing UDP Stream..."
UDP_Stream = CreateUDPStream(8080)
If UDP_Stream Then Print "-Successful"
If Not UDP_Stream Then Print "-Failed":Delay 2000:End

Print "Searching for Computers..."
Local remote_ip$
For i = 100 To 199;Send a message to all the IPs the Router will allow
	If i &lt;&gt; Right(DottedIP(local_ip),3);Makes sure we aren't sending a message to ourselves
		WriteString(UDP_Stream,"1")
		remote_ip = DotToInt("192.168.1."+Str(i))
		SendUDPMsg(UDP_Stream,remote_ip,8080)
	EndIf
Next

While Not KeyDown(1)
	message_ip = RecvUDPMsg(UDP_Stream)
	If message_ip
		Print "Found Host at: "+DottedIP(message_ip)
	EndIf
Wend
CloseUDPStream(UDP_Stream)
End

Function DotToInt%(ip$)
	off1=Instr(ip$,".")	  :ip1=Left$(ip$,off1-1)
	off2=Instr(ip$,".",off1+1):ip2=Mid$(ip$,off1+1,off2-off1-1)
	off3=Instr(ip$,".",off2+1):ip3=Mid$(ip$,off2+1,off3-off2-1)
	off4=Instr(ip$," ",off3+1):ip4=Mid$(ip$,off3+1,off4-off3-1)
	Return ip1 Shl 24 + ip2 Shl 16 + ip3 Shl 8 + ip4
End Function</pre><br>Note: The Server has to be running first <br><br></td></tr></table><br>
<a name="977918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> theoretically no you dont need php. You must have a main server and hardcode its ip into your game, then the game can make a request of all of the server names and their ip's and the number of player etc...  <br></div><br><br><div class="quote"> well you dont have to do this a specific way, there are many options. While I think a php database connection would be the cleanest way<br> <br></div><br><br>It's also the more convenient way.<br>What we should know is :<br>+&gt; Many servers does not allow access from other application than a web browser ( like "Free" ) , so you won't be able to send any request without a direct access. Else, the server can be a personal-computer, but, do a lot of people owns such a dedicated machine ? For sure, no. So there is many way to achieve IPs to local machine, but most of them are not reliable with most of the games. ( that are, Blitz3d games, and not industrial games... so they are not intended to make a great commercial benefits ... and of course, dedicated machine are expensive )<br><br>Eventually, you can use an iRC channel... but it's not a secured way.<br>An other way is to use DirectPlay ( that is the same way as using database+server, except, the server is the blitzbasic one's ) . But, it's not a very flexible way... <br><br></td></tr></table><br>
<a name="979445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xtremegamr</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Thanks again for all the help. Surprisingly, sending messages to all the IPs the router allows is the answer (if I don't want to use the main server concept): <br></div><br>Erm...that'll only work on small LAN's. If you do that on the Internet (or a big LAN), it'll take FOREVER.<br><br><div class="quote"> An other way is to use DirectPlay ( that is the same way as using database+server, except, the server is the blitzbasic one's ) . But, it's not a very flexible way... <br></div><br>I wouldn't recommend DirectPlay; you're better off creating your own master server or using a specialized game lobby system (ex. GameSpy). <br><br></td></tr></table><br>
<a name="979837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SytzeZ</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not that hard to create a simple PHP script, I can post some code if you need to.<br>There are a lot of free hosts that support PHP and MySQL (I use 000webhost.com, it's good IMO) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
