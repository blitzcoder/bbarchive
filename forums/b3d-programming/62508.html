<!DOCTYPE html><html lang="en" ><head ><title >Network functions please...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Network functions please...</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Network functions please...</a><br><br>
<a name="698338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would someone show me how to search for network games, so I can have an in-game list of available games instead of having to use the window StartNetGame() pops up.<br><br>A few functions that see what connections a computer has - like the functions that tell blitz what graphics cards a computer has.<br>Functions for looking through all the games currently available on the desired connection type - kinda like the ones for searching the graphics modes or files in a directory.<br><br>That way, my game can just provide a list of possible games to join and let the user choose.  And the player never has to type in anything but the name of the game he is creating.  He doesn't have to watch as the cool graphics disappear and a stupid StartNetGame() window appears.  The network is handled behind the scenes.<br><br>Obviously, StartNetGame() uses some functions to get the information I want, but I can't find anything in blitz to get that information.<br><br>Anybody have code or share my frustrations? <br><br></td></tr></table><br>
<a name="698485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are 3 protocols you can use to write multiplayer games: directplay, tcp and udp. It seems you want to use directplay. I have no idea about that one. You maybe want to use the free version of BLitzPlay instead, a UDP library. There is also a version of the PHP script GNET for BlitzPlay (GNet see this page menu). GNET will host IPs etc. of running games on a webserver, exactly what you want. <br><br></td></tr></table><br>
<a name="698522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Baystep Productions</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, I've been down this lane. What you are looking for is a static server to keep all the information on available servers. Including IP's, Ping, COnnection Type, version, etc. etc. Sort of like what GameSpy Arcade is for major titles. <br><br>Gnet is Blitz's miniscule version. It will save Game Names, Server Names, and IP's only. You then use the Include functions to get that data to your game. Gnet will work for you, unless your talking about needing to host a ton of servers. Like any major online game (Halo, AA, etc.)<br><br>I use TCP and Gnet, if I had time or money, I would start my own site for hosting this info for games. Could make money to. <br><br></td></tr></table><br>
<a name="698560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't seem to find GNet anywhere.  Can someone provide a link?<br><br>[EDIT] Found GNet.  Forgot the link like everyone else seems to have.  Besides, what I'm looking for is LAN stuff, I'm not ready to make online games yet.  GNet is a Blitz game server that allows blitz games to connect to a central online server (www.blitzbasic.com/gnet/gnet.php) so other players can join or host online games.<br>I don't think I want to use GNet.  It was a good suggestion though.  Thanks for the effort.<br><br>What I want to know is how StartNetGame() is obtaining a list of games, updating that list, and obtaining a list of possible connection types (TCP/IP, IPX, modem, serial, etc.).  How does it get this infomation?  Is it some DX thing? or is it part of windows?  How does it get the information?<br><br>Any more ideas out there? code, userlibs, something...<br><br>DirectPlay is part of DX, but I don't care whether it's DX or windows or native blitz.  Just show me how to do it in B3D and I'll be happy.<br><br>I need something to tell my program all the known connection types (TCP/IP, IPX, etc).  Then, once my program choses the connection type, something to list all games on that connection type WITHIN my program, however I want to display the list, NOT in that stupid StartNetGame() window.  I do not want to have to type in an IP address every time I join a game, I want to be able to just choose a game and join.  And I want this for a LAN not an online game.<br>(yea, yea, I said the same thing over and over didn't I) <br><br></td></tr></table><br>
<a name="698573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean by "LAN" ?<br>local ? or just Tcp/Ip ?<br><br>if you want LAN game, you'll have to specify the Ip ... <br>if you run locally with your fammily reseau, i d'ont know what will you call to receive informations. Unless you get datas from a server, and here, you'll have to get out from your local connection<br><br>If you want to play with lan using Tcp and an other player on the web, you could have a database MySql you log and had a party/Ip/name of the party ... etc... It will be your server ! Then, just have to call the database to receive informations.<br><br>Don't know if you use MySql, but it should be the best way ! <br><br></td></tr></table><br>
<a name="698669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't understand do you, Bobysait.<br><br>LAN - Local Area Network<br>TCP/IP - Transmission Control Protocol/Internet Protocol<br><br>TCP/IP is the standard protocol for network and online connections.  Other protocols exist, like IPX, which is outdated.<br><br>It is NOT required to input an IP address, if you want proof, make a simple network program that inits using StartNetGame().  You will NEVER have to give ANY address information, no IP address, no computer name, no nothing, and yet you can still see all the games availiable on your network.  I am on a network not connected to the internet.  Besides, if I want a game between computer in my house, I don't want to send my game off to some server site just to get information that StartNetGame() gets without being online.  Just play Warcraft III on you local network.  Nowhere do you give it any IP information.  You just click on the multiplayer button and it shows a list of all open games.  I want to be able to do that kind of thing.  I would like StartNetGame() to be broken into several function that don't have a stupid window.  I don't know how or where StartNetGame() is getting the network information, but it is getting it and I want to know how.<br><br>Maybe Mark has some hints... <br><br></td></tr></table><br>
<a name="698672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need an enumeration routine...and there's just the function available in netapi32.dll. Here is the VB form:<br>Private Declare Function NetServerEnum Lib "netapi32" _<br>  (ByVal servername As Long, _<br>   ByVal level As Long, _<br>   buf As Any, _<br>   ByVal prefmaxlen As Long, _<br>   entriesread As Long, _<br>   totalentries As Long, _<br>   ByVal servertype As Long, _<br>   ByVal domain As Long, _<br>   resume_handle As Long) As Long<br><br>if you want to see an example of this call in use, go to:<br><a href="http://vbnet.mvps.org/index.html?code/network/netserverenum.htm" target="_blank">http://vbnet.mvps.org/index.html?code/network/netserverenum.htm</a><br><br>Hope this helps.<br>Kevin <br><br></td></tr></table><br>
<a name="698677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look promising...I'll post the Blitz code if it works... <br><br></td></tr></table><br>
<a name="698715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is an interesting site that has a free network library that you can use with Blitz3d.<br><a href="http://www.krylarskreations.com/knl.shtml" target="_blank">http://www.krylarskreations.com/knl.shtml</a><br><br>Kevin <br><br></td></tr></table><br>
<a name="698737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow a livesign of Krylar! The Library looks good, tho:<br><br>"You'll shave MONTHS off of your multiuser development cycle!"<br><br>Well, not sure if my beard is really that large. :o) <br><br></td></tr></table><br>
<a name="698739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> at LEAST months. I was checking out the library and it looks like just what Subirenihil was wanting. <br><br></td></tr></table><br>
<a name="698761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>[EDIT]</b> <i>This what happens when you don't read the documentation and expect the demos to show everything!  Read to the bottom of this to see how to connect without any IP stuff.</i><br><br>Krylar looked great - until I tried to connect to the host.  It needed me to input an IP address - exactly what I am trying to avoid.  Like I keep saying, StartNetGame() is the only way I've found to avoid that, but it pops up a stinking window and when I'm running a fullscreen game the window is hidden, making it look like the game locked up (it doesn't lock up, its just waiting for StartNetGame(), which isn't going do anything until I exit the fullscreen so the user can see the StartNetGame() menu and choose something, which exiting fullscreen frees all my loaded images, so I have to reload them once I return to fullscreen, which is REALLY annoying.<br><br>I'm working on that netapi32.dll stuff but I'm not doing something right.  Anyone know how to do this with blitz?<br><br>These are the things I have ported into blitz.  Does anyone know about writing .decls?  I have something wrong here, but I'm not sure whether it is in the .decls or in my code.  Please debug.<br>(Kevin8084, The net.bb is mostly the same your link went to ported to blitz.  I ported the .decls came from there too.  I've never ported anything before, so I'm sure its full of bugs)<br><br>----- netapi32.decls -----<br>.lib "netapi32.dll"<br>NetServerEnum%(servername%, level%, buf%, prefmaxlen%, entriesread%, totalentries%, servertype%, domain%, resume_handle%):"NetServerEnum"<br>NetApiBufferFree%(buffer%):"NetApiBufferFree"<br><br>----- net.bb -----<br>;Windows Type used To call the Net API<br>Const MAX_PREFERRED_LENGTH% = -1<br>Const NERR_SUCCESS% = 0<br>Const ERROR_MORE_DATA% = 234<br><br>Const SV_TYPE_WORKSTATION%          = $1<br>Const SV_TYPE_SERVER%               = $2<br>Const SV_TYPE_SQLSERVER%            = $4<br>Const SV_TYPE_DOMAIN_CTRL%          = $8<br>Const SV_TYPE_DOMAIN_BAKCTRL%       = $10<br>Const SV_TYPE_TIME_SOURCE%          = $20<br>Const SV_TYPE_AFP%                  = $40<br>Const SV_TYPE_NOVELL%               = $80<br>Const SV_TYPE_DOMAIN_MEMBER%        = $100<br>Const SV_TYPE_PRINTQ_SERVER%        = $200<br>Const SV_TYPE_DIALIN_SERVER%        = $400<br>Const SV_TYPE_XENIX_SERVER%         = $800<br>Const SV_TYPE_SERVER_UNIX%          = SV_TYPE_XENIX_SERVER<br>Const SV_TYPE_NT%                   = $1000<br>Const SV_TYPE_WFW%                  = $2000<br>Const SV_TYPE_SERVER_MFPN%          = $4000<br>Const SV_TYPE_SERVER_NT%            = $8000<br>Const SV_TYPE_POTENTIAL_BROWSER%    = $10000<br>Const SV_TYPE_BACKUP_BROWSER%       = $20000<br>Const SV_TYPE_MASTER_BROWSER%       = $40000<br>Const SV_TYPE_DOMAIN_MASTER%        = $80000<br>Const SV_TYPE_SERVER_OSF%           = $100000<br>Const SV_TYPE_SERVER_VMS%           = $200000<br>Const SV_TYPE_WINDOWS%              = $400000  ;Windows95 And above<br>Const SV_TYPE_DFS%                  = $800000  ;Root of a DFS tree<br>Const SV_TYPE_CLUSTER_NT%           = $1000000 ;NT Cluster<br>Const SV_TYPE_TERMINALSERVER%       = $2000000 ;Terminal Server<br>Const SV_TYPE_DCE%                  = $10000000;IBM DSS<br>Const SV_TYPE_ALTERNATE_XPORT%      = $20000000;rtn alternate transport<br>Const SV_TYPE_LOCAL_LIST_ONLY%      = $40000000;rtn Local only<br>Const SV_TYPE_DOMAIN_ENUM%          = $80000000<br>Const SV_TYPE_ALL%                  = $FFFFFFFF<br><br>Const SV_PLATFORM_ID_OS2%        = 400<br>Const SV_PLATFORM_ID_NT%         = 500<br><br>;Mask applied To svX_version_major in<br>;order To obtain the major version number.<br>Const MAJOR_VERSION_MASK%         = $F<br><br>Type SERVER_INFO_100<br>  Field sv100_platform_id%<br>  Field sv100_name%<br>End Type<br><br>;Declare Function NetServerEnum Lib "netapi32" _<br>;  (ByVal servername As Long, _<br>;   ByVal level As Long, _<br>;   buf As Any, _<br>;   ByVal prefmaxlen As Long, _<br>;   entriesread As Long, _<br>;   totalentries As Long, _<br>;   ByVal servertype As Long, _<br>;   ByVal domain As Long, _<br>;   resume_handle As Long) As Long<br><br>;Declare Function NetApiBufferFree Lib "netapi32" _<br>;   (ByVal Buffer As Long) As Long<br><br>;Declare Sub CopyMemory Lib "kernel32" _<br>;   Alias "RtlMoveMemory" _<br>;  (pTo As Any, uFrom As Any, _<br>;   ByVal lSize As Long)<br>   <br>;Declare Function lstrlenW Lib "kernel32" _<br>;  (ByVal lpString As Long) As Long   <br><br>Global txt$<br>GetServers("")<br>Print txt$<br>WaitKey<br>End<br><br>Function Form_Load()<br><br>;   Command1.Caption = "Net Server Enum"<br><br>End Function<br>   <br><br>Function Command1_Click()<br><br>;   Call GetServers("")<br> <br>End Function<br><br><br>Function GetServers%(sDomain$)<br><br>  ;lists all servers of the specified Type<br>  ;that are visible in a domain.<br>  <br>   Local bufptr%=CreateBank(10024)<br>   Local dwEntriesread%<br>   Local dwTotalentries%<br>   Local dwResumehandle%<br>   Local se100.SERVER_INFO_100<br>   Local success%<br>   Local nStructSize%<br>   Local cnt%<br><br>   nStructSize = 8;LenB(se100)<br>   <br>  ;Call passing MAX_PREFERRED_LENGTH To have the<br>  ;API allocate required memory For the Return values.<br>  ;<br>  ;The call is enumerating all machines on the<br>  ;network (SV_TYPE_ALL); however, by Or'ing<br>  ;specific bit masks For defined types you can<br>  ;customize the returned Data. For example, a<br>  ;value of 0x00000003 combines the bit masks For<br>  ;SV_TYPE_WORKSTATION (0x00000001) And<br>  ;SV_TYPE_SERVER (0x00000002).<br>  ;<br>  ;dwServerName must be Null. The level parameter<br>  ;(100 here) specifies the Data structure being<br>  ;used (in this Case a SERVER_INFO_100 structure).<br>  ;<br>  ;The domain member is passed as Null, indicating<br>  ;machines on the primary domain are To be retrieved.<br>  ;If you decide To use this member, pass<br>  ;StrPtr("domain name"), Not the String itself.<br>   success = NetServerEnum(0,100,bufptr,MAX_PREFERRED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,0,dwResumehandle)<br><br>  ;If all goes well<br>   If success = NERR_SUCCESS And success &lt;&gt; ERROR_MORE_DATA Then<br>      <br>    ;loop through the returned Data, adding Each<br>    ;machine To the list<br>      For cnt = 0 To dwEntriesread - 1<br>         <br>        ;get one chunk of Data And cast<br>        ;into an SERVER_INFO_100 struct<br>        ;in order To add the name To a list<br>         PokeInt bufptr, nStructSize * cnt,se100\sv100_platform_id<br>         PokeInt bufptr, nStructSize * cnt+4,se100\sv100_name<br>            <br>         Txt$=txt$+Chr$(13)+GetPointerToByteStringW(se100\sv100_name)<br>         <br>      Next<br>      <br>   End If<br>   <br>  ;clean up regardless of success<br>   NetApiBufferFree(bufptr)<br>   <br>  ;Return entries as sign of success <br>   Return dwEntriesread <br><br>End Function<br><br><br>Function GetPointerToByteStringW$(dwData%)<br>  <br>   Local tmp$=""<br>   Local tmplen%<br>   <br>   If dwData &lt;&gt; 0 Then<br>   <br>      tmplen = BankSize(dwData); * 2<br>      <br>      If tmplen &lt;&gt; 0 Then<br>         For a=0 To tmplen-1<br>			tmp$=tmp$+Chr$(PeekByte(dwdata,a))<br>		Next<br>         <br>     End If<br>     <br>   End If<br>	Return tmp$    <br>End Function <br><br></td></tr></table><br>
<a name="698771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Curious: did you want to create a bank that size? <br><br></td></tr></table><br>
<a name="698773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here you have: Local se100.SERVER_INFO_100<br>Did you want se100.SERVER_INFO_100 = new SERVER_INFO_100? <br><br></td></tr></table><br>
<a name="699061"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, the bank size 10024 was a remnant of an attempt to get it to work.  I originally had it 1024.<br><br>I no longer need the se100.  (the code above used to have it like you have it, but I changed it while attempting to fix the bug.)<br><br>The new code runs without errors, but I have no idea why success returns 87.  I don't think it runs properly yet because it can't find any games - even when I start one on the same computer - and only returns a success of 87.  The msdn page says that the "level" parameter for NetServerEnum needs to be 100 or 101, but either of those values causes a "memory access violation".  Suggestions anyone?<br><br>Anybody know what &amp; means on the end of VB numbers (ie 0&amp;)?<br><br>Bug finders, get to work!<br><br>Here is my updated code, the .decls are the same:<br>;Windows Type used To call the Net API<br>Const MAX_PREFERRED_LENGTH% = -1<br>Const NERR_SUCCESS% = 0<br>Const ERROR_MORE_DATA% = 234<br><br>Const SV_TYPE_WORKSTATION%          = $1<br>Const SV_TYPE_SERVER%               = $2<br>Const SV_TYPE_SQLSERVER%            = $4<br>Const SV_TYPE_DOMAIN_CTRL%          = $8<br>Const SV_TYPE_DOMAIN_BAKCTRL%       = $10<br>Const SV_TYPE_TIME_SOURCE%          = $20<br>Const SV_TYPE_AFP%                  = $40<br>Const SV_TYPE_NOVELL%               = $80<br>Const SV_TYPE_DOMAIN_MEMBER%        = $100<br>Const SV_TYPE_PRINTQ_SERVER%        = $200<br>Const SV_TYPE_DIALIN_SERVER%        = $400<br>Const SV_TYPE_XENIX_SERVER%         = $800<br>Const SV_TYPE_SERVER_UNIX%          = SV_TYPE_XENIX_SERVER<br>Const SV_TYPE_NT%                   = $1000<br>Const SV_TYPE_WFW%                  = $2000<br>Const SV_TYPE_SERVER_MFPN%          = $4000<br>Const SV_TYPE_SERVER_NT%            = $8000<br>Const SV_TYPE_POTENTIAL_BROWSER%    = $10000<br>Const SV_TYPE_BACKUP_BROWSER%       = $20000<br>Const SV_TYPE_MASTER_BROWSER%       = $40000<br>Const SV_TYPE_DOMAIN_MASTER%        = $80000<br>Const SV_TYPE_SERVER_OSF%           = $100000<br>Const SV_TYPE_SERVER_VMS%           = $200000<br>Const SV_TYPE_WINDOWS%              = $400000  ;Windows95 And above<br>Const SV_TYPE_DFS%                  = $800000  ;Root of a DFS tree<br>Const SV_TYPE_CLUSTER_NT%           = $1000000 ;NT Cluster<br>Const SV_TYPE_TERMINALSERVER%       = $2000000 ;Terminal Server<br>Const SV_TYPE_DCE%                  = $10000000;IBM DSS<br>Const SV_TYPE_ALTERNATE_XPORT%      = $20000000;rtn alternate transport<br>Const SV_TYPE_LOCAL_LIST_ONLY%      = $40000000;rtn Local only<br>Const SV_TYPE_DOMAIN_ENUM%          = $80000000<br>Const SV_TYPE_ALL%                  = $FFFFFFFF<br><br>Const SV_PLATFORM_ID_OS2%        = 400<br>Const SV_PLATFORM_ID_NT%         = 500<br><br>;Mask applied To svX_version_major in<br>;order To obtain the major version number.<br>Const MAJOR_VERSION_MASK%         = $F<br><br>Type SERVER_INFO_100<br>  Field sv100_platform_id%<br>  Field sv100_name%<br>End Type<br><br>;Declare Function NetServerEnum Lib "netapi32" _<br>;  (ByVal servername As Long, _<br>;   ByVal level As Long, _<br>;   buf As Any, _<br>;   ByVal prefmaxlen As Long, _<br>;   entriesread As Long, _<br>;   totalentries As Long, _<br>;   ByVal servertype As Long, _<br>;   ByVal domain As Long, _<br>;   resume_handle As Long) As Long<br><br>;Declare Function NetApiBufferFree Lib "netapi32" _<br>;   (ByVal Buffer As Long) As Long<br><br>;Declare Sub CopyMemory Lib "kernel32" _<br>;   Alias "RtlMoveMemory" _<br>;  (pTo As Any, uFrom As Any, _<br>;   ByVal lSize As Long)<br>   <br>;Declare Function lstrlenW Lib "kernel32" _<br>;  (ByVal lpString As Long) As Long   <br><br>Global txt$<br>Print GetServers("")<br>Print txt$<br>WaitKey<br>End<br><br>Function Form_Load()<br><br>;   Command1.Caption = "Net Server Enum"<br><br>End Function<br>   <br><br>Function Command1_Click()<br><br>;   Call GetServers("")<br> <br>End Function<br><br><br>Function GetServers%(sDomain$)<br><br>  ;lists all servers of the specified Type<br>  ;that are visible in a domain.<br>  <br>   Local bufptr%;=CreateBank(10024)<br>   Local dwEntriesread%<br>   Local dwTotalentries%<br>   Local dwResumehandle%<br>   Local se100.SERVER_INFO_100=New SERVER_INFO_100<br>   Local success%<br>   Local nStructSize%<br>   Local cnt%<br><br>   nStructSize = 8;LenB(se100)<br>   <br>	Local d1=CreateBank(8)<br>	d2=CreateBank(Len(sdomain$))<br>	For a=0 To Len(sdomain$)-1:PokeByte d2,a,Asc(Mid$(sdomain$,a+1,1)):Next<br>  ;Call passing MAX_PREFERRED_LENGTH To have the<br>  ;API allocate required memory For the Return values.<br>  ;<br>  ;The call is enumerating all machines on the<br>  ;network (SV_TYPE_ALL); however, by Or'ing<br>  ;specific bit masks For defined types you can<br>  ;customize the returned Data. For example, a<br>  ;value of 0x00000003 combines the bit masks For<br>  ;SV_TYPE_WORKSTATION (0x00000001) And<br>  ;SV_TYPE_SERVER (0x00000002).<br>  ;<br>  ;dwServerName must be Null. The level parameter<br>  ;(100 here) specifies the Data structure being<br>  ;used (in this Case a SERVER_INFO_100 structure).<br>  ;<br>  ;The domain member is passed as Null, indicating<br>  ;machines on the primary domain are To be retrieved.<br>  ;If you decide To use this member, pass<br>  ;StrPtr("domain name"), Not the String itself.<br>   success = NetServerEnum(0,d1,bufptr,MAX_PREFERRED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,d2,dwResumehandle)<br><br>  ;If all goes well<br>   If ((success = NERR_SUCCESS) And (success &lt;&gt; ERROR_MORE_DATA)) Then<br>      <br>    ;loop through the returned Data, adding Each<br>    ;machine To the list<br>      For cnt = 0 To dwEntriesread - 1<br>         <br>        ;get one chunk of Data And cast<br>        ;into an SERVER_INFO_100 struct<br>        ;in order To add the name To a list<br>         PokeInt bufptr, nStructSize * cnt,PeekInt(d1,0);se100\sv100_platform_id<br>         PokeInt bufptr, nStructSize * cnt+4,PeekInt(d1,4);se100\sv100_name<br>            <br>         Txt$=txt$+Chr$(13)+GetPointerToByteStringW(PeekInt(d1,4));se100\sv100_name)<br>         <br>      Next<br>      <br>   End If<br>   <br>  ;clean up regardless of success<br>   NetApiBufferFree(bufptr)<br>   <br>  ;Return entries as sign of success <br>   Return dwEntriesread ;change this to "Return success" if you want to see what success returns<br><br>End Function<br><br><br>Function GetPointerToByteStringW$(dwData%)<br>  <br>   Local tmp$=""<br>   Local tmplen%<br>   <br>   If dwData &lt;&gt; 0 Then<br>   <br>      tmplen = BankSize(dwData); * 2<br>      <br>      If tmplen &lt;&gt; 0 Then<br>         For a=0 To tmplen-1<br>			tmp$=tmp$+Chr$(PeekByte(dwdata,a))<br>		Next<br>         <br>     End If<br>     <br>   End If<br>	Return tmp$    <br>End Function <br><br></td></tr></table><br>
<a name="699073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Error code 87 = invalid parameter <br><br></td></tr></table><br>
<a name="699076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks kevin.  That way I at least know why it doesn't return any servers. <br><br></td></tr></table><br>
<a name="699078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> no problem. Good luck on your coding! <br><br></td></tr></table><br>
<a name="699081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do I send it a pointer to an array of the SERVER_INFO_100 structure?  Or shouldn't a bank work just fine?<br><br>The first two parameters need to be 0, 100.  The remaining parameters still need to be debugged. <br><br></td></tr></table><br>
<a name="699085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just ran your code and got an error 124 (invalid level error) <br><br></td></tr></table><br>
<a name="699087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> An array is, itself, a pointer to the data type that the array holds, yes? I don't think that it's needed to do more than send it the array. <br><br></td></tr></table><br>
<a name="699089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, it did that to me once with the first code.  It always gives me an 87 with the second code.<br><br>I'm tweeking the variables and the buf parameter.  I'm always getting a "memory access violation" and crashing blitzcc.  I'm so glad Mark separated the compiler from the editor:) <br><br></td></tr></table><br>
<a name="699090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> For error lookups, go here:<br><a href="http://www.allapi.net/php/errlookup/errlookup.php" target="_blank">http://www.allapi.net/php/errlookup/errlookup.php</a><br><br>Very handy site! <br><br></td></tr></table><br>
<a name="699091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll try that then. <br><br></td></tr></table><br>
<a name="699093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're in Montana, yes? Chess player? <br><br></td></tr></table><br>
<a name="699095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the error page.<br><br>Identifier "se100" may not be used this way.<br><br>Dim se100.SERVER_INFO_100(100);=New SERVER_INFO_100<br><br>success = NetServerEnum(0,100,se100,MAX_PREFERRED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,0,dwResumehandle) <br><br></td></tr></table><br>
<a name="699096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> no problem...I'm glad that sites such as that exist! <br><br></td></tr></table><br>
<a name="699097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Belgrade, MT<br><br>How'd you know I liked chess? <br><br></td></tr></table><br>
<a name="699098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> you ranked #6 in  2003 tournament. You were in 8th grade at the time :) <br><br></td></tr></table><br>
<a name="699099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> The identifier error is in the success line. <br><br></td></tr></table><br>
<a name="699101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that you're going to get your code working today. <br><br></td></tr></table><br>
<a name="699103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> There were two chess tournaments i entered in 2003 (those were the only tournaments I have ever entered, more recent ones have coincided with other more important events in my life so I haven't gotten a chance to enter) one on May 3, the other was on September 27.  I think I got 4rth in May, just 'cause I was nervous and let a little kid pull a seven move checkmate on me:(  My little brother took first in the level beneath me.  I had moved up into the next level as had all the other good chess players.  My best friend won first. <br><br></td></tr></table><br>
<a name="699104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> What place did you get in the tournament? <br><br></td></tr></table><br>
<a name="699105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> In May, Ben Darling took 1st place. Is this your best friend? The kid pulled the 7 move checkmate on you in Round 3, yes? <br><br></td></tr></table><br>
<a name="699106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't play. I haven't played chess in years (though I started when I was four years old LOL) <br><br></td></tr></table><br>
<a name="699108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, I didn't play Ben Darling in May.  Some little 5th grader (that was the 7 move checkmate) was the only person I lost to that day.  In September, Nathan Clevidence won.  I think he won in May too, but he was in the 9th-12th range.  Nathan is my best friend, haven't met Ben much other than at the chess tournaments. <br><br></td></tr></table><br>
<a name="699111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry about looking into your life a little. If you are curious, do a google search for "kevin8084" and for "klee8084". These are both me. You might find the reverse engineering aspects worthwhile. Now, gotta go for a while. Later! <br><br></td></tr></table><br>
<a name="699113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> (The 5th grader pulled the 7 move checkmate on me in round 1)<br><br>Back to topic.<br><br>How do you send an array to a function? <br><br></td></tr></table><br>
<a name="699120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just call the array inside of the function:<br><br><pre class=code>Dim a(10)

For x=0 To 9
a(x)=x
Next

doit()

WaitKey()
End

Function doit()

For x=0 To 9
Print a(x)
Next
End Function</pre><br><br>Or, if you are worried about the scope, you can do this:<br><br><pre class=code>
Global a[10]

For x=0 To 9
a[x]=x
Next

doit()

WaitKey()
End

Function doit()
For x=0 To 9
Print a[x]
Next
End Function
</pre> <br><br></td></tr></table><br>
<a name="699281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Um, I don't see how that works for the code.<br><br>If you find something that works, please tell me. <br><br></td></tr></table><br>
<a name="699497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just noticed that I need pointers (aka. banks) for some of the parameters instead of actual values.  Success=0 (which is NERR_SUCCESS, which is exactly what you want to see).  Everything seems to run great - UNTIL the program executes the End command, which causes a "Memory access violation"<br><br>Here's the new code (I have remove most of the commented code to make this a smaller post):<br><br>;Windows Type used To call the Net API<br>Const MAX_PREFERRED_LENGTH% = -1<br>Const NERR_SUCCESS% = 0<br>Const ERROR_MORE_DATA% = 234<br><br>Const SV_TYPE_WORKSTATION%          = $1<br>Const SV_TYPE_SERVER%               = $2<br>Const SV_TYPE_SQLSERVER%            = $4<br>Const SV_TYPE_DOMAIN_CTRL%          = $8<br>Const SV_TYPE_DOMAIN_BAKCTRL%       = $10<br>Const SV_TYPE_TIME_SOURCE%          = $20<br>Const SV_TYPE_AFP%                  = $40<br>Const SV_TYPE_NOVELL%               = $80<br>Const SV_TYPE_DOMAIN_MEMBER%        = $100<br>Const SV_TYPE_PRINTQ_SERVER%        = $200<br>Const SV_TYPE_DIALIN_SERVER%        = $400<br>Const SV_TYPE_XENIX_SERVER%         = $800<br>Const SV_TYPE_SERVER_UNIX%          = SV_TYPE_XENIX_SERVER<br>Const SV_TYPE_NT%                   = $1000<br>Const SV_TYPE_WFW%                  = $2000<br>Const SV_TYPE_SERVER_MFPN%          = $4000<br>Const SV_TYPE_SERVER_NT%            = $8000<br>Const SV_TYPE_POTENTIAL_BROWSER%    = $10000<br>Const SV_TYPE_BACKUP_BROWSER%       = $20000<br>Const SV_TYPE_MASTER_BROWSER%       = $40000<br>Const SV_TYPE_DOMAIN_MASTER%        = $80000<br>Const SV_TYPE_SERVER_OSF%           = $100000<br>Const SV_TYPE_SERVER_VMS%           = $200000<br>Const SV_TYPE_WINDOWS%              = $400000  ;Windows95 And above<br>Const SV_TYPE_DFS%                  = $800000  ;Root of a DFS tree<br>Const SV_TYPE_CLUSTER_NT%           = $1000000 ;NT Cluster<br>Const SV_TYPE_TERMINALSERVER%       = $2000000 ;Terminal Server<br>Const SV_TYPE_DCE%                  = $10000000;IBM DSS<br>Const SV_TYPE_ALTERNATE_XPORT%      = $20000000;rtn alternate transport<br>Const SV_TYPE_LOCAL_LIST_ONLY%      = $40000000;rtn Local only<br>Const SV_TYPE_DOMAIN_ENUM%          = $80000000<br>Const SV_TYPE_ALL%                  = $FFFFFFFF<br><br>Const SV_PLATFORM_ID_OS2%        = 400<br>Const SV_PLATFORM_ID_NT%         = 500<br><br>Const MAJOR_VERSION_MASK%         = $F<br><br>Type SERVER_INFO_100<br>  Field sv100_platform_id%<br>  Field sv100_name%<br>End Type<br><br>Global txt$<br>Print GetServers("")<br>Print txt$<br>WaitKey<br>End<br><br>Function GetServers%(sDomain$)<br>   Local bufptr%=CreateBank(1024)<br>   Local dwEntriesread%=CreateBank(4)<br>   Local dwTotalentries%=CreateBank(4)<br>   Local dwResumehandle%<br>   Local success%<br>   Local nStructSize%<br>   Local cnt%<br><br>   nStructSize = 8;LenB(se100)<br>   <br>	Local d1=CreateBank(1024)<br>	d2=CreateBank(Len(sdomain$))<br>	For a=0 To Len(sdomain$)-1:PokeByte d2,a,Asc(Mid$(sdomain$,a+1,1)):Next<br><br>   success = NetServerEnum(0,100,bufptr,MAX_PREFERRED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,0,dwResumehandle)<br>   If ((success = NERR_SUCCESS) And (success &lt;&gt; ERROR_MORE_DATA)) Then<br>      <br>      For cnt = 0 To PeekInt(dwEntriesread,0) - 1<br>         Txt$=txt$+Chr$(13)+GetPointerToByteStringW(PeekInt(bufptr,cnt*nStructSize+4));se100\sv100_name)<br>         <br>      Next<br>      <br>   End If<br>   <br>   NetApiBufferFree(bufptr)<br>   <br>   Return PeekInt(dwEntriesread,0) <br><br>End Function<br><br><br>Function GetPointerToByteStringW$(dwData%)<br>  <br>   Local tmp$=""<br>   Local tmplen%<br>   <br>   If dwData &lt;&gt; 0 Then<br>   <br>      tmplen = BankSize(dwData); * 2<br>      <br>      If tmplen &lt;&gt; 0 Then<br>         For a=0 To tmplen-1<br>			tmp$=tmp$+Chr$(PeekByte(dwdata,a))<br>		Next<br>         <br>     End If<br>     <br>   End If<br>	Return tmp$    <br>End Function <br><br></td></tr></table><br>
<a name="699502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> This little example shows how to set up an array of types and shows that functions can access the array without being explicitly passed a pointer:<br><pre class=code>
Type mytype
	Field x#,y#,z#
End Type

Dim cool.mytype(10)

doit()

WaitKey()
End

Function doit()
cool.mytype(0)=New mytype
cool(0)\x=5
Print cool(0)\x
delete cool(0)
End Function
</pre><br>Ahh...I see that you posted in the interim <br><br></td></tr></table><br>
<a name="699503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the code, but that's not quite what I had in mind.  I was wanting to send the array of types out to the NetServerEnum - and it didn't like it.<br><br>Anyway, I figured out that my idea of using a bank was fine, the problem was that dwEntriesRead and dwTotalEntries needed to be banks too.<br><br>But there's still a problem with my code?  The End statement causes a "Memory access violation" <br><br></td></tr></table><br>
<a name="699508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have to go offline for a bit. I will attempt to recreate your program from scratch and see if I come up with the same error...I'll post when the program is complete.<br><br>Kevin <br><br></td></tr></table><br>
<a name="699608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> So far I'm having the same luck as you...very frustrating <br><br></td></tr></table><br>
<a name="699955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> The NetServerEnum seems to be messing up the bank, so when Blitz tries to free it it causes an error.<br><br>Insert "FreeBank bufptr" anywhere after you create the bank.  FreeBank will cause an error if you insert it after the NetServerEnum.  If you insert it before the NetServerEnum, then End causes an error (because End cleans up everything, including freeing existing banks) I think it NetServerEnum may be using the wrong variable initialization command - I saw something somewhere about you must use a certain command for declaring variables when creating a dll.  I will look at finding the windows command to create a bank that I can send to NetServerEnum.<br><br>This is looking very promising, but the task is a little more than I expected.  I hope we can get this working so that future programmers can have a more professional style networking lib at their fingertips - and our names possibly in the credits.<br><br>Thanks for all your help Kevin.  It has been a pleasure knowing someone that I can work with. <br><br></td></tr></table><br>
<a name="700724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> GRRRrrrrrr...<br><br>I think I need someone to write a dll to do this.  I'd try, but I don't have anything but Blitz.  <i>This is a hint...</i> <br><br></td></tr></table><br>
<a name="700729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Microsoft gives out it's express edition for free. You can make dlls quite easily with the Visual C++ Express edition or Visual C# express edition. <br><br></td></tr></table><br>
<a name="700733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where do I get it at (I could search but why bother when you could tell me)?<br><br>[EDIT]<br>Here's the download link if anybody else is curious:<br><a href="http://go.microsoft.com/fwlink/?LinkId=51410&amp;clcid=0x409" target="_blank">Express C++</a> <br><br></td></tr></table><br>
<a name="700745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can also get the Visual Basic express edition and the Visual J# express edition. Needless to say, I have them all :) <br><br></td></tr></table><br>
<a name="700912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> In your code you can stop the error messages by:<br>While success=$234<br>success = NetServerEnum(0,100,bufptr,MAX_PREFERRED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,0,dwResumehandle)<br>Wend<br><br>Simply continuing on receiving data from the function while there is still information. <br><br></td></tr></table><br>
<a name="701594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oooooooooooooh!<br><br>ERROR_MORE_DATA is supposed to be $234, not 234.<br><br>Thanks Kevin!<br><br>Now, to see if I can start a server. <br><br></td></tr></table><br>
<a name="701597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> no problem <br><br></td></tr></table><br>
<a name="706729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Kevin!  I found out why adding those lines prevents the error.  It SKIPS "success=NetServerEnum(0,100,..."  for proof, insert a "Stop" inside the loop - the "Stop" will never get triggered.<br><br>I think you wanted to do something like this:<br>success=$234<br>While success=$234<br>    success=NetServerEnum(0,100,bufptr,MAX_PREFERED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,0,dwResumehandle)<br>Wend<br><br>Or like this:<br>Repeat<br>    success=NetServerEnum(0,100,bufptr,MAX_PREFERED_LENGTH,dwEntriesread,dwTotalentries,SV_TYPE_ALL,0,dwResumehandle)<br>Until success=$234<br><br><b>BUT I FOUND I WAS WRONG ABOUT KNL!!!</b><br>I got it to work!<br><br>I'm on a different computer from my programming one so I can't post the code right now - I'll post as so as I can.<br><br>Thanks for all your help Kevin!  You're definently going to be in the credits.  I could try to send you a copy of of the game if you like - if/when I finish it.  Thanks! <br><br></td></tr></table><br>
<a name="706802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kevin8084</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad to have helped, Subirenihil :) <br><br></td></tr></table><br>
<a name="709075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alright!  I now have a program to demonstrate a no-IP network connection.<br><br><b>Step 1:</b> Download and install the K-NetLib<br><a href="http://www.krylarskreations.com/knl.shtml" target="_blank">K-NetLib</a><br><br><b>Step 2:</b> Run this code on several computers on your network. (it's quite elaborate, but uncommented)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Type host
	Field ip$,gn$,cp%,mp%,tim%
End Type

Type player
	Field id%,name$
End Type

Type chat
	Field msg$,pos%
End Type

Graphics 640,480,0,2
SetBuffer FrontBuffer()
Cls
Locate 0,0
name$=Input$("What is your name? ")
SetBuffer BackBuffer()

KNL_Initialize("{24538F2F-748F-4779-8E20-36D948406E34}",8,134)

KNL_EnumerateHosts(8080)

k$=""
xit$=0
Repeat
	While KNL_CheckMessages()=-1
		id=KNL_GetMessageID()
		If id=31
			hip$=KNL_FieldGetString$("HostIP")
			newh=True
			For h.host=Each host
				If h\ip$=hip$
					newh=False
					h\gn$=KNL_FieldGetString$("HostName")
					h\cp%=KNL_FieldGetInteger("CurrentPlayers")
					h\mp=KNL_FieldGetInteger("MaxPlayers")
					h\tim%=MilliSecs()
				EndIf
			Next
			If newh=True
				h.host=New host
				h\ip$=hip$
				h\gn$=KNL_FieldGetString$("HostName")
				h\cp%=KNL_FieldGetInteger("CurrentPlayers")
				h\mp=KNL_FieldGetInteger("MaxPlayers")
				h\tim%=MilliSecs()
			EndIf
		EndIf
		KNL_ClearMessage
	Wend
	Repeat
		k1=GetKey()
		k2=GetKey()
		kx=True
		Select k1
			Case 0:
			Case 8:
				If Len(k$)&gt;1 Then k$=Left$(k$,Len(k$)-1)
				If Len(k$)&lt;=1 Then k$=""
				kx=False
			Case 9:
				kx=False
				k$=k$+"    "
			Case 13:
				c.chat=New chat
				c\msg$=k$
				c\pos%=1
				k$=""
				kx=False
			Default:
				If k1&gt;=32 And k1&lt;=126
					k$=k$+Chr$(k1)
					kx=False
				EndIf
		End Select
		Select k2
			Case 0:
			Case 8:
				If Len(k$)&gt;1 Then k$=Left$(k$,Len(k$)-1)
				If Len(k$)&lt;=1 Then k$=""
				kx=False
			Case 9:
				kx=False
				k$=k$+"    "
			Case 13:
				c.chat=New chat
				c\msg$=k$
				c\pos%=1
				k$=""
				kx=False
			Default:
				If k2&gt;=32 And k2&lt;=126
					k$=k$+Chr$(k2)
					kx=False
				EndIf
		End Select
	Until kx=True
	pos=1
	For h.host=Each host
		If h\cp&lt;h\mp
			If KeyHit(58+pos) Then xit=h\ip$
			pos=pos+1
			c.chat=New chat
			c\msg$=h\gn$+" ("+Str$(h\cp)+"/"+Str$(h\mp)+")"
			c\pos%=2
		EndIf
		If MilliSecs()-h\tim&gt;3000 Then Delete h
	Next
	pos=1
	
	Cls
	Text 0,0,"Open Games (press the corrosponding function to join a game):",0,0
	For c.chat=Each chat
		If c\pos=1
			xit=1
		ElseIf c\pos=2
			If pos&lt;=11 Then Text 20,20*pos,c\msg,0,0
			pos=pos+1
			Delete c
		EndIf
	Next
	If MilliSecs() Mod 500 &gt; 250 Then
		Text 0,240,"Create Game: "+k$+"|"
	Else
		Text 0,240,"Create Game: "+k$
	EndIf
	Flip
Until xit&lt;&gt;0
KNL_StopHostsEnumeration

Cls
Flip

If xit=1
	For c.chat=Each chat
		If c\pos=1 Then Exit
	Next
	Text 320,240,"Starting net game "+Chr$(34)+c\msg$+Chr$(34)+" ...",1,1
	Flip
	
	If KNL_CreateHost(8080,c\msg$,"","",8)=0
		Cls
		Text 320,240,"Failed to create host. Press a key.",1,1
		FlushKeys
		Flip
		WaitKey
		KNL_Shutdown
		End
	EndIf
	KNL_SetPlayerInfo name$,""
Else
	For h.host=Each host
		If h\ip$=xit$ Then Exit
	Next
	Text 320,240,"Connecting to net game "+Chr$(34)+h\gn$+Chr$(34)+" ...",1,1
	Flip
	
	KNL_Shutdown
	KNL_Initialize("{24538F2F-748F-4779-8E20-36D948406E34}",8,138)
	If KNL_Connect(name$,"",xit$,8080,"",1)=0
		Cls
		Text 320,240,"Failed to connect to host. Press a key.",1,1
		FlushKeys
		Flip
		WaitKey
		KNL_Shutdown
		End
	EndIf
EndIf

For c.chat=Each chat
	Delete c
Next

Cls

k$=""
Repeat
	While KNL_CheckMessages()
		Select KNL_GetMessageID()
			Case 28:
				pid%=KNL_FieldGetInteger("LocalID")
				p.player=New player
				p\id%=pid%
				p\name$=name$
			Case 3
				pid%=KNL_FieldGetInteger("LocalID")
				p.player=New player
				p\id%=pid%
				p\name$=name$
			Case 4:
				pid%=KNL_FieldGetInteger("PlayerID")
				p.player=New player
				p\id%=pid%
				p\name$=KNL_GetPlayerName$(pid)
				c.chat=New chat
				c\pos=2
				c\msg$=p\name$+" has joined the game."
			Case 5:
				pid%=KNL_FieldGetInteger("PlayerID")
				For p.player=Each player
					If p\id%=pid%
						c.chat=New chat
						c\pos=2
						c\msg$=p\name$+" has left the game."
					EndIf
					Delete p
				Next
			Case 7:
				Select KNL_GetInteger(0)
					Case 1:
						pid%=KNL_FieldGetInteger("SenderID")
						For p.player=Each player
							If p\id%=pid%
								c.chat=New chat
								c\pos=2
								c\msg$=p\name$+": "+KNL_GetString$(1)
							EndIf
						Next
				End Select
		End Select
		KNL_ClearMessage()
	Wend

	Repeat
		k1=GetKey()
		k2=GetKey()
		kx=True
		Select k1
			Case 0:
			Case 8:
				If Len(k$)&gt;1 Then k$=Left$(k$,Len(k$)-1)
				If Len(k$)&lt;=1 Then k$=""
				kx=False
			Case 9:
				kx=False
				k$=k$+"    "
			Case 13:
				c.chat=New chat
				c\msg$=k$
				c\pos%=1
				k$=""
				kx=False
			Default:
				If k1&gt;=32 And k1&lt;=126
					k$=k$+Chr$(k1)
					kx=False
				EndIf
		End Select
		Select k2
			Case 0:
			Case 8:
				If Len(k$)&gt;1 Then k$=Left$(k$,Len(k$)-1)
				If Len(k$)&lt;=1 Then k$=""
				kx=False
			Case 9:
				kx=False
				k$=k$+"    "
			Case 13:
				c.chat=New chat
				c\msg$=k$
				c\pos%=1
				k$=""
				kx=False
			Default:
				If k2&gt;=32 And k2&lt;=126
					k$=k$+Chr$(k2)
					kx=False
				EndIf
		End Select
	Until kx=True

	pos=0
	For c.chat=Each chat
		If c\pos=1
			d.chat=New chat
			d\msg$=name$+": "+c\msg$
			d\pos=2
			KNL_SendInteger 1
			KNL_SendString c\msg$
			KNL_UpdateNetwork(0,0,1000,2)
			Delete c
		Else
			pos=pos+1
		EndIf
	Next
	If pos&gt;20
		c.chat=First chat
		For a=1 To pos-20
			d.chat=After c
			Delete c
			c=d
		Next
	EndIf
	pos=0
	Cls
	For c.chat=Each chat
		Text 0,pos*20,c\msg$,0,0
		pos=pos+1
	Next
	If MilliSecs() Mod 500 &gt; 250 Then
		Text 0,420,"Chat: "+k$+"|"
	Else
		Text 0,420,"Chat: "+k$
	EndIf
	Flip
Until KeyHit(1)

KNL_Shutdown
End
</textarea> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
