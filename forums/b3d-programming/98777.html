<!DOCTYPE html><html lang="en" ><head ><title >I need some help with changing between b3d anims</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >I need some help with changing between b3d anims</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >I need some help with changing between b3d anims</a><br><br>
<a name="1156451"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Newbie31</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, <br><br>I am new to the website and programming in general. I trying to make my first 3d game and I have run into problems in changing between animations with b3d file. <br><br>What I'm doing is - I load an animesh, then create a for loop to go through and animate the child nodes and extract the ani sequences then I made a varible that changes when enter is pressed then I link the variable to the animseq but when the varible changes the animseq doesn't.<br><br>Could anyone tell me what I'm doing wrong?<br><br>Here is a link to my file(megashares has been most reliable for me).<br><a href="http://d01.megashares.com/dl/aoq5TJR/Stickman" target="_blank">http://d01.megashares.com/dl/aoq5TJR/Stickman</a> test.rar<br><br>[bbcode]<br><br><br><br>;Set Graphics And Global Constraints<br><br>	;Set Graphics buffer<br>	Graphics3D 800,600,2,2<br>	SetBuffer BackBuffer()<br>	<br>	;Set collision type values<br>	PLYER=1<br>	SCENE=2<br>	<br>	;Global Constraints<br>	Global h_value=50<br><br><br>	Global FreeLookXS#, FreeLookZS#, FreeLookRotXS#, FreeLookRotYS#,Pitch#<br>	Global gfxcrosshair<br>	<br>;IMPORTANT CREATE TYPES TO FIND SUB-ANIMATIONS FROM ROOT NODES<br>	Global Model<br>	Type subanim<br>	Field model_child<br>	Field anim<br>	End Type <br><br>	Global aniseq%=1<br>	<br>;------------------------------------------------------------------------------------<br><br>;Create Cameras<br>	;Create Camera 1<br>Global	camera01=CreateCamera()<br>	CameraRange camera01,1,200<br>Global	camera02=CreateCamera()<br>	CameraRange camera02,1,200<br><br>;------------------------------------------------------------------------------------<br><br>;Create Lights<br>	;Create Light<br>	Light=CreateLight()<br>	RotateEntity light,0,0,0<br>	<br>;------------------------------------------------------------------------------------<br><br>;Create Objects<br>	;Create Plane<br>	plane=CreatePlane()<br>	EntityRadius plane,1<br>	EntityType plane,SCENE<br>	PositionEntity plane,0,0,0<br><br>	;Create Cube<br>	cube1=CreateCube()<br>	EntityRadius cube1,1<br>	EntityType cube1,SCENE<br>	PositionEntity cube1,-10,1,5<br><br>	;Create Cube<br>	cube2=CreateCube()<br>	EntityRadius cube2,1<br>	EntityType cube2,SCENE<br>	PositionEntity cube2,10,10,5<br>	<br>	<br>;------------------------------------------------------------------------------------<br>	<br>;Load Mesh	<br>	mesh=LoadAnimMesh("meshes\stickman.b3d")<br>	PositionEntity mesh,0,0,10<br>	ScaleEntity mesh,.05,.05,.05<br>	RotateEntity mesh,0,180,0<br><br><br>;------------------------------------------------------------------------------------<br><br>;Create Player<br>	player=CreateCube()<br>	EntityRadius player,1<br>	EntityType player,PLYER<br>	PositionEntity player,0,1,0<br>		<br>;------------------------------------------------------------------------------------<br><br>;Create pivots<br>	piv01=CreatePivot(player)<br>	PositionEntity piv01,0,4,0<br><br>	piv02=CreatePivot(player)<br>	PositionEntity piv02,5,4,0<br>	RotateEntity piv02,0,90,0<br><br>	<br>;------------------------------------------------------------------------------------<br><br>;Load Textures And Images<br>;Images<br>	gfxcrosshair=LoadImage("Textures\Crosshair.bmp")<br><br>;Textures<br>	;1 TERRAIN<br>	terr=LoadTexture("Textures\GRASS2.jpg")<br>	;2 CRATE<br>	crate=LoadTexture("Textures\wcrate.jpg")<br>	pivtex=LoadTexture("Textures\wcrate2.jpg")<br>	;3 PLAYER TEXTURE<br>	player_tex=LoadTexture("Textures\box.jpg")<br>	stick_tex=LoadTexture("Textures\char_tex.jpg")<br>	<br>;------------------------------------------------------------------------------------<br><br>	;Apply Textures To Entities<br>	EntityTexture plane,terr<br>	EntityTexture cube1,crate<br>	EntityTexture cube2,crate<br>	EntityTexture player,player_tex<br>	EntityTexture mesh,stick_tex<br><br>;------------------------------------------------------------------------------------<br><br>;Set collision method and response values<br>	method=2<br>	response=2<br><br>;------------------------------------------------------------------------------------<br>;Collect and animate root nodes<br><br>	;mesh Model<br>	For x = 1 To CountChildren(mesh)<br>	p.subanim = New subanim<br>	p\model_child = GetChild(mesh,x)<br>	walk1 = ExtractAnimSeq(p\model_child,0,110)		;walking animation<br>	idle1 = ExtractAnimSeq(p\model_child,110,190)	;idle animation<br>	If AnimLength(p\model_child)&gt;=0 Then<br>	Animate p\model_child,1,1,aniseq%,0<br>	EndIf<br>	Next<br><br><br>;-------------------------------------------------------------------------------------<br><br><br>;Set Key Functions<br>While Not KeyDown( 1 )<br><br><br>	If KeyHit( 28 )=1 <br>		If aniseq%=2<br>			aniseq%=1<br>		Else aniseq%=1<br>			aniseq%=2<br>		EndIf<br>	End If<br><br>;**************************  Animation Sequence Notes   *****************************<br><br>;do not uncomment<br>;mesh<br>; AnimSequence 0 = frames 0 to 200		[default sequence]<br>; AnimSequence 1 = frames 0 to 110		[walk1 sequence]<br>; AnimSequence 2 = frames 110 to 200	[idle1 sequence]<br><br>;**************************        End Of Notes         *****************************<br><br>;	If KeyDown(28) ; works with "If KeyDown(28)" but not with "If KeyHit(28)"<br>;<br>;		If AnimSeq(GetChild(mesh,1))=1 Animate GetChild(mesh,1),1,1,2,0<br>;	Else<br>;<br>;	If AnimSeq(GetChild(mesh,1))=2 Animate GetChild(mesh,1),1,1,1,0<br>;	EndIf<br><br><br>;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;<br>;Case Select Camera <br>	If KeyHit( 46 )		<br>		<br>		whichcamera% = 1-whichcamera%<br>	;	FreeEntity act_cam<br>		<br>		Select whichcamera%<br>		<br>			Case 0 <br>				HideEntity camera01<br>				ShowEntity camera02<br>			Case 1<br>				HideEntity camera02<br>				ShowEntity camera01<br>		End Select<br>		<br>	End If<br>	<br>	; Toggle wireframe enable value between true and false when spacebar is pressed <br>If KeyHit( 57 )=True Then enable=1-enable <br><br>; Enable/disable wireframe rendering <br>WireFrame enable <br><br>	<br>;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;<br><br>;object movement according to mouse pointer position<br><br>	FreeLook(player,piv01, .1)<br>	CamFollow(camera01,piv01,.18,8,0,0,0)<br>	<br>;object movement according to mouse pointer position<br><br>	FreeLook(player,piv02, .01)<br>	CamFollow(camera02,piv02,.18,8,0,0,0)<br>	<br>;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;	<br><br><br>;------------------------------------------------------------------------------------<br><br>	;Enable Collions between type_character and type_scenery<br>	Collisions PLYER,SCENE,method,response<br><br>;------------------------------------------------------------------------------------<br><br>UpdateWorld<br><br>RenderWorld<br><br>;------------------------------------------------------------------------------------<br><br>;Set Onscreen Display<br><br>DrawImage gfxcrosshair,MouseX()-14,MouseY()-14 ; Draw the image!<br>;HidePointer<br><br><br>	Text 0,0,"Use cursor keys to move about the infinite plane" <br>	Text 0,20,"Press [C] to toggle between Cameras"<br>	Text 0,50,"Mesh Child - Number('stickman') : "+ FindChild(mesh,"stickman")<br>	<br>	Text 0,70,"Number of children in Stickman Mesh : "+ CountChildren(mesh)<br>	<br>	Text 0,110,"aniseq variable : " + aniseq%<br><br>	Text 0,130,"Current Animation Sequence ; " + AnimSeq(GetChild(mesh,1)) <br><br>	If Animating(GetChild(mesh,1))=1<br>	Text 0,170,"mesh is animating"<br>	Else<br>	Text 0,170,"mesh is not animating"<br>	EndIf<br><br>	<br>Flip<br>Wend<br><br>End<br><br><br>;------------------------------------------------------------------------------------<br><br>;Functions<br><br><br>Function CamFollow(cam,ent,cspeed#,dist#,hite#,xrot#,tilt#)<br><br>TFormPoint 0,hite#,-dist#,ent,0<br><br>cx#=(TFormedX()-EntityX(cam))*cspeed#<br>cy#=(TFormedY()-EntityY(cam))*cspeed#<br>cz#=(TFormedZ()-EntityZ(cam))*cspeed#<br><br>TranslateEntity cam,cx,cy,cz<br><br>RotateEntity cam,xrot#,EntityYaw(cam),tilt#<br>PointEntity cam,ent<br>End Function<br><br>Function FreeLook(Object_Horizontal,Object_Vertical, sp# = .5)<br>If sp# &gt; 0 Then<br>    Side_Direction=((KeyDown(32) Or KeyDown(205)) - (KeyDown(30) Or KeyDown(203)))<br>    Front_Direction=((KeyDown(17) Or KeyDown(200)) - (KeyDown(31) Or KeyDown(208)))<br>	FreeLookXS# = (FreeLookXS# + Side_Direction * (sp#/2)) * .75<br>	FreeLookZS# = (FreeLookZS# + Front_Direction * sp#) * .75<br>	MoveEntity Object_Horizontal, FreeLookXS#, 0, FreeLookZS#<br>EndIf<br><br>FreeLookRotXS# = ((MouseXSpeed() - FreeLookRotXS#) * .2 + FreeLookRotXS#) * .45<br>FreeLookRotYS# = ((MouseYSpeed() - FreeLookRotYS#) * .2 + FreeLookRotYS#) * .45<br>If EntityPitch(Object_Vertical) + FreeLookRotYS# &lt; -25 Pitch# = -25 ElseIf EntityPitch(Object_Vertical) + FreeLookRotYS# &gt; 45 Pitch# = 45 Else Pitch# = EntityPitch(Object_Vertical) + FreeLookRotYS#<br>yaw# = -FreeLookRotXS# + EntityYaw(Object_Horizontal)<br>RotateEntity Object_Horizontal, 0, yaw#, 0<br>RotateEntity Object_Vertical, Pitch#, 0, 0<br>MoveMouse GraphicsWidth() / 2, GraphicsHeight() / 2<br>End Function<br><br>[/bbcode] <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
