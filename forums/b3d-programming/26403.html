<!DOCTYPE html><html lang="en" ><head ><title >Textures containing transparent sections</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Textures containing transparent sections</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Textures containing transparent sections</a><br><br>
<a name="274723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glitch01</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am having some trouble creating a texture with transparency from a masked image in memory.<br><br>Here's what I'm trying to do... my program generates an image in memory with certain parts having RGB values of 255,0,255 which I then set as masked.  If I draw this to the screen as a normal image it will plot correctly with the 255,0,255 portions invisible.<br><br>Now I need to create a texture out of this image, maintaining transparency where the color is 255,0,255.  I can't seem to get this to work.  <br><br>I create the texture, set the buffer to texturebuffer() of my texture and DrawImage() the image to the texture.  If I apply this texture to an object using the COLOR flag, it draws the texture showing the 255,0,255 color.. if I try to set the MASKED flag it draws the entire texture completely black.  <br><br>I've tried setting different texture flags but nothing is working as I imagined (they either turn the texture completely black on the screen or completely invisible).  I tried  searching the forums and wasn't able to find any threads on this (if they exist I sure couldn't find them!).<br><br>Any help would be greatly appreciated :-)<br><br>-Steve <br><br></td></tr></table><br>
<a name="274732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm not sure if you can set the masked colour of a texture. I'd be very glad if someone proved me wrong tho :) Oh the search feature of the forums kinda sucks, so don't give up if you've searched and not came across anything :o)<br><br>Could you not just set use 0,0,0 as your masked colour? And set the black parts to 1,1,1? <br><br></td></tr></table><br>
<a name="274737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glitch01</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure I understand what you mean by setting the black to 1,1,1 ...<br><br>Here's a very stripped down example of what I'm trying to do.. I'd like the black part of the texture (the black circle) to be transparent or even semi-transparent:<br><br>[CODE]<br><br>Graphics3D 640,480,0,2<br><br>camera = CreateCamera()<br>light  = CreateLight()<br>cube   = CreateCube()<br>sphere = CreateSphere()<br><br>;Create image<br>gfx = CreateImage(64,64)<br>	  SetBuffer ImageBuffer(gfx)<br>	  ClsColor 200,0,0<br>	  Cls()<br>	  Color 0,0,0<br>	  Oval 2,2,60,60,True<br>	  Color 255,255,255<br>	  Text 10,25,"HELLO!"<br>	  MaskImage gfx,0,0,0<br><br>;Create texture from masked image<br>tex = CreateTexture(64,64,1)<br>	  SetBuffer TextureBuffer(tex)<br>      DrawImage gfx,0,0<br><br><br>SetBuffer BackBuffer()<br><br><br>;Apply texture to cube<br>	EntityTexture cube, tex<br><br><br>;Position Camera<br>	PositionEntity camera,0,-5,0<br>	PointEntity camera,cube<br><br>While Not KeyHit(1)<br>	TurnEntity cube,1,2,1<br>	UpdateWorld()<br>	RenderWorld()<br>	Flip()<br>Wend<br>End<br>[/CODE]<br><br>-Steve <br><br></td></tr></table><br>
<a name="274808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> First - there are two Transparency Modes for Textures: Mask and Alpha.<br><br>You have to define this as the Textureflag, 4 for Mask or 2 for Alpha.<br><br>tex=createtexture(64,64,2 or 1)<br>so it's Alpha as well as fullright.<br><br>With Mask you only have the choice of opaque(non-black) or fully transparent(black). With alpha the Brightness of the Pixel will define its tranparency, the darker, the more transparent, UNLESS you load a Texture with a predefined Alpha-Channel such as a 32 Bit TGA Picture.<br><br>However, you can manipulate the Alpha-Channel of a Texture in Memory whenever you like this way:<br><br><pre class=code>
setbuffer texturebuffer(tex)
lockbuffer
for j=0 to textureheight(tex)-1
 for i=0 to texturewidth(tex)-1
  rgb=readpixelfast(i,j) and $FFFFFF
  ;  example of semitransparence for black parts:
  if rgb=0 ; black
   argb=(127 shl 24) or rgb ; using 127 for alphabyte
  else
   argb=rgb ; alphabyte remains zero
  endif
  writepixelfast i,j,argb
 next
next
unlockbuffer
setbuffer backbuffer()
</pre><br><br>Please note, that unlike Maskmode the Alphamode sometimes makes Problems with the Z-Order of the Objects, especially if they have intersecting parts. <br><br></td></tr></table><br>
<a name="274832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glitch01</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> JFK:  <br><br>Thanks for your reply, this is essentially what I was after, only I hoped there was an "easier" way to do this using drawimage() or copyrect().  <br><br>Not long before you posted I found another <a href="/bbs/posts.php?topic=21784" target="_blank">thread</a> that gave a very similar solution to what you gave here.<br><br>I did notice a z-order flaw when using the alpha (and later read a reference to this in a different thread).  Too bad as I was looking forward to using alpha rather than a complete mask.  Is there any work-around for this?<br><br>Thanks again for your help!<br><br>-Steve <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
