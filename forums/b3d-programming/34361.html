<!DOCTYPE html><html lang="en" ><head ><title >Mesh Triangle Reduction?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Mesh Triangle Reduction?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Mesh Triangle Reduction?</a><br><br>
<a name="371059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I have a model mesh containing 2000 triangles, is it possible to reduce the amount of triangles used to 1000 triangles, giving the model a less smoothed look (like the opposite of sub-dividing).<br><br>I'm using Quill 3D but I can't find any function to do this, can anyone help?<br><br>Is it possible in Blitz3D to directly assign the maximum number of triangles used in a mesh automatically? <br><br></td></tr></table><br>
<a name="371088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a crude function to do this in your samples folder:<br>samples\birdie\lodmesh<br><br>It's written by the same person who wrote Quill, so I'm surprised that it doesn't have any. <br><br></td></tr></table><br>
<a name="371102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Polygon reduction is a tricky problem, and one without any really good solution.  There are free tools available for that purpose, but their results aren't great.  Also, most polygon reduction tools screw up texture mapping.<br><br>Best results generally require doing polygon reduction manually, by merging vertices/collapsing edges. <br><br></td></tr></table><br>
<a name="371220"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't tried this tool, but if you check out the demo, it might be what you're looking for.<br><br><a href="http://www.thegamecreators.com/?f=action3d" target="_blank">http://www.thegamecreators.com/?f=action3d</a><br><br>------ <br><br></td></tr></table><br>
<a name="371502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the replies all, I'll take a look at the lod function and the demo.<br><br>It sounds like it would be best to design meshes using the lowest possible poly count, then sub-divide where necessary rather than design hi-poly meshes and then try poly reduction. That's ok for my own meshes, but trying to lower the poly count manually in other authors meshes looks like it will be a lot of work.<br><br>[EDIT]<br>The birdie lod demo is far too crude to be of any use, that is probably why it isn't used in Quill :(<br><br>But the Action3D demo looks promising, thanks again Axeman :) <br><br></td></tr></table><br>
<a name="377804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a free poly reduction tool I came across that might be worth a look.<br><br><a href="http://www.paralelo.com.br/en/solucoes/tecnologia/progmesh/index.php" target="_blank">http://www.paralelo.com.br/en/solucoes/tecnologia/progmesh/index.php</a> <br><br></td></tr></table><br>
<a name="377829"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's the first lod function I wrote for vivid. It works using a radial claw. Any verts within the claw of another vert is removed, and replaced with the original vert. This is repeated for every vert.<br><br>Then any triangles with more than 1 clashing vert(I.e repeat) are removed from the mesh. Result is it works on any <br>kind of mesh.<br><br>VBank=a bank containing your verts. I.e byte0=vertex0 x,byte4 =vertex0 y.<br>and the tri banks are simply indices to each vert. <br><br>The cool thing is you can re-use the original vert pool using this method. <br><br>Uv mapping like jhocking said though can get a little distorted with too much lod. <br><pre class=code>
Function glGenLod(sdat.sdat,level=0,rad#=0.08,mathes=2)
	Local Vbank
	oBank=sdat\cVerts
	nTri=CreateBank( BankSize(sdat\cTris))
	;CopyBank(oBank,0,vBank,0,BankSize(sdat\cverts))
	Local vertSt[50000] ;Should have used banks for this.
	Local vertTo[50000]
	vertC=sdat\vc
	
;	DebugLog "Was "+vertC+" vertices"
	For v=0 To VertC-1
	
		If vertSt[v]=False
		x#=PeekFloat(obank,vo)
		y#=PeekFloat(oBank,vo+4)
		z#=PeekFloat(obank,vo+8)
		;DebugLog x+" &gt;"+y+" z&gt;"+z
		
		so=0
	;	DebugLog "==============Checking Vert&gt;"+v+"----"
		For ov=0 To vertC-1
			
			tx#=PeekFloat(oBank,so)-x
			ty#=PeekFloat(oBank,so+4)-y
			tz#=PeekFloat(oBank,so+8)-z
		
			If Sqr(tx*tx+ty*ty+tz*tz)&lt;rad ;see if it's within clipping range.
				If ov&lt;&gt;v ;make sure its not the same vert. quicker to check here.
					If vertSt[ov]=False
					vertSt[ov]=True
					vertTo[ov]=v
					;opti=opti+1	
				;	DebugLog "------------&gt;"+ov
					oc=oc+1
				;	DebugLog x+" &gt;"+y+" z&gt;"+z
				;	DebugLog "2:"+PeekFloat(obank,so)+" &gt;"+PeekFloat(obank,so+4)+" &gt;"+PeekFloat(obank,so+8)
					EndIf
				Else
	;			DebugLog "nope"	
			;		DebugLog "----NOT MATCH--------&gt;"+ov
			;		oc=oc+1
			;		DebugLog x+" &gt;"+y+" z&gt;"+z
			;		DebugLog "2:"+PeekFloat(obank,so)+" &gt;"+PeekFloat(obank,so+4)+" &gt;"+PeekFloat(obank,so+8)
	
				;s;o=so+12
				EndIf	
			Else
			;DebugLog "----NOT MATCH--------&gt;"+ov
			;		oc=oc+1
			;		DebugLog x+" &gt;"+y+" z&gt;"+z
			;		DebugLog "2:"+PeekFloat(obank,so)+" &gt;"+PeekFloat(obank,so+4)+" &gt;"+PeekFloat(obank,so+8)

			EndIf
				so=so+12
		
		Next
		EndIf
		vo=vo+12
	Next
	;Now generate new TriList
	ctris=sdat\ctris
	nTri=CreateBank(BankSize(sdat\cTris))
	Local vI[5]
	For t=0 To sdat\tc-1
		For v=0 To 2
			vid=PeekInt(ctris,(t*12)+(v*4))
			
			If vid&gt;49999 Stop
			If vertSt[vid]=True
				nVert=vertTo[vid]
			Else
				nVert=vid
			EndIf
			vI[v]=nVert
			PokeInt(nTri,texO+(v*4),nVert)
		Next
		did=1
		If vi[0]=vi[1] Or vi[0]=vi[2] Or vi[1]=vi[2]
	;	If vi[1]=vi[2]
			did=0
		;EndIf
		EndIf
		
		If did=1
			texO=texO+12
			tC=tC+1
		EndIf
		
	Next
	;sdat\vBufId[level]=vBank
;	sdat\lTris[level]=nTri
	
	glGenBuffersObj(1,vbank)
	glBindBufferObj( GL_ELEMENT_ARRAY_BUFFER_ARB,PeekInt(vbank,0))
	If sdat\glOptimise=0 sdat\glOptimise=glStatic
	glBufferDataObj(GL_ELEMENT_ARRAY_BUFFER_ARB,BankSize(sdat\cTris),Ntri,sdat\glOptimise)
	
	sdat\tBufId[level]=PeekInt(vbank,0)
	sdat\lTc[level]=tc
	
	FreeBank vbank
	;DebugLog "Now "+Str(vertC-opti)+" vertices"
	
	;DebugLog "saved "+oc+" verts
;	DebugLog "old Tris&gt;"+sdat\tc
;	DebugLog "new Tri count&gt;"+tc	
End Function

</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
