<!DOCTYPE html><html lang="en" ><head ><title >Odd camera rotation...what am I doing wrong?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Odd camera rotation...what am I doing wrong?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Odd camera rotation...what am I doing wrong?</a><br><br>
<a name="1033194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got a problem here - this simple piece of code positions my game camera at the position of a vehicle, aligns it to the vehicle's X and Z axes, moves it upwards and backwards into the correct position for the driver, then adds a rotation controlled by the joypad right stick.<br><br>The problem is that the camera is ORBITING the point where it is placed BEFORE the MoveEntity 0,0.75,-1 - it should be ROTATING at the point where it is moved to by the MoveEntity 0.0.75,-1 command.<br><br>I honestly can't see what I've got wrong here - anyone spot something daft that I've done? It's almost as if the camera is parented to a pivot and is therefore rotating around that, but it's not parented to anything at all.... I'm really stuck on this one.<br><br><pre class=code>
		CameraZoom gamedata\camera1,1.3

		;position at correct position
		PositionEntity gamedata\camera1,TOKRB_GetX#(v\chassis_RB),TOKRB_GetY#(v\chassis_RB),TOKRB_GetZ#(v\chassis_RB)
		
		;align to x axis
		TFormVector 1,0,0 , v\chassis_mesh , 0
		AlignToVector gamedata\camera1 , TFormedX#() , TFormedY#() , TFormedZ#() , 1 , 0.25

		;align to z axis
		TFormVector 0,0,1 , v\chassis_mesh , 0
		AlignToVector gamedata\camera1 , TFormedX#() , TFormedY#() , TFormedZ#() , 3 , 0.25

		;position at driver's position	
		MoveEntity gamedata\camera1 , 0 , 0.75 , -1

		;rotate camera dep. upon the right stick look
		TurnEntity gamedata\camera1,0,gamedata\look_yaw#,0,False
</pre> <br><br></td></tr></table><br>
<a name="1033199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ugh, solved it - turns out that the AlignToVector commands are the cause of the problem, although I don't know why - they were correctly orienting the camera to the car with no issues, until I tried to move the camera backwards.<br><br>I've swapped them out for a single RotateEntity command that matches the camera's rotation in all axes to the rotation of the chassis_RB object, and now it's working as expected.<br><br>Very odd indeed. <br><br></td></tr></table><br>
<a name="1033236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob the Great</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just out of curiosity, are you using a collision system for your camera? In other words, will the camera will collide with the terrain and other objects?<br><br>The reason why I ask is because I've noticed that there seems to be a huge issue when I position the camera like you do, and the camera collides and doesn't position or rotate itself correctly. To solve the problem, I use ResetEntity() on the camera a lot.<br><br>I'm just wondering if anyone else has had this problem, and if there's an easier solution. <br><br></td></tr></table><br>
<a name="1033470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> no, my camera has no collision, so it's not being caused by that.<br><br>In my original code I aligned the camera to v\chassis_mesh, whereas in the modfied working one I aligned it to v\chassis_RB - I wonder if v\chassis_mesh was actually parented to something and therefore the aligntovector command was being messed up by the parent-&gt;child offset...? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
