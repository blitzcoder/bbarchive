<!DOCTYPE html><html lang="en" ><head ><title >Aplication launched via GPO on a domain.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Aplication launched via GPO on a domain.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Aplication launched via GPO on a domain.</a><br><br>
<a name="860500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lord_Troll</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My program is launched by a GPO on our domain. The only problem is that I want the ini file (which is located on a server share with the program) to be read and input information into the program.<br>When the program is launched by a user it functions correctly, but when the GPO launches my application, it can not find the ini file. Any clues?<br>I do not want to encode our server path into the acctual program becuase then it can not be moved to a different server or company or customer (unless I recompile it for them each time).<br>Here is the function that reads ini file.<br><br>;This function sets the server_path$ string, and configures the three text lines in the graphics display.<br>;All based on the appPusher.ini file.<br>Function Read_ini ()<br>	file = OpenFile("appPusher.ini") ;Open the ini file<br>	If FileType ("appPusher.ini") = 1 ;test to see if the ini file is a file (it could be a folder by mistake, or not exist).<br>		While Not Eof(file)<br>			ini$ = ReadLine(file)<br>				If Instr (ini$, "Server_Path=") &lt;&gt; 0 ;This checks to see if the read line is the server path line.<br>					server_path$ = ""<br>					For i = 13 To Len (ini$)<br>						a$ = Mid (ini$, i, 1)<br>						server_path$ = server_path$ + a$<br>					Next<br>				Else If Instr (ini$, "Message Text Line1") &lt;&gt; 0<br>					graphicsTextLine1$ = ""<br>					For i = 13 To Len (ini$)<br>						a$ = Mid (ini$, i, 1)<br>						graphicsTextLine1$ = graphicsTextLine1$ + a$<br>					Next<br>				Else If Instr (ini$, "Message Text Line2") &lt;&gt; 0<br>					graphicsTextLine2$ = ""<br>					For i = 13 To Len (ini$)<br>						a$ = Mid (ini$, i, 1)<br>						graphicsTextLine2$ = graphicsTextLine2$ + a$<br>					Next<br>				Else If Instr (ini$, "Message Text Line3") &lt;&gt; 0<br>					graphicsTextLine3$ = ""<br>					For i = 13 To Len (ini$)<br>						a$ = Mid (ini$, i, 1)<br>						graphicsTextLine3$ = graphicsTextLine3$ + a$<br>					Next<br>				Else<br>					RuntimeError "The program ini file does not have the correct data in it. (Run the config program.)"<br>				End If<br>		Wend<br>	Else<br>		RuntimeError "The ini file is missing or corrupt. Please run the config program to fix it."<br>	End If<br>End Function <br><br></td></tr></table><br>
<a name="860502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lord_Troll</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for the lack of tabs in the above function (they are in blitz, but did not show up).<br>Also, how do you put your code snipits into the post in Blue with the proper formatting?<br><br>Thanks!!!!! <br><br></td></tr></table><br>
<a name="860796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use [ code]Your code[ /code] or [ codebox]Your code[ /codebox] (for a scrollable codebox) but remove the space after the opening bracket.<br><br>The forum codes:-<br><a href="http://www.blitzbasic.com/faq/faq_entry.php?id=2" target="_blank">http://www.blitzbasic.com/faq/faq_entry.php?id=2</a><br><br>The faqs:-<br><a href="http://www.blitzbasic.com/faq/faq.php" target="_blank">http://www.blitzbasic.com/faq/faq.php</a> <br><br></td></tr></table><br>
<a name="860836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snarkbait</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You know you can easily access INI file info with a userlib? There's code in the archives.<br><br>Shouldn't you test if the file exists before you open it?<br><br>Can't help with your problem, however, sorry. <br><br></td></tr></table><br>
<a name="860843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Lord_Troll</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you Bill, I appriciate the info.<br><br>Snarkbait, thank you for the suggestion about the userlib, I will have to look into them. As to the OpenFile command, it returns an integer of zero if the file does not exist. Thus if the file does not exist you get the RuntimeError at the bottom of the function.<br><br>I think that I may have solved my problem by using the Commandline$() command. Adding it into my program and the correct parameter into the GPO on the domain seams to work. Wish I had more domains to test it on. <br><br></td></tr></table><br>
<a name="860846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yo! Wazzup?</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> And Lord_Troll, you can edit your post if you want to.<br><br>Next to the timestamp on the right. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
