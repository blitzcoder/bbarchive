<!DOCTYPE html><html lang="en" ><head ><title >How does lightmapping actually work??</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How does lightmapping actually work??</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How does lightmapping actually work??</a><br><br>
<a name="811438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hm, i would be interested in making a good lightmapper, but there are a couple of questions i do not  understand...<br><br>1. how does the lightmapper recognize a "surface" - you know what i mean...<br>2. how are the final images stored in the lightmap image file? how are they sorted?<br><br>you know me - i like doing that, i'm a demo scener myself. and open source, too :)<br>anyway... awaiting your answers, but i can not promise, that i understand this ;)<br>bye <br><br></td></tr></table><br>
<a name="811446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think I understand either question.<br><br>What's a surface? You mean several triangles which have an identical surface normal? Or several triangles which have smoothed edges between them ( like an entire sphere would be one surface? )<br><br>You mean how are the sections packed together? From memory, I think the quick and dirty method is to sort by width as the first key and height as the second key ( the second key being the one you use when you get two items with the same first key ) and then zig zag back and forth across the texture, left to right, right to left, filling in images as you go, in each case going through the list in sorted order until you find the widest image which will fit. <br><br></td></tr></table><br>
<a name="811457"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> a surface is a bunch of gapless polygons facing into the same direction.<br><br>and i mean this with the sorting algorithm<br><img src="http://spies.net/lightmap.png"> <br><br></td></tr></table><br>
<a name="811466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well you're going to spot "surfaces" by starting with one triangle and then finding all triangles which share at least one vertex with that starting triangle or any of the other triangles you've decided are part of that surface and have the same surface normal. If you want to lightmap smooth curves, you will want to disregard the surface normal requirement.<br><br>I already answered the sorting algorithm. I'm sure there are lots of ways of doing it, some better than others, but the width sort I mentioned worked pretty well for me. <br><br></td></tr></table><br>
<a name="811471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> hm. is there a working sample in the forums (i can understand ;D )? <br><br></td></tr></table><br>
<a name="811525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a complete lightmapper in the code archives. I don't know if you'll understand it or not. I couldn't make much sense of it, but I'm not very good at reading other people's code, so perhaps you'll do better than me.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=794" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=794</a> <br><br></td></tr></table><br>
<a name="811570"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> hm thats what i was talking about; i cant read peoples code so good, too. especially code that long :( <br><br></td></tr></table><br>
<a name="811724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am laning for voidrpg.<br>1) using normal lighning.<br>2) using vertex color to add more Dark surface from trees.<br><br>the problem with my method is that is verry verry not detailed at all. <br><br></td></tr></table><br>
<a name="811737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> * devils child shuts his mouth tight <br><br></td></tr></table><br>
<a name="811836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had a little lightmapper project in this forum section, it even supported GI. There was a little Bug with sawtheeth rounding problems with masked Textures, may be solved somehow. Plus, the speed was miserable.<br><br>However, it worked.<br><br>First all tris are unwelded. THen every triangle is UVmapped, just watched from above it (aligned to the triangle normals), so there's optimal UVmapping. Then the tris on the UVmap should be sorted and aligned in an optimized way. <br><br>If you once got the UVmapping done, the rest is easy IMHO. Simply check every texel. if it can see the lights, add a certain value (eg. -distance*lightcolor) to a light-parameter for each texel. finally draw this texels light-parameter to the lightmap.<br><br>BTW here's the mentioned thread:<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=71137#796234" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=71137#796234</a><br><br>And I never said that this is how lightmapping actually works :) <br><br></td></tr></table><br>
<a name="811859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gillissie</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey jfk, the link to your lightmapper Slim Shady doesn't seem to have anything to download except music.<br><a href="http://www.melog.ch/slimshady/" target="_blank">http://www.melog.ch/slimshady/</a> <br><br></td></tr></table><br>
<a name="811907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, strange. thanks for reporting, will try to fix it. Could be a bug in a ftp client that I recently used. Or maybe I dropped something by accident and didn't notice.<br>EDIT - ok I hopefully fixed it. I have no idea how the file was copied to that folder. <br><br></td></tr></table><br>
<a name="811939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> hm 1.500 lines of code... will need time to check this through. thanks a lot! :) <br><br></td></tr></table><br>
<a name="812745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> while you two are on the topic of slimshady, how can I get a lightmap of over 2048 x 2048 resolution?? Cause I've got a huge building I want light-mapped, but with the max 2048 resolution, It looks kinda crappy.  (PS: Devil's child, if you make that lightmapper, let me know ) <br><br></td></tr></table><br>
<a name="812747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..try to use multiple lightmaps... <br><br></td></tr></table><br>
<a name="812766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pete Carter</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> anything over 2048x2048 will be incompatable with most graphics cards like Naughty alien says use multiple light maps. <br><br></td></tr></table><br>
<a name="812900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> k <br><br></td></tr></table><br>
<a name="812910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> i would set the maximum of a texture size to 1024x1024. thats a good deal for every gfx card. to 512x512 on older games <br><br></td></tr></table><br>
<a name="813245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >chwaga</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I figured out the problem, It was the lumel's thanks <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
