<!DOCTYPE html><html lang="en" ><head ><title >Calling a exe from another exe?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Calling a exe from another exe?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Calling a exe from another exe?</a><br><br>
<a name="644081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>Assuming exe1 and exe2 are executable files compiled by<br> Blitz3D:<br><br>(1) Is it possible to call a exe2 from another exe1?<br>After exe2 is finished, it returns controls to exe1 and continue running. (similar to procedure/function)<br><br>(2)If possible, could we return some results from exe2 <br>to exe1 ?<br><br>Thanks in advance.<br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="644090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> (1) Yes, you can call an exe from another exe.<br>You can't tell whether the exe has finished, unless you use a userlib to do this.<br><br>(2) See 2nd point above. <br><br></td></tr></table><br>
<a name="644092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a userlib to do it:<br><a href="http://www.blitzbasic.com/toolbox/toolbox.php?tool=151" target="_blank">http://www.blitzbasic.com/toolbox/toolbox.php?tool=151</a><br>Edit: Okay, it's updated.<br><br><br>You can use the Windows API to send WM_COPYDATA messages between your two programs. (Just send program 2 your window handle through the command line, and things should be sorted).<br><br>If you need help with that Windows API stuff, feel free to ask.<br>A search in these forums should reveal everything you need, though -- I know that there is at least one very big post about it. (By me). Then there's the person from whom I learned it, who is also on these very forums... <br><br></td></tr></table><br>
<a name="644096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could return results by simply writing a small data file, and then reading it in when the 1st .exe is run. <br><br></td></tr></table><br>
<a name="644157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a lot.<br>I will try it.<br><br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="644953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> there's a problem when exe 1 is running in fullscreen mode. Running exe 2 will minimize exe 1. While minimized the execution of exe 1 is paused. After terminating exe2 exe 1 will not be maximised automaticly, but the user needs to click it on the taskbar.<br><br>Exe 2 may re-maximize exe 1 before it ends using Api commands, but it still needs to give focus to exe 1, where the common api commands didn't seem to work, so I had to emulate a mouseclick - needless to say, a criminal dirty hack.<br><br>A better solution is welcome. <br><br></td></tr></table><br>
<a name="644992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is possible, using the source of the RunProgram DLL (the link that I posted above), to change the properties of an application's window before it is launched.<br>Note that sometimes this does not work with various attributes (for example, launching Notepad with an altered title doesn't work, because it changes back to the filename after the program boots). However, it is able to work in many other cases, such as with cmd.exe.<br>There is a pretty good chance, though, that a Blitz program would not work with this.<br>...Although you could possibly experiment with not calling the Graphics command, which may stop it from ever setting its own window properties. We'd probably have to ask Mark about that, though.<br><br>Thus, it could be possible to set a WS_MINIMIZED, or maybe WS_HIDDEN property (sorry if those are the wrong flags, I'm too lazy to look them up) to the newly created application to avoid it minimizing the other window. <br><br></td></tr></table><br>
<a name="644997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Mr. Picklesworth. So let's see if the Runprogramm dll can prevent the fullscreen app from freezing. There must be ways since some tasks are running in the background, like the firewall etc. <br><br></td></tr></table><br>
<a name="645007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it works, here's a bit of encouragement that will last forever:<br>Your app is now undeniably smarter than AVG Antivirus. <br><br></td></tr></table><br>
<a name="645066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a bit more info for those thinking of doing this... On my last gfx card causing a full-screen blitz exe to lose focus/minimize would cause the exe to mav - every time. But not my current card.<br>So please don't assume that coz you can do it then it's ok to do it. You might get some stern complaints from some users.<br>The only tidy way to do this is for exe 1 to be windowed in the first place. <br><br></td></tr></table><br>
<a name="645155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to start windowed, boot exe 2, then go to fullscreen? <br><br></td></tr></table><br>
<a name="645848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it MAVed in that case, your system probably wasn't 100% stabile. It's the first time I hear of this. Sounds more like a bug in the cards drivers to me.<br><br>Chanching from windowd to fullscreen or from fullscreen to windowed is no option IMHO, because it requires to reload all graphics. <br><br>For Apps that never use fullscreen this isn't an issue. <br><br></td></tr></table><br>
<a name="649851"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>I test with the following programs:<br><br>exe1.bb:<br><pre class=code>
Graphics3D 800,600
SetBuffer BackBuffer() 
camera=CreateCamera() 
light=CreateLight() 
RotateEntity light,90,0,0 

; Create red sphere 
sphere1=CreateSphere() 
PositionEntity sphere1,0,0,20 
EntityColor sphere1,255,0,0
While Not KeyDown( 1 ) 
	TurnEntity sphere1, 0,0.5,0.5
	RenderWorld 
	Flip 
Wend 

ExecFile("exe2.exe")

; Create green sphere 
sphere2=CreateSphere() 
PositionEntity sphere2,0,10,20
EntityColor sphere2,0,255,0
While Not KeyDown( 1 ) 
	TurnEntity sphere1, 0,0.5,0.5
	TurnEntity sphere2, 0,0.5,0.5
	RenderWorld 
	Flip 
Wend 
End 
</pre><br><br>exe2.bb:<br><pre class=code>
Graphics3D 800,600
SetBuffer BackBuffer() 
camera=CreateCamera() 
light=CreateLight() 
RotateEntity light,90,0,0 

; Create cube 
cube=CreateCube() 
PositionEntity cube,0,0,5 
While Not KeyDown( 1 ) 
	TurnEntity cube, 0,0.5,0.5
	RenderWorld 
	Flip 
Wend 
End  
</pre><br><br>Originally, I use api as mentioned and get MAV.<br>Now, I use execfile and MAV go away.<br>However, I encounter two problems:<br>1. After exe2 finish running, <br>   it goes back to exe1 but exe1 was MINIMIZED!<br>2. When exe1 switch to exe2 or exe2 back to exe1,<br>   the screen flash (because windows maximize and minimize)<br>   and this switching could be seen.<br><br>Could we prevent these two problems?<br><br>edit:<br>I have tried "Real Maximize of B3D Window by KuRiX" <br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1370" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1370</a><br>Adding the 4 statements after execfile("exe2.exe"), it<br>does not work.<br><br>Thanks in advance.<br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="649883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Could we prevent these two problems?"<br>- No, because this is how Windows handles full-screen programs. <br><br>And as I said earlier, you're lucky if that happens - my last graphics card used to just crash.<br><br>Basically, if you're going to need to call another exe you must do it from a windowed app. <br><br></td></tr></table><br>
<a name="649970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't be so pessimistic, John. Of course it's possible!<br>How do you think all those background processes work? Windows is too big for something simple like this to be impossible :)<br><br>Of course, such a thing may need to be written in a different language... but there could be a way.<br><br>Have you tried using a startup window cleanup utility to remove the little window that pops up when Blitz starts?<br>Since exe2 is running in the background, I can safely assume that you don't need to call any graphics commands, so Graphics does not need to be called. In that case, it will (hopefully) never create a window. I have succcessfully created an invisible app before with Blitz, but it's gone now (complete accident, actually) and I don't know how it treats fullscreen apps.<br><br><br><br>May I ask why you need two exes?<br>There is a chance that such a thing is unnecessary. Besides, with Blitz3d, if there is anything much going on in the other program they'll both run incredibly slowly since the language has a very system hogging nature. <br><br></td></tr></table><br>
<a name="650141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>I just want to protect the source codes of all exe.<br>eg. some exes are unchanged, some will be updated.<br>(Usually, in other language, main exe unchanged, <br>only dll will be updated, download time is lesser. <br>Not all users have broadband connection.<br>As Blitz3D could not build dll, so exe is used instead,<br>each exe have to use Blitz3D commands.)<br><br>(1) Any more ideas that could achieve the same purpose?<br>(may be better than exe1 call exe2) :)<br><br>(2) BTW, I once come across on internet, there exists<br>a Blitz3D wrapper (dll) that could be called by<br>C language. That author want to use the advantages <br>of Blitz3D and c language, instead of building the<br>engine from scratch. I lost that link. <br>Do you think this will help???<br><br>Thanks in advance<br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="650230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry Mr Pick - yes you're right. I didn't realise that he needed a background task.<br>As you say, if it's handled externally.... well, your the man for that. <br><br></td></tr></table><br>
<a name="650321"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> there was a small hack for the runtime.dll.<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=37093#407848" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=37093#407848</a><br><br>(bot builders source, about in the middle of the thread)<br>But be careful, save a copy of the original runtime.dll <br><br></td></tr></table><br>
<a name="650466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is an archive with a compiled version of BotBuilder's program... featuring a file dialogue :)<br><a href="http://crumbsoftware.f2o.org/files/StartWindowRemover.zip" target="_blank">http://crumbsoftware.f2o.org/files/StartWindowRemover.zip</a> <br><br></td></tr></table><br>
<a name="650469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> BTW: Is it still working with Blitz3D 1.96? Thought there where some changes in the linker. <br><br></td></tr></table><br>
<a name="650482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now that you mention it...<br>I just tested it... don't think it does :(<br><br>Oh well. It was fun while it lasted :P<br><br>Looks like we'll need to try something else unless you're okay with compiling using an older version of Blitz. <br><br></td></tr></table><br>
<a name="652050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Happy Sammy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>I found the link...<br><a href="http://www.ezblitz.com/sub_index.htm" target="_blank">http://www.ezblitz.com/sub_index.htm</a><br>It allows Blitz3d to be used in a C++ application.<br><br>Sammy<br>:) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
