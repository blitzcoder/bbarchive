<!DOCTYPE html><html lang="en" ><head ><title >Rotate Object Parallel to Underlying Surface?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Rotate Object Parallel to Underlying Surface?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Rotate Object Parallel to Underlying Surface?</a><br><br>
<a name="319503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The best example I can think of is aligning a car to a mesh. If the car doesn't rotate ( yaw ) then I could just retrieve the angles from the Atan of the normals ( at least I think I could ) but that won't work when you change the yaw of the car.<br><br>Note : I need to actually retrieve the angles, not just rotate the object ( I'm thinking AlignToVector could do that but I don't want to rotate the object. ) I just want to retrieve the pitch and roll that I *would* use if I was going to align the car to the mesh. <br><br></td></tr></table><br>
<a name="319510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> When you say 'surface', I assume you mean a triangle (since a surface can contain triangles pointing in all sorts of directions)...?<br><br>If so, this might help you on your way...<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=867" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=867</a><br><br>(Bear in mind you could just AlignToVector a pivot and use the results from that -- the speed hit will be trivial.) <br><br></td></tr></table><br>
<a name="319621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I've tried AlignToVector with a pivot. I think it's right except that it points the car parallel with the normal rather than parallel with the surface. I'm not sure how to get from one to the other ( considering the car can have any Yaw. )<br><br>I'm not very good at reading other people's code, and though Richard's code clearly does the job, I can't see how it works. I think the pivot would work if I could figure out the conversion from parallel with normal to parallel with triangle. <br><br></td></tr></table><br>
<a name="320673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I've got it started, but I can't get it finished right.<br><br>Here's the code so far.<br><br>; LINEPICK DOWNWARD<br>	<br>baseent=LinePick (EntityX#(Player\entityhandle,True),EntityY#(Player\entityhandle,True),EntityZ#(Player\entityhandle,True),0,-2,0)<br>	<br>nx#=PickedNX#()<br>ny#=PickedNY#()<br>nz#=PickedNZ#()<br>	<br>		<br>temppiv=CreatePivot()<br>AlignToVector temppiv,nx#,ny#,nz#,1<br>AlignToVector temppiv,nx#,ny#,nz#,3<br>TurnEntity temppiv,90,0,0<br>	<br>Player\TargetPitch#=EntityPitch#(temppiv)<br>FreeEntity temppiv<br><br><br>That works fine if the player yaw remains zero. But I need to be able to account for whatever the yaw can be because it could be anything.<br><br>I've uploaded a diagram to show what I mean.<br><br><img src="http://members.aol.com/sybixsus/normal.jpg"><br><br><br><br>The player is on a downward slope, the normal is the big arrow. If the yaw is zero ( we're looking side on ) then I need to rotate 90 degrees to get the right pitch. But if the yaw is 180 degrees ( pointing back up the slope ) then i need to rotate -90 degrees to get the right pitch. In both cases the roll will be zero, but if the yaw is 90 or 270 then the pitch will be zero and the roll will be 90 or -90 instead. And all the angles inbetween obviously.<br><br>What am I missing to make it work for all yaw values? <br><br></td></tr></table><br>
<a name="322384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for the broken link. For some reason the file just vanished from my webspace. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
