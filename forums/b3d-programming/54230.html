<!DOCTYPE html><html lang="en" ><head ><title >Collisions get sticky at certain angles.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Collisions get sticky at certain angles.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Collisions get sticky at certain angles.</a><br><br>
<a name="605251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >callahan614</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> //----- EDIT -----//<br>  I didn't allow the bounce to occur because the condition was 'if the dot product does not equal zero', which should have been 'if the dot product is greater than zero'. I still have an issue, though - using mouselook from a third person perspective to control the orientation of the character without the mere rotation setting off the bounce function. What would be the condition for that? CollisionNY? If so, what value? Thanks.<br>//--- END EDIT ----//<br><br><br>Hey all,<br>     I've been working on a prototype of a 3D platformer in which the only form of locomotion is a mouselook/click/drag/release combo. It's sort of a Crash Bandicoot/Spyro meets Pinball with Megaman abilities. In any case, the main character is a little blob who lives in a petri dish. The level design is incredibly organic. My level designer created single-sided walls, all normals face in as they should. One particular obstacle, though, causes my character to get stuck upon colliding with it. This may be due to over-zealous collision detection on my part. (Note: Blitz3D's sliding collisions are out, as the curves of the level cause infinite sliding) Why would this obstacle (a poly model that is part of the same mesh as the entire level) cause sticking? Here is the code for the bounce function:<br><br>;---------------------------------------------<br>Function SZ_bounce.VECTOR(player.VECTOR,Index)<br><br>	norm\Vx# = CollisionNX(player\root,Index)<br>	norm\Vy# = CollisionNY(player\root,Index)<br>	norm\Vz# = CollisionNZ(player\root,Index)<br>	<br>    norm = normalize(norm)<br>    player = normalize(player)<br>    two_ndoti = 2 * (norm\Vx# * player\Vx# + norm\Vy# * player\Vy# +norm\Vz# * player\Vz#)<br>    player\Vx# = two_ndoti * norm\Vx# - player\Vx#;<br>    player\Vy# = two_ndoti * norm\Vy# - player\Vy#;<br>    player\Vz# = two_ndoti * norm\Vz# - player\Vz#;<br>    player\Vx# = (player\Magnitude# - (player\Magnitude# * .1)) * (player\Vx#)<br>    player\Vy# = (player\Magnitude# - (player\Magnitude# * .1)) * (player\Vy#)<br>    player\Vz# = (player\Magnitude# - (player\Magnitude# * .1)) * (player\Vz#)<br>    	<br>    Return player.VECTOR<br><br>End Function<br>;---------------------------------------------<br><br>This is used within a For...Next based on the value of CountCollisions for that frame. Let me know what code would be most helpful in figuring this out. It really ties into a larger issue: diminishing secondary bounces without causing an NaN, giving a realistic effect of landing. I can also make an executable available if you want to get a feel for the mechanics. Thanks in advance, guys.<br><br>P.S. - I'd be really honored if sswift made an appearance. <br><br></td></tr></table><br>
<a name="605428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Assume your using stop collisions?  To avoid sticking you need to slightly offset the collided entity by the collision normals within our bounce routine ...<br><br>e.g.  Translateentity Entity , .01 * norm\vx , .01*norm\vy, .01*norm\vz<br><br>Also, to determine whether the object has hit the ground rather than a wall then you should set a flag if norm\vy &gt; 0.<br><br>I'm not entirely sure whether your reflection code is implemented correctly so I think more code would help.<br><br>Stevie <br><br>I use this ... where Vx, Vy etc.. are the velocities.<br><br><pre class=code>
For i = 1 To CountCollisions( p\Pivot )
	Nx# = CollisionNX( p\Pivot , i )
	Ny# = CollisionNY( p\Pivot , i )
	Nz# = CollisionNZ( p\Pivot , i )
	TranslateEntity p\Pivot , Nx*.01, Ny*.01 , Nz*.01
	VdotN# = Vx * Nx + Vy * Ny + Vz * Nz
	NFx# = -2.0 * Nx * VdotN
	NFy# = -2.0 * Ny * VdotN
	NFz# = -2.0 * Nz * VdotN
	Vx = Vx + Nfx
	Vy = Vy + Nfy
                Vz = Vz + Nfz
	If Ny &gt; 0 p\OnGround = 1
Next
TranslateEntity p\Pivot , Vx , Vy , Vz
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
