<!DOCTYPE html><html lang="en" ><head ><title >Blitz Framerate issue - Quads/Models/Number of Entities</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Blitz Framerate issue - Quads/Models/Number of Entities</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Blitz Framerate issue - Quads/Models/Number of Entities</a><br><br>
<a name="319292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I am having a bit of trouble with Blitz's framerate and was hoping to get some opinions as <br>to why this could/should be so.<br><br>Tell me if this logic is incorrect:<br><br>I have a model with 60 triangles and 1 surface.  On my PC (500 Mhz, GeForce 2MX)<br>using Blitz I can easily have about 100 of them in the viewport at one time, usually<br>on a terrain( with LOD of 500).  I noticed when fiddling around with the mesh earlier that if I had 2 <br>surfaces I could only have about 40-50 of them in the viewport easily and only about <br>20 of them if I had 4 surfaces.  <br><br>So I concluded that my system should be able to handle 6000 polygons easily on the screen<br>at any one time (60 triangles multiplied by the 100 models).  Therefore, if I used quads,<br>a polygon with just 2 triangles I should be able to have at least a thousand of them on<br>screen at one time.  <br><br>This is the problem though:<br>I can still only have about 100-150 of these quads on the screen at once without incurring<br>massive slowdown.  Yet that is only 2-300 polygons as compared to the 6000 or so that were<br>rendered when I used the mesh with 60 polygons.  This is the case regardless of whether I <br>am updating the models position every frame or simply leaving them in place and moving the <br>camera around.  <br><br>It seems that when I have more than about 200 entities in total in the 3d world I get real<br>slowdown.  But - when I run some of the samples, like the Firepaint3d sample which has about<br>3-400 entities at any one time on my PC they run fine.<br><br>Is there something I might be doing wrong or have missed out on?<br>I am using the latest version of Blitz3d on a Windows 98 500Mhz PC with a Geforce 2 MX 32 Mb RAM<br>with 256Mb system RAM.<br><br><br>Updated message:<br>I began playing around with the Tween parameter and that seems to have fixed the problem to an extent.  I can now have a larger number of entities on the screen at once, although I am unsure of how to best use it. <br><br></td></tr></table><br>
<a name="319313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem is the number of surfaces NOT the number of polygons.<br><br>If you use quads a lot then try writing a single surface system, since they are relatively simple to set up and enable large amounts of quads at much higher speeds. <br><br></td></tr></table><br>
<a name="319316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought my quads only had a single surface or do you mean that it is possible to have a single surface for all my quads? <br><br></td></tr></table><br>
<a name="319324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You want a single surface for all your quads combined.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=437" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=437</a> <br><br></td></tr></table><br>
<a name="319328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You'll be so happy you did. That Geforce 2 MX is easily capable of rendering 30,000 polygons at 80+ fps if your surface count is low. <br><br></td></tr></table><br>
<a name="319330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Single surface for all of your quads. Everytime to want a new quad, you simply add 4 vertexs and 2 tris to the mesh. You use ONE texture. So all the quads use the same texture. Now, if you want different texture on each quad, you simply use a texture that has all the textures you need, then adjust the quads UV-co-ords to show the correct part of the texture.<br><br>Alot of surfaces kill blitz :)<br><br>Id imagine your Quads's are entities?<br><br><pre class=code>
quad=loadmesh("quad.b3d")
</pre><br>or<br><pre class=code>
quad=loadsprite("quad.bmp")
</pre><br><br>then you are copying that? That will result in lots of surfaces i'm sure :) <br><br></td></tr></table><br>
<a name="319341"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I have done is create a mesh, create a surface, create the 4 vertices then join them with addtriangles.  I then used the Entitytexture command to texture them with the one texture I have loaded into memory.  <br><br>Is this what you mean? <br><br></td></tr></table><br>
<a name="319342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> how are you creating new quads? <br><br></td></tr></table><br>
<a name="319343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is how I am creating new quads:<br><br>MyMesh\meshid=CreateMesh ()<br>mymesh\idnum=i<br>surf=CreateSurface(MyMesh\meshid)<br>Vertex(1)=AddVertex(surf,0,0,0,0,1)<br>Vertex(2)=AddVertex(surf,0,4,0,0,0)<br>Vertex(3)=AddVertex(surf,3,4,0,1,0)<br>Vertex(4)=AddVertex(surf,3,0,0,1,1)<br>Tri=AddTriangle(surf,Vertex(1),Vertex(2),Vertex(3))<br>Tri2=AddTriangle(surf,Vertex(1),Vertex(3),Vertex(4))<br>PaintMesh MyMesh\meshid,MyBrush <br><br></td></tr></table><br>
<a name="319345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, well see once you've set up your mesh. Just add 4 more vertexs to the surface, everytime you want a new quad like so.<br><br>Set up your mesh and add a quad:<br><br><pre class=code>
MyMesh\meshid=CreateMesh () 
mymesh\idnum=i 
surf=CreateSurface(MyMesh\meshid) 
Vertex(1)=AddVertex(surf,0,0,0,0,1) 
Vertex(2)=AddVertex(surf,0,4,0,0,0) 
Vertex(3)=AddVertex(surf,3,4,0,1,0) 
Vertex(4)=AddVertex(surf,3,0,0,1,1) 
Tri=AddTriangle(surf,Vertex(1),Vertex(2),Vertex(3)) 
Tri2=AddTriangle(surf,Vertex(1),Vertex(3),Vertex(4)) 
PaintMesh MyMesh\meshid,MyBrush
</pre><br><br>then add some new quads:<br><br><pre class=code>
for loop=1 to 5
   Vertex(1)=AddVertex(surf,0,0,0,0,1) 
   Vertex(2)=AddVertex(surf,0,4,0,0,0) 
   Vertex(3)=AddVertex(surf,3,4,0,1,0) 
   Vertex(4)=AddVertex(surf,3,0,0,1,1) 
   Tri=AddTriangle(surf,Vertex(1),Vertex(2),Vertex(3)) 
   Tri2=AddTriangle(surf,Vertex(1),Vertex(3),Vertex(4))
next
</pre><br><br>to access each quad, just adjust it's position, using vertexcoords(), and input the correct index for each vertex. The way i did it, was to create a type object for each quad. I'd store the index for the first vertex of the quad. <br><br></td></tr></table><br>
<a name="319346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's been said two or three times already, but ONE surface for ALL quads ( that have the same texture. ) NOT one surface for EACH quad.<br><br>The link Binary Moon gave you shows you how. There's another version by Elias T as well. <br><br></td></tr></table><br>
<a name="319373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or you can look in my sig.... although it's not very well commented code :) but it's as fast as it gets. <br><br></td></tr></table><br>
<a name="319454"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, that helps a lot.  Another question though - could this procedure be used for more complicated meshes than quads. <br><br></td></tr></table><br>
<a name="319487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes. You just have to make your own rotating and positioning functions for vertex groups. But I think moving objects with hundreds of vertices might be slower than blitz entities. <br><br></td></tr></table><br>
<a name="319513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Michael Reitzenstein</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But I think moving objects with hundreds of vertices might be slower than blitz entities. <br></div><br>On a hardware TnL card, this is almost certainly the case. But then, they are fast enough anyway... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
