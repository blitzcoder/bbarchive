<!DOCTYPE html><html lang="en" ><head ><title >Climbing System for 3rd Person Games</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Climbing System for 3rd Person Games</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Climbing System for 3rd Person Games</a><br><br>
<a name="1090953"></a>

<a name="1090954"></a>

<a name="1090956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I'm trying to figure out how to create some kind of climbing system for a 3rd person game. I just want to have the character be able to jump up and grab SOME (not all) ledges. So the beginning is obvious. Make a list of climbable edges (as a list of vertex pairs). Now, the problem is how to calculate whether the player is close enough to the edge to auto-grab it. So, simplified down to the bare minimum, I need to find the distance between a point and a line, but I don't have any code.<br><br>Does anyone know how to do this?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I googled it and found 66 million results, so that should get you started. ;-)<br><br>http://www.google.com/search?client=opera&amp;rls=en&amp;q=find+the+nearest+distance+between+a+point+and+a+line&amp;sourceid=opera&amp;ie=utf-8&amp;oe=utf-8&amp;channel=suggest <br><br></td></tr></table><br>
<a name="1090960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is one in the code archive as well, under the 3D Graphics - Math section. <br><br></td></tr></table><br>
<a name="1090962"></a>

<a name="1090964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, Warner. I found it:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2156" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2156</a><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, but that one is written in BlitzMax. Would need porting then.<br>There is another one, for Blitz3D, by Danny. :) <br><br></td></tr></table><br>
<a name="1090973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd highly reccomend using a ghost 6 sided box entity for marking ledges, etc. that the player can grab onto - this is what most commercial games use to. <br><br></td></tr></table><br>
<a name="1090974"></a>

<a name="1090976"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Converted to B3D, condensed, and added endpoint support:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function Magnitude#(px#,py#,pz#,dx#,dy#,dz#)
	Return Float(Sqr((dx-px)*(dx-px)+(dy-py)*(dy-py)+(dz-pz)*(dz-pz)))
End Function

Function DistancePointLine#(ax#,ay#,az#,bx#,by#,bz#,px#,py#,pz#)
	Local LineMag#,U#
	Local ix# = bx - ax
	Local iy# = by - ay
	Local iz# = bz - az
	
	LineMag = Magnitude(bx,by,bz,ax,ay,az)
	U = (((px-ax)*ix)+((py-ay)*iy)+((pz-az)*iz))/(LineMag*LineMag)
	If U &lt; 0.0
		Return Magnitude(px,py,pz,ax,ay,az)
	EndIf
	If U &gt; 1.0
		Return Magnitude(px,py,pz,bx,by,bz)
	EndIf
	ix = ax+U*ix
	iy = ay+U*iy
	iz = az+U*iz
	Return Magnitude(px#,py,pz,ix,iy,iz)
End Function</textarea><br><br><b>@Warner:</b> Sorry, did this before I read your post. Oh, well.<br><b>@Rroff:</b> Could you elaborate on that?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hopefully this will show what I mean:<br><br><img src="http://aten-hosted.com/images/ledge1.jpg"><br><br>The pink colored brush wouldn't be drawn visibly in the game, but is used to mark the edge and the extent of left to right movement and is what is checked against for places where the character can grab onto or perform other moves. <br><br></td></tr></table><br>
<a name="1091003"></a>

<a name="1091012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you had searched the blitz forums for related terms you'd have reached this thread where we previously discussed this subject:<br><a href="http://blitzbasic.com/Community/posts.php?topic=82689" target="_blank">http://blitzbasic.com/Community/posts.php?topic=82689</a><br><br>EDIT: Sounded a bit more direct than I wanted to. Mah mustake!<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah I remember reading that thread heh, naughty alien suggested the box trigger method there too. <br><br></td></tr></table><br>
<a name="1091013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't mean to cause anyone any trouble. Honestly, I didn't know what to search for - it's a very vague concept (actually a very specific concept). So I think I understand the box trigger method, but I think it might end up being a little inaccurate. Just to be sure, is there a way to adjust the player when a collision is detected so that they are "hang-aligned" to the ledge instead of wherever they were when the collision occured? <br><br></td></tr></table><br>
<a name="1091030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> With these systems its better to be a little inaccurate than too accurate as otherwise it can be fiddly and frustrating for the player to use - you might pull it off every time in testing because you implemented it and know how it works, a random player might not.<br><br>The middle of the box coincides with the edge of the ledge so you can work out the positioning from that. <br><br></td></tr></table><br>
<a name="1091037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ClayPigeon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, thank you for your help! Case closed! <br><br></td></tr></table><br>
<a name="1091127"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have coded a parkour demo and the character was able to jump and grab ledges.<br><br>What i have done is i have defined 4 trigger areas depending on where the hands might be when the player is near the ledge.<br><br>The player has a collider sphere on him, and each frame the program used linepick ahead of the player. If the normal picked was in the range of the areas where player can grab, and the normal was in the range of what ledge can be grabed or not (for example NY# = +1.0), then the character was oriented, positionned, animated on this ledge depending on the area that was triggered.<br><br>Watch this old demo :<br><a href="http://www.youtube.com/watch?v=_dk0hrtgquo" target="_blank">http://www.youtube.com/watch?v=_dk0hrtgquo</a><br><br>One bug that you can see on this demo, is that the character sometimes go through the ledges. This is because you have to calibrate the lenght of the linepick depending on the velocity of the character, else the linepick is not able to detect the ledge before the player go through it... <br><br></td></tr></table><br>
<a name="1091920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Rroff, can you please show us a working example of an object grabbing onto a ledge, shimmying across the ledge, and slowly using both arms, crossing the ledge while it is grabbed?<br><br>I'm sure everyone will appreciate it! :)<br><br>Thanks! :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
