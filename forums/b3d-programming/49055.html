<!DOCTYPE html><html lang="en" ><head ><title >Alt + Tab / Windows Key</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Alt + Tab / Windows Key</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Alt + Tab / Windows Key</a><br><br>
<a name="545690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I'm wondering how people have overcome the problems from Alt+Tab and the windows key when in a fullscreen blitz3d app.<br><br>I am having a few complaints from people playing my latest game because of these keys.<br><br>The windows key seems to cause random results, on my computer it just caused a froze the system for 30 seconds then reported a device driver failure (the graphics card driver) putting me in a 640x480x16 safe mode until I reboot.<br><br>Alt+tab usually does nothing more than pause the code for me, however for other people it can MAV the game or cause more sever errors such as a blue screen for people on windows 98 or a complete system lock up... this seems to vary from PC to PC though and may not occur everytime.<br><br><br>Is there a way of disabling these keys? (I'd love to see an example if someone has one) <br><br></td></tr></table><br>
<a name="545747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was answering a question about my 'Disable Sticky Keys' dll, so i thought I would check this out on the MS website. Here is a relevant article...<br><br><a href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/" target="_blank">Disable Task Switching</a><br><br>If no-one comes up with an easy way to handle this I may add this functionality {read: re-write from scratch to use a keyboard hook ;-) } to my dll, as disbling the Win key and ALT+TAB would fit with that. <br><br></td></tr></table><br>
<a name="545891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that Ctrl+Alt+Del should be left in place, but it would be really useful to disable Alt+Tab and the Windows key - these ALWAYS mav on my machine, and a few others I've tried it on.<br><br>Yes please, BlackJumper, go for it. We'd be very grateful. <br><br></td></tr></table><br>
<a name="545900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I'd be very greatful too.<br><br>However as John said I think Ctrl+Alt+Del should not be disabled... not that it helps me out much on Windows XP anyway :) <br><br></td></tr></table><br>
<a name="546993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlackJumper, are you planning to add this functionality?<br><br>Unless anyone can think of an easy way to fix it of course. <br><br></td></tr></table><br>
<a name="547028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am in the middle of a house move atm and may take a wee while to get my coding environment sorted out, so I doubt I will get this sorted within the next couple of weeks.<br><br>But, yeah - I will have a go at re-writing my dll to handle these annoying keyboard intrusions.<br><br>I would appreciate if in the meantime people could also post here any additional 'keyboard annoyances' that they think would fit in with the dll. I can't promise to include your suggestions, but I might as well try to tackle the whole shooting match rather than coming back for a re-write every few months when a new problem pops up.<br><br>Disable StickyKeys dll - features so far:<br>=========================================<br>1. Toggle (StickyKeys + FilterKeys + ToggleKeys) on and off... affects all of these simultaneously<br>2. Toggle ToggleKeys on and off (since you might want to re-enable this after switching off all of the above)<br>(3) restore all user settings back to original values when you exit the program... even if the program crashed last time before it managed to put things back properly.  :-)<br><br>Planned Features:<br>=================<br>4. Trap the Windows key presses<br>5. Trap ALT + TAB key presses<br><br>Requests:<br>==========<br>????? <br><br></td></tr></table><br>
<a name="547035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good to hear! :) <br><br></td></tr></table><br>
<a name="547202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's bad to disable these features as they are there for a reason and your program might not properly restore them.<br><br>They tried to do it in Quake also, but most people agreed that it was broken to try to do it to begin with.<br><br>As for MAV it could be bad drivers not restoring the vertex buffers and other DX stuff properly. <br><br></td></tr></table><br>
<a name="547216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well the start key is the only one I really want to disable because it can accidently be pressed during game play (Ctrl &amp; Alt are both used so if they miss that may hit the windows key).<br><br>As for Alt + Tab, i intend to give the user the option to block this, but not force it on them (on by default, warn them that it may completly crash their PC if they try to use it)<br><br><br>If Alt+Tab worked without crashing or only resulted in a MAV then I'd leave it. But as it can crash the graphics driver, cause a complete lockup or cause a blue screen on older windows I feel that I need to at least warn users before it happens. <br><br></td></tr></table><br>
<a name="547308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one. Go for it King Dave.<br><br>I'm looking forward to being able to make your dll a standard part of my development suite, as much as blitzsys.dll.<br><br>And of course credit you! <br><br></td></tr></table><br>
<a name="547400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not me making it :P Give BlackJumper the credit :) <br><br></td></tr></table><br>
<a name="547901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whoops, sorry BlackJumper.<br>Err... go for it.<br><br>@ozak: "they are there for a reason"<br>Yeah, so's the blue screen of death. And I still get that. <br><br></td></tr></table><br>
<a name="548328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK... I'm on this as soon as I get my Annual Report off to Companies House. {Or I may end up writing it from prison :-) } <br><br></td></tr></table><br>
<a name="548672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really need this as well for my game!!! It would be incredibly useful!!! Go for it!! <br><br></td></tr></table><br>
<a name="549179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm kinda surprised this hasn't been brought up before... or maybe I've just not looked in the right places <br><br></td></tr></table><br>
<a name="549418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nicstt</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeh could use this:)<br><br>hmmm, blue screen... been a while since I've seen that. Something must be broke:p <br><br></td></tr></table><br>
<a name="549659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Nicoust - I think you missed my point.<br><br>How about this (one of my catch-phrases after working with PCs for 25 years): "Windows, yeah, the only operating system that can't even shut _itself_ down!" <br><br></td></tr></table><br>
<a name="550423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >agent4125</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlackJumper, I would love to use this to disable the Windows Key, since I'm making a game for small children. <br><br></td></tr></table><br>
<a name="551561"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Version 2 of StickKeys_dll is available in the Code Arcs.<br><a href="/codearcs.php?code=1334" target="_blank">Check it out</a><br>I have added a Low Level Keyboardhook to trap the task switching keys. <br><br>The sample code has to be the most boring ever made... Someone please post an asteroids example that uses RightSHIFT for thrust, LeftSHIFT to fire, WIN key for shields and ALT+TAB to hyperspace. Please... ;-)<br><br>It was an 'interesting' project... I now know more about windows hooks than I ever wanted to. What I still don't really know is how to get Borland C++ Builder (V5) to share dll data segments properly... I eventually resorted to 'black magic' coding as their simply isn't any proper documentation out there. At one point I managed to inject the Key filter into all running apps then fail to unhook it... Try fixing your system when you can't actually type anything. :-(<br>This persisted after cold re-boot... very worrying (and a warning to make sure you close this down properly - details in the examples.) Finally had to use a Restore Point to get normal keyboard operation back.<br><br>Having said that... please test this and post any problems you have. I am especially interested to know if there are issues based on the User Level of the current user... do Restricted Users have problems with this ? {I'd love to answer for you, but I have spent two days on this and its now 6 a.m. - so I'm going to bed now.} <br><br></td></tr></table><br>
<a name="551628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Partial blame goes to King Dave (original request for blocking task switching)" haha :)<br><br>Nice work!<br><br>I tried simulating a crash to see if the system keys would still be locked out in other programs, glad to say that they wern't :)<br><br>Hmm, sadly you can't detect system key combos being pressed (only one is detected).<br><br>I'm glad the Ctrl+Alt+Del combo still works, the user needs some emergancey way to get out. <br><br></td></tr></table><br>
<a name="551638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlackJumper you have officially become one of my heros.<br><br>A superb piece of work!<br><br>I'll probably even write a little app for myself that just disables that bloody Windows Key! <br><br></td></tr></table><br>
<a name="552272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeeeees!! That's GREAT, and working perfectly!!! Be 100% sure that I will use your dll in my game!! Thank you very much for that! <br>Ex-cel-lent! <br><br></td></tr></table><br>
<a name="552319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm glad the Ctrl+Alt+Del combo still works, the user needs some emergancey way to get out. <br></div><br>I don't think it's actually possible to turn that one off - it's like hard coded deep in the bowels of Windows... <br><br></td></tr></table><br>
<a name="552566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad to finally make a positive contribution to the community. :-)<br><br>Thanks to King Dave for taking the brave step and simulating the in-game crash to see what happens... and thankfully it seems to be good news.<br><br><div class="quote"> Hmm, sadly you can't detect system key combos being pressed (only one is detected). <br></div><br><br><div class="quote"> I'll probably even write a little app for myself that just disables that bloody Windows Key! <br></div><br><br>Now that Version2 is 'out there' I will give a little while for any unforseen problems to manifest (and hopefully get de-bugged) before I move on to write version 2.1 - this will allow individual tweaking of which SysKey combinations are enabled/disabled and may also have some sort of return value so that you know what got blocked. To do this I will need to be fairly confident about what is going on with the 'shared dll memory' tricks. But I think it should be do-able.<br><br><div class="quote"> <i>I'm glad the Ctrl+Alt+Del combo still works, the user needs some emergancey way to get out...</i><br><br>I don't think it's actually possible to turn that one off - it's like hard coded deep in the bowels of Windows...  <br></div><br><br>Not quite true, but more trouble than its worth to try dealing with. A keyboard hook won't trap it, but you can replace the explorer shell; the security logon routine (GINA); etc. - often with simple registry hacks. <br>These would still popup dialogs however, disrupting game-flow, so they are not 'solutions' to the problem of intrusive keys. <br><br></td></tr></table><br>
<a name="552621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, this whole issue is a strange one - all these keys behave as expected on my machine. The Windows keys get completely ignored when in fullscreen mode and Alt+Tab lets me switch in and out of my app with no apparent problem.<br><br>I wonder if the whole problem is related to s specific version of Windows, or even a specific version of Blitz3D?<br><br>I have: Win98SE, Blitz3D v1.88 <br><br></td></tr></table><br>
<a name="552623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> @big10p:<br>========<br>Thanks for catching that big10p... I think that Low Level hooks may only work on NT versions of windows...{The DOS-based ones may use a higher level hook that only examines the message queue on a per application basis.} I will check up on that and may try to build in an O/S detection routine that figures out whether it can work or not. <br><br>There are (I thought superceded!) ways of tackling task-switching in W98 and WinME that I didn't bother to include in this dll. It may be that I will have to include them for completeness.<br><br>Can you tell me whether the accessibility functions work for you (first check they are enabled in your Control Panel, then try lots of LeftShift or holding down RightShift.) It would be good to know how W98 deals with this... <br><br></td></tr></table><br>
<a name="552631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to be clear, BlackJumper: I haven't tried your DLL because, as I said, none of these keys cause a problem on my system. I wasn't sure if you thought I made my post above having tried your DLL.<br><br>Anyway, I turned on StickyKeys and stabbed the shift keys a load of times while running my Blitz app. Again, it seems to handle things fine - no crash or other misbehaviour.<br><br>Like I say, this is all a bit strange. Why do I have no problems on my PC but others get MAVs, crashes etc.?<br><br>Maybe it's a bug in the latest version of Blitz3D? Have you tried downgrading to v1.88 to see if you still have problems? <br><br></td></tr></table><br>
<a name="552889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Anyway, I turned on StickyKeys and stabbed the shift keys a load of times while running my Blitz app. Again, it seems to handle things fine - no crash or other misbehaviour. <br></div><br><br>Firstly, it's not StickyKeys being on that is the real problem... it is the shortcut key to enable/disable StickyKeys that is the issue.<br><br>[img http:\\www.blackjumper.com\selling\AccessControlPanel.gif]<br><br>Also, it depends what you term 'misbehaviour'. It's not really ideal in a shoot-em-up that uses the Shift key if you can only fire off 4 rapid-fire bullets before a windows dialog interrupts to ask if you want to turn on StickyKeys. And if that dialog gets 'flipped' from the front buffer before you get a chance to do anything with it, then your user might not even know why the modal dialog is waiting for an answer and your game is refusing to run (a possibility in full-screen mode I believe.) <br><br></td></tr></table><br>
<a name="552906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> You will need those alternative methods for Windows 9x. There's some good stuff here on this subject:<br><a href="http://www.codeproject.com/win32/AntonioWinLock.asp" target="_blank">http://www.codeproject.com/win32/AntonioWinLock.asp</a> <br><br></td></tr></table><br>
<a name="552932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can I just point out that neither Win95 nor WinME (not sure about 98) are supported by MS.<br>Many companies are now echoing that in their product blurb (including mine).<br>With all due respect to big10p, should you really be worrying about those? - MS obviously aren't. <br><br></td></tr></table><br>
<a name="552938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep you should worry about WinME and 98, but not 95. There's quite a few 98's out there if you are aiming low spec.<br><br>Win98 basically is WinME <br><br></td></tr></table><br>
<a name="552940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I'm saying is that it would be very nice of you to allow for Win98/ME if you feel it's a good move - but Microsoft don't. <br><br></td></tr></table><br>
<a name="552942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, the additional code for W98/ME looks fairly straightforward... as long as I can get a bulletproof way to identify the underlying OS {I seem to remember that there was some weirdness around W98 and W98SE in the way they identified themselves...} there will be no problem in adding this to the next version. <br><br></td></tr></table><br>
<a name="552948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> You stilla star and we love you.<br><br>How long have we been asking for this! <br><br></td></tr></table><br>
<a name="553075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlackJumper: There is a bug in your nice lib!!! I put it in my game and everything looked fine at first: it was not possible to alt+tab, etc, as expected. BUT I am not able to catch the Esc key!! I have to press the Esc key a million of time before being able to quit the game... Disabling your lib, and it works again...<br><br>Do you have an idea why?? I use Blitz3D 1.90 and Windows XP Pro...<br>Thanks!! <br><br></td></tr></table><br>
<a name="553136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RepeatUntil:<br><br>Is it possible that you had a 'sticky' Ctrl key or Alt key* that is being registered ? The dll catches ALT+ESC and CTRL+ESC. I seem to have no problems in ESCaping in either windowed or fullscreen modes.<br> <br><div class="quote"> {* StickyKeys allows you to press CTRL+A by pressing CTRL followed by the A key. It 'latches' the Sys keys until the next key is pressed. If CTRL then ESC was being ignored, it might remain in a latched state ?!?} <br></div><br><br>Were you using KeyboardGameLock() {should have disabled StickyKeys} or individual components when this happened ?<br>Could you try again RepeatUntil (or check your Accessibility Control Panel - see image above) and see whether this explains it ?<br><br>Can anyone else confirm this unruly behaviour ? <br><br></td></tr></table><br>
<a name="553148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very strange! I did some additional test, and the results are strange!<br>But first let's answer to your questions:<br>First, the stickyKey option is not checked on my computer.<br>Second, I used KeyboardGameLock() , but separate options produced the same results.<br><br>Now for the strange results:<br>With this simple program, it works perfectly and I am able to press Esc:<br><pre class=code>
KeyboardGameLock(True) 
While KeyHit(1) = False
Wend
KeyboardGameLock(False)
</pre><br><br>But still, in my game, this does not work. In my game, I used KeyHit(1). I tried to replace by KeyDown(1) and your lib is now working as expected, and I am able to quit the game with Esc.<br>This effect is only seen with Esc, not with other keys.<br>Would it be possible that your lib interfere with the way Blitz try to catch the Esc key? (which will be seen only for in a long loop, like a game loop)<br>As I said, strange...<br>I will try to investigate more on my side... <br><br></td></tr></table><br>
<a name="553167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Keyhit<br>======<br>This command returns the number of times a specified key has been hit since the last time you called the KeyHit() command.<br><br>Keydown<br>=======<br>This command (similar to its counterparts MouseDown and JoyDown) is used to detect if a key is being held down. This command returns a 0 if the key is not held down, a 1 if the key is held down. <br></div><br><br>... but While...Wend should work for any non-zero value returned by KeyHit. Strange !!!! <br><br></td></tr></table><br>
<a name="553435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I tried to investigate more for this Esc problem.<br>What is sure is that I can Esc with KeyHit(1) without your lib, and I can not with you lib active (with no additional difference in the code). So your lib seems to have a side effect...<br><br>I did the test with KeyHit(1) located at some other place in my code, and depending where it is located, sometimes it works as expected. Strange!<br><br>Anyway, I use now KeyDown(1) and your lib, and it's working perfectly. I will stick with this solution. Thanks!<br><br>Just curious: nobody got this problem? <br><br></td></tr></table><br>
<a name="553513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers RepeatUntil, I will do a bit of digging into this when I get around to producing version 2.1<br><br>What keyboard setup do you have... I guess you might be using a French keyboard layout. Is there anything else unusual about your setup... Multimedia keyboard, etc. ?<br>{Not that any of that should make a difference, as the O/S should be fielding any interaction... but you never know !} <br><br></td></tr></table><br>
<a name="553622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey BlackJumper.<br><br>You're really gonna hate me for coming up with more and more requests!<br><br>How difficult would it be to disable the Insert key?<br><br>I muts have hit that swine 5 times in the last hour, subsequently (in insert mode) accidently wiping out text then having to retype it. Incredibly frustrating.<br><br>It's happened again while I've been typing this. <br><br></td></tr></table><br>
<a name="553688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Insert key added to TODO list - I imagine that to be fairly simple to add... the problem will be how to create a simple function interface to the dll to allow sets of keys to be enabled/disabled easily.<br><br>I am thinking that a system similar to Blitz's texture flags would be best.<br><br>DisableKeys(options)<br><br>where options are SYSALTTAB=1, SYSCTRLESC=2, SYSWIN=4, etc. and SYSALL = 1+2+4+8...+128 = 255<br><br>Can a .decls contain constant definitions ? These might have to be defined in an 'include' file.<br><br>Any comments on this approach ? Would people prefer a load of dedicated functions to toggle each state ? <br><br></td></tr></table><br>
<a name="553806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one, BJ.<br><br>For me, it doesn't matter how you handle the flags - do it to suit yourself.<br><br>As you say, very often it (frustratingly) takes longer to create the user interface part of a prog than the function it drives. <br><br></td></tr></table><br>
<a name="553857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlackJumper: my keyboard is an us keyboard, with the option English (United States) in Windows, with no strange option at all for this keyboard (it's a laptop without multimedia key).<br>What could be interesting is to test on another computer if I observe the same "feature". I will do that next week when I will have another computer available... <br><br></td></tr></table><br>
<a name="554130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlackJumper: I have a small request. There is a file that is created by your lib (stickyKeys.txt). Would it be possible to erase it at the end of the program (ie when we call KeyboardGameLock(False)). It would be nicer for the player of the game...<br><br>Thanks! <br><br></td></tr></table><br>
<a name="554159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >agent4125</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome job, BlackJumper.  It works perfectly for me.  Thanks!  =) <br><br></td></tr></table><br>
<a name="554943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> BlackJumper: I have a small request. There is a file that is created by your lib (stickyKeys.txt). Would it be possible to erase it at the end of the program (ie when we call KeyboardGameLock(False)). It would be nicer for the player of the game... <br></div><br><br>At the moment the system works on the basis that a <b>visible</b> file means that either (a) The function has laready been called to disable StickyKeys {so there is no need to disable them again}, or (b) the program crashed before they were restored to their original state ... in which case the 'visible' file is used as the state to restore to.<br><br>If the system shuts down correctly (e.g. using KeyboardGameLock(false) or SetStickyKeysState(false) ) then this file is <b>hidden</b> rather than deleted. I guess it would be possible to remove it completely, but I thought it would be safer to have a 'hidden' file with the old states in them as inexperienced users would be less likely to simply delete this if there was a problem.<br><br>Here is a snippet of the C++ code:<br><pre class=code>    if (mode == true)
        {  // Restore back when going to windowed or shutting down
           AllowAccessibilityShortcutKeys( true );
           set_file_attrib(filename, FA_HIDDEN);    // and hide file to show proper closedown
        }</pre><br><br>I'm open to suggestions on this one. How much of an issue is this for other potential users ? <br><br></td></tr></table><br>
<a name="554985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since you ask what other potential users think...<br><br>I'd like to be a potential user.<br>But I tried it, and do not use it, because what it does is too unexpected and complicated in my view and I don't want to spoil other users computers which use my programs.<br><br>I am a simple man and I like to keep things as uncomplicated as possible.<br>While I tried your samples I didn't find a way to disable the 8 seconds right shift key thing or the 5 times shift key pressing. Maybe I overread it... Maybe its not possible... Maybe I only didn't understand the instructions... Anyway - I didn't like that window popping up at all.<br>And I don't want to explain a user what do when this window pops up on his computer either.<br><br>What me simple user needs is blocking several key combinations - that's all. And not on my Computer but on the program users computer and only while he's using my program.<br><br>That means:<br>Everything that can cause troubles - by chance or wrong usage or for whatever reason should be avoided.<br>Start it with KeyboardGameLock(True) - okay.<br>Add the Kombinations with a Command like KeyboardCombiAdd("Alt+Tab") inside the program.<br>Kill it with KeyboardCombiKill("Alt+Tab") inside the program (no popup windows).<br>And kill the complete thing with KeyboardGameLock(False)<br>That's all.<br>And the best would be, since its quite a tricky Program let it check by itself, if the calling Program is still a running task... if not, exit Keyboardlock immediate - so that the computer has no funny things (like not being able to use the start button with the mouse as happended here after a managed program crash) left...<br><br>That's my view.<br><br>I know what effort you put into it - since I fiddled around with KeyboardHook and TaskManager too long and had to postpone it since I had no error free result at all.<br>Actually I had in mind to block disturbing Popup Windows as well - for instance: I don't mind to get a little message if friends enter MSN Messenger or when I get a notice that the AntiVirusProgram made an Update or that the Network is trying to restablished the connection with the internet.<br>But that should not disturb fullscreen window games.<br>Not by going back to Windows or not with endless flickering windows inside the fullscreen window. <br>There are programs on the market that can block these things and the Key cominations and there are others that can't - but that shows it is possible.<br>Hmmm - got carried away from the actual theme... <br><br></td></tr></table><br>
<a name="555095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> RaGR - the window pops up because Microsoft say it should!<br> - Not BlackJumper.<br><br>What BJ is trying to do is prevent that.<br><br>BJ - it works just fine. Exactly what it says on the box - it prevents a full-screen app being alt-tabbed and therefore on some graphics cards causing an MAV.<br><br>That alone was worth the money (;-}) but adding the sticky-keys catcher made it absolutely invaluable (since I use right-shift as a hold-down speed key).<br><br>I feel my app is now rock-solid thanks to you. <br><br></td></tr></table><br>
<a name="555469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stickykeys really should not be touched by any app, other than Windows itself.  I believe all that should be fiddled with are things that Windows does not give the average user controls to change. <br><br></td></tr></table><br>
<a name="555497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well default settings are restored after hotcakes, and how many people actually use the combonations?<br>I think windows should have defaulted these shortcuts to off anyway :) I always turn them off now when i get a new machine or reinstall windows. <br><br></td></tr></table><br>
<a name="555515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> John B.<br>You mean the 5 x Klick on Shift usually opens a Window in Windows? Not here, because that's disabled and Microsoft explains how to do it. And most Gamers do that anyway.<br>But the Window pops up after 5 x Shift when the dll is running and that was the point what I didn't find positive. That's all.<br>As I said: that I could not switch that off is maybe my fault because I only made a very superficial test.<br>The conclusion is: What does it help me, when I prevent Alt Tab but am pushing the problem to 5 x Shift what I didn't have before... and Shift is often used for speeding up in combination with a forward key. And Games that use it usualy disable this "feature" and do not add it. <br><br></td></tr></table><br>
<a name="555787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But the Window pops up after 5 x Shift when the dll is running and that was the point what I didn't find positive <br></div><br><br>OK, that shouldn't happen... If you have StickyKeys/FilterKeys/Togglekeys shortcuts disabled {<i>Not here, because that's disabled and Microsoft explains how to do it. And most Gamers do that anyway.</i>} then this dll <b>should not interfere</b>. <br><br>It was designed to only switch them off <b>if</b> they were left on by the user - and the user's original settings are then restored when you call SetStickyKeysState(false) or KeyboardGameLock(false). As a result there should be no annoying popups during the game (because you set KeyboardGameLock(true) or SetStickyKeysState(true) at the start) but you have not messed with their Windows setup once the game exits.<br><br>I cannot check the code for this now as my development laptop is dying from a sickly fan and I am currently cloning the harddrive. I will look into this when I have access to the code again.<br><br>@RaGR: You do realise that the 'demo' program was designed to show the <b>difference</b> between a program that is left to the user to deal with StickyKeys and one in which you take control by using the dll ?? When you toggle the function 'off' you <i>may</i> get intrusions - depending on the settings in the Accessibility Control Panel. <b>Under normal circumstances this would only prevent intrusions - it isn't designed to introduce them :-)</b><br><br><br><br>@RepeatUntil:<br><div class="quote"> I did the test with KeyHit(1) located at some other place in my code, and depending where it is located, sometimes it works as expected <br></div><br>Are you using a KeyHit() test elsewhere in your code ? I think it should return the count for each different key (can't test just now... see above) but it might be that any call to KeyHit() 'resets' all other keys. Can anyone confirm this ? <br><br></td></tr></table><br>
<a name="555899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, that would make KeyHit() useless. =] But it could be possible that GetKey() is used somewhere? <br><br></td></tr></table><br>
<a name="555998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the meantime I found this: There's a DLL and some sourcecode.<br>The whole article is quite interesting.<br>And the thing works, too. Many additional stuff. Disable Desktop, Taskbar, Startbutton... run process in a new desktop etc...<br><br><a href="http://www.codetools.com/win32/AntonioWinLock.asp" target="_blank">http://www.codetools.com/win32/AntonioWinLock.asp</a> <br><br></td></tr></table><br>
<a name="555999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have to state quite clearly (for BlackJumper's sake) that I am having no problems running full-screen, with StickyKeys/FilterKeys/Togglekeys disabled.<br><br>Certainly not getting a windows box popping up.<br><br>I'm baffled by that, as the program appears to run flawlessly, even down to reinstating the system settings when my app quits. <br><br></td></tr></table><br>
<a name="556009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's nice, John - but the alternative link does not harm BlackJumper at all, doesn't it?<br>King Dave started this thread because of the Alt+Tab thing - maybe he or other readers here want to try out different ways? This one seems to work different. And I didn't say better or worse.<br><br>@BlackJumper - As I said - I didn't check it proper enough and didn't understand everything on glancing through it first time.<br>Ok. I took a deeper look now. And must say - no popups - runs great. I don't know how it happened, but I always must have made the opposite of what was needed - that caused the wrong results. Anyway without my response I would have missed a very useful dll.<br>Big thanks :-) <br><br></td></tr></table><br>
<a name="556212"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for clearing things up RaGR. <br><br>In fact I used <a href="http://www.codetools.com/win32/AntonioWinLock.asp" target="_blank">Antonio Feiajio's article</a> as one of several references when I was upgrading my library (I think he is credited in the ReadMe). <br><br>I guess we could all do with learning not to skim read... I saw the dialogs on that page and assumed that he was producing a 'tool' rather than a dll. Could have saved myself a bit of work ;-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
