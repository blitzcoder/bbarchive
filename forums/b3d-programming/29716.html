<!DOCTYPE html><html lang="en" ><head ><title >Footstep sound on different material</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Footstep sound on different material</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Footstep sound on different material</a><br><br>
<a name="315081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I'd like to know how we can create footstep sound on different material. For exemple, when I walk into the sand it's not the same sound that when I walk on metal.<br><br>THX <br><br></td></tr></table><br>
<a name="315101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jim Teeuwen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> pseudo code:<br><br>Select( Entity_that_Player_is_walking_on )<br>   Case Wood: PlaySound( "footstep_wood" )<br>   Case Iron: PlaySound( "footstep_iron" )<br>   Case Sand: PlaySound( "footstep_sand" )<br>   Case Snow: PlaySound( "footstep_snow" )<br>End Select <br><br></td></tr></table><br>
<a name="315122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >eBusiness</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> And so of course you would need to "mark" each entity with a material type.<br><br>Alternately you could use a "floortype"-map, I use such one in my Lousy Racing Game, feel free to take a look. <br><br></td></tr></table><br>
<a name="315124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> check the other thread somewhere on this forum regarding footsteps on different textures. <br><br></td></tr></table><br>
<a name="315208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok but what is the command to know wich material the player is walking on? <br><br></td></tr></table><br>
<a name="315473"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, Halo posted some great footsteps sounds in the thread listed below:-<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=29552" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=29552</a><br><br>To find out which material the player is walking on you first need to get the handle of the entity your player is colliding with, using 'CollisionEntity'. You can then get the entity's collision type by using 'GetEntityType', and use the number you've assigned as that entity's collision type to index arrays you've set up that contain the properties info for that entity-type.<br><br>Another way to do it is to use the 'NameEntity' command to store an array index to your entity's properties info in its namestring, and then use 'EntityName$ ( entity )' to retrieve the index when you collide with the entity. <br><br>You can also store custom Type pointer values in the namestring by converting the pointer value to and from an integer number using a couple of unofficial, undocumented commands called 'Handle()' and 'Object()'. You can find out more about these in the 'Undocumented' section at www.Blitzcoder.com .<br><br>Basically use:-<br><br>int_variable% = Handle( my_type_pointer.my_type )<br><br>to get the pointer value, and:-<br><br>my_type_pointer.my_type = Object.my_type( int_variable% )<br><br>to convert it back to a custom type pointer. The Object command needs to be followed by the custom type extension (in this case, .my_type) so it knows which custom data type to convert the number to. <br><br></td></tr></table><br>
<a name="315668"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> look at the getsurface,getbrush, get texture type commands i think they will give you what you are looking for<br><br>What I would do:<br>1. do a line pick every 5 cycles straight down from the players position<br>2. do a get brush to determine what material is applied to that surface<br>3. play corresponding sound during the walk sequence <br><br></td></tr></table><br>
<a name="315690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you very much for all your advices <br><br></td></tr></table><br>
<a name="315696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> wesh,<br><br>Another approach could be to put a simple switch trigger at the room/area entry point that changes the walking sound. However, this method is not suitable for large outdoor areas.<br><br>IMHO, Axeman's technique could be the simplest and most flexible. My version of the technique would go like so:<pre class=code>Collisions player,wood,method,response
Collisions player,sand,method,response
Collisions player,iron,method,response
Collisions player,snow,method,response</pre>To detect and play sound dependent on surface<pre class=code>If EntityCollided(player,wood) PlaySound( "footstep_wood" )</pre> <br><br></td></tr></table><br>
<a name="316202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If for some reason the diffrent materials are all diffrent surfaces of the same mesh, you can use the new getbrush, gettexture and gettexturename$ functions (since blitz V.1.85), but bare in mind that getbrush and gettexture will create a brush and a texture copy in memory  that have to be deleted after investigation, so it's a good idea to store all surface handles in arrays together with their sound handle only once right after loading. you can then parse a<br>that small array in the game loop and compare the stored Surface handles with PickedSurface() (from what bradford6 said) <br><br></td></tr></table><br>
<a name="316243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok infortunelly, I 'got one mesh with one surface! I 'd like to know how to separate my mesh with several surface! But thank you for your advices! <br><br></td></tr></table><br>
<a name="316422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If a mesh is using diffrent textures, these textures will be the surfaces in blitz. there are several apps which let you assign multiple textures or materials to a mesh or to parts of the mesh. what App did you use to make your mesh? <br><br></td></tr></table><br>
<a name="316440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> 3DSMAx and I use the B3D pipeline exporter. In fact, I like to have access to all the different ground entity to make my footstep. <br><br></td></tr></table><br>
<a name="316520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you have multiple textures in that mesh, it should also have multiple sufaces in Blitz. I am not shure how B3D Pipeline exports the Mesh. But with the method I described you can have diffrent footsteps with every texture. eg: grass.bmp uses grass.wav, wood.bmp uses wood.wav etc.<br><br>If your mesh has multiple texture files, it also has multiple surfaces - as long as you use LoadMesh to load it, and not LoadAnimMesh. <br><br></td></tr></table><br>
<a name="316633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> In fact, my level is one mesh called "LEVEL.B3D" which contains differents entities (ground, wall, roof, etc..). My problem is that when I used the function Linepick to know what is the entities under the feet of the player, blitz return the global mesh (i.e "LEVEL"). <br>So I'd like to know, if I must do a FindChildren() of my global level mesh or does it's possible (with B3D pipeline extension or in blitzcode) To have acces of all the entities which are pickable.<br><br>I hope that you understand what I said, my english wasn't perfect!!! <br><br></td></tr></table><br>
<a name="316757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't understand because when I 've made a "CountChildren(level)". It returns me 0. In fact, my level has no children. Why? <br><br></td></tr></table><br>
<a name="316842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's because you used LoadMesh("Level.b3d").<br><br>Using LoadMesh, Blitz3D makes the entire level to be one mesh, without keeping the level's structure (so there aren't any children).<br><br>Use LoadAnimMesh instead, if you plan to use any commands for identifying children. <br><br></td></tr></table><br>
<a name="316847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, I discovered that but now It's very very slow! I've got 12000 polys but lots of children. Is that normal? <br><br></td></tr></table><br>
<a name="317145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wesh - no need for loadanimmesh for static Meshes, just a waste of speed. So better use LoadMesh. yes, Linepick wil return the global mesh handle, but don't care! Simply use the PickedSurface() Command to find out what texture your player stepped on.<br><br>As I said, after loading the level you need to store all surfaces in an array. parallely you should store the used texture per surface. this way you can assign a sound to each surface. The reason why is the order of the surfaces of a mesh is never the same after loading - i mean, each time oyu load a mesh with multiple surfaces, the order of the surfaces is randomly diffrent. This might be a DirectX issue, however.<br><br>SO first parse all surfaces and store their handles in a array, you could also use a type, but imho tere is no need for slower types in this case.<br><br>then use the getbrush, gettexture and gettexturename functions to determine which texture files are used by which surface (see SaveB3D example in the code archives on how to use them) and bare in mind: getbrush and gettexture will create a copy of the brush or texture, so it must be frred after finding the texture path.<br>The texture path returned by gettexturename incudes the full path, so you might use t$=replace(path$,currentdir$(),"") to remove everything but the texture filename.<br><br>then you can run something like<br><br>if t$(i)="water.bmp" then <br>sndfile$(i)="water.wav"<br>snd(i)=loadsound(sndfile$(i))<br>endif<br><br>Tell me if there are still questions about this issue. <br><br></td></tr></table><br>
<a name="317316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mathieu A</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you JFK! it works very well.<br><br>I do all that you told me. But I store the surface handle, and texture name in a Type. like that<br><br>type Surface<br> field surface<br> field texture<br> field Material<br>end type<br><br>I've got other questions about that. Is it better to loadsound in the main loop, or initialise sound and playsound in the loop?<br><br>And I want to know another thing about mesh and optimisation. I've got my level compounded of 2 entities indoor and outside(same mesh). And when I'm outside i do not want to render the inside, so I need to Hide the indoor entity. I want to, does it better to use a loadanimmesh and access to the hierachy of the mesh or is it better to seperate my level in two static mesh(loadmesh) and then Hide the indoor mesh?<br><br>I'd prefer the first method if it's possible and not slower than the separate static mesh method, because I do a lightmap of all my level and it's easier to do with only one mesh. <br><br></td></tr></table><br>
<a name="317346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't use loadsound in the mainloop. Load them in the level loading process. then store their handle and simply use playsound handle in the mainloop.<br><br>Your 2nd question is not so easy to answer. Maybe you should use 2 Meshes with LoadMesh, and use the SAME lightmap file for both. Blitz will then load the lightmap only one time to optimize ram usage. <br><br>The problem with LoadAnimMesh is: all your Surfaces will then be Children again :/ <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
