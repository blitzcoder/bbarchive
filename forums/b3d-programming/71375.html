<!DOCTYPE html><html lang="en" ><head ><title >Method for keeping time</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Method for keeping time</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Method for keeping time</a><br><br>
<a name="797944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey!, the project i'm working on has faced me with a great task, i knew it was coming, it was in the plans, anyways:<br><br>Lets say my program keeps track of plant growth.<br><br>my user chooses a grape plant to grow like so:<br><pre class=code>
you just planet a grape, will be fully grown in 5 days!
</pre><br>i store a time in a .txt file, when he opens the program 4 days later i want the program to know:<br><br><pre class=code>
your grape still needs 1 day to grow
</pre><br>how would i go about doing something like this? obviosly i have to store a time in a .txt file, so it can read off that when it starts up next. i got that much. <br><br></td></tr></table><br>
<a name="797953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could use CurrentDate$() to read the current date, and compare it to the date stored in the file.<br>A user could put back his computer clock/date or he could return after 15 days, while the plant needs 5 days to grow. It could be sensible to take these situations in account.<br><br>So:<br>0) get currentdate$<br>1) if filetype = 0 then new file, write date (new plant)<br>2) if filetype = 1 then open file, read date (old plant)<br>3) substract old date from new date, result is age of plant<br>4) if age &lt; 0 then ..<br>   if age &gt; 5 then ..<br>5) print 'your plant is ' + age + 'days old' <br><br></td></tr></table><br>
<a name="797955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> how would i substract the old date from the new date like for example this program doesnt work for obviose reasons..<br><br><pre class=code>
Graphics 800,600,16,2

date$=CurrentDate()

olddate$ = "20 Jul 2007"

Print date$-olddate$

Delay 6000
</pre><br><br>the rest is pretty straight forword.. <br><br></td></tr></table><br>
<a name="797956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Duh.<br><br><pre class=code>
Graphics 800,600,16,2

date$=CurrentDate()

olddate$ = "20 Jul 2007"

int_date%=Left(date,2)
int_olddate%=Left(olddate,2)

Print int_date-int_olddate

Delay 6000
</pre><br><br>Awsome. thanks for the help b32! <br><br></td></tr></table><br>
<a name="797961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, is CurrentDate's month return always the first 3 letters of a month? i need to be sure before i write this function <br><br></td></tr></table><br>
<a name="797975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, now i'm trying to get a hour value, lets pretend "Gas" is a fuel that runs per hour burning 450 units per hour..<br><br>heres the function i'm using to return how many days of 'gas' you have left.<br><br><pre class=code>
Function daysleft(fueltype$,amount)
days=0

Select fueltype$
Case "Gas"
days=amount/10800
End Select


Return days

End Function
</pre><br>this functions pretty straight forword, you punch in Gas as your fuel, and it devides the amount of fuel you punched in by a days worth a fuel(for gas) and returns the result.<br><br>i need the same thing but returns how many hours (ontop of the days) you have left..<br><br>so that i can display this as like<br><pre class=code>
You have DD days left and HH hours left of Gas
</pre><br><br>i cant just write the same function but instead of<br><pre class=code>
days=amount/10800
</pre><br>put<br><pre class=code>
days=amount/450
</pre><br><br>because that would return the total amount of hours of gas i have, not what i'm looking for..<br><br>so i tried somthing like this with a float:<br><pre class=code>
Function hoursleft$(fueltype$,amount#)
tmp# = 0.0
hours=0
tmp2$=""

Select fueltype$
Case "Gas"
tmp#=amount/10800

End Select

tmp2$=tmp#
hours% = Mid(tmp2,2,1)

Return hours
End Function
</pre><br><br>to extract the first decimal of a float of days (that would be the hours)<br><br>but for some reason it doesnt seem accurate.. what am i doing wrong? or am i going about it wrong, if so any ideas on how to do this? <br><br></td></tr></table><br>
<a name="798091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> i don't get this even the simplest function is incorrect:<br><br><pre class=code>
Function hoursleft$(amount#)

amount=amount / 10800

Return amount
End Function
</pre><br><br>if you enter 450, that would be 1 hour of the 24 hours, so it should return 0.1<br><br>can anyone explain why this isnt working? <br><br></td></tr></table><br>
<a name="798092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your function works.<br><br>But dividing 450 by 10800 will not return 0.1, that's simple math. <br><br></td></tr></table><br>
<a name="798094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> no it doesnt, take this small program for example:<br><br><pre class=code>
houramount# = 450.0

proof# = houramount*24

daysamount# = proof#

Print houramount / daysamount

Delay 6000
</pre><br><br>should display "0.1" but it displays 0.04and a bunch of numbers.. <br><br></td></tr></table><br>
<a name="798096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> oi, duh, i put it backwords.<br><br>Edit and you changed your reply :D <br><br></td></tr></table><br>
<a name="798097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> As for the remaining hours, I think you could use the Mod operator. It returns the remainder of a division.<br>Ie:<br>days = amount / 100 --&gt; division with integers will return only whole numbers<br>hours = amount mod 100<br><br>In this example, if 'amount' is 201, 'days' will be 2 and 'hours' 1 <br><br></td></tr></table><br>
<a name="798099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, i'm tried, i think this mod thing might be what i'm looking for. i'll try it <br><br></td></tr></table><br>
<a name="798105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, it seems mod returns the total number in this case?  i use:<br><br>days=11250/ 10800<br><br>to return the days(1)<br><br>and now using<br><br>hours = 11250 Mod 10800<br><br>and it returns 11250?<br><br>am i doing somthing wrong? as soon as i get this one i'm going to bed <br><br></td></tr></table><br>
<a name="798108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I think so ? Because when I try it, I get 450:<br><pre class=code>
Print 11250 Mod 10800

WaitKey()
</pre> <br><br></td></tr></table><br>
<a name="798115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Duh, i see what went wrong!<br><br>thanks b32! <br><br></td></tr></table><br>
<a name="798123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might find dates a lot simpler to work with if you convert them to the number of seconds since X. X is conventionally January 1, 1970, but you could very easily use January 1, 2000 or (perhaps better) the date/time that the current game was started.<br><br>If you do this, all the math becomes trivial addition and subtraction. <br><br></td></tr></table><br>
<a name="798124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> By the way Yahfree,  I just posted a small collection of my date functions in the code archive, if you are interested.  Currently, there are no example code, but if people are really struggling, I'll try to find time to make a couple examples.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2081" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2081</a><br><br>Cheers. <br><br></td></tr></table><br>
<a name="798190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very useful, thanks _33, octhothorp, that might be easy, but i don't see any functions that return the current date/month/year/hour/minute/second in seconds.. <br><br></td></tr></table><br>
<a name="798392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> That is because Blitz uses 32 bit long integers (a standard integer is 16 bits, also known as a "short" integer), time in seconds (such as how Windows stores creation/modification dates for files) is stored in 64 bit integers(not sure what they are normally called, "double long integers" maybe?).  32 bits is just not enough to store that much data.  A 32 bit signed int will work for 68 years, a 64 bit signed int will work for 292,471,208,677 years either side of your starting date (which is enough to store the age of the earth, even if you believe in an old earth)<br><br>If you want the current date and time, try this:<pre class=code>date$=CurrentDate$()
time$=CurrentTime$()

year%=Right$(date$,4)
month$=Mid$(date$,4,3)
day%=Left$(date$,2)
hour%=Left$(time$,2)
minutes%=Mid$(time$,3,2)
seconds%=Right$(time$,2)</pre><br>If you want months in an integer then change the "month$=" to "m$=" and add the following:<pre class=code>Select m$
	Case "JAN":month%=1
	Case "FEB":month%=2
	Case "MAR":month%=3
	Case "APR":month%=4
	Case "MAY":month%=5
	Case "JUN":month%=6
	Case "JUL":month%=7
	Case "AUG":month%=8
	Case "SEP":month%=9
	Case "OCT":month%=10
	Case "NOV":month%=11
	Case "DEC":month%=12
	Default:   month%=1
End Select</pre> <br><br></td></tr></table><br>
<a name="798393"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep, i wrote some functions to return ints of date ect ect here they are if they seem useful...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;---------------------------------
;        ReturnCurDateInt
;---------------------------------
Function ReturnDateInt%()
temp$ = CurrentDate()

temp2% = Left(temp,2)

Return temp2
End Function

;--------------------------------
;         ReturnCurMonthInt
;--------------------------------
Function ReturnMonthInt%()
temp$ = CurrentDate()

temp2$ = Mid(temp$,4,3)

;Figures out what month it is and returns its number
Select temp2$
Case "Jan"
temp3% = 1
Case "Feb"
temp3% = 2
Case "Mar"
temp3% = 3
Case "Apr"
temp3% = 4
Case "May"
temp3% = 5
Case "Jun"
temp3% = 6
Case "Jul"
temp3% = 7
Case "Aug"
temp3% = 8
Case "Sep"
temp3% = 9
Case "Oct"
temp3% = 10
Case "Nov"
temp3% = 11
Case "Dec"
temp3% = 12
End Select

Return temp3%

End Function


;------------------------------
;         ReturnHourInt
;------------------------------
Function ReturnHourInt%()
temp$ = CurrentTime()

temp2% = Left(temp$,2)

Return temp2

End Function
</textarea> <br><br></td></tr></table><br>
<a name="798775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yuck, i got a problem, i'll try to explain the best i can.<br><br>To put it into propective i'll use a pretend plant program as an example.<br><br><br>In this plant program, people can share information on how old their plants are. <br><br>the program reads a plant information file, in txt, thats how they share the plant information..<br><br>so person A is from a different timezone then person B<br><br>person A wants to show person B on how his plant is doing. Person B takes the information file from person A<br><br>the program then takes the old time marked on the file, and compares it with his 'new time'<br><br>because Person B is 2 hours ahead of Person A, his program takes Person A's file and reads Person A's time..<br><br>when the program grabs Person Bs current time, it calculates the plant to be 2 hours older then it should be!<br><br>thats my problem, But, i wrote my program so when it opens the first time, it subtracts everything and writes it back to the file.<br><br>in this messed up case, it would write the plant data back to the file with the information that the plant is 2 hours older then it should be.<br><br>after it writes back what it thinks is the correct data, the program then updates the time. my update time function updates the time based on the computer clock, so it would fix this issue.<br><br>but i cant use it before i update the data, otherwise it wouldnt subtract how old the plant is correctly, it would think no time has passed, and it would take any time off the plant.<br><br>i hope i was clear enough, how would i solve this problem? <br><br></td></tr></table><br>
<a name="798798"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you could read out what timezone the user is, and convert the system time to GMT before using it ?<br>Here is how to use the api, not sure if the daylight saving time stuff works correctly though.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;place these lines in any .decls file in:
;  c:\program files\blitz3d\userlibs
;---------------------------------------------
;	.lib "kernel32.dll"
;	
;	api_GetTimeZoneInformation% (lpTimeZoneInformation*) : "GetTimeZoneInformation"
;---------------------------------------------

	bank = CreateBank(255)
	
	api_GetTimeZoneInformation(bank)
	
	Print "Timezone info:"
	Print "--------------"
	
	;offset in minutes for the timezone
	bias = PeekInt(bank, 0)			
	Print "Your time is GMT+" + (bias/60)
	
	;name timezone
	name$ = PeekString(bank, 4, 64) 
	Print "This area is called " + name$ 
	
	Print
	
	daylight_name$ = PeekString(bank, 78, 64)
	Print "Optional daylight save info:"
	Print "----------------------------"
	Print "name = " + daylight_name$
	
	daylightbias = PeekInt(bank, 150)
	Print "offset =" + daybias
	

	WaitKey()
	End

; build and return a string of characters from a bank
;-----------------------
Function PeekString$(bank,offset,numbytes)
;-----------------------
	Local a$=""
	For pos=0 To numbytes-1
		byte=PeekByte(bank,pos+offset)
		If byte&lt;&gt;0 Then a$=a$+Chr$(byte)
	Next
	Return a$
End Function
</textarea><br>It was based on this info in the msdn:<br><a href="http://msdn2.microsoft.com/en-us/library/ms885646.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/ms885646.aspx</a> <br><br></td></tr></table><br>
<a name="798804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ohh, interesting, if i could convert everyones time into gmt time so the program only has to worry about 1 time, that would solve the problem, heres a dumb question, being the kid i am, different timezones can only be plus from gmt?<br><br>like for example is there any timezone that GMT-2 or any negitives? <br><br></td></tr></table><br>
<a name="798805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Errrrmmm .. offcourse I know that .. (googlegoogle) ..<br><a href="http://wwp.greenwichmeantime.com/info/timezone.htm" target="_blank">http://wwp.greenwichmeantime.com/info/timezone.htm</a><br>They seem to go from -12 to +12 <br><br></td></tr></table><br>
<a name="798807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then how do you know if:<br><br>Print "Your time is GMT+" <br><br>is + or minus? if it was minus would that line be:<br><br>"Your time is GMT+-"+time?<br><br>Edit, i wasnt very clear, would time be normal int for plus I.E. 6 and a negitive int for minus I.E. -6? <br><br></td></tr></table><br>
<a name="798810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, what would i have to do to add that feature? my guess would be:<br><br>somthing like this:<br><br>to get the new time i use this:<br><br><br>(i would modify my functions above):<br><br><pre class=code>
function ReturnHourInt()

bank = CreateBank(255)
tmp = api_GetTimeZoneInformation(bank)
tmp2 =  PeekInt(bank, 0)

tmp2=tmp2/60


temp$ = CurrentTime()

temp2% = Left(temp$,2)

temp2%=temp2%-tmp2

Return temp2

End Function
</pre><br><br>or somthing like that? right idea? wrong idea? or failing horribly? <br><br></td></tr></table><br>
<a name="798812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Erm .. yes, you're right .. 'bias' would be negative in such an area.<br>The 'daylightbias' is a bit more difficult. <br>The structure also contains two dates, that indicate the start/end date for the daylight saving time.<br>Before the first date, the clock is set normally to GMT+bias<br>However, between the two dates, the clock is set to GMT+bias+daylightbias.<br>I think the 'timezone' structure is now read properly, however it could be good to test it a bit.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;---------------------------------------------
;	.lib "kernel32.dll"
;	
;	api_GetTimeZoneInformation% (lpTimeZoneInformation*) : "GetTimeZoneInformation"
;---------------------------------------------

	bank = CreateBank(255)

	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	
	Print "Timezone info:"
	Print "--------------"
	
	;offset in minutes for the timezone
	bias = PeekInt(bank, 0)			
	Print "Your time is GMT " + bias + " mins"
	
	;name timezone
	name$ = PeekString(bank, 4, 64) 
	Print "This area is called " + name$ 

	Print

	;name daylight area	
	daylight_name$ = PeekString(bank, 78, 64)
	Print "Optional daylight save info:"
	Print "----------------------------"
	Print "name = " + daylight_name$ 

	
	;date when 'normal' time starts	
	month = PeekShort(bank, 70);month
	day = PeekShort(bank, 74);day
	hour = PeekShort(bank, 76);hour
	Print
	Print "date1= " + day + "/" + month + " at " + hour + ":00"
	
	;date when 'normal' time starts	
	month = PeekShort(bank, 154);month
	day = PeekShort(bank, 158);day
	hour = PeekShort(bank, 160);hour
	Print "date2= " + day + "/" + month + " at " + hour + ":00"

	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	Print "daylightoffset = " + daylightbias + " mins"
	
	FreeBank bank
	
	WaitKey()
	End

; build and return a string of characters from a bank
;-----------------------
Function PeekString$(bank,offset,numbytes)
;-----------------------
	Local a$=""
	For pos=0 To numbytes-1
		byte=PeekByte(bank,pos+offset)
		If byte&lt;&gt;0 Then a$=a$+Chr$(byte)
	Next
	Return a$
End Function
</textarea> <br><br></td></tr></table><br>
<a name="798813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ow .. missed your last post ..<br>Ehm, something like that should work, first extract hours/mins, then add 'bias' en if the date is in the 'timesave' period, add 'daylightbias' too<br><pre class=code>
time$ = CurrentTime$()
Print time$

hour = Mid$(time$, 1, 2)
min = Mid$(time$, 4, 2)
sec = Mid$(time$, 7, 2)

Print hour
Print min
Print sec

WaitKey()
</pre> <br><br></td></tr></table><br>
<a name="798815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> mm k... but i thought the built in computer clock grabs 'daylightbias' anyways? so if its in daylightbias, it should subtract more anyways correct? <br><br></td></tr></table><br>
<a name="798822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> how do i figure the date in GMT time? i mean the month doesnt matter, because the most difference between your time and gmt time cant differ up to months..<br><br>Edit, also, why doesnt this work?<br><br><pre class=code>
Function ReturnHourInt%()

bank = CreateBank(255)
tmp = api_GetTimeZoneInformation(bank)
tmp2 =  PeekInt(bank, 0)

tmp2=tmp2/60


temp$ = CurrentTime()

temp2% = Left(temp$,2)

If tmp2 &gt; 0 temp2%=temp2%-tmp2
If tmp2 &lt; 0 temp2%=temp2%+tmp2

Return temp2


End Function
</pre><br><br>should return the hour in GMT time no? well to double check i switched my computer clock to a different timezone ... and the time was different! it should be the same, as the function should compensate for that. <br><br></td></tr></table><br>
<a name="798894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you also reset the clock when changing the timezone ?<br>I tried the following with a few timezones and the result in 'minutes' was allways the same.<br>However, it is still not fullproof. The returned daylight-dates don't seem to be right and I'm not sure if the test I made for daylightsaving is full-proof.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
	;get date
	date$ = CurrentDate$()	
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = PeekInt(bank, 0)			
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias + daylightbias

	;final bias	
	Print "bias: " + bias
	
	time$ = CurrentTime$()
	Print time$	

	hour = Int(Mid$(time$, 1, 2)) * 60
	min = Int(Mid$(time$, 4, 2)) + bias + hour
	
	Print "minutes: " + min
		
	WaitKey()
	End
</textarea><br>So I would keep it in a Function, so it is easier to upgrade later on. <br><br></td></tr></table><br>
<a name="799003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, i'm confused, i'm trying to get the hour in gmt time to start with, but my atempts differ one the time zone set on my computer clock means its not working correctly..<br><br>the plan is no matter what time the users clock is based on, it does the math to convert the user current time into the current gmt time.<br><br>how would i do this?<br><br>ok lets simplefy this, how would i create 2 functions that return the current hour and current date in gmt time, i ausume it would be close to the functions i wrote above (ReturnHourInt, ReturnDateInt) as shown above i tried to modify ReturnHourInt to return the GMT time but i  failed horribly..<br><br>any ideas?<br><br><br>Edit, and i tried your example above, and a +8 time zone would return 1000 somthing and a -8 time zone would return 300 somthing 'minutes'<br><br>Edit2, Just to clear things up a little bit, the prototype i'm building doesnt accuratly respond to hours..<br><br>it doesnt grab the current minute, for example: if you planted your plant seed at 14:59 in 1 minute it will consider it 1 hour old. i plan to change this after i get this working. <br><br></td></tr></table><br>
<a name="799022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I gave it another try. This time I tested it more properly, so now it should be better. I tried writing a function that converts a given time into GMT-time:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics 800, 600, 0, 2
SetBuffer BackBuffer()

date$ = CurrentDate$()
Repeat

	time$ = CurrentTime$()

	Cls
	Text 0,  0, "now:" + time$
	Text 0, 20, "GMT:" + MakeGMTTime$(time$, date$)
	Flip
	
Until KeyHit(1)

End


Function MakeGMTTime$(time$, date$)

	;split date
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	hour = Int(Mid$(time$, 1, 2)) - (bias / 60)
	min = Int(Mid$(time$, 4, 2)) + (bias Mod 60)
	
	hour = hour + (min / 60)
	min = min Mod 60
	If hour &lt; 0 Then hour = hour + 24
	If hour &gt; 23 Then hour = hour - 24
	sec$ = Mid$(time$, 6)
			
	h$ = hour
	m$ = min
	If Len(h$) = 1 Then h$ = "0" + h$
	If Len(m$) = 1 Then m$ = "0" + m$
	time$ = h$ + ":" + m$ + sec$
	
	Return time$
		
End Function
</textarea> <br><br></td></tr></table><br>
<a name="799028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> THATS PERFECT!<br><br>You didnt have to make it for me :\<br><br>a simple point in the right direction woulda done!<br><br>thanks anyways, the only thing remaining is a function that returns the same thing as CurrentDate() but in GMT time, then it should go in the archive, how would you go about doing this?<br><br>and wheres the documents on what each byte is on this bank?<br><br>like how do you know:<br>bias = -PeekInt(bank, 0)<br>is at 0?<br><br>oh and to clean up that function a bit you can put Date/Time in the function... IE<br><br><pre class=code>
Function MakeGMTTime$()
date$ = CurrentDate$()
time$ = CurrentTime$()
</pre><br><br>then it only becomes:<br><br><pre class=code>
Graphics 800, 600, 0, 2
SetBuffer BackBuffer()


Repeat

	yourtime$ = CurrentTime$()

	Cls
	Text 0,  0, "now:" + yourtime$
	Text 0, 20, "GMT:" + MakeGMTTime$()
	Flip
	
Until KeyHit(1)

End


Function MakeGMTTime$()
date$ = CurrentDate$()
time$ = CurrentTime$()


	;split date
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	hour = Int(Mid$(time$, 1, 2)) - (bias / 60.0)
	If hour &lt; 0 Then hour = hour + 24
	If hour &gt; 23 Then hour = hour - 24
	min = Int(Mid$(time$, 4, 2)) 
	
	sec$ = Right$(time$, 2)
	time$ = hour + ":" + min + ":" + sec
	
	Return time$
		
End Function
</pre> <br><br></td></tr></table><br>
<a name="799036"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> About the date, first add the bias to the time. And if the new time is before 0:00 or after 23:59, then add or substract a day. With that new 'day', you can do the same thing towards months. If it is below zero or greater than the numbers of days in a month, substract or add a month. Then the same from month-&gt;years<br><br>About the bias, on the msdn page about this command:<br><a href="http://msdn2.microsoft.com/en-us/library/ms885646.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/ms885646.aspx</a><br><br>is a link to the TIME_ZONE_INFORMATION 'typedef':<br><pre class=code>
typedef struct _TIME_ZONE_INFORMATION { 
  LONG Bias; 
  WCHAR StandardName[32]; 
  SYSTEMTIME StandardDate; 
  LONG StandardBias; 
  WCHAR DaylightName[32]; 
  SYSTEMTIME DaylightDate; 
  LONG DaylightBias; 
} TIME_ZONE_INFORMATION; 
</pre><br>That is the information that will be stored in the bank.<br>'Long' in this case is the same as an Integer/Int (4 bytes), and -after testing- I thought that WChar[32] is a 64 bytes string. <br><br>'Bias' is the first element of this type, that is why it is at zero. <br><br>SYSTEMTIME is also a type:<br><pre class=code>
typedef struct _SYSTEMTIME { 
  WORD wYear; 
  WORD wMonth; 
  WORD wDayOfWeek; 
  WORD wDay; 
  WORD wHour; 
  WORD wMinute; 
  WORD wSecond; 
  WORD wMilliseconds; 
} SYSTEMTIME;
</pre><br>And a Word is 2 byte, I used PokeShort/PeekShort for this. <br><br></td></tr></table><br>
<a name="799087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  If it is below zero or greater than the numbers of days in a month  <br></div><br><br>How do i get the number of days in each month? then store it some way to be able to compare it with the current month? <br><br></td></tr></table><br>
<a name="799091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would make a string containing all the max. days in the months, each 2 characters, and then use Mid$() to get the appropriate value for the current month.<br><br>Then, I believe a leapyear can be found by this<br>(year mod 4 = 0)<br>I would multiply that with (month = 2) and add it to the number of days found with Mid$ <br><br></td></tr></table><br>
<a name="799093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, can you give me a small example? i havent seen this type of technque before i think its the same as this line:<br><br><pre class=code>
mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3
</pre> <br><br></td></tr></table><br>
<a name="799094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> :D Yes .. it is a bit weird I suppose<br><pre class=code>
maxdays = Int(Mid$("312831303130313130313031", month * 2 - 1, 2)) + ((month = 2) * (year Mod 4 = 0))
</pre> <br><br></td></tr></table><br>
<a name="799095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> interesting, looks very strange.. i'll mess with it thanks! <br><br></td></tr></table><br>
<a name="799098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Question, in your code above, month would be int 1-12 correct? and year would be the full year IE 2007? <br><br></td></tr></table><br>
<a name="799100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, although I'm not really certain about these leapyears. 2000 was a leapyear, right ? 2008..2004..2000 .. yes .. I think it is correct. And month is 1-12, integer, indeed <br><br></td></tr></table><br>
<a name="799104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well heres the final function, let me know what you think:<br><br><pre class=code>
;--------------------------------------------
;      MakeGMTDate$()
;--------------------------------------------
Function MakeGMTDate$()
date$ = CurrentDate$()
time$ = CurrentTime$()

	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3
	year = Mid(date$,8,4)
    maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	hour = Int(Mid$(time$, 1, 2))
	min = Int(Mid$(time$, 4, 2)) 
	
	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	;If the hour is greater then 23 (24+) then day would be 1 more in GMT
	If hour+bias/60 &gt; 23 day=day+1
	
	;If the hour is lesser then 0 (-1 and below) then the day would be 1 less in GMT
	If hour+bias/60 &lt; 0 day=day-1
	
	;If the day exceeds the max amount of days in the month, then the month would be 1 more in GMT
	If day &gt; maxdays mon=mon+1
	
	;if the day is less then 1 the month would be 1 less in GMT, reset maxdays so it reads the new month..
	; And set the day to the max days in the month (1 less from the next month)
	If day &lt; 1
	mon=mon-1 
	maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	day=maxdays
	End If
	
	;If the month exceeds 12 (months in a year) set months to 1
	If mon &gt; 12 year=year+1 mon = 1
	
	;If the month is less then 1, set months to 12, drop year by 1
	If mon &lt; 1 year=year-1 mon = 12
	
	
	Select mon
	Case 12: f_mon="Dec"
	Case 11: f_mon="Nov"
	Case 10: f_mon="Oct"
	Case 9: f_mon="Sep"
	Case 8: f_mon="Aug"
	Case 7: f_mon="Jul"
	Case 6: f_mon="Jun"
	Case 5: f_mon="May"
	Case 4: f_mon="Apr"
	Case 3: f_mon="Mar"
	Case 2: f_mon="Feb"
	Case 1: f_mon="Jan"
	End Select
	
Return day + " " + f_mon + " " + year

End Function
</pre><br><br>looks alright to me, but i might of missed somthing/screwed somthing up :D off to testing <br><br></td></tr></table><br>
<a name="799105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Two minor thingies: f_mon isn't defined as a string, so it returns a zero now instead of Aug. And 'day' should allways return 2 digits, even if it is below 10. So best is, to make that a string first, f_day, then add a zero to it if day&lt;10.<br>But for the rest: it looks nice. I also hope it works okay. <br><br></td></tr></table><br>
<a name="799110"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok it seems to work alright, thanks for pointing that out, and thanks for all the help, heres the final functions with a example:<br><br>CurrentGMTTime(Fixed a display issue)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;--------------------------------------------
;      CurrentGMTTime()
;--------------------------------------------

Function CurrentGMTTime$()
date$ = CurrentDate$()
time$ = CurrentTime$()


	;split date
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	hour = Int(Mid$(time$, 1, 2)) - (bias / 60.0)
	If hour &lt; 0 Then hour = hour + 24
	If hour &gt; 23 Then hour = hour - 24
	min = Int(Mid$(time$, 4, 2)) 
	
	sec$ = Right$(time$, 2)
	
	If hour&gt;10 shour$ = hour
	If hour&lt;10 shour$ = "0"+hour
	If min&gt;10 smin$ = min
	If min&lt;10 smin$ = "0"+min
	
	time$ = shour + ":" + smin + ":" + sec
	
	Return time$
		
End Function
</textarea><br>CurrentGMTDate<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;--------------------------------------------
;      CurrentGMTDate$()
;--------------------------------------------
Function CurrentGMTDate$()
date$ = CurrentDate$()
time$ = CurrentTime$()

f_mon$=""
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3
	year = Mid(date$,8,4)
    maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	hour = Int(Mid$(time$, 1, 2))
	min = Int(Mid$(time$, 4, 2)) 
	
	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	;If the hour is greater then 23 (24+) then day would be 1 more in GMT
	If hour+bias/60 &gt; 23 day=day+1
	
	;If the hour is lesser then 0 (-1 and below) then the day would be 1 less in GMT
	If hour+bias/60 &lt; 0 day=day-1
	
	;If the day exceeds the max amount of days in the month, then the month would be 1 more in GMT
	If day &gt; maxdays mon=mon+1
	
	;if the day is less then 1 the month would be 1 less in GMT, reset maxdays so it reads the new month..
	; And set the day to the max days in the month (1 less from the next month)
	If day &lt; 1
	mon=mon-1 
	maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	day=maxdays
	End If
	
	;If the month exceeds 12 (months in a year) set months to 1
	If mon &gt; 12 year=year+1 mon = 1
	
	;If the month is less then 1, set months to 12, drop year by 1
	If mon &lt; 1 year=year-1 mon = 12
	
	
	Select mon
	Case 12: f_mon="Dec"
	Case 11: f_mon="Nov"
	Case 10: f_mon="Oct"
	Case 9: f_mon="Sep"
	Case 8: f_mon="Aug"
	Case 7: f_mon="Jul"
	Case 6: f_mon="Jun"
	Case 5: f_mon="May"
	Case 4: f_mon="Apr"
	Case 3: f_mon="Mar"
	Case 2: f_mon="Feb"
	Case 1: f_mon="Jan"
	End Select
	
	If day&gt;10 sday$ = day
	If day&lt;10 sday$ = "0"+day
	
Return sday + " " + f_mon + " " + year

End Function
</textarea><br><br>Example:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
While Not KeyHit(1)
Cls

Text 0,0,"Your date is: "+CurrentDate()
Text 0,20,"Your time is: "+CurrentTime()
Text 0,60,"GMT Date is: "+MakeGMTDate()
Text 0,80,"GMT time is: "+MakeGMTTime()

Delay 5
Flip
Wend
End

;--------------------------------------------
;      CurrentGMTTime()
;--------------------------------------------

Function CurrentGMTTime$()
date$ = CurrentDate$()
time$ = CurrentTime$()


	;split date
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	hour = Int(Mid$(time$, 1, 2)) - (bias / 60.0)
	If hour &lt; 0 Then hour = hour + 24
	If hour &gt; 23 Then hour = hour - 24
	min = Int(Mid$(time$, 4, 2)) 
	
	sec$ = Right$(time$, 2)
	
	If hour&gt;10 shour$ = hour
	If hour&lt;10 shour$ = "0"+hour
	If min&gt;10 smin$ = min
	If min&lt;10 smin$ = "0"+min
	
	time$ = shour + ":" + smin + ":" + sec
	
	Return time$
		
End Function

;--------------------------------------------
;      CurrentGMTDate$()
;--------------------------------------------
Function CurrentGMTDate$()
date$ = CurrentDate$()
time$ = CurrentTime$()

f_mon$=""
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3
	year = Mid(date$,8,4)
    maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	hour = Int(Mid$(time$, 1, 2))
	min = Int(Mid$(time$, 4, 2)) 
	
	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	;If the hour is greater then 23 (24+) then day would be 1 more in GMT
	If hour+bias/60 &gt; 23 day=day+1
	
	;If the hour is lesser then 0 (-1 and below) then the day would be 1 less in GMT
	If hour+bias/60 &lt; 0 day=day-1
	
	;If the day exceeds the max amount of days in the month, then the month would be 1 more in GMT
	If day &gt; maxdays mon=mon+1
	
	;if the day is less then 1 the month would be 1 less in GMT, reset maxdays so it reads the new month..
	; And set the day to the max days in the month (1 less from the next month)
	If day &lt; 1
	mon=mon-1 
	maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	day=maxdays
	End If
	
	;If the month exceeds 12 (months in a year) set months to 1
	If mon &gt; 12 year=year+1 mon = 1
	
	;If the month is less then 1, set months to 12, drop year by 1
	If mon &lt; 1 year=year-1 mon = 12
	
	
	Select mon
	Case 12: f_mon="Dec"
	Case 11: f_mon="Nov"
	Case 10: f_mon="Oct"
	Case 9: f_mon="Sep"
	Case 8: f_mon="Aug"
	Case 7: f_mon="Jul"
	Case 6: f_mon="Jun"
	Case 5: f_mon="May"
	Case 4: f_mon="Apr"
	Case 3: f_mon="Mar"
	Case 2: f_mon="Feb"
	Case 1: f_mon="Jan"
	End Select
	
	If day&gt;10 sday$ = day
	If day&lt;10 sday$ = "0"+day
	
Return sday + " " + f_mon + " " + year

End Function
</textarea><br><br>I'll go code Archive these gems <br><br></td></tr></table><br>
<a name="799133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, maybe all is not well? run the example under different timezone settings on your computer clock, the GMT time seems to change? any ideas? <br><br></td></tr></table><br>
<a name="799276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I tried that, but it seems to work correctly ? I tested your last posted code under 'example'. In every timezone, I got 15:43 <br><br></td></tr></table><br>
<a name="799323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, set your timezone to somthing that has a halfhour thrown in it... like GMT + 9:30 or GMT - 4:30 <br><br></td></tr></table><br>
<a name="799351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see the problem.. when the bias is applied, it is divided by 60 in an integer division. That is the reason half hours 'dissapear' from this calculation.<br>After the line <pre class=code>If test Then bias = bias - daylightbias
</pre> it should go like this:<br>1. get hours and minutes<br>2. convert both to single time in minutes from midnight<br>   minutes = hours * 60 + minutes<br>3. apply bias to that number<br>   -if below zero, add 1440 minutes (=24hour)<br>   -use Mod 1440<br>4. finally, divide it by 60 again to get the hours, and use Mod 60 to get the minutes.<br>That should work better. <br><br></td></tr></table><br>
<a name="799354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> cant i just use:<br><br>Minutes = bias mod 60<br><br>?<br><br>then use bias as normal and add minutes to minutes?<br><br>edit:<br><br>somthing like this would work?<br><pre class=code>
	minutebias = - (bias Mod 60)
	
	min = Int(Mid$(time$, 4, 2)) - (minutebias)
	If min &lt; 1 Then min = min + 60 hour=hour-1
	If min &gt; 59 Then min = min - 60 hour=hour+1
</pre> <br><br></td></tr></table><br>
<a name="799409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> It looks like it should work. Have you tried it allready ? <br><br></td></tr></table><br>
<a name="799414"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tried it... hmm not working it seems:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
While Not KeyHit(1)
Cls

Text 0,0,"Your date is: "+CurrentDate()
Text 0,20,"Your time is: "+CurrentTime()
Text 0,60,"GMT Date is: "+CurrentGMTDate()
Text 0,80,"GMT time is: "+CurrentGMTTime()

Delay 5
Flip
Wend
End

;--------------------------------------------
;      CurrentGMTTime()
;--------------------------------------------

Function CurrentGMTTime$()
date$ = CurrentDate$()
time$ = CurrentTime$()


	;split date
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	minutebias = - (bias Mod 60)
	
	min = Int(Mid$(time$, 4, 2)) - (minutebias)
	If min &lt; 1 Then min = min + 60 hour=hour-1
	If min &gt; 59 Then min = min - 60 hour=hour+1
	
	hour = Int(Mid$(time$, 1, 2)) - (bias / 60.0)
	If hour &lt; 0 Then hour = hour + 24
	If hour &gt; 23 Then hour = hour - 24
	
	sec$ = Right$(time$, 2)
	
	If hour&gt;10 shour$ = hour
	If hour&lt;10 shour$ = "0"+hour
	If min&gt;10 smin$ = min
	If min&lt;10 smin$ = "0"+min
	
	time$ = shour + ":" + smin + ":" + sec
	
	Return time$
		
End Function

;--------------------------------------------
;      CurrentGMTDate$()
;--------------------------------------------
Function CurrentGMTDate$()
date$ = CurrentDate$()
time$ = CurrentTime$()

f_mon$=""
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3
	year = Mid(date$,8,4)
    maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	hour = Int(Mid$(time$, 1, 2))
	min = Int(Mid$(time$, 4, 2)) 
	
	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	;If the hour is greater then 23 (24+) then day would be 1 more in GMT
	If hour+bias/60 &gt; 23 day=day+1
	
	;If the hour is lesser then 0 (-1 and below) then the day would be 1 less in GMT
	If hour+bias/60 &lt; 0 day=day-1
	
	;If the day exceeds the max amount of days in the month, then the month would be 1 more in GMT
	If day &gt; maxdays mon=mon+1
	
	;if the day is less then 1 the month would be 1 less in GMT, reset maxdays so it reads the new month..
	; And set the day to the max days in the month (1 less from the next month)
	If day &lt; 1
	mon=mon-1 
	maxdays = Int(Mid$("312831303130313130313031", mon * 2 - 1, 2)) + ((mon = 2) * (year Mod 4 = 0))
	day=maxdays
	End If
	
	;If the month exceeds 12 (months in a year) set months to 1
	If mon &gt; 12 year=year+1 mon = 1
	
	;If the month is less then 1, set months to 12, drop year by 1
	If mon &lt; 1 year=year-1 mon = 12
	
	
	Select mon
	Case 12: f_mon="Dec"
	Case 11: f_mon="Nov"
	Case 10: f_mon="Oct"
	Case 9: f_mon="Sep"
	Case 8: f_mon="Aug"
	Case 7: f_mon="Jul"
	Case 6: f_mon="Jun"
	Case 5: f_mon="May"
	Case 4: f_mon="Apr"
	Case 3: f_mon="Mar"
	Case 2: f_mon="Feb"
	Case 1: f_mon="Jan"
	End Select
	
	If day&gt;10 sday$ = day
	If day&lt;10 sday$ = "0"+day
	
Return sday + " " + f_mon + " " + year

End Function
</textarea><br>what am i doing wrong? <br><br></td></tr></table><br>
<a name="799417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think the order of calculating hour/min went wrong.<br>First, you substract or add one to 'hour' (when checking the minutes) Then, you define 'hour' again, discarding the previous value of 'hour'. <br><br></td></tr></table><br>
<a name="799421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think i get it.. the order you discribed sounds exactly how it looks in the above example? <br><br></td></tr></table><br>
<a name="799423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I tried to describe what went wrong :)<br>First you say:<br>If min &lt; 1 Then min = min + 60 hour=hour-1<br>If min &gt; 59 Then min = min - 60 hour=hour+1<br><br>&lt;- So 'hour' is 1 or -1 at this point -&gt;<br>Then:	<br>hour = Int(Mid$(time$, 1, 2)) - (bias / 60.0)<br>^ Here, any previous changes made to 'hour' dissapear <br><br></td></tr></table><br>
<a name="799424"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> ahh i see, i made the changes, and it still doesnt seem to work :( any ideas?<br><br>function as of now:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
;--------------------------------------------
;      CurrentGMTTime()
;--------------------------------------------

Function CurrentGMTTime$()
date$ = CurrentDate$()
time$ = CurrentTime$()


	;split date
	day = Mid$(date$, 1, 2)
	mon = (Instr("JanFebMarAprMayJunJulAugSepOctNovDec", Mid$(date$, 4, 3)) + 2) / 3	

	bank = CreateBank(255)
	;retreive timezone info	
	api_GetTimeZoneInformation(bank)
	;offset in minutes for the timezone
	bias = -PeekInt(bank, 0)
	;date when 'normal' time starts	
	month1 = PeekShort(bank, 70);month
	day1 = PeekShort(bank, 74);day
	hour1 = PeekShort(bank, 76);hour
	;date when 'normal' time starts	
	month2 = PeekShort(bank, 154);month
	day2 = PeekShort(bank, 158);day
	hour2 = PeekShort(bank, 160);hour
	;amount of minutes offset in summer	
	daylightbias = PeekInt(bank, 168)
	FreeBank bank
	
	;test for daylightsaving
	test = 0
	If (mon &gt;= month2) And (mon &lt;= month1) Then
		If (mon &lt;&gt; month1) And (mon &lt;&gt; month2) Then test = 1
		If (day &gt;= day2) And (mon = month2) Then test = 1
		If (day &lt;= day1) And (mon = month1) Then test = 1
	End If
	If test Then bias = bias - daylightbias
	
	minutebias = - (bias Mod 60)
	hour = Int(Mid$(time$, 1, 2)) - (bias / 60.0)
	
	min = Int(Mid$(time$, 4, 2)) - (minutebias)
	If min &lt; 1 Then min = min + 60 hour=hour-1
	If min &gt; 59 Then min = min - 60 hour=hour+1
	
	If hour &lt; 0 Then hour = hour + 24
	If hour &gt; 23 Then hour = hour - 24
	
	sec$ = Right$(time$, 2)
	
	If hour&gt;10 shour$ = hour
	If hour&lt;10 shour$ = "0"+hour
	If min&gt;10 smin$ = min
	If min&lt;10 smin$ = "0"+min
	
	time$ = shour + ":" + smin + ":" + sec
	
	Return time$
		
End Function
</textarea> <br><br></td></tr></table><br>
<a name="799430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe the minutebias ? It is negative, and later on it is substracted, resulting in a positive value. <br><br></td></tr></table><br>
<a name="799433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yo! Wazzup?</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know if you've already done this, I'm too lazy to look through the fourm... You should encrypt the date in case someone tries to change the text file. <br><br></td></tr></table><br>
<a name="799438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yahfree</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems to be working now, thanks b32.<br><br>Wazzup, may be a possiblilty for the future, but at the moment if the users want to screw up their own data files they can be my guest :D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
