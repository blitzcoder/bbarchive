<!DOCTYPE html><html lang="en" ><head ><title >ExecFile() Problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ExecFile() Problem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >ExecFile() Problem</a><br><br>
<a name="233875"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rogue Vector</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My intro file is encapsulated in a seperate .exe file to my main game .exe file.<br><br>e.g.<br>  Intro.exe ; run the intro sequence<br>  Game.exe  ; start the game engine etc<br><br>In Game.exe, I have the first line of code as:<br><br>ExecFile("Intro.exe")<br><br>It does launch the file, BUT, here's the problem - It doesn't wait until Intro.exe has finished executing before moving onto to the next line of code.<br><br>What I get is a glimpse of the intro then it is abruptly cut off and the main game engine starts up - overriding it.<br><br>Is there a way I can make the engine wait until the intro has finished playing before loading up the engine.<br><br>I don't really want to use a WaitKey() statement here.<br><br>I need the intro to smoothly feed into the game.<br><br>Thanks in advance<br>RV <br><br></td></tr></table><br>
<a name="233912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> A batch file should work.  Try this:<br><br>Create your batchfile go.bat (or go.cmd, if you want, and you have NT/XP)<br><pre class=code>
Intro.exe
Game.exe
</pre><br><br>and then in your Blitz program:<br><pre class=code>
ExecFile("cmd /c go.bat")
</pre><br><br>(You will have to use command.com instead of cmd.exe in 9x.)<br><br>Or, if you don't want a window popping up, try using CreateProcess instead of ExecFile, but I think it leaves a stream open which you have to close. <br><br></td></tr></table><br>
<a name="233944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or just:<br>- run the 'intro' game<br>- at the end of the intro game, I mean inside the intro game code, just run the game itself.<br><br>In this way, there's no program who has to wait for another; just when the intro has finished, the last line before to quit will run the game itself.<br><br>So, to make a similar example like your one, in the Intro.exe, at the very end of the program put the statemet Execfile("Game.exe").<br><br>Hope it has sense for you,<br>Sergio. <br><br></td></tr></table><br>
<a name="233946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JPL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="233949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @soja: This is not very suitable. It implies creating an exe (big) just to execute the bacth! If you use a batch, which seems fine for what you want, better directly say your entry point is the batch itself. Also note that you could directly do ExecFile("go.bat").<br>The nice method would indeed to use CreateProcess, but it exists only in BlitzPlus, not in Blitz3D :/<br><br>EDIT: just seen the post of semar, his method is just as easy indeed. <br><br></td></tr></table><br>
<a name="234039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This is not very suitable. It implies creating an exe (big) just to execute the bacth! <br></div><br><br>You're right -- duh! -- chalk that one up to being TOO FAR into the Blitz mindset!  =)<br><br><div class="quote"> ...you could directly do ExecFile("go.bat"). <br></div><br>Actually, you can't.  It needs to be run from a command-line interpreter of some sort. <br><br></td></tr></table><br>
<a name="234117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't? I must verify this, but I already done it!<br>Well maybe it didn't worked for you because the ".bat" files are not associated to cmd.exe nor command.com on your system? <br><br></td></tr></table><br>
<a name="234128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> To take the completely opposite standpoint, would it really be that difficult to merge the two into a single exe? It'll save you having to distribute all the blitz libraries twice over (once inside each exe), and therefore skim something like 600k off your download.<br><br>I can't think of any good reason why you wouldn't want both programs in one exe (feel free to enlighten me) <br><br></td></tr></table><br>
<a name="234274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Well maybe it didn't worked for you because the ".bat" files are not associated to cmd.exe nor command.com on your system? <br></div><br>Beats me.  I've tried it on two different WinXP systems, and I haven't done anything funky with file associations... ??  I thought it was strange, but it DID work when I passed it as a parameter to cmd.exe... so I didn't think on it too much. <br><br></td></tr></table><br>
<a name="234449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rogue Vector</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay.<br><br>You may be wondering why I want to do it this way.<br><br>Well... Basically, I've found a crude way of linking a Macromedia Flash Movie to a Blitz program.<br><br>My 'Intro.exe' file encapsulates a Macromedia Flash Title sequence overlayed onto embedded movie footage.<br><br>I can trigger the game.exe from the Flash executable, but I can't trigger the Flash executable from the Blitz program without the problem, previously descrided, occuring.<br><br>I think it would be cool if they could put something like a CreateProcess() into Blitz3D.<br><br>Cheers.<br><br>RV <br><br></td></tr></table><br>
<a name="234600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >soja</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I don't know anything about Flash, so I can't offer any suggestions there...<br><br>and if the straight "call a batch file" doesn't work for you...<br><br>then perhaps in game.exe, launch intro.exe, and then monitor for the existence of it using a userlib call (probably to some function in user32.dll or kernel32.dll), just looping on that until the program is terminated, then continue execution of game.exe once it's gone.<br><br>It just comes down to polling for termination instead of an event-based approach (I guess) <br><br></td></tr></table><br>
<a name="234713"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >yinch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> if you know the duration of your flash movie - maybe you could just stick a delay after the Execfile command. Probably with a polling loop to check if there has been a skip intro keypress<br><br>so for example<br><pre class=code>
Execfile("intro.exe")
EndTime = MilliSecs() + DurationFlashMovieMS
While (MilliSecs() &lt; EndTime)
    if (GetKey() &lt;&gt; 0) then EndTime = 0 ;detects key press
    Delay(40) ; this reduces CPU load
Wend

; continue with rest of your blitz program
; .
; .
; .
</pre><br><br>y'03 <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
