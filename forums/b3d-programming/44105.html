<!DOCTYPE html><html lang="en" ><head ><title >Blitz3d in a Window - Jittery?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Blitz3d in a Window - Jittery?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Blitz3d in a Window - Jittery?</a><br><br>
<a name="491574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This one's bugged me for as long as I can remember, but since I don't normally write windowed-only games, it wasn't too important. But now I am, so it is. Blitz games in a window at twitchy and jittery, where their fullscreen cousins are not. This seems mainly to happen when I'm connected to the net, and happens worse if I'm downloading a file. I don't have a clue why that would make a difference ( aside from it being a software modem and needing a little cpu time, but not much ) but I'm absolutely certain it IS making a difference.<br><br>In fullscreen I can get rid of an occasional jitter by adding a little delay in the main loop, but windowed mode jitters much more frequently in the first instance and a little delay does not seem to help.<br><br>Lots of you have written windowed-only games, so how can you deal with it? Or can you? <br><br></td></tr></table><br>
<a name="491581"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please try my code and read my description from this topic to see if it's related:<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=33850" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=33850</a><br><br>If it is, it's one of my big whishes to get it fixed. :) <br><br></td></tr></table><br>
<a name="491677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well it's not exactly the same problem, because my game doesn't have any mouse input apart from the native Windows mouse cursor, but it does indeed seem to be related. It shows up for me most often when I have some smooth but slow moving objects ( eg: the text lines in a credits scroller ) and they jitter badly.<br><br>The LockBuffer(BackBuffer()):Unlock(BackBuffer()) fix does seem to help, so thanks for pointing me to that. <br><br>Now that I've looked at your code, I recall a game I wrote a year or two ago, which ran only in windowed mode. It was a puzzle game, but it used FPS-style mouselook, and it lagged like crazy. Again, the situation did occur in fullscreen mode, but to a much lesser degree.<br><br>As I say, the buffer trick seems to help, but it does seem that a proper fix should be implemented, particularly something to stop execution speed affecting mouse input. <br><br></td></tr></table><br>
<a name="491888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HappyCat</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had the mouse lagging problem in windowed mode on my laptop but I found that upgrading my graphics drivers fixed it so I never considered it to be a problem with Blitz itself.<br><br>Who knows though?  :-) <br><br></td></tr></table><br>
<a name="491899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >danjo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> i recently tried something. i have a 3d game, and use graphics3d etc, works ok in both full and windowed. i tried something at the start to start it in non3d mode, with just graphics 640,480,0,2 - and the scrolling stuff went very jerky, but in fullscreen it didnt.. <br><br></td></tr></table><br>
<a name="491935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason why is a dx fullscreen app has a much higher task priority than a windowed app. A windowed app has less priority than any system task. The fullscreen App has an extremly high prirotiy, so high that it may crash the system when you don't let windows "breath" from time to time with a Delay, waitkey, flip true or something like that that allows the OS to utilize Blitzes Idle Time.<br><br>A very long time somebody posted a solution that would allow to set the Processes Priority. It should be possible using the Windows Api with a decls call. Although even then you may not get the same priority as a fullscreen App. <br><br></td></tr></table><br>
<a name="491981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm 99% sure the mouse lag issue is not a prirotiy thing.<br><br>I think it's the way the messagepump in Blitz is coded.<br><br>Rendering/flipping takes precedence over getting all messages from Windows.<br>Blitz does not empty the message queue, even though it can't keep up reading messages because it's too buzy rendering.<br><br>IMO Blitz should throw away messages when it can't keep up. <br><br></td></tr></table><br>
<a name="492037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree with Peter. From my experience with the 2 year old game, messages were definitely being ignored in favour of rendering.<br><br>If priority is the issue here, then it should be fixed within Blitz. We should not need to code it ourselves. Blitz knows when it's being run in windowed mode, and it should adjust the priority accordingly.<br><br>Plenty of other languages and tools run DX in a window and don't have this problem. Quest3d and 3d Gamestudio, for example, both run DX in a window and are as smooth as they are in fullscreen. I can't see a legitimate reason for Blitz not to do the same. <br><br></td></tr></table><br>
<a name="492106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was talking about tasks like TCP Data transfer etc. When you're in Fullscreen Mode, your firewall and Antivirus high Priority Processes are forced to do their work in the idle time. In windowed mode it may be not possible to force them to "wait". are you sure the other apps you named don't have the same problems in windowed mode when you use the modem?<br><br>You also need to make sure that your framerate is compatible with the framerate the desktop uses. Probably you should use vwait:flip 0 instead of Flip True. <br><br></td></tr></table><br>
<a name="492111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I'm quite sure that games made with 3d Gamestudio and Quest3d don't jitter at all when the same background tasks are running.<br><br>VWait:Flip 0 is not compatible with some laptop videocards, so I don't use it. <br><br></td></tr></table><br>
<a name="492113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had some troubles when MD2 Models where in use, but I think this isn't your problem.<br><br>BTW: I think it's best to check the users Vsync Settings, something like this:<br><br><pre class=code>
syncmode=1
vwait
t1=millisecs()
vwait
t2=millisecs()
if (t2-t1)&lt;5 then ; seems like vwait is comletely ignored
 syncmode=2
endif
...
; and then in the game loop:

if syncmode=1 then
 vwait:flip 0
else
 flip
endif
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
