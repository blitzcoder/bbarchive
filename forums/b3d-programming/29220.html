<!DOCTYPE html><html lang="en" ><head ><title >Surface count dilemma</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Surface count dilemma</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Surface count dilemma</a><br><br>
<a name="308910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br><br>I'm working on a game where 4 blocks and one border form an island. Now the graphics designers sent me their blocks and the game chokes on them. The blocks contain objects like trees and so on.<br><br>But...I can hide objects that are not in my cameraview. This is the benefit of having seperate objects. On the other hand, combining objects seem to reduce surfacecount.<br><br>IS the TOTAL surface count important, or surfacecount per MESH? Sswift told me about what surfaces are, but I don't know if the game chokes on mesh surfacecount, or total surface count. If it's per mesh, I can chop them.<br><br>Trisrendered says (max) 60000 polygons which is quite high too. But this is the "combined" mesh. The mesh uses 110 surfaces now, but one plant layer used 54 surfaces all by itself! It's not such a complex looking layer! 54 x 4 blocks = 216 surfaces, excluding trees and so on. <br><br></td></tr></table><br>
<a name="308915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 110 surfaces? Blame yourself then... or your artists! :)<br><br>You can have 50.000 polygons on screen easily if your surface count is low, like 1-2. But 110... no way! <br><br>Number of objects is not that important (if it even few hundred), but should be kept at minimum too. But if you group too many (big) objects as one object, you choke to death Blitz3Ds culling because it only works per object... so if your 50.000 polygons are just one object it has to draw every polygon on every surface even if it is behind the camera.<br><br>So:<br><br>-Use sensible sized polygon / object chunks<br>-Minimize the amount of surfaces per object (combine textures to bigger texture chunks and UV-map stuff accordingly if needed) <br><br></td></tr></table><br>
<a name="308948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I find that surface count can add a up to 15 FPS using about 150,000 polygons.  I think mainly though if your game is choking you need to be careful with collision.  In Aerial Antics we had one level with around 40,000 polygons but then we used invisible low polygon collision which was 9,000 polygons.  We didn't really optimize the surface count as we needed many separate objects for culling purposes with the shadow system.  It is my experience that while surface count can a good optimization to a point, that it is far more important to watch collisions and culling.  We actually did some experients with reducing the surfaces, the game ran better overall with a higher surface count but more culling. <br><br></td></tr></table><br>
<a name="308964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, it's all about "balancing"... and there is no ready-made formula for that. And like BAN300 said, hi-poly meshes and collisions can be problematic [slow], preferred and better way is to use optimized invisible low-poly collision hull. <br><br></td></tr></table><br>
<a name="308965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Mustang,<br><br>Thanks for your explanation. I see Blitz does do culling even when it's one object, but ofcourse it isn't that optimised as it would have been with seperate objects. However, combining the "main" mesh, does decrease the surface count, and I guess here the combining does work. However, count is still high. <br><br></td></tr></table><br>
<a name="308972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is 23 surfaces ok? Say 18 surfaces with 2000 polys per surface? <br><br></td></tr></table><br>
<a name="308980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ross: is there a guideline for that? It's hard to tell.<br><br>Well, I decided this:<br><br>Combine the ground to one mesh (blocks+border).<br>Keep the entities on the ground mesh as seperate objects and use show/hide entity when not in cameraview.<br><br>Now it's up to bringing bad news to the modellers... <br><br></td></tr></table><br>
<a name="308982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehe, that's the problem sometimes. Modellers have to work a certain way :) Mind and don't hide meshes that are involved with collisions, if they are off screen :) <br><br></td></tr></table><br>
<a name="309021"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://www.theclue.nl/dukatiers/surfaceExample.jpg"><br><br>is this true? Right half of picture would be the "mesh", left part are the textures. <br><br></td></tr></table><br>
<a name="309036"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, 5 surfaces are needed for the top part since it is made from 5 different textures, this is the bad way of doing it.<br><br>Only 1 surface is needed for the lower part since it uses a single texture. this is the good way since it means both lower poly count and lower surface count. <br><br></td></tr></table><br>
<a name="309041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Every separate piece of texture creates new surface, and every new object (and it's textures) does this too. <br><br>Since objects need to be separate for culling and game purposes (like characters, props, level parts) they should be textured like that, meaning that character should have it's own texturemap and gun it's own. <br><br>You could combine even those, but since they are separate objetcs there's no point really to do that. And so on... <br><br></td></tr></table><br>
<a name="309064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The number of meshes does not matter, only the total number of surfaces in all meshes visible at once, and the total number of polygons visible in all meshes at once.<br><br>Try disabling collisions just for kicks.  I had some problems with collisions and terrains a long time ago but I forget if it was a slowdown or a glitch.<br><br>As a guideline how many surfaces you can have total, I have a mid-range video card, and I can push around 400 surfaces befor my framerate drops from 60 to 30 in a particle system test.  My card is roughly equivalent to a Geforce 2.  But each card will be different in how it handles state changes, which is what a surface causes.  A state change causes a "stall" on the card.  They happen when the card is told to draw with a different texture or other surface property.<br><br><br>"is this true? Right half of picture would be the "mesh", left part are the textures."<br><br>Yes.  In the top image you have many textures, and each one of those will require a different surface, but the bottom image combines several textures into one and so only requires one surface.<br><br>Note also that the bottom version requires one fifth the number of polygons, and that is just for a SINGLE window.  Imagine a while wall on a building filled with these windows, and the bottom version will not only have only one surface as opposed to 5, but there'll only be two polygons on that building as opposed to hundreds.<br><br>Note I still said 5 surfaces on the building.  Just because that one window needs five surfaces that doesn't mean you need 5 more surfaces for every window.  You can just stick all the polygons that use those five textures in the five surfaces that you created to hold those polygons.<br><br>Ie, if you have 500 trees each with a trunk texture and a texture of leaves, then you still only need two surfaces total.  Unless of course you want to be able to remove some of those trees from the scene for polygon culling.  In that case I reccomend combining large numbers of trees into "clumps" and hiding clumps of trees when nercessary instead of individual trees.  That will save you a lot of surfaces and the few extra polygons rendered will have little effect on the speed. <br><br></td></tr></table><br>
<a name="309066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Another factor to consider for speed btw, is OVERDRAW.  How many times is a pixel covered by different polygons?  And are those pixels transparent?  Overdraw can be expensive, and transparent overdraw even more so because you definitely have to draw two layers of pixels if you cansee a solid object behind a transparent one, whereas with opaque stuff you have a good chance of not having to draw extra pixels.  But there's still a lot of zbuffer checks. <br><br></td></tr></table><br>
<a name="309085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I typically find if you have entities that are similar that using CopyMesh() significantly speeds the program up (with about 100 entities).  Is this because it then uses the same surface?  I find it's interesting that you can add so much speed by copying the initial mesh instead of using loadmesh() you still have the same number of entities and you can manipulate them the same (perhaps texture changes are the exception).  There are a lot of ways to increase the speed of programs.  It'd be useful to know the methods and the ideology behind Blitz and why certain things really speed a game up.  I've learned quite a bit about this with the various games I've made but still learn something new every few weeks. <br><br></td></tr></table><br>
<a name="309147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Sswift: Thank you very much, you summed up all answers to my questions. I find the last tip worth to be trying to (overdraw). Your answer should be put in a blitz "user FAQ"...it's very important to know this :)<br><br><br># Ban300: I use a similair system:<br><br>answer = ifEntityIsInLibray(whichEntityFileName$)<br>if answer = true m\mesh=loadMesh(whichEntityFilename$)<br>else m\mesh = copyEntityFunction(whichEntityFileName$)<br><br>Basicly I use a "library" and I copy the entity (pointer) to the meshEntity\entity type. <br><br></td></tr></table><br>
<a name="309148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sswift: should I use hideEntity when an entity is not on screen, and showEntity when an entity IS on screen, or leave it up to Blitz' "flustrum culling"? <br><br></td></tr></table><br>
<a name="309162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I doubt that hiding an entity will in any way speed things up when it is off the screen.  Also, hiding an entity disables collision checking on it, which would affect gameplay.<br><br>Also, I wrote an octree entity hiding system a long time ago, and it was actually much faster to just use EntityAutoFade to hide thousands of trees than it was to try to hide them manually with hidentity.  Of couse neither ran at a good framerate.  It was just a test.  This difference in speed though has likely been dramatically reduced because Mark changed the way Blitz handles hiding entities so that is near instantaneous.  It was not when I did my earlier tests.<br><br>In summary, don't bother with frustrum culling.  Just hide stuff based on distance, and occlusion if possible.  (Ie, trees behind a hill can be hidden and that will speed things up.) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
