<!DOCTYPE html><html lang="en" ><head ><title >Quat "Height" maths question:</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Quat "Height" maths question:</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Quat "Height" maths question:</a><br><br>
<a name="506134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey peeps, Me again...<br><br>I need a hand figuring this out. I've made a program to create a mesh terrain, but that meant having to use Linepick to get height values, so what ive done to speed things up (my current routine takes around a third of the time as a linepick), is create an array the size of the terrain which contains the vertex height at each point.<br><br>I need to use this array to find the height in between those locations, i have it half working, but its not as expected.<br><br>[code<br>   1---2<br>   ¦---.¦<br>   3---4<br>[/code]<br><br>I know the height of positions 1,2,3 and 4. How can i figure out the height at the location of that spot?<br><br>I have a interpolate function (val1,val2,float#[0-1]) which works perfectly.<br><br>So what im doing currently is interpolating the two X and then the Y values and returning the result, but it seems to be out quite some bit in the centre (centre=0.25 instead of 0.5?) but the height at each actual array location is correct.<br><br>I'm close, i can smell it.<br><br>So, can anyone help?<br><br><br>[edit]<br><br>ARGH DAMN IT. we need an Edit for the topic title... <br><br></td></tr></table><br>
<a name="506173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; <br><br></td></tr></table><br>
<a name="506183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks mate, they help, but its more than required..... I'll have to test it but i doubt it will be any quicker....<br><br>The information i have for instance is:<br><br>the height at (0,0),(0,1),(1,0),(1,1),<br><br>a float between 0-1 that shows where about left/right on the square i am<br>a float between 0-1 that shows where about forward/backward on the square i am...<br><br>I'm very very close, and im sure its something very simple<br><br>So if im near the top right corner, my values might be:<br><br>xfloat#=0.9<br>yfloat#=0.9<br><br><br>I recon ive sussed it in my head, i dont have my code here to check. I'll post that later too... :D <br><br></td></tr></table><br>
<a name="506185"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cygnus .. not sure what Caffs version does as haven't tried it ..<br><br>May be quicker for you but ..  <br><br>Assume u is the 0-1 for the x axis and v is the 0-1 for the z axis. <br><br>I do this ...<br><br><pre class=code>
h1#=height(tx,tz)+( height(tx+1,tz)-height(tx,tz))*u 
h2#=height(tx,tz+1)+( height(tx+1,tz+1)- height(tx,tz+1))*u 
Return h1+(h2-h1) * v 
</pre><br><br>May help you . <br><br></td></tr></table><br>
<a name="506188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stevie G, i beleive that is it.. let me use some paper and calc.exe for a few mins.... <br><br></td></tr></table><br>
<a name="506191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; <br><br></td></tr></table><br>
<a name="506194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> "RaGR" im using it for a replacement TerrainY for my own terrain System, so it was the example... I'm affraid im not too good at describing the problem.<br><br>StevieG's code is almost exactly the same as what i figured already, only, its likely even quicker and more accurate, I cant get it to work correctly in VB, but, i cant' remember what VB's float thing is! heh.<br><br>Thanks for both of your help, Problem sorted... Hopefully :D<br><br>[edit]<br><br>Yeah! works! Thanks Steve, and RaGR, i need that snippet of yours in a side-project of mine :) thanks both!!!! <br><br></td></tr></table><br>
<a name="506198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; <br><br></td></tr></table><br>
<a name="506228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lol, I see no reason why i cant use either of the above, StevieG's seems to do exactly what i'm after, ive not actually been able to test yours as i was at work without blitz, i converted steves to VB but never had time to do yours... <br><br><br>Looking at the above though they should give the same results.  Give me a bit and i will test them both.<br><br>If they work, you have a little function to replace your super large one :D <br><br></td></tr></table><br>
<a name="506252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, they both work, Yours is slow because its working everything out, stevies code is using the information i already have. (i have to tell your code how high a point is, so thats where its more useful later when i dont know that its always the same...)<br><br>again, cheers for your help! <br><br></td></tr></table><br>
<a name="506330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ... they both produce the same end result .. even if RaGR was using a custom terrain it will be uniform in scale on the x/z axis so storing each height and interpolating should be much faster for thousands of particles. <br><br></td></tr></table><br>
<a name="506380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> (Hoping nobody will notice I'm hijacking this thread...) Adding to the functionality above, can anyone tell me how to work out the 'slope' (angle) of the tri <br>along the x axis and z axis?, so as to lay a sprite 'flat' on a possibly sloping tri? <br><br></td></tr></table><br>
<a name="506391"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, could use the AllignToVector command? Other than that, *looks at RaGR and Stevie* <br><br></td></tr></table><br>
<a name="506399"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just average the normals of the tri's three vertices, I think. This will give you a normal/vector to align your decal sprite to.<br><br>Note that triangles that share verts have smoothed normals so this may not give you the exact result you want. If so, look in the archives for a function by sswift that calculates the true surface normal of a tri. <br><br></td></tr></table><br>
<a name="506569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I would store the surface normals of each quad ( as per big10p ) and then align to vector on the y axis will do the job. <br><br></td></tr></table><br>
<a name="506640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; <br><br></td></tr></table><br>
<a name="506653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure how to take that, but Ive been programming in blitz for quite some time, and I usually do sus these things out for myself. The occasional bit of help is good, thats what this place is great for... So, the last few days ive had some new ideas and i'm trying them out. These are the simple formula that I will learn and use in a future project.<br><br>Sometimes, you just need to see something and then you just get it. Not like I'm the annoying newbie who never listens and always goes "heh that dont work. It dont, please help!!!"..<br><br>I admitted that your code did the job, and it did it well, but i also knew for my purpose that it could be done alot quicker.<br><br>I really do apreciate any help i'm given around here, and i love to take bits of code like yours and see how it works, what does what. Pretty neat.<br><br>What exactly have I done to bug you? I mean, what was so bad you felt the need to remove your posts? <br><br></td></tr></table><br>
<a name="506670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; <br><br></td></tr></table><br>
<a name="506672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry for waisting your time, I havent actually had more than 10 mins time to program since i'm at work right now.<br>One last thing, i did see why you did that, hence the two pieces of code. Im just horrible at explaining things!<br><br><br>You are right though, and in fact, i should close this window now and actually do something. (just Realised how much i've posted....) <br><br></td></tr></table><br>
<a name="506686"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> ; <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
