<!DOCTYPE html><html lang="en" ><head ><title >TCP stream - Eof() - help!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >TCP stream - Eof() - help!</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >TCP stream - Eof() - help!</a><br><br>
<a name="333108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm experimenting with an automatic FTP upload program to do patches for my game and I'm having trouble with the TCP stream.<br><br>  I thought Eof() returned True if a TCP connection had been closed. However it's returning True when a connection is still active. (I think it happens whenever I read to the end of the incoming data from the FTP server).<br><br>So can somebody say for definite:<br><br>1. How I can tell when the server has finished sending lines to me and is ready for another FTP directive.<br><br>2. How I can tell if the TCP connection has been broken.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="333129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you need to work with a timeout for a "broken" connection, since tcp isn't a true stream anyway, instead it's a packet system.<br><br>Maybe you can solve the problem with reading incoming data as Lines. And you might ask for the file size before downloading it. <br><br></td></tr></table><br>
<a name="333357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jfk,<br><br>  I am reading data with ReadLine(). Blitz's TCP already times out if the connection breaks, and supposedly gives a -1 result for Eof().<br><br>Anyway, I'm not downloading any files, that uses a whole seperate stream with FTP. I'm just reading in the nonsense data (message of the day and all that, about 20 lines worth) that the server sends me, before being ready to receive commands.<br><br>I think there's either a bug in Blitz (Eof() returning True when it shouldn't), or the documentation is wrong. <br><br></td></tr></table><br>
<a name="333387"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I had a little webcam server on tcp base that used to work on WinME, but not on Win98 - using the same firewall settings. It was using the small http server example from the code archives, modified to work with http 1.1. So I wouldn't be surprised if there is some kind of incompatibility. Anyway, FTP Servers tend to speak in many languages, you know, there are so many diffrent protocols and standards that most FTP Clients are not compatible to some Servers (at least not with the default settings).<br><br>But, isn't it the way that a FTP server sends two blank lines (chr$(10)) when he said what he wanted to say? OR was that HTTP? Pretty confusing. Maye there is some kind of FTP EOF Signal, at least on some servers...<br><br>I reccomend to print out onscreen the server answers to see if there is some kind of convention, and last but not least have a look on the RFC Specifications about FTP:  <a href="http://www.rfc-editor.org/rfcxx00.html" target="_blank">http://www.rfc-editor.org/rfcxx00.html</a> <br><br></td></tr></table><br>
<a name="333395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Klaas</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> if not readavail(tcpstream) ... then the server has finished to send packages .. this is not the end of a single line, there could be more lines in one package<br><br>if eof(tcpstream) ... the server has closed the connection<br><br>example:<br>while readavail(tcpstream)<br>   line$ = line$ + readline(tcpstream)<br>   if eof(tcpstream) return line$<br>wend <br><br></td></tr></table><br>
<a name="333442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jfk, FTP uses Telnet. You can actually use a Telnet client to do FTP, except you can't open data connections. The FTP server sends CRLF at the end of each line, and a "220" code means "expecting input", but you don't always get a 220 code, and you don't know how many lines to expect.<br><br>Klass, I use ReadAvail(), but it only tells you how much data has actually arrived, not how much has been sent from the server. So I don't know whether to wait for more data to arrive, or start sending. <br><br></td></tr></table><br>
<a name="333459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Klaas</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a hint ...  why not use the WinInet.dll .. there is a ftp function in it. Its easy to use and reliable. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
