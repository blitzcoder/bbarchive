<!DOCTYPE html><html lang="en" ><head ><title >Height and width of Desktop?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Height and width of Desktop?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Height and width of Desktop?</a><br><br>
<a name="1186314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is possible somehow recover from within Blitz3D the width and height of the windows desktop?, The fact is that my application recognizes (Menu) all display modes available on the graphics card, but if the end user decides to execute the screen relosución highest screen mode application, it runs the RISG to overcome the current windows on the desktop and the field of view of the application is reduced.<br><br>Then wanted to know if it is possible to recover the data (windows desktop width and height) to windows screen mode, taken as a maximum instead of pass that data.<br><br><img src="http://i41.tinypic.com/elei6q.jpg"> <br><br></td></tr></table><br>
<a name="1186319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes. See here: <a href="http://www.blitzbasic.com/Community/posts.php?topic=21501" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=21501</a><br><br><br>(...or just copy this code:<br><pre class=code>; User32.decls
;
.lib "user32.dll"
User32_GetSystemMetrics% (nIndex%) : "GetSystemMetrics"

;
;Blitz code
Global DesktopWidth  = User32_GetSystemMetrics(0)
Global DesktopHeight = User32_GetSystemMetrics(1)</pre><br>...) <br><br></td></tr></table><br>
<a name="1186320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> :D thanks!! i'am happy :) <br><br></td></tr></table><br>
<a name="1186346"></a>

<a name="1186347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Yash, <br>That's an interesting Function,  <b>GetSystemMetrics(#)</b><br><br>;  sources:  <br>;  <a href="http://www.blitzbasic.com/Community/posts.php?topic=100455" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=100455</a><br>;  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724385%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/ms724385%28v=vs.85%29.aspx</a><br><br>I made this small demo showing various uses of GetSystemMetrics(#)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;  The GetSystemMetrics Function 
;
;   copy the following data to User32.decls 
;
;  .lib "user32.dll"
;   User32_GetSystemMetrics% (nIndex%) : "GetSystemMetrics"

 Dim TF$(1)
 TF(0) = "False"
 TF(1) = "True"

; __ special parameter constants __
Const SM_CXSCREEN=0   ;; convenient constants for getting 
Const SM_CYSCREEN=1  ;; width and height of primary monitor

Const SM_CXCURSOR=13 ; the width of your cursor (in pixels)
Const SM_CYCURSOR=14 ; the height of your cursor (in pixels)
Const SM_SWAPBUTTON=23 ; Nonzero if the left and right mouse button definitions are swapped

Const SM_CXMIN=28 ; The minimum width of a window, in pixels
Const SM_CYMIN=29 ; The minimum height of a window, in pixels

Const SM_CMOUSEBUTTONS=43 ; The number of buttons on a mouse, or zero if no mouse
Const SM_SLOWMACHINE=73 ; Nonzero if the computer has a low-end (slow) processor
Const SM_MOUSEWHEELPRESENT=75 ; returns non-zero if your mouse has vertical scroll wheel
Const SM_SHUTTINGDOWN=$2000  ; Nonzero if the current session is in process of shutting down

Graphics 600,400,32,2

 Monitor_X = User32_GetSystemMetrics(0)
 Monitor_Y = User32_GetSystemMetrics(1)
 slow_machine =( User32_GetSystemMetrics(SM_SLOWMACHINE)&gt;0 )
 cursor_width  = User32_GetSystemMetrics(SM_CXCURSOR)
 cursor_height = User32_GetSystemMetrics(SM_CYCURSOR)
 Mwheel =  ( User32_GetSystemMetrics(SM_MOUSEWHEELPRESENT) = True )
 MbuttonCount = User32_GetSystemMetrics(SM_CMOUSEBUTTONS)
 MbuttonSwap = User32_GetSystemMetrics(SM_SWAPBUTTON) 

Print:
Print"  This is a System Metrics Test : " 
Print"  ------------------------------------------------------------"
Print:Print"  Your display monitor has graphics dimensions: "+Monitor_X+": "+Monitor_Y 
Print:Print"  Your cursor has dimensions: "+cursor_width+":"+cursor_height 
Print:Print"  Is mouse wheel present? : "+TF(Mwheel)
Print:Print"  Numer of mouse buttons = "+MbuttonCount

If slow_machine Then Print:Print" You have a SLOW machine. "
If MbuttonSwap Then Print:Print"  Your mouse's buttons are swapped, (LR) "

Print:Print" Touch a key to END. "
WaitKey():End </textarea><br>;------------------------------------------------------------------------<br><br>Next, is a simple demonstration of saving graphics modes in an array using the default B3D functions.<br>( These are apparently the <u>FULL SCREEN</u> modes. )<br><br><pre class=code>Type Gmode    ; Create a listing of graphics modes
         Field x,y  ; width, height 
         Field d    ; depth
End Type 

 Graphics 800,500,32,2

 countModes=CountGfxModes() 
 Dim Gr.Gmode( countModes )
 Local  gg.gmode
 
 For z= 1 To countModes
          gg = New Gmode
          gg\x = GfxModeWidth(z)
          gg\y = GfxModeHeight(z)
          gg\d = GfxModeDepth(z)
          Gr(z) = gg
 Next 

 Print 
 Print "  There are " + countModes + "  graphics modes available as shown: "
 Print 
 For z= 1 To countModes  ;; First, list all those with depth=16          
          If Gr(z)\d =16                   

                      Print"  mode ="+z+"   width ="+Gr(z)\x+ "  height="+Gr(z)\y+"  depth = 16 "
          End If 
 Next 
 Print 
 For z= 1 To countModes  ;; Next, list all those with depth=32
          If Gr(z)\d =32
                      Print"  mode ="+z+"   width ="+Gr(z)\x+ "  height="+Gr(z)\y+"  depth = 32 "
          End If 
 Next 

 WaitKey():End </pre><br> My results show that my computer has 24 graphics modes, where<br> all the even modes have depth=32, and<br> all  the odd modes have depth=16<br> <img src="http://i411.photobucket.com/albums/pp194/aeDream/emoticons/12%20emoticon%20packs%20for%20Messenger/Emopack%2001/Emo_57_zps1d540222.gif"> <br><br></td></tr></table><br>
<a name="1186374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> My code.<br><pre class=code>

; Scaneo de Modos Gráfricos.
;_________________________
Function ScaneoModoVideo%()
	
	Local X% 
	
	
	If Copia_WIND% =  0 Then 
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 16  Then 
				
				
					
					BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
					
			End If 
		Next
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32  Then 
				
				
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
				
			End If 
		Next
		
	End If 
	
	
	If Copia_WIND% = 1
		
		
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32  
				If  GfxModeWidth(X)  &lt;= EscritorioAncho%    And GfxModeHeight(X) &lt;= EscritorioAlto%	
					
					BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
				End If 
			End If 
		Next
	End If 
	
		
	
	
	
	If InitGameFirst% = True Then 
		BCF_SelectedComboBoxValue%(CMB_ModoVideo%,"800 X 600 -32-")
		
	Else 
		
		If Copia_WIND% = 1 And GfxModeDepth(Copia_ModoVideo%) = 16
		
			BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%+1)
			Copia_ModoVideo% = Copia_ModoVideo% +1
		Else 
			BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
			
		End If 
		
	End If 
	
	
End Function 
</pre> <br><br></td></tr></table><br>
<a name="1186464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Captain Wicker (crazy hillbilly)</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Isn't there a command for that already (ie DesktopWidth() and DesktopHeight()) that gets the screen resolution??? <br><br></td></tr></table><br>
<a name="1186475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> re "Isn't there a command for that already .." <br></div><br>We use the ones Yasha invented:  <img src="http://i411.photobucket.com/albums/pp194/aeDream/Yahoo%20emoticons/thinking.gif"><br><br>I don't think Blitz3d has an equivalent command.<br><br> Native_Monitor_X = User32_GetSystemMetrics(0)<br> Native_Monitor_Y = User32_GetSystemMetrics(1) <br><br></td></tr></table><br>
<a name="1186499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey hey don't give me credit for those, all I did was find the older forum post. Credit for those finds belongs to user "fredborg" (hasn't posted here in years but made some cool stuff back in the day). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
