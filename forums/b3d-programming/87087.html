<!DOCTYPE html><html lang="en" ><head ><title >How can I compute which side of my cube is up?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How can I compute which side of my cube is up?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How can I compute which side of my cube is up?</a><br><br>
<a name="987009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been searching around for some examples of surfacecollision, can anyone please hi-light any examples of this code in action so I can work out which side of the cubes is 'up', the cubes when they are loaded each have separate sides as set by the default cube model within Ultimate Unwrap 3D.<br><br>I'll only be attempting to which side is up once the cubes are static.<br><br>[EDIT] <br><br></td></tr></table><br>
<a name="987025"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The side that is pointing up is the one whose normals , when transformed from local space to world space have a y component which is greater than 0 ( prob best to use .5 incase of any inaccuracies )<br><br>i.e.<br><br>tformnormal faceNx, faceNy, faceNz, CUBEmesh, 0<br>if tformedy() &gt; .5<br>   ;this face is facing upwards<br>endif <br><br></td></tr></table><br>
<a name="987053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Stevie, will try this out this morning, still loving the fact that yesterday I fancied generating a program to bounce some dice around.<br><br>Stevie, this is the code I've been attempting to use to calculate which side is up, however all seven dice seem to be reporting that faceNy is 'up'.  <br><br>Below is how I am loading the cubes, the cubes have each side individually identified:<br><br>[EDIT]<br><br>[EDIT] <br><br></td></tr></table><br>
<a name="987067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using the Normals is nice, of course, but a Caveman like me would rather simply check the Y position of the children (top, bottom, side etc.) and then declare the topmost as the side that faces upward. IF the pivots of the children are not on the sides, but all in the center of the cube then you may use some additional Pivots instead. Maybe not that elegant, but at least it follows the KISS philosophy. :) <br><br></td></tr></table><br>
<a name="987089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Bp,<br><br>My example was partially pseudocode, you need to set the faceNx etc.. components yourself.  I also assumed you didn't use children to represent the sides of the cube as you didn't make this clear in your original post.<br><br>I see that you load in children for each side which is a bit overkill if you ask me - in which case jfk's solution would probably be best.<br><br>Stevie <br><br></td></tr></table><br>
<a name="987102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Panno</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> append a entity to each side from a cube (maybe a pivot) create a highpoint over the map (sun) and test the entitydistance from the pivots to the sun is annother way <br><br></td></tr></table><br>
<a name="987103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @jFK, I will attempt to find the Y position of the children. I'm not sure where (if indeed there are any) pivots attached to the children, so I may add some additional pivots for each child and then see which has the highest Y position.<br><br>If I come unstuck attacking from trying to establish which has the highest Y co-ordinate then I will try Panno's suggestion.<br><br>@Stevie, I appreciate I might be overdoing it somewhat with children for each side, I have not set faceNx componenets before, although if you know of a good example displaying typical code which sets faceNx components I'd appreciate it(;-).<br><br>Thanks for the help, BP. <br><br></td></tr></table><br>
<a name="987127"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Bp, <br><br>I don't have time to go into the normals solution but assuming that the children have a local position which is offset against the parent mesh ( i.e. not 0,0,0 ) then you can use something like this ...<br><br><pre class=code>
Function WhichFaceIsUp$( Count )

	HighestSide$ = ""
	BestHeight# = 0
	
	For side = 1 To 6
	
		child = GetChild( mesh_with_children( count ) , side )
		
		If EntityY( child, 1 ) &gt; BestHeight
			HighestSide = EntityName( child )
			BestHeight = EntityY( child, 1 )
		EndIf
		
	Next
	
	Return HighestSide
	
End Function
</pre><br><br>It returns the Name of the side but you can change that to return the child pointer or it's side number and deal with it from there.  <br><br>Stevie <br><br></td></tr></table><br>
<a name="987141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Stevie, thankyou very much, I tried briefly to marry up some pivots to my child sides prior to dinner this evening &amp; was not having much success, I look forward to giving this a whirl when I get back on my Dev PC.<br><br>@jfk, was just impressing my daughter with my skill at being able to do one side (wow I here you cry) of a rubiks cube, I think I peaked at doing two sides of a cube tops when I was younger - evidence I'd too much more interesting stuff to do, erm like program battleships in Basic on a Spectrum.  Had to try your version of blitzcube - quite impressive! <br><br></td></tr></table><br>
<a name="987242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I have discovered that I am successfully loading children of the mesh at load time and attempting to address the memory location of the child to an array.<br><br>However, the children of the mesh do not appear to inherit the co-ordinates of the parent mesh when it is positioned at run time, they simply stay at 0.0 which is causing a bit of a headache.<br><br>I've been inserting various debug to find out why the children do not seem to be inheriting the parent mesh attributes to no avail.  I check that the parent has children assocaited with it at load time with:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

;checking the mesh has children loaded with it:-

OutputChildNames( mesh_with_children(1) )

Function OutputChildNames( entity )
	
	Local i, count
	
	Print EntityName( entity )
	
	count = CountChildren( entity )
	For i = 1 To count
		OutputChildNames( GetChild( entity, i ) )
	Next
End Function


</textarea><br><br>Then I position the entities with:<br><br><pre class=code>
For x=1 To 7
	
	PositionEntity mesh_with_children(x),(-60+(x*30)),-20,DiceStartz
	
	RotateEntity mesh_with_children(x),180,0,0  ;will this change dice side up - no
	
Next

</pre><br><br>Then when I check the location of the main die mesh &amp; the associated childrens EntityY parameter what is returned is the main mesh outputs the co-ordinate which was set (-20), I have changed this to +20 now - however the children all reflect 0.0.  Is there some command I need to execute to ensure the children are all updated at the same time as the main mesh ?<br><br><pre class=code>
	
	
	dicetemp = FindChild(cube_mem(dice_x),"back_grp")
	
	Text 40,280,"Dice Number: "
	Text 180+(dice_x*60),280,dice_x
	
	Text 40,360+(Counts*44),"dicetemp EntityY = "
	Text 180+(dice_x*60),360,EntityY(dicetemp)
	
	
	Text 40,422,"top_side(Count) EntityY =    "
	Text 180+(dice_x*60),422,+EntityY( top_side(dice_x))
	;Text 40,444,"bottom_side(Count) EntityY = "+EntityY( bottom_side(dice_x))
	;Text 40,466,"left_side(Count) EntityY =   "+EntityY( left_side(dice_x))
	;Text 40,488,"right_side(Count) EntityY =  "+EntityY( right_side(dice_x))
	;Text 40,512,"back_side(Count) EntityY =   "+EntityY( back_side(dice_x))
	;Text 40,534,"front_side(Count) EntityY =  "+EntityY( front_side(dice_x))
	
	Text 40,310,"mesh_with_children(Count) EntityY = "
	Text 180+(dice_x*60),334,EntityY(mesh_with_children(dice_x))
	
	Flip
	
	WaitKey
	
Next

</pre> <br><br></td></tr></table><br>
<a name="987245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> So seeing as my mesh's children are misbehaving can someone please show me an example of code that will allow me to append 6 entities to each cube in question, then all I should hopefully have to do is check which entity is the highest.  Unless someone can tell me why my children are misbehaving.<br><br>I'm beginning to suspect I may have needed to do something else within UU3D to make the children attach to the main cube - or maybe some command in Blitz3D after I've found the children.<br><br>Or when a PositionEntity is called is it necessary to position the child meshes, I wouldn't have thought so....<br><br>useful threads:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=83868#946841" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=83868#946841</a><br><br>beginning to wonder If I am experiencing the same issue as LunC within the following thread:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=76352" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=76352</a><br><br>Which may explain why I keep getting 0.0 for my childs - if they are all centred on the middle of the parent entity.  How can I confirm all the children are slap bang in the middle of the parent as I suspect? <br><br></td></tr></table><br>
<a name="987287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have been working with the loop index code to determine which face is up &amp; I may've had an epiphany (;-)  <br><br>I think my logic which has resulted in the following debug results is sound, however it appears that after getchild is executed on a loaded mesh with respect to EntityY({child- side 3 for example}),1 then the subsequent EntityY on the remaining sides returns 0. I do not know the reason for this, but it causes an inherent problem with me trying to discern the different heights of different children of one cube.<br><br>I posted a modified version of Stevie's code below the image which displays the cubes sides debug info in the image. <br><br><br><br>I proved this by incrmeneting the loop original index value from 1 to 3, hence the reason why the third side of the cube is displaying a value for EntityY:<br><br>[EDIT]<br><br><br>I could not get an array to work inside a function so I'd to go all long hand:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Function WhichFaceIsUp$( Count )
	
	HighestSide$ = ""
	BestHeight# = 0
	
	For side = 3 To 6
		
		child = GetChild( mesh_with_children( Count ) , side )
		
		If Count=1
		
			If side=1 Then s1=EntityY( child, 1 )
			If side=2 Then s2=EntityY( child, 1 )
			If side=3 Then s3=EntityY( child, 1 )
			If side=4 Then s4=EntityY( child, 1 )
			If side=5 Then s5=EntityY( child, 1 )
			If side=6 Then s6=EntityY( child, 1 )
		
		EndIf
		
		If Count=2
			
			If side=1 Then a1=EntityY( child, 1 )
			If side=2 Then a2=EntityY( child, 1 )
			If side=3 Then a3=EntityY( child, 1 )
			If side=4 Then a4=EntityY( child, 1 )
			If side=5 Then a5=EntityY( child, 1 )
			If side=6 Then a6=EntityY( child, 1 )
			
		EndIf
		
		If Count=3
			
			If side=1 Then b1=EntityY( child, 1 )
			If side=2 Then b2=EntityY( child, 1 )
			If side=3 Then b3=EntityY( child, 1 )
			If side=4 Then b4=EntityY( child, 1 )
			If side=5 Then b5=EntityY( child, 1 )
			If side=6 Then b6=EntityY( child, 1 )
			
		EndIf
		
		If Count=4
			
			If side=1 Then c1=EntityY( child, 1 )
			If side=2 Then c2=EntityY( child, 1 )
			If side=3 Then c3=EntityY( child, 1 )
			If side=4 Then c4=EntityY( child, 1 )
			If side=5 Then c5=EntityY( child, 1 )
			If side=6 Then c6=EntityY( child, 1 )
			
		EndIf
		
		If Count=5
			
			If side=1 Then d1=EntityY( child, 1 )
			If side=2 Then d2=EntityY( child, 1 )
			If side=3 Then d3=EntityY( child, 1 )
			If side=4 Then d4=EntityY( child, 1 )
			If side=5 Then d5=EntityY( child, 1 )
			If side=6 Then d6=EntityY( child, 1 )
			
		EndIf
		
		If Count=6
			
			If side=1 Then e1=EntityY( child, 1 )
			If side=2 Then e2=EntityY( child, 1 )
			If side=3 Then e3=EntityY( child, 1 )
			If side=4 Then e4=EntityY( child, 1 )
			If side=5 Then e5=EntityY( child, 1 )
			If side=6 Then e6=EntityY( child, 1 )
			
		EndIf
		
		If EntityY( child, 1 ) &gt; BestHeight
			HighestSide = EntityName( child )
			BestHeight = EntityY( child, 1 )
			
			;Text 450,450+(Count*22),"Detected a highest side:"+side ;; Doh?
			;Text 330,400+(side*44)+(Count*22),"Detected a highest side:"+HighestSide+" On Dice: "+Count+" ht:"+BestHeight
			
			
			Text 10,422+(side*44),"top_side(Count) EntityY = "+EntityY( top_side(Count))
			Text 10,444+(side*44),"bottom_side(Count) EntityY = "+EntityY( bottom_side(Count))
			Text 10,466+(side*44),"left_side(Count) EntityY = "+EntityY( left_side(Count))
			Text 10,488+(side*44),"right_side(Count) EntityY = "+EntityY( right_side(Count))
			Text 10,510+(side*44),"back_side(Count) EntityY = "+EntityY( back_side(Count))
			Text 10,534+(side*44),"front_side(Count) EntityY = "+EntityY( front_side(Count))
			
			
			If Count=1
			
				Text 10,222,"The height of the children of Dice One 1:  "+s1+"  2: "+s2+"  3: "+s3+"  4: "+s4+"  5: "+s5+"  6: "+s6
			
			EndIf
			
			If Count=2
				
				Text 10,244,"The height of the children of Dice six 1: "+a1+"  2: "+a2+"  3: "+a3+"  4: "+a4+"  5: "+a5+"  6: "+a6
				
			EndIf
			
			If Count=3
				
				Text 10,266,"The height of the children of Dice two 1:  "+b1+"  2: "+b2+"  3: "+b3+"  4: "+b4+"  5: "+b5+"  6: "+b6
				
			EndIf
			
			If Count=4
				
				Text 10,288,"The height of the children of Dice three 1: "+c1+"  2: "+c2+"  3: "+c3+"  4: "+c4+"  5: "+c5+"  6: "+c6
				
			EndIf
			
			If Count=5
				
				Text 10,310,"The height of the children of Dice four 1: "+d1+"  2: "+d2+"  3: "+d3+"  4: "+d4+"  5: "+d5+"  6: "+d6
				
			EndIf
			
			If Count=6
				
				Text 10,332,"The height of the children of Dice five 1: "+e1+"  2: "+e2+"  3: "+e3+"  4: "+e4+"  5: "+e5+"  6: "+e6
				
			EndIf
			
			
			
			
			;bottom_side(Count) = FindChild(mesh_with_children(Count),"bottom_grp")
			;front_side(Count) = FindChild(mesh_with_children(Count),"front_grp")
			;left_side(Count) = FindChild(mesh_with_children(Count),"left_grp")
			;right_side(Count) = FindChild(mesh_with_children(Count),"right_grp")
			;back_side(Count) = FindChild(mesh_with_children(Count),"back_grp")
			
			;Flip  
			
			;WaitKey
			
		EndIf
		
	Next
	
	Return HighestSide
	
End Function

</textarea> <br><br></td></tr></table><br>
<a name="987302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> This<br><br>	Text 180+(dice_x*60),466,+(EntityY( bottom_side(dice_x), 1 ))<br><br>works better than this<br><br>        Text 180+(dice_x*60),466,+(EntityY( bottom_side(dice_x))<br><br>And has indeed revealed that my child entities appear to be slap bang in the centre of my cubes. <br><br></td></tr></table><br>
<a name="987325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a demo using normals of a standard blitz cube and no child entities.  I've used vertexcolor so that you can see what it's doing.<br><br>When you create and texture the cube in your modeller, you will know what value each side has so adjust the returned values to suit.<br><br><pre class=code>
Graphics3D 640,480,32,1

Global DICE = DICEcreate()
Global LIGHT = CreateLight()
Global CAM = CreateCamera()
PositionEntity CAM, 0,0,-5

While Not KeyHit(1)

	TurnEntity DICE, .05, 0, .05

	RenderWorld()
	
	Color 255,255,255
	Text 0,0, "The Dice Value is : " + DICEvalue( DICE )
	Color 255,0,0 : Text 0,30,  "Top:    1"
	Color 0,0,255 : Text 0,40,  "Bottom: 6"
	Color 0,255,255 : Text 0,50,"Right:  2"
	Color 255,255,0 : Text 0,60,"Left:   5"
	Color 0,255,0 : Text 0,70,  "Front:  3"
	Color 128,0,128 : Text 0,80,"Rear:   4"
	
	Flip
	
Wend

;====================================================================
;====================================================================
;====================================================================

Function DICEvalue( mesh )

	BestVert = - 1
	BestHeight# = 0

	s = GetSurface( mesh, 1 )
	For t = 0 To CountTriangles( s ) - 1 Step 2
		v0 = TriangleVertex( s, t, 0 )
		TFormNormal VertexNX( s, v0 ) , VertexNY( s, v0 ), VertexNZ( s, v0 ), mesh, 0
		If TFormedY() &gt; BestHeight
			BestHeight = TFormedY()
			BestVert = v0
		EndIf
	Next
	
	If VertexNY( s, BestVert ) = 1 Value = 1	;Top
	If VertexNY( s, BestVert ) = - 1 Value = 6 	;Bottom
	If VertexNX( s, BestVert ) = 1 Value = 2	;Right
	If VertexNX( s, BestVert ) = - 1 Value = 5	;Left
	If VertexNZ( s, BestVert ) = 1 Value = 3	;Front
	If VertexNZ( s, BestVert ) = - 1 Value = 4	;Rear

	Return Value

End Function

;====================================================================
;====================================================================
;====================================================================

Function DICEcreate()

	mesh = CreateCube()
	EntityFX mesh, 2+4

	s = GetSurface( mesh, 1 )
	For v = 0 To CountVertices(s)-1
		If VertexNY( s, v ) = 1 VertexColor s, v, 255,0,0
		If VertexNY( s, v ) = - 1 VertexColor s, v, 0,0,255
		If VertexNX( s, v ) = 1 VertexColor s, v, 0,255,255
		If VertexNX( s, v ) = - 1 VertexColor s, v, 255,255,0	
		If VertexNZ( s, v ) = 1 VertexColor s, v, 0,255,0
		If VertexNZ( s, v ) = - 1 VertexColor s, v, 128,0,128
	Next

	Return mesh

End Function
</pre> <br><br></td></tr></table><br>
<a name="987417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Stevie, I will give this a try shortly - I really appreciate the assistance. I was kind of reaching the banging my head against the monitor stage - hypothetically speaking (;-)<br><br>Have just tried it on the laptop - thanks Stevie, this will be priceless with helping to develop my knowledge with respect to entity manipulation.<br><br>I implemented the code within my main dice manipulator, alas when I assign any mesh to an ODE/mesh it loses the ability for info to be extracted regarding which side is up.  It has got me contemplating the nuances of applying gravitational math, that'll be physics to the cubes to retain the ability to establish which way is up.  Whilst the challenge of invoking some basic (erm, not so basic really) gravitational and rotational velocity to the cubes mathematically, I passed my O level physics but that was 22 years ago - I'm not up to it at the moment. <br><br></td></tr></table><br>
<a name="987807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was AFK, kind of. Thanks for what you said about the blitzcube. This was a nice finger exercise :) Something that can be finished in a few days, unlike fullfledged game projects, like fps or so.<br><br>Again, the cube problem. Let me suggest: when using pivots, since they are invisible, you may use CreateCube instead and alter it to CreatePivot later, when everything works. Just scale the cubes very small. Position them, parent them to the Dice, on the sides etc. They even don't have to be placed correctly on the surface, it's only important that they are aligned correctly. EG: <br><pre class=code>
dim piv(5)
for i=0 to 5
 piv(i)=createcube()
 scaleentity piv(i),0.1,0.1,0.1
 entityparent piv(i),dice
next

translateentity piv(0), 1, 0, 0
translateentity piv(1),-1, 0, 0
translateentity piv(2), 0, 1, 0
translateentity piv(3), 0,-1, 0
translateentity piv(4), 0, 0, 1
translateentity piv(5), 0, 0,-1
</pre><br>I don't know, if ODE works together with Blitzs Entity Hierarchies. But if ODE doesn't move the children, then you maybe have to cheat somehow. Not sure if UpdateWorld is required here.<br>Oh, and if your mesh is loaded with an offset center (you said something about -20 ??) then you may use a command like FitMesh to reset the center Pivot. And I think you don't have to use LoadAnimMesh (if you don't really need to identify the sides by their names - I don't know if this is mandatory. If the sides are always the same then I think it's not neccessary)<br><br>To check what side is up you only have to filter the topmost pivot out. eg:<br><br><pre class=code>
thisit=-1
top_y#=-1000

for i=0 to 5
 y#=entityy(piv(i),1)
if y&gt;top_y# then
  top_y#=y
  thisit=i
 endif
next
</pre><br>now the variable thisit should hold the number of the side that is up.<br>You may use an additional array, like dim piv_name$(5) and name them accordingly in the creation loop.<br><br>BTW if the eyes of the dice correspond with the indicies the way I created them - I guess no :) but I think you can fix that easily, with some fiddling.<br><br>Hope this helps. Stevies Solution looks pretty good. You have the choice :) <br><br></td></tr></table><br>
<a name="987944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> @jfk, thanks for the alternative suggestion - will try this out tomorrow now that I've resolved my minor problem where IDEal wouldn't start, no Microsoft application wanted to start with various cryptic error messages, my wifes camera wouldn't connect to the PC - needed to delete a file buried in the registry to permit the RPCServer to start.<br><br>So, it wasn't really a minor problem - due to the fact I'm studying programming with the Open University and my Msoft IDE would not start. Happy dayz ;)  Have had an initial stab at your pivot code - it certainly looks promising - thanks for the extra clarification from your initial post - the prospect of generating my own physics code was not overly appealing but now I've slept on it I do like a challenge!  I really hope I can attach some pivots &amp; cheat with the ODE mesh cubes - all in good time. <br><br></td></tr></table><br>
<a name="988045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've made an initial stab at understanding the pivot angle of attack, however I have discovered some confusing results. For some reason some pivots are never considered as 'highest', I need to do some more analysis.  Here is the code so far:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

;v2_ inc jfks pivots with slight modification
;to ease understanding of pivots

Graphics3D 640,480,32,2

Global DICE = DICEcreate()
Global LIGHT = CreateLight()
Global CAM = CreateCamera()
PositionEntity CAM, -5,0,-18

MoveEntity DICE, 0,5,0 ;this command exaggerates the difference in pivots co-ords during
                       ;rotation making it easier to analyse the results of pivots y co-ords

;initialise jfks dice

Dim piv(5)
For i=0 To 5
	piv(i)=CreateCube()
	ScaleEntity piv(i),0.1,0.1,0.1
	EntityParent piv(i),DICE
Next

TranslateEntity piv(0), 1, 0, 0
TranslateEntity piv(1),-1, 0, 0
TranslateEntity piv(2), 0, 1, 0
TranslateEntity piv(3), 0,-1, 0
TranslateEntity piv(4), 0, 0, 1
TranslateEntity piv(5), 0, 0,-1


Global thisit=-1
Global top_y#=-5
Dim yhistory(5)
Global currentmaxY#=0


;----------------end jfks dice


While Not KeyHit(1)
	
	TurnEntity DICE, .25, 0, .25
	
	
	
	
	RenderWorld()
	
	Color 255,255,255
	Text 0,0, "The Dice Value is : " + DICEvalue( DICE )
	Color 255,0,0 : Text 0,30,  "Top:    1"
	Color 0,0,255 : Text 0,40,  "Bottom: 6"
	Color 0,255,255 : Text 0,50,"Right:  2"
	Color 255,255,0 : Text 0,60,"Left:   5"
	Color 0,255,0 : Text 0,70,  "Front:  3"
	Color 128,0,128 : Text 0,80,"Rear:   4"
	
	
	;thisit=-1
	;top_y#=-1000
	
	For i=0 To 5
		y#=EntityY(piv(i),1)
		
		
		Text 20,(160+(i*22)), "y# for piv("+i+") is:"+y#
		
		
		If y&gt;top_y# Then
			top_y#=y       
			thisit=i
			
			;paint all pivot cubes white
			For whitewash=0 To 5
				EntityColor piv(whitewash),255,255,255
			Next
			
			
			;Attempt to piant thisit cube GREEN
			EntityColor piv(i),0,255,0;   just seems To be colouring blue?
			
			Flip
			
		EndIf
		
		;above code works for first half rotation of pivots, after
		;that point piv(3) remains as the pivot with the historic highest 
		; y co ordinate
		
		;update history of y co-ords
		yhistory(i)=EntityY(piv(i),1)
		;not using the above logic.... yet?
		
		;zero out the current maxy
		currentmaxY=0
		
		;establish a new top_y# once the max has been reached
		;attempt to color what the historic data thinks is top BLUE
		For a=0 To 5
			yy#=EntityY(piv(a),1)
			If yy&gt;currentmaxY# Then
				currentmaxY#=a
				;renew thisit
				thishigh=a
				
				;paint all pivot cubes white bar thisit highcube
				For whitewash=0 To 5
					;EntityColor piv(whitewash),255,255,255
						
					If whitewash&gt;thisit
						EntityColor piv(whitewash),255,255,255
					EndIf
					If whitewash&lt;thisit
						EntityColor piv(whitewash),255,255,255
					EndIf
				Next
				
				;record this high point for next iteration of loop
				yhistory(a)=yy
				
				EntityColor piv(thishigh),0,0,255
			EndIf
				
		Next
			
		
		
	Next
	
	
	Text 0,100,"jfk's dice topside is: "+thisit
	Text 0,130,"some historic data anal topside is:"+thishigh
	
	
	Flip
	
Wend

;====================================================================
;====================================================================
;====================================================================

Function DICEvalue( mesh )
	
	BestVert = - 1
	BestHeight# = 0
	
	s = GetSurface( mesh, 1 )
	For t = 0 To CountTriangles( s ) - 1 Step 2
		v0 = TriangleVertex( s, t, 0 )
		TFormNormal VertexNX( s, v0 ) , VertexNY( s, v0 ), VertexNZ( s, v0 ), mesh, 0
		If TFormedY() &gt; BestHeight
			BestHeight = TFormedY()
			BestVert = v0
		EndIf
	Next
	
	If VertexNY( s, BestVert ) = 1 Value = 1	;Top
		If VertexNY( s, BestVert ) = - 1 Value = 6 	;Bottom
			If VertexNX( s, BestVert ) = 1 Value = 2	;Right
				If VertexNX( s, BestVert ) = - 1 Value = 5	;Left
					If VertexNZ( s, BestVert ) = 1 Value = 3	;Front
						If VertexNZ( s, BestVert ) = - 1 Value = 4	;Rear
							
							Return Value
							
End Function

;====================================================================
;====================================================================
;====================================================================

Function DICEcreate()
	
	mesh = CreateCube()
	EntityFX mesh, 2+4
	
	s = GetSurface( mesh, 1 )
	For v = 0 To CountVertices(s)-1
		If VertexNY( s, v ) = 1 VertexColor s, v, 255,0,0
			If VertexNY( s, v ) = - 1 VertexColor s, v, 0,0,255
				If VertexNX( s, v ) = 1 VertexColor s, v, 0,255,255
					If VertexNX( s, v ) = - 1 VertexColor s, v, 255,255,0	
						If VertexNZ( s, v ) = 1 VertexColor s, v, 0,255,0
							If VertexNZ( s, v ) = - 1 VertexColor s, v, 128,0,128
							Next
							
							Return mesh
							
End Function




</textarea> <br><br></td></tr></table><br>
<a name="988046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Bp, you have a habbit of repeating code unnecessarily ;) <br><br>This is all you need:<br><br><pre class=code>
thisit=-1
	top_y#=-1000
	
	For i = 0 To 5
		y# = EntityY( piv(i) , 1 )
		If y &gt; top_y# Then
			top_y# = y       
			thisit = i
		EndIf
	Next
	
	For i = 0 To 5
		If thisit = i
			EntityColor piv(i), 255,0,0
		Else
			EntityColor piv(i), 255,255,255
		EndIf
	Next
		
</pre> <br><br></td></tr></table><br>
<a name="988052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Stevie, thanks, my debug has a way of running away with itself and ends up overcomplicating stuff.<br><br>That works a treat on both the cubes created &amp; the ODE/mesh cubes. ;)<br><br>I've just got to check out fitmesh to re-centre the model I am using.<br><br><img src="http://www.wishingwellsoftware.co.uk/reddice.jpg"> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
