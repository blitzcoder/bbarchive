<!DOCTYPE html><html lang="en" ><head ><title >How do I?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How do I?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How do I?</a><br><br>
<a name="536082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>I need one of my programmes to autorun on the startup/booting-up of a Win XP PC - does anyone know how to achieve this please?<br><br>Thanks<br><br>IPete2. <br><br></td></tr></table><br>
<a name="536085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, use the registry editor functions, look in the code archives, and add that key:<br><br>HKEY_LOCALMACHINE\Software\Microsoft\windows\currentversion\run\<br><br>here you add your app:<br><br>myapp: c:\myapp\myapp.exe<br><br>Cheers. <br><br></td></tr></table><br>
<a name="536087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neochrome</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> drag a shortcut to the startup on the start menu? <br><br></td></tr></table><br>
<a name="536089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey KuRiX<br><br>thanks man!  You are a star! I'll go and look for it now...<br><br><br>I tried tha Neo, it just sat there and looked at me - all sad and quiet.  Lol!<br><br><br>IPete2. <br><br></td></tr></table><br>
<a name="536090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have a copy of the registry functions anywhere please? The link in the code archives is down.  <br><br>Please help - ta!<br><br>IPete2. <br><br></td></tr></table><br>
<a name="536160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>HKEY_LOCALMACHINE\Software\Microsoft\currentversion\run\<br> <br></div><br>Shouldn't that be <br><br>"HKEY_LOCALMACHINE\Software\Microsoft\Windows\currentversion\run\" Edit: Kurix fixed his post.<br>?<br><br><br>Also, Creating a SHORTCUT to the program you want to run, in the start menu under "startup" will work- If not, you have issues :P <br><br></td></tr></table><br>
<a name="536172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, cygnus is right, i forgot the windows... hehe. I have edited my post :D<br><br>And take care, because you need to be an administrator to access localmachine. If not, try current user. <br><br></td></tr></table><br>
<a name="536226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys,<br><br>I managed to get into the regedit and set it all up.  But I keep getting a MAV, and its only when it runs as an auto boot - if I double click on the runtime it works just fine.<br><br>Any thoughts please would be great!<br><br>Ipete2. <br><br></td></tr></table><br>
<a name="536259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It might be something to do with the path.<br><br>I find I need something like...<br><br><pre class=code>
 correctdir=FileType  ("filethatshouldbethere.file")

 if not correctdir then ChangeDir (SystemProperty$ ("AppDir"))

</pre><br><br>...at the start of my program.  If the path isn't set up right this should correct it. <br><br></td></tr></table><br>
<a name="536426"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pete, I think John Pickford is probably right. You may find you have to use CurrentDir$() then add that to all your loading paths.<br><br>I _have_ come across certain (Windowsey) situations that suggest that Windows/Explorer and the Desktop all know what the desired path is, and Explorer effectively does a ChangeDir before running the exe, but that change appears to be local to the Desktop, and not global as us oldtimers were used to.<br><br>As I said, when in doubt get/set your own paths, and I _do_ mean absolute, not just relative to the exe. <br><br></td></tr></table><br>
<a name="536427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll try that tomorrow and report back.<br><br>cool thanks guys<br><br>IPete2. <br><br></td></tr></table><br>
<a name="536463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Damn, Pete. I just reread this thread and now I remember that I have had a similar problem to the one you describe:-<br>you can double-click the shortcut in the Startup folder OK, but it's actually the Auto-run (on the same shortcut!) which causes the problem.<br><br>I don't think I ever found a way around this, but at least I can confirm that it's not your imagination.<br><br>I can only suggest that you do some pretty extensive inserting of MessageBoxes (BlitzSys dll is great for that) or print to the screen+WaitKey() so that you can get CurrentDir$() at various stages of running, etc and see it as it's happening. <br><br></td></tr></table><br>
<a name="536542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just have the following as the first line of code:<br><pre class=code>  ;ChangeDir SystemProperty("appdir")</pre><br>which I un-comment when compiling a standalone. <br><br></td></tr></table><br>
<a name="536701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> My method copes with both situations so don't need to uncomment anything or change loading paths in the game. <br><br></td></tr></table><br>
<a name="537014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I must be doing something else wrong somewhere - it just will not work as an autorun file from boot up!  <br><br>If I double click on it or it's short cut there is no problem, but trying to make it autorun from boot - it just wont do it - even with the above code in place.<br><br><br>Ah well... Thanks for trying people.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="537048"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can I state the obvious (I don't think you're doing anything wrong, Pete) - I think that the Autorun part of Windows works differently from normal pathing/execing.<br><br>Don't you just love Microsoft....<br><br>(Personally I think that the MS Exec-er code looks inside the exe, sees that it wasn't compiled using an MS compiler, doesn't use a menu, wants to go full-screen, and it just says 'Screw that!')<br><br>Seriously I've noticed that the old 16-bit desktop apps I've written (docking-bar etc) are the last things to be run at bootup; I mean the Desktop's been up for 20 secs before they appear - I guess MS want all their own (hidden) apps and processes well started before they'll take a chance on something so radical as a 16-bit app or a Blitz app. <br><br></td></tr></table><br>
<a name="537050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you change the filename to a file that exists in your application folder? <br><br></td></tr></table><br>
<a name="537068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> How will that help? Even if the file doesn't exist, the directory is changed to "AppDir", anyway. <br><br></td></tr></table><br>
<a name="537069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, why do you check for a file JP? You might as well just <i>changedir</i> to the correct directory regardless of whether it's already set or not, surely? It's a win-win situation.<br><br>Edit: Great minds... <br><br></td></tr></table><br>
<a name="537179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> @JP<br><br>Yes, I changed it to my prog name plus exe as in:<br><br>"ssgb.exe"<br><br>Edit:<br>Doh! I just found out that I should have typed "AppDir" and not hard code the actual directory path myself - oops!<br><br>@John et al thanks for trying.  My client may not like the situation for now - but until I get this to work how I want it I have no choice, it is installation day. So after today I'll have to do remote testing.<br><br>Regard,<br><br>IPete2.<br><br>PS When I get on site - I'll try and change that bit of JP's code to see if that works on my app now.  I shall be back later tonight - hopefully with piccies! :) <br><br></td></tr></table><br>
<a name="537199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Sorry, why do you check for a file JP? You might as well just changedir to the correct directory regardless of whether it's already set or not, surely? It's a win-win situation. <br></div><br><br>Because when you run your code from the IDE Appdir will be the Blitz dir not your game folder.  It's written this way so you can just forget about it rather than having different code depending on how you run it. <br><br></td></tr></table><br>
<a name="537697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, I see. But, you know...<br><br><pre class=code>
If Upper(SystemProperty("appdir"))="C:\PROGRAM FILES\BLITZ3D\BIN\" Then RUNFROMIDE=True
</pre><br><br>I did unearth something a bit odd, though. I compiled the following code and dragged the resulting exe to the startup folder, creating a shortcut...<br><br><pre class=code>
Print "Current Dir: "+CurrentDir$()
Print "App Dir    : "+SystemProperty("appdir")
WaitKey
</pre><br><br>...and both values came out correct (when it auto-ran). Unless different Windows releases operate differently I don't see where the path error can be coming from. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
