<!DOCTYPE html><html lang="en" ><head ><title >Move stuff, Save positions, Move again, then Move back to saved positions...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Move stuff, Save positions, Move again, then Move back to saved positions...</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Move stuff, Save positions, Move again, then Move back to saved positions...</a><br><br>
<a name="1337122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What am I doing wrong here?  I need to be able to move stuff around on the screen, save the positions X, Y, Z, Pitch, Yaw, and Roll in a Type field.  Then I need to loop back thru the Type field and have my stuff move back to the saved positions.  I am having troubles with the Pitch, Yaw, and Roll.  Not all of the models are rotating to the saved positions and I am not sure why.  Can anyone see what I am doing wrong?<br><br>Below is some example code.  I can provide more if it helps.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

	;let's save the current step...S key
	If KeyHit(31) And ItemToMove$ = "part" Then
		For b.BendData = Each BendData
			If b\SEQ% = CurrentStep% Then
				b\XL# = XLeft#
				b\XR# = XRight#
				b\ZL# = ZLeft#
				b\ZR# = ZRight#
				b\RL# = RLeft#
				b\RR# = RRight#
				b\PartX# = EntityX#(part)
				b\PartY# = EntityY#(part)
				b\PartZ# = EntityZ#(part)
				b\PartPitch# = EntityPitch#(part)
				b\PartYaw# = EntityYaw#(part)
				b\PartRoll# = EntityRoll#(part)
			End If
		Next
	End If



		If SimulateIt = 1 Then
			For b.BendData = Each BendData
				If b\SEQ% = CurrentStep% Then
					;NewXL# = (Float(b\XL$)  + Float(b\FO$) + Float(b\LGA$)) - XLeft#
					NewXL# = b\XL# - XLeft#
					XLeft# = XLeft# + NewXL#
					TranslateEntity LeftGageAssembly, 0, 0, NewXL#, True
					TranslateEntity LeftGageTower, 0, 0, NewXL#, True
		
					;NewXR# = (Float(b\XR$) + Float(b\FO$) + Float(b\RGA$)) - XRight# 
					NewXR# = b\XR# - XRight# 
					XRight# = XRight# + NewXR#
					TranslateEntity RightGageAssembly, 0, 0, NewXR#, True
					TranslateEntity RightGageTower, 0, 0, NewXR#, True
					
					NewZL# = b\ZL# - ZLeft#
					TranslateEntity LeftGageAssembly, NewZL#, 0, 0, True
					TranslateEntity LeftGageTower, NewZL#, 0, 0, True
					TranslateEntity LeftGageBase, NewZL#, 0, 0, True
					ZLeft# = ZLeft# + NewZL#	
									
					NewZR# = b\ZR# - ZRight#
					TranslateEntity RightGageAssembly, NewZR#, 0, 0, True
					TranslateEntity RightGageTower, NewZR#, 0, 0, True
					TranslateEntity RightGageBase, NewZR#, 0, 0, True
					ZRight# = ZRight# + NewZR#
		
					NewRL# = b\RL# - RLeft#
					TranslateEntity LeftGageAssembly, 0, NewRL#, 0, True
					RLeft# = RLeft# + NewRL#	
									
					NewRR# = b\RR# - RRight#
					TranslateEntity RightGageAssembly, 0, NewRR#, 0, True
					RRight# = RRight# + NewRR#
	
					PositionEntity Part, b\PartX#, b\PartY#, b\PartZ#
					RotateEntity Part, b\PartPitch#, b\PartYaw#, b\PartRoll#
					
					Exit
				End If
			Next
		End If


</textarea> <br><br></td></tr></table><br>
<a name="1337149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why do you have Exit near the bottom? With that, you will only move one entity, then exit the For/Each loop and not process any more entities. <br><br></td></tr></table><br>
<a name="1337154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> My thinking is that once I find the entity that I want to change, I can exit the loop to save time searching for entities that I don't intend to change.<br><br>Basically, this program is not a game.  I am simulating a machine that bends sheet metal.  The user positions sheet metal parts, tooling, and machine stops at certain locations for each bend that is on a sheet metal part.  Once the user has set all of these things for each bend, I want to provide a way for the user to "replay" all of the positions, one at a time to see his work.  Once satisfied, the user can output all of these positions and I will write some code to take these positions and format a file that will be used to run the actual machine on the shop floor to make the parts.<br><br>I think this is a creative way to use Blitz3D.  I have something wrong that is causing my "part" not to rotate to the correct orientation when I replay the steps.  I am sure it is something simple.  I just have not found the problem yet.  I am not a programmer.  I am just trying to improve the operations in my shop to attempt to get more done in the day with less effort.<br><br>Thanks,<br>David <br><br></td></tr></table><br>
<a name="1337155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps parent/child relationships are getting confused. That's vague but I can't think of anything else. <br><br></td></tr></table><br>
<a name="1337157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK.  I'll have another look.  I am sure that I have something simple messed up.  Just can't find it right now.  I have a bunch of code junked together without a lot of organization.  I have been coming up with ideas, writing some code and testing.  I need to take some time to clean up my code and simplify things a bit.  I'll walk away for a while, relax and come back to this problem later.<br><br>Am I thinking about this correctly?  I want to allow the user to move things around however he wants.  Then, I want to allow the user to "SAVE" all of these positions.  To save, I am looking at each object, getting the X, Y, Z, Pitch, Yaw, and Roll values for each object and storing them.  Later, I can ask the user what "STEP" he wants to view.  Then, I look for this "STEP" in my TYPE data and move everything back to the X, Y, Z, Pitch, Yaw, and Roll locations.  That should work...right? <br><br></td></tr></table><br>
<a name="1337166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> This may help : <br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2944" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2944</a><br>(old code !!!) <br><br></td></tr></table><br>
<a name="1337167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am having the same problem with your code RemiD.  I have something messed up.  I am not sure if it is helpful or not without my models but I am listing my entire code below if anyone has the patience to find the needle in my haystack.<br><br>It is a little embarrassing to show my ugly code and lack of knowledge but I cannot find the problem.  The problem is when I save the "part" object locations and then try to move the "part" back later, the part does not go back to the same rotation and I cannot see how to fix it.  Seems like a simple thing to do but my code or logic has a mistake somewhere.  Thanks to anyone for having a look.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 1200,800
  AppTitle "ALT-RotCW, Ctrl-RotCCW, F-Flip, A-AutoLocGage, F1-LftVw, F2-TopVw, F3-FrntVw, F4-RtVw"
  SetBuffer BackBuffer()

  Global ItemToMove$ = "camera"
  Global ZoomAmount# = .015
  Global XLeft# = 2.435
  Global XRight# = 2.435
  Global ZLeft# = -1.5
  Global ZRight# = 1.5
  Global RLeft# = 0.020
  Global RRight# = 0.020
  Global PartRotation# = 0
  Global MaterialType$ = "14 mild"
  Global MaterialThickness# = .054
  Global CurrentStep%

  tex1 = LoadTexture("C:\Temp\gray.jpg") 
  tex2 = LoadTexture("C:\Temp\darkgray.jpg") 
  tex3 = LoadTexture("C:\Temp\red.jpg") 
  tex4 = LoadTexture("C:\Temp\DarkBlue.jpg") 


  ;Let's load the part now...
  ;Part1Pivot = CreatePivot()
  ;PositionEntity Part1Pivot, 0, 0, 0
  ;part=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\49-274911-000a.3DS", Part1Pivot)
  part=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\49-274911-000a_flat.3DS")
  PositionEntity part, .165, 8, -.93
  RotateEntity part, -90,180,0
  EntityTexture part, tex3
  EntityAlpha part, .75	;.5
  EntityPickMode part, 2
  NameEntity part, "part"
  ScaleMesh part, .0393700787, .0393700787, .0393700787	;CAD files are in mm, I am working in inches, so let's scale the CAD models
  MaterialThickness# = MeshDepth#(part)
  

  ;Let's load the ram now... 
  ram=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformram3.3DS")
  EntityColor ram, 75, 75, 75
  PositionEntity ram, .165, 8, -.93
  RotateEntity ram, -90,180,0
  EntityTexture ram, tex1
  EntityPickMode ram, 2
  NameEntity ram, "ram"

  ;Let's load the bed now...
  bed=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformbed2.3DS")
  EntityColor bed, 75, 75, 75
  PositionEntity bed, 0,8.83,0
  RotateEntity bed, 90,0,0
  EntityTexture bed, tex1
  EntityAlpha bed, 1

  ;Let's load the left gauge tower now...
  LeftGageTower=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformgagetower.3DS")
  EntityColor LeftGageTower, 75, 75, 75
  PositionEntity LeftGageTower, -8.25,-8,9.8
  RotateEntity LeftGageTower, 180,0,0
  EntityTexture LeftGageTower, tex1

  ;Let's load the left backgauge base now...
  LeftGageBase=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformgagebase.3DS")
  EntityColor LeftGageBase, 75, 75, 75
  PositionEntity LeftGageBase, -8.25,-11.6,6
  RotateEntity LeftGageBase, 180,0,0
  EntityTexture LeftGageBase, tex1

  ;Let's load the left gauge assembly now...
  LeftGageAssembly=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformleftgageassembly.3DS")
  EntityColor LeftGageAssembly, 75, 75, 75
  PositionEntity LeftGageAssembly, -30.13,-40.91,-12
  RotateEntity LeftGageAssembly, 270,0,0
  EntityTexture LeftGageAssembly, tex4
  EntityPickMode LeftGageAssembly, 2
  NameEntity LeftGageAssembly, "leftgage"

  ;Let's load the right gauge tower now...
  RightGageTower=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformgagetower.3DS")
  EntityColor RightGageTower, 75, 75, 75
  PositionEntity RightGageTower, .78,-8,9.8
  RotateEntity RightGageTower, 180,0,0
  EntityTexture RightGageTower, tex1

  ;Let's load the right backgauge base now...
  RightGageBase=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformgagebase.3DS")
  EntityColor RightGageBase, 75, 75, 75
  PositionEntity RightGageBase, .78,-11.6,6
  RotateEntity RightGageBase, 180,0,0
  EntityTexture RightGageBase, tex1

  ;Let's load the right gauge assembly now...
  RightGageAssembly=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\autoformrightgageassembly.3DS")
  EntityColor RightGageAssembly, 75, 75, 75
  PositionEntity RightGageAssembly, -89.85,-40.91,-12
  RotateEntity RightGageAssembly, 270,0,0
  EntityTexture RightGageAssembly, tex4
  EntityPickMode RightGageAssembly, 2
  NameEntity RightGageAssembly, "rightgage"

  ;Let's load the LTool now...
  LTool=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\30013.3DS")
  Target# = 3
  ScaleMesh LTool, 1, Target# / MeshHeight#(LTool), 1
  PositionEntity LTool, 0,1.305,.008
  RotateEntity LTool, -90,-90,0
  EntityPickMode LTool, 2
  NameEntity LTool, "ltool"
  EntityColor LTool, 20, 20, 20
  HideEntity LTool

  Type LowerTool
		Field Entity			;Mesh
		Field Id$				;Tool Id
		Field Name$         	;Tool Number
		Field Length#   		;Tool Length
		Field Location# 		;Tool Location on bed (centerline of machine to rigth edge of tool)
		Field Reversed$     	;Tool reversed (YES Or NO)
  End Type

  For I = 1 To 1
	c.LowerTool= New LowerTool
	c\entity = CopyMesh(LTool)
	c\Id$ = "MT030013000D"
	c\Name$ = "LTool-" + I
	c\Length# = 3 ;Input("What length?")
	c\Location# = I * 6
	c\Reversed$ = "No"
	ScaleMesh c\entity, 1, (c\Length# / MeshHeight(LTool)), 1
	TurnEntity c\entity, -90, 90, 90, True
	PositionEntity c\entity, c\Location#,1.305, 0
  	RotateEntity c\entity, -90,-90,0
  	EntityPickMode c\entity, 2
  	NameEntity c\entity, "LTool-" + I
	EntityColor c\entity, 20, 20, 20
  Next

  ;Let's load the UTool now...
  UTool=LoadMesh("C:\Users\hollifd\Desktop\PMPBS\30017.3DS")
  Target# = 3
  ScaleMesh UTool, 1, Target# / MeshHeight#(UTool), 1
  PositionEntity UTool, 0,4.385,.01
  RotateEntity UTool, 270,180,90
  EntityParent UTool, ram
  EntityPickMode UTool, 2
  NameEntity UTool, "utool"
  EntityColor UTool, 20, 20, 20
  HideEntity UTool

  Type UpperTool
		Field Entity			;Mesh
		Field Id$				;Tool Id
		Field Name$         	;Tool Number
		Field Length#   		;Tool Length
		Field Location# 		;Tool Location on bed (centerline of machine to rigth edge of tool)
		Field Reversed$     	;Tool reversed (YES Or NO)
  End Type

  For I = 1 To 1
	u.UpperTool= New UpperTool
	u\entity = CopyMesh(UTool)
	u\Id$ = "MT030017000P"
	u\Name$ = "UTool-" + I
	u\Length# = 3 ;Input("What length?")
	u\Location# = I * 6
	u\Reversed$ = "No"
	ScaleMesh u\entity, 1, (u\Length# / MeshHeight(UTool)), 1
	TurnEntity u\entity, -90, 90, 90, True
	PositionEntity u\entity, u\Location#,4.385, .01
  	RotateEntity u\entity, 270, 180, 90
  	EntityPickMode u\entity, 2
    EntityParent u\entity, ram  	
    NameEntity u\entity, "UTool-" + I
	EntityColor u\entity, 20, 20, 20
  Next

  ;Let's create a camera now...
  camera=CreateCamera()
  PositionEntity camera, 0,0, -200
  PointEntity camera, LTool  
  CameraProjMode camera, 2
  CameraZoom camera, ZoomAmount#

  ;Let's create a light now...
  light= CreateLight(3)
  PositionEntity light, 0, 40, -300
  PointEntity light, bed

  ;Let's create a second light now...
  light2= CreateLight(3)
  PositionEntity light2, 0, 40, 300
  PointEntity light2, bed

  AmbientLight 255, 255, 255 


While Not MeshesIntersect(part, LTool)
	TranslateEntity part, 0, -.1, 0, True
Wend


Type BendData
	Field Entity	;Mesh
	Field Name$		;Mesh name
	Field SEQ%		;Bend sequence number
	Field XL#		;XLeft
	Field XR#		;XRight
	Field LGA#		;Left gage allowance
	Field RGA#		;Right gage allowance
	Field FO#		;Finger offset
	Field ZL#		;ZLeft
	Field ZR#		;ZRight
	Field RL#		;RLeft
	Field RR#		;RRight
	Field Angle#	;Angle of bend
	Field BL#		;Bend length
	Field Tonnage#	;Tonnage
	Field PartX#	;PartX
	Field PartY#	;PartY
	Field PartZ#	;PartZ
	Field PartPitch#;PartPitch
	Field PartYaw#	;Partyaw
	Field PartRoll# ;PartRoll
End Type

;ImportBendData()

While Not KeyHit(1)
	CameraClsColor camera, 255, 255, 255
	Cls
	SetBuffer BackBuffer()

	If KeyDown(23) Then	;I key 
		If ItemToMove$ = "leftgage"  Then
			TranslateEntity LeftGageAssembly, 0, -.001, 0, True
			TranslateEntity LeftGageTower, 0, -.001, 0, True
			RLeft# = RLeft# -.001
		End If
		If ItemToMove$ = "rightgage" Then
			TranslateEntity RightGageAssembly, 0, -.001, 0, True
			TranslateEntity RightGageTower, 0, -.001, 0, True
			RRight# = RRight# - .001
		End If
		If ItemToMove$ = "part" Then
			TranslateEntity part, 0, -.02, 0, True
		End If
	End If

	If KeyDown(24) Then	;O key 
		If ItemToMove$ = "leftgage"  Then
			TranslateEntity LeftGageAssembly, 0, .01, 0, True
			TranslateEntity LeftGageTower, 0, .01, 0, True
			RLeft# = RLeft# + .01
		End If
		If ItemToMove$ = "rightgage" Then
			TranslateEntity RightGageAssembly, 0, .01, 0, True
			TranslateEntity RightGageTower, 0, .01, 0, True
			RRight# = RRight# + .01
		End If
		If ItemToMove$ = "part" Then
			TranslateEntity part, 0, .02, 0, True
		End If
	End If	
	
	;Change to LEFT view...;F1 key
	If KeyHit(59) Then	
		PositionEntity camera, -70, 0, 0
		TranslateEntity camera, 0, 1.25, 0
		PointEntity camera, LTool
		ShowEntity ram
	End If

	;Change to TOP view...	;F2 key
	If KeyHit(60) Then
		PositionEntity camera, 0, 50, 0
		PointEntity camera, bed
		ZoomAmount# = ZoomAmount# + .03
		HideEntity ram
	End If

	;Change to FRONT view...F3 key
	If KeyHit(61) Then
		PositionEntity camera, 0, 20, -70
		;TurnEntity camera, 45, 0, 0
		PointEntity camera, LTool
		ShowEntity ram
	End If	
	
	;Change to RIGHT view...F4 key
	If KeyHit(62) Then
		PositionEntity camera, 70, 0, 0
		TranslateEntity camera, 0, 1.3, 0
		PointEntity camera, LTool
		ShowEntity ram
	End If	
	
	;up key	
	If KeyDown(200) Then	
		If Instr(ItemToMove$, "Bend") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "bend"
		End If
		
		Select ItemToMove$
			Case "ram"
				TranslateEntity ram, 0, .1, 0, True
			Case "leftgage"
				TranslateEntity LeftGageAssembly, 0, 0, .05, True
				TranslateEntity LeftGageTower, 0, 0, .05, True
				XLeft# = XLeft# + .05
			Case "rightgage"
				TranslateEntity RightGageAssembly, 0, 0, .05, True
				TranslateEntity RightGageTower, 0, 0, .05, True
				XRight# = XRight# + .05
			Case "camera"
				TranslateEntity camera, 0, .125, 0,True
				TurnEntity camera, .05, 0, 0
			Case "part"
				TranslateEntity part, 0, 0, .1, True
			Case "bend"
				ItemToMove$ = SaveItemToMove$
				For b.BendData = Each BendData
					If b\Name$ = ItemToMove$ Then
						TranslateEntity b\Entity, 0, .01, 0
						Delay 50
						Exit
					End If
				Next
		End Select
	End If
	
	;down key
	If KeyDown(208) Then	
		
		If Instr(ItemToMove$, "Bend") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "bend"
		End If
		
		Select ItemToMove$

			
			Case "ram"
				TranslateEntity ram, 0,-.1,0, True
				While MeshesIntersect(UTool, LTool)
					TranslateEntity ram, 0, 0.001, 0, True
				Wend
			Case "leftgage"
				If XLeft# &gt;= .001 Then
					TranslateEntity LeftGageAssembly, 0, 0, -.001, True
					TranslateEntity LeftGageTower, 0, 0, -.001, True
					XLeft# = XLeft# - .001
				Else
					XLeft# = 0
				End If
			Case "rightgage"
				If XRight# &gt;= .001 Then
					TranslateEntity RightGageAssembly, 0, 0, -.001, True
					TranslateEntity RightGageTower, 0, 0, -.001, True
					XRight# = XRight# - .001
				Else
					XRight# = 0
				End If
			Case "camera"
				TranslateEntity camera, 0, -.125, 0, True
				TurnEntity camera, -.05, 0, 0
			Case "part"
				TranslateEntity part, 0, 0, -.1, True
				
			Case "bend"
				ItemToMove$ = SaveItemToMove$
				For b.BendData = Each BendData
					If b\Name$ = ItemToMove$ Then
						;ScaleMesh b\Entity, ((MeshWidth(b\Entity) - .01) / MeshWidth(b\Entity)), 1, 1	
						;TranslateEntity b\Entity, .005, 0, 0, True	
						;b\BL# = MeshWidth#(b\Entity)
						TranslateEntity b\Entity, 0, -.01, 0
						Delay 50
						Exit
					End If
				Next

			End Select
	End If
	
	;left key
	If KeyDown(203) Then	
		
		If Instr(ItemToMove$, "Bend") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "bend"
		End If		
		
		Select ItemToMove$
			Case "leftgage"
				TranslateEntity LeftGageAssembly, -.01, 0, 0, True
				TranslateEntity LeftGageTower, -.01, 0, 0, True
				TranslateEntity LeftGageBase, -.01, 0, 0, True
				ZLeft# = ZLeft# - .01
			Case "rightgage"
				TranslateEntity RightGageAssembly, -.01, 0, 0, True
				TranslateEntity RightGageTower, -0.01, 0, 0, True
				TranslateEntity RightGageBase, -0.01, 0, 0, True
				ZRight# = ZRight# - .01
			;Case "ltool"
			;	TranslateEntity LTool, -.125, 0, 0, True
			;	Delay 75
			;Case "utool"
			;	TranslateEntity UTool, -.125, 0, 0, True
			;	Delay 75
			Case "camera"
				TranslateEntity camera, -.125, 0, 0, True
			Case "part"
				TranslateEntity part, -.1, 0, 0,True
			Case "bend"
				ItemToMove$ = SaveItemToMove$
				For b.BendData = Each BendData
					If b\Name$ = ItemToMove$ Then
						ScaleMesh b\Entity, ((MeshWidth(b\Entity) + .01) / MeshWidth(b\Entity)), 1, 1	
						TranslateEntity b\Entity, -.005, 0, 0, True	
						b\BL# = MeshWidth#(b\Entity)
						;TranslateEntity b\Entity, -.01, 0, 0, True	
						Exit
					End If
				Next					
		End Select
	End If
	
	;right key
	If KeyDown(205) Then	
		
		If Instr(ItemToMove$, "Bend") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "bend"
		End If
				
		Select ItemToMove$
			Case "leftgage"
				TranslateEntity LeftGageAssembly, .01, 0, 0, True
				TranslateEntity LeftGageTower, .01, 0, 0, True
				TranslateEntity LeftGageBase, .01, 0, 0, True
				ZLeft# = ZLeft# + .01			
			Case "rightgage"
				TranslateEntity RightGageAssembly, .01, 0, 0, True
				TranslateEntity RightGageTower, .01, 0, 0, True
				TranslateEntity RightGageBase, .01, 0, 0, True
				ZRight# = ZRight# + .01
			;Case "ltool"
			;	TranslateEntity LTool, .125, 0, 0, True
			;	Delay 75
			;Case "utool"
			;	TranslateEntity UTool, .125, 0, 0, True
			;	Delay 75
			Case "camera"
				TranslateEntity camera, .125, 0, 0, True
			Case "part"
				TranslateEntity part, .1, 0, 0, True
				
			Case "bend"
				ItemToMove$ = SaveItemToMove$
				For b.BendData = Each BendData
					If b\Name$ = ItemToMove$ Then
						ScaleMesh b\Entity, ((MeshWidth(b\Entity) - .01) / MeshWidth(b\Entity)), 1, 1	
						TranslateEntity b\Entity, +.005, 0, 0, True	
						b\BL# = MeshWidth#(b\Entity)
						;TranslateEntity b\Entity, .01, 0, 0, True	
						Exit
					End If
				Next			

		End Select
	End If
	

	;Let's get the picked item...
	If MouseHit(3)=True Then 
		CameraPick(camera,MouseX(),MouseY())
	End If
	 
	If MouseDown(1) = True Then
		If Instr(ItemToMove$, "LTool") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "ltool"
		End If
		If Instr(ItemToMove$, "UTool") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "utool"
		End If

		If Instr(ItemToMove$, "Bend") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "bend"
		End If	
				
		Select ItemToMove$
			Case "part"
			TranslateEntity part, -.01, 0, 0, True

		Case "leftgage"
			TranslateEntity LeftGageAssembly, -.05, 0, 0, True
			TranslateEntity LeftGageTower, -.05, 0, 0, True
			TranslateEntity LeftGageBase, -.05, 0, 0, True
			ZLeft# = ZLeft# - .05
		Case "rightgage"
			TranslateEntity RightGageAssembly, -.05, 0, 0, True
			TranslateEntity RightGageTower, -.05, 0, 0, True
			TranslateEntity RightGageBase, -.05, 0, 0, True
			ZRight# = ZRight# - .05	
		Case "utool"
			ItemToMove$ = SaveItemToMove$
			For u.UpperTool = Each UpperTool
				If u\Name$ = ItemToMove$ Then
					TranslateEntity u\entity, -.125, 0, 0, True
					Delay 75
					Exit
				EndIf
			Next
		Case "ltool"
			ItemToMove$ = SaveItemToMove$
			For c.LowerTool = Each LowerTool
				If c\Name$ = ItemToMove$ Then
					TranslateEntity c\entity, -.125, 0, 0, True
					Delay 75
					Exit
				EndIf
			Next

		Case "ram"
			TranslateEntity ram, 0, -.1, 0, True
			If MeshesIntersect (UTool, LTool) Then
				While MeshesIntersect(UTool, LTool)
					TranslateEntity ram, 0, 0.001, 0, True
				Wend
			End If		
		
		Case "camera"
			TranslateEntity camera, -.5, 0, 0, True
			
		Case "bend"
			ItemToMove$ = SaveItemToMove$
			For b.BendData = Each BendData
				If b\Name$ = ItemToMove$ Then
					TranslateEntity b\Entity, -.005, 0, 0, True
					Exit
				End If
			Next
			
		End Select	
	End If
	If MouseDown(2) = True Then
		If Instr(ItemToMove$, "LTool") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "ltool"
		End If
		If Instr(ItemToMove$, "UTool") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "utool"
		End If
		If Instr(Upper(ItemToMove$), "BEND") Then
			SaveItemToMove$ = ItemToMove$
			ItemToMove$ = "bend"
		End If					
		Select ItemToMove$
			Case "part"
			TranslateEntity part, .01, 0, 0, True

			Case "leftgage"
			TranslateEntity LeftGageAssembly, .05, 0, 0, True
			TranslateEntity LeftGageTower, .05, 0, 0, True
			TranslateEntity LeftGageBase, .05, 0, 0, True
			ZLeft# = ZLeft# + .05

		Case "rightgage"
			TranslateEntity RightGageAssembly, .05, 0, 0, True
			TranslateEntity RightGageTower, .05, 0, 0, True
			TranslateEntity RightGageBase, .05, 0, 0, True
			ZRight# = ZRight# + .05		
		Case "utool"
			ItemToMove$ = SaveItemToMove$
			For u.UpperTool = Each UpperTool
				If u\Name$ = ItemToMove$ Then
					TranslateEntity u\entity, .125, 0, 0, True
					Delay 75
					Exit
				EndIf
			Next
		Case "ltool"
			ItemToMove$ = SaveItemToMove$
			For c.LowerTool = Each LowerTool
				If c\Name$ = ItemToMove$ Then
					TranslateEntity c\entity, .125, 0, 0, True
					Delay 75
					Exit
				EndIf
			Next
		Case "ram"
			TranslateEntity ram, 0, .1, 0, True
			
		Case "camera"
			TranslateEntity camera, .5, 0, 0, True
		
		Case "bend"
			ItemToMove$ = SaveItemToMove$
			For b.BendData = Each BendData
				If b\Name$ = ItemToMove$ Then
					TranslateEntity b\Entity, .005, 0, 0, True
					Exit
				End If
			Next
			
		End Select
		
	End If	
	
	
	
	
	;Let's rotate the part...
	If KeyDown(157) And ItemToMove$ = "part" Then	;Right Ctrl Key
		TurnEntity part, 0, 0, 5
		PartRotation# = PartRotation# + 5
		Delay 100
	End If
	;Let's rotate the part...
	If KeyDown(184) And ItemToMove$ = "part" Then	;Right Alt Key
		TurnEntity part, 0, 0, -5
		PartRotation# = PartRotation# - 5	
		Delay 100	
	End If	

	;Let's Flip the part...
	If KeyHit(33) And ItemToMove$ = "part" Then	;F Key
		TurnEntity part, 0, 180, 0
	End If	

	;Let's DELETE a bend;D key
	If KeyHit(32) And ItemToMove$ = "part" Then	
		For b.BendData = Each BendData
			If b\SEQ% = CurrentStep% Then
				FreeEntity b\Entity
				Delete b
			End If
		Next
		
		;Now, let's re-number all of the bends since I just deleted one from the list of bends...
		Count% = 1
		For b.BendData = Each BendData
			b\SEQ% = Count
			Count% = Count% + 1
		Next	
		CurrentStep% = 1	
	End If	

	;Let's ADD a new bend...;A key
	If (KeyHit(30) And ItemToMove$ = "part") Then
		MaxSteps% = 0
		For b.BendData = Each BendData
			If b\SEQ% &gt; MaxSteps% Then
				MaxSteps% = MaxSteps% + 1
				SaveZL# = b\ZL#
				SaveZR# = b\ZR#
				SaveRL# = b\RL#
				SaveRR# = b\RR#
				SavePartX# = b\PartX#
				SavePartY# = b\PartY#
				SavePartZ# = b\PartZ#
				SavePartPitch# = b\PartPitch#
				SavePartYaw# = b\PartYaw#
				SavePartRoll# = b\PartRoll#
			End If
		Next
			
		MaxSteps% = MaxSteps% + 1
		CurrentStep% = MaxSteps%
		
		b.BendData = New BendData
		b\Name$ = "Bend-" + MaxSteps%
		b\Entity = CreateCube()
		ScaleMesh b\entity, 2, (MeshDepth#(part) / MeshDepth#(b\Entity))+.005, MeshDepth#(part) / MeshDepth#(b\Entity)
		PositionEntity b\entity, 0, EntityY#(part) + MeshDepth#(b\Entity)/2, 0
  		EntityPickMode b\entity, 2
		NameEntity b\entity, "Bend-" + MaxSteps%
    	EntityParent b\entity, part  	
		EntityColor b\entity, 0, 255, 0		
		
		
		
		b\Seq% = MaxSteps%
		b\XL# = 2
		b\XR# = 2
		b\LGA# = 0
		b\RGA# = 0
		b\FO# = 0
		b\ZL# = -2
		b\ZR# = 2
		b\RL# = .02
		b\RR# = .02
		b\Angle# = 90
		b\Tonnage# = 1.4
		b\PartX# = EntityX#(part)
		b\PartY# = EntityY#(part)
		b\PartZ# = EntityZ#(part)
		b\PartPitch# = EntityPitch#(part)
		b\PartYaw# = EntityYaw#(part)
		b\PartRoll# = EntityRoll#(part)
	End If	
	

	;Let's autolocate the gauges...A key
	If KeyDown(30) 
		If ItemToMove$ = "leftgage" Then
			While XLeft# &gt; 0 And (Not MeshesIntersect(LeftGageAssembly, part))
				TranslateEntity LeftGageAssembly, 0, 0, -.001, True
				TranslateEntity LeftGageTower, 0, 0, -.001, True
				XLeft# = XLeft# - .001
			Wend
		End If
		If ItemToMove$ = "rightgage" Then
			While XRight# &gt; 0 And (Not MeshesIntersect(RightGageAssembly, part)) 
				TranslateEntity RightGageAssembly, 0, 0, -.001, True
				TranslateEntity RightGageTower, 0, 0, -.001, True
				XRight# = XRight# - .001
			Wend
		End If		
	End If
	


	;Let's do some zooming...
	Select MouseZSpeed()
		Case -1
			If ItemToMove$ = "camera" Then
				ZoomAmount# = ZoomAmount# + 0.01
			End If
			
			If ItemToMove$ = "part" Then
				TurnEntity part, 5, 0, 0, True
			End If
		Case 1
			If ItemToMove$ = "camera" Then
				ZoomAmount# = ZoomAmount# - 0.01
				If ZoomAmount# &lt; 0.01 Then
					ZoomAmount# = 0.01
				End If
			End If
			If ItemToMove$ = "part" Then
				TurnEntity part, -5, 0, 0, True
			End If				
	End Select		
	
	CameraZoom camera, ZoomAmount#


	;let's save the current step...S key
	If KeyDown(31) And ItemToMove$ = "part" Then
		For b.BendData = Each BendData
			If b\SEQ% = CurrentStep% Then
				b\XL# = XLeft#
				b\XR# = XRight#
				b\ZL# = ZLeft#
				b\ZR# = ZRight#
				b\RL# = RLeft#
				b\RR# = RRight#
				b\PartX# =    EntityX#(part)
				b\PartY# =    EntityY#(part)
				b\PartZ# =    EntityZ#(part)
				b\PartPitch# =EntityPitch#(part)
				b\PartYaw# =  EntityYaw#(part)
				b\PartRoll# = EntityRoll#(part)
				
			End If
		Next
	End If

	;Simulate CURRENT Bend Data...
	If ItemToMove$ = "part" Then
		SimulateIt = 0
		
		If KeyHit(201) Then	;PgUp key
			If CurrentStep% &gt; 1 Then
				CurrentStep% = CurrentStep% - 1
			Else
				CurrentStep% = 1
			End If
			SimulateIt = 1
		End If	

		If KeyHit(209) Then	;PgDn key
			SimulateIt = 1
			MaxSteps% = 0
			For b.BendData = Each BendData
				If b\SEQ% &gt; MaxSteps% Then
					MaxSteps% = MaxSteps% + 1
				End If
			Next
			If CurrentStep% &lt; MaxSteps% Then
				CurrentStep% = CurrentStep% + 1
			End If		
		End If

		If SimulateIt = 1 Then
			For b.BendData = Each BendData
				If b\SEQ% = CurrentStep% Then
					;NewXL# = (Float(b\XL$)  + Float(b\FO$) + Float(b\LGA$)) - XLeft#
					NewXL# = b\XL# - XLeft#
					XLeft# = XLeft# + NewXL#
					TranslateEntity LeftGageAssembly, 0, 0, NewXL#, True
					TranslateEntity LeftGageTower, 0, 0, NewXL#, True
		
					;NewXR# = (Float(b\XR$) + Float(b\FO$) + Float(b\RGA$)) - XRight# 
					NewXR# = b\XR# - XRight# 
					XRight# = XRight# + NewXR#
					TranslateEntity RightGageAssembly, 0, 0, NewXR#, True
					TranslateEntity RightGageTower, 0, 0, NewXR#, True
					
					NewZL# = b\ZL# - ZLeft#
					TranslateEntity LeftGageAssembly, NewZL#, 0, 0, True
					TranslateEntity LeftGageTower, NewZL#, 0, 0, True
					TranslateEntity LeftGageBase, NewZL#, 0, 0, True
					ZLeft# = ZLeft# + NewZL#	
									
					NewZR# = b\ZR# - ZRight#
					TranslateEntity RightGageAssembly, NewZR#, 0, 0, True
					TranslateEntity RightGageTower, NewZR#, 0, 0, True
					TranslateEntity RightGageBase, NewZR#, 0, 0, True
					ZRight# = ZRight# + NewZR#
		
					NewRL# = b\RL# - RLeft#
					TranslateEntity LeftGageAssembly, 0, NewRL#, 0, True
					RLeft# = RLeft# + NewRL#	
									
					NewRR# = b\RR# - RRight#
					TranslateEntity RightGageAssembly, 0, NewRR#, 0, True
					RRight# = RRight# + NewRR#
	
					PositionEntity Part, b\PartX#, b\PartY#, b\PartZ#
					RotateEntity Part, b\PartPitch#, b\PartYaw#, b\PartRoll#
					
				End If
			Next
		End If
		
	End If	
	
	;;Simulate ALL Bend Data...
	;If KeyHit (25) Then
	;	For b.BendData = Each BendData
	;		
	;		NewXL# = (Float(b\XL$)  + Float(b\FO$) + Float(b\LGA$)) - XLeft#
	;		XLeft# = XLeft# + NewXL#
	;		TranslateEntity LeftGageAssembly, 0, 0, NewXL#
	;		TranslateEntity LeftGageTower, 0, 0, NewXL#

	;		NewXR# = (Float(b\XR$) + Float(b\FO$) + Float(b\RGA$)) - XRight# 
	;		TranslateEntity RightGageAssembly, 0, 0, NewXR#, True
	;		TranslateEntity RightGageTower, 0, 0, NewXR#, True
	;		XRight# = XRight# + NewXR#
	;		
	;		NewZL# = (Float(b\ZL$)) - ZLeft#
	;		TranslateEntity LeftGageAssembly, NewZL#, 0, 0, True
	;		TranslateEntity LeftGageTower, NewZL#, 0, 0, True
	;		TranslateEntity LeftGageBase, NewZL#, 0, 0, True
	;		ZLeft# = ZLeft# + NewZL#	
	;						
	;		NewZR# = (Float(b\ZR$)) - ZRight#
	;		TranslateEntity RightGageAssembly, NewZR#, 0, 0, True
	;		TranslateEntity RightGageTower, NewZR#, 0, 0, True
	;		TranslateEntity RightGageBase, NewZR#, 0, 0, True
	;		ZRight# = ZRight# + NewZR#
	;
	;		NewRL# = (Float(b\RL$)) - RLeft#
	;		TranslateEntity LeftGageAssembly, 0, NewRL#, 0, True
	;		RLeft# = RLeft# + NewRL#	
	;						
	;		NewRR# = (Float(b\RR$)) - RRight#
	;		TranslateEntity RightGageAssembly, 0, NewRR#, 0, True
	;		RRight# = RRight# + NewRR#
	
	;		PositionEntity(part, b\PartX#, b\PartY#, b\PartZ#)
	;		RotateEntity(part, b\PartPitch#, b\PartYaw#, b\PartRoll#)
	;		
	;								
	;		UpdateWorld
	;		RenderWorld
	;		;Flip
	;		Text 5, 4,  "Current Step    : " + b\SEQ%
	;		CurrentStep% = b\SEQ%
	;		Locate 5,16
	;		FlushKeys
	;		If Input("Enter-Vw Next Stp, 99-Exit") = 99 Then
	;			Exit
	;		End If
	;	Next
	;End If
	

	UpdateWorld
	RenderWorld

	If Instr(ItemToMove$, "part") Then
		DisplayBendData()
	End If	
	
	If Instr(ItemToMove$, "Tool") &gt; 0 Then
		ChangeToolName()
	End If
	

	Color 0, 0, 0
	Line 600,0, 600, 800 
	Line 0, 400, 1200, 400

	If PickedEntity() &lt;&gt; 0 Then
		Color 0,0,0
		ItemToMove$ = EntityName$(PickedEntity())
	Else
		ItemToMove$ = "camera"
	EndIf
	
	Text 5, 4,  "Move Item: " + ItemToMove$
	Text 5, 16, ""
	Text 5, 28, ""
	Text 5, 40,  "X-Left   : " + FormatIt$(XLeft#,3)
	Text 5, 52,  "X-Right  : " + FormatIt$(XRight#,3)
	Text 5, 64,  "Z-Left   : " + FormatIt$(ZLeft#,3)
	Text 5, 76,  "Z-Right  : " + FormatIt$(ZRight#,3)
	Text 5, 88,  "R-Left   : " + FormatIt$(RLeft#,3)
	Text 5, 100, "R-Right  : " + FormatIt$(RRight#,3)

	Text 5, 112, "PartX    : " + EntityX#(part)
	Text 5, 124, "PartY    : " + EntityY#(part)
	Text 5, 138, "PartZ    : " + EntityZ#(part)
	Text 5, 174, "PartPitch: " + EntityPitch#(part)
	Text 5, 186, "PartYaw  : " + EntityYaw#(part)
	Text 5, 198, "PartRoll : " + EntityRoll#(part)
	

	Text 5, 150, "Material : " + MaterialType$
	Text 5, 162, "Thicknes : " + MaterialThickness#
	
	
	
	;Text 5, 136, "Part Rot : " + PartRotation
	
	If Instr(ItemToMove$, "Tool") Then
		DisplayToolLocations()
	End If

	;Export Bend Data...	E key
	If KeyHit (18) Then
		ExportBendData()
	End If

	Flip

Wend


Function FormatIt$(Number#, PlacesAfterDecimal#)

If Number# &gt; -0.001 And Number# &lt; 0.001 Then
	Number# = 0.0
End If

NewNumber$ = Str(Number#)
For I = 1 To PlacesAfterDecimal#
	NewNumber$ = NewNumber$ + "0"
Next


Found# = Instr(NewNumber$, ".")
If Found# &gt; 0 Then
	CurrentPlaces# = Len(Str(NewNumber$)) - Found#
	While CurrentPlaces# &lt; PlacesAfterDecimal#
		NewNumber$ = NewNumber$ + "0"
	Wend
	If CurrentPlaces# &gt; PlacesAfterDecimal# Then
		NewNumber$ = Mid(NewNumber$, 1, Len(NewNumber$) - (CurrentPlaces# - PlacesAfterDecimal#))
	End If	
End If

Return NewNumber$

End Function



Function ChangeToolName()

If Instr(ItemToMove$, "LTool-") Then
	If KeyDown(38) Then 
		For c.LowerTool = Each LowerTool
			If c\Name$ = ItemToMove$ Then
				Ans = -1
				While Ans &lt;&gt; 99
					FlushKeys()
					file=OpenFile("C:\Users\hollifd\Desktop\PMPBS\PMPBS_ToolList.txt")
					While Not Eof(file)	
						Hold$ = ReadLine$(file)
						StringToSearchFor$ = "StartDies"
						Found# = Instr(Hold$, StringToSearchFor$)
						If Found# &gt; 0 Then
							Count = 4
							Found# = 0
							While Found# = 0
								Hold$ = ReadLine(file)
								Found# = Instr(Hold$, "EndDies")
								If Found# &lt; 1 Then
									Text 5, Count, Hold$
									Count = Count + 12
								End If
							Wend
							Text 5, Count, "99-Exit"
						End If
					Wend
					CloseFile(file)

					Locate 5, Count + 12
					Ans = Input("Select: ")
					
					;Let's get the selection and update the tool name...
					If Ans &lt;&gt; 99 Then
						Selection$=Trim(Str(Ans)) + "-"
						file=OpenFile("C:\Users\hollifd\Desktop\PMPBS\PMPBS_ToolList.txt")
						Hold$ = ""
						FoundIt = 0
						While Instr(Hold$, "StartDies") &lt; 1
							Hold$ = ReadLine$(file)
						Wend
						While (Not Eof(file)) And (FoundIt &lt; 1)
							Hold$=ReadLine$(file)
							Found# = Instr(Hold$, Selection$)
							If Found# &gt; 0 Then
								c\Id$ = Mid(Hold$, Found# + Len(Selection$))
								FoundIt = 1
								Ans=99
							End If
						Wend
						CloseFile(file)
					End If
				Wend
			EndIf
		Next
	End If
End If

If Instr(ItemToMove$, "UTool-") &gt; 0 Then
	If KeyHit(38) Then
		For u.UpperTool = Each UpperTool
			If u\Name$ = ItemToMove$ Then
				Ans = -1
				While Ans &lt;&gt; 99
					FlushKeys()
					file=OpenFile("C:\Users\hollifd\Desktop\PMPBS\PMPBS_ToolList.txt")
					While Not Eof(file)	
						Hold$ = ReadLine$(file)
						StringToSearchFor$ = "StartPunches"
						Found# = Instr(Hold$, StringToSearchFor$)
						If Found# &gt; 0 Then
							Count = 4
							Found# = 0
							While Found# = 0
								Hold$ = ReadLine(file)
								Found# = Instr(Hold$, "EndPunches")
								If Found# &lt; 1 Then
									Text 5, Count, Hold$
									Count = Count + 12
								End If
							Wend
							Text 5, Count, "99-Exit"
						End If
					Wend
					CloseFile(file)

					Locate 5, Count + 12
					Ans = Input("Select: ")
					
					;Let's get the selection and update the tool name...
					If Ans &lt;&gt; 99 Then
						Selection$=Trim(Str(Ans)) + "-"
						file=OpenFile("C:\Users\hollifd\Desktop\PMPBS\PMPBS_ToolList.txt")
						Hold$ = ""
						While Instr(Hold$, "StartPunches") &lt; 1
							Hold$ = ReadLine$(file)
						Wend
						FoundIt = 0
						While (Not Eof(file)) And (FoundIt &lt; 1)
							Hold$=ReadLine$(file)
							Found# = Instr(Hold$, Selection$)
							If Found# &gt; 0 Then
								u\Id$ = Mid(Hold$, Found# + Len(Selection$))
								FoundIt = 1
								Ans=99
							End If
						Wend
						CloseFile(file)
					End If
				Wend
			EndIf
		Next
	End If
End If
If KeyDown(200) Then
	If Instr(ItemToMove$, "LTool") Then
		For c.LowerTool = Each LowerTool
			If c\Name$ = ItemToMove$ Then
				ScaleMesh c\entity, 1, ((MeshHeight(c\Entity) + .125) / MeshHeight(c\Entity)), 1	
				TranslateEntity c\entity, -.0625, 0, 0, True	
				Delay 75
			EndIf
		Next
	End If
	If Instr(ItemToMove$, "UTool") Then
		For u.UpperTool = Each UpperTool
			If u\Name$ = ItemToMove$ Then
				ScaleMesh u\entity, 1, ((MeshHeight(u\Entity) + .125) / MeshHeight(u\Entity)), 1	
				TranslateEntity u\entity, -.0625, 0, 0, True	
				Delay 75
			EndIf
		Next
	End If
End If
If KeyDown(208) Then
	If Instr(ItemToMove$, "LTool") Then
		For c.LowerTool = Each LowerTool
			If c\Name$ = ItemToMove$ Then
				ScaleMesh c\entity, 1, ((MeshHeight(c\Entity) - .125) / MeshHeight(c\Entity)), 1	
				TranslateEntity c\entity, .0625, 0, 0, True	
				Delay 75
			EndIf
		Next
	End If
	If Instr(ItemToMove$, "UTool") Then
		For u.UpperTool = Each UpperTool
			If u\Name$ = ItemToMove$ Then
				ScaleMesh u\entity, 1, ((MeshHeight(u\Entity) - .125) / MeshHeight(u\Entity)), 1	
				TranslateEntity u\entity, .0625, 0, 0, True	
				Delay 75
			EndIf
		Next
	End If
End If

End Function


Function DisplayToolLocations()

	Count = 4
	For u.UPperTool = Each UpperTool
		Text 840, Count, Left(u\Name$ + "        ",8) + " " + u\Id$ + " " + Right("       " + FormatIt(MeshHeight#(u\entity), 3), 6) + " " + Right("       " + FormatIt( FormatIt$((EntityX#(u\entity,True) + MeshHeight#(u\entity)/2),3),3), 7) + " " + u\Reversed$
		Count = Count + 12
	Next
	Count = Count + 12
	For c.LowerTool = Each LowerTool
		Text 840, Count, Left(c\Name$ + "        ",8) + " " + c\Id$ + " " + Right("       " + FormatIt(MeshHeight#(c\entity), 3), 6) + " " + Right("       " + FormatIt( FormatIt$((EntityX#(c\entity,True) + MeshHeight#(c\entity)/2),3),3),7)  + " " + c\Reversed$
		Count = Count + 12
	Next

End Function

Function ExportBendData()

	MyFileName$ = "C:\Users\hollifd\Desktop\PMPBS\BendData.txt"
	fileout = WriteFile(MyFileName$)
	WriteLine(fileout), "Material Description   :" + MaterialType$
	WriteLine(fileout), "Material Thickness     :" + MaterialThickness#
	WriteLine(fileout), "SEQ,X-Left(mm),X-Right(mm),Left-GageAllow,Right-GageAllow,FingerOffset,Z-Left,Z-Right,R-Left,R-Right,Angle,BendLength,Tonnage,PartX,PartY,PartZ,PartPitch,PartYaw,PartRoll"
	Count = 0
	For b.BendData = Each BendData
		Count% = Count% + 1
		WriteLine(fileout), Count% + "," + b\XL# + "," + b\XR# + "," + b\LGA# + "," + b\RGA# + "," + b\FO# + "," + b\ZL# + "," + b\ZR# + "," + b\RL# + "," + b\RR# + "," + b\Angle# + "," + b\BL# + "," + b\Tonnage# + "," + b\PartX# + "," + b\PartY# + "," + b\PartZ# + "," + b\PartPitch# + "," + b\PartYaw# + "," + b\PartRoll#
	Next
	CloseFile(fileout)

End Function


Function ImportBendData()

file=OpenFile("C:\Users\hollifd\Desktop\PMPBS\BendData.txt")
MaterialType$ = ReadLine$(file)
MaterialType$ = Mid(MaterialType$, 25)
MaterialThick$ = ReadLine$(file)
MaterialThickness# = Mid(MaterialThick$, 25)
Hold$ = ReadLine$(file)	;read past header line

While Not Eof(file)
	Hold$ = ReadLine$(file)

	If Hold$ &lt;&gt; "" Then
		b.BendData = New BendData
		CurrentStep% = 1
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\SEQ% = Mid(Hold$, 1, Found# - 1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
	
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\XL# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
	
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\XR# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\LGA# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\RGA# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\FO# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\ZL# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\ZR# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\RL# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\RR$ = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\Angle# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\BL# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\Tonnage# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
	
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\PartX# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\PartY# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\PartZ# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\PartPitch# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		Found# = Instr(Hold$, ",")
		If Found# &gt; 0 Then
			b\PartYaw# = Mid(Hold$, 1, Found# -1)
			Hold$ = Mid(Hold$, Found# + 1)
		End If
		
		;Flush out the last item from the string
		b\PartRoll# = Hold$

		;DebugLog b\seq$
		;DebugLog b\XL$
		;DebugLog b\XR$
		;DebugLog b\LGA$
		;DebugLog b\RGA$
		;DebugLog b\FO$
		;DebugLog b\ZL$
		;DebugLog b\ZR$
		;DebugLog b\RL$
		;DebugLog b\RR$
		;DebugLog b\Angle$
		;DebugLog b\BL$
		;DebugLog b\Tonnage$
		;DebugLog b\PartX$
		;DebugLog b\PartY$
		;DebugLog b\PartZ$
		;DebugLog b\PartPitch$
		;DebugLog b\PartYaw$
		;DebugLog b\PartRoll$
	End If
		
Wend
CloseFile(file)


End Function


Function DisplayBendData()
	Color 255, 0, 0
	Count = 12
	For b.BendData = Each BendData
		Text 150, 0, " Seq  XLeft  XRight   LGA   RGA FingOf   ZLeft  ZRight  Ang  BLen  Tons"
		Text 150, Count, Right("     " + Str(b\SEQ%), 5) + " " + Right("      " + FormatIt((b\XL# * 25.4),2),6) + " " + Right("      " + FormatIt((b\XR# * 25.4),2),6) + " " + FormatIt(b\LGA#,3) + " " + FormatIt(b\RGA#,3) + " " + FormatIt(b\FO#,3) + " " + Right("      " + FormatIt(b\ZL#,3),7) + " " + Right("      " + FormatIt(b\ZR#,3),7) + " " + b\Angle# + " " + Right("      " + FormatIt(b\BL#,3),6) + " " + FormatIt(b\Tonnage#,2) + " " + b\PartPitch# + "," + b\PartYaw# + " " + b\PartRoll#
		Count = Count + 12
	Next
	Text 150, CurrentStep * 12, "&gt;"
	Color 0, 0, 0
End Function

End

</textarea> <br><br></td></tr></table><br>
<a name="1337168"></a>

<a name="1337169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I quickly gave up on the full code, except for the definition of BendData.<br>You want to save information about each mesh at many steps. Simplified code looks like this.<br><pre class=code>Type BendData
	Field Entity	;Mesh
	; many fields omitted
	Field PartX#	;PartX
	Field PartY#	;PartY
	Field PartZ#	;PartZ
	Field PartPitch#;PartPitch
	Field PartYaw#	;Partyaw
	Field PartRoll# ;PartRoll
End Type


	;let's save the current step...S key

		For b.BendData = Each BendData
				; more code omitted
				b\PartX# = EntityX#(part)
				b\PartY# = EntityY#(part)
				b\PartZ# = EntityZ#(part)
				b\PartPitch# = EntityPitch#(part)
				b\PartYaw# = EntityYaw#(part)
				b\PartRoll# = EntityRoll#(part)
		Next
</pre><br>The For loop iterates over all the BendData types. But it does exactly the same thing for each one because part never changes inside the loop. <br>If I understand this you should be saving the current configuration for each entity by doing something like<br><pre class=code>				b\PartX# = EntityX#( b\Entity )				
				b\PartY# = EntityY#( b\Entity )  ; etc.</pre> <br><br></td></tr></table><br>
<a name="1337186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I save the positions of my "part", I am checking that the XYZPitchYawRoll values that I print to the screen match what I am storing in my TYPE fields.  They match.<br><br>When I run the code to put my "part" back to the saved positions, the "part" XYZPitchYawRoll values that I print to the screen do not match the saved values.<br><br>I believe I am saving the values correctly but the code to move my "part" seems to have a problem.  The other objects seem to work just fine.  It seems only the "part" object is not working.<br><br>My saved Pitch is -90<br>My saved Yaw is -180<br>My saved Roll is 180<br><br>After running my simulateit code which should move the part back to the positions above is moving the part to the following positions...<br><br>My saved Pitch is -90<br>My saved Yaw is 180<br>My saved Roll is -180<br><br><br><br>Something in this code...<br><pre class=code>
		If SimulateIt = 1 Then
			For b.BendData = Each BendData
				If b\SEQ% = CurrentStep% Then
					;NewXL# = (Float(b\XL$)  + Float(b\FO$) + Float(b\LGA$)) - XLeft#
					NewXL# = b\XL# - XLeft#
					XLeft# = XLeft# + NewXL#
					TranslateEntity LeftGageAssembly, 0, 0, NewXL#, True
					TranslateEntity LeftGageTower, 0, 0, NewXL#, True
		
					;NewXR# = (Float(b\XR$) + Float(b\FO$) + Float(b\RGA$)) - XRight# 
					NewXR# = b\XR# - XRight# 
					XRight# = XRight# + NewXR#
					TranslateEntity RightGageAssembly, 0, 0, NewXR#, True
					TranslateEntity RightGageTower, 0, 0, NewXR#, True
					
					NewZL# = b\ZL# - ZLeft#
					TranslateEntity LeftGageAssembly, NewZL#, 0, 0, True
					TranslateEntity LeftGageTower, NewZL#, 0, 0, True
					TranslateEntity LeftGageBase, NewZL#, 0, 0, True
					ZLeft# = ZLeft# + NewZL#	
									
					NewZR# = b\ZR# - ZRight#
					TranslateEntity RightGageAssembly, NewZR#, 0, 0, True
					TranslateEntity RightGageTower, NewZR#, 0, 0, True
					TranslateEntity RightGageBase, NewZR#, 0, 0, True
					ZRight# = ZRight# + NewZR#
		
					NewRL# = b\RL# - RLeft#
					TranslateEntity LeftGageAssembly, 0, NewRL#, 0, True
					RLeft# = RLeft# + NewRL#	
									
					NewRR# = b\RR# - RRight#
					TranslateEntity RightGageAssembly, 0, NewRR#, 0, True
					RRight# = RRight# + NewRR#
	
	
					DebugLog b\PartX#
					DebugLog b\PartY#
					DebugLog b\PartZ#
					DebugLog b\PartPitch#
					DebugLog b\PartYaw#
					DebugLog b\PartRoll#
					PositionEntity Part, b\PartX#, b\PartY#, b\PartZ#
					RotateEntity Part, b\PartPitch#, b\PartYaw#, b\PartRoll#    ;I believe something here is not working correctly, my part rotations are not getting back to my saved values
					
					SimulateIt = 0
					Exit
					
				End If
			Next
		End If

</pre> <br><br></td></tr></table><br>
<a name="1337188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pitch = -90 or +90 can be problematic due to gimbal lock. <br><br>But is there really any problem here? +180 and -180 are two different names for the same angle. They both mean "half way around". <br><br></td></tr></table><br>
<a name="1337192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> All I know is...<br>I move my part to any location on the screen and I display the positions of the part on the screen as I move it around.  I save the positions.  Then I replay the positions and my part rotates to a new rotation... but it should not.  Each time I save the step and replay it, the part rotates a little bit to a new rotation.  Most of the time, the part seems flipped 180 degrees.<br><br>I feel bad keeping this post alive.  I'll eventually figure out what is wrong.  I just wanted to make sure my logic/goal is good...that I should be able to move stuff around, save all of the positions to a file or to a TYPE field(s) and then replay those positions whenever I want by searching for the "position" I want to replay and then position / rotate each object that I want to replay. <br><br></td></tr></table><br>
<a name="1337193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK.  I stripped everything from my code except the bare basics and it now seems to work correctly.  So I have something interfering and causing my troubles in my code.  Thanks to everyone for looking at this.  I'll get it figured out from here.<br><br>Thanks again,<br>David <br><br></td></tr></table><br>
<a name="1337213"></a>

<a name="1337214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @hollifd&gt;&gt;try to use debuglog() to see what the get/saved/loaded/set pitch/yaw/roll values are, if i remember correctly, the yaw is between -180.0 and +180.0 but the pitch or the roll (i don't remember which one) is limited between a higher minimum value and a lower maximum value (which is confusing, i agree)<br><br>Also make sure that you use "true" for the last parameter of entityx(), entityy(), entityz(), entitypitch(), entityyaw(), entityroll(), positionentity(), rotateentity() so that the entity is not affected by the position/orientation of its parent.<br><a href="http://www.blitzbasic.com/b3ddocs/command.php?name=EntityX" target="_blank">http://www.blitzbasic.com/b3ddocs/command.php?name=EntityX</a><br><a href="http://www.blitzbasic.com/b3ddocs/command.php?name=EntityPitch" target="_blank">http://www.blitzbasic.com/b3ddocs/command.php?name=EntityPitch</a><br><a href="http://www.blitzbasic.com/b3ddocs/command.php?name=PositionEntity" target="_blank">http://www.blitzbasic.com/b3ddocs/command.php?name=PositionEntity</a><br><a href="http://www.blitzbasic.com/b3ddocs/command.php?name=RotateEntity" target="_blank">http://www.blitzbasic.com/b3ddocs/command.php?name=RotateEntity</a> <br><br></td></tr></table><br>
<a name="1337219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hollifd</td><td align="right"><font class=tiny>(Posted March)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> RemiD,<br>Thanks.  I have it working much better now.  Not sure what was wrong but after removing most of the code and starting over again, it is working much better now.  I am rocking and rolling again.  Thanks for hanging in there with me.  I appreciate it. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
