<!DOCTYPE html><html lang="en" ><head ><title >Need help with player movement !</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need help with player movement !</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Need help with player movement !</a><br><br>
<a name="164781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JPL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi !<br><br>This is my second question of the day ;-)<br><br>I'm working on an fps, my world is composed of a terrain a buildings placed on it. I'm looking for a commented fps framework, or at least explanations on how to manage player collisions, walk / jump.<br>To avoid the player climbing the walls, I've tried with a main entity (a sphere) with another small sphere under it to represent the player's feet. If the 'feet' sphere collides with something, the player can jump, else he is still in the air and cannot jump, but I've got a lot of problems and the movement of my player is not realistic, so I really need HELP since I've passed several hours on this player walk code and cannot get it to work.<br><br>Shame on me, it must be simple, but ... please help the poor coder I am !<br><br>Thanks a lot, <br><br></td></tr></table><br>
<a name="164789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doggie</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd think merely checking the terrainY against the players position would tell you whether or not he's in the air or on the ground. Providing that's how you're controlling where he walks. Something similar as this.<br><br><br><pre class=code>While Not KeyHit(1)
If KeyDown(200) Then
MoveEntity player,0,0,.5 
EndIf
If KeyDown(208) Then
MoveEntity player,0,0,-.5 
EndIf
If KeyDown(203) Then
TurnEntity player ,0,2,0 
EndIf
If KeyDown(205) Then
TurnEntity player ,0,-2,0 
EndIf
x#=EntityX(camera)
y#=EntityY(camera)
z#=EntityZ(camera)
x1#=EntityX(player)
y1#=EntityY(player)
z1#=EntityZ(player)
terra_y#=TerrainY(terrain1,x#,y#,z#)+5
PositionEntity camera,x#,terra_y#+15,z#
If Not EntityCollided(player,2)
PositionEntity player,x1#,terra_y#+3,z1#
End If
If Not KeyDown(200) Or KeyDown(208)
AnimateMD2 player,1,0.5,20,25 :UpdateWorld
EndIf
MouseLook(camera)
UpdateWorld
RenderWorld
Flip
Wend
</pre><br><br>Doggie <br><br></td></tr></table><br>
<a name="164799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JPL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a lot, but my problem is that there's also buildings with stairs in my scene, so I cannot use terrainy...<br><br>any ideas ? <br><br></td></tr></table><br>
<a name="164849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tiggertooth</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> A lot of games use invisible (but solid) ramps where stairs exist in the level.  Quake does this for example.<br><br>It provides a much smoother movement (no sudden jerks) and the built in collision code of Blitz handles it well if the stairs aren't too steep.  Depends on what effect you're going for I guess.  Turn those steps into slides as far as Blitz is concerned and it becomes trivial. <br><br></td></tr></table><br>
<a name="164998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Never mind TerrainY, a similar approach would be to simply do a raytrace (LinePick) straight down.  Then use PickedY to determine how far away the surface directly under the player is every frame. <br><br></td></tr></table><br>
<a name="165085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JPL</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, that's a good idea... let's code it :-) <br><br></td></tr></table><br>
<a name="165656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Madcap13</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> or you could just nick the castle code from your samples<br>directory. .. if you brought blitz3d. *:o).<br>I think you can download it somewhere if you havent.<br>in it, it has a terraign which the player can walk on<br>and its got a castle which the player can walk on&lt;but its<br>a bit slippery for some reason&gt;<br><br>I wouldnt feel downhearted about failed efforts in this<br>area. For the most part, once you've got the running/ducking<br>and shooting part, you've almost completed the coding part<br>of your FPS.<br>If you dont want opening or big explosions or enemies then<br>you actually have completed it.<br>ur, yeah.. as I was saying, its an integral part to FPS. <br><br></td></tr></table><br>
<a name="216067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LostCargo</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know this is an old post but im going to pull this one back out. I think this is a very important issue for FPS.<br><br>Alright, Im having the same problem JPL. I have posted about this once before and though everyone pitched in i really havent found a solition i like.<br><br>My solution was a snowman configuration similar to yours.<br>As below:<br><br>{H}        The head<br>{B}        The body<br> *         The foot or contact point<br>(BTW the trick with using the foot/contact is to have it barely inside the body so that the outer edge of the body hits a stair and lifts the unit to the next step while the smaller footer (which is away from the wall) stays out of conact with any objects from the side such as a stair or wall. THus they can only jump when standing solidly on a step. The body works best with full sliding collisions on)<br><br>Basicly i had used code just like yours to see if the (*) has hit anything. If it is touching, then the user can jump, if not then he cant. But i added another layer of complexity.<br>What if the user is in a hallway and jumps and hits its head. Well, i added code for that too. Great. Now if the user hits their head they fall back down instead of continuing their jump cycle.<br><br><br>My problem is that i am having to keep track of if the head, body or the foot are directly up and down.<br><br>I have a function which sort of does this, but i dont like having to call a function to do effect all all of these objects, expecially since i want will eventually put htem all in a type so that they can be reused. (See my code below)<br>Does anyone know of a way to welding objects togeather so that they still have their own individual collisions but will move as one unit or mesh? It may save some CPU cycles.<br><br><br><br>'=============================<br>example code: if you want it take it. I dont like the solution on a large scale<br><br><br>Function  PLAYER_MOVE(DIR_X,DIR_Y,DIR_Z)<br>	If  EntityCollided(ENTITY_headsphere , TYPE_ENVIRONMENT ) = 0 And DIR_Y &gt;= 0<br>		MoveEntity  entity_bodysphere ,0, DIR_Y,0<br>	Else<br>		If EntityCollided(ENTITY_contactsphere , TYPE_ENVIRONMENT ) = 0 And DIR_Y &lt; 0 Then<br>			MoveEntity  entity_bodysphere ,0, DIR_Y,0<br>		End If<br>	End If<br> 	MoveEntity  entity_bodysphere ,DIR_X, 0 ,0 <br>   	MoveEntity  entity_bodysphere ,0, 0 ,DIR_Z<br>	PositionEntity entity_headsphere ,	EntityX(entity_bodysphere ),EntityY(entity_bodysphere )+5 ,EntityZ(entity_bodysphere )<br>	PositionEntity entity_hero ,	EntityX(entity_bodysphere ),EntityY(entity_bodysphere )  ,EntityZ(entity_bodysphere )<br>	<br>    PositionEntity entity_camera ,	EntityX(entity_hero )   ,EntityY(entity_hero ) +13  ,EntityZ(entity_hero )   <br><br>    PositionEntity entity_contactsphere ,	EntityX(entity_bodysphere ),EntityY(entity_bodysphere )-3 ,EntityZ(entity_bodysphere )<br>End Function <br><br></td></tr></table><br>
<a name="216073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LostCargo</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> alright cancel that. I think i found a solution using collision normals<br><a href="http://www.blitzbasic.com/bbs/posts.php?topic=18696" target="_blank">http://www.blitzbasic.com/bbs/posts.php?topic=18696</a><br><br>thanks anyway. I hope this helps someoneelse. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
