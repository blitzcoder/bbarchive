<!DOCTYPE html><html lang="en" ><head ><title >UltraFast CrC32 needs testing!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >UltraFast CrC32 needs testing!</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >UltraFast CrC32 needs testing!</a><br><br>
<a name="555085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy UK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all, i needed crc32 code so i decided to use the code supplied by MrCredo in the code archives. The code is well written but very slow. Unmodified it takes on average 25-30 seconds to calculate the crc for a 20mb file. Ive added stuff to do this from memory and managed to speed it up by around 20 times but it only works for files that will fit into the remaining physical ram. Im trying to get it to do it in 10mb chuncks from memory but its proving harder than i thought. I'll post the code for people to hack :)<br><br>***********************************************************<br><br>Dim crc_table(255)<br>crc_init()<br><br><br>Print Hex$(crc_file("c:\test.exe"))<br>WaitKey<br><br>Function crc_init()<br>Local i<br>Local j<br>Local value<br>For i=0 To 255<br>value=i<br>For j=0 To 7<br>If (value And $1) Then <br>value=(value Shr 1) Xor $EDB88320<br>Else<br>value=(value Shr 1)<br>EndIf<br>Next<br>crc_table(i)=value<br>Next<br>End Function<br><br><br>Function crc_file(name$)<br>Local byte<br>Local crc<br>Local file<br>Local size<br>Local a<br>crc=$FFFFFFFF<br>file=ReadFile(name$)<br>size=FileSize("c:\test.exe")<br>If file=0 Then Return<br>bank=CreateBank(size)<br>ReadBytes bank,file,0,size<br>CloseFile file<br>st#=MilliSecs()<br>While a&lt;&gt;size<br>crc=(crc Shr 8) Xor crc_table(PeekByte(bank,a) Xor (crc And $FF))<br>a=a+1<br>Wend<br>et#=MilliSecs()<br>Print "CRC32 Checked in "+(et#-st#)/1000+" Seconds"<br>FreeBank bank<br>Return ~crc<br>End Function <br><br></td></tr></table><br>
<a name="555218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >King Dave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you look around for the blitzsys.dll it has functions to crc files or banks of data... it may be faster, but would have to time both methods :) <br><br></td></tr></table><br>
<a name="555233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is crc if you don't mind me asking? :o) <br><br></td></tr></table><br>
<a name="555270"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://en.wikipedia.org/wiki/Cyclic_redundancy_check" target="_blank">CRC</a> <br><br></td></tr></table><br>
<a name="555302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, thanks man :o) <br><br></td></tr></table><br>
<a name="555370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy UK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanx Ross i might look into later if i need the extra speed, 0.2 seconds is ok for a 20mb file for now i hope <br><br></td></tr></table><br>
<a name="555951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snarkbait</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice. I see you put in the 'closefile' mrcredo missed in his original code. ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
