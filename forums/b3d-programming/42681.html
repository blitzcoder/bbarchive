<!DOCTYPE html><html lang="en" ><head ><title >Aligning Sprite to Terrain</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Aligning Sprite to Terrain</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Aligning Sprite to Terrain</a><br><br>
<a name="477877"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I still can't figure out how to align a sprite to a mesh.<br><br>I've tried align to vector, and a bakajillion other things. My sprite is called "p\entityhandle" and I've already done "LinePick" and everything. I've tried using "AlignToVector" but it won't appear. I can't figure out how to make it align to a mesh. <br><br></td></tr></table><br>
<a name="477881"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> try using EntityFX p\entityhandle,16.  Blitz seems to align sprites faced down (meaning they aren't visible) - so you need to disable backface culling or rotate it 180 degrees in the X axis.<br><br>You will also need to use SpriteViewMode p\entityhandle,2 if you haven't done so already. <br><br></td></tr></table><br>
<a name="477892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok <br><br></td></tr></table><br>
<a name="477894"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ok <br></div><br>Don't mention it.<br><br><br><br><br><br><br><br><br><br>Oh, you didn't. <br><br></td></tr></table><br>
<a name="477911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ion-Storm</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> the Unmannered Newbie... <br><br></td></tr></table><br>
<a name="477913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry.<br><br>Thanks though. Although you may not accept it now. <br><br></td></tr></table><br>
<a name="477995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> On this subject (the topic, not the subject of manners etc.!)<br><br>How do I 'get' the vector from the terrain/mesh that I want the sprite aligned-to?<br><br>As in, what values do I put in to the AlignToVector command if these will be dependant on the angle of camera and the angle of the terrain/mesh vertices. <br><br></td></tr></table><br>
<a name="478008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use the normal from a collision or pick:<pre class=code>Graphics3D 800, 600, 0, 2

cam = CreateCamera()
PositionEntity cam, 0, 0, -5

cube = CreateCube()
EntityPickMode cube, 2
RotateEntity cube, 45, 45, 0

light = CreateLight(2)
PositionEntity light, 500, 500, -2000

sprite = CreateSprite()
EntityColor sprite, 0, 0, 200
ScaleSprite sprite, 0.2, 0.2
SpriteViewMode sprite, 2

Repeat
	If CameraPick(cam, MouseX(), MouseY())
		PositionEntity sprite, PickedX() + (PickedNX() * 0.01), PickedY() + (PickedNY() * 0.01), PickedZ() + (PickedNZ() * 0.01)
		AlignToVector sprite, -PickedNX(), -PickedNY(), -PickedNZ(), 3, 1
		
		;I could've used:
		;PositionEntity sprite, PickedX(), PickedY(), PickedZ()
		;AlignToVector sprite, -PickedNX(), -PickedNY(), -PickedNZ(), 3, 1
		;MoveEntity sprite, 0, 0, -0.01
	EndIf
	
	RenderWorld
	Flip
Until KeyHit(1)

End</pre> <br><br></td></tr></table><br>
<a name="478052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cermit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a good example Neville, very usefull. <br><br></td></tr></table><br>
<a name="478357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Darn - your code didn't work, although maybe it was how it was implemented. I messed around with my code, and although it still doesn't work, here's what I got:<br><pre class=code>
	If gun=1 
	If ammo &gt;= 1 
	If MouseHit(1)  
		ammo = ammo - 1 
	 	picked = LinePick(400, 300, EntityZ(camera), 1, 1, 10)
	 	p.hole = New hole
	 	p\entityhandle = CopyEntity(bullethole)
	 	p\alpha = 0.9
	 	p\typething = "pistol"
	 	nx# = PickedNX()
     	ny# = PickedNY()
     	nz# = PickedNZ()
		EntityFX p\entityhandle, 16
		PositionEntity p\entityhandle, PickedX() + (PickedNX() * 0.01), PickedY() + (PickedNY() * 0.01), PickedZ() + (PickedNZ() * 0.01)
		AlignToVector p\entityhandle, -PickedNX(), -PickedNY(), -PickedNZ(), 3, 1
		MoveEntity p\entityhandle, 0, 0, -0.05
		e.explosion = New explosion
		e\x = PickedX()
		e\y = PickedY()
		e\z = PickedZ()
		e\entity = CopyEntity(explosion)
	 	Emitter_Start(e\entity)
		PositionEntity e\entity, e\x, e\y, e\z
	EndIf
	EndIf
	EndIf
</pre> <br><br></td></tr></table><br>
<a name="478799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like your using LinePick all wrong - are those screen coords you're using with it? Take a look at the docs and have another go. :) <br><br></td></tr></table><br>
<a name="478824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well then how would I create a LinePick from the center of the screen?<br><br>I looked at the docs, and I'm pretty sure everything but the last two numbers are correct. <br><br></td></tr></table><br>
<a name="478828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well the centre of the screen or viewport should be the centre of the camera. So Entityx(camera,1),Entityy(camera,1),Entityz(camera,1).  A linepick uses world coords for the start of the line,  you are confusing it with camerapick that uses screen coords.  It must be said the docs do not make this very clear. <br><br></td></tr></table><br>
<a name="478838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks you guys! This might fix everything! :D <br><br></td></tr></table><br>
<a name="478840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> It did! <br><br></td></tr></table><br>
<a name="478920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really?  I was forgetting something.  That line you are projecting will always be along the z axis. Well in fact it is mostly along the z axis, I do not know why you have the  x and y components set to 1 which would push it up and to the right a bit.  Now linepick does not know anything about camera orientation so if your  camera is facing elsewhere you would also need to do something like Tformvector 0,0,10,camera,0 and then<br>linepick entityx(camera,1),entityy(camera,1),entityz(camera,1),tformedx(),tformedy(),tformedz(). <br><br></td></tr></table><br>
<a name="478941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wizzlefish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, it didn't work with Linepick - but it worked with CameraPick :D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
