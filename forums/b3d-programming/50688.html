<!DOCTYPE html><html lang="en" ><head ><title >Numerical accuracy. . .</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Numerical accuracy. . .</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Numerical accuracy. . .</a><br><br>
<a name="564496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Snidesmin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure everyone knows about this but are there any previous forum posts or documentation on the fact that switching off debug leads to lower numerical accuracy and also lower accuracy when reading pixel colors from images/screen?<br><br>The lower accuracy with debug off means that I occasionally experience errors that occur during a 'fast' run but do not occur while debugging.  These can be nasty bugs to identify.<br><br>I would like people to post their comments, ideas and work-arounds relating to this topic and also any kind of explanations for the behaviour that anyone may have. . .<br><br>I would love to know the answer to this:<br>"In order to preserve numerical accurracy in my Blitz program, do I have to compile my EXEs in (the slower) debug mode, or is there another way?" <br><br></td></tr></table><br>
<a name="564505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Numerical accuracy should not (and does not) alter depending on whether debug is on or off.<br><br>Please post a small piece of code to demo your problem.<br><br>P.S. You should never need to create an EXE with debug on! <br><br></td></tr></table><br>
<a name="564517"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Snidesmin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have experienced this in many many MANY situations on many different PCs. I think that all the PCs have been pentiums, so perhaps it's a pentium problem . . .<br><br>I will dig out a few examples and post them tonight or tommorow.<br><br>I have only really been concerned with this phenomenon because I write accuracy-critical programs such as erosion simulations.  <br>I especially notice it whenever I use the pixels on the screen to store numerical (height) data as I occasionally do with this type of program.<br><br>SOMEONE PLEASE TELL ME THAT THEY HAVE ALSO EXPERIENCED THIS OR SOMETHING SIMILAR OR ELSE I WILL GO INSANE!!! :O) <br><br></td></tr></table><br>
<a name="564547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have experienced situations where code crashes out, but when I go step-through it works. This has been with managing objects though and I don't know about numerical accuracy. I also can't be sure if my experiences are 'bugs' or just me being a crap coder not knowing what I'm doing ;) <br><br></td></tr></table><br>
<a name="564597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pixel 'accuracy' has nothing to do with floating point accuracy.  It is more likely because debug is windowed and release mode isn't, so you are getting a different screen 'depth': 32 or 16. <br><br></td></tr></table><br>
<a name="564831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Snidesmin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That might explain that. . .   although I always have my system running in 32-bit color, whether windowed or full screen. But I get your point, there could be something in that.<br><br>I'm still fairly sure I've experienced it with floating point numbers separately, though I'm not totally sure of myself now. . .  I'll have to do a few checks this weekend to see if I can replicate :O) <br><br></td></tr></table><br>
<a name="565017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I write accuracy-critical programs  <br></div><br>Although you did not specify I would like to predetermine one possibility with an explanation:<br><br>DO NOT use floats in this situation.  Floats are an estimate only. An estimate, guess, a ball park figure... Not precise.<br><br>Integers are your accurate data type.<br><br>If you need a floating point number to be numerically accurate then you will need to control your own data type.  A quick method would be an integer that is 1000 times it's real value to hold 3 decimal places, etc.<br><br>I say again, floats are not meant to be accurate, for a computer to handle them completely precisely would be very slow.<br><br>Just because they are not actually that bad does not qualify them as accurate, they can and do get it wrong sometimes, although their accuracy is not effected by debug status to my knowledge.<br><br>BTW: whilst this may or may not be related to the reported "Pentium bug" which I thought was just an issue with P60's and P90's, you might like to know I first came across innacuracies in floats using a ZX-Spectrum, so I dont think it's a Blitz specific "feature" ;) <br><br></td></tr></table><br>
<a name="565067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Snidesmin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, I've been playing around, and it seems that I stand corrected. . . <br><br>I think y'all right about floats not being affected by debug -  I am only experiencing it with pixel values which could be numerous things to do with the graphics card - I am therefore quitting using the pixels to store numbers, which was probably a dumb idea in the first place :O)<br><br>Anyway, thanks Becky - I had not realised until just now that integers are more accurate. . . but I guess that makes sense as you have to store extra info for the float in the same number of bytes (i.e. location of decimal) You have enlightened me! :O)<br><br>I guess what I really am after is a double precision type - and it does annoy me that I would have to implement all the math operations etc. . .   I expect I'd do a shoddy job too, and make it a really slow implementation.  Perhaps your idea of using integers will have to suffice.<br><br>Thank you all!!! :O) <br><br></td></tr></table><br>
<a name="565109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The tone of my post, having just re-read it, I believe may well be down to a nicotene craving i've been having all afternoon...  I'm several weeks into giving up and have been quite calm of late - but this afternoon i've just been flipping!  Sorry if I seemed off, or more likely, if I seem ... well, wierd.  Almost Jasper Carott'ish  "This Parrot is dead.  Deceased, it is no more......" <br><br></td></tr></table><br>
<a name="565155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> "This Parrot is dead. Deceased, it is no more......" comes from John Cleese, not Jasper Carrott ;) Anyway, keep up the giving up. As if the tobacco in cig's wasn't bad enough the other stuff they put in them (deadly toxins like formaldehyde) really are a recipe for death. I dunno how they ever get away with it. If Cadbury's put deadly poisons in their chocolate they'd be hung, drawn and quartered, dead, deceased, no more...<br><br>mrsnidesmin : The reason Floats aren't accurate is because they hold a finite representation of potentially infinitely small values. Consider the value for 1/7. In maths you'd keep that as 1/7 in your calculations, but converting to a decimal you get 0.142857142857142857... repeating forever. If your floating point rounds to 8 decimal places, you get an exact figure for 1/7 of 0.14285714 which isn't mathematically correct. Now use that value in a calcuation. Let's say we want (1/7) * (3 &amp; 3/4), which is in absolute terms 15/28, which in limited decimal is 0.535714285714285714285(...repeating 714285 forever). Rounded to 8 decimal places that's 0.53571429.<br>Performing this calculation using 8 dp FP figures you get the sum 0.14285714*3.7500000 = 0.52571428. It's 0.00000001 out from an 8 decimal place representation of the true calculation. By using more and more calculations with fixed precision, these rounding errors pile up to produce results that are just plain wrong, but not wrong enough to matter in most applications like 3D graphics.<br><br>Also regards FP accuracy on PCs, I heard recently from an experienced professional games developer that...<br><br><div class="quote"> Ignoring PC's and the wonders of DX randomly changing your rounding mode...<br>However last time I looked on PC's in particular it isn't, DX plays with the rounding mode on the processor, so in effect your graphics can change the outcome of your physics simulation. <br></div><br>Apparently DirectX can change the results from floating point calculations. This explains why my physics simulation can have slightly differnt outcomes on different runs, and why floating point results from calculations on a PC can have changing values. <br><br></td></tr></table><br>
<a name="565211"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Snidesmin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahhhhh. . .   so maybe it's not just me being insane then.  I guess that must be what happened in those various rare circumstances I encounter from time to time, that I've not been able to replicate in the last couple of days.  DX affecting the outcome of FP calculations. Who'd have thought eh? <br><br>Thanks Shifty, this is the best explanation so far. . .  Doesn't help me solve the problem of there being no 8-byte double precision float in BB though.  Don't suppose you want to implement one for me? :O) <br><br></td></tr></table><br>
<a name="565220"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You said you were storing numbers as pixel data. Well, i can't be too specific as i don't recall, but there's certain RGB combinations that can't be stored if i recall correctly. You can store them, but if you read a pixel colour value back, it changes slightly. Something to do with blitz using 24 bit colour? <br><br></td></tr></table><br>
<a name="565753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr Snidesmin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep, that wasn't the problem - I was using (or thought I was) 32-bit color all the time and I should have had 256*256*256 possible values (red*green*blue). But for some reason when reading the pixel values I sometimes got small errors. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
