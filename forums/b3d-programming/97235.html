<!DOCTYPE html><html lang="en" ><head ><title >Problem with texture creation on some machine</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Problem with texture creation on some machine</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Problem with texture creation on some machine</a><br><br>
<a name="1128145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >alain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi there,<br><br>I have the following test code:<br><br><pre class=code>
Graphics3D 640,480,32,2
t = CreateTexture(8,8,256+1)
SetBuffer(TextureBuffer(t))
Color 255,255,255
Rect 0, 0,8,8,True
SetBuffer(BackBuffer())
tb = TextureBuffer(t)
LockBuffer(tb)
p = ReadPixelFast(2,2,tb)
Print("result:"+Hex(p))
UnlockBuffer(tb)
FreeTexture t
While Not KeyDown( 1 )
RenderWorld
Flip
Wend
End
</pre><br><br>- It creates a 8x8 white texture.<br>- Locks the texture<br>- Pick a pixel on the middle<br>- Display the value of the pixel<br><br>On my machines, the result is, as expected, $ffffffff (white pixel), but on a user machine, the result is $ff000000 (black pixel)<br><br>The user machine uses Windows Vista 32bits, DirectX10 and the hardware is an Acer Aspire 5520 with an NVIDIA GeForce 7000M/nForce 610M.<br><br>Any idea? Maybe the texture flags? or something else? Any help welcome. <br><br></td></tr></table><br>
<a name="1128164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would avoid storing the texture in VRAM perhaps, and check to see if that makes a difference. <br><br></td></tr></table><br>
<a name="1128165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >alain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just sent a test program to my user with flags changed.. we will see. <br><br></td></tr></table><br>
<a name="1128171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't consistently use any 2D drawing commands other than WritePixelFast on texture buffers. They'll work on some machines and silently fail on others. So presumably the slacker here is Rect.<br><br>You could try either replacing Rect with a manual-rect using WritePixelFast, or copying from a region created on the BackBuffer? <br><br></td></tr></table><br>
<a name="1128173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or using the Blitz3D+ DLL? o.o <br><br></td></tr></table><br>
<a name="1128174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >alain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yasha: Didn't know that. Is it documented? What is the explanation? is it a bug in Blitz3D?<br><br>Using WritePixelFast everywhere is not really an option because it is far slower than just do a Rectangle in the Texture buffer.<br><br>Thundros: Which DLL? Are you talking about FastExtension? <br><br></td></tr></table><br>
<a name="1128175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> No... this 1...<br><br><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=75711" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=75711</a> <br><br></td></tr></table><br>
<a name="1128179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is it documented? <br></div><br><br>Definitely not.<br><br>Anyway, CopyRect is fast enough for real-time use on most machines, so <i>if</i> that's the cause of the problem, you can usually just CopyRect off the BackBuffer (after all, this is how people without FastExtension do render-to-texture).<br><br>As for the B3D+ DLL... that has <i>absolutely nothing</i> to do with this, and doesn't offer any remotely relevant features. <br><br></td></tr></table><br>
<a name="1128193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Yasha: Didn't know that. Is it documented? What is the explanation? is it a bug in Blitz3D? <br></div><br>It's implicit from the fact that the 2D commands use DirectDraw. This component has been deprecated since DirectX 8 onward, so it's not safe. <br>There is not enough information to say that this is the problem, however.<br><br>I agree with Yasha: draw to the BackBuffer then CopyRect from there to the texture buffer. I'm sure CopyRect is much more compatible than the drawing commands. Then use the ReadPixelFast. <br><br>- Use the texture on any cube or simple mesh just to see if it's working.<br>- Setup several different tests under the same app; rules out quicker what's the problem. <br><br></td></tr></table><br>
<a name="1128210"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure if using print with a locked buffer causes any issues or not? <br><br></td></tr></table><br>
<a name="1128317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >alain</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, without the 256 flag it seems to work on my user's computer. And it is also faster on my setup.<br><br>In short, if I understand well, the 256 flag should be used when we do "render on texture" operations, otherwise not. Is it right? <br><br></td></tr></table><br>
<a name="1128319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Depends on what you mean by "render on texture." If you'll be drawing to a texture constantly while the game/program is running at full speed (realtime), then you will <i>absolutely</i> need to use flag 256 and find workarounds for its many shortcomings. I had a thread on one such issue a while ago: <a href="http://blitzbasic.com/Community/posts.php?topic=95435" target="_blank">http://blitzbasic.com/Community/posts.php?topic=95435</a> <br><br></td></tr></table><br>
<a name="1128673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Flag 256 makes problems on some machines. You may use some code to test the flag for proper operation (colors...) and as well as if it actually makes something faster on a certain machine, or not, and in that case don't use it - dynamicly.<br><br>I wrote some speed comparation code for reading/writing pixels and copyrecting, in context with or without flag 256, probably published it somewhere, code archives or around here, must be a few years ago. try searching for "flag 256" or alike. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
