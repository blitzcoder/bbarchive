<!DOCTYPE html><html lang="en" ><head ><title >Hiding entities when they are not on screen</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Hiding entities when they are not on screen</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Hiding entities when they are not on screen</a><br><br>
<a name="475733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I have a lot of entities on a big playing area. I guess this makes the game slower not only because of the rendering (I setp up the camerarange so this is shouldn't be a problem... I guess) but because of the collision detection. So I was thinking I would hide all entities that are not on screen.<br>What's the best way of doing this? Looping trough all the entities (with types) and checking if they are on screen using EntityInView and if they're not, I hide them?<br>Is EntityInView fast enough for this? Or is there a better sollution?<br><br>Thanks. <br><br></td></tr></table><br>
<a name="475738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It depends on what sort of a game, how many entities etc.<br><br>Many previous suggestions involve having your game split into areas, where all the entities for an area are parented to a pivot or something. At the change of area, this pivot (and thus all recursive children) is hidden.<br><br>Some of the following may help:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1244" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1244</a><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=41049" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=41049</a><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=41247" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=41247</a><br><br>plus check out the code archives (maybe search them for 'Occlusion' as this is what you are trying to achieve. <br><br></td></tr></table><br>
<a name="475741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I already figured I had to use a grid or something, but parenting them to a pivot is a good idea!<br>Suppose my areas are 10*10, I only need to divide my player's x-y coords by 10, round it, and I know which area is closest. Then I'll probably have to show that area and possibly it's surrounding areas as well.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="475759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> you don't have to hide them manually! Blitz will automatcly skip rendering things that are not in view, aka behind the camera. Tho they need to be seperate meshes. But if they once are seperate meshes, you don't have to care about hiding them. Hiding them would also skip collision detection, so if you walk backward, you could fall trough the earth right to china.<br><br>Just make sure your world is made of reasonably sized seperate meshes, so the camera will automaticly skip rendering things that are a) out of the camera range or b) not in view.<br><br>If you have a huge big one-mesh map, you may use the ClusterizeMesh Function from the codearchives. <br><br></td></tr></table><br>
<a name="475806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you're missing the point. I know they are not rendered when they're out of range, but still it runs slow because there's collision detection with way too many objects going on. If they're not on screen I don't want there to be any collision detection.<br><br>"Hiding them would also skip collision detection, so if you walk backward, you could fall trough the earth right to china."<br><br>You're assuming I'm making a first person game then. Which I'm not. :) <br><br></td></tr></table><br>
<a name="475830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, this is giving me an FPS-increase of 10 (when there are lots of trees on the screen) to 50 (in less populates areas) :O<br>Great, it's running at 40-80fps now instead of 25-35fps. Quite an improvement! :) <br><br></td></tr></table><br>
<a name="476602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> just to note: Collision Detection can be maintained without rendering if objects are set to Alpha 0.<br><br>Perhaps, also, some optimisation may be done on your trees. If this is what seems to be causing the majority of the slowdown.<br><br>Are they meshes or sprites? can you texture them with less surfaces? can you replace meshes with sprites at greater distances (L.O.D stuff)?<br><br>This is kinda tricky stuff, and Im not the best to advise on it, but it may help a lot. <br><br></td></tr></table><br>
<a name="476610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fall_x</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> just to note: Collision Detection can be maintained without rendering if objects are set to Alpha 0. <br></div>Thanks, but I knew that already :)<br><br><div class="quote"> Are they meshes or sprites? <br></div><br>meshes, about 50 polygons<br><div class="quote"> can you texture them with less surfaces? <br></div><br>I guess they have 2 surfaces, the trunk (solid) and the leaves (transparant)... I tried grouping them in less meshes with addmesh(), add them to a mesh based on their location, but the 3D engine doesn't support zbuffer on transparant surfaces (or something like that, someone from blitz support explained it to me but I don't have the mail right here), which caused trees to pop up in front of eachother. And it didn't really increased the FPS by much.<br><div class="quote"> can you replace meshes with sprites at greater distances (L.O.D stuff)? <br></div><br>My camera is top-down (well, tilted a bit, but from the top), which means you can't look very far anyway. There are typically 10 trees on screeen at once, and they are not far enough away to replace them with a sprite.<br><br>But I'm pretty sure most of the slow-down was caused by the engine checking the collision between my players and every single tree that was in the scene. Now it only has to check a few trees, and it's a LOT faster.<br>Thanks for the suggestions. <br><br></td></tr></table><br>
<a name="476614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great stuff! Good luck! <br><br></td></tr></table><br>
<a name="476674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> BTW. to reduce the collision work with trees I usually don't set their collision on, but instead place an invisible box around the trunk (alpha zero). <br><br>Of course this requires that there ain't no birds or rc model airplanes expecting to collide with the branches. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
