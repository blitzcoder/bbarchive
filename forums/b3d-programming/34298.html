<!DOCTYPE html><html lang="en" ><head ><title >Hardware lights on lightmaps</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Hardware lights on lightmaps</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Hardware lights on lightmaps</a><br><br>
<a name="370273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please check me if I'm wrong:<br>I use flickering (hardware) lights as wall torches.<br>So far I've used .X meshes - no problem.<br>Then I used .B3D meshes - still no problem.<br>But .B3D meshes + lightmap - flickering lights now have literally _no_ effect on the walls of my level.<br>Do hardware lights have _no_ effect on a lightmapped mesh? <br><br></td></tr></table><br>
<a name="370277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Isaac P</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> check that your mesh is not set as fullbright, some b3d exporters export .b3d files as fullbright by default. <br><br></td></tr></table><br>
<a name="370278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kozmi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>Im' having the same problem you are with my player's torch in my egyptian level im' making! I got this real cool looking hand held torch for my player and all for this dark egyptian tomb like level, But the hardware light has no effect at all on my level's walls... :( So it sounds like your in the same boat as I am.<br><br>Wish I could help ya' out here... But I am needing the same thing as you are... Let me know if you end up figuring this out ok? Or I'll let you know if I do! <br><br></td></tr></table><br>
<a name="370279"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >9572AD</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> As Tainted said, lightmapped meshes are generally set to fullbright. <br><br></td></tr></table><br>
<a name="370280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Change the EntityFx for your level (and children if loaded as loadanimmesh) <br><br></td></tr></table><br>
<a name="370284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kozmi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmmm,<br><br>I'll give it a go around and see what happens! Thank's guys! ;) <br><br></td></tr></table><br>
<a name="370291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Usually it looks REALLY bad if you try to use real-time lights on levels that have been lightmapped... lightmaps are pre-calculated ligting and they don't look correct anymore if you disable full-bright mode and add real-time lights. If you have very dark corners on your lightmaps, no ("real") light is going to lit them anyway, they stay dark. <br><br></td></tr></table><br>
<a name="370328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paolo</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmmmm, at the moment I have found a solution for this but it is not going to be so useful if your levels has a lot of polys.<br><br>The solution is load your lightmapped level, then load the same level but WITHOUT lightmaps (only textures) and ENTITYBLEND(3) this level, this way a hardware light will affect this new level and will produce a really nice bright effect over the lightmapped one... :)<br>But as you may guess, this means doble the polycount... so...<br><br>Paolo. <br><br></td></tr></table><br>
<a name="370406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's no go on that one Paulo.<br>But let me add one more thing: Maplet created meshes/lightmaps _will_ respond to harware lights, but Quill3D meshes/lightmaps _won't_ (arrgghh! I paid for that prog!).<br>Anyone using Quill who has found a solution?<br>How do I set _not_ full bright on export?<br>@Rob: EntityFX set to what?<br>@DoctorWho: dying to see your level!<br>Keep at it guys, I really appreciate the help. <br><br></td></tr></table><br>
<a name="370410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try EntityFX with flags set to 0. <br><br></td></tr></table><br>
<a name="370444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> No. EntityFX set to 0 produces no change.<br>Somebody, please.....<br>How can Maplet do this fine, but Quill's output disables hardware lights?<br>C'mon let's hear from one of the geniuses!<br>Rob, sswift, anybody...... take pity. <br><br></td></tr></table><br>
<a name="370559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> inexistant hardware light -&gt; no normals in the model. Realtime light needs normals as the brightness is calculated basing on lightdirection - lightintensity and the surfaces normal<br><br>try updatenormals mesh, perhaps it helps <br><br></td></tr></table><br>
<a name="370581"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora, you've cracked it! - UpdateNormals mesh.<br>Who would have thought?<br>Unfortunately now some of my surfaces are strangely extra dark next to very light ones, but on the whole my flickering torches work - maybe I just need to check my vertices.<br>Thanks for that. <br><br></td></tr></table><br>
<a name="370629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zenith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since when was Rob a genius? He's an ogre! *hides behind his ogre mug* <br><br></td></tr></table><br>
<a name="371201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK. Just for info, but especially for DoctorWho, these are the steps I _had_ to take:<br>1) Create model in favourite modeller.<br>2) Export as .X<br>3) Load into Decorator.<br>4) Immediately save out as .B3D<br>5) Load into Quill.<br>6) Create and save lightmap.<br>7) Save scene out of Quill as .B3D.<br>The Decorator step is essential, else the model will _still_ not react to hardware lights.<br>By the way, I'd really like to know what other lightmappers people are using? <br><br></td></tr></table><br>
<a name="371236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> By the way, I'd really like to know what other lightmappers people are using? <br></div><br><br>There can be only one:<br><br><a href="http://www.frecle.net/giles/home.htm" target="_blank">http://www.frecle.net/giles/home.htm</a> <br><br></td></tr></table><br>
<a name="371278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dunno if the answers I received here are any help:<br>sounds kinda similar...<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=30707" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=30707</a> <br><br></td></tr></table><br>
<a name="371600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Malice - some interesting questions and answers there.<br>I think it would be worth me reiterating that Maplet produced a 'torch-lightable' lightmapped model, no problem.<br>But my .X model put through Quill would not.<br>ExtityFx model,0 had _no_ effect.<br>Only by loading the .X into Decorator, saving as .B3D, loading into Quill, lightmapping, saving again as .B3D, and _also_ using 'UpdateNormals model' could I get it to react to torch lights.<br>So does everyone else use Giles for lightmapping? <br><br></td></tr></table><br>
<a name="371608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to use "decal" lights on your walls, like Half-Life does. <br><br></td></tr></table><br>
<a name="371623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I understand what you mean, but I'm more interesting in the 'flickering torch' effect generally around a dark (previously) lightmapped room. <br>And hardware lights are ok for that as long as the room reacts properly, as bescribed above. <br><br></td></tr></table><br>
<a name="371634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could just create a second copy of the lightmap, slightly lighter in the places you want, and set the texture blend of one lightmap to 0, then switch them back and forth every 40 milliseconds or so. <br><br></td></tr></table><br>
<a name="372305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sussed it!!!<br><br>my code is for cartogrtaphy shop 4 B3d files, but i think the principals are the same.<br>This code extracts all the entity data, creates lights and blends the textures to accept HW lights.<br><br>Its a bit messy (took me an hour), it does not attach the light entities to the parent, clear up tempory textures or brushes. But you can do that yourself (may need doing to prevent memory probs).<br><br><a href="http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=1053" target="_blank">http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=1053</a> <br><br></td></tr></table><br>
<a name="372306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh bugger, the code archive thing is limeted to a few lines but if anyone wants it, email me : danontour2002@... <br><br></td></tr></table><br>
<a name="372749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think we're losing track here; I don't want multiple renders or anything like that, just a hardware light flickering torch effect generally affecting a darkened room; and I've sussed it, as described above. Still, thanks to all who have thrown their ideas in. <br><br></td></tr></table><br>
<a name="373059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> that thread ( www.blitzbasic.co.nz/codearcs/codearcs.php?code=1053 ) is now working. use this code wisely as it can really bugger up the look of the map.<br>For your torch, i recommend a realtime adjustment of the nearby lightmaps (using - EntityDistance(to lightrange) AND EntityVisable to either seriously brighten the maps when the torch is on or use a textureblend of 0 then switch it back to 3 when turned off.<br><br>Whos the man, DANZTHEMAN! <br><br></td></tr></table><br>
<a name="374105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dan, my buildings are loaded in as separate entities from the terrain, so I guess this system is not for me. If you could send the b3d as well as the code I'll test it.<br>But as I said above, the problem is solved. <br><br></td></tr></table><br>
<a name="374281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to use two copies of your lightmap, one slightly brighter, and turn the textureblend on and off.  This will give a flicker without eliminating shadows...and it's fast. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
