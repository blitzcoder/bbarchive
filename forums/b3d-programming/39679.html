<!DOCTYPE html><html lang="en" ><head ><title >Check to see if an entity still exists at a handle</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Check to see if an entity still exists at a handle</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Check to see if an entity still exists at a handle</a><br><br>
<a name="442768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need to check if a handle for an entity is still valid(basically, if there is still a active entity associated with it).  Is there a way to do this? <br><br></td></tr></table><br>
<a name="442773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> One way that springs to mind is to set all handles to zero when freeing them. For example, replace FreeEntity by adding this function to your code :<br><br>Function MyFreeEntity(ent)<br>   FreeEntity(ent)<br>   Return 0<br>End Function<br><br>And replace all FreeEntity(ent) calls with ent=FreeEntity(ent) <br><br></td></tr></table><br>
<a name="442796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, I'm creating a bunch of functions for this myself after a day of hunting down a memory leak that was caused by not freeing up a sound effect.<br><br>If you Free it, Zero it! <br><br></td></tr></table><br>
<a name="443243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sometimes a code uses multiple instances of a handle, eg:<br><br>a=createcube()<br>b=a<br><br>a=myfreeentity(a)<br><br>; a is now zero, but b don't knows about it<br><br>Probably you can check if b is a valid entity when you use the entityclass$() command, but I didn't test it. Maybe it still thinks there is a mesh, I don't know. But it should be tested quickly.<br><br>if entityclass$(b)="Mesh" then print "b still seems to be a valid mesh"<br><br>EDIT: I just tested it, and there is a very funny result, or should I say pretty scary :/<br><br>When you FreeEntity a Mesh, EntityClass$() will return "Pivot" when used with the now invalid handle! So this could be an option, but only if you KNOW that it should return "Mesh". (Cause it returns "Mesh" when you didn't free the mesh).<br><br>BTW. if you use EntityClass$() with a value that has never been an entity (eg. zero), it will produce a MAV.<br><br>Probably EntityClass$() should be enhanced, allowing to check non-handles as well as handles that are no longer valid and then return an empty string. <br><br></td></tr></table><br>
<a name="443263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Probably EntityClass$() should be enhanced, allowing to check non-handles as well as handles that are no longer valid and then return an empty string <br></div>The problem is that the handle is simply a pointer, which enables a fast, direct access. To do what you suggest it would have to scan the list of alive entities in order to know it's not a valid entity handle (though it could be enhanced with an associative container, but still). <br><br></td></tr></table><br>
<a name="443265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem of multiple handles pointing to an entity happens to me all the time.  For example, in one recent project I had a type for all the tanks.  The tanks store, as one field in the type, the handle of the object they are targetting.  But this resulted in a MAV if multiple tanks target the same object and one of them destroys it.<br><br>An addition to EntityClass to handle invalid handles would be really handy for situations like this, but in the meantime note that attempting to access a type instance that has been deleted results in a 'null' response, not an error.  So the workaround I use is to refer to the type instance that has the handle of the entity, not the entity's handle directly.  When I free the entity I also delete the type instance.  Thus, anything else attempting to refer to the type instance gets a 'null' response. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
