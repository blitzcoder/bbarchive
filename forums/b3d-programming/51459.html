<!DOCTYPE html><html lang="en" ><head ><title >WinBlitz3D HELP needed (kevin?)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >WinBlitz3D HELP needed (kevin?)</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >WinBlitz3D HELP needed (kevin?)</a><br><br>
<a name="574117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi All,<br><br>I'm dying to use WinBlitz3D for some editor I'm building - using windows controls &amp; gadgets with a blitz 3d viewport..<br><br>But since the latest release Kevin uses the 'apiGetMessage()' inside the main WaitEvent() function to WAIT for an event to happen (mouse, keyboard, button click) as opposed to the 'apiPeekMessage()' that he used in previous (more limited) versions.<br><br>Here comes the BUT:<br>apiGetMessage() FREEZES the entire program until it receives some event (ie. a mouse move, button click, key press, etc).<br>apiPeekMessage() doesn't freeze and so keeps my 3d blitz window alive and happy (refreshing every frame), but it doesn't catch any mouse or keyboard events; making my 3d environment impossible to 'control' by mouse or keyboard :(<br><br>I am in seriously unfamiliar terriotory here, and have been hacking at it for more than 3 weeks now (between the soup and the potatoes). <br><br>Does anyone (kevin?) have any idea's or tips to share to resolve this? Anything appreciated!!!!<br><br>cheers,<br>Danny. <br><br></td></tr></table><br>
<a name="574253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been looking into this and i can't understand why the apigetmessage blocks until a new events come. It should have an option to be non blocking, very strange! <br><br></td></tr></table><br>
<a name="574291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does your editor <i>need</i> to update every single frame?<br>APE (my editor) uses the latest version of WinBlitz, and it only does input updates when the Blitz window is in focus.<br><br>My WinBlitz uses apiPeekMessage. I believe that it is the latest version. Mind you, this may be an addition by myself.<br>To tell if you have the latest version, look for the function "PopUpGadgetMenu".<br><br>Does your waitEvent() function have a section that looks sort of like this?<br><pre class=code>
Case WM_NOTIFY
			;Notify "WM_NOTIFY"

			;Notify Hex(TCN_SELCHANGE) + " : " + Hex(PeekInt(WinProcReturn,$18))

			Select PeekInt(WinProcReturn,$18)

				Case NM_RCLICK
					ret_event = $401
					eventsource_RAW = PeekInt(WinProcReturn,$10)
					
					;Also does popup menu stuff
        			If apiIsWindow(eventsource_RAW) &lt;&gt; 0
        				Gadget_BankDATA = apiGetWindowLong(eventsource_RAW,GWL_USERDATA)
        				If Gadget_BankDATA &gt; 0
        					;If PeekInt(Gadget_BankDATA,$00) = eventsource_RAW
        						PopUpGadgetMenu(eventSource_raw)
        					;EndIf
        				EndIf
                    EndIf
                    
                Case NM_DBLCLK
                    ret_event=$204
                    eventdata_raw=1
                    eventsource_RAW = PeekInt(WinProcReturn,$10)

				Case NM_CLICK,TVN_SELCHANGEDA,TCN_SELCHANGE ; tabber
					ret_event = $401
					eventsource_RAW = PeekInt(WinProcReturn,$10)
					eventdata_RAW = apiSendMessage(eventsource_RAW,TCM_GETCURSEL,0,0)
					
                Case NM_KEYDOWN,TVN_KEYDOWN
                    eventsource_RAW = PeekInt(WinProcReturn,$10)
                    eventdata_raw=LOWORD(PeekInt(WinProcReturn,$08)) ;Key is one of the VK_ constants
                    ret_event=$101
</pre><br>I use that for mine, and it gets the proper input events for gadgets.<br>I find that resorting the windows can help, too. There is an unfortunate link between how many parents a window has and what kind of messages it sends to WinBlitz.<br>Remember: Only you can see how messy things are :) <br><br></td></tr></table><br>
<a name="574423"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers for the feedback Mr. Picklesworth!<br><br>You defenetly have a newer/different version of WinBlitz than I do (I have the 'public release version' of about 4 months ago). And I do have the PopUpGadgetMenu function but, by the looks of it, your waitEvents() is totally different than mine!!! I've looked everywhere but can't find a version that comes even close to the code you posted!<br><br>I do need the 'every frame refresh' to be able to control animation options in my editor. And I HAVE managed to get around that... .But the biggest problem is that i am NOT ABLE AT ALL to get ANY keyboard or mouse feedback using the apiPeekMessage function!! Not from native blitz function nor from the WinBlitz routines :(<br><br>It seems you do have found a way around it. Any chance of sharing this ??? (pretty please ;). <br><br></td></tr></table><br>
<a name="574448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Danny<br><br>Please bare with me on this, things are coming along slow but this is because im trying to juggle my 6 month old son, winblitz3d and my blitzmax project. ive gadgets working directly in the blitz-runtime window but in .dll i am going <br>to convert this to internal blitz source as soon as possable.<br><br>@KuRiX <br>apigetmessage waits for each event in the message queue, blame microsoft for this :)<br><br>btw, im sure Mr Picklesworth would be willin to share his modifyed winblitz3d include file.<br><br>kev <br><br></td></tr></table><br>
<a name="574513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers for that Kevin!<br><br>And good luck with the sleepless nights ;)<br><br>-Danny <br><br></td></tr></table><br>
<a name="574533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heh, sure, I'll share.<br>But don't replace your other version of WinBlitz, because this file is a bit untrustworthy. There may be chunks hard-coded around my editor, and a few strange redundancies and stupid functions that you will have to put up with. I would recommend copying and pasting what you want into another copy of WinBlitz3d_Include.bb.<br><br>I've also included my nearly uncommented (Yay!) GUI file, which may have a few handy tips and tricks, or things.<br><br><a href="http://crumbsoftware.f2o.org/files/WinBlitzFiles.zip" target="_blank">http://crumbsoftware.f2o.org/files/WinBlitzFiles.zip</a> <br><br></td></tr></table><br>
<a name="574609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Kev, of course i am blaming microsoft for that!, i know that this is a microsoft problem, so i wonder why they did it this way?<br><br>Anyway, congratulations for WinBlitz, is amazing!!! <br><br></td></tr></table><br>
<a name="574834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Danny, <br>yes and the early mornings are a killer too, but hes worth it :)<br><br>@KuRiX, <br>im not sure why microsoft done it, but i suppose thats why they have peekmessage. but there's problems when mixing blitz3d/gui. but the new way im doing it does not require you to wait for messages. im using blitz's own message handler's.<br><br>@Mr. Picklesworth <br>thanks for that dylan.<br><br>kev <br><br></td></tr></table><br>
<a name="574905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Dylan!<br>After some hacking, I finally got keyboard and mouse control again in Blitz!!! Cheers for that..<br><br>Crapper is that I now my treeview nodes have gone deaf, and my edit boxes don't accept keystrokes anymore :)p<br><br>So I guess I still got some hacking to go ;)<br>I'll keep you posted.<br><br>cheers all,<br>D. <br><br></td></tr></table><br>
<a name="574953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is your treeview parented to?<br>I find, strangely, that the most prominent messages returned by windows are different based on how many parents they have. For example, my object called entList is currently not parented to the groupbox that it appears to be inside of. This way, it returns all keyboard and mouse events to the main window. This way, I have full control over the object. If I had it actually parented to the groupbox, it would be returning proper events through WM_NOTIFY, which are all mostly events returned as $401. An example of a gadget that returns proper messages is created with SetUp_VarsList. With that list view, there wasn't a reason to get mouse and keyboard events - Just actual gadget events telling me when something has been selected, clicked (fully clicked), etc.<br>Thus, through the WM_NOTIFY segment of WaitEvent is the best way to get messages, because they are always right and proper. (Whereas, getting click messages is a bit untrustworthy and hack feeling)<br><br>I hope that made sense, I always write a bit strangely when I go off on tangents like that :)<br>So, see if your gadgets are actually recieving some kind of messages, and try to sort it out so they recieve the kind that you want them to recieve.<br><br>Winblitz takes a bit of fiddling, but it's well worth it once it's all working! <br><br></td></tr></table><br>
<a name="575335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I hear what you're saying Mr. Picklesworth...<br><br>And I agree that the fiddling is worth it, but I've been hacking at it for nearly a month now, trying to get my head around it - time to start using it ;)<br><br>I've seen the effect of parenting one gadget into another - or into another window, etc. But I still have no idea what the rules or regulations are, and unable to create a stable environment that doesn't fold when you add something else :/<br><br>Anyway I've got a very acceptable mix right now between what I had and what you send me. Full control in blitz and full control over my gadgets - just not at the same time.<br>I can't have blitz refreshing everyframe AND keep all the gadgets (menu, trees, editbox's) working at the same time. So I go for the stop-play space bar routine for now ;)<br><br>Cheers mate(s),<br>D. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
