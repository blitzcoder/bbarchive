<!DOCTYPE html><html lang="en" ><head ><title >Small problem with level editor scroll?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Small problem with level editor scroll?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Small problem with level editor scroll?</a><br><br>
<a name="1123916"></a>

<a name="1123918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all, ok, my level editor is working fine with the keys. (At least I think), for scrolling... (Correct the scrolling code if I'm wrong). BUT... I for some reason can't get the tile to draw in the exact correct spot UNLESS I haven't scrolled on the map. But that's a problem, because I NEED to scroll, in order to create a full map...<br><br><br>Here's the code: <br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Include "scancodes.bb"

Graphics 1024,768,0,2
AppTitle "Platform editor v2.0"
SetBuffer BackBuffer()
AutoMidHandle False		;Images placed by their top left
TFormFilter 0
;32
Dim map(32,24)
Dim mapcol(32,24)
Dim mapData(32,24)

Global mapx = 32
Global mapy = 24
Global mapx1 = 0
Global skypos
Global gridon = False
Global mapview = 1024

Global tiles = LoadAnimImage("gfx/Ztileset.bmp",32,32,0,10)
Global sky = LoadImage("gfx\sky1.bmp")
MaskImage tiles,255,0,255
TileImage sky

Global cursorx,cursory
Global gx,gy
Global currenttile=1
Global rpik,rpik2
Global rcol,rcol1,rcol2
Global mode=1
Global coltype=1

Const erasetile = 0

fill()

Global X1 = 0
Global Y1 = 0

; Main
While Not KeyHit(1)
	
	
	
	Cls
	
	
	If KeyDown(k_right) Then X1 = X1 - 1
	If KeyDown(k_left) Then X1 = X1 + 1
	
	
	
	If KeyDown(k_down) Then Y1 = Y1 - 1
	If KeyDown(k_up) Then Y1 = Y1 + 1
	
	
	
	If X1 &lt; -mapx Then X1 = -mapx
	If X1 &gt; 0 Then X1 = 0
	
	
	
	If Y1 &lt; -mapy Then Y1 = -mapy
	If Y1 &gt; 0 Then Y1 = 0
	
	

sky()
update()
grid()
control()
info()



Text GraphicsWidth()/2, GraphicsHeight()/2, "X1: "+X1, 1, 1
Text GraphicsWidth()/2, GraphicsHeight()/2+20, "Y1: "+Y1, 1, 1



Flip



Wend



Function control()
	
	
	
If mode=1
   ; If KeyDown(k_left) = mapx Then mapx = mapx+1 : mapx1 = mapx1 +1
	If KeyHit(12) And mode=1 Then currenttile=currenttile-1
	If KeyHit(13) And mode=1 Then currenttile=currenttile+1

	
	If KeyHit(34) 
	If gridon=True
	gridon=False
	Else
    gridon=True
	EndIf
	EndIf
	
	If currenttile&lt;0 Then currenttile=9
	If currenttile&gt;9 Then currenttile=0
    If KeyHit(46) Then mode=2	
    gx=MouseX()/32
    gy=MouseY()/32
	Color 256,0,0
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=currenttile
	If MouseDown(2) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=0
	
EndIf

If mode=2 
	If KeyHit(12) And mode=2 Then coltype=coltype-1
	If KeyHit(13) And mode=2 Then coltype=coltype+1
	If coltype&lt;1 Then coltype=1
	If coltype&gt;2 Then coltype=2
	
	Color 256,0,0
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
    gx=MouseX()/32
    gy=MouseY()/32
	If KeyHit(46) Then mode=1
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 And coltype=1 Then  mapcol(gx,gy)=1
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 And coltype=2 Then  mapcol(gx,gy)=2
	If MouseDown(2) And gx &lt; 32 And gy &lt; 24 Then mapcol(gx,gy)=0
EndIf


	If KeyHit(59)
		save("lvl1.map")
		supersave("lvl1_decrypted.map")
	EndIf
	
	If KeyHit(60)
    load("lvl1.map")
	EndIf
	
End Function



Function update()

If mode=1
For x=0 To mapx
	For Y=0 To mapy
		DrawImage tiles,X1+x*32,Y1+y*32,map(x,y)	
	Next	
Next

Color 0,0,0
Rect 0,0,40,40,1
DrawImage tiles,3,3,currenttile
EndIf

If mode=2
For x=0 To mapx
	For Y=0 To mapy
	DrawImage tiles,x*32,y*32,map(x,y)	
	If mapcol(x,y)=1
	Color 0,0,0
    Rect x*32,y*32,32,32,0
    EndIf	
	If mapcol(x,y)=2
	Color 255,0,0
    Rect x*32,y*32,32,32,0
    EndIf	
	Next
	Color 0,0,0
    Rect 0,0,40,40,1
    If coltype=1 
	Color 0,0,0
	Rect 3,3,32,32,1
	EndIf
	If coltype=2
	Color 255,0,0 
	Rect 3,3,32,32,1
	EndIf
Next


EndIf

End Function


Function sky()

TileBlock sky,skypos,0 

skypos=skypos+1

End Function


Function info()

If mode=1
Text 100,0,"Press C to change to collision mode   leftclick = place tile   rightclick = remove tile   + and - change tiles"
Text 100,20,"F1 to save - F2 to load   Unfortunatly it only saves as (lvl1.lvl) SOZ"
Text 100,40,"Press D to change to data mode    Press G for grid mode " 

EndIf
If mode=2
Text 100,0,"Press C to change to scenery mode   leftclick = place collision   rightclick = remove collision"
EndIf

End Function



Function save(filename$)

	f=WriteFile(filename$)

	For y=0 To 24
		For x=0 To 32
			WriteInt f,map(x,y)
		Next
	Next
	
	For y=0 To 24
		For x=0 To 32
			WriteInt f,mapcol(x,y)
		Next
	Next

	CloseFile f

End Function



Function supersave(filename$)
	
	f=WriteFile(filename$)
	
	For y=0 To 24
		For x=0 To 32
			WriteLine f, "TileNumber: "+map(x,y)
		Next
	Next
	
	For y=0 To 24
		For x=0 To 32
			WriteLine f,"CollisionTileNumber: "+mapcol(x,y)
		Next
	Next
	
	CloseFile f
	
End Function


Function load(filename$)

	f=OpenFile(filename$)

	For y=0 To 24
		For x=0 To 32
			i=ReadInt(f)
			map(x,y)=i
		Next ;x
	Next ;y
	
	For y=0 To 24
		For x=0 To 32
			i=ReadInt(f)
			mapcol(x,y)=i
		Next ;x
	Next ;y

	CloseFile f

End Function


Function grid()

If gridon=True
For x=0 To mapx
	For y=o To mapy
	Rect x*32,y*32,32,32,0
	Next
Next
EndIf

End Function


Function fill()
For x=0 To mapx
	For y=0 To mapy
    map(x,y)=5
	Next
Next
End Function</textarea><br><br><br><br>I need to create maps the SAME size in the game, as the editor...<br><br><br>Here's the CURRENT level editor AND game with media AND source: <br><br><br><a href="http://www.mediafire.com/?wpcx1uufi0x13f5" target="_blank">http://www.mediafire.com/?wpcx1uufi0x13f5</a><br><br><br>Thank you for the help! :)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1123945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ugh. I'm SO close. What could be wrong? :/ <br><br></td></tr></table><br>
<a name="1124010"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have a lot of code, that does nearly the same.. Why not put this into a function and call it?<br><br><pre class=code>If mode=1
For x=0 To mapx
	For Y=0 To mapy
		DrawImage tiles,X1+x*32,Y1+y*32,map(x,y)	
	Next	
Next
....
If mode=2
For x=0 To mapx
	For Y=0 To mapy
	DrawImage tiles,x*32,y*32,map(x,y)	
	If mapcol(x,y)=1
	Color 0,0,0
    Rect x*32,y*32,32,32,0
    EndIf
....	
</pre><br><br>better:<br><pre class=code>If mode=1
     DrawTiles
....
If mode=2
    DrawTiles
    Grid
   For x=0 To mapx
	For Y=0 To mapy
	If mapcol(x,y)=1
	Color 0,0,0
    Rect x*32,y*32,32,32,0
    EndIf
....	

Function DrawTiles()
   For x=0 To mapx
	For Y=0 To mapy
		DrawImage tiles,X1+x*32,Y1+y*32,map(x,y)	
	Next	
   Next
End Function
</pre><br><br><br><br>even better:<br><pre class=code>If mode=MODE_TILE_PLACE
     DrawTiles
....
If mode=MODE_KOLLISION
    DrawTiles
    Grid
   For x=0 To mapx
	For Y=0 To mapy
	If mapcol(x,y)=WITH_COLLISION
	    SetColor WHITE 
    Rect x*TILE_SIZE,y*TILE_SIZE,TILE_SIZE,TILE_SIZE,0
    EndIf
....	

Function DrawTiles()
   For x=0 To mapx
	For Y=0 To mapy
		DrawImage tiles,X_Off+x*TILE_SIZE,Y_Off+y*TILE_SIZE,map(x,y)	
	Next	
   Next
End Function
</pre><br><br><br><br><br>I can see some line which are responsible for Drawing Tiles on the Screen. Sometime you use a Scrolling-Offset X1, sometimes not. Why?<br><br>Next problem is to understand your code. You use a lot of numbers. This is no good style. Third persons can not understand what this code is good for.<br><br>sample:<br><br><pre class=code>If KeyHit(12) And mode=2 Then coltype=coltype-1
</pre><br><br>it would be better to define CONST at the beginning of the programm, the nto use this keywords instead of direct numbers:<br><pre class=code>CONST KEY_QUEST=12
CONST MODE_TILE_PLACE=1 , MODE_KOLLISION=2
If KeyHit(KEY_QUEST) And mode=MODE_KOLLISION Then coltype=coltype-1</pre><br><br><pre class=code>.....
    gy=MouseY()/32
	Color 256,0,0
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=currenttile
.....
</pre><br><br>better:<br><pre class=code> .....
    gy=MouseY()/32
    Color 256,0,0
    ShowCursor
    If MouseDown(1) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=currenttile
.....
Function ShowCursor()
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
End Function</pre><br><br>even better:<br><pre class=code>
CONST TILE_SIZE=32 
CONST RED=1, LEFT_MOUSE=1
 .....
    actCursorY=MouseY()/TILE_SIZE
    SetColor Red
    ShowCursor
    If MouseDown(LEFT_MOUSE) And actCursorX &lt; TILE_SIZE And actCursorY &lt; 24 Then map(gx,gy)=currenttile
.....
Function ShowCursor()
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
End Function

Function SetColor (ColorNumber%)
     Select ColorNumber
        Case RED
                 Color 255,0,0
    .....
End Function</pre><br><br><br><br>A variable name like X1% says not much about, why it is necessary, it would be better to name it Xoff%<br><br>Also your Grid() Function could handle all these RECT commands in one function... <br><br></td></tr></table><br>
<a name="1124017"></a>

<a name="1124018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I redid it so it's more conventional, but for some reason, it's still drawing tiles in the incorrect places. Also, what does "WITH_COLLISION" equal?<br><br><br>Here's my code: <br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Include "scancodes.bb"

Graphics 1024,768,0,2
AppTitle "Platform editor v2.0"
SetBuffer BackBuffer()
AutoMidHandle False		;Images placed by their top left
TFormFilter 0
;32
Dim map(32,24)
Dim mapcol(32,24)
Dim mapData(32,24)

Global mapx = 32
Global mapy = 24
Global mapx1 = 0
Global skypos
Global gridon = False
Global mapview = 1024

Global tiles = LoadAnimImage("gfx/Ztileset.bmp",32,32,0,10)
Global sky = LoadImage("gfx\sky1.bmp")
MaskImage tiles,255,0,255
TileImage sky

Global cursorx,cursory
Global gx,gy
Global currenttile=1
Global rpik,rpik2
Global rcol,rcol1,rcol2
Global mode=1
Global coltype=1

Const erasetile = 0
Const KEY_QUEST=12
Const MODE_TILE_PLACE=1 , MODE_COLLISION=2
Const TILE_SIZE=32 
Const RED=1, WHITE=2, LEFT_MOUSE=1
Const WITH_COLLISION = 5

fill()

Global X1 = 0
Global Y1 = 0

; Main
While Not KeyHit(1)
	
	
	
	Cls
	
	
	If KeyDown(k_right) Then X1 = X1 - 1
	If KeyDown(k_left) Then X1 = X1 + 1
	
	
	
	If KeyDown(k_down) Then Y1 = Y1 - 1
	If KeyDown(k_up) Then Y1 = Y1 + 1
	
	
	
	If X1 &lt; -mapx Then X1 = -mapx
	If X1 &gt; 0 Then X1 = 0
	
	
	
	If Y1 &lt; -mapy Then Y1 = -mapy
	If Y1 &gt; 0 Then Y1 = 0
	
	

sky()
update()
grid()
control()
info()



Text GraphicsWidth()/2, GraphicsHeight()/2, "X1: "+X1, 1, 1
Text GraphicsWidth()/2, GraphicsHeight()/2+20, "Y1: "+Y1, 1, 1



Flip



Wend



Function control()
	
	
	
If mode=1
   ; If KeyDown(k_left) = mapx Then mapx = mapx+1 : mapx1 = mapx1 +1
	If KeyHit(12) And mode=1 Then currenttile=currenttile-1
	If KeyHit(12) And mode=2 Then coltype=coltype-1
	If KeyHit(34) 
	If gridon=True
	gridon=False
	Else
    gridon=True
	EndIf
	EndIf
	
	If currenttile&lt;0 Then currenttile=9
	If currenttile&gt;9 Then currenttile=0
    If KeyHit(46) Then mode=2	
	gx=MouseX()/32
    actCursorX=MouseX()/TILE_SIZE
    actCursorY=MouseY()/TILE_SIZE
    SetColor(RED)
    ShowCursor()
	SetColor(WHITE)
    If MouseDown(LEFT_MOUSE) And actCursorX &lt; TILE_SIZE And actCursorY &lt; 24 Then map(gx,gy)=currenttile
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=currenttile
	If MouseDown(2) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=0
	
EndIf

If mode=2 
	If KeyHit(12) And mode=2 Then coltype=coltype-1
	If KeyHit(13) And mode=2 Then coltype=coltype+1
	If coltype&lt;1 Then coltype=1
	If coltype&gt;2 Then coltype=2
	
	Color 255,0,0
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
    gx=MouseX()/32
    gy=MouseY()/32
	If KeyHit(46) Then mode=1
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 And coltype=1 Then  mapcol(gx,gy)=1
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 And coltype=2 Then  mapcol(gx,gy)=2
	If MouseDown(2) And gx &lt; 32 And gy &lt; 24 Then mapcol(gx,gy)=0
EndIf


	If KeyHit(59)
		save("lvl1.map")
		supersave("lvl1_decrypted.map")
	EndIf
	
	If KeyHit(60)
    load("lvl1.map")
	EndIf
	
End Function



Function update()
	
	
	
	If mode=MODE_TILE_PLACE
		
		DrawTiles()
		
	ElseIf mode=MODE_COLLISION
		
		DrawTiles()
		
		grid()
		
		For x=0 To mapx
			
			For Y=0 To mapy
				
				If mapcol(x,y)=WITH_COLLISION
					
					Color 255, 255, 255
					
					Rect x*TILE_SIZE,y*TILE_SIZE,TILE_SIZE,TILE_SIZE,0
					
				EndIf
				
				
			Next
			
			
		Next
		
		
	EndIf
	
	

End Function


Function sky()

TileBlock sky,skypos,0 

skypos=skypos+1

End Function


Function info()

If mode=1
Text 100,0,"Press C to change to collision mode   leftclick = place tile   rightclick = remove tile   + and - change tiles"
Text 100,20,"F1 to save - F2 to load   Unfortunatly it only saves as (lvl1.lvl) SOZ"
Text 100,40,"Press D to change to data mode    Press G for grid mode " 

EndIf
If mode=2
Text 100,0,"Press C to change to scenery mode   leftclick = place collision   rightclick = remove collision"
EndIf

End Function



Function save(filename$)

	f=WriteFile(filename$)

	For y=0 To 24
		For x=0 To 32
			WriteInt f,map(x,y)
		Next
	Next
	
	For y=0 To 24
		For x=0 To 32
			WriteInt f,mapcol(x,y)
		Next
	Next

	CloseFile f

End Function



Function supersave(filename$)
	
	f=WriteFile(filename$)
	
	For y=0 To 24
		For x=0 To 32
			WriteLine f, "TileNumber: "+map(x,y)
		Next
	Next
	
	For y=0 To 24
		For x=0 To 32
			WriteLine f,"CollisionTileNumber: "+mapcol(x,y)
		Next
	Next
	
	CloseFile f
	
End Function



Function load(filename$)

	f=OpenFile(filename$)

	For y=0 To 24
		For x=0 To 32
			i=ReadInt(f)
			map(x,y)=i
		Next ;x
	Next ;y
	
	For y=0 To 24
		For x=0 To 32
			i=ReadInt(f)
			mapcol(x,y)=i
		Next ;x
	Next ;y

	CloseFile f

End Function



Function grid()

If gridon=True
For x=0 To mapx
	For y=o To mapy
	Rect x*32,y*32,32,32,0
	Next
Next
EndIf

End Function



Function fill()
For x=0 To mapx
	For y=0 To mapy
    map(x,y)=5
	Next
Next
End Function



Function DrawTiles()
	For x=0 To mapx
		For Y=0 To mapy
			DrawImage tiles,X1+x*32,Y1+y*32,map(x,y)	
		Next	
	Next
End Function



Function ShowCursor()
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
End Function



Function SetColor (ColorNumber%)
	
	Select ColorNumber
        Case RED
			Color 255,0,0
		Case WHITE
			Color 255,255,255
	End Select
	
End Function</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1124021"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> if you now use only the DrawTiles() function to draw any tile it is not longer possible, that the tiles are drawn in "incorrect places"! <br><br>The error must be in storing the tile-information in Map[] or in finding out the tile position before storing the map[]. Have a look on the Mouse() related functions. Also the problem could be caused by the Load functions?<br><br>Try to reduce the code to one remaining function GetTile(), which calculates the current tilepos X and Y by MouseX() and MouseY().<br><br>In a scrolled map window the cursor should also be shown considering the OffX and OffY. maybe this is better:<br><br><pre class=code>Function ShowCursor()
     GetTile()
 	Line X1+X,Y1+Y+16,X1+X+32,Y1#Y+16
	Line X1+X+16,Y1+Y,X1+X+16,Y1+Y+32
End Function</pre><br><br><br><br>Also all RECT-command should care about the OffX/OffY:<br><pre class=code>		For x=0 To mapx
			For Y=0 To mapy
				If mapcol(x,y)=WITH_COLLISION
					SetColor WHITE
					Rect X1+x*TILE_SIZE,Y1+y*TILE_SIZE,TILE_SIZE,TILE_SIZE,0
				EndIf
			Next
		Next
</pre><br><br>Also you should replace A L L Color commands with the new solution!<br><br>And of course my "+16" in the sample above with a HALF_TILE_SIZE const!!!<br><br>And I would exchange all "X1" with the name "Xoff" <br><br></td></tr></table><br>
<a name="1124023"></a>

<a name="1124030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, EXCEPT for the Xoff thing, NOW im confused... Here is what I have: <br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Include "scancodes.bb"

Graphics 1024,768,0,2
AppTitle "Platform editor v2.0"
SetBuffer BackBuffer()
AutoMidHandle False		;Images placed by their top left
TFormFilter 0
;32
Dim map(32,24)
Dim mapcol(32,24)
Dim mapData(32,24)

Global mapx = 32
Global mapy = 24
Global mapx1 = 0
Global skypos
Global gridon = False
Global mapview = 1024

Global tiles = LoadAnimImage("gfx/Ztileset.bmp",32,32,0,10)
Global sky = LoadImage("gfx\sky1.bmp")
MaskImage tiles,255,0,255
TileImage sky

Global cursorx,cursory
Global gx,gy
Global currenttile=1
Global rpik,rpik2
Global rcol,rcol1,rcol2
Global mode=1
Global coltype=1

Const erasetile = 0
Const KEY_QUEST=12
Const MODE_TILE_PLACE=1 , MODE_COLLISION=2
Const TILE_SIZE=32 
Const RED=1, WHITE=2, LEFT_MOUSE=1
Const WITH_COLLISION = 5

fill()

Global X1 = 0
Global Y1 = 0

; Main
While Not KeyHit(1)
	
	
	
	Cls
	
	
	If KeyDown(k_right) Then X1 = X1 - 1
	If KeyDown(k_left) Then X1 = X1 + 1
	
	
	
	If KeyDown(k_down) Then Y1 = Y1 - 1
	If KeyDown(k_up) Then Y1 = Y1 + 1
	
	
	
	If X1 &lt; -mapx Then X1 = -mapx
	If X1 &gt; 0 Then X1 = 0
	
	
	
	If Y1 &lt; -mapy Then Y1 = -mapy
	If Y1 &gt; 0 Then Y1 = 0
	
	

sky()
update()
grid()
control()
info()



Text GraphicsWidth()/2, GraphicsHeight()/2, "X1: "+X1, 1, 1
Text GraphicsWidth()/2, GraphicsHeight()/2+20, "Y1: "+Y1, 1, 1



Flip



Wend



Function control()
	
	
	
If mode=1
   ; If KeyDown(k_left) = mapx Then mapx = mapx+1 : mapx1 = mapx1 +1
	If KeyHit(12) And mode=1 Then currenttile=currenttile-1
	If KeyHit(12) And mode=2 Then coltype=coltype-1
	If KeyHit(34) 
	If gridon=True
	gridon=False
	Else
    gridon=True
	EndIf
	EndIf
	
	If currenttile&lt;0 Then currenttile=9
	If currenttile&gt;9 Then currenttile=0
    If KeyHit(46) Then mode=2	
	gx=MouseX()/32
    actCursorX=MouseX()/TILE_SIZE
    actCursorY=MouseY()/TILE_SIZE
    SetColor(RED)
    ShowCursor()
	SetColor(WHITE)
    If MouseDown(LEFT_MOUSE) And actCursorX &lt; TILE_SIZE And actCursorY &lt; 24 Then map(gx,gy)=currenttile
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=currenttile
	If MouseDown(2) And gx &lt; 32 And gy &lt; 24 Then map(gx,gy)=0
	
EndIf

If mode=2 
	If KeyHit(12) And mode=2 Then coltype=coltype-1
	If KeyHit(13) And mode=2 Then coltype=coltype+1
	If coltype&lt;1 Then coltype=1
	If coltype&gt;2 Then coltype=2
	
	Color 255,0,0
	Line MouseX()-10,MouseY(),MouseX()+10,MouseY()
	Line MouseX(),MouseY()-10,MouseX(),MouseY()+10
    gx=MouseX()/32
    gy=MouseY()/32
	If KeyHit(46) Then mode=1
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 And coltype=1 Then  mapcol(gx,gy)=1
	If MouseDown(1) And gx &lt; 32 And gy &lt; 24 And coltype=2 Then  mapcol(gx,gy)=2
	If MouseDown(2) And gx &lt; 32 And gy &lt; 24 Then mapcol(gx,gy)=0
EndIf


	If KeyHit(59)
		save("lvl1.map")
		supersave("lvl1_decrypted.map")
	EndIf
	
	If KeyHit(60)
    load("lvl1.map")
	EndIf
	
End Function



Function update()
	
	
	
	If mode=MODE_TILE_PLACE
		
		GetTiles()
		
	ElseIf mode=MODE_COLLISION
		
		GetTiles()
		
		grid()
		
		For x=0 To mapx
			
			For Y=0 To mapy
				
				If mapcol(x,y)=WITH_COLLISION
					
					Color 255, 255, 255
					
					Rect x*TILE_SIZE,y*TILE_SIZE,TILE_SIZE,TILE_SIZE,0
					
				EndIf
				
				
			Next
			
			
		Next
		
		
	EndIf
	
	

End Function


Function sky()

TileBlock sky,skypos,0 

skypos=skypos+1

End Function


Function info()

If mode=1
Text 100,0,"Press C to change to collision mode   leftclick = place tile   rightclick = remove tile   + and - change tiles"
Text 100,20,"F1 to save - F2 to load   Unfortunatly it only saves as (lvl1.lvl) SOZ"
Text 100,40,"Press D to change to data mode    Press G for grid mode " 

EndIf
If mode=2
Text 100,0,"Press C to change to scenery mode   leftclick = place collision   rightclick = remove collision"
EndIf

End Function



Function save(filename$)

	f=WriteFile(filename$)

	For y=0 To 24
		For x=0 To 32
			WriteInt f,map(x,y)
		Next
	Next
	
	For y=0 To 24
		For x=0 To 32
			WriteInt f,mapcol(x,y)
		Next
	Next

	CloseFile f

End Function



Function supersave(filename$)
	
	f=WriteFile(filename$)
	
	For y=0 To 24
		For x=0 To 32
			WriteLine f, "TileNumber: "+map(x,y)
		Next
	Next
	
	For y=0 To 24
		For x=0 To 32
			WriteLine f,"CollisionTileNumber: "+mapcol(x,y)
		Next
	Next
	
	CloseFile f
	
End Function



Function load(filename$)

	f=OpenFile(filename$)

	For y=0 To 24
		For x=0 To 32
			i=ReadInt(f)
			map(x,y)=i
		Next ;x
	Next ;y
	
	For y=0 To 24
		For x=0 To 32
			i=ReadInt(f)
			mapcol(x,y)=i
		Next ;x
	Next ;y

	CloseFile f

End Function



Function grid()

If gridon=True
For x=0 To mapx
	For y=o To mapy
	Rect x*32,y*32,32,32,0
	Next
Next
EndIf

End Function



Function fill()
For x=0 To mapx
	For y=0 To mapy
    map(x,y)=5
	Next
Next
End Function



;Function DrawTiles()
	;GetTiles()
;End Function



Function ShowCursor()
 	Line X1+X,Y1+Y+TILE_SIZE/2,X1+X+TILE_SIZE,Y1+Y+TILE_SIZE/2
	Line X1+X+TILE_SIZE/2,Y1+Y,X1+X+TILE_SIZE/2,Y1+Y+TILE_SIZE
End Function



Function SetColor (ColorNumber%)
	
	Select ColorNumber
        Case RED
			Color 255,0,0
		Case WHITE
			Color 255,255,255
	End Select
	
End Function



Function GetTiles()
	
	
	For x=0 To mapx
		For Y=0 To mapy
			If mapcol(x,y)=WITH_COLLISION
				SetColor WHITE
				Rect X1+x*TILE_SIZE,Y1+y*TILE_SIZE,TILE_SIZE,TILE_SIZE,0
			EndIf
		Next
	Next
	
	
End Function</textarea><br><br><br>Also, I sorta don't understand what you mean by it's drawing in incorrect places... :/ Sorry &gt;&lt;<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1124101"></a>

<a name="1124104"></a>

<a name="1124105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok... Now I had the time to have a deeper look on your code.<br><br>As I can see, you planned to set the scrolling not pixel by pixel but grid by grid. I found this line:<pre class=code>	If X1 &lt; -mapx Then X1 = -mapx
</pre><br>this says, that the scrolling should finish, when X1 is bigger then mapx, but mapx is 32. This cannot be pixels but rows or columns.<br><br>So you have to calculate the real scrolling by multiplicating the X1 with TILE_SIZE. So let us add this line:<br><pre class=code>OffX=X1*TILESIZE</pre> and use this OffX in all drawing commands:<br><pre class=code>Rect OffX+x*TILE_SIZE,OffY+y*TILE_SIZE,TILE_SIZE,TILE_SIZE,0
</pre>of course the same with Y1 and OffY<br><br>Now I cleaned up your Update() Function. Now it looks like this:<br><pre class=code>Function update()

		DrawTiles()
		
  		DrawGrid()
				
		DrawCurrentTile()

End Function</pre><br><br>it contains only three call of function, which take care about drawing tiles, the grid and a box which shows the current tile.<br><br>Here is the first:<br><pre class=code>Function DrawTiles()
		For x=0 To mapx
			For Y=0 To mapy
				DrawImage tiles,OffX+x*TILE_SIZE,OffY+y*TILE_SIZE,map(x,y)	
			Next	
		Next

End Function </pre><br>i think you understand what happens. Nothing special. The drawing uses the new OffX parameter.<br><br><br>here is the second:<br><pre class=code>

Function DrawGrid()
	If GridOn=True
		For x=0 To mapx
			For y=o To mapy
				If mapcol(x,y)=1
						SetColor BLACK
				ElseIf mapcol(x,y)=2
						Setcolor RED
				EndIf
					Rect OffX+X*TILE_SIZE , OffY+Y*TILE_SIZE , TILE_SIZE , TILE_SIZE ,0
			Next
		Next
	EndIf
End Function</pre><br>this paints the rects arounf the tiles and shows now all the time the status of the Collision at each tile<br><br>Now the third is a gift of me. It shows a box (like a window) that is always above the others and gives the user informations about the ccurrent tile and the current selected collision state<br><pre class=code>Function DrawCurrentTile()
	; draws a window to show all possible Tiles and the current:
		Local OffX%=15 , OffY%=715 , Border%=3
		
		; first a box
		SetColor BLACK
			Rect OffX-2*Border,OffY-2*Border,10*(TILE_SIZE+5)+4*Border,TILE_SIZE+4*Border
			SetColor GREY
			Rect OffX-Border, OffY-Border,10*(TILE_SIZE+5)+2*Border,TILE_SIZE+2*Border
		
		; then all tiles:
			For i=0 To 9
				DrawImage tiles,OffX+i*(TILE_SIZE+5),OffY,i
			Next
	
		; then the current:
		If coltype=2 
				SetColor RED
		Else
				Setcolor WHITE
		EndIf
			Rect OffX+CurrentTile*(TILE_SIZE+5) , OffY , TILE_SIZE , TILE_SIZE ,0
End Function
</pre><br><br><br>Now you should remove all drawing commands from the control() function. And there is no need for dividing the function into a mode=1 and a mode=2 part!<br><br>Remove the cursor cross code to a function ShowCursor() <br><br>Use 4 different key for the Collisions  and the tile selection. So you can both the same time. After that a mouse click would move the current tile and the current collision to a certain map position!<br><br>Bundle all key press commands into the control() function.<br><br><br>Your last problem now is the calculation of the map position from mouse coordinates:<br><br><pre class=code>
Global AktCursorX%,AktCursorY% 
.....

Function CalculateCursor()
	AktCursorX=MouseX()/TILE_SIZE-X1
	AktCursorY=MouseY()/TILE_SIZE-Y1
End Function</pre><br><br>Now you can write the code for ShowCursor() function:<br><br><pre class=code>Function ShowCursor()
	CalculateCursor()
	locX=OffX+AktCursorX * TILE_SIZE
	locY=OffY+AktCursorY * TILE_SIZE
	
 	Line locX , locY+TILE_SIZE/2 , locX+TILE_SIZE , locY+TILE_SIZE/2
	Line locX+TILE_SIZE/2 , locY , locX+TILE_SIZE/2 , locY+TILE_SIZE
End Function
</pre><br><br>will be continued....<br><br><br>here is the whole code (attention: i temp. removed the save/load functions()<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Include "scancodes.bb"

Graphics 1024,768,0,2
AppTitle "Platform editor v2.0"
SetBuffer BackBuffer()
AutoMidHandle False		;Images placed by their top left 
TFormFilter 0 ;32

Const erasetile = 0
Const KEY_QUEST=12
Const MODE_TILE_PLACE=1 , MODE_COLLISION=2
Const TILE_SIZE=32 
Const RED=1, WHITE=2, BLACK=3 , GREY=4 , YELLOW=5 , LEFT_MOUSE=1
Const WITH_COLLISION = 5





Dim map(32,24)
Dim mapcol(32,24)
Dim mapData(32,24)

Global mapx = 32
Global mapy = 24
Global mapx1 = 0
Global skypos
Global gridon = False
Global mapview = 1024

Global tiles = LoadAnimImage("gfx/Ztileset.bmp",32,32,0,10)
Global sky = LoadImage("gfx\sky1.bmp")
MaskImage tiles,255,0,255
TileImage sky

Global AktCursorX,AktCursorY
Global gx,gy
Global currenttile=1
Global rpik,rpik2
Global rcol,rcol1,rcol2
Global mode=1
Global coltype=1


fill()

Global X1%, Y1%, OffX%, OffY%

; Main
While Not KeyHit(1)
	
	
	
	Cls
	
	
	If KeyDown(k_right) Then X1 = X1 - 1
	If KeyDown(k_left) Then X1 = X1 + 1
	
	
	
	If KeyDown(k_down) Then Y1 = Y1 - 1
	If KeyDown(k_up) Then Y1 = Y1 + 1
	
	
	
	If X1 &lt; -mapx Then X1 = -mapx
	If X1 &gt; 0 Then X1 = 0
	
	
	
	If Y1 &lt; -mapy Then Y1 = -mapy
	If Y1 &gt; 0 Then Y1 = 0
	
	OffX=X1*TILE_SIZE
	OffY=Y1*TILE_SIZE


update()

control()




Text GraphicsWidth()/2, GraphicsHeight()/2, "X1: "+X1, 1, 1
Text GraphicsWidth()/2, GraphicsHeight()/2+20, "Y1: "+Y1, 1, 1



Flip



Wend



Function control()
	
	
	If KeyHit(12)  Then currenttile=currenttile-1
	If KeyHit(13)  Then currenttile=currenttile+1
	If currenttile&lt;0 Then currenttile=9
	If currenttile&gt;9 Then currenttile=0

	
	If KeyHit(34) 
		If gridon=True
			gridon=False
		Else
		    gridon=True
		EndIf
	EndIf
	

	If MouseHit(LEFT_MOUSE)
		CalculateCursor()
		Map(AktCursorX,AktCursorY)=CurrentTile
		MapCol(AktCursorX,AktCursorY)=ColType
	EndIf
	
	
	; changed: keys &lt;1&gt;  for the coltype: 
	If KeyHit(2)  Then coltype=(coltype+1) Mod 3

	If KeyHit(59)
		;save("lvl1.map")
		;supersave("lvl1_decrypted.map")
	EndIf
	
	If KeyHit(60)
	    ;load("lvl1.map")
	EndIf
	
End Function






Function update()

		DrawTiles()
		
  		DrawGrid()
		ShowCursor()
				
		DrawCurrentTile()

End Function





Function DrawGrid()
	If GridOn=True
		For x=0 To mapx
			For y=o To mapy
				SetColor BLACK
				Rect OffX+X*TILE_SIZE , OffY+Y*TILE_SIZE , TILE_SIZE , TILE_SIZE ,0
				If mapcol(x,y)&gt;0

						If mapcol(x,y)=1
							Setcolor RED
						DebugLog  x
						ElseIf mapcol(x,y)=2
							Setcolor YELLOW
					    EndIf
						Rect OffX+X*TILE_SIZE+1 , OffY+Y*TILE_SIZE+1 , TILE_SIZE-2 , TILE_SIZE-2 ,0
				EndIf
			Next
		Next
	EndIf
End Function





Function fill()
	For x=0 To mapx
		For y=0 To mapy
	    map(x,y)=5
		Next
	Next
End Function





Function DrawTiles()
		For x=0 To mapx
			For Y=0 To mapy
				DrawImage tiles,OffX+x*TILE_SIZE,OffY+y*TILE_SIZE,map(x,y)	
			Next	
		Next
End Function 




Function SetColor (ColorNumber%)	
	Select ColorNumber
		Case BLACK
			Color 1,1,1
		Case GREY
			Color 111,111,111
        Case RED
			Color 255,0,0
		Case WHITE
			Color 255,255,255
		Case YELLOW
			Color 255,255,0
	End Select
End Function




Function DrawCurrentTile()
	; draws a window to show all possible Tiles and the current:
		Local OffX%=15 , OffY%=715 , Border%=3
		
		; first a box
		SetColor BLACK
			Rect OffX-2*Border,OffY-2*Border,10*(TILE_SIZE+5)+4*Border,TILE_SIZE+4*Border
			SetColor GREY
			Rect OffX-Border, OffY-Border,10*(TILE_SIZE+5)+2*Border,TILE_SIZE+2*Border
		
		; then all tiles:
			For i=0 To 9
				DrawImage tiles,OffX+i*(TILE_SIZE+5),OffY,i
			Next
	
		; then the current:
		    If coltype=1 
				SetColor RED
			ElseIf coltype=2
				Setcolor YELLOW
			Else
				Setcolor WHITE
			EndIf
			Rect OffX+CurrentTile*(TILE_SIZE+5) , OffY , TILE_SIZE , TILE_SIZE ,0
End Function




Function CalculateCursor()
	AktCursorX=MouseX()/TILE_SIZE-X1
	AktCursorY=MouseY()/TILE_SIZE-Y1
End Function




Function ShowCursor()
	CalculateCursor()
	locX=OffX+AktCursorX * TILE_SIZE
	locY=OffY+AktCursorY * TILE_SIZE
	
 	Line locX , locY+TILE_SIZE/2 , locX+TILE_SIZE , locY+TILE_SIZE/2
	Line locX+TILE_SIZE/2 , locY , locX+TILE_SIZE/2 , locY+TILE_SIZE
End Function

</textarea><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1124143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, it sorta works.. When I use mousedown(), and move it with the arrows, then move it back to the left, it glitches for some reason, and draws tiles in the wrong place. I need to use mousedown so I don't have to draw something that needs to be drawn more than once, one by one.<br><br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Include "scancodes.bb"

Graphics 1024,768,0,2
AppTitle "Platform editor v2.0"
SetBuffer BackBuffer()
AutoMidHandle False		;Images placed by their top left 
TFormFilter 0 ;32

Const erasetile = 0
Const KEY_QUEST=12
Const MODE_TILE_PLACE=1 , MODE_COLLISION=2
Const TILE_SIZE=32 
Const RED=1, WHITE=2, BLACK=3 , GREY=4 , YELLOW=5 , LEFT_MOUSE=1
Const WITH_COLLISION = 5





Dim map(32,24)
Dim mapcol(32,24)
Dim mapData(32,24)

Global mapx = 32
Global mapy = 24
Global mapx1 = 0
Global skypos
Global gridon = False
Global mapview = 1024

Global tiles = LoadAnimImage("gfx/Ztileset.bmp",32,32,0,10)
Global sky = LoadImage("gfx\sky1.bmp")
MaskImage tiles,255,0,255
TileImage sky

Global AktCursorX,AktCursorY
Global gx,gy
Global currenttile=1
Global rpik,rpik2
Global rcol,rcol1,rcol2
Global mode=1
Global coltype=1


fill()

Global X1%, Y1%, OffX%, OffY%

; Main
While Not KeyHit(1)
	
	
	
	Cls
	
	
	If KeyDown(k_right) Then X1 = X1 - 1
	If KeyDown(k_left) Then X1 = X1 + 1
	
	
	
	If KeyDown(k_down) Then Y1 = Y1 - 1
	If KeyDown(k_up) Then Y1 = Y1 + 1
	
	
	
	If X1 &lt; -mapx Then X1 = -mapx
	If X1 &gt; 0 Then X1 = 0
	
	
	
	If Y1 &lt; -mapy Then Y1 = -mapy
	If Y1 &gt; 0 Then Y1 = 0
	
	OffX=X1*TILE_SIZE
	OffY=Y1*TILE_SIZE
	
	
	update()
	
	control()
	
	
	
	
	Text GraphicsWidth()/2, GraphicsHeight()/2, "X1: "+X1, 1, 1
	Text GraphicsWidth()/2, GraphicsHeight()/2+20, "Y1: "+Y1, 1, 1
	
	
	
	Flip
	
	
	
Wend



Function control()
	
	
	If KeyHit(12)  Then currenttile=currenttile-1
	If KeyHit(13)  Then currenttile=currenttile+1
	If currenttile&lt;0 Then currenttile=9
	If currenttile&gt;9 Then currenttile=0
	
	
	If KeyHit(34) 
		If gridon=True
			gridon=False
		Else
		    gridon=True
		EndIf
	EndIf
	
	
	If MouseDown(LEFT_MOUSE)
		CalculateCursor()
		map(AktCursorX,AktCursorY)=currenttile
		mapcol(AktCursorX,AktCursorY)=coltype
	EndIf
	
	
	; changed: keys &lt;1&gt;  for the coltype: 
	If KeyHit(2)  Then coltype=(coltype+1) Mod 3
	
	If KeyHit(59)
		;save("lvl1.map")
		;supersave("lvl1_decrypted.map")
	EndIf
	
	If KeyHit(60)
	    ;load("lvl1.map")
	EndIf
	
End Function






Function update()
	
	DrawTiles()
	
	DrawGrid()
	ShowCursor()
	
	DrawCurrentTile()
	
End Function





Function DrawGrid()
	If gridon=True
		For x=0 To mapx
			For y=o To mapy
				SetColor BLACK
				Rect OffX+X*TILE_SIZE , OffY+Y*TILE_SIZE , TILE_SIZE , TILE_SIZE ,0
				If mapcol(x,y)&gt;0
					
					If mapcol(x,y)=1
						SetColor RED
						DebugLog  x
					ElseIf mapcol(x,y)=2
						SetColor YELLOW
					EndIf
					Rect OffX+X*TILE_SIZE+1 , OffY+Y*TILE_SIZE+1 , TILE_SIZE-2 , TILE_SIZE-2 ,0
				EndIf
			Next
		Next
	EndIf
End Function





Function fill()
	For x=0 To mapx
		For y=0 To mapy
			map(x,y)=5
		Next
	Next
End Function





Function DrawTiles()
	For x=0 To mapx
		For Y=0 To mapy
			DrawImage tiles,OffX+x*TILE_SIZE,OffY+y*TILE_SIZE,map(x,y)	
		Next	
	Next
End Function 




Function SetColor (ColorNumber%)	
	Select ColorNumber
		Case BLACK
			Color 1,1,1
		Case GREY
			Color 111,111,111
        Case RED
			Color 255,0,0
		Case WHITE
			Color 255,255,255
		Case YELLOW
			Color 255,255,0
	End Select
End Function




Function DrawCurrentTile()
	; draws a window to show all possible Tiles and the current:
	Local OffX%=15 , OffY%=715 , Border%=3
	
		; first a box
	SetColor BLACK
	Rect OffX-2*Border,OffY-2*Border,10*(TILE_SIZE+5)+4*Border,TILE_SIZE+4*Border
	SetColor GREY
	Rect OffX-Border, OffY-Border,10*(TILE_SIZE+5)+2*Border,TILE_SIZE+2*Border
	
		; then all tiles:
	For i=0 To 9
		DrawImage tiles,OffX+i*(TILE_SIZE+5),OffY,i
	Next
	
		; then the current:
	If coltype=1 
		SetColor RED
	ElseIf coltype=2
		SetColor YELLOW
	Else
		SetColor WHITE
	EndIf
	Rect OffX+currenttile*(TILE_SIZE+5) , OffY , TILE_SIZE , TILE_SIZE ,0
End Function




Function CalculateCursor()
	AktCursorX=MouseX()/TILE_SIZE-X1
	AktCursorY=MouseY()/TILE_SIZE-Y1
End Function




Function ShowCursor()
	CalculateCursor()
	locX=OffX+AktCursorX * TILE_SIZE
	locY=OffY+AktCursorY * TILE_SIZE
	
 	Line locX , locY+TILE_SIZE/2 , locX+TILE_SIZE , locY+TILE_SIZE/2
	Line locX+TILE_SIZE/2 , locY , locX+TILE_SIZE/2 , locY+TILE_SIZE
End Function</textarea><br><br><br><br>Thanks, MidiMaster! :) <br><br></td></tr></table><br>
<a name="1124153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> shouldn't you pack all key commands into the control() function?<br><br>Do you want grid scrolling or pixel scrolling?<br><br>I could not repeat the bug you told me! <br><br>MouseDown is also OK! But i think the grid scrolling is too fast in combination with the MouseDown(), or?<br><br>Perhaps you should permit scrolling keys while mouse is pressed? <br><br></td></tr></table><br>
<a name="1124156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, what I need, is when you hold down the left mousebutton, then 1 of the cursor keys, it draws the selected tile in the correct area, no matter what speed, no matter how big the map is. :)<br><br><br>Thanks, MidiMaster! :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
