<!DOCTYPE html><html lang="en" ><head ><title >Aligning an entity to my verlet construct.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Aligning an entity to my verlet construct.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Aligning an entity to my verlet construct.</a><br><br>
<a name="296032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I for the life of me can't figure out how to align an entity to a verlet construct.   <br><br>  I am currently doing it by finding the vector between two verelt particles along the constructs Z axis, then finding one for along the verlet constructs X axis.  But using aling to vector for one, then the other, doesnt seem to work.  Any ideas? <br><br></td></tr></table><br>
<a name="296043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> NM, I got it. <br><br></td></tr></table><br>
<a name="296081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> ShatteredReality,<br><br>Would you mind sharing your find. I'm working on a verlet integrator myself and will soon have to deal with this.<br><br>thanx <br><br></td></tr></table><br>
<a name="296085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RayTracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had the same problem a while ago , and i solved it by using a center verlet and 2 other auxiliary verlets ,and then alligntovector <br><pre class=code>
			For cc.construct = Each construct    ;&lt;- PROBLEM?
			If cc\stopped = 0 Then
				PositionEntity cc\m_cg,EntityX(cc\v[0]\m,True),EntityY(cc\v[0]\m,True),EntityZ(cc\v[0]\m,True)
				x#=EntityX(cc\x1[1]\m)-EntityX(cc\v[0]\m) 
				y#=EntityY(cc\x1[1]\m)-EntityY(cc\v[0]\m) 
				z#=EntityZ(cc\x1[1]\m)-EntityZ(cc\v[0]\m) 
				AlignToVector cc\m_cg, x#, y#, z#, 2 

				x#=EntityX(cc\x2[1]\m)-EntityX(cc\v[0]\m) 
				y#=EntityY(cc\x2[1]\m)-EntityY(cc\v[0]\m) 
				z#=EntityZ(cc\x2[1]\m)-EntityZ(cc\v[0]\m) 
				AlignToVector cc\m_cg, x#, y#, z#, 3
			End If
			Next

</pre><br><br>cc\v[0] - center verlet<br>cc\x1 and cc\x2 - aux verlets<br>cc\m_cg - object <br><br></td></tr></table><br>
<a name="296189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> ghostdag,<br><br>thanx for the code. I have to figure out what the construct is, but, I'm sure that i can.<br><pre class=code>For construct.construct = Each construct    ;&lt;- PROBLEM?
	If not construct\stopped

		PositionEntity construct\entity%,EntityX(construct\v[0]\pivot%,True),EntityY(construct\v[0]\pivot%,True),EntityZ(construct\v[0]\pivot%,True)
		x#=EntityX(construct\x1[1]\pivot%)-EntityX(construct\v[0]\pivot%) 
		y#=EntityY(construct\x1[1]\pivot%)-EntityY(construct\v[0]\pivot%) 
		z#=EntityZ(construct\x1[1]\pivot%)-EntityZ(construct\v[0]\pivot%) 

		AlignToVector construct\entity%, x#, y#, z#, 2 
		x#=EntityX(construct\x2[1]\pivot%)-EntityX(construct\v[0]\pivot%) 
		y#=EntityY(construct\x2[1]\pivot%)-EntityY(construct\v[0]\pivot%) 
		z#=EntityZ(construct\x2[1]\pivot%)-EntityZ(construct\v[0]\pivot%) 

		AlignToVector construct\entity%, x#, y#, z#, 3
	End If
Next</pre> <br><br></td></tr></table><br>
<a name="296264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ghostdag does it the same way as myself. <br><br></td></tr></table><br>
<a name="296523"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RayTracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> the problem i am having using verlet physics is that i can't get it to be rigid enough especialy when the construct is thin,like a board, is there any method of improoving rigidity ? <br><br></td></tr></table><br>
<a name="296611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Miracle</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> To improve rigidity you'd either need to slow things down or increase the number of iterations, both of which can get pretty expensive. It's hard to keep something flat from going all over the place. <br><br></td></tr></table><br>
<a name="296630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> To Gurus who have implemented Thomas Jakobsen's Verlet Integrator Character Physics:<br><br>I'm currently searching for the (C2) Sqrt Approximation with respect to particle masses. My code simply does not work:<pre class=code>delta=x2-x1
delta=delta*restlength^2/((dotproduct(delta,delta)*(invmass1+invmass2))+restlength^2)-(invmass1+invmass2) &lt;-- trouble starts here
x1=x1-delta*invmass1
x2=x2+delta*invmass2</pre>Your assistance is valued. thanx <br><br></td></tr></table><br>
<a name="296638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Forget the sqrt approximation... it doesn't make anything faster.<br><br>On my Athlon 1800xp... sqr was as fast as fetching data from an array. So it isn't worth the hassle.<br><br>Btw. I didn't get it to work either. It's wrong in the paper. <br><br></td></tr></table><br>
<a name="296657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bouncer,<br><br>Interestingly, I could not get the standard formula to work. I had success with the standard sqr approx formula. I desire to tinker with masses and would like to use the sqr approx formula. <br> <br>I would prefer to keep the number operations to a minimum and the sqr approx offers this. Thanks for you insight. <br><br></td></tr></table><br>
<a name="296682"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Miracle</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't need to use any odd formulas just to incorporate mass into your equations.<br><br>Here's how the SetDistance function works in my own Verlet integration routine:<br><br>1. Find the vector between point 1 and point 2.<br>2. Find the length of that vector using your math of choice. I just used Sqr((x*x)+(y*y)+(z*z)), which is plenty fast.<br>3. If that delta length is &lt;= 0, set it to some very small number.<br>4. diff# = (deltalength - distance you want the two points to be apart)/deltalength.<br>5. totalmass# = (mass of particle 1) + (mass of particle 2).<br>6. Multiply the vector you found in Step 1 by (diff * (mass of particle 2/totalmass)) and subtract the result from the position of particle 1.<br>7. Multiply the vector you found in Step 1 by (diff * (mass of particle 1/totalmass)) and add the result to the position of particle 2.<br><br>Trust me, it works great. With this system, particles of high mass move proportionately more slowly, which gives you the whole off-center rotational thing you're looking for.<br><br>I also use this same function in my collision routines, which makes things bounce off each other wonderfully. Can't use Blitz collisions with this system, though. <br><br></td></tr></table><br>
<a name="296697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Miracle,<br><br>Thank you for your insight. I have been able to reduce the number of operations to 1/3 using the Sqr approx. However, I will give your suggestion a try. <br><br><div class="quote"> Can't use Blitz collisions with this system, though. <br></div>Please elaborate. <br><br></td></tr></table><br>
<a name="296710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Miracle</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Please elaborate. <br></div><br><br>Blitz collisions work great for things like keeping a car from falling through the ground or other movable-to-immovable object collisions. But if, say, you have two cars and want them to collide and bounce realistically off each other, Blitz collisions don't do as well.<br><br>The way Blitz collisions work, one object runs into another and stops cold (or slides around it). This dynamically changes the position of the moving object, but doesn't change the object it just ran into. Since the change in relative positions of objects are a big part of how Verlet physics work, you end up with one object bouncing off the other as if the other object had infinite mass.<br><br>On the other hand, if you handle collisions mathematically (i.e. "Oops, particle A is too close to particle B, I need to push them apart"), you can change the positions of both particles simultaneously, which makes them bounce off each other in a more realistic fashion. On the down side, this method is a lot more work since it requires you to keep track of which particle is getting too close to which other particle. If you only have two or three moving items, it's not so bad. If you're throwing around ten thousand bouncing constructs, however, it gets a little complicated. <br><br></td></tr></table><br>
<a name="296733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> miracle, check out the moving-moving collision lib by binary_moon(I think...). It is being optimized right now by sswift. I'll be using it for my physics system once it's finalized. <br><br></td></tr></table><br>
<a name="296741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was done by SimonH if I remember correctly.... <br><br></td></tr></table><br>
<a name="296807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> doh. Well, binary_moon was talking to sswift alot about it in the last topic. Probably simonh. Actually, yeah. now I remember... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
