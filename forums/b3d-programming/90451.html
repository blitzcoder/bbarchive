<!DOCTYPE html><html lang="en" ><head ><title >Run a Blitz3D .exe by clicking on a data file?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Run a Blitz3D .exe by clicking on a data file?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Run a Blitz3D .exe by clicking on a data file?</a><br><br>
<a name="1028168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cold Storage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many programs can run by being associated with a file type.<br><br>Is it possible to do this in Blitz 3D?<br><br>Here's a (naff) but simple example;<br><br>You write a simple text editor in Blitz3D called b3dtext.exe which writes out files with the extension .b3t<br><br>The user associated .b3t files with b3dtext.exe.<br><br>The user double-clicks on a .b3t file which causes b3dtext.exe to run, and also opens the file.<br><br>Thanks in advance for any help... ;O)<br><br>P.S. <br>How would you automate the process of associating .b3t files with b3dtext.exe? I'm guessing this is something your installation program should do in the registry? Then of course there's the thorny topic of if it's done one way in WinXP how is this done for Vista / Win7. <br><br></td></tr></table><br>
<a name="1028186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm pretty sure that Windows has an API to create a file association, which should work the same on all versions of windows.<br><br>The file association itself would specify the name of the executable, plus the necessary parameters that get passed when one double-clicks on the file. <br>One of those parameters is normally %1, which indicates the name of the file you clicked on. <br><br></td></tr></table><br>
<a name="1028208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is definitely more related to Windows internals than B3D. You should focus your study in that.<br><br>Try reading this: <a href="http://technet.microsoft.com/en-us/library/cc749986(printer).aspx" target="_blank">http://technet.microsoft.com/en-us/library/cc749986(printer).aspx</a><br><br>It explains how things work with the registry. If you can add that to the registry (any good Setup Maker application allows you to add things to the registry), you can make your application be associated with a certain filetype. <br><br>Of course, <b>always</b> ask the user before doing anything, and <b>always</b> put the choice as "off" to begin with. <br><br></td></tr></table><br>
<a name="1028215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure how you set file associations programmatically, but you can do it manually by right clicking on the data file, clicking on the 'Properties' menu option, and then by using the Properties window to change which program is set to open files with that file extension.<br><br>The Blitz3D program should use the CommandLine$() function to get the path to the file to be opened (which will probably be surrounded by quotes, which you will need to remove).<br><br>eg. filepath$ = Replace$(CommandLine$(), chr(34), "")<br><br>Apparently you use the registry to programmatically set file associations.<br><br>INFO: <a href="http://support.microsoft.com/kb/122787" target="_blank">http://support.microsoft.com/kb/122787</a> (Scroll down to 'Using a Program to Set File Associations'.) <br><br></td></tr></table><br>
<a name="1028280"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bill is right.  File associations are held in the registry - u'll need to use userlibs to modify registry values and add your '.b3t' files to the list.  Then, yes, it should be a simple CommandLine$() to get the path of the file that was 'opened'. <br><br></td></tr></table><br>
<a name="1028366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe it is possible to use innosetup&amp;istool to associate files? Probably it is best if an installer performs the file associations. <br><br></td></tr></table><br>
<a name="1028483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cold Storage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys!<br><br>I'll see if I can get it working... ;O) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
