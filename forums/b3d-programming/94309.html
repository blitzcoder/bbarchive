<!DOCTYPE html><html lang="en" ><head ><title >Collisions with Entites and Planes</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Collisions with Entites and Planes</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Collisions with Entites and Planes</a><br><br>
<a name="1081417"></a>

<a name="1081419"></a>

<a name="1081420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi i need a bit of help. I keep on having my characters falling through the plane (infinite groud) rather than stopping when they hit it.  <br>I did do a cop out. Here is the code below. I would like to remove the cop out and do it properly.<br>PS: I did 2 player movements and 2 different screen modes.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Global plyr1dir
Global plyr2dir

;recreate missing images
RestoreBMP()

;3d graphics mode
Graphics3D 640,480,16,3



;Collision Types
Const clsn_plyrs=1,clsn_Cube=2

;Set collisions
Collisions clsn_plyrs,clsn_plyrs,1,2
;Collisions clsn_plyrs,clsn_Plane,1,2
Collisions clsn_plyrs,clsn_Cube,2,2



;make a texture for the battle plane (its a grid for now)
PlaneTex=CreateTexture(32,32)
SetBuffer TextureBuffer(PlaneTex)
Color 84,84,252
Rect 0,0,32,32
For alllines=0 To 2
	Color 42-(alllines Mod 2)*42,42-(alllines Mod 2)*42,210-(alllines Mod 2)*42
	Line alllines,1,alllines+29,30
	Line alllines,30,alllines+29,1
Next
Color 0,0,0
For allsquares=0 To 3
	Rect allsquares/2*16,16*(allsquares Mod 2),16,16,0
Next
Color 0,0,168
Line 0,0,31,31
Line 0,31,31,0

;create cube
cube=CreateCube()
EntityColor cube,255,1,1
PositionEntity cube,0,1,0
EntityType cube,clsn_Cube

;create infinite plane to battle on
BtlPlane=CreatePlane()
EntityTexture BtlPlane,PlaneTex
PositionEntity BtlPlane,0,0,0
EntityType BtlPlane,clsn_Plane

;createlight and position it at 0,10,0
btlLight=CreateLight(2)
PositionEntity btllight,0,10,0

;double buffer
SetBuffer BackBuffer()

;make Player 1
Player1=CreateSprite()
Plyr1Tex=LoadAnimTexture("Char1.bmp",7,16,16,0,2)
EntityTexture Player1,Plyr1Tex,0
ScaleSprite Player1,.5,.5
;HandleSprite player1,0,-1
SpriteViewMode player1,2

;make a player1 sphere (temporary) Helps me with collision radius
P1Sphere=CreateSphere(8,Player1)
EntityColor P1Sphere,0,255,0
EntityAlpha P1Sphere,.3
ScaleEntity P1Sphere,.25,.5,.25
PositionEntity P1Sphere,0,0,0

;set collision type
EntityRadius Player1,.25,.5 ;#x#z,#y
EntityType Player1,clsn_plyrs

;make camera 1a
Cam1A = CreateCamera(Player1)
CameraViewport Cam1A,1,1,318, 238
CameraProjMode Cam1A,2 ;make 3d look 2d (my preference)
PositionEntity Cam1A, 0,6,-5
RotateEntity Cam1A,45,0,0
;CameraRange Cam1A,1,10
CameraZoom Cam1A,0.25

;make camera 1b
cam1b = CreateCamera(Player1)
CameraViewport cam1b,1,241,318, 238
PositionEntity cam1b, 0, 6,-6
RotateEntity cam1b,45,0,0
;CameraRange cam1b,1,10
CameraZoom cam1b,3

PositionEntity player1,0,5,0



;make Player 2
Player2=CreateSprite()
Plyr2Tex=LoadAnimTexture("Char2.bmp",7,16,16,0,2)
EntityTexture Player2,Plyr1Tex,0
ScaleSprite Player2,.5,.5
SpriteViewMode player2,2

;make a player1 sphere (temporary) Helps me with collision radius
P2Sphere=CreateSphere(8,Player2)
EntityColor P2Sphere,0,255,255
EntityAlpha P2Sphere,.3
ScaleEntity P2Sphere,.25,.5,.25
PositionEntity P2Sphere,0,0,0

;set collision type
EntityRadius Player2,.25,.5 ;#x#z,#y
EntityType Player2,clsn_plyrs



;make camera 2a
Cam2A = CreateCamera(Player2)
CameraViewport Cam2A,321,1,318, 238
CameraProjMode Cam2A,2 ;make 3d look 2d (my preference)
PositionEntity Cam2A, 0, 6,-5
RotateEntity Cam2A,45,0,0
CameraZoom Cam2A,0.25

;make camera 2b
cam2b = CreateCamera(Player2)
CameraViewport cam2b,321,241,318, 238
PositionEntity cam2b, 0, 6,-6
RotateEntity cam2b,45,0,0
CameraZoom cam2b,3

PositionEntity player2,-5,5,0

;Player 1 Direction (0=Right 1=Left)
Plyr1Dir=0
;Player 2 Direction (0=Right 1=Left)
Plyr2Dir=0
;main loop
Repeat
	;PULL PLAYERS DOWN. (THIS IS TEMPORARY)
	MoveEntity player1,0,-.025,0
	MoveEntity player2,0,-.025,0
	;MAKE SURE THAT PLAYERS DO NOT SINK BELOW THE BATTLE PLANE
	;IS THERE A BETTER WAY TO DO THIS? ANYONE?
	;PS: THESE 2 LINES ARE THE "COP OUTS"
	;REMOVE THEM AND SEE WHAT HAPPENS
	If EntityY(player1)&lt;0.5 Then PositionEntity player1,EntityX(player1),.5,EntityZ(player1)
	If EntityY(player2)&lt;0.5 Then PositionEntity player2,EntityX(player2),.5,EntityZ(player2)

	;control player 1
	object_Ctrl Player1,Plyr1Tex,0
	object_Ctrl Player2,Plyr2Tex,1
	;show 3d world
	UpdateWorld
	RenderWorld
	;show 2d stuff


	;MEMORY STUFF
	If AvailVidMem()&gt;=0
		If (AvailVidMem()/1024)/1024&gt;0  avail$=(AvailVidMem()/1024)/1024+" MB"
		If (AvailVidMem()/1024)/1024=0 
			If AvailVidMem()/1024=0  avail$=AvailVidMem()+" B"
			If AvailVidMem()/1024&gt;0  avail$=AvailVidMem()/1024+" KB"
		End If
	End If
	If TotalVidMem()&lt;0 Or AvailVidMem()&lt;0  avail$="Unknown":total$=avail$
	If TotalVidMem()&gt;=0
		If (TotalVidMem()/1024)/1024&gt;0
			Total$=(TotalVidMem()/1024)/1024+" MB"
			perc$=((AvailVidMem()/1024)/1024)*100/((TotalVidMem()/1024)/1024)+"% "
		ElseIf (TotalVidMem()/1024)/1024=0
			If TotalVidMem()/1024&gt;0
				total$=TotalVidMem()/1024+" KB"
				perc$=(AvailVidMem()/1024)*100/(TotalVidMem()/1024)+"% "
			ElseIf TotalVidMem()/1024=0
				total$=TotalVidMem()+" B"
				perc$=AvailVidMem()*100/TotalVidMem()+"% "
			End If
		End If
	End If


	;TEXT STUFF
	For alltext=0 To 1
		Color alltext*255,alltext*255,alltext*255
		Text 9-alltext,217-alltext, "Distance from Cube: "+Int(EntityDistance(Player1,Cube)*10)/10+"."+(Int(EntityDistance(Player1,Cube)*10) Mod 10)
		Text 329-alltext,217-alltext, "Distance from Cube: "+Int(EntityDistance(Player2,Cube)*10)/10+"."+(Int(EntityDistance(Player2,Cube)*10) Mod 10)

		Text 245-alltext,249-alltext, "Player Distance: "+Int(EntityDistance(Player1,Player2)*10)/10+"."+(Int(EntityDistance(Player1,Player2)*10) Mod 10)
		Text (80-Len(" Free VidMem: "+avail$))*4+1-alltext,233-alltext, " Free VidMem: "+avail$
		Text 9-alltext,233-alltext, "Total VidMem: "+Total$
		Text (79-Len(perc$+"VidMem Remaining"))*8+1-alltext,233-alltext, perc$+"VidMem Remaining"
		Text 9-alltext,9-alltext,"Player 1 CamProjMode 2"
		Text 9-alltext,25-alltext,"5 1 2 3 NumPad"
		Text 329-alltext,9-alltext,"Player 2 CamProjMode 2"
		Text 329-alltext,25-alltext,"W A S D Keys"
		Text 9-alltext,456-alltext,"Player 1 CamProjMode 1"
		Text 329-alltext,456-alltext,"Player 2 CamProjMode 1"
	Next
	Text 9,100,EntityX(player1)+","+EntityY(player1)+","+EntityZ(player1)
	Text 329,100,EntityX(player2)+","+EntityY(player2)+","+EntityZ(player2)
	Flip
	Cls
Until KeyHit(1)

;removes everything within the world (entities textures brushes)
ClearWorld

EndGraphics
End

;Control function
Function object_Ctrl(PromptObj,PromptTex,PromptCtrl)
	If promptctrl=0  CtrlUp=76:CtrlDn=80:CtrlLt=79:CtrlRt=81
	If promptctrl=1  CtrlUp=17:CtrlDn=31:CtrlLt=30:CtrlRt=32
	PromptFrame=0
	If promptCtrl=0
		If KeyDown(79)  Plyr1dir=1
		If KeyDown(81)  Plyr1dir=0
		Promptdirection=Plyr1dir
	ElseIf promptCtrl=1
		If KeyDown(30)  Plyr2dir=1
		If KeyDown(32)  Plyr2dir=0
		Promptdirection=Plyr2dir
	End If
	EntityTexture PromptObj,PromptTex,Promptdirection;Other calculations will be done to get the proper frame when animation starts
	;move 1/32 units each time  1/32=0.03125
	MoveEntity PromptObj,0.03125*(KeyDown(CtrlRt)-KeyDown(CtrlLt))*1,0,0.03125*(KeyDown(CtrlUp)-KeyDown(CtrlDn))*1
End Function

Function RestoreBMP()
	;set gfxmode
	Graphics 320,200,16,3
	;create image
	Tmp=CreateImage(32,16)
	;set buffer to image
	SetBuffer ImageBuffer(Tmp)
	;if Char1.bmp doesn't exist... Make it
	If FileType("Char1.bmp")=2  DeleteDir "Char1.bmp"
	If FileType("Char1.bmp")=0 
		Cls
		Restore Char
		For v=0 To 15
			For h=0 To 15
				Read c
				Color c*63,c*63,0
				Plot h,v
				Plot 31-h,v
			Next
		Next
		SaveImage Tmp,"Char1.bmp"
	End If
	;if Laser1.bmp doesn't exist... Make it
	If FileType("Laser1.bmp")=2  DeleteDir "Laser1.bmp"
	If FileType("Laser1.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,0
			Rect 0,c,16,7-2*c
			Rect 16+4+c,0,7-2*c,16
		Next
		SaveImage Tmp,"Laser1.bmp"
	End If
	;if Bullet1.bmp doesn't exist... Make it
	If FileType("Bullet1.bmp")=2  DeleteDir "Bullet1.bmp"
	If FileType("Bullet1.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,0
			Oval c*3/2,c*3/2,16-2*(c*3/2),16-2*(c*3/2)
			Oval 16+c+2,c+2,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage Tmp,"Bullet1.bmp"
	End If
	;if Char2.bmp doesn't exist... Make it
	If FileType("Char2.bmp")=2  DeleteDir "Char2.bmp"
	If FileType("Char2.bmp")=0 
		Cls
		Restore Char
		For v=0 To 15
			For h=0 To 15
				Read c
				Color c*63,c*63,c*63
				Plot h,v
				Plot 31-h,v
			Next
		Next
		SaveImage Tmp,"Char2.bmp"
	End If
	;if Laser2.bmp doesn't exist... Make it
	If FileType("Laser2.bmp")=2  DeleteDir "Laser2.bmp"
	If FileType("Laser2.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Rect 0,c,16,7-2*c
			Rect 16+4+c,0,7-2*c,16
		Next
		SaveImage Tmp,"Laser2.bmp"
	End If
	;if Bullet2.bmp doesn't exist... Make it
	If FileType("Bullet2.bmp")=2  DeleteDir "Bullet2.bmp"
	If FileType("Bullet2.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Oval c*3/2,c*3/2,16-2*(c*3/2),16-2*(c*3/2)
			Oval 16+c+2,c+2,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage Tmp,"Bullet2.bmp"
	End If
	SetBuffer BackBuffer()
	;free image
	FreeImage Tmp Tmp=0
	;clear variables
	c=0 h=0 v=0
	;end gfx mode
	EndGraphics
End Function

.Char
Data 0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0
Data 0,0,0,0,0,1,2,2,2,1,0,0,0,0,0,0
Data 0,0,0,0,1,2,2,2,2,2,1,0,0,0,0,0
Data 0,0,0,0,1,2,2,4,4,4,1,0,0,0,0,0
Data 0,0,0,0,1,2,4,4,4,4,1,0,0,0,0,0
Data 0,0,0,0,0,1,4,4,4,1,0,0,0,0,0,0
Data 0,0,0,0,0,1,1,4,1,0,0,0,0,0,0,0
Data 0,0,0,0,1,4,4,4,4,1,0,1,1,0,0,0
Data 0,0,0,1,4,4,1,4,4,4,1,2,2,1,0,0
Data 0,0,1,3,3,1,1,4,1,4,3,2,2,1,0,0
Data 0,0,1,2,2,2,1,4,1,1,3,2,2,1,0,0
Data 0,0,1,2,2,2,1,2,2,1,1,1,1,0,0,0
Data 0,0,0,1,1,1,2,1,2,1,0,0,0,0,0,0
Data 0,0,0,0,1,2,2,1,2,2,1,0,0,0,0,0
Data 0,0,0,1,3,3,3,1,3,3,3,1,0,0,0,0
Data 0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0
</textarea><br><br>Any other tips and stuff would be helpful too on projectiles and laserbeams. I didnt try those yet since type may have to be used. I am not comfortable with those yet. Images for those will be created with this code too.<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1081438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> clsn_Plane - is never given a value. <br><br></td></tr></table><br>
<a name="1081442"></a>

<a name="1081443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops. I guess i did miss that.  Ill fix that right now and let u know what happened.<br><br>fixed the clsn_Plane<br><pre class=code>
;Collision Types
Const clsn_plyrs=1,clsn_Cube=2,clsn_Plane=3

;Set collisions
Collisions clsn_plyrs,clsn_plyrs,1,2
Collisions clsn_plyrs,clsn_Plane,2,2 ;ive tried other combinations as well not just 2,2
Collisions clsn_plyrs,clsn_Cube,2,2
</pre><br>i removed the following<br><pre class=code>
	If EntityY(player1)&lt;0.5 Then PositionEntity player1,EntityX(player1),.5,EntityZ(player1)
	If EntityY(player2)&lt;0.5 Then PositionEntity player2,EntityX(player2),.5,EntityZ(player2)
</pre><br><br>now my characters sink 1/2 way through the floor.  I tried different combinations but I still dont get why it still does that. I am seriously debating whether or not to just use a giant cube for my ground. Because with the code i did for the Cube works fine.<br><br>Thnx Matty<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1081445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its probably sinking half way into the floor because that's where the axis of the player object is.  All collisions in Blitz3D are sphere-to-something - you need to move that sphere to correspond with the player's feet, or wheels, or whatever the player is. <br><br></td></tr></table><br>
<a name="1081487"></a>

<a name="1081488"></a>

<a name="1081489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> . // no matter - ignore this.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1081606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Gfk<br><br>ya i tried the HandleSprite etc... 0,-1.  It fixed the sprite but not my radius. What i got was my character was in mid air during collision on the cube but perfect on the ground. Im not sure what to do about that. I removed it when i kept on getting the same results.  To solve my problem, i created an invisible plane for the ground collision and positioned it 1/2 way up the body. That seems to work. I wonder y the collision for the cube surface and a plane didnt work the same way? I followed the same steps. O well. @ least now i got something to work. Thnx.<br><br>Now for the next part.. Jumping. YIKES <br><br></td></tr></table><br>
<a name="1081609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya i know i posed about 20-30min. ago but i was fixing my sinking problem and now my jumping problem.  My character Jumps great. But i dont need him to do jumps in mid air. and i cant seem to detect collisions with entitycollided(Player1,cube) the way my code is.  <br><br>Can someone plz run the code and tweak it (the jumping part that is) Run it first then tweak then u will see what i mean.  I am almost there.  I even looked at the Castle.BB in the samples folder to help me with this a bit.  I look at, and my head spins.  well here is the new code.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Global plyr1dir
Global plyr2dir

;recreate missing images
RestoreBMP()

;3d graphics mode
Graphics3D 640,480,16,3



;Collision Types
Const clsn_plyrs=1,clsn_Cube=2,clsn_Plane=3

;Set collisions
Collisions clsn_plyrs,clsn_plyrs,1,2
Collisions clsn_plyrs,clsn_Plane,2,2
Collisions clsn_plyrs,clsn_Cube,2,2



;make a texture for the battle plane (its a grid for now)
PlaneTex=CreateTexture(32,32)
SetBuffer TextureBuffer(PlaneTex)
Color 84,84,252
Rect 0,0,32,32
For alllines=0 To 2
	Color 42-(alllines Mod 2)*42,42-(alllines Mod 2)*42,210-(alllines Mod 2)*42
	Line alllines,1,alllines+29,30
	Line alllines,30,alllines+29,1
Next
Color 0,0,0
For allsquares=0 To 3
	Rect allsquares/2*16,16*(allsquares Mod 2),16,16,0
Next
Color 0,0,168
Line 0,0,31,31
Line 0,31,31,0

;create cube
cube=CreateCube()
EntityColor cube,255,1,1
PositionEntity cube,0,1,0
EntityType cube,clsn_Cube

;createlight and position it at 0,10,0
btlLight=CreateLight(2)
PositionEntity btllight,0,10,0

;double buffer
SetBuffer BackBuffer()

;make Player 1
Player1=CreateSprite()
Plyr1Tex=LoadAnimTexture("Char1.bmp",7,16,16,0,2)
EntityTexture Player1,Plyr1Tex,0
ScaleSprite Player1,.5,.5
;HandleSprite player1,0,-1
SpriteViewMode player1,2

;make a player1 sphere (temporary) Helps me with collision radius
P1Sphere=CreateSphere(8,Player1)
EntityColor P1Sphere,0,255,0
EntityAlpha P1Sphere,.3
ScaleEntity P1Sphere,.25,.5,.25
PositionEntity P1Sphere,0,0,0

;set collision type
EntityRadius Player1,.25,.5 ;#x#z,#y
EntityType Player1,clsn_plyrs

PositionEntity player1,0,5,0

;make camera 1a
Cam1A = CreateCamera(Player1)
CameraViewport Cam1A,1,1,318, 238
CameraProjMode Cam1A,2 ;make 3d look 2d (my preference)
PositionEntity Cam1A, 0,6,-5
RotateEntity Cam1A,45,0,0
;CameraRange Cam1A,1,10
CameraZoom Cam1A,0.25

;make camera 1b
cam1b = CreateCamera(Player1)
CameraViewport cam1b,1,241,318, 238
PositionEntity cam1b, 0, 6,-6
RotateEntity cam1b,45,0,0
;CameraRange cam1b,1,10
CameraZoom cam1b,3




;make Player 2
Player2=CreateSprite()
Plyr2Tex=LoadAnimTexture("Char2.bmp",7,16,16,0,2)
EntityTexture Player2,Plyr1Tex,0
ScaleSprite Player2,.5,.5
SpriteViewMode player2,2

;make a player1 sphere (temporary) Helps me with collision radius
P2Sphere=CreateSphere(8,Player2)
EntityColor P2Sphere,0,255,255
EntityAlpha P2Sphere,.3
ScaleEntity P2Sphere,.25,.5,.25
PositionEntity P2Sphere,0,0,0

;set collision type
EntityRadius Player2,.25,.5 ;#x#z,#y
EntityType Player2,clsn_plyrs

PositionEntity player2,-5,5,0


;make camera 2a
Cam2A = CreateCamera(Player2)
CameraViewport Cam2A,321,1,318, 238
CameraProjMode Cam2A,2 ;make 3d look 2d (my preference)
PositionEntity Cam2A, 0, 6,-5
RotateEntity Cam2A,45,0,0
CameraZoom Cam2A,0.25

;make camera 2b
cam2b = CreateCamera(Player2)
CameraViewport cam2b,321,241,318, 238
PositionEntity cam2b, 0, 6,-6
RotateEntity cam2b,45,0,0
CameraZoom cam2b,3



;create infinite plane to battle on
BtlPlane=CreatePlane()
PositionEntity BtlPlane,0,.25,0
EntityAlpha BtlPlane,0
EntityType BtlPlane,clsn_Plane
ShoPlane=CreatePlane()
EntityTexture ShoPlane,PlaneTex
PositionEntity shoPlane,0,0,0
PositionEntity BtlPlane,0,.5,0

;WaitKey

;Player 1 Direction (0=Right 1=Left)
Plyr1Dir=0
;Player 2 Direction (0=Right 1=Left)
Plyr2Dir=0
;main loop
clearbuffer
Repeat
	;control player 1
	object_Ctrl Player1,Plyr1Tex,0
	object_Ctrl Player2,Plyr2Tex,1

;----spacebar for jump-------------------------
	If KeyHit(57) Then
		Plyr1jmp=1
		Plyr1vel#=5
	End If
	tmpp1=EntityY(player1)
	MoveEntity PLayer1,0,Plyr1vel#/32,0
	If tmpp1=EntityY(player1) Then plyr1jmp=0
	Plyr1vel#=Plyr1vel#-.1
	If Plyr1vel#&lt;-10 Then Plyr1vel#=-10
;------------------------------------------------
	;show 3d world
	UpdateWorld
	RenderWorld
	;show 2d stuff


	;MEMORY STUFF
	If AvailVidMem()&gt;=0
		If (AvailVidMem()/1024)/1024&gt;0  avail$=(AvailVidMem()/1024)/1024+" MB"
		If (AvailVidMem()/1024)/1024=0 
			If AvailVidMem()/1024=0  avail$=AvailVidMem()+" B"
			If AvailVidMem()/1024&gt;0  avail$=AvailVidMem()/1024+" KB"
		End If
	End If
	If TotalVidMem()&lt;0 Or AvailVidMem()&lt;0  avail$="Unknown":total$=avail$
	If TotalVidMem()&gt;=0
		If (TotalVidMem()/1024)/1024&gt;0
			Total$=(TotalVidMem()/1024)/1024+" MB"
			perc$=((AvailVidMem()/1024)/1024)*100/((TotalVidMem()/1024)/1024)+"% "
		ElseIf (TotalVidMem()/1024)/1024=0
			If TotalVidMem()/1024&gt;0
				total$=TotalVidMem()/1024+" KB"
				perc$=(AvailVidMem()/1024)*100/(TotalVidMem()/1024)+"% "
			ElseIf TotalVidMem()/1024=0
				total$=TotalVidMem()+" B"
				perc$=AvailVidMem()*100/TotalVidMem()+"% "
			End If
		End If
	End If


	;TEXT STUFF
	For alltext=0 To 1
		Color alltext*255,alltext*255,alltext*255
		Text 9-alltext,217-alltext, "Distance from Cube: "+Int(EntityDistance(Player1,Cube)*10)/10+"."+(Int(EntityDistance(Player1,Cube)*10) Mod 10)
		Text 329-alltext,217-alltext, "Distance from Cube: "+Int(EntityDistance(Player2,Cube)*10)/10+"."+(Int(EntityDistance(Player2,Cube)*10) Mod 10)

		Text 245-alltext,249-alltext, "Player Distance: "+Int(EntityDistance(Player1,Player2)*10)/10+"."+(Int(EntityDistance(Player1,Player2)*10) Mod 10)
		Text (80-Len(" Free VidMem: "+avail$))*4+1-alltext,233-alltext, " Free VidMem: "+avail$
		Text 9-alltext,233-alltext, "Total VidMem: "+Total$
		Text (79-Len(perc$+"VidMem Remaining"))*8+1-alltext,233-alltext, perc$+"VidMem Remaining"
		Text 9-alltext,9-alltext,"Player 1 CamProjMode 2"
		Text 9-alltext,25-alltext,"5 1 2 3 NumPad, SpcBar=Jump"
		Text 329-alltext,9-alltext,"Player 2 CamProjMode 2"
		Text 329-alltext,25-alltext,"W A S D Keys, No Jump Yet"
		Text 9-alltext,456-alltext,"Player 1 CamProjMode 1"
		Text 329-alltext,456-alltext,"Player 2 CamProjMode 1"
	Next
	Text 9,100,EntityX(player1)+","+EntityY(player1)+","+EntityZ(player1)
	Text 9,116,"Velocity:"+Float(Int(Plyr1vel*10))/10+", JumpStat[1=T/0=F]:"+Plyr1jmp

	;can not detect collision between player1 and cube... WHY?
	Text 9,248,"Ent.Coll - Player1,Cube:"+EntityCollided(Player1,Cube)
	Flip
	Cls
Until KeyHit(1)

;removes everything within the world (entities textures brushes)
ClearWorld
ClearCollisions
EndGraphics
End

;Control function
Function object_Ctrl(PromptObj,PromptTex,PromptCtrl)
	If promptctrl=0  CtrlUp=76:CtrlDn=80:CtrlLt=79:CtrlRt=81
	If promptctrl=1  CtrlUp=17:CtrlDn=31:CtrlLt=30:CtrlRt=32
	PromptFrame=0
	If promptCtrl=0
		If KeyDown(CtrlLt)  Plyr1dir=1
		If KeyDown(CtrlRT)  Plyr1dir=0
		Promptdirection=Plyr1dir
	ElseIf promptCtrl=1
		If KeyDown(CtrlLt)  Plyr2dir=1
		If KeyDown(Ctrlrt)  Plyr2dir=0
		Promptdirection=Plyr2dir
	End If
	EntityTexture PromptObj,PromptTex,Promptdirection;Other calculations will be done to get the proper frame when animation starts
	;move 1/32 units each time  1/32=0.03125;						;PULL PLAYERS DOWN. (THIS IS TEMPORARY)
	MoveEntity PromptObj,0.03125*(KeyDown(CtrlRt)-KeyDown(CtrlLt))*1,-.03125,0.03125*(KeyDown(CtrlUp)-KeyDown(CtrlDn))*1
	;MAKE SURE THAT PLAYERS DO NOT SINK BELOW THE BATTLE PLANE
	;IS THERE A BETTER WAY TO DO THIS? ANYONE?
	;PS: THESE 2 LINES ARE THE "COP OUTS"
	;REMOVE THEM AND SEE WHAT HAPPENS
	
;	If EntityY(PromptObj)&lt;0.5 Then PositionEntity PromptObj,EntityX(PromptObj),.5,EntityZ(PromptObj)
End Function

Function RestoreBMP()
	;set gfxmode
	Graphics 320,200,16,3
	;create image
	Tmp=CreateImage(32,16)
	;set buffer to image
	SetBuffer ImageBuffer(Tmp)
	;if Char1.bmp doesn't exist... Make it
	If FileType("Char1.bmp")=2  DeleteDir "Char1.bmp"
	If FileType("Char1.bmp")=0 
		Cls
		Restore Char
		For v=0 To 15
			For h=0 To 15
				Read c
				Color c*63,c*63,0
				Plot h,v
				Plot 31-h,v
			Next
		Next
		SaveImage Tmp,"Char1.bmp"
	End If
	;if Laser1.bmp doesn't exist... Make it
	If FileType("Laser1.bmp")=2  DeleteDir "Laser1.bmp"
	If FileType("Laser1.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,0
			Rect 0,c,16,7-2*c
			Rect 16+4+c,0,7-2*c,16
		Next
		SaveImage Tmp,"Laser1.bmp"
	End If
	;if Bullet1.bmp doesn't exist... Make it
	If FileType("Bullet1.bmp")=2  DeleteDir "Bullet1.bmp"
	If FileType("Bullet1.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,0
			Oval c*3/2,c*3/2,16-2*(c*3/2),16-2*(c*3/2)
			Oval 16+c+2,c+2,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage Tmp,"Bullet1.bmp"
	End If
	;if Char2.bmp doesn't exist... Make it
	If FileType("Char2.bmp")=2  DeleteDir "Char2.bmp"
	If FileType("Char2.bmp")=0 
		Cls
		Restore Char
		For v=0 To 15
			For h=0 To 15
				Read c
				Color c*63,c*63,c*63
				Plot h,v
				Plot 31-h,v
			Next
		Next
		SaveImage Tmp,"Char2.bmp"
	End If
	;if Laser2.bmp doesn't exist... Make it
	If FileType("Laser2.bmp")=2  DeleteDir "Laser2.bmp"
	If FileType("Laser2.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Rect 0,c,16,7-2*c
			Rect 16+4+c,0,7-2*c,16
		Next
		SaveImage Tmp,"Laser2.bmp"
	End If
	;if Bullet2.bmp doesn't exist... Make it
	If FileType("Bullet2.bmp")=2  DeleteDir "Bullet2.bmp"
	If FileType("Bullet2.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Oval c*3/2,c*3/2,16-2*(c*3/2),16-2*(c*3/2)
			Oval 16+c+2,c+2,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage Tmp,"Bullet2.bmp"
	End If
	SetBuffer BackBuffer()
	;free image
	FreeImage Tmp Tmp=0
	;clear variables
	c=0 h=0 v=0
	;end gfx mode
	EndGraphics
End Function

Function clearbuffer()
FlushKeys
FlushMouse
FlushJoy
End Function

.Char
Data 0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0
Data 0,0,0,0,0,1,2,2,2,1,0,0,0,0,0,0
Data 0,0,0,0,1,2,2,2,2,2,1,0,0,0,0,0
Data 0,0,0,0,1,2,2,4,4,4,1,0,0,0,0,0
Data 0,0,0,0,1,2,4,4,4,4,1,0,0,0,0,0
Data 0,0,0,0,0,1,4,4,4,1,0,0,0,0,0,0
Data 0,0,0,0,0,1,1,4,1,0,0,0,0,0,0,0
Data 0,0,0,0,1,4,4,4,4,1,0,1,1,0,0,0
Data 0,0,0,1,4,4,1,4,4,4,1,2,2,1,0,0
Data 0,0,1,3,3,1,1,4,1,4,3,2,2,1,0,0
Data 0,0,1,2,2,2,1,4,1,1,3,2,2,1,0,0
Data 0,0,1,2,2,2,1,2,2,1,1,1,1,0,0,0
Data 0,0,0,1,1,1,2,1,2,1,0,0,0,0,0,0
Data 0,0,0,0,1,2,2,1,2,2,1,0,0,0,0,0
Data 0,0,0,1,3,3,3,1,3,3,3,1,0,0,0,0
Data 0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0
</textarea><br><br><br>PS: Y cant i detect collisions between my Player1 and Cube?<br>Run code then check. Anyone plz. I have no idea what i am doing wrong. <br><br></td></tr></table><br>
<a name="1081612"></a>

<a name="1081613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's not what EntityCollided does. It takes a collision <i>type</i> as the second parameter, and if a collision occured, returns the entity handle of that type. To convert the handle into a true/false, do a comparison check of the result against the object you want to test (line 219):<br><br><pre class=code>Text 9,248,"Ent.Coll - Player1,Cube:"+(EntityCollided(Player1,clsn_Cube)=cube)</pre><br><br>I like the aesthetic by the way.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1081686"></a>

<a name="1081687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanx Yasha.  I guess i didnt fully understand the help documents.<br><br>Have u done jumping b4? If so what would u recommend to stop jumping in mid air? Just out of curiosity?<br><br>I have dl a few jumping examples as well.  Im gonna look through them, but every bit of info helps.<br><br>Oh, I glad u like the aesthetic part. BTW which part is that? Sorry I have never heard that term in programming b4.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1081796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> well.. I can get my char to jump. no matter what i do, I cant get him to not being able to jump in mid air.  I am totally stumpped.  Not sure what to do to fix the problem. <br><br></td></tr></table><br>
<a name="1081797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> You've got a variable Plyr1jmp that is set to 1 when the player jumps. If you set this to 0 when it lands again, you can disallow jumping as long as Plyr1jmp is true.<br><br>That's the simple part; the harder part is determining when to set the variable back to "jump permitted". If you have a simple collision between the player and the environment, it could jump again when it hits the underside of a ceiling or scrapes a wall on the way down, which may not be what you want.<br><br>There are two common solutions to this problem. If you have a very simple world or level design, you can have more than one collision surface for the world. Upward-facing surfaces would have a different collision type from vertical and downward-facing surfaces. Both collision types stop the player's movement, but only the upward-facing surface resets the jump variable.<br><br>If you have a more complex world, you might instead do something different with the player. One common styrategy is to give the player a second collision pivot, with a very small radius, parented to the player at its feet. The main collision radius still does the work of stopping the character's movement, but checking for collisions between the "foot pivot" and the world is the only way to reset the jump variable, again preventing side or top collisions from letting it jump again.<br><br>I'm sure this must be a fairly common issue as many games have jumping, so there must be some helpful stuff in past posts and the code archive (you can search the code archive with this tool: <a href="http://www.blitzbasic.com/Community/posts.php?topic=88773" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=88773</a> ).<br><br>The aesthetic... I just meant I like the retro look. <br><br></td></tr></table><br>
<a name="1081831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hm... I never thought of using a pivot. Then agian I just began to understand them. I guess part of me is still used to 2d prgming.  Im gonna give that a try. thnx again. <br><br></td></tr></table><br>
<a name="1081874"></a>

<a name="1081876"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I tried using a pivot. Applied a sphere to it so i knewwhere it was, and anther radius but it seem to separate from the player.<br><br>The parent was the player the pivot the child.  The child tended to move away from the parent when colliding.  the radius type never stays with the pivot anyway.  <br><br>  I am getting so frustrated.  I may have to say "forget about the jumping" for now  I have been fighting with the jumping for too long. I just dont know how to fix it at this time.<br><br><br>BTW can anyone tell me what TranslateEntity does?  Ive looked at the documents and a few jumping examples and i still dont get it.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1081877"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> TranslateEntity = MoveEntity without rotations. Up=allways up, no matter how the entity is turned.<br><br>If you have a child object with collisions that is connected to a parent, collisions could cause it to 'stay behind' when the parent moves. You have to position it back into the right place every frame. It serves as a 'sensor': it shouldn't matter where it is after a collision, you just use it to find out if it collided with something.<br><br>Anyway, here is a very basic jump/control example:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()

CreateLight()

cam = CreateCamera()
MoveEntity cam, 0, 5, -15

;create player
player = CreateSphere()
EntityColor player, 0, 0, 255
PositionEntity player, 0, 5, 0

EntityRadius player, 1
EntityType player, 1

;create world
world = CreateWorld()
EntityType world, 2, True

;set collisions
Collisions 1, 2, 2, 3

Repeat

	;move player with cursor keys	
	MoveEntity player, (KeyDown(205) - KeyDown(203)) * 0.1, 0, (KeyDown(200) - KeyDown(208)) * 0.1	

	If jump &gt; 0 Then
		;move up
		TranslateEntity player, 0, 0.1, 0 
		landed = False
		jump = jump - 1
	Else
		;if player is on ground, jumping is allowed
		If landed Then
			If KeyDown(57) jump = 25: jsp# = 0.5
		Else
			;move player down
			TranslateEntity player, 0, -0.1, 0
				
			;see if player landed on vertical surface
			landed% = False
			For i% = 1 To CountCollisions(player) ;loop through all collisions
				If CollisionNY(player, i) &gt; 0.5 Then ;if surface is 'vertical up'
					landed = True ;decide we have landed
					Exit
				End If
			Next
		End If		
	
	End If

	UpdateWorld ;check collisions	
	RenderWorld
	
	Text 0,  0, "cursor keys to move, space to jump"
	Text 0, 20, "jump = " + jump	
	Flip
	
Until KeyHit(1)

End

;make world
Function CreateWorld%()

	floor_ = CreateCube()
	ScaleMesh floor_, 25, 0.01, 25
	EntityColor floor_, 255, 0, 0
	
	box_ = CreateCube()
	PositionEntity box_, 5, 1, 5
	EntityParent box_, floor_

	box_ = CreateCube()
	PositionEntity box_, -5, 4, 5
	EntityParent box_, floor_

	box_ = CreateCube()
	ScaleEntity box_, 1, 3, 1
	PositionEntity box_, 0, 3, 10
	EntityParent box_, floor_
	
	Return floor_

End Function
</textarea> <br><br></td></tr></table><br>
<a name="1081886"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drak</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> TranslateEntity() will always move the object in global XYZ coordinates, regardless of the orientation of the object. <br><br></td></tr></table><br>
<a name="1081966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanx.. All of you guys have been awesome. This is the best site for help i have ever came too.  Thankyou for giving me some tips, tricks, and ideas to try to get the jumping to work properly.  I gotta say jumping in 2d is way easier than this.<br><br>Now that is said.   I have given it one more try b4 i just set it aside and work on projectiles... and i gotta ask "what is a Normal?" Because honestly i dont see the difference between CollisionY and CollisionNY except the 'Normal' bit.<br><br>BTW i really got wide eyed when i saw this <br><br><pre class=code>
world = CreateWorld()
EntityType world, 2, True
</pre><br><br>When i looked at the function "Create World".  I didnt realize that was even possible. To call a function like that just because the world was loaded there.  I have been prgming for a long time, and im still learning...<br>NEways... heres the new code... (again).<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Global plyr1dir
Global plyr2dir

;recreate missing images
RestoreBMP()

;3d graphics mode
Graphics3D 640,480,16,3



;Collision Types
Const clsn_plyrs=1,clsn_Cube=2

;Set collisions
Collisions clsn_plyrs,clsn_plyrs,1,2
Collisions clsn_plyrs,clsn_Cube,2,2
;Collisions clsn_Foot,clsn_Cube,1,2


;make a texture for the battle plane (its a grid for now)
PlaneTex=CreateTexture(32,32)
SetBuffer TextureBuffer(PlaneTex)
Color 84,84,252
Rect 0,0,32,32
For alllines=0 To 2
	Color 42-(alllines Mod 2)*42,42-(alllines Mod 2)*42,210-(alllines Mod 2)*42
	Line alllines,1,alllines+29,30
	Line alllines,30,alllines+29,1
Next
Color 0,0,0
For allsquares=0 To 3
	Rect allsquares/2*16,16*(allsquares Mod 2),16,16,0
Next
Color 0,0,168
Line 0,0,31,31
Line 0,31,31,0

;create cube
cube=CreateCube()
EntityColor cube,255,1,1
PositionEntity cube,0,1,0;above ground. a cube is 2x2x2 the center is its origin.
EntityType cube,clsn_Cube

;createlight and position it at 0,10,0
btlLight=CreateLight(2)
PositionEntity btllight,0,5,0

;double buffer
SetBuffer BackBuffer()

;make Player 1
Player1=CreateSprite()
Plyr1Tex=LoadAnimTexture("Char1.bmp",7,16,16,0,2)
EntityTexture Player1,Plyr1Tex,0
ScaleSprite Player1,.5,.5
SpriteViewMode player1,2

;make a player1 sphere (temporary) Helps me with collision radius
P1Sphere=CreateSphere(8,Player1)
EntityColor P1Sphere,0,255,0
EntityAlpha P1Sphere,.3
ScaleEntity P1Sphere,.25,.5,.25
PositionEntity P1Sphere,0,0,0

;set collision type
EntityRadius Player1,.25,.5 ;#x#z,#y
EntityType Player1,clsn_plyrs

PositionEntity player1,0,5,0



;make camera 1a
Cam1A = CreateCamera(Player1)
CameraViewport Cam1A,1,1,318, 238
CameraProjMode Cam1A,2 ;make 3d look 2d (my preference)
PositionEntity Cam1A, 0,6,-5
RotateEntity Cam1A,45,0,0
;CameraRange Cam1A,1,10
CameraZoom Cam1A,0.25

;make camera 1b
cam1b = CreateCamera(Player1)
CameraViewport cam1b,1,241,318, 238
PositionEntity cam1b, 0, 6,-6
RotateEntity cam1b,45,0,0
;CameraRange cam1b,1,10
CameraZoom cam1b,3




;make Player 2
Player2=CreateSprite()
Plyr2Tex=LoadAnimTexture("Char2.bmp",7,16,16,0,2)
EntityTexture Player2,Plyr1Tex,0
ScaleSprite Player2,.5,.5
SpriteViewMode player2,2

;make a player1 sphere (temporary) Helps me with collision radius
P2Sphere=CreateSphere(8,Player2)
EntityColor P2Sphere,0,255,255
EntityAlpha P2Sphere,.3
ScaleEntity P2Sphere,.25,.5,.25
PositionEntity P2Sphere,0,0,0

;set collision Type
EntityRadius Player2,.25,.5 ;#x#z,#y
EntityType Player2,clsn_plyrs



PositionEntity player2,-5,5,0


;make camera 2a
Cam2A = CreateCamera(Player2)
CameraViewport Cam2A,321,1,318, 238
CameraProjMode Cam2A,2 ;make 3d look 2d (my preference)
PositionEntity Cam2A, 0, 6,-5
RotateEntity Cam2A,45,0,0
CameraZoom Cam2A,0.25

;make camera 2b
cam2b = CreateCamera(Player2)
CameraViewport cam2b,321,241,318, 238
PositionEntity cam2b, 0, 6,-6
RotateEntity cam2b,45,0,0
CameraZoom cam2b,3



;create a cube to battle on. Make it 64x larger (Length&amp;Width) and the height 
BtlCube=CreateCube()
ScaleEntity BtlCube,64,1,64
ScaleTexture PlaneTex,0.0078125,0.0078125
EntityTexture BtlCube,PlaneTex
PositionEntity Btlcube,0,-1,0
EntityType BtlCube,clsn_Cube

;WaitKey

;Player 1 Direction (0=Right 1=Left)
Plyr1Dir=0
;Player 2 Direction (0=Right 1=Left)
Plyr2Dir=0
;main loop
clearbuffer
Repeat

	WireFrame KeyDown(2)
	;control player 1
	object_Ctrl Player1,Plyr1Tex,0
	object_Ctrl Player2,Plyr2Tex,1

	;Player 1 Jump
	If KeyDown(156) Then
		If plyr1jmp=0 ;if jumping is false (stand)
			Plyr1vel=35	;set velocity of 30
			Plyr1jmp=1 ;jumping is now true
		End If
	End If
	;Player 2 Jump
	If KeyDown(57) Then
		If plyr2jmp=0 ;if jumping is false (stand)
			Plyr2vel=35	;set velocity of 30
			Plyr2jmp=1 ;jumping is now true
		End If
	End If
	;here's all the new jumping stuff (Translateentity i dont have to worry about that.)
	MoveEntity PLayer1,0,Float(Plyr1vel)/320,0 ;move the player in a jumping movement
	If plyr1jmp=1 Plyr1vel=Plyr1vel-1 ;reduce velocity to slow down then reverse
	If plyr1jmp=0 Then ;if jumping is false
		Plyr1vel=0   ;set velocity to 0 (no vertical movement
		If CountCollisions(PLayer1)=0 Then Plyr1jmp=1 ;If there's no collisions you are still jumping.  you need atleast 1 collsion to not be jumping
	End If
	;Im not sure about this part... all i know is that it works. borrowed from the following commented code
;	If jump &gt; 0 Then
;		;move up
;		TranslateEntity player1, 0, 0.1, 0 
;		landed = False
;		jump = jump - 1
;	Else
;		;if player is on ground, jumping is allowed
;		If landed Then
;			If KeyDown(57) jump = 25: jsp# = 0.5
;		Else
;			;move player down
;			TranslateEntity player1, 0, -0.1, 0
;			;see if player landed on vertical surface
;			landed% = False
;			For i% = 1 To CountCollisions(player1) ;loop through all collisions
;				If CollisionNY(player1, i) &gt; 0.5 Then ;if surface is 'vertical up'
;					landed = True ;decide we have landed
;					Exit
;				End If
;			Next
;		End If		
;	End If
	For checkallcollisions=1 To CountCollisions(player1)
		If CollisionNY(player1,checkallcollisions)&gt;0.5 Plyr1jmp=0
	Next

	;here's all the new jumping stuff (Translateentity i dont have to worry about that.)
	MoveEntity PLayer2,0,Float(Plyr2vel)/320,0 ;move the player in a jumping movement
	If plyr2jmp=1 Plyr2vel=Plyr2vel-1 ;reduce velocity to slow down then reverse
	If plyr2jmp=0 Then ;if jumping is false
		Plyr2vel=0   ;set velocity to 0 (no vertical movement
		If CountCollisions(PLayer2)=0 Then Plyr2jmp=1 ;If there's no collisions you are still jumping.  you need atleast 1 collsion to not be jumping
	End If
	;Im not sure about this part... all i know is that it works. borrowed from the following commented code
;	If jump &gt; 0 Then
;		;move up
;		TranslateEntity player1, 0, 0.1, 0 
;		landed = False
;		jump = jump - 1
;	Else
;		;if player is on ground, jumping is allowed
;		If landed Then
;			If KeyDown(57) jump = 25: jsp# = 0.5
;		Else
;			;move player down
;			TranslateEntity player1, 0, -0.1, 0
;			;see if player landed on vertical surface
;			landed% = False
;			For i% = 1 To CountCollisions(player1) ;loop through all collisions
;				If CollisionNY(player1, i) &gt; 0.5 Then ;if surface is 'vertical up'
;					landed = True ;decide we have landed
;					Exit
;				End If
;			Next
;		End If		
;	End If
	For checkallcollisions=1 To CountCollisions(player2)
		If CollisionNY(player2,checkallcollisions)&gt;0.5 Plyr2jmp=0
	Next

	











;;;;;----spacebar for jump-------------------------
;;;;	If KeyHit(57) Then
;;;;		If Plyr1jmp=0
;;;;			Plyr1vel#=5.0
;;;;			Plyr1jmp=1
;;;;		End If
;;;;	End If
;;;;	MoveEntity PLayer1,0,Plyr1vel#/32,0
;;;;;	If CountCollisions(Player1)&gt;0 Then
;;;;;		PLyr1vel#=0
;;;;	;	Plyr1jmp=0
;;;;;	End If
;;;;;	If CountCollisions(Player1)=0 Then
;;;;		Plyr1Jmp=0
;;;;		Plyr1vel#=Plyr1vel#-.1
;;;;;	End If
;;;;;	If Plyr1vel#&lt;-10 Then Plyr1vel#=-10
;------------------------------------------------
	;show 3d world
	UpdateWorld
	RenderWorld
	;show 2d stuff


	;MEMORY STUFF
	If AvailVidMem()&gt;=0
		If (AvailVidMem()/1024)/1024&gt;0  avail$=(AvailVidMem()/1024)/1024+" MB"
		If (AvailVidMem()/1024)/1024=0 
			If AvailVidMem()/1024=0  avail$=AvailVidMem()+" B"
			If AvailVidMem()/1024&gt;0  avail$=AvailVidMem()/1024+" KB"
		End If
	End If
	If TotalVidMem()&lt;0 Or AvailVidMem()&lt;0  avail$="Unknown":total$=avail$
	If TotalVidMem()&gt;=0
		If (TotalVidMem()/1024)/1024&gt;0
			Total$=(TotalVidMem()/1024)/1024+" MB"
			perc$=((AvailVidMem()/1024)/1024)*100/((TotalVidMem()/1024)/1024)+"% "
		ElseIf (TotalVidMem()/1024)/1024=0
			If TotalVidMem()/1024&gt;0
				total$=TotalVidMem()/1024+" KB"
				perc$=(AvailVidMem()/1024)*100/(TotalVidMem()/1024)+"% "
			ElseIf TotalVidMem()/1024=0
				total$=TotalVidMem()+" B"
				perc$=AvailVidMem()*100/TotalVidMem()+"% "
			End If
		End If
	End If


	;TEXT STUFF
	For alltext=0 To 1
		Color alltext*255,alltext*255,alltext*255
		Text 9-alltext,217-alltext, "Distance from Cube: "+Int(EntityDistance(Player1,Cube)*10)/10+"."+(Int(EntityDistance(Player1,Cube)*10) Mod 10)
		Text 329-alltext,217-alltext, "Distance from Cube: "+Int(EntityDistance(Player2,Cube)*10)/10+"."+(Int(EntityDistance(Player2,Cube)*10) Mod 10)

		Text 245-alltext,249-alltext, "Player Distance: "+Int(EntityDistance(Player1,Player2)*10)/10+"."+(Int(EntityDistance(Player1,Player2)*10) Mod 10)
		Text (80-Len(" Free VidMem: "+avail$))*4+1-alltext,233-alltext, " Free VidMem: "+avail$
		Text 9-alltext,233-alltext, "Total VidMem: "+Total$
		Text (79-Len(perc$+"VidMem Remaining"))*8+1-alltext,233-alltext, perc$+"VidMem Remaining"
		Text 9-alltext,9-alltext,"Player 1 CamProjMode 2"
		Text 9-alltext,25-alltext,"5 1 2 3 NumPad, NP Ent=Jump"
		Text 329-alltext,9-alltext,"Player 2 CamProjMode 2"
		Text 329-alltext,25-alltext,"W A S D Keys, SpcBar=Jump"
		Text 9-alltext,456-alltext,"Player 1 CamProjMode 1"
		Text 329-alltext,456-alltext,"Player 2 CamProjMode 1"
	Next
	Text 9,100,EntityX(player1)+","+EntityY(player1)+","+EntityZ(player1)
	Text 9,116,Int(EntityX(player1)*32)+","+Int(EntityY(player1)*32)+","+Int(EntityZ(player1)*32)
	Text 9,132,"Velocity:"+Float(Int(Plyr1vel*10))/10+","+plyr1jmp

	;can not detect collision between player1 and cube... WHY?
	Text 9,248,"Count:"+CountCollisions(Player1)+","
;	Text 9,248,"Ent.Coll - Player1,Cube:"+(EntityCollided(Player1,clsn_Cube)=cube)
;	Text 9,248+16,"Ent.Coll - Plyr1,BtlPln:"+(EntityCollided(Player1,clsn_Cube)=BtlCube)+",Triangles Rendered: "+TrisRendered()
	Flip
	Cls
Until KeyHit(1)

;removes everything within the world (entities textures brushes)
ClearWorld
ClearCollisions
EndGraphics
End

;Control function
Function object_Ctrl(PromptObj,PromptTex,PromptCtrl)
	If promptctrl=0  CtrlUp=76:CtrlDn=80:CtrlLt=79:CtrlRt=81
	If promptctrl=1  CtrlUp=17:CtrlDn=31:CtrlLt=30:CtrlRt=32
	PromptFrame=0
	If promptCtrl=0
		If KeyDown(CtrlLt)  Plyr1dir=1
		If KeyDown(CtrlRT)  Plyr1dir=0
		Promptdirection=Plyr1dir
	ElseIf promptCtrl=1
		If KeyDown(CtrlLt)  Plyr2dir=1
		If KeyDown(Ctrlrt)  Plyr2dir=0
		Promptdirection=Plyr2dir
	End If
	EntityTexture PromptObj,PromptTex,Promptdirection;Other calculations will be done to get the proper frame when animation starts
	;move 1/32 units each time  1/32=0.03125;						;PULL PLAYERS DOWN. (THIS IS TEMPORARY)
	MoveEntity PromptObj,0.03125*(KeyDown(CtrlRt)-KeyDown(CtrlLt))*1,0,0.03125*(KeyDown(CtrlUp)-KeyDown(CtrlDn))*1
	;MAKE SURE THAT PLAYERS DO NOT SINK BELOW THE BATTLE PLANE
	;IS THERE A BETTER WAY TO DO THIS? ANYONE?
	;PS: THESE 2 LINES ARE THE "COP OUTS"
	;REMOVE THEM AND SEE WHAT HAPPENS
	
;	If EntityY(PromptObj)&lt;0.5 Then PositionEntity PromptObj,EntityX(PromptObj),.5,EntityZ(PromptObj)
End Function

Function RestoreBMP()
	;set gfxmode
	Graphics 320,200,16,3
	;create image
	Tmp=CreateImage(32,16)
	;set buffer to image
	SetBuffer ImageBuffer(Tmp)
	;if Char1.bmp doesn't exist... Make it
	If FileType("Char1.bmp")=2  DeleteDir "Char1.bmp"
	If FileType("Char1.bmp")=0 
		Cls
		Restore Char
		For v=0 To 15
			For h=0 To 15
				Read c
				Color c*63,c*63,0
				Plot h,v
				Plot 31-h,v
			Next
		Next
		SaveImage Tmp,"Char1.bmp"
	End If
	;if Laser1.bmp doesn't exist... Make it
	If FileType("Laser1.bmp")=2  DeleteDir "Laser1.bmp"
	If FileType("Laser1.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,0
			Rect 0,c,16,7-2*c
			Rect 16+4+c,0,7-2*c,16
		Next
		SaveImage Tmp,"Laser1.bmp"
	End If
	;if Bullet1.bmp doesn't exist... Make it
	If FileType("Bullet1.bmp")=2  DeleteDir "Bullet1.bmp"
	If FileType("Bullet1.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,0
			Oval c*3/2,c*3/2,16-2*(c*3/2),16-2*(c*3/2)
			Oval 16+c+2,c+2,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage Tmp,"Bullet1.bmp"
	End If
	;if Char2.bmp doesn't exist... Make it
	If FileType("Char2.bmp")=2  DeleteDir "Char2.bmp"
	If FileType("Char2.bmp")=0 
		Cls
		Restore Char
		For v=0 To 15
			For h=0 To 15
				Read c
				Color c*63,c*63,c*63
				Plot h,v
				Plot 31-h,v
			Next
		Next
		SaveImage Tmp,"Char2.bmp"
	End If
	;if Laser2.bmp doesn't exist... Make it
	If FileType("Laser2.bmp")=2  DeleteDir "Laser2.bmp"
	If FileType("Laser2.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Rect 0,c,16,7-2*c
			Rect 16+4+c,0,7-2*c,16
		Next
		SaveImage Tmp,"Laser2.bmp"
	End If
	;if Bullet2.bmp doesn't exist... Make it
	If FileType("Bullet2.bmp")=2  DeleteDir "Bullet2.bmp"
	If FileType("Bullet2.bmp")=0 
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Oval c*3/2,c*3/2,16-2*(c*3/2),16-2*(c*3/2)
			Oval 16+c+2,c+2,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage Tmp,"Bullet2.bmp"
	End If
	SetBuffer BackBuffer()
	;free image
	FreeImage Tmp Tmp=0
	;clear variables
	c=0 h=0 v=0
	;end gfx mode
	EndGraphics
End Function

Function clearbuffer()
FlushKeys
FlushMouse
FlushJoy
End Function

.Char
Data 0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0
Data 0,0,0,0,0,1,2,2,2,1,0,0,0,0,0,0
Data 0,0,0,0,1,2,2,2,2,2,1,0,0,0,0,0
Data 0,0,0,0,1,2,2,4,4,4,1,0,0,0,0,0
Data 0,0,0,0,1,2,4,4,4,4,1,0,0,0,0,0
Data 0,0,0,0,0,1,4,4,4,1,0,0,0,0,0,0
Data 0,0,0,0,0,1,1,4,1,0,0,0,0,0,0,0
Data 0,0,0,0,1,4,4,4,4,1,0,1,1,0,0,0
Data 0,0,0,1,4,4,1,4,4,4,1,2,2,1,0,0
Data 0,0,1,3,3,1,1,4,1,4,3,2,2,1,0,0
Data 0,0,1,2,2,2,1,4,1,1,3,2,2,1,0,0
Data 0,0,1,2,2,2,1,2,2,1,1,1,1,0,0,0
Data 0,0,0,1,1,1,2,1,2,1,0,0,0,0,0,0
Data 0,0,0,0,1,2,2,1,2,2,1,0,0,0,0,0
Data 0,0,0,1,3,3,3,1,3,3,3,1,0,0,0,0
Data 0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0
</textarea><br><br>If anyone has time i would love to get some feed back from everyone who took their time and shared their knowledge to help me.  And of course everyone who just want to take a look too. <br><br></td></tr></table><br>
<a name="1143987"></a>

<a name="1143988"></a>

<a name="1143989"></a>

<a name="1143990"></a>

<a name="1143991"></a>

<a name="1143993"></a>

<a name="1144313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok I have been playing around with jumping &amp; collisions.  again.<br><br>the first routine does what it did in the previous code. you hold down the jump button and the charcter bounces around like a rabbit. At least he dont stick to walls.<br>the second routine if u press the jump button and he jumps. hold jump and then release... charged jump. but im having problems with getting stuck on the sides of the cubes (or sliding down). <br><br>What i would like to do is have the character do charged jumping like routine 2 but does not get stuck/slide down on the walls like routine 1<br><br>can anyone help?<br><br>here is my code.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">




Global mup=200,MDN=208,mlt=203,mrt=205,mjp=57,mst=28
;input user keys here before the program starts
Color 255,255,255
For x=0 To 6
	Cls
	Text 10, 0,"   Up:"
	Text 10,12," Down:"
	Text 10,24," Left:"
	Text 10,36,"Right:"
	Text 10,48," Jump:"
	Text 10,60,"Shoot:"
	If X&lt;6 Text 10,84,"[ESC] Use Defaults"
	
	If x&lt;6 Rect 58,x*12,8,12
	If x&gt;0 Text 58,0,mup
	If x&gt;1 Text 58,12,mdn
	If x&gt;2 Text 58,24,mlt
	If x&gt;3 Text 58,36,mrt
	If x&gt;4 Text 58,48,mjp
	If x&gt;5 Text 58,60,mst
	If x=6 Text 10,84,"Press any key to continue..."
.redo
	confirm=False
	FlushKeys
	Repeat
		For keyz=0 To 255
			If KeyHit(keyz)
				If x=0 mup=keyz
				If x=1 mdn=keyz
				If x=2 mlt=keyz
				If x=3 mrt=keyz
				If x=4 mjp=keyz
				If x=5 mst=keyz
				confirm=True
			End If
		Next
	Until confirm=True
	If X&lt;6
		If MUP=1 Or MDN=1 Or MLT=1 Or MRT=1 Or MJP=1 Or MST=1
			mup=200
			MDN=208
			mlt=203
			mrt=205
			mjp=57
			mst=28
			x=5
		End If
	End If	
	If x=0
		If mup=15 Goto redo
	ElseIf x=1
		If mdn= 15 Goto redo
		If mdn=mup Goto redo
	ElseIf x=2
		If mlt= 15 Goto redo
		If mlt=mup Goto redo
		If mlt=mdn Goto redo
	ElseIf x=3
		If mRt= 15 Goto redo
		If mRT=mup Goto redo
		If mRT=mdn Goto redo
		If mRT=mLT Goto redo
	ElseIf x=4
		If mJP= 15 Goto redo
		If mJP=mup Goto redo
		If mJP=mdn Goto redo
		If mJP=mLT Goto redo
		If mJP=mRT Goto redo
	ElseIf x=5
		If mST= 15 Goto redo
		If mST=mup Goto redo
		If mST=mdn Goto redo
		If mST=mLT Goto redo
		If mST=mRT Goto redo
		If mST=mJP Goto redo
	End If
Next
;ADDED DATA---------------------------------------
RESTOREBMP ;CREATE CHARACTGER AND BULLET AND BEAM
;-------------------------------------------------

Const PERIOD=32 ;(1024/PERIOD) = FPS (FRAMES PER SECOND)

;SET GRAPHICS MODE AND LOAD STUFF HERE.
Graphics3D 640,480,16,3

Global TIME=MilliSecs()-PERIOD,ELAPSED,FRAMETICKS,TWEEN#
;TIME = CALCULATE TIME PERIOD
;ELLAPSE = TIME ELLAPSED (TIME PASSED) This changes throughout the program
;FRAMETICKS = How many frames have ellapsed (passe)
;TWEEN# = used to get inbetween frames


;ADDED DATA--------------------------------------------------------------------
Const CLSN_PLYR=1,CLSN_OBJS=2,CLSN_GRND=3
Collisions CLSN_PLYR,CLSN_OBJS,2,2
Collisions CLSN_PLYR,CLSN_GRND,2,2

AmbientLight 84,168,252

PLANE1TEX=CreateTexture(32,32)
SetBuffer TextureBuffer(PLANE1TEX)
Color 84,84,252
Rect 0,0,32,32
For ALLLINES=0 To 2
	Color 42-(ALLLINES Mod 2)*42,42-(ALLLINES Mod 2)*42,210-(ALLLINES Mod 2)*42
	Line ALLLINES,1,ALLLINES+29,30
	Line ALLLINES,30,ALLLINES+29,1
Next
Color 0,0,0
For ALLSQUARES=0 To 3
	Rect ALLSQUARES/2*16,16*(ALLSQUARES Mod 2),16,16,0
Next
Color 0,0,168
Line 0,0,31,31
Line 0,31,31,0

PLANE2TEX=CreateTexture(32,32)
SetBuffer TextureBuffer(PLANE2TEX)
Color 252,84,84
Rect 0,0,32,32
For ALLLINES=0 To 2
	Color 210-(ALLLINES Mod 2)*42,42-(ALLLINES Mod 2)*42,42-(ALLLINES Mod 2)*42
	Line ALLLINES,1,ALLLINES+29,30
	Line ALLLINES,30,ALLLINES+29,1
Next
Color 0,0,0
For ALLSQUARES=0 To 3
	Rect ALLSQUARES/2*16,16*(ALLSQUARES Mod 2),16,16,0
Next
Color 168,0,0
Line 0,0,31,31
Line 0,31,31,0
;------------------------------------------------------------------------------

SetBuffer BackBuffer() ;Double buffering


;ADDED DATA--------------------------------------------------------------------

;cubes
cube=CreateCube()
EntityColor cube,1,1,255
ScaleEntity cube,.5,.5,.5
PositionEntity cube,-5,1.5,0
EntityType cube,clsn_objs

cube=CreateCube()
EntityColor cube,255,1,1
ScaleEntity cube,.25*2,.25*2,.25*2
PositionEntity cube,0,.25*2,0
EntityType cube,clsn_objs

cube=CreateCube()
EntityColor cube,1,255,1
ScaleEntity cube,.25*6,.25*12,.25*6
PositionEntity cube,5,.25*12,0
EntityType cube,clsn_objs

;light
btllight=CreateLight(2)
PositionEntity btllight,0,10,0

;charsize x,y
sizex=16*1
sizey=16*1
plyrdir=0 ;player direction
WALKSPEED=2 ;PLAYER'S WALKING SPEED

player1=CreateSprite()
plyr1tex=LoadAnimTexture("char1.bmp",7,32,32,0,2)
EntityTexture player1,plyr1tex,0
SpriteViewMode player1,2
PositionEntity player1,0,5,0
ScaleSprite player1,0.03125*sizex,0.03125*sizey
EntityRadius player1,0.0078125*sizex,0.015625*sizey
EntityType player1,clsn_plyr
;delete when done----------
sphere=CreateSphere(32,player1)
EntityAlpha sphere,.5
ScaleEntity sphere,0.0078125*sizex,0.015625*sizey,0.0078125*sizex
PositionEntity sphere,0,0,0
;--------------------------

;player camera
camera=CreateCamera(player1)
CameraViewport camera,0,0,GraphicsWidth(),GraphicsHeight()
CameraProjMode camera,2
PositionEntity camera,0,10,-10
RotateEntity camera,45,0,0
CameraZoom camera,.5
;fixed camera
smlcam=CreateCamera()
CameraViewport smlcam,GraphicsWidth()*7/8,GraphicsHeight()*7/8,GraphicsWidth()/8,GraphicsHeight()/8
CameraProjMode smlcam,2
PositionEntity smlcam,3,10,-10
RotateEntity smlcam,45,0,0
CameraZoom smlcam,.5

;battlefield
btlcube=CreateCube()
ScaleEntity btlcube,12,Float(1)/256,4
ScaleTexture plane1tex,Float(1)/24,Float(1)/8
EntityTexture btlcube,plane1tex
PositionEntity btlcube,0,0,0
EntityType btlcube,clsn_grnd

;exitfield
exitcube=CreateCube()
ScaleEntity exitcube,12+8,Float(1)/256,4+8
ScaleTexture plane2tex,Float(1)/40,Float(1)/24
EntityTexture exitcube,plane2tex
PositionEntity EXITcube,0,-Float(1)/256,0
EntityType EXITcube,clsn_grnd

FLUSH ; FLUSH INPUTS
;------------------------------------------------------------------------------


;BEGINNING OF PROGRAM

Repeat
	;WAIT FOR ELLAPSED TIME
	Repeat
		ELAPSED=MilliSecs()-TIME
	Until ELAPSED
	
	FRAMETICKS=ELAPSED/PERIOD ;how many 'frames' have elapsed
	
	Tween#=Float(elapsed Mod period)/Float(period) ;fractional remainder
	
	;check each frame
	For checkticks=1 To frameticks
		time=time+period ;goto next time period
		If checkticks=frameticks Then CaptureWorld ; capture each frame in 3d world within time period
		
		;place images/entties and inputs here--------------------------------------------
	
	
	

		
		;ADDED DATA----------------------------------
		If jroutine=1;new jump routine stumped
			velud=veluD-1
			If CountCollisions(player1)&gt;0 velud=-1
			If KeyHit(mjp)
				If CountCollisions(player1)&gt;0 velud=8;8,11,14,16,18 (1-5 blocks respectfully)
			End If
			If KeyDown(mjp)=True
				tmpvud=tmpvud+1
				If tmpvud&gt;18 tmpvud=18
			ElseIf KeyDown(mjp)=False
				If CountCollisions(player1)&gt;0 velud=tmpvud
				tmpvud=-1
			End If
		ElseIf jroutine=0;jump routine with help from blitz forum community
			If jump=False
				If CountCollisions(player1)=0 jump=True
				velud=0
			End If
			velud=velud-1
			For checkallCollisions=1 To CountCollisions(player1)
				If CollisionNY(player1,checkallcollisions)&gt;0.03125*sizey
					jump=False
					velud=0-1
					Exit
				ElseIf CollisionNY(player1,checkallcollisions)&lt;-0.03125*sizey
					jump=True
					velud=0-1
					Exit
				End If
			Next
			If KeyDown(mjp)
				If jump=False
					velud=18
					jump=True
				End If
			End If
		End If
		If KeyHit(15) jroutine=Not jroutine ;tab ;toggles jumping routines
		
		;move up
		If KeyDown(mup)=True
			If CountCollisions(PLAYER1)=0
				If VELNS=0 VELN=1
			ElseIf CountCollisions(PLAYER1)&gt;0
				veln=veln+walkspeed
				If veln&gt;5*walkspeed veln=5*walkspeed
			End If
		ElseIf KeyDown(mup)=False
			If CountCollisions(PLAYER1)&gt;0
				veln=veln-walkspeed
				If veln&lt;0 veln=0
			End If
		End If
		;move down
		If KeyDown(mdn)=True
			If CountCollisions(PLAYER1)=0
				If VELNS=0 VELS=1
			ElseIf CountCollisions(PLAYER1)&gt;0
				vels=vels+walkspeed
				If vels&gt;5*walkspeed vels=5*walkspeed
			End If
		ElseIf KeyDown(mdn)=False
			If CountCollisions(PLAYER1)&gt;0
				vels=vels-walkspeed
				If vels&lt;0 vels=0
			End If
		End If
		velns=veln-vels ;balances north(up) and south(down) movement
		;move left
		If KeyDown(mlt)=True
			If CountCollisions(PLAYER1)=0
				If VELWE=0 VELW=1
			ElseIf CountCollisions(PLAYER1)&gt;0
				velw=velw+walkspeed
				If velw&gt;5*walkspeed velw=5*walkspeed
			End If
		ElseIf KeyDown(mlt)=False
			If CountCollisions(PLAYER1)&gt;0
				velw=velw-walkspeed
				If velw&lt;0 velw=0
			End If
		End If
		;move RIGHT
		If KeyDown(mrt)=True
			If CountCollisions(PLAYER1)=0
				If VELWE=0 VELE=1
			ElseIf CountCollisions(PLAYER1)&gt;0
				velE=velE+walkspeed
				If velE&gt;5*walkspeed velE=5*walkspeed
			End If
		ElseIf KeyDown(mRT)=False
			If CountCollisions(PLAYER1)&gt;0
				velE=velE-walkspeed
				If velE&lt;0 velE=0
			End If
		End If
		velWE=velE-velW ;balances west(left) and east(right) movement
		If velwe&lt;&gt;0 tmpdir=-(Sgn(velwe)-1)/2 ;calculate char dir using valwe
		If tmpdir&lt;&gt;plyrdir
			plyrdir=tmpdir
			direction(player1,plyr1tex,tmpdir)
		End If
		;CHARACTER MOVEMENT
		MoveEntity player1,Float(velwe)/160,Float(velud)/32,Float(velns)/160
		;--------------------------------------------
		;--------------------------------------------------------------------------------
		UpdateWorld ;UPDATE YOUR 3D WORLD
	Next
	RenderWorld TWEEN# ; RENDERS CURRENT SCREEN FROM BACKGROUND BUFFER (INCLUDING TWEENING)
	
	;ADDED TEXT---------------------------------------------------------
	Color 255,255,255
	Text 0, 0,EntityX(PLAYER1)+","+EntityY(PLAYER1)+","+EntityZ(PLAYER1)
	Text 0,10,VELNS+", "+VELWE+", "+VELUD
	Text 0,20,"[TAB] Toggle jumping: "+jroutine
	If jroutine=0 Text 20,30,"hold [JUMP] to bounce around"
	If jroutine=1 Text 20,30,"press [JUMP] to Jump."
	If jroutine=1 Text 20,40,"hold &amp; release [JUMP] to ChargeJump"
	
	;-------------------------------------------------------------------
	Flip ; show new screen update
Until KeyHit(1) Or (EntityCollided(Player1,CLSN_GRND)=exitcube) Or (EntityY(player1)&lt;-2 Or EntityY(player1)&gt;11);END MAIN LOOP

;CLEAN UP STUFF
time=0
elapsed=0
frameticks=0
tween#=0
checkticks=0

ClearWorld ;remove entities, brushes, textures from memory (anything missed)
ClearCollisions ;clear all collisions from memory
EndGraphics
flush


Function DIRECTION(SPR,TEX,FRM);CHANGE IMAGE ON SPRITE
	EntityTexture SPR,TEX,FRM
End Function

Function flush() ;flush all inputs from memory
	FlushKeys ;clear keyboard presses
	FlushMouse ;clear mouse clicks
	FlushJoy ;clear joystick presses
End Function

Function restorebmp()
	;set gfxmode
	Graphics 320,240,16,3
	;Create Image
	tmp=CreateImage(64,32)
	;set buffer to image
	SetBuffer ImageBuffer(tmp)
	;if char1.bmp doesn't exist... make it
	If FileType("char1.bmp")=2 DeleteDir "char1.bmp"
	If FileType("char1.bmp")=0
		Cls
		Restore char
		For v=0 To 31
			For h=0 To 31
				Read c
				If c&gt;0
					Color (c-1)*84+7*(c=1),(c-1)*84+7*(c=1),(c-1)*84+7*(c=1)
					Plot h,v
					Plot 63-h,v
				End If
			Next
		Next
		SaveImage tmp,"char1.bmp"
	End If
	;if laser1.bmp doesn't exist... make it
	If FileType("laser1.bmp")=2 DeleteDir "laser1.bmp"
	If FileType("laser1.bmp")=0
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Rect 8,c+12,16,7-2*c
			Rect c+12+32,8,7-2*c,16
		Next
		SaveImage tmp,"laser1.bmp"
	End If
	;if bullet1.bmp doesn't exist... make it
	If FileType("bullet1.bmp")=2 DeleteDir "bullet1.bmp"
	If FileType("bullet1.bmp")=0
		Cls
		For c=0 To 3
			Color c*63+63,c*63+63,c*63+63
			Oval c*3/2+8,c*3/2+8,16-2*(c*3/2),16-2*(c*3/2)
			Oval c+2+32+8,c+2+8,16-2*(c+2),16-2*(c+2)
		Next
		SaveImage tmp,"bullet1.bmp"
	End If
End Function


.char
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,4,4,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,4,4,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,4,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,1,4,4,4,4,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,1,4,4,1,4,4,4,1,2,2,1,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,1,3,3,1,1,4,1,4,3,2,2,1,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,1,2,2,2,1,4,1,1,3,2,2,1,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,1,2,2,2,1,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,1,1,1,2,1,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,1,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,1,3,3,3,1,3,3,3,1,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Data 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
</textarea><br><br>BTW there is still no projectiles in this example. I am working on that now. while i wait for a reply<br><br>ps: you'll have to save the code for it to work.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1144515"></a>

<a name="1144516"></a>

<a name="1144727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nexinarus</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Technically this thread needs no more replies.<br>Originally this thread was all about collisions. Then collisions when jumping.<br><br>To get working code of jumping look at the thread "Almost Perfect Jumping" or go to the "code archives/Miscellaneous/Basic &amp; Charged Jumping in 3D".  I posted the code there too.<br>Eventually it will be updated to allow charge jumping. Who knows, it may be there now. It depends on whether or not i can get the code tested by others.<br><br>Well have fun coding!<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
