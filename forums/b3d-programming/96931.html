<!DOCTYPE html><html lang="en" ><head ><title >registry in windows 7</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >registry in windows 7</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >registry in windows 7</a><br><br>
<a name="1123232"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jp1985</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br>I want to be able to read the keys from HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\GameUX and I am running in windows 7 x64. I have found multiple ways of doing this, running batch files, win api, external decal but none of them actually return the keys. <br>For example running the batch file:<br><br>C:\WINDOWS\System32\reg.exe query HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\GameUX &gt;&gt; z:\test3.txt <br><br>Outputs all the keys in the registry to test3.txt. Perfect.<br>However if I run this file from my blitz3d program it only finds a single key(MachineSettings) and not the ones I need (like Games). The same thing happens with the api, using regedit commandline and decals. <br><br>I am also running the program with admin level privileges built into its manifest and have tried running program as administrator as well.<br>Its as if windows doesn't want external programs to see those keys as looking in regedit shows the keys fine.<br><br>Any help you can give will be excellent as this has been bugging me for over 2 days now and has halted my project greatly. <br><br></td></tr></table><br>
<a name="1123279"></a>

<a name="1123284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> use PhysX dll, functions.<br><br><a href="http://blitzbasic.com/Community/posts.php?topic=90281" target="_blank">http://blitzbasic.com/Community/posts.php?topic=90281</a><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1123338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jp1985</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that but the dll doesn't contain any way to query keys. I want to enumerate all the keys not just read a single value or write a single value. <br>The registry area I am reading from can potentially have hundreds of different valued keys in it so there is no way for me to know the exact path of each key hence I need a function that returns the values of each of the subkeys <br><br></td></tr></table><br>
<a name="1123339"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did u try any other plugins they might have? They have a WIDE variety of registry API plugins <br><br></td></tr></table><br>
<a name="1123341"></a>

<a name="1123344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> but none of them actually return the keys. <br></div>This is because you are trying to read it from the wrong registry.  64-bit versions of Windows do not natively support 32-bit software. 64-bit versions of Windows will only run 32-bit software via emulation using WoW64.  If you insist on running 32-bit software, you need to use the proper locations so the emulator can find the data you need.<br><br>You have a 64-bit OS and you are running a 32-bit EXE.  If you try and write to 64-bit registry, it <i>should</i> be automatically written to the 32-bit registry equivalent.  If you want to read that value, you need to read the 32-bit registry equivalent, you can't read it from the 64-bit registry because it was never written there.<br><br>If you have a 32-bit app, you <b>should</b> only be reading and writing to the 32-bit registry equivalent.  Example:  HKEY_LOCAL_MACHINE\Software\Wow6432Node   <br><br>Also, on a 64-bit system, c:\windows\system32  is only for 64-bit stuff.  32-bit stuff will be kept in the equivalent name that includes the emulator's name:  c:\windows\SysWOW64<br><br>If you go to explorer and navigate to c:\windows\SysWOW64 you will see 32-bit versions of many things that are in c:\windows\system32  If there is a regedit in c:\windows\SysWOW64, it should load your 32-bit registry entries.  Otherwise you will need to use the normal registry editor and navigate to the 32-bit equivalents for each registry category.   <br><br>FWIW, this is nothing new and has been like this on 64-bit versions of XP and Vista, but since those versions were hardly used, this is new to many people.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1123342"></a>

<a name="1123343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ps.  Any DLLs distributed with a 32-bit exe and not kept in your program's directory should be placed in c:\windows\SysWOW64 so the emulator can find them.  This is another "gotcha" that snags some folks.  32-bit DLLs need to go in the eumlator's system directory.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1123347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Coolios :) <br><br></td></tr></table><br>
<a name="1123365"></a>

<a name="1123366"></a>

<a name="1123367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jp1985</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks GaryV your a lifesaver :)<br><br>For other people looking to solve this, I used the following method to read 64bit keys:<br><br>Local temp_proc:Tprocess = CreateProcess("C:\Windows\sysnative\reg.exe QUERY HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\GameUX",1)<br><br>Running a 32-bit app on a 64-bit OS redirects system32 to SYSWOW64 automatically.<br>The sysnative is a virtual directory that actually points to the real system32 folder. Running the 64bit Reg with proper command line options returns 64bit registry items.<br><br>Heres my full code:<br><pre class=code>
Local temp_proc:Tprocess = CreateProcess(GetEnv("WINDIR")+"\sysnative\reg.exe QUERY HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\GameUX",1)
While temp_proc.status()
	If temp_proc.pipe.ReadAvail() Print "pipe: " + temp_proc.pipe.ReadLine()
Wend

Extern "Win32"
	Function GetEnvironmentVariable(lpName$z, lpBuffer:Byte Ptr, nSize) = "GetEnvironmentVariableA@12"
End Extern

Function GetEnv$(envVar$)
		Local buff@[64]
		
		Local rtn = GetEnvironmentVariable(envVar$, buff@, buff.length)
		If rtn &gt; buff.length
			buff@ = buff@...]
			rtn = GetEnvironmentVariable(envVar$, buff@, buff.length)
		EndIf
		
		Return String.FromBytes(buff@, rtn)
End Function
</pre><br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1285224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> seems that there are issues with this code (on windows 8.1 and 10)<br><br><a href="http://www.blitzmax.com/Community/posts.php?topic=105477" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=105477</a><br><br>any idea in how to use the standard APIs and KEY_WOW64_64KEY = 0x0100 ??? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
