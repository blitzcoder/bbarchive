<!DOCTYPE html><html lang="en" ><head ><title >shadow mesh vertex alpha probem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >shadow mesh vertex alpha probem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >shadow mesh vertex alpha probem</a><br><br>
<a name="671620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kalisme</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all... I'm having a problem with my little shadow engine I'm doing... Here is my conundrem:<br>I need the shadow meshes to fade as they go out of distance.... so I figure that means they must use entityfx mesh, 2+32<br>And I'm using the vertexcolor command, changing the alpha with the Alpha# part of the command...<br>And I ot it working with normal meshes...<br>But I have to use entityblend mode 2 and I'm using textureblend mode 5... and entityblend mode 2 (what I need to hide the white backgrounds of my shadow textures) seems to stop the vertex alpha from working...<br>I'm very confused... can someone help me?<br>Thank you for reading,<br>-Kev <br><br></td></tr></table><br>
<a name="671718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you try to use entityAutofade instead? <br><br></td></tr></table><br>
<a name="671725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kalisme</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> dosn't that just fade depending on it's distance from the camera? and it's not per vertex... I don't think...<br><br>(I could be wrong... I haven't used the command much)<br>When I said I want the shadow mesh to fade as it goes out of distance, I meant I want it to fade as it goes out of distance from the light source... and it really has to be per vertex because it copys the required vertecies from the meshes it covers... so the vertecies can be really far apart... so each verticies distance from the light source can be very diffarent...<br><br>But thank you very much Jfk... I really like your work :D <br><br></td></tr></table><br>
<a name="671745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok I see. There are some problems with some cards when mixing alpha and additional blending. see versions.txt about the reimplementation of the feature to mix them at all.<br><br>It doesn't matter if it's vertex alpha, texture alpha, entityalpha, basicly it's alpha with all its troubles (z-sort, the mentioned mixing problem)<br><br>I think you seriously need to use an other shadow blend mode. IMHO there's no need for blendmode 2. I suggest to do it this way: Blendmode default, 1(alpha). Use a texture that is completely black on the RGB channel and has the shape of the shadow tored in the alpha channel only. You may use Photoshop to do such a shadow. Save as TGA 32 Bit.<br><br>Alternatilvely do it this way: (Assuming your shadow texture is dark shadow on bright "background")<br><br><pre class=code>
tex=loadtexture("shade.bmp")
setbuffer texturebuffer(tex)
lockbuffer()
for j=0 to textureheight(tex)-1
 for i=0 to texturewidth(tex)-1
  rgb=readpixelfast(i,j) and $FFFFFF
  grey=int (255.0-(((rgb shr 16)+((rgb shr 8) and $FF) + (rgb and $FF))/3.0)) shl 24
  writepixelfast i,j,grey
 next
next
unlockbuffer()
</pre><br><br>Not sure if it works, just typed it. What it does: inverting the brightness, so black will be white and white will be black, then it will shift the brightness to the alpha channel and paint the RGB channels black.<br><br>when you use med. grey on white, it should look about nice. <br><br></td></tr></table><br>
<a name="671814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ehrm, I just realize you need to update the textures dynamicly (do you?) so using readpixelfast like this would be too slow.<br><br>I take it you are rendering the shadow caster from the lights viewpoint, with the background white and the caster black and this forces you to use blendmode 2? In this case I'd suggest to simply swap the colors and use mode 1. EntityColor m,0,0,0 won't work for the shadow caster, but you may paintmesh it with a brush that is made of a white texture with fx 1 etc. Then use the black color for the background instead.<br><br>All you need to do is to store the old brush(es), using GetSurfaceBrush(mesh). Although the command is creating a copy of the original brush, I think the original brush will be removed as soon as you are painting the meshes with an other brush. So don't worry too much about ram. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
