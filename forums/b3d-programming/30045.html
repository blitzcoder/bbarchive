<!DOCTYPE html><html lang="en" ><head ><title >Sin/Cos Lookup Tables</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Sin/Cos Lookup Tables</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Sin/Cos Lookup Tables</a><br><br>
<a name="319492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Apocalypse</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are Blitz3D's math functions already optimized with lookup tables or does it force an actual calculation each time the functions are called? <br><br></td></tr></table><br>
<a name="319494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> A calculation... <br><br></td></tr></table><br>
<a name="319502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If ALL the lookup tables were stored in ram, people would need way more than they should. so - no. And anyway, the calculations are pretty fast. <br><br></td></tr></table><br>
<a name="319512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The calculations are *trivially* fast... :) <br><br></td></tr></table><br>
<a name="319514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use look-ups all the time for real-time FX. If your sin/cos or other math is complex then look-up tables are the way to go!<br><br>We had this discussion some time ago and look-up's kicked ass. :)<br><br>L8r, <br><br></td></tr></table><br>
<a name="319515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> In fact here is a test app to show the difference:<br><br>No Look-Up: 1187 mils<br>WITH Look-Up: 39 mils :)<br><br><pre class=code>
;By Richard Betson
Graphics 640,480,16,2

;x and y precalc array
Dim look_up_x(800,600)
Dim look_up_y(800,600)

;make look_up table
look_up()



;Calc each part of the example math NOT USING A LOOK UP
calc_time=MilliSecs()
Calc_No_Look_up()
total_calc_millisecs=MilliSecs()-calc_time


;Calc each part of the example math WITH A LOOK UP
look_up_time=MilliSecs()
For x=1 To 800
	For y=1 To 600
	x1=look_up_x(x,y)
	y1=look_up_y(x,y)
	Next
Next
total_look_up_millisecs=MilliSecs()-look_up_time



Color 255,128,255

While Not KeyHit(1)

Text 10,60,"Here are the results:"
Text 10,80,"Total Time in Millisecs it took to calc example math NOT USING a LOOK-UP"
Text 10,100,"Calc No Look_up Time:"+total_calc_millisecs
Text 10,120,"Total Time in Millisecs it took to calc example math WITH a LOOK-UP"
Text 10,140,"Look_up Time :"+total_look_up_millisecs

Text 10,180,"Hit Escape to exit"
Wend
End


Function Calc_No_Look_up()
For x=1 To 800
	For y=1 To 600

		rad#=Abs((x-ttx)*(x-ttx))+Abs((y-tty)*(y-tty))
		If rad&gt;0
			rad= Sqr(rad)
		Else
			rad=0
		EndIf
		If rad=0 Then rad=1
		dx#=((x-ttx)/rad)
		dy#=((y-tty)/rad)
		rad=((1/Cos((rad)/ttx*2))+(rad+2))
		x1=Int(dx*rad)+ttx
		y1=Int((dy#)*rad)+tty

	Next
Next

End Function


Function look_up() ; Makes a look-up table that hold the x and y data precalced
For x=1 To 800
	For y=1 To 600
	
	;This is just an example calc. Something I have used befor like this
		rad#=Abs((x-ttx)*(x-ttx))+Abs((y-tty)*(y-tty))
		If rad&gt;0
			rad= Sqr(rad)
		Else
			rad=0
		EndIf
		If rad=0 Then rad=1
		dx#=((x-ttx)/rad)
		dy#=((y-tty)/rad)
		rad=((1/Cos((rad)/ttx*2))+(rad+2))
		x1=Int(dx*rad)+ttx
		y1=Int((dy#)*rad)+tty

	If x1&gt;=tw-1 Then x1=tw-1
	If y1&gt;=th-1 Then y1=th-1
	If x1&lt;=1 Then x1=1
	If y1&lt;=1 Then y1=1
	
	;Save this data (map x and y pos. precalced)
	look_up_x(x,y)=x1
	look_up_y(x,y)=y1
	
	Next
Next

End Function
</pre> <br><br></td></tr></table><br>
<a name="319516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Apocalypse</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's nice to see people who still appreciate the time saving lessons of old when CPU power was at a premium. It's these types of time saving measures that really allow highly detailed games to be done without lossing frame rate.<br><br>It may take almost not time to calculate one COS(23) but when you need to run it 10,000 times that starts to add up. By pre-computing a lookup table, the time is actually the cost of reading a memory location (1 cycle).<br><br>Thanks Richard. <br><br></td></tr></table><br>
<a name="319518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I got 9 seconds without<br><br>2 seconds with tables <br><br></td></tr></table><br>
<a name="319520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not saying it's not worth doing - just that blitz shouldn't precalc it. It's even better if you can have lookup tables for whole equations. <br><br></td></tr></table><br>
<a name="319526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It's nice to see people who still appreciate the time saving lessons of old when CPU power was at a premium. <br></div> Oldtimers (when it comes to programming) like myself do this on a spinal reflex. <br><br></td></tr></table><br>
<a name="319549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lol @wedoe...<br><br>Not many of us left. :)<br><br>L8r, <br><br></td></tr></table><br>
<a name="319554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not an oldtimer- but I started on the atari and went on up to a 300mhz compie with QB. -that's gotta count for somthing :) <br><br></td></tr></table><br>
<a name="319574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get no look up: 64<br>Look up: 53<br><br>Your 900mhz Celeron is to blame.  I have a 2400+ AMD. <br><br>As you can see, with a modern CPU, the difference is trivial because accessing ram takes almost as long as just doing the calculations.  I wouldn't be at all surprised to find out that a 3ghz system did the calculations faster than the lookup. <br><br></td></tr></table><br>
<a name="319586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get 54 / 20 with a 2700+ AMD thats almost 3* faster. <br><br></td></tr></table><br>
<a name="319590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barnabius</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> 2018 ms with no look-up<br>  16 ms with look-up<br><br>P4, 2400 MHz<br><br>sswift is right about accessing the ram being rather slow compared to modern FPU in a typica CPU but let's not forget that small look-up table can easily end up completely inside the L2 cache and we all know how fast accessing the L2 cache is. Looks like the "old way" of doing it wins again, even with ultra modern hardware. :)<br><br>Barney (started assembly programming on KIM-1) <br><br></td></tr></table><br>
<a name="319593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>2018 ms with no look-up , P4 2400 MHz <br></div><br>There's something seriously wrong with that. I get 140 ms with a 1000MHz Athlon. <br><br></td></tr></table><br>
<a name="319602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I bet banabius is running with debug on.<br><br><br>"I get 54 / 20 with a 2700+ AMD thats almost 3* faster."<br><br>So?<br><br>He's doing the calculation 480,000 times.  In what realistic situation, other than a full screen polar distortion function like I put in my little pong game, would you possibly want to call sin or cos 480,000 times a frame?  I can't think of any. <br><br>That's what Blitzsupport meant when he said it was "trivially" fast.  It's not worth optimizing in 99% of situations where you'd use sin or cos, cause you'll never notice a difference. :-) <br><br></td></tr></table><br>
<a name="319650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm an old timer and I see almost no benefit to obfuscating my code with look up tables.  Yes, they are faster in pathological test cases but in real life situations?  Hardly. <br><br></td></tr></table><br>
<a name="319659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I should point out that I post my drivel with real-world game situations in mind, not pointless theoretical benchmarks! <br><br></td></tr></table><br>
<a name="319666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> These would be impossible in "real-time" with out look-up's:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=29481" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=29481</a><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=19509" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=19509</a><br><br><a href="http://blitz.idigicon.com/project_detailb.asp?ProjectName=Water%20FX%20-%20Real%20Time" target="_blank">http://blitz.idigicon.com/project_detailb.asp?ProjectName=Water%20FX%20-%20Real%20Time</a><br><br><br>some more examples I use look-up's in:<br><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=27171" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=27171</a><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=29496" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=29496</a><br><br><br>Look-up's are the easyest way to improve any complex real-time FX. I use them all the time! Try this example with out look-up's. :)<br><br><br><pre class=code>
;The Perfect Sign - Copyright 2003, Richard R Betson
;vidiot@... -- www.redeyeware.50megs.com
;Speed with lookups! Use at your own risk. All rights reserved.



Graphics 800,600,16
stp=45
Dim mb#(201,201,stp+1,2)

Text 300,290,"Making look-up's"

SetBuffer BackBuffer()



timer=CreateTimer(75)

lu(stp)
cr1=MilliSecs()+10000
cr2=MilliSecs()+20000
cr3=MilliSecs()+30000


While Not KeyHit(1)

LockBuffer BackBuffer()

For y=0 To 200
	For x=0 To 200

	clr=((225-(y/2)) Shl 8 Or (146+(y/4)) Or  (155+(x/2)) Shl 16 )
	
	a#=mb#(x,y,ii,0)
	b#=mb#(x,y,ii,1)

	If a&gt;1 And a&lt;799 And b&gt;-299 And b&lt;399
		WritePixelFast a+110,b+240,clr
	EndIf

	Next
Next
UnlockBuffer BackBuffer

	fps=fps+1
	If fps_t&lt;MilliSecs()
	fp$=" "+Str$(fps)
	fps_t=1000+MilliSecs()
	fps=0
	EndIf
	Color 255,0,0
	Text 10,10,"The Perfect Sign -  Richard R Betson"
	
	
	
	;Text 10,35,"FPS: "+fp$



If KeyDown(68)=1
	SaveBuffer(BackBuffer(),"screen.bmp")
EndIf

WaitTimer(timer)

Flip False
Cls
ii=ii+1
If ii&gt;stp Then ii=0
Wend


End



Function LU(stp)


For i=0 To stp

.jmp

If t&lt;MilliSecs()
t=MilliSecs()+50
mt#=(MilliSecs()/8)*1.2


For y=0 To 200
	For x=0 To 200
		rad#=Abs(((x-100))*(x-100))+Abs((y-100)*(y-100))

		If rad&gt;0
			rad= Sqr(rad)
		Else
			rad=0
		EndIf

		a#=(x*2)+(Sin((y-100-mt))/y) + y-(Cos(y-100-mt)/y)
		b#=(y)-100-(Sin((rad*20)-(mt))*(rad/5.9)) + y/2-(Cos((rad*34)-(mt))/(rad/40))
		mb#(x,y,i,0)=a#
		mb#(x,y,i,1)=b#
	Next
Next
Else
Goto jmp
EndIf

Next

End Function

</pre><br><br>L8r, <br><br></td></tr></table><br>
<a name="319696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Micha</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting to see how the debug mode slows things.<br><br>Debug mode off :<br>No Look-Up: 1595 mils <br>WITH Look-Up: 11 mils :)<br><br>Debug mode on :<br>No Look-Up: 1802 mils <br>WITH Look-Up: 85 mils <br><br>System :  <br>P4  3 Ghz, 512 MB Ram<br>Ati 9800 pro<br>Win XP <br><br></td></tr></table><br>
<a name="319718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, those are good demonstrations, but again not really representative of real-world game situations. Of course look-ups have their place (eg. cool little graphics demos like these that need to use the Sin/Cos commands 1000s of times per loop). The original poster didn't specify his requirements, though --  you'd very rarely use Sin/Cos that much in an actual game. <br><br></td></tr></table><br>
<a name="319727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> That code isn't doing a lookup in a sin table it's doing a lookup for an equation. Sin lookup tables are pointless. <br><br>I get 1226 no lookup and 1252 on lookups<br><br>Since you are usually doing angles with sin this is<br>tested with a double precision angle. I added the <br>text string because both would fluctuate with less<br>than a millisecond of time 0,1 0,0 1,0 and so on.<br><pre class=code>
Graphics 640,480,16,2

;x and y precalc array
Dim look_up_x#(36000)

;make look_up table
look_up()



;Calc each part of the example math NOT USING A LOOK UP
theta#=0
calc_time=MilliSecs()
	For x=1 To 36000
		theta#=theta#+0.01
		rad#= Sqr(theta#)
		Text 0,0,rad#
	Next
total_calc_millisecs=MilliSecs()-calc_time


;Calc each part of the example math WITH A LOOK UP
look_up_time=MilliSecs()
For x=1 To 36000
	rad#=look_up_x(x)
	Text 0,0,rad#
Next
total_look_up_millisecs=MilliSecs()-look_up_time



Color 255,128,255

While Not KeyHit(1)

Text 10,60,"Here are the results:"
Text 10,80,"Total Time in Millisecs it took to calc example math NOT USING a LOOK-UP"
Text 10,100,"Calc No Look_up Time:"+total_calc_millisecs
Text 10,120,"Total Time in Millisecs it took to calc example math WITH a LOOK-UP"
Text 10,140,"Look_up Time :"+total_look_up_millisecs

Text 10,180,"Hit Escape to exit"
Wend
End



Function look_up() ; Makes a look-up table that hold the x and y data precalced
For x=1 To 36000
	theta#=theta#+0.01	
	look_up_x(x)= Sqr(theta#)	
Next

End Function
</pre> <br><br></td></tr></table><br>
<a name="319788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello !!!!<br><br>Is this turning into a religion ? What is this ?<br>Seems to me some people here want the raving lunatics that want<br>to spare a few cycles of CPU time to change their mind at any cost !<br><br>I know one doesn't have much use for this in most situations nowdays,<br>but it can never be wrong to make your program faster, no matter how little.<br><br>I always spare cycles if I can, so shoot me ! <br><br></td></tr></table><br>
<a name="319792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> but it can never be wrong to make your program faster, no matter how little.  <br></div><br>Well, actually, in a professional situation - it can be.  Optimizing code needlessly is the quickest way to get your fellow programmers to hate you. <br><br></td></tr></table><br>
<a name="319812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> That can only be true if you work with people that are not very professional. <br><br></td></tr></table><br>
<a name="319895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> No.<br><br>OK, so, you optimize a piece of code that doesn't need it.  Let's say that code develops a problem that someone needs to go in and fix.  Because of your optimizations, the code is now harder to read and the bug takes longer to fix thus costing the team time and money.  Time and money that was essentially tossed into a bucket and burned because someone decided to optimize a piece of code that didn't need it.<br><br>Now ... who's the unprofessional one in this situation?  The optimizer who believed that optimization is never the wrong choice. <br><br></td></tr></table><br>
<a name="319937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> But sin/cos tables aren't optimizations. You're going to<br>see equal amounts of time using lookups as you are if you don't when you're finding a vanilla sin or cos.<br>Equation tables are a great optimization and are very useful. Richard Betsons example is a great example of its use.<br><br>One way I optimize for effects is to calculate one sin each loop and store an offset for a bobing rotating effect in some of my pickup items. I store the ofset in the type of the foo. This saves me a sin calc or a lookup for each and replaces them with a simple addition. <br><br></td></tr></table><br>
<a name="319942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AbbaRue</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> On that first example I get 1693 without lookup, and 11 with lookup table. <br><br>On this note, the usual situation were I use lookup tables is when I can't find a simple formula to get the numbers I need. <br>Or when I only need a small number of answers. And am going to use those same answers over and over again. <br>Eg. I was designing a game that only allowed 16 different positions to turn 360 deg.  So as to allow for less calculations.  <br>In this case a lookup table of 16 values would be quite efficient.  <br>If you have dozens of entities in a world, that are moving around, only allowing 16 directions for them to face, makes for a lot less calculations.  <br>Just calculate the directions once and store them in a lookup table. <br>All things have a place under the right circumstances.<br>Also, todays cpu's have built in functions that run very fast.  Many people don't know this but most computers on the market have a buss speed of less then 200 Mhz. <br>So even though the cpu is running at 3 GHz, they read and write to memory at less then 200 MHz. And the fastest computer on the common market today has a buss speed of 800 MHz. <br>That means that the fastest you can read and write memory is at 800 MHz.  So if you can use internal cpu math funcions to calculate, that could be much faster then accessing memory in a lookup table. <br>Definitly if your formula is in cpu cash while calculating. <br><br></td></tr></table><br>
<a name="319950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> also, generally lookup tables are easy to read. trig tables can be sin_, tan_ and atan_.  <br><br>I think optimisations are good if you are optimising a frequently called function. or even an unfrequently called one. If it's a team project, why not write some comments that tell how the optimisation works? <br><br></td></tr></table><br>
<a name="319960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eh, the message is getting lost in semantics - as always.<br><br>The point is : don't optimize unless you need to.  Measure twice, cut once. <br><br></td></tr></table><br>
<a name="319962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> depends on your definition of needing.<br><br>For instance, runing on a crappy computer would 'need' more optimisations. A great compie would 'need' less optimisations.  So it depends on how many users you want to lose. <br><br></td></tr></table><br>
<a name="320080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Now ... who's the unprofessional one in this situation?  <br></div> I guess we both are, if you also have made money out of programming.<br>But there is no reason you shouldn't comment your code is it ?<br>If the other programmers you refer to is equally professional they <br>would always optimize code also, this way all the programmers think<br>alike and the source is no sweat to read at all.<br><br>But I do get your point, no problem there, I just disagree.<br><br>On top of that I have a problem making "bad" code, it kind<br>of physically hurts inside to see my name on a routine that<br>IMO is not as good as it should be. Vanity I guess.<br><br>On the other side, I have never programmed in a company with more than<br>just a handful of programmers and we almost never looked into the others code.<br><br>Than again I see your point of view as a source to make bloatware<br>and if there is something I really really have a problem with, it's bloatware. <br><br></td></tr></table><br>
<a name="320203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Than again I see your point of view as a source to make bloatware <br>and if there is something I really really have a problem with, it's bloatware.  <br></div><br>I'm advocating bloatware?!  You're completely missing my point.<br><br>Moving on... <br><br></td></tr></table><br>
<a name="320213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Epicboy is 100% correct here.   Code optimisation should only be done when necessary and then as a last resort.  I'm an old school coder from the speccy days and I'm well accustomed to very low level optimisation.  <br><br>I also know the value of clear, readable, updatable code.  Optimisation ALWAYS have a detrimental effect on the code in some way.  Usually it makes the code far less general purpose, capitalising on the current specific use.<br><br>My philosphy is to optimise the algorithm not the code.   If something is slow, there's usually a more efficient approach which will gain you far more speed than tweaking code.<br><br>Mr Betsons example is misleading,  it shows good use of a look-up table (and nobody is arguing against those) but not of a sin\cos look up table which itself is worthless. <br><br></td></tr></table><br>
<a name="320256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> @weboe<br><br><div class="quote"> <br>Seems to me some people here want the raving lunatics that want <br>to spare a few cycles of CPU time to change their mind at any cost ! <br> <br></div><br><br>I should point out that my 900 Celeron is an overclocked 600.. lol<br><br>l8r, <br><br></td></tr></table><br>
<a name="320294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> My philosphy is to optimise the algorithm not the code. <br></div> Well put.<br><br>If you see my postings above, I have no problem with others<br>coding by a different mindset than I do, I just don't see<br>why some religiously try to covert people like me to program<br>in a way they think is approprate.<br><br>@EpicBoy: The bloatware comment were a bit stupid, I'm sorry.<br>You didn't comment on anything else I wrote tho.<br><br>I think someone must put a gun to my head to make me stop<br>caring about optimizing code, like I said before, it's a spinal reflex :) <br><br></td></tr></table><br>
<a name="320310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> A lot of people don's seem to have ever heard the maxim "premature optimisation is the root of all evil", or understood it.<br>I'm glad though to see Wedoe recognize what EpicBoy didn't advocate against optimization, but against unneeded or premature optization.<br>In fact Wedoe, I used to have the same "spinal reflexs" as you. I just learned to recognize which of those spinal reflexs are outdated and counterproductive.<br><br>And for those that still don't get it, that doesn't mean at all that lookup tables are to be blindly banned, but equally don't use them blindly, do so only where needed (inner loops that must be really fast, and supposing that on the platform you're targetting it's faster enough to be worth it), and when needeed (that is, rarely at the very beginning of your develoment, but most likely as a last optimzation stage). <br><br></td></tr></table><br>
<a name="320439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Richard Betson</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I use look-ups all the time for real-time FX. If your sin/cos or other math is complex then look-up tables are the way to go! <br> <br></div><br><br>I still stand by this. :)<br><br>L8r, <br><br></td></tr></table><br>
<a name="320467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Optimisation doesn't necessarily make your code less readable. in some cases, more readable. For instance, the code optimiser/cleaner I'm working on will give you options whether or not to make optimisations that detrement readability. You may be thinking 'How is it possible to optimize code with a program?' Well, it is admitadly diffucult, however not so hard that it isn't worth a try. Basically, first work out simple stuff like indentation(done), add quote checking(quote lint), add mistyping errors(in the works; to find mistyped variables/functions). Then do stuff like static expression evaluation(done - even though blitz does it for you while compiling), varible modification evaluation, etc. Then do complex stuff like specific optimisations that target various things. <br><br>The majorly un-nice to readability would be to make all variables global so that the program doesn't have to recreate them every function call. This would only be recommended before an exe release. <br><br></td></tr></table><br>
<a name="320519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bocote</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Of course it is possible to optimise a program using another program, after all that is what optimising compilers do.  One of my compilers makes dramatic differences to code size and execution speed, just by enabling its optimisation.  Interestingly butchering code in a vain attempt to make it “optimal” can often make it worse because it gets in the way of the optimiser.<br><br>I have seen someone who wrote X + X + X because it was quote – “faster than 3 * X” – he was amazed at just how much slower his “optimised” and less clear equation was.<br><br>I say don’t optimise unless you need to and then try to think of a better algorithm don’t go in for coding tricks. <br><br></td></tr></table><br>
<a name="320524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bocote</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Making variables global instead of local can seriously degrade performance.  Not sure on Blitz – but on stack frame processors accessing local variables can be done with small and very efficient instructions where as accessing Global variables required length far or indirect instructions.<br><br>I reduced the code size of one program from 64K bytes to 41K Bytes and the execution speed more than doubled at the same time.  This was done by using more local variables so allowing the compile to use the processors most efficient memory access every time a variable was used instead of using a larger inefficient access to the global memory space.  So I improved the structure of the code, made it more readable, reduced it size by 1/3 and more than doubled it execution speed.<br><br>So if you want to butcher your code in the name of optimisation think again, I have seen “professional” programmers in dismay after weeks of code butchering in the name of “optimisation” only to find little improvement and sometimes even total disbelief from them when they find their newly “optimised” code runs slower than it did before. <br><br></td></tr></table><br>
<a name="320553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> heh. I always thought globals would run faster !?!?! oh well. good thing I haven't done that yet. I bet X+X is faster than 2*X :P .... Although it has to access the variable twice? hmm. oh well. one thing we know is that * is faster than ^2 <br><br></td></tr></table><br>
<a name="320591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> one thing we know is that * is faster than ^2  <br></div>You can't even say that in general (though it may be in blitz). It is equally often said that x*2 is slower than x shl 1. That's not so sure. Why? Because all the optimizations you're planning to do in your program are not new and are the kind of things optimizong compilers can do very easily. Here, a compiler can recognize that "2" is a constant integer expression, and evaluates to 2 (!). Thus it can use a left shift by itself to achieve the same result (I have absolutely no idea if blitz does this, though someone reported it does; it's easy to check, and if it doesn't then you can keep this trick in your bag of useful optimization). This means that with compilers that have even a minimal optimizing phase, you can avoid to manually replace pultiplications by 2 by left shifts yourself (thuse keeping a more understanble and straightforwardcode). In this case, better keep left shifts for operations that conceptually really operate on bits and let the compiler do these optimizations. <br><br></td></tr></table><br>
<a name="320593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> The "2" thing is a good example.<br><br>In the old days of Z80 I would left shift every time.  But nowadays with faster processors I value clearer code and dev time over run time.   I stick to x=x*2 in my code.  If the compiler catches it and compiles to a left shift then great (Blitz does). <br><br></td></tr></table><br>
<a name="320597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bocote</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> I’m not saying local variables are faster than global – just that they often are, so if it matters to you check before assuming you need to use the less desirable global variable in the name of efficiency.  Local variables can also all use the same memory locations – very important on processors that have very little memory.<br><br>Your assumption that 2 * X is slower than X + X is based on the assumption that a multiply is slower than an add.  I don’t know for the Pentium but that is not always the case.  In the vast majority of expressions in your program you will never notice the difference anyway. <br><br></td></tr></table><br>
<a name="320603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would add my advice here, because a sin/cos look-up table solved me a nasty problem.<br><br>I coded an asteroids clone. As add-on, I wrote a record and playback system which can record an entire game session, and then playback it automatically (if you are curious, you can download it by following the link in my signature).<br><br>The problem was that the session files saved on a pc, given impredictable result on another pc: the astroship hit asteroids, or missed it sometime, so the playback worked only on the pc where it was saved, and this was not exactly what I planned.<br><br>I've finally solved that problem, and discovered two important aspects:<br>1) the imagewidth and imageheight commands, give different values on different pcs - and this was one source of the trouble<br>2) the sin and cos - used for the astroship's bullets movement - give also different values on different pcs - and this was the second source of imprecision with the bullets.<br><br>So my advice is to use look-up table if you need the same precision on different pcs, as well as to use constant values for imagewidth and imageheight.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="320623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> 3) If you use sin/cos for absolute placement on the screen you won't have to worry<br>the pattern by the movement is looking like a spring and the object actually<br>moves off screen after a while because of the lack of enough numbers after zero in the math. <br><br></td></tr></table><br>
<a name="320628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Imagewidth and Imageheight give different results?!  You sure? Are you sure you weren't using floats where you should've used Ints?  I've never seen that before. If so, thats a nasty bug. <br><br></td></tr></table><br>
<a name="320685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> @MasterBeaker,<br>yes I'm sure, I used integers, and I have reported it in the old-fashioned bug forum...<br><br>The difference was about one pixel, but enough to miss (or hit) a sprite...<br><br>However, I'm quite convinced that it's more video card related rather than Blitz. Different gfx cards could act in different manner with anti-aliased 2D images.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="320691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Were you resizing them? What do you mean by anti-aliased? <br><br></td></tr></table><br>
<a name="320698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> He means the edges were all fuzzy.  duuuuhhhhh :P. <br><br></td></tr></table><br>
<a name="320775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Were you resizing them? <br></div><br>Nope.<br><br><div class="quote"> What do you mean by anti-aliased? <br></div><br>An image made with pshoppro, where the image itself is drawn with antialias. So yes, the edges were all fuzzy.<br><br>I have to tell, however, that I tried also with 'normal' images - just plan non-antialiased sprites for the asteroids - but get the same error.<br><br>Crazy gfx cards !<br><br>Sergio. <br><br></td></tr></table><br>
<a name="320841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could you perhaps post an example which demonstrates ImageWidth and ImageHeight reporting different values on different machines?  I haven't actually tested it but I find it hard to believe that those commands are variable in the way you describe; they just return the pixel dimensions of an image, and the number of pixels in a given image never change (assuming you never alter the image.)<br><br>Oh, and maybe do it in a new thread?  This one is getting pretty lengthy and the example would be off-topic. <br><br></td></tr></table><br>
<a name="320908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> I hardly believe it too. I'd like to see it, and then we could make a bug report, because there is *absolutely no reason* why it would behave like this. <br><br></td></tr></table><br>
<a name="321014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless of course its only on one gfx card in the whole world. :) <br><br></td></tr></table><br>
<a name="321095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did report this issue time ago - I think more than one year - and reported also a snippet to demonstrate it. The thread was opened and discussed on the bugs forum, and I guess that Mark is well aware about it, because he too answered to the thread, like other Blitzers.<br><br>Basically, if you want to try by yourself:<br>- create an image with a paint program - NOT from within the program itself<br>- load it from within Blitz<br>- print out ImageWidth and ImageHeight<br>- compare the values on different pcs.<br><br>I've experienced a difference of one pixel between an athlon with nvidia card, and an Intel laptop (don't remember the gfx card now).<br><br><div class="quote"> Oh, and maybe do it in a new thread? This one is getting pretty lengthy and the example would be off-topic. <br></div><br>@jhocking<br>sorry for that, I just wanted to spot out another reason to the advantage of using pre-calc values; I didn't want to turn this topic in a bug report, really..<br><br>Sergio. <br><br></td></tr></table><br>
<a name="321253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>;SIN/COS Lookup Table
Dim Sin2#(360)
Dim Cos2#(360)
For loop=0 To 359
	Sin2#(loop)=Sin(loop)
	Cos2#(loop)=Cos(loop)
Next</pre>Use like Blitz Sin/Cos:<pre class=code>y=Sin2#(degrees)*100</pre>Very fast...very harmless. <br><br></td></tr></table><br>
<a name="321320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Only problem you have, is where your doing angle calculations in blitz3d. If you put sin(1048), easy. You get the result.<br><br>With look-ups, you need to be sure that after every calculation, you wrap the angle wrap around, so it doesn't exceed 359 or go below 0. Which is a pain :) <br><br></td></tr></table><br>
<a name="321444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> With look-ups, you need to be sure that after every calculation, you wrap the angle wrap around, so it doesn't exceed 359 or go below 0. Which is a pain :)  <br></div><br><br><pre class=code>Mod</pre> <br><br></td></tr></table><br>
<a name="321607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good answer, perhaps could have given two or three words more info tho &lt;grin&gt; <br><br></td></tr></table><br>
<a name="321613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK<br><br><pre class=code>degrees=degrees Mod 360</pre><br><br>[edited]<br><br>:) <br><br></td></tr></table><br>
<a name="321621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> You mean mod 360 I guess?<br>And using mod on each access of the table defeats the purpose of speed. That's why the usual way of doing it is to have 256 (or 512, or...) values instead of 360 (thus allowing to just shift mask the 'angle', and having everything conforming to that. <br><br></td></tr></table><br>
<a name="321627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wedoe</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, should have been 360 and it was a comment to the use for placing gfx according to precalculated sin/cos, not lookup-tables in general. :)<br>Using as lookup-table for speed a more computerfriendly number is of coz much quicker. <br><br></td></tr></table><br>
<a name="321657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Apocalypse</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't realize this would be such a contentious subject when I asked the question. I did mean using the tables in the situation Frank Taylor described. Interesting thread tho. :-) <br><br></td></tr></table><br>
<a name="321669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> The table described isn't very practical,  you can only use a whole number for the angle.  That would be of little use in any of my projects.<br><br>If the angle is a float then there's a lot more complexity in using a look up table,  certainly enough to negate the speed increase.<br><br>Ultimately Sin\Cos are fast and unlikely to be any kind of bottleneck in your game.<br><br>Sure, I could sit an devise a demo in which the speed of Sin\Cos is critical but that proves nothing. <br><br></td></tr></table><br>
<a name="321776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >pepsc</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> hello all what u do is make a table from 0 to 511 then use "and" i would love to see the tables that were in blitz user magazine again "bum" any body got that code <br><br></td></tr></table><br>
<a name="321788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Have Fun" doing what?  Parsing your post?  :) <br><br></td></tr></table><br>
<a name="321799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lol.  Epicboys hiden rage comes out once more :P.<br><br>(just playing) <br><br></td></tr></table><br>
<a name="321822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="321842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's hidden about it? <br><br></td></tr></table><br>
<a name="322443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeh man settle down, I'm beginning to suspect maybe FlameDuck has hijacked your handle here &lt;cheeky grin&gt; <br><br></td></tr></table><br>
<a name="322491"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does a smiley not mean what I think it does?  That was a joke.  Geez, people... <br><br></td></tr></table><br>
<a name="322507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Joke or not, that was a good example of bad typing :P <br><br></td></tr></table><br>
<a name="326460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> 2) the sin and cos - used for the astroship's bullets movement - give also different values on different pcs - and this was the second source of imprecision with the bullets. <br><br>So my advice is to use look-up table if you need the same precision on different pcs... <br></div><br><br>Of course the lookup table is generated at startup of the app, so different processors generating different results won't be solved by this ?? <br><br></td></tr></table><br>
<a name="326663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Of course the lookup table is generated at startup of the app, so different processors generating different results won't be solved by this ??  <br></div><br>Indeed BlackJumper,<br>the trick here is to build up a look-up table once, on your development pc, and store the values in Data statements.<br><br>Then, pick the values from the data statements to fill up two arrays like my_sin() and my_cos(), and use my_sin(angle) instead of sin(angle) to retrieve the values.<br><br>In this way you are sure that all the pcs will use the same values - because they are not calculated, but red from data statements - that is, they are constant.<br><br>This is the way I solved the 'different values on different pcs' issue.<br><br>Hope this has sense for you,<br>Sergio. <br><br></td></tr></table><br>
<a name="326707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> @semar:<br>Another option here is to create pseudo-Sin functions from a McLaurin-Taylor expansion series. Normally this is summed to an infinite number of terms, but can be reasonably approximated with only 5 - 10 terms, depending on the accuracy required...<br><br><img src="http://www.win.tue.nl/~maubach/education/2n320/lectures/arithmetic/arithmetic/img32.gif"><br><br>This involves calcualtions of powers and of factorials (big hits on processor) but that makes them perfect for storing in a lookup table rather than constant calculation. And since you are controlling the accuracy by choosing the number of terms I would assume they will be constant across processors {unless the power calculations for floats give different answers :-( } <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
