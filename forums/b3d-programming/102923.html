<!DOCTYPE html><html lang="en" ><head ><title >Embedding files question</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Embedding files question</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Embedding files question</a><br><br>
<a name="1235485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a way to embed a sound or graphic file in a Blitz3D program so that there is no need to load it separately from the executable?<br><br>For instance, if I have a beep.wav file, can it somehow be embedded in the code itself, as DATA statements or something, so that the WAV file doesn't have to be loaded at all separately, but automatically is a part of the executable? <br><br></td></tr></table><br>
<a name="1235505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not in a way that will work with any built-in Load* commands. You will need to use the data to re-create the object in question using construction functions. (These functions aren't guaranteed to exist for all things, e.g. there's no builtin way to adjust or even create an MD2 object; they are only intended to be loaded in.)<br><br>There are "packer" tools that can embed your regular application in a kind of virtual filesystem and run it in that environment... don't know of any that are free offhand, but it might be a simpler avenue to investigate. That way you could develop the main application without worrying about it and pack it up later. <br><br></td></tr></table><br>
<a name="1235507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> SmartPacker Pro is not free, but it's DEFINITELY worth the money! It can also be used to encrypt your program with RJindael as well as Blowfish! <br><br></td></tr></table><br>
<a name="1235518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe PakMaker by Terabit(which is no longer avail), see here: <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=85356" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=85356</a><br><br>From the convo there I'm getting the impression it's free(dunno for sure).<br><br>But perhaps if you ask nicely, I know who has a copy ;-)<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=101776#1214462" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=101776#1214462</a><br><br><br>This is why we need a Blitz file repository.. Pitty there's no such thing on this site, cos files come and go. <br><br></td></tr></table><br>
<a name="1235524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> One of the things I'm considering doing now the B3D source has been released is adding the ability to use banks to load data for sounds, meshes, etc. which would massively increase flexibility for stuff like this. <br><br></td></tr></table><br>
<a name="1235525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes.. GOD yes.. <br><br></td></tr></table><br>
<a name="1235527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a very good idea Rroff, it shouldn't be to hard to modify and the simple capability to load something from a bank covers all eccentric needs (loading from Data statements, loading from a pack, downloading from the Internet etc.) <br><br></td></tr></table><br>
<a name="1236175"></a>

<a name="1236176"></a>

<a name="1236178"></a>

<a name="1236179"></a>

<a name="1236180"></a>

<a name="1236181"></a>

<a name="1236184"></a>

<a name="1236185"></a>

<a name="1236186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @yasha :: <div class="quote"> There are <i>packer</i> tools that can embed your regular application in a kind of virtual filesystem... <br></div><br>Here are some virtual filesystem programs ::::  [ Most of these are free. ]<br><br>Enigma Virtual Box :: <font class="tiny"> <a href="http://enigmaprotector.com/en/aboutvb.html" target="_blank">http://enigmaprotector.com/en/aboutvb.html</a> </font><br>EVALaze :: <font class="tiny"> <a href="http://www.evalaze.de/en/home/" target="_blank">http://www.evalaze.de/en/home/</a> </font><br>P-Apps :: <font class="tiny"> <a href="http://portable-app.com/" target="_blank">http://portable-app.com/</a> </font><br>MoleBox Virtualization :: <font class="tiny"> <a href="http://www.molebox.com/molebox-vs.shtml" target="_blank">http://www.molebox.com/molebox-vs.shtml</a> </font><br>JauntPE :: <font class="tiny"> <a href="http://jauntepe.sourceforge.net/index.html" target="_blank">http://jauntepe.sourceforge.net/index.html</a> </font><br><br>BoxedApp Virtualization { NOT FREE } :: <font class="tiny"> <a href="http://boxedapp.com/boxedapppacker/#.U-lCWGN5E0w" target="_blank">http://boxedapp.com/boxedapppacker/#.U-lCWGN5E0w</a> </font><br>iCore Virtual Account :: <font class="tiny"> <a href="http://icoresoftware.com/" target="_blank">http://icoresoftware.com/</a> </font> <br><br></td></tr></table><br>
<a name="1236310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have the ability to store mesh, music, textures etc ... as data.<br>So, when you come to reload them from the binary, just export as a temporary file and load the real data<br><br>for ex :<br><pre class=code>
Function genBinary(file$, outBB$, label$)
	Local in = ReadFile(file);
	Local out = WriteFile(outBB);
	Local count = FileSize(file);
	Local bank = CreateBank(count);
	ReadBytes(bank, in, 0, count);
	Local o = 0;
	Local n = 0;
	WriteLine (out, "."+label);
	WriteLine (out, "Data "+count );
	Local l$="";
	For o = 0 To count -1
		If n&gt;0 Then l = l +",";
		l = l + PeekByte(bank, o);
		n = n + 1;
		If n=50
			WriteLine (out, "Data "+l);
			n = 0;
			l = "";
		EndIf;
	Next
	If Len(l)
		WriteLine (out, "Data "+l);
	EndIf
	
	WriteLine ( out, "Function readBinary_"+label+"$()" );
	WriteLine ( out, "  Restore "+label );
	WriteLine ( out, "  Local seed = RndSeed() : SeedRnd(MilliSecs())" );
	WriteLine ( out, "  local randName$ = str(rand(1,2^31)) + str(rand(1,2^31)) + "+Chr(34)+".tmp"+Chr(34) );
	WriteLine ( out, "  SeedRnd(seed)" );
	WriteLine ( out, "  Local tmp = writefile(randName)" );
	WriteLine ( out, "  Local size = 0 : Read size" );
	WriteLine ( out, "  local i%, d")
	WriteLine ( out, "  For i = 1 to size" );
	WriteLine ( out, "     read d : writebyte(tmp, d)" );
	WriteLine ( out, "  Next" );
	WriteLine ( out, "  closefile(tmp)" );
	WriteLine ( out, "  return randName" );
	WriteLine ( out, "End Function" );
	
	CloseFile(in);
	CloseFile(out);
End Function
</pre><br><br>Then all you have to do is :<br>export as ".bb" binary datas using 'genBinary("MyFileToExport.ext", "MyDataBBFileToCreate.bb","MyLabelForData")'<br><br>Finally, to load the medias from binaries, just use the generated function (it returns the name of the temporary file containing the datas and don't forget to delete the temporary file after it's been loaded)<br><br><br>Of course, it's not the best method, but it might be a quick and dirty solution. <br><br></td></tr></table><br>
<a name="1236321"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrniceguy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Check out Smart Packer Pro (X). Maybe it suits your needs.<br><br><a href="/posts.php?topic=102669#1229042" target="_blank">More info...</a> <br><br></td></tr></table><br>
<a name="1236384"></a>

<a name="1236385"></a>

<a name="1236386"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like BobySait's experiment.<br>--------------------------------------------------------<br>Here is yet another way to access files (embedded) inside an EXE ::<br><br>Pros ::<br>(<b>a</b>) This method computes very fast, (no DATA statements needed). <br>(<b>b</b>) Doesn't require virtualization.<br><br>Cons :: <br>(<b>a</b>) It's complex to set up &amp; requires a hex editor.<br>----------------------<br><br>Here's my demo code { attachfiles1.BB } --&gt;<br> <a href="http://uploadingit.com/file/kfbjz5c5busi1rga/attachfiles1.zip" target="_blank">http://uploadingit.com/file/kfbjz5c5busi1rga/attachfiles1.zip</a> <br><br>It requires freeimage --&gt; <a href="http://freeimage.sourceforge.net/" target="_blank">http://freeimage.sourceforge.net/</a><br><br>This method involves using the binary copy command to append files to an EXE:<br><br><b>COPY /B /Y</b> attachfiles1.exe +nightshade.jpg +poisonivy.jpg +lantana.jpg +laurel.jpg attachfiles1.exe<br><br>(...takes the first 5 files and joins them together into the last file)<br>( Reference :: <font class="tiny"><b> <a href="https://en.wikipedia.org/wiki/Copy_%28command%29" target="_blank">https://en.wikipedia.org/wiki/Copy_%28command%29</a> ) </b></font><br>(...Later on, the <b>EXE</b> file reads itself, and extracts media files from itself.)<br><br>[A:] This simple program takes a few JPGs and does a binary append to the EXE file.  <br>[B:] Your mission, is to take a hex editor and find the offsets into the EXE file<br>where the media files (JPGs or otherwise) occur.<br><br>[C:] Further instructions are included in "Attachfiles1.BB" .<br><br>Sample program output :<br><img src="http://i37.photobucket.com/albums/e73/VirtLands/various/attachfiles1_sample_output_377x278_zps9b4e7aa1.png"><br>-------------------------------------------------------------<br><font class="tiny">Later, I realized that an even better method is to append all the media files together (using binary copy), then find each of those offsets <br>within that large chunk (for each media file).<br><br>[ Obviously, the first file shall start at offset zero. ]<br>Those offsets shall not change (often).  Then take that large chunk and append that to your EXE.<br><br>Then, you'll only need to find the very 1st offset within the EXE, ...the rest of the offsets can be calculated mathematically, <br>(because they are <i>relative</i> to each other). </font> <br><br></td></tr></table><br>
<a name="1257093"></a>

<a name="1257094"></a>

<a name="1257095"></a>

<a name="1257097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excuse my question, please could you hi-light how to....<br><br>@VirtLands - could you hi-light the definition for the FreeImage_Unload function? Cheers....<br><br><pre class=code>

Function FiUnload(dib)
 ;Frees a FreeImage bitmap, a wrapper function
 ;Returns nothing

 FreeImage_Unload(dib)

End Function

</pre><br><br>I've downloaded the FreeImage directory, was kinda hoping the dll would've sufficed....<br><br>found this within the FreeImage header file:-<br><br><pre class=code>

// Allocate / Clone / Unload routines ---------------------------------------

DLL_API FIBITMAP *DLL_CALLCONV FreeImage_Allocate(int width, int height, int bpp, unsigned red_mask FI_DEFAULT(0), unsigned green_mask FI_DEFAULT(0), unsigned blue_mask FI_DEFAULT(0));
DLL_API FIBITMAP *DLL_CALLCONV FreeImage_AllocateT(FREE_IMAGE_TYPE type, int width, int height, int bpp FI_DEFAULT(8), unsigned red_mask FI_DEFAULT(0), unsigned green_mask FI_DEFAULT(0), unsigned blue_mask FI_DEFAULT(0));
DLL_API FIBITMAP * DLL_CALLCONV FreeImage_Clone(FIBITMAP *dib);
DLL_API void DLL_CALLCONV FreeImage_Unload(FIBITMAP *dib);

</pre><br><br>So... do I have to compile FreeImage.c to make a FreeImage.o that I can reference within the Attachfiles1.bb ? I thought depositing the FreeImage.dll within my B3D userlibs directory might've sufficed.<br><br>Incidentally, the attachfiles1.exe that comes with the download runs fine ;) <br><br></td></tr></table><br>
<a name="1257104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, might need to d0 this-<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=93118#1063439" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=93118#1063439</a> <br><br></td></tr></table><br>
<a name="1257108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> HI, VIRTLANDS! =D <br><br></td></tr></table><br>
<a name="1257169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got it - I needed a decls file declared a while back..... <br><br></td></tr></table><br>
<a name="1257174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool! :) <br><br></td></tr></table><br>
<a name="1257187"></a>

<a name="1257189"></a>

<a name="1257190"></a>

<a name="1257191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So... do I have to compile FreeImage.c to make a FreeImage.o that I can reference within the Attachfiles1.bb ? <br></div><br>Hi there, there's no need to re-compile the freeimage project,<br>you may use the <b>FreeImage.DLL</b> as it already is.  <br><br>--------------------------------------------------------------------------<br><br>Here is the FreeImage.DECLS as of 11-29-2008 :: <br><br>--&gt; <a href="https://www.dropbox.com/s/xg8hhw4nautbq5c/freeimage.decls?dl=0" target="_blank">https://www.dropbox.com/s/xg8hhw4nautbq5c/freeimage.decls?dl=0</a> <br><br>( I replied to your email. )<br><br>--------------------------------------------------------------------------<br><br>However, if you do wish to search for some advanced freeimage code, then here are some links ::<br><br>FreeImage (Original) :: <a href="http://freeimage.sourceforge.net/sourcecode.html" target="_blank">http://freeimage.sourceforge.net/sourcecode.html</a><br><br>Kanma/FreeImage :: <a href="https://github.com/Kanma/FreeImage" target="_blank">https://github.com/Kanma/FreeImage</a> <br><br></td></tr></table><br>
<a name="1257209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Virtlands - I intend to finish what I started later today - thankyou for the additional feedback, it is really appreciated.<br><br>Really nice code you've put together with respect to FreeImage ;) <br><br></td></tr></table><br>
<a name="1257395"></a>

<a name="1257396"></a>

<a name="1257397"></a>

<a name="1257398"></a>

<a name="1257399"></a>

<a name="1257499"></a>

<a name="1257500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like the way you said "<i>glueing/appending</i>" files.<br><br>Well, I suppose the process can be automated a little bit.<br><br>Suppose you have a <i>chunk</i> of files to append to an EXE, perhaps <b>10</b> of them,  <br><br>(<b>a</b>) You can first do a binary concatenation of those 10, into <b>Chunk A</b>, <br>(<b>b</b>) then later append <b>Chunk A</b> to the EXE. <br><br>(<b>c</b>) Once you know the magic offset (into the EXE) of the 1st file, <br>then you can do simple math to figure out the offsets of the remaining 9.<br>{ These other offsets would be "file sizes". }<br>--------------------------------------------------------------------------<br><br>The binary copy command is as follows :: source :<font class="tiny"> <a href="http://support.microsoft.com/kb/71161" target="_blank">http://support.microsoft.com/kb/71161</a> </font><br><br><br><b> copy /b source1 + source2 + source3 + (....)  targetfile </b><br><br>You can also combine several files into one by using <i>wildcards</i>. For example:<br><br><b> copy /b *.exe combin.exe </b> <br><br></td></tr></table><br>
<a name="1257657"></a>

<a name="1257658"></a>

<a name="1257659"></a>

<a name="1257660"></a>

<a name="1257661"></a>

<a name="1257662"></a>

<a name="1257663"></a>

<a name="1257664"></a>

<a name="1257665"></a>

<a name="1257666"></a>

<a name="1257668"></a>

<a name="1257669"></a>

<a name="1257670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> @VirtLands, this is good stuff.<br><br>[edit] just clocked this bit:<br><br><div class="quote"> the EXE, ...the rest of the offsets can be calculated mathematically, <br>(because they are relative to each other).  <br></div><br><br>yep, I'll get there......kinda sums up the rest of my post here:-<br><br>As you've suggested at 'C':<br><br><div class="quote"> <br><br>(c) Once you know the magic offset (into the EXE) of the 1st file,<br>then you can do simple math to figure out the offsets of the remaining 9.<br>{ These other offsets would be "file sizes". }<br><br> <br></div><br><br>I suppose, in tandem with your instructions - you need to record the filesize of each individual file you are appending (if indeed they have different sizes), and populate an array with this in order for the sourcefilesize for each appended file?<br><br>I fail to see how your AttachFiles1.bb was able to know where each appended file 'ended' - is there a EOF in effect in binary?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Global sourcefile$ = SystemProperty ("appdir")+ "AttachFiles1.exe"  ; = The program reads itself.
Global sourcefilesize = FileSize(sourcefile)

Print "getting this far... press any key..."

WaitKey

; Read the embedded files into banks
For z=1 To 4
     bank[z] = FiBankFromFile( sourcefile, sourcefilesize, offset[z] )  ; Read starting at magic number offsets.
Next 


</textarea><br><br>If I'm interpreting what the sourcefilesize attribute is meant to be..... <br>(i.e. the size of each individually appended file...)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Global sourcefile$ = SystemProperty ("appdir")+ "AttachFiles1.exe"  ; = The program reads itself.
;Global sourcefilesize = FileSize(sourcefile)

Print "getting this far... press any key..."

sourcefilesizeZ(1) = 20
sourcefilesizeZ(2) = 40
sourcefilesizeZ(3) = 44
sourcefilesizeZ(4) = 16


WaitKey

; Read the embedded files into banks
For z=1 To 4
     bank[z] = FiBankFromFile( sourcefile, sourcefilesizeZ[z], offset[z] )  ; Read starting at magic number offsets.
Next 


</textarea><br><br><br>Hmmm, I think I might be asking a little much of the FreeImage.dll to try and load/manipulate .b3d files into memory banks alongside .tga files.....<br><br>I'll revert to using 4 image files as you have in the example rather than interspersing the image files with .b3d models.<br><br>[edit] As you've suggested, I might also try simple hex arithmetic to ascertain individual file sizes.<br><br>Cheers, BP. <br><br></td></tr></table><br>
<a name="1257889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ...interspersing the image files with .b3d models. <br></div><br>Maybe embed the B3D file into the EXE, <i>self</i>-extract it to disk, and then read it naturally.<br><br>Just in case you want to keep your media files a secret, then please do encrypt them before embedding them into the EXE<br><br>, otherwise people can hack your program apart with programs such as these <img src="http://pcpuzzle.com/forum/images/smiles/icon_wink.gif"><br><br>(<b>a</b>) Binary Inspector :: <font class="tiny"> <a href="http://tinyurl.com/l5s79jt" target="_blank">http://tinyurl.com/l5s79jt</a> </font> (FREE Online App)<br>(<b>b</b>) Allmedia Grabber :: <font class="tiny"> <a href="http://tinyurl.com/25ek3d" target="_blank">http://tinyurl.com/25ek3d</a> </font> ($54.90)<br>(<b>c</b>) Dragon Unpacker  :: <font class="tiny"> <a href="http://tinyurl.com/pbuwlhe" target="_blank">http://tinyurl.com/pbuwlhe</a> </font> (Free)<br>(<b>d</b>) Free Resource Extractor :: <font class="tiny"> <a href="http://tinyurl.com/mpb7mjc" target="_blank">http://tinyurl.com/mpb7mjc</a> </font> (Free)<br>(<b>e</b>) MultiExtractor :: <font class="tiny"> <a href="http://tinyurl.com/oj6d2g6" target="_blank">http://tinyurl.com/oj6d2g6</a> </font> (Free?)<br>---------------------------------------------------------------------------------<br><img src="http://www.freeresourceextractor.com/images/screen_small.png"><br><br>As an example,  I took some game data file, (<i>res2.dat</i>), dragged it into <b>Binary Inspector</b>; <br>It found 371 images, and 105 music files. That's awesome.,<br><br><img src="http://i57.tinypic.com/23tjdl3.jpg"> <br><br></td></tr></table><br>
<a name="1259766"></a>

<a name="1259767"></a>

<a name="1259818"></a>

<a name="1259819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> @VirtLands, thanks for the feedback - managed to add a fifth image to your AttachFiles.exe and display it ;) onwards and upwards:--<br><br><img src="http://www.wishingwellsoftware.co.uk/fifth.png"><br><br>Binary Inspector looks like an interesting utility. I need to look into how to self-extract .b3d file to disk.... my aspiration was to rip it straight from the memory bank in question into the relevant entity variable at run time therefore removing the necessity to self-extract the .b3d file to disk. I might need a little more sleep for my grey matter to digest further where I'm going with this - for now though- pleased to get my test5th image added to your initial example ;)<br><br>Hmmm, I fear I'm trying to achieve the impossible with this approach, receving a MAV around the attempt to load the b3d from the memory bank.<br><br><pre class=code>
; Get Freeimage bitmaps for each JPG bank
For z=1 To 5
    bitmap[z] = FiLoadFromBank( bank[z] )  ;; Save into a Freeimage bitmap
    image[z] = FiRead(bitmap[z])    
Next 

Print "getting this far (3)... press any key..."

WaitKey

; Get a b3d entity

b3dentityraw = FiLoadFromBank( bank[6] )  ;; Now, is this attempting to put a b3d entity into a bitmap? Could cause issues

b3dentityraw = FiLoadFromBank( bank[7] )


Print "getting this far (4)... press any key..."

WaitKey

;Local b3dentityone = LoadAnimMesh(Read(bank[6]))

;Local b3dentitytwo = LoadAnimMesh(Read(bank[7]))

b3dentityone = LoadAnimMesh(b3dentityrawone)

b3dentitytwo = LoadAnimMesh(b3dentityrawtwo)

Print "getting this far (5)... press any key..."

WaitKey

</pre> <br><br></td></tr></table><br>
<a name="1259933"></a>

<a name="1259935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've managed to identify where the offset for the first and last byte for a particular memory bank, which has been appended to a file. So, somehow, I need to:--<br><br>1. Write out just these bytes to a new file upon each execution<br><br>2. Load the AnimMesh from that file once I have written it to disk<br><br>3. Delete said file after loading it from disk.<br><br>I've tried analysing Boby Saits code with a view to achieving this goal - however brainache has set in.<br><br>Every time it loads - it'd be nice to simply copy the memory bank in question into the LoadAnimMesh command - is there any syntax available to do this? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
