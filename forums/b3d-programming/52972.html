<!DOCTYPE html><html lang="en" ><head ><title >Just come back, but old stuff runs slowly</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Just come back, but old stuff runs slowly</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Just come back, but old stuff runs slowly</a><br><br>
<a name="592056"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>I stopped using Blitz about a year ago now due to time constraints (who invented work :( ) but thought I would have another play round now.  I started to go through some old stuff I wrote back in the day to refresh the old memory on stuff and come across this...well puzzling problem.<br><br>I wrote a small (and very ineffecient) demo and always remembering it running with no slow-down...however after a year has gone by I run it a slightly upgraded machine, it drops from 60fps to 30fps<br><br>I tried it on three machines, two had this problem, whilst the third (which technically is the worse) had no problem at all.<br><br>results<br>-------<br><br>machine: Athlon 3200+ ~2.2ghz, 1gb ram, gfx6800xt<br>directx: 9.0c<br>fps: ~30<br><br>machine: Athlon 64 ~2ghz, 512mb ram, mobility9600<br>directx: 9.0c<br>fps: ~30<br><br>machine: Intel 2.2ghz, 1gb ram, some crappy onboard gfx...<br>directx: 9.0c<br>fps: 60 (max refresh rate)<br><br>The obvious diference between machines is the processor....but I never had this problem when I first wrote it, and I wrote it on an Athlon machine.<br><br>To replicate the problem:<br><br>download and run: <a href="http://www.agilehosting.co.uk/simpleDef.zip" target="_blank">http://www.agilehosting.co.uk/simpleDef.zip</a><br><br>Now everytime you press F1 to get the help up the whole thing slows down dramatically.....this is what never happens and doesn't currently on the intel machine.<br><br>I realise that a LOT can be done to speed to the whole thing up (like not printing a page of text every frame, and optimising the mesh) but I am curious as to what has changed to cause this slowdown over the period of this year? <br><br>thanks for any advice <br><br></td></tr></table><br>
<a name="592062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just rerun the test on the mobility 9600 machine and the slowdown is inconsistent....~20 seconds of 60fps, then slows down to 20-30 then ~20 seconds laterbackup to 60...odd<br><br>Machine 1 (gfx6800xt) is consistant in slow-down<br><br>Machine 3 (internal gfx, intel), just doesnt slow down<br><br>I just noticed the source I included is not quite the same as the compiled exe...sorry bout that I actually lost the final source, the only diference should be the fps display.<br><br>thanks <br><br></td></tr></table><br>
<a name="592064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your exe doesn't work (crashed with a MAV).<br><br>Your .deform_mesh is bugged. Tries to loop through more vertices than actually exist.<br><br>Just change<pre class=code>For vertexcount = 0 To verticesqty</pre>to<pre class=code>For vertexcount = 0 To verticesqty-1</pre><br>Other than that, the only slowdown might be when the help text is displayed. 'Text' is not a fast command. Better to grab the text as an image, once, then display as required.<br><br>Recompile your exe (as changed above) with Blitz 1.90, then come back if it still slows down ;)<br><br>**EDIT**<br><br>Suddenly dawned on me. Those multiple KeyDown()'s are causing it.<br><br>Take the keyboard check out of the loop (apart from check for Esc) and you'll probably see what I mean :)<br><br>**FURTHER EDIT**<br><br>Do you really need to CountVertices() in .deform_mesh every frame to get verticesqty? This is a fixed value. I don't know what overhead that particular function needs, but every little helps. <br><br></td></tr></table><br>
<a name="592114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> 22 fps here with F1 activated...<br><br>P4 2.4 GHz , 4Gig RAM, nVidia 5600XT, 256 MB VidRAM, WinXP SP2 <br><br></td></tr></table><br>
<a name="592122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for your replies.<br><br>I apreciate your comments vinylpusher and understand the problems with the actual code, however..<br><br>Taking out the keyboard check routine does stop the problem but only because the F1 help isn't being displayed.  If you force it to display and leave the keyboard check out the problem remains.<br><br>The issue here is not my crappy code :) but the fact that it runs smoothly &amp; constantly (help displayed or not) on one machine which is actually less powerful graphically than the others....a year ago it ran fine on all machines (I am a stippler for not being happy with anything not running smooth)<br><br>The only things that have changed are Blitz has been updated, I went from 2000 to XP, increased RAM &amp; direct X has been updated....could it be a problem with how the 'TEXT' command renders and one of them?<br><br>apreciate your time on this. <br><br></td></tr></table><br>
<a name="592123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> it's probably related to the nvidia drivers. <br><br></td></tr></table><br>
<a name="592125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seems older GFX cards are better at doing pure 2D stuff (like Text) than the newer ones. My 850Mhz/GeForce256 machine is faster at 2D than my 1Ghz/GeForce2 machine. 2D seems to be going the way of the Dodo and card manufacturers are giving it short shrift. <br><br></td></tr></table><br>
<a name="592126"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> The differences between the systems might be such that however Blitz renders text (which is probably not a great way) runs fine on one system because Blitz and your graphics pipeline nicely mesh together, whereas on the other system, there might be any number of abstractions between Blitz's Text call and the actual rendering in hardware.<br><br>I can imagine perhaps nVidia's driver having to (un)mangle a number of calls repeatedly in order to render everything correctly. Nvidia's hardware might not natively support some minor little aspect of the way Blitz is trying to render the text and so the driver has to step in and translate.<br><br>Pure conjecture of course, but I can't think of anything else right now.<br><br>**EDIT**<br><br>I think folks are right when they say 2D stuff isn't exactly concentrated on. 2D stuff on nvidia's hardware is pretty much the driver faking it by using 3D hardware. Things run so fast these days that saying "is your card fast for 2D?" is completely redundant. Most everyone's machine can throw 32 bit colour 1920x1200 images around the screen without breaking a sweat. <br><br></td></tr></table><br>
<a name="592127"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> you may actually be onto something there.  My laptop is running a radeon, but I think the stuttering problem was to do with the audio as disabling it made it run smoothly 100% of the time...<br><br>I'll try installing old nvidia drivers to other machine later to see if it cures the problem...<br><br>thanks <br><br></td></tr></table><br>
<a name="592129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Euphoria: I think you'll probably find that newer drivers are better. What you <i>would</i> probably see is something of TNT2 or early GeForce class making far less work of Blitz's text rendering. Those cards were 2D with 3D bolted on, rather than newer cards being 3D with 2D emulated.<br><br>Would explain why Intel's graphics chip doesn't suffer the slowdown. I've no knowledge about how ATI implement their 2D.<br><br>Tried a Matrox? <br><br></td></tr></table><br>
<a name="592137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rolled back the drivers to 61.77 (as close as I could find to the time of demo creation) and everything ran smoothly, with a steady 62fps with the help displayed....<br><br>So the problem would seem to be related to the nVidia drivers and blitz 2d rendering.....not much I can do about that I suppose.<br><br>Maybe I should avoid nVidia if I want to do anything 2D in Blitz? As surely it would be silly to write stuff based on old drivers.  Do you think this problem could affect the other 2d areas of Blitz, like sprites and stuff?<br><br>Might have to run some more tests on the other 2d areas.....<br><br>No havent tried a Matrox vinylpusher, only ever had an Nvidia and radeon.<br><br>Thanks for the help <br><br></td></tr></table><br>
<a name="592139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blimey, I wasn't expecting that result!<br><br>Wonder what nvidia have done in these newest drivers?!<br><br>I think everything else works fine apart from text. Images, when used to display text, are fast.<br><br>Even if you grabbed Blitz normal text character by character and then formed a loop that displayed the same text as you are in your demo, it would run faster.<br><br>Obviously, the best to do in your demo would be to grab the whole thing as one image, but you get the idea. <br><br></td></tr></table><br>
<a name="592144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep I'll just avoid doing that in the future.  But will run some other 2d tests on old and new nvidia drivers when I get some time, just to make sure I am not going to be wasting my time writing anything 2d for nvidia cards.<br><br>cheerz <br><br></td></tr></table><br>
<a name="592179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Finjogi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> With my machine demo was running windowed quite steady 2 frames, even while displaying text. Text printing is slow, as said already. Another slow thing is plotting stars. 500 goes every frame but 1500 not, 4500 is horrible. It is sad but true, current GPU makers do better job with 3d and 2d as plotting pixels and things like that are not so important. <br><br></td></tr></table><br>
<a name="592185"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, I can plot somewhere around 50k pixels in a frame using WritePixelFast().<br><br>Even something in the 500MHz range should manage 5 to 10k.<br><br>There are other, even faster, ways to plot pixels if you really want to go overboard. <br><br></td></tr></table><br>
<a name="592187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Maybe I should avoid nVidia if I want to do anything 2D in Blitz? <br></div><br><br>Well unless you're going to tell everyone who plays your game what videocards they should buy and avoid, I'd probably be more inclined to either :<br><br>(a) Avoid 2d if I want to do anything with Blitz on Nvidia.<br><br>or<br><br>(b) Avoid Blitz if I want to do anything with 2d on Nvidia. <br><br></td></tr></table><br>
<a name="592193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Finjogi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> IMO plot x,y is fine for experimenting things, but better way is like vinylpusher wrote, use WritePixel or WritePixel fast.  <br><br>Gabriel, "anything with nvidia" comment, it is not so, you just have to take a moment to check out what commands are slow in current GFX card scene... some are slow with Nvidia, some with ATI, some with uh,.. are there any other real GFX cards around :D It is also other way around, you can't expect intel GFX card to push 20 million tris/ frame like some nvidia or ati can. <br><br></td></tr></table><br>
<a name="592203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabriel: Dude, that's pretty harsh to say avoid blitz for 2D on Nvidia.<br><br>We didn't tell Amiga users "Sorry, get yourself an 060 to play this game", we found a faster way to do what you needed to do.<br><br>We've already solved Euphoria's problem (as he is no doubt finding out). From personal experience, I know I can throw almost as many 2D images around as I can 3D sprites (I hit the upper limits of allowed visible tris in 3D).<br><br>You can do dozens of layers of parallax and hundreds of on-screen 2D sprites before you even have to think too much about optimisation. 2D speeds really are a non-issue with Blitz right now. Maybe not so much with Bmax, which has its own problems, but with B3D you've got nothing to worry about.<br><br>There are well discussed commands that you should avoid overusing in your main game loop (and ways around the problems, too). <br><br></td></tr></table><br>
<a name="592204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> are you using frapsXP to measure framerate? I find with blitz3d and frapsXP running I get massive slowdowns in blitz stuff, generally around half the fps. <br><br></td></tr></table><br>
<a name="592372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have had trouble with nVidia drivers in the past on an old GeForce2GTS/Pro card.  It reported the number of texture layers wrong and this caused me considerable problems so I had to stay with an old driver for about a year until eventually they fixed it (or did I upgrade my card?).<br><br>I do not experience much slowdown with my current nVidia card (5200FX) and 2D commands, infact I invariably have quite a few text commands onscreen - it's a near instant command.<br><br>My immediate thought on reading your problem was that your Blitz was not up-to-date.<br><br>I have not looked at your source code but looking at the demo I see no obvious reason why something like that should not run a lot faster, I only got 32fps here.  2Ghz AMD, 512mb Ram <br><br></td></tr></table><br>
<a name="592598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Euphoria</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using 1.90 (and tried recompiling to exe under it).  I also tried older version of Blitz (was on that train of though) but made no difference.  <br><br>This problem has been resolved thanks to all your help :)<br><br>Still need to test the other 2D stuff against old/new nVidia drivers to see if the problem is elsewhere before resigning my Blitz stuff to 3d only... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
