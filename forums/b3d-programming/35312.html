<!DOCTYPE html><html lang="en" ><head ><title >Fast Multiplayer?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Fast Multiplayer?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Fast Multiplayer?</a><br><br>
<a name="383939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My question is this: Is there a way in Blitz3D to program fastpeaced action multiplayer games. Such as a simple quake game? <br>I have tried working with my own UDP_Library for quite long but I can't make it work! There is always something wrong, especially speed! I tried to send the mouse pointer (infullscreen) to another computer over LAN, laggy as hell. I started out with BlitzPlay Lite, but it proved to be too slow so I tried making my own lib(not that my lib is faster^^). <br><br>Am I trying to acheive something impossible? Something that no one have ever really succeded at? Fast multiplayer exsists, cause I have played alot of games that work fine with even more than 8 people. I'm not aiming to make my game lag-free for modem users, I'm fine with a limit to 100Mbit connections. Still I can't, even with BlitzPlay, make a simple  [send/receive -&gt; x/y/dir for each player] to NOT lag when three players is in the game... <br>Anyone who can show me a solution? (test demo/game TOTALY lag-free) A /tutorial/link/sample code/ on network basics?<br>//Thanks in advance Wave <br><br></td></tr></table><br>
<a name="383947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have to understand that multiplayer games employ many tricks to run lag free. For instance, usually you broadcast your x/y/dir less than the framerate. Maybe 10-20 times per second, possibly less. That might even be over kill. You can also have systems in which the server only gives a player info it needs to know. It doesn't need to know what happened in some far away unseen place.  You can use splines to make motion appear smooth even when the data is sparse. <br><br></td></tr></table><br>
<a name="383949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Take a look at Cubic Splines and other interpolation techniques. <br><br>The basic idea is to track the network lag either by timestamps or other means provided by your network library. The lag is how far in the past an update happened, you then project the update slightly into the future, and adjust the entity motion towards the future location.<br><br>Note the seperation between network updates and how the local instance of a remote entity moves -- there is no way to sync everything up using the net updates to control motion directly, so the next best thing is to "guess" where the entity will be, then try to get the local instance to "catch up"<br><br>So an entity never follows exactly the same path on your screen as it does on the screen of the player controlling the entity, but its not too far off. <br><br></td></tr></table><br>
<a name="383971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you have any rekommended links or examples on multiplayer tricks?<br><br>Maybe I got Interpolation techniques wrong but isn't that just a technique to use if there is serious latency? I mean, how much can I really decrease packet sending by using such techniques? Seems like very much work for just getting the possition of an object to update. I'll still take a look at it. Any links?<br><br>If I adjust the motion using splines, and it comes out wrong, won't that make lag more visiable? Like if you do drastic changes in direction N speed. <br><br></td></tr></table><br>
<a name="383991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/codearcs.php?code=825" target="_blank">Cubic Splines interpolation</a> can be useful regardless. I'm curious about how your messenging between server / client? How many bytes needed to convey update? Using any compression? <br><br></td></tr></table><br>
<a name="384003"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use UDP, I have tried 2 ways. First to send X/y/dir in one package, then when received divde it up to X,y,dir. <br><br>The other method was to send x,y,dir separetly as different msgs(this is faster for me but it shouldn't be) <br><br>"I'm curious about how your messenging between server / client?" Here is how I do it:<br>From my_Network library.. (With blitzplay I get a better speed but it's only sufficient for MAX 2 players from what I have seen so far)<br>The size of the package are the UDP header+2float+1Int<br><br><pre class=code>
:		For C.Client = Each Client ;Send to each computer 
								
			If C\Net_id &lt;&gt; My_Net_ID  ; broadcast to all players	
				WriteByte(UDP_Stream, MessageType%)	;One byte, Max 255	This is the "type" of the msg
				WriteByte(UDP_Stream, My_Net_ID%) ;Send your id in the message
							
					If MessageData &lt;&gt; ""
						For T = 1 To Len(MessageData$)
							WriteByte ( UDP_Stream, Asc (  Mid$(MessageData$,T,1)  )  )  ;This is the data of the msg
						Next
					EndIf
			;	DebugLog" Message sent to IP : "+C\IP+" and Port : "+C\Port 		
				SendUDPMsg( UDP_Stream, C\IP, C\Port );send data stream to Computer
			End If
Next
</pre> <br><br></td></tr></table><br>
<a name="384007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe I should add that the idea I have for my Tank game, is for it to be very FAST, You will turn/accelerate/fire/use special abilities/ as fast as possible! This means Splines will not solve the problem<br>(I will still use them as they do make enemy movment a bit smother) And it is meant to be a Team-based multiplayer game. I want 4v4 games to work =) <br><br></td></tr></table><br>
<a name="384032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could probably shave of 2 bytes by making the direction a short integer. I doubt your variable goes higher than 65535.<br><br>You could try some forms of compression but it probably wouldn't work very well (probably make it slower) unless you were using a server-client system.<br><br>Anyway, I would like to point out that internet speeds might be the reason there aren't any (that I know of) really FAST tank games.  It's probably not possible to achieve you goal of super fast near instantaneous play without some insane algorithms and really fast connections. <br><br></td></tr></table><br>
<a name="384049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have to accept the fact that every player is operating with their own framework for time and motion, and plan for it in your code... There is no way to achieve fast reaction without a LAN connection.<br><br>If you want internet play, you code will have to cope with 100-500ms lag times, and with the idea that each player is really playing in an independent game world that has bots controlled over the network (i.e. remote players). <br><br></td></tr></table><br>
<a name="384156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> bot builder, how do I make short intergers in blitz?<br><br>And second I'm trying to acheive a fast game play in a LAN where TCP/IP pings (latency) are Below 0 milisecs and a bandwith of ~100Mbit. But I'll try to do it with deadreconing and cubic splines, if noone else has any suggestion?<br><br>Thanks for reply /wave <br><br></td></tr></table><br>
<a name="384167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I recommend blitzplay library for blitz. www.blitzcoder.com/blitzplay<br><br>then learn some cubic spline tricks. otacon posted a fairly neat cubic spline function for me the other week. When we're not flirting with each other that is. <br><br></td></tr></table><br>
<a name="384192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have checked up on cubic splines, seems lika a smart way to go, but what am I supposed to do with that function? Ok, I get a smoth line, but exatly, how will it make my tank go that way. I don't see how to implend it in network code. And I'm using BlitzPlay lol. I just can't get it to work fast enought. <br><br></td></tr></table><br>
<a name="384282"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> the cubic spline is one technique for predicting the future location of the entity.. you then figure out the forces to apply to the local instance to make it reach the predicted location at the correct time....<br><br>The local entity continues using the using the computed forces until the next network update, then you recompute, using the new past (network entity update), current (local entity position), and future (predicted network entity location, reverse computed forces for local entity) <br><br></td></tr></table><br>
<a name="384371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I need a function :P\X = Spline(P\X,P\Xvel);which returns his NewX, right?<br><br>How am I supposed to get NewX? What's the function? Do I have to update both his X and Y at the same time? And if so, how do I do that?<br><br>Rob are you willing to share some of your spline tricks? <br><br></td></tr></table><br>
<a name="384397"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> This setup assumes you are using elapsed time to control distance moved per world update, so framerate isnt an issue.<br><br>also it is assumed that everything is expressed as forces applied to the entity, tho rotation forces arent handled, they can be easily added.<br><br>[vector (x,y,z) values]<br>P=position<br>V=force vector<br>N=Network data<br><br>[scalar (integer) values]<br>L=Local Entity<br>F=Future Entity<br>T=Timestamp<br><br>compute future timestamp<br>FT = LT + (prediction time offset, say 0.25 secs)<br>compute future position <br>FP = NP + (NV * (FT - NT))<br>compute vectors from local position to future position<br>LV = (FP - LP) / (FT - LT)<br>optionally use the computed local forces to rotate the entity to face in the direction of movement.<br><br>You will need some extra work to synchronize timestamps at net connect to make this work. Its not cubic splines, but it gets the job done. <br><br></td></tr></table><br>
<a name="384539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I don't use vectors to calculate speed right now. But that's not a problem. Vectors are easy to implend. <br><br>"elapsed time to control distance moved per world update"<br>Here is where I get lost. It's probably obvious to you but I just don't understand. Sorry. Do you have any code of motion controlled over time, or about this. Time is my weak point here, Timestamp?<br><br>Thanks for the help so far! <br><br></td></tr></table><br>
<a name="384569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> everything is based on time :) speed = distance/unit time, if your unit time is millisecs (since thats what the blitz system clock runs in), then a force vector is how much an entity travels in one millisecond.<br><br>the difference between the timestamp on a net packet, and the current time is how far in the past that the remote player did something (moved, fired, etc), its also how much lag that player is currently getting off the net. (thats what makes this so kewl -- automatically smooths out the lag)<br><br>so given the time, force and position in the past, you can predict the entities position some time in the future. the distance vector from the local entity representation to the predicted position divided by the prediction time = the force that must be applied to the local entity to converge the local position with the predicted future position at the correct time.<br><br><img src="http://www.camelot-software.com/files/convergence.png"><br><br>In the 1st frame, each red dot + line represents the position and vectors sent over the net. In the 2nd frame, the green dots represent the predecited locations a short time in the future, in the 3rd frame, the forces that must be applied to the local entity.<br><br>The following code isnt adapted to the network, but shows the basic idea of using time to control motion... ticks is the number of milliseconds since the last RenderWorld. Basically makes motion independent of frame rate. (Tho I never run a game update cycle any faster than the vertical refresh interval of the monitor - people that run 200 fps update cycles are wasting cpu on generating graphics that the player will never "see")<br><br>Code also includes my smooth jump routine.. player jumps up, gravity drags them down, and it includes a recovery time before they can next jump. (that part of the code needs to be fixed up for tick handling, its setup for 60fps right now)<br><br><pre class=code>
Global walkspeed# = 0.007
Global turnspeed# = 0.07

Global jumpcnt = 0;

Function Update()
	
	MoveEntity camera_pivot,0,0.2,0 ; gravity
	If KBS_Action("walk") MoveEntity camera_pivot,0,0,walkspeed# * ticks
	If KBS_Action("back") MoveEntity camera_pivot,0,0,-walkspeed# * ticks
	
	If KBS_Action("left") TurnEntity camera_pivot,0,turnspeed# * ticks,0
	If KBS_Action("right") TurnEntity camera_pivot,0,-turnspeed# * ticks,0

	If KBS_Action("jump") And jumpcnt = 0
		jumpcnt=40
	EndIf
		
	If jumpcnt &gt; 0 
		If (jumpcnt &gt; 35)
			MoveEntity camera_pivot,0,0.6,0
		EndIf
		jumpcnt = jumpcnt - 1
	EndIf
	
	MoveEntity camera_pivot,0,-0.3,0 ; gravity
	
End Function
</pre> <br><br></td></tr></table><br>
<a name="385028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I'm starting to getting the idea =) Now how do I sync two computers. I mean I can't use millisecs(), I have to somehow create a timer, in game. <br><br>This is my idea (tell me if I'm wrong)<br>When game starts:<br><br>Do.. Player/Timer = Player/Timer +1<br><br>receive Clients\Timers and pick a time in the future when all client should reset.<br>And then all client should reset at the same time to get in sync, substracting the lag (time for msg to be sent and retreived). Then I can continusly do these resets and make sure every player is in sync. Their Timer = My Timer. Then I can implend Quibic Splines or your version of predicting their possition at a given time in future, provided by the last packet received. If the package contains the players possition, then the timeStamp provided in the msg would tell me that X ticks ago player was at X1,Y1 and he is probably at X2,Y2 now. &lt;-- calculated using splines.<br><br>Is the teori so far, right?<br><br>Now the simple question of.. How to code this? Where to start?<br><br>I really want to get the hang of this! Working hard //Wave~ <br><br></td></tr></table><br>
<a name="385103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> you should actually only have to compute a millisecs offset once at net connection -- bit of a pain in the arse -- start off sending timestamp packets from server to client, and the client responding with its timestamp/... time the round trip, if you get 3 or 4 in a row that are very close together in elapsed transit time, average the differences between server and client timestamps, adjust for average lag, then send a packet to the slave telling it what offset to use.<br><br>This is the same basic idea used by unix the unix rtime command to remotely sync a computer clock. <br><br></td></tr></table><br>
<a name="385227"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> You mean I only need to know how many millisecs it takes (in avg) for packages to be returned? <br><br>Host sends testString<br><br>Client receives it and send it back. + it starts it' Millisecs timer.<br><br>Host receives the response and checks how long time has passed in millisecs()<br>Host now sends antoher test pack to the CLient with this time<br><br>The client Receivs this package and checks it's millisecstimer to the package. When done 3-4 times you can get an average. <br><br>Now each plackaet recieved by either host or client is known to have this latency and therefor you calculate where the other players most probably are when package was received. <br><br></td></tr></table><br>
<a name="385348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> latency can change through the life of the connection.. you need to figure a time offset to get each machine to agree on a timestamp.. then timestamped packets tell you how much lag you are getting at any moment.... <br><br></td></tr></table><br>
<a name="385354"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is a timestamp? Is timestamp realtive to each computer or are they supposed to be same for all connected clients? <br><br></td></tr></table><br>
<a name="385366"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> a timestamp is time in millisecs -- the problem is to determine the offset between the clocks on 2 computers so that, after adjustment, they are running on as close to the same clock as possible, preferably within 2 or 3 milisecs of each other<br><br>server.time = client.time + adjustment<br><br>then the client timestamps every packet (4 bytes of overhead) with time+adjustment, then the server had no problem figuring when in its time the packet was sent<br><br>on recieve packets, clients do timestamp-adjustment to change the timestamp to their local clock <br><br></td></tr></table><br>
<a name="385458"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't get it, millisecs() returns the CPUclock in millisecound. But who say that my clock ain't going 2h 34min 3days 23sec and 123ms Wrong. Then the client will think the packet has an Enormous lag. Or should I set the computer clock somehow? If I do A=millisecs() A gets the value of 36632413. Now let say I send and receive a package I can check millisecs() again to see how it took for the client to reply, this is the latency,right? But this is not the same as a timestamp. So what I should sent in each packet is my A=millisecs()+LastpackedDelay?? But what should the client do with this millisecs_int. If the client substracts his millisecs() from the millisecs()_int received in the last package then he'll get a huge number or?, it seems like I'm walking in circles =) <br>If you have any good reasourses/links I'll be happy to read about the subject,I have searched, but I haven't found anything really useful. <br><br>Still trying// Wave~ <br><br></td></tr></table><br>
<a name="385470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ZombieWoof</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> which is why you jump through hoops at network connect to figure out the adjustment value to sync the clocks :)<br><br>here is a one step sync up... it assumes lag local-&gt;remote = lag remote-&gt;local (not always true, packets can take radically different routes in each direction)<br><br>server:<br>local_t1 = time()<br>send packet(request time)<br>remot_tm = recieve packet<br>local_t2 = time()<br>lag = (local_t2-local_t1)/2<br>avg = (local_t2+local_t1)/2<br>adjust = (avg - remot_tm)<br>send packet(adjust)<br><br>client:<br>serve_req = recieve packet<br>send packet(local time)<br>serve_adj = recieve packet<br><br>remote then timestamps all packets with its local time + adjust (which should be very close to server time) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
