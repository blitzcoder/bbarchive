<!DOCTYPE html><html lang="en" ><head ><title >Traffic system in a game?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Traffic system in a game?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Traffic system in a game?</a><br><br>
<a name="947906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have any ideas on how to implement a basic traffic system in a game? I'm not necessarily looking for code, although I'd sure like to see some. I'm interested in either 2d or 3d approaches, since I figure the concepts should be the same for both.<br><br>Here is an image that I have made up to help discussion.<br><img src="http://www.andimages.com/proofs/pongo/blitz/roads.png"><br><br>What I am looking to do is populate the roads with some cars. The yellow dots are waypoints, so a single car should be able to move around in this manner, picking a random waypoint at an intersection.<br><br>Additional cars can be added into the system, but then the issues of collision avoidance start to happen. For example, how can I get cars to line up behind a stopped car without simply plowing into it? Distance based collision would work somewhat (don't allow a car to move if it is too close to another car) but this falls apart when cars are traveling in different directions and get close to each other.<br><br>Anyways, I'm just looking for ideas here. It doesn't have to be actually correct, but I want it to look correct if that makes any sense. <br><br></td></tr></table><br>
<a name="947987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nawi</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to check if the car is both close enough and in front of the car (just calculate the angle between the two cars centers, and compare with the angle of the car). You could then either implement red lights (make a zone where the first car will stop in front of the red light, if the red light is on.) Or you could implement a right of way system. <br><br></td></tr></table><br>
<a name="948012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >stayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try using a pivot on the passenger side front and rear.  That way traffic in opposing lanes won't attempt to avoid each other since the pivots are on opposite sides of the cars.  For same lane traffic you could match the speed of the car behind with the car in front according to pivot distance (with a bit of slack of course to simulate acceleration/deceleration).<br><br>Just a basic idea.  I am sure it could be done much more elegantly with some nifty math. <br><br></td></tr></table><br>
<a name="948087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The simplest method of checkng cars in front and behind is using tformpoint. e.g. <br><br><pre class=code>
tformpoint 0,0,0,ThisCarEntity, ThatCarEntity
</pre><br><br>Pseudode ..<br><br><pre class=code>
if tformedz() &gt; 0 then This car is tformedz() units in front of That car
if tformedz() &lt; 0 then This car is tformedz() units behind That car
if abs( tformedx() ) &gt; ( This Car Width * .5 + ThatCarWidth * .5 )  then That car will not collide with This car if stays on current heading.
</pre><br><br>Using a combinations of these tformed results you can determine whether breaking is required, the car in front has stopped at traffic lights etc...<br><br>Give me a shout if you need a hand.<br><br>Stevie <br><br></td></tr></table><br>
<a name="948198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the comments. I will have to try setting up some code to see how this might work. These methods seem to make sense, but I wonder if there isn't an easier way. I'm concerned about the overhead of tracking a larger number of cars through a larger map.<br><br>Baby steps first though,... I'll try to get things working with a single straight road, followed by a single intersection,... then onto something like the pic I posted above.<br><br>Do those waypoints look correct? Do I need more? can I get away with any less? <br><br></td></tr></table><br>
<a name="948206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >stayne</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good luck with it Pongo, I'm sure it's going to be quite the task.  I've seen AI cars slamming into each other and getting hung up for several minutes in big games like GTA and Test Drive Unlimited.  I can only imagine how tough it would be to code the logic where an AI vehicle needs to recover from being spun around...while facing a wall head on :).  As far as waypoints go if you are using aligntovector you could probably get away with less as long as you force the AI cars to slow down before curves. <br><br></td></tr></table><br>
<a name="948207"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pongo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, I know.<br><br>Right now I'm just in the early phase of things, and I need to find out if I can make things work. The basic gameplay is get from point A to point B within a certain amount of time. The cars need to be there only to create interference. That's why they don't need to necessarily do everything correct,... they are simply moving obstacles. (Although I would like the ability to knock them aside, rather than them being solid fixtures.)<br><br>Gameplay is also going to be top-down, so 2d works as well as 3d for this. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
