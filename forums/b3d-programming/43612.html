<!DOCTYPE html><html lang="en" ><head ><title >Alpha Channel Problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Alpha Channel Problem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Alpha Channel Problem</a><br><br>
<a name="486857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi. <br><br>I have problems with the Alpha Channel of a Texture.<br><br>When I load the texture as a TGA with Alpha Channel, it works nicely.<br><br>But the TGA is 4 Megs, and even zipped still pretty huge. So I decided to save the RGB Channels as a JPG, and the Alpha Channel as a seperate JPG. To prevent lossy JPG behaviour on the Alpha Channel, I set all texels Alphabytes to zero if they are less than 10. This way the 4 Megs shrink down to less than 100 kB.<br><br>Now there's a problem, some brighter areas of the texture don't seem to be alphaed correctly. It looks like there is some kind of Bitwise overflow that makes a certain brightness half as transparent as slightly darker texels.<br><br>When I load the TGA and then apply the alpha channel as I did with the JPG, then it works perfectly. It seems setting the Alpha Bytes taken from the Alpha Channel JPG works ok. It must be something with the RGB JPG. Tho, this JPG was saved with a relative high quality, so it isn't a Lossy-Compression Problem.<br><br>Is there anyone who had the same Problem? <br><br></td></tr></table><br>
<a name="486867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, fixed it. It was a stupid bug:<br><br><pre class=code>
rgb1=readpixelfast(x,y,buffer1)
rgb2=readpixelfast(x,y,buffer2) and $FFFFFF
rgb3=rgb1 or ((rgb2 and $FF)shl 24)
writepixelfast x,y,rgb3,buffer1
</pre><br>should be<br><pre class=code>
rgb1=readpixelfast(x,y,buffer1) and $FFFFFF
rgb2=readpixelfast(x,y,buffer2) and $FFFFFF
rgb3=rgb1 or ((rgb2 and $FF)shl 24)
writepixelfast x,y,rgb3,buffer1
</pre><br><br>Reading the RGB Pixel from Buffer1 without to mask out the Alpha Channel, and then ORing the Alphabyte of buffer2 to it gave me these strange Alpha values. Kind of a typo. <br><br></td></tr></table><br>
<a name="487574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barliesque</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds like a good idea.  Will you add a little sample of this trick to the code archives? <br><br></td></tr></table><br>
<a name="487604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not PNG <br><br></td></tr></table><br>
<a name="487792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, added to the code archives:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1286" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1286</a><br><br>Ice9 - yes, for the Alpha Channel I use a 8-Bit PNG now.<br><br>Problem with a 32 Bit PNG with Alpha Channel is: since it's non-lossy you still got enormous filesizes with big textures (eg: 1024%1024, may be 1MB in 32Bit PNG or 100KB in JPG) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
