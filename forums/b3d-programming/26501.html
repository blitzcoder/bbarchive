<!DOCTYPE html><html lang="en" ><head ><title >Is this Single Surface?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is this Single Surface?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Is this Single Surface?</a><br><br>
<a name="276021"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am so sorry to bring this subject up again, but I am trying to Optimise my game "LunaC" as much as possible.<br><br>I have read about having as fewer surfaces as possible is the key to speed gain.  <br><br>1) If my model has 8 textures, will there be a surface for each texture.  If I map all my textures onto 1 image and redo the UVMap, will my model have 1 surface.<br><br>2) Every time i create a sprite, is this a new surface<br><br>3) Please can someone once and for all; explain surfaces to me :-( <br><br></td></tr></table><br>
<a name="276024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1a) 8 textures = 8+ surfaces<br>1b) It should do.  Whether its worth reducing 8 surfaces down to one in this way is another matter.<br><br>2) Yes.  Definitely worth a reduction here (for particles etc).<br><br>3) A Surface is just collection of verts and tris that share the same common characteristics: texture, shininess, color, etc.  It might help to imagine them as seperate 'entities', and that the Blitz Entity system is merely a convenient way of grouping them together. <br><br></td></tr></table><br>
<a name="276027"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>1) If my model has 8 textures, will there be a surface for each texture<br> <br></div><br><br>Yes.<br><br><div class="quote"> <br>Every time i create a sprite, is this a new surface<br> <br></div><br><br>Sort of. The surface mechanism in Blitz automatically discards redundant renderstate changes, so the overhead *may* be small - or it may not. If the engine ends up displaying the same sprite 1000 time at different locations, and they all share the same texture/color/shininess etc there will be little slowdown.<br><br><div class="quote"> <br>Please can someone once and for all; explain surfaces to me<br> <br></div><br><br>A surface binds a vertex/triangle mesh (not a Blitz mesh - I regret that now - badly named!) to a brush.<br><br>Internally, there is a surface 'class' that looks a bit like:<br><br>class Surface{<br>  Mesh *mesh;<br>  Brush *brush;<br>};<br><br>Which is not quite optimal. These 2 should be separated, but to do so needs something like an immediate mode. I'm working on it. <br><br></td></tr></table><br>
<a name="276035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob Pearmain</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello Mark, good to hear from you.  <br><br>Thanks for explaining all that, MasterBeaker as well.  <br><br>I always remember an explanation of why rocketboards was so fast was because there were only 8 surfaces per level.  <br><br><div class="quote"> Sort of. The surface mechanism in Blitz automatically discards redundant renderstate changes, so the overhead *may* be small - or it may not. If the engine ends up displaying the same sprite 1000 time at different locations, and they all share the same texture/color/shininess etc there will be little slowdown. <br></div> <br><br>So do I create a mesh, set all its properties and use copymesh to reference it, or what?<br><br>Thanks for all your help <br><br></td></tr></table><br>
<a name="276135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Sort of. The surface mechanism in Blitz automatically discards redundant renderstate changes, so the overhead *may* be small - or it may not. If the engine ends up displaying the same sprite 1000 time at different locations, and they all share the same texture/color/shininess etc there will be little slowdown. <br></div>Oh good. I assume this applies to all meshes no matter what order they were created in (i.e. it groups meshes by brush to render them).<br><br>So this means I won't see that much speed up from combining my identical particle quads into one big mesh entity? <br><br></td></tr></table><br>
<a name="276179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suppose then that the speed difference between blitz sprites and s custom single surface partical system is the fact that the single surface system is not made up of so many entities seperate entities that blitz will have to cylce thruogh internally. <br><br></td></tr></table><br>
<a name="276403"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So this means I won't see that much speed up from combining my identical particle quads into one big mesh entity? <br></div><br><br>Far be it from me to argue with the guy who created the language, but I think I'm going to argue with the guy who created the language. I wrote 2 demos a long time ago and posted them here for people to test. One created 500 identical sprites ( sharing the same, texture, colour, shininess, etc ) and one that created 500 identical quads, all attached to the same surface. If I recall, the speed increase ranged between 200% and 400% on average. With larger numbers of sprites, it was much more even.<br><br>So, assuming what Mark says is true, the code which discards redundant renderstate changes is.. fallible. <br><br></td></tr></table><br>
<a name="276509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> These 2 should be separated, but to do so needs something like an immediate mode. I'm working on it. <br></div><br><br>Awesome!<br><br>Tracer <br><br></td></tr></table><br>
<a name="276521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ken Lynch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I wrote 2 demos a long time ago and posted them here for people to test. One created 500 identical sprites ( sharing the same, texture, colour, shininess, etc ) and one that created 500 identical quads, all attached to the same surface. If I recall, the speed increase ranged between 200% and 400% on average. <br></div><br><br>I have not noticed any increase in speed using single surface compared to sprites, especially when you add all the vertex updating code to keep the single suface system pointing at the camera, but then you do say you did the demo a long time ago - Blitz may have changed internally since then. <br><br></td></tr></table><br>
<a name="276533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought it was well established that single surface homemade particle systems were faster than doing it with Blitz Sprites.<br><br>Who hasn't made one? <br><br></td></tr></table><br>
<a name="276535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> In my experience the sprites are just as fast as using a single surface system. BUT, when you go over abouut 100 particles using sprites, the system suffers big slowdown. I can go up to about 1800 single surface particles until i get that same sort of slowdown.<br><br>So the way i see it is use single surface stuff if you intend to have alot of particles onscreen. Other wise i think they are just the same :) <br><br></td></tr></table><br>
<a name="276553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Neo Genesis10</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does multitexturing use one surface or one for each texture applied? <br><br></td></tr></table><br>
<a name="276560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I never use Blitz sprites. I use my own quad meshes. I just want to know if creating all the quads in a single mesh is faster than creating a single quad mesh and CopyEntity()ing it a few hundred times. <br><br></td></tr></table><br>
<a name="276630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroBooster</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> RottBott:<br>I never use Blitz sprites. I use my own quad meshes. I just want to know if creating all the quads in a single mesh is faster than creating a single quad mesh and CopyEntity()ing it a few hundred times. <br><br>It's faster rottbott, the difference get's larger as you use a higher quantity of quads/other models, at 100 surfaces in quads you may not notice much of a difference, but try looking at a good 1500 quads in the distance (DISTANCE because fill rate will choke otherwise) and you will quickly notice that the single surface particles in the distance are far faster then the 1500 individual surfaces!<br><br>MasterBeaker:<br><br>I thought it was well established that single surface homemade particle systems were faster than doing it with Blitz Sprites. Who hasn't made one? <br><br>Been using single surfaces for certain particles and many other things way before vertex alpha was even implemented. For high density graphics surface reduction is the way to achieve professional speed results. <br><br></td></tr></table><br>
<a name="276674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> RetroBooster - I know cos you've been using <a href="http://www.playerfacory.co.uk" target="_blank">FONText</a> for a long time. :P <br><br></td></tr></table><br>
<a name="276695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I have not noticed any increase in speed using single surface compared to sprites, especially when you add all the vertex updating code to keep the single suface system pointing at the camera, but then you do say you did the demo a long time ago - Blitz may have changed internally since then. <br></div><br><br>Imagine how much faster it would be if Blitz did this internally and you didn't HAVE to do all the vertex manipulation by hand.<br><br>I've just run the demo again and the speed difference on my machine is 400%. I use Sin and Cos tables to get a slight speed increase and I actually found that recreating the surface and adding all the quads to it each frame was faster than manipulating them where they are. Though the latter is still around 300% faster.<br><br>Bear in mind that this is only if you're updating every particle every frame. If you use a clever little rotation system where only 1/5 of the sprites is being moved each frame, sprites won't get any faster but single surface quads will.<br><br>So you could easily end up with a speed increase of around 2000% over sprites. And that's with 500 particles. Not an inordinate amount. The more sprites, the bigger the increase. <br><br></td></tr></table><br>
<a name="276707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Single surface is far faster. Not all single surface routines are born equal however. You don't need to use clearsurface each frame either if you rely on dx to clip tri's well out of range. <br><br></td></tr></table><br>
<a name="276792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob.. OK. So when you delete a particle you mark it for deletion and move it away to some way-out location where it cannot been seen, or set the vertices alpha to 0.<br><br>Then every now and then (50 frames?) you ClearSurface and get rid of the quads marked for deletion.<br><br>That right? <br><br></td></tr></table><br>
<a name="277075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroBooster</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> MasterBeaker:<br>RetroBooster - I know cos you've been using FONText for a long time. :P <br><br>Yeah masterbeaker, great tool, though I was reffering to even long before that.<br><br>RottBott:<br>Depends on what your system is setup for... I have some setups that never need to use clearsurface, some which use it periodicaly and some of those add new particles (not just quads but whole objects if needed) in a distributed manner (over multiple game loops, sometimes even seconds). <br><br></td></tr></table><br>
<a name="277116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Anthony Flack</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rob - I tested this good and proper before deciding how to implement my 2d-in-3d system, and if every particle is going to be moving, then it takes pretty much exactly the same time to clear the surface and rebuild all the quads as it does to move all the existing vertexes. Plus when you rebuild, you can re-sort the drawing order at the same time. <br><br></td></tr></table><br>
<a name="277136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rottbott</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I knew I missed something. Can "reycle" particles. Saves using ClearSurface at all.<br><br>How do you handle Z-order for alpha'd particles? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
