<!DOCTYPE html><html lang="en" ><head ><title >Mipmapping and VRam resident not working 2gether?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Mipmapping and VRam resident not working 2gether?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Mipmapping and VRam resident not working 2gether?</a><br><br>
<a name="403999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried to combine Flags 8 and 256 using texturefilters, but it seems as soon as I use Flag 256, mippmapping is ignored. Could it be that this is the nature of mipmapping?<br><br>eg:<br><br>cleartexturefilters<br>texturefilter "",9 or 256<br>mesh=loadmesh("building.b3d")<br><br>The reason why I tried this is DX tends to pause when it dynamicly loads surfaces/textures to vram, and this makes the framerate pretty jerky. <br><br></td></tr></table><br>
<a name="404000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think it works on some cards and not others. I know that if I enable VRam I lose mipmapping. <br><br></td></tr></table><br>
<a name="404068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Flag 256 speeds things up on one of my PCs, and slows things down on the other!? :/ <br><br></td></tr></table><br>
<a name="404077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Flag 256 speeds things up on one of my PCs, and slows things down on the other!? :/  <br></div><br><br>Used to do that on one of mine too. Poor Nvidia drivers were the culprit. <br><br></td></tr></table><br>
<a name="404125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I know. If you want to use it in a Release, first make a little benchmark test. I wrote some code that would test A] if it's supported at all (using a checksum test on the buffer) and B] if it's faster than non-256ish. Must be somewhere in the archives. Not a big deal. <br><br></td></tr></table><br>
<a name="404130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doesan't that make sense, since mipmapping creates a low-res version of the texture?  If the texture were kept "real-time" it would have to create a new mipmap ever frame? <br><br></td></tr></table><br>
<a name="404151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> mipmapping is ok to prevent moire patterns, but I don't like the way how dx is "optimizing" Ram usage, since I got enough ram to hold everything in Ram, so no need to swap lots of versions over the bus and pause the game for .5s whenever I enter a new room. <br><br></td></tr></table><br>
<a name="404656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sybixus: that would explain it - I haven't updated the driver on the 'slow' machine for years. Didn't much see the point, it's only a GeForce 256. :/<br><br>jfk: Thanks. I'll have a root in the code arcs and see if I can find it. <br><br></td></tr></table><br>
<a name="404942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jan_</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jo, If you use Flag 256 Flag 8 is allways disabled / have no effekt. <br><br></td></tr></table><br>
<a name="405732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LAB[au]</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> you will have to write a pixel to the texture each frame to trigger mipmap generation, that's what I made... <br><br></td></tr></table><br>
<a name="406094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> really? and then it keeps using vram resident textures? <br><br></td></tr></table><br>
<a name="406099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> VRAM resident textures are not meant for operations on them like a Mipmap replacement would be, only for being statically loaded.<br>As Mipmap replaces the texture depending on the view distance, this would slow things down drastically ( try it youself. do some texture operations on a normal texture and on a +256 texture, the 2nd one will be 100-200x slower. Blitz3D has to copy the texture from VRAM into SysRAM, alter it and send it back to VRAM which needs quite some time )<br><br>big10p: try the 60.80 or 61.80 drivers at <a href="http://www.laptopvideo2go.com" target="_blank">http://www.laptopvideo2go.com</a> , they are top :) <br><br></td></tr></table><br>
<a name="406124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>only pixel shaders can change textures in VRAM.<br> <br></div><br><br>Pixel shaders only have read-access to textures. And their write position is pre-determined before pixel shader execution and not changable.(Hence pixel shader :) )<br><br>But, anyway, the fatest way is to just store a copy in local sysram. perform updates to that(And reads directly on the sys mem copy for v.fast performance) then just upload it. Uploading a 512x512 texture from sys ram to vid ram for example is v.fast.<br><br>And on modern cards you can actually set the gpu's draw buffer to that of the texture's, using pbuffers. This doesn't work on a *lot* of older cards, but it's the fatest method. (not supported in b3d) <br><br></td></tr></table><br>
<a name="406154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> we are talking of Blitz3Ds VRAM flag not any new technics, perhaps you missed that? <br><br></td></tr></table><br>
<a name="406179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> How does you implying pixel shaders can write to textures, have anything to do with vram flag? <br><br></td></tr></table><br>
<a name="406182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> *never post 5 words that someone else could understand as a offer to write a lot of stuff that has nothing to do with the topic at all - so reedited the 5 words out* <br><br></td></tr></table><br>
<a name="406209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually seinstein(not a typo), it was in reply to your further bit of factual fabrication where you stated a texture needs to be downloaded back into system ram to be edited. (You already have it in system ram, unless b3d supports render to texture, which it doesn't)<br><br>So if I'm off-topic, so are you. But then I don't care what's on or off, i'm not that anal. <br><br></td></tr></table><br>
<a name="406355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, I'm getting a bit confused here. :P<br><br>TBH I don't really see what flag 256 is for - I thought all textures are kept in VRAM. When I LoadTexture() does Blitz not just load the texture into VRAM? Why do we need a flag to tell Blitz to store it in VRAM?<br><br>I have a texture I need to re-draw every frame (a dynamic shadow map) so I assume I need to use flag 256 to keep the rendering as fast as possible, yes?<br><br>Surely the GPU can only render to it's own memory (VRAM) and not sysmem? If so, I don't see the point of swapping stuff out to sysmem, other than if VRAM becomes full.<br><br>Can someone explain to Mr. Thicko here what's going on! :P<br><br>---<br><br>Thanks for the link Dreamora ;) <br><br></td></tr></table><br>
<a name="406369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Without vram, blitz uses a managed mode. Which I believe is a case of performing ops in system memory, then uploading to vram. And also keeping textures in sys ram until referenced by a model, to help cards with low vid mem(I.e texture swapping. Whether mark's code does this or dx I dunno)<br><br>But with vram flag, this managed mode is circumvented so that copyrects etc translate into(in gl terms, dx is not something I'm familar with) simple direct buffer copies from backbuffer to texture bufer (I.e no trip to system memory ala non v-ram flag mode, as color buffer/tex buffers are all agp side)<br><br>I could be wrong, but if I am then I'm just as confused as you are to what it means ;) <br><br></td></tr></table><br>
<a name="406378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> 256 simply means the texture will always be in use and must not be paged etc... It is probably "kept alive" each cycle.<br><br>mipmaps obviously won't work with 256 because 256 is a realtime texture and mipmaps are only generated when you load the texture. <br><br></td></tr></table><br>
<a name="406502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the answers, guys - I'm nearly there! :P<br><br><div class="quote"> <br>Without vram, blitz uses a managed mode. Which I believe is a case of performing ops in system memory <br></div><br>What kind of ops are you talking about here? Do you mean just stuff like CopyRect? Surely the texture has to actually be in VRAM in order for the GPU to perform other ops like Line, Rect, Oval etc.?! <br><br></td></tr></table><br>
<a name="406510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no texture operation that you can perform over GPU in Blitz3D.<br><br>All operations you perform on a texture are done over CPU in SysRAM which is the reason why VRAM + operations end in total break ins in performance if you want to use it in real time. <br><br></td></tr></table><br>
<a name="407151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, so if I'm drawing to a texture every frame, I shouldn't use flag 256?<br><br>BTW, I wonder how hard it would be for Mark to expand the GfxDriverCaps command so that it tells us whether flag 256 is supported or not. I currently only tells us if cube mapping is supported, doesn't it? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
