<!DOCTYPE html><html lang="en" ><head ><title >Robs Normal Mapping Statue code and demo?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Robs Normal Mapping Statue code and demo?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Robs Normal Mapping Statue code and demo?</a><br><br>
<a name="874314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can anyone please make this available for me to download?<br><br>[EDIT] I have spent most of the afternoon looking for normal mapping demos, but actually Bump Mapping demos would be more what I need on reflection, as I don't want to have to create high poly meshes.  <br><br>Thanks if that's possible.  If not anyone got anything similar? I want to try out normal mapping and that was the best example - which worked - that I ever saw.<br><br>I just want to give objects in a scene I'm developing some additional detail and I think this is the best way forwards.<br><br>I need to create the objects in 3DS Max then export via B3D Pipeline and... I have no idea.. pls help?<br><br>Thanks again.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="874322"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> you mean fredboards ... as long as you look for robs you won't find much ...<br>At least if you are talking of the normal mapped Arianna statue.<br><br>What I would suggest having a look at is the BSM renderer.<br>Allows normalmap with dynamic lights using a cubemap above it instead of altering the vertex color. this allows you to have brighter and darker meshes + normalmap and it works on animated models as well which normally is impossible <br><br></td></tr></table><br>
<a name="874377"></a>

<a name="1219949"></a>

<a name="1222158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hosted here as normaldemo.zip.<br><br><a href="http://www.blitzmax.com/logs/userlog.php?user=8652&amp;log=1737" target="_blank">http://www.blitzmax.com/logs/userlog.php?user=8652&amp;log=1737</a> <br><br></td></tr></table><br>
<a name="874511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora, <br><br>I am begining to realise that what I really need is bump mapping, just additional noise on a surface to give it some detail, instead of flat textured stuff.  Robs demo is ace, but I dont want to have to build a large polygon version to get the normal map, not for rocks and metal fragments anyway.<br><br>@markcw, many thanks for that - <br><br>So in addition had anyone got a bump map demo with source please?<br><br>IPete2. <br><br></td></tr></table><br>
<a name="874512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll get you one when i get home man. <br><br></td></tr></table><br>
<a name="874515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ross - you are a real gent thanks,<br><br>Im taking my PC home tonight so I shall keep an eye out.  What I am looking to do is add some noise or surface detail to rocks, metal fragments, and effectively crystals.  SO I don't want to have to build very high poly versions to do that.<br><br>Thanks for any help.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="874522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you need a movable light source? <br><br></td></tr></table><br>
<a name="874530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> is it based on any external lib, or you require pure b3d code? <br><br></td></tr></table><br>
<a name="874535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The objects will rotate in screen, I guess that means a movable source?<br><br>I don't mind as long as its all stable code. The simpler to use the better thanks.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="874544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> try this..<br><br>Function ApplyBumpMap( Mesh, SearchTexture$, BumpMap, Frame=0, LightMapped=1 )<br>	;this function changes the texture on a mesh so you can apply a bump/normal map<br>	Local SurfS=CountSurfaces( Mesh ) <br>	Local SurfI=0<br>	Local BlankBrush = CreateTexture( 64, 64 )<br>	Local t0, t1, t2, t3<br>	<br>	SetBuffer TextureBuffer( BlankBrush )<br>	ClsColor 255, 255, 255<br>	Cls<br>	ClsColor 0, 0, 0<br>	SetBuffer BackBuffer()<br>	<br>	For SurfI=1 To Surfs<br>		s=GetSurface( Mesh, SurfI ) <br>		b=GetSurfaceBrush(s) <br>		t0=GetBrushTexture( b, 0 ) <br>		t1=GetBrushTexture( b, 1 )<br>		t2=GetBrushTexture( b, 2 )<br>		<br>		If Upper$( StripPath$( TextureName$( t0 ) ) ) = Upper$( SearchTexture$ )<br>			BrushTexture b, BumpMap, Frame, 0<br>			BrushTexture b, t0, Frame, 2<br>			<br>			;lightmap is always on channel (index) 1<br>			If LightMapped=0<br>				BrushTexture b, BlankBrush, 0, 1<br>			Else<br>				BrushTexture b, t1, 0, 1<br>			EndIf<br>			<br>			PaintSurface s, b<br>		EndIf <br>		<br>		If t0&lt;&gt;0<br>			FreeTexture t0<br>		EndIf<br>	Next <br>	<br>	FreeTexture BlankBrush<br>End Function<br><br>Function StripPath$(file$) <br>	;borrowed from Blitz Help file<br>	If Len(file$)&gt;0 <br>		For i=Len(file$) To 1 Step -1 <br>			mi$=Mid$(file$,i,1) <br>			If mi$="\" Or mi$="/" Then Return name$ Else name$=mi$+name$ <br>		Next <br>	EndIf <br><br>	Return name$ <br>End Function <br><br></td></tr></table><br>
<a name="874615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> did NA's solution work for you? <br><br></td></tr></table><br>
<a name="874637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya Ross and Naughty Alien,<br><br>Short answer is no, but it may be because I don't have a proper bump map from my 3d guy yet, or that I didn't use it right.<br><br>What is the BumpMap parameter in the function call for?<br><br>I tried a few variations, but I didnt see anything happen.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="874642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Found this on my hard drive, but I don't know who wrote it (apologies to whoever did). The filename in the code below is a link to the image... didn't expect that to work!<br><br><pre class=code>
Graphics3D 640,480,0,2

bump=LoadTexture( "<a href="http://www.hi-toro.com/blitz/images/mynormal.jpg" target="_blank">mynormal.jpg</a>",1+8 )
cube=CreateSphere(16)
EntityFX cube,1+2
TextureBlend bump,4
EntityTexture cube,bump,0,0

light = CreateLight(2)
lighticon = CreateSphere(8,light)
EntityFX lighticon,1
ScaleEntity lighticon,0.1,0.1,0.1

camera=CreateCamera()
CameraClsColor camera,128,128,128
PositionEntity camera,0,0,-4.0

a# = 180.0

While Not KeyHit(1)

	a = a + 1
	If a = 360.0 Then a = 0
	PositionEntity light,Cos(a)*4,Sin(a*2)*1,Sin(a)*4
	
	If KeyDown(200) TurnEntity cube, 1,0,0
	If KeyDown(208) TurnEntity cube,-1,0,0
	
	If KeyDown(205) TurnEntity cube,0,-1,0
	If KeyDown(203) TurnEntity cube,0, 1,0
	
	If KeyDown(30) TranslateEntity camera,0,0,0.01
	If KeyDown(44) TranslateEntity camera,0,0,-0.01
	
	UpdateBumpNormals(cube,light)
		
	UpdateWorld
	RenderWorld
	Flip
Wend

Function UpdateBumpNormals(mesh,light)

	n_surf = CountSurfaces(mesh)
	For s = 1 To n_surf
		surf = GetSurface(mesh,s)
		n_vert = CountVertices(surf)-1
		For v = 0 To n_vert
			TFormNormal VertexNX(surf,v),VertexNY(surf,v),VertexNZ(surf,v),mesh,0
			nx# = TFormedX()
			ny# = TFormedY()
			nz# = TFormedZ()
			TFormPoint VertexX(surf,v),VertexY(surf,v),VertexZ(surf,v),mesh,0
			red# = EntityX(light,True)-TFormedX()
			grn# = EntityY(light,True)-TFormedY()
			blu# = EntityZ(light,True)-TFormedZ()
			d# = Sqr(red*red + grn*grn + blu*blu)
			red = (red/d)
			grn = (grn/d)
			blu = (blu/d)
			dot# = red*nx + grn*ny + blu*nz
			If dot&gt;0.0
				red = (1.0+(red*dot))*127.5
				grn = (1.0+(grn*dot))*127.5
				blu = (1.0+(blu*dot))*127.5			
				VertexColor surf,v,red,grn,blu
			Else
				VertexColor surf,v,127.5,127.5,127.5
			End If
		Next
	Next

End Function

End
</pre> <br><br></td></tr></table><br>
<a name="874759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> BumpMap is your loaded normalmap you want to apply man..its working great here... <br><br></td></tr></table><br>
<a name="874807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice demo.<br>So how are normal maps produced? <br><br></td></tr></table><br>
<a name="874833"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> use CrazyBump..you will love it..thing simply rocks<br><br><a href="http://www.crazybump.com/" target="_blank">http://www.crazybump.com/</a> <br><br></td></tr></table><br>
<a name="875042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Naughty,<br><br>Ah maybe thats why it does not work here, I dont have a normal map. I shall download crazybump and try it - many thanks.<br><br>[edit okay now that seem to work.  I shall get the 3D artist to look it over next week and start using this technique where appropriate. Thanks guys!  ]<br><br>IPete2. <br><br></td></tr></table><br>
<a name="875107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> What! $299 - I don't think so.<br><br>Any others? <br><br></td></tr></table><br>
<a name="875113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..sure, here is excellent one from ATI and free too..my suggestion is, dont us nVidia normalmap plug in for Photoshop..instead, use this one and you'll be happy <br><br><a href="http://ati.amd.com/developer/sdk/radeonSDK/html/Tools/ToolsPlugIns.html" target="_blank">http://ati.amd.com/developer/sdk/radeonSDK/html/Tools/ToolsPlugIns.html</a><br><br>or this one for MAC lovers<br><br><a href="http://homepage.mac.com/nilomarabese/Menu13.html" target="_blank">http://homepage.mac.com/nilomarabese/Menu13.html</a> <br><br></td></tr></table><br>
<a name="875165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> To explain in a little more depth, changing the light direction of a normal map, involves you changing, either:<br><br>The entitycolor, or,<br>The vertex colors, or,<br>The texture blending with the normal map.<br><br>Alot of examples use the textureblending, as they can use a cubemap, with colour normal information stored on it. Basically, as the model moves/animates, the vertex normals of the model change. Since a cubemap adjusts the texturecoords dynamically, it automatically maps a certain part of the texture, for particular vertex normals of the cubemap. Therefore, this always shows the correct normal colour for mixing with the normalmap, providing the correct lighting.<br><br>For a rotatable lightsource, you actually have to the rotate the cubemap, which is an expensive process, so alot of codes use a very small cubemap, to reduce the rendering process of the new cubemap.<br><br>A simple way though for normalmaps, with a rotatable light source, is to use entity color, and change the red green and blue parts yourself, to determine a position(normal) for the light. 255 being 1, 128 being 0 and 0 being -1 (for normals)<br><br>However, you can only use this on static meshes, which do not move, as their normals would be incorrect.<br><br>Vertex colours can be used, but that would involve you looping through every vertex and calculating their light value, based on light direction. This gives you some ability to have spot light and omi lights too, depending on the numb er and distribution of vertices in the mesh. <br><br></td></tr></table><br>
<a name="878768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mtnhome3d</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> heres another prog that can make normals and its free<br><a href="http://www.xnormal.net/" target="_blank">http://www.xnormal.net/</a> <br><br></td></tr></table><br>
<a name="879866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm I gotta try this when I get home! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
