<!DOCTYPE html><html lang="en" ><head ><title >Millisecs() alternatives ?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Millisecs() alternatives ?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Millisecs() alternatives ?</a><br><br>
<a name="984787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive found that any timing based on millisecs() can get funky if a machine is left on for days.. So far i think ive gotten around this by starting the game with a global stamp if the current time, then creating a new millisecs to subtract the start time from current millisecs value.<br><br>Are there any OTHER alternatives to this ?<br><br><br><pre class=code>
Global Game_StartTime=millisecs()

Function Millisecs2#()
Return MilliSecs()-game_starttime#
End Function 
</pre> <br><br></td></tr></table><br>
<a name="984796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Millisecs() will start returning negative values (but incrementing as normal) after about 25 days of system up-time.<br><br>I *almost* suggested using a timer instead but apparently Blitz3D timers are a completely different beast to the timers available in Blitzmax (which I migh add, do the trick nicely).<br><br>I think BlitzSupport wrote an alternative Millisecs() function that gets around the 25 day limit but again, it was Blitzmax code and involved Long vars so wouldn't translate to Blitz3D.<br><br>I appreciate that none of this is any help whatsoever, other than to suggest why not use Blitzmax and MiniB3D in future?  Other than that, if whatever hacky method you're using works, why change? <br><br></td></tr></table><br>
<a name="984801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...Or do a periodic test to see if millisecs() is smaller than your previous known value. If yes, then you know that the timer rolled over, and you can account for that. <br><br></td></tr></table><br>
<a name="984804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just use Abs(MilliSecs())<br><br>Edit: Oh I forgot that Millisecs() would look like it's counting down if it's on its negative side, if you use Abs on it. So nevermind. <br><br></td></tr></table><br>
<a name="984833"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there a windows api call to reset the timer ? <br><br></td></tr></table><br>
<a name="984858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't believe so, and even if there was, messing with it might screw up any other system timer-dependent processes.<br><br>What you might be able to do (random thought, off the top of my head), is this:<br><pre class=code>Function myMillisecs()
  Return Millisecs() - 2147483647
End Function</pre>That way it'll be double the time (about 50 days) before the returned value is less than it was the last time you called it, as for the first 25 days you'll get negative values.  This is assuming that Blitz3D handles Ints like Blitzmax does, and won't give an overflow error or something if you try to put too high/low a value into a var.<br><br>I really think you're a bit stuffed as to a permanent solution to this. <br><br></td></tr></table><br>
<a name="985062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberyoyo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> GIA_Green_Fire_ <br>You were on the right tracks.<br>you need to do this:<pre class=code>
abs(oldmillisecs-millisecs())
oldmillisecs=millisecs()
</pre><br><br>And everything should be okay <br><br></td></tr></table><br>
<a name="985985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jasu</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Always count "millisecs since last tick" instead of using Millisecs() directly.<br><pre class=code>
Repeat
  TimeDiff = Millisecs() - oldTime
  oldTime = Millisecs()
  ; Do all stuff using TimeDiff variable
Forever
</pre><br>The feature that causes this problem is also the solution:<br>- 2147483648 - 2147483630 = 18 (why, you might ask?)<br>Because -2147483648 - 1 = +2147483647 (caused by crossing integer limit)<br>and +2147483647 - 2147483629 = 18<br><br>You should do this regardless if you use max or 3d. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
