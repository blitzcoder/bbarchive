<!DOCTYPE html><html lang="en" ><head ><title >400 sprites</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >400 sprites</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >400 sprites</a><br><br>
<a name="1037501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I haven't been here in a while, but BlitzMonkeys seems down for the count, so.<br><br>I ran into a little... Not necessarily problem, but CONCERN, in my game today. Long story short, there are ball-shaped enemies in this game which, at the moment, split into eight mini-versions of themselves when destroyed. Well, after destroying a tightly packed test group of 50, I of course had the resulting 400 mini-enemies... And my framerate proceeded to drop to about... Oh, 1 frame per five or so seconds.<br><br>System specs are a 1GHz Atom, 2GB of RAM and 224MB video memory, if you're interested. Now, about these enemies. This game I'm making is rendered in 3D, but only uses 2D imagery, i.e. everything in it is flat geometry and sprites. So we're just talking 400 small sprites, not complex meshes or anything. Another thing to know is what the logic was for each of these mini-enemies. Basically, all they do is follow the player using <b>AlignToVector()</b>. I used a little <b>MilliSecs()</b> tracking and confirmed that the entire logic update for all 400 mini-enemies took no longer than 2ms. Yet another detail is that they all have collision statements. Basically, they're set for sphere-to-polygon collision with the level walls, and sphere-to-sphere collision with each other.<br><br>I also noticed that the framerate didn't immediately drop to ungodly depths. It struggled at first, but actually dropped steadily over the next few seconds. Since the enemies were all created at once, I don't really see any reason that the framerate should go any lower than its initial speed, at the time of their creation.<br><br>As another check, I took a <b>MilliSecs()</b> check on the core function. Basically, everything my 3D programs do gets packed into a single function which I call <b>Core()</b>. All logic, control, EVERYTHING, happens in the CORE, apart from <b>UpdateWorld()</b> and <b>RenderWorld()</b>. The entire time for the CORE updates was less than 10ms. Around 6~8ms, to be specific.<br><br>So, what I'm asking is basically this. Is it too much to hope for Blitz to handle 400 multi-collision sprites? Is there perhaps some quirk or cumulative bug in the tweening code (I'm using the Mark Sibly blend from the "castle.bb" demo) that I don't know about? Or should I be looking for something else going wrong? <br><br></td></tr></table><br>
<a name="1037513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What video adapter do you have in the system?<br><br>Atom CPU's are pretty slow in the first place (a 1.6GHz atom is slower than a 1.6GHz Celeron, albeit it uses much less electricity so they're popular in netbooks), but depending on the size and number of the sprites you're drawing the video acceleration (or lack thereoff) can also make a huge difference in rendering speed.<br><br>Most netbooks have pretty crappy video hardware -- again, to safe battery life... You may want to create a small demo for people to download so you could see how many FPS it runs in other machines. It could very well be that yours is just underpowered for the job you want it to do... <br><br></td></tr></table><br>
<a name="1037516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, same results in my desktop, which is a 3GHz Athlon 5200+ x2, and a 256MB Radeon X1300 (yeah, not great, but not terrible. XD) Maybe I'll post something testable later and see what happens, if I can mod it enough to cut it down to brass tacks for benchmarking... XD<br><br>The thing I'm most confused about is why the framerate dropped over time instead of just going down and staying there... <br><br></td></tr></table><br>
<a name="1037530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it the sprites or the collisions?  If you can turn off the collisions try that and see how long each frame takes to render.  If it is still slow then try changing the sprites to quad surfaces thingies (sorry, can't remember the proper term).<br><br>You also may be using up texture memory if you are creating the sprites the wrong way (I don't remember which is which, but there are posts about it if you search.)<br><br>If it IS collisions then you may want to try implementing a quadrant collision system - splitting the screen into smaller squares (large enough to hold one sprite) and then only collision check things that are in the sprite's current square and each adjacent square.  (and perhaps more depending on if the sprite moved from one square to another) <br><br></td></tr></table><br>
<a name="1037534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ... quad surfaces thingies (sorry, can't remember the proper term). <br></div><br><br>Yeah, quads is what I call 'em. I use them a lot, actually, so much so that I ended up just making a quick <b>CreateQuad()</b> function. XD<br><br><div class="quote"> You also may be using up texture memory if you are creating the sprites the wrong way (I don't remember which is which... <br></div><br><br>I think that'd be using <b>LoadSprite()</b> for every one, which would create multiple instances of the same texture. Don't worry, I'm not; they're all made using <b>CreateSprite()</b>, then <b>EntityTexture()</b> is called during their update loop.<br><br><div class="quote"> If it IS collisions then you may want to try implementing a quadrant collision system... <br></div><br><br>Yeah, I'll prolly just return to my old standby, <b>EntityDistance()</b>. The map collisions can be altered too if need be, since the map data is stored in an array. I'll see what comes up. So far no one's said anything about exceeding the practical limits of Blitz3D - like I did in my earliest draft of the game, wherein every tile of the 200x200 map was an individual sprite - so I'll sniff around in the code and see what else I can come up with.<br><br>Gawd, y'know, I'm getting rather disheartened these days. I mean, 3D programming is great and fun, but... Most of the time now it seems like every time I add a single line of code, something else breaks. It's starting to become more complicated than it's worth. T_T <br><br></td></tr></table><br>
<a name="1037548"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did 6,000,000 Googles:<br><br><img src="http://img340.imageshack.us/img340/5411/another26milliongoogles.jpg"><br><br>It ran like a slug super-glued to a road (with a nail belted through him - just to be sure he is secure) - but it looked great. <br><br></td></tr></table><br>
<a name="1037555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I did 6,000,000 Googles: <br></div><br><br>Okay... Moving... On... &gt;.&gt;<br><br>Well, problem identified. It is indeed being triggered by the collisions, but the actual cause of the problem is definitely the tweening code. If <b>UpdateWorld()</b> takes longer than the maximum time to maintain logic at 60FPS - so basically, 16ms max - it causes a cumulative slowdown, dragging the program down into the mud. I need a break right now; my head's spinning, especially with all the problems I've had to fix of late. However, I do at least know what the problem is, so a solution is on the horizon. Phew.<br><br>Oh, final note, to xlsior: I don't usually like bragging, but hey, I love Evie (my netbook), so. XD I am pleased to report that, sans collisions, she can update over SIX hundred of said sprites with absolutely no problem, running at the silky smooth sixty. In fact, she often amazes me with just how much she CAN do, considering she is "just" a netbook. Someday soon I'm gonna see what kind of benchmarks <i>Portal</i> gets on her. :D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
