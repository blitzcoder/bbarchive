<!DOCTYPE html><html lang="en" ><head ><title >Size of window border</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Size of window border</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Size of window border</a><br><br>
<a name="945408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Virtech</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>In conjunction with this <a href="/posts.php?topic=83726" target="_blank">taskbar</a> functionality I need to get the metrics (sizes) of the different part of a window border around a b3d application. Would it be possible to get this data also trough the use of a decls?<br><br>Thanks. <br><br></td></tr></table><br>
<a name="945449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, use <a href="http://msdn.microsoft.com/en-us/library/ms724385(VS.85).aspx" target="_blank">GetSystemMetrics</a>. There's also <a href="http://msdn.microsoft.com/en-us/library/ms724947(VS.85).aspx" target="_blank">SystemParametersInfo</a> but it's a bit  more complicated -- with GetSystemMetrics you just pass the value you want to retrieve and it returns it, eg. <i>xborder = GetSystemMetrics (value)</i>.<br><br>I'll let you have a go yourself first, but if you get stuck just say!<br><br>Scroll to the bottom of that page and look at the grey Requirements box, which tells you which DLL the function is in. If a .decls file of that name doesn't exist in the Blitz3D\userlibs folder, create it, otherwise back up the existing one and edit it. It's just a plain text file with ".decls" extension. If you have to create it, use the DLL's name for the file (eg. for <i>example.dll</i> you create <i>example.decls</i>).<br><br>Follow the format in the <a href="/sdkspecs/sdkspecs/userlibs_specs.txt" target="_blank">Userlibs Specs</a> document to add the function name -- you only need to look at the "Format of decls files" section. Once added, save the file and try calling the command from Blitz.<br><br>If it all looks right but Blitz says the function doesn't exist, try adding 'A' to the function name (as in the DLL there may be Unicode and Ascii versions of the function), eg. GetSomething% (details) becomes GetSomethingA% (details).<br><br>The constants you want to pass are probably SM_CXBORDER and SM_CYBORDER, or maybe SM_CXFIXEDFRAME and SM_CYFIXEDFRAME -- try both and see what you get. (Also look through the list to see if anything else sounds appropriate.) The docs page above helpfully tells you the values in this case, so just define the constants you need with these values (in your Blitz program, not in the .decls) before calling the function.<br><br>(In cases where constants aren't documented, just type <i>const SM_CYFIXEDFRAME</i> (for example) into Google and you'll usually find C source declaring them. Check a few results just to be sure they're correct.)<br><br>See how you get on anyway... <br><br></td></tr></table><br>
<a name="945605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Virtech</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks again for the great support. I think you provided me with enough info to get me going in the right direction. Should be a piece of cake :) <br><br></td></tr></table><br>
<a name="945706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a codelib entry at <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1071" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1071</a> which may be useful to you. <br><br></td></tr></table><br>
<a name="946076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Virtech</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Bill :) I found that codelib very helpful. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
