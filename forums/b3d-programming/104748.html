<!DOCTYPE html><html lang="en" ><head ><title >recursive function performances</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >recursive function performances</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >recursive function performances</a><br><br>
<a name="1271062"></a>

<a name="1271063"></a>

<a name="1271064"></a>

<a name="1271065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Flanker512</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi guys, I have a question about performance according to specific code implementation.<br><br>Let's say i have this function :<br><pre class=code>Function recursiveFunction(variable)

	If variable = True
		; blablabla calling recursiveFunction 1000 times
	Else
		; blablabla calling recursiveFunction 1000 times
	EndIf

End Function</pre><br><br>will it be better to implement it like that :<br><br><pre class=code>Function mainFunction(variable)

	If variable = True
		; call recursiveFunction1 10 times
	Else
		; call recursiveFunction2 10 times
	EndIf

End Function

Function recursiveFunction1()
	; blablabla calling recursiveFunction1 100 times
End Function

Function recursiveFunction2()
	; blablabla calling recursiveFunction2 100 times
End Function</pre><br><br>so basically, is checking "variable = True" 10 times over 1000 worth the effort ?<br><br>my recursive function is quite huge and it's not really easy to test the other method :-/ <br><br></td></tr></table><br>
<a name="1271066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> By 'better' , if you mean faster then it probably makes very little difference. <br><br>I think it's important to know what your recursive function actually does? <br><br></td></tr></table><br>
<a name="1271067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Flanker512</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes I mean faster, the recursive function performs basic maths.<br><br>the second implementation could avoid a lot of "If variable = True", and I wonder if it can increase performances as it's only a memory read if i'm not wrong. <br><br></td></tr></table><br>
<a name="1271068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I think it's important to know what your recursive function actually does? <br> <br></div><br><br>Performs basic maths doesn't really help.<br><br>Avoiding alot of "if variable = true" conditions is going to make very little, if any difference to the speed of your code. <br><br></td></tr></table><br>
<a name="1271069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Flanker512</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The function is a recursive pathfinding designed to be as fast as possible so the implementation is crucial. For example, as a test, if I add "temp = temp + 1" in the "blablabla", I can see a performance decrease, so I'm tracking every operation wich can be avoided. However the "If variable = True" is not as simple in my case, so if it doesn't make a huge difference, I may stick with it. Thx for the help. <br><br></td></tr></table><br>
<a name="1271079"></a>

<a name="1271080"></a>

<a name="1271081"></a>

<a name="1271082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> This honestly isn't worth worrying about at this stage. For every project, write the code in the form that is <i>clearest to you</i>, and then test the whole program after integrating it; if whole-program performance falls below the threshold of acceptability, make a profile and make changes to the code you've empirically found to be the source of the problem.<br><br>By thinking about this before the actual code is in place, you're going to end up writing unnecessarily convoluted code that doesn't perfectly reflect the algorithm and will thus be harder to manage (and risks being slower in the long run as a result, by locking you in). You probably also aren't going to have any significant effect on the performance by trying to pre-empt the results because modern CPU performance is actually pretty complicated.<br><br>Things to consider:<br><br>-- Blitz3D is not an optimising compiler anyway. The machine code it generates is... well it's not horrible, but it makes no pretence at being "high-performance". By writing in Blitz3D you are already giving away anywhere between 1 and 90 percent of your program's performance (who knows how much it really is; it varies)<br>-- on modern systems, the number of instructions is a very minor issue. Yes, testing a variable technically involves a memory read and a branch, but in practice caching and branch prediction make both of these operations very cheap. In particular, a branch that almost always goes the same way (i.e. 1000 tests that result in false before the loop ends) are basically going to be equivalent to no-ops; branches are generally only slow if they aren't consistent. So to some extent the hardware has actually started actively compensating for the code.<br>-- what the hardware can't currently compensate for is the fact that Blitz3D isn't really designed to handle recursion beyond the most basic form, so it means a lot of function calls, local variable initialisation, tromping around in a wide swathe of memory (nuking the call/ret predictor stack and wasting cache), and the risk of stack overflow (1000 invocations of a reasonably-sized function is around the point where you should be becoming worried). Recursion is certainly elegant, but if you care about performance, you could negate all of those issues by using a loop - even a loop with a manually-managed shadow stack - as your implementation's base instead, and likely see a noticeable performance improvement.<br>-- since Blitz3D doesn't understand e.g. cache, alignment, or prediction, it's perfectly possible to have huge - like 20% - performance variations in <i>exactly the same piece of code</i>, simply because you moved a line up or down somewhere else in the program and had no effect on the logic but the instructions were emitted in a different sequence (this does happen in practice, although it's thankfully not that extreme normally). So it can make even getting a read on where exactly the source of a micro-benchmark's slowdown <i>is</i> difficult.<br><br>Machine code is fast. Bad machine code is actually still pretty fast. Unless you know it <i>is</i> something you need to worry about, it's not something you need to worry about. Do whatever you want and you'll probably be fine. (If you're really not, you might want to consider dropping down to C for this bit.) <br><br></td></tr></table><br>
<a name="1271115"></a>

<a name="1271116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Flanker512</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thx for the tips Yasha. I should have done like you tell, would have save me some time... In fact I tried to improve the code before it actually works... And I messed up everything lol Now I'm rewriting it the basic way even if it's not the fastest and I'll improve later if necessary.<br><br>CPU seems complicated... I know Blitz3D isn't optimize for such things but I need a simple 3D engine so I'll give it a try. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
