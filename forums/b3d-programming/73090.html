<!DOCTYPE html><html lang="en" ><head ><title >Optimizing the game package - &gt; PNG into JPG+PNG</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Optimizing the game package - &gt; PNG into JPG+PNG</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Optimizing the game package - &gt; PNG into JPG+PNG</a><br><br>
<a name="816969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJirenius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to optimize all my 32 bits png images as they are pretty big in my (hopefully) finished game just to reduce packagesize.<br><br>The theory is instead of using 32-bits pngimages which is rather big sizedimages, I would like to use one JPG instead and apply a 8bit-alpha.png on that one instead.<br><br>Is it possible to do this on textured entities without having to rewrite all my code??? <br><br></td></tr></table><br>
<a name="816973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJirenius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, to clarify and put it in one simple question:<br><br>Is it possible to load COLOUR-DATAfrom one image and ALPHA-DATA from another and store it in the same texture (not multitextures)???? <br><br></td></tr></table><br>
<a name="816988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's possible, but I think you will have to write your own code to do it. As jpg compression is lossy, you will lose image quality. <br><br></td></tr></table><br>
<a name="816992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJirenius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I know it's lossy, it's unfortunately the only way to go to lower it more than png 32bits images.<br><br>What I tried at the moment is this:<br><br><pre class=code>
Tex = 	LoadTexture ("Data\Buttons1.jpg", 3)	
Tex2 = LoadTexture ("Data\Buttons1.jpg", 1)
CopyRect 0,0,w,h,0,0,TextureBuffer (Tex2),TextureBuffer(Tex)
return Tex
</pre><br><br>but appearently it just didnt work and only kept the alpha channel anyway :(<br>any suggestions? <br><br></td></tr></table><br>
<a name="816993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bug already reported.<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=71621" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=71621</a><br><br>Some people think it's not a bug, but I think it is.  Textures do have alpha channels, as well as 32bit graphics modes.  But Blitz3D doesn't copy the whole 32bit, only 24 bit (RGB color values).  So we are out of luck for this one.  If you build your texture in memory as an image, you can't define alpha values and then copy that back to the texture buffer. <br><br></td></tr></table><br>
<a name="817002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AJirenius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> But I am doing it the other way around and not copying the alphachannels but the normal colourchannels (RGB), alphachannel would hopefully stay intact, but it doesn't seem to work anyway. <br><br></td></tr></table><br>
<a name="817074"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Suggestion: Don't use compressed images.<br><br>Now, I know that sounded very strange, but I have my reasons.<br><b>Image compression is very poor compression, even .jpg</b><br><br>Here is a list of compression of an image:<br>.bmp - filesize 3841KB (no compression)<br>.jpg - 537KB<br>pure blitz3D coded compression of .bmp - 396KB<br>.zip - 122KB<br><br>I'll try to find the link to the compression algorythm.<br><br>there is also a dll to pack/unpack .zip files <br><br></td></tr></table><br>
<a name="817094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've published some code that does exactly what you want, in the code archives. Instead of copyrect you simply use WritePixelfast to set the alphabyte:<br><br>rgb=readpixelfast(x,y,jpgbuf) and $ffffff<br>a=readpixefast(x,y,pngbuf) and $ff000000<br>writepixelfast x,y, (rgb or a) <br><br></td></tr></table><br>
<a name="817095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Suggestion: Don't use compressed images. <br></div><br><br>What do you mean by:<br><div class="quote"> pure blitz3D coded compression of .bmp - 396KB <br></div><br><br>And omitting to mention PNG... tsk tsk. <br><br></td></tr></table><br>
<a name="817365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Subirenihil</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> .png - 229KB<br><br>Interesting, I'll have to check my sources, I was under the impression that .png and .jpg used the same compression algorithm, only .png adds alpha layer and keeps colors exactly.  It would seem that I was mistaken.<br><br><a href="/codearcs.php?code=195" target="_blank">Purely B3D coded Compression</a><br><a href="/codearcs.php?code=196" target="_blank">Purely B3D coded Decompression</a><br><br>(Note: I applied the compression algorithm multiple times to get the stated file size) <br><br></td></tr></table><br>
<a name="817607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Subirenihil for the compress / decompress code.  I'll have a look at it this weekend. <br><br></td></tr></table><br>
<a name="818103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>.bmp - filesize 3841KB (no compression)<br>.jpg - 537KB<br>pure blitz3D coded compression of .bmp - 396KB<br>.zip - 122KB<br> <br></div><br><br>Wait a minute. zip 122k? I think this depends a lot. As far as I know the packing algos of jpg, PNG and GIF are about as efficient as zip. Where in JPG you can greatly control the amount of loss, so whenever you list JPG then you should say at what quality percentage. Depending on the kind of image (cell shaded something, or a complete chaos) lossless compression is more or less efficient.<br><br>IMHO the best format sizewise is DDS anyway. (not for lightmaps) <br><br></td></tr></table><br>
<a name="818174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd just use DDS for everything anyway (using the appropriate DDS settings for lightmaps and normalmaps) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
