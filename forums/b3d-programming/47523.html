<!DOCTYPE html><html lang="en" ><head ><title >No colored lights with normal mapping.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >No colored lights with normal mapping.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >No colored lights with normal mapping.</a><br><br>
<a name="528125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Damn, that sucks..<br><br>Did some normal mapping, and using colored lights (yellow).<br><br>With the normal mapping the color is white, but without the normal mapping applied to the mesh the color is yellow...<br><br>Anyone know a workaround for this? <br><br></td></tr></table><br>
<a name="528128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem is you are not simulating the virtual light completely.<br><br>The normal map provides the brightness at each pixel.  You need to multiply this by the color of the light.  I don't remember exactly how normal mapping works off the top of my head, but either you have to set the object color to yellow, or you have to put a yellow surface beneath or above the normal mapped surface and multiply that by the normal mapped surface to change the color.<br><br>Also I don't know what you mean by doing normal mapping with coored lights.  Normal mapping uses virtual lights that you create, not the ligths in Blitz.<br><br>In other words, you would store the position of the light and dtermine the direction of that relative to your object, and set your object color to be the same as that vector by normalizing the vector then multiplying it's length by 255 or something, and then that is the color you set the object to before dot3 blending the normal mapped surface, and the result is a shaded version of the object in black and white, which you then apply color to in some way, like having that second skin I described that you multiply with it.  So you'd have an object with two surfaces with the same polygons in each.<br><br>So I don't know what you mean by a colored normal light if you don't know how to apply color to the object. :-) <br><br></td></tr></table><br>
<a name="528180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I mean is I create an object, normal map it, texture it.<br><br>Then I create a light and move the light around.  The normal mapping looks pretty good as the light moves, however the object is not colored with the light.<br><br>So if I had a sphere normal mapped, how would your technique apply to it? <br><br></td></tr></table><br>
<a name="528192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> How are you creating this light source?<br><br>Are you using the object color or vertex colors to define the light source vector that the dot3 map is multiplied with?<br>  <br>What texture layer is the object texture on?<br>What is it's blending mode?<br><br>What texture layer is the normal map on?<br><br>The easiest way to make a light a certain color might be to place a texture of the appropriate color on the third texture later and set that layer to multiply blend.  I'm not positive that will work, but I think it will.  <br><br>This assumes that you have the normal map on the first texture layer, are dot 3 blending it with the color of the object or vertex colors below, and you have the texture on layer 2 which you are multiplying or multiplyx2 with the result of the first operation.  You then need to multiply the result of THAT by the light color, hence the texture on the third layer. <br><br></td></tr></table><br>
<a name="528700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am creating the light with:<br><br>light = createlight(2)<br><br>and simply moving the light entity around.  The normal maps seem to work pretty well.  I have a screen shot at home, when I get home I will show it to you.<br><br>not sure what layer, the code is at home, however i used the code in the code archives to apply a normal map to an existing texture in an object by texture name.  The is the only bit of code I borrowed.<br><br>hmmm, perhaps I am doing the wrong though, now that I think of it, the normal maps didnt have direction, just intensity when the light moved around.. <br><br>I will have to rethink my methods.<br><br>Thanks a ton for the help sswift. <br><br></td></tr></table><br>
<a name="528905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dark:<br>Well then you're doing things wrong, and if all you see is intensity then the normal maps AREN'T working very well. :-)<br><br>You do NOT use Blitz lights with normal maps.  Any lights you create would be virtual lights you store the positions of yourself and calculate the data for.<br><br>Normal maps in Blitz are only half supported, because Blitz doesn't have pixel shaders.  You need pixel shaders to do proper normal maps.  Some folks here have indicated they have got them working with levels in the past, but I have my doubts about whether they're realyl working right.  It's often hard to tell.  As far as I know you can only normal map a character model sort of right, and only if they do not animate.<br><br>For that you would create a normal map in I guess global space, and then set the color of the object to the vector representing the direction of a directional light in the object's space.  You would have to convert it from world space to obejct space to do that.  Then you dot3 blend that map with the object color, and that calculates the right pixel shades, which you then have to apply color to.<br><br>But if the object moves, the normal map would be distorted and the vectors would no longer be pointing in the right directions.  And you can't fix this by using vertex colors instead because A) vertex colors don't get normalized, or treated as vectors, and your colors have to represent a normalized vector (one with a length of 1), and B) You can't get the locations of the vertices as they change position in the animation.  Blitz always returns their static location.  And if you don't know where they are, you don't know how the angles of the surfaces attached to them have changed.<br><br>In short, I wouldn't even be trying to mess with normal maps in Blitz.  They are nothing but pain.<br><br><br>If you want to make your models look better, instead of trying to make them normal mapped, maybe you should try to do specular mapping?  Specular mapping is where some parts of the obejct are shinier than others.  You can get some very nice looking bump like effects with specular mapping.<br><br>I'm not going to go into how to do specular mapping right now though.  I'll just say you need a mesh with two surfaces, and top one which has specular turned up, and an alpha map, and the bottom which has specular turned down and no alpha map.  Those are the basics. <br><br></td></tr></table><br>
<a name="529755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a ton for the info, I guess normal mapping is pretty much a lost cause in Blitz3d (damn).<br><br>Here was the screenshot I had taken of what I got to work:<br><a href="http://www.kcstudios.net/gallery/gallery.asp?Gallery=2&amp;Category=18&amp;Image=70" target="_blank">http://www.kcstudios.net/gallery/gallery.asp?Gallery=2&amp;Category=18&amp;Image=70</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
