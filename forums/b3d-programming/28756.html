<!DOCTYPE html><html lang="en" ><head ><title >I'll write a tutorial for dynamic lights and decals if Blitz3D gets more than two texture coord sets.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >I'll write a tutorial for dynamic lights and decals if Blitz3D gets more than two texture coord sets.</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >I'll write a tutorial for dynamic lights and decals if Blitz3D gets more than two texture coord sets.</a><br><br>
<a name="303076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wrote routines for dynamic lights and decals on walls, using the same method as Half-Life, but have no way to display them with the texture and lightmap.  If Blitz3D had 3 sets of texture coords, I could display dynamic lights for gunfire or moving lights.  If Blitz3D had four or more sets of texture coords I could display decals for bullet marks and blood splatters that actually wrap around the walls, and don't go over the edges.<br><br>I asked Mark for additional texture coord sets, and if he adds them, I'll write a tutorial to show how to easily implement these features.<br><br>The other way to do this, of course, is by changing the Blitz3D depth function.  In OpenGL, a value of GL_LEQUAL will blend together two surfaces that are exactly on top of each other. <br><br></td></tr></table><br>
<a name="303077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool. your some guy Halo ;) How many uv co-ords sets do direct x support? <br><br></td></tr></table><br>
<a name="303081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> In order to only need 2 sets of UV coords, couldn't you..<br><br>Keeping a copy of the lightmap texture write your dynamic lights into its pixels, in effect overwriting the static lightmap information where your dynamic lights are.<br><br>Then draw the current frame using this new texture which has the static and dynamic lighting in it.<br><br>Then copyrect the original lightmap to overwrite the dynamic lights.<br><br>Thinking further, you only need to keep track of which areas of the lightmap you dirtied with the dynamic lights and copyrect from the original lightmap to reset these pixels only when that dynamic light changes.<br><br>This of course assumes that every triangle has it's own individual area of lightmap texture, so no optimisations would be allowed in the lightmap texture for triangles with the same lightmap shading to share the same pixels of the lightmap...not sure if you do this with cartshop anyway.<br><br>Hope my long winded explanation is understandable -.- <br><br></td></tr></table><br>
<a name="303086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure why it always has to be wrapped up into some kind of deal. I think there's a legitimate purpose for more than 2 UV sets, and that - as a feature request - this is perfectly valid. So on that basis, thumbs up, agree, yes please, can we have this? <br><br></td></tr></table><br>
<a name="303087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I assume theres not much point writing a tutorial without the extra set of uv's ;) <br><br></td></tr></table><br>
<a name="303092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, but this "If I get what I want, I'll.." thing seems bound to annoy those who use every thread Halo starts as an opportunity to engage in a little bashing. I just think if it's a legitimate request for something that's genuinely useful ( and in my opinion it is ) it would get more credence and be taken more serious if it came without the baggages.. just a flat "This would be really useful." <br><br></td></tr></table><br>
<a name="303106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, and most likely very easy to implement for mark(not sure of it though). Sounds like a good idea to me. <br><br></td></tr></table><br>
<a name="303108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Drawing pixels to a lightmap is too slow for dynamic lights, and too low-res for blood splatters.  Blitz3D has the capacity to do dynamic lighting, and I just one little feature request from Mark, and I'll show you how.  It's pretty easy, you just make a calculation based on the normal of the face, the distance of the light, and the light's position relative to the face.  Hard to describe, but the math is simple.  I'll post the code if anyone wants, but you can't really do much with it right now. <br><br></td></tr></table><br>
<a name="303112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skitchy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've wanted this for ages too. It would also allow you to do some excellent stuff with terrains (or custom terrain meshes) eg. small repeating grass texture on layer 0, dirt patches on layer 1, rock patches on layer 3, lightmap on layer 4 - that sort of thing. <br><br></td></tr></table><br>
<a name="303132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Once you have an object mapped with planar or cubic texture coordinates you can use PositionTexture, ScaleTexture and RotateTexture to postion different texture layers on a surface. Not that I disagree with the request... <br><br></td></tr></table><br>
<a name="303133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I considered that, but then each face requires a separate copy of the texture, right? <br><br></td></tr></table><br>
<a name="303140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a good request for many many other reasons. <br><br></td></tr></table><br>
<a name="303142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MSW</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about this...a sort of modified "draw dynamic lights to the lightmap" approch...<br><br>Load the lightmap as a image kept in system memory (call it lightorg)...create a seperate system memory image of the same pixel size (call it lightscratch)...then create a texture that same pixel size as the lightmap (called lightmap)<br><br>Then for each dynamic light create a pivot at it's location with the same radius and use the entity visable function to deturmine if the effects of this light will show onscreen...<br><br>If so you can do all your lightmap modifications to the lightscratch image...setbuffer to the lightmap texture and draw the lightscratch image there...this should work faster then the writepixel fast method as it optimizes the system to video transfer bandwidth...writepixel is fast...but everytime you call it the video card not only needs the color, but also the location within the surface to place the color...so in effect you are sending twice the amount of data to the video card... <br><br></td></tr></table><br>
<a name="303148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matt2222</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldn't it just be better, faster, easier, and more efficient if this feature were just added to blitz?  Not a difficult change to code, and the advantages are endless.  I think that this would be an EXCELLENT addition to b3d.<br><br>-Matt <br><br></td></tr></table><br>
<a name="303153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroBooster</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not to sound odd, but halo's right in this case, the only other way to do proper dynamic lighting in blitz right now is multipass rendering (2 renderworlds) I've done dynamic lighting in blitz as well and i'd personaly love some extra layers. :)<br>Scratching to lightmaps isn't fast enough, what you do to achieve proper dynamic lights is adjust the UV sets and texture them with a light/decal texture. <br><br></td></tr></table><br>
<a name="303161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> agreed it would be nice to have extra channels :) <br><br></td></tr></table><br>
<a name="303262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't need another set of UV coordinates to create dynamic lights.<br><br>First of all, unless you're writing for ulta high end cards (higher than Geforce 2 say) you can't assume the user even has more than two texture channels.  And if the user doesn't have four texture channels you're gonna end up using one additional surface for every texture unit you attempt to make use of past number 2.  So four simulated texture units will actually create three surfaces, and waste one texture unit on each of those two extra surfaces that you could have used for better effects.<br><br><br>"I considered that, but then each face requires a separate copy of the texture, right?"<br><br>No, each dynamic light requires a seperate texture and surface.<br><br>To do dynamic lights, you need one adidtional surface for each object that will be dynamically lit.  This surface has two sets of texture coordinates.  The first set you set the U to the X coordinate of the vertex, and the V to the Y coordinate of the vertex, and the second set you set the U to the Z cooridnate of the vertex, and the V to 0.<br><br>You leave both set to multiply mode, but set the blend mode of the surface to whatever you need to for your particular game to blend it with your lightmaps or texture.  IF you're just blending with a texture then multiply.  Lightmap, you probably want add.<br><br>Then you simply apply the texture and offset and scale it as neccessary.  <br><br><br>The textures need to be loaded with UV clamping on, and the XY texture needs to be a circle of light that fades to black at the edge of the texture.  The Z texture needs to be a linear gradient going left to right from black to white to black.<br><br><br>Obviously this is not the least expensive way to do dynamic lights.  A method which takes advantage of hardware vertex lighting would probably be a lot faster since you could do it with just a single surface.  You'll have to subdivide large walls though if you want them to look good with a vertex light in the center though.  But even if you subdivide each wall into 32 polygons, that's gonna be a lot less expensive than having even 2 dynamic lights with the texture method.  You can probably have 4-8 vertex lights lights and still have it be less expensive than just 2 texture lights. <br><br></td></tr></table><br>
<a name="303285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroBooster</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> The idea of having more layers is making it less heavy to run and make use of the latest hardware which doesn't mind dealing with dense multitexturing.<br><br>It's far from something we absolutely need though, since we can already pull it off by multipass rendering or as sswift says, getting an extra surface instead.<br><br>There's plenty of smaller things that could have a greater impact on blitz's abilities. <br><br></td></tr></table><br>
<a name="303311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> How can you do multipass/multisurface rendering without either major z-fighting or seeing through walls? <br><br></td></tr></table><br>
<a name="303317"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitz renders surfaces in the order they are created in the object.<br><br>So, surface 1 you leave normal, but surface 2 and later you set the vertex alpha flag for the surface.  The vertex alpha flag will cause the renderer to test the zbuffer but not write to it.  As both surfaces are at the same exact location in space, and always rendered in the same order, there is no z-fighting*.  And you can't see through any walls because you render a layer which writes to the zbuffer first.<br><br>(*Or at least, I never saw any when I helped someone implement vertex alpha blending in a terrain engine.)<br><br><br>As for multipass rendering, you can do the same thing.  Render the first pass with all surfaces set to have zbuffering, but render the second pass with all surfaces set to have vertex alpha enabled. <br><br></td></tr></table><br>
<a name="303319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's interesting.  I think another texture coord set would be much simpler, though. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
