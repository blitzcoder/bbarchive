<!DOCTYPE html><html lang="en" ><head ><title >texture mask's color</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >texture mask's color</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >texture mask's color</a><br><br>
<a name="553028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cousin Gilgamesh</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using the texture flags to mask some textures, and I find it extremely annoying that 0,0,0, the masked color, is extremely prevolent in images I'm trying to mask. instead of using 1,1,1 for black in my pictures, is there any way I can change which color is masked? It would be helpful if anyone knew how I would go about doing this. Thanks a lot. <br><br></td></tr></table><br>
<a name="553055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> MaskImage handle,red,green,blue <br><br></td></tr></table><br>
<a name="553077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maskimage only works for images not textures (ie 2d not 3d). <br><br></td></tr></table><br>
<a name="553172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cousin Gilgamesh</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there anything else I can do? <br><br></td></tr></table><br>
<a name="553255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ozak</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doesn't the alpha channel work for 3D textures? <br><br></td></tr></table><br>
<a name="553273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> you need to write a little function that will set your alpha channel. I'd do something lke this:<br><br><pre class=code>
MaskTexture(mytexture,1,1,1)
...
function MaskTexture(tex,r,g,b)
 setbuffer texturebuffer(tex)
 lockbuffer()
 for y=0 to textureheight(tex)-1
  for x=0 to texturewidth(tex)-1
   rgb=readpixelfast(x,y) and $ffffff
   r2=(rgb and $ff0000) shr 16
   g2=(rgb and $ff00) shr 8
   b2=(rgb and $ff)
   alpha=255
   if (r=r2) and (g=g2) and (b=b2) then
    alpha=0
   endif
   argb= (alpha shl 24) or rgb
   writepixelfast x,y,argb
  next
 next
 unlockbuffer()
 setbuffer backbuffer()
end function
</pre><br>just from my head, I hope there ain't no typos. <br><br></td></tr></table><br>
<a name="553287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note, as I found out, this doesn't work in 16 bit colour - the graphics get screwed. I'm afraid I don't have the 16but friendly code sorted yet as I'm working on other aspects to my program. <br><br></td></tr></table><br>
<a name="553293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you can make it work with a color that can be divided by 16, eg: 16,16,16 instead of 1,1,1. Not sure, but there's some way, some raster 32 bit is converted to 16 bit, and some bit values remain the same. <br><br></td></tr></table><br>
<a name="553427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doesn't 16 bit representation vary on different hardwares? So one card might have 5,6,5 and another 5,5,5,1? OR are they all 5,6,5? If what you suggest would work, this suggests the minimum value 'step' for a colour would be 256/32 = 8 for R and B, and 256/64 = 4 for G. In which case colours that divide uniformly into 16 bit would be (a*8),(b*4),(c*8) such as 80,44,72 and 0,4,8?<br><br>Even is the hardware varies in colour representation, using colours in steps of 8 should work on all hardwares, just with the loss of resolution in whatever colour is 6 bit. <br><br></td></tr></table><br>
<a name="553434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Doesn't 16 bit representation vary on different hardwares <br></div><br><br>No, 0,0,0 is the same accross the board..<br><br>Your issue is that you might be using a jpg or lossy compression format for your texture, in which case 0,0,0 in the image might not be 0,0,0 after decompression the image. <br><br></td></tr></table><br>
<a name="553450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think this wasn't the point, I guess he meant 1,1,1 didn't work in 16 Bit Mode. Well as Shifty said, steps of 8 should work, that's even better than steps of 16, as I suggested. I only remember this was discussed a few years ago and there was a solution. <br><br></td></tr></table><br>
<a name="553585"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Liberator</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really simple way to fix this, you need to use a .bmp file with a alpha layer. Just use the alpha texture flag and not the Masked. Just pop open photoshop, add an alpha channel, make the stuff you wanna see black, the stuff you don't want to see white, and your problem is solved. Works with 16, and 32 bit images.<br><br>And for all of you that are going to yell about a .bmp file not having the ability to support alpha information - try it and run it in blitz. It's flawless. <br><br></td></tr></table><br>
<a name="553733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cousin Gilgamesh</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm... I have Jasc Paint shop, but it's able to do a lot of the same things. I'll take a look around and see if I can do this. thanks a lot! <br><br></td></tr></table><br>
<a name="553741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DH</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using Jasc I found the following way to make an alpha image (I have PSP 8 min you):<br><br>Create your mask, then merge all layers.  Create a seperate image with your 'actua' image and merge all layers.<br><br>In the mask image, right click on the layer and select the mask-&gt;from image option.  Tell it to create the mask from the source values.  It will create a mask layer.  Hide it (click on the eye to hide it). and select the other layer (non-mask) for drawing operations.<br><br>Goto your actual image and select it and copy it.  Go back to the 'mask' image and paste the contents on the normal layer.  No unhide the mask layer and go to file-&gt;export-&gt;png optimizer.  From there goto tranparancy tab and select the 'range' of values rather than the 1 or 0 option for the transparancy.<br><br>After you hit ok, it will ask where you want to save the image (As a .png file). and there you go, a png alpha image.<br><br>(it took me 5 hours to figure this out with PSP where as photoshop it's pretty straight forward).  If you ever get the chance to pick up a copy of photoshop do it!  You won't regret it! <br><br></td></tr></table><br>
<a name="553807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> In PSP seven if you have your mask image you can fairly easily save it as an aplhoa channel. Select Masks &gt; New &gt; From Image and select the mask image. This creates the mask. Then do Masks &gt; Save to Alpha Chhannel &gt; New Channel , and you can change it's name to Alpha or leave it as Selection#1 - the name makes no odds. Finally save your image as a .png and in the Optimiser, select Transparency &gt; Alpha Channel &gt; Existing image transparency. It's pretty straightforward to set up single colour transparencies too with the PSP optimiser.<br><br>The .png alpha channel idea unfortunately doesn't work if you're creating your own textures, such as I am by copying areas of an image to sprite textures. Though it certainly might work for Gilgamesh from the sounds of it. <br><br></td></tr></table><br>
<a name="553814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using Alpha Transparency will probably only open a new pandora box: Z-Order problems. So when somebody is using the Mask Flag 4, he usualy has a good reason to do this.<br><br>But since the masked textures use mipmapping and filtering, they normaly fade to black on their contours. Even worse, when the mesh is far away from the camera, this effect is getting stronger. We have seen this a lot with Grass Quads using the Mask flag. THey where kind of outlined with a black border.<br><br>So there was no way around Writepixelfast &amp; Co. But the good news is: you can neutralize this black outline syndrom completely! All you have to do is: Ask if the RGB Color of a pixel is your Transparency Color (0,0,0 by default). If so, set the alpha byte to 0 and the RGB byte to something green (for grass), if it's not then set the alpha byte to 255 and don't alter the rgb. This way the grass texture will fade to green and it' slooking real good this way.<br><br>The determination of the best Color for the outline effect can even be automatized, just parse all pixels of a texture and calculate the average RGB color. <br><br></td></tr></table><br>
<a name="568307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> anyone having a working example for this issue? i try to load a mesh with loadmesh() and the texture is applied automatically. so i still have my black borders around. some guy wrote that using 32 bit alpha (png, tga) will do the trick. i tried this, but i failed. i always get the ugly black border. i need a mesh, bbcode and a texture. please help ;) <br><br></td></tr></table><br>
<a name="568314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try my <a href="/codearcs.php?code=1131" target="_blank">KeyImage</a> routine to clean up your black edges. <br><br></td></tr></table><br>
<a name="568333"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> looks good, but as the texture is automatically loaded within loadmesh(), i have no texturehandle. see what i mean? <br><br></td></tr></table><br>
<a name="568346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look at the GetSurfaceBrush command help in the docs. Perfect example to getting the texture used. Remember and free the brush created in this process though, as you'll have two copies of it. <br><br></td></tr></table><br>
<a name="568538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> that sounds good. i'll try. i think this is a solution for my problem. <br><br></td></tr></table><br>
<a name="569378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >t3K|Mac</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> whoohow! it works! jfk, you are my hero ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
