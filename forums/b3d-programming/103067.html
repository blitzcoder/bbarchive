<!DOCTYPE html><html lang="en" ><head ><title >Problem with TextureBuffer() ?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Problem with TextureBuffer() ?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Problem with TextureBuffer() ?</a><br><br>
<a name="1238155"></a>

<a name="1238156"></a>

<a name="1238157"></a>

<a name="1238158"></a>

<a name="1238159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all. I was finishing work on the progress bar code on my other thread &amp; needed to turn it into a "live texture" (in other words, it's a texture that automatically animates when applied to a model), when I noticed for some reason that the texture won't show up on the "quad" or flat cube as a transparent texture no matter what I try.<br><br>Can someone please tell me how to fix this?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;Jesse Andersen - xmlspy - <a href="http://www.xmlspy.tk" target="_blank">http://www.xmlspy.tk</a>
;July 19, 2005 : Progress bars
;jesse_andersengt@...
;http://www.alldevs.com

Graphics3D 800, 600, 0, 2
SetBuffer BackBuffer()
SeedRnd MilliSecs()

; Common keys:
Const VK_LEFTMOUSE                              = $01   ; Left physical mouse button
Const VK_RIGHTMOUSE                             = $02   ; Right physical mouse button
Const VK_MIDDLEMOUSE                            = $04   ; Middle physical mouse button
Const VK_BACKSPACE                              = $08   ; BACKSPACE key
Const VK_TAB                                    = $09   ; TAB key
Const VK_ENTER                                  = $0D   ; ENTER key (Main keyboard or keypad)
Const VK_SHIFT                                  = $10   ; SHIFT key (Left or right)
Const VK_CONTROL                                = $11   ; CTRL key (Left or right)
Const VK_ALT                                    = $12   ; ALT key (Left or right)
Const VK_PAUSE                                  = $13   ; PAUSE key
Const VK_SCROLL                                 = $14   ; SCROLL LOCK key
Const VK_ESCAPE                                 = $1B   ; ESC key
Const VK_SPACE                                  = $20   ; SPACEBAR
Const VK_PGUP                                   = $21   ; PAGE UP key
Const VK_PGDN                                   = $22   ; PAGE DOWN key
Const VK_END                                    = $23   ; END key
Const VK_HOME                                   = $24   ; HOME key
Const VK_LEFT                                   = $25   ; LEFT ARROW key
Const VK_UP                                     = $26   ; UP ARROW key
Const VK_RIGHT                                  = $27   ; RIGHT ARROW key
Const VK_DOWN                                   = $28   ; DOWN ARROW key
Const VK_PRINTSCRN                              = $2C   ; PRINT SCREEN key
Const VK_INSERT                                 = $2D   ; INSERT key
Const VK_DELETE                                 = $2E   ; DELETE key
Const VK_0                                      = $30
Const VK_1                                      = $31
Const VK_2                                      = $32
Const VK_3                                      = $33
Const VK_4                                      = $34
Const VK_5                                      = $35
Const VK_6                                      = $36
Const VK_7                                      = $37
Const VK_8                                      = $38
Const VK_9                                      = $39
Const VK_A                                      = $41
Const VK_B                                      = $42
Const VK_C                                      = $43
Const VK_D                                      = $44
Const VK_E                                      = $45
Const VK_F                                      = $46
Const VK_G                                      = $47
Const VK_H                                      = $48
Const VK_I                                      = $49
Const VK_J                                      = $4A
Const VK_K                                      = $4B
Const VK_L                                      = $4C
Const VK_M                                      = $4D
Const VK_N                                      = $4E
Const VK_O                                      = $4F
Const VK_P                                      = $50
Const VK_Q                                      = $51
Const VK_R                                      = $52
Const VK_S                                      = $53
Const VK_T                                      = $54
Const VK_U                                      = $55
Const VK_V                                      = $56
Const VK_W                                      = $57
Const VK_X                                      = $58
Const VK_Y                                      = $59
Const VK_Z                                      = $5A
Const VK_LEFTWIN                                = $5B   ; Left Windows key
Const VK_RIGHTWIN                               = $5C   ; Right Windows key
Const VK_NUMPAD0                                = $60
Const VK_NUMPAD1                                = $61
Const VK_NUMPAD2                                = $62
Const VK_NUMPAD3                                = $63
Const VK_NUMPAD4                                = $64
Const VK_NUMPAD5                                = $65
Const VK_NUMPAD6                                = $66
Const VK_NUMPAD7                                = $67
Const VK_NUMPAD8                                = $68
Const VK_NUMPAD9                                = $69
Const VK_MULTIPLY                               = $6A   ; Keypad *
Const VK_ADD                                    = $6B   ; Keypad +
Const VK_SEPERATOR                              = $6C   ; Keypad /
Const VK_SUBTRACT                               = $6D   ; Keypad -
Const VK_DECIMAL                                = $6E   ; Keypad .
Const VK_DIVIDE                                 = $6F   ; Keypad \
Const VK_F1                                     = $70
Const VK_F2                                     = $71
Const VK_F3                                     = $72
Const VK_F4                                     = $73
Const VK_F5                                     = $74
Const VK_F6                                     = $75
Const VK_F7                                     = $76
Const VK_F8                                     = $77
Const VK_F9                                     = $78
Const VK_F10                                    = $79
Const VK_F11                                    = $7A
Const VK_F12                                    = $7B
Const VK_NUMLOCK                                = $90  
Const VK_CAPITAL                                = $91   ; CAPS LOCK key
Const VK_LEFTSHIFT                              = $A0   ; Windows 95 does not support the left and right distinguishing constants.     
Const VK_RIGHTSHIFT                             = $A1  
Const VK_LEFTCTRL                               = $A2  
Const VK_RIGHTCTRL                              = $A3  
Const VK_LEFTALT                                = $A4  
Const VK_RIGHTALT                               = $A5
 
; Less common keys:
; Some of the keys here would seem to be common keys, but the documentation does not say they work in 95/98,
; so I did not include them with the other keys above just to be safe.
Const VK_CANCEL                                 = $03   ; Control-break processing
Const VK_X1MOUSE                                = $05   ; Windows 2000/XP: X1 mouse button
Const VK_X2MOUSE                                = $06   ; Windows 2000/XP: X2 mouse button
Const VK_CLEAR                                  = $0C   ; CLEAR key
Const VK_SELECT                                 = $29   ; SELECT key
Const VK_EXECUTE                                = $2B   ; EXECUTE key
Const VK_PRINT                                  = $2A   ; PRINT key
Const VK_HELP                                   = $2F   ; HELP key
Const VK_KANA                                   = $15   ; Input Method Editor (IME) Kana mode
Const VK_HANGUL                                 = $15   ; IME Hangul mode
Const VK_JUNJA                                  = $17   ; IME Junja mode
Const VK_FINAL                                  = $18   ; IME final mode
Const VK_KANJI                                  = $19   ; IME Hanja/Kanji mode 
Const VK_CONVERT                                = $1C   ; IME convert
Const VK_NONCONVERT                             = $1D   ; IME nonconvert
Const VK_ACCEPT                                 = $1E   ; IME accept
Const CK_MODECHANGE                             = $1F   ; IME mode change request
Const VK_APPS                                   = $5D   ; Applications key
Const VK_SLEEP                                  = $5F   ; Computer Sleep key
Const VK_F13                                    = $7C
Const VK_F14                                    = $7D
Const VK_F15                                    = $7E
Const VK_F16                                    = $7F
Const VK_F17                                    = $80
Const VK_F18                                    = $81
Const VK_F19                                    = $82
Const VK_F20                                    = $83
Const VK_F21                                    = $84
Const VK_F22                                    = $85
Const VK_F23                                    = $86
Const VK_F24                                    = $87
Const VK_BROWSER_BACK                           = $A6   ; Windows 2000/XP: Browser Back key
Const VK_BROWSER_FORWARD                        = $A7   ; Windows 2000/XP: Browser Forward key
Const VK_BROWSER_REFRESH                        = $A8   ; Windows 2000/XP: Browser Refresh key
Const VK_BROWSER_STOP                           = $A9   ; Windows 2000/XP: Browser Stop key
Const VK_BROWSER_SEARCH                         = $AA   ; Windows 2000/XP: Browser Search key
Const VK_BROWSER_FAVORITES                      = $AB   ; Windows 2000/XP: Browser Favorites key
Const VK_BROWSER_HOME                           = $AC   ; Windows 2000/XP: Browser Start And Home key
Const VK_VOLUME_MUTE                            = $AD   ; Windows 2000/XP: Volume Mute key
Const VK_VOLUME_DOWN                            = $AE   ; Windows 2000/XP: Volume Down key
Const VK_VOLUME_UP                              = $AF   ; Windows 2000/XP: Volume Up key
Const VK_MEDIA_NEXT_TRACK                       = $B0   ; Windows 2000/XP: Next Track key
Const VK_MEDIA_PREV_TRACK                       = $B1   ; Windows 2000/XP: Previous Track key
Const VK_MEDIA_STOP                             = $B2   ; Windows 2000/XP: Stop Media key
Const VK_MEDIA_PLAY_PAUSE                       = $B3   ; Windows 2000/XP: Play/Pause Media key
Const VK_LAUNCH_MAIL                            = $B4   ; Windows 2000/XP: Start Mail key
Const VK_LAUNCH_MEDIA_SELECT                    = $B5   ; Windows 2000/XP: Select Media key
Const VK_LAUNCH_APP1                            = $B6   ; Windows 2000/XP: Start Application 1 key
Const VK_LAUNCH_APP2                            = $B7   ; Windows 2000/XP: Start Application 2 key     
Const VK_OEM_1                                  = $BA   ; Windows 2000/XP: For the US standard keyboard, the ';:' key
Const VK_OEM_PLUS                               = $BB   ; Windows 2000/XP: For any country/region, the '+' key
Const VK_OEM_COMMA                              = $BC   ; Windows 2000/XP: For any country/region, the ',' key
Const VK_OEM_MINUS                              = $BD   ; Windows 2000/XP: For any country/region, the '-' key
Const VK_OEM_PERIOD                             = $BE   ; Windows 2000/XP: For any country/region, the '.' key
Const VK_OEM_2                                  = $BF   ; Windows 2000/XP: For the US standard keyboard, the '/?' key
Const VK_OEM_3                                  = $C0   ; Windows 2000/XP: For the US standard keyboard, the '`~' key
Const VK_OEM_4                                  = $DB   ; Windows 2000/XP: For the US standard keyboard, the '[{' key
Const VK_OEM_5                                  = $DC   ; Windows 2000/XP: For the US standard keyboard, the '\|' key
Const VK_OEM_6                                  = $DD   ; Windows 2000/XP: For the US standard keyboard, the ']}' key
Const VK_OEM_7                                  = $DE   ; Windows 2000/XP: For the US standard keyboard, the 'single-quote/double-quote' key
Const VK_OEM_8                                  = $DF   ; Used for miscellaneous characters; it can vary by keyboard.
Const VK_ICO_F17                                = $E0  
Const VK_ICO_F18                                = $E1  
Const VK_OEM102                                 = $E2   ; Windows 2000/XP: Either the angle bracket key or the backslash key on the RT 102-key keyboard
Const VK_ICO_HELP                               = $E3
Const VK_ICO_00                                 = $E4  
Const VK_PROCESSKEY                             = $E5   ; Windows 95/98/Me, Windows NT 4.0, Windows 2000/XP: IME PROCESS key
Const VK_ICO_CLEAR                              = $E6
Const VK_PACKET                                 = $E7   ; Windows 2000/XP: Used to pass Unicode characters as if they were keystrokes.
Const VK_OEM_RESET                              = $E9
Const VK_OEM_JUMP                               = $EA
Const VK_OEM_PA1                                = $EB
Const VK_OEM_PA2                                = $EC
Const VK_OEM_PA3                                = $ED
Const VK_OEM_WSCTRL                             = $EE
Const VK_OEM_CUSEL                              = $EF
Const VK_OEM_ATTN                               = $F0
Const VK_OEM_FINNISH                            = $F1
Const VK_OEM_COPY                               = $F2
Const VK_OEM_AUTO                               = $F3
Const VK_OEM_ENLW                               = $F4
Const VK_OEM_BACKTAB                            = $F5
Const VK_ATTN                                   = $F6   ; Attn key
Const VK_CRSEL                                  = $F7   ; CrSel key
Const VK_EXSEL                                  = $F8   ; ExSel key
Const VK_EREOF                                  = $F9   ; Erase EOF key
Const VK_PLAY                                   = $FA   ; Play key
Const VK_ZOOM                                   = $FB   ; Zoom key
Const VK_NONAME                                 = $FC   ; Reserved
Const VK_PA1                                    = $FD   ; PA1 key
Const VK_OEM_CLEAR                              = $FE   ; Clear key

Type Bar
	Field x#, y#, width#, height#
	Field value#, horizontal
	Field Red, Green, Blue
	Field bRed, bGreen, bBlue
	Field bStyle
End Type

Dim tex_memory(0,0)

Global b1value# = 0

Global Bar1 = Create_Bar(GraphicsWidth()/2-250/2, GraphicsHeight()/2, 250, 15, b1value#, 1, 68, 207, 252, 68, 207, 252, 0)

;b2value# = 50
;Bar2 = Create_Bar( 0, 21, GraphicsHeight() - 21, 20, b2value#, 0)

;b3value# = 75
;Bar3 = Create_Bar( GraphicsWidth() - 21, 21, 20, GraphicsHeight() - 21, b3value#, 2)

;Bar4 = Create_Bar( 21, GraphicsHeight() - 21, GraphicsWidth() - 43, 20 , b1value#)

camera = CreateCamera()
CameraRange camera, .01, 10000.0
PositionEntity camera, 0, 1, 0

AmbientLight 255, 255, 255

sky = CreateCube()
EntityColor sky, 102, 102, 255
ScaleEntity sky, 1000, 1000, 1000
EntityOrder sky, 1000
FlipMesh sky

Global ground = CreatePlane()
EntityColor ground, 0, 64, 0

Global bartex = CreateTexture(256, 256)
OptimizeAlphaChannel(bartex)

Global myent = CreateCube()
PositionEntity myent, -10, 1, 10

Global myent2 = CreateCube()
PositionEntity myent2, 10, 1, 10

Global cube888 = CreateCube()

PositionEntity cube888, 0, 1, 10
ScaleEntity cube888, 1, 0.01, 1
RotateEntity cube888, -90, 0, 0

timer = CreateTimer(60)

Global starttime#=MilliSecs() ; Get our start time

;Below is a hack, if you have hex edited runtime.dll to remove the
;terrible black window when a program starts &amp; have user32.decls
;in your userlibs folder in your Blitz3D folder, 
;uncomment the below...

;api_ShowWindow(SystemProperty$("AppHWND"), 1)

Repeat

;	If KeyDown(16) Then b1value# = b1value# - 1 ; Q
;	If KeyDown(17) Then b1value# = b1value# + 1 ; W
;	If KeyDown(30) Then b2value# = b2value# - 1 ; A
;	If KeyDown(44) Then b2value# = b2value# + 1 ; Z
;	If KeyDown(45) Then b3value# = b3value# - 1 ; S
;	If KeyDown(31) Then b3value# = b3value# + 1 ; X

	b1value# = b1value# + 1
	
;	If b1value# &gt; 100 Then b1value# = 100
;	If b1value# = 100 And Then Delete_Bar(Bar1)

	If ob1value# &lt;&gt; b1value# Then
		b1value# = Update_BarValue( Bar1, b1value# )
		;Update_BarValue( Bar4, b1value# )
		ob1value# = b1value#
	EndIf
	
;	If ob2value# &lt;&gt; b2value# Then
;		b2value# = Update_BarValue( Bar2, b2value# )
;		ob2value# = b2value#
;	EndIf
	
;	If ob3value# &lt;&gt; b3value# Then
;		b3value# = Update_BarValue( Bar3, b3value# )
;		ob3value# = b3value#
;	EndIf
	
;	WaitTimer( timer )

	Control_Entity(camera, 0.1, 0.4, 1.0, 2.0)

	UpdateWorld
	RenderWorld

	Render_Bar( 4500, "Loading File Data: "+finame$ )
	
	Color 255, 255, 255

;	Text 100, 100, "Press QW for horizontal  | Value= " + b1value#
;	Text 100, 120, "Press AZ for vertical 1  | Value= " + b2value#
;	Text 100, 140, "Press SX for vertical 2  | Value= " + b3value#
	
	VWait 1
	Flip 0
	Delay 1

Until KeyHit(1)

End

Function Create_Bar( x#, y#, width# = 100, height# = 20, value# = 100, horizontal = 1, Red = 0, Green = 255, Blue = 0, bRed = 255, bGreen = 255, bBlue = 255, bStyle = 0 )
	Bar.Bar = New Bar
		Bar\x# = x#
		Bar\y# = y#
		Bar\width# = width#
		Bar\height# = height#
			If value# &lt;= 0 Then value# = 0
			If value# &gt;= 100 Then value# = 100
		Bar\value# = value# : Bar\horizontal = horizontal
		Bar\Red = Red : Bar\Green = Green : Bar\Blue = Blue
		Bar\bRed = bRed : Bar\bGreen = bGreen : Bar\bBlue = bBlue
		Bar\bStyle = bStyle
	Return Handle( Bar )
End Function

Function Delete_Bar( ID )
	Bar.Bar = Object.Bar( ID )
	If Bar.Bar &lt;&gt; Null Then
		Delete Bar
	EndIf
End Function

Function Render_Bar(timetolive# = 2500.0, get_current_file$="No files to load...")

	If timetolive# &lt; 2500.0 Then timetolive# = 2500.0

	For Bar.Bar = Each Bar
 
		If Bar\horizontal = 0

			percent$ = Int(Bar\value#)+"% / 100%"
			current$ = get_current_file$
		
			If Bar\value# &gt; 0.0 And Bar\value# &lt; 100.0 Then current$ = "..."
			If Bar\value# = 100.0 Then current$ = "Data Saved Successfully!"

			SetBuffer TextureBuffer(bartex)
			
				Color Bar\bRed, Bar\bGreen, Bar\bBlue
				Rect Bar\x#, Bar\y#, Bar\height#, Bar\width#, Bar\bStyle
			
				Color Bar\Red, Bar\Green, Bar\Blue
				Rect Bar\x#+1, Bar\y#+1, Bar\height# - 2, ((Bar\value# * .01) * Bar\width#) - 2
							
				Color 255, 255, 255
				Text Bar\x#+Bar\width#/2-StringWidth(current$)/2, Bar\y#+StringHeight(current)+10, current$
				Text Bar\x#+Bar\width#/2-StringWidth(percent$)/2, Bar\y#+StringHeight(percent)+30, percent$
	
				EntityTexture cube888, bartex

			SetBuffer BackBuffer()
	
		ElseIf Bar\horizontal = 1

			percent$ = Int(Bar\value#)+"% / 100%"
			current$ = get_current_file$
		
			If Bar\value# &gt; 0.0 And Bar\value# &lt; 100.0 Then current$ = "..."
			If Bar\value# = 100.0 Then current$ = "Data Saved Successfully!"

			SetBuffer TextureBuffer(bartex)
		
				Color Bar\bRed, Bar\bGreen, Bar\bBlue
				Rect Bar\x#, Bar\y#, Bar\width#, Bar\height#, Bar\bStyle
		
				Color Bar\Red, Bar\Green, Bar\Blue
				Rect Bar\x#+1, Bar\y#+1, ((Bar\value# * .01) * Bar\width#) - 2, Bar\height# - 2
		
				Color 255, 255, 255
				Text Bar\x#+Bar\width#/2-StringWidth(current$)/2, Bar\y#+StringHeight(current)+10, current$
				Text Bar\x#+Bar\width#/2-StringWidth(percent$)/2, Bar\y#+StringHeight(percent)+30, percent$
	
				EntityTexture cube888, bartex

			SetBuffer BackBuffer()

		ElseIf Bar\horizontal = 2

			percent$ = Int(Bar\value#)+"% / 100%"
			current$ = get_current_file$
		
			If Bar\value# &gt; 0.0 And Bar\value# &lt; 100.0 Then current$ = "..."
			If Bar\value# = 100.0 Then current$ = "Data Saved Successfully!"

			;SetBuffer TextureBuffer(bartex)
		
				Color Bar\bRed, Bar\bGreen, Bar\bBlue
				Rect Bar\x#, Bar\y#, Bar\width#, Bar\height#, Bar\bStyle
		
				Color Bar\Red, Bar\Green, Bar\Blue
		
				tTotal1# = Bar\height# + Bar\y# + 1
				val1# = tTotal1 - ((Bar\value# * .01) * Bar\height#)
				val2# = (tTotal1 - val1#) - 2		
		
				Rect Bar\x#+1, val1#, Bar\width# - 2, val2#
		
				Color 255, 255, 255
				Text Bar\x#+Bar\width#/2-StringWidth(current$)/2, Bar\y#+StringHeight(current)+10, current$
				Text Bar\x#+Bar\width#/2-StringWidth(percent$)/2, Bar\y#+StringHeight(percent)+30, percent$

				EntityTexture cube888, bartex
				
			SetBuffer BackBuffer()
	
		EndIf

	Next
	
	EntityTexture cube888, bartex
	
	If Bar1 Then TimerWait(timetolive#)
	
End Function

Function Update_BarValue( ID, value# )

	Bar.Bar = Object.Bar( ID )

	If Bar.Bar &lt;&gt; Null Then

		If value# &lt;= 0.0 Then value# = 0.0
		If value# &gt;= 100.0 Then value# = 100.0
		Bar\value# = value#
		Return value#

	EndIf

End Function

Function TimerWait#(seconds#)

	If MilliSecs() &lt; starttime#+seconds# ; Loop for the delay# time adjusting our alpha amount toward opacity
	
		newtime#=MilliSecs()
			
	Else
	
		Delete_Bar(Bar1)
		Bar1 = 0
		
		;starttime#=MilliSecs()
		;newtime#=MilliSecs()
		
	EndIf
	
End Function

Function Control_Entity(ent, movespeed#=0.1, double_movespeed#=0.4, turnspeed# = 1.0, double_turnspeed# = 2.0)

	If Not CONTROL()

		If Not SHIFT()
							
			If W_UP() Then MoveEntity ent, 0, 0, movespeed# : entmoved = True
			If S_DOWN() Then MoveEntity ent, 0, 0, -movespeed# : entmoved = True
			If A_LEFT() Then TurnEntity ent, 0, turnspeed#, 0, 1 : entturned = True
			If D_RIGHT() Then TurnEntity ent, 0, -turnspeed#, 0, 1 : entturned = True
													
		Else If SHIFT()
			
			If W_UP() Then MoveEntity ent, 0, 0, double_movespeed# : entmoved = True
			If S_DOWN() Then MoveEntity ent, 0, 0, -double_movespeed# :  entmoved = True
			
			If A_LEFT() Then TurnEntity ent, 0, double_turnspeed#, 0, 1 : entturned = True
			If D_RIGHT() Then TurnEntity ent, 0, -double_turnspeed#, 0, 1 : entturned = True
									
		EndIf
			
	ElseIf CONTROL()
	
		If Not SHIFT()

			entturned = 0
			
			If W_UP() Then MoveEntity ent, 0, movespeed#, 0 : entmoved = True
			If S_DOWN() Then MoveEntity ent, 0, -movespeed#, 0 : entmoved = True
			If A_LEFT() Then MoveEntity ent, -movespeed#, 0, 0 : entmoved = True
			If D_RIGHT() Then MoveEntity ent, movespeed#, 0, 0 : entmoved = True
				
		Else If SHIFT()
		
			entturned = 0
	
			If W_UP() Then MoveEntity ent, 0, double_movespeed#, 0 : entmoved = True
			If S_DOWN() Then MoveEntity ent, 0, -double_movespeed#, 0 : entmoved = True
			If A_LEFT() Then MoveEntity ent, -double_movespeed#, 0, 0 : entmoved = True
			If D_RIGHT() Then MoveEntity ent, double_movespeed#, 0, 0 : entmoved = True
				
		EndIf

	EndIf

End Function

; -------------------------------------------------------------------------------------------------------------------------------------
; This function returns 1 if the specified virtual key is being pressed, and 0 if it is not.
;
; Normally, the function checks to see if your application has focus and ignores any keys being held down if it does not, 
; but if you want it to tell you if a key is pressed regardless of whether your app has focus, you can set IgnoreFocus to True.
; -------------------------------------------------------------------------------------------------------------------------------------
Function GDI_GetAsyncKeyState(VirtualKey, IgnoreFocus=False)

	If (IgnoreFocus = True) And (api_GetActiveWindow() = 0) Then Return
	Return (api_GetAsyncKeyState%(VirtualKey) And %1000000000000000) &gt; 0

End Function

Function KH_ESCAPE()
	Return (KeyHit(1))
End Function

Function KH_A()
	Return (KeyHit(30))
End Function

Function KH_C()
	Return (KeyHit(46))
End Function

Function KH_E()
	Return (KeyHit(18))
End Function

Function KH_H()
	Return (KeyHit(36))
End Function

Function KH_I()
	Return (KeyHit(23))
End Function

Function KH_M()
	Return (KeyHit(50))
End Function

Function KH_N()
	Return (KeyHit(49))
End Function

Function KH_O()
	Return (KeyHit(24))
End Function

Function KH_P()
	Return (KeyHit(26))
End Function

Function KH_Q()
	Return (KeyHit(16))
End Function

Function KH_S()
	Return (KeyHit(31))
End Function

Function KH_X()
	Return (KeyHit(45))
End Function

Function KH_Z()
	Return (KeyHit(44))
End Function

Function KH_UP()
	Return (KeyHit(200))
End Function

Function KH_DOWN()
	Return (KeyHit(208))
End Function

Function KH_LEFT()
	Return (KeyHit(203))
End Function

Function KH_RIGHT()
	Return (KeyHit(205))
End Function

Function KH_SPACE()
	Return (KeyHit(57))
End Function

Function KH_BACKSPACE()
	Return (KeyHit(14))
End Function

Function KH_1()
	Return (KeyHit(2))
End Function

Function KH_2()
	Return (KeyHit(3))
End Function

Function KH_TAB()
	Return (KeyHit(15))
End Function

Function KH_R()
	Return (KeyHit(19))
End Function

Function KH_LEFT_RETURN()
	Return (KeyHit(28))
End Function

Function KH_RIGHT_RETURN()
	Return (KeyHit(156))
End Function

Function CONTROL()
	Return (GDI_GetAsyncKeyState(VK_LEFTCTRL, 1) Or GDI_GetAsyncKeyState(VK_RIGHTCTRL, 1))
End Function

Function SHIFT()
	Return (GDI_GetAsyncKeyState(VK_LEFTSHIFT, 1) Or GDI_GetAsyncKeyState(VK_RIGHTSHIFT, 1))
End Function

Function SPACE()
	Return (GDI_GetAsyncKeyState(VK_SPACE, 1))
End Function

Function CONTROL_SHIFT()
	Return (CONTROL() And SHIFT())
End Function

Function CONTROL_SPACE()
	Return (CONTROL() And SPACE())
End Function

Function CONTROL_SHIFT_SPACE()
	Return (CONTROL_SHIFT() And SPACE())
End Function

Function KD_W()
	Return (GDI_GetAsyncKeyState(VK_W, 1))
End Function

Function KD_UP()
	Return (GDI_GetAsyncKeyState(VK_UP, 1))
End Function

Function KD_S()
	Return (GDI_GetAsyncKeyState(VK_S, 1))
End Function

Function KD_DOWN()
	Return (GDI_GetAsyncKeyState(VK_DOWN, 1))
End Function

Function KD_A()
	Return (GDI_GetAsyncKeyState(VK_A, 1))
End Function

Function KD_LEFT()
	Return (GDI_GetAsyncKeyState(VK_LEFT, 1))
End Function

Function KD_D()
	Return (GDI_GetAsyncKeyState(VK_D, 1))
End Function

Function KD_RIGHT()
	Return (GDI_GetAsyncKeyState(VK_RIGHT, 1))
End Function

Function W_UP()
	Return (KD_W() Or KD_UP())
End Function

Function S_DOWN()
	Return (KD_S() Or KD_DOWN())
End Function

Function A_LEFT()
	Return (KD_A() Or KD_LEFT())
End Function

Function D_RIGHT()
	Return (KD_D() Or KD_RIGHT())
End Function

Function CONTROL_SHIFT_SPACE_UP()
	Return (CONTROL() And SHIFT() And SPACE() And KD_UP())
End Function

Function CONTROL_SHIFT_SPACE_DOWN()
	Return (CONTROL() And SHIFT() And SPACE() And KD_DOWN())
End Function

Function CONTROL_SHIFT_SPACE_LEFT()
	Return (CONTROL() And SHIFT() And SPACE() And KD_LEFT())
End Function

Function CONTROL_SHIFT_SPACE_RIGHT()
	Return (CONTROL() And SHIFT() And SPACE() And KD_RIGHT())
End Function

Function CONTROL_SHIFT_SPACE_RETURN()
	Return (CONTROL() And SHIFT() And SPACE() And KD_RETURN())
End Function

Function CONTROL_SHIFT_UP()
	Return (CONTROL() And SHIFT() And KD_UP())
End Function

Function CONTROL_SHIFT_DOWN()
	Return (CONTROL() And SHIFT() And KD_DOWN())
End Function

Function CONTROL_SHIFT_LEFT()
	Return (CONTROL() And SHIFT() And KD_LEFT())
End Function

Function CONTROL_SHIFT_RIGHT()
	Return (CONTROL() And SHIFT() And KD_RIGHT())
End Function

Function CONTROL_SHIFT_RETURN()
	Return (CONTROL() And SHIFT() And KD_RETURN())
End Function

Function CONTROL_SPACE_UP()
	Return (CONTROL() And SPACE() And KD_UP())
End Function

Function CONTROL_SPACE_DOWN()
	Return (CONTROL() And SPACE() And KD_DOWN())
End Function

Function CONTROL_SPACE_LEFT()
	Return (CONTROL() And SPACE() And KD_LEFT())
End Function

Function CONTROL_SPACE_RIGHT()
	Return (CONTROL() And SPACE() And KD_RIGHT())
End Function

Function CONTROL_SPACE_RETURN()
	Return (CONTROL() And SPACE() And KD_RETURN())
End Function

Function CONTROL_UP()
	Return (CONTROL() And KD_UP())
End Function

Function CONTROL_DOWN()
	Return (CONTROL() And KD_DOWN())
End Function

Function CONTROL_LEFT()
	Return (CONTROL() And KD_LEFT())
End Function

Function CONTROL_RIGHT()
	Return (CONTROL() And KD_RIGHT())
End Function

Function CONTROL_RETURN()
	Return (CONTROL() And KD_RETURN())
End Function

Function KD_X()
	Return (GDI_GetASyncKeyState(VK_X, 1))
End Function

Function KD_RETURN()
	Return (GDI_GetASyncKeyState(VK_RETURN, 1))
End Function

;--------------------------------------------------------------------
;  This function will clear a texture of all it's alpha information |
;--------------------------------------------------------------------
;parameters  =  texture : the texture you wish to clear alpha information from
Function prepare_texture(texture)

	LockBuffer TextureBuffer(texture)

	For loop=0 To TextureWidth(texture)-1
		For loop1=0 To TextureHeight(texture)-1

			RGB1=ReadPixelFast(loop,loop1,TextureBuffer(texture))
			r=(RGB1 And $FF0000)Shr 16;separate out the red
			g=(RGB1 And $FF00) Shr 8;green
			b=RGB1 And $FF;and blue parts of the color
			a=(RGB1 And $FF000000)Shr 24
			
			a=255; remove any alpha information currently in the texture.

			newrgb= (a Shl 24) Or (r Shl 16) Or (g Shl 8) Or b; combine the ARGB back into a number

			WritePixelFast(loop,loop1,newrgb,TextureBuffer(texture)); write the info back to the texture
		Next
	Next

	UnlockBuffer TextureBuffer(texture)

End Function

;---------------------------------------------------------------------
;  This function will mask the passed across RGB of the texture also |
;  passed across. Do NOT pass across a value for flag if you only    |
;  want to mask an exact colour.                                     |
;---------------------------------------------------------------------
;parameters = texture   : the texture you wish to clear alpha information from
;           = r1        : the red value to mask
;           = g1        : the green value to mask
;           = b1        : the blue value to mask
;           = tolerance : the tolerance value. If set to 0, then the function will only mask the
;                         EXACT colours passed across. Higher value will mask values close to the colour.

Function texture_mask_colour(texture,r1,g1,b1,tolerance=0)
	
	LockBuffer TextureBuffer(texture)

	For loop=0 To TextureWidth(texture)-1
		For loop1=0 To TextureHeight(texture)-1
			RGB1=ReadPixelFast(loop,loop1,TextureBuffer(texture)) ; read the RGB value from the texture
			r=(RGB1 And $FF0000)Shr 16;separate out the red
			g=(RGB1 And $FF00) Shr 8;green
			b=RGB1 And $FF;and blue parts of the color
			a=(RGB1 And $FF000000)Shr 24 ; extract the alpha

			If r&gt;=r1-tolerance And r=&lt;r1+tolerance And g=&gt;g1-tolerance And g=&lt;g1+tolerance And b=&gt;b1-tolerance And b=&lt;b1+tolerance Then; check RGB lies with the tolerance
				;temp=((Abs(r-r1)+Abs(g-g1)+Abs(b-b1))/3.0)*4.0 ; alpha the values based on the tolerance value
				a=0;temp

			End If

			newrgb= (a Shl 24) Or (r Shl 16) Or (g Shl 8) Or b ; combine the ARGB back into one value

			WritePixelFast(loop,loop1,newrgb,TextureBuffer(texture)); write back to the texture
		Next
	Next
	UnlockBuffer TextureBuffer(texture)
End Function

Function mask_texture(t, frames = 1, mask_color = 0); ...................................................................... mask_texture
; Drops the alpha of all pixels that match the masking color to 0
	w = TextureWidth(t)
	h = TextureHeight(t)
	For fi = 0 To frames - 1
		buffer = TextureBuffer(t, fi)
		LockBuffer buffer
		For iw = 0 To w - 1
			For ih = 0 To h - 1
				c = ReadPixelFast(iw, ih, buffer) And $FFFFFF 		; Read pixel from texture
				If c = mask_color 									; If Color = mask_color
					WritePixelFast iw, ih, 0, buffer 				; Write transparent black pixel
				Else 												; If color != mask_color
					WritePixelFast iw, ih, c Or $FF000000, buffer 	; Write color and 100% alpha to texture
				End If
			Next
		Next
		UnlockBuffer buffer
	Next 
End Function

Function SetMaskChannel(tex)
 ;this function will set the alpha channel of black pixels to be fully transparent 
 ;(as required by masked textures using flag 4).
 Local w,h,rgb,r,g,b,x,y,x2,y2,count,average_rgb
 w=TextureWidth(tex)
 h=TextureHeight(tex)
 Dim tex_memory(w,h)
 SetBuffer TextureBuffer(tex)
 LockBuffer()
 For y=0 To h-1
  For x=0 To w-1
   rgb=ReadPixelFast(x,y) And $FFFFFF
   If rgb=0 Then
    WritePixelFast x,y,0
   Else
   EndIf
  Next
 Next
 UnlockBuffer()
 SetBuffer BackBuffer()
End Function



Function OptimizeAlphaChannel(tex)
 ;this function will set the alpha channel of black pixels to be fully transparent 
 ;(as required by masked textures using flag 4). Additionally it will paint the RGB of transparent 
 ; pixels with the average neighbour color to prevent black edge bleeding artefacts.
 Local w,h,rgb,r,g,b,x,y,x2,y2,count,average_rgb
 w=TextureWidth(tex)
 h=TextureHeight(tex)
 Dim tex_memory(w,h)
 SetBuffer TextureBuffer(tex)
 LockBuffer()
 For y=0 To h-1
  For x=0 To w-1
   rgb=ReadPixelFast(x,y) And $FFFFFF
   tex_memory(x,y)=rgb
  Next
 Next
 For y=0 To h-1
  For x=0 To w-1
   If tex_memory(x,y)=0
    count=0
    r=0
    g=0
    b=0
    For y2=y-1 To y+1
     For x2=x-1 To x+1
      If (x&lt;&gt;x2 Or y&lt;&gt;y2) And ((x2&gt;=0) And (x2&lt;w) And (y2&gt;=0) And (y2&lt;h)) 
       If tex_memory(x2,y2)&lt;&gt;0
        r=r+ ((tex_memory(x2,y2) And $FF0000) Shr 16)
        g=g+ ((tex_memory(x2,y2) And $FF00)   Shr 8)
        b=b+ ((tex_memory(x2,y2) And $FF))
        count=count+1
       EndIf
      EndIf
     Next
    Next
    If count&gt;0
     r=r/count
     g=g/count
     b=b/count
     average_rgb=(r Shl 16) Or (g Shl 8) Or b
    Else
     average_rgb=0
    EndIf
    WritePixelFast x,y,average_rgb
   EndIf
  Next
 Next
 UnlockBuffer()
 SetBuffer BackBuffer()
 Dim tex_memory(0,0)
End Function</textarea><br><br>Thank You so kindly! :)<br><br>~GF <br><br></td></tr></table><br>
<a name="1238164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Transparency came up recently in another thread: <a href="/posts.php?topic=103041" target="_blank">here</a>.<br><br>I put my code into a function called CreateTestTexture( ). Use that to create the bartex texture to get an idea of how it works.<br><br><pre class=code>Function CreateTestTexture( )

	tex=CreateTexture( 256,256, 1 + 2 + 16 + 32 )  ; color + alpha + clamp u + clamp v
	
	SetBuffer TextureBuffer( tex )
	For x = 0 To 255
		For y = 0 To 255
			WritePixel x, y, (x Shl 24) + $FFFF00  ; alpha=x  R=255 G=255 B=0
		Next
	Next
	
	img = CreateImage( 200, 100 )
	SetBuffer ImageBuffer( img )
	Color 0,0,255
	tempFont = LoadFont( "arial", 80 )
	SetFont tempfont
	Text 0,0, "Hello"
	FreeFont tempfont
	
	imgbuff = ImageBuffer( img )
	texbuff = TextureBuffer( tex )
	For x = 0 To 199
		For y = 0 To 99
			imgpixel = ReadPixel( x, y, imgbuff ) And $FFFFFF  ; just the color data
			If imgpixel &lt;&gt; 0 
				texpixel = ReadPixel( x+50, y+90, texbuff ) And $FF000000  ; just alpha
				WritePixel x+50, y+90, texpixel + imgpixel, texbuff
			End If
		Next
	Next
	SetBuffer BackBuffer()
	FreeImage img
	
	Return tex
	
End Function</pre> <br><br></td></tr></table><br>
<a name="1238165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks ALOT, Floyd! This works PERFECTLY! :)<br><br>~GF <br><br></td></tr></table><br>
<a name="1295950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a way to make this work with any size texture?<br><br>Thanks, guys! :)<br><br>~GF <br><br></td></tr></table><br>
<a name="1296040"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use the width and height parameter of the create texture command. <br><br></td></tr></table><br>
<a name="1296063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> GF at his finest :) <br><br></td></tr></table><br>
<a name="1296088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> RemiD, being a d*** as always. Please leave if you're gonna do nothing but bash people. <br><br></td></tr></table><br>
<a name="1296089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank You, Matty. :)<br><br>~GF <br><br></td></tr></table><br>
<a name="1296109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Related to this topic : <a href="http://www.blitzbasic.com/Community/posts.php?topic=102563" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=102563</a> (post#4) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
