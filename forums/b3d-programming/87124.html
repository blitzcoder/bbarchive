<!DOCTYPE html><html lang="en" ><head ><title >Gnet alternative opinions</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Gnet alternative opinions</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Gnet alternative opinions</a><br><br>
<a name="987441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can I get some honest opinions on this.  I didnt want to use Gnet because I really want servers running full speed without lag spikes contacting the gnet front end.<br><br>So what im doing is this.  I have a php set up that server admins can load up and input the server name, ip, port, ect.  When they submit that it adds the server to a list (plain text atm).  <br><br>The client on startup (and if the user hits refresh) will download the list and display all the servers.  The way im keeping the inactive servers off the list is this: I run a ping bot on my local machine that will download the list, and ping everyone on it every so often. if it cannot contact the server it modifies the list and reuploads it for the clients, if a server cannot be contacted for more than a few days its removed from the list permanently.(server admin can always resubmit the listing)<br><br>This prevents each server from having to contact a database, but still only lists the active servers for the client.  I was thinking I would have the pingbot go through the list once every 20 minutes.<br> <br>What do you think of this approach ? I am open for alternative ideas, or improvements to this one. <br><br>Thanks <br><br></td></tr></table><br>
<a name="987487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mahan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a little side thought about the pings (to see if servers are available): Note that many internet routers don't answer ping. (i.e. they are often configured that way by default in the internal firewall)<br><br>If you write the ping so that it's actually a special package that the game servers respond to with an ACK you achieve two things:<br>1) You know that the actual server software is running on the other end. (and not a router that happens to respond to ping)<br>2) The routers that happen to block ping, must either way be configured to "forward" packages or connections to the internal server from the outside (to be available online) and therefore will always respond to your "custom ping".<br><br>As usual I highly recommend Enet for the networking from Blitz* as I think that it's the best networking solution, but that is just my personal opinion :-) <br><br></td></tr></table><br>
<a name="987489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mahan, <br><br> Thats what I currently do, the ping is actually a packet, the server is set up to reply with current map and player information when it receives the special ping packet.<br><br>I've not used Enet before, I use BlitzPlay Pro right now. <br><br></td></tr></table><br>
<a name="987497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey RifRaf, I incorporated eNet into BlitzPlay, <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2586" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2586</a><br><br>I haven't coded it to work with the update of eNet (even though it still works) but it probably would just take a few seconds/minutes to do. Here's what you would need to change <a href="http://www.blitzbasic.com/Community/posts.php?topic=49076#987012" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=49076#987012</a> <br><br></td></tr></table><br>
<a name="987508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I saw that when you did it, grats on a job well done.  But BplayPro has everything I need right now.  I may look into other network libs when I move over to bmax, or perhaps just convert Bpplay Pro over to that as well , sure wouldnt be hard to do. <br><br></td></tr></table><br>
<a name="987896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Can I get some honest opinions on this. I didnt want to use Gnet because I really want servers running full speed without lag spikes contacting the gnet front end. <br></div><br><br>RifRaf, ETNA was developped exactly in this idea: avoid lag when contacting the server (by mean of thread). And ETNA has a version of gnet which does exactly what you need. Get ETNA (free) from my sig. You can see the modified gnet directly <a href="http://repeatuntil.online.fr/Etna/Etna_lib.html" target="_blank">from this link</a>. <br><br></td></tr></table><br>
<a name="987927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> RepeatUntil,<br><br> Thanks, im afraid for this project im already up to my eyeballs in BlitzPlay Pro, sitting at about 25k lines of code that is deeply dependent on Bplay.    Ill keep my eyes on ETNA for my next project though.<br><br>edit: hm I may have jumped the gun, I thought ETNA was a network comms lib. Ill look into it more, thanks! <br><br></td></tr></table><br>
<a name="987959"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know nothing about php &amp; mysql .  Has anyone written up the steps to get gnet working on another site aside fom bb.com ? <br><br></td></tr></table><br>
<a name="987961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mahan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I'm a bit curious about this too. I have installed mysql numerous times on both *nix and Windows, and I have gotten .PHP to run as a plugin in apache a few times.<br><br>Is this what is required to get ETNA running? <br><br></td></tr></table><br>
<a name="988454"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, RifRaf, ETNA runs perfectly with BlitzPlay!!! This could be ran in parallel, no problem at all. I did that for my game in the past in Blitz3D. <br><br>To test gnet, there is 2 steps: first you use the server from blitzbasic.com to test that this is working. Use the example from the "Gnet" directory in Etna. Just run gnet_test.bb and that should work: check in the gnet tab on this site and you should see your "game".<br><br>Then the second step, if you need it (ie if you need an extended gnet with your own version), is to install the php and the mysql table on your own server. For this, use the files gnet.php and gnet.mysql (that you can find in the same directory in Etna) and install them on your server. I won't explain you how to create a mysql table, but really, this is very simple if you read help about this on the internet. <br><br>There is a little help on this page: <a href="http://repeatuntil.online.fr/Etna/Etna_lib.html" target="_blank">http://repeatuntil.online.fr/Etna/Etna_lib.html</a><br><br>I hope it helps... <br><br></td></tr></table><br>
<a name="988558"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mahan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I won't explain you how to create a mysql table, but really, this is very simple if you read help about this on the internet. <br> <br></div><br><br>Agreed that simply creating a table in MySQL is trivial, but to have a working stack with Webserver, PHP (integrated in the webserver) and MySQL with all the small tweaking in configuration-files to make them working together takes some time if you aren't used to it (even though it can be done in one evening by googling around alot)<br><br>So to clarify my previous question, is this what is needed if you want ETNA running on a home-server?<br><br>In that case I would like to recommend the install-tool XAMPP that help exactly with setting up the Apache-PHP-MySQL stack (+ several other things if needed, that can optionally be added by XAMPP):<br><br><a href="http://www.apachefriends.org/en/xampp.html" target="_blank">http://www.apachefriends.org/en/xampp.html</a><br><br>Also, Rifraf: If you install all this "crap" on your homecomputer, it will install as services/daemons and will (normally) be run all the time when your computer is started. If you want to keep your computer clean you could think about using virtualization (i.e. create a virtual computer inside your actual computer) with these servers installed. That way you can decide for yourself when to start/stop the server and when it's not running your real computer will not be cluttered down with running processes:<br><br>check <a href="http://www.virtualbox.org/" target="_blank">http://www.virtualbox.org/</a> for virtualization of the server,if you're interested. <br><br></td></tr></table><br>
<a name="988582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, <br>ill look into all of this <br><br></td></tr></table><br>
<a name="988828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, for ETNA, you need to have php + mysql on the server (it was already installed by my provider, so that was easy for me!). On my local computer, I have installed easyphp (http://www.easyphp.org/) and this is very simple to install and run. <br><br></td></tr></table><br>
<a name="991652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> RepeatUntil,  -(or anyone else )<br><br>hm.. i cant seem to connect.  Does the database have to have a primary key set ? <br>I created the DB and set it up though an applet my hosting provider has on thier website, using the fields you listed<br><br>database is ttusers, username is ttuser<br>the connection bit is  <br><pre class=code>
//connect
$conn = mysql_connect("localhost","ttuser","&lt;password&gt;") or die("Could not connect : " . mysql_error());
mysql_select_db("ttusers") Or die("Could not select database");
</pre><br><br>a shot of the setup page, i have game set as a primary key. but I have tried it with and without this and it ETNA still reports failure to submit a server in the example bb<br><br><img src="http://www.empowergames.com/phpmyadmin_shot.jpg"><br><br>and this is the entire php unmodified aside from the connection bit added at the end.<br><br>Any ideas what I may be doing wrong?<br><br><pre class=code>
&lt;?php
// Code by Mark Sibly

//Assumes DB already open.




function ping(){
	global $ip;

	echo "$ip\n";
	exit();
}

//return a list of all servers
function list_servers(){

	$res=mysql_query( "select game,server,ip from gnet_servers order by t_time desc" );
	while( $row=mysql_fetch_row($res) ){
		echo( "$row[0]\n" );
		echo( "$row[1]\n" );
		echo( "$row[2]\n" );
	}
	echo "\n";
	exit();
}

//add a server
function add_server(){
	global $ip,$game,$server;

	$err="ERROR\n";
	if( $game ){
		if( !$server ) $server="$game@$ip";
		$res=mysql_query( "select count(*) from gnet_servers where game='$game' and ip='$ip'" );
		$row=mysql_fetch_row( $res );
		if( $row[0]==0 ){
			mysql_query( "insert into gnet_servers (game,server,ip,t_time) values ('$game','$server','$ip',now())" );
			$err="OK\n";
		}
	}
	echo $err;
	exit();
}

//refresh a server
function ref_server(){
	global $ip,$game,$server;

	$err="ERROR\n";
	if( $game ){
		if( !$server ) $server="$game@$ip";
		$res=mysql_query( "select count(*) from gnet_servers where game='$game' and ip='$ip'" );
		$row=mysql_fetch_row( $res );
		if( $row[0]==1 ){
			mysql_query( "update gnet_servers set server='$server',t_time=now() where game='$game' and ip='$ip'" );
			$err="OK\n";
		}
	}
	echo $err;
	exit();
}

//remove a server
function rem_server(){
	global $ip,$game,$server;

	$err="ERROR\n";
	if( $game ){
		if( !$server ) $server="$game@$ip";
		$res=mysql_query( "select count(*) from gnet_servers where game='$game' and ip='$ip'" );
		$row=mysql_fetch_row( $res );
		if( $row[0]==1 ){
			mysql_query( "delete from gnet_servers where game='$game' and ip='$ip'" );
			$err="OK\n";
		}
	}
	echo $err;
	exit();
}
//connect
$conn = mysql_connect("localhost","ttuser","&lt;password&gt;") or die("Could not connect : " . mysql_error());
mysql_select_db("ttusers") Or die("Could not select database");

//setup some useful globals
if ($_SERVER["HTTP_X_FORWARDED_FOR"]) {
	$ip   = $_SERVER["HTTP_X_FORWARDED_FOR"];
} else {
	$ip   = $_SERVER["REMOTE_ADDR"];
}
$opt=array_key_exists("opt",$_GET) ? $_GET["opt"] : "";
$game=array_key_exists("game",$_GET) ? $_GET["game"] : "";
$server=array_key_exists("server",$_GET) ? $_GET["server"] : "";

//delete 'old' servers
mysql_query( "delete from gnet_servers where time_to_sec(now())-time_to_sec(t_time)&gt;300" );

//begin header...(not sure about the no-cache bit!)
header( "content-type: text/html\ncache-control: no-cache\n\n" );

switch( $opt ){
case "add":add_server();break;
case "ref":ref_server();break;
case "rem":rem_server();break;
case "list":list_servers();break;
case "ping":ping();break;
default:echo "ERROR\n";
}


exit();

?&gt;

</pre> <br><br></td></tr></table><br>
<a name="996664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi RifRaf,<br>sorry, just see your message now. Do you still have the problem? This does not related to ETNA. To check this, run the command by hand in your internet browser (eg <a href="http://mysite.com/myscript.php?get=1)" target="_blank">http://mysite.com/myscript.php?get=1)</a> and see if this works. Probably not, you will have to see what is wrong in your php or mysql files. Don't be afraid to put print messages in the php to see where is the problem.... <br><br></td></tr></table><br>
<a name="996760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thaks, loading the php in my IE it runs the final line<br><br><pre class=code>default:echo "ERROR\n";</pre> and simply echos error in the browser. <br><br></td></tr></table><br>
<a name="997224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, could you give us the exact command you ran in IE? Apparently, you forgot to have a "opt" option in your command.<br>In the php, you have:<br>$opt=array_key_exists("opt",$_GET) ? $_GET["opt"] : "";<br><br>and if opt is not provided in the command, then you arrive here:<br>switch( $opt ){<br>...<br>default:echo "ERROR\n";<br>}<br><br>So this error has nothing to do with ETNA or even mySQL. You should make this work first, check your command... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
