<!DOCTYPE html><html lang="en" ><head ><title >Tips for rendering large number of actors?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Tips for rendering large number of actors?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Tips for rendering large number of actors?</a><br><br>
<a name="415921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone here have experience rendering large numbers (30+)  of boned, animated actors?  There are a number of factors I can think of that might be possible to optimize.<br><br>First, updating animations with UpdateWorld() is a bad idea, because you only need to do it before a render.  I go from 60 to 30 fps just by animating 20 soldiers and not even rendering them.<br><br>Second, since I have no idea how bones actually work internally, I think it's best to use your own bones, updated right before the RenderWorld().<br><br>Finally, you can gain some speed by rendering each actor in a separate pass.  My guess is this bypasses an expensive z-ordering routine. <br><br></td></tr></table><br>
<a name="415940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> TFormpoint is too slow for this.  30000 calls per render just doesn't work, and that is probably the approximate amount you would need for 32 players at different LOD levels.  Is Blitz's internal bone routine any faster than this? <br><br></td></tr></table><br>
<a name="416044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, rendering say 20 actors all together, is actually slower than say 20 passes? That's quite interesting... :o) <br><br></td></tr></table><br>
<a name="416051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> does using hideentity offscreen speed things up? the additional call to hideentity might make blitz skip processing bones. <br><br></td></tr></table><br>
<a name="416053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> "First, updating animations with UpdateWorld() is a bad idea, because you only need to do it before a render."<br><br>Yes it is an awful idea to use updateworld for updating models so they will properly detect polygon collisions and mesh intersections.  Because updateworld was clearly intended to only be run every time renderworld is called.  That is why they are the same command.<br><br>Oops, wait, they're not!  You can call updateworld as many or as few times as you want before a renderworld.  You just can't seperate the bone updates from the rest of the physics, because they're rather important in detecting collisions.<br><br>If you don't want a solider to be animated and take part in collisions, then he is most likely off the screen and far from the camera, where you should manually cull him with hideentity, which will avoid the update during updateworld. <br><br></td></tr></table><br>
<a name="416065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Didn't I just say that? <br><br></td></tr></table><br>
<a name="416094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Braincell</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol<br><br>I'm beginning to be glad i'm not into FPS stuff... :) Blitz has its own internal engine for it all and writing/using your own stuff must be slow. Its just something that makes sence kinda, so maybe such FPS games are best made in VC++ itself. I made basic stuff with bones so far, just to test it, and I'd use the internal stuff. <br><br>And I'm not sure i get this right, but maybe if you used preanimated meshes (where suitable) instead of bones to animate them, you wouldnt need soo much processing during the game. You could also use a trick and mix both perhaps?<br><br>:) <br><br></td></tr></table><br>
<a name="416111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> " Didn't I just say that? "<br><br>Clearly not, because I used seven sentances and you only used two; and without any capitalization I might add! <br><br></td></tr></table><br>
<a name="416122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ladies, please... <br><br></td></tr></table><br>
<a name="416208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, hideentity prevents the animations to be updated. But you should test if the animationTime is frozen or reset trough the hidden state. <br><br></td></tr></table><br>
<a name="416230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't do a whole lot of mesh intersections tests during a game loop.  I do 0.<br><br>I was just wondering if anyone who was not talking out of their ass had experience with this kind of thing, and new what the real issues were.<br><br>Yes, rendering 20 meshes in separate passes is slightly faster than rendering 20 meshes in one pass, presumably because they aren't z-ordered.  (This only causes a problem with alpha surfaces, so I render all transparent objects in one final pass.) <br><br></td></tr></table><br>
<a name="416235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, Blitz doesn't seem capable of producing more than 25 - 30 animated characters at once.  My advice would be o use one entity and then for others off in the distance make a render of it's animation or make a render of all the ones in the same animation pose and make sprites if they are far away.  You also might just want to use LOD so you're only transforming a few verts.  As it stands now though you can't have many animated meshes especially using the Animate command.  I think I found a big speed burst by manually updating the animation too. <br><br></td></tr></table><br>
<a name="416410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gpete</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just used 200 Psionic ants and when they were all in view animating, I was getting 18 fps. When I closed in to view one ant animating at the end of the formation, I got 47 fps. Both times I had a particule emitter running, a "rogue" ant chasing me around the plane,and a 800 unit sky sphere rotating. I would say the key is if the entity's are in view. <br><br></td></tr></table><br>
<a name="416435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> In my case, it is the render updates that kill speed.  I get 20-30 FPS with 30 soldiers with bones on and animation disabled, but enabling animation kills the framerate:<br><br><img src="http://www.leadwerks.com/post/screenshot0038.png"><br><br>It looks like I can get the animation speed within an acceptable range.  But if we can render 30 soldiers with an expensive routine, why not use vertex interpolation and double the number of soldiers we can use?<br><br>After a few more test, the slowest step actually seems to be changing the vertex coords command.  This takes more power than the TForm calculations. <br><br></td></tr></table><br>
<a name="416462"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is the best I can do.  30 actors at 30 FPS.  These are only 666 polygons each, or else I would think it acceptable.  As you can see, the models are rendered in 5 msecs, but it takes 10 msecs to update them all.<br><br>I still don't know if Blitz bones are inheritly any faster than Tforming and updating vertex coords.  Can someone official comment on this?<br><br><img src="http://www.leadwerks.com/post/screenshot0044.jpg"> <br><br></td></tr></table><br>
<a name="416480"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried Psionic's dwarf model, and was render 150,000 animated poys at 40 fps.  I am going to look into the skeleton hierarchy and see why mine are so slow. <br><br></td></tr></table><br>
<a name="416493"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> These are only 666 polygons each <br></div>There is your problem... <br><br></td></tr></table><br>
<a name="416500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...anyone else notice the 666?! <br><br></td></tr></table><br>
<a name="416522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, i can get away with adjusting around 2000 odd particles in a single surface system. Each particle has 4 vertices and there constantly being changed, so you might be faster just doing that. <br><br></td></tr></table><br>
<a name="416645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good for you. I am dealing with like 20,000 vertices, plus normals.<br><br>It looks like bones actually use DX skin meshes, so it is inheritly faster to use a boned b3d than to update them yourself.  My guess is they really do only get updated before the render.<br><br>In my case, the excess entities in the skeletal hierarchy seem to be dragging down animation speed and rendering.  I have about 3 times as many joints as I actually need.  I am going to eliminate all hierarchy redundancies and see what happens. <br><br></td></tr></table><br>
<a name="416654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I have about 3 times as many joints as I actually need. <br></div><br><br>Weeeell... :) Bones are fast (DX ones at least, rendered with good HW), but we still try to keep the bone count to absolute minimum at work because they can be costly fast if you have too many bones - and this gets multiplied with the amount of characters on screen simultaneously. Reducing 5 bones from a rig is 100 bones less if you have 20 characters on screen. <br><br></td></tr></table><br>
<a name="416655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Good for you.<br> <br></div><br><br>Yes, it is. <br><br></td></tr></table><br>
<a name="416659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Which then begs the question, would single-surface particle systems run faster with a boned mesh?  I know my particles start taking a hit once I get about 6000 updating. <br><br></td></tr></table><br>
<a name="416779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was the skeleton redundancies that were slowing it down.  Look:<br><br><img src="http://www.leadwerks.com/post/actors.jpg"><br><br>I also gain about 8 fps by eliminating the hand bones, even though no verts are attached to them.  You should use a low-res skeleton as well as mesh, for distant objects!  Fortunately, I can eliminate bones, even spine segments, and use the same animations.  Your distant skeletons can consist of just a few bones, while your immediate skeletons have separate hand, feet, and full spine bones. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
