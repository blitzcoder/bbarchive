<!DOCTYPE html><html lang="en" ><head ><title >Keydown, and lost window focus</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Keydown, and lost window focus</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Keydown, and lost window focus</a><br><br>
<a name="966132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im running into an odd thing.   The player can use a joystick or keys to move a tank..  In windowed mode if the player is holding a direction .. say the up arrow key to move forward, and at the same time clicks off of the window to the desktop or another window.  The game believes the user is still holding the arrow key, in fact even when you click back onto the games window the application is confused and nomatter what other keys you press it still thinks the up arrow is also pressed.  The only way to fix it is to tap the up arrow again, sometimes more than once.  <br><br>I have tried detecting when the window looses focus and flushing the keys, but that doesnt work.  Ive tried flushing the keys on focus return as well but it doesnt do anything either(even if it did, that wouldnt fix the problem of the tank moving while the window is not in focus)<br><br><br>Anyone else ran into this, and if so did you find a solution.  Im at a point where I may just remove windowed mode as an option. <br><br></td></tr></table><br>
<a name="966138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GIB3D</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wouldn't worry about it too much. It happens in commercial games too. Like Half-Life 2, and um... other games I can't remember atm. I'd include Garry's Mod but that uses the Half-Life 2 engine so.. yea.. <br><br></td></tr></table><br>
<a name="966553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could use GetASyncKeyState instead. It will also detect keyup/down when the window has no focus. Maybe this archive entry helps:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1319" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1319</a> <br><br></td></tr></table><br>
<a name="966617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks warner, ill check that out <br><br></td></tr></table><br>
<a name="966663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason that this occurs is that the window never receives a KeyUp Event for that specific key. In order for it to get a KeyUp message, you'll need to press the key again when the window has focus.<br>I suppose that internally, it works somewhat like this:<br><pre class=code>
Dim keydown[255]

Function OnKeyUp(key:Int)
   keydown[int] = True
End Function

Function OnKeyDown(key:Int)
   keydown[int] = False
End Function
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
