<!DOCTYPE html><html lang="en" ><head ><title >Lighting with Multi-Texturing</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Lighting with Multi-Texturing</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Lighting with Multi-Texturing</a><br><br>
<a name="297580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >inneractive</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay I have a 3D tile terrain engine using multi-textured tiles consisting of a base texture, and alpha - noblend texture.<br><br>;----------<br>	ClearTextureFilters<br><br>	; base texture using UVW coord set 0<br>	BFL_TERRAIN\base = LoadTexture(baseTex, 57)<br>	TextureCoords BFL_TERRAIN\base, 0<br><br>	; blend texture using UVW coord set 1<br>	BFL_TERRAIN\blend = LoadTexture(blendTex, 59)<br>	TextureCoords BFL_TERRAIN\blend, 1		<br>	TextureBlend BFL_TERRAIN\blend, 1		<br>;---------- <br><br>I add these textures to a surface using a brush.<br><br>;----------<br>BFL_TERRAIN\brush = CreateBrush()<br>	<br>BrushTexture BFL_TERRAIN\brush, BFL_TERRAIN\base, 0, 0<br>BrushTexture BFL_TERRAIN\brush, BFL_TERRAIN\blend, 0, 1<br>PaintSurface BFL_TERRAIN\surface, BFL_TERRAIN\brush<br>;----------<br><br>When I turn off the ambientlight<br>AmbientLight 0,0,0<br><br>my blend texture (flagged alpha) is still clearly visible, while the base texture is blacked out. Is this because I have TextureBlend set to 1? This is needed for alpha multi-texturing.<br><br>If this is the case then does anybody know a workaround so I can use the AmbientLight settings to ajust light on my levels while still using textures flagged alpha? <br><br></td></tr></table><br>
<a name="297582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dont remember what I did to solve this stuff... try putting the alpha texture UNDER your base texture in the "0 layer". <br><br></td></tr></table><br>
<a name="297584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >inneractive</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, it didn't work. I set my alpha texture to index 0 and my non-alpha texture to index 1. Made it look like the alpha was set to multiply. One interesting thing though, my framerate jumped from 367 to 398...<br><br>Thanks though. I'll keep playing around with the settings. <br><br></td></tr></table><br>
<a name="297594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >inneractive</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess I can use BrushAlpha to fake it, but then my other lights won't effect the brush. I'll probably just go with vertex alpha or colors and some kind of manual lighting system.... was hoping I could avoid the extra work ;p <br><br></td></tr></table><br>
<a name="297597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> What you're trying to do won't work.<br><br>What you WANT to do is set layer 1 to your base texture and have that be affected by the color/lighting below it.  So you leave that at the default multiply blend mode, which makes it look like a lit texture.<br><br>But then you also want to alpha blend a second texture with the first, and have that affected by lighting.  To do that you're trying to put it on layer 2 and set some blending mode to make it work.  But that can never work.<br><br>Ignoring the fact that you may not even be able to set a texture to both multiply AND add blend, the idea of multiplying a second texture with the first to make it appear lit is mistaken.<br><br>What you really need to do is have two surfaces.  With two surfaces you can do a lot of things that you can't do with basic multitexturing.  There's a number of ways that you could set things up with two surfaces to achieve what you want.<br><br>One way would be to have the first surface be your base texture, and have the second surface be the alpha.  BOTH surfaces will be lit, so BOTH surfaces will have properly lit textures.  The alpha map then blends the LIT second layer with the first lit layer with varying levels of transparency.  <br><br>This gives the correct result, whereas multiplying two textures together, and then lighting the end result by using multitexturing would give you really dark textures that don't look like they're blended together.<br><br>Another thing you could do would be to place both textures on the first layer, but with lighting disabled, using the alpha to blend them together, and then on the second surface have lighting eneabled, with no texture, but set that surface to multiply blend with the first.  Then the textures which have been blended will be darkened where apprpriate.  This method however will not allow you to have overbrightened areas as would be caused if you had shininess enabled to create specular highlights.  However, when Blitz gets 2x multiply blending, then that problem will be solved because you can use that and then get really nice looking vertex based lighting that you may not be able to get with the first method I described.  This method may have problems handling fog though, whereas the first method should handle fog.<br><br>Using two surfaces also allows you to use vertex alpha instead of an alpha map, which allows you to create effects you might not be able to do with an alpha map. <br><br></td></tr></table><br>
<a name="297604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >inneractive</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh jeez, I just tested it out in the 2 surface tiled terrain lib I started making first and you are right!<br><br>...and after all that work converting it into a single surface multi-textured tiled terrain lib. Just as I was putting in my camera and lighting functions I noticed the problem. Oh well, the 2 surface lib runs almost as fast. I guess I was taking the single-surface concept a bit too far.<br><br>Thanks for the help! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
