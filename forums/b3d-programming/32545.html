<!DOCTYPE html><html lang="en" ><head ><title >Depth of Field</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Depth of Field</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Depth of Field</a><br><br>
<a name="349010"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Akat</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> anyone know how to do an effect like depth of field view <br><br></td></tr></table><br>
<a name="349013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Zombie apocalypse 3 has depth of field.<br><br>Basically, you grab the portion to blur to a textured quad, then render it say 8 times, alphaed in slightly differant positions, the more you jiggle(Constant, never random) the more blurry it appears.<br><br>It's far from easy.. <br><br></td></tr></table><br>
<a name="349017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Umm, the overall effect that is, not just blurring it..that part is easy. <br><br></td></tr></table><br>
<a name="349060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want to see this thing in a demo (not a b3d demo I hasten to add) then go here and get the shader demo its 3MB but worth every bit.<br><br><a href="http://www.virtools.com/applications/technology-effects.asp" target="_blank">http://www.virtools.com/applications/technology-effects.asp</a><br><br>Play with this to see depth of field, blur, hair, fur, light, toon shading and alsorts it is very very good.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="349097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> i wish Blitz could do that all :) <br><br></td></tr></table><br>
<a name="349100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> So does Mark.;) (Probably!) <br><br></td></tr></table><br>
<a name="349114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HNPhan</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> well good thing is that most of the effects we can do <br><br></td></tr></table><br>
<a name="349209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was referring to programming shaders :-)<br>I hope Blitzmax will be able to let us program shaders, or perhaps follow a standard. I found out that Microsoft has it's own shader language for DirectX.... <br><br></td></tr></table><br>
<a name="349283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's many ways to do depth of feild.  One is to pivot the camera around your focal point and re-render the scene a bunch of times.  That is much too expensive for realtime use though.<br><br>Another method was recently outlined in Game Developer Magazine.  I won't go into details on it because you can't use that method either but it looks like it might be something implemented in the future on 3D cards and it looks fast.  Maybe it can be implemented with pixel shaders, I'm not sure.  But there's no pixel shaders in Blitz.<br><br>There is one method you might be able to use.  Something like whatever Otacon was hinting at.  But it may not give you perfect results.<br><br>In the code archives I put a hardware blurring function.  You should grab that.<br><br>Now, all you need to do is take your camera range, and divide it up into X regions of depth.  Then you render each region of depth, and blur the resulting image more and more for more distant regions.<br><br>Ie, if your camera has a range of 1-256, then render the following ranges, using the amount of blur in parentheses:<br>1-2     (1)<br>2-4     (2)<br>4-8     (4)<br>8-16    (8)<br>16-32   (16)<br>32-64   (32)<br>64-128  (64)<br>128-256 (128)<br><br>I don't mean to imply that you need to render 8 times.  You could do just four.  The important thing to note is how the distance covered by each step doubles each time.  The number in the parentheses represents how many pixels are sampled for each pixel in the final image.  So 1 means no blurring.   Each pixel represents one pixel of the blurred image.  4 means that each pixel is the average of a 4x4 pixel region.  It might be easier though to imagine that the first leve you sample just the pixel, and the second level you sample one pixel to the left, right top bottom, and the diagonals... a 3x3 pixel area.... then a 5x5 pixel are etc.<br><br>But that depends on how you do the blurring.  One way to do the blurring is simply to scale the image down.  That is probably the fastest way, but the quality of the blur will not be vey good.  You know what a low res texture looks like when scaled up?  How it has lines running through it and looks liek blurry blocks?  That's how that would look.<br><br>My blurring function does a higher quality blur, but it's still not without artifacts of it's own.  The artifacts are more pleasing visually though.  <br><br>Once you have rendered each plane, you need to stick them back togehter in the scene.  Unfortuinately, this is the hard part, and I'm not sure how to go about doing it.<br><br>Then again, maybe I have an idea... and it might actually make the blurring easier.<br><br>It occurs to me that one could render the most distant region to a small portion of the screen, and then grab that, and copy it to a texture.  Then one would use entityorder to render this textured quad, stetched to fill the camera view, behind everything else in the scene when rendering the next region. <br><br></td></tr></table><br>
<a name="349288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Continuation fo the above... (justin case my PC crashes cause it did the first time I wrote this)<br><br>So let's say you want to render four pass depth of feild.<br><br>Your depths are as follows:<br><br>1-64<br>64-128<br>128-256<br>256-512<br><br>Now let's assume our display is 1024x768.<br><br>For speed reasons we're going to take a shortcut and render the most distant regions to a smaller camera view.  But you could instead blur the full size image.  However, that is unlikely to be fast enough for realtime use.  Even this method is probably pushing it with 1024x768 res.<br><br>So we render the first layer.  The mist distant layer.  <br><br>Set the camera range to 256, 512.  (You'll have to correct the fog since the near and far planes are different.  I'll leave that as an excerise for the reader)  Your sky should be visible in this first pass.<br><br>Now, render the view to a 128x96 viewport.  Copy to a texture.  Do not blur.  There is no need to.<br><br>Next create a quad in front of the camera filling the camera view, and texture it with our new texture.  Check out my distant object rendering code in the code archives for an example of how to do this.  Set it's entityorder so it renders before everything else.<br><br>Now, render your view again.  But this time render a 256x192 image.  You will now have a texture that has blurry stuff behind it and stuff that's in focus in front of it.<br><br>Repeat this process, doubling the camera view size each time until you get to 1024x768, and changing the camera's range each time to those values I listed above.  The distance between the near and far camera planes should be half that which it was the previous time each time you render.<br><br>On the last full-screen pass you don't need to copy to a texture.  Just flip so the player can see the final scene.  Objects will get blurrier as they recceed into the distance.<br><br>Don't ask me how to do Depth of Feild which can vary and make stuff up close blurry and stuff in the distance sharp, that's up to you to figure out. :-)  I'm sure it's not nearly as easy though. <br><br></td></tr></table><br>
<a name="349368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Check out the Splinter Cell: Pandora Tomorrow multiplayer demo (60 meg), the spies night vision uses DOF, looks real nice.<br><br><img src="http://www.tomspeed.com/scptdof.jpg"><br><br>Tom <br><br></td></tr></table><br>
<a name="349379"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> It may look nice, but personally, I'd only ever use DOF to blur VERY distant objects, to simulate natural atmospheric scattering and heat shimmer, during gameplay.<br><br>But for cutscenes it's nice.<br><br>The problem with DOF during gameplay is that DOF is like lens flare.  It's something a camera has, not your eyes.  <br><br>Technically, your eyes have DOF.  But your eyes focus on whatever it is you want to look at.  DOF in a game does not.  If I look down that hall, it looks blurry cause the camera's focusing up close.  That's annoying and unrealistic.  It just makes the screenshots prettier, but it makes the game unpleasant to play. <br><br></td></tr></table><br>
<a name="349396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Swift, you only get dof in splinter cell when you're using the night vison camera.(others being heat vison, electromagnetic and motion sensitive...really great game.) <br><br></td></tr></table><br>
<a name="349410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> It looks more like the player is near sighted. <br>Depth of field is a camera trick like lense flare. It<br>looks great in photographs or nature movies but for<br>a 3D interactive environment I don't think it's worth<br>doing unless it is part of the gameplay.<br><br>Depth of field is basicly focus. Your object of focus<br>is the only thing that is in focus. It helps attract<br>the eye to the subject that is being photographed making<br>it more detailed. forground objects are blurred as well as<br>background objects.<br><br>This table <br>1-2 (1) <br>2-4 (2) <br>4-8 (4) <br>8-16 (8) <br>16-32 (16) <br>32-64 (32) <br>64-128 (64) <br>128-256 (128) <br> <br>shoudl look more like this if your point of focus is at 4-8<br>1-2 (16) <br>2-4 (8) <br>4-8 (1) <br>8-16 (8) <br>16-32 (16) <br>32-64 (32) <br>64-128 (64) <br>128-256 (128) <br><br>The technique would work great for a bird watching game where you are trying to find a rare bird with a pair of binoculars or a deer hunter game where you have to adjust your scope. A photographer game would also work well.<br>Other than that in a 3D environment such as an fps you never<br>know what the player is focused on so you end up with the <br>player view looking like it needs an optometrist. One way it could be used in an fps is to indicate a switch or an<br>object that a player should interact with as if the player's<br>vision is focused on the object. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
