<!DOCTYPE html><html lang="en" ><head ><title >New MeshWidth() comand</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >New MeshWidth() comand</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >New MeshWidth() comand</a><br><br>
<a name="387757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This adds a global parameter!  :D<br><br><pre class=code>Function MeshWidth#(mesh,globl=False)
start=True
For s=1 To CountSurfaces(mesh)
	surf=GetSurface(mesh,s)
	For v=0 To CountVertices(surf)-1
		x#=VertexX(surf,v)
		y#=VertexY(surf,v)
		z#=VertexZ(surf,v)
		If globl
			TFormPoint x,y,z,mesh,0
			x=TFormedX()
			y=TFormedY()
			z=TFormedZ()
			EndIf
		If x&lt;minx# Or start=True minx=x
		If y&lt;miny# Or start=True miny=y
		If z&lt;minz# Or start=True minz=z
		If x&gt;maxx# Or start=True maxx=x
		If y&gt;maxy# Or start=True maxy=y
		If z&gt;maxz# Or start=True maxz=z
		start=False
		Next
	Next
w#=maxx-minx
h#=maxy-miny
d#=maxz-minz
Return w
End Function

Function MeshHeight#(mesh,globl=False)
start=True
For s=1 To CountSurfaces(mesh)
	surf=GetSurface(mesh,s)
	For v=0 To CountVertices(surf)-1
		x#=VertexX(surf,v)
		y#=VertexY(surf,v)
		z#=VertexZ(surf,v)
		If globl
			TFormPoint x,y,z,mesh,0
			x=TFormedX()
			y=TFormedY()
			z=TFormedZ()
			EndIf
		If x&lt;minx# Or start=True minx=x
		If y&lt;miny# Or start=True miny=y
		If z&lt;minz# Or start=True minz=z
		If x&gt;maxx# Or start=True maxx=x
		If y&gt;maxy# Or start=True maxy=y
		If z&gt;maxz# Or start=True maxz=z
		start=False
		Next
	Next
w#=maxx-minx
h#=maxy-miny
d#=maxz-minz
Return h
End Function

Function MeshDepth#(mesh,globl=False)
start=True
For s=1 To CountSurfaces(mesh)
	surf=GetSurface(mesh,s)
	For v=0 To CountVertices(surf)-1
		x#=VertexX(surf,v)
		y#=VertexY(surf,v)
		z#=VertexZ(surf,v)
		If globl
			TFormPoint x,y,z,mesh,0
			x=TFormedX()
			y=TFormedY()
			z=TFormedZ()
			EndIf
		If x&lt;minx# Or start=True minx=x
		If y&lt;miny# Or start=True miny=y
		If z&lt;minz# Or start=True minz=z
		If x&gt;maxx# Or start=True maxx=x
		If y&gt;maxy# Or start=True maxy=y
		If z&gt;maxz# Or start=True maxz=z
		start=False
		Next
	Next
w#=maxx-minx
h#=maxy-miny
d#=maxz-minz
Return d
End Function</pre> <br><br></td></tr></table><br>
<a name="387776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Josh,<br><br>Thanks - you rock!<br><br>IPete2. <br><br></td></tr></table><br>
<a name="387796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xmlspy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is very neat, I will definitly use this one. <br><br></td></tr></table><br>
<a name="387844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a better version.  This is recursive, and skips non-mesh entities.  It also includes commands to return a mesh's extents on each axis:<br><br><pre class=code>Function MeshWidth#(mesh,globl=False,recursive=False)
min#=meshminx(mesh,globl,recursive)
max#=meshmaxx(mesh,globl,recursive)
Return (max-min)/2.0+min
End Function

Function MeshHeight#(mesh,globl=False,recursive=False)
min#=meshminy(mesh,globl,recursive)
max#=meshmaxy(mesh,globl,recursive)
Return (max-min)/2.0+min
End Function

Function MeshDepth#(mesh,globl=False,recursive=False)
min#=meshminz(mesh,globl,recursive)
max#=meshmaxz(mesh,globl,recursive)
Return (max-min)/2.0+min
End Function

Function MeshMaxX#(m,globl=False,recursive=False)
start=True
If EntityClass(m)="Mesh"
	For s=1 To CountSurfaces(m)
		surf=GetSurface(m,s)
		For v=0 To CountVertices(surf)-1
			x#=VertexX(surf,v)
			y#=VertexY(surf,v)
			z#=VertexZ(surf,v)
			If globl
				TFormPoint(x,y,z,m,0)
				x=TFormedX()
				y=TFormedY()
				z=TFormedZ()
				EndIf
			If x&gt;maxx# Or start=True maxx=x
			start=False
			Next
		Next
	EndIf
If recursive
	For c=1 To CountChildren(m)
		x=meshmaxx#(GetChild(m,c),globl,True)
		If x&gt;maxx# Or start=True maxx=x
		start=False
		Next
	EndIf
Return maxx
End Function

Function MeshMinX#(m,globl=False,recursive=False)
start=True
If EntityClass(m)="Mesh"
	For s=1 To CountSurfaces(m)
		surf=GetSurface(m,s)
		For v=0 To CountVertices(surf)-1
			x#=VertexX(surf,v)
			y#=VertexY(surf,v)
			z#=VertexZ(surf,v)
			If globl
				TFormPoint(x,y,z,m,0)
				x=TFormedX()
				y=TFormedY()
				z=TFormedZ()
				EndIf
			If x&lt;minx# Or start=True minx=x
			start=False
			Next
		Next
	EndIf
If recursive
	For c=1 To CountChildren(m)
		x=meshminx#(GetChild(m,c),globl,True)
		If x&lt;minx# Or start=True minx=x
		start=False
		Next
	EndIf
Return minx
End Function

Function MeshMaxY#(m,globl=False,recursive=False)
start=True
If EntityClass(m)="Mesh"
	For s=1 To CountSurfaces(m)
		surf=GetSurface(m,s)
		For v=0 To CountVertices(surf)-1
			x#=VertexX(surf,v)
			y#=VertexY(surf,v)
			z#=VertexZ(surf,v)
			If globl
				TFormPoint(x,y,z,m,0)
				x=TFormedX()
				y=TFormedY()
				z=TFormedZ()
				EndIf
			If y&gt;maxy# Or start=True maxy=y
			start=False
			Next
		Next
	EndIf
If recursive
	For c=1 To CountChildren(m)
		y=meshmaxy#(GetChild(m,c),globl,True)
		If y&gt;maxy# Or start=True maxy=y
		start=False
		Next
	EndIf
Return maxy
End Function

Function MeshMinY#(m,globl=False,recursive=False)
start=True
If EntityClass(m)="Mesh"
	For s=1 To CountSurfaces(m)
		surf=GetSurface(m,s)
		For v=0 To CountVertices(surf)-1
			x#=VertexX(surf,v)
			y#=VertexY(surf,v)
			z#=VertexZ(surf,v)
			If globl
				TFormPoint(x,y,z,m,0)
				x=TFormedX()
				y=TFormedY()
				z=TFormedZ()
				EndIf
			If y&lt;miny# Or start=True miny=y
			start=False
			Next
		Next
	EndIf
If recursive
	For c=1 To CountChildren(m)
		y=meshminy#(GetChild(m,c),globl,True)
		If y&lt;miny# Or start=True miny=y
		start=False
		Next
	EndIf
Return miny
End Function

Function MeshMaxZ#(m,globl=False,recursive=False)
start=True
If EntityClass(m)="Mesh"
	For s=1 To CountSurfaces(m)
		surf=GetSurface(m,s)
		For v=0 To CountVertices(surf)-1
			x#=VertexX(surf,v)
			y#=VertexY(surf,v)
			z#=VertexZ(surf,v)
			If globl
				TFormPoint(x,y,z,m,0)
				x=TFormedX()
				y=TFormedY()
				z=TFormedZ()
				EndIf
			If z&gt;maxz# Or start=True maxz=z
			start=False
			Next
		Next
	EndIf
If recursive
	For c=1 To CountChildren(m)
		z=meshmaxz#(GetChild(m,c),globl,True)
		If z&gt;maxz# Or start=True maxz=z
		start=False
		Next
	EndIf
Return maxz
End Function

Function MeshMinZ#(m,globl=False,recursive=False)
start=True
If EntityClass(m)="Mesh"
	For s=1 To CountSurfaces(m)
		surf=GetSurface(m,s)
		For v=0 To CountVertices(surf)-1
			x#=VertexX(surf,v)
			y#=VertexY(surf,v)
			z#=VertexZ(surf,v)
			If globl
				TFormPoint(x,y,z,m,0)
				x=TFormedX()
				y=TFormedY()
				z=TFormedZ()
				EndIf
			If z&lt;minz# Or start=True minz=z
			start=False
			Next
		Next
	EndIf
If recursive
	For c=1 To CountChildren(m)
		z=meshminz#(GetChild(m,c),globl,True)
		If z&lt;minz# Or start=True minz=z
		start=False
		Next
	EndIf
Return minz
End Function</pre> <br><br></td></tr></table><br>
<a name="388311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xmlspy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> how about an entitywidth, entityheight, and entitydepth?  that would be useful also. <br><br></td></tr></table><br>
<a name="388416"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's an entity scale x,y,z() lib function I posted...somewhere. <br><br></td></tr></table><br>
<a name="388427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe something along the lines of<br><br>Function Entitywidth#(Mesh, globl=False)<br>If globl Then parent=0 Else parent=getparent(mesh)<br>TFormVector MeshWidth(mesh),0,0,mesh,parent<br>Return Sqr(TFormedX()*TFormedX()+TFormedY()*TFormedY()+TFormedZ()*TFormedZ())<br>End Function<br><br>would work?  And similarly for EntityHeight and Depth with the tformvector function adjusted accordingly.  I can't think of any use for it at the moment though!<br><br>[edit]<br>Similarly, for entity scale:<br><br>Function EntityScaleX#(entity, globl=False)<br>If globl Then parent=0 Else parent=getparent(entity)<br>TFormVector 1,0,0,entity,parent<br>Return Sqr(TFormedX()*TFormedX()+TFormedY()*TFormedY()+TFormedZ()*TFormedZ())<br>End Function<br><br>Function EntityScaleY#(entity, globl=False)<br>If globl Then parent=0 Else parent=getparent(entity)<br>TFormVector 0,1,0,entity,parent<br>Return Sqr(TFormedX()*TFormedX()+TFormedY()*TFormedY()+TFormedZ()*TFormedZ())<br>End Function<br><br>Function EntityScaleZ#(entity, globl=False)<br>If globl Then parent=0 Else parent=getparent(entity)<br>TFormVector 0,0,1,entity,parent<br>Return Sqr(TFormedX()*TFormedX()+TFormedY()*TFormedY()+TFormedZ()*TFormedZ())<br>End Function<br><br>In this context if the global flag is false then the scale returned will be from the entities viewpoint in local space and should correspond to the scale applied by ScaleEntity().  If the Global flag is true then the scale returned for each axis will depend on the entities orientation in the scaled space from an observers viewpoint in world space. <br><br></td></tr></table><br>
<a name="388437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> How does an entity have "width"? <br><br></td></tr></table><br>
<a name="388613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Size along the X axis. <br><br></td></tr></table><br>
<a name="388644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> How does an entity have a "size"?  It is a point in 3D space.<br><br>Let me put it this way, what would the difference be between a MeshWidth() command and an EntityWidth() command? <br><br></td></tr></table><br>
<a name="388666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can scale entities seperately from their meshes.  So a function that took the entity scaling into account along with the associated mesh would probably be what the person was asking about. <br><br></td></tr></table><br>
<a name="388775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you have a mesh that has a scale of 100 units wide, and you use scaleentity on a particular instance of it, then the resulting entity might be 200 units wide.  You can also scale it differently on each axis.  The mesh scale is only the base scale of the entity if it has not been changed in size from the default of 1.0.<br><br>The differnece between a meshwidth command and an entitywidth command is that entitywidth returns meshwidth() * entityscalex() <br><br></td></tr></table><br>
<a name="388791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Easy enough -<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function EntityScaleX#(Entity,Globl=False)
	If Globl=False Then
		tempPitch#=EntityPitch(Entity,1)
		tempYaw#=EntityYaw(Entity,1)
		tempRoll#=EntityRoll(Entity,1)
		RotateEntity entity,0,0,0,1
	EndIf
	Ret#=GetMatElement(Entity,0,0)
	If Globl=False Then RotateEntity entity,tempPitch,tempYaw,tempRoll,1
	Return Ret#
End Function

Function EntityScaleY#(Entity,Globl=False)
	If Globl=False Then
		tempPitch#=EntityPitch(Entity,1)
		tempYaw#=EntityYaw(Entity,1)
		tempRoll#=EntityRoll(Entity,1)
		RotateEntity entity,0,0,0,1
	EndIf
	Ret#=GetMatElement(Entity,1,1)
	If Globl=False Then RotateEntity entity,tempPitch,tempYaw,tempRoll,1
	Return Ret#
End Function

Function EntityScaleZ#(Entity,Globl=False)
	If Globl=False Then
		tempPitch#=EntityPitch(Entity,1)
		tempYaw#=EntityYaw(Entity,1)
		tempRoll#=EntityRoll(Entity,1)
		RotateEntity entity,0,0,0,1
	EndIf
	Ret#=GetMatElement(Entity,2,2)
	If Globl=False Then RotateEntity entity,tempPitch,tempYaw,tempRoll,1
	Return Ret#
End Function

Graphics3D 640,480,0,2

c=CreateCube()
RotateEntity c,45,2,30
ScaleEntity c,5,3.2,1
Print "Local: "+EntityScaleX(c)+", "+EntityScaleY(c)+", "+EntityScaleZ(c)
Print "Global: "+EntityScaleX(c,1)+", "+EntityScaleY(c,1)+", "+EntityScaleZ(c,1)</textarea><br><br>Even lets you get the global scale. <br><br></td></tr></table><br>
<a name="388949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also have a lib somewhere that returns the actual scale values stored in the entity structure.<br><br>A global mesh width is just the MeshWidth() command, using the global flag. <br><br></td></tr></table><br>
<a name="388955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have updated my post above with functions that return entityscale to my liking though granted you can get blitz to cough them up more directly by peeking about.  Thinking about it peeking the values from the blitz entity structure is probably a better way of getting the absolute scale factors, particularly if they are going to be used to plug back into ScaleEntity as might sometimes be the case.  Thats from a numerical stability point of view anyway. <br><br></td></tr></table><br>
<a name="389005"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bot Builder</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah. DJWoodgate's functions are about 2x as fast as mine as well. ohwell. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
