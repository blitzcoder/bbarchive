<!DOCTYPE html><html lang="en" ><head ><title >Need help with this code here..</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need help with this code here..</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Need help with this code here..</a><br><br>
<a name="814369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >System4 Studios</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When my friend tries to connect to my machine.. He always get the memory access violation when connecting.. but when I see it from my server side it says he lagged out.. I'm using BlitzPlay Network Engine.. <br><br>Here is the code.. <br><br>Graphics3D 800,600,16,2<br>SetBuffer BackBuffer()<br>AppTitle "Soul Shooter Online V0.4"<br>AntiAlias enable <br>WBuffer enable <br>Dither enable <br>Include "getfile.bb"<br>Include "gnet.bb"<br>Include "ParticleManager.bb"<br>Include "devilgui.bb"<br>Include "bplite.bb"<br>Include "Inc_TerraEdLoader.bb"<br>Include "Inc_TerraEdCamera.bb"<br><br>HidePointer<br>Global gameState$="Title Screen"<br>Global body=1<br>Global scene=2<br>Collisions body,scene,2,2<br>Collisions body,body,2,2<br>Global spell$="Spark"<br>Global copySprite<br>Global chat$<br>Global key=GetKey()<br><br>;--------------------------------------------<br>Global mb1press<br>Global mb2press<br>Global upkeyPress<br>Global downkeyPress<br>Global leftkeyPress<br>Global rightkeyPress<br>Global enterkeyPress<br>Global spacekeyPress<br>Global tabkeyPress<br>Global chatkeypress <br>;---------------------------------------------<br>Global localplayerpointer<br>Global font=LoadFont("Arial",20,1)<br>Global bigfont=LoadFont("Arial",50,1)<br>Global menucount,servercount,serverpointer<br>Global camera <br>Global health#<br>Global serverrefresh#<br>Global shot,shot2,shot3<br>Global shottimer#<br>Global hosting<br>Global vx#,vy#,vz#<br>Global oldx#,oldy#,oldz#<br>Global centermouse=False <br>Global justdied <br>Global level <br>Dim incoming$(100)<br>Global positionUpdateTimer#<br>Global sparkemitter <br>Global sparktemplate <br>Global scoresend#<br>Global mainlogo=LoadImage("media/ssobanner.png")<br>Global readserver1$<br>Global server1$<br><br><br><br>;member status sounds--------------------------------------------<br>Global normalsound=LoadSound("media/normal.mp3")<br>Global cpasound=LoadSound("media/cpa.mp3")<br>Global modsound=LoadSound("media/moderator.mp3")<br>Global adminsound=LoadSound("media/admin.mp3")<br>Global creatorsound=LoadSound("media/creator.mp3")<br>Global enteringchat=False <br>;-----------------------------------------------------------------------<br>;collisions <br>Collisions(body,scene, 2, 2)<br>Collisions(body,body, 2, 2)<br>;----------------------------------------------------------------------<br>;load spell sounds<br>Global sparksound=LoadSound("media/spark.wav")<br>Global aurorablastsound=LoadSound("media/aurorablast.wav")<br>Global shockwavesound=LoadSound("media/shockwave.wav")<br>Global deadlygassound=LoadSound("media/deadlygas.wav")<br>gui_initgui("skins/cwing.skin")<br><br>camera=TER_CreateCamera(0,0,0)<br>TER_InitTerraEd(camera,False)<br><br>Type player <br>	Field iD, name$,mesh[10],score,score2<br>End Type <br><br><br>Type info <br>	Field txt$<br>End Type <br><br>Type pdata<br>	Field x#,y#,r#,name$,net_id%<br>	Field xvel#,yvel#,rvel#<br>End Type<br><br><br><br><br><br>Text 0,0,"Now Loading..."<br>Delay 5000<br>Cls <br><br>Global name$=Input("Please enter a username:")<br><br><br>.mainmenu<br>Global mainwindow=GUI_CreateWindow(400,300,200,200, "SSO Main Menu")<br>Global btn1 = GUI_CreateButton(mainwindow,5,10,175,25, "Servers")<br>Global btn2 = GUI_CreateButton(mainwindow,5,40,175,25, "Forums")<br>Global btn3 = GUI_CreateButton(mainwindow,5,70,175,25, "Fan Sites")<br>Global btn4 = GUI_CreateButton(mainwindow,5,100,175,25,"Clan Support (Coming Soon)")<br><br>While Not KeyHit(1)<br>	<br>	Cls<br>	GUI_UpdateGUI()<br>	If GUI_AppEvent()=btn1<br>		serverwindow=GUI_CreateWindow(200,300,200,200, "Servers:")<br>		btn11 = GUI_CreateButton(serverwindow,5,10,175,25, "SoulEdge Server")<br>		btn12 = GUI_CreateButton(serverwindow,5,40,175,25, "")<br>		btn13 = GUI_CreateButton(serverwindow,5,70,175,25, "")<br>		btn14 = GUI_CreateButton(serverwindow,5,100,175,25,"")<br>		btn16 = GUI_CreateButton(serverwindow,5,130,175,25,"")<br>	EndIf <br>	<br>	If GUI_AppEvent()=btn11 <br>		Color 255,255,255<br>		Cls <br>		My_Port = Rand (3000,4000)<br>		IP$=Input$("Please enter the host's IP? ")<br>		<br>		Select BP_JoinSession(name,My_Port,IP,2080)<br>		;Handle any of the reasons if we couldn't join.<br>			Case BP_NOREPLY<br>				Cls<br>				RuntimeError "No reply from server.."<br>				End<br>			Case BP_IAMBANNED<br>				Cls<br>				RuntimeError "You have been banned.. Contact an admin for unban on the forums."<br>				End<br>			Case BP_GAMEISFULL<br>				Cls<br>				RuntimeError "The server is full.. exiting"<br>				End<br>			Case BP_PORTNOTAVAILABLE<br>				Cls<br>				RuntimeError "Port: " + My_Port + " was not available.. exiting"<br>				End<br>			Case BP_USERABORT<br>				Cls<br>				RuntimeError "Connection attempt aborted!"<br>				End<br>		End Select<br>		Goto chatserver<br>		Cls <br>	EndIf <br>		<br>	DrawImage mainlogo,0,0 <br>	Flip <br>	<br>	<br>Wend<br><br><br>GUI_FreeGUI()<br>End<br><br>.chatserver<br>;Oh, we're allowed in? here we go!<br>p.pdata = New pdata<br>p\name = myname<br>p\x = width/2<br>p\y = height/2<br>p\r = 90<br>p\net_id = BP_My_ID<br><br><br>While Not KeyHit(1)<br>	frames = WaitTimer(tmr)<br>	For k = 1 To frames<br>		BP_UpdateNetwork()<br>		HandleMessages()<br>		UpdatePlayers()<br>		send_count = send_count - 1<br>		If send_count &lt;= 0 Then<br>			send_count = send_freq<br>			p.pdata = First pdata<br>			msgtosend$ = BP_IntToStr(Int(p\x),2) + BP_IntToStr(Int(p\y),2) + BP_IntToStr(Int(p\r),2)<br>			If sendupdates Then BP_UDPMessage (0,1,msgtosend)<br>		End If<br>	Next<br>	RenderAll()<br>Wend<br><br>BP_EndSession ()<br><br>End<br>;******************************Functions*******************************<br>Function HandleMessages ()<br>	For msg.MsgInfo = Each MsgInfo<br>		Select msg\msgType<br>			Case 255	;A new player has joined!<br>				p.pdata = New pdata<br>				p\name = msg\msgData<br>				p\x = width/2<br>				p\y = height/2<br>				p\r = 90<br>				p\net_id = msg\msgFrom<br>				nInfo.NetInfo = BP_FindID(p\net_id)<br>				Info ("**" + p\Name + " has joined!" +extra$)<br>			Case 254	;A player has left<br>				p.pdata = Find_pdata(msg\msgFrom)<br>				If p&lt;&gt;Null Then<br>					If msg\msgData = True Then Info ("**" + p\Name + " leaves.") Else Info ("**" + p\Name + " lagged out!")<br>					Delete p<br>				End If<br>			Case 253	;The host has disconnected<br>				For p.pdata = Each pdata<br>					If p\net_id &lt;&gt; BP_My_ID Then Delete p<br>				Next<br>				If msg\msgData = True Then Info ("**The server has been shutdown by the host!") Else Info ("**No reply from host in " + (BP_TimeoutPeriod / 1000) + " seconds. Exiting game..")<br>			Case 252	;Someone got kicked/banned<br>				p.pdata = Find_pdata(msg\msgFrom)<br>				If p\net_id = BP_My_ID Then	;It was -me-??<br>					If msg\msgData = False Then Info ("**You have been kicked by Admin/Mod") Else Info ("**You have been banned by Server Admin/Moderator.")<br>					For p.pdata = Each pdata<br>						If p\net_id &lt;&gt; BP_My_ID Then<br>							Delete p<br>						End If<br>					Next<br>				Else				;It wasn't? Ok then.<br>					If msg\msgData = False Then Info ("**" + p\Name + " has been kicked!") Else Info ("**" + p\Name + " has been banned!")<br>					Delete p<br>				End If<br>			Case 2		;a chat packet<br>				p.pdata = Find_pdata(msg\msgFrom)<br>				Info (p\Name + ":" + msg\msgData)<br>				<br>			Case 3 ;normal<br>				PlaySound normalsound<br>				<br>			Case 4 ;cpa attributes<br>				PlaySound cpasound<br>				<br>			Case 5;moderator attributes<br>				PlaySound modsound<br>				<br>			Case 6;admin attributes<br>				PlaySound adminsound<br>				<br>			Case 7;creator attributes<br>				PlaySound creatorsound<br>		End Select<br>		Delete msg<br>	Next<br>End Function<br><br><br>Function Info (t$)<br>	i.Info=New info<br>	i\txt$=t$<br>	Insert i Before First info<br>End Function<br><br>Function UpdatePlayers ()<br>	For p.pdata = Each pdata<br>;Other input<br>		If KeyHit(KF1) Then<br>			logging = 1 - logging<br>			If logging Then<br>				BP_StartLogFile (myname + ".txt")<br>			Else<br>				BP_StopLogFile ()<br>			End If<br>		End If<br>		If BP_My_ID = BP_Host_ID<br>			For keycheck = 60 To 68<br>				If KeyHit(keycheck) Then<br>					If keycheck - 58 &lt;&gt; My_ID Then		;No kicking yourself!<br>						If KeyDown(kShift) Then<br>							nInfo.NetInfo = BP_FindID(keycheck - 58)<br>							If nInfo&lt;&gt;Null Then<br>								Info("**You banned: " + nInfo\Name)<br>								BP_KickID(keycheck - 58, True)<br>							End If<br>						Else<br>							nInfo.NetInfo = BP_FindID(keycheck - 58)<br>							If nInfo&lt;&gt;Null Then<br>								Info("**You kicked: " + nInfo\Name)<br>								BP_KickID(keycheck - 58, False)<br>							End If<br>						End If<br>					End If<br>				End If<br>			Next<br>		End If<br>		If KeyHit(KF11) Then<br>			sendupdates = 1 - sendupdates<br>		End If<br>		If KeyDown(KTab) Then DebugInfo = 1 Else DebugInfo = 0<br>;Chat<br>		key=GetKey()<br>		If key<br>			If key=13<br>				If chat$&lt;&gt;"" Then<br>					BP_UDPMessage (0,2,chat$)<br>					Info (p\name + ":" + chat)<br>					chat$=""<br>				End If<br>			Else If key=8<br>				If Len(chat$)&gt;0 Then chat$=Left$(chat$,Len(chat$)-1)<br>			Else If key&gt;=32 And key&lt;127<br>				chat$=chat$+Chr$(key)<br>			EndIf<br>		EndIf<br>	Next<br>End Function<br><br>Function RenderAll ()<br>	Local st$<br>	Local counter%<br>	For p.pdata = Each pdata<br>		counter = counter + 1<br>	Next<br>	Color 100,100,100<br>	Rect 0,FontHeight()*2,width,FontHeight()*(counter) + 1,False<br>	Color 10,10,50<br>	Rect 1,(FontHeight()*2)+1,width-2,FontHeight()*(counter) - 1,True<br>	textcounter = 2<br>	Color 20,150,150<br>	Text width/2,0,"-=[Soul Shooter Online ChatRoom]=-",True<br>	For p.pdata = Each pdata<br>		If p\net_id = BP_My_ID Then<br>			Text 1,FontHeight()*textcounter, p\net_id + "] " + "**" + p\name + "**"<br>		Else<br>			Text 1,FontHeight()*textcounter, p\net_id + "] " + p\name<br>		End If<br>		textcounter = textcounter + 1		<br>	Next<br>	Color 0,200,50<br>	textcounter = textcounter + 1		<br>	Text 0,FontHeight()*textcounter, "&gt;" + chat$ + "_"<br>	textcounter = textcounter + 1<br>	counter = 0<br>	Color 150,150,150<br>	For i.Info = Each info<br>		counter = counter + 1<br>		If counter &gt; 15 Then<br>			Delete i<br>		Else<br>			Text 0,FontHeight()*textcounter, i\txt<br>			textcounter = textcounter + 1<br>		End If<br>	Next<br>	<br>	Color 0,140,160<br>	If logging Then Text 0,height-FontHeight(),"Logging: Enabled    (f1 to toggle)" Else Text 0,height-FontHeight(),"Logging: Disabled   (f1 to toggle)"<br>	If sendupdates Then Text 0,height-FontHeight()*2,"Sending updates: True    (f11 to toggle)" Else Text 0,height-FontHeight()*2,"Sending updates: False  (f11 to toggle)"<br>	Text 0,height-FontHeight()*3,"[TAB] displays debug information",False, False<br>	If Host Then Text 0,height-FontHeight()*4,"F2-10 to boot that player, hold [SHIFT] to ban"<br>	<br>	If DebugInfo Then<br>		p.pdata = First pdata<br>		Color 40,100,150<br>		Rect (width/2) - WindowCount - 1,(height/2)-51,(WindowCount * 2) + 2, 102,False<br>		Color WindowCount/4,WindowCount/3,WindowCount/2<br>		Rect (width/2) - WindowCount,(height/2)-50,WindowCount * 2, 100,True<br>		If WindowCount &lt; 210 Then<br>			WindowCount = WindowCount + 10<br>			If WindowCount &gt; 210 Then WindowCount = 210<br>		Else<br>			If BP_Online Then<br>				Color 100,200,100<br>				Text (width/2) - WindowCount,(height/2)-50,"Online",False,False<br>			Else<br>				Color 200,50,50<br>				Text (width/2) - WindowCount,(height/2)-50,"Offline",False,False<br>			End If<br>			<br>			Color 200,200,200<br>			<br>			st$ = "-=[" + p\Name + "]=-"<br>			Text (width/2),(height/2) - (FontHeight() * 3),st$,True,True<br>			<br>			st$ = "GameType: " + BP_GetGameType()<br>			Text (width/2) - (WindowCount),(height/2) - FontHeight(),st$,False,True<br>			st$ = "TimeoutPeriod: " + BP_GetTimeoutPeriod() + "s."<br>			Text (width/2) - (WindowCount),(height/2),st$,False,True<br>			st$ = "My IP: " + BP_GetMyIP()<br>			Text (width/2) - (WindowCount),(height/2) + FontHeight(),st$,False,True<br>			st$ = "Host IP: " + DottedIP$(BP_GetHostIP())<br>			Text (width/2) - (WindowCount),(height/2) + (FontHeight() * 2),st$,False,True<br>			<br>			st$ = "# Of Players: " + BP_GetNumberOfPlayers()<br>			Text (width/2),(height/2) - FontHeight(),st$,False,True<br>			st$ = "Max. # Of Players: " + BP_GetMaxPlayers()<br>			Text (width/2),(height/2),st$,False,True<br>			st$ = "Packets Sent: " + BP_GetPacketsSent()<br>			Text (width/2),(height/2) + FontHeight(),st$,False,True<br>			st$ = "Packets Received: " + BP_GetPacketsReceived()<br>			Text (width/2),(height/2) + (FontHeight() * 2),st$,False,True<br>		End If<br>	Else<br>		If WindowCount &gt; 0 Then<br>			Color 40,100,150<br>			Rect (width/2) - WindowCount - 1,(height/2)-51,(WindowCount * 2) + 2, 102,False<br>			Color WindowCount/4,WindowCount/3,WindowCount/2<br>			Rect (width/2) - WindowCount,(height/2)-50,WindowCount * 2, 100,True<br>			WindowCount = WindowCount - 10<br>			If WindowCount &lt; 0 Then WindowCount = 0<br>		End If<br>	End If<br>	Flip<br>	Cls<br>End Function<br><br>Function Find_pdata.pdata (ID)<br>	For p.pdata = Each pdata<br>		If p\net_id = ID Then Return p<br>	Next<br>End Function <br><br></td></tr></table><br>
<a name="814382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vertigo</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I do not have the time to analyze that code.  If you dont mind some positive criticism allow me to make a few suggestions.  First off Indent your code.  It will be impossible for you and everyone else to easily decipher exactly what the heck is going on.  Secondly network game coding is a sheer nightmare.  Might I suggest starting with something a tad easier?  Simply creating a client and server on the same machine that does nothing more than a simple chat.  Just learn to had send and receive data as well as to build on that and have a good data management structure.  Blindly jumping into projects like this always ends poorly.  If you cant trap a MAV at this early of a stage, just image what it will be like when there are a lot of clients sending tons of packets everywhere.  Just some friendly advise.<br><br>If you want to continue with this however, might I suggest running in Debug mode and atleast figuring out where it is MAVing on your friends end?<br><br>-Scott <br><br></td></tr></table><br>
<a name="814387"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >System4 Studios</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> that's what this code is basically is.. a simple chat..  and I have worked on a game with network coding before with my Soul Shooter Online game.. so I'm not new with Network coding.. (TCP) I'm just using this BlitzPlay lite.. which is UDP.. and I'm learning how to use it.. and My fault with the code indenting.. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
