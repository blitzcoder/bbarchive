<!DOCTYPE html><html lang="en" ><head ><title >Lighting Normals Problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Lighting Normals Problem</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Lighting Normals Problem</a><br><br>
<a name="543184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just messing around with something here ...<br><br>I'm not 100% sure how the updatenormals function works but as you can see here it's no doing as I want.  The attached image is a basic track mesh made from various track tile meshes. I use addmesh to make one big mesh then use updatenormals.  Note that there are no shared vertices on each tile.<br><br>As you can see the lighting is dodgy at the seems.  I've tried various programs from the code archives with no joy.  What I want is a function that will sort out the lighting on the edges.<br><br>Can anyone help without the use of a modeling program?<br><br><img src="http://www.steviegoodwin.plus.com/images/TrackTest.JPG"> <br><br></td></tr></table><br>
<a name="543202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you tried this?...<br><br><a href="/codearcs.php?code=1377" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1377</a> <br><br></td></tr></table><br>
<a name="543205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yip, the trouble with it is that it welds the whole mesh .. not just the seems so the rest of the mesh looks 10 times worse.  Cheers anywho! <br><br></td></tr></table><br>
<a name="543246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You say you tried some of the archive code but did you try Swifts calcnormals function?<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=975" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=975</a> <br><br></td></tr></table><br>
<a name="543250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, that doesn't work either.  It pretty much produces the same results as the native command.<br><br>I'm using Vertexcolor btw. <br><br></td></tr></table><br>
<a name="543311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Couple questions:<br><br>You say "Note that there are no shared vertices on each tile". So each tile mesh is made up of a set of unwelded tris, yes? Can I ask why? :) UpdateNormals can't smooth normals unless shared verts are used.<br><br>If each of the tile meshes normals are correct before you're AddMesh'ing them together, why are you using UpdateNormals at all? You do know AddMesh doesn't weld any vertices, right?<br><br>Last thing - you may have seen this already - but this may help with 'debugging' your normals, at least :)<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1085" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1085</a> <br><br></td></tr></table><br>
<a name="543437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm maybe I'm not 100% sure what welded, unwelded means.  <br><br>For example the vertices are arranges in a left/right straight tile as below.  Note that polys use vertices 0,1,3 / 3,2,0 &amp; 4,5,8 / 7,6,4 etc... Vertices 2&amp;4 / 3&amp;5 etc. share the same position.<br><br>The reason I'm doing this is I'm using vertex colours and don't want certain parts to bleed colours into others etc..<br><br>Make more sense?<br><br>I've tried updating the normals for each tile and not updating normals for the new mesh but this is worse than the picture.<br><br><pre class=code>
0							1

2							3
4							5

6							7
8							9

10							11
12							13

14							15
16							17

18							19
20							21

22							23
24							25

26							27
28							29

30							31
</pre> <br><br></td></tr></table><br>
<a name="543470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a thought which should solve it but probably involves a bit of a head "foray" for you if you've not done mesh creation before.<br><br>Why not construct a single mesh out of the tiles by using the mesh/surface/vertice command set.  That way you will end up with one smooth mesh.<br><br>Another option might be to disable lighting on the object and use a texture layer to alpha on a light map created with the good old plot command. <br><br></td></tr></table><br>
<a name="543506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Braincell</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You have to fix this in a modeler package. Weld the vertices where you want the transitions to be smooth, then use smoothing groups. You'll have to know how to fix the parameter(s) of smoothing groups to get the right effect. You can separate the two meshes or have them together and use smoothing groups, the results shouldnt be too different, although if the meshes are separate you might get slightly different lighting at the edges of the other mesh. If you created the mesh with code, you'll simply have to change the code so that the same vertice is used by for example 4 surrounding squares (if you have a square grid). You should know what welding means anyhow. <br><br></td></tr></table><br>
<a name="543560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ Becky.  I've never used any modeling programs before so building meshes in code is what I always do.  Building the whole track without tiles defeats the purpose.  I did consider using a lightmap so this may be the way to go.<br><br>@ Lenn.  I'm sure I could write a routine to remove duplicate vertices and amend the triangles which use these.  <br><br>Thanks folks. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
