<!DOCTYPE html><html lang="en" ><head ><title >BlitzScript3D</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BlitzScript3D</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >BlitzScript3D</a><br><br>
<a name="442121"></a>

<a name="1096466"></a>

<a name="1096467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.hpquest.com/techlord/apps/blitzscript/help/index.html" target="_blank">BlitzScript3D</a> is a Scripting System with a BASIC Syntax for use in Blitz3D made games. Based on <a href="/codearcs.php?code=51" target="_blank">Mark Sibly's Blitz Compiler Code</a>, the Scripting System Lib will contain a Compiler and Virtual Machine.<br><br>The Scripting System Compiler will open and parse *.bsc files, generate opCode that resembles x86 assembler instructions, and convert opCode into smaller Pcode (opCode represented by a integer value), saving the Pcode files with  *.bso extension. Pcode files are loaded and executed by a Virtual Machine. The Virtual Machine simulates a cpu processing the Pcode files. <br><br>The Scripting Language Supports:<br>1. Keywords: let, print, end, if, then, else<br>2. Blitz3D Commands<br>3. Operators: binary +, -, *, /, &lt;, =, &gt;, &lt;=, &lt;&gt;, &gt;= and unary -<br>4. Precedence : *, /, &gt;&gt;,&lt;&lt; have precedence over +, -, which have precendence over &lt;,=,&gt;,&lt;=,&lt;&gt;,&gt;=<br>5. Subexpressions grouped by Parenthesis .<br>6. Comments<br>7. Preprocessing (New)<br><br>To Be Implemented:<br>1. Multi-Dimensional Arrays (wip)<br>2. Functions<br>3. Conditional Loops<br>4. Select...Case<br><br><font class="tiny">Last edited 2011</font><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="442129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess a Script Interpreter and a Compiler that generates Assembler Souces are two completely diffrent things. Probably you should think about to use the already existing virtual Blitz Machine, this would save you a lot of work. Also Noel started a Script Interpreter if I remember right. <br><br></td></tr></table><br>
<a name="442130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> jfk <br><br>I'm aware of BVM, however, the goal is to produce another Scripting alternative with Blitz. I have developed 2 scripting systems using Marks Compiler code as the basis.  Had some pretty good results. Just decided openly write one. <br><br></td></tr></table><br>
<a name="442133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Started one, never finished it.<br><br><a href="http://blitzbasic.com/Community/posts.php?topic=38036#420588" target="_blank">http://blitzbasic.com/Community/posts.php?topic=38036#420588</a><br><br>Personally, I prefer mine to this sort of one, but then I'm an odd fellow.  I don't really consider this one a scripting language until I see it do something other than convert one language to another. <br><br></td></tr></table><br>
<a name="442163"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Noel <br><br>Actually, there is no scripting language yet. Just a basic compiler that can parse some basic-like syntax into opcode. <br><br>It currently takes the basic program<pre class=code>
let a=1
let b=2
let c=a*b+a/b
if a=b then print a else print b
end</pre><br>and generates these opcodes<pre class=code>//tbasic startup...1
  sub  edx,edx
//let a=1 
  mov  eax,1
  mov  [_a],eax
//let b=2 
  mov  eax,2
  mov  [_b],eax
//let c=a*b+a/b 
  mov  eax,[_a]
  push eax
  mov  eax,[_b]
  pop  ecx
  imul eax,ecx
  push eax
  mov  eax,[_a]
  push eax
  mov  eax,[_b]
  mov  ecx,eax
  pop  ecx
  shl eax,ecx
  pop  ecx
  add  eax,ecx
  mov  [_c],eax
//if a&lt;b then print a else print b 
  mov  eax,[_a]
  push eax
  mov  eax,[_b]
  pop  ecx
  cmp  ecx,eax
  slt  eax
  and  eax,255
  and  eax,eax
  jz  __1
  call print:64
  mov  eax,[_a]
  jmp  __2
__1:
  call print:64
  mov  eax,[_b]
__2:
//end 
  ret

_a:
  dd  0
_b:
  dd  0
_c:
  dd  0
Done!
</pre>Pcode is merely a numerical representation of these opcodes<pre class=code>
;opcode
mov eax,2

;pcode equivalent
01 2</pre><br><br>The VM simulate a cpu containing the necessary LIFO Stacks (Array), Registers/Stack Pointers(Variables), and Functions to process Pcode. Generating opcode may be optional. <br><br>Using 'compiled' Pcode files will provide greater performance than 'interpreting' the scripting language on the fly. Compilation is only required once.<br><br>This is a good start, lots to add. <br><br></td></tr></table><br>
<a name="442223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MSW</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sense the VM simulates a CPU, also think about a muti-threading approch with Pcode(script) instanceing, parent/child linking, and messageing between those instances.<br><br>You could concieveably create a bunch of object scripts...a script for a particular type of gun, another for a particular type of armor, particular type of movement (running, walking, jumping, etc)...and pieceing them together in parent/child relationships under an AI script...and instance them with a particular game character/enemy/whatever...in this way even simular enemies can have different weapons, and effects at thier disposal, and completely customizeable at run time without haveing to generate bloated AI scripts that take all variations into account.<br><br>Obviously this would require a little more planning and work in terms of the VM...effectively a bit like writeing a OS for the VM in that you would need the equivelant load utility to get scripts into memory for VM use, a resource/process manager to maintain the scripts in memory and introduce them once loaded to the VM, as well as the appropriate garbage collection utilities to clear unused scripts from memory and general clean-up duities....then of course the VM would need to work with time slices, or other means of multi-processing control, as well as a means to swap between executeing processes...but it shouldn't be that hard. <br><br></td></tr></table><br>
<a name="442771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="442925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> MSW,<br><br>I'm a lil foggy on the concepts muti-threading approch with Pcode(script) instanceing, parent/child linking, and messageing between. Please provide more detail as im very interesting in adding these features. <br><br></td></tr></table><br>
<a name="442999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Work In Progress. I have divided the Scripting System into two sections: Compiler and VirtualMachine. The compiler's job will be to load and compile 'BlitzScript' into Pcode. The Virtual Machines Job will be to load and execute Pcode. I have made several changes to Mark's Original Source. Mostly dividing the source into smaller 'code modules' and renamed all vars, functions, etc, with 'bscvm' to ensure the lib will function without interference with existing code.<br><br>Get the<br><a href="http://techlord.blackeve.com/BlitzScript.zip" target="_blank">WIP ZIP</a>. Included  are code modules, I generated with TypeWizard. Many of the modules contain unnecessary functions to be removed when the system is working properly. Included are also some other code modules used in other projects. The WIP ZIP contains:<br><br>bscvm.bb - Main Program<br>stack.bb - An old stack lib I've used in many projects.<br>bscvmVar.bb - Manages a look table for Vars used by the compiler and virtual machine.<br>bscvmLabel.bb - Manages a look table for Labels used by the compiler.<br>bscvmCompiler.bb - Manages Compiler Object, compiles 'blitzscript' *.bbs files to pcode files *.bsc<br>bscvmThread.bb - A component of the Virtual Machine, supports psudeo-multithreading execution.<br>bscvmVirtualMachine.bb - Virtual Machine Object - executes pcode files. <br><br></td></tr></table><br>
<a name="443002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="443010"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> With the current design, the compiler and virtual machine are independent. The VM will be able to exec multiple script 'threads'. If you take a look at the compiler and VM modules you will notice two large Select...Case structures. These structure quickly map function calls and parameters to blitz commands. Custom functions will operate differently, the will be bahave similar to scripts with ability to pass parameters. Not sure how its going to be implemented, i just know that i will. <br><br></td></tr></table><br>
<a name="443031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MSW</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>MSW, <br><br>I'm a lil foggy on the concepts muti-threading approch with Pcode(script) instanceing, parent/child linking, and messageing between. Please provide more detail as im very interesting in adding these features. <br> <br></div><br><br>Okay...this may be a bit confuseing:<br><br>First you will need a resource manager...this handles the loading of scripts, allocating of memory banks, etc...<br><br>The pcode itself is stored in bank...and when the resource manager is called upon to load a script into memory it first checks to see if it hasn't already been loaded...if not then it creates a resorce tracking record (basicly a type) which contains the handle for the Pcode bank, the name of the pcode, info about how much variable space the pcode requires and all that...then a script instance is created (another type) it is given a name along with handles to both the pcode bank, and a bank for pcode variables, messages, and bytecode pointers....if the resource manager finds that the script already exists, it simply creates another script instance of that type.<br><br>basicly there are two scirpt instance lists. and the VM works with the "active" list.<br><br>messages are basicly special stacks that parents can push data onto, with the script instance owning the particular message list being the only instance able to pop data off.<br><br>the parent/child stuff works quite simply.<br><br>basicly you have something like this:<br><pre class=code>

Type script_inst

;basic stuff

 Field Name$
 Field ID%                   ;used for classifying scripts 
 Field Pcode                 ;handle to a bank
 Field variables             ;handle to another bank
 Field Messages              ;handle to another bank  
 Field pcodepointer%
 
 
;VM active/inactive list stuff

 Field flags%                ;is script active, etc..
 Field previous.script_inst  
 Field next.script_inst

;instance parent child stuff

 Field parent.script_inst
 Field child.script_inst

end type
</pre><br><br>typicaly only the highest level parent (its parent = NULL...or possably the game control script) scripts are active...this means thier children will likely be on the inactive list.<br><br>Say the parent script decides to fire its gun...the vm then searched through the scripts children for the first matching gun ID..finds that the child is inactive...changes the childs flag to active and puts it on the end of the active list adding "fire" to its messages <br><br>the lists are structured like this:<br><br><pre class=code>
Dim active.script_inst[1]
Dim inactive.script_inst[1]
</pre><br><br>active[0] points to the first script in the list<br>active[1] points to the last.<br><br>tis' basic linked list stuff...I think you prolly have a handle on that.<br><br>anyway..when the VM gets to the particular gun script...first thing it may do is check it's messages...sees "fire"...and does so by calling upon the resource manager to create a new script instance...in this case it's "bullet 1" or some such...the resource manager creates the appropriate instance...and the gun script becomes it's parent, putting it on the active list, and giveing it messages informing it of what direction to travel in, etc...then the gun script tells the VM to put it on the inactive list and reset it's pcode pointer.<br><br>course the bullet script is then run, gets it's messges, sets the appropriate variables, moves the bullet mesh into possition, etc...it remains on the active list...until the game control script that is parent over everything finds that it has collided with a wall, and gives it the appropriate message...it reads it, and decides to generate a smoke script...does so...then tells the VM to delete it (parent/child, previous/next lists are updated in the process)<br><br>hopefully that makes some sense. <br><br></td></tr></table><br>
<a name="443106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> MSW,<br><br>Well, I think I'm on track with your suggestions. The 'bscvmThread' object is the equivalent of 'script_inst'. I'm handling processing and management different but, should achieve the same results. <br><br></td></tr></table><br>
<a name="443688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking for ideas on how to deal with functions. <br><br></td></tr></table><br>
<a name="443760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> CALL and RET shouldn't be too difficult to implement.  you'd have to make a call stack.<br><br>also - is there any reason you're restricting yourself to x86-style opcodes and registers if it's not real assembly?  i mean, if i were you, i'd use something like r0-r15 for registers.. one of the problems with x86 assembly is the sheer lack of general-purpose registers, and it doesn't really make much sense to limit yourself, especially in a scripting language, when you need speed and can't afford to be shifting registers around all the time.<br><br>just my 2 cents :) <br><br></td></tr></table><br>
<a name="444004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> DrakeX,<br><br>A Call Stack? Please elaborate as im sure there are many ways to implement one. The x86 Opcodes were merely a starting point.<br><br>Found some good articles for others interested in writting there own Scripting Engine. Flipcode's Implementing a Scripting Engine: <a href="http://www.flipcode.com/articles/scripting_issue01.shtml" target="_blank">Part 1</a>, <a href="http://www.flipcode.com/articles/scripting_issue02.shtml" target="_blank">Part 2</a>, <a href="http://www.flipcode.com/articles/scripting_issue03.shtml" target="_blank">Part 3</a>, <a href="http://www.flipcode.com/articles/scripting_issue04.shtml" target="_blank">Part 4</a>, <a href="http://www.flipcode.com/articles/scripting_issue05.shtml" target="_blank">Part 5</a>, <a href="http://www.flipcode.com/articles/scripting_issue06.shtml" target="_blank">Part 6</a>, <a href="http://www.flipcode.com/articles/scripting_issue07.shtml" target="_blank">Part 7</a>, <a href="http://www.flipcode.com/articles/scripting_issue08.shtml" target="_blank">Part 8</a>, <a href="http://www.flipcode.com/articles/scripting_issue09.shtml" target="_blank">Part 9</a><br><br>Note: Part 9 discusses how to deal with functions. <br><br></td></tr></table><br>
<a name="444151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> The latest changes: Wrote some help docs on BlitzScript which be a basic-syntax language very similar to Blitz3D. Still trying to sort out the handling of functions as there are many ways to go about it. I dont think object-oriented stuff is going to make it into BlitzScript. <br><br></td></tr></table><br>
<a name="444152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Frank: Write a preprocessor for the scripts to allow usage of object oriented programming features.  I did that for Blitz3D and it works fine.  Just spits out a .BB file that has code compatible with Blitz. <br><br></td></tr></table><br>
<a name="444157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Noel,<br><br>OO is way on the bottom of the feature list at this point and time. However, figuring out implemention of standard variables and functions are giving me clues for implementing oo. <br><br><div class="quote">  Write a preprocessor for the scripts to allow usage of object oriented programming features. I did that for Blitz3D and it works fine. Just spits out a .BB file that has code compatible with Blitz.  <br></div>I'm not sure exactly what you mean here as BSCVM is a in-game script compiler &amp; processor that uses scripts at runtime. The method you describe requires you to convert your script -&gt; .bb and then compile the *.bb with blitzcc. Please correct me if im wrong. <br><br></td></tr></table><br>
<a name="444217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I mean when you compile the script file, preprocess it (either via some means such as a virtual file system or via a temporary file (bscvm.SWAP for example)) and then process the preprocessed version.  That would, basically, result in a pseudo-object oriented environment.  g++, as far as I'm concerned, is a big preprocessor that converts to C and then builds the preprocessed file- presumably from an existing stream such that no extra files are neccessary.<br><br>Does it quite nicely, too.<br><br>Rambling there, my brain is jelly at the moment. <br><br></td></tr></table><br>
<a name="444219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I'm to add OO features they will be implemented into the Compiler, just as the standard variable and function features are.<br>I've checked out your <a href="/codearcs.php?code=1103" target="_blank">AAAP</a>. IMHO performing preprocessing is unnecessary. Truly these features should be incorporated into the compiler. <br><br></td></tr></table><br>
<a name="451741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=39819" target="_blank">BlitzScript3D Compiler &amp; Virtual Machine (BSCVM) will making a debut in Project PLASMA FPS! BSCVM will be the scripting solution for Project PLASMA FPS.</a> <br><br></td></tr></table><br>
<a name="451867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Strider Centaur</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im not sure a scripting language needs a VM.  <br><br>I see several people are trying to make a BB scripting language, But Im not really sure what advantage this has of native BB other than the obvious ability to influance a sceen or game engine coded in blitz without having access to the actual source and need for recompile.   <br><br>While those are good reason for scripting, it seems to me that BB would make a terible scripting language.  Its a great programming language for what it was designed for, but its bulky and not very intuitive.  It also has alot of restrictions on how you can access data.  A good scripting language should be light, easy to learn, and provide plenty of support for accessing all types of data, even using methods not supported by the main application, in this way you can make scripts that extend the application in ways you normally would not be able too.<br><br>There are some excelent scripting languages out there, and many are free to use, everything from Embeded python DLL to LUA.<br><br>Given that many of these scripting languages are opensource and supported by huge comunities, one would think that using them would be a pleasure.   <br><br>As usuall Im not a fan or doing what others have already done, Im just to lazy to reinvent things.  :)<br><br>BTW hasn't somone aleady done a LUA DLL for use with blitz? <br><br></td></tr></table><br>
<a name="452139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Strider,<br><br>The inclusion of a scripting language into PPF is to influence Game Objects in the engine without having to  access to the engine source and recompile with blitzcc. Thus, games developed with the 'engine' can be MODed without the need for Blitz3D compilation.<br><br>In respect to PPF the scripting language will be focused around high level interactive game objects: Camera, Players, Weapons, Projectiles, Reactors (Particles), Powerups, Triggers &amp; Keys, Waypoints, Platforms, Flares (lens flares), Foilage, Terrain, Maps, Soundfields, Warps, and GUI &amp; Chat. <br><br>The scripting language will be a BASIC Syntax and offer a limited number of control loops, conditions, variables and arrays, and functions. Scripts are compiled to pcode for fast loading and execution. The VM process pcode.<br><br>Network Core, Rendering Optimizatons, and other 'behind-the-scenes' task are managed by the engine coded with native blitz. All modern, complete game engines offer a method of programming game behavior via some sort of scripting language and PPF will follow suit. <br><br></td></tr></table><br>
<a name="463670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone interested in a Scripting Engine?<br><br>PS: A Free One that is. <br><br></td></tr></table><br>
<a name="463672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >@rtur</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes! of cource! :) <br><br></td></tr></table><br>
<a name="465023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzScript3D Engine is coming!<br><br>To Be Continued... <br><br></td></tr></table><br>
<a name="467110"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> ... <br><br></td></tr></table><br>
<a name="467120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Synchronist</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Frank, a worthy project to be sure! I was seriously looking at Java, Java3D and the BeanShell for a project. Your timing perfect! Thx! <br><br></td></tr></table><br>
<a name="467121"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Sychronist, Thanks.<br><br>There is more to do. But, once complete it should be an ideal scripting solution developed with Blitz3D for Blitz3D! <br><br></td></tr></table><br>
<a name="467133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Synchronist</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Frank; this is great! I can see you've got your work cut out for you in extending the features but it sure looks like you're on the right track! <br><br></td></tr></table><br>
<a name="468979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/logs/userlog.php?user=223&amp;log=401" target="_blank">New BlitzScript3D Update</a> <br><br></td></tr></table><br>
<a name="469078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are Frank Taylor and Synchronist the same person?  They sound so much alike. <br><br></td></tr></table><br>
<a name="469087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Synchronist</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Noel, we're two different people. It's just that Great Minds think alike. 8^)<br><br>@Frank, looking good! I'm messing about with it by coding a solar system sym in B3D, BasicGL and BSVM. It's interesting.<br><br>A suggestion? You might consider adding some version numbers to the filename... <br><br></td></tr></table><br>
<a name="469097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sychronist,<br><br>hehe. Your right. Changes are very rapid on both code and docs. Its usually best to replace all files. I'll startup a worklog with the most recent version changes.<br><br>Noel,<br><br>Now why on earth would I purchase two copies of Blitz3D just to chat to myself on the forum? LOL <br><br></td></tr></table><br>
<a name="469198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uhfgood</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> I always wondered what the real purpose of scripting langauges were, when you could just use the development enviroment you have, recode and recompile.  I guess modding for people that just have your game and not access to blitz (or any other de for that matter), would be a good use for scripting.  If you're a programmer, is there anything scripting does for you if you're already working with blitz3d and/or some other language/enviroment? <br><br></td></tr></table><br>
<a name="469390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Synchronist</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> One the good things about Frank's system is that you can change a script and reload it into the application while it's still running. This allows you to modify program behavior to some extent without having the "modify/compile/run" cycle each time. It might not amount to much time saved in a rather static enviroment, but it you were tweaking say, AI algorithms, the time saved could be substantial. <br><br></td></tr></table><br>
<a name="469433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> A Scripting System provides a encapsulated programming interface to the app/game core. This allows you modify and extend the applications behavior without modification to core components. Mods, Plugins, and Macros, are all good examples of the benefits of a scripting system.<br><br>Many modern software packages now include a scripting system: Quake - QuakeC, Unreal - UnrealScript, Microsoft Office - VBScript, 3DStudio Max - MaxScript, Torque - Torqescript, A6 - Quake C, Maya - Mel, Scriptable Installers, and many others. IMHO, pratically all software can benefit from a Scripting Engine of some sort. <br><br></td></tr></table><br>
<a name="469549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Uhfgood</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> YEah I know most games have a scripting system in them, always just curious about it... writing a program in another program, sounds odd to me. <br><br></td></tr></table><br>
<a name="470128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Multi-Dimensional Arrays Are Coming! I've work out the math to convert multiple indexes into a linear index for use with Blitz Arrays (ie: mytype.alien[100]). The code below pertains to the BlitzScript3D Engine but, may be useful for others. <br><br>This code snippet, illustrates the formula that will compute the offset into memory for an array with any number of dimensions:<pre class=code>Graphics 1024,768
n=Input("Number of Array Dimensions: ")
ascii= 96
element$=Chr(ascii+loop+1)
dimensions$="a"
For loop = 1 To n
	Print "Dim Array("+dimensions+")"
	Print "linear_index=base_index+"+String("(",loop)+"a_index)" + expressions$ + "*element_size_in_bytes"
	Print 
	element$=Chr(ascii+loop+1) 
	expression$="*"+element$+"_size+"+element$+"_index)"
	expressions$=expressions$+expression$
	dimensions$=dimensions$+","+element$
Next</pre>Application of the formula in the BlitzScript3D Engine.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;bscvm Array
;supports up to 4 dimensions using Row Major Ordering Formula 
; @ webster.cs.ucr.edu/AoA/Windows/HTML/Arraysa2.html
;There is a generic formula that will compute the offset into memory For an array 
;with any number of dimensions, however, you'll rarely use more than four. 


Global blitzscriptVar[65535] ;a single dimension array

Type bscvmArray
	Field name$
	Field i_size
	Field j_size
	Field k_size
	Field l_size
	Field head
	Field tail
End Type

Function bscvmArrayCreate.bscvmArray(i,j=0,k=0,l=0)
	this.bscvmArray = New bscvmArray
	this\i_size=i+1
	this\j_size=j+1
	this\k_size=k+1
	this\l_size=l+1
	this\head=0
	this\tail=this\head + this\i_size * this\j_size * this\k_size * this\l_size
	Return this
End Function

Function bscvmArrayGet(this.bscvmArray,i_index,j_index=0,k_index=0,l_index=0)
	Return blitzscriptVar[this\head+(((i_index * this\j_size+j_index) * this\k_size+k_index) * this\l_size+l_index)]
End Function

Function bscvmArraySet(this.bscvmArray,i_index,j_index=0,k_index=0,l_index=0,value$=0)
	blitzscriptVar[this\head+(((i_index * this\j_size+j_index) * this\k_size+k_index) * this\l_size+l_index)]=value
End Function

Function bscvmArrayLinearIndexGet(this.bscvmArray,i_index,j_index=0,k_index=0,l_index=0)
	Return this\head+(((i_index * this\j_size+j_index) * this\k_size+k_index) * this\l_size+l_index)
End Function

Function bscvmArrayTest()

	this.bscvmArray=bscvmArrayCreate(3,3,3,3)
	
	For i =  0 To 3
	For j =  0 To 3
	For k =  0 To 3
	For l =  0 To 3
		
	DebugLog(i+","+j+","+k+","+l+"= "+m+" /  "+bscvmArrayLinearIndexGet(this,i,j,k,l))
	m=m+1
	
	Next
	Next
	Next
	Next
	DebugLog "tail="+this\tail
	
End Function

bscvmArrayTest()</textarea> <br><br></td></tr></table><br>
<a name="470601"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> ... <br><br></td></tr></table><br>
<a name="472084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Preprocessor<br><br>BlitzScript3D Engine now features a Case-Sensitive Mass Text Replacement Preprocessor. Although extremely simple, the Preprocessor allows you to code with BlitzScript3D in very interesting ways. It also works hand in hand with 'Const' keyword allowing you to replace labels with values, strings, and expressions.<br><br>Multi-Dimensional Arrays are pratically complete and will be available in the next update. Once they're in and have been fully tested, I will be implementing functions. I have the framework for functions in place, just have to wrap my brain around dealing with local vars. <br><br>BlitzScript3D is looking really good and the performance isn't very shabby. <br><br></td></tr></table><br>
<a name="472118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Synchronist</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lookin' good Frank... 8^) <br><br></td></tr></table><br>
<a name="472189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Conan</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep! Real cool! <br><br></td></tr></table><br>
<a name="472295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drey</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, scripts are sweet for level editors.  Say u're making a level and u want the AI to change objectives and object to start moving when you flip a switch.  And editor with an scriptor should make this easy if i'm understanding this right.  Say, u want a wave of enemies to bust down from a roof and turn on once u stop on some trigger.  Well, on the trigger, u could put "code" "in" to it.  Then once the collision happens, it'll kick the sequence u have programmed in there.  There's ways to hardcore it, but u can make modifications really easy with editor and scriptor.  The point of a script isn't to replace hardcoding.  It's to allow flexiblity and sweet events to happen without having to give a blitz3d compiler to the world(which u'll get in trouble for).<br><br>So far, BlitzScript3D seems to be pretty similar to what i was preparing for myself.  But the biggest difference is, it would also have functions that are in my engine.  control over the Actor, Collision, Health Modifiors, Armor, Lighting, Particles, Sound, Movers/Waypoint Systems.  <br>So it'll also have say "Actor_LightPackage"<br><br>Event Collision_Box_5( ActorHandle )<br><br>   Actor_SetLightPackage(Actor, (New Light Package) ) ; sets new lights for that room that will be applied to the actor.<br><br>End Event<br><br>I'm doubting that BlitzScript3d could access my types that are hardcoded in my engine.  So i'm probably still have to create a wrapper for those correct? <br><br></td></tr></table><br>
<a name="472355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm doubting that BlitzScript3d could access my types that are hardcoded in my engine. So i'm probably still have to create a wrapper for those correct? <br></div><br>SortOf, considering the BlitzScript3D Engine is compiled with your Blitz App. You will have to 'hardcode' access to them in BlitzScript3D Compiler and VM to expose them within scripts. To do this, you will have to:<br><br>1) Add a "Command_Label" and Command Index to the bscvmCompilerCallIndex. This allows the Compiler to recognize the 'command' within a script as a valid function.  <br><br>2) Add a Command Call to your function in the bscvmThreadCallIndex to be executed by the VM. This tells the VM what command to execute when processing the compiled script. <br><br>Thats it. These functions are just two big select case structures. They provide a lot of flexibility and they're fast. You can get a greater idea if you look at the code modules, but, I'll explain here as well.<br><pre class=code>bscvmCompiler.bb:  Function bscvmCompilerCallIndex

Purpose: Compiler Call Selector. Makes Commands Calls recognizable by compiler from scripts.
The Return values match the Command Index# called in the bscvmThreadCallIndex. You can easily
 add new commands to the scripting engine by adding a case here and the bscvmThreadCallIndex.

Add a New Command:
	Case "your_command_label" Return Index#
		
Parameters: bscvmCompiler Object

Return: bscvmThreadCallIndex#</pre><br><br><pre class=code>bscvmThread.bb: Function bscvmThreadCallIndex 

Purpose: VirtualMachine Call Selector. Called by bscvmThreadProcess to executes Command calls.
Parameter values are stored in the this\arg[0-15] and the Return value is stored in this\ax. 
The Select Case Values are matched to the command labels in the bscvmCompilerCallIndex. 
You can easily add new commands to the scripting engine by adding a case here and the 
bscvmCompilerCallIndex.

Add a Command w/ Arguments:		
	Case Index# Your_Function(this\arg[0])

Add a Command w/ Return Value:	
	Case Index# this\ax=Your_Function(this\arg[0]) 

Add a Command with no Arguments:
	Case Index# Your_Function()

Add a Command w/Return Value and no Arguments:
	Case Index# this\ax=Your_Function() 

Parameters: bscvmThread Object
Return: None.</pre>The VM passes and returns string, float, and integer values with functions. If your functions work with types internally, you may have to use Object/Handle command to pass or return a specified type or use globals. I personally use a Array_Of_Types Indexing System. Anyhow, the two steps above is all that is needed to expose your 'hardcoded' functions, arrays, variables, etc within script. <br><br>I'm going to eventually append all the code modules into one file, so all you have to do is Include "BlitzScript3D.bb", BlitzScript3DStart() {initialize}, BlitzScript3DUpdate() {main loop}, and BlitzScript3DStop() {shutdown}. <br><br></td></tr></table><br>
<a name="472452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drey</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> yea, i figured i'll have to do something like that.  that's fine tho.  Hmm, very interesting.  I have your system on my computer.  I'm checking it out.  <br><br>It's pretty much like the system i wanted to make.  So i figure i'll just use it.  I just want short lil rounties and start ups occur when events occur.  If u programmed with visual basic before, then you'll pretty much have an idea on how i want the editor to work.  Timers and all that sweetness.<br><br>I knew making something a flexible has i want would make a while, but your scripter took a big part of the work out.  Thanks for making it free.  :-D. <br><br></td></tr></table><br>
<a name="472571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drey</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been thinking about the scripting system.  I guess it really depends on the developers goals.  All this examples are just thoughts.  I haven't tried them out yet.<br><br>If one's goal is to make there game modible, then the Script System is good because it shouldn't get you into legal troubles.<br><br>If you're only consider about making the game yourself tho, no  community.  There's other options too.  I was thinking this.<br><br>So the idea has 3 levels.  Engine Style Includes, Main, Custom Hardcoding for levels.  <br><br>Basicly, the idea is u can have an .exe per level if u're cool with that.  U'll have a StartUp.exe.  That's like your main menu or whatever.  Then, when u load a game or pick a stage.  The custom exe gets called and StartUp.exe is ended.<br><br>In your custom exe,  U'll probably have this<br><pre class=code>
Include "Engine" ; The custom types and functions u've made.
Include "Main" ; controls and such

**now you put your custom per level coding here"

</pre><br><br>This would be faster than using a script system.  Just bigger overall because blitz3d doesn't make DLLs( :( ).<br><br>If blitz3d has memory addressing for it's types( not this array handle stuff ).  U could actually have 2 .exes running per level.  So say u're loading your level, while the types and entities are being made, u send there address to a .txt file.  Then in your other .exe(the script), u load up the address from your main.exe into your level(x).exe and start your checks( this probably could work for entites, not types tho ).<br>Because level.exe doesn't generate graphics on it's own screen and such, it shouldn't slow anything down really.  <br><br>Again, DLLs would make this easier and cleaner, but i think u guys get the idea.  <br><br>Just wanted to share some thoughts. <br><br></td></tr></table><br>
<a name="472977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Drey<br><br>I intend to use scripting for Interactive Logic and Macros in my Games and Applications. Rendering and other performance critical functions will be hardcoded. So in other words, the Script tells the engine "StartParticle(fire,x,y,z)" and the Engine generates sprites, textures them, orientates them, and culls them when out of view.<br><br>Most modern day games comprise of 3 elements: Engine, Media Data, and Logic Data. The 'Engine' manages network, rendering, collision, and sound. 'Media Data' provides the external Game Content. 'Logic Data' defines Interactive GamePlay.  Scripting provides a means of of creating Programmable Logic Data.<br><br>Each element is encapsulated so that they can be combined to create new games. If you hardcode any two of these elements together you will have to restart from scratch if you want to use them in a another project. Even if your making the game for yourself, you may want to employ the 'Engine' in one project, Media Data and Logic Data in others. <br><br></td></tr></table><br>
<a name="472978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/logs/userlog.php?user=223&amp;log=401" target="_blank">New BlitzScript3D Update 123004</a> <br><br></td></tr></table><br>
<a name="474825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Was digging through some old code and found by old ACTIONBuilder code. The purpose of the ACTIONBuilder was to scan *.bb files, find Functions, and generate a Function Call Select...Case Tree from them. Saves lots of time adding a large number of functions to the FunctionCall Select...Case.<br><br>I've decided to add this utility to BlitzScript3D as well. I'm totally redesigning it. It will make adding functions to the Scripting Engine extremely simple. I've separated the compiler and vm function callindex functions into independent files. These functions are just two large select case structures used in Script Engine to identify commands in script and execute them in the VM. <br><br>The new bscvmCallBuilder utility will generate a compiler and vm function callindex file. So no messing around with the code and tracking index numbers. Just run bscvmCallBuilder and it will parse the *.bb and *.h (prototype) generate compiler and vm function callindex files for you.<br><br>Found it extremely useful when adding other code lib functions to the scripting engine. <br><br></td></tr></table><br>
<a name="475083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> How was that assembly code working? <br><br></td></tr></table><br>
<a name="475235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> bscvmCallBuilder  complete and totally out performs its predecessor ACTIONBuilder. This utility will pratically automate adding functions and macros the scriptengine.<br><br><div class="quote"> How was that assembly code working?  <br></div> Im not sure what assembly you refering too. Please elaborate. Thnx <br><br></td></tr></table><br>
<a name="475248"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> You posted opcodes above ... looked like assembly language.  Is that just for the virtual machine? <br><br></td></tr></table><br>
<a name="475283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Those opcodes were the starting point for my VM. The opcodes instuct the processor how to move data on the stack and registers. The VM mimics  a processor consisting of a stack array and register variables.<br><br>I dont use the code specifically, but they give a idea what direction to go in. I'm quite happy with me results. just have to get functions in. <br><br></td></tr></table><br>
<a name="476259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found several bugs in the scripting system that have demanded my immediate attention. The If...Then...Else is limited and failing. This is basis for simple logic and must work with no errors. Select...Case on hold. As soon as the resolve the If...Then problems I'll resume getting functions in<br><br>In the meantime, I've added 'BlitzScript...EndBlitzScript' Keywords. These keywords allow you to put several individual scipts in a single file verses being forced to have a individual file for each script. This can substitute for Functions for now. <br><br></td></tr></table><br>
<a name="478702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> ... <br><br></td></tr></table><br>
<a name="478709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is stupid.  BVM works perfectly.  Use it. <br><br></td></tr></table><br>
<a name="478738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Josha, <br><br>Remember the good ole days of Metal? <br><br></td></tr></table><br>
<a name="478743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Frank,<br><br>Remember the good ole days of all your community projects never being finished? <br><br></td></tr></table><br>
<a name="478747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Noel Cower (Posted 2005-01-16 16:13:00) <br> <br>Frank, <br><br>Remember the good ole days of all your community projects never being finished? <br></div>This isn't one of them. <br><br></td></tr></table><br>
<a name="478750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> This wasn't a community project either. <br><br></td></tr></table><br>
<a name="478752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope. I only worked on Project Plasma FPS and recently started PW3D as a Community Project. So when folks start blabbing about how many unfinished Projects there are, all I can do is chuckle out loud. As I told many before a project never really dies, it just changes names. <br><br></td></tr></table><br>
<a name="478845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Remember the good ole days of Metal? <br></div><br>Yes:<br><a href="http://www.idigicon.com/products/pdetails.asp?id=80" target="_blank">http://www.idigicon.com/products/pdetails.asp?id=80</a> <br><br></td></tr></table><br>
<a name="478847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent! <br><br></td></tr></table><br>
<a name="478970"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyways, the point is, I finished it.<br><br>Now if only I had the same art budget that they had to design the box with. <br><br></td></tr></table><br>
<a name="478972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol <br><br></td></tr></table><br>
<a name="478982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are Noel Cower and Halo the same person?? They both sound like retards. <br><br></td></tr></table><br>
<a name="479012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> I manage to hunt down and kill the If-Then-Else Bug that was infesting BlitzScript3D.  The problem was  between both the compiler and VM in the assignment of the instruction loading. <br><br>Now that its resolved I can really see how limited my current implementation of 'bscvmLabels' really is. You cannot do anyting fancy. In fact, your limited to evaluating a single expression at a time which makes for pain in the arse scripting. <pre class=code>Example:
If n=1 Then dostuff()
If n=2 Then dostuff()
If n=3 Then dostuff()
;you get the point</pre>This has taken priority over implementing functions because without Labels working properly you cannot jump back and forth between instruction offsets. Jumping is needed for Unconditional Loops, Conditional Loops, Nested Conditions and Functions. I'm to work on expanding this functionality asap. When complete you should be able to support Nested If..Then...Else...EndIf and 'Label &amp; Goto' Keywords.<br><br>In the meantime, I've added 'BlitzScript...EndBlitzScript' Keywords. These keywords allow you to put several individual scipts in a single file verses being forced to have a individual file for each script. This can substitute for Functions for now. <br><br>The bscvmCommandInstaller completey and totally out performs its predecessor ACTIONBuilder. This utility will automate adding functions and macros the scriptengine and its huge work saver.<br><br>Expect an update within the week. <br><br></td></tr></table><br>
<a name="479051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Clarks</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> Frank Taylor:<br><br>im in the works of creating my own virtual machine and i already ran into problems with if statements.<br><br>ex.(if n = 3)<br><br>how exactly would that piece of code be turned to byte code with out some sort of coruption. the compiler needs to know that theres a comparison going on and not an assignment.<br><br>load n<br>pushint 3<br>comp<br>if_false_jump  (to someline)<br><br>how exactly does the compiler know what line the vm should jump to.<br><br>and what about the keywords( and, or , xor, not) <br><br></td></tr></table><br>
<a name="479132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> Clarks,<br><br>Well, this is going to deserve an in depth answer and it would be easier to explain if we could compare notes. I have one question: is your  language compiled or interpreted?<br><br> I started with <a href="/codearcs.php?code=51" target="_blank">Mark Sibly's Compiler Code</a> because it had a excellent way of parsing expressions and tokenizing BASIC statements, keywords, etc and output instructions. Once you are able to tokenize the statements and write instructions with your compiler, its easier to construct the VM. It took a lil research on assembly  to get a good understanding of what the instructions do.<br><br>Armed with a some info on Assembly,  I designed a simple VM that consists of a couple Arrays (Stacks), a couple of  Variables (Registers), and Constants (Instructions). The VM moves values in / out of variables, push/pop values on and off the Stack, performs <i>simple</i> compares (=,&lt;,&gt;,etc), perform simple math operations (*,/,+,-), and perform instruction jumps. The compiler outputs the instructions to do this and these instructions are the VM's Constant Instruction Values. <br><br><div class="quote"> how exactly does the compiler know what line the vm should jump to. <br></div> <br><br>So with this background info I can tell how labels work in BlitzScript3D. The compiler outputs an instruction called BSCVM_OP_LABEL and a operand that is the ID of that Label. When the VM <b>loads</b> the compiled script and comes across the BSCVM_OP_LABEL instuction, it creates a label,  assigns it the id and stores the <b>Instruction Pointer</b> value to the label. <br><br>When the VM executes each instructoin stored in the Instruction Array. Instruction Pointer is incremented to the next instruction. So when the VM runs across the BSCVM_OP_LABEL, BSCVM_OP_JZ or BSCVM_OP_JMP instructions, the it accesses the Label's ID and sets the Intruction Pointer valued stored in the Label.<br><br><img src="http://techlord.blackeve.com/vm.gif"><br>__# = Label ID <br><br></td></tr></table><br>
<a name="479487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Clarks</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also started with marks code too.<br>my compiler takes the source and compiles it to byte code.<br>the compiler is not fully developed yet. the vm will take the byte codes and executed it.  so its interpreted. <br><br>label for labels, jmp for jump, what does the jz stand for.<br><div class="quote"> <br>So with this background info I can tell how labels work in BlitzScript3D. The compiler outputs an instruction called BSCVM_OP_LABEL and a operand that is the ID of that Label. When the VM loads the compiled script and comes across the BSCVM_OP_LABEL instuction, it creates a label, assigns it the id and stores the Instruction Pointer value to the label. <br><br>When the VM executes each instructoin stored in the Instruction Array. Instruction Pointer is incremented to the next instruction. So when the VM runs across the BSCVM_OP_LABEL, BSCVM_OP_JZ or BSCVM_OP_JMP instructions, the it accesses the Label's ID and sets the Intruction Pointer valued stored in the Label.<br> <br></div><br><br>can you explain this a little bit more. <br><br></td></tr></table><br>
<a name="479513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> Clark, <br><br>A little reading on <a href="http://www.jegerlehner.ch/intel/IntelCodeTable.pdf" target="_blank">80x86 Assembler Codes</a> will help a great deal. I'm curious as to how you are <i>executing</i> instructions. If you havent downloaded Blitzscript3D, do so, and look over the bscvmCompiler.bb and bscvmThread.bb files. Heres what my VM looks like (ignore the hex codes their useless):<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">;Instruction Codes

Const	BSCVM_OP_MOV_EAX_ECX	=	1	;$01	
Const 	BSCVM_OP_MOV_ECX_EAX	=	2	;$02	
Const	BSCVM_OP_MOV_EAX_VAR	=	3	;$03	
Const	BSCVM_OP_MOV_ECX_VAR	=	4	;$04	
Const	BSCVM_OP_MOV_VAR_EAX	=	5	;$05	
Const	BSCVM_OP_MOV_VAR_ECX	=	6	;$06	
Const	BSCVM_OP_MOV_EAX_VALUE	=	7	;$07	
Const	BSCVM_OP_MOV_ECX_VALUE	=	8	;$08	
Const	BSCVM_OP_MOV_VALUE_EAX	=	9	;$09	
Const	BSCVM_OP_MOV_VALUE_ECX	=	10	;$0A	
Const	BSCVM_OP_PUSH_EAX	=	11	;$0B	
Const	BSCVM_OP_POP_EAX	=	12	;$0C	
Const	BSCVM_OP_POP_ECX	=	13	;$0D	
Const	BSCVM_OP_POW_EAX_ECX	=	14	;$0E	
Const	BSCVM_OP_MUL_EAX_ECX	=	15	;$0F	
Const	BSCVM_OP_SHL_EAX_ECX	=	16	;$10	
Const	BSCVM_OP_DIV_EAX_ECX	=	17	;$11	
Const	BSCVM_OP_SHR_EAX_ECX	=	18	;$12	
Const	BSCVM_OP_ADD_EAX_ECX	=	19	;$13	
Const	BSCVM_OP_NEG_EAX	=	20	;$14	
Const	BSCVM_OP_SUB_EAX_ECX	=	21	;$15	
Const	BSCVM_OP_INC_EAX	=	22	;$16	
Const	BSCVM_OP_DEC_EAX	=	23	;$17	
Const	BSCVM_OP_SEQ_EAX	=	24	;$18	
Const	BSCVM_OP_SNE_EAX	=	25	;$19	
Const	BSCVM_OP_SLE_EAX	=	26	;$1A	
Const	BSCVM_OP_SGE_EAX	=	27	;$1B	
Const	BSCVM_OP_SGT_EAX	=	28	;$1C	
Const	BSCVM_OP_SLT_EAX	=	29	;$1D	
Const	BSCVM_OP_SLE_STR	=	30	;$1E	
Const	BSCVM_OP_SGE_STR	=	31	;$1F	
Const	BSCVM_OP_SGT_STR	=	32	;$20	
Const	BSCVM_OP_SLT_STR	=	33	;$21	
Const	BSCVM_OP_AND_EAX	=	34	;$22	
Const	BSCVM_OP_OR_EAX	=	35	;$23	
Const	BSCVM_OP_XOR_EAX	=	36	;$24	
Const	BSCVM_OP_JMP	=	37	;$25	
Const	BSCVM_OP_JZ	=	38	;$26	
Const	BSCVM_OP_LABEL	 =	39	;$27	
Const	BSCVM_OP_PUSH_CALL	=	41	;$29	
Const	BSCVM_OP_POP_CALL	=	42	;$2A	
Const	BSCVM_OP_PUSH_ARG	=	43	;$2B	
Const	BSCVM_OP_POP_ARG	=	44	;$2C	
Const	BSCVM_OP_RETURN	=	45	;$2D	
Const	BSCVM_OP_NEWVAR	=	46	;$2E	
Const	BSCVM_OP_MUL_STR	=	48	;$30
Const	BSCVM_OP_NEWARRAY	=	49	;$31
Const	BSCVM_OP_MOV_EAX_HEAD	=	50	;$32
Const	BSCVM_OP_MOV_DIM_EAX	=	51	;$33
Const	BSCVM_OP_MOV_EAX_DIM	=	52	;$34
Const	BSCVM_OP_MOV_IDX_EAX	=	53	;$35
Const	BSCVM_OP_MOV_EAX_IDX	=	54	;$36
Const	BSCVM_OP_ARR_POP	=	55	;$37
Const	BSCVM_OP_IDX_POP	=	56	;$38
Const	BSCVM_OP_POP_ARR	=	57	;$39
Const	BSCVM_OP_ARR_SIZE	=	58	;$3A
Const	BSCVM_OP_NEWBSR	=	59	;$3B	
Const	BSCVM_OP_PUSH_BSR	=	60	;$3C	
Const	BSCVM_OP_POP_BSR	=	61	;$3D
Const	BSCVM_OP_CONCENATE_EAX_ECX	=	62	;$3E
Const	BSCVM_OP_MOV_DAT_VALUE	=	63	;3F
Const	BSCVM_OP_MOV_VAR_DAT	=	64	;40
Const	BSCVM_OP_RESTORE	=	65	;41
Const	BSCVM_OP_OPENTHREAD	=	66	;42
Const	BSCVM_OP_CLOSETHREAD	=	67	;43</textarea><br>Heres the actual VM object. Each script gets its own self-contained VM 'Thread' consisting of its own stacks, registers, and flags. <pre class=code>Type bscvmThread
	;Purpose: bscvmThread Script Object.
	Field id%
	Field parentid%
	Field typeid%
	Field label$
	Field filename$
	Field instruction$[BSCVMTHREAD_INSTRUCTION_MAX%]
	Field instructionPTR%
	Field instructionsize%
	Field stack$[BSCVMTHREAD_STACK_MAX%]
	Field stackPTR%
	Field arg$[BSCVMTHREAD_ARG_MAX%]
	Field call%
	Field ax$
	Field cx$
	Field zero%
	Field run% ;state -1:Infinite loop, 0:halt, &gt;0:Specified Loops  
	Field schedule%
	Field scheduleCTR%
End Type</pre>The instructions are stored the bscvmThread\instruction[] Array. When 'executed' the VM  loops through the elements in the instruction array. This is handled by the bscvmThreadUpdate() Function <pre class=code>Function bscvmThreadUpdate()
	;Purpose: Updates all Virtual Machine bscvmThreads see bscvmUpdate Function 
	;Parameters: None
	;Return: None
	For this.bscvmThread=Each bscvmThread

		If this\schedule&gt;0
			this\scheduleCTR=this\scheduleCTR+1
			If this\scheduleCTR=this\schedule 
				this\run=1
				this\scheduleCTR=0
			EndIf	
		EndIf
		
		If this\run
			Repeat
				bscvmThreadProcess(this)
			Until this\instructionPTR&gt;this\instructionSize
			this\instructionPTR=0 ;reset instruction
			If this\run&gt;0 this\run=this\run-1
		EndIf	
		
	Next
End Function</pre>The bscvmThreadProcess() Function selects the Instruction and manipulates the Instruction PTR, Stack, AX, and ZeroFlag.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Function bscvmThreadProcess(this.bscvmThread)
	;Purpose: Called from the bscvmThreadUpdate() Function; Core of the Virtual Machine.
	;	Processes bscvmThread Operators and Operands;
	;	Increments Instruction Stack
	;Parameters: bscvmThread Object
	;Return: None

	Select Int(this\instruction[this\instructionPTR%])
		;x85 Assembly opcodes methods
		Case BSCVM_OP_MOV_ECX_EAX ;assigns this\ax value to this\cx
			this\cx=this\ax
			this\instructionPTR%=this\instructionPTR%+1 ;inc to next instruction
		Case BSCVM_OP_MOV_VAR_EAX ;assigns this\ax value to var
			bscvmVarID(this\instruction[this\instructionPTR%+1])\value=this\ax
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_MOV_EAX_VAR ;assigns var value to this\ax
			this\ax=bscvmVarID(this\instruction[this\instructionPTR%+1])\value
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_MOV_EAX_VALUE ;assigns const value to this\ax
			this\ax=this\instruction[this\instructionPTR%+1]
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_PUSH_EAX ;pushes this\ax value to this\bscvmStack
			this\stack[this\stackPTR%]=this\ax
			this\stackPTR%=this\stackPTR%+1
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_POP_ECX ;pops top this\bscvmStack value to this\cx
			this\stackPTR%=this\stackPTR%-1
			this\cx=this\stack[this\stackPTR%]
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_POP_EAX ;pops top this\bscvmStack value to this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=this\stack[this\stackPTR%]
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_PUSH_CALL ;pushes call value to this\bscvmStack
			this\stack[this\stackPTR%]=this\instruction[this\instructionPTR%+1]
			this\stackPTR%=this\stackPTR%+1
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_POP_CALL ;popc ;pops this\bscvmStack value to call,executes
			this\stackPTR%=this\stackPTR%-1
			this\call=this\stack[this\stackPTR%];(method)
			bscvmThreadCallIndex(this)
			;For bscvmloop=0 To BSCVMTHREAD_ARG_MAX%:this\arg[bscvmloop]="":Next;clear args my be removed for performance
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_PUSH_ARG ;pushes this\ax value to argbscvmStack
			this\stack[this\stackPTR]=this\ax
			this\stackPTR=this\stackPTR+1
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_POP_ARG ;pops arg value off argbscvmStack assign arg
			this\stackPTR=this\stackPTR-1
			this\arg[this\instruction[this\instructionPTR%+1]]=this\stack[this\stackPTR]
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_MUL_EAX_ECX ;integer divide this\ax with this\cx stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=Float(this\stack[this\stackPTR%])*Float(this\ax)
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_MUL_STR
			this\stackPTR%=this\stackPTR%-1
			this\ax=String(this\stack[this\stackPTR%],this\ax)
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_POW_EAX_ECX	
			For bscvmloop = 1 To this\cx:this\ax=Float(this\ax)*Float(this\ax):Next ;multiplies this\ax to itself by this\cs times
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_DIV_EAX_ECX ;float divide this\cx with this\ax stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=Float(this\stack[this\stackPTR%])/Float(this\ax)
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_NEG_EAX ;
			this\ax=-Float(this\ax)
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_ADD_EAX_ECX ;float adds this\ax with this\cx stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=Float(this\stack[this\stackPTR%])+Float(this\ax)
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_CONCENATE_EAX_ECX ;float adds this\ax with this\cx stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=this\stack[this\stackPTR%]+this\ax
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SUB_EAX_ECX ;float subtracts this\ax from this\cx stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=Float(this\stack[this\stackPTR%])-Float(this\ax)
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SHL_EAX_ECX ;float shift left this\ax by this\cx stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=this\stack[this\stackPTR%] Shl this\ax
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SHR_EAX_ECX ;float shift right this\ax by this\cx stores value into this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=this\stack[this\stackPTR%] Shr this\ax
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_AND_EAX	
			If this\cx And this\ax this\zero=True
			this\instructionPTR%=this\instructionPTR%+1	
		Case BSCVM_OP_OR_EAX	
			If this\cx Or this\ax this\zero=True
			this\instructionPTR%=this\instructionPTR%+1	
		Case BSCVM_OP_XOR_EAX	
			If this\cx Xor this\ax this\zero=True
			this\instructionPTR%=this\instructionPTR%+1	
		Case BSCVM_OP_SLT_EAX ;compares numeric this\ax&lt;this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If Float(this\ax)&lt;Float(this\stack[this\stackPTR%]) this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SGT_EAX ;compares numeric this\ax&gt;this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If Float(this\ax)&gt;Float(this\stack[this\stackPTR%]) this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SLE_EAX ;compares numeric this\ax&lt;=this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If Float(this\ax)&lt;=Float(this\stack[this\stackPTR%]) this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SGE_EAX ;compares numeric this\ax&gt;=this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If Float(this\ax)&gt;=Float(this\stack[this\stackPTR%]) this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SEQ_EAX ;compares numeric/string this\cx&lt;&gt;this\ax sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			this\cx=this\stack[this\stackPTR%] ;testing
			If this\ax&lt;&gt;this\stack[this\stackPTR%] this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SNE_EAX ;compares numeric/string this\ax=this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If this\ax=this\stack[this\stackPTR%] this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SLT_STR ;compares string this\ax&lt;this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If this\ax&lt;this\stack[this\stackPTR%] this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SGT_STR ;compares string this\ax&gt;this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If this\ax&gt;this\stack[this\stackPTR%] this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SLE_STR ;compares string this\ax&lt;=this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If this\ax&lt;=this\stack[this\stackPTR%] this\zero=True
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_SGE_STR ;compares string this\ax&gt;=this\cx sets script zero flg
			this\stackPTR%=this\stackPTR%-1
			If this\ax&gt;=this\stack[this\stackPTR%] this\zero=True
			this\instructionPTR%=this\instructionPTR%+1	
		Case BSCVM_OP_JZ ;if this\zero true jump to label
  	     		If this\zero
				this\instructionPTR%=bscvmLabelID(this\instruction[this\instructionPTR%+1])\offset
				this\zero=False
			Else
				this\instructionPTR%=this\instructionPTR%+2
			EndIf
		Case BSCVM_OP_JMP ;unconditional jump to label
			this\instructionPTR%=bscvmLabelID(this\instruction[this\instructionPTR%+1])\offset
		Case BSCVM_OP_LABEL
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_MOV_DIM_EAX	 ;assigns this\ax value to array dim
			bscvmArray.bscvmArray=bscvmArrayID(this\instruction[this\instructionPTR%+1])
			bscvmArray\size[this\instruction[this\instructionPTR%+2]]=Int(this\ax)+1
			dimension=this\instruction[this\instructionPTR%+2]
			size=bscvmArray\size[this\instruction[this\instructionPTR%+2]]
			bscvmArray\dimensions=this\instruction[this\instructionPTR%+2]
			this\instructionPTR%=this\instructionPTR%+3
		Case BSCVM_OP_MOV_EAX_DIM  ;assigns array dim to this\ax 
			this\ax=bscvmArrayID(this\instruction[this\instructionPTR%+1])\size[this\instruction[this\instructionPTR%+2]]
			this\instructionPTR%=this\instructionPTR%+3
		Case BSCVM_OP_MOV_EAX_HEAD
			this\ax=bscvmArrayID(this\instruction[this\instructionPTR%+1])\head
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_ARR_SIZE ;gets array size, adjust master array pointer
			bscvmArray.bscvmArray= bscvmArrayID(this\instruction[this\instructionPTR%+1])
			bscvmArray\head=bscvmMasterArrayPTR
			bscvmArray\tail=1
			For bscvmloop=0 To bscvmArray\dimensions
				bscvmArray\tail=bscvmArray\tail*bscvmArray\size[bscvmloop]
			Next
			bscvmMasterArrayPTR=bscvmMasterArrayPTR+bscvmArray\tail
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_ARR_POP ;pops array idx, assigns value to this\ax
			this\stackPTR%=this\stackPTR%-1
			this\ax=bscvmMasterArray(this\stack[this\stackPTR%])
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_IDX_POP
			this\stackPTR%=this\stackPTR%-1
			this\ax=this\stack[this\stackPTR%]
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_POP_ARR ;pops array idx, assigns this\ax to array
			this\stackPTR%=this\stackPTR%-1
			bscvmMasterArray(this\stack[this\stackPTR%])=this\ax
			this\instructionPTR%=this\instructionPTR%+1	
		Case BSCVM_OP_MOV_DAT_VALUE
			bscvmArray.bscvmArray=bscvmArrayID(this\instruction[this\instructionPTR%+1])
			If bscvmArray\Head+bscvmArray\PTR&lt;=bscvmArray\size[0]
				bscvmMasterArray(bscvmArray\head+bscvmArray\PTR)=this\instruction[this\instructionPTR%+2]
				bscvmArray\PTR=bscvmArray\PTR+1
			EndIf
			this\instructionPTR%=this\instructionPTR%+3
		Case BSCVM_OP_MOV_VAR_DAT		
			bscvmArray.bscvmArray=bscvmArrayID(this\instruction[this\instructionPTR%+1])
			If bscvmArray\Head+bscvmArray\PTR&lt;=bscvmArray\size[0]
				bscvmVarID(this\instruction[this\instructionPTR%+2])\value=bscvmMasterArray(bscvmArray\head+bscvmArray\PTR)
				bscvmArray\PTR=bscvmArray\PTR+1
			EndIf
			this\instructionPTR%=this\instructionPTR%+3
		Case BSCVM_OP_RESTORE
			bscvmArrayID(this\instruction[this\instructionPTR%+1])\PTR=0
			this\instructionPTR%=this\instructionPTR%+2			
		Case BSCVM_OP_PUSH_BSR ;pushes bsr label to this\bscvmStack
			this\stack[this\stackPTR%]=this\instruction[this\instructionPTR%+1]
			this\stackPTR%=this\stackPTR%+1
			this\instructionPTR%=this\instructionPTR%+2
		Case BSCVM_OP_POP_BSR ;popc ;pops this\bscvmStack value to BSR,executes
			this\stackPTR%=this\stackPTR%-1
			this\call=this\stack[this\stackPTR%];(method)
			;jmp to BSR
			this\instructionPTR%=this\instructionPTR%+1
		Case BSCVM_OP_OPENTHREAD
			
		Default
			RuntimeError( "VM Error: Invalid Instruction ["+this\instructionPTR%+"]="+this\instruction[this\instructionPTR%]+Chr(13)+"Next Instruction ["+(this\instructionPTR%+1)+"]="+this\instruction[this\instructionPTR%+1])
			;this\instructionPTR%=this\instructionPTR%+1		
	End Select
End Function</textarea><br>I simplified the Compiler code generated for comparisions. <pre class=code>cmp  ecx,eax
slt  eax
and  eax,255
and  eax,eax</pre>Is equal to <pre class=code>
BSCVM_OP_SLT
</pre><br><br>BSCVM_OP_JZ or ("JZ")  stands for 'Jump if Zero'. As you can see the VM uses a variable that represents the Zero Flag in a CPU. The IF and ELSEIF keywords generate comparision codes: SEQ, SLT, SGT,SNE,SGE, SLE  and jump code: JZ.<br><br>When the VM executes the Comparison Code it performs the comparison on the values in the AX and CX 'Register' vars. If the comparison fails it sets the Zero Flag to 1 otherwise it remains 0. When the VM executes the JZ instruction it will perform a JMP if the Zero Flag is set True, otherwise it will not. JMP is an unconditional Jump.<br><br>The confusing part is that VM performs the comparisions in a inverted fashion to set the Zero flag. So SEQ doesnt mean <b>if ax=cx zero=True</b>, It means <b>if ax&lt;&gt;cx zero=true</b> . It took a while for me to get this to work. I'm currently rewritting this entire portion of the Compiler, because IF...ELSE. expressions are very limited. You can not compile multiple statement conditions, ELSEIF,  and Nested IF...ELSE, etc. The VM doesnt require any rewrite because the instructions generated are the same, just the order is different. As soon as I get it working I'm going to make an official update. If you want the 'unofficial' wip.zip let me know and I'll post a link for DL. <br><br></td></tr></table><br>
<a name="479519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Clarks</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> 80x86 Assembler Codes:<br><br>i took a look at them, my head started to hurt.<br><br>i already had downloaded your blitzscript3d, and viewed the demo, impressive.<br><br>im not executing any instructions yet,  i didnt even start coding the vm.  im just looking for ways to compile a file very efficiently and offer flexiblity and power in the language. trying to make sure that the codes produced are efficient and effective, easy for the vm to understand and execute as fast as possible. for instance, the (cmp ecx,eax) is not how i had plan to do it, but your overview and your source opened my eyes up some.<br><br>best luck on BlitzScript3D, if i continue with my project ill give you an update. <br><br></td></tr></table><br>
<a name="479525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> i took a look at them, my head started to hurt <br></div><br>Clarks,<br><br>My head still hurts -  hehe. That probably wasn't the best article. I read several articles before I really started to get a feel for it.<br><br>I'm nearly complete with this version of BlitzScript3D. I'm very interested in watching your project evolve as well. I plan on using the BlitzScript3D Engine as the scripting solution for several <a href="/posts.php?topic=39819" target="_blank">Games</a> and <a href="/posts.php?topic=42211" target="_blank">Applications</a>. <br><br>Ultimately, I hope others find BlitzScript3D as useful learning tool. I've learned a great deal about programming from working on this project. My view on coding is much different. I feel enlightened. I'm sure you will experience the same enlightenment if you continue your project as well. <br><br></td></tr></table><br>
<a name="480560"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/logs/userlog.php?user=223&amp;log=401" target="_blank">New BlitzScript3D Update 012005</a> <br><br></td></tr></table><br>
<a name="562611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone using BlitzScript3D? I will be gearing up to add features on the TODO List in the <a href="/logs/userlog.php?user=223&amp;log=401" target="_blank">Worklog</a>. Would like to get some feedback if possible. <br><br></td></tr></table><br>
<a name="562773"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would like to have used BlitzScript3D in some of my projects, but unfortunately it doesn't support the features I need. BlitzScript3D would be much nicer if it had function, custom type, and conditional loop (while..wend) support.<br><br>Since it didn't look like BlitzScript3D was ever going to support these, I actually just began writing my own scripting engine just a couple of days ago. Currently, my compiler (I haven't even began programming the VM yet) supports number+string expressions, and if..then statements, in addition to custom type support with New and Delete keywords. I soon plan to impliment select..case conditions, conditional loops, overloadable functions, and an OPcode optimizer (I already know exactly how the optimizer is going to work).<br><br>If you would like to continue developing BlitzScript3D, I might be able to help you a little with some of these features if you plan to impliment them, although I doubt I could be any help since my compiler is probably totally different from yours (my scripting language's syntax is more BlitzMax style than BlitzBasic style). <br><br></td></tr></table><br>
<a name="562785"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> John J,<br><br>I took a short  break:) Functions and Conditional Loops are on the agenda. I need these features as well. <br><br>I'm very interested how you are designing your Scripting Engine. I would like to compare notes. Although different in code, they may be very similar in operation. I'm completely open to any advice you have on adding custom types, select..case conditions, conditional loops, overloadable functions features to BlitzScript3D. <br><br></td></tr></table><br>
<a name="562826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would do select..case conditions and conditional loops basically the same as I did if..then conditions: the "TOKEN_IF" case takes care of the entire if..then..else..endif" and all it's statements just like Mark Sibley's example. Here's my if..then..else..endif code (single or multi line):<br><br><pre class=code>
	Case TOKEN_IF
		GSC_ParseExpression()
		If GSC_TokenType &lt;&gt; TOKEN_THEN Then
			GSC_AddError("Expected "+Chr(34)+"Then"+Chr(34))
			GSC_SkipLine(): GSC_NextToken()
			Return
		End If
		LabelElse = GSC_UniqueLabel()
		WriteLine GSC_OutputFile, "    jz    _" + LabelElse
		
		GSC_NextToken()
		If GSC_TokenType = TOKEN_TERMINATOR Then
			;Multi-line IF statement
			Repeat
				GSC_ParseStatement()
				If GSC_Done Then
					GSC_AddError("Expected "+Chr(34)+"Else"+Chr(34)+" or "+Chr(34)+"EndIf"+Chr(34))
					Return
				End If
			Until GSC_TokenType = TOKEN_ELSE Or GSC_TokenType = TOKEN_ENDIF
			If GSC_TokenType = TOKEN_ELSE
				LabelEndif = GSC_UniqueLabel()
				WriteLine GSC_OutputFile, "    jmp   _" + LabelEndif
				WriteLine GSC_OutputFile, "_" + LabelElse + ":"
				GSC_NextToken()
				If GSC_TokenType = TOKEN_IF Then GSC_AddWarning("Ambiguous coding style (may cause unexpected errors - see language manual)")
				Repeat
					GSC_ParseStatement()
					If GSC_Done Then
						GSC_AddError("Expected "+Chr(34)+"EndIf"+Chr(34))
						Return
					End If
				Until GSC_TokenType = TOKEN_ENDIF
				WriteLine GSC_OutputFile, "_" + LabelEndif + ":"
				GSC_NextToken()
			Else ;EndIf
				WriteLine GSC_OutputFile, "_" + LabelElse + ":"
				GSC_NextToken()
			EndIf
		Else
			;Single-line IF statement
			GSC_ParseStatement(False)
			If GSC_TokenType = TOKEN_ELSE
				LabelEndif = GSC_UniqueLabel()
				WriteLine GSC_OutputFile, "    jmp   _" + LabelEndif
				WriteLine GSC_OutputFile, "_" + LabelElse + ":"
				GSC_NextToken()
				GSC_ParseStatement()
				WriteLine GSC_OutputFile, "_" + LabelEndif + ":"
			Else
				WriteLine GSC_OutputFile, "_" + LabelElse + ":"
			EndIf
		End If
		
	Case TOKEN_ELSE, TOKEN_ENDIF
		GSC_AddError("Keyword is out of place (there are no open "+Chr(34)+"If"+Chr(34)+" statements)")
		GSC_NextToken()
		Return
</pre><br>Note: As you can see, GSC_NextToken() does not return anything! Instead of returning the token type, I find it cleaner and more logical to store the token and token type in global variables (GSC_Token, GSC_TokenType).<br><br>I haven't gotten to overloadable functions yet, but I don't think I'll have much trouble with the overloading part; just search all functions for the best match. For the actual function part I'm not sure - probably just as simple as a call stack and "scoping" variables properly.<br><br>To impliment custom types I had to "invent" a few special opcodes. These opcodes move a type field to/from another variable/eax/ecx:<br><br><pre class=code>
mfc  a, b
  Moves the contents of the ecx."b" (type ecx, field "b") into "a"

mfa  a, b
  Moves the contents of the eax."b" (type eax, field "b") into "a" (same as mfc except uses eax instead of ecx)

xfc  a, b
  Moves the contents of "b" into ecx."a" (type ecx, field "a")

xfa  a, b
  Moves the contents of "b" into eax."a" (type eax, field "a") (same as xfc except uses eax instead of ecx)
</pre><br><br>Then the compiler can use these to compile code like this:<br><pre class=code>
Type Car 
  Field a:Int, b:Float
EndType

Local test:Car, tmp:Float

test = New Car

test.a = 23

tmp = test.a * 10

Delete test
</pre><br><br>Into this:<br><br><pre class=code>
;test = New Car
    new   eax,{car}
    mov   [test], eax
;test.a = 23
    mov   eax,23
    mov   ecx, [test]
    xfc   &lt;a&gt;, eax
;tmp = test.a * 10
    mov   eax,[test]
    mfa   eax,&lt;a&gt;
    push  eax
    mov   eax,10
    pop   ecx
    mul   eax,ecx
    mov   [tmp], eax
    mov   eax,[test]
;Delete test
    del   eax

    end
</pre> <br><br></td></tr></table><br>
<a name="562844"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> Frank, have you read <a href="http://www.rik.org/articles/ciphervm.htm" target="_blank">this</a>? <br><br></td></tr></table><br>
<a name="562893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> Noel,<br><br>Thanks for the article it was very informative. My reasoning behind developing BlitzScript3D was similar to Rik's with one additional facet. I wanted the Scripting Engine to be written in Blitz3D. No Dlls. This would serve as a learning tool and show that Blitz3D can meet the challenge. This is ultimately my goal with all my projects.<br><br>John J,<br><br>My idea of implementing SELECT...CASE is also similar to the IF...ELSEIF...THEN. <pre class=code>get varname			;select							
If var=value		;first case
ElseIf var=value	;next case
ElseIf var=value	;ditto
.
.
.
Else				;default case
EndIf				;end select</pre>SELECT CASE will most like be my next feature to add. I noticed that your IF...THEN can handle multiple lines. However, the following line concerns me.<pre class=code>If GSC_TokenType = TOKEN_IF Then GSC_AddWarning("Ambiguous coding style (may cause unexpected errors - see language manual)")</pre>.This suggest that the implementation does not support nested IF..THEN. Please correct me if I'm wrong. Handling Nested SELECT...CASE is also something to consider.<br><br>Conditional Loops. I do have a primitive form of looping using labels and goto commands. Its easy to home brew your own conditional loops but, too unconventional. I plan to implement FOR...NEXT, Repeat...Until, While...Wend loops based labels, jumps, and if...then contructs. I will also going to experiment with <i>Hyper</i> SELECT...CASE based on Label Jumping. The reason behind this is to reduced the number of instructions to evaluate conditions.<br><br>I haven't quite figured out how I will implement Functions less alone overload them. So I'm going to think tank for this. With BlitzScript3D being datatype-less, it may be difficult to implement overloading. The only way i can see this is if i implement them like methods in class and it will be limited (based on number of parameters vs type of parameters).<br><br>The way you implemented Custom Types looks very interesting. This is were I can see BlitzScript3D datatype-lessness making implementation easier. If I do pursue types, I will most likely pursue simple object classes in which you can package properties and methods under a object name.  I always been a fan of the (.) syntax:<pre class=code> 
object = New model
object.entity = entityload("dude.b3d")
object.rotate()

vs

object.model = New model
object\entity = entityload("dude.b3d")
object\rotate() ;doesent exist
</pre> I would also build in ID Reference Management for fast access to individual objects. Custom Type implementation depends on how it impacts performance.<br><br>I'm very interested in how you plan to implement the VM. I assume your compiler will convert scripts to opcodes and the VM loads in opcodes for processing.  My compiler converts scripts directly into <i>pcode (a byte representation of the opcodes)</i>. This is the compiled version of the script. BlitzScript3D can either recompile the script at loadtime or just load the compiled script. This allows you to totally remove human readible scripts and just used the compiled versions. <br><br></td></tr></table><br>
<a name="563057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>However, the following line concerns me.<br><br><pre class=code>
If GSC_TokenType = TOKEN_IF Then GSC_AddWarning("Ambiguous coding style (may cause unexpected errors - see language manual)")
</pre><br> <br>.This suggest that the implementation does not support nested IF..THEN. Please correct me if I'm wrong.<br> <br></div><br>This isn't exactly what it seems. Testing the next token for "If" only detects if the programmer typed something like:<br><br><pre class=code>
If &lt;condition&gt; Then
  &lt;statements&gt;
Else If &lt;condition&gt; Then 'This is not elseif to the compiler
  &lt;statemtnts&gt;
EndIf
</pre><br>, which is the same as:<br><pre class=code>
If &lt;condition&gt; Then
  &lt;statements&gt;
Else
  If &lt;condition&gt; Then 'Unclosed if

EndIf
</pre><br><br>, since I haven't implimented any ElseIf behaviour. The reason an "Else" followed by an "If" on a new line would not generate this warning is my compiler returns TOKEN_TERMINATOR when a new-line character (chr(13)) is found OR ";" is found (the equivelant of Blitz3D's ":").<br><br>I intend the VM to read Pcode and the compiler to write to Pcode as well (I mistook OPcode and Pcode as being synonomous). The file "manipulation" scheme I plan to impliment is slightly similar to BlitzScript3D:<br><br>The compiler writes the date/time stamp of the script file to the Pcode file. When the VM finds only the Pcode file, it will run that. If it finds only the Script file, it will compile and run that. But, if it finds <i>both the script and Pcode file</i>, it will check to see whether the Pcode file is up-to-date (if the date/time stamp of the script file equals the one writen <i>within</i> the Pcode file). If the Pcode is up-to-date, there's no need to recompile and can simply load that. If not, the souce will be recompiled (and therefore will not be recompiled until the source code's date/time stamp is changed by an edit). <br><br></td></tr></table><br>
<a name="563085"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> John J,<br><br>I like the idea of checking the timestamp on the script to determine recompile. I did not consider this. For BlitzScript3D you have to explicitly tell it to recompile, just in case you want to work on script but not modify the compiled version. However, a timestamp check is better.<br><br>IF Statements. I was concerned about nested IFs<pre class=code>
If &lt;condition&gt; Then 
	If &lt;condition&gt; Then 
		If &lt;condition&gt; Then 
			value = True
		EndIf
	EndIf
EndIf
</pre>This usage is not the same as Else...If. I ran into great deal of headache implementing nested conditions until i realized the power of labels and jumps. <br><br></td></tr></table><br>
<a name="563132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> My implimentation supports nested "If" statements since the "If" code calls ParseStatement() for each line between "If" and "Else", "Else" and "EndIf". And since ParseStatement() handles "If"s, nested "If" statements are automatically handled (just as long as the label names don't clash - and they don't due to the GSC_UniqueLabel() function). What my previous post stated was that that line simply helps avoid confusion about "Else If", since I haven't implimented "ElseIf" behavour.<br><br>The idea about checking the timestamp isn't new, I don't think, since that's the way I thought most compilers worked (most C compilers only recompile source files that have been modified). <br><br></td></tr></table><br>
<a name="563443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skyfire1</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> i tried blitzscript3d. now i'm off on a quest to figure out how i'll need it. <br><br></td></tr></table><br>
<a name="563445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> You won't need it. <br><br></td></tr></table><br>
<a name="563447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skyfire1</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> why not?!!! <br><br></td></tr></table><br>
<a name="563462"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>I follow you now and Nested IF's looking good. I found a very bad bug in running compiled scripts without recompilation:( I almost had to redo the entire variable handling.<br><br>Its not looking good for Custom Types. I dont have a clue as to how i want to handle the dynamic mem allocation. Instead of drilling my brain on them, i moving on with Select...Case Implementation.<br><br>skyfire1,<br><br>A Scripting Engine can be used for  'Modable' game engines, Macros, and other User Programmable behavior without modifying the actual Game/App Source Code.<br><br>If you take a look at some the most powerful game engines and applications, they all include a scripting system. <br><br></td></tr></table><br>
<a name="563475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> Today I added function support! Functions now compile perfectly, supporting both Local and Static variables. It supports blitz's style of functions (with or without parenthisis enclosing parameters).<br><br>The way it works is actually simple. Before a function is called, all Local variables of the function are "pushed", all the parameter values are "pushed", the execution pointer is pushed to the call stack, and it "jmps" to the function. Within the function, it "pops" the parameters into the function's parameter's variables. When it returns ("pops" the execution pointer off the call stack), it "pops" back all the functions local variables.<br><br>I probably didn't explain that very well, but it basically uses the stack to store the parameters, and to restore variables when using recursion techniques.<br><br>Unfortunately, I didn't add overloading support. It turns out it wasn't as easy as it seemed. To add function overloading I would have to add a <i>third</i> file parse pass, and I didn't think the advantages of overloadible functions justify the added compile time delay. Currently, one pass reads in variable and type declarations, and the second pass compiles the actual code. I've timed it and it compiles at about 50-70 KB of code per second.<br><br>So, it looks like conditional loops like "For..Next", "While..Wend", and "Repeat..Until" are next, then I'll be pretty much done with the compiler, and I'll begin work on the VM :)<br><br>skyfire1: Noel says you won't need it probably because he doesn't personally see any use for it. That's perfectly fine, except I would encourage you to research the advantages/disadvantages of a scripting engine in your project. I am making my own scripting engine because I think many aspects of my game would benifit from it greatly (especially AI), in addition to the fun I have programming things like this :) <br><br></td></tr></table><br>
<a name="563485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>Your explanation on Functions make perfect sense. I push and pop off args to regular functions in the same manner. I just havent quite figured out how to handle local variables at the moment.  I knew that function overloading would be tricky.<br><br>I use a very crude preprocessor (mass text replacement) on the 1st pass of the script and compile it to pcode on the second. If you can accomplish a 3rd pass within reasonable time, i say go for it. Afterall, once the script is compiled it loads first with no additional passes.<br><br>So you're moving on to conditional loops. I have to assume you already have Select...Case working? I'm real curious as to how you worked out the opcode sequence.<br><br>PS: Dont forget Multi-Dimensional Arrays and Logical conditions. <br><br></td></tr></table><br>
<a name="563654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> Select..Case compiles from this:<br><pre class=code>
Local a:Float

Select a
Case 1
  a=2
Case 2, 0
  a=1
Default
  a=0
EndSelect
</pre><br>, to this:<br><pre class=code>
;Select a
    mov   eax,[a]
    mov ebx, eax

;Case 1
_Flow_2
    mov   eax,1
    cEQ eax, ebx
    jz  _Flow_3

;a=2
    mov   eax,2
    mov   [a], eax
    jmp _Flow_1

;Case 2
_Flow_3
    mov   eax,2
    push  eax
    mov   eax,0
    pop   ecx
    or    eax, ecx
    cEQ eax, ebx
    jz  _Flow_4

;a=1
    mov   eax,1
    mov   [a], eax
    jmp _Flow_1

;Default
_Flow_4

;a=0
    mov   eax,0
    mov   [a], eax
    jmp _Flow_1

;EndSelect
_Flow_5
_Flow_1

    end
</pre><br><br>It's pretty simple, really. The hardest part was writing the parser (it wasn't really that difficult, it just took a bit of thought). I'd show you my Select..Case code, but you'll probably want to program yours yourself :)<br><br>About logical operators (and, or, xor, not), I implimented those long ago. As to miltidimentional arrays, I haven't even given them any real thought yet, but I'll probably impliment them last. <br><br></td></tr></table><br>
<a name="563839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>WOW! You totally comprehend Opcode.  Its hard to believe you just started a writting your own Scripting Engine less than a week ago. I struggled for weeks just implementing basic IF...THEN statements (BlitzScript3D has yet to support Logical Conditions.) If you can work out the opcodes, its no trouble to work the vm.<br><br>I'm going to reintroduce myself to the BlitzScript3D Compiler Opcode:) <br><br></td></tr></table><br>
<a name="564230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, I learned how the opcodes work the first day I started my scripting engine by studying Mark Sibley's compiler code. Before then all I knew about opcodes were they moved memory around and used some thingey called a "stack" :)<br><br>Anyway, I now have While..Wend, Repeat..Until, Repeat..Forever, and For..Step..Next loops working fine.<br><br>Here's how the loop code compiles:<br><pre class=code>
Local a:Int, b:Int

'--------------------------------------
'While..Wend
'--------------------------------------
While a&lt;10
  a=a+1
Wend

'--------------------------------------
'Repeat..Until
'--------------------------------------
Repeat
  a=a-1
Until a=0

'--------------------------------------
'Repeat..Forever
'--------------------------------------
Repeat
  a=a-1
Forever

'--------------------------------------
'For..Step..Next
'--------------------------------------
For a = 1 To 10 Step 2
  b=1
Next
</pre><br><br>Compiled:<br><br><pre class=code>
'--------------------------------------
'While..Wend
'--------------------------------------

While a&lt;10
_Flow_2
    mov   eax,[a]
    push  eax
    mov   eax,10
    pop   ecx
    cLT   ecx,eax
    jz  _Flow_1

;a=a+1
    mov   eax,[a]
    push  eax
    mov   eax,1
    pop   ecx
    add   eax,ecx
    mov   [a], eax

;Wend
    jmp _Flow_2
_Flow_1


'--------------------------------------
'Repeat..Until
'--------------------------------------

;Repeat
_Flow_4

;a=a-1
    mov   eax,[a]
    push  eax
    mov   eax,1
    pop   ecx
    sub   eax,ecx
    mov   [a], eax

;Until a=0
    mov   eax,[a]
    push  eax
    mov   eax,0
    pop   ecx
    cEQ   ecx,eax
    jz  _Flow_4
_Flow_3


'--------------------------------------
'Repeat..Forever
'--------------------------------------

;Repeat
_Flow_6

;a=a-1
    mov   eax,[a]
    push  eax
    mov   eax,1
    pop   ecx
    sub   eax,ecx
    mov   [a], eax

;Forever
    jmp _Flow_6
_Flow_5


'--------------------------------------
'For..Step..Next
'--------------------------------------

;For a = 1 To 10 Step 2
    mov   eax,1
    mov   [a], eax
_Flow_8
    mov   eax, [a]
    push  eax
    mov   eax,10
    pop   ecx
    cLT   eax, ecx
    jz    _Flow_7

;b=1
    mov   eax,1
    mov   [b], eax

;Next
    mov   eax, [a]
    add   eax, 2.0
    mov   [a], eax
    jmp _Flow_8
_Flow_7


    end
</pre> <br><br></td></tr></table><br>
<a name="564294"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> John J.<br><br>I'm totally amazed. I sure could have used this insight with BlitzScript3D initially. I can visualize the cover of your  book entitled: "How to write a Scripting Engine in 7 days with Blitz3D." <br><br>I create some weird opcodes for handling labels and jumps. Your opcode output is very elegant and holds true to nature. I'm gonna leave things in that area alone for now, but, i will definately take a second look at it in the future. At least for optimizing purposes.<br><br>I getting used to looking at BlitzScript3D code now. Its time to start adding these constructs:)<br><br><pre class=code>
Frank Taylor's Distorted Opcode for Select...Case

;Select expression
mov eax,&lt;expression&gt;
push eax
jz start
 
;dummycase
 
;Case &lt;expression&gt;
label_next
mov eax,&lt;expression&gt;
seq eax  ;auto pops stack -&gt; ecx and compares
push ecx ;push ecx back to stack
jz next
;statements
jmp last
 
;Case expression$
label_next
mov eax,&lt;expression$&gt;
seq eax str ;auto pops stack to ecx and compare strings
push ecx ;push ecx back to stack
jz next
;statements
jmp last

;Default
label_next
;statements

;EndSelect
label_last
</pre> <br><br></td></tr></table><br>
<a name="564521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm going to begin work on the optimizer next. It will probably be seperate from the compiler; instead of optimizing as it compiles, it will optimize after the compile.<br><br>One method of optimization it will use is a mass-text-replacer. For example this might replace this:<br><pre class=code>
pop ecx
cEQ eax, ecx
</pre><br>for this:<br><pre class=code>
seq eax  ;auto pops stack -&gt; ecx and compares
</pre><br>Or possibly simplify other complex operations that are performed often.<br><br>The other optimization method I planned out could reduce these rendundant instructions:<br><pre class=code>
mov eax, 10
mov [a], eax
mov eax, [a]
mov [b], eax
mov eax, 5
</pre><br>to this:<br><pre class=code>
mov [a], 10
mov [b], 10
mov eax, 5
</pre><br><br>How it works: First, it finds a group of "mov"s. Then, it lists all variables/registers used and their values internally like this:<br><div class="quote"> <br>eax = eax<br>a = a<br>b = b<br> <br></div><br>Then it steps through each "mov" assignment and changes the value of the variables.<br><br>Step 1: "mov eax, 10"<br><div class="quote"> <br>eax = 10<br>a = a<br>b = b<br> <br></div><br><br>Step 2: "mov [a], eax"<br>set a=eax ... eax is 10, so set a=10:<br><div class="quote"> <br>eax = 10<br>a = 10<br>b = b<br> <br></div><br><br>Step 3: "mov eax, [a]"<br>...<br><div class="quote"> <br>eax = 10<br>a = 10<br>b = b<br> <br></div><br><br>Step 4: "mov [b], eax"<br><div class="quote"> <br>eax = 10<br>a = 10<br>b = 10<br> <br></div><br><br>Step 5: "mov eax, 5"<br><div class="quote"> <br>eax = 5<br>a = 10<br>b = 10<br> <br></div><br><br>Done! Now translate the final data back into "mov"s:<br><br><pre class=code>
mov eax, 5
mov [a], 10
mov [b], 10
</pre><br><br>That's just a simple example, but it shows the versatility of the "mov" optimization algorithm. I've tried the algorithm (by "hand") on code like "a=a" and other redundant code, and it works quite well. <br><br></td></tr></table><br>
<a name="564838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>My optimizations are in both compilation and VM. I would highly recommend developing the VM prior to the Optimizer. My reason being is, you already have compiler output, the next step is to get the output to run. I'm certain  you will get a better perspective on optimizations once you see the code run. <br><br></td></tr></table><br>
<a name="566363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> I took your advise, and started the VM first. First, I converted the compiler output to binary. It outputs instructions like:<br><br><div class="quote"> <br>(1 byte)Instruction code<br>(1 byte)Parameter code<br>(x bytes)Parameter(s)<br><br>(1 byte)Instruction code<br>(1 byte)Parameter code<br>(x bytes)Parameter(s)<br><br>...<br>...<br> <br></div><br><br>Anyway, the VM is coming along fairly well.<br><br>I also just added the "automatic" compile system that uses the source file's date/time stamp to check if the compiled file is up-to-date. I used <a href="/codearcs.php?code=1442" target="_blank">(this)</a> method by turtle1776 to get the modified time/date of a file (it also can get the created, and last accessed time, although I didn't use those). It's works perfectly, although it does require the user to put a small decls file in the userlibs folder (for access to kernel32.dll). <br><br></td></tr></table><br>
<a name="566546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>Thumbs Up! My instructions are formatted in nearly the same fashion. I dont output all data in bytes though. I use shorts and strings for parameters. I have yet to find a need for more than two parameters. <br><br>I'm going to omit the auto-recompile for now. If there are significant requests for the feature I'll add it later. I do not desire to use a DLL, so I will most likely place the time stamp in the compiled file or special project config file as you suggested earlier.<br><br>You wouldn't believe how hard im struggling with implementing Select Case. Its all due to my fancy-spancy opcodes:( I'm going to keep working at it til it works. I'm trying to use the opcodes I have in place without creating new ones. I'm not looking forward conditional loops either. <br><br></td></tr></table><br>
<a name="566763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> About the auto-recompile: I don't use any DLL's really, except for a standard windows DLL that all blitz applications probably are already using anyway (kernel32.dll). Since blitz doesn't natively support getting the date/time stamp of a file, that's what turtle1776's code does.<br><br>My code now uses this to take the date/time of the source, and write it to the compiled file. There's really no other way to do auto-recompile unless you can get the date/time of the source file (it's the only way you can know if it has been modified or not).<br><br>In my opinion, putting the date/time in the compiled file is much better than putting it in a project config file, since the source and executable are totally independant of each other and any other files (more fail-safe and bug-safe).<br><br>My recompile check compares the compiled executable's written date/time with the date/time stamp of the source file. If it is EQUAL, no compile is necessary. If it is not equal, it recompiles. This method, opposed to not compiling when the executable is "Greater than or Equal to", can avoid the possibility of having a later-dated executable with an identicle as a existing source file being used. In other words, source files (if existing) take precedance over executables. <br><br></td></tr></table><br>
<a name="566937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> Getting Closer to resolving Select...Case. I'm designing it with Nested Select...Cases in mind. What I noticed in your Select...Case opcode segment above <pre class=code>;Select a
    mov   eax,[a]
    mov ebx, eax
</pre> is that you use a <b>ebx</b> register which holds the value or pointer to [a]. BlitzScript only uses eax and ecx.<br><br>Taking Nested Select...Case into consideration, the ebx register's contents will have to pushed and popped off the stack as needed with each Case comparison otherwise it will be overwritten if nested Select.Case is encountered. <pre class=code>;Select a
    mov   eax,[a]
    push eax

;Case 1
_Flow_2
    mov   eax,1
    pop ebx
    cEQ eax, ebx
    push ebx
    jz  _Flow_3

   {statements}
    jmp _Flow_1</pre>This is completely dependent on how the VM Stack is implemented... I only use one. <br><br></td></tr></table><br>
<a name="566940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah-hoooooooooo! <br><br>Nested Select...Cases are in.  Doesn't yet support cases with  multiple arguments, but its working! <br><br></td></tr></table><br>
<a name="567204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm glad to hear you're making progress!<br><br>I didn't notice that problem with my Select..Case - thanks for finding that! I fixed it so it uses the stack instead of ebx to store the "Select" expression, similar to your example above. Instead of popping ebx, comparing, and pushing ebx when ebx is needed, I use a new opcode called "vpop" (virtual pop) which pops the top stack item into a variable without modifying the stack contents. At the end of the "Select", I "xpop", which removes the top stack item (so the Select expression doesn't stay in there causing a stack leak).<br><br>I added multiple case items a while ago by reading expressions seperated by commas, producing code as if the commas were "Or" keywords <br><br></td></tr></table><br>
<a name="567596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> Moving on to Control Loops. I do have code in place to handle logical operators: OR, AND, XOR, NOT. But, I have yet to put the code in operation. I'm going to move on to Control Loops for now. <br><br></td></tr></table><br>
<a name="568351"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>I'm curious about how you are managing labels. I noticed that your label# are ordered from the highest to the lowest. I'm not sure how you are able to do this, unless you're using a stack to manage the label ids.<br><br>BlitzScript Label IDs are assigned during load time. I believe your method to be more effecient. <br><br></td></tr></table><br>
<a name="568966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> The label IDs are just calculated with a UniqueVariable() function. The reason the IDs may appear in reverse order some times is my code sometimes needs to pre-calculate a label (so it can jump to the end of a Select..Case structure with the Exit keyword, for example). <br><br></td></tr></table><br>
<a name="571115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>Hows the VM coming along? <br><br></td></tr></table><br>
<a name="571890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't done any work on it in a little while. I've been recently working on my game. I usually have a few projects "in-progress" so if I get tired of one, I can move over to another. I seem to work bests in "bursts", switching projects occasionally so I don't get bored.<br><br>My latest project is documented in my <a href="/logs/userlog.php?user=7631&amp;log=498" target="_blank">worklog </a>, if you're interested.<br><br>Anyway, when I do get around to it, all I have to do it fill in the Select..Case structure which execures all the opcodes, create a call stack and variable stack, and that's about all. <br><br></td></tr></table><br>
<a name="571918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> John<br><br>I too switch project to project as well. Working on each diligently as long as the motivation allows. Check out my <a href="/logs/userlog.php?user=223&amp;log=540" target="_blank">latest project</a>. Sounds like the VM is all ready to rock and roll. <br><br>Took a gander at your MegaMesh worklog. This is very much needed. I was actually working on LOD and VIS Rendering Optimizations for Project PLASMA FPS before I took a pause. However, I was taking a precalculated VIS (occlusion) and prerendered LOD approach. <br><br></td></tr></table><br>
<a name="584151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John J.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> Over the past week, I've spent some of my time finishing up GameScript. I thought you might be interested in my latest progress.<br><br>Currently, GameScript is 98% functional (custom types, function, static vars, local vars, global vars, select case, while, wend, etc. etc.). The entire language works flawlessly. Luckily, I had to make almost no changes to the compiler when getting the VM to work. I simply need to add an assembly code optimizer, and (not so simple) arrays. I also will need to find a way to integrate the scripts with the application better.<br><br>When a runtime error occurrs, a runtime error window is displayed, after writing a CrashLog.txt file containing useful information about the crash, including a dis-assembled portion of the code where the error occurred. <br><br>Currently, it runs this script perfectly, giving a list of prime numbers:<br><pre class=code>
'Prime number search

Local prime:Int, i:Int

Print "Prime Numbers:"

prime = 1
For i = 1 To 20
  prime = NextPrime(prime)
  Print prime
Next

End



'Prime number search function
Function NextPrime:Int(current:Int)
  Local i:Int
  Local found:Int

  While Not found
    current = current + 1; Found = True
    For i = 2 To current-1
      If (current Mod i) = 0 Then
        Found = False
        Exit
      EndIf
    Next
  Wend

  Return current
EndFunction
</pre><br><br>My scripting engine currently runs at 3-5 times less than the same code directly compiled in a blitz EXE (both with debug mode off). Because of the structure of the VM (lots of nested Select..Case's because of the multi-variable type), running in debug mode causes scripts to run extremely slow (10 times slower than when debug mode is off). Anyway, I hope my optimizer will be able to increase efficiency and possibly get it down to an average of only 3 times slower.<br><br>I'm also thinking about making a debugger program to debug scripts. It would be very possible to create a simple app to allow you to step over/step into code from the original script file (if each instruction code has a line index to use).<br><br>Let me know if I can help in any way with your scripting engine.<br><br>P.S. When you get to functions, remember that local/global variables makes no difference to the VM. A global variable named "a", for example, is totally different from a local variable in some function named "a", since the compiler should automatically do this. When the compiler comes across "a", it checks what function it's in, and handles the compilation accordingly. Also, for recursion to work, all a functions variables should be "push"ed before calling any function, then "pop"ped after the function call. <br><br></td></tr></table><br>
<a name="584818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> John,<br><br>Your scripting engine is looking real good. It is interesting how you achieved a Scripting Engine with a BlitzMax syntax written with the Blitz Basic language. Your speed results are good, BlitzScript3D runs about the same.  <br><br>I've have yet to implement loops and logical operators. I've taken a break to work on a game. I will return to it in the near future and will definately seek your help. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
