<!DOCTYPE html><html lang="en" ><head ><title >Sun flares and hud sprites 'shaking'!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Sun flares and hud sprites 'shaking'!</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Sun flares and hud sprites 'shaking'!</a><br><br>
<a name="486184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Viperfish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> My current project is a 3d space simulation game in which the player has completely free movement in all directions, 'elite' style.<br><br>I'm experiencing a problem with sprites shaking the further away the player gets from postion 0,0,0.  It first came to light when I downloaded the absolutely AWESOME sun flares demo by Barliesque. You can get it here;<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1107" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1107</a><br><br>In the demo it worked perfectly. When I got the code working in my game, I noticed at times the flares were shaking and even blinking in and out of view.  You can see this for yourself by modifying the code in the above demo. After 'Scene = LoadAnimMesh("Media\Scene.b3d")'. Add the following line <br><pre class=code>
ScaleEntity scene,700,700,700
</pre><br><br>Then modify the player controls function so the movement speed is scaled up.<br><pre class=code>
If KeyDown(203) Then mvx=mvx-100
If KeyDown(205) Then mvx=mvx+100
If KeyDown(200) Then mvz=mvz+100
If KeyDown(208) Then mvz=mvz-100
	
If KeyDown(30) Then mvx=mvx-100
If KeyDown(32) Then mvx=mvx+100
If KeyDown(17) Then mvz=mvz+100
If KeyDown(31) Then mvz=mvz-100
</pre><br><br>Now if you run the code you'll notice (at least on my machine and another I tested it on) that the flares start jumping and shaking the further away you walk. <br><br>The program uses CAMERAPROJECT, PROJECTEDX &amp; PROJECTEDY to determine the 2d location of the sun on the screen before placing the sprites. The x and y values returned by these functions dont 'shake'. If you print them to the screen while the program is running you can see the flares shaking uncontrollably even when the player is stationary and the values returned by the above functions are static. <br><br>I've now noticed by hud sprites, which are parented to the camera, also shake but to a lesser degree. <br><br>It only seems to become noticeable when the player moves about 10000 away from position 0,0,0.<br><br>Is there a fix for this (other than scaling my entire world down)?<br>or is it one of those floating point problems I keep reading about? <br><br></td></tr></table><br>
<a name="486194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> JOhn,<br><br>Hm, I thought this 'bug' had gone away!  With real-time worlds floating point accuracy is no where near something like 3D Max or Lightwave, so the further you travel from the origin the worse this problem will become.<br><br>The way to solve it is to use a second camera for all your HUD stuff.<br><br>Check out HUD and second camera code in the Archives or check on BlitzCoder.  <br><br>I am sure the answers are here.  I use Swifts HUD and Filax's HUDs when I want one.<br><br>IPete2. <br><br></td></tr></table><br>
<a name="486196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I've now noticed by hud sprites, which are parented to the camera, also shake but to a lesser degree. <br></div><br><br><div class="quote"> The way to solve it is to use a second camera for all your HUD stuff. <br></div><br><br>You can also get this problem if your HUD sprites are too close to the camera, regardless of where in your 3D world everything is. <br><br></td></tr></table><br>
<a name="486197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It does sound like a float thing, and 10000.0 is coincidentally enough where you lose a digit of precision. You'll probably have to scale down. <br><br></td></tr></table><br>
<a name="486534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Viperfish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmmm. Thanks for the replies. Scaling down it is! <br><br></td></tr></table><br>
<a name="488718"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzcoder.com/cgi-bin/ubb-cgi/postdisplay.cgi?forum=Forum4&amp;topic=000352" target="_blank">http://www.blitzcoder.com/cgi-bin/ubb-cgi/postdisplay.cgi?forum=Forum4&amp;topic=000352</a><br><br>Andy <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
