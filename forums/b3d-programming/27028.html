<!DOCTYPE html><html lang="en" ><head ><title >Entity Property Library</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Entity Property Library</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Entity Property Library</a><br><br>
<a name="282708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ken Lynch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just letting you know I've added a simple entity property library to the code archives. It uses child pivots to store the properties which means that the properties are part of the entity and that means when you delete the entity the properties are automatically cleaned up.<br><br>Let me know if you find this useful.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=820" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=820</a> <br><br></td></tr></table><br>
<a name="282876"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Am I right in thinking that it creates a new Pivot for every property?<br><br>Wouldn't it make more sense to use the Entity Name of just one pivot? <br><br></td></tr></table><br>
<a name="282898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Am I right in thinking that it creates a new Pivot for every property? <br></div><br><br>Reading through it... yes.<br><br>I agree. Using a single pivot, with a comma (or pipe) seperated list of properties and values would be the better way to do it. This would mean the properties list could look like this.<br><br><pre class=code>delay=50|speed=100|class=transport</pre><br><br>Then a function could be used that is passed the property name and gets the value returned (much as it is now)<br><br>The idea is good. It just doesn't work as efficiently as it could.<br><br>Using this method you could actually by pass the pivots altogether and just use the actual entities name. <br><br></td></tr></table><br>
<a name="282909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ken Lynch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>The idea is good. It just doesn't work as efficiently as it could. <br><br>Using this method you could actually by pass the pivots altogether and just use the actual entities name. <br> <br></div><br><br>But in what way is it inefficient. True, it generates lots of pivots, but it leaves the entities name free to be used for what it should be, doesn't seem to have a performance hit on any entities that use it, and the speed of FindChild is I am sure faster than parsing a long string as you have to parse the entire string in a linear fashion - the example creates 3000 properties for the cube and can retrieve any property almost instantly.<br><br>It also has the advantage of being able to allow array style properties in the new version i am working on. <br><br></td></tr></table><br>
<a name="282917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like it. A HideEntity operation on the created properties pivot may be even more efficient in regards to Blitz3D internal entity enumeration in update and render calls. <br><br></td></tr></table><br>
<a name="282927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> But in what way is it inefficient. <br></div><br><br>I don't know. I would geuss it depends upon the amount of properties being used, but creating pivots takes up memory (albeit not a huge amount) I seem to remember some code shown a few months ago that proved that lots of pivots is just as bad as lots of spheres in that having large numbers of pivots slowed down the app, even if there was nothing to render.<br><br>I would agree that findchilding the properties would be quicker than parsing the string of properties. I guess it all comes down to how often you use these things.<br><br>Personally the way I do this is to name the entity with the handle of a type which stores that entities data so all I have to do is<br><br><pre class=code>p.property=new property
nameEntity handle(p)
</pre><br><br>then to get the entities data I would<br><pre class=code>
p.property=object.property(entityName(id))
a=p\property1
b=p\property2
;...etc
</pre><br><br>Of course this will only be good until Mark decides wether the handle/ object commands are official or not, but I have had no problems so far. <br><br></td></tr></table><br>
<a name="282951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ken Lynch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Binary_Moon:<br><br>I'm well aware of that hack, but I needed something more dynamic and flexible - this is one way I've found round it. This way you can pass an entity to a function and get a property without the function needing to know anything about the 'Type' you have created for the entity - this being the main falldown of types in my opinion as it stops you from having generic functions.<br><br>Anyway, I've posted the code and the idea so that anyone who might find it useful can use it. If anyone can help to refine it then please do.<br><br>Skidracer:<br><br>Glad you like it. I'll try some tests an see if HideEntity makes a difference. <br><br></td></tr></table><br>
<a name="282954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kuron</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just really getting into B3D, this sounds VERY useful Ken.  Thanks for sharing :c) <br><br></td></tr></table><br>
<a name="282960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm well aware of that hack, but I needed something more dynamic and flexible - this is one way I've found round it. <br></div><br><br>That's cool. Just trying to present a different 'perspective' :)<br><br>Just had another look at your code. A couple of things I would change (that have nothing to do with the amount of pivots)<br><br>In setProperty() you should use<br><br><pre class=code>
	v = GetChild(p, 1)
	If v = 0 Then v = CreatePivot(p)
	NameEntity v, value
</pre><br><br>As it is at the moment you can only set the property once. If you want to change the property you can't unless you delete the property first. <br><br></td></tr></table><br>
<a name="282987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> this is excellent, i was trying something like this, you bet me to it :) <br><br></td></tr></table><br>
<a name="283038"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ken Lynch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> As it is at the moment you can only set the property once. If you want to change the property you can't unless you delete the property first. <br></div><br><br>You can, it's just I messed up the code a little so there are actually two NameEntity calls, one inside the if and one outside - though the code you wrote is what I originally intended to write ;-) Thanks.<br><br>I've done some quick tests using a string parsing routine, just out of curiosity, and it seems my assumtions are wrong, my string parser version is just as fast as my pivot version at the moment. <br><br></td></tr></table><br>
<a name="283234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I've done some quick tests using a string parsing routine, just out of curiosity, and it seems my assumtions are wrong, my string parser version is just as fast as my pivot version at the moment. <br></div><br><br>I would guess (I don't know but...) that using FindChild blitz has to loop through all children doing a string comparison to check the name. Obviously this would be slow if we wrote it (in blitz), so it is faster than our version would be but faster than parsing a string... haven't got a clue. Thats why I like the object and handle method. You can get straight to the entity data really quickly. <br><br></td></tr></table><br>
<a name="283279"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ken Lynch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> It does seem like Blitz does just go through all entities until it gets to the one with a name that matches, it's probably the only way to do it as I can't imagine entities being sorted in any way.<br><br>I did like the object/handle trick, but I began to find limitations when trying to write reusable libraries of functions - unless you use the same type for all your entities then you have to rewrite the same function for different types. I am just trying to explore Blitz and see if there is a different, more flexible way of doing things - this is just one of my experiments.<br><br>Overall, my tests have shown that searching through pivots is about twice as fast as parsing a string using InsStr to retrieve values - I can retrieve 9000 values in about 35 milliseconds using pivots compared to 70 milliseconds using a single string to store all the properties.<br><br>The memory usage of the pivot method for creating 9000 properties is about 7000KB above that for creating a string to contain a list of 9000 properties, so the pivot method is a bit more memory intensive, but you are never going to have anywhere near 9000 properties in a game. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
