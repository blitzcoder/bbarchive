<!DOCTYPE html><html lang="en" ><head ><title >WinBlitz3d Events Help</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >WinBlitz3d Events Help</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >WinBlitz3d Events Help</a><br><br>
<a name="706767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a short simplified example of a problem I'm having.<br>What I want to achieve is a trackbar and a spinner that are synchronised and that can also be manipulated via code. <br>In the following example If you move the trackbar the spinner updates and vice versa - you can click the Start button and the text will change to Stop - it works - but when you enable the updates to either the trackbar or the spinner via code the events generated by this prevent the button  event or anything else from ever getting "heard".<br>If you use WB3D_FlushEvents() then you flush everything including the button event so that doesn't help.<br>Is what I am trying to do possible? If so how do I filter out the events generated by code rather than user manipulation ?<br>Any help on this would be greatly appreciated.<br><br><pre class=code>
Include "../../../WB3DStyles.bb"

; setup gfx mode.
Graphics3D 640,480,16,2
Global switch=0
Global updatespinner=0
Global updatetrackbar=0

; install winblitz3d.
Global RuntimeWindow_hWnd = WB3D_InitializeGUI(SystemProperty("AppHwnd"),10,10,300,200)
WB3D_SetQuitMessage "WinBlitz3D 3D/GUI","Sure To Quit" 
;WB3D_HideGadget RuntimeWindow_hWnd

; create winapi window, setting its title, and position on screen. use default style creation.
example_window = WB3D_CreateWindow("WB3D_CreateWindow Example",200,100,450,275,0,0)
trackbar = WB3D_CreateTrackBar%(10, 24, 200, 30,example_window,0,TBS_AUTOTICKS Or TBS_TOP Or WS_CHILD)
WB3D_SetTrackBarRange (trackbar,0,100)
WB3D_SetTrackBarPos (trackbar,0)
button=WB3D_CreateButton%("Start",10, 60, 60, 20,example_window,0)
checkspinner=WB3D_CreateCheckButton ("Update Spinner",10, 140, 160, 20,example_window,0)
checktrackbar=WB3D_CreateCheckButton ("Update Trackbar",10, 160, 160, 20,example_window,0)

thislabel = WB3D_CreateEditField("",10,100,30,20,example_window,0,0)
spinner = WB3D_CreateSpinner(40, 100,50,20,example_window,0,0)
WB3D_SetSpinnerRange (spinner,0,100)
WB3D_SetSpinnerPos (spinner,0)
; cleanup any old creation events, its better to do this before we enter the main
; event loop, when some gadgets are created they generate events.
WB3D_FlushEvents 

; setup out quit flag, and loop until the flag is set.
QUIT = 0
While Not QUIT = 1
	
	; generate an internal blitz event
	Flip
	Cls
	Text 10,10,selected
	; get an event of the event queue.
	event = WB3D_WaitEvent()
	Select event
		
		
		Case WB3D_EVENT_GADGET
			selected = WB3D_EventSource()
			
			Select selected
				Case button
					switch=Not switch
					If switch 
						WB3D_SetGadgetText(button,"Stop")
					Else
						WB3D_SetGadgetText(button,"Start")
					End If

				Case trackbar
					 WB3D_SetSpinnerPos(spinner,WB3D_GetTrackBarPos(trackbar))
				Case spinner
					 WB3D_SetTrackBarPos(trackbar,WB3D_GetSpinnerPos(spinner))
				Case checkspinner
					updatespinner= Not updatespinner
				Case checktrackbar
					updatetrackbar= Not updatetrackbar
				
				
			
			End Select


		Case WB3D_EVENT_KEYPRESS
		
			; wb_eventdata holds the key code that was pressed.
			keypressed = WB3D_EventData()
			Select keypressed
				
				Case WB3D_KEY_ESCAPE	
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
				
		Case WB3D_EVENT_WINDOW_CLOSE
		
			; wb3d_eventsource hold the handle to the window that close button was selected
			window = WB3D_EventSource()
			Select window
			
				Case example_window
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
	End Select

	If switch
		count=count+1
			If count&gt;100 count=0
				If updatetrackbar WB3D_SetTrackBarPos (trackbar,count)
				If updatespinner WB3D_SetSpinnerPos (spinner,count)
				;WB3D_FlushEvents();This will delete all events nothing left to capture !!!
			End If	
Wend

; use notify using external winapi constants. 
WB3D_Notify "WB3D GUI Window Example","Bye, Thats It I Quit",MB_OK Or MB_ICONASTERISK
WB3D_EndGUI()
EndGraphics
End
</pre> <br><br></td></tr></table><br>
<a name="706790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi smiff <br><br><div class="quote"> <br>If so how do I filter out the events generated by code rather than user manipulation <br> <br></div><br><br>this is not possable under winblitz3d at the moment. <br><br>im unsure on what your trying to do? is it this. add the code below before the while-wend loop.<br><br><pre class=code>

WB3D_SetButtonState checktrackbar,True
updatetrackbar= Not updatetrackbar
switch=Not switch
WB3D_SetGadgetText(button,"Start")

</pre><br><br>if this is not what your after can you explain a little more. maybe i drunk a little to much beer and its as clear as day?<br><br>kev <br><br></td></tr></table><br>
<a name="706804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Those checkboxes and variables are just to switch conditions so you could see the events working and then not - they are irrelevant to the issue.<br>Here's a more basic example - Once you hit Start the button no longer responds :<br><pre class=code>
Include "../../../WB3DStyles.bb"

; setup gfx mode.
Graphics3D 640,480,16,2
Global switch=0

; install winblitz3d.
Global RuntimeWindow_hWnd = WB3D_InitializeGUI(SystemProperty("AppHwnd"),10,10,300,200)
WB3D_SetQuitMessage "WinBlitz3D 3D/GUI","Sure To Quit" 
;WB3D_HideGadget RuntimeWindow_hWnd

; create winapi window, setting its title, and position on screen. use default style creation.
example_window = WB3D_CreateWindow("WB3D_CreateWindow Example",200,100,450,275,0,0)
trackbar = WB3D_CreateTrackBar%(10, 24, 200, 30,example_window,0,TBS_AUTOTICKS Or TBS_TOP Or WS_CHILD)
WB3D_SetTrackBarRange (trackbar,0,100)
WB3D_SetTrackBarPos (trackbar,0)
button=WB3D_CreateButton%("Start",10, 60, 60, 20,example_window,0)

thislabel = WB3D_CreateEditField("",10,100,30,20,example_window,0,0)
spinner = WB3D_CreateSpinner(40, 100,50,20,example_window,0,0)
WB3D_SetSpinnerRange (spinner,0,100)
WB3D_SetSpinnerPos (spinner,0)
; cleanup any old creation events, its better to do this before we enter the main
; event loop, when some gadgets are created they generate events.
WB3D_FlushEvents 

; setup out quit flag, and loop until the flag is set.
QUIT = 0
While Not QUIT = 1
	
	; generate an internal blitz event
	Flip
	Cls
	Text 10,10,selected
	; get an event of the event queue.
	event = WB3D_WaitEvent()
	Select event
		
		
		Case WB3D_EVENT_GADGET
			selected = WB3D_EventSource()
			
			Select selected
				Case button
					switch=Not switch
					If switch 
						WB3D_SetGadgetText(button,"Stop")
					Else
						WB3D_SetGadgetText(button,"Start")
					End If

				Case trackbar
					 WB3D_SetSpinnerPos(spinner,WB3D_GetTrackBarPos(trackbar))
				Case spinner
					 WB3D_SetTrackBarPos(trackbar,WB3D_GetSpinnerPos(spinner))
				
				
				
			
			End Select


		Case WB3D_EVENT_KEYPRESS
		
			; wb_eventdata holds the key code that was pressed.
			keypressed = WB3D_EventData()
			Select keypressed
				
				Case WB3D_KEY_ESCAPE	
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
				
		Case WB3D_EVENT_WINDOW_CLOSE
		
			; wb3d_eventsource hold the handle to the window that close button was selected
			window = WB3D_EventSource()
			Select window
			
				Case example_window
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
	End Select

	If switch
		count=count+1
			If count&gt;100 count=0
				WB3D_SetTrackBarPos (trackbar,count)
				WB3D_SetSpinnerPos (spinner,count)
				;WB3D_FlushEvents();This will delete all events nothing left to capture !!!
			End If	
Wend

; use notify using external winapi constants. 
WB3D_Notify "WB3D GUI Window Example","Bye, Thats It I Quit",MB_OK Or MB_ICONASTERISK
WB3D_EndGUI()
EndGraphics
End
</pre><br>Basically what I am trying to do is have a trackbar and a spinner synchronised - when manipulated by the user. I also want to be able to manipulate them via code in the main program loop so flushing events is not an option because this flushes everything.<br>In the example the trackbar and spinner are synched - if you move one the other updates. If you try and manipulate the gadgets via code ,however , the resulting flood of events prevents any other event from beiing dealt with.<br>If there is no way to manipulate the gadgets via code without generating a lot of events that cannot be filtered or flushed out then I will have to rethink. <br><br></td></tr></table><br>
<a name="706811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pepsi</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> That second example worked for me for a while until I decided to continuely click on the spinner button a whole bunch of times. After I did that, the stop button would not respond anymore for me.<br><br>I feel something is loosing focus.<br><br>The code I put up in the "winblitz3d: limit min sizing help" thread has a wierd behaviour when I try to access the window menu with the alt-key combinations. Sometimes the alt-key combo will not respond quick enough for the menu to be highlighted. If I loose focus of my entire application and then come back to it, I am unable to even access the window menu with the alt key alone. But, I did notice if I press a button, Im able to access the window's menu again with the alt-key combos.<br><br>hrmmmm... focus... <br><br></td></tr></table><br>
<a name="706965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes "sometimes" I can get it working when just updating the trackbar but never when updating the spinner. There's something not quite right about the way events are handled.<br>It would be great if code-generated changes to the gadgets did not generate events at all like  other gui libs. <br><br></td></tr></table><br>
<a name="706990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>It would be great if code-generated changes to the gadgets did not generate events at all like other gui libs.<br> <br></div><br><br>how would this function? i cant quite figure a way to easy add this. any ideas?<br><br>kev <br><br></td></tr></table><br>
<a name="707456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Smiff. <br><br>Ive added WB3D_GenerateEvents(state) to WinBlitz3D, this enables you to control when winblitz3d will generate events.<br><br>using WB3D_GenerateEvents() seems to correct the problem here.<br><br><pre class=code>
	If switch
		count=count+1
			If count&gt;100 count=0
				WB3D_GenerateEvents False
				WB3D_SetTrackBarPos (trackbar,count)
				WB3D_SetSpinnerPos (spinner,count)
				WB3D_GenerateEvents True
				;WB3D_FlushEvents();This will delete all events nothing left to capture !!!
			End If	

</pre><br><br>the experimental update can be downloaded from here.<br> <br><a href="http://www.winblitz3d.co.uk/WinBlitz3D_V1.1_Experimental.zip" target="_blank">http://www.winblitz3d.co.uk/WinBlitz3D_V1.1_Experimental.zip</a><br><br>kev <br><br></td></tr></table><br>
<a name="707507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Kev - that's excellent news- Looks like it will do the job nicely-  my PC just died last night - it had been suffering for quite a while now but finally gave up the fight - hopefully be back up &amp; running with a new system asap and I'll give it a go !! <br><br></td></tr></table><br>
<a name="707580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pepsi</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya, I tried it out and it worked smoothly for me. Seems to work! <br><br></td></tr></table><br>
<a name="707593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kev - on the ball as usual, and fixed within a day. Well done! <br><br></td></tr></table><br>
<a name="707648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried it but it still doesn't work on my system - can't understand it. The stop button still refuses to respond even with wrapping the setgadget statements with the new command.  I think  I need to take a break ! <br><br></td></tr></table><br>
<a name="707652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Smiff, whats your system spec? i recall danny having some problems on a lower spec pc. can you provide the full code causing the problem, if this is possable email it to me.<br><br>can you also try using WB3D_StartEvents and WB3D_StopEvents, other than this i could add a temp command to see how many items are on the event queue.<br><br>ive a feeling its not the event queue, but possably some calculation you could possably be doing while updating the spinner and trackbar thats causing missed events? could this be possable?<br><br> <br>kev <br><br></td></tr></table><br>
<a name="707897"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Double post <br><br></td></tr></table><br>
<a name="707899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kev - System spec as follows:<br>AMD Athlon 2600+(1.92Ghz) 1Gig DDR, WinXP Home SP2<br>Nvidia 6200 256mb.<br>I also thought it must be something else causing the problem until I tried it in the test code. <br>The code is exactly the same as the last simplified example with the WB3D_GenerateEvents added :<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Include "WB3DStyles.bb"

; setup gfx mode.
Graphics3D 640,480,16,2
Global switch=0

; install winblitz3d.
 RuntimeWindow_hWnd = WB3D_InitializeGUI(SystemProperty("AppHwnd"),10,10,300,200)
WB3D_SetQuitMessage "WinBlitz3D 3D/GUI","Sure To Quit" 
WB3D_HideGadget RuntimeWindow_hWnd

; create winapi window, setting its title, and position on screen. use default style creation.
 example_window = WB3D_CreateWindow("WB3D_CreateWindow Example",200,100,450,275,0,0)
 trackbar = WB3D_CreateTrackBar%(10, 24, 200, 30,example_window,0,TBS_AUTOTICKS Or TBS_TOP Or WS_CHILD)
WB3D_SetTrackBarRange (trackbar,0,100)
WB3D_SetTrackBarPos (trackbar,0)
 button=WB3D_CreateButton%("Start",10, 60, 60, 20,example_window,0)

thislabel = WB3D_CreateEditField("",10,100,30,20,example_window,0,0)
 spinner = WB3D_CreateSpinner(40, 100,50,20,example_window,0,0)
WB3D_SetSpinnerRange (spinner,0,100)
WB3D_SetSpinnerPos (spinner,0)
; cleanup any old creation events, its better to do this before we enter the main
; event loop, when some gadgets are created they generate events.
WB3D_FlushEvents 

; setup out quit flag, and loop until the flag is set.
QUIT = 0
While Not QUIT = 1
	
	; generate an internal blitz event
	Flip
	Cls
	Text 10,10,selected
	; get an event of the event queue.
	event = WB3D_WaitEvent()
	Select event
		
		
		Case WB3D_EVENT_GADGET
			selected = WB3D_EventSource()
			
			Select selected
				Case button
					switch=Not switch
					If switch 
						WB3D_SetGadgetText(button,"Stop")
					Else
						WB3D_SetGadgetText(button,"Start")
					End If

				Case trackbar
					 WB3D_SetSpinnerPos(spinner,WB3D_GetTrackBarPos(trackbar))
				Case spinner
					 WB3D_SetTrackBarPos(trackbar,WB3D_GetSpinnerPos(spinner))
				
				
				
			
			End Select


		Case WB3D_EVENT_KEYPRESS
		
			; wb_eventdata holds the key code that was pressed.
			keypressed = WB3D_EventData()
			Select keypressed
				
				Case WB3D_KEY_ESCAPE	
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
				
		Case WB3D_EVENT_WINDOW_CLOSE
		
			; wb3d_eventsource hold the handle to the window that close button was selected
			window = WB3D_EventSource()
			Select window
			
				Case example_window
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
	End Select

	If switch
		count=count+1
			If count&gt;100 count=0
			WB3D_GenerateEvents 0
				WB3D_SetTrackBarPos (trackbar,count)
				WB3D_SetSpinnerPos (spinner,count)
			WB3D_GenerateEvents 1
			End If	
Wend

; use notify using external winapi constants. 
WB3D_Notify "WB3D GUI Window Example","Bye, Thats It I Quit",MB_OK Or MB_ICONASTERISK
WB3D_EndGUI()
EndGraphics
</textarea><br>If this works for you then perhaps the problem is system related ?!?<br>I have tries the start/stop events - I will try again using both commands to see if that helps. <br>Thanks once again for your help with this = a temp command to see the number of events in the queue would be very helpful - might give some idea of what is happening. <br><br></td></tr></table><br>
<a name="707974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Smiff<br><br>download www.winblitz3d.co.uk/WinBlitz3D_V1.1_Experimental.zip<br><br>ive added WB3D_QueueSize() this will return the total number of events in the queue.<br><br>using the example below i see '1' event on the queue, only when moving the trackbar with the mouse does this increase.<br><br>please try and report back your findings, we will try and get to the bottom of this problem.<br><br><pre class=code>
Include "WB3DStyles.bb"

; setup gfx mode.
Graphics3D 640,480,16,2
Global switch=0

; install winblitz3d.
Global RuntimeWindow_hWnd = WB3D_InitializeGUI(SystemProperty("AppHwnd"),10,10,300,200)
WB3D_SetQuitMessage "WinBlitz3D 3D/GUI","Sure To Quit" 
;WB3D_HideGadget RuntimeWindow_hWnd

; create winapi window, setting its title, and position on screen. use default style creation.
example_window = WB3D_CreateWindow("WB3D_CreateWindow Example",200,100,450,275,0,0)
trackbar = WB3D_CreateTrackBar%(10, 24, 200, 30,example_window,0,TBS_AUTOTICKS Or TBS_TOP Or WS_CHILD Or WS_VISABLE)
WB3D_SetTrackBarRange (trackbar,0,100)
WB3D_SetTrackBarPos (trackbar,0)
button=WB3D_CreateButton%("Start",10, 60, 60, 20,example_window,0)

thislabel = WB3D_CreateEditField("",10,100,30,20,example_window,0,0)
spinner = WB3D_CreateSpinner(40, 100,50,20,example_window,0,0)
WB3D_SetSpinnerRange (spinner,0,100)
WB3D_SetSpinnerPos (spinner,0)
; cleanup any old creation events, its better to do this before we enter the main
; event loop, when some gadgets are created they generate events.
WB3D_FlushEvents 

; setup out quit flag, and loop until the flag is set.
QUIT = 0
While Not QUIT = 1
	
	; generate an internal blitz event
	Flip
	Cls
	Text 10,10,selected
	Text 10,40,WB3D_QueueSize()
	
	; get an event of the event queue.
	event = WB3D_WaitEvent()
	Select event
		
		
		Case WB3D_EVENT_GADGET
			selected = WB3D_EventSource()
			WB3D_GenerateEvents False
			Select selected
				Case button
					switch=Not switch
					If switch 
						WB3D_SetGadgetText(button,"Stop")
					Else
						WB3D_SetGadgetText(button,"Start")
					End If

				Case trackbar
					 WB3D_SetSpinnerPos(spinner,WB3D_GetTrackBarPos(trackbar))
				Case spinner
					 WB3D_SetTrackBarPos(trackbar,WB3D_GetSpinnerPos(spinner))
				
				
				
			
			End Select
			WB3D_GenerateEvents True

		Case WB3D_EVENT_KEYPRESS
		
			; wb_eventdata holds the key code that was pressed.
			keypressed = WB3D_EventData()
			Select keypressed
				
				Case WB3D_KEY_ESCAPE	
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
				
		Case WB3D_EVENT_WINDOW_CLOSE
		
			; wb3d_eventsource hold the handle to the window that close button was selected
			window = WB3D_EventSource()
			Select window
			
				Case example_window
					
					; set the flag to leave the loop.
					QUIT = 1
					
			End Select
	End Select
	
	If switch
		count=count+1
			If count&gt;100 count=0
				WB3D_GenerateEvents False
				WB3D_SetTrackBarPos (trackbar,count)
				WB3D_SetSpinnerPos (spinner,count)
				WB3D_GenerateEvents True
			End If	

	

Wend

; use notify using external winapi constants. 
WB3D_Notify "WB3D GUI Window Example","Bye, Thats It I Quit",MB_OK Or MB_ICONASTERISK
WB3D_EndGUI()
EndGraphics
End
</pre><br><br>kev <br><br></td></tr></table><br>
<a name="708369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK have run a few tests - the trackbar and  spinner events are now stopped by the WB3D_GenerateEvents true/false function. That works nicely, however, the button events still get queued up - its as if the WB3D_WaitEvent() command is timing out when you're manipulating the gadgets by code in this fashion.<br><br>Here's a short clip to demonstrate - (wmv) 1Mb<br><br><a href="http://pacemakeranimation.net/tutorials/wb3d.wmv" target="_blank">http://pacemakeranimation.net/tutorials/wb3d.wmv</a> <br><br></td></tr></table><br>
<a name="708372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have found the problem !! I removed the blitzcc.exe.manifest file from my bin directory and just using the standard version of the Common Controls it works fine !<br>I could kick myself up the backside !!<br>The XP version of the Common Controls has a lot more events that WB3d sees - the gotfocus(), mouseover(), lostfocus() events all seem to be captured unlike with the Standard version.<br>Probably in need of some kind of event hook functionality to get it working properly.<br>Damnation ! - I was quite liking the XP look. <br><br></td></tr></table><br>
<a name="708503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Smiff <br><br>I will setup blitzcc.exe with a manifest and see if its possable to handle these extra events.<br><br>BTW does your example work when setting a manifest to your compiled .exe? i wonder if this is a problem with manifest's or with the way blitzcc.exe and the use of manifests.<br><br>*EDIT fixed the event system when moving the trackbar, i will upload the fixed version later for you to try.<br><br>kev <br><br></td></tr></table><br>
<a name="708646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Kev the example behaves the same when setting the manifest to a compiled exe as when setting it to the blitzcc.exe. <br><br></td></tr></table><br>
<a name="708673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> HI Smiff<br><br>in my haste i edited the above post only to find my last additions broke the event system on other gadgets. although i can confirm that when using xp manifest events become strange. the manifest does indeed generate WM_MOUSEHOVER and WM_MOUSELEAVE events. im currently looking into why the event system is processing multipul events that should not be processed.<br><br>can you add WB3D_FlushEvents to the trackbar case statement, here this stops events going above 2.<br><br><pre class=code>

				Case trackbar
					 WB3D_FlushEvents
					 WB3D_SetSpinnerPos(spinner,WB3D_GetTrackBarPos(trackbar))

</pre><br><br>kev <br><br></td></tr></table><br>
<a name="749986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ricky Smith</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any news on the events with XP manifest issue ? <br><br></td></tr></table><br>
<a name="749993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Ricky  <br> <br>Ive still to find a fix for the manifest issue, the strange thing is most all the gadgets work correctly when a manifest is used.<br><br>kev <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
