<!DOCTYPE html><html lang="en" ><head ><title >Would this be overkill?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Would this be overkill?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Would this be overkill?</a><br><br>
<a name="341630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would it be overkill to create types for every single entity, triangle and vertex in my level? I'd really like to be able to do it, but I'm not sure if it will take up too much memory... and before you ask, I do have valid reasons for wanting to do this (it will save a lot of needless loops) <br><br></td></tr></table><br>
<a name="341632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's probably better to store triangles and vertices in banks. <br><br></td></tr></table><br>
<a name="341635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> That depends on how many entities, vertices, and triangles you have in your level. <br><br></td></tr></table><br>
<a name="341641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Chris,<br><br>Types are a nice way to package objects and build hierarcy for objects. I would only store this info if you need it readily available or to change it in game as it already stored in memory by blitz as an entity. <br><br></td></tr></table><br>
<a name="341658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to do it because I've created my own backface culling system using the dot product method and I need to be able to set the 'culled' Field of each vertex Type instance when looping through the triangles of the entity.<br><br><pre class=code>For each surface
	For each triangle
		;Cull or not?
		triangle\v0\culled = true/false
		triangle\v1\culled = true/false
		triangle\v2\culled = true/false
	Next
Next</pre>Thats roughly what I want to do... I thought I had found a solution after starting this topic but it doesn't work because of a possible bug in Blitz3D.<br><br>I tried setting the W coordinate of the vertex to be 1.0 or 0.0 by using VertexTexCoords, but VertexW appears to return 1.0 no matter what I set it to. I tried the same thing using the V coordinate and it worked, but obviously I need that for texture coordinates. <br><br></td></tr></table><br>
<a name="341661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Techlord</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I want to do it because I've created my own backface culling system using the dot product method <br></div>Wow, Chris! <br><br>I'm not sure why you want to do this as Blitz3D has builtin backface culling and its most likely faster. Good Luck. <br><br></td></tr></table><br>
<a name="341662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you aren't using vertex alpha, you could use that to store the flag. <br><br></td></tr></table><br>
<a name="341663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using all the vertex properties apart from the W texture coordinate. I need to create my own backface culling method because I'm creating a custom effect on a per-vertex basis and I don't want it to affect back facing vertices. <br><br></td></tr></table><br>
<a name="342067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Afrohorse</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had problems creating alot of types when I tried to adding extra information into a 256x256 map. <br><br>Basically I defined a type that had the information I needed per pixel of the map the ran though it new-ing 256x256(65536) of these types. <br><br>It seemed fine during the game, but when it came to freeing them off at the end it took ages - 10 minutes+! Not sure why, parhaps it runs through a list everytime you delete a type and re-organises the memory - but anyway, I changed it to create one type with arrays of data elements and it was fine. <br><br>So, creating too many types seems to cause a huge slow down when freeing them. <br><br></td></tr></table><br>
<a name="342072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, basically for each vertex you want to store whether is has been culled or not?<br><br>That's not the right way to do hidden face removal.  You should determine the normal of the face and cull it based on that.<br><br>Consider a cube, where the normals of the vertcies have been smoothed between all faces.  The normals now point out towards the corners.  You are facing the front of the cube, and can only see the front face.  Yet the vertices that the side faces are visible.  So with the method you're using those side faces would not be culled.<br><br>To calculate the normal of a face, you take the positions of the three vertcies of that face, perform a cross product using two sides of the triangle, and then normalize the resulting vector.  That's your face normal.<br><br>I'd SHOW you how to do it with my Calcualte Normals function but SOMEONE appears to have deleted it from the code archives.  Or if it is there it's not in any of the graphics or algorithm categories and there's no search function.  I'll re-add it and get back to you. <br><br></td></tr></table><br>
<a name="342086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, rather than just add the normal function tot he code arhcives, I added that, and then went ahead and deleted the uneccessary stuff for you to create a function to calculate face normals.<br><br>Here ya go:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=976" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=976</a> <br><br></td></tr></table><br>
<a name="342100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi sswift,<br><br>I am calculating the triangle normal and not the vertex normal. That's where the problem occurs... because I'm looping through the triangles of the mesh and not the vertices all I know about the current 3 vertices are their indexes. If I then want to set properties in the vertex type I have to loop through the Type until I find a match.<br><br>To give you a basic idea of what I'm trying to do, I want to visually represent every vertex of a mesh but ignore the back facing ones. I tried doing it by using a mesh but keeping the scale constant was too difficult due to objects to the left and right appearing bigger due to perspective etc. <br><br></td></tr></table><br>
<a name="342103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thinky ou can do what you want if you take my vertex normal calculation function, also in the code archives, in the same category as the above function, and modify it so that in the triangle loop, it doesn't store the face normal, but instead acesses an array of vertices, say Dim VertexFrontFace(Surface, Index) and sets that value to true for each vertex of a triangle if that triangle is found to be front facing.<br><br>Then only those vertcies which are connected to no triangles which are front facing will be set to false. <br><br></td></tr></table><br>
<a name="342110"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here, I coded a function to do that for ya.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=977" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=977</a> <br><br></td></tr></table><br>
<a name="342114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a nice bit of code sswift, but don't mesh surface indexes start from 1?<br><br>I think I'm gonna have to scrub the whole backface culling method because I forgot to take into account that more complex meshes will have front facing polygons behind other polygons and they will show up when I don't want them to.<br><br>The best way I can think of is to simply position a pivot at each vertex, offset it a bit in the direction of the vertex normal and then do an EntityVisible check from the camera to the pivot to see if it should be rendered. <br><br></td></tr></table><br>
<a name="342116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Odds On</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just tried doing that and as I expected it was far too slow even on a reasonably low polygon mesh. I think I'll probably have to use a mesh to represent the vertex.. hopefully the surface count won't make it too slow. <br><br></td></tr></table><br>
<a name="342122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> " That's a nice bit of code sswift, but don't mesh surface indexes start from 1?"<br><br>I knew there was a reason I started that loop from 1... I changed it cause I usualyl start loops from 0. :-) <br><br></td></tr></table><br>
<a name="342188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why on earth would you want to backface cull in software? It's slower. <br><br></td></tr></table><br>
<a name="342202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >darklordz</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> he has he reasons if ya read the topic u might find out why... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
