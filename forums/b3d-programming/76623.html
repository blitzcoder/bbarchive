<!DOCTYPE html><html lang="en" ><head ><title >My CubeMapping Doesn't look right</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >My CubeMapping Doesn't look right</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >My CubeMapping Doesn't look right</a><br><br>
<a name="856822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://i270.photobucket.com/albums/jj119/fbepyon/14042008.png"><br><br>I have been trying to get the cube mapping to reflect the terrain, but I can't seem to figure it out why its not workin... <br><br></td></tr></table><br>
<a name="856890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to give slightly more information about what your doing. Are you using a seperate render to render the reflection? Are you positioning your camera at the reflection point? Whats your code? etc :o) <br><br></td></tr></table><br>
<a name="856909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The camera is positioned just about the water plain..<br><br>as for the cubemapping code its just excately the same copy/pasted from the example on the blitz3d..<br><br>Also the cubemap is updated using a delta timer.. <br><br></td></tr></table><br>
<a name="856929"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> cubemapping for water is a big waste of processing.  Because, in cube mapping, you are sampling 6 camera angles.  But, your water is only one place...  Why not just do a mirror for the water?  There is a mirror code example in the code archive.  If you want to use a bump mapped water with reflection, then it is another case.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1524" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1524</a> <br><br></td></tr></table><br>
<a name="856937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeh im trying to get bump mapping in later, but I thought I had to get the cubemapping working first..<br><br>EDIT:::<br><br>I tried the mirror code, but it doesn't make any difference.. I get 300-400fps with both with flip false.. so I will stay with cubemapping, I just can't seem to get it to work the right way.. :(<br><br>Also My water will be thru out the whole level.. once I get the zoning in the engine..  But I won't run the cubemapping until Im in that zone.. <br><br></td></tr></table><br>
<a name="856952"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Doggie</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok... <br><br></td></tr></table><br>
<a name="856981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Once again..<br><br>I forgot to say Im trying to do this with out any dlls..<br><br>Is there anyway or is there something wrong..? <br><br></td></tr></table><br>
<a name="856984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> What to do is hide your main camera and enable your cubemapping camera. That way you can see exactly what the camera is rendering. <br><br></td></tr></table><br>
<a name="857024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..what about posting some code so we can dig into it? <br><br></td></tr></table><br>
<a name="857043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> k.. just so u know I switched this over to minib3d, same code, but its still not workin in either..<br><br>Cube Map Code..<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Function UpdateCubemap(tex:TTexture,camera:TCamera,entity:TMesh,lma:Int)
Local tex_sz=TextureWidth(tex)
ShowEntity camera
HideEntity entity
PositionEntity camera,EntityX#(entity),EntityY#(entity),EntityZ#(entity)
CameraClsColor camera,0,0,0
CameraClsMode camera,True,True
CameraViewport camera,0,0,tex_sz,tex_sz

lma = lma Mod 6
Select lma
	Case 1
		RotateEntity camera,0,90,0
		RenderWorld
		SetCubeFace tex,0
		BackBufferToTex(tex)
	Case 2
		RotateEntity camera,0,0,0
		RenderWorld	
		SetCubeFace tex,1
		BackBufferToTex(tex)
	Case 3
		RotateEntity camera,0,-90,0
		RenderWorld
		SetCubeFace tex,2
		BackBufferToTex(tex)
	Case 4
		RotateEntity camera,0,180,0
		RenderWorld
		SetCubeFace tex,3
		BackBufferToTex(tex)
	Case 5
		RotateEntity camera,-90,0,0
		RenderWorld
		SetCubeFace tex,4
		BackBufferToTex(tex)
	Case 0
		RotateEntity camera,90,0,0
		RenderWorld
		SetCubeFace tex,5
		BackBufferToTex(tex)
	End Select

ShowEntity entity
HideEntity camera
End Function

</textarea><br><br>I found this code in the code arcs, but I have tried like 4 different versions!!<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Creating Water plain code...

	Method createwater()
	
		w.camera=CreateCamera()
		w.mesh = CreateMesh()
		w.surf = CreateSurface(w.mesh)
		w.brush = CreateBrush()
		w.addwater(mesh,surf,1,1)
		EntityFX w.mesh,1|2|32
		
		w.texture = CreateTexture(128,128,1|128)
		BrushTexture w.brush,w.texture
		'w.brush = LoadBrush("water.bmp")
		PaintSurface w.surf,w.brush
		BrushFX w.brush,1|2
		
		SetCubeMode w.texture,1

	End Method
	
	Method addwater(mesh:TMesh,surf:TSurface,v:Float=16,u:Float=16,tersize:Int=128)
		
		If tersize &gt; 127 Then tersize = 127
		
		Local vx:Int, vz:Int
		
		For vx = 0 To tersize ; For vz = 0 To tersize 
		
			adata[vx,vz]=1
			wdata[vx,vz] = AddVertex(surf,vx,(128/255.0)*Float(32),vz,vx/Float(v),vz/Float(u))
			VertexColor surf,wdata[vx,vz],255,255,255,adata[vx,vz]
		
		Next ; Next
		
		Local tx:Int, tz:Int
		
		For tx = 0 To tersize - 1 ; For tz = 0 To tersize - 1
			
			AddTriangle surf,wdata[tx+1,tz],wdata[tx,tz],wdata[tx,tz+1]
			AddTriangle surf,wdata[tx+1,tz],wdata[tx,tz+1],wdata[tx+1,tz+1]
		
		Next ; Next
					
	End Method

</textarea><br><br>Sorry for the lack of comments, most of this is coding on the fly type stuff.. Im basicly testing myself so I can make this into a fully functional engine for a few games im planning..<br><br>:EDIT:<br><br>I got it working sorta, but its not lining up right, I noticed that I forgot to update the normals of the water.. :) but I don't understand why its off..<br><br>Okay I just figured out Cubemapping sucks for when you have a camera that moves.. :( because it makes the cube mapping all messed up, but if I was at one height it works fine.. very strange!! <br><br></td></tr></table><br>
<a name="857055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_33</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> With regular blitz3d, I don't do water, but I use instead libs such as AShadow, DevilShadow System (free), or FastExt.  I suggest anyone of those, but the one that have best result so far is AShadow's water, which looks really good if you can use it properly.  But, if you run minib3d, then ignore all of those... <br><br></td></tr></table><br>
<a name="857101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> No offense here, but could you post Blitz3D code. It's not much use if i can't compile it in blitz and see what the trouble is. Plus, i don't quite understand the differences in bmax, so mistakes are harder to spot.<br><br>If you want help on that code, post it in the blitzmax forum.<br><br>Thanks you :o) <br><br></td></tr></table><br>
<a name="857198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FBEpyon</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> there isn't much difference in the code..<br><br>but I have decided to switch this project fully over to B3d.  minib3d has a few things i Have seen that need to be fixed, and b3d has alot more to offer when it comes to libs like you said...<br><br>I tryed Devilshadow and its great.. so that was what made me switch back. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
