<!DOCTYPE html><html lang="en" ><head ><title >Climb Up Ramp Collision?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Climb Up Ramp Collision?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Climb Up Ramp Collision?</a><br><br>
<a name="1305766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I would like to know how this works with default B3D collisions. I tried all methods but I can't seem to get my player go climb up in a ramp platform.<br><br>Thanks <br><br></td></tr></table><br>
<a name="1305777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean by a "ramp platform" <br><br></td></tr></table><br>
<a name="1305779"></a>

<a name="1305781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you're talking about smooth obstacles or ramps, simply use linepick.<br>If you mean ladders then check: <br>C:\Program Files (x86)\Blitz3D\samples\si\fps<br><br>(which includes ramps/slopes also btw) <br><br></td></tr></table><br>
<a name="1305782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> \samples\mak\castle has ramps. <br><br></td></tr></table><br>
<a name="1305796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, pain in the *** ramps that keep you sliding slowly -.-<br><br>~GF <br><br></td></tr></table><br>
<a name="1305799"></a>

<a name="1305804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> With collisions yes indeed. That's why I use linepick - learned the hard way ;-) <br><br></td></tr></table><br>
<a name="1305805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Care to share a bit of example code in 3D to show us how you do that, @Nasher?<br><br>Thanks! =)<br><br>~GF <br><br></td></tr></table><br>
<a name="1305813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sure, nothing suitable for publishing, will have to pull out, no can't do right now, but doesn't the multiplayer example contain similar code(fake gravity with linepick and a ramp)?<br><br><img src="http://i.imgur.com/iAXV2Ym.png"><br>(need to sleep. what am I doing here at 1:20 in the morning? I guess it's addiction.. :-) ltrs.. <br><br></td></tr></table><br>
<a name="1305819"></a>

<a name="1305825"></a>

<a name="1305826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys. I know about linepick but it would probably easy with a basic example.<br><br>@Rick Nasher<br>I see that one but kinda confused how that works. I noticed it uses collisions command with the linepick :/ ( lol, ok get some sleep! thanks and see ya in the morning :)<br><br>I would appreciate reading a simpler code like the ones you see in the online manual. thanks<br><br>@RemiD<br><br>That pic above right there is one example <br><br></td></tr></table><br>
<a name="1305882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RustyKristi&gt;&gt;oh you mean a slope.<br><br>Not sure what is the difficulty with this.<br>What i do is that i separate the detection of the obstacles below (terrains, floors), above (ceilings), and the detection of the obstacles at front, back, left, right.<br><br>This means that each loop, for each turningmoving character/vehicle there are 2 translations, first one up/down, then one front/back/left/right. (or the other way around)<br><br>Also keep in mind that you can manage collision detection and repositionning with a combination of linepicks + pickables and ellipsoids + collidables or only with linepicks + pickables.<br><br>Just make sure that the pickables/collidables are low details meshes and it will be fast enough...<br><br><br>The example that Rick proposes is really primitive imo... <br><br></td></tr></table><br>
<a name="1306045"></a>

<a name="1306046"></a>

<a name="1306047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD <br>Actually.. sort of regarding the same topic: collisions &amp; gravity.<br> <br>Using the <a href="/post.php?topic=105608&amp;post=1306044" target="_blank"><b>code example</b></a> I mentioned, I'd like to reduce health when falling and die when from a too high cliff, but I can't seem to get it to detect these situations above without errors. I mean it works, but also kills the player when running down a ramp, it somehow sees this as gravity too.<br><br>Any idea's on how to achieve something like this? <br><br></td></tr></table><br>
<a name="1306050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD<br><br>Actually, I tried the UDP example that Rick pointed out and it is something that I am looking for but I can't seem to put it all together to build a basic example from that. <br><br></td></tr></table><br>
<a name="1306092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Rick and RustyKristy&gt;&gt;<br>Try to separate the movement and the detection of the obstacles at front,back,left,right (with ellipsoids and collidables) ; and the movement and the detection of the obstacles at up,down (with linepick and pickables)<br><br>Your problem is probably because you use only one ellipsoid and you turnmove this ellipsoid (which can't go through obstacles) instead of using a pivot (with childs ellipsoids) and you turnmove this pivot (which can go through obstacles) (but still detect collisions with the environment thanks to the childs ellipsoids). <br><br></td></tr></table><br>
<a name="1306097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, can you put a very basic example at least as I would like to learn from it?<br><br>Also problem with shapes if you have a rectangular object like a car and you try to climb it, I guess you have to fake the pitch of your mesh so it does not look weird? This is not a problem with humanoid meshes or objects that take less space. <br><br></td></tr></table><br>
<a name="1306117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD<br>My problem isn't the same for it's detection and collision system is working fine in general. <br><br>Only issue is that I want add the ability to destinquish between a high drop and normal colisions. High drops deducting health/energy and even higher causing death.  <br><br>I thought it would be piece of cake but actually isn't( I'm probably on the wrong track). When is a dropt a too high drop? I thought about using: if 'gravity vector velocityY' &gt; maxthreshold, but apparentlty this increases also rapidly when running down a ramp, causing sudden death. :-(<br><br>I just know this should be very simple to do as I used it in the past, many years ago. Forgot how I did it though. <br><br></td></tr></table><br>
<a name="1306119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt; maxthreshold / 2 <br><br></td></tr></table><br>
<a name="1306122"></a>

<a name="1306135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dunno how that would work GF. Nevertheless, it actually made me think about reality:<br>In real life falling is always faster than running down a ramp.<br>Hence the situation in the game. Where it's the opposite. <br><br></td></tr></table><br>
<a name="1306134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RustyKristi&gt;&gt;<br>I am not in a coding mood and i don't want to spend time on that for the moment, but i will try to find an old code example to illustrate what i mean.<br><br><br>@Rick&gt;&gt;What you want is easy to make, you simply have one variable for each character for example character_gravityspeed# and when the character is falling, this value increase (or decrease depending on how you want to code it) and the higher the absolute value, the bigger the damage when the character is landing on the ground. <br><br></td></tr></table><br>
<a name="1306136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> with one pivot + several childs ellipsoids + collidables (using Blitz3d collision system) :<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D(800,600,32,2)

SeedRnd(MilliSecs())

Origine = CreateCube()
ScaleMesh(Origine,0.01/2,0.01/2,0.01/2)
EntityColor(Origine,255,000,000)

;Input
Const CUp% = 1
Const CToDown% = 2
Const CDown% = 3
Const CToUp% = 4

Global MPX% = 0
Global MPY% = 0
Global MXDiff# = 0
Global MYDiff# = 0

Global MZOld% = 0
Global MZCur% = 0
Global MWheel% = 0

Global Camera = CreateCamera()
CameraRange(Camera,0.1,100)

Global TerrainRenderer 
Global TerrainCollidable

BuildTerrain()

BuildingsMaxCount% = 100
Global BuildingsCount%
;Dim BuildingHeight#(BuildingsMaxCount)
Dim BuildingRenderer(BuildingsMaxCount)
Dim BuildingCollidable(BuildingsMaxCount)

BuildBuildings()

PlatformsMaxCount% = 100
Global PlatformsCount%
Dim PlatformRenderer(PlatformsMaxCount)
Dim PlatformCollidable(PlatformsMaxCount)

BuildPlatforms()

CharactersMaxCount% = 10
Global CharactersCount%
Dim CharacterFeet(CharactersMaxCount)
Dim CharacterEyes(CharactersMaxCount)
Dim CharacterRenderer(CharactersMaxCount)
Dim CharacterCollider(CharactersMaxCount,10)
Dim DebugCharacterCollider(CharactersMaxCount,10)
Dim CharacterState%(CharactersMaxCount)
Dim CharacterTarget(CharactersMaxCount)

BuildCharacters()

Global PlayerId%

PlayerId = Rand(1,10)
SetEntityAsFree(Camera)
PositionRotateEntityLikeOtherEntity(Camera,CharacterEyes(PlayerId))
MoveEntity(Camera,0,0,-3)
SetEntityAsChildOfOtherEntity(Camera,CharacterEyes(PlayerId))
RotateEntity(CharacterEyes(PlayerId),22.5,0,0)

;PositionEntity(Camera,0,0,-3)

DLight = CreateLight(1)
LightColor(DLight,200,200,200)
PositionEntity(DLight,-1000,1000,-1000)
RotateEntity(DLight,45,-45,0)

AmbientLight(050,050,050)

Global CollidedCollidable%
Global CollidedName$
Global CollidedKind$
Global CollidedId%

Const GroupTerrainsR% = 1
Const GroupBuildingsR% = 2
Const GroupPlatformsR% = 3
Const GroupCharactersER% = 100

Global UpdateCollidersTime%
Global UpdateCollisionsTime%

Main()

EndGraphics()

End()

Function PositionRotateEntityLikeOtherEntity(Entity,OtherEntity)
 PositionEntity(Entity,EntityX(OtherEntity,True),EntityY(OtherEntity,True),EntityZ(OtherEntity,True))
 RotateEntity(Entity,EntityPitch(OtherEntity,True),EntityYaw(OtherEntity,True),EntityRoll(OtherEntity,True))
End Function

Function PositionEntityLikeOtherEntity(Entity,OtherEntity)
 PositionEntity(Entity,EntityX(OtherEntity,True),EntityY(OtherEntity,True),EntityZ(OtherEntity,True))
End Function

Function RotateEntityLikeOtherEntity(Entity,OtherEntity)
 RotateEntity(Entity,EntityPitch(OtherEntity,True),EntityYaw(OtherEntity,True),EntityRoll(OtherEntity,True))
End Function

Function SetEntityAsChildOfOtherEntity(Entity,OtherEntity)
 EntityParent(Entity,OtherEntity,True)
End Function

Function SetEntityAsFree(Entity)
 EntityParent(Entity,0)
End Function

Function Distance2D#(PAX#,PAZ#,PBX#,PBZ#)
 VX# = PBX - PAX
 VZ# = PBZ - PAZ
 Distance2D# = Sqr((VX*VX)+(VZ*VZ))
 Return Distance2D
End Function

Function Distance3D#(PAX#,PAY#,PAZ#,PBX#,PBY#,PBZ#)
 VX# = PBX - PAX
 VY# = PBY - PAY
 VZ# = PBZ - PAZ
 Distance3D# = Sqr((VX*VX)+(VY*VY)+(VZ*VZ))
 Return Distance3D
End Function

Function BuildTerrain()

 TerrainRenderer = CreateTerrain(128)
 For VX% = 0 To 128-1
  For VZ% = 0 To 128-1
   HeightRGB% = Rand(030,033)
   Height# = 1.0/255*HeightRGB
   ModifyTerrain(TerrainRenderer,VX,VZ,Height,False) 
  Next
 Next
 ScaleEntity(TerrainRenderer,1,25.5,1)
 TerrainDetail(TerrainRenderer,4000,True)
 TerrainShading(TerrainRenderer,True)
 PositionEntity(TerrainRenderer,0,0,0)
 EntityColor(TerrainRenderer,000,100,000)
 NameEntity(TerrainRenderer,"TER"+Str(1))

End Function

Function BuildBuildings()

 For i% = 1 To 100
  BuildingsCount = BuildingsCount + 1
  BId% = BuildingsCount
  TWidth# = Rnd(1,5)
  TDepth# = Rnd(1,5)
  THeight# = Rnd(0.25,15)
  BuildingRenderer(BId) = CreateMesh()
  TPart = CreateCube()
  ScaleMesh(TPart,TWidth/2,0.3/2,TDepth/2)
  PositionMesh(TPart,0,-0.15,0)
  AddMesh(TPart,BuildingRenderer(BId))
  FreeEntity(TPart)
  TPart = CreateCube()
  ScaleMesh(TPart,TWidth/2,THeight/2,TDepth/2)
  PositionMesh(TPart,0,THeight/2,0)
  AddMesh(TPart,BuildingRenderer(BId))
  FreeEntity(TPart)
  EntityColor(BuildingRenderer(BId),100,100,100)
  BuildingCollidable(BId) = CopyMesh(BuildingRenderer(BId))
  EntityAlpha(BuildingCollidable(BId),0.25)
  NameEntity(BuildingCollidable(BId),"BUI"+Str(BId))
  .LineChooseBuildingPosition
  TX# = Rnd(1+TWidth/2,100-1-TWidth/2)
  TY# = 3.3
  TZ# = Rnd(1+TDepth/2,100-1-TDepth/2)
  PositionEntity(BuildingCollidable(BId),TX,TY,TZ)
  For OBId% = 1 To BuildingsCount
   If(OBId &lt;&gt; BId)
    If(MeshesIntersect(BuildingCollidable(BId),BuildingCollidable(OBId))=True)
     Goto LineChooseBuildingPosition
    EndIf
   EndIf
  Next
  PositionEntity(BuildingRenderer(BId),TX,TY,TZ)
 Next
End Function

Function BuildPlatforms()

 For i% = 1 To 100
  PlatformsCount = PlatformsCount + 1
  PId % = PlatformsCount
  TWidth# = Rnd(0.5,3)
  TDepth# = Rnd(0.5,3)
  PlatformRenderer(PId) = CreateMesh()
  TPart = CreateCube()
  ScaleMesh(TPart,TWidth/2,0.1/2,TDepth/2)
  PositionMesh(TPart,0,0.05,0)
  AddMesh(TPart,PlatformRenderer(PId))
  FreeEntity(TPart)
  EntityColor(PlatformRenderer(PId),100,100,100)
  PlatformCollidable(PId) = CopyMesh(PlatformRenderer(PId))
  EntityAlpha(PlatformCollidable(PId),0.25)
  NameEntity(PlatformCollidable(PId),"PLA"+Str(PId))
  .LineChoosePlatformPosition
  TX# = Rand(1+TWidth/2,100-1-TWidth/2)
  TY# = Rnd(3.3,10)
  TZ# = Rand(1+TDepth/2,100-1-TDepth/2)
  PositionEntity(PlatformCollidable(PId),TX,TY,TZ)
  For BId% = 1 To BuildingsCount
   If(MeshesIntersect(PlatformCollidable(PId),BuildingCollidable(BId))=True)
    Goto LineChoosePlatformPosition
   EndIf
  Next
  For OPId% = 1 To PlatformsCount
   If(OPId &lt;&gt; PId)
    If(MeshesIntersect(PlatformCollidable(PId),PlatformCollidable(OPId))=True)
     Goto LineChoosePlatformPosition
    EndIf
   EndIf
  Next
  PositionEntity(PlatformRenderer(PId),TX,TY,TZ)
 Next

End Function

Function BuildCharacters()

 For i% = 1 To 10
  CharactersCount = CharactersCount + 1
  CId% = CharactersCount

  R% = Rand(050,250)
  G% = Rand(050,250)
  B% = Rand(050,250)

  ;Feet
  CharacterFeet(CId) = CreatePivot()
  PositionEntity(CharacterFeet(CId),0,0,0)

  ;Eyes
  CharacterEyes(CId) = CreatePivot()
  PositionRotateEntityLikeOtherEntity(CharacterEyes(CId),CharacterFeet(CId))
  SetEntityAsChildOfOtherEntity(CharacterEyes(CId),CharacterFeet(CId))
  MoveEntity(CharacterEyes(CId),0,1.6,0.15)
  DebugCharacterEyes = CreateCube()
  ScaleMesh(DebugCharacterEyes,0.14/2,0.04/2,0.08/2)
  PositionMesh(DebugCharacterEyes,0,0,0.04)
  PositionRotateEntityLikeOtherEntity(DebugCharacterEyes,CharacterEyes(CId))
  SetEntityAsChildOfOtherEntity(DebugCharacterEyes,CharacterEyes(CId))
  EntityColor(DebugCharacterEyes,R,G,B)

  ;Mesh
  CharacterRenderer(CId) = CreateCube()
  ScaleMesh(CharacterRenderer(CId),0.5/2,1.7/2,0.25/2)
  PositionMesh(CharacterRenderer(CId),0,1.7/2,0)
  PositionRotateEntityLikeOtherEntity(CharacterRenderer(CId),CharacterFeet(CId))
  SetEntityAsChildOfOtherEntity(CharacterRenderer(CId),CharacterFeet(CId))
  EntityColor(CharacterRenderer(CId),R,G,B)

  ;DebugColliderEs
  For ii% = 1 To 10
   DebugCharacterCollider(CId,ii%) = CreateSphere(8)
   ScaleMesh(DebugCharacterCollider(CId,ii%),0.25,0.25,0.25)
   EntityAlpha(DebugCharacterCollider(CId,ii%),0.5)
  Next

  ;ColliderEs
  For EId% = 1 To 6
   VY# = 0+(EId*0.25)
   CharacterCollider(CId,EId) = CreatePivot()  
   PositionRotateEntityLikeOtherEntity(CharacterCollider(CId,EId),CharacterFeet(CId))
   MoveEntity(CharacterCollider(CId,EId),0,VY,0)
   SetEntityAsChildOfOtherEntity(CharacterCollider(CId,EId),CharacterFeet(CId))
   PositionRotateEntityLikeOtherEntity(DebugCharacterCollider(CId,EId),CharacterFeet(CId))
   MoveEntity(DebugCharacterCollider(CId,EId),0,VY,0)
   SetEntityAsChildOfOtherEntity(DebugCharacterCollider(CId,EId),CharacterFeet(CId))
   NameEntity(CharacterCollider(CId,EId),"CHA"+Str(CId))  
  Next

  ;Target
  CharacterTarget(CId) = CreatePivot()
  DebugCharacterTarget = CreateCylinder(8)
  ScaleMesh(DebugCharacterTarget,0.5/2,0.001/2,0.5/2)
  PositionRotateEntityLikeOtherEntity(DebugCharacterTarget,CharacterTarget(CId))
  SetEntityAsChildOfOtherEntity(DebugCharacterTarget,CharacterTarget(CId))
  EntityColor(DebugCharacterTarget,R,G,B)

  PositionEntity(CharacterFeet(CId),32.0/(12)*i,3.3+0.001,0.5)
  PositionEntityLikeOtherEntity(CharacterTarget(CId),CharacterFeet(CId))

 Next

End Function

Function Main()
 
 While(KeyDown(1)&lt;&gt;1)

  GetInputvBasic()

  If(KeyHit(3)&gt;0)
   PlayerId = PlayerId + 1
   If(PlayerId &gt; 10)
    PlayerId = 1
   EndIf
   SetEntityAsFree(Camera)
   PositionRotateEntityLikeOtherEntity(Camera,CharacterEyes(PlayerId))
   SetEntityAsChildOfOtherEntity(Camera,CharacterEyes(PlayerId))
   MoveEntity(Camera,0,0,-3)
   RotateEntity(CharacterEyes(PlayerId),22.5,0,0)
  EndIf

  UpdateColliders()

  UpdatePlayerBC()

  UpdateBotsBC()
 
  UpdateCollisionsStart% = MilliSecs()
  UpdateWorld(0)
  UpdateCollisionsTime% = MilliSecs() - UpdateCollisionsStart

  UpdatePlayerAC()

  UpdateBotsAC()

  If(KeyDown(2)=1)
   WireFrame(True)
  Else
   WireFrame(False)
  EndIf

  SetBuffer(BackBuffer())
  RenderWorld()
 
  Text(0,0,"Triangles = "+TrisRendered())
  Text(0,20,"FPS = "+Str(FPS))
  Text(0,40,"CollidedCollidable = "+Str(CollidedCollidable))
  Text(0,60,"CollidedName = "+CollidedName)
  Text(0,80,"CollidedKind = "+CollidedKind)
  Text(0,100,"CollidedId = "+Str(CollidedId))
  Text(0,260,"UpdateCollidersTime = "+Str(UpdateCollidersTime))
  Text(0,280,"UpdateCollisionsTime = "+Str(UpdateCollisionsTime))

  Flip(1)

 Wend

End Function

Function GetInputvBasic()

 ;MouseWheel
 MWheel = 0
 MZCur = MouseZ()
 If(MZCur &gt; MZOld)
  MWheel = + 1
  MZOld = MZCur
  ;DebugLog("MWheel = "+MWheel)
 ElseIf(MZCur &lt; MZOld)
  MWheel = - 1
  MZOld = MZCur
  ;DebugLog("MWheel = "+MWheel)
 EndIf

 ;Mouse picker properties
 MXDiff = MouseXSpeed()  
 MYDiff = MouseYSpeed() 
 MPX = MouseX()
 MPY = MouseY()

End Function

Function UpdateColliders()

 UpdateCollidersStart% = MilliSecs()

 ;Delete Colliders 
 For CId% = 1 To CharactersCount
  For EId% = 1 To 6
   SetEntityAsFree(CharacterCollider(CId,EId))
   SetEntityAsFree(DebugCharacterCollider(CId,EId))
   FreeEntity(CharacterCollider(CId,EId))
   CharacterCollider(CId,EId) = 0
  Next
 Next

 ;Recreate Colliders
 For CId% = 1 To CharactersCount
  ;ColliderEs
  For EId% = 1 To 6
   VY# = 0+(EId*0.25)
   CharacterCollider(CId,EId) = CreatePivot()  
   PositionRotateEntityLikeOtherEntity(CharacterCollider(CId,EId),CharacterFeet(CId))
   MoveEntity(CharacterCollider(CId,EId),0,VY,0)
   SetEntityAsChildOfOtherEntity(CharacterCollider(CId,EId),CharacterFeet(CId))
   PositionRotateEntityLikeOtherEntity(DebugCharacterCollider(CId,EId),CharacterFeet(CId))
   MoveEntity(DebugCharacterCollider(CId,EId),0,VY,0)
   SetEntityAsChildOfOtherEntity(DebugCharacterCollider(CId,EId),CharacterFeet(CId))
   NameEntity(CharacterCollider(CId,EId),"CHA"+Str(CId))  
  Next
 Next

 ;give each collider and each collidable a collision group
 EntityType(TerrainRenderer,GroupTerrainsR)
 For BId% = 1 To BuildingsCount
  EntityType(BuildingCollidable(BId),GroupBuildingsR)
 Next 
 For PId% = 1 To PlatformsCount
  EntityType(PlatformCollidable(PId),GroupPlatformsR)
 Next
 For CId% = 1 To CharactersCount
  For EId% = 1 To 6
   EntityRadius(CharacterCollider(CId,EId),0.25)
   EntityType(CharacterCollider(CId,EId),GroupCharactersER+CId)
   NameEntity(CharacterCollider(CId,EId),"CHA"+Str(CId))
  Next
 Next

 ClearCollisions()
 ;define collision detection and response between different collision groups
 For CId% = 1 To CharactersCount
  Collisions(GroupCharactersER+CId,GroupTerrainsR,2,1)
  Collisions(GroupCharactersER+CId,GroupBuildingsR,2,1)
  Collisions(GroupCharactersER+CId,GroupPlatformsR,2,1)
  For OCId% = 1 To CharactersCount
   If(OCId &lt;&gt; CId)
    Collisions(GroupCharactersER+CId,GroupCharactersER+OCId,1,1)
   EndIf
  Next
 Next

 UpdateCollidersTime = MilliSecs() - UpdateCollidersStart

End Function

Function UpdatePlayerBC()

 Id% = PlayerId
 If(KeyDown(30)=1)
  TurnEntity(CharacterFeet(Id),0,1.5,0)
 ElseIf(KeyDown(32)=1)
  TurnEntity(CharacterFeet(Id),0,-1.5,0)
 EndIf
 If(KeyDown(17)=1)
  MoveEntity(CharacterFeet(Id),0,0,0.1)
 ElseIf(KeyDown(31)=1)
  MoveEntity(CharacterFeet(Id),0,0,-0.1)
 EndIf
 If(KeyDown(16)=1)
  MoveEntity(CharacterFeet(Id),0,-0.1,0)
 ElseIf(KeyDown(18)=1)
  MoveEntity(CharacterFeet(Id),0,0.1,0)
 EndIf
 If(KeyDown(44)=1)
  MoveEntity(CharacterFeet(Id),-0.1,0,0)
 ElseIf(KeyDown(45)=1)
  MoveEntity(CharacterFeet(Id),0.1,0,0)
 EndIf

End Function

Function UpdatePlayerAC()

 Id% = PlayerId
 For EId% = 1 To 6
  CC% = CountCollisions(CharacterCollider(Id,EId))
  If(CC% &gt; 0)
   CollidedCollidable = CollisionEntity(CharacterCollider(Id,EId),1)
   If(CollidedCollidable &lt;&gt; 0)
    TName$ = EntityName(CollidedCollidable)
    TKind$ = Left(TName,3)
    TId% = Right(TName,Len(TName)-3)
    VY# = 0+(EId*0.25)
    TFormPoint(0,-VY,0,CharacterCollider(Id,EId),0)
    PositionEntity(CharacterFeet(Id),TFormedX(),TFormedY(),TFormedZ())
    Goto LineEndCheckCollisions
   EndIf
  EndIf
 Next
 .LineEndCheckCollisions

End Function

Function UpdateBotsBC()

 For Id% = 1 To CharactersCount
  If(Id &lt;&gt; PlayerId)

  EndIf
 Next

End Function

Function UpdateBotsAC()

 For Id% = 1 To CharactersCount
  If(Id &lt;&gt; PlayerId)

  EndIf
 Next

End Function
</textarea> <br><br></td></tr></table><br>
<a name="1306139"></a>

<a name="1306140"></a>

<a name="1310456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> with one pivot + several linepicks + pickables (using Blitz3d linepick system) :<br><pre class=code>
rd-stuff.fr/one-pivot+several-linepicks+pickables-code-example.bb
</pre><br>this one i will delete it in a few days (because i will probably reuse the code later), so download it while you can ! <br><br></td></tr></table><br>
<a name="1306141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have fun figuring it out ! :P <br><br></td></tr></table><br>
<a name="1306153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> You know what, Remi? I'll modify this code for him, AND I will be posting it FOR ALL TO SEE because you are nothing to me! Do NOT talk to Remi anymore, @RustiKrusti, he's a royal PAIN in EVERYONE's @5*!<br><br>Here's the original code :: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D(640,480,32,2)  
HidePointer()  

SeedRnd(MilliSecs())  

Global Arial14Font = LoadFont("Arial",14,False,False,False)

Global MPX%
Global MPY%
Global MXDiff#
Global MYDiff#

Global MZOld% = 0
Global MZCur% = 0
Global MWheel% = 0

Const CIdle% = 1 ;Up
Const CPressed% = 2 ;UpToDown
Const CHeld% = 3 ;Down
Const CReleased% = 4 ;DownToUp

Global KeySpaceState%
Global KeySpacePrevState%
Global KeySpaceDownCount

Origine = CreateCube()  
ScaleMesh(Origine,0.01/2,0.01/2,0.01/2)
EntityColor(Origine,255,000,255)

Global Camera = CreateCamera()  
CameraRange(Camera,0.1,100)
CameraClsColor(Camera,000,000,000)  

;terrain
Global TerrainROAM
BuildTerrain()

;buildings
Global BuildingsCount%
Dim BuildingRoot(11)
Dim BuildingRenderer(11)
Dim BuildingXZRadius#(11)
Dim BuildingPickable(11)
BuildBuildings()

;stairs
Global StairsCount%
Dim StairRoot(100)
Dim StairRenderer(100)
Dim StairXZRadius#(100)
Dim StairPickable(100)
BuildStairs()

;slopes
Global SlopesCount%
Dim SlopeRoot(100)
Dim SlopeRenderer(100)
Dim SlopeXZRadius#(100)
Dim SlopePickable(100)
BuildSlopes()

;rocks
Global RocksCount%
Dim RockRoot(10)
Dim RockRenderer(10)
Dim RockXZRadius#(10)
Dim RockPickable(10)
BuildRocks()

;trees
Global TreesCount%
Dim TreeRoot(10)
Dim TreeRenderer(10)
Dim TreeXZRadius#(10)
Dim TreePickable(10)
BuildTrees()

;crates
Global CratesCount%
Dim CrateRoot(10)
Dim CrateRenderer(10)
Dim CrateXZRadius#(10)
Dim CratePickable(10)
BuildCrates()

;barrels
Global BarrelsCount%
Dim BarrelRoot(10)
Dim BarrelRenderer(10)
Dim BarrelXZRadius#(10)
Dim BarrelPickable(10)
BuildBarrels()

;platforms
Global PlatformsCount%
Dim PlatformRoot(100)
Dim PlatformRenderer(100)
Dim PlatformXZRadius#(100)
Dim PlatformPickable(100)
Dim PlatformState%(100)
BuildPlatforms()

Global HumanoidsCount%
Dim HumanoidRoot(10)
Dim HumanoidRootYaw#(10)
Dim HumanoidMiddle(10)
Dim HumanoidEyes(10)
Dim HumanoidEyesPitch#(10)
Dim HumanoidRenderer(10)
Dim HumanoidXZRadius#(10)
Dim HumanoidPickable(10)
Dim HumanoidPostureMode%(10) ;CCrouching CStanding
Dim HumanoidMoveForce#(10)
Dim HumanoidJumpForce#(10)
Dim HumanoidPositionState%(10) ;COnAir or COnGround
Dim HumanoidActionState%(10) ;
Dim HumanoidAnimationState%(10) ;
Dim HumanoidGVX#(10)
Dim HumanoidGVY#(10)
Dim HumanoidGVZ#(10)
Dim HumanoidTarget(10)
BuildHumanoids()

Const COnAir% = 1
Const COnSlope% = 2
Const COnLedge% = 3
Const COnLadder% = 4
Const COnGround% = 5

Const CCrouching% = 1
Const CStanding% = 2

Const CIsCrouchingIdle% = 1
Const CIsCrouchingForward% = 2
Const CIsCrouchingBackward% = 3
Const CIsCrouchingLeft% = 4
Const CIsCrouchingRight% = 5

Const CIsStandingIdle% = 6
Const CIsStandingForward% = 7
Const CIsStandingBackward% = 8
Const CIsStandingLeft% = 9
Const CIsStandingRight% = 10

Const CIsJumping% = 11
Const CIsFalling% = 12
Const CIsLanding% = 13

Const CIsSliding% = 14

;Const CIsGrabbing% = 
;Const CIsClimbing% = 
;Const CIsLettingGo% = 

Global CapsuleRoot = CreatePivot()

Global LPsCount%
Dim LPY#(6)

Global PsCount%
Dim PStartX#(6)
Dim PStartY#(6)
Dim PStartZ#(6)
Dim PPickable%(6)
Dim PPointX#(6)
Dim PPointY#(6)
Dim PPointZ#(6)
Dim PNormalX#(6)
Dim PNormalY#(6)
Dim PNormalZ#(6)

Global Point = CreateCube()
ScaleMesh(Point,0.03/2,0.03/2,0.03/2)
EntityColor(Point,255,000,255)

SunLight = CreateLight(1)  
LightColor(SunLight,200,200,200)  
PositionEntity(SunLight,-1000,1000,-1000,True)  
RotateEntity(SunLight,45,-45,0,True)  

AmbientLight(100,100,100)

PositionEntity(Camera,64,32,-16,True)
RotateEntity(Camera,45,0,0,True)

Global PlayerId%
PlayerId = Rand(1,10)
PositionRotateEntityLikeOtherEntity(Camera,HumanoidEyes(PlayerId))
MoveEntity(Camera,0,0,-3)
HumanoidPostureMode(PlayerId) = CStanding
HumanoidMoveForce(PlayerId) = 0.05

Global LoopTimer = CreateTimer(20)
Global MainLoopMsTime%

Global SetSomeObstaclesAsPickableMsTime%
Global LinepicksMsTime%

Main()

End()

Function UpdatePlayer ( )

	If Not KeyDown ( 29 ) Or KeyDown ( 157 )
	
		If Not ( KeyDown ( 42 ) Or KeyDown ( 54 ) )
		
			MoveEntity PlayerId, 0, 0 ( KeyDown ( 
		
		Else
		
		EndIf

	Else

	EndIf

End Function

Function Main()

 While( KeyDown(1)&lt;&gt;1 )

  MainLoopMsStart% = MilliSecs()

  GetMouseInput()
  GetKeyboardInput()

  UpdatePlayer()
  UpdateAI()

  If( KeyDown(2)=1 )
   Wireframe(True)
  Else
   Wireframe(False)
  EndIf 

  PositionRotateEntityLikeOtherEntity(Camera,HumanoidEyes(PlayerId))
  MoveEntity(Camera,0,0,-3)

  SetBuffer(BackBuffer())
  RenderWorld()

  SetFont(Arial14Font)
  Color(255,255,255)
  CText("PlayerPostureMode = "+PostureModeStr(HumanoidPostureMode(PlayerId)),0,0)
  CText("PlayerMoveForce = "+HumanoidMoveForce(PlayerId),0,14)
  CText("PlayerJumpForce = "+HumanoidJumpForce(PlayerId),0,28)
  CText("PlayerPositionState = "+PositionStateStr(HumanoidPositionState(PlayerId)),0,42)
  CText("PlayerActionState = "+ActionStateStr(HumanoidActionState(PlayerId)),0,56)
  CText("PlayerGVX = "+HumanoidGVX(PlayerId),0,70)
  CText("PlayerGVY = "+HumanoidGVY(PlayerId),0,84)
  CText("PlayerGVZ = "+HumanoidGVZ(PlayerId),0,98)

  CText("SetSomeObstaclesAsPickableMsTime = "+SetSomeObstaclesAsPickableMsTime,400,0)
  CText("LinepicksMsTime = "+LinepicksMsTime,400,14)

  WaitTimer(LoopTimer)
  VWait()
  Flip()

  MainLoopMsTime% = MilliSecs() - MainLoopMsStart

 Wend

End Function

Function CText(TextStr$,PX%,PY%)
 Text(PX,PY,TextStr,False,False)
End Function

Function PositionEntityLikeOtherEntity(Entity,OEntity)
 PositionEntity(Entity,EntityX(OEntity,True),EntityY(OEntity,True),EntityZ(OEntity,True),True)
End Function

Function RotateEntityLikeOtherEntity(Entity,OEntity)
 RotateEntity(Entity,EntityPitch(OEntity,True),EntityYaw(OEntity,True),EntityRoll(OEntity,True),True)
End Function

Function PositionRotateEntityLikeOtherEntity(Entity,OEntity)
 PositionEntity(Entity,EntityX(OEntity,True),EntityY(OEntity,True),EntityZ(OEntity,True),True)
 RotateEntity(Entity,EntityPitch(OEntity,True),EntityYaw(OEntity,True),EntityRoll(OEntity,True),True)
End Function

Function SetEntityAsChildOfOtherEntity(Entity,OEntity)
 EntityParent(Entity,OEntity,True)
End Function

Function SetEntityAsFree(Entity)
 EntityParent(Entity,0)
End Function

Function Diag#(SideLength#)
 Diag# = Sqr( (SideLength * SideLength) + (SideLength * SideLength) )
 Return Diag
End Function

Function Distance2D#(PAX#,PAZ#,PBX#,PBZ#)
 VX# = PBX - PAX
 VZ# = PBZ - PAZ
 Distance2D# = Sqr((VX*VX)+(VZ*VZ))
 Return Distance2D
End Function

Function Distance3D#(PAX#,PAY#,PAZ#,PBX#,PBY#,PBZ#)
 VX# = PBX - PAX
 VY# = PBY - PAY
 VZ# = PBZ - PAZ
 Distance3D# = Sqr((VX*VX)+(VY*VY)+(VZ*VZ))
 Return Distance3D
End Function

Function AddSurfaceToOtherSurface(Mesh,Surface,OSurface)
 For TId% = 0 To CountTriangles(Surface)-1
  ;V0
  V0Id% = TriangleVertex(Surface,TId,0)
  V0LX# = VertexX(Surface,V0Id)
  V0LY# = VertexY(Surface,V0Id)
  V0LZ# = VertexZ(Surface,V0Id)
  TFormPoint(V0LX,V0LY,V0LZ,Mesh,0)
  V0GX# = TFormedX()
  V0GY# = TFormedY()
  V0GZ# = TFormedZ()
  V0NX# = VertexNX(Surface,V0Id)
  V0NY# = VertexNY(Surface,V0Id)
  V0NZ# = VertexNZ(Surface,V0Id)
  ;V1
  V1Id% = TriangleVertex(Surface,TId,1)
  V1LX# = VertexX(Surface,V1Id)
  V1LY# = VertexY(Surface,V1Id)
  V1LZ# = VertexZ(Surface,V1Id)
  TFormPoint(V1LX,V1LY,V1LZ,Mesh,0)
  V1GX# = TFormedX()
  V1GY# = TFormedY()
  V1GZ# = TFormedZ()
  V1NX# = VertexNX(Surface,V1Id)
  V1NY# = VertexNY(Surface,V1Id)
  V1NZ# = VertexNZ(Surface,V1Id)
  ;V2
  V2Id% = TriangleVertex(Surface,TId,2)
  V2LX# = VertexX(Surface,V2Id)
  V2LY# = VertexY(Surface,V2Id)
  V2LZ# = VertexZ(Surface,V2Id)
  TFormPoint(V2LX,V2LY,V2LZ,Mesh,0)
  V2GX# = TFormedX()
  V2GY# = TFormedY()
  V2GZ# = TFormedZ()
  V2NX# = VertexNX(Surface,V2Id)
  V2NY# = VertexNY(Surface,V2Id)
  V2NZ# = VertexNZ(Surface,V2Id)
  ;Triangle
  OldVerticesCount = CountVertices(OSurface) 
  NV0Id% = OldVerticesCount-1 + 1
  NV1Id% = OldVerticesCount-1 + 2 
  NV2Id% = OldVerticesCount-1 + 3
  AddVertex(OSurface,V0GX,V0GY,V0GZ)
  VertexNormal(OSurface,NV0Id,V0NX,V0NY,V0NZ)
  AddVertex(OSurface,V1GX,V1GY,V1GZ)
  VertexNormal(OSurface,NV1Id,V1NX,V1NY,V1NZ)
  AddVertex(OSurface,V2GX,V2GY,V2GZ)
  VertexNormal(OSurface,NV2Id,V2NX,V2NY,V2NZ)
  AddTriangle(OSurface,NV0Id,NV1Id,NV2Id)
 Next
End Function

Function ColorSurfaceWithBrush(Surface,R%,G%,B%,A#=1.0,Fx%=0)
 TBrush = CreateBrush()
 BrushColor(TBrush,R,G,B)
 BrushAlpha(TBrush,A)
 BrushFX(TBrush,Fx)
 PaintSurface(Surface,TBrush)
 FreeBrush(TBrush)
End Function

Function BuildTerrain()

 TerrainROAM = CreateTerrain(128)
 For HX% = 0 To 128-1 Step 1
  For HZ% = 0 To 128-1 Step 1
   HeightRGB% = Rand(030,032) ;030 to 032 for 20cm variation
   HeightY# = 1.0/255.0*Float(HeightRGB)
   ModifyTerrain(TerrainROAM,HX,HZ,HeightY,False) 
  Next
 Next
 ScaleEntity(TerrainROAM,1,25.5,1)
 TerrainDetail(TerrainROAM,4000,True)
 TerrainShading(TerrainROAM,True)
 EntityAlpha(TerrainROAM,0.5)

 TerrainDiffuseTexture = CreateTexture(128,128)
 SetBuffer(TextureBuffer(TerrainDiffuseTexture))
  For PX% = 0 To 128-1 Step 1
   For PY% = 0 To 128-1 Step 1
    R% = 000 
    G% = Rand(090,110)
    B% = 000
    Color(R,G,B)
    Plot(PX,PY)
   Next
  Next
 ScaleTexture(TerrainDiffuseTexture,128,128)
 TextureBlend(TerrainDiffuseTexture,2)
 ;EntityTexture(TerrainROAM,TerrainDiffuseTexture,0,0)

 NameEntity(TerrainROAM,"TER"+Str(1))

End Function

Function BuildBuildings()
 
 For i% = 1 To 10 Step 1

  Levels% = Rand(1,15)
  
  BuildingsCount = BuildingsCount + 1
  Id% = BuildingsCount

  BuildingRoot(Id) = CreatePivot()

  BuildingRenderer(Id) = CreateMesh()
  CreateSurface(BuildingRenderer(Id))
  For L% = 1 To Levels Step 1
   TWidth# = Rand(3,10)
   TDepth# = Rand(3,10)
   For GX# = 0 To TWidth-1 Step 1
    For GZ# = 0 To TDepth-1 Step 1
     RandomChoice% = Rand(1,3)
     If( RandomChoice = 1 Or RandomChoice = 2  )
      ;add a part
      TPart = CreateCube()
      ScaleMesh(TPart,1.0/2,1.0/2,1.0/2)
      PositionMesh(TPart,1.0/2,1.0/2,1.0/2)
      PositionMesh(TPart,GX,L-1,GZ)
      AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(BuildingRenderer(Id),1))
      FreeEntity(TPart)
     Else If( RandomChoice = 3 )
      ;add nothing
     EndIf
    Next
   Next
  Next
  MWidth# = MeshWidth(BuildingRenderer(Id))
  MDepth# = MeshDepth(BuildingRenderer(Id))
  PositionMesh(BuildingRenderer(Id),-MWidth/2,0,-MDepth/2)
  ;ColorSurfaceWithBrush(GetSurface(BuildingRenderer(Id),1),075,075,075)
  HideEntity(BuildingRenderer(Id))

  BuildingXZRadius(Id) = Diag(10)/2

  BuildingPickable(Id) = CopyEntity(BuildingRenderer(Id))
  EntityColor(BuildingPickable(Id),255,255,255)
  EntityAlpha(BuildingPickable(Id),0.5)

  .LineChooseBuildingPosition
  PositionEntity(BuildingRoot(Id),Rnd(0+MWidth/2,128-MWidth/2),3.1,Rnd(0+MDepth/2,128-10-3-MDepth/2),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( OId &lt;&gt; Id )
    If( Distance2D(EntityX(BuildingRoot(Id),True),EntityZ(BuildingRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= BuildingXZRadius(Id)+BuildingXZRadius(OId)+1 )
     Goto LineChooseBuildingPosition
    EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(BuildingRenderer(Id),BuildingRoot(Id))
  PositionRotateEntityLikeOtherEntity(BuildingPickable(Id),BuildingRoot(Id))
 
  NameEntity(BuildingPickable(Id),"BUI"+Str(Id))

 Next

End Function

Function BuildStairs()

 For THeight# = 0.125 To 0.375 Step 0.125
  For TDepth# = 0.25 To 0.5 Step 0.125

   StairsCount = StairsCount + 1
   Id% = StairsCount

   StairRoot(Id) = CreatePivot()

   StairRenderer(Id) = CreateMesh()
   CreateSurface(StairRenderer(Id))
   TWidth# = 3.0
   ;THeight# = 0.25 ;0.25
   ;TDepth# = 0.25
   For ii% = 1 To 12 Step 1
    TX# = 0
    TY# = 0+((ii-1)*THeight)
    TZ# = 0+((ii-1)*TDepth)
    TPart = CreateCube()
    ScaleMesh(TPart,TWidth/2,THeight/2,TDepth/2)
    PositionMesh(TPart,0,THeight/2,TDepth/2)
    PositionMesh(TPart,0,TY,TZ)
    AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(StairRenderer(Id),1))
    FreeEntity(TPart)
   Next
   ;PositionMesh(StairRenderer(Id),0,0,MeshDepth(StairRenderer(Id))/2)
   MWidth# = MeshWidth(StairRenderer(Id))
   MDepth# = MeshDepth(StairRenderer(Id))
   ;ColorSurfaceWithBrush(GetSurface(StairRenderer(Id),1),075,075,075)
   HideEntity(StairRenderer(Id))
 
   StairXZRadius(Id) = MDepth

   StairPickable(Id) = CopyEntity(StairRenderer(Id))
   EntityColor(StairPickable(Id),255,255,255)
   EntityAlpha(StairPickable(Id),0.5)

   .LineChooseStairPosition
   PositionEntity(StairRoot(Id),0+1.5+(Id-1)*3.0,3.1,128.0-10,True)
   PositionRotateEntityLikeOtherEntity(StairRenderer(Id),StairRoot(Id))
   PositionRotateEntityLikeOtherEntity(StairPickable(Id),StairRoot(Id))
 
   NameEntity(StairPickable(Id),"STA"+Str(Id))

  Next

 Next

End Function

Function BuildSlopes()

 For Pitch# = 0 To -90.0 Step -10.0

  SlopesCount = SlopesCount + 1
  Id% = SlopesCount

  SlopeRoot(Id) = CreatePivot()

  SlopeRenderer(Id) = CreateMesh()
  CreateSurface(SlopeRenderer(Id))
  TWidth# = 3.0
  TDepth# = 10.0

  TPart = CreateMesh()
  TSurface = CreateSurface(TPart)
  AddVertex(TSurface, -1.0, 0.0, 1.0 )
  AddVertex(TSurface, 1.0, 0.0, 1.0 )
  AddVertex(TSurface, -1.0, 0.0, -1.0 )
  AddVertex(TSurface, 1.0, 0.0, -1.0 )
  AddTriangle(TSurface,0,1,2)
  AddTriangle(TSurface,2,1,3)
  ScaleMesh(TPart,3.0/2,1.0,10.0/2)
  PositionMesh(TPart,0,0,10.0/2)
  RotateMesh(TPart,Pitch,0,0)
  UpdateNormals(TPart)
  ;AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(SlopeRenderer(Id),1))
  AddMesh(TPart,SlopeRenderer(Id))
  FreeEntity(TPart)

  ;PositionMesh(SlopeRenderer(Id),0,0,MeshDepth(SlopeRenderer(Id))/2)
  MWidth# = MeshWidth(SlopeRenderer(Id))
  MDepth# = MeshDepth(SlopeRenderer(Id))
  ;ColorSurfaceWithBrush(GetSurface(SlopeRenderer(Id),1),075,075,075)
  HideEntity(SlopeRenderer(Id))
 
  SlopeXZRadius(Id) = 13

  SlopePickable(Id) = CopyEntity(SlopeRenderer(Id))
  EntityColor(SlopePickable(Id),255,255,255)
  EntityAlpha(SlopePickable(Id),0.5)

  PositionEntity(SlopeRoot(Id),50+1.5+(Id-1)*3.0,3.1,128.0-10,True)
  PositionRotateEntityLikeOtherEntity(SlopeRenderer(Id),SlopeRoot(Id))
  PositionRotateEntityLikeOtherEntity(SlopePickable(Id),SlopeRoot(Id))
 
  NameEntity(SlopePickable(Id),"SLO"+Str(Id))

 Next

End Function

Function BuildRocks()
 
 For i% = 1 To 10 Step 1
  
  RocksCount = RocksCount + 1
  Id% = RocksCount

  RockRoot(Id) = CreatePivot()

  RockRenderer(Id) = CreateSphere(8)  
  Width# = Rnd(0.5,1.0)
  Height# = Rnd(0.25,0.5)
  Depth# = Rnd(0.5,1.0)
  ScaleMesh(RockRenderer(Id),Width/2,Height/2,Depth/2)
  ;ColorSurfaceWithBrush(GetSurface(RockRenderer(Id),1),075,075,075)
  HideEntity(RockRenderer(Id))

  RockXZRadius(Id) = 0.5

  RockPickable(Id) = CopyEntity(RockRenderer(Id))
  EntityColor(RockPickable(Id),255,255,255)
  EntityAlpha(RockPickable(Id),0.5)

  .LineChooseRockPosition
  PositionEntity(RockRoot(Id),Rnd(0+0.5,128-0.5),3.1,Rnd(0+0.5,128-10-3-0.5),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( Distance2D(EntityX(RockRoot(Id),True),EntityZ(RockRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= RockXZRadius(Id)+BuildingXZRadius(OId)+1 )
    Goto LineChooseRockPosition
   EndIf
  Next
  ;is far enough from another stair ?
  For OId% = 1 To StairsCount Step 1
   If( Distance2D(EntityX(RockRoot(Id),True),EntityZ(RockRoot(Id),True),EntityX(StairRoot(OId),True),EntityZ(StairRoot(OId),True)) &lt;= RockXZRadius(Id)+StairXZRadius(OId)+1 )
    Goto LineChooseRockPosition
   EndIf
  Next
  ;is far enough from another rock ?
  For OId% = 1 To RocksCount Step 1
   If( OId &lt;&gt; Id )
    If( Distance2D(EntityX(RockRoot(Id),True),EntityZ(RockRoot(Id),True),EntityX(RockRoot(OId),True),EntityZ(RockRoot(OId),True)) &lt;= RockXZRadius(Id)+RockXZRadius(OId)+1 )
     Goto LineChooseRockPosition
    EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(RockRenderer(Id),RockRoot(Id))
  PositionRotateEntityLikeOtherEntity(RockPickable(Id),RockRoot(Id))
 
  NameEntity(RockPickable(Id),"ROC"+Str(Id))

 Next

End Function

Function BuildTrees()

 For i% = 1 To 10 Step 1
  
  TreesCount = TreesCount + 1
  Id% = TreesCount

  TreeRoot(Id) = CreatePivot()

  TreeRenderer(Id) = CreateMesh()
  CreateSurface(TreeRenderer(Id))
  TPart = CreateCone(4)
  ScaleMesh(TPart,0.5/2,(10.0-1.5)/2,0.5/2)
  PositionMesh(TPart,0,(10.0-1.5)/2,0)
  AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(TreeRenderer(Id),1))
  FreeEntity(TPart)
  OldYaw# = 0
  For Y# = 1.5 To 10-1.5 Step 0.25
   Scale# = (10.0-1.5-Y)
   If( Scale &gt; 5.0 )
    Scale = 5.0
   EndIf
   .LineChooseBrancheYaw
   Yaw# = Rnd(-180.0,180.0)
   If( Yaw &gt; OldYaw-45 And Yaw &lt; OldYaw+45 )
    Goto LineChooseBrancheYaw
   EndIf
   OldYaw = Yaw
   TPart = CreateCone(4)
   ScaleMesh(TPart,Scale/20/2,Scale/2,Scale/20/2)
   PositionMesh(TPart,0,Scale/2,0)
   RotateMesh(TPart,-45,Yaw,0)
   PositionMesh(TPart,0,Y,0)
   AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(TreeRenderer(Id),1))
   FreeEntity(TPart)
  Next
  ;ColorSurfaceWithBrush(GetSurface(TreeRenderer(Id),1),075,050,025)
  HideEntity(TreeRenderer(Id))

  TreeXZRadius(Id) = 5.0

  TreePickable(Id) = CopyEntity(TreeRenderer(Id))
  EntityColor(TreePickable(Id),255,255,255)
  EntityAlpha(TreePickable(Id),0.5)

  .LineChooseTreePosition
  PositionEntity(TreeRoot(Id),Rnd(0+5.0,128-5.0),3.0,Rnd(0+5.0,128-10-3-5.0),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( Distance2D(EntityX(TreeRoot(Id),True),EntityZ(TreeRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= TreeXZRadius(Id)+BuildingXZRadius(OId)+1 )
    Goto LineChooseTreePosition
   EndIf
  Next
  ;is far enough from another Stair ?
  For OId% = 1 To StairsCount Step 1
   If( Distance2D(EntityX(TreeRoot(Id),True),EntityZ(TreeRoot(Id),True),EntityX(StairRoot(OId),True),EntityZ(StairRoot(OId),True)) &lt;= TreeXZRadius(Id)+StairXZRadius(OId)+1 )
    Goto LineChooseTreePosition
   EndIf
  Next
  ;is far enough from another rock ?
  For OId% = 1 To RocksCount Step 1
   If( Distance2D(EntityX(TreeRoot(Id),True),EntityZ(TreeRoot(Id),True),EntityX(RockRoot(OId),True),EntityZ(RockRoot(OId),True)) &lt;= TreeXZRadius(Id)+RockXZRadius(OId)+1 )
    Goto LineChooseTreePosition
   EndIf
  Next
  ;is far enough from another tree ?
  For OId% = 1 To TreesCount Step 1
   If( OId &lt;&gt; Id )
    If( Distance2D(EntityX(TreeRoot(Id),True),EntityZ(TreeRoot(Id),True),EntityX(TreeRoot(OId),True),EntityZ(TreeRoot(OId),True)) &lt;= TreeXZRadius(Id)+TreeXZRadius(OId)+1 )
     Goto LineChooseTreePosition
    EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(TreeRenderer(Id),TreeRoot(Id))
  PositionRotateEntityLikeOtherEntity(TreePickable(Id),TreeRoot(Id))
 
  NameEntity(TreePickable(Id),"TRE"+Str(Id))

 Next

End Function

Function BuildCrates()

 For i% = 1 To 10 Step 1
  
  CratesCount = CratesCount + 1
  Id% = CratesCount

  CrateRoot(Id) = CreatePivot()

  CrateRenderer(Id) = CreateMesh()
  CreateSurface(CrateRenderer(Id))
  TPart = CreateCube()
  ScaleMesh(TPart,0.5/2,0.5/2,0.5/2)
  PositionMesh(TPart,0,0.5/2,0)
  AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(CrateRenderer(Id),1))
  FreeEntity(TPart)
  ;ColorSurfaceWithBrush(GetSurface(CrateRenderer(Id),1),100,075,050)
  HideEntity(CrateRenderer(Id))

  CrateXZRadius(Id) = Diag(0.5)/2

  CratePickable(Id) = CopyEntity(CrateRenderer(Id))
  EntityColor(CratePickable(Id),255,255,255)
  EntityAlpha(CratePickable(Id),0.5)

  .LineChooseCratePosition
  PositionEntity(CrateRoot(Id),Rnd(0+0.25,128-0.25),3.2,Rnd(0+0.25,128-10-3-0.25),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( Distance2D(EntityX(CrateRoot(Id),True),EntityZ(CrateRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= CrateXZRadius(Id)+BuildingXZRadius(OId)+1 )
    Goto LineChooseCratePosition
   EndIf
  Next
  ;is far enough from another Stair ?
  For OId% = 1 To StairsCount Step 1
   If( Distance2D(EntityX(CrateRoot(Id),True),EntityZ(CrateRoot(Id),True),EntityX(StairRoot(OId),True),EntityZ(StairRoot(OId),True)) &lt;= CrateXZRadius(Id)+StairXZRadius(OId)+1 )
    Goto LineChooseCratePosition
   EndIf
  Next
  ;is far enough from another rock ?
  For OId% = 1 To RocksCount Step 1
   If( Distance2D(EntityX(CrateRoot(Id),True),EntityZ(CrateRoot(Id),True),EntityX(RockRoot(OId),True),EntityZ(RockRoot(OId),True)) &lt;= CrateXZRadius(Id)+RockXZRadius(OId)+1 )
    Goto LineChooseCratePosition
   EndIf
  Next
  ;is far enough from another tree ?
  For OId% = 1 To TreesCount Step 1
   If( Distance2D(EntityX(CrateRoot(Id),True),EntityZ(CrateRoot(Id),True),EntityX(TreeRoot(OId),True),EntityZ(TreeRoot(OId),True)) &lt;= CrateXZRadius(Id)+TreeXZRadius(OId)+1 )
    Goto LineChooseCratePosition
   EndIf
  Next
  ;is far enough from another crate ?
  For OId% = 1 To CratesCount Step 1
   If( OId &lt;&gt; Id )
    If( Distance2D(EntityX(CrateRoot(Id),True),EntityZ(CrateRoot(Id),True),EntityX(CrateRoot(OId),True),EntityZ(CrateRoot(OId),True)) &lt;= CrateXZRadius(Id)+CrateXZRadius(OId)+1 )
     Goto LineChooseCratePosition
    EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(CrateRenderer(Id),CrateRoot(Id))
  PositionRotateEntityLikeOtherEntity(CratePickable(Id),CrateRoot(Id))
 
  NameEntity(CratePickable(Id),"CRA"+Str(Id))

 Next

End Function

Function BuildBarrels()

 For i% = 1 To 10 Step 1
  
  BarrelsCount = BarrelsCount + 1
  Id% = BarrelsCount

  BarrelRoot(Id) = CreatePivot()

  BarrelRenderer(Id) = CreateMesh()
  CreateSurface(BarrelRenderer(Id))
  TPart = CreateCylinder(8)
  ScaleMesh(TPart,0.5/2,1.0/2,0.5/2)
  PositionMesh(TPart,0,1.0/2,0)
  ;AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(BarrelRenderer(Id),1))
  AddMesh(TPart,BarrelRenderer(Id))
  FreeEntity(TPart)
  ;ColorSurfaceWithBrush(GetSurface(BarrelRenderer(Id),1),100,075,050)
  HideEntity(BarrelRenderer(Id))

  BarrelXZRadius(Id) = 0.25

  BarrelPickable(Id) = CopyEntity(BarrelRenderer(Id))
  EntityColor(BarrelPickable(Id),255,255,255)
  EntityAlpha(BarrelPickable(Id),0.5)

  .LineChooseBarrelPosition
  PositionEntity(BarrelRoot(Id),Rnd(0+0.25,128-0.25),3.2,Rnd(0+0.25,128-10-3-0.25),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( Distance2D(EntityX(BarrelRoot(Id),True),EntityZ(BarrelRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= BarrelXZRadius(Id)+BuildingXZRadius(OId)+1 )
    Goto LineChooseBarrelPosition
   EndIf
  Next
  ;is far enough from another Stair ?
  For OId% = 1 To StairsCount Step 1
   If( Distance2D(EntityX(BarrelRoot(Id),True),EntityZ(BarrelRoot(Id),True),EntityX(StairRoot(OId),True),EntityZ(StairRoot(OId),True)) &lt;= BarrelXZRadius(Id)+StairXZRadius(OId)+1 )
    Goto LineChooseBarrelPosition
   EndIf
  Next
  ;is far enough from another rock ?
  For OId% = 1 To RocksCount Step 1
   If( Distance2D(EntityX(BarrelRoot(Id),True),EntityZ(BarrelRoot(Id),True),EntityX(RockRoot(OId),True),EntityZ(RockRoot(OId),True)) &lt;= BarrelXZRadius(Id)+RockXZRadius(OId)+1 )
    Goto LineChooseBarrelPosition
   EndIf
  Next
  ;is far enough from another tree ?
  For OId% = 1 To TreesCount Step 1
   If( Distance2D(EntityX(BarrelRoot(Id),True),EntityZ(BarrelRoot(Id),True),EntityX(TreeRoot(OId),True),EntityZ(TreeRoot(OId),True)) &lt;= BarrelXZRadius(Id)+TreeXZRadius(OId)+1 )
    Goto LineChooseBarrelPosition
   EndIf
  Next
  ;is far enough from another crate ?
  For OId% = 1 To CratesCount Step 1
   If( Distance2D(EntityX(BarrelRoot(Id),True),EntityZ(BarrelRoot(Id),True),EntityX(CrateRoot(OId),True),EntityZ(CrateRoot(OId),True)) &lt;= BarrelXZRadius(Id)+CrateXZRadius(OId)+1 )
    Goto LineChooseBarrelPosition
   EndIf
  Next
  ;is far enough from another Barrel ?
  For OId% = 1 To BarrelsCount Step 1
   If( OId &lt;&gt; Id )
    If( Distance2D(EntityX(BarrelRoot(Id),True),EntityZ(BarrelRoot(Id),True),EntityX(BarrelRoot(OId),True),EntityZ(BarrelRoot(OId),True)) &lt;= BarrelXZRadius(Id)+BarrelXZRadius(OId)+1 )
     Goto LineChooseBarrelPosition
    EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(BarrelRenderer(Id),BarrelRoot(Id))
  PositionRotateEntityLikeOtherEntity(BarrelPickable(Id),BarrelRoot(Id))
 
  NameEntity(BarrelPickable(Id),"BAR"+Str(Id))

 Next

End Function

Function BuildPlatforms()

 For i% = 1 To 30 Step 1

  PlatformsCount = PlatformsCount + 1
  Id% = PlatformsCount

  PlatformRoot(Id) = CreatePivot()

  PlatformRenderer(Id) = CreateMesh()
  CreateSurface(PlatformRenderer(Id))
  TPart = CreateCube()
  ScaleMesh(TPart,3.0/2,0.1/2,3.0/2)
  PositionMesh(TPart,0,0.1/2,0)
  AddSurfaceToOtherSurface(TPart,GetSurface(TPart,1),GetSurface(PlatformRenderer(Id),1))
  FreeEntity(TPart)
  Width# = MeshWidth(PlatformRenderer(Id))
  Depth# = MeshDepth(PlatformRenderer(Id))
  ;ColorSurfaceWithBrush(GetSurface(PlatformRenderer(Id),1),075,075,075)
  HideEntity(PlatformRenderer(Id))

  PlatformXZRadius(Id) = Diag(3.0)/2

  PlatformPickable(Id) = CopyEntity(PlatformRenderer(Id))
  EntityColor(PlatformPickable(Id),255,255,255)
  EntityAlpha(PlatformPickable(Id),0.5)

  .LineChoosePlatformPosition
  PositionEntity(PlatformRoot(Id),Rnd(0+Width/2,128-Width/2),3.2+Rnd(0.5,10),Rnd(0+Depth/2,128-10-3-Depth/2),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= PlatformXZRadius(Id)+BuildingXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
  Next
  ;is far enough from another Stair ?
  For OId% = 1 To StairsCount Step 1
   If( Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(StairRoot(OId),True),EntityZ(StairRoot(OId),True)) &lt;= PlatformXZRadius(Id)+StairXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
  Next
  ;is far enough from another rock ?
  For OId% = 1 To RocksCount Step 1
   If( EntityY(PlatformRoot(Id)) &lt; 3.2+0.5 And Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(RockRoot(OId),True),EntityZ(RockRoot(OId),True)) &lt;= PlatformXZRadius(Id)+RockXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
  Next
  ;is far enough from another tree ?
  For OId% = 1 To TreesCount Step 1
   If( EntityY(PlatformRoot(Id)) &lt; 3.2+10.0 And Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(TreeRoot(OId),True),EntityZ(TreeRoot(OId),True)) &lt;= PlatformXZRadius(Id)+TreeXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
  Next
  ;is far enough from another crate ?
  For OId% = 1 To CratesCount Step 1
   If( EntityY(PlatformRoot(Id)) &lt; 3.2+0.5 And Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(CrateRoot(OId),True),EntityZ(CrateRoot(OId),True)) &lt;= PlatformXZRadius(Id)+CrateXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
  Next
  ;is far enough from another Barrel ?
  For OId% = 1 To BarrelsCount Step 1
   If( EntityY(PlatformRoot(Id)) &lt; 3.2+1.0 And Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(BarrelRoot(OId),True),EntityZ(BarrelRoot(OId),True)) &lt;= PlatformXZRadius(Id)+BarrelXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
  Next
  ;is far enough from another Platform ?
  For OId% = 1 To PlatformsCount Step 1
   If( OId &lt;&gt; Id )
    If( EntityY(PlatformRoot(Id)) =&gt; EntityY(PlatformRoot(OId)) And EntityY(PlatformRoot(Id)) &lt;= EntityY(PlatformRoot(OId))+0.1 And Distance2D(EntityX(PlatformRoot(Id),True),EntityZ(PlatformRoot(Id),True),EntityX(PlatformRoot(OId),True),EntityZ(PlatformRoot(OId),True)) &lt;= PlatformXZRadius(Id)+PlatformXZRadius(OId)+1 )
    Goto LineChoosePlatformPosition
   EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(PlatformRenderer(Id),PlatformRoot(Id))
  PositionRotateEntityLikeOtherEntity(PlatformPickable(Id),PlatformRoot(Id))
 
  NameEntity(PlatformPickable(Id),"PLA"+Str(Id))

 Next

End Function

Function BuildHumanoids()

 For i% = 1 To 10 Step 1

  HumanoidsCount = HumanoidsCount + 1
  Id% = HumanoidsCount

  HumanoidRoot(Id) = CreatePivot()

  HumanoidMiddle(Id) = CreatePivot()
  PositionRotateEntityLikeOtherEntity(HumanoidMiddle(Id),HumanoidRoot(Id))
  MoveEntity(HumanoidMiddle(Id),0,0.875,0)
  SetEntityAsChildOfOtherEntity(HumanoidMiddle(Id),HumanoidRoot(Id))
  
  HumanoidEyes(Id) = CreatePivot()

  HumanoidRenderer(Id) = CreateCube()
  ScaleMesh(HumanoidRenderer(Id),0.5/2,1.75/2,0.25/2)
  PositionMesh(HumanoidRenderer(Id),0,1.75/2,0)
  ColorSurfaceWithBrush(GetSurface(HumanoidRenderer(Id),1),Rand(025,255),Rand(025,255),Rand(025,255))
  HideEntity(HumanoidRenderer(Id))

  HumanoidXZRadius(Id) = 0.25

  HumanoidPickable(Id) = CreateCylinder(16)
  ScaleMesh(HumanoidPickable(Id),0.5/2,1.0/2,0.5/2)
  PositionMesh(HumanoidPickable(Id),0,1.0/2,0)
  EntityColor(HumanoidPickable(Id),255,255,255)
  EntityAlpha(HumanoidPickable(Id),0.5)

  .LineChooseHumanoidPosition
  PositionEntity(HumanoidRoot(Id),Rnd(0+0.25,128-0.25),3.2+0.1,Rnd(0+0.25,128-10-3-0.25),True)
  ;is far enough from another building ?
  For OId% = 1 To BuildingsCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(BuildingRoot(OId),True),EntityZ(BuildingRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+BuildingXZRadius(OId)+1 )
    Goto LineChooseHumanoidPosition
   EndIf
  Next
  ;is far enough from another Stair ?
  For OId% = 1 To StairsCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(StairRoot(OId),True),EntityZ(StairRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+StairXZRadius(OId)+1 )
    Goto LineChooseHumanoidPosition
   EndIf
  Next
  ;is far enough from another rock ?
  For OId% = 1 To RocksCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(RockRoot(OId),True),EntityZ(RockRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+RockXZRadius(OId)+1 )
    Goto LineChooseHumanoidPosition
   EndIf
  Next
  ;is far enough from another tree ?
  For OId% = 1 To TreesCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(TreeRoot(OId),True),EntityZ(TreeRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+TreeXZRadius(OId)+1 )
    Goto LineChooseHumanoidPosition
   EndIf
  Next
  ;is far enough from another crate ?
  For OId% = 1 To CratesCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(CrateRoot(OId),True),EntityZ(CrateRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+CrateXZRadius(OId)+1 )
    Goto LineChooseHumanoidPosition
   EndIf
  Next
  ;is far enough from another barrel ?
  For OId% = 1 To BarrelsCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(BarrelRoot(OId),True),EntityZ(BarrelRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+BarrelXZRadius(OId)+1 )
    Goto LineChooseHumanoidPosition
   EndIf
  Next
  ;is far enough from another platform ?
  For OId% = 1 To PlatformsCount Step 1
   If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(PlatformRoot(OId),True),EntityZ(PlatformRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+PlatformXZRadius(OId)+1 )
    If( EntityY(PlatformRoot(OId),True) &lt; 3.2+1.75+1 )
     Goto LineChooseHumanoidPosition
    EndIf
   EndIf
  Next
  ;is far enough from another humanoid ?
  For OId% = 1 To HumanoidsCount Step 1
   If( OId &lt;&gt; Id )
    If( Distance2D(EntityX(HumanoidRoot(Id),True),EntityZ(HumanoidRoot(Id),True),EntityX(HumanoidRoot(OId),True),EntityZ(HumanoidRoot(OId),True)) &lt;= HumanoidXZRadius(Id)+HumanoidXZRadius(OId)+1 )
     Goto LineChooseHumanoidPosition
    EndIf
   EndIf
  Next
  PositionRotateEntityLikeOtherEntity(HumanoidRenderer(Id),HumanoidRoot(Id))
  SetEntityAsChildOfOtherEntity(HumanoidRenderer(Id),HumanoidRoot(Id))
  PositionRotateEntityLikeOtherEntity(HumanoidPickable(Id),HumanoidRoot(Id)) 
  SetEntityAsChildOfOtherEntity(HumanoidPickable(Id),HumanoidRoot(Id))

  HumanoidTarget(Id) = CreatePivot()
  PositionEntity(HumanoidTarget(Id),Rnd(0+0.25,128.0-0.25),3.2,Rnd(0+0.25,128.0-0.25),True)

  ;HumanoidPostureMode(Id) = Rand(1,2)
  HumanoidPostureMode(Id) = CStanding
  ScaleEntity(HumanoidPickable(Id),1,1.75,1)
  PositionRotateEntityLikeOtherEntity(HumanoidEyes(Id),HumanoidRoot(Id))
  MoveEntity(HumanoidEyes(Id),0,1.75-0.1,0)
  HumanoidMoveForce(Id) = Rnd(0.05,0.5)
  HumanoidJumpForce(Id) = 0
  HumanoidPositionState(Id) = COnAir
  HumanoidActionState(Id) = CIsFalling
  HumanoidGVX(Id) = 0
  HumanoidGVY(Id) = 0
  HumanoidGVZ(Id) = 0

  NameEntity(HumanoidPickable(Id),"HUM"+Str(Id))

 Next

End Function

Function GetMouseInput()

 MPX = MouseX()
 MPY = MouseY()

 MXDiff = MouseXSpeed()
 MYDiff = MouseYSpeed()

 MWheel = 0
 MZCur = MouseZ()
 If(MZCur &gt; MZOld)
  MWheel = + 1
  MZOld = MZCur
 ElseIf(MZCur &lt; MZOld)
  MWheel = - 1
  MZOld = MZCur
 EndIf

End Function

Function GetKeyboardInput()

 KeySpaceState = CIdle
 If( KeyDown(57) = 1 )
  KeySpaceDownCount = KeySpaceDownCount + 1
  If( KeySpaceDownCount = 1 )
   KeySpaceState = CPressed
   KeySpacePrevState = CPressed
  Else If( KeySpaceDownCount &gt; 1 )
   KeySpaceState = CHeld
   KeySpacePrevState = CHeld
  EndIf
 Else If( KeyDown(57) = 0 )
  KeySpaceDownCount = 0
  If( KeySpacePrevState = CPressed Or KeySpacePrevState = CHeld ) 
   KeySpaceState = CReleased
   KeySpacePrevState = CReleased
  EndIf
 EndIf

End Function
</textarea><br><br>~GF <br><br></td></tr></table><br>
<a name="1306156"></a>

<a name="1306158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lol<br>Moved my replies here: <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=104840#1306157" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=104840#1306157</a><br><i>Don't want to highjack/ride a thread more than I should. ;-) </i> <br><br></td></tr></table><br>
<a name="1306160"></a>

<a name="1306161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait a minute..Huh? GF? what did I miss? besides RemiD doesn't want to play along and posting incomplete code? ;-)<br>Btw: the one you posted also nogo(yet).<br><br>@RemiD<br>Afaics, your code doesn't contain jumping or moving onto objects. <br>Just detection of objects, so not particularly useful for moving up a ramp I'd say. <br><br></td></tr></table><br>
<a name="1306165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> HAHAHAHAHA! NICE one, Nasher! =D<br><br>~GF <br><br></td></tr></table><br>
<a name="1306169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD <br><br>Thanks for that, it did work but I don't see any ramps in the scene to test it out.<br><br>@GF<br>Yes, as RickNasher said it doesnt work but thank you for adding more <br><br></td></tr></table><br>
<a name="1306170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's the working version if you guys wanna fix the camera, the jump, &amp; the player.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D ( 640, 480, 32, 2 ) 

HidePointer ( ) 

SeedRnd ( MilliSecs ( ) ) 

Global Arial14Font = LoadFont ( "Arial", 14, False, False, False ) 

Global MPX%
Global MPY%
Global MXDiff#
Global MYDiff#

Global MZOld% = 0
Global MZCur% = 0
Global MWheel% = 0

Const CIdle% = 1 ;Up
Const CPressed% = 2 ;UpToDown
Const CHeld% = 3 ;Down
Const CReleased% = 4 ;DownToUp

Global KeySpaceState%
Global KeySpacePrevState%
Global KeySpaceDownCount

Origin = CreateCube ( ) 
ScaleMesh ( Origin, 0.01/2, 0.01/2, 0.01/2 ) 
EntityColor ( Origin, 255, 000, 255 ) 

Global cam = CreateCamera ( ) 
CameraRange ( cam, 0.1, 100 ) 
CameraClsColor ( cam, 000, 000, 000 ) 

;terrain

Global TerrainROAM

BuildTerrain ( ) 

	;buildings

	Global BuildingsCount%
	
		Dim BuildingRoot ( 11 ) 
		
			Dim BuildingRenderer ( 11 ) 
			
			Dim BuildingXZRadius# ( 11 ) 
		
		Dim BuildingPickable ( 11 ) 
	
	BuildBuildings ( ) 

	;stairs
	Global StairsCount%
	
		Dim StairRoot ( 100 ) 
		
			Dim StairRenderer ( 100 ) 
			
			Dim StairXZRadius# ( 100 ) 
		
		Dim StairPickable ( 100 ) 
	
	BuildStairs ( ) 

	;slopes
	Global SlopesCount%
	
		Dim SlopeRoot ( 100 ) 
		
			Dim SlopeRenderer ( 100 ) 
			
			Dim SlopeXZRadius# ( 100 ) 
		
		Dim SlopePickable ( 100 ) 
	
	BuildSlopes ( ) 
	
	;rocks
	Global RocksCount%
	
		Dim RockRoot ( 10 ) 
		
			Dim RockRenderer ( 10 ) 
			
			Dim RockXZRadius# ( 10 ) 
		
		Dim RockPickable ( 10 ) 
	
	BuildRocks ( ) 
	
	;trees
	Global TreesCount%
	
		Dim TreeRoot ( 10 ) 
		
			Dim TreeRenderer ( 10 ) 
			
			Dim TreeXZRadius# ( 10 ) 
		
		Dim TreePickable ( 10 ) 
	
	BuildTrees ( ) 
	
	;crates
	Global CratesCount%
	
		Dim CrateRoot ( 10 ) 
		
			Dim CrateRenderer ( 10 ) 
			
			Dim CrateXZRadius# ( 10 ) 
		
		Dim CratePickable ( 10 ) 
	
	BuildCrates ( ) 
	
	;barrels
	Global BarrelsCount%
	
		Dim BarrelRoot ( 10 ) 
		
			Dim BarrelRenderer ( 10 ) 
			
			Dim BarrelXZRadius# ( 10 ) 
		
		Dim BarrelPickable ( 10 ) 
	
	BuildBarrels ( ) 

	;platforms
	Global PlatformsCount%
	
		Dim PlatformRoot ( 100 ) 
		
			Dim PlatformRenderer ( 100 ) 
			
				Dim PlatformXZRadius# ( 100 ) 
			
			Dim PlatformPickable ( 100 ) 
		
		Dim PlatformState% ( 100 ) 
	
	BuildPlatforms ( ) 

	Global HumanoidsCount%
	
		Dim HumanoidRoot ( 10 ) 
		
			Dim HumanoidRootYaw# ( 10 ) 
			
				Dim HumanoidMiddle ( 10 ) 
				
					Dim HumanoidEyes ( 10 ) 
					
						Dim HumanoidEyesPitch# ( 10 ) 
						
							Dim HumanoidRenderer ( 10 ) 
							
								Dim HumanoidXZRadius# ( 10 ) 
								
									Dim HumanoidPickable ( 10 ) 
									
										Dim HumanoidPostureMode% ( 10 ) ;CCrouching CStanding
										
										Dim HumanoidMoveForce# ( 10 ) 
									
									Dim HumanoidJumpForce# ( 10 ) 
								
								Dim HumanoidPositionState% ( 10 ) ;COnAir or COnGround
							
							Dim HumanoidActionState% ( 10 ) ;
						
						Dim HumanoidAnimationState% ( 10 ) ;
					
					Dim HumanoidGVX# ( 10 ) 
				
				Dim HumanoidGVY# ( 10 ) 
			
			Dim HumanoidGVZ# ( 10 ) 
		
		Dim HumanoidTarget ( 10 ) 
	
	BuildHumanoids ( ) 

Const COnAir% = 1

	Const COnSlope% = 2
	
		Const COnLedge% = 3
	
	Const COnLadder% = 4

Const COnGround% = 5

	Const CCrouching% = 1

	Const CStanding% = 2

Const CIsCrouchingIdle% = 1

	Const CIsCrouchingForward% = 2
	
		Const CIsCrouchingBackward% = 3
		
			Const CIsCrouchingLeft% = 4
		
				Const CIsCrouchingRight% = 5
				
				Const CIsStandingIdle% = 6
			
			Const CIsStandingForward% = 7
		
		Const CIsStandingBackward% = 8

	Const CIsStandingLeft% = 9

Const CIsStandingRight% = 10

	Const CIsJumping% = 11
	
		Const CIsFalling% = 12
	
	Const CIsLanding% = 13

Const CIsSliding% = 14

	Global CapsuleRoot = CreatePivot ( ) 

	Global LPsCount%

Dim LPY# ( 6 ) 

	Global PsCount%
	
		Dim PStartX# ( 6 ) 
		
			Dim PStartY# ( 6 ) 
			
				Dim PStartZ# ( 6 ) 
				
					Dim PPickable% ( 6 ) 
					
					Dim PPointX# ( 6 ) 
				
				Dim PPointY# ( 6 ) 
			
			Dim PPointZ# ( 6 ) 
		
		Dim PNormalX# ( 6 ) 
	
	Dim PNormalY# ( 6 ) 

Dim PNormalZ# ( 6 ) 
	
	Global Point = CreateCube ( ) 
	
	ScaleMesh ( Point, 0.03/2, 0.03/2, 0.03/2 ) 
	
EntityColor ( Point, 255, 000, 255 ) 

	SunLight = CreateLight ( 1 ) 
	
		LightColor ( SunLight, 200, 200, 200 ) 
		
			PositionEntity ( SunLight, - 1000, 1000, - 1000, True ) 
		
				RotateEntity ( SunLight, 45, - 45, 0, True ) 
			
					AmbientLight ( 100, 100, 100 ) 
				
						PositionEntity ( cam, 64, 32, - 16, True ) 
					
						RotateEntity ( cam, 45, 0, 0, True ) 
			
					Global PlayerId%
			
				PlayerId = Rand ( 1, 10 ) 
			
			PositionRotateEntityLikeOtherEntity ( cam, HumanoidEyes ( PlayerId ) ) 
		
		MoveEntity ( cam, 0, 0, - 3 ) 
	
		HumanoidPostureMode ( PlayerId ) = CStanding
	
	HumanoidMoveForce ( PlayerId ) = 0.05

Global LoopTimer = CreateTimer ( 60 ) 

	Global MainLoopMsTime%
	
		Global SetSomeObstaclesAsPickableMsTime%
		
		Global LinepicksMsTime%
	
	Main ( ) 

End

Function UpdatePlayer ( PlayerId, mspd# = 0.1, tspd# = 0.3, dmspd# = 0.3, dtspd# = 0.5 ) 

	If Not KeyDown ( 29 ) Or KeyDown ( 157 ) 
	
		If Not ( KeyDown ( 42 ) Or KeyDown ( 54 ) ) 
		
			MoveEntity PlayerId, 0, 0,  ( KeyDown ( 17 ) - KeyDown ( 31 ) Or KeyDown ( 200 ) - KeyDown ( 208 ) ) * mspd#
			
			TurnEntity PlayerId, 0,  ( KeyDown ( 30 ) - KeyDown ( 32 ) Or KeyDown ( 203 ) - KeyDown ( 205 ) ) * tspd#, 0.0

		Else

			MoveEntity PlayerId, 0, 0,  ( KeyDown ( 17 ) - KeyDown ( 31 ) Or KeyDown ( 200 ) - KeyDown ( 208 ) ) * dmspd#
			
			TurnEntity PlayerId, 0,  ( KeyDown ( 30 ) - KeyDown ( 32 ) Or KeyDown ( 203 ) - KeyDown ( 205 ) ) * dtspd#, 0.0

		EndIf

	Else

		If Not ( KeyDown ( 42 ) Or KeyDown ( 54 ) ) 
		
			MoveEntity PlayerId,  ( KeyDown ( 32 ) - KeyDown ( 30 ) Or KeyDown ( 205 ) - KeyDown ( 203 ) ) * mspd#, 0,  ( KeyDown ( 17 ) - KeyDown ( 31 ) Or KeyDown ( 200 ) - KeyDown ( 208 ) ) * mspd#

		Else

			MoveEntity PlayerId,  ( KeyDown ( 32 ) - KeyDown ( 30 ) Or KeyDown ( 205 ) - KeyDown ( 203 ) ) * dmspd#, 0,  ( KeyDown ( 17 ) - KeyDown ( 31 ) Or KeyDown ( 200 ) - KeyDown ( 208 ) ) * dmspd#

		EndIf

	EndIf

End Function

Function Main ( ) 

	While Not KeyDown ( 1 ) 
	
		MainLoopMsStart% = MilliSecs ( ) 
		
			GetMouseInput ( ) 
			
				GetKeyboardInput ( ) 
				
					If ( KeyHit ( 2 ) ) Then w = 1 - w 
					
						Wireframe w
						
							PositionRotateEntityLikeOtherEntity ( cam, HumanoidEyes ( PlayerId ) ) 
							
								MoveEntity ( cam, 0, 0, -3 ) 
								
									SetBuffer ( BackBuffer ( ) ) 
									
										RenderWorld ( ) 
										
											SetFont ( Arial14Font ) 
											
												Color ( 255, 255, 255 ) 
												
												CText ( "PlayerMoveForce = " + HumanoidMoveForce ( PlayerId ), 0, 14 ) 
											
											CText ( "PlayerJumpForce = " + HumanoidJumpForce ( PlayerId ), 0, 28 ) 
										
										CText ( "PlayerGVX = " + HumanoidGVX ( PlayerId ), 0, 70 ) 
									
									CText ( "PlayerGVY = " + HumanoidGVY ( PlayerId ), 0, 84 ) 
								
								CText ( "PlayerGVZ = " + HumanoidGVZ ( PlayerId ), 0, 98 ) 
							
							CText ( "SetSomeObstaclesAsPickableMsTime = " + SetSomeObstaclesAsPickableMsTime, 400, 0 ) 
						
						CText ( "LinepicksMsTime = " + LinepicksMsTime, 400, 14 ) 
					
					WaitTimer ( LoopTimer ) 
				
				VWait ( ) 
			
			Flip ( ) 
		
		MainLoopMsTime% = MilliSecs ( ) - MainLoopMsStart
	
	Wend

End Function

Function CText ( TextStr$, PX%, PY% ) 

	Text ( PX, PY, TextStr, False, False ) 

End Function

Function PositionEntityLikeOtherEntity ( Entity, OEntity ) 

	PositionEntity ( Entity, EntityX ( OEntity, True ), EntityY ( OEntity, True ), EntityZ ( OEntity, True ), True ) 

End Function

Function RotateEntityLikeOtherEntity ( Entity, OEntity ) 

	RotateEntity ( Entity, EntityPitch ( OEntity, True ), EntityYaw ( OEntity, True ), EntityRoll ( OEntity, True ), True ) 

End Function

Function PositionRotateEntityLikeOtherEntity ( Entity, OEntity ) 

	PositionEntity ( Entity, EntityX ( OEntity, True ), EntityY ( OEntity, True ), EntityZ ( OEntity, True ), True ) 
	
	RotateEntity ( Entity, EntityPitch ( OEntity, True ), EntityYaw ( OEntity, True ), EntityRoll ( OEntity, True ), True ) 

End Function

Function SetEntityAsChildOfOtherEntity ( Entity, OEntity ) 

	EntityParent ( Entity, OEntity, True ) 

End Function

Function SetEntityAsFree ( Entity ) 

	EntityParent ( Entity, 0 ) 

End Function

Function Diag# ( SideLength# ) 

	Diag# = Sqr (  ( SideLength * SideLength ) + ( SideLength * SideLength ) ) 
	
	Return Diag

End Function

Function Distance2D# ( PAX#, PAZ#, PBX#, PBZ# ) 

	VX# = PBX - PAX
	
		VZ# = PBZ - PAZ
		
		Distance2D# = Sqr (  ( VX*VX ) + ( VZ*VZ ) ) 
	
	Return Distance2D

End Function

Function Distance3D# ( PAX#, PAY#, PAZ#, PBX#, PBY#, PBZ# ) 

	VX# = PBX - PAX
	
		VY# = PBY - PAY
		
			VZ# = PBZ - PAZ
		
		Distance3D# = Sqr (  ( VX*VX ) + ( VY*VY ) + ( VZ*VZ ) ) 
	
	Return Distance3D

End Function

Function AddSurfaceToOtherSurface ( Mesh, Surface, OSurface ) 

	For TId% = 0 To CountTriangles ( Surface ) - 1
	
		;V0
		
			V0Id% = TriangleVertex ( Surface, TId, 0 ) 
			
				V0LX# = VertexX ( Surface, V0Id ) 
			
			V0LY# = VertexY ( Surface, V0Id ) 
			
		V0LZ# = VertexZ ( Surface, V0Id ) 
			
		TFormPoint ( V0LX, V0LY, V0LZ, Mesh, 0 ) 
			
			V0GX# = TFormedX ( ) 
			
				V0GY# = TFormedY ( ) 
				
					V0GZ# = TFormedZ ( ) 
				
				V0NX# = VertexNX ( Surface, V0Id ) 
			
			V0NY# = VertexNY ( Surface, V0Id ) 
			
		V0NZ# = VertexNZ ( Surface, V0Id ) 
			
		;V1
			
			V1Id% = TriangleVertex ( Surface, TId, 1 ) 
			
			V1LX# = VertexX ( Surface, V1Id ) 
			
			V1LY# = VertexY ( Surface, V1Id ) 
			
			V1LZ# = VertexZ ( Surface, V1Id ) 
			
			TFormPoint ( V1LX, V1LY, V1LZ, Mesh, 0 ) 
			
			V1GX# = TFormedX ( ) 
			
			V1GY# = TFormedY ( ) 
			
			V1GZ# = TFormedZ ( ) 
			
			V1NX# = VertexNX ( Surface, V1Id ) 
			
			V1NY# = VertexNY ( Surface, V1Id ) 
			
			V1NZ# = VertexNZ ( Surface, V1Id ) 
			
			;V2
			
			V2Id% = TriangleVertex ( Surface, TId, 2 ) 
			
			V2LX# = VertexX ( Surface, V2Id ) 
			
			V2LY# = VertexY ( Surface, V2Id ) 
			
			V2LZ# = VertexZ ( Surface, V2Id ) 
			
			TFormPoint ( V2LX, V2LY, V2LZ, Mesh, 0 ) 
			
			V2GX# = TFormedX ( ) 
			
			V2GY# = TFormedY ( ) 
			
			V2GZ# = TFormedZ ( ) 
			
			V2NX# = VertexNX ( Surface, V2Id ) 
			
			V2NY# = VertexNY ( Surface, V2Id ) 
			
			V2NZ# = VertexNZ ( Surface, V2Id ) 
			
			;Triangle
			
			OldVerticesCount = CountVertices ( OSurface ) 
			
			NV0Id% = OldVerticesCount - 1 + 1
			
			NV1Id% = OldVerticesCount - 1 + 2 
			
			NV2Id% = OldVerticesCount - 1 + 3
			
			AddVertex ( OSurface, V0GX, V0GY, V0GZ ) 
			
			VertexNormal ( OSurface, NV0Id, V0NX, V0NY, V0NZ ) 
			
			AddVertex ( OSurface, V1GX, V1GY, V1GZ ) 
			
			VertexNormal ( OSurface, NV1Id, V1NX, V1NY, V1NZ ) 
			
			AddVertex ( OSurface, V2GX, V2GY, V2GZ ) 
			
			VertexNormal ( OSurface, NV2Id, V2NX, V2NY, V2NZ ) 
		
		AddTriangle ( OSurface, NV0Id, NV1Id, NV2Id ) 
	
	Next

End Function

Function ColorSurfaceWithBrush ( Surface, R%, G%, B%, A# = 1.0, Fx% = 0 ) 
 TBrush = CreateBrush ( ) 
 BrushColor ( TBrush, R, G, B ) 
 BrushAlpha ( TBrush, A ) 
 BrushFX ( TBrush, Fx ) 
 PaintSurface ( Surface, TBrush ) 
 FreeBrush ( TBrush ) 
End Function

Function BuildTerrain ( ) 

 TerrainROAM = CreateTerrain ( 128 ) 
 For HX% = 0 To 128 - 1 Step 1
For HZ% = 0 To 128 - 1 Step 1
 HeightRGB% = Rand ( 030, 032 ) ;030 to 032 for 20cm variation
 HeightY# = 1.0/255.0*Float ( HeightRGB ) 
 ModifyTerrain ( TerrainROAM, HX, HZ, HeightY, False ) 
Next
 Next
 ScaleEntity ( TerrainROAM, 1, 25.5, 1 ) 
 TerrainDetail ( TerrainROAM, 4000, True ) 
 TerrainShading ( TerrainROAM, True ) 
 EntityAlpha ( TerrainROAM, 0.5 ) 

 TerrainDiffuseTexture = CreateTexture ( 128, 128 ) 
 SetBuffer ( TextureBuffer ( TerrainDiffuseTexture ) ) 
For PX% = 0 To 128 - 1 Step 1
 For PY% = 0 To 128 - 1 Step 1
R% = 000 
G% = Rand ( 090, 110 ) 
B% = 000
Color ( R, G, B ) 
Plot ( PX, PY ) 
 Next
Next
 ScaleTexture ( TerrainDiffuseTexture, 128, 128 ) 
 TextureBlend ( TerrainDiffuseTexture, 2 ) 
 ;EntityTexture ( TerrainROAM, TerrainDiffuseTexture, 0, 0 ) 

 NameEntity ( TerrainROAM, "TER" + Str ( 1 ) ) 

End Function

Function BuildBuildings ( ) 
 
 For i% = 1 To 10 Step 1

Levels% = Rand ( 1, 15 ) 

BuildingsCount = BuildingsCount + 1
Id% = BuildingsCount

BuildingRoot ( Id ) = CreatePivot ( ) 

BuildingRenderer ( Id ) = CreateMesh ( ) 
CreateSurface ( BuildingRenderer ( Id ) ) 
For L% = 1 To Levels Step 1
 TWidth# = Rand ( 3, 10 ) 
 TDepth# = Rand ( 3, 10 ) 
 For GX# = 0 To TWidth - 1 Step 1
For GZ# = 0 To TDepth - 1 Step 1
 RandomChoice% = Rand ( 1, 3 ) 
 If ( RandomChoice = 1 Or RandomChoice = 2 ) 
;add a part
TPart = CreateCube ( ) 
ScaleMesh ( TPart, 1.0/2, 1.0/2, 1.0/2 ) 
PositionMesh ( TPart, 1.0/2, 1.0/2, 1.0/2 ) 
PositionMesh ( TPart, GX, L - 1, GZ ) 
AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( BuildingRenderer ( Id ), 1 ) ) 
FreeEntity ( TPart ) 
 Else If ( RandomChoice = 3 ) 
;add nothing
 EndIf
Next
 Next
Next
MWidth# = MeshWidth ( BuildingRenderer ( Id ) ) 
MDepth# = MeshDepth ( BuildingRenderer ( Id ) ) 
PositionMesh ( BuildingRenderer ( Id ), - MWidth/2, 0, - MDepth/2 ) 
;ColorSurfaceWithBrush ( GetSurface ( BuildingRenderer ( Id ), 1 ), 075, 075, 075 ) 
HideEntity ( BuildingRenderer ( Id ) ) 

BuildingXZRadius ( Id ) = Diag ( 10 ) /2

BuildingPickable ( Id ) = CopyEntity ( BuildingRenderer ( Id ) ) 
EntityColor ( BuildingPickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( BuildingPickable ( Id ), 0.5 ) 

.LineChooseBuildingPosition
PositionEntity ( BuildingRoot ( Id ), Rnd ( 0 + MWidth/2, 128 - MWidth/2 ), 3.1, Rnd ( 0 + MDepth/2, 128 - 10 - 3 - MDepth/2 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( Distance2D ( EntityX ( BuildingRoot ( Id ), True ), EntityZ ( BuildingRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= BuildingXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
 Goto LineChooseBuildingPosition
EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( BuildingRenderer ( Id ), BuildingRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( BuildingPickable ( Id ), BuildingRoot ( Id ) ) 
 
NameEntity ( BuildingPickable ( Id ), "BUI" + Str ( Id ) ) 

 Next

End Function

Function BuildStairs ( ) 

 For THeight# = 0.125 To 0.375 Step 0.125
For TDepth# = 0.25 To 0.5 Step 0.125

 StairsCount = StairsCount + 1
 Id% = StairsCount

 StairRoot ( Id ) = CreatePivot ( ) 

 StairRenderer ( Id ) = CreateMesh ( ) 
 CreateSurface ( StairRenderer ( Id ) ) 
 TWidth# = 3.0
 ;THeight# = 0.25 ;0.25
 ;TDepth# = 0.25
 For ii% = 1 To 12 Step 1
TX# = 0
TY# = 0 + (  ( ii - 1 ) *THeight ) 
TZ# = 0 + (  ( ii - 1 ) *TDepth ) 
TPart = CreateCube ( ) 
ScaleMesh ( TPart, TWidth/2, THeight/2, TDepth/2 ) 
PositionMesh ( TPart, 0, THeight/2, TDepth/2 ) 
PositionMesh ( TPart, 0, TY, TZ ) 
AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( StairRenderer ( Id ), 1 ) ) 
FreeEntity ( TPart ) 
 Next
 ;PositionMesh ( StairRenderer ( Id ), 0, 0, MeshDepth ( StairRenderer ( Id ) ) /2 ) 
 MWidth# = MeshWidth ( StairRenderer ( Id ) ) 
 MDepth# = MeshDepth ( StairRenderer ( Id ) ) 
 ;ColorSurfaceWithBrush ( GetSurface ( StairRenderer ( Id ), 1 ), 075, 075, 075 ) 
 HideEntity ( StairRenderer ( Id ) ) 
 
 StairXZRadius ( Id ) = MDepth

 StairPickable ( Id ) = CopyEntity ( StairRenderer ( Id ) ) 
 EntityColor ( StairPickable ( Id ), 255, 255, 255 ) 
 EntityAlpha ( StairPickable ( Id ), 0.5 ) 

 .LineChooseStairPosition
 PositionEntity ( StairRoot ( Id ), 0 + 1.5 + ( Id - 1 ) *3.0, 3.1, 128.0 - 10, True ) 
 PositionRotateEntityLikeOtherEntity ( StairRenderer ( Id ), StairRoot ( Id ) ) 
 PositionRotateEntityLikeOtherEntity ( StairPickable ( Id ), StairRoot ( Id ) ) 
 
 NameEntity ( StairPickable ( Id ), "STA" + Str ( Id ) ) 

Next

 Next

End Function

Function BuildSlopes ( ) 

 For Pitch# = 0 To - 90.0 Step - 10.0

SlopesCount = SlopesCount + 1
Id% = SlopesCount

SlopeRoot ( Id ) = CreatePivot ( ) 

SlopeRenderer ( Id ) = CreateMesh ( ) 
CreateSurface ( SlopeRenderer ( Id ) ) 
TWidth# = 3.0
TDepth# = 10.0

TPart = CreateMesh ( ) 
TSurface = CreateSurface ( TPart ) 
AddVertex ( TSurface, - 1.0, 0.0, 1.0 ) 
AddVertex ( TSurface, 1.0, 0.0, 1.0 ) 
AddVertex ( TSurface, - 1.0, 0.0, - 1.0 ) 
AddVertex ( TSurface, 1.0, 0.0, - 1.0 ) 
AddTriangle ( TSurface, 0, 1, 2 ) 
AddTriangle ( TSurface, 2, 1, 3 ) 
ScaleMesh ( TPart, 3.0/2, 1.0, 10.0/2 ) 
PositionMesh ( TPart, 0, 0, 10.0/2 ) 
RotateMesh ( TPart, Pitch, 0, 0 ) 
UpdateNormals ( TPart ) 
;AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( SlopeRenderer ( Id ), 1 ) ) 
AddMesh ( TPart, SlopeRenderer ( Id ) ) 
FreeEntity ( TPart ) 

;PositionMesh ( SlopeRenderer ( Id ), 0, 0, MeshDepth ( SlopeRenderer ( Id ) ) /2 ) 
MWidth# = MeshWidth ( SlopeRenderer ( Id ) ) 
MDepth# = MeshDepth ( SlopeRenderer ( Id ) ) 
;ColorSurfaceWithBrush ( GetSurface ( SlopeRenderer ( Id ), 1 ), 075, 075, 075 ) 
HideEntity ( SlopeRenderer ( Id ) ) 
 
SlopeXZRadius ( Id ) = 13

SlopePickable ( Id ) = CopyEntity ( SlopeRenderer ( Id ) ) 
EntityColor ( SlopePickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( SlopePickable ( Id ), 0.5 ) 

PositionEntity ( SlopeRoot ( Id ), 50 + 1.5 + ( Id - 1 ) *3.0, 3.1, 128.0 - 10, True ) 
PositionRotateEntityLikeOtherEntity ( SlopeRenderer ( Id ), SlopeRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( SlopePickable ( Id ), SlopeRoot ( Id ) ) 
 
NameEntity ( SlopePickable ( Id ), "SLO" + Str ( Id ) ) 

 Next

End Function

Function BuildRocks ( ) 
 
 For i% = 1 To 10 Step 1

RocksCount = RocksCount + 1
Id% = RocksCount

RockRoot ( Id ) = CreatePivot ( ) 

RockRenderer ( Id ) = CreateSphere ( 8 ) 
Width# = Rnd ( 0.5, 1.0 ) 
Height# = Rnd ( 0.25, 0.5 ) 
Depth# = Rnd ( 0.5, 1.0 ) 
ScaleMesh ( RockRenderer ( Id ), Width/2, Height/2, Depth/2 ) 
;ColorSurfaceWithBrush ( GetSurface ( RockRenderer ( Id ), 1 ), 075, 075, 075 ) 
HideEntity ( RockRenderer ( Id ) ) 

RockXZRadius ( Id ) = 0.5

RockPickable ( Id ) = CopyEntity ( RockRenderer ( Id ) ) 
EntityColor ( RockPickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( RockPickable ( Id ), 0.5 ) 

.LineChooseRockPosition
PositionEntity ( RockRoot ( Id ), Rnd ( 0 + 0.5, 128 - 0.5 ), 3.1, Rnd ( 0 + 0.5, 128 - 10 - 3 - 0.5 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( Distance2D ( EntityX ( RockRoot ( Id ), True ), EntityZ ( RockRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= RockXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
Goto LineChooseRockPosition
 EndIf
Next
;is far enough from another stair ?
For OId% = 1 To StairsCount Step 1
 If ( Distance2D ( EntityX ( RockRoot ( Id ), True ), EntityZ ( RockRoot ( Id ), True ), EntityX ( StairRoot ( OId ), True ), EntityZ ( StairRoot ( OId ), True ) ) &lt;= RockXZRadius ( Id ) + StairXZRadius ( OId ) + 1 ) 
Goto LineChooseRockPosition
 EndIf
Next
;is far enough from another rock ?
For OId% = 1 To RocksCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( Distance2D ( EntityX ( RockRoot ( Id ), True ), EntityZ ( RockRoot ( Id ), True ), EntityX ( RockRoot ( OId ), True ), EntityZ ( RockRoot ( OId ), True ) ) &lt;= RockXZRadius ( Id ) + RockXZRadius ( OId ) + 1 ) 
 Goto LineChooseRockPosition
EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( RockRenderer ( Id ), RockRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( RockPickable ( Id ), RockRoot ( Id ) ) 
 
NameEntity ( RockPickable ( Id ), "ROC" + Str ( Id ) ) 

 Next

End Function

Function BuildTrees ( ) 

 For i% = 1 To 10 Step 1

TreesCount = TreesCount + 1
Id% = TreesCount

TreeRoot ( Id ) = CreatePivot ( ) 

TreeRenderer ( Id ) = CreateMesh ( ) 
CreateSurface ( TreeRenderer ( Id ) ) 
TPart = CreateCone ( 4 ) 
ScaleMesh ( TPart, 0.5/2,  ( 10.0 - 1.5 ) /2, 0.5/2 ) 
PositionMesh ( TPart, 0,  ( 10.0 - 1.5 ) /2, 0 ) 
AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( TreeRenderer ( Id ), 1 ) ) 
FreeEntity ( TPart ) 
OldYaw# = 0
For Y# = 1.5 To 10 - 1.5 Step 0.25
 Scale# = ( 10.0 - 1.5 - Y ) 
 If ( Scale &gt; 5.0 ) 
Scale = 5.0
 EndIf
 .LineChooseBrancheYaw
 Yaw# = Rnd ( - 180.0, 180.0 ) 
 If ( Yaw &gt; OldYaw - 45 And Yaw &lt; OldYaw + 45 ) 
Goto LineChooseBrancheYaw
 EndIf
 OldYaw = Yaw
 TPart = CreateCone ( 4 ) 
 ScaleMesh ( TPart, Scale/20/2, Scale/2, Scale/20/2 ) 
 PositionMesh ( TPart, 0, Scale/2, 0 ) 
 RotateMesh ( TPart, - 45, Yaw, 0 ) 
 PositionMesh ( TPart, 0, Y, 0 ) 
 AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( TreeRenderer ( Id ), 1 ) ) 
 FreeEntity ( TPart ) 
Next
;ColorSurfaceWithBrush ( GetSurface ( TreeRenderer ( Id ), 1 ), 075, 050, 025 ) 
HideEntity ( TreeRenderer ( Id ) ) 

TreeXZRadius ( Id ) = 5.0

TreePickable ( Id ) = CopyEntity ( TreeRenderer ( Id ) ) 
EntityColor ( TreePickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( TreePickable ( Id ), 0.5 ) 

.LineChooseTreePosition
PositionEntity ( TreeRoot ( Id ), Rnd ( 0 + 5.0, 128 - 5.0 ), 3.0, Rnd ( 0 + 5.0, 128 - 10 - 3 - 5.0 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( Distance2D ( EntityX ( TreeRoot ( Id ), True ), EntityZ ( TreeRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= TreeXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
Goto LineChooseTreePosition
 EndIf
Next
;is far enough from another Stair ?
For OId% = 1 To StairsCount Step 1
 If ( Distance2D ( EntityX ( TreeRoot ( Id ), True ), EntityZ ( TreeRoot ( Id ), True ), EntityX ( StairRoot ( OId ), True ), EntityZ ( StairRoot ( OId ), True ) ) &lt;= TreeXZRadius ( Id ) + StairXZRadius ( OId ) + 1 ) 
Goto LineChooseTreePosition
 EndIf
Next
;is far enough from another rock ?
For OId% = 1 To RocksCount Step 1
 If ( Distance2D ( EntityX ( TreeRoot ( Id ), True ), EntityZ ( TreeRoot ( Id ), True ), EntityX ( RockRoot ( OId ), True ), EntityZ ( RockRoot ( OId ), True ) ) &lt;= TreeXZRadius ( Id ) + RockXZRadius ( OId ) + 1 ) 
Goto LineChooseTreePosition
 EndIf
Next
;is far enough from another tree ?
For OId% = 1 To TreesCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( Distance2D ( EntityX ( TreeRoot ( Id ), True ), EntityZ ( TreeRoot ( Id ), True ), EntityX ( TreeRoot ( OId ), True ), EntityZ ( TreeRoot ( OId ), True ) ) &lt;= TreeXZRadius ( Id ) + TreeXZRadius ( OId ) + 1 ) 
 Goto LineChooseTreePosition
EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( TreeRenderer ( Id ), TreeRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( TreePickable ( Id ), TreeRoot ( Id ) ) 
 
NameEntity ( TreePickable ( Id ), "TRE" + Str ( Id ) ) 

 Next

End Function

Function BuildCrates ( ) 

 For i% = 1 To 10 Step 1

CratesCount = CratesCount + 1
Id% = CratesCount

CrateRoot ( Id ) = CreatePivot ( ) 

CrateRenderer ( Id ) = CreateMesh ( ) 
CreateSurface ( CrateRenderer ( Id ) ) 
TPart = CreateCube ( ) 
ScaleMesh ( TPart, 0.5/2, 0.5/2, 0.5/2 ) 
PositionMesh ( TPart, 0, 0.5/2, 0 ) 
AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( CrateRenderer ( Id ), 1 ) ) 
FreeEntity ( TPart ) 
;ColorSurfaceWithBrush ( GetSurface ( CrateRenderer ( Id ), 1 ), 100, 075, 050 ) 
HideEntity ( CrateRenderer ( Id ) ) 

CrateXZRadius ( Id ) = Diag ( 0.5 ) /2

CratePickable ( Id ) = CopyEntity ( CrateRenderer ( Id ) ) 
EntityColor ( CratePickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( CratePickable ( Id ), 0.5 ) 

.LineChooseCratePosition
PositionEntity ( CrateRoot ( Id ), Rnd ( 0 + 0.25, 128 - 0.25 ), 3.2, Rnd ( 0 + 0.25, 128 - 10 - 3 - 0.25 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( Distance2D ( EntityX ( CrateRoot ( Id ), True ), EntityZ ( CrateRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= CrateXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
Goto LineChooseCratePosition
 EndIf
Next
;is far enough from another Stair ?
For OId% = 1 To StairsCount Step 1
 If ( Distance2D ( EntityX ( CrateRoot ( Id ), True ), EntityZ ( CrateRoot ( Id ), True ), EntityX ( StairRoot ( OId ), True ), EntityZ ( StairRoot ( OId ), True ) ) &lt;= CrateXZRadius ( Id ) + StairXZRadius ( OId ) + 1 ) 
Goto LineChooseCratePosition
 EndIf
Next
;is far enough from another rock ?
For OId% = 1 To RocksCount Step 1
 If ( Distance2D ( EntityX ( CrateRoot ( Id ), True ), EntityZ ( CrateRoot ( Id ), True ), EntityX ( RockRoot ( OId ), True ), EntityZ ( RockRoot ( OId ), True ) ) &lt;= CrateXZRadius ( Id ) + RockXZRadius ( OId ) + 1 ) 
Goto LineChooseCratePosition
 EndIf
Next
;is far enough from another tree ?
For OId% = 1 To TreesCount Step 1
 If ( Distance2D ( EntityX ( CrateRoot ( Id ), True ), EntityZ ( CrateRoot ( Id ), True ), EntityX ( TreeRoot ( OId ), True ), EntityZ ( TreeRoot ( OId ), True ) ) &lt;= CrateXZRadius ( Id ) + TreeXZRadius ( OId ) + 1 ) 
Goto LineChooseCratePosition
 EndIf
Next
;is far enough from another crate ?
For OId% = 1 To CratesCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( Distance2D ( EntityX ( CrateRoot ( Id ), True ), EntityZ ( CrateRoot ( Id ), True ), EntityX ( CrateRoot ( OId ), True ), EntityZ ( CrateRoot ( OId ), True ) ) &lt;= CrateXZRadius ( Id ) + CrateXZRadius ( OId ) + 1 ) 
 Goto LineChooseCratePosition
EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( CrateRenderer ( Id ), CrateRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( CratePickable ( Id ), CrateRoot ( Id ) ) 
 
NameEntity ( CratePickable ( Id ), "CRA" + Str ( Id ) ) 

 Next

End Function

Function BuildBarrels ( ) 

 For i% = 1 To 10 Step 1

BarrelsCount = BarrelsCount + 1
Id% = BarrelsCount

BarrelRoot ( Id ) = CreatePivot ( ) 

BarrelRenderer ( Id ) = CreateMesh ( ) 
CreateSurface ( BarrelRenderer ( Id ) ) 
TPart = CreateCylinder ( 8 ) 
ScaleMesh ( TPart, 0.5/2, 1.0/2, 0.5/2 ) 
PositionMesh ( TPart, 0, 1.0/2, 0 ) 
;AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( BarrelRenderer ( Id ), 1 ) ) 
AddMesh ( TPart, BarrelRenderer ( Id ) ) 
FreeEntity ( TPart ) 
;ColorSurfaceWithBrush ( GetSurface ( BarrelRenderer ( Id ), 1 ), 100, 075, 050 ) 
HideEntity ( BarrelRenderer ( Id ) ) 

BarrelXZRadius ( Id ) = 0.25

BarrelPickable ( Id ) = CopyEntity ( BarrelRenderer ( Id ) ) 
EntityColor ( BarrelPickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( BarrelPickable ( Id ), 0.5 ) 

.LineChooseBarrelPosition
PositionEntity ( BarrelRoot ( Id ), Rnd ( 0 + 0.25, 128 - 0.25 ), 3.2, Rnd ( 0 + 0.25, 128 - 10 - 3 - 0.25 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( Distance2D ( EntityX ( BarrelRoot ( Id ), True ), EntityZ ( BarrelRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= BarrelXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
Goto LineChooseBarrelPosition
 EndIf
Next
;is far enough from another Stair ?
For OId% = 1 To StairsCount Step 1
 If ( Distance2D ( EntityX ( BarrelRoot ( Id ), True ), EntityZ ( BarrelRoot ( Id ), True ), EntityX ( StairRoot ( OId ), True ), EntityZ ( StairRoot ( OId ), True ) ) &lt;= BarrelXZRadius ( Id ) + StairXZRadius ( OId ) + 1 ) 
Goto LineChooseBarrelPosition
 EndIf
Next
;is far enough from another rock ?
For OId% = 1 To RocksCount Step 1
 If ( Distance2D ( EntityX ( BarrelRoot ( Id ), True ), EntityZ ( BarrelRoot ( Id ), True ), EntityX ( RockRoot ( OId ), True ), EntityZ ( RockRoot ( OId ), True ) ) &lt;= BarrelXZRadius ( Id ) + RockXZRadius ( OId ) + 1 ) 
Goto LineChooseBarrelPosition
 EndIf
Next
;is far enough from another tree ?
For OId% = 1 To TreesCount Step 1
 If ( Distance2D ( EntityX ( BarrelRoot ( Id ), True ), EntityZ ( BarrelRoot ( Id ), True ), EntityX ( TreeRoot ( OId ), True ), EntityZ ( TreeRoot ( OId ), True ) ) &lt;= BarrelXZRadius ( Id ) + TreeXZRadius ( OId ) + 1 ) 
Goto LineChooseBarrelPosition
 EndIf
Next
;is far enough from another crate ?
For OId% = 1 To CratesCount Step 1
 If ( Distance2D ( EntityX ( BarrelRoot ( Id ), True ), EntityZ ( BarrelRoot ( Id ), True ), EntityX ( CrateRoot ( OId ), True ), EntityZ ( CrateRoot ( OId ), True ) ) &lt;= BarrelXZRadius ( Id ) + CrateXZRadius ( OId ) + 1 ) 
Goto LineChooseBarrelPosition
 EndIf
Next
;is far enough from another Barrel ?
For OId% = 1 To BarrelsCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( Distance2D ( EntityX ( BarrelRoot ( Id ), True ), EntityZ ( BarrelRoot ( Id ), True ), EntityX ( BarrelRoot ( OId ), True ), EntityZ ( BarrelRoot ( OId ), True ) ) &lt;= BarrelXZRadius ( Id ) + BarrelXZRadius ( OId ) + 1 ) 
 Goto LineChooseBarrelPosition
EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( BarrelRenderer ( Id ), BarrelRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( BarrelPickable ( Id ), BarrelRoot ( Id ) ) 
 
NameEntity ( BarrelPickable ( Id ), "BAR" + Str ( Id ) ) 

 Next

End Function

Function BuildPlatforms ( ) 

 For i% = 1 To 30 Step 1

PlatformsCount = PlatformsCount + 1
Id% = PlatformsCount

PlatformRoot ( Id ) = CreatePivot ( ) 

PlatformRenderer ( Id ) = CreateMesh ( ) 
CreateSurface ( PlatformRenderer ( Id ) ) 
TPart = CreateCube ( ) 
ScaleMesh ( TPart, 3.0/2, 0.1/2, 3.0/2 ) 
PositionMesh ( TPart, 0, 0.1/2, 0 ) 
AddSurfaceToOtherSurface ( TPart, GetSurface ( TPart, 1 ), GetSurface ( PlatformRenderer ( Id ), 1 ) ) 
FreeEntity ( TPart ) 
Width# = MeshWidth ( PlatformRenderer ( Id ) ) 
Depth# = MeshDepth ( PlatformRenderer ( Id ) ) 
;ColorSurfaceWithBrush ( GetSurface ( PlatformRenderer ( Id ), 1 ), 075, 075, 075 ) 
HideEntity ( PlatformRenderer ( Id ) ) 

PlatformXZRadius ( Id ) = Diag ( 3.0 ) /2

PlatformPickable ( Id ) = CopyEntity ( PlatformRenderer ( Id ) ) 
EntityColor ( PlatformPickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( PlatformPickable ( Id ), 0.5 ) 

.LineChoosePlatformPosition
PositionEntity ( PlatformRoot ( Id ), Rnd ( 0 + Width/2, 128 - Width/2 ), 3.2 + Rnd ( 0.5, 10 ), Rnd ( 0 + Depth/2, 128 - 10 - 3 - Depth/2 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
Next
;is far enough from another Stair ?
For OId% = 1 To StairsCount Step 1
 If ( Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( StairRoot ( OId ), True ), EntityZ ( StairRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + StairXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
Next
;is far enough from another rock ?
For OId% = 1 To RocksCount Step 1
 If ( EntityY ( PlatformRoot ( Id ) ) &lt; 3.2 + 0.5 And Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( RockRoot ( OId ), True ), EntityZ ( RockRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + RockXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
Next
;is far enough from another tree ?
For OId% = 1 To TreesCount Step 1
 If ( EntityY ( PlatformRoot ( Id ) ) &lt; 3.2 + 10.0 And Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( TreeRoot ( OId ), True ), EntityZ ( TreeRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + TreeXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
Next
;is far enough from another crate ?
For OId% = 1 To CratesCount Step 1
 If ( EntityY ( PlatformRoot ( Id ) ) &lt; 3.2 + 0.5 And Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( CrateRoot ( OId ), True ), EntityZ ( CrateRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + CrateXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
Next
;is far enough from another Barrel ?
For OId% = 1 To BarrelsCount Step 1
 If ( EntityY ( PlatformRoot ( Id ) ) &lt; 3.2 + 1.0 And Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( BarrelRoot ( OId ), True ), EntityZ ( BarrelRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + BarrelXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
Next
;is far enough from another Platform ?
For OId% = 1 To PlatformsCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( EntityY ( PlatformRoot ( Id ) ) &gt;= EntityY ( PlatformRoot ( OId ) ) And EntityY ( PlatformRoot ( Id ) ) &lt;= EntityY ( PlatformRoot ( OId ) ) + 0.1 And Distance2D ( EntityX ( PlatformRoot ( Id ), True ), EntityZ ( PlatformRoot ( Id ), True ), EntityX ( PlatformRoot ( OId ), True ), EntityZ ( PlatformRoot ( OId ), True ) ) &lt;= PlatformXZRadius ( Id ) + PlatformXZRadius ( OId ) + 1 ) 
Goto LineChoosePlatformPosition
 EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( PlatformRenderer ( Id ), PlatformRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( PlatformPickable ( Id ), PlatformRoot ( Id ) ) 
 
NameEntity ( PlatformPickable ( Id ), "PLA" + Str ( Id ) ) 

 Next

End Function

Function BuildHumanoids ( ) 

 For i% = 1 To 10 Step 1

HumanoidsCount = HumanoidsCount + 1
Id% = HumanoidsCount

HumanoidRoot ( Id ) = CreatePivot ( ) 

HumanoidMiddle ( Id ) = CreatePivot ( ) 
PositionRotateEntityLikeOtherEntity ( HumanoidMiddle ( Id ), HumanoidRoot ( Id ) ) 
MoveEntity ( HumanoidMiddle ( Id ), 0, 0.875, 0 ) 
SetEntityAsChildOfOtherEntity ( HumanoidMiddle ( Id ), HumanoidRoot ( Id ) ) 

HumanoidEyes ( Id ) = CreatePivot ( ) 

HumanoidRenderer ( Id ) = CreateCube ( ) 
ScaleMesh ( HumanoidRenderer ( Id ), 0.5/2, 1.75/2, 0.25/2 ) 
PositionMesh ( HumanoidRenderer ( Id ), 0, 1.75/2, 0 ) 
ColorSurfaceWithBrush ( GetSurface ( HumanoidRenderer ( Id ), 1 ), Rand ( 025, 255 ), Rand ( 025, 255 ), Rand ( 025, 255 ) ) 
HideEntity ( HumanoidRenderer ( Id ) ) 

HumanoidXZRadius ( Id ) = 0.25

HumanoidPickable ( Id ) = CreateCylinder ( 16 ) 
ScaleMesh ( HumanoidPickable ( Id ), 0.5/2, 1.0/2, 0.5/2 ) 
PositionMesh ( HumanoidPickable ( Id ), 0, 1.0/2, 0 ) 
EntityColor ( HumanoidPickable ( Id ), 255, 255, 255 ) 
EntityAlpha ( HumanoidPickable ( Id ), 0.5 ) 

.LineChooseHumanoidPosition
PositionEntity ( HumanoidRoot ( Id ), Rnd ( 0 + 0.25, 128 - 0.25 ), 3.2 + 0.1, Rnd ( 0 + 0.25, 128 - 10 - 3 - 0.25 ), True ) 
;is far enough from another building ?
For OId% = 1 To BuildingsCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( BuildingRoot ( OId ), True ), EntityZ ( BuildingRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + BuildingXZRadius ( OId ) + 1 ) 
Goto LineChooseHumanoidPosition
 EndIf
Next
;is far enough from another Stair ?
For OId% = 1 To StairsCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( StairRoot ( OId ), True ), EntityZ ( StairRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + StairXZRadius ( OId ) + 1 ) 
Goto LineChooseHumanoidPosition
 EndIf
Next
;is far enough from another rock ?
For OId% = 1 To RocksCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( RockRoot ( OId ), True ), EntityZ ( RockRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + RockXZRadius ( OId ) + 1 ) 
Goto LineChooseHumanoidPosition
 EndIf
Next
;is far enough from another tree ?
For OId% = 1 To TreesCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( TreeRoot ( OId ), True ), EntityZ ( TreeRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + TreeXZRadius ( OId ) + 1 ) 
Goto LineChooseHumanoidPosition
 EndIf
Next
;is far enough from another crate ?
For OId% = 1 To CratesCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( CrateRoot ( OId ), True ), EntityZ ( CrateRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + CrateXZRadius ( OId ) + 1 ) 
Goto LineChooseHumanoidPosition
 EndIf
Next
;is far enough from another barrel ?
For OId% = 1 To BarrelsCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( BarrelRoot ( OId ), True ), EntityZ ( BarrelRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + BarrelXZRadius ( OId ) + 1 ) 
Goto LineChooseHumanoidPosition
 EndIf
Next
;is far enough from another platform ?
For OId% = 1 To PlatformsCount Step 1
 If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( PlatformRoot ( OId ), True ), EntityZ ( PlatformRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + PlatformXZRadius ( OId ) + 1 ) 
If ( EntityY ( PlatformRoot ( OId ), True ) &lt; 3.2 + 1.75 + 1 ) 
 Goto LineChooseHumanoidPosition
EndIf
 EndIf
Next
;is far enough from another humanoid ?
For OId% = 1 To HumanoidsCount Step 1
 If ( OId &lt;&gt; Id ) 
If ( Distance2D ( EntityX ( HumanoidRoot ( Id ), True ), EntityZ ( HumanoidRoot ( Id ), True ), EntityX ( HumanoidRoot ( OId ), True ), EntityZ ( HumanoidRoot ( OId ), True ) ) &lt;= HumanoidXZRadius ( Id ) + HumanoidXZRadius ( OId ) + 1 ) 
 Goto LineChooseHumanoidPosition
EndIf
 EndIf
Next
PositionRotateEntityLikeOtherEntity ( HumanoidRenderer ( Id ), HumanoidRoot ( Id ) ) 
SetEntityAsChildOfOtherEntity ( HumanoidRenderer ( Id ), HumanoidRoot ( Id ) ) 
PositionRotateEntityLikeOtherEntity ( HumanoidPickable ( Id ), HumanoidRoot ( Id ) ) 
SetEntityAsChildOfOtherEntity ( HumanoidPickable ( Id ), HumanoidRoot ( Id ) ) 

HumanoidTarget ( Id ) = CreatePivot ( ) 
PositionEntity ( HumanoidTarget ( Id ), Rnd ( 0 + 0.25, 128.0 - 0.25 ), 3.2, Rnd ( 0 + 0.25, 128.0 - 0.25 ), True ) 

;HumanoidPostureMode ( Id ) = Rand ( 1, 2 ) 
HumanoidPostureMode ( Id ) = CStanding
ScaleEntity ( HumanoidPickable ( Id ), 1, 1.75, 1 ) 
PositionRotateEntityLikeOtherEntity ( HumanoidEyes ( Id ), HumanoidRoot ( Id ) ) 
MoveEntity ( HumanoidEyes ( Id ), 0, 1.75 - 0.1, 0 ) 
HumanoidMoveForce ( Id ) = Rnd ( 0.05, 0.5 ) 
HumanoidJumpForce ( Id ) = 0
HumanoidPositionState ( Id ) = COnAir
HumanoidActionState ( Id ) = CIsFalling
HumanoidGVX ( Id ) = 0
HumanoidGVY ( Id ) = 0
HumanoidGVZ ( Id ) = 0

NameEntity ( HumanoidPickable ( Id ), "HUM" + Str ( Id ) ) 

 Next

End Function

Function GetMouseInput ( ) 

 MPX = MouseX ( ) 
 MPY = MouseY ( ) 

 MXDiff = MouseXSpeed ( ) 
 MYDiff = MouseYSpeed ( ) 

 MWheel = 0
 MZCur = MouseZ ( ) 
 If ( MZCur &gt; MZOld ) 
MWheel =  1
MZOld = MZCur
 ElseIf ( MZCur &lt; MZOld ) 
MWheel = -1
MZOld = MZCur
 EndIf

End Function

Function GetKeyboardInput ( ) 

 KeySpaceState = CIdle
 If ( KeyDown ( 57 ) = 1 ) 
KeySpaceDownCount = KeySpaceDownCount + 1
If ( KeySpaceDownCount = 1 ) 
 KeySpaceState = CPressed
 KeySpacePrevState = CPressed
Else If ( KeySpaceDownCount &gt; 1 ) 
 KeySpaceState = CHeld
 KeySpacePrevState = CHeld
EndIf
 Else If ( KeyDown ( 57 ) = 0 ) 
KeySpaceDownCount = 0
If ( KeySpacePrevState = CPressed Or KeySpacePrevState = CHeld ) 
 KeySpaceState = CReleased
 KeySpacePrevState = CReleased
EndIf
 EndIf

 For i% = 1 To 10 Step 1

UpdatePlayer ( HumanoidPickable ( PlayerId ), 0.01, 0.03, 0.03, 0.05 ) 

PositionEntity cam, EntityX# ( HumanoidPickable ( PlayerId ) ), EntityY# ( HumanoidPickable ( PlayerId ) ), EntityZ# ( HumanoidPickable ( PlayerId ) ) 

 Next

End Function
</textarea><br><br>Enjoy!<br><br>~GF <br><br></td></tr></table><br>
<a name="1306171"></a>

<a name="1306172"></a>

<a name="1306219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I will be posting it FOR ALL TO SEE because you are nothing to me!<br> <br></div><br>@GF&gt;&gt;I feel the same about you, as you already know :D<br><br>I don't really care that you post it for others to see, only those who have a good enough level will be able to understand it and to use it (=not you)<br><br><br>@Rick&gt;&gt;The example with linepicks and pickables has jumping, falling, but not sliding (because i had a problem with the picked normal values, not sure why)<br><br><br>Anyway it shows 2 alternative ways to manage collisions. <br><br></td></tr></table><br>
<a name="1306173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>if you guys wanna fix the camera, the jump, &amp; the player.<br> <br></div><br>Some things never change... Ahahah <br><br></td></tr></table><br>
<a name="1306174"></a>

<a name="1306175"></a>

<a name="1306176"></a>

<a name="1306177"></a>

<a name="1306178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> (GF modified my code, now the example he posted does not work anymore, nothing surprising...) <br><br></td></tr></table><br>
<a name="1306181"></a>

<a name="1306543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="1306182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh my mistake, a part of the code is missing.<br>Please redownload in a moment.<br><br><br>@GF&gt;&gt;remove your codes i will reupload the full working code so that you can steal it. <br><br></td></tr></table><br>
<a name="1306185"></a>

<a name="1306544"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="1306189"></a>

<a name="1306192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here : rd-stuff.fr/one-pivot+several-linepicks+pickables-code-example.bb<br><br>The controls are :<br>mouse xaxis to turn left right<br>mouse yaxis to look up down<br>zqsd to move front back left right<br>mouse wheel to increase or decrease movement speed<br>hold space to charge jump<br>release space to jump<br>left ctrl to crouch<br>left shift to stand<br><br>the others things i don't remember, read the code... <br><br></td></tr></table><br>
<a name="1306198"></a>

<a name="1306199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> In this code example (one-pivot+several-linepicks+pickables), there are slopes, but you can only move on those who have a slope between 0 and 45, because between 45 and 90 the character was supposed to automatically slide down the slope. However this is where i stopped to code this because there was a problem with the picked normal values...<br><br>Maybe GF will fix it ? <br><br></td></tr></table><br>
<a name="1306201"></a>

<a name="1306202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks RemiD, that was an awesome demo! :D In fact, by looking at those game components you can actually make a game with it. nice!<br><br>Apparently atm I just need a really really basic example to figure it out, a ground, ramp + player will do. The added terrain is another bonus. I just need to dissect what is happening under the hood. <br><br>Thank you again, that looks really cool. I might use it as a base for later demos if you have no restrictions with it. <br><br></td></tr></table><br>
<a name="1306203"></a>

<a name="1306204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it's still hard to come up with an alternative, I think RickNasher's code will do just fine for now. I stripped down just the basics so I can test some stuff with it and see if it fits with what I'm trying to do.<br><br>On a separate question, how do you get the inclination of a surface with the linepick collision so your object follows the angle or steepness, ie terrain? <br><br></td></tr></table><br>
<a name="1306216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RustiKristi<br>Search for AlignToVector , it normally does the trick.<br>I think you would have to use something like this:<br><br>LinePick( EntityX( player ), EntityY( player ), EntityZ( player ), EntityX( objecttoalignto ) - EntityX( player ), EntityY( objecttoalignto  ) - EntityY( player ), EntityZ( objecttoalignto  ) - EntityZ( player ) )<br>AlignToVector( player, PickedNX(), PickedNY(), PickedNZ(), 2, 1 )<br><br>@RemiD<br>Ah, you noticed it was missing a few major routines. Tssk tssk. Thought like GF, you were pulling someone's leg here. :-)<br><br>Besides: at 2nd glance I noticed some vital things were missing from the multiplayer code. I don't know how I was thinking it would ever work while only using linepick in the follow cam and jumping sections.. Aarrghh <br>[Rick beating himself over the head with a fat, large, rotten fish] <br><br></td></tr></table><br>
<a name="1306217"></a>

<a name="1306218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> @All&gt;&gt;Yes you can use this code as it is or modify it for your projects, no restriction, i don't care, only those who have a good enough understanding and skill will be able to anyway ! :)<br><br><br>Also one tip concerning movement on slopes or crossing small obstacles (lower than the  knee level) or movement on a terrain with hills and deeps or irregular ground :<br>you can use linepick to detect where the ground is related to the player root, and if it is farer ("further" ?) than the distance between the root and the knee, calculate and apply gravity, but if it is between the root and the knee, directly position the character on the ground. This allows movement on irregular terrains/small obstacles without "jerky falling". <br><br></td></tr></table><br>
<a name="1306220"></a>

<a name="1306221"></a>

<a name="1306222"></a>

<a name="1306223"></a>

<a name="1306224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is another example with one pivot + one ellipsoid + collidables, so that Rick can finally realize the superiority of my code and my awesomeness (just joking this code is old and primitive) :<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D(800,600,32,2)
SetBuffer(BackBuffer())
SeedRnd(MilliSecs())

Origine = CreateCube()
ScaleMesh(Origine,0.01/2,0.01/2,0.01/2)
EntityColor(Origine,255,000,000)

Const CIdle% = 0
Const CHit% = 1
Const CHeld% = 2
Const CReleased% = 3
Const CRolled% = 4
;Const CHitAlreadyUsed% = 4
;Const CHeldAlreadyUsed% = 5
;Const CRolledAlreadyUsed% = 6

Global MXDiff#
Global MYDiff#
Global MPX%
Global MPY%
Global MZOld% = 0
Global MZCur% = 0
Global MWheel% = 0

Global KeyMouseLeftState%
Global KeyMouseRightState%
Global KeyMouseMiddleState%
Global KeyMouseWheelState%
Global KeyMouseLeftDownTime%
Global KeyMouseRightDownTime%
Global KeyMouseMiddleDownTime%

Global KeyActionState%
Global KeyActionDownTime% 

Global Camera = CreateCamera()
CameraRange(Camera,0.1,100)

Const GroupPlayer% = 1
Const GroupTerrains% = 2
Const GroupBuildings% = 3
Const GroupLedges% = 4
Const GroupLadders% = 5
Const GroupPoles% = 6
Const GroupRopes% = 7
Const GroupWirenets% = 8
Const GroupPlatforms% = 9
Const GroupElevators% = 10

Global TerrainB3D = CreateTerrain(32)
For VX% = 0 To 31
 For VZ% = 0 To 31
  HeightRGB% = Rand(030,033)
  Height# = 1.0/255*HeightRGB
  ModifyTerrain(TerrainB3D,VX,VZ,Height,False) 
 Next
Next
ScaleEntity(TerrainB3D,1,25.5,1)
TerrainDetail(TerrainB3D,2048,True)
TerrainShading(TerrainB3D,True)
PositionEntity(TerrainB3D,0,0,0)
EntityColor(TerrainB3D,000,100,000)
NameEntity(TerrainB3D,"TER"+Str(1))
EntityType(TerrainB3D,GroupTerrain)

Global BuildingMesh = CreateMesh()
TPart = CreateCube()
ScaleMesh(TPart,5.0/2,0.3/2,5.0/2)
PositionMesh(TPart,0,-0.15,0)
AddMesh(TPart,BuildingMesh)
FreeEntity(TPart)
TPart = CreateCube()
ScaleMesh(TPart,5.0/2,3.0/2,5.0/2)
PositionMesh(TPart,0,1.5,0)
AddMesh(TPart,BuildingMesh)
FreeEntity(TPart)
EntityColor(BuildingMesh,100,100,100)
NameEntity(BuildingMesh,"BUI"+Str(1))
EntityType(BuildingMesh,GroupBuildings)
PositionEntity(BuildingMesh,16,3.3,16)

Global LadderMesh = CreateMesh()
TPart = CreateCube()
ScaleMesh(TPart,0.05/2,3.3/2,0.05/2)
PositionMesh(TPart,-0.025,1.65,0)
PositionMesh(TPart,-0.2,0,0)
AddMesh(TPart,LadderMesh)
FreeEntity(TPart)
TPart = CreateCube()
ScaleMesh(TPart,0.05/2,3.3/2,0.05/2)
PositionMesh(TPart,0.025,1.65,0)
PositionMesh(TPart,0.2,0,0)
AddMesh(TPart,LadderMesh)
FreeEntity(TPart)
For TY# = 0.3 To 3.3 Step 0.2
 TPart = CreateCube()
 ScaleMesh(TPart,0.4/2,0.05/2,0.05/2)
 PositionMesh(TPart,0.0,TY,0)
 AddMesh(TPart,LadderMesh)
 FreeEntity(TPart)
Next
EntityColor(LadderMesh,100,050,025)
Global LadderColliderR = CreateQuad()
RotateMesh(LadderColliderR,0,180,0)
ScaleMesh(LadderColliderR,0.5/2,3.3/2,1)
PositionMesh(LadderColliderR,0,1.65,0)
EntityAlpha(LadderColliderR,0.25)
EntityParent(LadderColliderR,LadderMesh,True)
MoveEntity(LadderColliderR,0,0,-0.025-0.001)
NameEntity(LadderColliderR,"LAD"+Str(1))
EntityType(LadderColliderR,GroupLadders)
PositionEntity(LadderMesh,16,3,16-2.5-0.025)

Const COnGround% = 1
Const COnAir% = 2
Const COnLedge% = 3
Const COnLadder% = 4
Const COnPole% = 5
Const COnRope% = 6
Const COnWirenet% = 7
Const COnPlatform% = 8
Const COnElevator% = 9
Global PlayerPositionState% = COnGround

Global PlayerFallForce# = 0
Global PlayerJumpForce# = 0

Const COn% = 1
Const COff% = 2

Global PlayerJumpState% = COff

Global PlayerVX# = 0
Global PlayerVZ# = 0

Global PlayerColliderE = CreatePivot()
PositionEntity(PlayerColliderE,0,0.25,0)
EntityRadius(PlayerColliderE,0.25)
EntityType(PlayerColliderE,GroupPlayer)
Global PlayerFeet = CreatePivot()
PositionEntity(PlayerFeet,0,0,0)
EntityParent(PlayerFeet,PlayerColliderE,True)
Global PlayerEyes = CreatePivot()
PositionEntity(PlayerEyes,0,1.6,0.11)
EntityParent(PlayerEyes,PlayerFeet,True)
DebugPlayerColliderE = CreateSphere(16)
ScaleMesh(DebugPlayerColliderE,0.5/2,0.5/2,0.5/2)
PositionEntity(DebugPlayerColliderE,EntityX(PlayerColliderE,True),EntityY(PlayerColliderE,True),EntityZ(PlayerColliderE,True))
RotateEntity(DebugPlayerColliderE,EntityPitch(PlayerColliderE,True),EntityYaw(PlayerColliderE,True),EntityRoll(PlayerColliderE,True))
EntityParent(DebugPlayerColliderE,PlayerColliderE,True)
EntityAlpha(DebugPlayerColliderE,0.25)
PlayerMesh = CreateCube()
ScaleMesh(PlayerMesh,0.5/2,1.7/2,0.25/2)
PositionMesh(PlayerMesh,0,0.85,0)
EntityParent(PlayerMesh,PlayerFeet,True)
EntityColor(PlayerMesh,000,000,225)
Global PlayerCenter = CreatePivot()
PositionEntity(PlayerCenter,EntityX(PlayerFeet,True),EntityY(PlayerFeet,True),EntityZ(PlayerFeet,True))
RotateEntity(PlayerCenter,EntityPitch(PlayerFeet,True),EntityYaw(PlayerFeet,True),EntityRoll(PlayerFeet,True))
MoveEntity(PlayerCenter,0,0.85,0)
EntityParent(PlayerCenter,PlayerFeet,True)
Global DebugPickOnGround = CreateCube()
ScaleMesh(DebugPickOnGround,0.025/2,0.025/2,0.025/2)
EntityColor(DebugPickOnGround,125,000,255)

PositionEntity(Camera,EntityX(PlayerEyes,True),EntityY(PlayerEyes,True),EntityZ(PlayerEyes,True))
RotateEntity(Camera,EntityPitch(PlayerEyes,True),EntityYaw(PlayerEyes,True),EntityRoll(PlayerEyes,True))
EntityParent(Camera,PlayerEyes,True)
MoveEntity(Camera,0,0,-3)
TurnEntity(PlayerEyes,22.5,0,0)

PositionEntity(PlayerColliderE,16,3.3+0.251,8)

;PositionEntity(Camera,0,0,-3)


DLight = CreateLight(1)
LightColor(DLight,225,225,225)
PositionEntity(DLight,-1000,1000,-1000)
RotateEntity(DLight,45,-45,0)

AmbientLight(050,050,050)

Global CollidedCollidable%
Global CollidedName$
Global CollidedKind$
Global CollidedId%

Collisions(GroupPlayer,GroupTerrains,2,2)
Collisions(GroupPlayer,GroupBuildings,2,2)
Collisions(GroupPlayer,GroupLadders,2,2)

Global SC#

Repeat

 MainLoopStart% = MilliSecs()

 SetBuffer(BackBuffer())

 ;GetInput()

 UpdatePlayerBC()
 
 UpdateWorld()

 UpdatePlayerAC()

 If(KeyDown(2)=1)
  WireFrame(True)
 Else
  WireFrame(False)
 EndIf

 ClsColor(000,000,000)
 Cls()

 RenderWorld()
 
 Text(0,0,"Triangles = "+TrisRendered())
 Text(0,20,"FPS = "+Str(FPS))
 Text(0,40,"CollidedCollidable = "+Str(CollidedCollidable))
 Text(0,60,"CollidedName = "+CollidedName)
 Text(0,80,"CollidedKind = "+CollidedKind)
 Text(0,100,"CollidedId = "+Str(CollidedId))
 Text(0,120,"PlayerPositionState = "+PlayerPositionStateStr())
 Text(0,140,"PlayerVX = "+Str(PlayerVX))
 Text(0,160,"PlayerVZ = "+Str(PlayerVZ))
 Text(0,180,"PlayerJumpState = "+PlayerJumpStateStr())
 Text(0,200,"PlayerJumpForce = "+Str(PlayerJumpForce))
 Text(0,220,"PlayerFallForce = "+Str(PlayerFallForce))
 Text(0,240,"PlayerJumpForce+PlayerFallForce = "+Str(PlayerJumpForce+PlayerFallForce))
 
 Flip(1)

 MainLoopTime% = MilliSecs() - MainLoopStart
 If(MainLoopTime = 0)
  MainLoopTime = 1
 EndIf

 FPS% = 1000/MainLoopTime
 SC# = Float(30) / 1000 * MainLoopTime

Until(KeyDown(1)=1)

EndGraphics()

End()

Function CreateQuad()
 TMesh = CreateMesh()
 TSurface = CreateSurface(TMesh)
 AddVertex(TSurface, 1.0, 1.0, 0.0, 0.000, 0.000)
 AddVertex(TSurface, -1.0, 1.0, 0.0, 1.000, 0.000)
 AddVertex(TSurface, 1.0, -1.0, 0.0, 0.000, 1.000)
 AddVertex(TSurface, -1.0, -1.0, 0.0, 1.000, 1.000)
 AddTriangle(TSurface,0,1,2)
 AddTriangle(TSurface,2,1,3)
 UpdateNormals(TMesh)
 Return TMesh
End Function

Function GetInput()
 GetInputMouse()
 GetInputKeyboard()
End Function

Function GetInputMouse()
 KeyMouseLeftState = CIdle
 KeyMouseRightState = CIdle
 KeyMouseMiddleState = CIdle
 KeyMouseWheelState = CIdle
 If(MouseHit(1)&gt;0)
  ;DebugLog("KeyMouseLeft hit !")
  KeyMouseLeftState = CHit
 ElseIf(MouseDown(1)=1)
  KeyMouseLeftDownTime = KeyMouseLeftDownTime + 1
  If(KeyMouseLeftDownTime &gt; 30)
   ;DebugLog("KeyMouseLeft held !")
   KeyMouseLeftState = CHeld
  EndIf 
 EndIf
 If(MouseDown(1)=0)
  KeyMouseLeftDownTime = 0
 EndIf
 If(MouseHit(2)&gt;0)
  ;DebugLog("KeyMouseRight hit !")
  KeyMouseRightState = CHit
 ElseIf(MouseDown(2)=1)
  KeyMouseRightDownTime = KeyMouseRightDownTime + 1
  If(KeyMouseRightDownTime &gt; 30)
   ;DebugLog("KeyMouseRight held !")
   KeyMouseRightState = CHeld
  EndIf 
 EndIf
 If(MouseDown(2)=0)
  KeyMouseRightDownTime = 0
 EndIf
 If(MouseHit(3)&gt;0)
  KeyMouseMiddleState = CHit
 EndIf
 MPX = MouseX()
 MPY = MouseY()
 MXDiff = MouseXSpeed()  
 MYDiff = MouseYSpeed() 
 MZCur = MouseZ()
 If(MZCur &gt; MZOld)
  MWheel = + 1
  MZOld = MZCur
  ;DebugLog("MWheel = "+MWheel)
  KeyMouseWheelState = CRolled
 ElseIf(MZCur &lt; MZOld)
  MWheel = - 1
  MZOld = MZCur
  ;DebugLog("MWheel = "+MWheel)
  KeyMouseWheelState = CRolled
 EndIf
End Function

Function GetInputKeyboard()
 KeyActionState = CIdle
 If(KeyHit(57)&gt;0)
  ;DebugLog("KeyAction hit !")
  KeyActionState = CHit
 ElseIf(KeyDown(57)=1)
  KeyActionDownTime = KeyActionDownTime + 1
  If(KeyActionDownTime &gt; 30)
   ;DebugLog("KeyAction held !")
   KeyActionState = CHeld
  EndIf 
 EndIf
 If(KeyDown(57)=0)
  KeyActionDownTime = 0
 EndIf
End Function

Function UpdatePlayerBC()
 If(PlayerPositionState = COnGround)  
  PlayerOldX# = EntityX(PlayerColliderE,True)
  PlayerOldZ# = EntityZ(PlayerColliderE,True)
  If(KeyDown(17)=1)
   MoveEntity(PlayerColliderE,0,0,0.1)
  ElseIf(KeyDown(31)=1)
   MoveEntity(PlayerColliderE,0,0,-0.1)
  EndIf
  If(KeyDown(30)=1)
   TurnEntity(PlayerColliderE,0,1.5,0)
  ElseIf(KeyDown(32)=1)
   TurnEntity(PlayerColliderE,0,-1.5,0)
  EndIf
  If(KeyDown(16)=1)
   MoveEntity(PlayerColliderE,-0.1,0,0)
  ElseIf(KeyDown(18)=1)
   MoveEntity(PlayerColliderE,0.1,0,0)
  EndIf
  If(KeyHit(57)&gt;0)
   PlayerJumpForce = 0.85/10
   PlayerJumpState = COn
   TranslateEntity(PlayerColliderE,0,PlayerJumpForce,0)
  EndIf
  PlayerNewX# = EntityX(PlayerColliderE,True)
  PlayerNewZ# = EntityZ(PlayerColliderE,True)
  PlayerVX = PlayerNewX-PlayerOldX
  PlayerVZ = PlayerNewZ-PlayerOldZ
 ElseIf(PlayerPositionState = COnAir)
  PlayerFallForce = PlayerFallForce - 0.166/40
  If(PlayerJumpForce+PlayerFallForce &lt;= 0)
   PlayerJumpState = COff
  EndIf
  ;TranslateEntity(PlayerColliderE,0,PlayerJumpForce+PlayerFallForce,0)
  TranslateEntity(PlayerColliderE,PlayerVX,PlayerJumpForce+PlayerFallForce,PlayerVZ)
 ElseIf(PlayerPositionState = COnLedge)
  ;
 ElseIf(PlayerPositionState = COnLadder)
  If(EntityY(PlayerFeet,True) &gt; EntityY(LadderMesh,True)+0.5)
   If(EntityY(PlayerFeet,True) &gt; EntityY(LadderMesh,True)+3.3)
    PlayerJumpForce = 0.25/10
    PlayerJumpState = COn
    TFormPoint(0,0,0.1,PlayerColliderE,0)
    PlayerVX = TFormedX()-EntityX(PlayerColliderE,True)
    PlayerVZ = TFormedZ()-EntityZ(PlayerColliderE,True)
    PlayerPositionState = COnAir
   EndIf
  ElseIf(EntityY(PlayerFeet,True) &lt;= EntityY(LadderMesh,True)+0.5)
   MoveEntity(PlayerColliderE,0,0,-0.1)
   PlayerPositionState = COnAir
  EndIf 
  If(KeyHit(29)&gt;0)
   MoveEntity(PlayerColliderE,0,0,-0.1)
   PlayerPositionState = COnAir
  ElseIf(KeyHit(57)&gt;0)
   PlayerJumpForce = 0.25/10
   PlayerJumpState = COn
   TFormPoint(0,0,-0.1,PlayerColliderE,0)
   PlayerVX = TFormedX()-EntityX(PlayerColliderE,True)
   PlayerVZ = TFormedZ()-EntityZ(PlayerColliderE,True)
   PlayerPositionState = COnAir
  EndIf
  If(KeyDown(17)=1)
   MoveEntity(PlayerColliderE,0,0.2/10,0)
  ElseIf(KeyDown(31)=1)
   MoveEntity(PlayerColliderE,0,-0.2/10,0)
  EndIf
 ElseIf(PlayerPositionState = COnPole)
  ;
 ElseIf(PlayerPositionState = COnRope)
  ;
 ElseIf(PlayerPositionState = COnWirenet)
  ;
 ElseIf(PlayerPositionState = COnPlatform)
  ;
 ElseIf(PlayerPositionState = COnElevator)

 EndIf
End Function

Function UpdatePlayerAC()
 If( PlayerPositionState = COnGround Or PlayerPositionState = COnAir )
  CC% = CountCollisions(PlayerColliderE)
  If(CC% &gt; 0)
   CollidedCollidable = CollisionEntity(PlayerColliderE,1)
   If(CollidedCollidable &lt;&gt; 0)
    ;DebugCollidedPoint = CreateCube()
    ;ScaleMesh(DebugCollidedPoint,0.025/2,0.025/2,0.025/2)
    ;PositionEntity(DebugCollidedPoint,CollisionX(PlayerColliderE,1),CollisionY(PlayerColliderE,1),CollisionZ(PlayerColliderE,1))
    ;EntityColor(DebugCollidedPoint,255,000,000)
    CollidedName$ = EntityName(CollidedCollidable)
    CollidedKind$ = Left(CollidedName,3)
    CollidedId% = Right(CollidedName,Len(CollidedName)-3)
    If(CollidedKind = "TER")
     ;
    ElseIf(CollidedKind = "BUI")
     ;
    ElseIf(CollidedKind = "LED")
     ;
    ElseIf(CollidedKind = "LAD")
     If( DeltaYaw(PlayerFeet,LadderMesh) =&gt; -22.5 And DeltaYaw(PlayerFeet,LadderMesh) &lt;= 22.5 )
      If(EntityY(PlayerFeet,True) &gt; EntityY(LadderMesh,True)+0.5)
       PlayerPositionState = COnLadder
       TY# = EntityY(PlayerFeet,True)
       PlayerVX# = 0
       PlayerVZ# = 0
       PlayerFallForce = 0
       PlayerJumpForce = 0
       PositionEntity(PlayerColliderE,EntityX(LadderMesh,True),TY,EntityZ(LadderMesh,True)-0.025-0.1-0.251)
       RotateEntity(PlayerColliderE,EntityPitch(LadderMesh,True),EntityYaw(LadderMesh,True),EntityRoll(LadderMesh,True))
      EndIf
     EndIf
    EndIf
   EndIf
  EndIf
 EndIf
 EntityPickMode(TerrainB3D,2)
 EntityPickMode(BuildingMesh,2)
 TFormVector(0,-10,0,PlayerCenter,0)
 LinePick(EntityX(PlayerCenter,True),EntityY(PlayerCenter,True),EntityZ(PlayerCenter,True),TFormedX(),TFormedY(),TFormedZ())
 PickedPickable = PickedEntity()
 If(PickedPickable &lt;&gt; 0)
  PickedName$ = EntityName(PickedPickable)
  PickedKind$ = Left(PickedName,3)
  PickedId% = Right(PickedName,Len(PickedName)-3)
  If(PickedKind = "TER")
   PX# = PickedX()
   PY# = PickedY()
   PZ# = PickedZ()
  ElseIf(PickedKind = "BUI")
   PX# = PickedX()
   PY# = PickedY()
   PZ# = PickedZ()
  EndIf
 ElseIf(PickedPickable = 0)
  PX# = EntityX(PlayerCenter,True)
  PZ# = EntityZ(PlayerCenter,True)
  PY# = TerrainY(TerrainB3D,PX,0,PZ)
 EndIf
 PositionEntity(DebugPickOnGround,PX,PY,PZ)
 EntityPickMode(TerrainB3D,0)
 EntityPickMode(BuildingMesh,0)
 If(PlayerPositionState &lt;&gt; COnLadder)
  If(EntityY(PlayerFeet,True) &gt; PY)
   If(EntityY(PlayerFeet,True) - PY &lt;= 0.3)
    If(PlayerJumpState = COff)
     PlayerPositionState =  COnGround
     PositionEntity(PlayerColliderE,PX,PY+0.251,PZ)
     PlayerFallForce = 0
     PlayerJumpForce = 0
    ElseIf(PlayerJumpState = COn)
     PlayerPositionState =  COnAir
    EndIf
   ElseIf(EntityY(PlayerFeet,True) - PY &gt; 0.3)  
    PlayerPositionState =  COnAir
   EndIf
  ElseIf(EntityY(PlayerFeet,True) &lt;= PY)
   PlayerPositionState =  COnGround
   PositionEntity(PlayerColliderE,PX,PY+0.251,PZ)
   PlayerFallForce = 0
   PlayerJumpForce = 0
  EndIf
 EndIf
End Function

Function PlayerPositionStateStr$()
 If(PlayerPositionState = COnGround)
  StateStr$ = "OnGround"
 ElseIf(PlayerPositionState = COnAir)
  StateStr$ = "OnAir"
 ElseIf(PlayerPositionState = COnLedge)
  StateStr$ = "OnLedge"
 ElseIf(PlayerPositionState = COnLadder)
  StateStr$ = "OnLadder"
 ElseIf(PlayerPositionState = COnPole)
  StateStr$ = "OnPole"
 ElseIf(PlayerPositionState = COnRope)
  StateStr$ = "OnRope"
 ElseIf(PlayerPositionState = COnWirenet)
  StateStr$ = "OnWirenet"
 ElseIf(PlayerPositionState = COnElevator)
  StateStr$ = "OnElevator"
 EndIf
 Return StateStr
End Function

Function PlayerJumpStateStr$()
 If(PlayerJumpState = COn)
  StateStr$ = "On"
 ElseIf(PlayerJumpState = COff)
  StateStr$ = "Off"
 EndIf
 Return StateStr
End Function
</textarea><br>Apparently, in this code i turnmove the ellipsoid and the rest of the character follows (works for simple games only, you can't create a tomb raider/indiana jones with that !)<br>You can grab the ladder only if the character is oriented towards enough, and then climb up down letgo... <br><br></td></tr></table><br>
<a name="1306229"></a>

<a name="1306232"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehehe, thanks but already solved the issue(sometimes it stares you right in the face). Had to extend sensitivity of linepick also. Silly really.<br>Many thanks though. Your initial response was correct.<br>See: <a href="http://www.blitzbasic.com/Community/post.php?topic=105608&amp;post=1306228" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=105608&amp;post=1306228</a><br><br>Btw: interesting fx with all the transparency, but kinda hard to maneuver.<br>Like the ladder thingy etc in 2nd example. Similar to the fps example in Blitz examples(the one with the gargoyle and stuff). <br><br></td></tr></table><br>
<a name="1306231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Rick&gt;&gt;about linepick length and radius, you may want to read this : <a href="http://www.blitzbasic.co.nz/Community/posts.php?topic=104372" target="_blank">http://www.blitzbasic.co.nz/Community/posts.php?topic=104372</a> (post#8) <br><br></td></tr></table><br>
<a name="1306233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rick Nasher</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know, read it before. ;-) thanks. <br><br></td></tr></table><br>
<a name="1306262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya know, Remi? You're a mean little t**t. I feel sorry for you... You can label me all you want, but it means NOTHING to me. Labeling is just a means of control &amp; I have just removed your control. How does it feel to lose?<br><br>Have a good day.<br><br>~GF <br><br></td></tr></table><br>
<a name="1306263"></a>

<a name="1306264"></a>

<a name="1306265"></a>

<a name="1306266"></a>

<a name="1306267"></a>

<a name="1306268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> GF, We're here to collaborate and not make enemies. There's a lot of social media platforms out there in case you want to pursue making friends or enemies, twitter facebook instagram, take your pick.<br><br>If the guy hates your guts, there's nothing you can do. Throwing insults with that last comment does not make any difference at all. So I would suggest stop doing these childish acts and move on.<br><br>Sometimes I don't agree or have differences of opinion with RemiD, Nasher or other guys but I don't take any offense on that because I'm here to learn and if I know something I would share it in return. It's normal but still they provide help and knowledge and I truly appreciate that. If you don't then maybe there's something wrong with you.<br><br>Please don't hijack this thread with your insults GF and move on, it's kind of disruptive. <br><br></td></tr></table><br>
<a name="1306269"></a>

<a name="1306270"></a>

<a name="1306271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RemiD<br><br>Thanks for the last example, it's much better now and I think I can get some ideas there. So the same applies with the ramp and a terrain?<br><br><div class="quote"> Search for AlignToVector , it normally does the trick.<br>I think you would have to use something like this:<br><br>LinePick( EntityX( player ), EntityY( player ), EntityZ( player ), EntityX( objecttoalignto ) - EntityX( player ), EntityY( objecttoalignto ) - EntityY( player ), EntityZ( objecttoalignto ) - EntityZ( player ) )<br>AlignToVector( player, PickedNX(), PickedNY(), PickedNZ(), 2, 1 )<br> <br></div><br><br>Ok RickNasher, I'll check this with the UDP example you already got which is working for me. thanks <br><br></td></tr></table><br>
<a name="1306272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> RustiKrusti, I defend you &amp; this is the thanks I get? I'm out of here... <br><br></td></tr></table><br>
<a name="1306273"></a>

<a name="1306274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> GF, first off I have no qualms with anyone here, so I'm not sure why you are defending me in the first place.. but thanks anyway. <br><br></td></tr></table><br>
<a name="1306283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>If the guy hates your guts, there's nothing you can do.<br> <br></div><br>I don't hate GF or anybody, i have difficulties to tolerate high level of stupidity/nonsense. (low level are ok, i am stupid too sometimes)<br><br><br>@GF&gt;&gt;Steal the code and fix it, improve it ! Show us how it is done by the master of Blitz3d.<br><br><div class="quote"> <br>How does it feel to lose?<br> <br></div><br>Oh nooo ! <br><br></td></tr></table><br>
<a name="1306290"></a>

<a name="1306291"></a>

<a name="1306292"></a>

<a name="1306447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RustyKristi&gt;&gt;The more recent code and what i would use would be the example with one pivot + several linepicks + pickables because it is flexible (i can organize the code how i want, no need for updateworld, and i can use it per turning moving entity for a step by step collision system (like in the example))<br>I have created another game prototype using the same system, but this time for a flying ship shape and it works reliably and is fast enough.<br><br>But it is probably reliable enough to use a system with one pivot + several ellipsoids + collidables to detect the obstacles at front,back,left,right, and one pivot + one linepick + pickables to detect the ground<br><br>The difficulty you may encounter when using ellipsoids + collidables is that even if you use the collision response "stop" sometimes an ellipsoid goes through a collidable so then how can you reposition the turning moving entity precisely if you can't rely on the collision detection ? Hence the system with several linepicks + pickables <br><br></td></tr></table><br>
<a name="1306384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks RemiD, I will look into that. <br><br></td></tr></table><br>
<a name="1306449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Linepicks are slow, it's not likely you can use linepicks for everything and still achieve a decent framerate having multiple moving characters/objects, unless you keep the scenery very basic.<br><br>Also, imitating gravity can be a pain in the behind (e.g. the "bullet through paper" problem among many other problems).<br>Why not use a physics engine? <br><br></td></tr></table><br>
<a name="1306455"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>Linepicks are slow, it's not likely you can use linepicks for everything and still achieve a decent framerate having multiple moving characters/objects, unless you keep the scenery very basic.</pre><br><br>Interesting, maybe not use the actual model as collisions and have a low poly with alpha instead? <br><br></td></tr></table><br>
<a name="1306464"></a>

<a name="1306465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Linepicks are slow, it's not likely you can use linepicks for everything and still achieve a decent framerate having multiple moving characters/objects<br> <br></div><br>my code example demonstrates the contrary, it depends on how you use linepick(s) (preferably after a distance check, and with low tris shapes for pickables) <br><br></td></tr></table><br>
<a name="1306466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, not only that, you'll need all kinds of optimizations to be able to use linepicks as a collision system in a real game running at an acceptable speed. Which is why I suggested using a physics engine ;) <br><br></td></tr></table><br>
<a name="1306468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> my code example demonstrates the contrary <br></div><br><br>I have not looked at your code but yes, you might manage to speed up linepick by enforcing restraints (entitydistance being a very important one). I highly doubt however it will run even remotely close to the speed a good physics engine would, especially when the scene gets crowded with lots of objects. <br>Reason being: a physics engine has all these optimizations already built in. <br><br></td></tr></table><br>
<a name="1306472"></a>

<a name="1306473"></a>

<a name="1306475"></a>

<a name="1306481"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> My comment was only to contradict your statement that "Linepicks are slow", it depends on how it is used...<br><br>Before doing a distance check to determine if a pickable must be considered or not, you could also have your map divided in areas so that you would only consider the pickables in the area where the character/vehicle is and those in the areas connected to this area. (=less distance checks, then less pickables to consider, then fast linepicks)<br><br>The same system can also be used to determine which surfaces must be hidden/shown before rendering.<br><br><br>A physics engine can also be slow depending on how it is used (especially if you have many turning moving bodies and you don't reset the angularvelocity and linearvelocity of the turning moving bodies and deactivate them below a low enough threshold). <br><br></td></tr></table><br>
<a name="1306477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really I think arguments concerning speed of linepicks vs speed of physics engine is rather subjective and highly context-dependant.<br><br>A physics engine may be much faster processing the collision and sliding motions of moving up/down ramps compared to linepicking the object every frame, yet Physics engines are not restricted ONLY to this implementation and perform numerous other calculations on numerous other entities regardless of whether those entities may be in the range/direction of a linepick etc.<br><br>If a physics engine of sorts is already implemented and in use then by all means it would probably be most efficient to utilise that functionality to handle moving along ramps - since the calculations will be performed regardless.<br><br>HOWEVER, if this is not the case, then Linepicking to identify the ramp and/or gradient is an ideal and fast enough method to handle most typical examples and will not be slowed down by the existence of unrelated objects that lie beyond or away from the pick radius and direciton. <br><br></td></tr></table><br>
<a name="1306484"></a>

<a name="1306486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, as I stated on this thread question, I can only use standard B3D functions and not include any libraries such as physx or bullet.<br><br>If that will be the case then I would not be asking for it anymore since the physics engine will do that for me, given the proper setup. <br><br></td></tr></table><br>
<a name="1306520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Cocopino</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, might have jumped to conclusions. I just scanned the thread and saw words like these:<br><div class="quote"> collisions, gravity, vector, gravityspeed, jumping, MMO, etc <br></div><br><br>Rolling your own physics simulator might prove a hell of a job... But if it works for you, it works for you :) <br><br></td></tr></table><br>
<a name="1306522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah its just for basic physics and gameplay stuff, nothing serious.<br><br>As for the mmo part, I did not even notice but that yea it was GF which btw was not even close to what we have been discussing. He's just trolling RemiD as usual.<br><br>thanks for the input. :) <br><br></td></tr></table><br>
<a name="1306523"></a>

<a name="1306542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="1306529"></a>

<a name="1306530"></a>

<a name="1306531"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> You should remove that comment before some admin or SkidRacer sees that. Do you want to be banned?<br><br>Read your comment #31 and tell me if you're not trolling. I'm seeking help and we're having a discussion about this custom physics and you're mocking somebody in the middle of it. <br><br>Man, you're totally out of place. Be polite and calm down. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
