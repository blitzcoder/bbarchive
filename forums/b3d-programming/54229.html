<!DOCTYPE html><html lang="en" ><head ><title >Chroma key</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Chroma key</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Chroma key</a><br><br>
<a name="605231"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chevron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have a good algorithm for removing blue/green for chroma keying images.<br><br>I am considering making a daft matchstick man kung-foo game,just for a bit of fun. <br><br></td></tr></table><br>
<a name="605235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I made some stuff. Its pretty simple, only the matte line may be tricky.<br><br>I'd suggest to:<br><br>calculate the ratio Blue vs Red and Blue vs Green<br><br>if both relations are above a given ratio, you may mask the pixel<br><br>v#=1.2<br><br>ratio1#=blue#/red#<br>ratio2#=blue#/green#<br><br>if (ratio1 &gt; v) and (ratio2 &gt; v) then<br>; mask it<br>endif<br><br>Personally I have added a matte line optimation that will help to reduce a greenish outline of the antialiased contour of the object, eg. if ratio is bigger than 1.0 and smaller than 1.2 then take the brightness of the foreground pixel and the colortone of the wanted background pixel (from the desired new background image) and create a new RGB value from it. <br><br></td></tr></table><br>
<a name="605239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chevron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that JFK this is the routine that I currently use<br><br>;-----------------------------------------------<br>Function chroma_blue_single(chroma_image$)<br>;-----------------------------------------------<br><br>Cls<br>SetBuffer BackBuffer()<br>image=LoadImage(chroma_image$)<br>DrawImage image,0,0<br>LockBuffer BackBuffer()<br><br>For y=0 To ImageHeight(image)<br>For x=0 To ImageWidth(image)<br><br>	int_rgb=ReadPixelFast (x,y)<br>	rgb_blue=getblue(int_rgb)<br>	rgb_red=GetRed(int_rgb) <br>	rgb_green=GetGreen(int_rgb)<br><br>	If rgb_blue-rgb_green&gt;intensity And rgb_blue-                rgb_red&gt;intensity<br><br>		WritePixelFast(x,y,mask_value)<br>	<br>	EndIf	<br>Next<br>Next<br><br>UnlockBuffer BackBuffer()<br>End Function<br><br><br>Which is pretty much as you suggest. But I just thought that it was a bit simple and thought that there must be a much better,more effective way of doing this.<br><br>Maybe this is an effective way, my results haven't been too bad. <br><br></td></tr></table><br>
<a name="605249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah, plain masking is simple. The tricky part is the contours, so prevent blocky contours, eg. in Chroma Keying for movies. But of course this only makes sense when you know the new background pixel, unless you store the masked image in a special format with alpha transparency for the contours: the more green a nonmasked pixel still is, the more transparent it's going to be, plus it will have to use the color tone of the background instead of its orignial greenish tone that is part of the green (masked) background.<br><br>I think photoshop is doing this too when you check the "antialiase" checkbox in the lasso tool. <br><br></td></tr></table><br>
<a name="605331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chevron</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, see what you are gettig at there, I have noticed this effect myself. I will try and normalise the edges of the masked images to fit the background image pixels and see how this effects my final result.<br><br>Thanks fo the advice <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
