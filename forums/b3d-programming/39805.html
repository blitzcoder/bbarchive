<!DOCTYPE html><html lang="en" ><head ><title >reading colour from lightmap for lighting entity?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >reading colour from lightmap for lighting entity?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >reading colour from lightmap for lighting entity?</a><br><br>
<a name="444469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure a while ago someone posted a routine to read the colour at an entity's position from the lightmap and then set the entity's colour, to enable it to darken when in shadow.<br><br>Does anyone have this routine? My attempt is very slow it seems.<br><br>Thanks<br>James <br><br></td></tr></table><br>
<a name="444617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah the dudes email that wrote the example for what your asking is kusanagi@...<br>I coudnt find the example though <br><br></td></tr></table><br>
<a name="444623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this it?:<br>danjeruz.servegame.com/DSS/vollight.zip <br><br></td></tr></table><br>
<a name="444625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry Puki, my server has been shut down by my ISP. i will email Vorderman as i still have the file though. <br><br></td></tr></table><br>
<a name="444628"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if it is the one.<br><br>Hey, "Vorderman" - is it the one in this thread?:<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=38107" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=38107</a> <br><br></td></tr></table><br>
<a name="444764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've sent the file to him via Email. <br><br></td></tr></table><br>
<a name="444782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks very much Cygnus - I'll have a look at it and see whether it's the thing I was after. I think there was a simple code example posted by someone somewhere, just posted up as normal in a [code] box - the forum search is next to useless though and I still can't find it...<br><br>by the way, how do you know my email :) ??? <br><br></td></tr></table><br>
<a name="444784"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone know who "kusanagi@..." is? I shall email him to see if he has the code example around still. Thanks ckob. <br><br></td></tr></table><br>
<a name="444790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Cygnus" knows and, if not, I can find out - the original for the above zip was posted at Blitzcoder - I think the guy is Russian or something - I can get the info.<br><br>Is the zip file the code you wanted?  If not, tell us everything you remember about the posted code you saw - names of people that posted in the thread - was it the code for an actual lightmapper routine or something else - any more info, will help me locate the code for you. <br><br></td></tr></table><br>
<a name="444810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about Fredborgs PickedU() &amp; PickedV() commands?<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=515" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=515</a><br><br>Linepick down<br>Get the Picked U &amp; V<br>Read that pixel color from the lightmap.<br><br>Rough &amp; Fast :) <br><br></td></tr></table><br>
<a name="444812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mustang</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Freelance 3D Artist, full time dad (note: 'Dad' services not for hire!) <br></div><br><br>:)<br><br>I could use "full time 3D Artist &amp; dad" - but I too wouldn't want to be a rent-a-dad for anyone else, it's too tough, one kid is more than enough... <br><br></td></tr></table><br>
<a name="444814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >puki</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The volume light code was done by "DSS" (that is what he is called on Blitzcoder).  I don't think he posts here.  He lives in the UK and his email is mailto:dmitry.smirnov@... <br><br></td></tr></table><br>
<a name="444819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, DSS is the coder for the volume lightmap program. my server is down but providing im not flooded with requests, il send the code via email. <br><br></td></tr></table><br>
<a name="444864"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, I'm not sure that volume lightmap program is the correct one - what I saw was a small routine to just return the colour from the lightmap at the position of an entity. I've done this myself with just a few lines, but for some reason reading the pixel colour from the lightmap is very very slow - even a single read every render loop drops the framerate, and I've tried using lockbuffer and readpixelfast - I must be doing something wrong somewhere - any ideas anyone? <br><br></td></tr></table><br>
<a name="444975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> With certain NVidia drivers, I've noticed slow downs with textures using the flag 256 (vram), is your lightmap using this flag? <br><br></td></tr></table><br>
<a name="444979"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>for some reason reading the pixel colour from the lightmap is very very slow - even a single read every render loop drops the framerate, and I've tried using lockbuffer and readpixelfast - I must be doing something wrong somewhere - any ideas anyone?<br> <br></div><br>The size of the lightmap matters greatly - make it as small as you can bear to see. (EDIT: I'm basing this advice on my experience with kusanagi's technique.) <br><br></td></tr></table><br>
<a name="444991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not using texture flag 256, the LM is just loaded as normal and set to blend in the second UV channel. It is 1024x1024 though - I might try reducing it to 256 or 512 and see what happens. Thanks. <br><br></td></tr></table><br>
<a name="445063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MSW</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Hmm, I'm not sure that volume lightmap program is the correct one - what I saw was a small routine to just return the colour from the lightmap at the position of an entity. I've done this myself with just a few lines, but for some reason reading the pixel colour from the lightmap is very very slow - even a single read every render loop drops the framerate, and I've tried using lockbuffer and readpixelfast - I must be doing something wrong somewhere - any ideas anyone? <br> <br></div><br><br>Upon loading the lightmap, make and store a copy of it in a bank or array...read the colors from there, NOT the lightmap stored in video memory. <br><br></td></tr></table><br>
<a name="445564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Afrohorse</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Upon loading the lightmap, make and store a copy of it in a bank or array...read the colors from there, NOT the lightmap stored in video memory.  <br></div><br><br>I 2nd that! You don't want to be reading texture data directly - oh no!<br><br>In addition, if you're dealing with a character running around a level you only need to store the lightmaps on surfaces the character can walk over. For example, you could only take copies of the lightmaps from polygons with normals that point upwards - this saves quite a lot of memory. To save even more, you don't have to have these 'memory copy' of the textures at the same resolution, you could store them at a lower resolution and interpolate the results. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
