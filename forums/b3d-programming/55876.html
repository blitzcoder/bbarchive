<!DOCTYPE html><html lang="en" ><head ><title >why is TEXT so slow...? and ZOOMing help?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >why is TEXT so slow...? and ZOOMing help?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >why is TEXT so slow...? and ZOOMing help?</a><br><br>
<a name="621776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can half the framerate in SRX just by printing 10 lines of text to the sceen - why is it soooooo slow????<br><br>I'll have to use sprites parented to the camera to display HUD info such as speed, framerate etc.., but for different cameras I have different zoom levels (typically 1.0 to 1.6), and some external cameras having a constantly adjusting zoom to track the car.<br><br>Does anyone know how I can attach and position a sprite relative to the camera so it always appears the same on-screen, no matter what the zoom is set to? <br><br></td></tr></table><br>
<a name="621793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >David819</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure why your frame rate would slow to such an extent, if you put up some code of the text and relative data i might be able to help. I'll have a look about the camera zoom and sprites, i'll post up some code if i come up with anything for you. <br><br></td></tr></table><br>
<a name="621794"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not have a seperate HUD cam that has a fixed zoom? (and render it last of course) <br><br></td></tr></table><br>
<a name="621805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  i'll post up some code if i come up with anything for you. <br></div><br>Thanks Kain. As far as my game code goes, it's just a typical 3d rendertweening game loop with 10 TEXT commands to print a load of stuff, nothing fancy. Without the TEXT commands, I get 60fps, with the TEXT commands I get 30fps. I knew TEXT was slow, but I wasn't expecting it to be THAT slow.<br><br><div class="quote"> Why not have a seperate HUD cam that has a fixed zoom? (and render it last of course) <br></div><br>I don't quite understand - how would I overlay that onto the normal game camera?<br><br>The effect I want to achieve would be same as using LOADIMAGE and then DRAWIMAGE to place an specific sized graphic onto the screen, but from what I remember DRAWIMAGE is slow also and using the 3D sprites is the best way to do this, but the camerazoom thing is messing it up. <br><br></td></tr></table><br>
<a name="621813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >David819</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok i have made some code of you based on Beaker's idea: basically i have created two camera's the main one and one to display the hud with a sprite, i've positioned the hud camera behind the main camera so the sprite does not get in the way of the main camera. here it is:<br><br>Graphics3D 640,480,32,2<br>SetBuffer BackBuffer()<br><br>;create main camera<br>cam=CreateCamera()<br>PositionEntity cam,0,0,0<br><br>;create camera for hud<br>;positions the hud camera behind the main one<br>camdis=CreateCamera()<br>CameraViewport camdis,0,0,128,128<br>PositionEntity camdis,EntityX(cam),EntityY(cam),EntityZ(cam)-1<br><br>;load sprite and make it linked to hud camera<br>spr=LoadSprite("test.jpg")<br>EntityParent spr,camdis<br><br>;create random object ot zoom into<br>sp=CreateSphere()<br>PositionEntity sp,0,0,10<br><br>While Not KeyHit(1)<br><br>If pzo &lt;-3 Then pzo =-3<br>If pzo &gt;-2 Then pzo=-2<br>If pzo2 &gt;3 Then pzo2 =3<br>If pzo2 &lt;2 Then pzo2=2<br><br>; Change zoom value depending on key pressed<br>If KeyDown( 208 )=True Then zoom#=zoom#-0.1<br>If KeyDown( 200 )=True Then zoom#=zoom#+0.1<br><br>; Put a minimum and maximum cap on zoom value<br>If zoom#&lt;1 Then zoom#=1<br>If zoom#&gt;1.6 Then zoom#=1.6<br><br>; Set camera zoom<br>CameraZoom cam,zoom#<br><br>RenderWorld<br>Flip<br>Wend<br>End<br><br>Hope this helps. <br><br></td></tr></table><br>
<a name="621825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, thanks anyway but that's not really the right effect, because the sprite is not overlayed on the main camera, it's in a seperate viewport in the top left.<br><br>Also, I already have 2 cameras (main cam and rear-view mirror) so adding a third is likely to slow things down even more.<br><br>I think what I need to do is position and scale the sprite in such as way as to cancel out the effect of the zoom... <br><br></td></tr></table><br>
<a name="621834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think what Beaker meant is to have a separate HUD cam which you hide when rendering the main scene. Then, you set CameraClsMode to not clear the color buffer, hide the main cam, show the HUD cam and RenderWorld again.<br><br>This method should have very little impact on overall render speed - if any at all. <br><br></td></tr></table><br>
<a name="621837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paolo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Vorderman,<br>I have that same effect with text, but only when I use<br>the VWait command at the end of the code, if I remove<br>the vwait and use only Flip it is back to normal again ... just a thought ...<br><br>Paolo. <br><br></td></tr></table><br>
<a name="621868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> After you putting your Text commands *after* UpdateWorld() and RenderWorld()?<br><pre class=code>
setbuffer backbuffer()
While not keyhit(1)
; do stuff
     UpdateWorld()
     RenderWorld()
     Text x,y,mytext$
     Flip
Wend</pre> <br><br></td></tr></table><br>
<a name="621883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> After you putting your Text commands *after* UpdateWorld() and RenderWorld()? <br></div><br><br>Yes, otherwise the text is overwritten by the 3d update.<br><br><div class="quote"> I have that same effect with text, but only when I use the VWait command <br></div><br>Hmm, I'll try that and see what happens...<br><br>no, makes no difference. I can run 1 or 3 full-physics cars with no probs, but print the FPS and the framerate is halfed. <br><br></td></tr></table><br>
<a name="621900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's an old issue. When it was first discovered the powers that be said that it was a driver issue and that neither ATI or nVidia was responding to inquiries.<br><br>In other words, an issue that must be worked around by using quads with text as you suggested.<br><br><br>Andy <br><br></td></tr></table><br>
<a name="621989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >David819</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, i'll try and have a go at making the sprite adjust correctly for you, i made some code that moved the sprite when you zoomed in and out but it's got quite abit of work to be done on it before it will work correctly. <br><br></td></tr></table><br>
<a name="621995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> What big10p and beaker say is probably the best solution.  <br><br>Basically something like this:<br><br><pre class=code>
repeat

UpdateAllYourGameStuffInHere()
updateworld

cameraprojmode HUDCamera,0
cameraprojmode GAMECamera,1
renderworld

cameraclsmode HUDCamera,false,true
cameraprojmode HUDCamera,1
cameraprojmode GAMECamera,0
renderworld 

flip ;false ;if you want

forever
</pre> <br><br></td></tr></table><br>
<a name="621999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> or use a simple image with maskcolor instead and draw the text to the image only, if something changes. otherwise just draw the image. should be faster than 10 text()-commands even with a screensize-image and you don't have to fiddle around with that sprite stuff! <br><br></td></tr></table><br>
<a name="622032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Vorderman, Youre definitely limiting your framerate- youre screen syncing somehow.<br><br>It might be forced on in the drivers, or you might be using VSync, or FLIP 1.<br><br>Either way, it waits for the next frame to begin before continuing. <br><br>a new frame at 60fps comes every 1000/60 milliseconds. if you miss one frame it waits for the next frame, another 1000/60 milliseconds away. (1000/60)*2=33.3333333, the same as 1000/30.<br><br>Thats what I see anyway. <br><br></td></tr></table><br>
<a name="622046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> The HUD overlay was solved for me by someone (forget who!) providing source for a camera that draws second over the first scene cam. So if the first cam for the game is positioned at 0,0,-100 with range 1000, the UI camera is positioned at 0,0,5000 with range 1000. I think. That's how I did it, but this other system didn't use an orthographic camera as mine did. The scene is rendered, and then the UI camera. Pixel perfect sprites from the archive Pixie system provided textured quads. I use TEXT to write to a quad's texture whenever I want to update the text. <br><br></td></tr></table><br>
<a name="622058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> [quote]<br><br>I'm using the rendertweening framework from the code archives, with VWAIT : FLIP FALSE instead of FLIP, so according to the docs it should be CPU limited instead of GPU limited.<br><br>What base framework do you use? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
