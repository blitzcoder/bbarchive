<!DOCTYPE html><html lang="en" ><head ><title >Exclude a mesh from a light</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Exclude a mesh from a light</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Exclude a mesh from a light</a><br><br>
<a name="847527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have two near lights and a mesh.<br>How to to exclude this mesh from one of the two lights?<br>Maybe tom dll? <br><br></td></tr></table><br>
<a name="847529"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Multipass rendering.  Something like:<br><br>Start of loop<br>Show everything<br>CameraClsMode cam,True,True<br>Hide light1<br>RenderWorld<br>CameraClsMode cam,False,False<br>Hide light2<br>Show light1<br>RenderWorld<br>End of Loop <br><br></td></tr></table><br>
<a name="847532"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes but it would be too slow... :( <br><br></td></tr></table><br>
<a name="847545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> not if done right. take a look at this: <a href="http://blitzbasic.com/codearcs/codearcs.php?code=1246" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=1246</a> <br><br></td></tr></table><br>
<a name="847731"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Set the mesh to full bright. Then use entity color to reduce the brightness of the entity is one way. <br><br></td></tr></table><br>
<a name="847984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://www.dokroton.com/temp/lightproblem.gif"><br>As you can see, every character has to be enlightned by the light of the room he's in.<br>CharD has to stay dark.<br>How many multipass rendering I'd need?<br>Wouldn't the rooms be rendered 3 times?<br>Perhaps I just didn't understand CameraClsMode function? <br><br></td></tr></table><br>
<a name="847987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would render the rooms once, with all the lights on (With cameraClsMode cam,True,True set).<br><br>Then render each character individually, with only the light that's in the same room as he is (using CameraClsMode cam,False,False).  That way you're still only rendering everything once. <br><br></td></tr></table><br>
<a name="847990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> To render every character individually I need to hide the rooms.. right?<br>Isn't Hideentity too slow? <br><br></td></tr></table><br>
<a name="847991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, hide the rooms.  You're disabling clearing of the z-buffer with CameraClsMode after the first render, so the geometry of what's already been rendered will still be taken into account when you render the characters - i.e. if a character is behind a wall, you still won't be able to see him.  Try it and see.<br><br>HideEntity is extremely fast. <br><br></td></tr></table><br>
<a name="847995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok!I'm going to try!<br>Thank you :) <br><br></td></tr></table><br>
<a name="848072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait... So not clearing the z-buffer actually allows you to render meshes behind other previously rendered? Man... i feel sooo stupid now... <br><br></td></tr></table><br>
<a name="848405"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Uhm I have a problem now:the particle sprites are always behind the chars and if I don't hide them, they are rendered 3 times.<br>please don't tell me that sprites don't write on the Zbuffer :( <br>here's my loop:<br><br><pre class=code>
Show level
Hide chars
Show particles
CameraClsMode camera,True,True
*RenderWorld*

Hide Cur_Level
Hide particles
CameraClsMode camera,False,False
Show chars(for light1)
*RenderWorld*

Show chars(for light2)
*RenderWorld*
</pre> <br><br></td></tr></table><br>
<a name="848406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> If they are using a blend mode where you can see through them (they default to add blending) then no they are not written into the z-buffer.  This is why polygons with alpha transparency are sometimes rendered in the wrong order when they overlap.<br><br>I think the solution is to only render your sprites once after everything else.  They will be affected by the z-buffer, they just don't affect the z-buffer themselves. <br><br></td></tr></table><br>
<a name="848536"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I rendered particles after everything else. thx It works.<br>Btw I think there's a problem with this multipass method.<br>Characters are rendered even if they are out of the screen?!<br>Trisrendered() after each *render* outputs as if it drew every character.<br>No more object culling with CameraClsMode camera,False,False ?<br>Forced to use EntityInView? <br><br></td></tr></table><br>
<a name="848650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlagDKT</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh no!The chars cover level alphablended faces... <br><br></td></tr></table><br>
<a name="848757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> They will only be rendered if ANY of the character is shown. In fact, i'm sure it's the bounding box of the character. So even if you can't see any of the character. It's bounding box may be on screen. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
