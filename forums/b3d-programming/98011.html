<!DOCTYPE html><html lang="en" ><head ><title >camera range error workaround...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >camera range error workaround...</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >camera range error workaround...</a><br><br>
<a name="1142049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Slomas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm writing a flight sim with a 3d cockpit <br><br>The problem I've run into is that specifying a camera range 'near' enough to render the inside of the cockpit- will create bad zbuffer errors in the outside scenery/buildings etc.<br><br>The only workaround I have is to render just the cockpit with a near range (and black windows)- grab this as an image- then render just the outside- and then draw the masked cockpit image back on top of that.<br><br>This works, but takes 6 times as long- mostly for the GrabImage command it seems...<br><br>any bright ideas?  <br><br>many thanks in advance, I'll make the sim available when done.. <br><br></td></tr></table><br>
<a name="1142050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Rendering the cockpit to a separate camera would be the usual way.<br><br>You'll have to use cameraclsmode on your main camera to stop it from clearing the color buffer (effectively turn off its built-in Cls). <br><br></td></tr></table><br>
<a name="1142051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is also CopyRect instead of GrabImage.<br>Then you could CopyRect the backbuffer to an image.<br><br>I don't know if it's faster. <br><br></td></tr></table><br>
<a name="1142052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Slomas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> wow, I'd never noticed that command!<br>every day's a school day...<br><br>I'll give it a try, thanks! <br><br></td></tr></table><br>
<a name="1142053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Copyrect is good enough most of the time for realtime useage.<br><br>But I reccomend using the method Gfk mentions. <br><br></td></tr></table><br>
<a name="1142060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can also use entity order. Set an entity order of "-1" or less for your cockpit.<br><br>The entire scene will be rendered, then the cockpit will be rendered last, overlaying everything.<br><br>This way you can keep the camera-near at 1.0. <br><br></td></tr></table><br>
<a name="1142062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Slomas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ahh-  satisfaction at last! separate short-range camera with it's Cls disabled works great- much faster<br><br><br><img src="http://www.planillustrator.com/cockpit.jpg"><br><br>one follow up-  is there any way to simply disable a camera- i.e. for the outside only view?<br><br>interestingly- setting it's range or viewport to 0,0 or very small actually seems to slow things down.... <br><br></td></tr></table><br>
<a name="1142063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That looks like a nice little project you've got going.<br><br>How do you handle the floating point errors that creep in with coordinates at large values from 0? are you moving the whole world about 0,0,0? <br><br></td></tr></table><br>
<a name="1142064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> HideEntity will 'turn off' a camera, as will CameraProjMode, iirc. <br><br></td></tr></table><br>
<a name="1142066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Slomas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks Rroff, good question- I ran into that problem also- the world size is 200,000 x 200,000 - while the needles are fractions in front of the dials<br><br>moving the world around the plane was too counterintuitive for my brain!, so I ended up moving the plane normally- then just re-centering the world around the plane- (and offsetting the plane) every few seconds<br><br>a 2d cockpit would have been way easier- but I'm going for a more real experience-( including the nausea unfortunately!) <br><br></td></tr></table><br>
<a name="1142068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Slomas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gfk- I don't see any documentation for that command-<br>but 0/1 turns it off and on and frees up time- thanks-<br><br>I'm 12 millisecs per loop faster now so I'm good to go! <br><br></td></tr></table><br>
<a name="1142070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you happen to need more juice, use EntityOrder. <br>This would only use a single RenderWorld and would spare the second camera.<br><br>I don't know how you were moving the world at first, but if you parent everything - except the plane - to a single pivot and move this pivot, you should get the same effect. <br><br></td></tr></table><br>
<a name="1142071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> EntityOrder has its uses, but be aware that it will completely ruin any geometry that isn't perfectly convex (or perfectly concave and enclosing the camera. It not only takes the entity out of order but also disables proper ordering for the entity's individual polygons.<br><br>I'm also not really seeing how it would help in this case... the natural ordering looks fine, this looks like strictly a range issue. <br><br></td></tr></table><br>
<a name="1142074"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Slomas</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yasha- yes, I toyed with entity order to try to fix the scenery zbuffer problem- but as you note - you can't apply it to anything that obstructs any part of itself -e.g. the terrain.<br><br>kryzon- one RenderWorld seems to work for both cameras- and I found  no difference in speed at all between one and two cameras rendering the same scene as long as they are working in two separate ranges-(1-50 and 50-50000)  i.e. everything is still just rendered once?<br><br>I'm basing all this on measuring the difference in millisecs() between the start and end of the main loop- just before the Flip, if that's the best way to track processing time? <br><br></td></tr></table><br>
<a name="1142075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> The documentation for CameraProjMode says:<br><br>0: no projection - disables camera (faster than HideEntity)<br><br>(1 is the default setting)<br><br>Never tested it to see if its faster than hideentity tho.<br><br>Only thing I've ever used entityorder on is for rendering stuff as a background and always behind everything else never had any sorting issues with that but its always been fairly simple stuff. <br><br></td></tr></table><br>
<a name="1142087"></a>

<a name="1142088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> actually EntityOrder could be used here to enlarge the near range<br>just by scaling up the cockpit (like *10,*10,*10) then up the near range to "1.0" or more<br><br>But, I'm ok with Yasha for one point :<br>EntityOrder does not like complex polygons<br>and other point not mentionned : if you intend to use alpha/vertexalpha/texturealpha(or anything with alpha) entityorder will not sort the Z-Depth for the polygons and some backface will become visible or worse : the farvest polygons of the cockpit could be seen front of nearest ones<br><br>so : modifying the cameraclsmode should be the best option<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1142096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RemiD</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've had the same problem and your suggestions are interesting to know thanks ! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
