<!DOCTYPE html><html lang="en" ><head ><title >Additive/Blending Problem with background</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Additive/Blending Problem with background</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Additive/Blending Problem with background</a><br><br>
<a name="721788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having some trouble with what I think is additive or blending with the background<br><br>Image:<br><img src="http://i99.photobucket.com/albums/l294/Stormlizard/water.jpg"><br><br>Notice the two red and one blue circles. They blend in black areas with the background. These are .png sprites from photoshop with a MASKED flag applied. The background is a .jpg sprite with normal color flags. <br><br></td></tr></table><br>
<a name="721867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if I get you right. Maybe you're talking about darkish blended contours of the masked textures, like a dark border? This is well known "feature". Since masked textures require to use black as transparent color (even with TGA), and Texturefiltering will kind of blur things (as well as mipmapping does), you will be forced to use <br><br>A) A solution posted in the archives that will paint black texels with a neutral background color while leaving the alpha channel of the loaded mesked texture intact. I have posted such a solution too, not so long ago.<br><br>B) Use the new texture formats DDS, specificly DDS DXT3 with alpha information. You need to cut out the black parts, so they become transparent (not talking about a 4th channel for alpha!). Then select the outline of the masked thing, select border (eg. 4), then blur it (more), so the alpha channel will also be blured and allow directx to use smooth vector curves for the mask contour. In short: use DXT3 with alpha, then load it in mask mode. This is the reccomended way.<br><br>(nvidia offers a free PS export plugin I think) <br><br></td></tr></table><br>
<a name="721980"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'll try to explain better.<br><br>Problem 1) The black borders appear around sprites when another sprite gets close to it.<br><br>Problem 2) In the above screenshot those circle bubble things are supposed to be completely solid no alpha (but they are masked). Why are they looking like I applied an EntityAlpha to them.<br><br>And while i'm at it, what is the best way to make an object turn around and the peak of its flight? <br><br></td></tr></table><br>
<a name="722022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1) I have no idea<br>2) Instead of Loadsprite use CreateSprite, then Looadtexture and EntityTexture sprite,tex.<br>3)"and the peak of his fight"? Not sure what you mean. <br><br></td></tr></table><br>
<a name="722108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh! Yeah! Stupid me, they're not sprites, they're single-surface meshes with textures. Not sure if this changes <br>anything though.<br><br>For the "peak of flight thing" Heres a diagram:<br><img src="http://i99.photobucket.com/albums/l294/Stormlizard/forum_diagram.jpg"><br><br>Hopr this helps. Sorry i'm having to write these pretty fast, haven't had much time lately... <br><br></td></tr></table><br>
<a name="722111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="722113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, what i'd do is use sin/cos. Have an angle variable, and constantly add values to it.<br><br><pre class=code>
Graphics 800,600
setbuffer backbuffer()

Global angle
Global x#,y#
x = 300
y = 200

While Not KeyHit(1)

   cls
   angle = angle + 1
   oval x,y + (sin(angle)*200) ; 200 is just a number to multiple the effect enough to see it.
   flip
wend
end
</pre> <br><br></td></tr></table><br>
<a name="722114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the above code, you would probabl add the sin(angle) effect onto the Y co-ord.<br><br>Another way to do this, would be to have waypoints and make the entity follow a curving waypoint system.<br><br>You could generate the waypoints, based on the entity's position. When it needs to turn, generate a waypoint system. Read it in from data statements or something. <br><br></td></tr></table><br>
<a name="722115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something like this:<br><br>Save your waypoints to a type arrangement, or array, looking something like this...<br><br>www.rosscrooks.pwp.blueyonder.co.uk/waypoints.jpg<br><br>When you decide you want the entity to turn, generate the waypoint's, based on the entities position and orientation, like so:<br><br>www.rosscrooks.pwp.blueyonder.co.uk/waypointplacement.jpg<br><br>Obviously, don't parent them to the entity :oP Just get the entity to follow the waypoints. Let the waypoint control code know when you've reached the last waypoint path. Then let normal control take over.<br><br>Using this method you can have your entities do pretty cool stuff :o) <br><br></td></tr></table><br>
<a name="722247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see what you mean, but I'm not sure if waypoints are fast enough. I mean, I have 5 - 10 objects on screen at one time.<br><br>But really the turning around not's the problem, the transpaerency is. <br><br></td></tr></table><br>
<a name="722253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >b32</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> The dark lines around transparent sprites is a very common glitch. I believe there is code in the archives that deals with that.<br>There is a mask and an alpha flag. Masked textures are drawn without any black pixels. (RGB=0,0,0) About alpha, I think I've read that blitz can only handle 2 alpha steps, on and off, but I'm not sure. <br><br></td></tr></table><br>
<a name="722260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alpha can handle 256 levels of transparency, like rgb, hence 32bit argb.<br><br>When a DXT3 is saved with Alpha and then loaded as Mask in Blitz, the countours will be interpolated, as I said before.<br><br>For the peak thing I'd suggest to use a decreasing gravity variable, something like this:<br><br>jump#=2.0<br><br>while game<br><br>y#=y+jump<br>jump=jump-.1<br>if jump&lt;-2 then jump=2<br>... <br><br></td></tr></table><br>
<a name="722483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suppose I get what you mean. You can't seem to search the code archives. Is what you're talking about, Bram32, recent or is it awhile back? <br><br></td></tr></table><br>
<a name="722535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> What he sais is what I already said before, BTW. Dark outlines on masked textures due to mipmapping.<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1806" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1806</a> <br><br></td></tr></table><br>
<a name="722541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry, thanks. <br><br></td></tr></table><br>
<a name="722547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope. Still not working<br><br>{Edit: Download Removed by Author} <br><br>Sorry about all this, I'm just having a lot of trouble with my coding recently <br><br></td></tr></table><br>
<a name="723074"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Will check this out later tonight. Got to go and get some fresh air ATM. <br><br></td></tr></table><br>
<a name="723177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm currently trying your code. I don't get this fully, do I have to click the rockets somehow?<br><br>You should have say the user has to type in "FireWorks" in the  prompt on startup.<br><br>I see dark borders on the "stage" messages that  are using the mask flag. Or are those masked 2D images? Anyway, in the 3rd level I get an Error, entity does not exist in Function Reload_Back():<br><br>Case 3<br>...<br>MoveENtity back,0,20,-18 ; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt; this fails<br><br>Anyhow, I can't get to the screen with the red and the blue spheres for some reason. So how should I test this? EDIT ok, I was blind, got to tye "Water" instead of "FireWorks".<br><br>I take it you want the spheres to be masked (round shape), but fully opaque in the inner part, right?<br><br>Since you loaded the texture with flag 4, (the OptimizeALphaChannel function does fix the black border problem, but not the transparency problem), I have only one conclusion: the Mesh (quad) that is used by the particle engine must be blended in additional mode, instead of default alpha. I'll check this right now... <br><br></td></tr></table><br>
<a name="723182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> You know, the more I try this, the more I think the bubble.png "sprites" are ok, but the background images, that are sprites too may use additive blending and are layed ONTOP of the bubble spheres? <br><br></td></tr></table><br>
<a name="723187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bingo. You have loaded the background sprites with default texture flag, this seems to be additive. Simply Add the flag 4 to the loadsprite commands for the backgrounds, in the functions "Loadsprites" and Reload_back(). <br><br>Additionally you have to add this line at the end of both functions:<br><br>EntityOrder back,1<br><br>To make sure the foreground is not drawn behind the background.<br><br>This was pretty tricky. <br><br></td></tr></table><br>
<a name="723189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about this: now that I helped you to fix this, may I use your "fire.jpg" sprite? That's a nice one. <br><br></td></tr></table><br>
<a name="723198"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fuller</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually that's from a royalty free (I think) sprite pack included in the Devil Particle system.<br><br>You can download it from his website. Lots of nice sprites.<br><br>And About the typing stuff in, that's just temporary till I get GUI going. The Error after level 3 is becuase I didn't make a "level 3" sprite.<br><br>Thanks for your help! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
