<!DOCTYPE html><html lang="en" ><head ><title >rs232</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >rs232</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >rs232</a><br><br>
<a name="307478"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> is there anyway to talk via the com port ? want to make a demo motion platform and use blitz3d.<br><br>thanks<br><br>Matt <br><br></td></tr></table><br>
<a name="307547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok found it .. you just do :<br><br>fileout = WriteFile("COM1") <br><br></td></tr></table><br>
<a name="307555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> nope , thats not what i needed , as i need to set baud rate etc... <br><br>anyone used the BuildCommDCB() API before ?? come on guys ?<br><br>Matt <br><br></td></tr></table><br>
<a name="307556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RepeatUntil</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really?? This works?? Very nice tip!!<br><br>  Did you really check that you were able to write data to COM1??<br><br>EDIT:<br>Sorry! I didn't see you third post... It would be too simple!! <br><br></td></tr></table><br>
<a name="307564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> i am pretty sure it does work , but i dont know what baud setting it defaults to .. you dont have any controll over it. ( well not that i can see) just looking into dll's that do it at the moment.<br><br>Matt <br><br></td></tr></table><br>
<a name="308046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maverick</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can open the com port as a file and you can specify the baudrate it opens too also as part of the filename.<br>I can`t remember exactly what the file name is but i think it was WriteFile("comnumber:baudratehere,8,N,1") or something similar . I have used this method in the past and it works fine for output at whatever baud rate you like upto the port maximum,,,, BUT do not try to read from a serial port in the same manner , it crashes blitz quicksharp.<br><br>The other alternative is to use a DLL which is a far neater way and allows you to read and write to the com ,, plus other goodies like setting the buffers and hanshaking ect :-) Thats the way I do it <br><br></td></tr></table><br>
<a name="308336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks maverick , there must be somthing wrong my end , it seems to work , ie locks the COM port so no other app can use it , but the STAMP2 PIC processor that i have connected to the serial port is not picking up the commands , (it works if i use windows terminal program)<br><br>thanks<br><br>Matt <br><br></td></tr></table><br>
<a name="308390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maverick</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> the best way to check that it is working is to use a null modem rs232 lead (can get em for a couple of quid in maplin if your uk) and connect com1 to com2 on your computer ,then run hyperterminal on com2 and use com1 on your blitz program, anything sent in blitz then shows up in hyper terminal.<br><br>If your not bothered about that a window pop`s up when the com is opened I have a DLL that i have written a userlib interface for that lets you have full controll over the com port. The only limitation is the popup when the port is initialised this can be removed by paying for the comertial version of the DLL <br><br></td></tr></table><br>
<a name="308399"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> i think the dll's sounds like the one i saw , i would love to have a copy of it , plus your userlib's , email mg@...<br><br>will give you full credit<br><br>thanks<br><br>Matt <br><br></td></tr></table><br>
<a name="308609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maverick</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok your the second person to ask me for the userlib I`ll write a little how to use instruction text then send tt too you . I can only provide you with the shareware version of the DLL (the one with the popup) as I am using the full DLL under a license and although I CAN distribute it with my programs I am not allowed to distribute it with Scource code. The functionality, use and ureslib of the lisenced version is IDENTICAL to that of the shareware version the only difference being a popup when initialising the port. <br><br></td></tr></table><br>
<a name="308636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maverick</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ****Big sorry`s*****<br>I just downloaded the latest Shareware version of the RS232 DLL and it has been changed to a 90 day trial as opposed to a popup window and no limitations.<br>Also after studying the release TXT the has been a function added to the DLL called SioGetCode but for some reason Blitz doesn`t want to see this function.<br><br>I will contact the authour of the DLL and enquire about this. <br><br></td></tr></table><br>
<a name="308848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MattG</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok cool maverick , i dont mind about the 90 day trail .. if it works i will buy it , but is it possible to send what you have at the moment (eg popup etc) as i would love to see if my stuff will work ... but if you want to doc it etc ... i can wait......<br><br>thanks again<br><br>Matt <br><br></td></tr></table><br>
<a name="309200"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >maverick</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi yes after consultation with the authours I have got the new version of the DLL working correctly. I am going to document this properly and add the modem function I didn`t bother with in the decls the first time round.<br><br>I`m also going to change the function names to make it a little more freindly. <br><br></td></tr></table><br>
<a name="309816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zenith</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, the default settings of your com ports are set within the device manager in windows, just open up the Ports (COM &amp; LPT) label, then double click one of the ports to edit its settings. (all of the settings are there I think) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
