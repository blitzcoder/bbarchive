<!DOCTYPE html><html lang="en" ><head ><title >Debugging Multithreaded Programs</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Debugging Multithreaded Programs</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Debugging Multithreaded Programs</a><br><br>
<a name="1109671"></a>

<a name="1109672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xtremegamr</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I first started messing around with FastPointer, I used it to make multithreaded web servers. That's cool and all, but now I want to try and incorporate it into a game project.<br><br>However, I've run into a pretty serious problem with debugging; I've been finding that either the program will run perfectly, or it will just crash with no indication as to what is wrong.<br><br>So my question is, is there any feasible way to debug and track down errors in multithreaded Blitz programs?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1109687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well your biggest obstacle is that the debugger flat-out won't work with them (this isn't unique to multithreading: the debugger won't work with code called via function pointer anyway - although not being designed for multiple threads means that would likely be a problem too). So you're limited to printing debug messages at strategic points in your program.<br><br>Three things come to mind:<br><br>1) Does Print work? I haven't tested it, so don't know what kind of havoc might result from two threads trying to print at once (obviously only relevant if Print is usable in the context of your graphical setup).<br><br>2) Similarly, if multiple threads can be forced by DirectX to play nice when accessing the graphics object, you could just have a different horizontal alignment for the data from each thread when using a very simple Text debug display over your graphics. Again, I haven't tried, to see if this even works.<br><br>3) A more complex solution might be to roll-your-own Debug console. You could use a second application as a listener, and have each thread connect to it with a network stream or something, and write debug messages to the streams (to then be displayed by the second process). Since such streams are designed to work between multiple machines it would work as a brute-force way to reintegrate the messages into a single thread for easy display.<br><br>4) Uh... don't use multithreading in commercial Blitz3D code. Seriously: the feature isn't reliable and doesn't work properly with the language in any way. If you need multithreading for something you intend to release, you should seriously consider using some other language. (Obviously though, for personal projects, the impossible should never be an obstacle.) <br><br></td></tr></table><br>
<a name="1109705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xtremegamr</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does Print work? <br></div><br>Print DOES work -- It's just possible to get messages that are smashed together when 2 threads access the thread stream at the same time.<br><br>For example, in Thread 1:<br><pre class=code>Print "Hi Yasha!"</pre><br><br>and in thread 2:<br><pre class=code>Print "Hi xtremegamr!"</pre><br><br>sometimes results in:<br><pre class=code>
Hi Hi Yasxtremegamr!
ha!
</pre><br><br><div class="quote"> ..using a very simple Text debug display over your graphics... <br></div><br>I haven't tried using Text from multiple threads before, though. It seems like a pretty good idea.<br><br><div class="quote"> A more complex solution might be to roll-your-own Debug console... <br></div><br>I've tried this, too. It works pretty well...assuming that the program doesn't randomly crash.<br><br><div class="quote"> ...don't use multithreading in commercial Blitz3D code <br></div><br>Meh. I guess that this is true, given all of the hacks\workarounds I have to use to debug. I'll probably end up learning the DirectX or OpenGL API's and switching to C++ eventually, anyway.<br><br>Thanks for the help!<br><br>P.S. That was four things :P <br><br></td></tr></table><br>
<a name="1109729"></a>

<a name="1109730"></a>

<a name="1109731"></a>

<a name="1109732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rroff</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need a very good understanding of how threads work to use fastpointer for threading safely especially the async nature of threading and access to resources, IO and variables i.e. 2 threads trying to read/write a value to the same location at the same time cause all kinds of issues.<br><br>Been very thankful for fastpointer tho lately as I decided to use the OS console for debugging purposes (kernel32 function AllocConsole()) and the kernel32 function ReadConsole() halts main thread execution until certain input rules are met, so I threaded that using fast pointer :D (my game engine accepts commands typed into the console window as well as the ingame console when in developer mode - its handy for testing stuff before the ingame UI is setup)<br><br>EDIT: For anyone interested AllocConsole() only works from a compiled exe and won't work when the code is run from the blitz IDE.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
