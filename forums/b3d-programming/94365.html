<!DOCTYPE html><html lang="en" ><head ><title >Surface order changing</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Surface order changing</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Surface order changing</a><br><br>
<a name="1082459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rgdyman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been using blitz3d for a while now. This is my first post.<br>I have been able to solve or simply find any questions I may of<br>had in the past by trial and error or finding the solution here <br>on the forums. This one has got me scratching my head for days<br>now and could really use some help.<br><br>What I have is a mesh with 4 surfaces. The idea is to choose a <br>surface using the mouse or a ComboBox. The ComboBox has<br>the name of the surface, ( Head,Body,Legs,Feet )<br><br>You select a surface and place a texture on that surface.<br>It's a simple "Build your own character" .<br><br>The system is fully functional. However, the "surfaces" will be in the <br>proper order only when I am running it from Blitz3D. When I run it<br>from a .exe the surfaces get all messed up. <br><br>The head is now the fee, the feet are now the body......<br><br>Is there something I maybe missing when I create the .exe?<br>Im very confused on this one.   Any help would be a life saver,<br>Thanks in advance. <br><br></td></tr></table><br>
<a name="1082462"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you loading the mesh from a file? If so, I believe the loading order may not be guaranteed to stay the same (not sure where I got that idea, but I definitely remember it from somewhere).<br><br>Anyway, if you always know that the model will have four surfaces and that they will be one of those listed above, you could simply devise a test to tell which is which and swap them around to the correct variables for the combobox?<br><br>If it's important that they're in a particular oder on the mesh, you will have to rebuild the mesh using surface and vertex commands. There's no way to delete a surface once it's added, so you have to create a new mesh and copy them over in the right order instead. <br><br></td></tr></table><br>
<a name="1082479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rgdyman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the reply. <br><br>I am loading form file, "Press the Load button and select the b3d mesh<br>you want." It loads in.<br><br>considering the textures will change constantly , seeking a texture name<br>to determine the surface wont work. <br><br>Using surface and vertex commands to rebuild things. Thats all new to me,.<br>Im not afraid of seeking the examples and\or forum tips along with some trial and error. ( Tend to learn a lot from that anyway) But, is that the <br>trail I should follow? <br><br>Basically, what Im asking is, In order to guarantee that the "Head" surface remains the "Head" surface for all eternity so when I select<br>"Head" in the combo box I will be retextureing the "Head"<br>I have to learn how to use surface and vertex commands to rebuild the <br>mesh? <br><br>All else fails, I could get the folder the tetuxre came from and see if its <br>"Head" , if so then carry on, if not, then place on the side, Or create a type  . Field BodyPart() . field surface.<br><br>( the idea just came to me now about the type ) <br>Then when Place Tetxure is pressed , sift the Type and find the proper surface.... Well I know to well how "Ideas" tend to crash and burn<br>with that old thought of " Hmmmm,, why that happen?"<br><br>Again, Thanks for the help and tips. <br>In advance, thanks for any further tips or a nice nudge in the right direction  :) <br><br></td></tr></table><br>
<a name="1082480"></a>

<a name="1082481"></a>

<a name="1082482"></a>

<a name="1082483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can also use the vertex count as a test to find out which surface you're dealing with (I wouldn't like to do this either, but it might be the only reliable way). If only surfaces had a 'Name' property.<br><br>You need to make sure each one has a different vertex count, even if you have to add dummy vertices in your modelling software just to make each one different.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1082487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the only thing that's changing is the texture, it may be worth ignoring the surfaces and just playing with the textures.<br><br>The way I would handle this is with a minor design change to use a "texture atlas" instead of multiple textures on multiple surfaces. Simply move the UVs for each current surface into one of the four corners, and make the whole model a single surface. Then give it a texture four times the size, with each of the four textures you want copied into one of the four quadrants of the large "atlas" texture.<br><br>You'd probably have to leave it untextured until it got into the program, then create the atlas from the required four smaller textures and apply it to the whole model. Each time you wanted to update a single area, instead of retexturing a surface, you'd just CopyRect the desired source texture to the relevant quadrant of the individual model's atlas (and it will update in real time without needing to EntityTexture again). You'd be able to rely on UV coordinates not to change at runtime, so you could set the selection that way.<br><br>... maybe. <br><br></td></tr></table><br>
<a name="1082488"></a>

<a name="1082489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rgdyman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, vert count. <br><br>100=feet<br>200=body<br>600=Head<br><br>Interesting idea. Never thought of that.....The meshes are both default. So the vert count will never change.<br>Rather cool idea Kryzon, Seems fast and to the point. The main issue is<br>New Meshes. A child for instance. Diff mesh. same surface count.<br>But vert count is interesting. I'll run with that for now and see how she runs. Naturally, only using the one Male Mesh things will run perfect<br>for the fact verts have not changed. Hopefully a new idea using this<br>principle will help me along the way with new Meshes being used,<br>And YES, a "Name" for each surface be a life saver. <br><br><br> After many hours of aggravation , I finally came here and posted.<br><br>Thanks for the  ideas, pointers.. Nice to have the help :)<br><br>EDIT: Yasha posted as I was slowly typing away....<br>Yasha, That I will have to read a few times and try things until I grasp it first hand. Seems confusing :P,.,probably isn't once I see it first hand,<br>but that was one confusing read lol.... But, its stuff like that that gets me to have something to search about. Confusing yes, but  Informative.<br>Thanks! :)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1082500"></a>

<a name="1082501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you use the parts as objects instead of surfaces?<br><br>Break the mesh up into seperate objects and name then in whatever program you built it in, then export to B3D and load into Blitz as an AnimMesh, then locate the various objects using their names and the FindChild command.<br><br>You can then just manipulate the single surfaces on each of the different objects rather than 4 surfaces on 1 object.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1082508"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry my suggestion wasn't clear. Maybe a diagram...<br><br><img src="http://img852.imageshack.us/img852/4776/atlas.png"><br><br>It requires doing a few things differently in the modeller: don't put a texture on the model there, and scale each of the surfaces' UVs to 1/4 of the texture map. Then move each one to their respective quarter of the map. Add them all to the same surface and export.<br><br>Once in B3D, make a new texture with CreateTexture that's the size of all four subtextures combined, and apply it to the model. Now all you need to do is copy the source texture you want for a given body part to the right quarter of the model's view texture, using CopyRect.<br><br>The important point being that since you moved the UVs for each body part yourself, you know for certain which quarter they're in, and you don't have to mess about with surfaces or brushes at all, which is good for efficiency (if efficiency is a concern).<br><br>For the record I actually think Vorderman's idea is better, but I just wanted to clear up the explanation. <br><br></td></tr></table><br>
<a name="1082513"></a>

<a name="1082514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rgdyman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yasha, After reading your post a couple times it did come clear. The diagram summed it up, Thanks!.<br><br>I went ahead and tried the vert counting, Things ran perfect.<br>Naturally, using any other mesh will result in surface selection<br>changing if the verts do not match he coded counts.... Works<br>but a tad limiting.<br><br><br>I need to have my hand at the UV'ing method. Makes sense so its<br>one foot forward.<br><br>I did code in surface selection using the mouse. To my surprise,<br>I can select each surface . However, you cant "see" what selection<br>was made. I tried to set entityfx to 2 and have the vert color change to<br>red in hopes to highlight the surface chosen.  The entire mesh turned red so it appears I simply goofed the entire code up...<br>Of course when I was typing this I had the felling the entire time that it<br>cant be this easy... :)<br><br><pre class=code>
If MeshEN &gt; 0 And surfacechosen &gt; 0 
		
        EntityFX(MeshEN,2)
		
	verts=CountVertices surfacechosen
		
	For v = 1 To verts
		VertexColor surfacechosen,v,255,0,0
	Next 
EndIf 
</pre><br><br>Is there a way to toggle each surface coloring to highlight the selection?<br>Thanks , yet again :)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1082521"></a>

<a name="1082522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try setting all vertices on the mesh:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
If MeshEN &gt; 0 And surfacechosen &gt; 0 
		
    EntityFX(MeshEN,2)

	For i = 1 To CountSurfaces(MeshEN)		
	
		surf = GetSurface(MeshEN, i)		
		verts=CountVertices(surf)
		
		If (surf = surfacechosen)
			r = 255
			g = 0
			b = 0
		Else
			r = 255
			g = 255
			b = 255
		End If
		
		For v = 0 To verts-1
			VertexColor surf,v,r,g,b
		Next 
		
	Next
	
End If </textarea><br>Else, beside 'EntityFX' there is also 'BrushFX'. If each surface has its own brush attached (PaintSurface), <br>you can use BrushFX to toggle vertex colors mode for each individual surface.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1082558"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rgdyman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Warner, <br><br>I cant believe  just did what I hate most and did a copy/paste job,<br>But that little snip of code works perfect!<br><br>I cant thank you enough!<br><br>Now I can just highlight the surface selected. No need for the combo box<br>or any of that... This is GREAT!<br><br>Thanks to everyone that jumped in to help me out. I wish I would of came here a while back for trouble I have had. I think I will back the project up and have my hand at the other ideas anyway. Just to get a feel for the different ways I could of achieved this whole thing. Worst case I might learn a little something new , lol. <br><br>Thanks again everyone! <br>rgdyman <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
