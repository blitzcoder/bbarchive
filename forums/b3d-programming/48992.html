<!DOCTYPE html><html lang="en" ><head ><title >MouseZSpeed stuff and window losing focus</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >MouseZSpeed stuff and window losing focus</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >MouseZSpeed stuff and window losing focus</a><br><br>
<a name="544982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure that many people here have noticed this problem.<br>Whenever the Blitz Runtime Window loses focus, MouseZ() resets to 0, causing MouseZSpeed() to mess up. In programs where rolling the mouse wheel causes the camera to zoom, for example, this is a problem because it means that it will reset the camera's zoom.<br>Does anyone know how to fix this problem? <br><br></td></tr></table><br>
<a name="545155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure if we're discussing quite the same problem, but I can tell you that I have to FlushMouse quite often, since MouseZspeed will still be incrementing even when the mouse is outside my window. So as often as I can (screen changes, view mode changes) I do this:<br><pre class=code>
;---------------------------------
Function zFlushMouse()
;---------------------------------
Local mzs#
	FlushMouse
	Repeat
		mzs# = MouseZSpeed()
	Until mzs# =0
End Function
</pre> <br><br></td></tr></table><br>
<a name="545166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rhyolite</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The other method is to reset the mouse coordinates to centre of screen.<br><br>Rhy :) <br><br></td></tr></table><br>
<a name="545196"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not working for me :(<br>I just came up with a silly but perhaps possible solution though. It needs a lot of that crazy windows stuff that I'm obsessed with.<br>The camera only zooms if a mouseZ message has been sent to the main window, but MouseZSpeed is checked every frame.<br><br><br>(Off topic: My program now has three ways to zoom the camera in and out) <br><br></td></tr></table><br>
<a name="567015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Pickford</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have this problem.  Lose focus and my game camera zooms right in to the max.<br><br>Has anyone solved it?   All I can think of at the moment is to detect big sudden jumps in the mouseZ and recalibrate.<br><br>Is there a way to detect loss of focus?  That would be ideal. <br><br></td></tr></table><br>
<a name="567226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use BlitzSys to get my window handle, then constantly check:<br>If hWnd &lt;&gt; GetActiveWindow() ; User32.decls I think. <br><br></td></tr></table><br>
<a name="567262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Even detecting loss of focus hasn't worked perfectly for me though. Perhaps its my own fault with that, but I don't think it is :( <br><br></td></tr></table><br>
<a name="567445"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> On Loss_of_focus, set a flag.<br><br>on gain_of_focus, check that flag and immediately check MouseZspeed() if its set. This results in the single erraneous value being used up by the check you threw in. then, reset the flag. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
