<!DOCTYPE html><html lang="en" ><head ><title >Raknet question</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Raknet question</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Raknet question</a><br><br>
<a name="666858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using Raknet in my program and it's coming along very nicely. I've just started doing some multiplayer testing with several clients and have noticed some errors, due to my newbie programming behaviour, so I'd appreciate any help here.<br><br>Here's basically what's happening. When a packet comes in from a client and the server just needs to respond to it, it all works fine, because I can just take the client connection from the packet and respond to that connection.......<br><br>But sometimes I need my server to send out signals to connected clients based on various events that have happened. In these cases, the server doesn't have access to a packet, so it can't get the connection from a packet. To solve this (I'm sure there's an easier way), when the client first connects, I stored it's connection data in it's type, using the command......<br><br>p\Connection=RN_PacketGetPlayerID(packet)<br><br>So later on, when I need to send anything to that client without a packet to respond to, I send it with a line such as ......<br><br>RN_ServerSend2(Server,BitStreamOut,HIGH_PRIORITY,RELIABLE,0,P\Connection,False)<br><br>Unfortunately, this doesn't work. It seems to be sending the messages out to the wrong clients or something because it's all becoming garbled at the client end.<br><br>Is this the best way of achieving this? Is the original line for storing the connection correct?<br><br>Any help from Raknet users would be much appreciated :) <br><br></td></tr></table><br>
<a name="666872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Farflame. I am the creator of the wrapper. Happy to know there are some users :)<br><br>What you are doing is fine. The PLAYER ID is basically a struct storing ip and port. and the funcion getplayerid returns a pointer to such struct. When are you calling getplayerid?. You should do when the server receives ID_NEW_INCOMING_CONNECTION packet.<br><br>What version of the wrapper are you using? <br><br></td></tr></table><br>
<a name="666890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Kurix. Yep, still using Raknet, brilliant wrapper. I emailed you earlier, have you altered your email address?<br><br>I'm using 0.7. I did try a newer version around Xmas but it was unstable so I backtracked to 0.7.<br><br>Here's my function. I've removed a few irrelevant bits, but does it look correct?<br><br><pre class=code>
Function NetworkUpdate()
	packet=RN_ServerReceive(Server) ; Read any packets received by the server.
	While (packet)
		
		; Then get the message information from the packet.
		Message$=RN_PacketGetData(packet)
		MessageID$=Mid$(Message$,1,1) ; Get the header

		; The message type is now stored in 'MessageID$'
		Select Asc(MessageID$)
			;--------------------------------------------------------------------------------------
			Case ID_NEW_INCOMING_CONNECTION
				; A brand new connection just contacted the server. Set up a clean user.
				p.pdata=New pdata
				p\NetID=RN_PacketGetplayerIndex(packet) ; Make a copy of the player index into
				;p\NetID so that future packets can be matched up with the correct player data.
				p\Connection=RN_PacketGetplayerID(packet)
</pre><br><br>Does that look correct? <br><br></td></tr></table><br>
<a name="666893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, is the latest version now stable? I'll upgrade if you're confident that it's stable. <br><br></td></tr></table><br>
<a name="666972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mmm, it should work. I will try it later, and if i can make a sample i will email it to you! <br><br></td></tr></table><br>
<a name="666993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sir Gak</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Umm, what's a wrapper (other than the plastic that comes around packaged goods)? <br><br></td></tr></table><br>
<a name="667064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Definition from WikiPedia:<br><br>"The wrapper acts as an interface between its caller and the wrapped code. This may be done for compatibility, e.g. if the wrapped code is in a different programming language or uses different calling conventions, for security, e.g. to prevent the calling program from executing certain functions, to provide a level of emulation, e.g. a DirectX API which hides the functions of the video card driver. The implication is that the wrapped code can only be accessed via the wrapper. " <br><br></td></tr></table><br>
<a name="667178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Farflame</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the case of Raknet, Kurix has 'wrapped' the original C++ code into a Blitz wrapper, so you can now use Raknet in Blitz3D using Blitz-type commands. And a damn good job he's done of it :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
