<!DOCTYPE html><html lang="en" ><head ><title >Scalemesh memory access violation</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Scalemesh memory access violation</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Scalemesh memory access violation</a><br><br>
<a name="336491"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys,<br><br>Ran into a weird problem, I have a program that I previously use the scaleentity command, but now I want to replace it with the scalemesh command.  It's only called once per entity.  Anyway, when I swapped the code from scaleentity to scalemesh, I get a memory access violation.  This doesn't make much sence to me because the other function worked fine.  Any ideas? <br><br></td></tr></table><br>
<a name="336503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you turned debug on to give you a better idea of what the error is?<br><br>It's possible I'm barking up the wrong tree here but ..<br><br>Have you got an original mesh which you take copies of and then apply scaleentity to?  If you've done this and then freed the original the scalemesh command will still be trying to access the orignal entity.   Maybe try using copymesh. <br><br></td></tr></table><br>
<a name="336507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe it's something to do with you using copyentity then scalemesh? <br><br></td></tr></table><br>
<a name="336552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Graphics3D 800,600

camera=CreateCamera()


cube#=CreateCube()

ScaleEntity cube,1,1,1

;ScaleMesh cube,1,1,1 ;run this line to get a MAV =)

While Not KeyHit(1)
RenderWorld()

Text 0,0,"program running"
Flip
Wend
</pre> <br><br></td></tr></table><br>
<a name="336559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> cube#=CreateCube() !!<br><br>tsk, tsk, cube%=CreateCube() <br><br></td></tr></table><br>
<a name="336564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> make sure you assign stuff like meshes as integers, they aren't floats. <br><br></td></tr></table><br>
<a name="336580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually the model is a b3d file, but I'm sure that doesn't make any difference.  I tried it in debug mode but I get the same error.  My program is rather large now.  It could be something from somewhere else. <br><br></td></tr></table><br>
<a name="336608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Craig:<br>As peter said, NEVER EVER assign a handle to a floating point variable.  Remove the # at the end of the variable name when you create the cube.<br><br>Additionally, if you still have the problem loading the B3D file, perhaps it's possible the file contains pivots or lights?  I haven't actually used the B3D format much myself so I don't know if it can have NON-mesh entities contained in it.<br><br>It might be that a B3D mesh which has children and such has a pivot as the root entity... the parent entity, and that would be the one you're accessing when you use the handle.<br><br>Use countchildren on the entity after you load it, and see if that returns a number greater than 0.  If so then the problem may well be that the root mesh is a pivot.<br><br>That is, asusming that the problem isn't just that you used a floating point variable to store the handle. <br><br></td></tr></table><br>
<a name="336643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>cube#=CreateCube() !! <br><br>tsk, tsk, cube%=CreateCube() <br> <br></div><br><br>That was the point of my post lol, I was trying to be subtle ^^ <br><br></td></tr></table><br>
<a name="336668"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found my bug, it was in a different part of my code.  It was trying to pass a camera entity in there.  Like I said, the code was getting pretty big.  Easy solution though. <br><br></td></tr></table><br>
<a name="336673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, I have quite a challenge ahead of me.  My code has many entities parented to each other.  The shadow lib only casts on rotatemesh and scalemeshed entities.  I'm assuming rotatemesh and scalemesh will not effect the children of that entity in the same manner as scaleentity and rotateentity.  Unless I'm misstaken. <br><br></td></tr></table><br>
<a name="336688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> One entity parented to another is fine.  YOu just have to pass the right pointer to the shadow system.  You passed the pointer to a parent which was a camera apparently.<br><br>The system does not automatically shadow children of the entity you pass it for this very reason.  So if you pass an entity that has a camera as a child it should work fine.  <br><br>But I won't make any guarantees. :-)<br><br><br>"I'm assuming rotatemesh and scalemesh will not effect the children of that entity in the same manner as scaleentity and rotateentity."<br><br>They will not.  But you could scale the children individually.<br><br>Why do you have children of an entity receivign a shadow?  Does your level have children for doors and chairs and things? <br><br></td></tr></table><br>
<a name="336690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Function Recursive_Shadow_Entity_And_Children(Entity)

	Cast_Shadow(Entity, 128)

	For Loop = 1 To CountChildren(Entity)
		
		ThisChild = GetChild(Entity, Loop)
		Recursive_Shadow_Entity_And_Children(ThisChild)
		
	Next

End Function
</pre><br><br><br>That function recursively applies a shadow to a mesh and all its children.  You can easily modify it to instead apply a scalemesh to a mesh and all its children.  All you need do is give the function three additional paramaeters for x y and Z scale and pass them on to the function again inside the loop so subsequent calls get the scale too.<br><br>One more thing... If you look in the versions.txt for Blitz3D, you will see information on a new command which was added a few versions back that tells you what kind of entity a particular entity is.  You can use this information to make the function not apply a scalemesh to a non mesh entity.  You could also modify the function above to not apply a shadow to a child entity as well.<br><br>I highly reccomend though that you not set every object in your level to receive shadows.  The system is probably not capable of handling that, though I suppose if you set up your lights very carefully you _might_ get away with it. <br><br></td></tr></table><br>
<a name="336712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got the shadow system receiving great on entities that are completely static with no children.  What I've been writing is a LW scene to Blitz Entity placement and system.  I intend to use this to construct my levels for my game projects.  As it stands, it imports position, rotation, scale, and animation on all the above for all the items in the Lightwave scene.  This include the entity hierachy structure.  This is mostly done and it works!  As it stands, it is possible to have static mesh geometry that is in a heirachy of entities, and since it's an editor system, I don't want to put too many limitation on the form in which the level has to be constucted.  I am considering unparenting the entities in world space and doing the meshrotate and meshscale from that point.  I would prefer to retain the original hierarchy, but if it causes too much trouble, I guess I'll have to work around it.  Either way, I'm pretty happy with the results as it stands right now. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
