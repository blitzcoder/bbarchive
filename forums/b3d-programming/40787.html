<!DOCTYPE html><html lang="en" ><head ><title >Feature Request: EntityGroup()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Feature Request: EntityGroup()</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Feature Request: EntityGroup()</a><br><br>
<a name="458709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's probably a good reason why we can't have this or else we would have it already, but if you don't ask you don't get and at least I've taken the trouble to find a way of organising it.<br><br>What I'm talking about is an end to having to mess around with this silly surface limitation Blitz has. Now I haven't done any programming with DX, but as I understand it, you render objects individually, and reset the texture state ( there's probably a real term for this ) between rendering objects with different textures. But for whatever reason, Blitz resets the texture state every single time, whether it needs to or not.<br><br>So what I'm suggesting is to have entity groups. Every entity defaults to zero for compatibility, but can also be assigned an entity group. Then when you call RenderWorld, Blitz goes through the groups, only resetting texture state between groups. So if I have ten cubes with share a brush ( and therefore texture ) I can give them all an EntityGroup() of 2 and they are all rendered without the texture state change. Then Blitz resets the texture state and goes onto group 3 and so on and so forth.<br><br>With the default of zero, it shouldn't break any code, and if people assign two objects with different brushes to the same entity group, it's their own stupid fault if their sky has the same texture as the ground. It wouldn't break or crash, and the problem would be obvious to them and easy to fix. <br><br></td></tr></table><br>
<a name="458785"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'm surprised it doesn't at least sort by brush when rendering.  i guess because each object can potentially have a different brush, as they are created "on the fly" for each object, that sorting would not really give much of an advantage.  <br><br>if i had my way, you'd have to create a brush for every different visual property.  a little more work, but it really speeds things up when you've got 200 or 300 objects with the same brush, and you only need to set the visual properties once for all of them.<br><br>sad thing is that none of this will ever happen. <br><br></td></tr></table><br>
<a name="458795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> if i had my way, you'd have to create a brush for every different visual property. a little more work, but it really speeds things up when you've got 200 or 300 objects with the same brush, and you only need to set the visual properties once for all of them. <br></div><br><br>That was my first thought. Then I thought, well Mark would have to keep track of the brushes in code, and maybe there's a reason he can't or doesn't want to, so I came up with the idea of us doing it manually. If Mark would prefer to enforce upon us the use of brushes and handle it that way, I'd be perfectly happy with that instead. But this faffing about with surfaces is a joke. <br><br></td></tr></table><br>
<a name="458932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem is, entities can and do consist of more than one brush/material set up, even within b3d. So it would really have to be a case of Surface Group.<br>I mean take your average character. 1 texture for head, 1 for body etc, no real way to sort by entity.<br><br>It's certainly possible though, batches in vivid are essentially this, you can add surfaces/entities/shared surfaces and it sorts the surface list internally and renders by material(I.e whatever order/entities the surface are in, if they're copied..only 1 change required to render them all)<br>And, considering it speeds up your average scene by about 50% it can be vital.<br><br>I'd say b3d doesn't have it because to actually sort these lists isn't THAT fast. Throw in a dynamic scene and it would be a nightmare, when based around a single scene list as b3d is.<br>So..the bmax engine he's planning will be ideal probably, but not b3d in it's current state. <br><br></td></tr></table><br>
<a name="459076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fair point about multiple surfaces per entity, that would have to go if you changed it, and that would break code, so that's no good.<br><br>The sorting question is the one I was trying to avoid. If there was a way for us to manually pick which objects were rendered when, it wouldn't be an issue for Mark to take care of internally.<br><br>Perhaps a RenderEntity() command so we can render just what we want in the order we want? Something needs to be done. Single surface workarounds are fun and challenging to code, but they're not the answer for every situation. <br><br></td></tr></table><br>
<a name="459090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Render_Entity alone wouldn't give any advantages, unless mark also added control when texture locking.<br><br>How I did it was, simply create a batch type, each batch element = pointer to surface and a pointer to the entity it's being referenced from.<br>Now, you just sort by surface, and still retain per-entity attribs. Basically,<br><br>for each batchObj<br>    if bat\surf&lt;&gt;lastSurf Locksurface:lastSurf=bat\surf<br>    lockEntity bat\ent<br>    renderSurface bat\surf<br>next<br><br>And you sort before hand.<br><br><br>a cooler way, which I'll probably implement in vivid having just thought of it, is for each surface, generate a 8/12 byte buffer, each 4bytes = texture handle int, and generate a CRC from that.<br>Now for each surface, you have a single unique int for it's texture set up.<br><br>But since it's a crc, you can do cool things, like sort by any data value you'd like.<br><br>Say you wanted to share surface locks that share texture binds AND a entity name.<br>Insert the entity name into the buffer, then the texture look ups, then generate the crc for each one.<br><br>Right, i'm off to implement that in vivid..hands off mark ;) <br><br></td></tr></table><br>
<a name="459188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> "The problem is, entities can and do consist of more than one brush/material set up, even within b3d"<br><br>then you'd just change the sorting from per-entity to per-surface, right before rendering.  call some kind of a "buffer" function on each surface, which would stick it into a dynamic array at the correct position.. then render the dynamic array.  not sure how fast it'd be, but i've been thinking about doing that in my engine to see.  unfortunately i won't have time to try it until christmas.. <br><br></td></tr></table><br>
<a name="459197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Almost anything can be done when performance isn't taken into account. But compared to seperate pre-sorted(and post-sort sorted by adding to already existing 'runs') methods, you're going to be hitting the cpu hard. probably hard enough to render any gains useless.<br><br>I suppose mark could rewrite it internally, and just sort when a entity is added. but i can't see him doing something that would cripple dynamic entity speed(I.e imagine particles. hundreds being added/removed per min)<br><br>again leads back to having seperate render lists. <br><br></td></tr></table><br>
<a name="459275"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> that's true.  and that's something i'll have to think about for my engine ;)  do an insert sort on load/create/brush change, but have another mode for objects that are always changing their surfaces.<br><br>i think distinguishing between static and dynamic objects in my engine would help immensely. <br><br></td></tr></table><br>
<a name="459293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> One way you could it now(I assume you're using blitz3d? If you're writing your own engine in the true sense of the word, ignore this advice :) ) is to create a header pivot for static/non-static.<br><br>I.e ShowEntity Static_Parent<br>HideEntity NonStatic_Parent <br><br></td></tr></table><br>
<a name="459498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> i am actually writing my own engine in C++ with the DX SDK, but it's got a blitz-like heirarchy system :)  though it'd probably be better to make static and dynamic objects separate classes. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
