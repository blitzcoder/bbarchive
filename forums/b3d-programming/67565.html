<!DOCTYPE html><html lang="en" ><head ><title >Hullo!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Hullo!</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Hullo!</a><br><br>
<a name="754701"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foolish Frost</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hullo.  Just got blitz3d, and was looking it over.  An interesting thing I found when playing with the Demo:<br><br>If you set objects to 1% transparency, they render faster.  Try this demo, in the dragon demo directory.  use s/x to change number of dragons, and e to turn 1% transparency on or off.<br><br>thoughts?<br><br><br>-----<br>copy the below code and add to the dragon demo directory, then run it.<br>---<br><br>;0,40  : idle<br>;40,46 : run<br>;46,54 : attack<br>;54,58 : paina<br>;58,62 : painb<br>;62,66 : painc<br>;66,72 : jump<br>;72,84 : flip<br><br>Dim dranim (8,2)<br>dranim (1,1) = 0  : dranim (1,2) = 40<br>dranim (2,1) = 40 : dranim (2,2) = 46 <br>dranim (3,1) = 46 : dranim (3,2) = 54 <br>dranim (4,1) = 54 : dranim (4,2) = 58 <br>dranim (5,1) = 58 : dranim (5,2) = 62 <br>dranim (6,1) = 62 : dranim (6,2) = 66 <br>dranim (7,1) = 66 : dranim (7,2) = 72 <br>dranim (8,1) = 72 : dranim (8,2) = 84 <br><br>alpha# = .99<br><br>; ------------------------------------------------------------------<br>; 	GameCore -- support@...<br>; ------------------------------------------------------------------<br>; The basics of a frame-limited Blitz 3D game, ready to rock<br>; ------------------------------------------------------------------<br>;             Adapted from Mark Sibly's code<br>; ------------------------------------------------------------------<br><br>Global info1$="Dragon Demo"<br>Global info2$="Use arrows keys to pan, A/Z to zoom, S/X to change number of dragons,"<br>Global info3$="E toggles alpha... MD2 Dragon model courtesy of Polycount"<br><br>Include "../start.bb"<br><br>; ------------------------------------------------------------------<br>;	Game's frames-per-second setting<br>; ------------------------------------------------------------------<br><br>Global gameFPS = 30<br><br>;set up fps counter<br>fps_milli=MilliSecs(): fps_counter=0: update_frequency=10<br><br>; ------------------------------------------------------------------<br>;	Open 3D display mode<br>; ------------------------------------------------------------------<br><br>Graphics3D 640, 480<br><br>; ------------------------------------------------------------------<br>; General setup<br>; ------------------------------------------------------------------<br><br>;environment cube<br>cube=CreateCube()<br>FitMesh cube,-250,0,-250,500,500,500<br>FlipMesh cube<br>tex=LoadTexture( "chorme-2.bmp" )<br>ScaleTexture tex,1.0/3,1.0/3<br>EntityTexture cube,tex<br>EntityAlpha cube,.4<br>EntityFX cube,1<br><br>;floor mirror<br>;m=CreateMirror()<br><br>;simple light<br>light=CreateLight()<br>TurnEntity light,45,45,0<br><br>;camera<br>camera = CreateCamera()<br>Global cam_xr#=30:Global cam_yr#=0:Global cam_zr#=0:Global cam_z#=-240<br><br>;cool dragon model!<br><br>;ffx = 5<br>;ffy = 5<br>;ffz = 5<br><br>arearange# = 320.0<br>basecritterarea# = 80.0<br>crittersize# = 1.0<br><br>distance = basecritterarea * crittersize <br><br>ffx = (arearange / distance) + 1<br>ffy = (arearange / distance) + 1<br>ffz = (arearange / distance) + 1<br><br><br>Dim dragon(ffx ,ffy ,ffz )<br><br>tex=LoadTexture( "model\dragon.bmp" )<br>dragon(1,1,1)=LoadMD2( "model\dragon.md2" )<br>EntityTexture dragon(1,1,1),tex<br><br>numdragonscounter = 0<br><br>For xx = 1 To ffx <br>	For yy = 1 To ffy <br>		For zz = 1 To ffz <br>			If xx &gt; 1 Or yy &gt; 1 Or zz &gt; 1<br>				dragon(xx,yy,zz) = CopyEntity ( dragon(1,1,1) )<br>				;dragon(xx,yy,zz) = CopyMesh ( dragon(1,1,1) )<br>			EndIf<br>			PositionEntity dragon(xx,yy,zz),(0 - (arearange / 2)) + ((xx-1)*distance ),25 + ((zz-1)*distance ),(0 - (arearange / 2)) + ((yy-1)*distance )<br>			TurnEntity dragon(xx,yy,zz),0,150,0<br>			ScaleEntity dragon(xx,yy,zz),crittersize ,crittersize ,crittersize <br><br>			EntityAlpha dragon(xx,yy,zz),alpha <br>			<br>			animcycle = animcycle + 1<br>			If animcycle &gt; 8<br>				animcycle = 1<br>			EndIf<br>			<br>			AnimateMD2 dragon(xx,yy,zz),1,.1,dranim (animcycle ,1),dranim (animcycle ,2)<br>			<br>			numdragonscounter = numdragonscounter + 1<br>		Next<br>	Next<br>Next<br><br><br>; ------------------------------------------------------------------<br>;	Frame limiting code setup<br>; ------------------------------------------------------------------<br><br>framePeriod = 1000 / gameFPS<br>frameTime = MilliSecs () - framePeriod<br><br>Repeat<br><br>	; --------------------------------------------------------------<br>	; Frame limiting<br>	; --------------------------------------------------------------<br><br>	Repeat<br>		frameElapsed = MilliSecs () - frameTime<br>	Until frameElapsed<br><br>	frameTicks = frameElapsed / framePeriod<br>	<br>	frameTween# = Float (frameElapsed Mod framePeriod) / Float (framePeriod)<br><br>	; --------------------------------------------------------------<br>	; Update game and world state<br>	; --------------------------------------------------------------<br>	<br>	For frameLimit = 1 To frameTicks<br>	<br>		If frameLimit = frameTicks Then CaptureWorld<br>		frameTime = frameTime + framePeriod<br>		<br>		UpdateGame ()<br><br>		PositionEntity camera,0,250,0<br>		RotateEntity camera,cam_xr,cam_yr,cam_zr<br>		MoveEntity camera,0,0,cam_z<br>		<br><br>		UpdateWorld<br>			<br>	Next<br><br>	; --------------------------------------------------------------<br>	; **** Wireframe for DEBUG only -- remove before release! ****<br>	; --------------------------------------------------------------<br>		<br>	If KeyHit (17): w = 1 - w: WireFrame w: EndIf ; Press 'W'<br>		<br>	If KeyHit (18)<br>	<br>		If alpha = .99<br>			alpha = 1.0<br>		Else<br>			alpha = .99<br>		EndIf<br>			<br>		<br>		For xx = 1 To ffx <br>			For yy = 1 To ffy <br>				For zz = 1 To ffz <br>	<br>					EntityAlpha dragon(xx,yy,zz), alpha <br>	<br>				Next<br>			Next<br>		Next<br>	EndIf<br>	<br>	If KeyHit (31)<br>		<br>		crittersize = crittersize + .1<br>		If crittersize &gt; 5.0 Then crittersize = 5.0<br>		redrawdragons = 1<br>			<br>	EndIf<br>	<br>	If KeyHit (45)<br>		<br>		crittersize = crittersize - .1<br>		If crittersize &lt; .3 Then crittersize = .3<br>		redrawdragons = 1<br>			<br>	EndIf<br>	<br>	If redrawdragons = 1<br>		redrawdragons = 0<br>		For xx = 1 To ffx <br>			For yy = 1 To ffy <br>				For zz = 1 To ffz <br>	<br>					FreeEntity dragon(xx,yy,zz) <br>	<br>				Next<br>			Next<br>		Next<br>		<br>		distance = basecritterarea * crittersize <br><br>		ffx = (arearange / distance) + 1<br>		ffy = (arearange / distance) + 1<br>		ffz = (arearange / distance) + 1<br>		<br>		<br>		Dim dragon(ffx ,ffy ,ffz )<br>				<br>		tex=LoadTexture( "model\dragon.bmp" )<br>		dragon(1,1,1)=LoadMD2( "model\dragon.md2" )<br>		EntityTexture dragon(1,1,1),tex<br>		<br>		numdragonscounter = 0<br>		<br>		For xx = 1 To ffx <br>			For yy = 1 To ffy <br>				For zz = 1 To ffz <br>					If xx &gt; 1 Or yy &gt; 1 Or zz &gt; 1<br>						dragon(xx,yy,zz) = CopyEntity ( dragon(1,1,1) )<br>						;dragon(xx,yy,zz) = CopyMesh ( dragon(1,1,1) )<br>					EndIf<br>					PositionEntity dragon(xx,yy,zz),(0 - (arearange / 2)) + ((xx-1)*distance ),25 + ((zz-1)*distance ),(0 - (arearange / 2)) + ((yy-1)*distance )<br>					TurnEntity dragon(xx,yy,zz),0,150,0<br>					ScaleEntity dragon(xx,yy,zz),crittersize ,crittersize ,crittersize <br>		<br>					EntityAlpha dragon(xx,yy,zz),alpha <br>					<br>					animcycle = animcycle + 1<br>					If animcycle &gt; 8<br>						animcycle = 1<br>					EndIf<br>					<br>					AnimateMD2 dragon(xx,yy,zz),1,.1,dranim (animcycle ,1),dranim (animcycle ,2)<br>					<br>					numdragonscounter = numdragonscounter + 1<br>				Next<br>			Next<br>		Next<br>		<br>	EndIf<br>	<br>	<br>	; --------------------------------------------------------------<br>	; Draw 3D world<br>	; --------------------------------------------------------------<br><br>	RenderWorld frameTween<br>	Text 0,00,"Notice the framerate increase when alpha is turned on by even 1%" <br>	Text 0,20,"The dragons still seem to be sorted properly, but why the speed increase?" <br>	Text 0,40,"Dragons:"+numdragonscounter <br>		<br>	; fps counter<br>	fps_counter=fps_counter+1<br>	If fps_counter=update_frequency<br>	     fps=1000/Float(((MilliSecs()-fps_milli))/update_frequency)<br>	     fps_milli=MilliSecs()<br>	     fps_counter=0<br>	     EndIf<br>	<br>	; print fps<br>	Text 0,60,"FPS:"+fps<br>	<br>	Text 0,80,"Alpha:"+alpha<br>	<br>	; --------------------------------------------------------------<br>	; Show result<br>	; --------------------------------------------------------------<br><br>	Flip<br><br>Until KeyHit (1)<br><br>End<br><br>; ------------------------------------------------------------------<br>; Game update routine, called from frame limiting code<br>; ------------------------------------------------------------------<br><br>Function UpdateGame ()<br><br>	If KeyDown(203)<br>		cam_yr=cam_yr-2<br>	Else If KeyDown(205)<br>		cam_yr=cam_yr+2<br>	EndIf<br>	<br>	If KeyDown(200)<br>		cam_xr=cam_xr+2<br>		If cam_xr&gt;90 cam_xr=90<br>	Else If KeyDown(208)<br>		cam_xr=cam_xr-2<br>		If cam_xr&lt;5 cam_xr=5<br>	EndIf<br>	<br>	If KeyDown(26)<br>		cam_zr=cam_zr+2<br>	Else If KeyDown(27)<br>		cam_zr=cam_zr-2<br>	EndIf<br>	<br>	If KeyDown(30)<br>		cam_z=cam_z+1:If cam_z&gt;-10 cam_z=-10<br>	Else If KeyDown(44)<br>		cam_z=cam_z-1:If cam_z&lt;-240 cam_z=-240<br>	EndIf<br>	<br>	cam_yr=cam_yr+1<br>	<br>End Function <br><br></td></tr></table><br>
<a name="754820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bytecode77</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> you are optimazing at the wrong point. when making a game you should optimize in particle uses etc by 20% instead of 1% on transparency...<br><br>it sould be ~2% slower than 1% faster anyway.<br>cu <br><br></td></tr></table><br>
<a name="754928"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foolish Frost</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What?  Sorry.  Have no idea what you're talking about.  My point was that I find it interesting that using alpha at ALL speeds up rendering.  I would think that transparency would SLOW the render rate. <br><br></td></tr></table><br>
<a name="754939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes you're right, that's very weird indeed!<br><br>I do have to change the "Flip" to "Flip 0" - else it will remain stuck at 60fps.<br><br>But with alpha @ 0.99 I get a steady 200FPS whilst alpha @ 1.0 drops it to 160FPS!<br><br>I was gonna say this probably has something to do with the fact that the dragon demo uses render-tweening. But when I disabled it, I get the exact same results! So err... I got no explenation ;)<br><br>Interesting!<br><br>d. <br><br></td></tr></table><br>
<a name="754942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Like you mention in the code, my guess is that it 'skips' some internal z-sort. Since Blitz is known to 'not' properly sort transparent entities. But I'll do a test and set 'all my entities' to 0.99 alpha to see if it does make a difference....<br><br>danny <br><br></td></tr></table><br>
<a name="755106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Z sort is done by the entity or childs origin when it's<br>transparent so yes that may be the case Danny. i once had<br>a butterfly model with transparent wings and the rear wing<br>was drawing in front of the front wing until I moved its <br>origin. <br><br></td></tr></table><br>
<a name="755109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ZBuffer *writes* are normally disabled when drawing geometry with alpha, so it might be a little less overhead on GFX card.<br><br><br>If you're interested: 'Why are ZWrites disabled?'<br><br>Picture this scenario. A semi-transparent cube. If it was drawn with Z-Writes enabled, then ZBuffer would be updated with the 'nearest Z distance' of the cube geometry.<br><br>Now what if we wanted to draw a smaller cube inside the 1st, semi-transparent!, box?<br><br>During the drawing of the smaller box, it's geometrys Z distance would be compared to the Z-Buffer... and because it would be GREATER THAN in this case, the smaller cube would not be drawn.<br><br>So when drawing transparent geometry, the Z-Buffer is NOT updated (ZWrites are disabled!)<br><br><br>This is not the case for geometry using masked textures in B3D. The opaque parts of a masked texture ARE written to the ZBuffer.<br><br>This also why when using ALPHA for say 'grass' textures you need to sort the geometry manualy so the furthest away gets drawn first (else it'll look ugly &amp; randomly overlapped). Using masked textures you don't have to do any sorting!<br><br>As a test, apply a masked texture instead of one loaded with the alpha flag. It *should* render about the same as the non-alpha scene.<br>Tom <br><br></td></tr></table><br>
<a name="755186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that explenation Tom!<br><br>But one thing I don't understand; When you mentioned the 'grass' geometry needing manual sorting, you're talking about a single surface (particle) system right?!<br><br>Ok, but you're saying 'masked' textures DO NOT need manual sorting. With 'Masked' do you mean a 24bit color-only texture that has for example the background PURPLE (ie. giving nasty non-antialiased edges) - as opposed to a 32bit color+alpha channel texture (which DOES need manual sorting - but gives nice smooth edges where the texture goes from transparent to opaque) ?!<br><br>If that's true, that's cool because I didn't knew that! ;)<br><br>Thanks,<br>Danny. <br><br></td></tr></table><br>
<a name="755348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Single surface for the grass yeah. Single surface is currently the fastest &amp; best method for doing grass.<br><br>Masked textures do have harsh edges, because their pixels are either fully opaque, or fully transparent. No alpha blending is used when drawing masked textures. <br><br></td></tr></table><br>
<a name="755460"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I'm probably the last to come up with this obvious idea; But ...<br><br>Would it be possible then to use ALPHA textures (on a single surface system) but somehow triggering or forcing Blitz/DX7 to treat it as a MASKED texture?<br><br>With the obvious goal to have 'aplha textured' grass without the need of manually z-sorting each poly (costing precious fps)?!<br>I assume this can't be done using the default Blitz3D commands and options, but since you've got a much more in-depth undertanding of dx7, I can imagine this might perhaps be possible ?!?!?!??<br><br>Danny. <br><br></td></tr></table><br>
<a name="755569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Would it be possible then to use ALPHA textures (on a single surface system) but somehow triggering or forcing Blitz/DX7 to treat it as a MASKED texture? <br></div><br><br>Unortunately not. At least, you could force the settings but it wouldn't look right.<br><br>There are tricks to speeding up grass systems. You can pre-caululate 4 versions of your grasses mesh, each Z sorted to a dominant axis (-X, +X, -Z, +Z), then display the appropriate mesh depending on which dominant axis your camera is looking. Search the forums, there's many topic &amp; examples. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
