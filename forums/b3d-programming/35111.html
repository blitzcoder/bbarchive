<!DOCTYPE html><html lang="en" ><head ><title >problems with a message-intercepting userlib</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >problems with a message-intercepting userlib</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >problems with a message-intercepting userlib</a><br><br>
<a name="381199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK first you should know what i'm trying to do..<br><br>windows sends every window messages about the keyboard status, of course.  these can be used to do PERFECT keyboard input, including key autorepeat and everything, and taking advantage of this functionality means no more kludgy somewhat-functional user-made text input functions.<br><br>now.  i did some researching and found that i can intercept messages using subclassing, where i replace the window's updating function and can do what i want with the messages, and then send them along to the old window updating function so that it's as if my function isn't even there.<br><br>i have this all working, and it works BEAUTIFULLY.  i just set up the subclass (with a BeginEntry command), and i can get the entry buffer.  i can then remove the subclass with an EndEntry command, and it all works wonderfully.<br><br>i only have two problems.<br><br>one, if the EndEntry command (the one that removes the subclass) is the last command in the program, it gives me an "unknown runtime error" upon exit.  HOWEVER if i place any code after the EndEntry command, even just an End command, i don't get this error.  it isn't really much of a problem now that i've found a solution, but i'm just wondering if there's anything i can do to fix it.<br><br>two, if the program quits abnormally (has a runtime error) or normally (with an End) while the subclass is still in effect, it gives a fairly nasty fatal error.  is there ANY way for me to set something up so that the subclass is removed whenever the program ends so that this doesn't happen?  i've tried scanning for WM_CLOSE messages in my custom function but it never recieves them.<br><br>thanks! <br><br></td></tr></table><br>
<a name="382285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DrakeX</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh dear. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
