<!DOCTYPE html><html lang="en" ><head ><title >Virus..the game - not the other one !</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Virus..the game - not the other one !</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Virus..the game - not the other one !</a><br><br>
<a name="279031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PaulJG</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thought I might have a little dig about with the old retro game - "Virus" or "Zarch"..<br><br><a href="http://www.birdsanctuary.co.uk/screens.php?fi=virus&amp;fh=virus/&amp;shot=zarch.gif&amp;colour=red&amp;page=i.php&amp;altag=Zarch%20running%20on%20the%20Archimedes" target="_blank">http://www.birdsanctuary.co.uk/screens.php?fi=virus&amp;fh=virus/&amp;shot=zarch.gif&amp;colour=red&amp;page=i.php&amp;altag=Zarch%20running%20on%20the%20Archimedes</a><br><br>From what I've played with it, the only problem I'm gonna have is culling the landscape ?. It uses a strange patchwork effect which I'm pretty sure I can emulate with either different surfaces - or a multitextured patch.<br><br>But any ideas on how I can get the cutoff effect ?? <br><br></td></tr></table><br>
<a name="279032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could just set a very small camera range!<br><br>IPete2.<br><br>Great game btw. <br><br></td></tr></table><br>
<a name="279034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PaulJG</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Pete, that would cetainly stop the front and back - just the sides though ?. <br><br></td></tr></table><br>
<a name="279035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Paul<br><br>Use a viwport for a squared off effect, not sure how to make it exactly like Virus.<br><br>(The cameraviewport settings for the camera you are rendering.)<br><br>IPete2. <br><br></td></tr></table><br>
<a name="279118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> What a classic! V2000 just didn't bake my biscuit in the same way. You could have a scene made out of a load of individual quads. Heights for the quads could be read from a 2d array and when a row or column goes 'out of bounds' they can be recycled to the other side of the display with new y values and colours. Birdie's terrain tiling demo that comes with Blitz is worth taking a look at. <br><br></td></tr></table><br>
<a name="279162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wiebo</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used to play Virus all the time on my Amiga... I almost finished the game as well.... Man it was hard. <br><br></td></tr></table><br>
<a name="279170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used to have one of those 'Action replay' cheat boxes. Nothing quite like sending a hundred homing missiles at a time after your foes. Still didn't crack it... <br><br></td></tr></table><br>
<a name="279180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm pretty sure virus/zarch is done as 0DFEx suggests. Is this what your looking for?  Not very well commented but you get the just I'm sure.  .... oh and you'd need to do some form of average to get the terrain heights for the edges - these ones don't fade in too well!!<br><br>:-<br><br>Graphics3D 640,480,16,1<br><br>Type point<br>	Field height#<br>	Field index<br>End Type<br><br>Const size=1000<br><br>Dim terrain.point(size-1,size-1)<br><br>create_terrain()<br><br><br>camera=CreateCamera():PositionEntity camera,0,60,-60<br>light=CreateLight()<br>grid=create_grid():surf=GetSurface(grid,1)<br>PointEntity camera,grid<br><br><br>Global x_pos# = size * 5.0<br>Global z_pos# = size * 5.0<br>Global width#=(size*10)<br><br>While Not KeyDown(1)<br><br>	x_mov#=( KeyDown(205)-KeyDown(203) ) * .2<br>	z_mov#=( KeyDown(208)-KeyDown(200) ) * .2<br><br>	x_pos#=( x_pos+width + x_mov ) Mod width<br>	z_pos#=( z_pos+width + z_mov ) Mod width<br>	<br>	update_terrain(surf)<br><br>	UpdateWorld()<br>	RenderWorld()<br>	Flip<br>Wend<br><br>;=====================================================================================================<br>;=====================================================================================================<br>;=====================================================================================================<br><br>Function update_terrain(surf)<br><br>	mx#=Floor( (x_pos +5.0) / 10.0)<br>	mz#=Floor( (z_pos +5.0) / 10.0)<br>	fx#=x_pos - mx*10.0<br>	fz#=z_pos - mz*10.0<br>	<br>	For z=-5 To 5<br>		For x=-5 To 5<br>			v=(x+5)+(z+5)*11<br>			ax=(mx+x+size) Mod size<br>			az=(mz+z+size) Mod size<br>			VertexColor surf,v,0,terrain(ax,az)\height * 50,50<br>			vx#=x*10 - fx * (Abs(x)&lt;&gt;5)<br>			vy#=terrain(ax,az)\height<br>			vz#=-z*10 + fz * (Abs(z)&lt;&gt;5)<br>			VertexCoords surf,v,vx,vy,vz<br>		Next<br>	Next<br><br>End Function<br>	<br>;=====================================================================================================<br>;=====================================================================================================<br>;=====================================================================================================<br><br>Function create_terrain()<br><br>	For z=0 To size-1<br>		For x=0 To size-1<br>			terrain(x,z)=New point<br>			terrain(x,z)\height = Rand(0,10) <br>		Next	<br>	Next<br>	<br>End Function<br>	<br>;=====================================================================================================<br>;=====================================================================================================<br>;=====================================================================================================<br><br>Function create_grid()<br><br>	mesh=CreateMesh():s=CreateSurface(mesh)<br>	<br>	;points<br>	For z=-5 To 5<br>		For x=-5 To 5<br>			v=AddVertex(s,x*10,0,-z*10)<br>			VertexColor s,v,100,Rand(20,60),Rand(10,30)<br>		Next<br>	Next<br>	<br>	;triangles &amp; tex coords<br>	For z=0 To 9<br>		For x=0 To 9<br>			v0=x+(z*11):v1=v0+1<br>			v2=v1+11:v3=v0+11<br>			AddTriangle s,v0,v1,v2<br>			AddTriangle s,v2,v3,v0<br>		Next<br>	Next<br>			<br>	EntityFX mesh,2<br>	Return mesh<br><br>End Function <br><br></td></tr></table><br>
<a name="279183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> sweet! <br><br></td></tr></table><br>
<a name="279184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Big&amp;</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was trying to do the same but gave up with the same problem.<br><br>The zip includes the original Virus/Zarch ladscape data, including object positions.<br><br><a href="http://www.andyn.karoo.net/misc/vland.zip" target="_blank">http://www.andyn.karoo.net/misc/vland.zip</a> <br><br></td></tr></table><br>
<a name="279201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks good Big&amp; - don't recomment using 256 surfaces though.  Have an idea for the averaging of the edges - will post details if I can get it working. <br><br></td></tr></table><br>
<a name="279290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PaulJG</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, lot of good info and help. :)<br><br>Anyone remember the tank game that came out after it, using the same terrain landscape engine ?. (although I dont think it was written by Braben)<br><br>Thinking about it.. not 100% sure on this one - back in the time of Amiga CD32's I've got a feeling that Acid came out with a sort of proper 3d remake of it ??. (Mark, Simon ??)<br>Although.. I could be mistaken.<br><br>While I'm in retro mode.. there was a fullgame available on one of the amiga cover disks that was one of the first ever 3d shootemup's. Pretty sure it was by Psygnosis - they gave it away since it was pulled from production.<br><br>Basically, you where this tank'y thing in an areana - sorta a very early Unreal Torny. (but a tank rather than a bod) - you could use things like jump pads and lasers.. anyone have any idea what I'm on about ???. (I got the original disk SOMEWHERE in the house - it would make one hell of a remake !. Buckets of playability, but with very easy coding. <br><br></td></tr></table><br>
<a name="279304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PaulJG</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually... just found the answers to my questions.<br><br>The game I was thinking about was programmed by Mark - it was called "Guardian", published by Guildhall.<br>(it got 83% in  Amiga Computing) - think it was more of a virus/defender type game though.<br><br>The other game I was thinking about was "Trex Warrior" - now that is a game just crying out for a remake !. <br><br></td></tr></table><br>
<a name="279353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep. I also believe Guardian was programmed in BlitzBasic, although in Amiga BlitzBasic you could program directly in assembler language. Also Skidmarks on the Amiga was also written in Blitz ( again using assembler command ). <br><br></td></tr></table><br>
<a name="279381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't do that to me again Paul - making my head ache at this time of night trying to come up with the name of some old game. Found the answer on the net, and I quote,<br><br>"CONQUEROR is a 3D tank game that makes use of the 3D engine that David Braben wrote for the classic game Zarch on the Archimedes or Virus on the Amiga." <br><br></td></tr></table><br>
<a name="279976"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> There was also a game called ZeeWolf on the amiga... Good fun it was!<br><br>Andy <br><br></td></tr></table><br>
<a name="280117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Indeed it was. I remember that one too. <br><br></td></tr></table><br>
<a name="280133"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vorderman</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> PaulJG : please email me at jkett@... - I have some older source code that may be of interest to you. <br><br></td></tr></table><br>
<a name="280236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Zeewolf 2... drool... <br><br></td></tr></table><br>
<a name="280256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Zeewolf 2... drool..."<br><br>a)Did exist?<br>b)Will exist?<br>c)Is a figment of your imagination? <br><br></td></tr></table><br>
<a name="280261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Andy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did exist!<br><br><a href="http://www.amigagames.com/gage/z/zeewolf2.html" target="_blank">http://www.amigagames.com/gage/z/zeewolf2.html</a><br><br>Andy <br><br></td></tr></table><br>
<a name="280312"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Beauty! Must have abandoned the Amiga by then to join the mounting Hordes of PC scum. The Amiga was most definitely the victim of a conspiracy.......... <br><br></td></tr></table><br>
<a name="281941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ PaulJG and big&amp;<br><br>Managed to get the culling effect working a treat - using a single surface with vertex colours.  If anyone is interested let me know and I'll post the code.  Could easily be used for Zarch, Conqueror or Zeewolf clones. <br><br></td></tr></table><br>
<a name="281960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >joncom2000</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I for one would like to see how you did it Stevie G. So please do post the code :) <br><br></td></tr></table><br>
<a name="281967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok.  Not very well commented and I'm not sure how to put the code in a black box etc...  Let me know what you think?<br><br>Graphics3D 320,240,16,1 <br><br>Const  size#=256<br>Const  divs#=7<br>Const  divg#=divs*4+1<br>Const  scale#=16<br>Const  speed#=.25<br><br>Global camera=CreateCamera()<br>Global light=CreateLight()<br>Global target=CreatePivot()<br>Global map,map_tex<br>Global grid=create_grid()<br>Global surf=GetSurface(grid,1)<br>Global x_pos#= size *.5 <br>Global z_pos#= size *.5<br>Global last_x# = x_pos<br>Global last_z# = z_pos<br>Global frames<br><br>Type point<br>	Field height#<br>	Field index<br>	Field r,g,b<br>End Type<br><br>Dim    terrain.point(size-1,size-1)<br><br>random_terrain(0) ;10031972 <br><br>While Not KeyDown(1)<br><br>	x_pos=qwrap( x_pos + (KeyDown(205)-KeyDown(203)) * speed,size)<br>	z_pos=qwrap( z_pos + (KeyDown(208)-KeyDown(200)) * speed,size)<br>	<br>	update_terrain()<br>	update_camera()<br>	<br>	frames=qwrap(frames+1,10)<br>	If frames = 0 update_map()<br>		<br><br>	UpdateWorld()<br>	RenderWorld()<br>	<br>	Flip<br>Wend<br>	<br>;=====================================================================================================<br>;UPDATE TERRAIN =====================================================================================================<br>;=====================================================================================================<br><br>Function update_terrain()<br>		<br>	ax#=Floor(x_pos):az#=Floor(z_pos)<br>	fx#=(x_pos) - ax:fz#=(z_pos) - az  <br>				<br>	For z=-divs To divs+1 <br>		For x=-divs To divs+1<br>		<br>			nx#=qwrap(ax+x,size) <br>			nz#=qwrap(az+z,size) <br>			<br>			vy#=terrain(nx,nz)\height<br>			vx#=qlimit( x-fx,-divs,divs)<br>			vz#=qlimit( z-fz,-divs,divs)<br>			<br>			;brightness<br>			c#=.5+(divs-Sqr(vx*vx+vz*vz))/(divs)<br>			r=terrain(nx,nz)\r * c<br>			g=terrain(nx,nz)\g * c<br>			b=terrain(nx,nz)\b * c<br>					<br>			If Abs(vx)=divs Or Abs(vz)=divs <br>				vy#=get_height( x_pos+vx , z_pos+vz) <br>			EndIf	<br>			<br>			;vertex positions			<br>			For iz = 0 To ( z &gt; -divs And z &lt; divs+1 )<br>				For ix = 0 To ( x &gt; -divs And x &lt; divs+1 )<br>					x1 = ( x + divs ) * 2 - ( x &gt; -divs ) + ix    <br>					z1 = ( z + divs ) * 2 - ( z &gt; -divs ) + iz    <br>					v=x1+z1*(divg+1)<br>					VertexCoords surf,v, vx * scale , vy , -vz * scale<br>				Next<br>			Next<br>			<br>			;colours<br>			For iz = 0 To (z &lt; divs+1) <br>				For ix = 0 To (x &lt; divs+1)<br>					x1 = ( x + divs ) * 2 + ix<br>					z1 = ( z + divs ) * 2 + iz<br>					v=x1+z1*(divg+1)<br>					VertexColor surf,v,r,g,b <br>				Next<br>			Next<br>					<br>		Next	<br>	Next<br>	<br>End Function<br><br>;=====================================================================================================<br>;GET HEIGHT OF POINT ON WORLD CO-ORDS =====================================================================================================<br>;=====================================================================================================<br><br>Function get_height(bx#,bz#)<br>	<br>	bx=qwrap(bx,size):bz=qwrap(bz,size)<br>	tx#=Floor(bx):tz#=Floor(bz)<br>	jx#=bx - tx:jz#=bz - tz  <br>	cx#=qwrap(tx+1.0,size) <br>	cz#=qwrap(tz+1.0,size) <br>	v1#=terrain(tx,tz)\height+(terrain(cx,tz)\height-terrain(tx,tz)\height)*jx<br>	v2#=terrain(tx,cz)\height+(terrain(cx,cz)\height-terrain(tx,cz)\height)*jx<br>	<br>	Return v1+(v2-v1)*jz<br><br>End Function<br><br>;=====================================================================================================<br>;UPDATE CAMERA =====================================================================================================<br>;=====================================================================================================<br><br>Function update_camera()<br><br>	PositionEntity target,0,divs*10+get_height(x_pos,z_pos)* 1.0,-divs*25<br>	dx#=(EntityX(target,1)-EntityX(camera,1))*.1<br>	dy#=(EntityY(target,1)-EntityY(camera,1))*.1<br>	dz#=(EntityZ(target,1)-EntityZ(camera,1))*.1<br>	TranslateEntity camera,dx,dy,dz<br>		<br>End Function<br><br>;=====================================================================================================<br>;UPDATE MAP =====================================================================================================<br>;=====================================================================================================<br><br>Function update_map()<br><br>	SetBuffer TextureBuffer(map_tex)<br>		<br>	For z=-2 To 2<br>		For x=-2 To 2<br>			xp=qwrap(last_x+x,size)<br>			zp=qwrap(last_z+z,size)<br>			Color terrain(xp,zp)\r,terrain(xp,zp)\g,terrain(xp,zp)\b<br>			Plot xp,zp<br>		Next<br>	Next<br>	<br>	For z=-2 To 2<br>		For x=-2 To 2<br>			xp=qwrap(Floor(x_pos)+x,size)<br>			zp=qwrap(Floor(z_pos)+z,size)<br>			Color 255,255,255 <br>			Plot xp,zp<br>		Next<br>	Next<br>			<br>	SetBuffer BackBuffer()<br>	<br>	last_x=Floor(x_pos)<br>	last_z=Floor(z_pos)<br><br>End Function<br><br><br>;=====================================================================================================<br>;GENERATE RANDOM TERRAIN FOR TESTING =====================================================================================================<br>;=====================================================================================================<br><br>Function random_terrain(seed)<br>	<br>	SeedRnd seed<br>	<br>	;initialise<br>	For z=0 To size-1<br>		For x=0 To size-1<br>			terrain(x,z) = New point<br>		Next<br>	Next<br>	<br>	passes=50+Rand(150)<br>		<br>	;do heights<br>	For parts=0 To passes<br>	<br>		start_x=Rand(0,size)<br>		start_z=Rand(0,size)<br>		rad#=Rand(1,32)<br>		start_y#=Rand(8,32)<br>	<br>		For z=-rad To rad<br>			For x=-rad To rad<br>				d#=Sqr(x*x+z*z)<br>				If d &lt; rad<br>					py#=Cos(d/rad * 90) * start_y<br>					px=qwrap(start_x+x,size)<br>					pz=qwrap(start_z+z,size)<br>					terrain(px,pz)\height = ( terrain(px,pz)\height + py ) <br>				EndIf<br>			Next<br>		Next<br>	Next<br>	<br>	;do colours - based on code from BIG&amp;<br>	<br>	For z=size-1 To 0 Step -1 <br>		For x=0 To size-1 <br>			th#=get_height(x+.5,z+.5)<br>			terrain(x,z)\r = th+Rnd(80)<br>			terrain(x,z)\g = th+120<br>			terrain(x,z)\b = th+Rnd(80)<br>			If th=0 ;*BODGE*Sea<br>				terrain(x,z)\r=60+Rnd(20)<br>				terrain(x,z)\g=60+Rnd(20)<br>				terrain(x,z)\b=220+Rnd(20)<br>			Else <br>				If th &lt; 12;*BODGE*Beach<br>					terrain(x,z)\r=th *10+90<br>					terrain(x,z)\g=th *10+90<br>					terrain(x,z)\b=240-th *20<br>				End If<br>			End If<br>		Next<br>	Next<br>	;*BODGE* Color Landing Pad<br>	For z=-4 To 4 <br>		For x=-4 To 4<br>			col=Rnd(32)+168<br>			xp=qwrap(size*.5+x,size):zp=qwrap(size*.5+z,size) <br>			If x &gt;-4 And z &gt;-4 terrain(xp,zp)\height=30<br>			terrain(xp,zp)\r=col<br>			terrain(xp,zp)\g=col<br>			terrain(xp,zp)\b=col<br>		Next<br>	Next<br>	<br>	;create map<br>	map_tex=CreateTexture(256,256)<br>	SetBuffer TextureBuffer(map_tex)<br>	For z=0 To size-1 <br>		For x=0 To size-1<br>			Color terrain(x,z)\r,terrain(x,z)\g,terrain(x,z)\b<br>			Plot x,z<br>		Next<br>	Next<br>		<br>	SetBuffer BackBuffer()<br>	map=create_quad(camera)<br>	PositionEntity map,-5,3,6<br>	EntityTexture map,map_tex,0<br>	<br>End Function<br><br>;=====================================================================================================<br>;CREATE DISPLAY GRID =====================================================================================================<br>;=====================================================================================================<br><br>Function create_grid()<br><br>	mesh=CreateMesh():s=CreateSurface(mesh)<br>	<br>	For z=0 To divg<br>		For x=0 To divg<br>			v=AddVertex(s,0,0,0)<br>		Next<br>	Next<br>	<br>	For z=0 To divg-1<br>		For x=0 To divg-1<br>			v0=x+z*(divg+1):v1=v0+1<br>			v2=v1+divg+1:v3=v0+divg+1<br>			AddTriangle s,v0,v1,v2<br>			AddTriangle s,v2,v3,v0<br>		Next<br>	Next<br>	<br>	EntityFX mesh,6<br>	Return mesh<br>	<br>End Function<br><br>;=====================================================================================================<br>;=====================================================================================================<br>;=====================================================================================================<br><br>Function qlimit#(q#,a#,b#)<br><br>	If q &lt; a q=a<br>	If q &gt; b q=b<br>	Return q<br>	<br>End Function<br><br>;=====================================================================================================<br>;=====================================================================================================<br>;=====================================================================================================<br><br>Function qwrap#(q#,a#)<br><br>	If q &gt;=a q=q-a<br>	If q &lt; 0 q=a+q<br>	Return q	<br>	<br>End Function<br><br>;=====================================================================================================<br>;=====================================================================================================<br>;=====================================================================================================<br><br>Function create_quad(parent=0)<br><br>	mesh=CreateMesh(parent)<br>	surface=CreateSurface(mesh)<br>	AddVertex surface,-1,1,0,0,0<br>	AddVertex surface,1,1,0,1,0<br>	AddVertex surface,1,-1,0,1,1<br>	AddVertex surface,-1,-1,0,0,1<br>	AddTriangle surface,0,1,2<br>	AddTriangle surface,2,3,0<br>	Return mesh<br>	<br>End Function <br><br></td></tr></table><br>
<a name="281987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CyberHeater</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brilliant and quite hypnotic... <br><br></td></tr></table><br>
<a name="281988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PaulJG</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Stevie !, good stuff - I've got loads of info and background material now. :) <br><br></td></tr></table><br>
<a name="282067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >joncom2000</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for sharing the code. It's mint. I look forward to seeing some Virus/Zarch etc. games in the future.<br><br>I will give it a try myself as well :) <br><br></td></tr></table><br>
<a name="283327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pepsi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Stevie, I saw this in the archives and rushed to find this thread! Just wanted to say thanks for sharing this code gem! Very cool Indeed :) <br><br></td></tr></table><br>
<a name="283415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Big&amp;</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome code Stevie. Just makes me feel damn feeble for giving up. :(<br><br>Cheers again. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
