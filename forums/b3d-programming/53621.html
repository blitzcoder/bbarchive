<!DOCTYPE html><html lang="en" ><head ><title >Sound Channel volume inconsistency</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Sound Channel volume inconsistency</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Sound Channel volume inconsistency</a><br><br>
<a name="598880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drackbolt</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone!<br><br>I've researched this and I'm not sure what the problem is...  I'm using channels to playback multiple sound effects in an RTS game, but when too many guns are firing at once, the sounds start drifting in an out.  It seems like I can't successfully get more than three or four sounds to play at once without losing global volume or losing sounds altogether.  I'm not modifying volume levels for sounds or channels directly in any way.  Aside from this, my code is doing what it is supposed to do.  Is this a limitation of my sound card (Realtek AC97)?  Thanks,<br><br>Jesse <br><br></td></tr></table><br>
<a name="598901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are a few causes.<br><br>The Main one i can think of is this:<br><br>Sound1+Sound1=sound1 at twice the volume<br>sound1+sound1+sound1+sound1=sound1 at 4x the volume<br><br>If you play a sound many times on top of each other, They will distort and eventually you will hear nothing.<br><br>The sound Could be phasing.<br><br>Sound1+inverted sound1=no sound.<br><br><br>umm... Hard to describe.... The second theory wont tend to happen anyway. <br><br></td></tr></table><br>
<a name="598950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sound levels are a strange thing. We humans hear loudness on a logarithmic scale.<br><br>Layering sounds on top of each other in a game can be quite problematic. Either play a few sounds loudly, or many sounds quietly. Of course, playing everything quietly is not really the best option.<br><br>If I were you, I would add some code to lower the volume of all channels as more and more sounds are playing simultaneously. With the right weightings, you will still be tricked into believing that as in-game action increases, overall sound volume does also, even though everything overall remains quite level.<br><br>**EDIT**<br><br>Hmm... better explain how Blitz is playing sounds.<br><br>Sound1 plays at full volume, and it sounds perfect.<br><br>Sound1+Sound2 both play at full volume, sound distorts because the sounds are 'added' together, summing their waveforms and creating an overly-loud (and now clipped) output waveform.<br><br><br>What <i>should</i> happen, but doesn't, is that sound1+sound2 when played together have their waveforms mixed (add them together and divide amplitude by 2). This overlays one sound on the other with no increase in volume. Has a side effect that when you play 2 exact same sounds out of phase, you get... well... phasing :)  Sounds like a weird whooshing sound.<br><br>Sounds great in a club when you're on acid with 2 records playing in phase, but I digress! (don't do drugs, they're bad and <i>I'm joking, okay?</i>). <br><br></td></tr></table><br>
<a name="598956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do mono sounds phase? If not, you could make all the sound files into mono (not stereo) and thus solve the problem???  Maybe???<br><br><br>IPete2. <br><br></td></tr></table><br>
<a name="598967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jams</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <i>" Do mono sounds phase?"</i><br><br>Yeah they suffer from the same problem.<br><br>Perhaps there's some userlib out there that can let b3d interface with onboard DSP? so you could (on some soundcards) activate an on-board compressor? <br><br></td></tr></table><br>
<a name="598974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or, you could manually control the volume. Keep track of how many sounds are playing, and adjust the channel volumes manually :o) <br><br></td></tr></table><br>
<a name="599058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drackbolt</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> First of all, thanks a lot for all the replies... Very helpful.  Great community here.<br><br>I should give a bit more detail.  All the sounds are mono, in wave format.  I have an array of sound channels set up so that when a new sound is requested, it receives its own channel and  has its pitch altered appropriately.  The problem has more to do with losing volume and sounds altogether than anything else.  If two or three are playing, they sound beautiful.  If four or five are playing, they're all barely audible.  If more than that are playing the volume of the game goes completely dead until a less "busy" time.  I don't know why I'm running into this... I can't imagine it would be an uncommon problem unless I'm doing something wrong in particular.  If I have to, it wouldn't be too hard to add a control routine for the volume based on quantity of waves, but I don't see the results as being all that smooth.  Thanks again for all your help. <br><br></td></tr></table><br>
<a name="599067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you create a small program to demonstrate the problem? <br><br></td></tr></table><br>
<a name="599099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds like the sound waves cancelling each other out or amplifying till there not audible... <br><br></td></tr></table><br>
<a name="599122"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If more than that are playing the volume of the game goes completely dead until a less "busy" time <br></div><br>This is a bit of a giveaway - I suspect a WIndows/system timesharing deficiency. <br><br></td></tr></table><br>
<a name="599309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drackbolt</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, here's the code for my "playsound" function.  It calls an array of sound channels, which call an array of sounds.  Let me know if anything looks amiss.<br><br>For a = 0 To 99<br>	If ChannelPlaying(rSoundChannel(a)) = 0	;if channel not in use<br>		Select fvSound<br>			Case 1,2,3,4,5,6,7,8,9,10,11	;weaponfire<br>			rSoundChannel(a) = PlaySound(rFiresound(fvSound))<br>			ChannelPitch rSoundChannel(a),30000<br>		End Select<br>		Exit<br>	EndIf<br>Next<br><br>I've tested this out, and it's iterating properly.  I have also had the time to test it on other computers, and they all had the same problem.  Please help! <br><br></td></tr></table><br>
<a name="599424"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The fact that you seem to want to entertain the playback of 100 samples simultaneously at full volume looks amiss.<br><br>Consider maybe 5 channels instead, pumping through samples at 20% of their full volume. You could have a channel for explosions, one for fire, another for alerts etc; and once an explosion (for example) with a higher priority than the one that is already playing is requested, then the old one simply has to shut up. <br><br></td></tr></table><br>
<a name="599428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> The simplest fix I would guess is to play every gun shot at a slightly different frequency. <br><br></td></tr></table><br>
<a name="599433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drackbolt</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I first tried 8 channels, and then went down to 4, without any difference in the problem.  I then read in this forum somewhere that you could have up to 1024, so I figured why not and went to 100.  It didn't make a difference anyway.  No system seems capable of playing more than 3 at once without drastic reduction in volume.<br><br>Having only one channel for sound effects of a given type is fine for music, but not for combat...  I was really hoping to avoid going that route.  Any suggestions or more info anybody? <br><br></td></tr></table><br>
<a name="599442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Having only one channel for sound effects of a given type is fine for music, but not for combat... I was really hoping to avoid going that route.<br> <br></div><br><br>You already said it yourself (I think) - you could keep track of how much stuff is going on and lower/raise the volume of each channel as and when it's needed. It just takes more cycles to manage than the more simplistic method I suggested. Realistically, though, your players aren't going to be able to discern 100 noises at once (and audio is there to communicate what is going on, remember, and help the player react to circumstances) and if all you need is a cacophony of gunfire then 5-10 dedicated channels for that purpose will probably suffice. <br><br></td></tr></table><br>
<a name="599463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Drackbolt</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess what's confusing is that multiple sound effects would decrease the perceptible volume instead of increase it.  Since everything defaults to a volume of 1, I can't increase the volume beyond that for individual sounds in Blitz.  So, how would I go about increasing the volume for each sound when more are playing?  I have no idea what ratios to use.  I've tried starting all sound volumes at 0.1, then increasing by 0.1 per other sound playing, but that pattern still breaks down beyond four or five sounds at once.  Unless anyone has any epiphanies here, I think I'm just going to end up going the single- or dual-channel route. <br><br></td></tr></table><br>
<a name="599569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe a stupid question: Are you shure <b>all</b> your variables used for Volume are floating point ?<br><br>Second guess: I noticed a sound problem only on one computer I had and could not fix the problem. One of my Blitz3D games that ran normal on every other system, played the sound at about 1/4 of the volume (distorted when I put the main volume in the sound panel) on this one computer. If I stopped the game and started new - everthing worked normal... obviously it had to do with the initialzing of the sound card - done wrong at first try. Driver update didn't fix it. Other games (Blitz or others) worked normal... wrong code should have had an effect on other computers as well... <br><br></td></tr></table><br>
<a name="810404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >lo-tekk</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> This thread is kinda old, but sadly not for me. I stumbled into exactly the same problem right now. Lowering the volume has no real effect. If i play 16 channels and set the volume to 1/16 each, i hear nothing anymore. Currently i have set a limit of 16 channels that can play simultaneously but that did not solve the problem of garbled or distorted sound. Maybe i get the channel-concept wrong.<br>Had anyone else this problem and how can it be solved ? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
