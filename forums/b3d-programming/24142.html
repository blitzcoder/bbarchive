<!DOCTYPE html><html lang="en" ><head ><title >Collision with moving Doors</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Collision with moving Doors</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Collision with moving Doors</a><br><br>
<a name="250100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've set up collisions between the camera and a door.<br><br>When the door is stationary the collisions work OK, it stops the camera going through the door.<br><br>But when you click on the door to shut it, the camera will pass through the door and doesn't get pushed away as I want.<br><br>The simplest solution I suppose is to make the door always open away from the players position but does anyone have an idea of how to get the door to push the camera out of the way??<br><br><br>Piccie:<br><br><img src="http://homepage.ntlworld.com/jm.keay/scream2.jpg"> <br><br></td></tr></table><br>
<a name="250103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm.. if you're using polygon collision detection for your door, maybe RotateMesh instead of RotateEntity should work. But I haven't tried it... <br><br></td></tr></table><br>
<a name="250111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't tried it either but I doubt that'll work.  The problem is that the built-in collision detection is based on moving objects colliding with something.  Since the door is moving you'd have to detect collisions of the door against the player.  With a properly set collision sphere/ellipse for the door this might work well but if not you will have to do things manually using LinePicks or MeshesIntersect or something.<br><br>Come to think of it, MeshesIntersect would be my recommendation.  It is a slow(er) command but you'd only need to use it once a frame to check the nearest door (as opposed to all doors in your level.)  This will tell you if the door and camera are intersecting.  Act on that information to push the camera back. <br><br></td></tr></table><br>
<a name="250141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitz's collision system isn't the best in the world.  It only detects collisions reliably between a moving object, and an object which is not moving.  If both objects are moving, 90% of the time it will fail to detect the collision... unless both objects use sphere collision, and then it seems to be able to handle it better... it's reliable about 90% of the time.<br><br>What really needs to happen is someone needs to come up with a more reliable collision system, because I'm guessing that Mark won't be fixing the collision system anytime soon.<br><br>The other option is to run your game physics twice every frame.  The first time, move the door.  The second time, move the player/camera.  Do an update world for each movement.  The result will be that you're actually doing collisions against static objects, at the cost of some speed. <br><br></td></tr></table><br>
<a name="250142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tough on second thought, since you can onyl have sphere-with-something collisions, if you rotate the door and it hits the player, when the player is standing still, it won't odo crap because when the door collides with something that is sphere to polygon or sphere to sphere.  So the door is the sphere in the case where it is moving.  Which obviously is not the shape of a door.<br><br>I guess the only real solution is a custom collision system. <br><br></td></tr></table><br>
<a name="250166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rob</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> linepicking provides a reasonably constant collision system for simplistic moving objects such as a door. <br><br></td></tr></table><br>
<a name="250169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Edit...I clicked edit/update but it made new posts &gt;.&lt; <br><br></td></tr></table><br>
<a name="250172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Edit...It's the one below this one ^^ <br><br></td></tr></table><br>
<a name="250174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've 'solved' the problem like this.<br><br>I use an entity pick from the camera to check if the player wants to open/close the door.<br><br>The door then opens/shuts doing a meshesintersect test with a sphere mesh which is around the camera.<br><br>If the meshesintersect test is true the door stops.<br><br>When the door is moved again it goes in the opposite direction to what it did last.<br><br>I might post a minimal download demo of this soon.<br><br>And here it is...<br><br>http://homepage.ntlworld.com/jm.keay/squeam!.zip<br><br><br>no lightmaps,lores textures and no sound, just a functional test, see what you think! <br><br></td></tr></table><br>
<a name="250261"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might want to take a look at the source code for 'Operation Chateau Pregney' also. It uses doors similar to the ones you're using. The link for it is below.<br><br><a href="http://melog.ch/dropper/" target="_blank">http://melog.ch/dropper/</a> <br><br></td></tr></table><br>
<a name="250594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess all Blitz FPS have this Problem. I have even seen it in the Lithtech Enginge. Yes, use Meshintersect ONLY if the Door is in Motion and the Player is near the Door. If the meshes intersect simply pause the Door-Motion. To prevent that "I cannot open the door because I am in its way" you could always swing it to the other side than the players side. In OCP I used some additional dummyboxes and stuff, overcomplicated patchwork, I'd try to make it simpler today. <br><br></td></tr></table><br>
<a name="250615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for all the responses.<br><br>I didn't want to make the doors swing in both directions, although this would have removed the need for a meshintersect test its just not how I wanted the doors to operate.<br><br>I do 2 entitypicks so that you can't operate the door unless you are far enough away from it, rushing into the door when its moving will stop it though.<br><br>For me this is the most realistic method and I don't notice any slowdown so for now its onto other things.<br><br>I've added a particle system and a Hud to the updated picture above...next is coronas =) <br><br></td></tr></table><br>
<a name="250671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just for determining distance to the door you don't need to use picks.  Just using EntityDistance is faster. <br><br></td></tr></table><br>
<a name="250691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> EntityPick is used so that I know the player is facing the door but point taken ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
