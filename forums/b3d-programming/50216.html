<!DOCTYPE html><html lang="en" ><head ><title >Zip capability</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Zip capability</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Zip capability</a><br><br>
<a name="558442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> From within a Blitz3D app I need to zipup a folder of files.<br><br>Is there any Blitz code that can do this (that produces a zip compatible with WinZip)?<br><br>I've searched the Tools and Code Archive sections, but no luck. <br><br></td></tr></table><br>
<a name="558463"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not entirely sure they're exactly what you're looking for but it's late and I don't want accuracy to stand in the way of me looking like I'm being helpful.  ;o)<br><br>A couple of leads I've dug up:<br><br>http://web.archive.org/web/20031019211236/http://www.blitzbasic.com/bbs/posts.php?topic=17491<br>Peter Scheutz's adaptation of his zipwrapper into a Blitz3D userlib.<br><br><a href="http://www.freewebs.com/elias_t/bz2wrapper.htm" target="_blank">http://www.freewebs.com/elias_t/bz2wrapper.htm</a><br>Dog's Life Software's Blitz wrapper for the bzip2 compression method.  By their own admission it doesn't compress directories yet (only single files), but... well it's something.<br><br>I hope those help.  Either way, I'm going to bed.  :oD <br><br></td></tr></table><br>
<a name="558465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your talking about manually code processing a file to make it zipped that's a lot of work and you can find out how to do it by reading up technical papers on gamedev.net.<br><br>However Winzip has a command line version which you can make ExecFile calls with, I dont know if it's legally permissable to include it in a download but hey - using one of the wrappers above could hide it! lol<br><br><a href="http://www.winzip.com/prodpagecl.htm?wzhcli" target="_blank">http://www.winzip.com/prodpagecl.htm?wzhcli</a> <br><br></td></tr></table><br>
<a name="558468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh one tip which might be useful when using command line tools.  You can redirect output of the command prompt to a "null" device or file so that the output doesnt appear to screen.  I've not used the Winzip command line tool so dont know if this is of help to you but if you add a &gt; to a DOS command it redirects the text output to whatever you write on the right.<br><br>ie:<br>winzip myDir myFile.zip &gt;c:\winzip.log<br><br>the null device allows for silent zipping, I can never remember what the exact syntax is because the last time I used it I was also an Amigaphille and the Amiga name was different...<br><br>&gt;nul:<br>&gt;null<br><br>something like that.<br><br>Finally, if you use two symobls: &gt;&gt; you can apped to a log file rather than overwrite it.  ie:<br><br>winzip myDir myFile.zip &gt;&gt; C:\myZipLog.txt <br><br></td></tr></table><br>
<a name="558470"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh you can also use this to send information the other way on the DOS pipe.  So if you have a command, say "Format.Com" that you want to provide keyboard inputs too such as confirming the format by pressing "y[ENTER]" then create a text file containing "y[ENTER]" and pipe it thus:<br><br>format c: /s /q &lt;keyboardPresses.txt<br><br>Please dont use that technique with the example given ! <br><br></td></tr></table><br>
<a name="558593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's lots of work!<br>Thanks Becky Rose, I'm an old DOS man myself; thanks for reminding me about the commands.<br><br>Thanks Lineof7s - unfortunately zlib.dll and its wrappers only seem to work with single files, and I need files in folders in a folder. Also the only real example states that the zipped up exe ended up larger than the original (and reasons why). Ho-hum.<br><br>But maybe Becky Rose has tipped me off...<br>Don't I have an old version of pkzip somewhere which can be command line driven? Hmmm.<br><br>I'll let you know. <br><br></td></tr></table><br>
<a name="558602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please do, i've been trying to justify why I remember all this for ages and dying for a reason to use it.  I found an old batch file I wrote on a backup disk the other day that had labels and goto's and stuff, i'd completely forgotten the syntax of all of that but it still works in XP!<br><br>I preffered the Amiga-CLI though, bring back my beloved Arrexx! <br><br></td></tr></table><br>
<a name="558629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> (Too right! I'm still using dos batch files for backing up projects, filtering out .bak's etc. If you need any dos batch file tutorials let me know, I've got a couple...)<br><br>Cracked it! - Or at least good enough.<br><br>Firstly, my old copy of Pkzip produced a zip file, but with all internal names as per 8.3 DOS convention.<br>Doh! Should have thought of that.<br><br>Then I tried to get Winzip to react to a command line - went on their site, needs a plugin.... nevermind.<br><br>Did a search and found 7-zip... free and takes command lines:<br><a href="http://www.7-zip.org" target="_blank">http://www.7-zip.org</a><br><br>So finally I can zip up a folder full of files from wothin Blitz:-<br><pre class=code>
example()
End

;-------------------------------------------
Function example()
;-------------------------------------------
	zipexedir$ = "E:\Projects\R4D\files\TLA\sys\"
	sourcedir$ = "E:\Projects\R4D\files\Projects\Example\"
	destfile$ = "C:\Example.zip"
	ZipFolder(zipexedir$,sourcedir$,destfile$)
End Function

;-------------------------------------------
Function ZipFolder(zipexedir$,sourcedir$,destfile$)
;-------------------------------------------
	If Right$(zipexedir$,1)&lt;&gt;"\" Then zipexedir$ = zipexedir$ + "\" 
	If Right$(sourcedir$,1)&lt;&gt;"\" Then sourcedir$ = sourcedir$ + "\" 
	doscommand$ = zipexedir$ + "7z.exe a -r -tzip " + destfile$ + " " + sourcedir$
	ExecFile "command /c "+ doscommand$
End Function
</pre><br>Backy Rose, I still can't get rid of that damn dos box; neither '&gt;null' nor '&gt;nul' has any effect.<br><br>Thanks for everyone's help. <br><br></td></tr></table><br>
<a name="558669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> What about CreateProcess instead of ExecFile? <br><br></td></tr></table><br>
<a name="558743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Hotcakes: Sorry, which language are you using?<br><br>@All: A few amendments-<br><br>1) All filenames (for safety) should be wrapped in quotes, in case they are long filenames.<br><br>2) I soon hit the commandline length limit, because of the size of the paths (command /c failed).<br>Therefore it's safer to write your files into a textlist, then reference that in the commandline (see below).<br>In my example I needed to zipup a single file (pfile$) and also a folder(sourcedir$).<br><br>3) You should ideally be calling 7-zip's standalone exe which is called 72a.exe, as opposed to the previously mentioned 72.exe.<br><br><pre class=code>
;-------------------------------------------
Function ZipFolder(zipexedir$,sourcedir$,pfile$,destfile$)
;-------------------------------------------
Local fileout, doscommand$

	If FileType(destfile$)= 1 Then DeleteFile destfile$
	If Right$(zipexedir$,1)&lt;&gt;"\" Then zipexedir$ = zipexedir$ + "\" 
	If Right$(sourcedir$,1)&lt;&gt;"\" Then sourcedir$ = sourcedir$ + "\" 
	
	pfile$ = Chr$(34) + pfile$ + Chr$(34)
	sourcedir$ = Chr$(34) + sourcedir$ + Chr$(34)
	destfile$ = Chr$(34) + destfile$ + Chr$(34)

	fileout = WriteFile("filelist.txt") 
	WriteLine(fileout, pfile$) 
	WriteLine(fileout, sourcedir$) 
	CloseFile(fileout)

	doscommand$ = zipexedir$ + "7za.exe a -r -tzip " + destfile$ + " @filelist.txt"
	ExecFile "command /c " + doscommand$ 

End Function
</pre> <br><br></td></tr></table><br>
<a name="558791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh I assumed you needed .zip for compatability, .7z is miles better and in my experience gives better compression than .rar aswell.  I'm glad i've got another convert - even if you did descover it yourself :)  Now I just need you to use Innosetup for making the release installs with... <br><br></td></tr></table><br>
<a name="558793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use 7zip myself - I've never looked at it enough to know it had a commandline interface though (and nothing I'm doing at the moment needs zipping).<br><br>I use Innosetup too, if that gets me into the club.  :o)<br><br>Glad to found a solution, John.  Especially if I need it anytime in the future. <br><br></td></tr></table><br>
<a name="559020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually what I need next _is_ a good free install maker.<br><br>I looked at Innosetup - I couldn't make head or tail of it.<br>It seemed like a script system with really obscure instructions.<br><br>Any clues (or help files) you can give me? <br><br></td></tr></table><br>
<a name="559064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I first looked at InnoSetup I didn't know the proverbial from the clay as far as installers went, but whenever someone mentioned InnoSetup (and mentioned it in very favourable tones), they'd always mention ISTool as well.  I've always used them both together, and they've always been remarkably straightforward and professional-looking (in combination).<br><br><a href="http://www.istool.org/default.aspx/" target="_blank">http://www.istool.org/default.aspx/</a><br><br><div class="quote"> ISTool helps you create scripts for Jordan Russell's Inno Setup compiler. Inno Setup is a great compiler for very professional looking setups, and the only disadvantage is that you have to create fairly complex scripts by hand. <br><br>This is where ISTool comes in. With this application you can edit these scripts in a visual environment, and creating these setup scripts becomes much easier.  <br></div> <br><br></td></tr></table><br>
<a name="559119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Hotcakes: Sorry, which language are you using? <br></div><br>I could have sworn there was an alternative to ExecFile that grabbed the output, but I may well have been thinking about BlitzPlus now that you mention it.  Sorry. <br><br></td></tr></table><br>
<a name="559195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Lineof7s - downloaded them, thanks for the info.<br>Now for another late night.<br>I'll let you know. <br><br></td></tr></table><br>
<a name="559228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Banshee</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> As LineOf7s says, ISTool.  I have never personally "used" InnoSetup.  I just call ISTool by the name InnoSetup because i'm dense. <br><br></td></tr></table><br>
<a name="559486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, another very late night.<br>Maybe it's just me, but I can't use software like this.<br><br>If it were mine, I wouldn't release it (maybe that's why it's free) - it's just too difficult to understand.<br>I still haven't got it learn what a folder is yet - all it does is add the root files, not the folders.<br><br>Thanks all, but I've had enough. I'm going to pay for ClickTeam's Install Creator which having downloaded 14 demos, I find the best. <br><br></td></tr></table><br>
<a name="566130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snarkbait</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> John - I have found a way to create proper zip files with folders from within Blitz using zlib.dll, are you interested still? <br><br></td></tr></table><br>
<a name="566142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LineOf7s</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> &lt;puts on totally convincing fake John voice&gt;<br><br>Uh yes, yes I am interested.  :o) <br><br></td></tr></table><br>
<a name="566157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Snarkbait</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> here:<br><br><pre class=code>
; "savetozip.bb" include file
; by snarkbait
; snarkbait66 @ gmail.com
; needs the correct version of zlib.dll in the current folder
; actually uses a modified build of zlib.dll found here:
; <a href="http://www.winimage.com/zLibDll/zlib123dll.zip" target="_blank">http://www.winimage.com/zLibDll/zlib123dll.zip</a>
; often named 'zlibwapi.dll' but I change the name to
; zlib.dll (for no good reason other than the previous 
; authors of blitz zlib wrappers did so)

; needs the following .decls file
;
; zlib.decls
; .lib "zlib.dll" ; or use "zlibwapi.dll" if you don't change the name
; 
; Zlib_zipOpen%( filename$, append ):"zipOpen"
; Zlib_zipOpenNewFileInZip%( fh, filename$, fileinfo*, extrafield_local, size_extrafield_local, extrafield_global, size_extrafield_global, comment$, method, level ):"zipOpenNewFileInZip"
; Zlib_zipWriteInFileInZip%( fh, buf*, buflen):"zipWriteInFileInZip"
; Zlib_zipCloseFileInZip%( fh ):"zipCloseFileInZip"
; Zlib_zipClose%( fh ):"zipClose"
;
; usage: 
; success = LoadFolderToZip("subfoldername","destfilename.zip")
;
; folder zipped must be a subfolder of the current running directory
; do not use full path name or trailing backslash
; i.e. LoadFolderToZip("Test","test.zip")
; will load all the files in the subfolder 'Test' to a file called test.zip
; ignores further subfolders, could easily be modified to include them also

Const Z_DEFLATED = 8
Const Z_DEFAULT_COMPRESSION = -1

Const APPEND_STATUS_CREATE = 0 
Const APPEND_STATUS_CREATEAFTER  = 1 
Const APPEND_STATUS_ADDINZIP= 2 

Function SaveToZip(filename$, filetozip$, append = APPEND_STATUS_CREATE)
	file = Zlib_zipOpen (filename$,append)
	If Not file Return False
	zipfile = OpenFile(filetozip$)
	If Not zipfile Return False
	zipsize = FileSize(filetozip$)
	fbank = CreateBank(zipsize)
	ibank = CreateBank(100)
	ReadBytes fbank,zipfile,0,zipsize
	Zlib_zipOpenNewFileInZip( file, filetozip$,ibank,0,0,0,0,"",Z_DEFLATED,Z_DEFAULT_COMPRESSION)
	Zlib_zipWriteInFileInZip( file , fbank, BankSize(fbank))
	Zlib_zipCloseFileInZip( file)
	Zlib_zipClose(file)
	FreeBank fbank
	FreeBank ibank
	Return True
End Function

Function LoadFolderToZip(folder$,destfile$)
	If FileType(folder$) = 2
		a = 0
		zipdir = ReadDir(folder$)
		Repeat
			thisfile$ = NextFile$(zipdir)
			If thisfile$ = "" Exit
			If FileType(folder$ + "\" + thisfile$) = 1
				If a = 0
					success = savetozip(destfile$,folder$ + "\" + thisfile$)
					If Not success Return False
				Else
					success = savetozip(destfile$,folder$ + "\" + thisfile$,APPEND_STATUS_ADDINZIP)
					If Not success Return False 
				EndIf
				a = a + 1
			EndIf
		Forever
		Return True 
	Else
		Return False
	EndIf 
End Function 

</pre> <br><br></td></tr></table><br>
<a name="566201"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, nice one.<br><br>I'll have to revisit my code a some point soon, so I've tucked your code and the dll away to have a look at then.<br><br>Thanks for the work. <br><br></td></tr></table><br>
<a name="568274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Storm8191</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> John: to use Innosetup easily, it has a wizard to create your script file for you.  Use that to create your script file initially, and then you can add special extra parameters as you please.  Yes, it is a hard program to use, but it's full of nice features. <br><br></td></tr></table><br>
<a name="568327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Argh! I hate to say this, but if we're talking about the same program then the wizard is just as vague and unfriendly as the main program.<br><br>I ended up buying (shock, horror) the ClickTeam Installer.<br>I find it well nigh perfect. You can even change the overlay images and decide where and in which font each message will appear. But of course that's when I want to do the business on the whole app for distro.<br><br>Internally the app still has jobs to do:<br>a) I create and copy a folder of files (the hard way)<br>(- think of this as creating a demo on the fly.)<br>b) Point to the folder and use 7za.exe to zip it.<br>c) Point to the zip and use MakeSFX.exe to turn it into a self-extracting exe with desktop icon.<br>The point being that this can all be done internally via your Blitz code, which is what my app needed.<br><br>By the way, a few people have said that they need to execute a dos-like command, and you can use ExecFile(command /c etc) to do this, but I soon found that Command won't execute if the line gets too long.<br><br>So (hee-hee), I came up with this:<br><pre class=code>	batfile$ = "Export.bat"
	fileout = WriteFile(batfile$) 
	doscommand$ = "@echo PLEASE WAIT . . ." ; &lt;- your commands here
	WriteLine(fileout, doscommand$) 
	CloseFile(fileout)
	Delay 500
	api_ShellExecute(hWnd, "", batfile$, 0, "", SW_HIDE)</pre> No more ugly black box! <br><br></td></tr></table><br>
<a name="568358"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, the old DOS command.com had a 127 (I think) character limit for each command.<br><br>Remeber, this was in the time when Bill couldn't foresee anyone needing any more than 640K RAM! :P <br><br></td></tr></table><br>
<a name="568412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GrahamK</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are still looking for zip capabilities, feel free to have a go with my library. <br><br>It was written prior to userlibs, but 'should' still work.<br><br>Look under projects... over on my squeakyduck site. <br><br></td></tr></table><br>
<a name="568574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one, Blitztastic.<br>As I said, I've got it fairly sorted now, but thanks anyway. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
