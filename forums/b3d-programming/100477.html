<!DOCTYPE html><html lang="en" ><head ><title >Help Variable Windows XP/7</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Help Variable Windows XP/7</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Help Variable Windows XP/7</a><br><br>
<a name="1186711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a problem trying to retrieve the data of a variable, in Windows XP I returned 2, however returns me windows 7 22 and that causes me problems in the logic of the program.<br><br>Someone who can help me to know what is happening. :( <br><br></td></tr></table><br>
<a name="1186712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Going to need to post some code... <br><br></td></tr></table><br>
<a name="1186714"></a>

<a name="1186721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> OOps, I misunderstood, <br><br>,,,now it's apparent that it has something to do with video modes. <br><br></td></tr></table><br>
<a name="1186715"></a>

<a name="1186716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows XP OK no problem.<br><img src="http://i42.tinypic.com/t5gnk3.jpg"><br><br>Problem Windows 7.<br><img src="http://i44.tinypic.com/33df3g0.jpg"><br><br><br>Code here:<br><br>Init Variable.<br><pre class=code>
Copia_ModoVideo% = INI_GetValue(Fichero.INI_File,"Graficos","Modo_Video")
</pre><br><br>Disable / enable button save.<br><pre class=code>
	If Graficos% = True
		
		AppTitle BCF_TestComboBoxType(CMB_ModoVideo%) +"X" + Copia_ModoVideo%
		
		If Copia_ModoVideo% &lt;&gt;  BCF_TestComboBoxType(CMB_ModoVideo%)  	Then 
			BCF_EnableGadget(Boton[BtonGuardar]\Imagen%,True)
		Else 
			BCF_EnableGadget(Boton[BtonGuardar]\Imagen%,False )
		End If 
		
		
	End If 
</pre><br><br>help please. <br><br></td></tr></table><br>
<a name="1186718"></a>

<a name="1186720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...what's in the Windows 7 INI file at that line? It looks straightforward: the problem is that an invalid value is being retrieved. Has a different value been saved for Windows 7?<br><br>If not, perhaps post the INI file? <br><br></td></tr></table><br>
<a name="1186729"></a>

<a name="1186730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you want to store the value of the graphic card entry like "320x200".<br><br>But it looks like you save the index of the graphic mode in the modes list? 640x480 is very early in the list... so it is the second, And 720x480 is far doen the list at position 22?<br><br>So, some more questions about this:<br><br>What does the "2x2" represent? <br>What does it mean? <br>Send us all lines where Copia_ModoVideo% is used!<br><br>What do you want to store in Copia_ModoVideo%?<br>What do you want to store in CMB_ModoVideo%? <br><br></td></tr></table><br>
<a name="1186746"></a>

<a name="1186747"></a>

<a name="1186748"></a>

<a name="1186749"></a>

<a name="1186750"></a>

<a name="1186751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> 2X2<br><br><pre class=code>AppTitle BCF_TestComboBoxType (CMB_ModoVideo%) + "X" + Copia_ModoVideo%</pre><br>Saves the current video last index to display in the combobox controls<br><br><br><br>File INI.<br>Kernel.img<br><br><pre class=code>
Configuración General



;Opciones Gráficas
[ Graficos ]
Modo_Video =  2 ;Variable Copia_ModoVido!!
Calidad_Sombras = 1
Distancia_Dibujado = 2500.0
DOF = 1
SYNCV = 1
Modo_Windows = 0 
Calidad_Reflejos = 2
Calidad_Agua = 2
Filtro_Textura = 2
GLOW = 1
RAYS = 1



;Opciones Audio
[ Sonidos ]
VolumeMusica = 50.0
VolumeEfectos = 50.0
VolumeVoces = 50.0



;Opciones Pantalla
[ Pantalla ]
SubTitulos = 1
Lenguaje = 0
</pre> <br><br></td></tr></table><br>
<a name="1186754"></a>

<a name="1186763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Code no problem XP, Yes problem Windows 7.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function ScaneoModoVideo%()
	
	Local X% 
	
	
	If Copia_WIND% =  0  And GfxModeDepth(Copia_ModoVideo%) = 16  Then 
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 16  Then 
				
				
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
				
			End If 
		Next
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32  Then 
				
				
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
				
			End If 
		Next
		
		BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
	ElseIf Copia_WIND% = 0  And GfxModeDepth(Copia_ModoVideo%) = 32  Then  
		
		
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 16  Then 
				
				
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
				
			End If 
		Next
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32  Then 
				
				
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
				
			End If 
		Next
		BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
	ElseIf Copia_WIND% = 1  And GfxModeDepth(Copia_ModoVideo%) = 16  Then
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32 
				If  GfxModeWidth(X)  &lt;= EscritorioAncho%    And GfxModeHeight(X) &lt;= EscritorioAlto%	
					
					BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
					; Fix Yue
					Copia_ModoVideo% = X%
					
				End If 
				
				
				
				
			End If 
			
			If GraphicsWidth()  = GfxModeWidth(X) And GraphicsHeight() = GfxModeHeight(X)
				;Copia_ModoVideo% = X%
				BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
			End If 
			
		Next
		
		
	ElseIf Copia_WIND% = 1 And GfxModeDepth(Copia_ModoVideo) = 32
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32 
				If  GfxModeWidth(X)  &lt;= EscritorioAncho%    And GfxModeHeight(X) &lt;= EscritorioAlto%	
					
					BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
					
					;BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
					
				End If 
				
				
				
				
			End If 
			
			If GraphicsWidth()  = GfxModeWidth(X) And GraphicsHeight() = GfxModeHeight(X)
				;Copia_ModoVideo% = X%
				BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
			End If 
			
		Next
		
	End If 
	
	
	
	
	
	If InitGameFirst% = True Then 
		BCF_SelectedComboBoxValue%(CMB_ModoVideo%,"800 X 600 -32-")
		InitGameFirst% = False
	End If 
	
	
	
	
	
		
	
	
		
		
	ChangeRes% = False
		
		
		
	
	
End Function 

</textarea> <br><br></td></tr></table><br>
<a name="1186755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is the file posted above copied from your Windows 7 machine? If not, can you confirm that the INI file on Windows 7 stores exactly the same data as the file on Windows XP? It's possible that you're saving different values to the file, and that the error is actually happening earlier on in the program with however the file is generated.<br><br>Also, please use the "codebox" tag for large code blocks. <br><br></td></tr></table><br>
<a name="1186758"></a>

<a name="1186759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, <br><br>INI Windows 7, index 800  600 32 = 4<br><br><pre class=code>
;Configuración General



;Opciones Gráficas
[ Graficos ]
Modo_Video = 4 ; Windows 7 ,23 Windows XP
Calidad_Sombras = 1
Distancia_Dibujado = 2500.0
DOF = 1
SYNCV = 1
Modo_Windows = 1
Calidad_Reflejos = 2
Calidad_Agua = 2
Filtro_Textura = 2
GLOW = 1
RAYS = 1



;Opciones Audio
[ Sonidos ]
VolumeMusica = 50.0
VolumeEfectos = 50.0
VolumeVoces = 50.0



;Opciones Pantalla
[ Pantalla ]
SubTitulos = 1
Lenguaje = 0
</pre><br><br>I have noticed something strange with User32, with the aim of recovering the data on screen height and length windows desktop, I return the highest value or the current width in windows 7 returns an index below.<br><br>In windows xp if the screen width is 1024, 1024 returns user32 in windows 7 returns a inidce below.<br><br>Widht screen Windows 7 1024<br>User32 &gt;&gt;&gt; Blitz 683 ....<br><br>It could be the cause of the problem?? <br><br></td></tr></table><br>
<a name="1186760"></a>

<a name="1186762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> OHHHHH... you mean the index used for the CountGfxModes/GfxModeWidth etc. functions?<br><br>Those indices are <i>completely</i> non-portable! They very much depend on the individual machine. The point of those functions is that you <i>must not</i> assume anything about which modes are available - you should be using them to <i>test</i> which modes are available, and at what number. There is no reason to expect the indices would be the same, because there is no reason to expect that the same modes would even exist on another machine.<br><br>In other words, do not save this number: it is meaningless (it isn't even guaranteed to be the same if you restart your computer). Definitely do not compare it to a BCF mode setting, because there is no connection at all between the two! <br><br></td></tr></table><br>
<a name="1186764"></a>

<a name="1186766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> but I'm doing the following.<br><br>Scanning first graphics modes, these index return me eg 1 to 5<br><br><pre class=code>
; Copia_ModoVideo% 
Graphics3D GfxModeWidth(Copia_ModoVideo%),GfxModeHeight(Copia_ModoVideo%),GfxModeDepth(Copia_ModoVideo%)
</pre> <br><br></td></tr></table><br>
<a name="1186780"></a>

<a name="1186781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Error User32.dll<br><br><pre class=code>
Graphics3D 800,600,32
SetBuffer BackBuffer()
Global WidthDes% 			= User32_GetSystemMetrics (0)
Global HeightDes% 	 		= User32_GetSystemMetrics (1)


Text 0,0,WidthDes% + "X" + HeightDes%
Flip 
WaitKey()
EndGraphics()
End
</pre><br><img src="http://i42.tinypic.com/anlqjb.jpg"><br><br>No error Windows XP User32.dll<br><img src="http://i43.tinypic.com/6is5sy.jpg"> <br><br></td></tr></table><br>
<a name="1186790"></a>

<a name="1186791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> It looks like your Windows 7 system is being confused by a DPI setting: <a href="http://stackoverflow.com/questions/2630392/getsystemmetrics-returns-wrong-value-for-sm-cxscreen" target="_blank">http://stackoverflow.com/questions/2630392/getsystemmetrics-returns-wrong-value-for-sm-cxscreen</a><br><br>You should be able to use EnumDisplaySettings to get unscaled results instead: <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd162611%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/dd162611%28v=vs.85%29.aspx</a><br><br>(I don't know offhand how to use this function, will get back with details later if nobody beats me to it.) <br><br></td></tr></table><br>
<a name="1186792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://i39.tinypic.com/96gnpy.jpg"><br><br>Solved, I have a defect, and I do not understand programming I blame the engine.<br><br>From what has been learned is that in user32.dll in windows 7 returns the exact value of the height and width of the desk yet that erroneous information is displayed in the display properties.<br><br>The solution implies that 'running properly on Windows XP and Windows 7, when you start the program first scans graphics modes are supported, these values &amp;#8203;&amp;#8203;are saved in a file that are indexes, depending on operating system and graphics card are variably height and width data.<br><br>For example the 4 in windows 7 refers to graphical mode 800 * 600 -32 - on another machine this value worth 8 with Windows 7 and in Windows XP it in another machine 23 and 19.<br><br>They are like variables that take different data agrees oparativo system and graphics card.<br><br>But the error was in my head, and corrected the code into graphics mode scanning.<br><br>This data is stored for the user in combo box control, but internally handled indexes for each field are filled.<br><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
; Scaneo de Modos Gráfricos.
;_________________________
Function ScaneoModoVideo%()
	
	Local X% 
	
	
	If Copia_WIND% =  0  And GfxModeDepth(Copia_ModoVideo%) = 16  Then 
		
		
		For X% = 1 To CountGfxModes3D()
			
			
			If GfxModeDepth(X%) = 16 Then 	
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
		    End If 
			
			
			
		Next
		
		For X% = 1 To CountGfxModes3D()
			
			
			If GfxModeDepth(X%) = 32 Then 	
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
		    End If 
			
			
			
		Next
		
	
		
	BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
	ElseIf Copia_WIND% = 0  And GfxModeDepth(Copia_ModoVideo%) = 32  Then  
		
		
		
		For X% = 1 To CountGfxModes3D()
			
			
			If GfxModeDepth(X%) = 32 Then 	
			
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
		    End If 
			
			
			
		Next
		
		For X% = 1 To CountGfxModes3D()
			
			
			If GfxModeDepth(X%) = 16 Then 	
				
				BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
		    End If 
			
			
			
		Next
		
		
		
		
		BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
	ElseIf Copia_WIND% = 1  And GfxModeDepth(Copia_ModoVideo%) = 16  Then
		
		
		For X% = 1 To CountGfxModes3D()
			
			If GfxModeDepth(X%) = 32
				
				If  GfxModeWidth(X)  &lt;= EscritorioAncho%    And GfxModeHeight(X) &lt;= EscritorioAlto%	
					
					BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
					
					
				End If 
				
			End If
			
			
			
			
		
		
		
		Next
		
		For X% = 1 To  CountGfxModes3D()
			
			If GfxModeWidth(X) = GraphicsWidth() And GfxModeHeight(X%) = GraphicsHeight() And GfxModeDepth(X%) = 32  
				Copia_ModoVideo% = X%
				
			End If 
			
		Next  
		
		
		BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)	
	ElseIf Copia_WIND% = 1 And GfxModeDepth(Copia_ModoVideo) = 32
		
		For X% = 1 To CountGfxModes3D()
			If GfxModeDepth(X) = 32 
				
				
				If  GfxModeWidth(X)  &lt;= EscritorioAncho%    And GfxModeHeight(X) &lt;= EscritorioAlto%	
					
					BCF_AddComboBoxItem%(CMB_ModoVideo%,GfxModeWidth(X%) + " X " + GfxModeHeight(X%) + " -" + GfxModeDepth(X%) +"-",55,X%)
					
					BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
					
				End If 	
				
				
			End If 
			
;			If GraphicsWidth()  = GfxModeWidth(X) And GraphicsHeight() = GfxModeHeight(X)
;				;Copia_ModoVideo% = X%
;				BCF_SelectedComboBoxType%(CMB_ModoVideo%,Copia_ModoVideo%)
;			End If 
			
		Next
		
	End If 
	
	
	
	
	; Fix
	If InitGameFirst% = True Then 
		BCF_SelectedComboBoxValue%(CMB_ModoVideo%,"800 X 600 -32-")
		InitGameFirst% = False
	End If 
	
	
	
	
	
		
	
	
		
		
	ChangeRes% = False
		
		
		
	
	
End Function 


; Modo Gráfico por defecto.
;_________________________
Function ModoVideo%()
	
	Local InitFirst%
	Local Fichero.INI_File
	If GfxMode3DExists(800,600,32) Then 
		
		If FileType ("SaveGame\Kernel.img") = False Then  	
			Graphics3D (800,600,32,2)
			InitFirst% = True
			
			
			; - Gráficos.
			For X% = 1 To CountGfxModes3D()
				
				If GfxModeWidth(X%) = 800 And GfxModeHeight(X%) = 600 And GfxModeDepth(X%) = 32 Then 
					
					Copia_ModoVideo% = X%
				End If 
			Next
			
			
			Copia_CalidadSombras% = 1
			Copia_DistanciaDibujado% = 2500
			
			Copia_DOF% 		= 1
			Copia_SYNCV% 	= 1
		    Copia_WIND% 	= 1
			
			Copia_CalidadReflejos% = 2
			Copia_CalidadAgua%     = 2
			Copia_FiltroText%      = 2
			
			Copia_GLOW%		= 1
			Copia_RAYS%		= 1
			
			; - Sonidos.
			Copia_VolumeMusica%  = 50
			Copia_VolumeEfectos% = 50
			Copia_VolumeVoces%   = 50
			
			
			; - Pantalla.
			Copia_SubT%			 = 1
			Copia_Lenguaje%		 = 0
			
			
		Else 
			InitFirst% = False
			
			
			
			Fichero.INI_File = INI_Load("SaveGame/Kernel.img")
			
			; - Gráficos.
			Copia_ModoVideo% 		= INI_GetValue(Fichero.INI_File,"Graficos","Modo_Video")
			
			
			
			
			
			Copia_CalidadSombras% 	= INI_GetValue(Fichero.INI_File,"Graficos","Calidad_Sombras")
			Copia_DistanciaDibujado%= INI_GetValue(Fichero.INI_File,"Graficos","Distancia_Dibujado")
			
			Copia_DOF%              = INI_GetValue(Fichero.INI_File,"Graficos","DOF")
			Copia_SYNCV%			= INI_GetValue(Fichero.INI_File,"Graficos","SYNCV")
			Copia_WIND%				= INI_GetValue(Fichero.INI_File,"Graficos","Modo_Windows")
			
			
			
			Copia_CalidadReflejos%  = INI_GetValue(Fichero.INI_File,"Graficos","Calidad_Reflejos")
			Copia_CalidadAgua%  	= INI_GetValue(Fichero.INI_File,"Graficos","Calidad_Agua")
			Copia_FiltroText%  		= INI_GetValue(Fichero.INI_File,"Graficos","Filtro_Textura")
			
			Copia_GLOW%   			= INI_GetValue(Fichero.INI_File,"Graficos","GLOW")
			Copia_RAYS%   			= INI_GetValue(Fichero.INI_File,"Graficos","RAYS")
			
			
			; - Sonidos.
			Copia_VolumeMusica%     = INI_GetValue(Fichero.INI_File,"Sonidos","VolumeMusica")
			Copia_VolumeEfectos%    = INI_GetValue(Fichero.INI_File,"Sonidos","VolumeEfectos")
			Copia_VolumeVoces%     	= INI_GetValue(Fichero.INI_File,"Sonidos","VolumeVoces")
			
			; - Pantalla.
			Copia_SubT%				= INI_GetValue(Fichero.INI_File,"Pantalla","SubTitulos")	
			Copia_Lenguaje%			= INI_GetValue(Fichero.INI_File,"Pantalla","Lenguaje")	
			
			
			INI_Free(Fichero.INI_File)
			
			If Copia_WIND% = 0
				ModoW% = 1
				
				
			Else 
				ModoW% = 2
				
				
				
					
					For X% = 1 To CountGfxModes3D()
						
						
						If GfxModeWidth(X%) = EscritorioAncho% And GfxModeHeight(x%) = EscritorioAlto% Then 
							
							
							If GfxModeWidth(Copia_ModoVideo%) &gt; EscritorioAncho And GfxModeHeight(Copia_ModoVideo%) &gt; EscritorioAlto% And GfxModeDepth(X%) = 32 Then 
								
								Copia_ModoVideo% = x 
								
							End If 
							
							
							
						End If 
						
						
					Next 
					
					
				
			End If 
			
			
			
			
			
			Graphics3D (GfxModeWidth(CountGfxModes3D()-CountGfxModes3D()+Copia_ModoVideo%),GfxModeHeight(CountGfxModes3D()-CountGfxModes3D()+Copia_ModoVideo%),GfxModeDepth(CountGfxModes3D()-CountGfxModes3D()+Copia_ModoVideo%), ModoW%)
				
			
			
		End If 		
	Else 
		RuntimeError "Error Nro: 000000"
	End If 
	Return InitFirst%
	
End Function 
</textarea><br><br>however in order to retrieve data from the height and width of the windows desktop, is that when the app is displayed on the desktop window mode, only available modes are displayed, but not on the desktop through windows, because if this were to happen that way, the user would choose by mistake so high, exceeding the width of the windows desktop and the application window would be much larger.<br><br>Thanks for attention. <br><br></td></tr></table><br>
<a name="1186910"></a>

<a name="1186911"></a>

<a name="1186926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yasha said, <div class="quote"> "You should be able to use EnumDisplaySettings to get unscaled results instead: <br><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd162611%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/dd162611%28v=vs.85%29.aspx</a> "  <br></div><br> Just out of curiosity, I tried for a while to figure out the <br><br> <b>EnumDisplaySettings</b> &amp; <b>EnumDisplayDevices</b> functions, <br><br> and I couldn't figure it out, it's obviously a complicated mess.<br><br> Here is the proposed <b>USER32.DECLS</b> addition<br><br>; .lib "user32.dll"<br>;<br>; EnumDisplaySettings%(lpszDeviceName$, iModeNum%, lpDevMode* ) : "EnumDisplaySettingsA"<br>; EnumDisplayDevices%(lpDevice$, iDevNum%, lpDisplayDevice*, dwFlags%) : "EnumDisplayDevicesA"<br><br>;---------------------------------------------------------------------- <br><br></td></tr></table><br>
<a name="1186921"></a>

<a name="1186922"></a>

<a name="1186923"></a>

<a name="1186930"></a>

<a name="1186931"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya,<br><br>The string arrays are fixed length strings even if the returned value doesn't fill the array, so use the maximum length possible when calculating sizes. DWORD, int, uint are 4 bytes, WORD and short are 2 bytes. TCHAR are 1 byte each for ANSI strings and 2 bytes for UNICODE string. ANSI strings use the *A version of functions ( EnumDisplaySettingsA ), and UNICODE is for the *W version ( EnumDisplaySettingsW ).<br><br>So armed with that information and choosing to use EnumDisplaySettingsA, dmSize is at byte offset 36 which would be a value of 156.<br><br>To use the EnumDisplaySettings* function you don't really need a lpszDeviceName value for the default display so leave it as an integer value of 0 or Null. The iModeNum parameter you would start at zero and keep increasing the value each time you call the function and if it returns a value greater than 0 then DEVMODE struct will be filled with data, you increase this value by 1 for the next display mode. If the return value is 0 then the function has failed signifying that there is no mode at the index of iNumMode, so you exit/quit the loop.<br><br>My Blitz3D is so rusty that it's seized up nowadays so I apologise in advance, but here's a 'Max version to display all modes returned using that function :-<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Extern "Win32"
	Function EnumDisplaySettingsA(lpString$z,iModeNum,dmDevMode:Byte Ptr)
EndExtern

Type _DEVMODE
	Field dmDeviceName0,dmDeviceName1,dmDeviceName2,dmDeviceName3,dmDeviceName4,dmDeviceName5,dmDeviceName6,dmDeviceName7
	Field dmSpecVersion:Short
	Field dmDriverVersion:Short
	Field dmSize:Short
	Field dmDriverExtra:Short
	Field dmFields
	Field dmPostition_x:Short,dmPosition_y:Short
	Field dmDisplayOrientation
	Field dmDisplayFixedOutput
	Field dmColor:Short
	Field dmDuplex:Short
	Field dmYResolution:Short
	Field dmTTOption:Short
	Field dmCollate:Short
	Field dmFormName0,dmFormName1,dmFormName2,dmFormName3,dmFormName4,dmFormName5,dmFormName6,dmFormName7
	Field dmLogPixels:Short
	Field dmBitsPerPel
	Field dmPelsWidth
	Field dmPelsHeight
	Field dmDisplayFlags
	Field dmDisplayFrequency
	Field dmICMMethod
	Field dmICMIntent
	Field dmMediaType
	Field dmDitherType
	Field dmReserved1
	Field dmReserved2
	Field dmPanningWidth
	Field dmPanningHeight
End Type 

Local DM:_DEVMODE = New _DEVMODE
DM.dmSize = 156

Local iMode = 0
While EnumDisplaySettingsA(Null,iMode,DM)
	DM.dmSize = 156
	Print "Width: " + DM.dmPelsWidth + " x " + "Height: " + DM.dmPelsHeight + " x " + DM.dmBitsPerPel
	iMode :+ 1
Wend
</textarea><br><br>' EDIT:- Added DM.dmSize inside the While loop to re-initialise correctly. <br><br></td></tr></table><br>
<a name="1186925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks col,  I shall try your code. Looks like you've figured it out. <img src="http://i37.photobucket.com/albums/e73/VirtLands/emoticons/MSN%20Emoticons/Happy/Happy_0201.gif"> <br><br></td></tr></table><br>
<a name="1186934"></a>

<a name="1186935"></a>

<a name="1186936"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello, I continuco struggling with Blitz3D, and apparently I have acceptable results as expected in the resolution change. User32 I only used to retrieve the height and width of the windows desktop.<br><br>I tested this on three machines, Windows XP / 7/8 and apparently is working correctly, let me know your opinion.<br><br>A greeting.<br><br><img src="http://i39.tinypic.com/f20wlj.png"><br><br>Download Here: <a href="http://www.mediafire.com/?5t7pwu74uaqax99" target="_blank">http://www.mediafire.com/?5t7pwu74uaqax99</a><br><br>:) <br><br></td></tr></table><br>
<a name="1186943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Addi</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm getting error code 000x9et <br><br></td></tr></table><br>
<a name="1186944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> OMG i`m Crazy!! <br><br></td></tr></table><br>
<a name="1186945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works well here.<br><br>Asus N56V, Intel i7, Windows8. <br><br></td></tr></table><br>
<a name="1186951"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Col<br>One concern, language change works correctly?, Are not oddly shaped buttons?<br><br>Greetings. <br><br></td></tr></table><br>
<a name="1186963"></a>

<a name="1186966"></a>

<a name="1186968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >virtlands</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> For me, it completely skips the menus and goes directly to the rotating figure.  <img src="http://i411.photobucket.com/albums/pp194/aeDream/hurt_zps211311e6.gif"> <br><br></td></tr></table><br>
<a name="1186973"></a>

<a name="1186976"></a>

<a name="1186977"></a>

<a name="1186978"></a>

<a name="1186979"></a>

<a name="1186980"></a>

<a name="1186981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>One concern, language change works correctly?, Are not oddly shaped buttons?<br> <br></div><br><br>Pardon my ignorance for not another language other than English ( Yes I have traveled the world a little and I feel ignorant for only knowing English ). After choosing Ingles for 1 - the selected tab and the 3 buttons at the bottom have no text. Changing screen again and every thing is perfect, graphics are good, images are good, all text is good.<br><br>Google translate:- [Perdonen mi ignorancia por no otro idioma que no sea Inglés (sí he viajado por todo el mundo un poco y me siento ignorante sólo para saber Inglés). Después de elegir Inglés para 1 - la ficha seleccionada y los 3 botones en la parte inferior no tener ningún texto. Cambiando pantalla de nuevo y todo es perfecto, los gráficos son buenos, las imágenes son buenas, todo el texto es bueno] <br><br></td></tr></table><br>
<a name="1187015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Col@ Pardon my ignorance for not... <br></div><br> <br>I appreciate your help, it is very important for me, well I also feel very ignorant of the world and my daily struggle is to learn something new, and kill the demons of ignorance. But greatly appreciate that you use the translator is a nice touch.<br><br>The problem seems to be related to ReadPixelFast happen and seek a solution.<br><br>new versión fix problem.<br><br><div class="quote">  @VirtLands For me, it completely skips the menus and goes directly to the rotating figure. <br></div><br><br>Operating System? Bits 32-64?, Graphics Card?<br><br><div class="quote"> @Addi I'm getting error code 000x9et  <br></div><br><br>That error is a mav, but not in that place happens if after changing screen resolution, or at the beginning. <br><br></td></tr></table><br>
<a name="1187022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://blitzbasic.com/Community/posts.php?topic=100496" target="_blank">http://blitzbasic.com/Community/posts.php?topic=100496</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
