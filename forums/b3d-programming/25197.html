<!DOCTYPE html><html lang="en" ><head ><title >Does CopyEntity create a new surface per instance?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Does CopyEntity create a new surface per instance?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Does CopyEntity create a new surface per instance?</a><br><br>
<a name="261695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >R0B0T0</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The reason for my question is that I'm building an outdoor environment and trying to figure out if it would be better to copyentity my tree and building models, or create all instances as a unique meshes and then combine the surfaces. <br><br></td></tr></table><br>
<a name="261703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm pretty sure copy entity creates now surfaces. <br><br></td></tr></table><br>
<a name="261728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's much better to combine them into meshes.  I've tested this. <br><br></td></tr></table><br>
<a name="261734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bouncer</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Copyentity doesn't create new surfaces. It just copies the mesh pointer. If you for example deform the mesh of a copied entity, all other entitys copied will also deform. <br><br></td></tr></table><br>
<a name="261782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's true, however you still get a speed hit the same as if each entity was a seperate mesh. <br><br></td></tr></table><br>
<a name="261799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would think the speed hit would depend on the GPU and how it handled it. It would also depend on if you wished to selectively show certain entities. If you combined all it all into one mesh  the more tris you add to the mesh the greater the speed hit. How many mesh additions/copied entities are you testing? <br><br></td></tr></table><br>
<a name="261812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >R0B0T0</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am aiming to have about 10-15 base models for the buildings, and maybe 5 for trees.  These will be used to create a settlement and the surrounding landscape.<br><br>I was hoping that CopyEntity was the solution as I could then texture the copied entities differently from the templates thus increasing the apparent variety of models.<br><br>SSwift, I am dissapointed at the results that you have found, but would you not get a comparable performance hit from not having unseen meshes culled?  As LilPuppy pointed out, if I AddMesh something like 200 buildings and one is in view, then presumably they will all get rendered? <br><br></td></tr></table><br>
<a name="261836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> We've done much better by not using one mesh.  Most of the time it's better to cull away the polygons and still have a good number of objects (I'm talking maybe 50 surfaces instead of 1).  <br><br>One benchmark I did using just spheres showed a FPS increase by rendering (only rendering, no collision or picks) spheres, but I think that the collision, pick, and possibly if you're using Sswift's own shadow system that having more entities is better.  I know the shadow system likes to cull away whole entities that cannot be receivers and I think the collision and pick systems also make certain similar checks for possible colliders.<br><br>As it is right now we're using a few meshes for visuals only, and then about 30 to 50 separate collision only (but not rendered, alpha=0) to use for picks and shadows.  However, even before we used this method we tested a few large meshes with fewer surfaces Vs. many separate surfaces and by culling away entities behind the camera is was faster (although more erratic). <br><br></td></tr></table><br>
<a name="261984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you have say a forest you should use tree-groups as added meshes but not the entire forest as one mesh. If you split the forest in groups of the size of 10 or twenty trees per mesh you can save a lot of surfaces but will use culling of entities behind the camera nonetheless. If you have a function that can add all trees to one mesh then it might be simple to use such groups instead. <br><br></td></tr></table><br>
<a name="262005"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> "SSwift, I am dissapointed at the results that you have found, but would you not get a comparable performance hit from not having unseen meshes culled?"<br><br><br>Let me make a clarification.<br><br>For each surface of each entity, regardless of whether you use copyentity or copymesh, you get a speed hit.<br><br>However, you also get a speed hit for the number of polygons that are visible at once.<br><br>There is a sweet-spot where selectively combining entities together and keeping them seperate gives you the best performance.  <br><br>I can't tell you where this sweet spot is, but I can tell you that it's likely to be vastly different from card to card.<br><br>What I suggest is combinig entities which are close to eachother.<br><br>The test that I did a while back was a test to see how many trees I could pack onto a terrain at once while still maintaining a framerate greater than 20fps.<br><br>With individual entities, the number of trees I could have at once was very low.  <br><br>However, I discovered that I could make "clumps" of trees that were near eahtoher into a single mesh with a single surface, and in doing so I was able to get 100,000 trees onto my terrain at once.<br><br>I may have been able to put even more if I worked at it some more to tweak the number of trees in each mesh.<br><br>Of course I did not have 100,000 trees visible at once.  I had a fraction of that visible at once.  The point was that as you walked around this huge terrain lots of trees were always in view.  <br><br>Btw, I used entityautofade in my demo.  I tried to do an octree, but I found it was very slow.  I'm not sure why.  It shouldn't have been.<br><br>Oh and also, the groups of trees I used were like 50-100 trees in a group.  That seemed to be the optimal number for a large fairly open terrain with trees that only went about a half mile into the distance.  My trees were just two planes each though.  WIth more detailed trees you'd have to use less obviously. <br><br></td></tr></table><br>
<a name="262018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >R0B0T0</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I think you are right about using smaller groups of combined meshes; I will have to experiment to find the correct number to include in each segment.<br><br>The nice thing is that since I am dynamically generating my models and using uv's per poly to do texture tiling on the buildings, I can mix up the uv's to vary the tiles per building even though the whole group will be using only 1 "tilemap" texture.  I would not be able to do it this way with copyentity as the mesh uv's could not be altered without affecting all copies. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
