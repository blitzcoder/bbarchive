<!DOCTYPE html><html lang="en" ><head ><title >Weird GetBrushTexture behavior...exactly what is this command for?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Weird GetBrushTexture behavior...exactly what is this command for?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Weird GetBrushTexture behavior...exactly what is this command for?</a><br><br>
<a name="272691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Observe:<br><br><pre class=code>Graphics3D 400,300,16,2
t=CreateTexture(2,2)
mesh=CreateMesh()
surf=CreateSurface(mesh)
b=CreateBrush()
BrushTexture b,t
PaintSurface surf,b
b=GetSurfaceBrush(surf)
RuntimeError GetBrushTexture(b,0)+"&lt;&gt;"+t
</pre> <br><br></td></tr></table><br>
<a name="272693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >poopla</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> GetBrushTexture returns a new texture handle.  It says so in the docs, it's the same texture, only different handle. <br><br></td></tr></table><br>
<a name="272694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, that would seem to make brushtexture entirely worthless.  However, I suspect something more is going on here.<br><br>In Blitz, if I'm not mistaken, when you apply a texture to an entity, and then free the texture, the entity remains textured.  Perhaps someone should confirm this though as I'm not positive.<br><br>Anyhow, if true, this implies that the texture is copied when you apply it to an entity.<br><br>However, when you edit a texture, any entity using that texture takes on it's new appearance.  This implies that the texture is NOT copied.<br><br>Either I'm mistaken, or Blitz is doing something funny with the textures.  And this might be causing you to get unexpected results from this operation. <br><br></td></tr></table><br>
<a name="272695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> "GetBrushTexture returns a new texture handle. It says so in the docs, it's the same texture, only different handle."<br><br><br>It says no such thing.  The docs, confusingly, state:<br><br>...<br><br>Returns the texture that is applied to the specified brush. <br><br>The optional index parameter allows you to specify which particular texture you'd like returning, if there are more than one textures applied to a brush. <br><br>You should release the texture returned by GetBrushTexture after use to prevent leaks! Use FreeTexture to do this. <br><br>To find out the name of the texture, use TextureName <br><br>...<br><br><br>This in particular is confusing:<br><br>"You should release the texture returned by GetBrushTexture after use to prevent leaks! Use FreeTexture to do this."<br><br>Why should returning the handle of the texture you assigned to the brush, and thus applied to the surface, then require you to use freetexture?<br><br><br>This is very confusing.  What exactly is going on internally?  Is the texture being COPIED to a NEW texture when you call this command?  Does this happen every time you call the command on a specific entity, or jsut the first time?  For what reason is the texture copied?<br><br>I thought the point of the brushtexture command was so that you could get the handle of the texture applied to a surface when you load a file that automatically applies the textures, or so that a third part library, like the YAL lightmapper for example, could get the texture applied to a speciifc surface of an entity passed to it by the user, so that it can then modify it, or get the color of the texels from it.<br><br>Why then would it need to copy anything?<br><br>Mark really needs to document these commands better.  There's no point in adding new commands if he doesn't document them well enough so that people can make proper use of them. <br><br></td></tr></table><br>
<a name="272696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> The only thing I can think of is that it can be used to compare file names to known textures, but that seems like a roundabout way of doing things. <br><br></td></tr></table><br>
<a name="272709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> This in particular is confusing: <br><br>"You should release the texture returned by GetBrushTexture after use to prevent leaks! Use FreeTexture to do this." <br><br>Why should returning the handle of the texture you assigned to the brush, and thus applied to the surface, then require you to use freetexture? <br><br><br>This is very confusing. What exactly is going on internally? Is the texture being COPIED to a NEW texture when you call this command? Does this happen every time you call the command on a specific entity, or jsut the first time? For what reason is the texture copied? <br></div><br><br>I completly agree. When I read the docs, I had exactly the same thoughts. Time for some testing, me thinks.<br><br>[EDIT]Ok, it doesn't seem to be copying the texture because even if I apply the newly acquired texture handle to another visible entity, the AvailVidMem() doesn't change. However, you can keep doing it over and over and over and the texture handle is always different, so it may be using system memory for all the extra handles. But since you can only free one texture, not both, it does kinda seem you're going to get memory leaks whether you like it or not. Or perhaps not if you only use it once per entity.[/EDIT] <br><br></td></tr></table><br>
<a name="272730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> GetSurfaceBrush() and GetEntityBrush() create a new brush based on the entity or brush data. This way you can free a brush or texture after applying it to an entity or surface, and then create a new brush to manipulate with GetSurfaceBrush() when you need it. <br><br></td></tr></table><br>
<a name="272893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ziltch</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should they be called <br>CopySurfaceBrush() and CopyEntityBrush() <br>instead of<br>GetSurfaceBrush() and GetEntityBrush() ? <br><br></td></tr></table><br>
<a name="272994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, those names makes more sense to me. <br><br></td></tr></table><br>
<a name="272998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Litobyte</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Humm so there is still no way to know what texture file was used for a determined entity / surface ? <br><br></td></tr></table><br>
<a name="273105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Binary_Moon</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Humm so there is still no way to know what texture file was used for a determined entity / surface ? <br></div><br><br>You mean apart from the texturename command<br><br><a href="http://www.blitzbasic.com/b3ddocs/command.php?name=texturename&amp;ref=goto" target="_blank">http://www.blitzbasic.com/b3ddocs/command.php?name=texturename&amp;ref=goto</a> <br><br></td></tr></table><br>
<a name="273125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> This does allow some cool stuff.<br><br>Mesh save routines can now account for textures, finally!<br><br>You can go through the limbs and surfaces of a loaded mesh and apply shaders or properties.<br><br>If FileName(texturename$)="caulk" ClearSurface surf <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
