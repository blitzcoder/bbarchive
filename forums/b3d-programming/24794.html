<!DOCTYPE html><html lang="en" ><head ><title >entity type</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >entity type</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >entity type</a><br><br>
<a name="257287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pudding</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any way to tell if an entity is a pivot or a bone? Or if an entity has/is a mesh?<br><br>The distinction between entity and mesh seems rather vague in Blitz. This code works most of the time:<br><br>For i = 1 To CountChildren(root)<br> c = GetChild(root,i)<br> If CountSurfaces(c) then ...<br><br>this works even though GetChild returns an entity and CountSurfaces takes a mesh - BUT if the child is a bone then CountSurfaces throws a memory access violation!<br><br>The simplest example:<br>p = CreatePivot()<br>CountSurfaces(p)<br><br>this throws an error instead of returning zero.<br><br>Am I missing something obvious? What command can I use before CountSurfaces to avoid a crash???<br><br>-Pudding <br><br></td></tr></table><br>
<a name="257353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sunteam Software</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could try using unique names for your bones so that you could get the entity name and if it matches....voila.<br><br><pre class=code>
;example
If EntityName$(c)="bone" then...
</pre> <br><br></td></tr></table><br>
<a name="257383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pudding</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was hoping for a solution that assumes nothing about the source. I'm using the code in a viewer that loads b3d files and its kind of lame that it would crash if some arbitrary naming convention weren't followed.<br><br>-Pudding <br><br></td></tr></table><br>
<a name="257559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you are loading a b3d file you can tell its a bone cos it says BONE in the chunk header in the file.  You need to parse the file. <br><br></td></tr></table><br>
<a name="257580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pudding</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sorry, parsing the b3d file for this kind of info is ridiculous - the language needs commands for basic queries of this sort. (btw not bashing your suggestion, thank you for offering a solution)<br><br>Guess it's time to head over to the feature request forum...<br><br>Maybe the bug report forum too - if Blitz is going to play all loosey-goosey with entities/meshes/bones/pivots then CountSurfaces(pivot) should return 0 instead of crashing...<br><br>-Pudding <br><br></td></tr></table><br>
<a name="264668"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pudding</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm revisiting this problem, so I thought I'd bump this up and see if anyone has found any workaround.<br><br>The problem I'm having is my Max B3d Viewer recurses through the scene to calculate a bounding box so it can put the default camera somewhere reasonable. Right now if it hits a bone that doesn't match my naming convention ("bone" or "bip" prefix) it crashes - and there's not a damned thing I can do about it!<br><br>I was going to resort to parsing the b3d file to build this bounding box, but right now the viewer can be used with .x and .3ds files as well. <br><br>Any ideas? <br><br>(Yes I could write .x and .3ds file parsers too, but please, Blitz is supposed to make things easier!!)<br><br>-Pudding <br><br></td></tr></table><br>
<a name="264686"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> There really isn't anyway round this.  It's either parse the files or hope that Mark adds commands for it.  Sorry I can't help more.  I'm in the same boat as you. <br><br></td></tr></table><br>
<a name="264724"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Skitchy</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> For this specific situation, what about this :-<br>Get the Max exporter to write out a temp file of *only* vertex positions (and maybe the tris as well if its easier) - just dont export the bones. This will give the equivelant of a LoadMesh() object as opposed to a LoadAnimMesh() object. <br>Then have the .b3d viewer calculate the extremities of the mesh from this data. Obviously, any animation will not be taken into account, but you'll be able to get a good idea of the bounding box, add a bit to it, and stick the camera in as neccessary.<br><br>Hope that helps in some way :)<br><br>BTW Pudding - did you read my suggestions for a 'bone-per-vertex' optimisation in the other thread (Announcing B3D PipeLine). If so, what are your thoughts on that? :) <br><br></td></tr></table><br>
<a name="264743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pudding</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Skitchy, those were some cool optimizations. <br><br>I've written a general animation key frame optimizer that approximates the sampled animation curves with far fewer keys. That reduces the file size considerably. As for optimizing the number of bones - I like your ideas, but they're a lot harder to implement! My first optimization is likely to be the option to not make bones for vertices that do not move...<br><br>It might be cool to implement your ideas in a post process tool; load a b3d file and interactively tweak optimization parameters. I'm toying with the idea of such a tool. It would also let you join multiple animation sequences together, that sort of thing...<br><br>As for the bounding box thing, I think I'm going to have to wait for Mark to add some commands... I can pretty much do what you describe with a b3d file, but .x and .3ds files would require a different solution and I'd like to use the viewer as a generic 3d viewer.<br><br>-Pudding <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
