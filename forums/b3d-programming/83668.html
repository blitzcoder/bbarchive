<!DOCTYPE html><html lang="en" ><head ><title >Mesh load terrain</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Mesh load terrain</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Mesh load terrain</a><br><br>
<a name="943872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know u guys proally dont have time to fix it, but i need some help fixing uv coordinate glitch. its some bad geometry.<br><br><img src="http://i406.photobucket.com/albums/pp148/DarkShadowWing/badgeom.png"> <br><br></td></tr></table><br>
<a name="943873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, guys. I have tried &amp; tried to fix ur code, but i still end up where i started. here's my code so far. download the zip provided above to try the code.<br><br>i added stuff as well. ull need a cloud texture. i will provide it to u. and a sea texture. which i cant provide to you. i say this because my sea texture isnt perfect.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; Meshterrain Demo, Version 1.001 by Krischan (webmaster@...)
;
; Make sure there are three images in the current folder:
;
; - a Heightmap (standard: 256x256 PNG)
; - a Colormap (standard: 2048x2048 JPG)
; - a detail Texture (standard: 512x512 PNG)
;
; This script will cut the images and display the heightmap/colormap as a tiled Mesh Terrain
;
; Textures and Heightmap generated with Large 3D Terrain SE 2.5 (http://www.bundysoft.com/L3DT)
; Based on a script from Ross C and this thread:
;
; <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1609" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1609</a>

; Settings
Global speed#	=	1			; Walk speed
Global scale#	=	1000.00		; map scale
Global tiles	=	16			; how many tiles in X -AND- Y direction? must be power of 2
Global mapsize	=	256			; overview map size
Global range#	=	100			; initial view range (100 = 100% map size)
Global showmap	=	1			; show map
Global fog		=	1			; use fog or not
Global gravity	=	2			; use gravity or not
Global wired	=	0			; show wireframe or not
Global raster	=	0			; show tile raster or not
Global border#	=	1		; 1.00 = 100% = walk along the borderline
Global vscale#	=	3.0			; vertical terrain scale divider (increase if using smaller hmaps)
Global ipos		=	30			; initial player y position

AppTitle "Monkey Island Meshterrain Demo 1.001"
HidePointer

Graphics3D 1024,768,32,2
AmbientLight 255, 255, 255

Global lake = CreatePlane()
ScaleEntity lake, 1000, 1, 1000

z1$ = LoadTexture("wave.PNG")
EntityAlpha lake, .01

EntityTexture lake, z1$
PositionEntity lake, 0, 2000, 0

Global lakez = CreatePlane()
ScaleEntity lakez, 1000, 1, 1000

EntityAlpha lakez,.2

EntityTexture lakez, z1$

ScaleTexture z1$, 1000, 1000

sky=CreatePlane()
ScaleEntity sky, 10, 1, 10
cloud=LoadTexture("RealClouds02.pcx",2)
ScaleTexture cloud,10000,10000
PositionEntity sky,0,2900,0
TurnEntity sky,0,0,180
EntityTexture sky,cloud

sky2=CreatePlane()
ScaleEntity sky2, 50, 1, 50
cloud2=LoadTexture("RealClouds02.pcx",2)
ScaleTexture cloud2,10000,10000
PositionEntity sky2,0,5000,0
TurnEntity sky2,0,0,180
EntityTexture sky2,cloud2

ms=MilliSecs() : SeedRnd(ms)

Dim hm(tiles,tiles),cm(tiles,tiles),tile(tiles,tiles)
Global cam,player,cam_pitch#,cam_yaw#,mvx#,mvy#,mvz#,targetpitch#,targetyaw#,sp#

hmap=LoadImage("heightmap.png")
cmap=LoadImage("colormap.jpg")
detail=LoadTexture("detail.png")

hmw=ImageWidth(hmap) : hmh=ImageHeight(hmap) : hmws=hmw/tiles : hmhs=hmh/tiles
cmw=ImageWidth(cmap) : cmh=ImageHeight(cmap) : cmws=cmw/tiles : cmhs=cmh/tiles

Global sw=hmw*range#

; create textures and heightmap tiles
x=1
Repeat
	y=1 
	Repeat
		cm(x,y)=CreateTexture(cmw/tiles,cmh/tiles,1+16+32)
		hm(x,y)=CreateImage((hmw/tiles)+1,(hmh/tiles)+1)
		y=y+1
	Until y&gt;tiles
	x=x+1
Until x&gt;tiles

; cut heightmap
x=hmws
Repeat
	y=hmhs
	Repeat
		CopyRect(x-hmws,y-hmhs,hmws+1,hmhs+1,0,0,ImageBuffer(hmap),ImageBuffer(hm(x/hmws,y/hmhs)))
	y=y+hmhs
	Until y&gt;hmh
	x=x+hmws
Until x&gt;hmw

; cut colormap
x=cmws
Repeat
	y=cmhs
	Repeat
		CopyRect(x-cmws,y-cmhs,cmws,cmhs,0,0,ImageBuffer(cmap),TextureBuffer(cm(x/cmws,y/cmhs)))
		If raster Then
			SetBuffer TextureBuffer(cm(x/cmws,y/cmhs))
			Color 255,0,0
			Rect(0,0,cmws,cmhs,0)
		EndIf
		y=y+cmhs
	Until y&gt;cmh
	x=x+cmws
Until x&gt;cmw

; resize and free unused images
ResizeImage cmap,mapsize,mapsize
FreeImage(hmap)
mf#=mapsize*1.0/hmw

; create mesh terrain tiles
x=0
Repeat
	y=0
	Repeat
		tx=1+Abs(x)/hmws : ty=1+Abs(y)/hmhs
		tile(tx,ty)=LoadMeshTerrain(hm(tx,ty),cm(tx,ty),detail,tx,ty)
		; find Xfighter in your Samples directory and use the textures in there

		PositionEntity tile(tx,ty),(x*scale#)-((hmw/2)*scale#),0,(y*scale#)+((hmh/2)*scale#)
		EntityType tile(tx,ty),2
		ScaleEntity tile(tx,ty),scale#,scale#,scale#
		y=y-hmhs
	Until y&lt;(-hmh+hmhs)
	x=x+hmws
Until x&gt;(hmw-hmws)

player=CreateCube()
PositionEntity player,0,ipos*scale#,4
EntityType player,1
EntityRadius player,1.0*scale#

ScaleEntity player, 100, 100, 100

cam=CreateCamera(player)
;PositionEntity cam,0,0,0
CameraZoom cam,.2
CameraFogColor cam,100,150,200
CameraClsColor cam,100,150,200
cam_yaw=230
targetyaw=230

AmbientLight 255,255,255

s=Speed(ms)

MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

Collisions 1,2,2,3

; Main loop
While Not KeyHit(1)

z# = z# + .0001
PositionTexture z1$, z#, z#

cl#=cl-.0003; this is the speed of the lower cloud level
PositionTexture cloud,cl,cl
cl2#=cl2-.00002; this is the speed of the upper cloud level
PositionTexture cloud2,cl2,cl2

If zoom# &lt;= 1 Then zoom# = 1

If zoom# &gt; 1.45 Then zoom# = 1.45

If MouseZ() Then zoom# = MouseZ()+zoom#*.0000001 : Else zoom# = 1

CameraZoom cam, zoom#

	FPS_C=FPS_C+1 
	If ms&lt;MilliSecs() 
		ms=MilliSecs()+1000 
		FPS=FPS_C 
		FPS_C=0 
	EndIf

	old=pos : pos=MouseZSpeed()
	
	; Keys
	If KeyHit(59) Then wired=1-wired		; F1 = Wireframe on/off
	If KeyHit(60) Then gravity=1-gravity	; F2 = Gravity on/off
	If KeyHit(61) Then fog=1-fog			; F3 = Fog on/off
	If KeyHit(28) Then showmap=1-showmap	; Return = Map on/off
	If KeyDown(201) Then sw=sw+hmw/16		; Page up = slow range increase
	If KeyDown(209) Then sw=sw-hmw/16		; Page down = slow range decrease
	
	If old=1 Then sw=sw+hmw					; Mouse Wheel up = fast range increase
	If old=-1 Then sw=sw-hmw				; Mouse Wheel down = fast range decrease
	
	If sw&lt;hmw Then sw=hmw

	PlayerControls()
	
	plx#=EntityX(player) : ply#=EntityY(player) : plz#=EntityZ(player)
	If gravity Then ply#=ply#-(sp#*50)
	If plx#&lt;((-hmw*border#)/2)*scale# Then plx=((-hmw*border#)/2)*scale#
	If plx#&gt;((hmw*border#)/2)*scale# Then plx#=((hmw*border#)/2)*scale#
	If plz#&lt;((-hmh*border#)/2)*scale# Then plz#=((-hmh*border#)/2)*scale#
	If plz#&gt;((hmw*border#)/2)*scale# Then plz#=((hmw*border#)/2)*scale#

	PositionEntity player,plx#,ply#,plz#
	
	CameraFogMode cam,fog
	CameraRange cam,0.1,sw
	CameraFogRange cam,0,sw

	WireFrame wired
	UpdateWorld
	RenderWorld
	
	Color 255,255,255
	Text 0,0,"Tris: "+TrisRendered()+"  FPS: "+FPS+"  Range: "+sw+"  Wireframe: "+wired+"  Gravity: "+gravity+"  Fog: "+fog+"  Build time: "+(s/1000.0)+" sec."+"zoom: "+zoom#+" gravity:"+mvy
	
	If showmap Then
		Color 0,0,0 : Rect 0,25,mapsize,mapsize,1 : DrawImage cmap,0,25
		Color 255,255,255 : Text 0,12,"X:"+Int(plx#)+" Y:"+Int(ply#)+" Z:"+Int(plz#)+" Pitch: "+cam_pitch+" Yaw: "+cam_yaw
		Color 255,0,0 : Oval((mapsize/2)+(plx#/scale#*mf#)-2,25+(mapsize/2)+(plz#*-1/scale#*mf#)-2,4,4,1)
	EndIf
	
	Flip 0

Wend

End

Function Updatecamera(cam1,follow,mindist#,maxdist#)  ;This function updates the camera

PointEntity cam1,follow  ;You may need to edit this out depending on your program

x# = EntityX(cam1)
y# = EntityY(cam1)
z# = EntityZ(cam1)

x1# = EntityX(follow)
y1# = EntityY(follow) ;the plus 10 is optional so your camera stays somewhat above your character... change if needed or remove completely
z1# = EntityZ(follow)

dx# = x#-x1#
dy# = y#-y1#
dz# = z#-z1#

dist# = Sqr((dx#*dx#) + (dy#*dy#) + (dz#*dz#))	;distance formula 3d (the reason I 'reinvented the wheel' here is because I needed the x y and z differences for later anyway so it is more efficient to use the variables twice than to have the computer do it for you)

If dist# &gt; maxdist# Then
	fct# = maxdist#/dist#
	dx# = dx#*fct#
	dy# = dy#*fct#
	dz# = dz#*fct#
ElseIf dist# &lt; mindist# Then
	fct# = mindist#/dist#
	dx# = dx#*fct#
	dy# = dy#*fct#
	dz# = dz#*fct#
EndIf

PositionEntity cam1, x1#+dx#,y1#+dy#,z1#+dz#		;This positions the camera where it needs to go.

End Function
Function Speed(ms) : s=(MilliSecs()-ms) : Return s : End Function

Function PlayerControls()

	mxspd# = MouseXSpeed()*0.25
	myspd# = MouseYSpeed()*0.25

	MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

	targetpitch = targetpitch + myspd
	targetpitch = ClampValue(targetpitch, -85,85)
	targetyaw = targetyaw - mxspd	

	cam_pitch = cam_pitch + (targetpitch - cam_pitch)/16.0
	cam_yaw = cam_yaw + (targetyaw - cam_yaw)/16.0
	
	RotateEntity player,0,cam_yaw,0
	RotateEntity cam,cam_pitch,0,0
	
	sp#=speed#
	If KeyDown(42) Or KeyDown(54) Then sp#=(speed#*5)	; Shift = Turbo
	If mvy# &lt;= .01 Then mvy# = .01

	If KeyDown(200) Then mvz=mvz+sp#			; Arrow up = forward
	If KeyDown(208) Then mvz=mvz-sp#			; Arrow down = backward
	If KeyDown(205) Then mvx=mvx+sp#			; Arrow right = right
	If KeyDown(203) Then mvx=mvx-sp#			; Arrow left = left
	
	If MouseDown(1) Then mvy=mvy+sp#			; LMB = raise
	If MouseDown(2) Then mvy=mvy-sp#			; RMB = lower
		
	If KeyDown(17) Then mvz=mvz+sp#				; W = forward
	If KeyDown(31) Then mvz=mvz-sp#				; S = backward
	If KeyDown(30) Then mvx=mvx-sp#				; A = left
	If KeyDown(32) Then mvx=mvx+sp#				; D = right

	If KeyDown(16) Then mvy=mvy+sp#				; Q = raise
	If KeyDown(18) Then mvy=mvy-sp#				; E = lower
	
	
	TranslateEntity player,0,mvy,0
	MoveEntity player,mvx,0,mvz

	mvx=mvx/1.01
	mvy=mvy/1.01
	mvz=mvz/1.01
	
End Function

Function ClampValue(Original#, low#, high#)

	If Original&lt;low  Then Return low
	If Original&gt;high Then Return high
	Return Original

End Function


Function LoadMeshTerrain(heightmap,colormap=False,detail=False,tx=0,ty=0)

	lessx=1 : If tx=ti Then lessx=2
	lessy=1 : If ty=ti Then lessy=2

	x = ImageWidth(heightmap)-lessx : y = ImageHeight(heightmap)-lessy

	mesh = CreateMesh() : surf = CreateSurface(mesh)

	For ly = 0 To y
		For lx = 0 To x
			AddVertex surf,lx,0,ly,1.0/lx,1.0/ly
		Next
	Next

	For ly = 0 To y-1
		For lx = 0 To x-1
			AddTriangle surf,lx+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)			
			AddTriangle surf,(lx+1)+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)+(x+1)
		Next
	Next
	
	PositionMesh mesh,0,0,-y

	SetBuffer ImageBuffer(heightmap) : LockBuffer ImageBuffer(heightmap)

	For lx = 0 To x
		For ly = 0 To y
			h=(ReadPixelFast(lx,y-ly) And $ff0000)/$10000
			index = lx + ((x+1)*ly)
			VertexCoords surf,index,VertexX(surf,index),h/vscale#,VertexZ(surf,index)
			VertexTexCoords surf,index,lx,(y-ly)
		Next
	Next

	UnlockBuffer ImageBuffer(heightmap) : SetBuffer BackBuffer()
	
	UpdateNormals mesh
	
	If colormap EntityTexture mesh,colormap,0,0 : ScaleTexture colormap,x,y
	If detail EntityTexture mesh,detail,0,2 : ScaleTexture detail,2,2 : TextureBlend detail,5
			
	Return Mesh
	
End Function</textarea> <br><br></td></tr></table><br>
<a name="943874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cloud texture: <a href="http://www.mediafire.com/download.php?zgmjlieydgl" target="_blank">http://www.mediafire.com/download.php?zgmjlieydgl</a> <br><br></td></tr></table><br>
<a name="943883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Abrexxes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please, next time upload in 32bit TIFF to make DSL6000 users happy! (or optimize it to make us all happy) ;)<br><br><img src="http://abrexxes.huntingsoftware.de/temp5/badgeom.png"> <br><br></td></tr></table><br>
<a name="943884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry abrexxes &gt;&lt; <br><br></td></tr></table><br>
<a name="943901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Meh, don't worry about it too much, DSW; just check on the image filesize. If it's over 500KB, try to shrink it down. JPEGs are usually smaller; if you have Photoshop or the GIMP, you can tune their settings to get the perfect balance of quality vs. size.<br><br>With regards to your actual problem, though, I wish I could help, but UV mapping is a <i>very</i> new concept to me, so I'm not much good. T_T <br><br></td></tr></table><br>
<a name="943902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I understand. :) <br><br></td></tr></table><br>
<a name="944064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I updated my load terrain mesh function in the archives. I believe that code uses my old version, with the old UV bugs. My new version should work perfectly.<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1609" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1609</a> <br><br></td></tr></table><br>
<a name="944091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ross, this leads back to the same function I've been using. LoadMeshTerrain. and I tried the other 2, but I cant seem to move camera w/ top function OR use a map w/ a dot to show position of player.<br><br>the 2nd function doesnt even show the terrain. loadterrain3().<br><br>here's my code so far:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; Meshterrain Demo, Version 1.001 by Krischan (webmaster@...)
;
; Make sure there are three images in the current folder:
;
; - a Heightmap (standard: 256x256 PNG)
; - a Colormap (standard: 2048x2048 JPG)
; - a detail Texture (standard: 512x512 PNG)
;
; This script will cut the images and display the heightmap/colormap as a tiled Mesh Terrain
;
; Textures and Heightmap generated with Large 3D Terrain SE 2.5 (http://www.bundysoft.com/L3DT)
; Based on a script from Ross C and this thread:
;
; <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1609" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1609</a>

Global dropfile$

dropfile$ = "C:\Documents and Settings\zeldaX\Desktop\Angel Theme Song-Sanctuary Extended Remix.mp3"

Include "bass.bb"

If BASS_Init(-1,44100,0,0,BASS_NULL)&lt;&gt;1 Then RuntimeError "Sound not ready":End

			DropPath=dp_RequestedPath()
			DropQuant=dp_RequestedFileCount()
			
			;Delete old files
			If DragDrop=1 Then
				If DropQuant&gt;0 Then
					TrackPos=0
					TrackAnz=0
					BASS_ChannelStop(FBassHandle)
				End If
			End If
			
			For DropCount=0 To DropQuant-1
				DropFile$=dp_RequestedPath()+"\"+dp_RequestedFile(DropFile$)
			Next
			
FBassHandle=BASS_StreamCreateFile(0,DropFile$,0,0,BASS_MUSIC_FLOAT)

BASS_ChannelPlay(FBassHandle,BASS_TRUE)

Global black,red,blue,redt,bluet 

; Settings
Global speed#	=	1			; Walk speed
Global scale#	=	1000.00		; map scale
Global tiles	=	16			; how many tiles in X -AND- Y direction? must be power of 2
Global mapsize	=	256			; overview map size
Global range#	=	100			; initial view range (100 = 100% map size)
Global showmap	=	1			; show map
Global fog		=	1			; use fog or not
Global gravity	=	2			; use gravity or not
Global wired	=	0			; show wireframe or not
Global raster	=	0			; show tile raster or not
Global border#	=	1-.01		; 1.00 = 100% = walk along the borderline
Global vscale#	=	3.0 		; vertical terrain scale divider (increase if using smaller hmaps)
Global ipos		=	30			; initial player y position

AppTitle "Monkey Island Meshterrain Demo 1.001"
HidePointer

Graphics3D 1024,768,32,2
AmbientLight 255, 255, 255

Global lake = CreatePlane()
ScaleEntity lake, 1000, 1, 1000

z1$ = LoadTexture("wave.png")

EntityAlpha lake, .01

EntityTexture lake, z1$
PositionEntity lake, 0, 2000, 0

Global lakez = CreatePlane()
ScaleEntity lakez, 1000, 1, 1000

EntityAlpha lakez,.2

EntityTexture lakez, z1$

ScaleTexture z1$, 1000, 1000

sky=CreatePlane()
ScaleEntity sky, 10, 1, 10
cloud=LoadTexture("RealClouds02.pcx",2)
ScaleTexture cloud,10000,10000
PositionEntity sky,0,2900,0
TurnEntity sky,0,0,180
EntityTexture sky,cloud

sky2=CreatePlane()
ScaleEntity sky2, 50, 1, 50
cloud2=LoadTexture("RealClouds02.pcx",2)
ScaleTexture cloud2,10000,10000
PositionEntity sky2,0,5000,0
TurnEntity sky2,0,0,180
EntityTexture sky2,cloud2

ms=MilliSecs() : SeedRnd(ms)

Dim hm(tiles,tiles),cm(tiles,tiles),tile(tiles,tiles)
Global cam,player,cam_pitch#,cam_yaw#,mvx#,mvy#,mvz#,targetpitch#,targetyaw#,sp#
Global hmap = loadterrain3("heightmap.png","colormap.jpg","detail.png")
player=CreateCube()
PositionEntity player,0,ipos*scale#,4
EntityType player,1
EntityRadius player,1.0*scale#

ScaleEntity player, 100, 100, 100

cam=CreateCamera(player)
;PositionEntity cam,0,0,0
CameraZoom cam,.2
CameraFogColor cam,100,150,200
CameraClsColor cam,100,150,200
cam_yaw=230
targetyaw=230

AmbientLight 255,255,255

s=Speed(ms)

MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

Collisions 1,2,2,3

;============example senario===============
;map=Init3Dglass(cam,1) 

; Main loop
While Not KeyHit(1)

az# = az# + .0001
PositionTexture z1$, az#, az#

cl#=cl-.0003; this is the speed of the lower cloud level
PositionTexture cloud,cl,cl
cl2#=cl2-.00002; this is the speed of the upper cloud level
PositionTexture cloud2,cl2,cl2

If zoom# &lt;= 1 Then zoom# = 1

If zoom# &gt; 1.45 Then zoom# = 1.45

If MouseZ() Then zoom# = MouseZ()+zoom#*.01^100 : Else zoom# = 1

CameraZoom cam, zoom#

	FPS_C=FPS_C+1 
	If ms&lt;MilliSecs() 
		ms=MilliSecs()+1000 
		FPS=FPS_C 
		FPS_C=0 
	EndIf

	old=pos : pos=MouseZSpeed()
	
	; Keys
	If KeyHit(59) Then wired=1-wired		; F1 = Wireframe on/off
	If KeyHit(60) Then gravity=1-gravity	; F2 = Gravity on/off
	If KeyHit(61) Then fog=1-fog			; F3 = Fog on/off
	If KeyHit(28) Then showmap=1-showmap	; Return = Map on/off
	If KeyDown(201) Then sw=sw+hmw/16		; Page up = slow range increase
	If KeyDown(209) Then sw=sw-hmw/16		; Page down = slow range decrease
	
	If old=1 Then sw=sw+hmw					; Mouse Wheel up = fast range increase
	If old=-1 Then sw=sw-hmw				; Mouse Wheel down = fast range decrease
	
	If sw&lt;hmw Then sw=hmw

	PlayerControls()
	
	plx#=EntityX(player) : ply#=EntityY(player) : plz#=EntityZ(player)
	If gravity Then ply#=ply#-(sp#*50)
	If plx#&lt;((-hmw*border#)/2)*scale# Then plx=((-hmw*border#)/2)*scale#
	If plx#&gt;((hmw*border#)/2)*scale# Then plx#=((hmw*border#)/2)*scale#
	If plz#&lt;((-hmh*border#)/2)*scale# Then plz#=((-hmh*border#)/2)*scale#
	If plz#&gt;((hmw*border#)/2)*scale# Then plz#=((hmw*border#)/2)*scale#

	PositionEntity player,plx#,ply#,plz#
	
	CameraFogMode cam,fog
	CameraRange cam,0.1,sw
	CameraFogRange cam,0,sw

	WireFrame wired
	
;	Update3Dglass(cam,map,redt,bluet) 
	
	UpdateWorld
	RenderWorld
	
	Color 255,255,255
	Text 0,0,"Tris: "+TrisRendered()+"  FPS: "+FPS+"  Range: "+sw+"  Wireframe: "+wired+"  Gravity: "+gravity+"  Fog: "+fog+"  Build time: "+(s/1000.0)+" sec."+"zoom: "+zoom#+" gravity:"+mvy
	
;	If showmap Then
;		Color 0,0,0 : Rect 0,25,mapsize,mapsize,1 : DrawImage cmap,0,25
;		Color 255,255,255 : Text 0,12,"X:"+Int(plx#)+" Y:"+Int(ply#)+" Z:"+Int(plz#)+" Pitch: "+cam_pitch+" Yaw: "+cam_yaw
;		Color 255,0,0 : Oval((mapsize/2)+(plx#/scale#*mf#)-2,25+(mapsize/2)+(plz#*-1/scale#*mf#)-2,4,4,1)
;	EndIf
	
	Flip 0

Wend

BASS_Stop()

End

Function Init3Dglass(cam,map)
    black=MakeQuad(cam)
    EntityAlpha black,1
    PositionEntity black,0,0,1

	redt=CreateTexture(map,map)
    red=MakeQuad(cam)
    EntityColor red,255,0,0
    EntityFX red,1
    EntityBlend red,3
    PositionEntity red,0,0,1
    TextureBlend redt,5
    EntityTexture red,redt

	bluet=CreateTexture(map,map)
    blue=MakeQuad(cam)
    EntityColor blue,0,255,255
    EntityFX blue,1
    EntityBlend blue,3
    PositionEntity blue,0,0,1
    TextureBlend bluet,5
    EntityTexture blue,bluet
	
	Return map
End Function

Function MakeQuad(cam)
    q = CreateMesh(cam)
	s = CreateSurface(q)
	AddVertex s, -1, 1, 0, 0, 0
	AddVertex s, 1, 1, 0, 1, 0
	AddVertex s, -1,-1, 0, 0, 1
	AddVertex s, 1,-1, 0, 1, 1
   	AddTriangle s, 0, 1, 2
	AddTriangle s, 3, 2, 1
	
	Return q
End Function

Function Update3Dglass(cam,map,rtext,btext)
    HideEntity red
    HideEntity blue
    HideEntity black

	CameraViewport cam, 0, 0, map, map
    
	;Make red texture
    MoveEntity cam,-.2,0,0
    RenderWorld
    CopyRect 0,0,map,map,0,0,BackBuffer(),TextureBuffer(rtext)

    ;Make blue texture
    MoveEntity cam,.4,0,0
    RenderWorld
    CopyRect 0,0,map,map,0,0,BackBuffer(),TextureBuffer(btext)

	;Reset viewport
	CameraViewport Cam,0,0,GraphicsWidth(),GraphicsHeight()
    MoveEntity cam,-.2,0,0
    
	;Show textures
	ShowEntity red
    ShowEntity blue
    ShowEntity black
End Function

Function Updatecamera(cam1,follow,mindist#,maxdist#)  ;This function updates the camera

PointEntity cam1,follow  ;You may need to edit this out depending on your program

x# = EntityX(cam1)
y# = EntityY(cam1)
z# = EntityZ(cam1)

x1# = EntityX(follow)
y1# = EntityY(follow) ;the plus 10 is optional so your camera stays somewhat above your character... change if needed or remove completely
z1# = EntityZ(follow)

dx# = x#-x1#
dy# = y#-y1#
dz# = z#-z1#

dist# = Sqr((dx#*dx#) + (dy#*dy#) + (dz#*dz#))	;distance formula 3d (the reason I 'reinvented the wheel' here is because I needed the x y and z differences for later anyway so it is more efficient to use the variables twice than to have the computer do it for you)

If dist# &gt; maxdist# Then
	fct# = maxdist#/dist#
	dx# = dx#*fct#
	dy# = dy#*fct#
	dz# = dz#*fct#
ElseIf dist# &lt; mindist# Then
	fct# = mindist#/dist#
	dx# = dx#*fct#
	dy# = dy#*fct#
	dz# = dz#*fct#
EndIf

PositionEntity cam1, x1#+dx#,y1#+dy#,z1#+dz#		;This positions the camera where it needs to go.

End Function
Function Speed(ms) : s=(MilliSecs()-ms) : Return s : End Function

Function PlayerControls()

	mxspd# = MouseXSpeed()*0.25
	myspd# = MouseYSpeed()*0.25

	MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

	targetpitch = targetpitch + myspd
	targetpitch = ClampValue(targetpitch, -85,85)
	targetyaw = targetyaw - mxspd	

	cam_pitch = cam_pitch + (targetpitch - cam_pitch)/16.0
	cam_yaw = cam_yaw + (targetyaw - cam_yaw)/16.0
	
	RotateEntity player,0,cam_yaw,0
	RotateEntity cam,cam_pitch,0,0
	
	sp#=speed#
		
	If KeyDown(42) Or KeyDown(54) Then sp#=(speed#*5)	; Shift = Turbo
	If mvy# &lt;= 10*4 Then mvy# = 10*4
	
	If KeyDown(200) Then mvz=mvz+sp#			; Arrow up = forward
	If KeyDown(208) Then mvz=mvz-sp#			; Arrow down = backward
	If KeyDown(205) Then mvx=mvx+sp#			; Arrow right = right
	If KeyDown(203) Then mvx=mvx-sp#			; Arrow left = left
	
	If MouseDown(1) Then mvy=mvy+sp#			; LMB = raise
	If MouseDown(2) Then mvy=mvy-sp#			; RMB = lower
		
	If KeyDown(17) Then mvz=mvz+sp#				; W = forward
	If KeyDown(31) Then mvz=mvz-sp#				; S = backward
	If KeyDown(30) Then mvx=mvx-sp#				; A = left
	If KeyDown(32) Then mvx=mvx+sp#				; D = right

	If KeyDown(16) Then mvy=mvy+sp#				; Q = raise
	If KeyDown(18) Then mvy=mvy-sp#				; E = lower
	
	TranslateEntity player,0,mvy,0
	MoveEntity player,mvx,0,mvz

	mvx=mvx/1.01
	mvy=mvy/1.01
	mvz=mvz/1.01
	
End Function

Function ClampValue(Original#, low#, high#)

	If Original&lt;low  Then Return low
	If Original&gt;high Then Return high
	Return Original

End Function

; Y position is calculated by: scale * pixel colour on loaded image.

; PLEASE NOTE: You must clamp the texture your applying if it is spread across the whole mesh.
;              If you don't, it will bleed across to the opposite side. Clamp with flags 16 + 32
Function load_terrain(heightmap$,y_scale#=1,texture1$="",t_flag1 = 1,texture2$="",t_flag2 = 1,texture3$="",t_flag3 = 1)


	temp = LoadImage(heightmap$)
	If temp = 0 Then Return 0
	
	x = ImageWidth(temp)
	DebugLog(" image width = "+x)
	y = ImageHeight(temp)

	mesh = CreateMesh()
	surf = CreateSurface(mesh)

	For ly = 0 To y-1 ; your doing -1 because the image pixels start at 1 and the vertex
					  ; indices start at 0
		For lx = 0 To x-1
			AddVertex surf,lx , 0, -ly, Float(lx)/(x-1), Float(ly)/(y-1)
		Next
	Next
	RenderWorld
	
	AddTriangle surf, 0, 65,64
	AddTriangle surf, 0, 1 ,65
	For ly = 0 To y-2
		For lx = 0 To x-2 ; leave the vertex counting an extra unit short, as the code below reaches
						  ; reaches one unit ahead to create the triangles

			; below is to simply explain the creation process and order of the triangles.
			; Triangles must be created in clockwise order, facing the camera, to be seen.
			current_y = ly*y
			next_y = (ly+1)*y
			current_x = lx
			next_x = lx+1
			;create the quad
			AddTriangle surf, current_y+current_x, next_y+next_x    , next_y + current_x
			AddTriangle surf, current_y+current_x, current_y+next_x , next_y + next_x
		Next
	Next


	PositionMesh mesh, -x/2.0,0,y/2.0 ; centre the mesh on the world axis.

	SetBuffer ImageBuffer(temp)
	For ly = 0 To y-1
		For lx = 0 To x-1
			GetColor lx,y-ly
			index = (ly*y) + lx
			VertexCoords surf, index , VertexX(surf,index), ColorRed()*y_scale, VertexZ(surf,index)
		Next
	Next
	SetBuffer BackBuffer()
	
	UpdateNormals mesh
	
	If texture1 &lt;&gt; "" Then
		t1 = LoadTexture(texture1,t_flag1)
		If t1 = 0 Then RuntimeError(" Error in load_terrain() function: Texture1 not found from filename given")
		EntityTexture mesh,t1,0,0
	End If
	If texture2 &lt;&gt; "" Then
		t2 = LoadTexture(texture2,t_flag2)
		If t2 = 0 Then RuntimeError(" Error in load_terrain() function: Texture2 not found from filename given")
		EntityTexture mesh,t2,0,1
	End If
	If texture3 &lt;&gt; "" Then
		t3 = LoadTexture(texture3,t_flag3)
		If t3 = 0 Then RuntimeError(" Error in load_terrain() function: Texture3 not found from filename given")
		EntityTexture mesh,t3,0,2
	End If
		
	
	Return mesh
	
End Function

Function LoadTerrain3(hmap$,tmap$=0,lmap$=0)

	; load the heightmap
	temp = LoadImage(hmap$)
	If temp = 0 Then RuntimeError "Heightmap image "+hmap$+" does not exist." : Return 0
	
	; store heightmap dimensions
	x = ImageWidth(temp)
	y = ImageHeight(temp)

	; load texture and lightmaps
	tmap = LoadTexture(tmap$)
	lmap = LoadTexture(lmap$)
	
	; auto scale the textures to the right size
	If tmap ScaleTexture tmap,x,y
	If lmap	ScaleTexture lmap,x,y

	; start building the terrain
	mesh = CreateMesh()
	surf = CreateSurface(mesh)

	; create some verts for the terrain
	For ly = 0 To y
		For lx = 0 To x
			AddVertex surf,lx,0,ly,1.0/lx,1.0/ly
		Next
	Next
	RenderWorld
	
	; connect the verts with faces
	For ly = 0 To y-1
		For lx = 0 To x-1
			AddTriangle surf,lx+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)
			AddTriangle surf,(lx+1)+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)+(x+1)
		Next
	Next
	
	; position the terrain to center 0,0,0
	PositionMesh mesh, -x/2.0,0,-y/2.0

	; alter vertice height to match the heightmap red channel
	SetBuffer ImageBuffer(temp)
	For lx = 0 To x
		For ly = 0 To y
			GetColor lx,y-ly
			index = lx + ((x+1)*ly)
			VertexCoords surf, index , VertexX(surf,index), ColorRed()/20.0,VertexZ(surf,index)
			; set the terrain texture coordinates
			VertexTexCoords surf,index,lx,-ly 
		Next
	Next
	SetBuffer BackBuffer()
	
	; update the terrain normals so lighting will look correct
	UpdateNormals mesh
	
	; apply texture map to index 0
	If tmap EntityTexture mesh,tmap,0,0
		
	; apply lightmap to index 1 with flag 2
	If lmap EntityTexture mesh,lmap,0,1 : TextureBlend lmap,2
	
	Return Mesh
End Function

Function LoadMeshTerrain(heightmap,colormap=False,detail=False,tx=0,ty=0)

	lessx=1 : If tx=ti Then lessx=2
	lessy=1 : If ty=ti Then lessy=2

	x = ImageWidth(heightmap)-lessx : y = ImageHeight(heightmap)-lessy

	mesh = CreateMesh() : surf = CreateSurface(mesh)

	For ly = 0 To y
		For lx = 0 To x
			AddVertex surf,lx,0,ly,1.0/lx,1.0/ly
		Next
	Next

	For ly = 0 To y-1
		For lx = 0 To x-1
			AddTriangle surf,lx+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)			
			AddTriangle surf,(lx+1)+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)+(x+1)
		Next
	Next
	
	PositionMesh mesh,0,0,-y

	SetBuffer ImageBuffer(heightmap) : LockBuffer ImageBuffer(heightmap)

	For lx = 0 To x
		For ly = 0 To y
			h=(ReadPixelFast(lx,y-ly) And $ff0000)/$10000
			index = lx + ((x+1)*ly)
			VertexCoords surf,index,VertexX(surf,index),h/vscale#,VertexZ(surf,index)
			VertexTexCoords surf,index,lx,(y-ly)
		Next
	Next

	UnlockBuffer ImageBuffer(heightmap) : SetBuffer BackBuffer()
	
	UpdateNormals mesh
	
	If colormap EntityTexture mesh,colormap,0,0 : ScaleTexture colormap,x,y
	If detail EntityTexture mesh,detail,0,2 : ScaleTexture detail,2,2 : TextureBlend detail,5
			
	Return Mesh
	
End Function</textarea><br><br>~DS~ <br><br></td></tr></table><br>
<a name="944228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't even use that code. Just use my code i posted in the archives. He has modified some of my code, so replacing it with the new version won't work.<br><br>And the function is called the exact same thing, yes. I have however, updated it and eliminated the bugs. <br><br></td></tr></table><br>
<a name="944234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> right, so how do i make the map appear on the screen as sprite like he did? w/ dot that cant go off the sprite? <br><br></td></tr></table><br>
<a name="944355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know. You'd need to write a map function :o) My function only taks a heightmap image and creates and textures a Blitz mesh. It would involve making a relationship between the players co-ords, and the ultimate size of the terrain i believe, and scaling it appropriately so it would show a map. <br><br></td></tr></table><br>
<a name="944559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberyoyo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Darkshadowing I have made some fixes to your program and removed a lot fof the seams.<br>look there:<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1609" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1609</a> <br><br></td></tr></table><br>
<a name="944605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is great cyber! :D Btw, could u tell me ur email? If not, its cool :) <br><br></td></tr></table><br>
<a name="944634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberyoyo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait a minute I  think I can improve it again. I'll post a newer version in this thread later today.<br>Sorry I'm a bit paranoid with my email :p <br><br></td></tr></table><br>
<a name="944667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >cyberyoyo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok here's my last effort. I couldn't improve on the seams but I cleaned up the code a bit.<br>It looks good enough for me ;)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; Meshterrain Demo, Version 1.001 by Krischan (webmaster@...)
;
; Make sure there are three images in the current folder:
;
; - a Heightmap (standard: 256x256 PNG)
; - a Colormap (standard: 2048x2048 JPG)
; - a detail Texture (standard: 512x512 PNG)
;
; This script will cut the images and display the heightmap/colormap as a tiled Mesh Terrain
;
; Textures and Heightmap generated with Large 3D Terrain SE 2.5 (http://www.bundysoft.com/L3DT)
; Based on a script from Ross C and this thread:
;
; <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1609" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1609</a>

; Settings
Global speed#	=	0.1			; Walk speed
Global scale#	=	100.00		; map scale
Global tiles	=	16			; how many tiles in X -AND- Y direction? must be power of 2
Global mapsize	=	256			; overview map size
Global range#	=	100			; initial view range (100 = 100% map size)
Global showmap	=	1			; show map
Global fog		=	1			; use fog or not
Global gravity	=	1			; use gravity or not
Global wired	=	0			; show wireframe or not
Global raster	=	0			; show tile raster or not
Global border#	=	0.99		; 1.00 = 100% = walk along the borderline
Global vscale#	=	8.0			; vertical terrain scale divider (increase if using smaller hmaps)
Global ipos		=	50			; initial player y position

Graphics3D 1024,768,32,1

ms=MilliSecs() : SeedRnd(ms)

Dim hm(tiles,tiles),cm(tiles,tiles),tile(tiles,tiles)
Global cam,player,cam_pitch#,cam_yaw#,mvx#,mvy#,mvz#,targetpitch#,targetyaw#,sp#

hmap=LoadImage("heightmap.png")
cmap=LoadImage("colormap.jpg")
detail=LoadTexture("detail.png")

hmw=ImageWidth(hmap) : hmh=ImageHeight(hmap) : hmws=hmw/tiles : hmhs=hmh/tiles
cmw=ImageWidth(cmap) : cmh=ImageHeight(cmap) : cmws=cmw/tiles : cmhs=cmh/tiles

Global sw=hmw*range#

; create textures and heightmap tiles
x=1
Repeat
	y=1 
	Repeat
		cm(x,y)=CreateTexture(cmw/tiles,cmh/tiles,1+16+32)
		hm(x,y)=CreateImage((hmw/tiles)+1,(hmh/tiles)+1)
		y=y+1
	Until y&gt;tiles
	x=x+1
Until x&gt;tiles

; cut heightmap
x=hmws
Repeat
	y=hmhs
	Repeat
		CopyRect(x-hmws,y-hmhs,hmws+1,hmhs+1,0,0,ImageBuffer(hmap),ImageBuffer(hm(x/hmws,y/hmhs)))
	y=y+hmhs
	Until y&gt;hmh
	x=x+hmws
Until x&gt;hmw

; cut colormap
cpt=0 : cptmax=tiles^2
tempimage=CreateImage(cmws+2,cmhs+2)
x=cmws
Repeat
	y=cmhs
	Repeat
		cpt=cpt+1
		Flip :Cls : Locate 0,0 : Print "Creating world. Chunk "+cpt+" of "+cptmax
		If KeyHit(1) Then end
	;*CHANGE!*
	;I have used a temporary image to interpolate the texture
		CopyRect(x-cmws-1,y-cmhs-1,cmws+2,cmhs+2,0,0,ImageBuffer(cmap),ImageBuffer(tempimage))
		ResizeImage tempimage,cmws,cmhs
		CopyRect(0,0,cmws,cmhs,0,0,ImageBuffer(tempimage),TextureBuffer(cm(x/cmws,y/cmhs)))
		If raster Then
			SetBuffer TextureBuffer(cm(x/cmws,y/cmhs))
			Color 255,0,0
			Rect(0,0,cmws,cmhs,0)
		EndIf
		y=y+cmhs
	Until y&gt;cmh
	x=x+cmws
Until x&gt;cmw

; resize and free unused images
ResizeImage cmap,mapsize,mapsize
FreeImage(hmap)
FreeImage tempimage
mf#=mapsize*1.0/hmw

; create mesh terrain tiles
x=0
Repeat
	y=0
	Repeat
		tx=1+Abs(x)/hmws : ty=1+Abs(y)/hmhs
		tile(tx,ty)=LoadMeshTerrain(hm(tx,ty),cm(tx,ty),detail,tx,ty)
		PositionEntity tile(tx,ty),(x*scale#)-((hmw/2)*scale#),0,(y*scale#)+((hmh/2)*scale#)
		EntityType tile(tx,ty),2
		ScaleEntity tile(tx,ty),scale#,scale#,scale#
		y=y-hmhs
	Until y&lt;(-hmh+hmhs)
	x=x+hmws
Until x&gt;(hmw-hmws)

player=CreatePivot()
PositionEntity player,0,ipos*scale#,0
EntityType player,1
EntityRadius player,1.0*scale#

cam=CreateCamera(player)
PositionEntity cam,0,0,0
CameraZoom cam,2
CameraFogColor cam,100,150,200
CameraClsColor cam,100,150,200
cam_yaw=230
targetyaw=230

AmbientLight 255,255,255

s=Speed(ms)

MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

Collisions 1,2,2,3

; Main loop
While Not KeyHit(1)

	FPS_C=FPS_C+1 
	If ms&lt;MilliSecs() 
		ms=MilliSecs()+1000 
		FPS=FPS_C 
		FPS_C=0 
	EndIf

	old=pos : pos=MouseZSpeed()
	
	; Keys
	If KeyHit(59) Then wired=1-wired		; F1 = Wireframe on/off
	If KeyHit(60) Then gravity=1-gravity	; F2 = Gravity on/off
	If KeyHit(61) Then fog=1-fog			; F3 = Fog on/off
	If KeyHit(28) Then showmap=1-showmap	; Return = Map on/off
	If KeyDown(201) Then sw=sw+hmw/16		; Page up = slow range increase
	If KeyDown(209) Then sw=sw-hmw/16		; Page down = slow range decrease
	
	If old=1 Then sw=sw+hmw					; Mouse Wheel up = fast range increase
	If old=-1 Then sw=sw-hmw				; Mouse Wheel down = fast range decrease
	
	If sw&lt;hmw Then sw=hmw

	PlayerControls()
	
	plx#=EntityX(player) : ply#=EntityY(player) : plz#=EntityZ(player)
	If gravity Then ply#=ply#-(sp#*50)
	If plx#&lt;((-hmw*border#)/2)*scale# Then plx=((-hmw*border#)/2)*scale#
	If plx#&gt;((hmw*border#)/2)*scale# Then plx#=((hmw*border#)/2)*scale#
	If plz#&lt;((-hmh*border#)/2)*scale# Then plz#=((-hmh*border#)/2)*scale#
	If plz#&gt;((hmw*border#)/2)*scale# Then plz#=((hmw*border#)/2)*scale#
	PositionEntity player,plx#,ply#,plz#
	
	CameraFogMode cam,fog
	CameraRange cam,0.1,sw
	CameraFogRange cam,0,sw

	WireFrame wired
	UpdateWorld
	RenderWorld
	
	Color 255,255,255
	Text 0,0,"Tris: "+TrisRendered()+"  FPS: "+FPS+"  Range: "+sw+"  Wireframe: "+wired+"  Gravity: "+gravity+"  Fog: "+fog+"  Build time: "+(s/1000.0)+" sec."
	
	If showmap Then
		Color 0,0,0 : Rect 0,25,mapsize,mapsize,1 : DrawImage cmap,0,25
		Color 255,255,255 : Text 0,12,"X:"+Int(plx#)+" Y:"+Int(ply#)+" Z:"+Int(plz#)+" Pitch: "+cam_pitch+" Yaw: "+cam_yaw
		Color 255,0,0 : Oval((mapsize/2)+(plx#/scale#*mf#)-2,25+(mapsize/2)+(plz#*-1/scale#*mf#)-2,4,4,1)
	EndIf
	
	Flip 0

Wend

End

Function Speed(ms) : s=(MilliSecs()-ms) : Return s : End Function

Function PlayerControls()

	mxspd# = MouseXSpeed()*0.25
	myspd# = MouseYSpeed()*0.25

	MoveMouse GraphicsWidth()/2,GraphicsHeight()/2

	targetpitch = targetpitch + myspd
	targetpitch = ClampValue(targetpitch, -85,85)
	targetyaw = targetyaw - mxspd	

	cam_pitch = cam_pitch + (targetpitch - cam_pitch)/16.0
	cam_yaw = cam_yaw + (targetyaw - cam_yaw)/16.0
	
	RotateEntity player,0,cam_yaw,0
	RotateEntity cam,cam_pitch,0,0
	
	sp#=speed#
	If KeyDown(42) Or KeyDown(54) Then sp#=(speed#*5)	; Shift = Turbo

	If KeyDown(200) Then mvz=mvz+sp#			; Arrow up = forward
	If KeyDown(208) Then mvz=mvz-sp#			; Arrow down = backward
	If KeyDown(205) Then mvx=mvx+sp#			; Arrow right = right
	If KeyDown(203) Then mvx=mvx-sp#			; Arrow left = left
	
	If MouseDown(1) Then mvy=mvy+sp#			; LMB = raise
	If MouseDown(2) Then mvy=mvy-sp#			; RMB = lower
		
	If KeyDown(17) Then mvz=mvz+sp#				; W = forward
	If KeyDown(31) Then mvz=mvz-sp#				; S = backward
	If KeyDown(30) Then mvx=mvx-sp#				; A = left
	If KeyDown(32) Then mvx=mvx+sp#				; D = right

	If KeyDown(16) Then mvy=mvy+sp#				; Q = raise
	If KeyDown(18) Then mvy=mvy-sp#				; E = lower
	
	
	TranslateEntity player,0,mvy,0
	MoveEntity player,mvx,0,mvz

	mvx=mvx/1.01
	mvy=mvy/1.01
	mvz=mvz/1.01
	
End Function

Function ClampValue(Original#, low#, high#)

	If Original&lt;low  Then Return low
	If Original&gt;high Then Return high
	Return Original

End Function


Function LoadMeshTerrain(heightmap,colormap=False,detail=False,tx=0,ty=0)


	x = ImageWidth(heightmap)-1 : y = ImageHeight(heightmap)-1

	mesh = CreateMesh() : surf = CreateSurface(mesh)

	For ly = 0 To y
		For lx = 0 To x
			AddVertex surf,lx,0,ly,1.0/lx,1.0/ly
		Next
	Next

	For ly = 0 To y-1
		For lx = 0 To x-1
			AddTriangle surf,lx+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)
			AddTriangle surf,(lx+1)+((x+1)*ly),lx+((x+1)*ly)+(x+1),(lx+1)+((x+1)*ly)+(x+1)
		Next
	Next
	
	PositionMesh mesh,0,0,-y

	SetBuffer ImageBuffer(heightmap) : LockBuffer ImageBuffer(heightmap)

	For lx = 0 To x
		For ly = 0 To y
			h=(ReadPixelFast(lx,y-ly) And $ff0000)/$10000
			index = lx + ((x+1)*ly)
			VertexCoords surf,index,VertexX(surf,index),h/vscale#,VertexZ(surf,index)
			VertexTexCoords surf,index,lx,(y-ly)
		Next
	Next

	UnlockBuffer ImageBuffer(heightmap) : SetBuffer BackBuffer()
	
	UpdateNormals mesh
	
	;*CHANGE!*
	;texture scale and detail texture scale changed
	If colormap EntityTexture mesh,colormap,0,0 : ScaleTexture colormap,x,y
	If detail EntityTexture mesh,detail,0,2 : ScaleTexture detail,8,8 : TextureBlend detail,5
			
	Return Mesh
	
End Function
</textarea> <br><br></td></tr></table><br>
<a name="944686"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is awesome! Thank you so much cyber!<br><br>The glitch is sorta annoying.<br><br>If anyone else would like to try to fix it 100%, please do.<br><br>If not, then thats fine.<br><br>~DS~ <br><br></td></tr></table><br>
<a name="944693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> DarkShadowWing, take a look in the code archives, i posted an update there. <br><br></td></tr></table><br>
<a name="944708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Holy CRAP! Kris, thats AWESOME!<br><br>HOW did u make this?!<br><br><a href="http://www.blitzbasic.com/gallery/view_pic.php?id=1910" target="_blank">http://www.blitzbasic.com/gallery/view_pic.php?id=1910</a><br><br>Can u do the same for LoadTerrain?!<br><br>Along with it reading terragen OR heightmap? <br><br></td></tr></table><br>
<a name="944873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Can u do the same for LoadTerrain?! <br></div><br>Sure, I'm working on it right now. In the screenshot I used an older code with a quadtree Terrain not capable of Vertex Shadows but with a very high resolution texture and a nice but unfinished realtime sky environment. The huge 8192x8192 texture is cutted down to 8x8=64 "smaller" textures with 1024x1024 pixels each. But this leads to the next problem (which is the same problem you encountered in the first post of this topic). You will notice the cutting seams of the texture, but only if you're close enough (in my latest demo there is a large texture stretched across all tiles so there a no seams). The solution here is to align a single row of texels along the right and bottom texture side with the neighbour texels of the neighbour textures per tile, hard to explain. Short: the opposite pixels must be "duplicated" to align seamless. If I have time I will post a demo later.<br><br>I wouldn't suggest using a heightmap, just think about the detail difference. A heightmap gives you 0...255 = 256 nuances. A terragen file gives you 0...65535 = 65536 nuances! This is 256 times more detailed! You must code it yourself - I don't need a heightmap anymore - the terragen loader works fine :-p There are nice tools like Wilbur, L3DT and of course Terragen out there that you don't need a paint program to create your landscape. Look at my island - the height information has been done in Wilbur only, and the colormap has been rendered out of it in L3DT.<br><br>Wilbur: <a href="http://www.ridgecrest.ca.us/~jslayton/wilbur.html" target="_blank">http://www.ridgecrest.ca.us/~jslayton/wilbur.html</a><br>L3DT: <a href="http://www.bundysoft.com/L3DT/" target="_blank">http://www.bundysoft.com/L3DT/</a> <br><br></td></tr></table><br>
<a name="945120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> How's it going? Do you need help?<br><br>With what little I can offer? <br><br></td></tr></table><br>
<a name="945412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you make it so the ter files have the same quality &amp; height as the heightmaps when using the older code? <br><br></td></tr></table><br>
<a name="949173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you finish? <br><br></td></tr></table><br>
<a name="949489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not yet. But I managed to find out the original files from my "monkey island 1" demo and it looks much better than the original with my new system. But I think the old island sucks now, my revised island looks much better and is optimized for this system. I think I can release a running demo soon. I still have to rewrite large parts of the source, clean it up and comment it, after that I'll post the source here. But there is much room for improvements, no optimizations yet (LOD or PVS).<br><br>Both terrains are ultra-high resolution (513x513 vertices), but still looks nice 4 times reduced (to 129x129) - in these screenshots I used the ultra resolution, running still fine here on my notebook (GF9600M GT, C2D 2.53GHz). Both use a 4096x4096 colormap texture, vertex colors (with vertex lights) and a detail map, nothing else. I only switched the two input files (terragen source and colormap texture).<br><br>The old Island:<br><img src="http://www.christianhart.de/bb/MI1_compare.jpg"><br><br>The new Island:<br><img src="http://www.christianhart.de/bb/MI2_compare.jpg"> <br><br></td></tr></table><br>
<a name="949503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Awesome! Keep it up!<br><br>Is that sun real or is it a texture or somethin? <br><br></td></tr></table><br>
<a name="949526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> The Sun is made out of 6 Quads with 4 different textures drawed over the sky with Entityorder. Three Sun Quads blended together (Flag 0,03, Alpha 1.0,0.5,0.25), blended again with two sun glow quads with different textures plus a brightness quad for the effect when you look direct into the sun it gets brighter (calculated smoothly by the distance screen center&lt;&gt;screen corners), Blend Modes 3,5,3. And the sun looks different depending on the day time (like the whole scene). Looks cool but not real. A single texture couldn't achieve such an effect. <br><br></td></tr></table><br>
<a name="949534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats awesome!<br><br>So when do u think this will be done mate? <br><br></td></tr></table><br>
<a name="949575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I arranged a first pre-alpha demo so don't expect a stable or optimized demo but you will get a good impression of my current work. Oh and it is still based on Ross C's meshterrain code :-) But read the readme.txt first!<br><br>3.5MB 7zip SFX Archive: <a href="http://www.christianhart.de/bb/terratilesdemo.exe" target="_blank">http://www.christianhart.de/bb/terratilesdemo.exe</a> <br><br></td></tr></table><br>
<a name="950124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since ross' code is open source can u please release the source when ur done? :) <br><br></td></tr></table><br>
<a name="950181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Take a look at this Showcase entry and answer your question yourself :-)<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=84108" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=84108</a> <br><br></td></tr></table><br>
<a name="950215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks :)<br><br>i found a few things u might add. make jump a little slower if at all possible, allow for when u switch to free camera mode (the 1 where it looks like ur running down a mountain, make it so that the player runs faster depending on the gravity, and if theres a little bit too much of gravity, the player will literally fall down the hill. and make it so the player can swim &amp; float :)<br><br>these are only ideas, do what u want to <br><br></td></tr></table><br>
<a name="951908"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> hows it going? :) <br><br></td></tr></table><br>
<a name="957168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Any headway yet? :) <br><br></td></tr></table><br>
<a name="958237"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sure. I had to rewrite the EVERYTHING but it is much more sophisticated now. The terrain is based on a quadtree now (still tiled) - that doubled the FPS rates! I spent a lot of time commenting, designing new maps and tuning the settings. I am nearly finished - I'm just thinking about improvements and trying some different settings now.<br><br>I renamed the project from "TerraTiles" to "BlitzTiles" (there is a company named like that dealing with real tiles so BlitzTiles is a very unique term) - so this will be a new project - the old non-quadtree code is antiquated now.<br><br>And here three candy map previews for my new Loading screen (I hate the black commandline-style loader), stay tuned for the program I plan to release it this week (the shots are 1:1 as they look in the program, I only added some text):<br><br><img src="http://www.christianhart.de/bb/blitztiles/desert_preview.jpg"><br>This map has been created completely with L3DT. In L3DT there is a template called "desert mesas", the map is named after it. I only added some steep mesa mountains. The map demonstrates a desert landscape with water holes and a very steep sun angle and a bright full moon night in a 1025 resolution. This map has a square footage of 105km<br><br><img src="http://www.christianhart.de/bb/blitztiles/monkeyisland_preview.jpg"><br>This map has been created completely with Wilbur. It is a very detailled island environment named after the similar looking island from the game "The Secret of Monkey Island". It is the only map using the huge 2049 resolution. This map has a square footage of 105km, too (ocean area not mentioned)<br><br><img src="http://www.christianhart.de/bb/blitztiles/zillertal_preview.jpg"><br>This map has been created out of real height data of the zillertal alps in Tirol / Austria using 3DEM, Wilbur and L3DT. Additional I added some description of mountain tops and local places. Although the map has only a 1025 resolution it covers the whole nature park. The visibility range is about 50km. This map has a huge square footage of 2123km! I really love to walk on this map because I spent my vacations quite often there, hiking the mountains. <br><br></td></tr></table><br>
<a name="958305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hambone</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Absolutely beautiful.  The last shot is easily one one of the prettiest landscape shots I have ever sen in B3D.<br><br>Very well done! <br><br></td></tr></table><br>
<a name="958342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Waiting for this eagerly. <br><br></td></tr></table><br>
<a name="958416"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree w/ @hambone &amp; @john blackledge. absolutely FASCINATING! :D Could you release the new source? I honestly think this should make the Blitz image archive :)<br><br>Thanks yet again for all the help you have given not only to me, but to other Blitz developers as well :)<br><br>I'm sure this will prove useful in the future! :)<br><br>Thank you! :)<br><br>~DS~ <br><br></td></tr></table><br>
<a name="958516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> That looks very nice Krischan, very nice indeed. Looking closely at your terrains, I <i>think</i> I figured something out: the texturing (grass, rock, etc) seems to be based on the slope angle of each area. Am I close? <br><br></td></tr></table><br>
<a name="958599"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzTiles is up. Have fun!<br><br><a href="/posts.php?topic=84809" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=84809</a> <br><br></td></tr></table><br>
<a name="958654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simply AMAZING! Thats all I can say... This thing is AMAZING! :O<br><br>Congrats, Krischan!<br><br>~DS~ <br><br></td></tr></table><br>
<a name="958672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could someone plz help me modify this, so depending on what angle the player is at on a hill, it will adjust the player speed using the added force of running up or down a hill, until the hill reaches a certain "dropoff" point, where the player will activate a trip &amp; fall animation making the player fall down the hill, and slip down the hill until the hill angle becomes walkable again, at which point the "get back up" animation activates, and the dwarf gets back up?<br><br>I have a sorta working version that is sorta what should be happening here: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">; aligns player to ground normal and depending on angle of hill, increases or decreases the speed of the player by the added force of running up or down the hill, and eventually activates a trip &amp; fall animation that makes the player trip and fall, followed by making the speed become normal again BT_PlayerSpeed = 0.25

;Note: It does NOT matter if the dwarf has a trip and fall animation AND the get back up animation, just try to add it anyway. An example: If Dwarf_Trips then activate_trip animation followed by the speed which is increased by the force of the fall followed by a get back up animation.

	If BT_PlayerAlign Then
		AlignToVector BT_Player,BT_NX,BT_NY,BT_NZ,2,0.1
		If BT_NZ &gt; 45
		BT_PlayerSpeed = BT_PlayerSpeed - .01
		Else If BT_NZ &lt; 45
		BT_PlayerSpeed = BT_PlayerSpeed + .01
		Else
		BT_PlayerSpeed = 0.25
		EndIf
	Else
		RotateEntity BT_Player,0,EntityYaw(BT_Player),0
	EndIf</textarea> <br><br></td></tr></table><br>
<a name="958808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> You should use the global Var "BT_NY#"! It will return the Y normal below the player. 1.0 is 100% flat and 0.0 is very steep, for example if the NY is below 0.75 you could start sliding. Put this before Flip 0 and walk around:<br><br>Text 0,0,BT_NY<br><br>But I think it is more complex. I did some tests with it but the player movement was not my main objective here. In one test I added four cubes around the player and checked the collision normals to find out if the player moves toward a cliff and what is "around" the player. Never really worked. <br><br></td></tr></table><br>
<a name="960911"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> No worries, my friend is learning Blitz, and will soon be able to teach me! :) He's WAY better than I am at figuring this stuff out! :) IF I get a fix, I will post it if he says its ok! :) Which am sure he will! :)<br>Thanks again, Krischan! :)<br><br>~SI~ <br><br></td></tr></table><br>
<a name="974596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> thought id bring this thread up again<br><br>hows the bug fixes going? <br><br></td></tr></table><br>
<a name="975043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Krischan</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bug fixes? BlitzTiles is released and it's up to you now. I'm working on my other projects (but nothing to mention at this stage). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
