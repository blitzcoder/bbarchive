<!DOCTYPE html><html lang="en" ><head ><title >Detecting the state of an exec'ed file</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Detecting the state of an exec'ed file</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Detecting the state of an exec'ed file</a><br><br>
<a name="622609"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> One you use fileexec to run a program, is there a way of detecting if its running or not?<br>Im trying to detect the state of a 'plug-in' exe.<br>I cant use the clipboard as im using that as a transport for commands.<br><br>I guess theres a way of doing it with a userlib, anyone know which one?<br><br>prehaps something like:<br>programisrunning = DetectAppTitle("myapptitle")<br><br>returns 1 or 0 <br><br></td></tr></table><br>
<a name="622616"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I remember correctly, the following code might not detect non-Blitz exe's, but it's worth a shot.<br><br>Userlib decls...<br><pre class=code>
.lib "kernel32.dll"
CreateMutexA%(lpMutexAttributes%,bInitialOwner%,lpName$):"CreateMutexA"
GetLastError%():"GetLastError"
</pre><br><br>Blitz code...<br><pre class=code>
CreateMutexA(0,1,"myapptitle")
If GetLastError()=183 Then Print "myapptitle is running"
</pre> <br><br></td></tr></table><br>
<a name="622700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >D4NM4N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> i tried it but couldnt seem to get any joy. Is apptitle just that, the actual text thats displayed on the windows title bar?<br><br>this one looks promising but i dont know how to assign a long pointer to a null terminated string in b3d<br><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wceui40/html/cereffindwindow.asp" target="_blank">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wceui40/html/cereffindwindow.asp</a><br><br>It looks like there are other functions as well where i could use the error state to confirm if running, but they all require a handle and ive no idea how to get that. <br><br></td></tr></table><br>
<a name="622721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeh, apptitle is the text in the title bar. You could try it with the process name too (blitzcc.exe etc)<br><br>To find the window handle try this...<br><br>Userlib decls...<br><pre class=code>
.lib "user32.dll"
FindWindowA%(NullString,WindowText$):"FindWindowA"
GetWindowLongA%(hWnd%,nIndex%):"GetWindowLongA"
</pre><br><br>Blitz code...<br><pre class=code>
Handle=FindWindowA("","myapptitle")
Long=GetWindowLongA(Handle,-16)
</pre><br><br>As with the previous example, it works ok in BlitzPlus but I'm not sure about Blitz3D. <br><br></td></tr></table><br>
<a name="622765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >octothorpe</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> A more "low tech" solution might involve relying on simple file system semaphores:<br><br>Create a blank file, then run your child process.  When the child process is finished, have it delete the file.  The parent process can simply check for the existance of the file every second or so. <br><br></td></tr></table><br>
<a name="622852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The full, proper, and very easy solution is handled by a DLL which I wrote:<br><a href="http://www.blitzbasic.com/toolbox/toolbox.php?tool=151" target="_blank">http://www.blitzbasic.com/toolbox/toolbox.php?tool=151</a><br><br>It currently uses CreateProcess to launch the program. That shouldn't matter much since it sticks to default values, but if you want the C++ source so that you can change it over to ShellExecuteEx, go ahead and email me.<br><br>As far as I know, the DLL works with any compiled program in existence. The Grasshopper Plugin System plugin creator tool uses RunProgram to execute 3 different external programs (a resource compiler, ResHacker, and XVI32) while keeping them completely synchronized 100% of the time. Grasshopper 0.4 also uses the DLL to run Notepad and know when it has been closed. <br><br></td></tr></table><br>
<a name="624078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> *Bump*<br>I would be quite upset if my contribution, which has a 90% chance of solving this problem with a high level of ease and perfection, was not commented on.<br>It doesn't look like the problem was actually totally solved previously, so... This bump is to aid D-Grafix, who must have missed his thread being added to. <br><br></td></tr></table><br>
<a name="624079"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> A common way to see if a thread is still active is to build in some windows messaging.<br><br>Send a message to the application via a global message or direct to the window and wait for a response.<br><br>Something like :-<br><br>Send "Are you Alive"<br>Respond "Yes I am"<br><br>This will also prevent multiple instances of the same application from being run. <br><br></td></tr></table><br>
<a name="624120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoeRetro</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> VIP3R gave everyone the proper answer.<br><br>Create a mutex to prevent multiple instances of your application from running.<br><br>Use FindWindow to detect a titled application that is running... <br><br></td></tr></table><br>
<a name="624147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, cool.<br>Thanks VIP3R! I've always wondered how to do mutexes.<br><br>Beware, though: Even with mutexes, you may encounter the need to place arbitrary and dangerous delays to avoid timing problems.<br>Mutexes are excellent for getting an application to ensure that it only has one instance running, though.<br><br>The RunProgram DLL, on the other hand, is a safe method to run programs which fixes the problem of arbitrary delays. It starts tracking from the moment that Windows thinks to launch the program and finishes the moment that it ends (Thus, no issues with timing). Also doesn't require any modifications to the app that is being launched, you don't need to know the window name of the launched program (which would not work in many cases... for example, the window for the app you are currently running to read this), the program being launched could take a millisecond to complete without tossing yours into an infinite loop (which is possible with some of the many techniques which I have explored for two of my projects), and the launched program doesn't even need to be in a window!<br><br><br>John:<br>www.blitzbasic.com/toolbox/toolbox.php?tool=151<br>(As mentioned above) <br><br></td></tr></table><br>
<a name="624183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Mr Pick.<br>What is this RunProgram DLL that you speak of? <br><br></td></tr></table><br>
<a name="624495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Barliesque</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @John Blackledge<br>Click on the link in Mr. Pickles' post above.<br><br>Another solution--not that another is needed--is to use the clipboard.  D-Grafix mentioned above that he's already using the clipboard to pass messages between other components of his project, and so he couldn't also use it for this purpose.  But it *could* be used by multiple processes...  If you allow multiple messages to be contained in the clipboard, with a sender/receiver tag for each message.  You could append and delete messages to/from a list and thus allow several components to exchange simple messages. <br><br></td></tr></table><br>
<a name="624527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice. Thanks Mr Pick! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
