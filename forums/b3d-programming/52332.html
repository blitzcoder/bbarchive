<!DOCTYPE html><html lang="en" ><head ><title >Need code for an object swinging on a line</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need code for an object swinging on a line</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Need code for an object swinging on a line</a><br><br>
<a name="584202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys<br><br>Do any of you have some code for an object hanging<br>on a piece of line and swinging sideways and in circles.<br><br>I need this for my next project Adventure fishing 3.<br>A fly fishing game.<br><br>Thanks<br>3DFish <br><br></td></tr></table><br>
<a name="584223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> On the one hand, that's a pretty vague request.  Normally I would ask for clarification on exactly what you want.  On the other hand, the fact that this is for a fishing game makes me assume the object is a fish pulling on the line and jerking around.<br><br>This isn't necessarily an ideal approach, but a simple trick would be to create a pivot at the end of the pole (ie. where the line is coming from) and parent the fish to that pivot.  Now if you rotate the pivot, the fish will be orbiting around that point. <br><br></td></tr></table><br>
<a name="584302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WolRon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Verlet constraints? <br><br></td></tr></table><br>
<a name="584501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks<br><br>The line is fly line hanging from the tip of a fly rod.<br>A fly will be attached to the end of the line.<br>I need a swinging effect (the fly).<br><br>My sin,cos,tan maths are a bit on the shaky side. <br><br></td></tr></table><br>
<a name="584514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhocking</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> "swinging" is actually the part I wanted clarification on.  Are you talking about the movement of the fly during casting? <br><br></td></tr></table><br>
<a name="584536"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> no, only the movement of the fly when holding the rod before a cast. <br><br></td></tr></table><br>
<a name="584549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeppe Nielsen</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just something I just coded :-)<br><br>Try to catch the box with the rod.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Graphics 800,600,16,2
SetBuffer BackBuffer()

num=25

l#=200
dl#=l/num

x#=400
For n=1 To num
	
	If n=1
		startpoint.point=pointnew(x,100,True)
		p1.point=startpoint
	Else
	
		If n=num
		
			endpoint.point=pointnew(x,100,False,5)
			p1.point=endpoint
		
		Else
		
			p1.point=pointnew(x,100)
		
		EndIf
		
		contraintnew p1,p2.point
		
	EndIf
	
	p2.point=p1
	
	x#=x#+dl
Next


p1.point=PointNew(200-25,100)
p2.point=PointNew(250-25,100)
p3.point=PointNew(250-25,150)
p4.point=PointNew(200-25,150)
boxhandle.point=pointnew(225-25,75,False,5)

ContraintNew p1,p2
ContraintNew p2,p3
ContraintNew p3,p4
ContraintNew p4,p1
ContraintNew p1,p3
ContraintNew p2,p4
ContraintNew p1,boxhandle
ContraintNew p2,boxhandle



rodx=400
rody=300

Repeat


Cls

If pick=0
Text 400,20,"Catch the box with the fising rod",1
Else
Text 400,20,"Box caught",1
Text 400,40,"Press mouse button to release box",1
EndIf


PointUpdate
ContraintUpdate

mdx=(MouseX()-rodx)
mdy=(MouseY()-rody)

angle=ATan2(mdy,mdx)

px=rodx+Cos(angle)*200
py=rody+Sin(angle)*200

Line rodx,rody,px,py

PointMove startpoint,px,py

Select pick

Case 0

dx#=endpoint\x-boxhandle\x
dy#=endpoint\y-boxhandle\y
If Sqr(dx*dx+dy*dy)&lt;8
boxcontraint.contraint=contraintnew( endpoint,boxhandle)

pick=1
EndIf

Case 1

If MouseDown(1)

Delete boxcontraint
pick=2

EndIf

Case 2

dx#=endpoint\x-boxhandle\x
dy#=endpoint\y-boxhandle\y
If Sqr(dx*dx+dy*dy)&gt;16

pick=0

EndIf

End Select


PointDraw
ContraintDraw

Flip

Until KeyDown(1)
End






Type point

	Field x#,y#
	
	Field vx#,vy#
	
	Field lock
	
	Field size
	
End Type


Function PointNew.point(x#,y#,lock=False,size=0)

	p.point=New point
	
	PointMove(p,x#,y#)
	
	p\lock=lock
	
	p\size=size
	
	Return p
End Function

Function PointMove(p.point,x#,y#)

	p\x=x
	p\y=y
	
End Function


Function PointDraw()

For p.point=Each point
	If p\size&gt;0
	
	Oval p\x-p\size,p\y-p\size,p\size+p\size,p\size+p\size,True
	
	EndIf
Next

End Function


Function PointUpdate(dt#=0.1,gravity#=5)

For p.point=Each point
	
	p\vy=p\vy+gravity*dt

	p\vx=p\vx*0.975 ;-Sgn(p\vx)*0.5*dt
	p\vy=p\vy*0.975 ;-Sgn(p\vy)*0.5*dt	

	If p\lock=True
	
		p\vx=0
		p\vy=0
		
	EndIf
		
	p\x=p\x+p\vx*dt
	p\y=p\y+p\vy*dt

	
	If p\y&gt;GraphicsHeight()
	
		p\vy=-p\vy*0.5
		p\y=GraphicsHeight()
	
	EndIf
		
	
Next

End Function

Function PointForce(p.point,fx#,fy#)

p\vx=p\vx+fx
p\vy=p\vy+fy

End Function

Type contraint

	Field s.point
	Field e.point
	Field l# ;relax length of contraint
	Field stiffness# ; stiffness of contraint
	Field damping# ; damping of contraint	
	
End Type

Function ContraintNew.contraint(s.point,e.point,stiffness#=18,damping#=20)

	c.contraint=New contraint
	c\s=s
	c\e=e
	
	dx#=(c\e\x-c\s\x)
	dy#=(c\e\y-c\s\y)
	
	c\l=Sqr(dx*dx+dy*dy)
	
	c\stiffness#=stiffness#
	c\damping#=damping#
	
	Return c
End Function

Function ContraintUpdate(dt#=0.01,iterations=50)


For i=1 To iterations
	For c.contraint=Each contraint
		
		dx#=(c\e\x-c\s\x)
		dy#=(c\e\y-c\s\y)
	
		currentlength#=Sqr(dx*dx+dy*dy)
	
		displacement#=currentlength-c\l
		
		nx#=dx#/currentlength#
		ny#=dy#/currentlength#
	
		fx#=nx#*(displacement*c\stiffness)
		fy#=ny#*(displacement*c\stiffness)
		fz#=nz#*(displacement*c\stiffness)

		fx#=fx#+nx#*c\damping#
		fy#=fy#+ny#*c\damping#

		PointForce c\s,fx*0.5*dt,fy*0.5*dt
		PointForce c\e,-fx*0.5*dt,-fy*0.5*dt		
			
	Next
Next

End Function

Function ContraintDraw()

	For c.contraint=Each contraint

		Line c\s\x,c\s\y,c\e\x,c\e\y

	Next

End Function	

</textarea> <br><br></td></tr></table><br>
<a name="584563"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow Jeppe!<br><br>That's really neat..<br><br>I'm looking for something similar, only in 3D.<br>A rod tip (pivot). <br>More line pivots hanging from the rod tip.<br>Each line pivot should affect the other.<br><br>The line pivots should only start moving when the rod tip moves.<br><br>The line pivots needs to swing in the direction in which the rod tip moves. <br><br></td></tr></table><br>
<a name="584600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KuRiX</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow! Really impressive piece of code, i like it! congratulations! <br><br></td></tr></table><br>
<a name="584717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >IPete2</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow!<br><br>Fab stuff, thanks for sharing that!<br><br>IPete2. <br><br></td></tr></table><br>
<a name="584867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >3DFish</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for all the input guys.<br><br>I have found a solution.<br><br>Check out this thread by Mr. Picklesworth <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=39525&amp;hl=rope" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=39525&amp;hl=rope</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
