<!DOCTYPE html><html lang="en" ><head ><title >How to Calculate CameraZoom for 1:1 pixels</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to Calculate CameraZoom for 1:1 pixels</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >How to Calculate CameraZoom for 1:1 pixels</a><br><br>
<a name="297277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Orca</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey everyone,<br><br>I'm working on a single surface 2d thing, and I can't seem to get my head around this part.<br><br>I'm setting up my quads so that each blitz unit is equal to a pixel. That is, a 32x32 image would be converted to a 32x32 quad..<br><br>Problem is I cant seem to work out an accurate way of moving/zooming the camera so that 640x480 blitz units matches perfectly to 640x480 pixels. This seems like it wouldnt be that hard but I suck at "maths" :)<br><br>I've looked in the code sections here and on blitzcoder BUT (I'm probably just being thick) it seems the related code snippets I've looked at seem to do the opposite of what I want.. I need a proper way of figuring out how far on the z axis to move the camera back(or zoom level would work too) so I get the 1:1 thing.<br><br>If anyone could help it would be most appreciated. Spanks ;) <br><br></td></tr></table><br>
<a name="297314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Surely you'd be wanting this..<br><br><a href="http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=773" target="_blank">http://www.blitzbasic.co.nz/codearcs/codearcs.php?code=773</a> <br><br></td></tr></table><br>
<a name="297325"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Orca</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks. :D <br><br>I had looked at that already but I guess I really need to look thru that snippet and study it. <br><br></td></tr></table><br>
<a name="297371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now if ever there was a tutorial crying out to be made this was it....<br><br>Perhaps one day Anthony Flack will finish Cletus and tell us all how to do it :) <br><br></td></tr></table><br>
<a name="297381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Orca</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think everyones seen it but anthonys post on bc was very informative...http://www.blitzcoder.com/cgi-bin/ubb-cgi/postdisplay.cgi?forum=Forum14&amp;topic=000868<br><br>I got past the first steps, now I need to get this camera issue sorted OR find a plan b. I think I'm gonna revive that bc thread in hopes that hell enlighten us some more o_O <br><br></td></tr></table><br>
<a name="297398"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jfk EO-11110</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> this one uses the camerazoom in a simple way:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=321" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=321</a> <br><br></td></tr></table><br>
<a name="297399"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a basic 'bare-bones' version of my SpriteControl which will get your quads on screen with mimimum of fuss:<br><pre class=code>; "Sprite Control BASIC.bb" - 'Bare Bones' include

Global spritepivot,spritecamera

; Create a complete sprite display with camera/pivot
Function SpriteGraphics3D(gw,gh,d=0,m=0,dist#=1)
	Graphics3D gw,gh,d,m
	SetBuffer BackBuffer()
	spritecamera=CreateCamera()
	spritepivot=CreatePivot(spritecamera)
	Local aspect#=Float(gh)/Float(gw)
	Local scale#=2.0/gw
	PositionEntity spritepivot,-1,aspect,dist
	ScaleEntity spritepivot,scale,scale,scale
	Return spritepivot
End Function

; Loads an image into a texture and attaches it to sprite quad
Function LoadImage3D(file$,texflags=4,par=-1)
	; Create quad mesh
	If par=-1 par=spritepivot
	Local sprite=CreateMesh(par)
	Local s=CreateSurface(sprite)
	AddVertex s,0,0,0 ,0,0 : AddVertex s,2,0,0 , 1,0
	AddVertex s,0,-2,0 ,0,1 : AddVertex s,2,-2,0 , 1,1
	AddTriangle s,0,1,2 : AddTriangle s,3,2,1
	; transfer image into texture buffer (with alpha)
	Local tmpimage=LoadImage(file$)
	Local spritetexture=LoadTexture(file$,texflags)
	Local iw=ImageWidth(tmpimage) , ih=ImageHeight(tmpimage)
	Local tw=TextureWidth(spritetexture) , th=TextureHeight(spritetexture)
	If iw&lt;&gt;tw Or ih&lt;&gt;th
		ib=ImageBuffer(tmpimage)
		tb=TextureBuffer(spritetexture)
		For x=0 To iw-1
			For y=0 To ih-1
				rgbc=ReadPixel(x,y,ib) And $00ffffff
				If rgbc=((r Shl 16)+(g Shl 8)+b)
					WritePixel x,y,($00000000),tb
				Else
					WritePixel x,y,(rgbc Or $ff000000),tb
				EndIf
			Next
		Next
	EndIf
	FreeImage tmpimage
	; Texture and resize sprite. Move handle to top/left
	ScaleTexture spritetexture,Float(tw)/Float(iw),Float(th)/Float(ih)
	EntityTexture sprite,spritetexture
	EntityFX sprite,1+16 : EntityOrder sprite,-100
	ScaleEntity sprite,Float(iw)/2,Float(ih)/2,1
	PositionEntity sprite,-10000,-10000,0
	Return sprite
End Function

; Position 3d sprite at 2D screen coordinates
Function DrawImage3D(sprite,x,y,z=0)
	PositionEntity sprite,x+0.5,-y+0.5,0
End Function

; Flush out an existing quad sprite and it's texture
Function FreeImage3D(sprite)
	Local brush=GetEntityBrush(sprite)
	Local tex=GetBrushTexture(brush)
	If brush&lt;&gt;0 FreeBrush brush
	If tex&lt;&gt;0 FreeTexture tex
	If sprite&lt;&gt;0 FreeEntity sprite
End Function</pre><br><br>An example piece of test code:<br><pre class=code>Include "Sprite Control BASIC.bb"

Const sw=640,sh=480

SpriteGraphics3D sw,sh
CameraClsColor spritecamera,50,10,70

; load and create quad sprite
quad=LoadImage3D("myimage.bmp")

; position the quad
DrawImage3D quad,sw/2,sh/2
RenderWorld
Flip
WaitKey

; cleanup
FreeImage3D quad

End</pre><br>The above works with the main camera set at the default zoom ratio of 1.<br>If you zoom the main camera (1 onwards) then use this function which zooms the camera as well as the sprite pivot:<br><pre class=code>; Use this command to zoom the main camera and sprite pivot
; NOTE: Only positive values if 1 and greater can be used
Function CameraZoom3D(cam,z#)
	If z&lt;1 z=1
	If EntityClass$(cam)="Camera" CameraZoom cam,z
	Local numchilds=CountChildren(cam)
	If numchilds&gt;0
	For c=1 To numchilds
		Local child=GetChild(cam,c)
		If EntityName$(child)="SpriteControl Pivot"
			PositionEntity child,EntityX(child),EntityY(child),z+0.001
		EndIf
	Next
	EndIf
End Function</pre><br><br>With the above example you would then use:<br><pre class=code>CameraZoom3D spritecamera,zoomamount#</pre><br>Hope that helps.<br>Note: The above is mainly thanks to skidracer and his 'pixies' method for displaying pixel-perfect sprites. <br><br></td></tr></table><br>
<a name="297438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Al Mackey</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want some of the basic technical theory, these tips might help:<br><br>The camera, by default, has a zoom value of 1.0, which gives it a 90 degree field of view horizontally.  This might be a little wide for full 3D stuff, but it's a fairly handy level of zoom to deal with for this sort of thing.<br><br>With a 90 degree field of view, an object that's one unit wide placed centered but one unit away from the camera will take up exactly the full width of the frame.<br><br>So if you have an object that's 640 units wide and 480 units tall, placed at 0, 0, 640 relative to the camera, it should have that 1:1 ratio you're looking for.<br><br>If you're keeping all your objects and sprites at the same distance away from the camera, remember that using EntityOrder() can be used to override the Z-buffer and tell the rendering engine what goes on top of what. <br><br></td></tr></table><br>
<a name="297450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Al, thats useful info, thanks! <br><br></td></tr></table><br>
<a name="297520"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very useful, thanks for that Al. <br><br></td></tr></table><br>
<a name="297641"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiK</td><td align="right"><font class=tiny>(Posted 2003)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Syntax Error's Sprite Control stuff is really interesting...<br><br>I'm in the final stages of a purely 2d game at the mo, but for my next project I'm planning to do 2d-in-3d and so the first item on the agenda is a single surface sprite engine. <br><br>Syntax Error and Skidracers positioning stuff will come in very useful I'm sure :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
