<!DOCTYPE html><html lang="en" ><head ><title >Creating a Terrain Mesh Editor</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Creating a Terrain Mesh Editor</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Creating a Terrain Mesh Editor</a><br><br>
<a name="404277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> In My Game, My Terrain is a Specific Level.. So I need an Editor to modify the Mesh Terrain as I see fit. I have some basics going along, I can create a mesh, Selete a vertice to move up or down. What I'd like to do is select a Vertice and depending on my settings select a range of Vertices so I can make mountain tops and such. I Guess checking the distance from my currently selected Vertice might work... but then the problem of how do I make a smooth transition from the center vertice, ourward, like hills and valleys. <br><br></td></tr></table><br>
<a name="404278"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to have the movement amount drop off as you get away from the center of your selection.  So the middle vertex is moved with a strength of 100%, the next ones out are at (say) 80%, then 60%, etc. <br><br></td></tr></table><br>
<a name="404288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK that makes sense, Is it really that easy? <br><br>Now another tricky thing, Any good Ideas for allowing me to know the Points that will be influenced... Maybe a small sphere at each Vertex that will be moved, or a circle. But For a circle, how would I draw a circle on my terrain, to encompass all the verts <br><br></td></tr></table><br>
<a name="404313"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrtricks</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try out my terrain editor <a href="http://www.robinking.com/allseeingi/totalterrain.htm" target="_blank">Total Terrain</a> - version 2.0 is more fully featured. Its sculpting tools create the smooth hills and valleys you asked about. It's freeware too so you've nothing to lose by trying! <br><br></td></tr></table><br>
<a name="404342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I noticed it, but I Feel that if I don't create my own tools, I won't learn to program... Plus I think there is something to be said in hobby programming, that reinventing the wheel is not such a bad thing.<br><br>Regards,<br>Eric <br><br></td></tr></table><br>
<a name="404356"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> As a hobby, that's true.  But if the hobby changes into something where you'd like to make money, releasing becomes the primary objective.  In that situation, looking for pre-existing solutions is the smartest choice. <br><br></td></tr></table><br>
<a name="404428"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrtricks</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you could try it out to see if you want to get inspired about your own editor - what you like, what you don't like etc. I always try out other examples of programs similar to mine. <br><br></td></tr></table><br>
<a name="404432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is a bit naff and knocked up quickly but may give you one idea to generate landscapes.  Also, have a look at SSwifts Perlin Noise heightmap generator - it's fractal based as I remember.  Also, try googling for more info - "random terrains".<br><br><pre class=code>
Graphics 640,480,32,1 

Const Size = 256
Const Maxheight=255
Dim Terrain#( Size-1 , Size-1 )

MyTerrain = TERRAINcreate( 427, 500, 100 )

;show it
DrawImage MyTerrain , 0 , 0
Flip
MouseWait

;===========================
;===========================
;===========================

Function TERRAINcreate( Seed , Passes ,SmallNo )
	
	;reset values to 0
	Dim Terrain( Size, Size )
	
	;set random seed
	SeedRnd Seed
			
	;generate terrain
	For Parts =1 To Passes
	
		StartX = Rand( 0 , size )
		StartZ = Rand( 0 , size )
		SlopeType = Rand( 0 , 1 )
		
		;Smaller Bits
		If Parts &gt; ( Passes - SmallNo ) 
			StartY# = Rnd( 4, 8 )
			Radius# = Rand( 4,8 )
		Else
			StartY# = Rnd(4,32)
			Radius# = Rand(4,32)
		EndIf
			
		For z=-radius To radius
			For x=-radius To radius
				Distance# = Sqr( x*x + z*z )
				If Distance &lt; Radius
					If SlopeType = 0 py#=Cos( Distance / Radius * 90) * StartY * 2.0
					If SlopeType = 1 py#=( 1.0 - Sin( ( Distance / Radius ) *90 ) ) * StartY *3.0
					px = WRAP( StartX + X , Size)
					pz = WRAP( StartZ + Z, Size)
					NewHeight# = LIMIT( terrain( px, pz) + py , 0, 255 ) 
					Terrain( px , pz ) = NewHeight
				EndIf
			Next
		Next
	Next
		
	;make heightmap
	Heightmap = CreateImage( Size , Size )
	SetBuffer ImageBuffer( Heightmap )
	Color 0,0,0:Rect 0,0,size,size,1
	For z =0 To size -1
		For x =0 To size -1
			c = Terrain( x , z )
			Color c,c,c
			Plot x,z
		Next
	Next
	SetBuffer BackBuffer()
	
	Return Heightmap
						
End Function

;===========================
;===========================
;===========================

Function WRAP#( q# , hi# , lo#=0 )
	
	If q &lt; lo Then q = hi + (q-lo)
	If q &gt;= hi Then q = lo + (q-hi)
	Return q
	
End Function

;===========================
;===========================
;===========================

Function LIMIT#( q# , lo# , hi# )

	If q &lt; lo q = lo
	If q &gt; hi q = hi
	Return q
	
End Function
</pre> <br><br></td></tr></table><br>
<a name="404478"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok cool little piece of code, but I am staring with a Flat quad.. I think this could be an Option, in my editor to start with a random Terrain and then modify it from there...Hey thanks alot. <br><br></td></tr></table><br>
<a name="404515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gpete</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Stevie G,<br>Nice functions,  I made a little prog...use your own image name, textures-  maybe loop it to make a bunch of terrain heightmaps fast! <br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics3D 640,480,32,1 

Const Size = 256
Const Maxheight=255
Dim Terrain#( Size-1 , Size-1 )
SeedRnd MilliSecs()
MyTerrain = TERRAINcreate( Rnd(1,400),Rnd(100,500),3)

;show it
DrawImage MyTerrain , 0 , 0

ok=SaveImage (MyTerrain,"bmp/myterrain.bmp") 
; Print results 
If ok=1 Then 
Print "Save successful!" 
Else 
Print "There was an error saving!" 
End If 

MouseWait
Cls

camera=CreateCamera() 
PositionEntity camera,1,1,1 

light=CreateLight() 
RotateEntity light,90,0,0 

dter=LoadTerrain("bmp/myterrain.bmp")
ScaleEntity dter,2,30,2
dtex=LoadTexture("png/condens.png")
ScaleTexture dtex,5,5
EntityTexture dter,dtex

;================================
While Not KeyDown(1)

If KeyDown( 205 )=True Then TurnEntity camera,0,-1,0 
If KeyDown( 203 )=True Then TurnEntity camera,0,1,0 
If KeyDown( 208 )=True Then MoveEntity camera,0,0,-0.1 
If KeyDown( 200 )=True Then MoveEntity camera,0,0,0.1 

x#=EntityX(camera) 
y#=EntityY(camera) 
z#=EntityZ(camera) 

terra_y#=TerrainY(dter,x#,y#,z#)+2

PositionEntity camera,x#,terra_y#,z# 

RenderWorld

Flip

Wend
;===========================
;===========================
;===========================

Function TERRAINcreate( Seed , Passes ,SmallNo )
	
	;reset values to 0
	Dim Terrain( Size, Size )
	
	;set random seed
	SeedRnd Seed
			
	;generate terrain
	For Parts =1 To Passes
	
		StartX = Rand( 0 , size )
		StartZ = Rand( 0 , size )
		SlopeType = Rand( 0 , 1 )
		
		;Smaller Bits
		If Parts &gt; ( Passes - SmallNo ) 
			StartY# = Rnd( 4, 8 )
			Radius# = Rand( 4,8 )
		Else
			StartY# = Rnd(4,32)
			Radius# = Rand(4,32)
		EndIf
			
		For z=-radius To radius
			For x=-radius To radius
				Distance# = Sqr( x*x + z*z )
				If Distance &lt; Radius
					If SlopeType = 0 py#=Cos( Distance / Radius * 90) * StartY * 2.0
					If SlopeType = 1 py#=( 1.0 - Sin( ( Distance / Radius ) *90 ) ) * StartY *3.0
					px = WRAP( StartX + X , Size)
					pz = WRAP( StartZ + Z, Size)
					NewHeight# = LIMIT( terrain( px, pz) + py , 0, 255 ) 
					Terrain( px , pz ) = NewHeight
				EndIf
			Next
		Next
	Next
		
	;make heightmap
	Heightmap = CreateImage( Size , Size )
	SetBuffer ImageBuffer( Heightmap )
	Color 0,0,0:Rect 0,0,size,size,1
	For z =0 To size -1
		For x =0 To size -1
			c = Terrain( x , z )
			Color c,c,c
			Plot x,z
		Next
	Next
	SetBuffer BackBuffer()
	
	Return Heightmap
						
End Function

;===========================
;===========================
;===========================

Function WRAP#( q# , hi# , lo#=0 )
	
	If q &lt; lo Then q = hi + (q-lo)
	If q &gt;= hi Then q = lo + (q-hi)
	Return q
	
End Function

;===========================
;===========================
;===========================

Function LIMIT#( q# , lo# , hi# )

	If q &lt; lo q = lo
	If q &gt; hi q = hi
	Return q
	
End Function
</textarea> <br><br></td></tr></table><br>
<a name="404571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Already do this mate but with my own custom terrains - quite handy if you use red for height, blue for objects and green for land type :) <br><br></td></tr></table><br>
<a name="404925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a point on my terrain... A Mesh terrain, Not Blitz's.. I have a influence radius of 5 units. I click my mouse, up the terrain goes, but it makes a plateau, because all the verts within a 5 unit radius move the same distance, I want it to make a hill top. does someone have a small algorithm that will make it a smooth hill type fade? (Ie less effect the futher away from the control point)<br><br>Did that make sense?<br>Eric <br><br></td></tr></table><br>
<a name="404927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> instead of altering with the same amount on all verts you could use a Value / Distance^2 ( which means xdiff ^2 + ydiff ^2 + zdiff ^2 ) as altering value. ( at least if Distance is always &gt; 1 ... if Distance &lt; 1 then Distance ^2 has to be replaced with 1 / Distance ^2 ) <br><br></td></tr></table><br>
<a name="404962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok This works, but I't isn't as smooth as I would like.. thanks for the Idea.<br><br>Regards,<br>Eric <br><br></td></tr></table><br>
<a name="404964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can play with the part which you use to divide basing on a distance value ( I choose Distance ^2 because this prevents the usage of sqrt which slows down the calculations a little, but for a max of 100 height values, it should be no problem to use Value / sqrt( xdiff^2 + zdiff^2 ) or something basing on that <br><br></td></tr></table><br>
<a name="404966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> What we do at Epic is we have 2 circles on the terrain.<br><br>One is the inner radius, inside of which all verts move with the same strength. <br><br>The other one is the outer radius and the verts between the inner and outer radii move with a strength adjusted by a linear falloff.  So the closer a vert is to the outer radius edge, the less it moves. <br><br></td></tr></table><br>
<a name="405083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mrtricks</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use SIN and COS for smooth rolling hills and valleys. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
