<!DOCTYPE html><html lang="en" ><head ><title >Walking + Gravity + Animation</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Walking + Gravity + Animation</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Walking + Gravity + Animation</a><br><br>
<a name="1014775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Whats My Face</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey I have found that it is difficult to get my walking code right. The problem is that I can't have gravity on all the time or the character has a hard time walking up steep hills. But if I leave it off then the character temporary leaves the ground and it takes a frame or so to get him back on making the animation look bad and the camera a bit shaky. Has anyone found a good way to turn gravity completely off while the character is still on the ground but not have the character leave the ground for a frame or so at a time? Some code would be greatly appreciated. <br><br></td></tr></table><br>
<a name="1014812"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Serpent</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have had similar problems to this in a simple tanks game i <i>tried</i> to create.  If a tank moved along the side of a hill in the terrain, it would often fall through and end up underneath the terrain constantly falling.  I got around this through two things: first of all, making my value for gravity low - btw my 'gravity' was just every frame moving the tank down a certain amount, no acceleration whatsoever.  Secondly, the main part of my solution lay with the rotation of the tank.  The tank rotates with the landscape, so effectively it moves up along the surface of a hill rather than trying to move through it because it tilts up when reaching the higher ground.<br><br>This doesn't apply very well to your situation.  However, I think you can get Collision Normals.  If you call CollisionNY#(entity,index) after each collision in each frame, you can get how a multiplier for how high up your character needs to move in order to match the slope of the hill.  With this, you could move your character up the correct amount to make it look like it's walking up the side of the hill rather than into it.  This should also prevent your character from walking 'through' the hill (which is the main problem anyway).  I'll see if I can get some example code working... <br><br></td></tr></table><br>
<a name="1014840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_PJ_</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> CollisionNY#(entity,index)  <br></div> <br>Yeah this should help.<br><br>Also, bear in mind, that however your gravity is implemented, walking along a slope, the gravity should only impede movement downwards, so depending on the incline, Cos(angle) will give the appropriate effect of gravity, i.e. walking perpendicular to the direction of gravity (i.e. flat ground) will be affected by gravity * 0 = 0<br>However, movement parallel to gravity, such as upwards, will be 100% affected. <br><br></td></tr></table><br>
<a name="1014843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> can someone show an example of this with a computer generated hill OR a mesh? I too would like to see how this works. <br><br></td></tr></table><br>
<a name="1014849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nrasool</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doesn't the Castle demo show you this? It one of the samples in Blitz3d <br><br></td></tr></table><br>
<a name="1014866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Whats My Face</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using CollisionNY# and aligntovector has been really helpful, thanks. However, my character has become Spider Man. I was thinking about figuring in the slope into the gravity like Malice said unless anybody else has a better method? <br><br></td></tr></table><br>
<a name="1014873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Guy Fawkes</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> reset ur vector after using it. maybe that would work? <br><br></td></tr></table><br>
<a name="1014890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Check the value of NY#, before aligning. This will be the slope gradient essentially. Have a play about with it. <br><br></td></tr></table><br>
<a name="1015138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RifRaf</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Similar to how ive done it.  I have two gravity values applied, one value is always applied and the second stronger value is applied when there are no collisions ( in the air ), and I dont align to the ground if the collisionNY is not within tolerance. <br><br>This allows steeper slopes to slow the movement some but not drastically  wich works for my tank game. I guess if you were planning this for humanoid movement you wouldnt want any slowing at all. In wich case the CollisionNY angle value effecting the gravity directly would work best. <br><br></td></tr></table><br>
<a name="1015161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I was thinking about figuring in the slope into the gravity like Malice said unless anybody else has a better method <br></div><br>From what I remember from my tests in this subject, try <i>only applying gravity to characters that are in movement</i>.<br>The characters won't flicker, and they also won't stay a bit "on the air" when, say, travelling through a terrain or such. They also won't slide down slopes if they stop right in the middle of one.<br><br>Just make sure to use a strong enough gravity value (this will change based on the scale of your world and elements).<br><br>EDIT: In case there cliffs in your game (where the above method will need some modifications), try linepicking every other frame (for performance reasons) to see if the character is actually standing above ground. Don't use the character's hull for collisions or else he might be stuck at mid-air for touching the level with his arm, for instance. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
