<!DOCTYPE html><html lang="en" ><head ><title >Hey Mark!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Hey Mark!</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Hey Mark!</a><br><br>
<a name="851721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you explain these results?<br><br><a href="http://blitzmax.com/Community/posts.php?topic=76157" target="_blank">http://blitzmax.com/Community/posts.php?topic=76157</a> <br><br></td></tr></table><br>
<a name="851870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> with low texture sizes, the GPU bandwidth doesn't become a bottleneck so you can do it in "realtime".<br>But the larger the texture becomes the more critical the bandwidth is. Get someone with a GMA900 / NVIDIA 6200 or joke card like that to test it ... should give more insight to that if it is really bandwidth related (as those cards are on 64bit bus and the like)<br><br>The thing that one should point out is that copyrect on different hardware does NOT work with 256 flag, so while it works for you, others might get black textures only. <br><br></td></tr></table><br>
<a name="851880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, i don't know if it would be the same with render to texture, as the texture demands you use the 256 flag as well. <br><br></td></tr></table><br>
<a name="851883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> r2t textures are hacked from outside anyway, Blitz does not offer that, as a result of it the texture must be modified outside.<br><br>but draw commands that are directed to texturebuffers do not work at all on some hardware. no drawimage / drawrect / drawtext. Only writepixelfast readpixelfast. <br><br></td></tr></table><br>
<a name="851914"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I SAID MARK, NOT DREAMORA!<br><br><br><div class="quote"> with low texture sizes, the GPU bandwidth doesn't become a bottleneck so you can do it in "realtime". <br></div><br><br><br>Wrong!<br><br>While it may be true that one needs to worry about GPU bandwidth, that is not what is causing the results we're seeing.  Copying one texture shouldn't cause an instant drop from 1000fps to 80, when copying 50 only drops the framerate by maybe another 2fps.<br><br><br>This is why I asked Mark to explain it.  I'm pretty sure nobody here knows enough about how the cards work at a low enough level to explain why this is happening, and suggest a possible solution. <br><br></td></tr></table><br>
<a name="851932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK the initial drop is a different thing. that one actually is simple: To copyrect, you must lock the buffer so it gets downloaded to the System RAM. GPUs never were meant for that and are dead slow at it.<br><br>if you do it more than once it isn't needed anymore, the backbuffer is already present in the in the system ram and DX knows that it is here and where.<br>you can not grab anything from the VRAM directly, thats why Pixel Shaders were invented, to work on the GPU directly without using the ultra slow download solution anymore. <br><br></td></tr></table><br>
<a name="851938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> But this happens with both a copyrect and the render to rexture code which should be doing no transfers to system ram.<br><br>And one would think that doing a renderworld 50 times would trigger this slowdown 50 times.<br><br>But hey, Ross, try rotating that cube a bit inside that loop to prove whether it's reusing the same backbuffer that's already in system ram over and over.  I really doubt it is though. <br><br></td></tr></table><br>
<a name="851945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Copying one texture shouldn't cause an instant drop from 1000fps to 80, when copying 50 only drops the framerate by maybe another 2fps.<br> <br></div><br><br>Hmm, i don't think you have read the results properly.<br><br>My tests are ALL based on 50 copies. I don't do a test for just the one copy, so i have no idea what the framerate is for that. Pretty dam fast i'd imagine.<br><br>And you don't need to lock the buffer to copyrect. It doesn't for me give much of an improvement. <br><br></td></tr></table><br>
<a name="851969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ross:<br>I read the results right.<br><br>The results say that 50 256x256 textures takes the same amount of time as 50 32x32 textures.  But 50 256x256 textures are equivalent to 3200 32x32 textures.<br><br>So if rendering 64x as many 32x32 textures didn't result in a drop in speed, then the meager change from 50 32x32 textures to 1 32x32 texture isn't going to affect the framerate either.<br><br>Clearly, something other than bandwidth is causing a hitch when the textures first start rendering that results in an initial precipitous drop in framerate. <br><br></td></tr></table><br>
<a name="852013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tab</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> With one copy is extremely fast in my GF7600GS. <br><br></td></tr></table><br>
<a name="852026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ross: Yes you don't use lockbuffer. But the hardware will do it to download the backbuffer content from VRAM to System RAM automatically.<br>thats why you dont gain / lose anything if you do it as well, its done anyway<br><br>but it puzzles me that it should be the same speed and checking the sources the reason was obvious: its a broken benchmark. the r2t has the setbuffer within the loops they must be outside for fair comparision. (resultet in a performance gain of 8%)<br><br>For me its hard to test as the visual output is not the same on my 8800GTS with 168.29 drivers.<br>The render to textures shows the spinning cube.<br>The copy rect only the backdrop <br><br></td></tr></table><br>
<a name="852033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't gain any performance when i take the buffers out. Must be something that's happening in the backround upon calling copyrect/render to texture.<br><br>You sound like you have a bad driver version? Mind you, they did say use the 256 flag with caution. I remember Lee Page's Tattoo had problems with the 256 flag, and he was using writepixelfast on his texture. <br><br></td></tr></table><br>
<a name="852036"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have the most current drivers for the 8800GTS so I would guess that is one of those things that I pointed out -&gt; forget copyrect and draw to buffer if you intend to have it played by real people, not theoretical ones ...<br>as this is a real machine with real drivers, there is little you can do about it ... its just DX7, point<br><br>without the alpha flag it works on the copyrect as expected at the same performance so Mark definitely should look into that. Abrexxes pointed that one out months ago and it still persists. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
