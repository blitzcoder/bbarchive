<!DOCTYPE html><html lang="en" ><head ><title >Fake Lighting Techniques For Blitz3d</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Fake Lighting Techniques For Blitz3d</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Fake Lighting Techniques For Blitz3d</a><br><br>
<a name="552789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rogue Vector</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I've run into a problem that I'm sure others have had in the past.<br><br>I need to simulate a rotating hazard warning light.<br><br>Normally, I'd just use a Blitz 3D Spotlight, but my level is lit using a gile[s] lightmap, so it won't work. I think it has something to do with Blitz only supporting 2 sets of UV coords.<br><br>Anyway, I seem to remember a while back that someone came up with a technique that used something like an EntityBlend on a textured sphere to simulate a moving light spot. <br><br>The texture was a radial gradiant and when combine with the level mesh it created a fairly convincing fake light effect.<br><br>Does anyone have the code, or know how to acheive somehing like this?<br><br>Thanks in advance,<br><br>Rogue Vector. <br><br></td></tr></table><br>
<a name="552800"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ross C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Normally, I'd just use a Blitz 3D Spotlight, but my level is lit using a gile[s] lightmap, so it won't work. I think it has something to do with Blitz only supporting 2 sets of UV coords.<br> <br></div><br><br>The blitz lights works by lighting the vertices of the mesh, so it can't be the textures, unless there very dark areas of the lightmap. If the area around the light is flat, you could fake the lighting using a white mesh and using an entityblend mode. <br><br></td></tr></table><br>
<a name="552831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rogue Vector</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't really understand why the Blitz3D lighting won't work with my level, but trust me, it simply refuses to illuminate the geometry.<br><br>The level mesh has a base texture layer, a masking texture layer - that essentially illuminates certain specific regions of a wall via and additive blend, and finally the light map created in gile[s].<br><br>God! It's frustrating. It's a simple scene element and it won't do it.<br><br>Rogue Vector <br><br></td></tr></table><br>
<a name="552842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Putting a blitz light in with a premade lightmap may look wrong.  Have you tried making sure that the level does not have the entityfx fullbright flag set? <br><br></td></tr></table><br>
<a name="552843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Putting a blitz light in with a premade lightmap may look quite unrealistic.  Have you tried making sure that the level does not have the entityfx or brushfx set to fullbright? <br><br></td></tr></table><br>
<a name="552871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hujiklo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not the number of UV co-ords. Light mapping in Giles automatically sets your base mesh to 'full bright' and then adds the lightmaps. I don't remember exactly right now but I think you can have upto 8 sets of UV co-ords in Blitz.<br><br>As for the faked spot light effect. I think Fredborg did a nice piece of code for that effect. I don't know if it's in the code archives though but he definitely had it on these forums somewhere. <br><br></td></tr></table><br>
<a name="552935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadJack</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> 'I don't remember exactly right now but I think you can have upto 8 sets of UV co-ords in Blitz.'<br><br>No, Blitz supports 2 UV co-ords but up to 8 texture layers. <br><br></td></tr></table><br>
<a name="553044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shifty Geezer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I don't really understand why the Blitz3D lighting won't work with my level, but trust me, it simply refuses to illuminate the geometry. <br></div><br>Lights work on vertices. This measures the amount of light hitting each vertex and interpolates it across the triangle between vertices. So a triangle lit with white light in one corner and no light in the other two will show a gradient of illumination from one point to the opposite edge.<br><br>Now imagine you've got a wall, a plain rectangle made of two triangles. If you shine a spotlight into the middle of that wall, the vertices are receiving no light so the light won't show. If instead you use a rectangular mesh of say 20x20 smaller rectangles, the central vertices will be illuminated by the spotlight. However this typs of lighting shows the triangles of the mesh, and you won't get a smooth circular spot. Basically small spotlights are very hard to manage in a vertex lit system. You would need to find another solution like a texturing solution. There's a few examples I've seen including one that projects a bat-signal as though it were a torch light. <br><br></td></tr></table><br>
<a name="553052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use to work with this to solve exactly problem you mention about...you can add also nice sprites over light surface and make them changing transparency according to angle against camera..anyway, this will light your geometry, and change intensity of light applied on to level geometry according to distance from light source..<br><br>Graphics3D 1280,1024,32,1<br>SetBuffer BackBuffer()<br><br>HidePointer<br>AmbientLight 12,24,50<br>SeedRnd MilliSecs()<br><br>light = CreateLight()<br>RotateEntity light,70,40,0<br>LightColor light,50,50,50<br><br><br>camera = CreateCamera()<br>scene = CreateMesh()<br><br>For i = 0 To 100<br><br>	cube = CreateCube()<br>	ScaleMesh cube,Rnd(1,10),Rnd(1,10),Rnd(1,10)<br>	RotateMesh cube,Rnd(-90,90),Rnd(-180,180),Rnd(-180,180)<br>	PositionMesh cube,Rnd(-100,100),Rnd(-100,100),Rnd(-100,100)<br>	<br>	AddMesh cube,scene<br>	<br>	FreeEntity cube<br>	<br>Next<br><br>cube = CreateCube()<br>ScaleMesh cube,150,150,150<br>FlipMesh cube<br>AddMesh cube,scene<br>FreeEntity cube<br><br>DL_Init()<br>DL_SetReceiver(scene)<br><br>DL_SetLight(camera)<br><br>spd# = 2.0<br><br>Repeat<br><br>	MoveEntity camera,(KeyDown(205)-KeyDown(203))*spd,0,(KeyDown(200)-KeyDown(208))*spd<br>	TurnEntity camera,MouseYSpeed()*0.25,-MouseXSpeed()*0.25,0<br>	RotateEntity camera,EntityPitch(camera,True),EntityYaw(camera,True),0<br><br>	MoveMouse 320,240<br>    <br>	DL_Update()<br><br>	RenderWorld<br>	Flip<br><br>Until KeyHit(1)<br><br>DL_Free()<br><br><br><br><br><br><br><br><br><br>Type dl_receiver<br>	Field mesh<br>End Type<br><br>Type dl_light<br>	Field entity<br>	Field range#<br>	Field scale#<br>	Field intensity#<br>	Field flicker#<br>	Field flickerrange#<br>	Field r#,g#,b#<br>End Type<br><br>Global dl_brush<br>Global dl_tex<br><br>Function DL_Init()<br><br>	ClearTextureFilters<br>	dl_tex = LoadTexture("your_light_source_texture.png",1+16+32)<br><br>	dl_brush = CreateBrush()<br>	BrushBlend dl_brush,3<br>	BrushFX dl_brush,1+2<br>	BrushTexture dl_brush,dl_tex	<br><br>End Function<br><br>Function DL_Free()<br><br>	For dlr.dl_receiver = Each dl_receiver<br>		FreeEntity dlr\mesh<br>		Delete dlr<br>	Next<br><br>	For dll.dl_light = Each dl_light<br>		Delete dll<br>	Next<br><br>	If dl_tex	Then FreeTexture dl_tex<br>	If dl_brush	Then FreeBrush dl_brush<br><br>	dl_tex		= 0<br>	dl_brush	= 0<br><br>End Function<br><br>Function DL_SetReceiver(mesh)<br><br>	dlr.dl_receiver = New dl_receiver<br>	dlr\mesh = CopyMesh(mesh)<br>	PaintMesh dlr\mesh,dl_brush<br>	<br>End Function<br><br>Function DL_SetLight(entity,range#=500.0,scale#=0.75,intensity#=2.0,flicker#=0.05,flickerrange#=0.5,r#=200,g#=220,b#=255)<br><br>	dll.dl_light = First dl_light<br><br>	If dll = Null<br>		dll.dl_light = New dl_light<br>	End If<br>	<br>	dll\entity 	 = entity<br>	dll\range  	 = range<br>	dll\scale		= scale<br>	dll\intensity = intensity<br>	dll\flicker	 = flicker<br>	dll\flickerrange = flickerrange<br>	<br>	dll\r		= r<br>	dll\g		= g<br>	dll\b		= b<br>	<br>End Function<br><br>Function DL_Update()<br><br>	dll.dl_light = First dl_light<br>	If dll = Null Then Return<br><br>	If Rnd(0.0,9.0)&lt;dll\flicker<br>		intensity# = dll\intensity*Rnd(dll\flickerrange,1.0)<br>	Else<br>		intensity# = dll\intensity<br>	End If<br><br>	For dlr.dl_receiver = Each dl_receiver<br>		mesh	= dlr\mesh<br>		n_surfs = CountSurfaces(mesh)<br>		For s = 1 To n_surfs<br>			surf = GetSurface(mesh,s)<br>			n_verts = CountVertices(surf)-1<br>			For v = 0 To n_verts<br>				TFormPoint VertexX(surf,v),VertexY(surf,v),VertexZ(surf,v),mesh,dll\entity<br>				x# = TFormedX()<br>				y# = TFormedY()<br>				z# = TFormedZ()<br>				<br>				dist# = Sqr(x*x + y*y + z*z)*dll\scale<br>				tu# = (x/dist)+0.5<br>				tv# = 1.0-((y/dist)+0.5)<br>				<br>				VertexTexCoords surf,v,tu,tv<br><br>				If z&gt;dll\range Then z = dll\range<br>				falloff# = 1.0-(z/dll\range)<br>				If falloff&lt;0.0 Then falloff = 0.0<br>				If falloff&gt;1.0 Then falloff = 1.0<br>				<br>				TFormNormal VertexNX(surf,v),VertexNY(surf,v),VertexNZ(surf,v),mesh,dll\entity<br>				dot# = -TFormedZ()*falloff*intensity<br>				If dot&gt;0.0<br>					VertexColor surf,v,dot*dll\r,dot*dll\g,dot*dll\b<br>				Else<br>					VertexColor surf,v,0,0,0<br>				End If<br>			Next<br>		Next		<br>	Next<br><br>End Function <br><br></td></tr></table><br>
<a name="553058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, Naughty Alien!<br>I've tucked that away for when I need 'direct' lighting.<br>Thanks for sharing. <br><br></td></tr></table><br>
<a name="553068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rogue Vector</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fredborg's code, which is here by the way, <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1000" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1000</a><br><br> - doesn't work in this instance because it requires another set of UV coords.<br><br>I posted the problem in the gile[s] forum and here's the response:<br><a href="http://www.frecle.net/forum/viewtopic.php?t=424" target="_blank">http://www.frecle.net/forum/viewtopic.php?t=424</a><br><br><div class="quote"> <br>In gile[s] forum:<br>Dreamora wrote:<br>You can't do anything like that with B3D + Lightmaps as B3D only supports 2 UV Coord sets which you both need (1 for base texture, 1 for lightmap) so you can't project another texture over it using a 3rd UV which would be needed for it.<br> <br></div><br><br>This is why I was thinking in terms of an EntityBlend of a mesh.<br><br>But how?<br><br>Man! I hope the 3D module for BlitzMax makes doing stuff like this far more straight forward.<br><br>Regards,<br><br>Rogue Vector <br><br></td></tr></table><br>
<a name="553123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> but why you wanna project another texture instead of changing vertex colors to simulate light on specific areas?? For example, 3DS file cant support even 2 UV sets, but with vertex color management, yoy can easy apply lightmap information over difuse textures without problems...same things is here... <br><br></td></tr></table><br>
<a name="553335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry... "3DS file cant support even 2 UV sets" ???<br><br>Does this mean that a 3DS files can never be lightmapped ?<br><br>This is pretty important as a potential client wants to use 3DS (directly, not B3D), and wants lightmapping. <br><br></td></tr></table><br>
<a name="553379"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Naughty Alien</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> 3DS files cant support 2UV sets, so cant be lightmapped on the way like B3D file..but as I'm mention above, you can make them lightmapped on the way I mention early...you can apply lightmap on to 3DS file, or X file on this way..<br><br>Graphics3D 800,600,32,2<br><br><br><br>camera=CreateCamera()<br><br>Textured_Mesh=LoadAnimMesh("level.3ds")<br>litemap_mesh=LoadAnimMesh("lightmap.3ds")<br>t=LoadTexture("lightmap.bmp")<br><br>MapVertices(Textured_Mesh,litemap_mesh,t)<br>FreeEntity litemap_mesh<br>FreeTexture t<br><br>MoveEntity camera,0,200,-500<br>PointEntity camera,Textured_Mesh<br><br>While Not KeyHit(1)<br>TurnEntity Textured_Mesh,0,0.1,0<br>UpdateWorld<br>RenderWorld<br>Flip<br>Wend<br>End<br><br>;=====================<br>Function MapVertices(model,copy,texture)<br><br><br>For n=1 To CountSurfaces(model)<br>surf=GetSurface(model,n)<br><br>Next<br><br>For n=1 To CountSurfaces(model)<br>	<br>	surf=GetSurface(model,n)<br>	lsurf=GetSurface(copy,n)<br>	For v=0 To CountVertices(surf)-1<br>		<br>		tu#=VertexU#(lsurf,v)<br>		tv#=VertexV#(lsurf,v)<br>		tw#=VertexW#(lsurf,v)<br>		VertexTexCoords surf,v,tu,tv,tw,1<br>	Next<br>Next<br><br><br><br>TextureCoords texture,1<br>EntityTexture model,texture,0,1<br><br>For e=1 To CountChildren(Model)<br>limb=GetChild(model,e)<br>limb2=GetChild(copy,e)<br>MapVertices(limb,limb2,texture)<br>Next<br><br>End Function<br><br><br>where is Textured_Mesh your 3DS level textured with difuse textures on to it, LITEMAP_MESH is same mesh as Textured_Mesh, except lightmap texture is applied on to it without any other texture...and T is lightmap texture...what is important here is that lightmapped level (LITEMAP_MESH) MUST BE same geometry as Textured_Mesh...thats all..this things working properly if you exporet geometry on proper way..enjoy <br><br></td></tr></table><br>
<a name="553625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >John Blackledge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've no way of immediately testing your code, but I'll assume it works - and thanks for that.<br><br>This at least means I can reopen negotiations over 3DS lightmapping.<br><br>Thanks very much for that.<br><br>Just out of interest, why did you create this?<br>And is anyone else finding a need for this, and why? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
