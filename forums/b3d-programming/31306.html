<!DOCTYPE html><html lang="en" ><head ><title >Anyone have a World to Screen func -clipping?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Anyone have a World to Screen func -clipping?</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Anyone have a World to Screen func -clipping?</a><br><br>
<a name="333846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tom</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Anyone have a function to do what CameraProject does without clipping?<br><br>Cheers<br>Tom <br><br></td></tr></table><br>
<a name="333902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know the maths for projection (though its probably straightforward enough)  so I would probably try the easy way out (if you can call it that)...<br><br>Temporarily reset the camera near and far ranges to very low and high values (but within floating point precision).  Now only stuff on or behind the camera plane will be clipped.  For stuff behind the camera I suppose you could tform the point to the camera, then if z is less than zero negate z and tform the point back to world before projecting, which should give you the position that point would be at behind the camera projected on the screen in the appropriate position, because it's now pretending it's in front of the camera.  I guess you could do something similar to move points that happen to fall on or near the camera plane away from it slightly - If (after negating Z if necessary), z is closer than your super small camera near value then set it to this value.<br><br>Edit...<br><br>Here is a function which seems to work more or less but that link Klaas posted below is probably worth further investigation because this still has issues with points that lie on the plane.  I seem to recall running into this before.<br><br><pre class=code>
Function ProjectNoClip(camera,x#,y#,z#,near#,far#)
	CameraRange camera,0.001,1000000
	TFormPoint x,y,z,0,camera
	z = TFormedZ()
	If z &lt; 0 Then z = -z
	If z &lt; 0.001 Then z = 0.001
	TFormPoint TFormedX(),TFormedY(),z,camera,0
	CameraProject camera,TFormedX(),TFormedY(),TFormedZ()
	CameraRange camera,near,far
End Function
</pre><br><br>In fact setting the near value (and Z value adjustment) to 0.01 seems to stabilise it a bit, so its probably a floating point accuracy issue. However points on the plane far from the camera will still not be dealt with properly so beware.  Hmmm, Maybe you could try increasing the near value (and the Z value adjustment) based on distance, that should settle it down.  Of course this will effect the actual position of the projected coordinates, but as these will be far off the screen anyway hopefully not much of a concern as long as the vector to those coordinates from a point that is in view is more or less right. <br><br></td></tr></table><br>
<a name="333954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Klaas</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> maybe this one helps <br><br><a href="http://colos1.fri.uni-lj.si/~sis/GRAFIKA/ALGORITMI/2D_CLIPPING/transform.html" target="_blank">http://colos1.fri.uni-lj.si/~sis/GRAFIKA/ALGORITMI/2D_CLIPPING/transform.html</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
