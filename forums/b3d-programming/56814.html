<!DOCTYPE html><html lang="en" ><head ><title >Mirroring a vector</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Mirroring a vector</h1><a href="forums.php" >Blitz3D Forums</a>/<a href="topics.php?forum=82" >Blitz3D Programming</a>/<a href="#bottom" >Mirroring a vector</a><br><br>
<a name="631602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Given a vector, anyone know the quickest way to mirror it, using maths?<br><br>Let's use 2D (x,y) to make it simpler: say I have a vector x=-1 y=1 and I want to mirror it so it becomes x=1 y=1. In this instance I can just negate the x but I want it to work whatever the vector. e.g. with x=0 y=1, negating the x makes no difference, I want it to become x=0 y=-1.<br><br>I know I could use TFormVector on a pivot or something, but I want to find a quicker(?) way using maths.<br><br>Cheers.<br><br>[edit]Yikes. I guess this isn't going to be a simple as I'd hoped because I need to figure into the equation the axis I want to mirror around. :/ <br><br></td></tr></table><br>
<a name="631623"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you're talking about something bouncing off a wall or suchlike?  In which case you can derive the reflection vector by determining the cross product of the motion vector and the collision normal vector.  <br><br>Example here ..<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=670" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=670</a><br><br>Otherwise, I'm not sure what you mean?  <br><br>Stevie <br><br></td></tr></table><br>
<a name="631642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackJumper</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> ... as per your edit - you can't 'mirror' something without defining the axis or plane that you intend to act as the mirror<br><br>have a look at this FAQ...<br><br>http://web.archive.org/web/20041011193859/http://www.j3d.org/matrix_faq/vectfaq_latest.html <br><br></td></tr></table><br>
<a name="631675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the links, guys - I'll take a look.<br><br>What I need this for is this: I am creating a 'symetrical' mesh on-the-fly. Because it's symetrical, I calculate the normal of a vert on the left side, and want to simply mirror it to apply to the corresponding vert on the right side. I'd hoped doing this would be quicker that calculating each normal from scratch. Does that make sense?<br><br>Anyway, it turns out I may just be better off using UpdateNormals and be done with it. Not sure - got a bit more experimenting to do. :)<br><br>Thanks again. <br><br></td></tr></table><br>
<a name="631740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ross C has something that does this in the archives.  Quite recent in fact ...<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1521" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1521</a> <br><br></td></tr></table><br>
<a name="631786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also if you want rotation around am arbitary axis, not necessarily one aligned to xyz, there is an example of that in the matrix section of Marks published 3d c++ geometry code.  I have used something similar myself when playing around with rotating objects embedded in meshes.  Not sure if it would help in your case or not though.<br><br><br><pre class=code>
	Matrix( float angle,const Vector &amp;axis ){
		const Vector &amp;u=axis;
		float c=cosf(angle),s=sinf(angle);
		float x2=axis.x*axis.x,y2=axis.y*axis.y,z2=axis.z*axis.z;
		i=Vector( x2+c*(1-x2),u.x*u.y*(1-c)-u.z*s,u.z*u.x*(1-c)+u.y*s );
		j=Vector( u.x*u.y*(1-c)+u.z*s,y2+c*(1-y2),u.y*u.z*(1-c)-u.x*s );
		k=Vector( u.z*u.x*(1-c)-u.y*s,u.y*u.z*(1-c)+u.x*s,z2+c*(1-z2) );
	}
</pre><br><br>Ps. do not ask me to explain the maths!  I just know it works. <br><br></td></tr></table><br>
<a name="631920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stevie: Yeah, I need to mirror on an arbitary axis so Ross' code doesn't help, I'm afraid.<br><br>David: Gulp! Thanks for the code. I'll see if I can make use of it but judging by the heavy maths involved, I can't see it being any faster than simply calculating each normal from scratch. I didn't think to look at Mark's geometry code.<br><br>Cheers <br><br></td></tr></table><br>
<a name="631931"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stevie G</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Big10p .. was it not you who did the meshclip thing?  <br><br>Surely you could use that reasonably easily?  Clip the mesh on an arbitary plane, copy and transform the vertices/tris to the other side of the plane.  Then addmesh them together?<br><br>Stevie <br><br></td></tr></table><br>
<a name="631938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does the mesh really have to be created with an arbitrary orientation?<br><br>What about creating it in the usual way, aligned to the coordinate axes, so reflections are trivial.<br>Then, after the mesh is complete, use RotateMesh to put it in the desired orientation. <br><br></td></tr></table><br>
<a name="631953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, I haven't explained myself very well. The mesh I'm creating, as a whole, isn't symetrical. However, it's made up of symetrical pieces.<br><br>I don't have a problem creating the mesh, or calculating the vert normals, it's just that normals on one side of each 'peice' are simply a mirror of those on the other side. I just wondered if there was an easy/fast way of mirroring the normals instead of re-calculating from scratch.<br><br>The mesh is (or can) be made up of many 'peices' so rotating each piece to axis-align it, then rotate it back would be too slow, I think. <br><br></td></tr></table><br>
<a name="632083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DJWoodgate</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> All things considered then, recalculate the normals. :)<br>Here is a link to some maths on reflection.<br><a href="http://www.euclideanspace.com/maths/geometry/affine/reflection/" target="_blank">http://www.euclideanspace.com/maths/geometry/affine/reflection/</a><br><br>Stevie G's original suggestion about the bouncing code merits further investigation since you have a plane normal and your vertex normal which might somehow be reflected onto the other side of the plane using the inverse of the plane normal?  I don't know,I would have to play about with it.<br><br>Edit, no I do not think that will work.  So to reflect a point or normal you could use a reflection matrix as given in the link above.  This may be less work than recalculating the normals for a lot of points to be reflected in the same plane, but I suspect there is not going to be a lot in it and you always loose a little bit of accuracy when doing these transforms.<br><br><pre class=code>
; given a plane normal
pnx#=-0.5
pny#=0.866
pnz#=0

; construct a reflection matrix
pnx2#=pnx*pnx
pny2#=pny*pny
pnz2#=pnz*pnz

mat1# = -pnx2+pnz2+pny2
mat2# = -2*pnx*pny
mat3# = -2*pnx*pnz
mat4# = -2*pny*pnx
mat5# = -pny2+pnx2+pnz2
mat6# = -2*pny*pnz
mat7# = -2*pnz*pnx
mat8# = -2*pnz*pny
mat9# = -pnz2+pny2+pnx2


; given a point to reflect
px#=1
py#=0
pz#=0

; multiply the point by the reflection matrix
rx# = px*mat1 + py*mat2 + pz*mat3
ry# = px*mat4 + py*mat5 + pz*mat6
rz# = px*mat7 + py*mat8 + pz*mat9

</pre> <br><br></td></tr></table><br>
<a name="632302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was looking at that site you linked to yesterday, David. ;) Didn't notice the page about reflection, though, thanks.<br><br>That site seems very good but I get lost pretty quickly when the maths gets too complicated, and I lose sight of the logic of what's happening. Then again, I don't really need to know how things work, just that they do work. :)<br><br>Thanks for the code. I suspect it may not be any quicker than recalculating the nromal, though, as I'd need to re-calculate the reflection matrix for each 'peice' of my mesh. Hmm, It maybe useful, though - I'll have to see what I can do. :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
