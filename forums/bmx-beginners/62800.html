<!DOCTYPE html><html lang="en" ><head ><title >Why is there LoadPixmap and LoadPixmapPNG?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Why is there LoadPixmap and LoadPixmapPNG?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Why is there LoadPixmap and LoadPixmapPNG?</a><br><br>
<a name="701611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not just have LoadPixmap? <br><br></td></tr></table><br>
<a name="701638"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Michael Reitzenstein</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> LoadPixmapPNG is an internal function that's called by LoadPixmap. There is also LoadPixmapJpeg. Due to the way the BlitzMax modules are structured, LoadPixmapPNG/LoadPixmapJPG have to be public to be accessable by pixmap loading system. <br><br>It's also significantly faster to load what you know will be a PNG with LoadPixmapPNG than LoadPixmap. BlitzMax tries each loader in series rather than guessing to try LoadPixmapPNG if the extension is .png - at least, it did when I did Inca Quest, and that's a trick I used to save many many seconds off the load time. <br><br></td></tr></table><br>
<a name="701992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, yes, Max still does things that way.  Its implementation looks really sexy until you think about it in that way... <br><br></td></tr></table><br>
<a name="702004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Michael:<br>So wait, if you saved several seconds with this technique, then what did you do?  Use LoadPixmapPNG, and then convert the pixmaps to images with one of the other commands?<br><br><br>Also, I was looking at the source for LoadImage, and I found this:<br><br><pre class=code>
	Function Load:TImage( url:Object,flags,mr,mg,mb )
		Local pixmap:TPixmap=TPixmap(url)
</pre><br><br>TPixmap is a type.  Where's New, and what the heck is that (Url) bit doing on there?  The pixmap type doesn't seem to shed any light on this. <br><br></td></tr></table><br>
<a name="702014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @SSwift<br><br>LoadPixmap and LoadPixmapPNG both return a TPixmap, so what I Imagine Michael did, was instead of using LoadPixmap, he used either LoadPixmapPNG or LoadPixmapJPG directly.<br><br>It looks to me as if there is also Function TPixmap that excets A URL as parameter. (But thats just a guess) <br><br></td></tr></table><br>
<a name="702016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's trying to cast the URL object to a pixmap, if it succeeds, the image is generated from the pixmap, otherwise the URL is passed on to LoadPixMap() where the pixmap is loaded via the TPixmapLoaders.<br><br>Don't ya just love this OO stuff. :o)<br><br>As Michael R has stated, you can bypass the usual TPixmapLoader chain by supplying the pixmap directly...<br><pre class=code>Local image:TImage = LoadImage(LoadPixMapPNG("image.png"))</pre> <br><br></td></tr></table><br>
<a name="702024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> H&amp;K:<br>Yes, but you need IMAGES to draw stuff, so he'd have to convert those pixmaps to images.<br><br>Yan:<br>"if it succeeds, the image is generated from the pixmap, otherwise the URL is assumed to be a file path string and the pixmap is loaded via the TPixmapLoaders."<br><br>Ah... I see!<br><br><br>"Don't ya just love this OO stuff. :o)"<br><br>Nope!  I don't love not being able to tell when something is a cast or a function call! :-)<br><br><br>I do like the idea of being able to use loadimage on a pixmap though.  That explains how Michael was able to speed up his loader so easily.  I guess I'll implement a file extension pixmap loading thing into my custom loadimage function I already use which ovverides the normal one and see if my load times get sped up. <br><br></td></tr></table><br>
<a name="702028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I tested it, and using ExtractExt to determine the file extension before calling the appropriate LoadPixmap function then calling LoadImage on that isn't any faster than calling LoadImage normally.<br><br>So I'd like to know what Michael did that supposedly shaved seconds off his load time. :-)<br><br>Maybe all your images were bmp's or jpeg?  Most of mine are png's. <br><br></td></tr></table><br>
<a name="702047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I don't love not being able to tell when something is a cast or a function call! <br></div><br>It was obvious.  url:Object was the first parameter right above that line =]<br><br><div class="quote"> I'd like to know what Michael did that supposedly shaved seconds off his load time. :-) <br></div><br>Presumably he had a hell of a lot of images being loaded, because most picture ident methods don't check for much...  usually 12-20 bytes of header info and then quits out...  it depends on how many image modules you have and how complicated they are.  I havn't seen any complicated ones though. <br><br></td></tr></table><br>
<a name="702105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Sswift, Oh yes I see what you mean. Bit slow there, sorry <br><br></td></tr></table><br>
<a name="702367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> So<br><br>Local image:TImage = LoadImage(LoadPixMapPNG("image.png"))<br><br>is faster than normal Loadimage()? <br><br></td></tr></table><br>
<a name="702518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep. Obviously varies but it's about 1-3ms per load. <br><br></td></tr></table><br>
<a name="702522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> "yep. Obviously varies but it's about 1-3ms per load."<br><br>Not quite!  I loaded 60 files and I didn't even see a 1ms difference.  In fact it took more time.<br><br>I ran two tests each, and without it, I got 4331 and 4342.  But with it I got 4359 and 4349.<br><br>The majority of my load time is an ogg file, but you're talking about a 180ms difference for 60 image files and I'm just not seeing that in those numbers. <br><br></td></tr></table><br>
<a name="702526"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Running larger tests has more variety of responses which could suggest a problem with my testing. <br>9/10 times loadpixmappng is faster (for me). Admittedly between 1-60ms. Lower numbers of loads show a larger difference <br>e.g. 5 images show between 1-15ms difference... for me.<br>Please can some run/check/correct the following...<br><pre class=code>
Graphics 640 , 480
GCCollect()
Local image:TImage
t1:Int=MilliSecs()
For x = 0 To 5
	image = LoadImage("max.png")
Next
t2:Int=MilliSecs()
GCCollect()
Print "loadimage done"
t3:Int=MilliSecs()
For x = 0 To 5
	image = LoadImage(LoadPixmapPNG("max.png"))
Next
t4 = MilliSecs()
Print "loadpixmap done"
Print t2 - t1
Print t4-t3

</pre><br>&lt;edit&gt; Scratch all that. They do seem the same if I load a dummy image first then run through the loops.<br>&lt;edit2&gt; In fact, scratch it all again. Getting some very odd results. Still suggests Loadpixmappng is slightly quicker but results vary too much to be sure. <br><br></td></tr></table><br>
<a name="702529"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad you guys are spending your time on something really important.  :) <br><br></td></tr></table><br>
<a name="702530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's this or X-Factor! <br><br></td></tr></table><br>
<a name="702542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or that maria thing <br><br></td></tr></table><br>
<a name="702552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Getting load times down IS important!  <br><br>But not shaving off 20ms.  If it was like a second it would be worthwhile.  Which is why I'm probably gonna implement that ogg to wav thing. <br><br></td></tr></table><br>
<a name="702564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is <a href="/posts.php?topic=62734#701663" target="_blank"> MaxMod </a> an option for reducing OGG load times as it has streaming? <br><br></td></tr></table><br>
<a name="702574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Getting load times down IS important!  <br></div><br>incbin FTW.  :P <br><br></td></tr></table><br>
<a name="702595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're saying Incbin will make everything load much faster?<br><br>Hm...<br><br>I'll have to test that. <br><br></td></tr></table><br>
<a name="702603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm theorizing.  It should, but who knows... <br><br></td></tr></table><br>
<a name="702613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well you don't go around throwing out statements like INCBIN FTW! without solid evidence to back you up!  You might look quite silly later. :-) <br><br></td></tr></table><br>
<a name="702625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eh, could be faster, could not be ... try it and see.  And get off my lawn. <br><br></td></tr></table><br>
<a name="702691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Michael Reitzenstein</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Post your code. <br><br></td></tr></table><br>
<a name="702699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Incbin should be slower as the files need to be extracted first.<br><br>You can stream ogg files via fmod. That's what I'm doing to get rid of the loading times. <br><br></td></tr></table><br>
<a name="702764"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Incbin should be slower as the files need to be extracted first. <br></div><br>If it's slower, there's something seriously wrong. <br><br></td></tr></table><br>
<a name="702783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> WarrenM, thanks for the suggestion. Works great for me. <br><br></td></tr></table><br>
<a name="702802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> ^^Is that a feeling or fact? <br><br></td></tr></table><br>
<a name="702827"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a leap of logic, but call it faith if you will.  Once the EXE is loaded into memory all of the incbin stuff should be there as well.  I can't imagine loading from that memory bank is slower than going to to disk for each file. <br><br></td></tr></table><br>
<a name="702831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Didn't you hear him tell you to get off his lawn? :-) <br><br></td></tr></table><br>
<a name="702834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ^^Is that a feeling or fact?  <br></div><br>I believe it but not sure what that means. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
