<!DOCTYPE html><html lang="en" ><head ><title >Loading Ogg files faster</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Loading Ogg files faster</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Loading Ogg files faster</a><br><br>
<a name="1049598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I loaded an ogg Music file with FreeAudio it took around ~1500 millisecs<br>And it was compressed in quality and in the kbit rate to 112 kb/s<br><br>The same wav file took around ~60ms.<br><br>Now, 1500 msecs is too long, and I dont like 30 mb wav files,<br>so whats the solution on this? <br><br></td></tr></table><br>
<a name="1049613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's no solution as far as I know. ogg has to be decoded and this takes time, while the WAV has not to be decoded as it is RAW pcm audio. Take into account that the beneffits of OGG are mainly on deployment of the game, as both will take the same amount of RAM when being used (well, ogg a bit more as it will store also the coded data stream during load).<br>You can split the ogg into smaller ones, load one after the other (while refreshing the sreen to avoid making the game look hung) and you can later join them into a new sound object. This will be a bit slower, but can be used to make this process responsive... My two cents <br><br></td></tr></table><br>
<a name="1049639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you preload the ogg file into ram, like a bank or something, and then load the ogg from there? <br><br></td></tr></table><br>
<a name="1049650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If that's faster then i would do it (i haven't worked with banks until now)<br>The question is how fast is the preloading because it still has to decode the ogg file (and my game will at least have 20 oggs).<br><br>The splitting thing sounds interesting, but I'd prefer the direct loading if possible. <br>Is it possible to partly load an ogg stream?<br>I mean loading a part of the ogg file and then playing the part loaded while loading the rest in the background. <br><br></td></tr></table><br>
<a name="1049652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just one more option, multithreaded loading. Personally I'd go with imaginaryhuman's method of doing a ram load If possible and if that was too slow then experiment with threading so you can do other setup while you load. <br><br>Yet another option might be another sound lib rather than the built in methods. One that could stream the data... <br><br></td></tr></table><br>
<a name="1049708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Streaming audio is your best option.  Search for MaxMod2. <br><br></td></tr></table><br>
<a name="1049841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >nrasool</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wrote about the same thing, see GFK answer on <a href="http://www.blitzbasic.com/Community/posts.php?topic=90852#1033753" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=90852#1033753</a><br><br>That is the workaround and it pretty fast to load up. <br><br></td></tr></table><br>
<a name="1050112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>That is the workaround and it pretty fast to load up. <br></div><br>Pretty fast is an understatement :D<br>A 7 minute piece( 7.9 MB, 160 kbps ) took 60 ms to load, the one from my intial post around 10 ms<br>Thanks a lot.<br><br>However, when using MaxMod2 in DebugMode it ends (so after the app ends) with a segmentation fault<br>(Release is doing fine)<br><pre class=code>
Import maxmod2.rtaudio
Import maxmod2.ogg

SetAudioStreamDriver("Maxmod rtaudio")

Graphics 400,300,0

ms = MilliSecs()
Local bank:TBank = LoadBank("music.ogg")
Print MilliSecs()-ms
Local music:TChannel = PlayMusic(bank)

WaitKey()
End
</pre><br><br>I have had some compiling problems with maxmod2 and inserted a<br><pre class=code>#include &lt;stdio.h&gt;</pre><br>at the top (in file.cpp) and then it compiled fine.<br><br>Ubuntu 10.04, GCC ad G++ version 4.4.3 <br><br></td></tr></table><br>
<a name="1050117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested the above code here and it works perfectly (Blitzmax 1.41, MaxMod2 1.07).  I'm using Windows 7, though.<br><br>Does Blitzmax default to FreeAudio on Linux?  I'm sure that MaxMod only supports FreeAudio and OpenAL. <br><br></td></tr></table><br>
<a name="1050128"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Magically my problem disappeared.<br>I haven't changed anything but after trying to recompile it now also works in debug mode.<br>Thanks for helping, this is really a great forum. <br><br></td></tr></table><br>
<a name="1053456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem I had which suddenly crashed the application in Release Mode now appeared again.<br>And the problem seams to be related to banks, because when I use<br><pre class=code>Local music:TChannel = PlayMusic("music.ogg")</pre><br>it plays fine.<br>Btw, its also a LOT faster this way. Takes 1ms to load on my machine in contrast to the ~50ms before (an to the 1500ms before -.-). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
