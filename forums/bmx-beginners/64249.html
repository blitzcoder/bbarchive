<!DOCTYPE html><html lang="en" ><head ><title >2D Overhead scrolling maze</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >2D Overhead scrolling maze</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >2D Overhead scrolling maze</a><br><br>
<a name="717020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure that someone has done this before, nevertheless: I am looking for a sample of a 2D overhead scroller, with a map that includes "walls" for collisions. The controls don't matter, I intend to use a car sort of control scheme. I'm thinking something similar to the old 2D GTA games (GTA1 and GTA2). Has anyone done/seen anything like that? <br><br></td></tr></table><br>
<a name="717044"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> this may be a bit more complicated than you wanted but:<br><br>map editor<br><a href="http://www.scottshaver2000.com/forum/viewtopic.php?t=140" target="_blank">http://www.scottshaver2000.com/forum/viewtopic.php?t=140</a><br><br>tilemap module<br><a href="http://www.scottshaver2000.com/forum/viewtopic.php?t=135" target="_blank">http://www.scottshaver2000.com/forum/viewtopic.php?t=135</a><br><br>there are some samples in the mapeditor zip file that cover what you want <br><br></td></tr></table><br>
<a name="717063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's always my example that can be found on the Code section of my Blitz site (link in my sig).  Not quite as complicated as the one above, but the walls are generated randomly in my example.<br><br>The map is simply stored in an array, as it pretty much would be any tilemap, so can be populated by any means - DefData, load from file, etc. <br><br></td></tr></table><br>
<a name="717095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AD</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sure someone attempted to do a GTA clone in Blitz Basic, but I am not sure what ever happened to it. <br><br></td></tr></table><br>
<a name="717149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jazzie, I looked at your site, I couldn't find the program to which you were referring. Mind telling me which title, or providing a link? <br><br></td></tr></table><br>
<a name="717157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Scott Shaver,<br><br>Loved what you are doing but unfortunately I was unable to compile and run any of your examples... I extracted each example into it's own directory, are they dependent upon files in other directories? Should I just unzip everything into one directory? <br><br></td></tr></table><br>
<a name="717213"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm still taking responses to this question... This should be a sticky thing, like scrolling 101... I doubt anyone buying BlitzMax DOESN'T want scrolling and collisions. <br><br></td></tr></table><br>
<a name="717222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's great Zamfir. I look forward to reading it when you've finished. What have you got so far? <br><br></td></tr></table><br>
<a name="717245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You need to make sure you have my tilemap module to compile the examples <br><br></td></tr></table><br>
<a name="717247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah! <br><br></td></tr></table><br>
<a name="717249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> On your forum, you have this: "The tilemaps module had to be updated due to a change in BlitzMax handling of bigendian machines."<br><br>... I'm not seeing the tilemap module. <br><br></td></tr></table><br>
<a name="717251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> the second link in my first post <br><br></td></tr></table><br>
<a name="717299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Scott,<br><br>fter doing the MinGW thing and rebuilding all modules, your stuff worked like a charm. Great stuff, and I'll probably use it.<br><br>Another question though... If anyone's seen on here the demo where it takes a very large PNG or some other bitmap and breaks it up into smaller pieces so any video card can handle it... Would it be possible to make a map using one large image for the obstacles and transparent alpha for the background and test collisions against that? That might be a way to break out of the grid format... Just a thought.<br><br>Thanks! <br><br></td></tr></table><br>
<a name="717337"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> the system works by having all of the tiles in a single image, you could modify the code but it would be a pain. <br><br></td></tr></table><br>
<a name="717343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> note to tohers, if there is a reference to igl.mod in the demos remove it. <br><br></td></tr></table><br>
<a name="717370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Scott, is your collision all rectangular? Also, what about rotating the background around the player? <br><br></td></tr></table><br>
<a name="717375"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Scott Shaver</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no rotation, the tilemap module was intended for platformer type games. As for the collision stuff that's really up to you, there isn't any built in collision handling as you can see in the examples, I implmented the wall collisions in the easiest manner possible, full tile collision.  If you use some non-rectangular tiles (via transparency) you could implement the collisions in your own way. <br><br></td></tr></table><br>
<a name="717657"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Jazzie, I looked at your site, I couldn't find the program to which you were referring. Mind telling me which title, or providing a link? <br></div><br><br>You may have clicked on the wrong link in my sig, as there are two sites there.  My SOS Software site where all my games are, and the Blitz site, which is my programming site (code examples, current projects, etc).<br><br>The page with all my code examples is here: <a href="http://www.blitz.sos-software.co.uk/code.htm" target="_blank">http://www.blitz.sos-software.co.uk/code.htm</a><br><br>And the download for the tilemap example is here: <a href="http://www.blitz.sos-software.co.uk/downloads/TileDemoMax.zip" target="_blank">http://www.blitz.sos-software.co.uk/downloads/TileDemoMax.zip</a><br><br>My example also demonstrates keeping the player central on-screen whenever possible.  If the player is near the edge of the level then it's the player that moves and not the level. <br><br></td></tr></table><br>
<a name="717743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> @JazzieB, very nice tile map demo. <br><br></td></tr></table><br>
<a name="718035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jazzie,<br><br>I concur, very well done! <br><br></td></tr></table><br>
<a name="718435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jazzie,<br><br>I like your engine, I've tried using fredborg's viewport rotation function (found here: <a href="http://www.blitzbasic.com/Community/posts.php?topic=42799#478997" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=42799#478997</a><br><br>but it only works for a second when "A" is pressed. The code is below, I'm not sure how to put it in a code window yet:<br><br><br>Framework brl.glmax2d<br>Import brl.random<br>Import brl.pngloader<br>SetGraphicsDriver GLMax2DDriver()<br><br>' ----- CONSTANTS -----<br><br>Const scrWidth=640,scrHeight=480			' screen resolution<br>Const scrDepth=32							' bitdept, *** change as required ***<br>Const scrHertz=75							' refresh rate (this is nice and smooth, but change if required).<br>Const tileWidth=32,tileHeight=32			' dimension of tiles<br>Const tileMain=1,tileBack=2,tilePlayer=3	' frame numbers for tiles<br><br>Const playerSpeed=4							' pixels for player to move each update<br><br>Const mapWidth=64,mapHeight=64				' size of map<br>Const marginX=(scrWidth-tileWidth)/2		' margin between edge of screen and centre (horizontal)<br>Const marginY=(scrHeight-tileHeight)/2		' margin between edge of screen and centre (vertical)<br><br>' ----- GLOBALS -----<br><br>SeedRnd MilliSecs()<br><br>Global ms#,fps#,msTot#,msCnt#,msAvg#<br><br>' ----- TYPE / METHOD DECLARATIONS -----<br><br>Type player<br>	Field mapX,mapY					' map block co-ordinates (top left if more than one square occupied)<br>	Field x,y						' pixel co-ordinates<br>	<br>	Function Create:player()		' create a player with the starting x and y map co-ordinates<br>		Local sx,sy<br>		p:player=New player			' create player<br>		Repeat<br>			sx=Rand(1,mapWidth-1)	' choose random x position<br>			sy=Rand(1,mapHeight-1)	' choose random y position<br>		Until lev.Read(sx,sy)=0<br>		p.mapX=sx					' set starting x (map co-ordinate)<br>		p.mapY=sy					' set starting y (map co-ordinate)<br>		p.x=sx*tileWidth			' set x position (pixels)<br>		p.y=sy*tileHeight			' set y position (pixels)<br>		Return p<br>	End Function<br>	<br>	Method Update()<br>		Local dx=(KeyDown(key_right)-KeyDown(key_left))*playerSpeed	' get player input for the x direction<br>		Local dy=(KeyDown(key_down)-KeyDown(key_up))*playerSpeed	' get player input for the y direction<br>		<br>		If dy Then									' check vertical movement<br>			If MapCollision(x+dx,y+dy) Then			' check if we can move<br>				If dx Then							' can't move, but might be trying to move diagonally<br>					If MapCollision(x,y+dy) Then	' can we move straight up or down?<br>						dy=0						' still can't move, so don't allow<br>					EndIf<br>				Else<br>					dy=0							' not trying to move at angle, so don't allow<br>				EndIf<br>			EndIf<br>		EndIf<br>		<br>		If dx Then									' do the same for horizontal<br>			If MapCollision(x+dx,y+dy) Then<br>				If dy Then<br>					If MapCollision(x+dx,y) Then<br>						dx=0<br>					EndIf<br>				Else<br>					dx=0<br>				EndIf<br>			EndIf<br>		EndIf<br>		<br>		x:+dx						' update co-ordinates<br>		y:+dy<br>		mapX=Floor(x/tileWidth)		' update map position<br>		mapY=Floor(y/tileHeight)<br>	End Method<br>	<br>	Method Draw(sx,sy)<br>		DrawImage imgTiles,sx,sy,tilePlayer			' draw plater with supplied screen co-ordinates<br>		DrawText "World position: "+x+","+y,0,0<br>		DrawText "Map position: "+mapX+","+mapY,0,16<br>	End Method<br>End Type<br><br>Type level<br>	Field map[mapWidth,mapHeight]	' define our map array<br>	<br>	Method Read(x,y)				' method to read tile at map position<br>		Return map[x,y]<br>	End Method<br>	<br>	Method Write(x,y,z)				' method to write to a map position<br>		map[x,y]=z<br>	End Method<br>	<br>	Method Draw(ox,oy)							' draw map at specified offset (calculated in RenderGame)<br>		SetBlend solidblend						' set blending to solid to erase screen<br>		TileImage imgTiles,ox/2,oy/2,tileBack	' draw our parallax background image<br>		SetBlend alphablend						' set blending to alpha (not needed, as our tiles are square)<br>		' now go through map and display each tile, but ignore any blank tiles for additional speed<br>		For Local y=0 Until mapHeight<br>			For Local x=0 Until mapWidth<br>				If Read(x,y) Then DrawImage imgTiles,x*tileWidth+ox,y*tileHeight+oy,Read(x,y)<br>			Next<br>		Next<br>	End Method<br>End Type<br><br>Rem<br>	NOTE: The Draw() method above could be optimised further to only loop through those tiles that appear<br>	on-screen, but is not really needed at the moment as only those images that appear on-screen will be<br>	rendered anyway.  Larger and more complicated ganes may benefit if every bit of available processing power<br>	is needed.  The rendering process of this demo runs at under 1ms on a P4 2.4GHZ with Radeon 9800 Pro.<br>EndRem<br><br>' ----- SET UP GRAPHICS -----<br><br>Graphics scrWidth,scrHeight,scrDepth,scrHertz	' change graphics mode<br>HideMouse										' hide the mouse pointer<br><br>Global imgTiles=LoadAnimImage("tiles.png",tileWidth,tileHeight,0,4)	' load the tiles<br><br>' ----- INITIALISE MAP -----<br><br>Global lev:level=New level				' create a level<br><br>For Local x=0 Until mapWidth			' draw the top and bottom borders<br>	lev.Write(x,0,tileMain)<br>	lev.Write(x,mapHeight-1,tileMain)<br>Next<br><br>For Local y=0 Until mapHeight			' draw the left and right borders<br>	lev.Write(0,y,tileMain)<br>	lev.Write(mapWidth-1,y,tileMain)<br>Next<br><br>For Local i=1 To 50						' draws50 random lines of the wall tile<br>	dir=Rand(0,1)<br>	x=Rand(1,mapWidth-2)<br>	y=Rand(1,mapHeight-2)<br>	l=Rand(2,30)<br>	For Local j=0 Until l<br>		If dir Then<br>			lev.Write(x,y,tileMain)<br>			x:+1<br>			If x=mapWidth Then Exit<br>		Else<br>			lev.Write(x,y,tileMain)<br>			y:+1<br>			If y=mapHeight Then Exit<br>		EndIf<br>	Next<br>Next<br><br>' ----- INITIALISE PLAYER -----<br><br>Global face:player=player.Create()			' create a player<br><br>' ----- MAIN LOOP -----<br><br>While Not KeyHit(key_escape)<br>	face.Update						' get player input and update position<br>	RenderGame						' render the screen<br>Wend<br><br>' ----- RENDER FUNCTION -----<br><br>Function RenderGame()<br><br>		If KeyHit(KEY_A)<br>		    Sangle:+1<br>		EndIf<br>		    <br>	Local time=MilliSecs()		' used to time how long this takes (before flipping, which waits for vsync)<br>	Local t$					' used to format render time<br><br>	Local lx,ly,px,py			' level offsets and players on-screen position<br><br>	' check horizontal placement<br>	If face.x&gt;=marginX And face.x&lt;=((mapWidth-1)*tileWidth-marginX) Then	' if player within central area<br>		px=marginX			' player stays in centre<br>		lx=px-face.x		' level offset is player's x minus the margin between the screen edge and player<br>	ElseIf face.x&lt;marginX	' check if player near left edge<br>		px=face.x			' yes, so on-screen position is same as x<br>		lx=0				' and level offset is it's left edge<br>	Else					' otherwise player is near right edge of level<br>		px=marginX+marginX-((mapWidth-1)*tileWidth-face.x)	' calculate player's position based on level width<br>		lx=-mapWidth*tileWidth+scrWidth	' adjust level's position so that right edge is same as screen edge<br>	EndIf<br>	<br>	' check for vertical placement - same as above, but on the y axis<br>	If face.y&gt;=marginY And face.y&lt;=((mapHeight-1)*tileHeight-marginY) Then<br>		py=marginY<br>		ly=py-face.y<br>	ElseIf face.y&lt;marginY<br>		py=face.y<br>		ly=0<br>	Else<br>		py=marginY+marginY-((mapHeight-1)*tileHeight-face.y)<br>		ly=-mapHeight*tileHeight+scrHeight<br>	EndIf<br><br>	lev.Draw(lx,ly)		' draw the level at the calculated offset<br>	face.Draw(px,py)	' draw the player at the calculated on-screen position<br>	<br>	ms=MilliSecs()-time				' work out how long it took to draw<br>	msTot:+ms						' add to total render time for previous frames<br>	msCnt:+1						' increase count (for average)<br>	msAvg=msTot/msCnt				' calculate average render time<br>	If msAvg Then fps=1000/msAvg	' make sure we won't get a /0 error and calculate *estimated* FPS<br>	t=msAvg							' convert to string for displaying on screen<br>	DrawText "Avg render time: "+t[..5]+"ms ("+Int(fps)+" FPS)",0,32	' write to screen<br>	<br>	SetViewRotation (Sangle)<br><br>	Flip							' flip the buffers so we can see everything and clear any rubbish from memory.<br>End Function<br><br>' ----- CHECKS IF ANY SQUARES AT PIXEL CO-ORDINATES ARE OCCUPIED -----<br><br>Function MapCollision(x,y)<br>	Local mx,my<br>	mx=Floor(x/tileWidth)											' get map position<br>	my=Floor(y/tileHeight)<br>	If lev.Read(mx,my) Then Return True								' check top left<br>	If (x Mod tileWidth) Then If lev.Read(mx+1,my) Then Return True	' check top right<br>	If (y Mod tileHeight) Then<br>		If lev.Read(mx,my+1) Then									' check bottom left<br>			Return True<br>		ElseIf (x Mod tileWidth) Then<br>			If lev.Read(mx+1,my+1) Then Return True					' check bottom right#<br>		EndIf<br>	EndIf<br>	Return False<br>End Function<br><br>Rem<br>bbdoc: Set the rotation of the viewport<br>about: SetViewRotation allows you to rotate the entire viewport, so that all<br>drawing is rotated according to the @angle parameter.<br>endrem<br>Function SetViewRotation(angle:Float)<br>	<br>	Global o_angle:Float<br>	<br>	glMatrixMode GL_PROJECTION<br>	glRotatef angle-o_angle,0,0,1<br>	o_angle=angle<br>	<br>	glMatrixMode GL_MODELVIEW<br>	glLoadIdentity<br>	<br>End Function<br><br>Rem<br>bbdoc: Set the offset of the viewport<br>about: SetViewOffset allows you to offset the entire viewport, so that all<br>drawing is offset according to the @offsetx and @offsety parameters.<br>endrem<br>Function SetViewOffset(offsetx:Float,offsety:Float)<br>	<br>	Global o_offsetx:Float<br>	Global o_offsety:Float<br>	<br>	glMatrixMode GL_PROJECTION<br>	glTranslatef offsetx-o_offsetx,offsety-o_offsety,0<br>	o_offsetx = offsetx<br>	o_offsety = offsety<br>	<br>	glMatrixMode GL_MODELVIEW<br>	glLoadIdentity<br>	<br>End Function<br><br>Rem <br>bbdoc: Set the zoom factor of the viewport<br>about: SetViewZoom allows you to zoom all drawn elements at once, instead<br>of scaling each individual element. Use the @zoom parameter to define the<br>level of zoom, a value of 0 is the default zoom, &gt;0 zooms in, &lt;0 zooms out.<br>endrem<br>Function SetViewZoom(zoom:Float)<br>	<br>	Global o_zoom:Float<br>	<br>	glMatrixMode GL_PROJECTION<br>	glScalef 1.0+(zoom-o_zoom),1.0+(zoom-o_zoom),1.0+(zoom-o_zoom)<br>	o_zoom = zoom<br>	<br>	glMatrixMode GL_MODELVIEW<br>	glLoadIdentity<br>	<br>End Function <br><br></td></tr></table><br>
<a name="718475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackSp1der</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>but it only works for a second when "A" is pressed. The code is below, I'm not sure how to put it in a code window yet:<br> <br></div><br>it's because your "sangle" variable is not defined as global. and allways you call rendergame the sangle variable is set to zero.<br><br>put sangle as global before main loop<br><pre class=code>
' ----- MAIN LOOP -----
Global Sangle:Float
</pre><br><br>code box:<br>[ codebox]<br>[ /codebox]<br>(whitout spaces)<br><br>and... you don't need projection matrix. you need to work with Angle, Distance, COS and SIN, is easy. Try to make your own engine. <br><br></td></tr></table><br>
<a name="718477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> thank you, that worked. <br><br></td></tr></table><br>
<a name="718500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackSp1der</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> maybe you can find a better way to do it.<br>it's only an example.<br>use up,down,left,right to move.<br>'A' and 'S' to rotate<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Global ScreenWidth=800
Global ScreenHeight=600

Graphics ScreenWidth,ScreenHeight,0
SetBlend ALPHABLEND
AutoMidHandle True
Local image:TImage=CreateImage(25,15)
DrawText "(X)",0,0
GrabImage(image,0,0)


SetOrigin ScreenWidth/2,ScreenHeight/2


Global Background:TBackground=New TBackground

'create random 50 blocks/sprites
For Local block:Int=0 To 50
	Local newblock:TBlock=New TBlock
	newblock.ImageRotation=Rand(360)
	'position from background center to sprite position
	newblock.Rotation=Rand(360)
	newblock.Distance=Rand(ScreenHeight)
	Background.Blocks.AddLast(newblock)
Next

Background.UpdateBlockCoords(0,0,0)
While Not KeyHit(KEY_ESCAPE) Or AppTerminate()

	Local update:Int
	'check scroll keys
	If KeyDown(KEY_UP) Then
		Background.UpdateBlockCoords(0,+5,0)
	ElseIf KeyDown(KEY_DOWN) Then
		Background.UpdateBlockCoords(0,-5,0)
	ElseIf KeyDown(KEY_LEFT) Then
		Background.UpdateBlockCoords(+5,0,0)
	ElseIf KeyDown(KEY_RIGHT) Then
		Background.UpdateBlockCoords(-5,0,0)
	EndIf
	'check rotation keys
	If KeyDown(KEY_A) Then
		Background.UpdateBlockCoords(0,0,-1)
	ElseIf KeyDown(KEY_S) Then
		Background.UpdateBlockCoords(0,0,+1)
	EndIf

	Cls
	'draw all blocks
	For Local block:TBlock=EachIn Background.Blocks
		SetRotation block.ImageRotation
		DrawImage image,block.X, block.Y
		SetRotation 0
		SetAlpha 0.3
		DrawLine 0,0,block.X,block.Y
		SetAlpha 1
	Next
	'draw player
	SetColor 255,0,0
	DrawOval -10,-10,21,21
	SetColor 255,255,255
	Flip 1
Wend


'----------------------------------------------------------------
Type TBackground

	Global Blocks:TList=CreateList()

	Method UpdateBlockCoords(x:Float,y:Float,rotation:Float)
		For Local block:TBlock=EachIn Blocks
			block.X=x+Cos(rotation+block.Rotation)*block.Distance
			block.Y=y+Sin(rotation+block.Rotation)*block.Distance
			block.Rotation=ATan2(block.y,block.x)
			block.Distance=Sqr( block.x^2 + block.y^2 )
			block.ImageRotation:+rotation
		Next
	EndMethod

EndType

Type TBlock

	Field X:Float
	Field Y:Float

	Field ImageRotation:Float

	Field Rotation:Float
	Field Distance:Float

EndType
</textarea> <br><br></td></tr></table><br>
<a name="718523"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right on, that's cool. If I can get that to work with a tile map I'm golden! <br><br></td></tr></table><br>
<a name="719023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zamfir</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you see this function? This is exactly what I need it to do, just not sure where or how to implement it properly:<br><br>Rem<br>bbdoc: Set the rotation of the viewport<br>about: SetViewRotation allows you to rotate the entire viewport, so that all<br>drawing is rotated according to the @angle parameter.<br>endrem<br>Function SetViewRotation(angle:Float)<br><br>Global o_angle:Float<br><br>glMatrixMode GL_PROJECTION<br>glRotatef angle-o_angle,0,0,1<br>o_angle=angle<br><br>glMatrixMode GL_MODELVIEW<br>glLoadIdentity<br><br>End Function <br><br></td></tr></table><br>
<a name="851752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Foolish</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very helpful.   Thanks guys. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
