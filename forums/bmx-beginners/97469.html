<!DOCTYPE html><html lang="en" ><head ><title >My code for checking game input.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >My code for checking game input.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >My code for checking game input.</a><br><br>
<a name="1132849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >allranger</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am currently trying to making a 2D platform game.  Something like you would see on the classic game consoles.  I have a USB joystick for my computer that looks like a SNES/XBOX controller so I am programing with that in mind.<br><br>I have read several tutorials and am having a blast. But there are a few things I do not grasp at the moment.  The whole OOP is new to me.<br><br>One of the things I read is that you must be careful to only poll user input once a game cycle because it can cause some strange things to happen in your game if you don't because the input may change between checks.<br><br>Of course I did not account for that when I started... :-)<br><br>So I started from over from the ground up and this is what I have:<br><br><br><br>Type TGameInput<br><br>	'Set Varibles for SNES/XBox Type Controller.<br>	Global DPad_Up_Pressed:Int=False<br>	Global DPad_Down_Pressed:Int=False<br>	Global DPad_Left_Pressed:Int=False<br>	Global DPad_Right_Pressed:Int=False<br>	Global Button_Start_Pressed:Int=False<br>	Global Button_Select_Pressed:Int=False<br>	Global Button_A_Pressed:Int=False<br>	Global Button_B_Pressed:Int=False<br>	Global Button_X_Pressed:Int=False<br>	Global Button_Y_Pressed:Int=False<br>	Global Button_L_Pressed:Int=False<br>	Global Button_R_Pressed:Int=False<br><br>	'Set Keys for Varibles.<br>	Global DPad_Up:Int=KEY_UP<br>	Global DPad_Down:Int=KEY_DOWN<br>	Global DPad_Left:Int=KEY_LEFT<br>	Global DPad_Right:Int=KEY_RIGHT<br>	Global Button_Start:Int=KEY_ENTER<br>	Global Button_Select:Int=KEY_TAB<br>	Global Button_A:Int=KEY_X<br>	Global Button_B:Int=KEY_Z<br>	Global Button_X:Int=KEY_S<br>	Global Button_Y:Int=KEY_A<br>	Global Button_L:Int=KEY_Q<br>	Global Button_R:Int=KEY_W<br>	<br>	'Set Varibles for echo.<br>	Global EchoControllerInput:Int=False<br><br>	Function CheckInput()<br>		<br>		If KeyDown(DPad_Up) And Not KeyDown(DPad_Down)<br>			If EchoControllerInput Print "Up."<br>			DPad_Up_Pressed=True<br>		Else<br>			DPad_Up_Pressed=False<br>		End If<br>		<br>		If KeyDown(DPad_Down) And Not KeyDown(DPad_Up)<br>			If EchoControllerInput Print "Down."<br>			DPad_Down_Pressed=True<br>		Else<br>			DPad_Down_Pressed=False<br>		End If<br><br>		If KeyDown(DPad_Left) And Not KeyDown(DPad_Right)<br>			If EchoControllerInput Print "Left."<br>			DPad_Left_Pressed=True<br>		Else<br>			DPad_Left_Pressed=False<br>		End If<br>		<br>		If KeyDown(DPad_Right) And Not KeyDown(DPad_Left)<br>			If EchoControllerInput Print "Right."<br>			DPad_Right_Pressed=True<br>		Else<br>			DPad_Right_Pressed=False<br>		End If<br><br>		If KeyDown(Button_Start)<br>			If EchoControllerInput Print "Start."<br>			Button_Start_Pressed=True<br>		Else<br>			Button_Start_Pressed=False<br>		End If<br>		<br>		If KeyDown(Button_Select)<br>			If EchoControllerInput Print "Select."<br>			Button_Select_Pressed=True<br>		Else<br>			Button_Select_Pressed=False<br>		End If<br>		<br>		If KeyDown(Button_A)<br>			If EchoControllerInput Print "Button A."<br>			Button_A_Pressed=True<br>		Else<br>			Button_A_Pressed=False<br>		End If<br>		<br>		If KeyDown(Button_B)<br>			If EchoControllerInput Print "Button B."<br>			Button_B_Pressed=True<br>		Else<br>			Button_B_Pressed=False<br>		End If<br><br>		If KeyDown(Button_X)<br>			If EchoControllerInput Print "Button X."<br>			Button_X_Pressed=True<br>		Else<br>			Button_X_Pressed=False<br>		End If<br>	<br>		If KeyDown(Button_Y)<br>			If EchoControllerInput Print "Button Y."<br>			Button_Y_Pressed=True<br>		Else<br>			Button_Y_Pressed=False<br>		End If<br><br>		If KeyDown(Button_L)<br>			If EchoControllerInput Print "Button L."<br>			Button_L_Pressed=True<br>		Else<br>			Button_L_Pressed=False<br>		End If<br>	<br>		If KeyDown(Button_R)<br>			If EchoControllerInput Print "Button R."<br>			Button_R_Pressed=True<br>		Else<br>			Button_R_Pressed=False<br>		End If<br>		<br>	End Function<br>	<br>End Type<br><br><br>Then, in may main game loop I run: TGameInput.CheckInput()<br><br>I added EchoControllerInput for debugging.  If it is set to true and you are in a windowed screen it will print out what buttons you are pressing.<br><br>Also, the first time around I was checking to make sure that the user did not have both the left and right or up and down directions pressed for the update part of my loop.  Instead of doing that every time I have now moved it down into the CheckInput Function.<br><br>I plan to add an option so it will read a controller configuration file so you can save the keyboard/joystick options but I have not made it that far yet.<br><br>Does anybody have any input on the code? I think I have accounted for most situations.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="1132863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matibee</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks ok, if a little lengthy IMHO.<br><br><pre class=code>
If KeyDown(Button_L)
If EchoControllerInput Print "Button L."
Button_L_Pressed=True
Else
Button_L_Pressed=False
End If
</pre><br><br>to me, is..<br><pre class=code>
Button_L_Pressed=KeyDown(Button_L)
</pre><br><br>because I don't prevent multiple buttons down in the input code, I deal with it in the game logic.  Multiple buttons are often used for cheats or combos.<br><br>If you have player run logic tied to left and right inputs my input would look something like..<br><br><pre class=code>
If ( KeyDown( KEY_LEFT ) )
  'go left
else if ( KeyDown( KEY_RIGHT ) )
  ' go right
end if 
</pre><br><br>A more flexible system would simply allow you to register the inputs you're interested in with the input action tied to it.<br><br>Most importantly your code will work for your needs right now and you can tweak it later - move forward and get some more game written :) <br><br></td></tr></table><br>
<a name="1132871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matibee</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just remembered this:  <a href="http://www.blitzbasic.com/Community/posts.php?topic=85744" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=85744</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
