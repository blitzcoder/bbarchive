<!DOCTYPE html><html lang="en" ><head ><title >How to find the isometric tile under the mouse?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to find the isometric tile under the mouse?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >How to find the isometric tile under the mouse?</a><br><br>
<a name="1027432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you look at this picture:<br><br><img src="http://zac-interactive.dk/temp/Isometric_Terrain_by_sweet_kungfuman.jpg"><br><br>In this example it is a 5x5 grid stored in an array.<br><br>How would you find out which tile that the user is clicking on? <br><br></td></tr></table><br>
<a name="1027435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> First thing that springs to my mind is:<br><br>Make two axis vectors with origin in the middle lowest corner.<br>Find the points (pointA , pointB) closest to mousexy on both vectors.<br>Get the distance between the origin and pointA and quantize it to get tilex.<br>Get the distance between the origin and pointB and quantize it to get tiley. <br><br></td></tr></table><br>
<a name="1027437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> nice picture by the way -- are those graphics from the project you're actually working on? <br><br></td></tr></table><br>
<a name="1027442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh God this brings back terrible, terrible nightmares. <br><br></td></tr></table><br>
<a name="1027468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> are those graphics from the project you're actually working on? <br></div><br><br>No it was just something random I found using google.<br><br><div class="quote"> Oh God this brings back terrible, terrible nightmares. <br></div><br><br>Why, is it overly complex? <br><br></td></tr></table><br>
<a name="1027477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Let's say each tile is 64x32. Create a 64x32 sprite which is just a blank, flat square ie no depth or height to the tile. The rest is transparent colour. Now have a 1x1 pixel image. Do a collision check between the 1x1 image on your mouse pointer and each tile's position using the flat (invisible) testing sprite. <br><br></td></tr></table><br>
<a name="1027487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been spending some time looking around on the web again today, and I came across this article, which I am not sure why, I did not find yesterday:<br><br><a href="http://www.gamedev.net/reference/articles/article747.asp" target="_blank">http://www.gamedev.net/reference/articles/article747.asp</a><br><br>Using these tiles and a color map tile I managed to come up with something that looks to be working.<br><br><img src="http://zac-interactive.dk/temp/tile_dirt.png"><br><img src="http://zac-interactive.dk/temp/tile_grass.png"><br><img src="http://zac-interactive.dk/temp/tile_water.png"><br><img src="http://zac-interactive.dk/temp/MouseMapIso.png"><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

Graphics 1024,768

SeedRnd(MilliSecs())

Global tile1:TImage = LoadImage("tile_grass.png",0)
Global tile2:TImage = LoadImage("tile_water.png",0)
Global tile3:TImage = LoadImage("tile_dirt.png",0)

Global mousemapiso:TImage = LoadImage("MouseMapIso.png",0)

Global map:Int[12,45]
For Local y:Int = 0 To 44
For Local x:Int = 0 To 11
	map[x,y] = Rnd(3)
Next
Next

Global tileselectx:Int = 0
Global tileselecty:Int = 0

While Not KeyHit(KEY_ESCAPE)
	Cls
	drawmap()
	Flip

	If MouseHit(1) Then
		Local regionX:Int = (MouseX() / 64)
		Local regionY:Int = (MouseY() / 32) * 2
		Local mapX:Int = MouseX() Mod 64
		Local mapY:Int = MouseY() Mod 32
		Local rgb:Int = ReadPixel(LockImage(mousemapiso),mapX,mapY)
		Select rgb
			Case -65536
				tileselectx = regionX - 1
				tileselecty = regionY - 1
			Case -256
				tileselectx = regionX
				tileselecty = regionY - 1
			Case -1
				tileselectx = regionX
				tileselecty = regionY
			Case -16711936
				tileselectx = regionX - 1
				tileselecty = regionY + 1
			Case -16776961
				tileselectx = regionX
				tileselecty = regionY + 1
		End Select
	End If
Wend
End

Function drawmap()
	Local i:Int = 0
	For Local y:Int = 0 To 44
	For Local x:Int = 0 To 11
		If tileselectx = x And tileselecty = y Then
			SetColor 255,255,255
			Else
			SetColor 128,128,128
		End If
		Local tx:Int = x*64
		Local ty:Int = y*16
		If i = 1 Then tx :+ 32
		Select map[x,y]
			Case 0
				DrawImage(tile1,tx,ty)
			Case 1
				DrawImage(tile2,tx,ty)
			Case 2
				DrawImage(tile3,tx,ty)
		End Select
	Next
	i = 1-i
	Next
End Function
</textarea><br><br>This is not code from the game, just something I quickly made to test out the suggestion from that article.<br><br>I hope someone else find it useful as well. <br><br></td></tr></table><br>
<a name="1027498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Enyaw</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wrote a bit of code that works out the mouse position on a isometric grid - <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2608" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2608</a> that you might find usefull and easy to work out how it works. <br><br></td></tr></table><br>
<a name="1027775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raph</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I do what Czar Flavius said. More, if you do it when you go to draw, you can also do things like highlight the hovered tile, etc. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
