<!DOCTYPE html><html lang="en" ><head ><title >[MAXGUI] Getting depth of desktop</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >[MAXGUI] Getting depth of desktop</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >[MAXGUI] Getting depth of desktop</a><br><br>
<a name="660635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there an easy way to do this? I thought for sure the object returned by Desktop() would have a .depth field (and it does have width and height).<br><br>Seems I should be able to say:<br><pre class=code>
dskDesktop:TGadget = Desktop()
width = dskDesktop.Width   ' Works!
height = dskDesktop.Height ' Also works!
depth = dskDesktop.Depth   ' Oops!
</pre><br><br>I know I can use GetGraphicsMode to get info about a specific mode available on the user's system (including depth), but how do I know which index (the first parameter of GetGraphicsMode) is the current one?<br><br>Thanks!<br>Russell <br><br></td></tr></table><br>
<a name="660642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> A TGadget, which is what Desktop() returns for some reason does not have a depth parameter.<br><br>Try this:<pre class=code>Print GetDeviceCaps(GetDC(0),COLORRES)</pre> <br><br></td></tr></table><br>
<a name="660645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks FlameDuck. I was going to try that next ;) (really, I was!). Interestingly, though, although my desktop is set to 32bits, the above returns 24 instead. Maybe it ignores the alpha bits (no relation to the breakfast cereal ;))? <br><br>Any ideas on how to do the above on Mac and Linux?<br><br>Speaking of the TGadget type, I couldn't find the methods and/or functions available for it and tried .height and .width by chance and they worked. Where are these listed?<br><br>Russell <br><br></td></tr></table><br>
<a name="660649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >assari</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> one way is to look into the source code ..\mod\brl.mod\maxgui.mod\gadget.bmx and navigate via the IDE's Code Tab. <br><br></td></tr></table><br>
<a name="660653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> In OpenGL you can use glGetIntegerv(GL_RED_BITS,Varptr(redbits)) and the same for GL_GREEN_BITS, GL_BLUE_BITS, GL_ALPHA_BITS, and also for the other buffers such as GL_STENCIL_BITS, GL_DEPTH_BITS, GL_ACCUM_BITS.<br><br>You WILL find that the numbers that this reports back to you might well be different to how the mode is *described* in the list of screen modes, and even how it is described in the o/s.<br><br>My desktop is 32-bit. Or rather, it refers to is as widthxheight Millions of colors. Then in Max, if I get the list of modes, it reports it as 32-bit. However, OpenGL reports the desktop is a 24-bit desktop, not 32-bit, and doesn't have an alpha buffer. Also if I switch my display to a 16-bit desktop, which is advertized in the o/s as widthxheight Thousands of colors, Max reports it as a 16-bit mode from the list, but in OpenGL it reports it is actually a 5:5:5 mode, ie 15-bit, with no alpha.<br><br>Conclusion: GetGraphicsMode() returns only a higher-level approximation of what the mode is, not the actual mode. The actual mode internally may be less bits per pixel and may not include an alpha channel. 32-bit might actually be 24-bit and 16-bit might be 15-bit.<br><br>Yet, if you try opening a 15-bit screen, having been told by OpenGL that it is 5 bits per pixel not 5:6:5, you will have some problems - a display might open but it can be extremely slow compared to the 16-bit mode - whereas if you request a 16-bit mode, it gives you 16-bits-per-pixel but uses only 15 of them. All confusing stuff.<br><br>To get desktop depth I open a very small window 64x1 and then use test via OpenGL, add up the bits and see what you get. You might want to assume that 15-bit=16-bit, but it probably will report correctly whether you have an alpha buffer.<br><br>NB: Opening a window on a 32-bit screen which is actually a 24-bit screen, and asking for an alpha channel, does give you an alpha channel. It seems. <br><br></td></tr></table><br>
<a name="660663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, AD. If I were using OGL directly, I'd probably use the method you describe.<br><br>Basically, what I want to do is inform the user that if they are running a 256 color desktop (unlikely, I know), they will have to switch to HiColor or TrueColor...and have this work on all platforms.<br><br>FlameDuck's method works fine on Win32, but doesn't help me if/when I try to compile this on other platforms.<br><br>Hopefully, BRL will offer a simple solution in a near-future update? :)<br><br>Russell <br><br></td></tr></table><br>
<a name="660842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, you can't use DirectX on linux or mac so you have to use OpenGL if you want to test it.<br><br>You may get an unusual response from OpenGL, as well, it might say the bit depth is -1.<br><br>I'm still experimenting with this. Having a box come up in 256-color mode is a good idea. Having said that, the display probably will still work if the desktop is 256-color, it will just take a while longer to convert from truecolor to indexed. <br><br></td></tr></table><br>
<a name="661550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> As a simple workaround that should work on all platforms, is there a way to find out which mode is the current one? Because then I could just use GetGraphicsMode() to get the depth.<br><br>Thanks!<br>Russell <br><br></td></tr></table><br>
<a name="665759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unfortunately that won't work becauase the list of graphics modes filters out any 256-color modes and lists only modes from 15/16-bit upwards. You can however apply that when the mode is 16/24/32-bit, but usually if it says 24-bit you may have to upgrade it to a 32-bit mode. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
