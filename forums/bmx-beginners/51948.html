<!DOCTYPE html><html lang="en" ><head ><title >Do Arrays use more memory than single variables?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Do Arrays use more memory than single variables?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Do Arrays use more memory than single variables?</a><br><br>
<a name="579705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hope someone can answer this, for instance would an array of MyArray[3] use more memory than just having three variables MyVar_A, MyVar_B, and MyVar_C? Plus how much extra memory (if it does) does it use. <br><br></td></tr></table><br>
<a name="579791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Probably something like an extra 4 bytes or maybe 8 - But this is fixed no matter if your array has 10 elements or 10,000. Not worth worrying about. <br><br></td></tr></table><br>
<a name="579801"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>Print MemAlloced()
Local myArray[3]
Print MemAlloced()
Local myVar1 , myVar2 , myVar3
Print MemAlloced()</pre>Looks like it. <br><br></td></tr></table><br>
<a name="579809"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this interesting?<br><pre class=code>
Print MemAlloced()
Print MemAlloced()
Local myVar1 , myVar2 , myVar3
Print MemAlloced()
</pre><br>If memalloced command takes 20 (bytes?) of mem then why don't the variables use anything? <br><br></td></tr></table><br>
<a name="579813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> tonyg, try<br><pre class=code>
Flushmem()
Print MemAlloced()
FlushMem()
Print MemAlloced()
Local myVar1, myVar2, myVar3
FlushMem()
Print MemAlloced()
</pre><br>seems MemAlloced uses memory that isn't released until Flushmem() is called. <br><br></td></tr></table><br>
<a name="579814"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's right but if you take out the 'print memalloced' memory usage there is 0 for the variables. If you do the same test with an array it *does* use memory. <br>Even if I value the variable it doesn't seem to use any memory. I could be misreading this. <br><br></td></tr></table><br>
<a name="579815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just tested: an array[3] takes 58 bytes and the three variables together only use 22 bytes. So using arrays effectively doubles the what-would-be memory usage. Anyone get similar findings? <br><br></td></tr></table><br>
<a name="579816"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Array[3] takes 36 bytes and the variables together take nothing(?) <br><br></td></tr></table><br>
<a name="579841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The variables are initialised at init time, before your first command can be executed.  The arrays are allocated during run time, when you expect them to be initialised using your code.  That explains why the Local line causes no memory loss. <br><br></td></tr></table><br>
<a name="579845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> So when we check memory usage of programs it's not reporting any memory used by variables? <br><br></td></tr></table><br>
<a name="579870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's probably exceptions, but for the most part I think variables always take up ram since the birth of the program's existance.  4 or 8 bytes or something each probably. <br><br></td></tr></table><br>
<a name="579871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If its anything like C then it would be a 4 byte pointer to a memory address wouldnt it? In my code (to get my results above) I casted each as an Integer. I havnt checked the results without casting,<br><br><pre class=code>
Print MemAlloced()
Local MyArray:Int[3]
Print MemAlloced()
Local A1:Int, A2:Int, A3:Int
Print MemAlloced()
</pre> <br><br></td></tr></table><br>
<a name="579874"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> That still doesn't show any memory being used by the variables even if they hold a value. <br><br></td></tr></table><br>
<a name="579880"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Leiden, you're probably right - 4 byte pointer + 4 byte Int (or 8 byte double/1 byte Byte) = a range between 5 and 12 bytes.  Theoretically.  Anything could be going on under the hood. <br><br></td></tr></table><br>
<a name="579887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> So there isnt any way to get the amount of memory being used under the hood then? <br><br></td></tr></table><br>
<a name="579889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not that I know of.  I should stress that I'm only hypotheticising here, I don't profess to know anything about...  well, anything.<br><br>As for what goes on under the hood, well that will become clearer to all once the compiler is opensourced. <br><br></td></tr></table><br>
<a name="579935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nelvin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> An array needs some internal memory too - the heap manager has to manage the allocated blocks for your array somehow.<br>The array itself needs the number of bytes you decided it to consume *and* an internal memblockheader (8 bytes IIRC) *AND* you need an additional pointer (4byte) for accessing the array (accessing an array is slower than membervariables too because it's simply more to do and there's a huge potential for cache misses which will make your arrayaccess 10, 20times slower than reading a member variable - please note that this is typically not the case in 10lines of benchmarkcode, but very much in reallife situations)<br><br>Last but not least - non object variables (ints, floats etc) do not need any memory because they'r "allocated" on the stack not the heap. <br><br></td></tr></table><br>
<a name="580132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh thanks for that. So if I followed you on that correctly there is a 4 byte accessor to the array, but the accessor is slower than using a membervalue. So I thought that BlitzMax would be doing everything the optimal way? I'm honestly dont have a clue what a membervariable is, can you explain that one please? <br><br></td></tr></table><br>
<a name="580150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think he meant memory variable.  =] <br><br></td></tr></table><br>
<a name="580153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ohh thanks, So does that mean that BlitzMax isnt doing arrays the optimal way? <br><br></td></tr></table><br>
<a name="580166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Last but not least - non object variables (ints, floats etc) do not need any memory because they'r "allocated" on the stack not the heap. <br></div>True. However shouldn't it be the same for an array of simple datatypes? What about Global Ints, Floats, etc. Shouldn't they be allocated on the heap aswell? They don't use any additional memory.<br><br><div class="quote"> Ohh thanks, So does that mean that BlitzMax isnt doing arrays the optimal way? <br></div>No. <br><br></td></tr></table><br>
<a name="580206"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I'm not mistaken a one dimension array takes 24 bytes + the array data (by example 4 bytes per slot in an int array). For a 2 dimension array that would be 28 bytes + the array data, and so on.<br><br><div class="quote"> True. However shouldn't it be the same for an array of simple datatypes <br></div>No because Arrays in BlitzMax are true objects, though handled very specially.<br><br><div class="quote"> Shouldn't they be allocated on the heap aswell? They don't use any additional memory. <br></div>Err, What? No. Not sure to see what you meant, but when you have a global array it should still be allocated on the heap. It's the reference to the array object that is global and statically allocated, the object should be allocated on the heap, or else you'd never be able to make it point to a bigger or smaller array. <br><br></td></tr></table><br>
<a name="580264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nelvin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> @FlameDuck<br>Global values which only need a onetime init will typically end in some kind of data area in memory - locals have to be initialized whenever they come into scope - but both won't change the memory allocated dynamically.<br>And as Koriolis wrote - it's because an array is some dynamic object.<br><br>@ LeidenK<br>They are slower because there are 2 steps necessary to read a value instead of only one for reading a variable.<br><br>Try to imagine it - accessing a variable is like ... looking at a sheet of paper, you only have to look on it and see what is written on it - accessing an array is like you have a book and a page number - now to get your information you first have to take that book, open your indexed page and then read what's written on it.<br><br>It of course depends on the environment, if you have some 100 oder 1000 reads it wont be noticable, but if your app/game is a real number cruncher accessing arrays maybe millions of times a second it may very well make a difference - especially for simple calculations. <br><br></td></tr></table><br>
<a name="580289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> And as Koriolis wrote - it's because an array is some dynamic object. <br></div>Yeah that makes sense. <br><br></td></tr></table><br>
<a name="580309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nelvin: You example helped me to understand how Arrays are accessed. Thnx! :)<br><br>I suppose that using arrays for the time being isnt going to be an issue. Its too much of a hastle to not use them as they provide a simple, compact way to store multiple values under one name. Plus with todays processors it wont make much difference. <br><br></td></tr></table><br>
<a name="580552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Which is precisely why they exist.  =] <br><br></td></tr></table><br>
<a name="580571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehe good point ;) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
