<!DOCTYPE html><html lang="en" ><head ><title >Tile Masks</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Tile Masks</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Tile Masks</a><br><br>
<a name="837721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ponyboy</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> For the game I'm working on, I want to be able to use tile masks on the first and second layers of a map. To do this, what needs to happen is I need draw the first layer (like grass) and then take the mask (a black and white image) and blit it onto the second layer tile using either black or white as the transparent image. At this point I have the second layer tile and tile mask as one image and can then blit that on top of the first layer tile using the opposite color as the transparent color to get transition effect amongst tiles.<br><br>The problem I foresee is that in BlitzMax, I can't blit to offscreen images right? So how would I go about creating this effect then in BlitzMax? <br><br></td></tr></table><br>
<a name="837723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since Max2D is 3D, cant you just use alpha channels?<br>I assume it would be faster than 2D bit masking. <br><br></td></tr></table><br>
<a name="837725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ponyboy</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> By alpha channels I'm assuming you mean when I save the tiles have a transparent alpha channel in the png file?<br><br>I could do that but then every single ground tile that I use (there are 20+), would have to be saved with every single transition used (there are 30+) which results in 600+ tiles, ~550 of which are not needed if I can just use a tile mask.<br><br>I'm trying to avoid this as it's a lot of extra work and a waste of memory having to hold on to that many extra tiles. <br><br></td></tr></table><br>
<a name="837739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can not blit to images at all. BM is 2D through 3D.<br><br>You can only blit to the backbuffer or paste a pixmap into another pixmap.<br><br>But none of these actually helps as masking isn't a "realtime" effect as well, changing an image means reupload of its pixmap to the graphic card.<br><br>For your purpose, you most likely would have a list of pixmaps with the masks and then paste that into a copy of the corresponding image (after you locked it to get its pixmap).<br><br><br>But be aware that this means that each of those different images uses its own space in VRAM. <br><br></td></tr></table><br>
<a name="837741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im not sure how your transitions work, but you can get this kind of thing on the cheap with 3D.<br><br>By drawing 2 quads with alternating alphas. (ie one quad goes  from left-&gt;right, the other in reverse)<br><br>How to do this with Max2D is unclear to me though.<br><br>Since what you are after seems like a pure 2D operation, you might be better of with SDL or DirectDraw... <br><br></td></tr></table><br>
<a name="837754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you're basically trying to do a cross-fade between two tiles, which is basically alpha blending.<br><br>What you sound like you need is to be able to have multiple frames of animation in the alpha channel of any given tile that you want to use it with. That's pretty tricky on graphics hardware because usually the alpha has to be embedded in with the RGB data.<br><br>You could sort of do it manually whereby you draw the background layer and then you fade it out by the inverse of the alpha fade value by drawing a black rect/mask over it at the appropriate level of transparency. Then you could do the same as you said with another image somewhere else and fade it up to white a bit. But then you need to `grab` that second composite image so that you can draw it with LIGHTBLEND which will add it to the other image, producing the effect of a cross-fade. You sort of need offscreen drawing to do the second image and the grab, so you could draw it to the backbuffer, do your fade-to-white, grab it, clear the screen, draw the background layer, fade it, then draw the other image on top additively. But grabbing is not something you really want to do many times in little pieces and direct render to texture would be faster.<br><br>An alternative is to make sure your app opens in a 32-bit screen with a destination alpha channel, draw your alpha mask to the destination alpha only, draw the background object as RGB and not to the alpha channel, then set up a blend more which uses the destination alpha to determine the fade value, and then draw the second image on top as RGB using the dest alpha. But this won't work in 16-bit or even 24-bit screens, must be 32-bit and you'll have to write your own code for DirectX or OpenGL. <br><br></td></tr></table><br>
<a name="837759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=72749#813109" target="_blank"> Texture splatting </a> might help.<br>There is some more code later <a href="/posts.php?topic=73158" target="_blank"> here </a>. It's DX only there but OGL should be possible. <br><br></td></tr></table><br>
<a name="837763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ponyboy</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's pretty much exactly what I want to do but for multiple tiles on the map. Gonna need it for OpenGL though also. Looks like I got some work cut out for me. <br><br></td></tr></table><br>
<a name="837765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would actually precalculate the needed images on load of the tile map and then store them. That way you only need your base tex and the masks stored on the disk and the rest will be generated dynamically once for each map.<br>The reason is that the images etc are no static mesh so multi texturing is nice but a quite overnice setup overhead as well. <br><br></td></tr></table><br>
<a name="837769"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here are some more links then :<br><a href="http://www.gamasutra.com/features/20011024/peasley_03.htm" target="_blank"> Tiled Terrain  </a><br><a href="http://www.gamedev.net/reference/articles/article934.asp" target="_blank"> Tile/Map-Based Game Techniques: Handling Terrain Transitions  </a><br><a href="http://www.gamasutra.com/features/19981009/multitexturing_01.htm" target="_blank"> Multitexturing in DX6 </a><br><a href="http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=22" target="_blank"> NeHe OGL multitexture basics </a><br><a href="http://www.gamedev.net/reference/articles/article2238.asp" target="_blank"> Texture splatting in D3D </a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
