<!DOCTYPE html><html lang="en" ><head ><title >Garbage Collection Checklist?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Garbage Collection Checklist?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Garbage Collection Checklist?</a><br><br>
<a name="558910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to refactor someone else's code, including making it much more OO, and moving things around between types. It's going very nicely in all ways except one. Types are not being Delete()'d. I have a Destroy() method which removes the object from the global type list and also removes a reference from a container type. There should not be any more references anywhere except locals which go out of scope. I call FlushMem in the main loop only.<br><br>I'm just wondering if there's anything I could be checking to help me find why it's not being freed correctly. I remember seeing something about FlushMem having scope but there's nothing in the FlushMem documentation when I double F1 ( well there wouldn't be, would there? )<br><br>I doubt that's the problem, but I have to consider all possibilities now. For reference, yes, the destroy method is verified as being called, and yes, FlushMem is definitely being called every frame. <br><br></td></tr></table><br>
<a name="558913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Flushmem only cleans the current and subscope. So if called from a function, it only frees stuff that was created during the running of this function, not what had existed before its execution.<br><br>Because of that, it is normally called in the mainloop as its commonly the "lowest" existing scope. <br><br></td></tr></table><br>
<a name="558916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> When you say 'Global type list' you're not referring to anything similar to the B3D Global type list because, I;m sure you know, Bmax hasn't got one.<br>You are using listremove for each list that the type has been added to?<br>If this doesn't help try setting the type variable handle to null and see what happens. Mark suggested it's not necessary but you never know...<br><a href="/posts.php?topic=44911" target="_blank"> Memory management </a> <br><br></td></tr></table><br>
<a name="558923"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Basically if you want to emulate Blitz3D's way of thinking and not worry about memory, just place it before your flip.<br><br>The scope is always the present and any routines called below it, therefore no worries if you stick it in your main loop.<br><br>It's only optional because you might want to create and free one million types and THEN flush the memory when you're ready. Overall, it gives Blitzmax a nice speed boost.<br><br>For most games, it's perfectly ok to stick it before the flip. <br><br></td></tr></table><br>
<a name="558941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, it looks like it was just a case of FlushMem scope. Although I was calling it in the main loop, right after flip, the main loop is housed in a "master" type called game which controls everything else. I've made a new main loop which calls the old main loop and moved FlushMem from the old one to the new one and things are being deleted now.<br><br>Tony: Right. when I said global type list, I meant a type list stored in a global type variable. I remove all the entries from the list when destroying them. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
