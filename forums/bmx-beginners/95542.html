<!DOCTYPE html><html lang="en" ><head ><title >Angles. and rotation..</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Angles. and rotation..</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Angles. and rotation..</a><br><br>
<a name="1100993"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul "Taiphoz"</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm about to start a small test project, little bit of code to see if a basic game concept will work out, and once thing that I will need to do a lot is turn one sprite to face a given position on the screen, but last time I worked with angles I recall max was different to blitz3D.<br><br>Does anyone have any bullet proof way of handling this ? not touched it in ages id rather not fumble around and fall into old habbits its the perfect chance for me to learn a better way of doing it. <br><br></td></tr></table><br>
<a name="1101012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> are you talking about 2D or 3D? What do you mean with "face"?<br><br>BlitzMax has only 2D drawing possibilities. So how you make a sprite "face" a given position?<br><br>I think we need more information about the visual situation you are expecting... <br><br></td></tr></table><br>
<a name="1101033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Atan2() using the coordinates of the player and enemy.<br><br>angle = atan2(ey-py, ex-px) <br><br></td></tr></table><br>
<a name="1101041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul "Taiphoz"</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gfk yeah thats what I would do but when it comes to taking that value and making it point my sprite in the right direction I always get all screwed up I work it out in the end but its always a pain in the ass.<br><br>I think its cos it yields -180,180 response as I recall, and I always instinctively try something like pointenemy(180) and expect it to face down the screen when in fact it ends up facing left or something.<br><br>I recall writing a function that takes that daft angle system and converts it to a 0/360 system but I cant find it, guess im gona have to do it again. <br><br></td></tr></table><br>
<a name="1101042"></a>

<a name="1101043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul "Taiphoz"</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh sorry yeah 2D at the moment while I proof the concept out, but then with everything working I plan to port it all to 3D, in reality very little code will need to change from 2D to 3D so doing it in 2D first as it does not require a ton of time spend on art assets.<br><br>which of course means I have more time on code, with my limited time for blitz, having more time on it is a good thing.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Gfk yeah thats what I would do but when it comes to taking that value and making it point my sprite in the right direction I always get all screwed up I work it out in the end but its always a pain in the ass. <br></div><pre class=code>SetRotation(Angle)
DrawImage imgPlayer,px,py</pre><br>But you are confusing me with the to-ing and fro-ing between 2d and 3d buzzwords.  I really don't see the point in writing something in 2d, then rewriting it all in 3d afterwards.  I also don't understand how you think that changing it from 2d to 3d will be a quick process as surely all of your art assets would need to be replaced with meshes. <br><br></td></tr></table><br>
<a name="1101183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> the main thing you have to remember is that if your original image is not facing to the right at it's unrotated state then you have to do some adjustment to the setRotation angle before display.<br>if your image natural angle is facing up then just before display you need to do something like this:<br><pre class=code>
setRotation(angle+90)
</pre><br>to avoid this kind of problems and if your images are not facing to the right use a paint program and turn and/or flip all of your images to face to the right. <br>then you can do as GFK prescribed. <br><br></td></tr></table><br>
<a name="1101204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Paul "Taiphoz"</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> So when I draw a new sprite I should face it right, I always have mine facing up dont know why just habbit I guess. <br><br></td></tr></table><br>
<a name="1101212"></a>

<a name="1101214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>So when I draw a new sprite I should face it right, I always have mine facing up dont know why just habbit I guess. <br> <br></div><br>just about everybody face them up.<br><br> Don't worry about the negative number in the atan2. You still will get the correct results.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1101251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> here is a code sample to demonstrate Atan2 without the "180° problems". <br><br><pre class=code>Graphics 400,300
	x#=100
	y#=100
	add#=.5
	xadd#=add
	yadd#=0
	kiX=200
	kiy=150

Repeat
	x=x+xadd
	y=y+yadd
	If xadd&gt;0 And x&gt;300
		xadd=0
		yadd=add
	ElseIf yAdd=add And y&gt;200
		xadd=-add
		yadd=0
	ElseIf XAdd=-add And x&lt;100
		xadd=0
		yadd=-add
	ElseIf yAdd=-add And y&lt;100
		xadd=add
		yadd=0
	
	EndIf
	Cls
	SetColor 0,155,0
	DrawRect 98,98,210,110
	SetColor 255,0,0
	DrawOval kiX,kiY,5,5
	SetColor 0,0,255
	DrawOval x,y,5,5
	winkel%= ATan2(x-kiX,y-kiY)
	SetColor 255,255,255
	DrawText winkel,10,10
	DrawText "=" + ((winkel+360) Mod 360) + " Grad",10,30
	Flip 1
	
Until KeyHit(key_Escape)



</pre><br>There is also a article in the german board about "facing two objects in 2D without screwing problems" maybe it can help you:<br><br><a href="http://www.blitzforum.de/forum/viewtopic.php?p=392344#392344" target="_blank">http://www.blitzforum.de/forum/viewtopic.php?p=392344#392344</a><br><br><br>sample:<br><pre class=code>WorldWinkel = Atan2 ( GesuchterX - VerfolgerX ,  GesuchterY - VerfolgerY )
WorldWinkel = (WorldWinkel +360° ) mod 360°
ZielWinkel = WorldWinkel - SichtRichtung
If ZielRichtung &lt; - 180°
    ZielRichtung = ZielRichtung + 360°
Endif
If ZielRichtung &gt; + 180°
    ZielRichtung = ZielRichtung - 360°
Endif</pre><br><br>you have to keep in mind that Atan2 results the WorldAngle (WorldWinkel). If your hunter already runs in a certain direction (SichtRichtung), you have to keep in mind this to calculate the required turn of the hunter (ZielRichtung). Only now you can decide how to turn... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
