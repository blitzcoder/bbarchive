<!DOCTYPE html><html lang="en" ><head ><title >WaitKey_or_Mouse()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >WaitKey_or_Mouse()</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >WaitKey_or_Mouse()</a><br><br>
<a name="843161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LeeFbx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wanted a function that would combine Waitkey and Waitmouse.<br>After looking at the source code, I put this together and to my complete astonishment it seems to work.<br><br>Is this a good place to post this?<br>What about making it a regular part of BlitzMax?<br><br><br>' Function that waits for a key press or mouse click<br>' Mouse keys are returned as 255 + mouse key code<br><br>Function WaitKey_Or_Mouse()<br>    Local n%<br>	FlushKeys ;	FlushMouse<br>	Repeat<br>		WaitSystem<br>		For n=1 To 255<br>			If KeyHit(n) Return n<br>		Next		<br>		For n=1 To 3<br>			If MouseHit(n) Return n + 255<br>		Next		<br>	Forever<br>End Function <br><br></td></tr></table><br>
<a name="843173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> :)<br><br>If you don't want the know what key or mouse button has been pressed you can use,<br><br><pre class=code>While Not KeyHit() Or MouseHit(); Wend</pre> <br><br></td></tr></table><br>
<a name="843249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
While Not KeyHit() Or MouseHit(); delay(1); Wend</pre><br><br>Thats better, the above is a pure overkill as the point of wait is to halt the execution <br><br></td></tr></table><br>
<a name="843350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LeeFbx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The point is I DO care which key or button was pressed.<br>WaitKey and WaitMouse each issue their own "WaitSystem" and you can't satisfy both at once.<br><br>KeyHit() and MouseHit() don't seem to work without a specific key code between the parentheses.<br>This is the idea of what I want, but it doesn't work either:<br><br>While Not (kc = WaitKey())|(kc = WaitMouse())  ; Delay(1); Wend<br><br>WaitKey_Or_Mouse() gets around the two waitsystem bind. <br><br></td></tr></table><br>
<a name="843355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>Graphics 640,480

Repeat
	quit:Int = 0
	If MouseHit(1) Then quit = 1001
	If MouseHit(2) Then quit = 1002
        If Not quit
        	quit = GetChar()
        EndIf
	Delay 1	
Until quit &lt;&gt; 0

Print quit
</pre> <br><br></td></tr></table><br>
<a name="843363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LeeFbx</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That does the job nicely too.  Thanks GfK. <br><br></td></tr></table><br>
<a name="843542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The only problem with using GetChar instead of looping through all the key codes with KeyHit/Down is that each return different codes.<br><br>KeyHit/Down returns BlitzMax's scan/key code, whereas GetChar returns the ASCII code of the key being pressed.  Therefore GetChar can return two different values for the letter "a" depending on whether Caps Lock is on, or whether the Shift key is being held down at the time.<br><br>I have the option of redefining controls in my game, and as all keyboard checks are done using scan codes during the game, I have to scan all codes during this set-up to ensure that I'm checking the right keys in game.  Of course, I could set-up some kind of look-up table to convert ASCII codes to scan codes, but then KeyHit/Down can check keys that I can't detect with GetChar.<br><br>It's a shame that there isn't a GetChar equivalent for scan codes, as the looping method does show some significant slow-down on my lower spec'd iBook (I have a demo of the game running in the background at all times). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
