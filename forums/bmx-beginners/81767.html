<!DOCTYPE html><html lang="en" ><head ><title >Open File in a Directory</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Open File in a Directory</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Open File in a Directory</a><br><br>
<a name="921149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bookworm99</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>I have a function which saves a file using RequestFile, CreateFile, OpenFile, and CloseFile. <br><br>The file is created correctly, and in the right place with RequestFile and CreateFile, but when I open the file with OpenFile it returns null. <br><br>Here's the code: <br><br><pre class=code>
Function saveFileAs()

Local time:String = CurrentTime$()
Local timeOut:String[] = time.split(":") 
Local timeString$ = timeout[0]+timeout[1]+timeout[2]
	
filter$="Character Files (.chr);All Files:*"
filename$=RequestFile( "Save File As:",filter$,True)

saveFile=CreateFile(filename$)

saveLns=OpenFile(filename$)

WriteLine saveLns,"RPG-X Character Creator Saved Character File"
WriteLine saveLns,"Created on "+CurrentDate$()+" at "+timeString$+"."
WriteLine saveLns,"-------------------------------------------------"
WriteLine saveLns,""
WriteLine saveLns,"Name: "+TextFieldText(characterName)
WriteLine saveLns,"Age: "+TextFieldText(characterAge)
WriteLine saveLns,"Gender: "+SelectedGadgetItem(charGenderComboBox)

CloseFile savedLns 

	
Return 0


End Function 
</pre><br><br>All help is appreciated - thanks! <br><br></td></tr></table><br>
<a name="921154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't use OpenFile.  Use WriteFile and ReadFile instead. <br><br></td></tr></table><br>
<a name="921156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bookworm99</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried that... no luck. Same thing happens. <br><br></td></tr></table><br>
<a name="921157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't know then.  If ReadFile is returning Null, then I'd be 99.99% certain that you've got the file/path wrong.<br><br>You should post some more code (like, the code where you're trying to read the file - i.e. where the error is). <br><br></td></tr></table><br>
<a name="921160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bookworm99</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've fixed it. There was a very simple typo, that's all. Thank you. <br><br></td></tr></table><br>
<a name="921164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, just so you're aware - if by any chance a file happens to be read-only, it won't open with OpenFile. ;) <br><br></td></tr></table><br>
<a name="921205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bookworm99</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I knows that.<br><br>I have another question.<br><br>I have a biiig file, a config file for something, and I want to edit a certain line which begins with, say, "setup character bind "0"" <br><br>how do I find that line so I can edit it? <br><br></td></tr></table><br>
<a name="921214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Volker</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Open the file.<br>Read all lines in a list or array.<br>Check all lines:<br><pre class=code>
local line:string
If line.contains("setup character bind ")
  ' replace line with new one
end if
</pre><br>I dont know about searching for " in a string; may cause problems!<br><br>Then write the list/array back to file.<br>There is no way to edit something in the middle of a file as far as I know. <br><br></td></tr></table><br>
<a name="921216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I dont know about searching for " in a string; may cause problems! <br></div><br><pre class=code>local line:string
If line.contains("setup character bind ~q0~q")
  ' replace line with new one
end if
</pre> <br><br></td></tr></table><br>
<a name="921220"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bookworm99</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm... so I would store each line of the file in an array, and read each line until I find what I want? That would work, but I'm a bit shaky on how I'd actually go about copying the file into an array, then writing it back out into the file...<br><br>This help is great; it's very much appreciated :) <br><br></td></tr></table><br>
<a name="921283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Volker</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I prefer a TList for this:<br><pre class=code>
SuperStrict 

Local filetoread:TStream = OpenFile("test.txt") ' make sure that there is a file with this name!
Local filelist:TList = New TList

' Read from file
While Not Eof(filetoread) ' reading the file to the list
	Local line:String = ReadLine(filetoread) ' read a line
	filelist.AddLast(line) ' add it to the list
Wend
CloseFile(filetoread)

' write list back to file
Local filetowrite:TStream = OpenFile("test.txt")
For Local line:String = EachIn filelist        ' cycle throug the list
	WriteLine (filetowrite, line)		' write line to file
Next
CloseFile(filetowrite) ' Better never forget, Windows opens the same file only a few hundred times :-)




</pre> <br><br></td></tr></table><br>
<a name="921293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bookworm99</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alright, I'll try adding the replace code in there as well :) <br><br>Something like this: <br><br><pre class=code>
Local filetoread:TStream = OpenFile("test.txt") ' make sure that there is a file with this name!
Local filelist:TList = New TList

' Read from file
While Not Eof(filetoread) ' reading the file to the list
	Local line:String = ReadLine(filetoread) ' read a line
	filelist.AddLast(line) ' add it to the list
If filelist.line.contains("REPLACE")

filelist.line.contains = "replaced"

end if

Wend
CloseFile(filetoread)

' write list back to file
Local filetowrite:TStream = OpenFile("test.txt")
For Local line:String = EachIn filelist        ' cycle throug the list
	WriteLine (filetowrite, line)		' write line to file
Next
CloseFile(filetowrite) ' Better never forget, Windows opens the same file only a few hundred times :-)
</pre> <br><br></td></tr></table><br>
<a name="921360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Volker</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> That will not work. You misuse the string method 'contains'.<br>Just assing a new value to the readed line before storing <br>it in the list:<br><br><pre class=code>
SuperStrict

Local filetoread:TStream = OpenFile("test.txt") ' make sure that there is a file with this name!
Local filelist:TList = New TList

' Read from file
While Not Eof(filetoread) ' reading the file to the list
	Local line:String = ReadLine(filetoread) ' read a line
	'
	If line.Contains("REPLACE") ' check for searched string
		line = ("replaced") ' replace readed line with the new line
	End If
        '
	filelist.AddLast(line) ' add it to the list
Wend
CloseFile(filetoread)

' write list back to file
Local filetowrite:TStream = OpenFile("test.txt")
For Local line:String = EachIn filelist        ' cycle throug the list
	WriteLine (filetowrite, line)		' write line to file
Next
CloseFile(filetowrite) ' Better never forget, Windows opens the same file only a few hundred times :-)
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
