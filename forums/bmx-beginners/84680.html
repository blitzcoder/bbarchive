<!DOCTYPE html><html lang="en" ><head ><title >masked image and shaded blend doesnt work?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >masked image and shaded blend doesnt work?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >masked image and shaded blend doesnt work?</a><br><br>
<a name="956898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> hi<br><br>I have been trying forever to get a masked image to shade blend correctly but it always ends up choosing to multiply the black pixels.  does anyone know why this is or a way around this? <br><br></td></tr></table><br>
<a name="956902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> MASKBLEND doesn't work at the same time as SHADEBLEND, but there is a way to make it work...<br><br>Here is some code from glmax2d.mod outlining how it works out what to do in the various blend modes:<br><br><pre class=code>
Case MASKBLEND
	glDisable GL_BLEND
	glEnable GL_ALPHA_TEST
	glAlphaFunc GL_GEQUAL,.5
Case SOLIDBLEND
	glDisable GL_BLEND
	glDisable GL_ALPHA_TEST
Case ALPHABLEND
	glEnable GL_BLEND
	glBlendFunc GL_SRC_ALPHA,GL_ONE_MINUS_SRC_ALPHA
	glDisable GL_ALPHA_TEST
Case LIGHTBLEND
	glEnable GL_BLEND
	glBlendFunc GL_SRC_ALPHA,GL_ONE
	glDisable GL_ALPHA_TEST
Case SHADEBLEND
	glEnable GL_BLEND
	glBlendFunc GL_DST_COLOR,GL_ZERO
	glDisable GL_ALPHA_TEST
Default
	glDisable GL_BLEND
	glDisable GL_ALPHA_TEST
End Select
</pre><br>In masked blend, your sprite's alpha channel values have to be 128 or higher (0.5 to 1.0) in order to be drawn. Blending is also switched off so it will absolutely not do shadeblend or lightblend or alphablend at the same time.<br><br>Alphablend multiplies the sprite's RGB values by its alpha channel values, and then adds that to the backbuffer's RGB values multiplied by the inverse of the sprite's alpha values. In alphablend you can't do lightblend or shadeblend or maskblend at the same time. To get a pixel to not be drawn from the sprite, it doesn't matter what color the pixel is so long as the alpha channel has a 0 in it.<br><br>In lightblend mode, the sprite's RGB values are multiplied by its alpha channel values - similar to alphablend, but then instead of inversely scaling the backbuffer's values, it simply adds it to the backbuffer's values - which is why the colors get lighter and lighter until reaching white. You can't do alphablend or shadeblend or maskblend while you're doing lightblend. However, you can fake masking in lightblend by setting the `do not draw` pixels to black with 0 for the alpha value - it will end up adding 0 to the destination pixel, thus not changing it, thus making it seem like you're masking at the same time. But you can't have alpha's of 255 or 128 and expect it to do that.<br><br>Shadeblend multiplies the sprite's RGBA values (including the alpha channel), by the values in the backbuffer pixels. It doesn't do any further addition, and merely replaces the backbuffer pixel with the result of this multiplication. It won't do lightblend or alphablend or maskblend at the same time. However, a white pixel in your sprite will appear to have no effect on changing the background pixels because it will be multiplying 1.0 x 1.0, which leaves the pixel as it was - giving the impression of masking. So pixels you don't want to draw with shadeblend you should set to white - it doesn't matter what the alpha values are because they aren't used.<br><br>Shadeblend always multiplies EVERY pixel, black or otherwise. But if your pixel is black, it should not change the background color. <br><br></td></tr></table><br>
<a name="957002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> my pixel is 0,0,0 aka black so when shadeblend multiplies it by the background color, white, it goes completely black.  I am trying to set the shadeblend mode while masking the completely black pixels out of the image but I still can't figure it out.  thanks for the explanation though.<br><br>so maybe this should clear it up <br><br>img = loadimage("myimage.png",MASKEDIMAGE)<br><br>setblend shadeblend<br><br>drawimage img<br><br>.. thats what im trying to do but the image doesn't retain its MASK from the masked image flag when I use shadeblend <br><br></td></tr></table><br>
<a name="957007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use transparency on the image instead of a mask? <br><br></td></tr></table><br>
<a name="957014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dont know how to do transparency cuz I dont have anything like photoshop to do that in.. all I have is MS paint for now :p <br><br></td></tr></table><br>
<a name="957026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you read the docs? <br><br>I think you are confused over meaning of shadeblend (it's for subtractive (multiply) effects such as shadows).<br><br><a href="http://blitzbasic.com/bmdocs/command.php?name=SetBlend&amp;ref=2d_cat" target="_blank">http://blitzbasic.com/bmdocs/command.php?name=SetBlend&amp;ref=2d_cat</a><br><br>If you must use shadeblend white pixels not black will leave destination unmodified. <br><br></td></tr></table><br>
<a name="957028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I dont know how to do transparency cuz I dont have anything like photoshop to do that in.. all I have is MS paint for now :p  <br></div><a href="http://www.gimp.org/windows/" target="_blank">GIMP</a>.<br><br>EDIT:<br>@REDi: :D <br><br></td></tr></table><br>
<a name="957029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I dont know how to do transparency cuz I dont have anything like photoshop to do that in.. all I have is MS paint for now :p  <br></div><br>Use gimp its free! <a href="http://www.gimp.org/" target="_blank">http://www.gimp.org/</a><br><br>*EDIT* DOH :) <br><br></td></tr></table><br>
<a name="957032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @skidracer - I know what it does I just thought that using a mask would stop it from even looking at the black pixels <br><br></td></tr></table><br>
<a name="957039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> 0 multiplied by white is 0!<br><br>White pixels turn black. That is normal. Make your pixels in your sprite WHITE if you want them to do masking. <br><br></td></tr></table><br>
<a name="957040"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> oh... ok thanks IH I should have thought of that... doh! <br><br></td></tr></table><br>
<a name="957067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> As described previously ;-)<br><br>Shadeblend multiplies, lightblend adds. <br><br></td></tr></table><br>
<a name="957153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> All of the blend types - maskblend, solidblend, lightblend, alphablend, shadeblend, these are all *exclusive*, you cannot do two of them at the same time. You can't do maskblend at the same time as shadeblend, for example. But as I and Skidracer said, white pixels will have the effect that a mask would have when using shadeblend. Black pixels turn the background black. Lightblend is the reverse - black pixels act like a mask and white pixels turn it white <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
