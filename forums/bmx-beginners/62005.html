<!DOCTYPE html><html lang="en" ><head ><title >garbage management</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >garbage management</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >garbage management</a><br><br>
<a name="692975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry to all if I re-open an old thread, but I need to have the a right solution.<br>First of all, in the game I have some list and objects; some of them will be destroyed, other no. At the end of the level I destroy all the objects and clear all the list. Then run GCCollect to 'flush the mem'.<br>Now, I'm thinking: can I put a GCCollect() in the main loop or this is 'dangerous'? It slowdown? GCCollet() runs immediately the garbage collector? I need to use the GCSetMode(manual) to obtain better result? What method do you use?<br>Thanks in advance, but I think this is a point to clarify for all. <br><br></td></tr></table><br>
<a name="692989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Might seema silly question but have you got a memory leak?<br>I leave Bmax to do all garbage collection but keep an eye on memory allocation. I keep a high-watermark and, from one run to another, if it's excessive or jumps too much I check what I added for problems.<br>The only advantage I can see (now) with manual GC is you know when it will be run (but not when memory will be reclaimed). If you want to go that route keep an eye on memory consumption and run gccollect during any spare cycles or when it's becoming a priority. <br><br></td></tr></table><br>
<a name="693002"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think there is any good answer about when to use GCCollect.<br><br>So I agree with Tony on this one. Just let the garbage collection be automatic. Later, if you suspect that performance could be better, you can try calling GCCollect in places where think it might help. <br><br></td></tr></table><br>
<a name="693015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can put a GCCollect into the mainloop<br>But it is not needed.<br>There is no real need to keep the RAM usage low if there is plenty of RAM, as it only makes the game slower (memory alloc dealloc isn't a that fast thing). <br><br></td></tr></table><br>
<a name="693112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks to all, I was wonder if I made the 'right' things, and it's seem to be ok. My only worry is about the gfx memory: in the game after some levels I need to change the background graphics, so I null all the refer to the image_back and run GCcollect() and then I load the new level. On my test machine (8Mb vram shared - I know it's crap!) I got a memory error: it's probably due to 'out of videoram'. But as the background are the same size (640x480x32bit) is there  a way to re-use the same chunk or vram or it's pure speculation?<br><br>By the way: after destroying all my objects (and all the inner reference, timage pointer, tlink pointer and so on) I use ClearList and then I delete too the List (and then re-create them): I noticed a little increment in GCCollect() memory so I think it is a 'good' method, or no? <br><br></td></tr></table><br>
<a name="693149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the image was really destroyed, it shouldn't be there anymore. But for a "secure" way you could do a flip after the GCCollect and see if it helps.<br><br>But you must have quite a strange graphics card ... Because 640x480 as TImage means 1024x1024 which normally won't work on such old cards at all (GeForce 3 or 4 at minimum when I remember correctly) and thats what is needed to have an image of that size (as 640 becomes 1024 and 480 becomes 512 -&gt; max(1024,512) = 1024).<br><br>To test if it is a VRAM thing you could load it as pixmap and draw the pixmap ... if it works then then it most likely might be VRAM thing.<br><br>If not, then perhaps the system just is too low on memory or has a too small paging file. (because out of memory often comes up if the paging file can't be made larger either because manually fixed to that size or because the users have their C partition full of trash) <br><br></td></tr></table><br>
<a name="693174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank for the info - the FLIP after the GCCollect is interesting...<br>The Gfx card is a CyberBlade ai-something, it is a integrated for portable computer (Celeron 800 + 128Mb ram+ WinME). I know that it's not a 'normal' configuration today, but I use it as worst case possible: if the program runs on this, well, it should run on other (better) configuration.<br>Thanks for info about paging &amp; Hd space: I'm using computer with big ram&amp;hd so this problem was out of my mind. <br><br></td></tr></table><br>
<a name="693181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK that system is a little crit ... or I should say anything before Win2k / WinXP is as the memory handling of Windows itself is fundamentally different (there is a good reason they *win98 / winme* aren't supported anymore). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
