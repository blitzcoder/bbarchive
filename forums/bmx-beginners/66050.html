<!DOCTYPE html><html lang="en" ><head ><title >copy x,y,w,h of an image to the backbuffer ?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >copy x,y,w,h of an image to the backbuffer ?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >copy x,y,w,h of an image to the backbuffer ?</a><br><br>
<a name="738021"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> can someone tell me which command to use that will copy a selected area x,y,w,h of a loaded image to x,y of the screen ?<br><br>When I briefly used Blitz3D, I used DrawIMageRect, but when I use it in BMax, its not working correctly (its copying the WHOLE image instead of x,y,w,h of the image) and scaling it down <br><br></td></tr></table><br>
<a name="738032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ' -----------------------------------------------------------------------------<br>' ccDrawImageArea by Ian Duff (faster?)<br>' -----------------------------------------------------------------------------<br>' Note that this code works fine in DirectX or OpenGL on PCs - it autodetects (JB).<br>Function ccDrawImageArea(image:TImage, x#, y#, rx#, ry#, rw#, rh#, theframe=0)<br>  Local origin_x#, origin_y# ; GetOrigin (origin_x, origin_y)<br>  Local tw = Pow2Size(image.width)<br>  Local th = Pow2Size(image.height)<br>  Local rw1#  = rx + rw<br>  Local rh1#  = ry + rh<br>  Local x0# = -image.handle_x, x1# = x0 + rw<br>  Local y0# = -image.handle_y, y1# = y0 + rh<br>  <br>  If rw1 &gt; image.width<br>    x1 = x0 + rw + image.width - rw1<br>    rw1 = image.width<br>  EndIf<br>   <br>  If rh1 &gt; image.height<br>    y1 = y0 + rh + image.height - rh1<br>    rh1 = image.height<br>  EndIf<br>?Win32<br>  If TD3D7ImageFrame(image.frame(theframe))<br>    Local frame:TD3D7ImageFrame = TD3D7ImageFrame(image.frame(theframe))<br>    <br>    frame.setUV(rx / tw, ry / th, rw1 / tw, rh1 / th)<br>    frame.Draw x0, y0, x1, y1, x + origin_x, y + origin_y<br>    frame.setUV(0, 0, image.width / Float(tw), image.height / Float(th))<br>  Else<br>?<br>    Local frameA:TGLImageFrame = TGLImageFrame (image.frame(theframe))<br>                <br>    frameA.u0 = rx / tw<br>    frameA.v0 = ry / th<br>    frameA.u1 = rw1 / tw<br>    frameA.v1 = rh1 / th<br>    <br>    frameA.Draw x0, y0, x1, y1, x + origin_x, y + origin_y<br>    <br>    frameA.u0 = 0<br>    frameA.v0 = 0<br>    frameA.u1 = image.width / Float(tw)<br>    frameA.v1 = image.height / Float(th)<br>?Win32<br>  EndIf<br>?<br>  <br>  Function Pow2Size(n)<br>    Local ry = 1<br>    <br>    While ry &lt; n<br>      ry :* 2<br>    Wend<br>    <br>    Return ry<br>  End Function<br>End Function<br> <br></div> <br><br></td></tr></table><br>
<a name="738035"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> cheers<br><br>I see DrawImageRect isn't the same command as it was in B3D, s o I couldn't use that.<br><br>I'm wondering now, whether to use your function above for each of my 32x32 sprites, or do just a single drawimage, which will overlay all my sprites in one go<br><br>do you think I'd pay a big performance hit on a 800x600 screen if I did the latter ? <br><br></td></tr></table><br>
<a name="738173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Soryry, I'm not sure what you mean by "overlay all my sprites in one go". <br><br></td></tr></table><br>
<a name="738329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry, here's an explanation<br><br>1. I draw a background image, 800x600<br>2. I draw 4no. sprites, each 32x32 incl alpha<br>3. I draw a foreground image, 800x600 incl alpha<br><br>or<br><br>3. I use your code, DrawImageArea on each of the sprites to draw a 32x32 section of the foreground image on each of the sprites<br><br>so, to recap, I'm just wondering if there's much of a saving using your code to draw 4no, 32x32 blocks, instead of just using DrawImage to draw a single 800x600 foreground image instead? <br><br></td></tr></table><br>
<a name="738334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bregors</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="738359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would have said there will be a saving using the image rect code becasue you are only drawing 4096 pixels instead o 480,000!  However, as the 3D card is handling the drawing the saving isn't as much as it would have been in the old days when the CPU was doing the work. <br><br></td></tr></table><br>
<a name="738669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey, can you explain your code, above...<br><br>?Win32 <br><br>also there seems to be a function inside a function, which I've never seen before ? <br><br></td></tr></table><br>
<a name="738684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The code between the ?win32 and the next ? is only compiled on a PC, as only a PC will have DirectX, but could also be using OpenGL.  If the above were compiled on a Mac or under Linux then all the DirectX code would be ignored.<br><br>The above code uses some low level API calls/accessing to achieve it's rect copying, so needs to know which graphics API is in use (on a PC).<br><br>I can't help you with an explanation of the rest of the code, but maybe Grey can, although I don't think the code is his (could be wrong though).<br><br>The ? commands are known as compiler directives and instruct the compiler whether to compile certain chunks of code or not.  This can be done on platform (Windows, Mac or Linux), processor (PowerPC, x86) or whether the program is being compiled in debug or not.  They can be quite useful, especially when you want your games to work across mulitple platforms. <br><br></td></tr></table><br>
<a name="738740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah the code isn't mine, someone posted it for me once and I kept a copy for use.  JazzieB is correct about ?win32<br><br>Functions within functions are very useful in certain circumstances.  You can't call it from anywhere else except from within the function it's declared in. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
