<!DOCTYPE html><html lang="en" ><head ><title >How do you do "multilayered" tilemapping in max?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How do you do "multilayered" tilemapping in max?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >How do you do "multilayered" tilemapping in max?</a><br><br>
<a name="472530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey peeps<br><br>Okay, so in blitz2d you have image buffers and could write to any one of those at any time, allowing me to write certain tiles to certain buffers and allowing me to Z-order things. (no, z-ordering isnt what im trying to do here, thats just what i used to use this technique for)<br><br>In max, you can only write to the back buffer, right? this causes a problem: i want to write my tiles to the backbuffer, and at a certian point i may find somewhere where i want to draw an effect. I would then previously have  drawn my effect to the backbuffer last after rendering it to an image buffer and drawing all player stuff.  how would i now render this effect without messing up the contents of the backbuffer?<br><br>Heres another issue:<br>im doing a GUI that works by rendering its windows to an image, only now i have to render the window to the backbuffer and copy it across using some copyimage/copypixelmap routines (which take time). BUT ive just overwritten what ive been rendering.... <br><br><br><br>Well, i hope you can see my problem anyway... theres probrably a very easy quick fix, but how can i draw to an imagebuffer things like rectangles,triangles,lines????<br><br>Cheers for your help again peeps <br><br></td></tr></table><br>
<a name="472542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I asked something similar...<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=42118" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=42118</a><br>I will sorely miss imagebuffers. <br><br></td></tr></table><br>
<a name="472547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> How sad :( i'l continue on my way trying to create a kludgefix. I wonder if buffers will return? <br><br></td></tr></table><br>
<a name="472552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> something else while im here... i wish windows would allow us to directly access memory.. like qbasic did... people dont realise how much faster this would be even if we had to do things ourselves :( <br><br>currently in max2d, its more effort to re-write den bros 3 than it was to write it in Qbasic. The 3D side of things, wow. i mean, the power is there- its not even that difficult to write a 3d engine and make games with it... but 2d is struggling.itl change though, with the power available. :) <br><br></td></tr></table><br>
<a name="472557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I would then previously have drawn my effect to the backbuffer last after rendering it to an image buffer and drawing all player stuff. how would i now render this effect without messing up the contents of the backbuffer?  <br></div>I'm not sure I understand. Why is messing up the backbuffer an issue?<br><br><div class="quote"> BUT ive just overwritten what ive been rendering.... <br></div>Then a) Draw it in the correct place (or one of the correct places) from the start, or b) Draw it before you do any rendering, then do the copy thing, then render game graphics, then render GUI overlay.<br><br>Depending on the complexity of the GUI, it might be just as fast to just draw the entire GUI every time. <br><br></td></tr></table><br>
<a name="472566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> FlameDuck, youre missing the point. Imagebuffers kept things quick and easy. The problem with drawing them in the first place would be that upon continuing drawing the tiles, the effect would get overwritten.<br><br>The fact that the above can with careful use be gotten around is true.<br><br>Also, "Do the copy thing".... the "copy thing" seems deadly slow from here weather i use pixmaps or images often dropping the framerate to 10-11fps from 60. Copying plain pixels from buffer to buffer before avoided the complexity of all these issues.<br><br><br>The original issue i wrote of above (with the multilayered tiles) ive gotten around because the collision commands (which i do like!) allowing collision layers like Qbasic and DirectQB did it.<br><br><br>I suppose im generally not all that impressed with the Max2D module. With a bit ofknowledge, i may write something to bring back the old buffers. :) <br><br></td></tr></table><br>
<a name="472597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> FlameDuck, youre missing the point. Imagebuffers kept things quick and easy. <br></div>I know. However the ability to have multiple Lists will acheive the exact same effect.<br><br><div class="quote"> The problem with drawing them in the first place would be that upon continuing drawing the tiles, the effect would get overwritten. <br></div>No. You can do Z-ordering in seperate TLists instead of seperate images. Just add the Images in the same Z "space" to the same list, then add those lists to a bigger list in the correct "back to front" z-order, and viola! (It's called "composite pattern").<br><br>[qutoe]Also, "Do the copy thing".... the "copy thing" seems deadly slow from here[/quote]GrabImage is that slow on your PC?<br><br><div class="quote"> With a bit ofknowledge, i may write something to bring back the old buffers. :) <br></div>Well I'm sure many will appreciate it, but I'm just not entirely sure it's really worth it TBH. Incidently, you could probably use the composite pattern to get around your GUI problem too (it was originally meant to solve just that issue). <br><br></td></tr></table><br>
<a name="472602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grabimage is deadly slow on any system as it grabs a pixmap and converts<br><br>grabpixmap is worlds faster <br><br></td></tr></table><br>
<a name="472603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, it does take a bit of getting used to, how everything works in BlitzMax. I think that overall OpenGL based rendering is a good idea, it's a well-supported industry standard, it's fast with good hardware and has lots of flexibility. You might get lucky in that maybe some auxiliary color buffers are supported in most OpenGL implementations. I have no idea how widely supported they are, but they do act as additional backbuffers. You can redirect all drawing routines to output to a different buffer and then use something like CopyPixels to copy it over to the backbuffer. If auxiliary buffers are not available maybe you'll get lucky that a given OpenGL implementation supports stereoscopic views, ie you get extra left and right buffers.<br><br>Given that the OpenGL rendering library is quite sophisticated, Max2D is really an attempt to make it more palatable for most of us by providing some of the more basic higher-level functions you would expect, like as you say the buffers in previous versions of Blitz. You could possibly use some kind of custom rendering code to draw everything to a pixmap and then just copy it over (albeit more slowly). I think there are some omissions from Max2D and things that can be improved and added to but I'm sure such thoughts are in the pipeline.<br><br>As far as GUI's and screen refreshing go, it seems trendy these days to throw as much muscle behind the rendering process as possible and just redraw the whole screen each frame. In days gone by people came up with more ingenious ways to drastically reduce the amount of rendering needed and it all worked fine. However, there are some benefits to updating everything every frame - animating stuff is almost for free, and besides OpenGL doesn't really support hardware scrolling - which complicates matters. You could just redraw your whole GUI ever frame, or at least keep it in textures and draw them each frame, only updating the textures when things need to change? Or assemble textures cleverly so you only have to update the minimal amount and make your GUI like a mosaic.<br><br>Anyway, from the OpenGL red book..chapter 10, at <a href="http://fly.cc.fer.hr/~unreal/theredbook/chapter10.html" target="_blank">http://fly.cc.fer.hr/~unreal/theredbook/chapter10.html</a><br><br>-------<br><br>An OpenGL system can manipulate the following buffers: <br>Color buffers: front-left, front-right, back-left, back-right, and any number of auxiliary color buffers<br>Depth buffer <br>Stencil buffer <br>Accumulation buffer<br><br>Your particular OpenGL implementation determines which buffers are available and how many bits per pixel each holds. Additionally, you can have multiple visuals, or window types, that have different buffers available. At a minimum, you're guaranteed to have one color buffer for use in RGBA mode with associated stencil, depth, and accumulation buffers that have color components of nonzero size, and one color buffer for use in color-index mode with associated depth and stencil buffers.<br><br>also...<br><br>Color Buffers<br>The color buffers are usually the ones you draw to. They contain either color-index or RGB color data and may also contain alpha values. An OpenGL implementation that supports stereoscopic viewing has left and right color buffers for the left and right stereo images. If stereo isn't supported, only the left buffers are used. Similarly, double-buffered systems have front and back buffers, and a single-buffered system has the front buffers only. Every OpenGL implementation must provide a front-left color buffer.<br><br>Up to four optional, nondisplayable auxiliary color buffers can also be supported. OpenGL doesn't specify any particular uses for these buffers, so you can define and use them however you please. For example, you might use them for saving an image that you use repeatedly; rather than redrawing the image, you can just copy it into the usual color buffers. See the description of glCopyPixels() in "Reading, Writing, and Copying Pixel Data" for more information about how to do this. <br><br>You can use GL_STEREO or GL_DOUBLE_BUFFER with glGetBooleanv() to find out if your system supports stereo (that is, has left and right buffers) or double-buffering (has front and back buffers). To find out how many auxiliary buffers are present, use glGetIntegerv() with GL_AUX_BUFFERS. <br><br>also...<br><br>Selecting Color Buffers for Writing<br>The results of a drawing operation can go into any of the color buffers: front, back, front-left, back-left, front-right, back-right, or any of the auxiliary buffers. You can choose an individual buffer to be the drawing target, or you can also set the target to be a combination of these buffers. In a double-buffered application, for example, you might want to draw a common background into both the back and front buffers; from then on, you want to draw only in the back buffer (and swap the buffers when you're finished drawing). In some cases, however, you might want to treat part of a particular double-buffered window as though it were single-buffered by drawing to both front and back buffers. You use the glDrawBuffer() command to select the buffers to be written.void glDrawBuffer(GLenum mode); <br>Selects the buffers enabled for writing or clearing. The value of mode can be one of the following: <br><br>GL_FRONT <br>GL_BACK <br>GL_RIGHT <br>GL_LEFT <br>GL_FRONT_RIGHT <br>GL_FRONT_LEFT <br>GL_BACK_RIGHT <br>GL_BACK_LEFT <br>GL_AUXi <br>GL_FRONT_AND_BACK <br>GL_NONE <br><br>Arguments that omit RIGHT or LEFT refer to both the left and right buffers; similarly, arguments that omit FRONT or BACK refer to both. The i in GL_AUXi is a digit identifying a particular auxiliary buffer. <br><br>You can enable drawing to nonexistent buffers as long as you enable drawing to at least one buffer that does exist. If none of the specified buffers exist, an error results <br><br></td></tr></table><br>
<a name="472647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Theres something called a <a href="http://www.paulsprojects.net/opengl/rtotex/rtotex.html" target="_blank">pbuffer</a> in opengl too, that lets you draw to textures - usefull for those camera / screen effects you see in games!. <br><br></td></tr></table><br>
<a name="472712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is pbuffers supported in OpenGL 1.2 though?<br><br>Also, this thread started out asking about multi-layered maps. I presume you were meaning like where basically there is one layer of parallax and the game characters can sometimes walk behind trees or railing and sometimes in front of other scenery? Or were you trying to do parallax? <br><br></td></tr></table><br>
<a name="473062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2004)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> i was looking up the opengl commands and found gldrawbuffer but i couldnt get anything functioning. <br><br>Thanks for all your commands.<br>Yes, grabimage AND grabpixel are that slow on my machine.. im on a gf4 ti4200 with latest drivers.<br><br>As for using Tlists, i reverted to using an x dimentional array and iterating through all the loops a few times... seems fast even on slow end machines (max seems faster at this than b3d) if i can get my OpenGL skills up and enable and write to different "pbuffers" then i will have no quarrels left :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
