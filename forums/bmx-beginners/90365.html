<!DOCTYPE html><html lang="en" ><head ><title >Instant Replay (Saving large amounts of data)?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Instant Replay (Saving large amounts of data)?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Instant Replay (Saving large amounts of data)?</a><br><br>
<a name="1026985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Herbert Filby</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all. I just purchased Blitzmax and Leadwerks 2.3 to fulfill a game idea I've been hatching for about 10 years now... <br><br>I'm trying to recreate an instant replay code that I prototyped in QBasic, and it needs updating.<br><br>I am going to be storing perhaps up to 24 hours of non-continuous instant replay data, and I need to know which is going to be faster:<br><br>-SQL database<br>-XML file<br>-or if there is another option, please let me know<br><br>Also, data may be altered dynamically while the replay is happening (like if I were racing against a "ghost" version of myself in Mario Kart, but I can bump into it, rather than passing through it). So it will be simultaneously recording and playing back at the same time, for multiple objects, and updating old object replays if they are altered.<br><br>Anyone have any suggestions which route I should go? I plan on making a full 3D game, so each object needs to be "saved" and timestamped... ie. a lot of data being recorded and played back.<br><br>I'm not worried so much about how much space this takes up, but more on performance of read/write on random access data that happens every second... <br><br></td></tr></table><br>
<a name="1026988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Volker</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you want to use serialization (storing objects) there<br>are Bruceys persist mod, which stores data in XLM files<br>and chaos.clone mod; which is faster and stores data binary.<br>You should look at both and decide which is better for your purposes.<br>Serialization uses reflection, which is not the fastes at all. <br><br></td></tr></table><br>
<a name="1026989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> For replays, usually not the entire game state is saved but instead the actions or changes that take place. For example, only when a unit changes direction, speed, fires weapon etc. The rest of the time, the game world updates as per your usual update function. This requires considerably less space, but requires the game to be finely tuned so that replays do not go out of sync. <br><br></td></tr></table><br>
<a name="1026991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you're looking into SQL, you may want to consider SQL Lite as well -- it's not as fast/flexible as for example MySQL / MSSQL / Oracle, etc. but it does support the basics and it has one massive advantage: You don't have any external dependencies, but the module will enable you to interface directly with the SQL file, without the need to actually install and configure an external database first.<br><br>(Brucey has a SQL Lite module for Blitzmax, plus there are one or two others as well) <br><br></td></tr></table><br>
<a name="1027000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the data will be read sequentually, it would be best stored in a flat file I think. <br><br></td></tr></table><br>
<a name="1027006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Herbert Filby</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes I'm experimenting with SQLite and Brucey's module. I will look into this persist mod and see if it's more on what I'm looking at doing. <br><br></td></tr></table><br>
<a name="1027026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The benefit of a database is being able to easily find your data.  But if your data is just sequential, there is no reason to use a database.  Just use a flat file and stream it.  Actually, I think 1 time per second is too much.  I would think you could save the instant replay of a whole race in memory, then write it to a file afterwards.  Unless your race actually takes 24 hours... <br><br></td></tr></table><br>
<a name="1027045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Herbert Filby</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not just one race, though. I want to be able to save multiple races and simultaneously alter files as they are being read (if changes are made during replay). So in essence, you could end up racing 20 iterations of yourself at once.<br><br>My original prototype created a separate file for each object, and using QBasic, the files were quite small, but I had to limit how many objects could be recorded and played back.<br><br>It would start recording each movement of the player character, while every 0.1 seconds it would look for any other recordings, find the coordinates of that object, and output it to the screen. There was no tweening, so even updating it every 0.1 seconds, playback was a bit jerky, plus that algorithm did not take collision detection into consideration.<br><br>I guess since the files will be sequential, I'll try doing it using simple read/write functions to a file and see how that goes. I was hoping that there was a better way but logically, this makes sense. And I wouldn't have to depend on a third party module.<br><br>I will see if I can stream it to memory for recording, and write to a file afterward, which should improve performance during gameplay. <br><br></td></tr></table><br>
<a name="1027053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you want a useable reply or not?<br><br><div class="quote"> It would start recording each movement of the player character, while every 0.1 seconds it would look for any other recordings, find the coordinates of that object, and output it to the screen. There was no tweening, so even updating it every 0.1 seconds, playback was a bit jerky, plus that algorithm did not take collision detection into consideration. <br></div><br><br><div class="quote"> For replays, usually not the entire game state is saved [per iteration] but instead the actions or changes that take place. For example, only when a unit changes direction, speed, fires weapon etc [is this saved in the replay]. The rest of the time, the game world updates as per your usual update function [changing the behavior of the units according to their actions]. This requires considerably less space, but requires the game to be finely tuned so that replays do not go out of sync.  <br></div><br><br>Analogy: Chess games are not recorded by writing down the positions of every piece on the board every turn. Instead, only the moves that take place are recorded. This takes considerably less space, and for a real-time game completely removes the need for tweening or special collision detection algorithms, as you just use your normal ones. Only the initial state of the game needs to be saved, and then a list of changes to the flow of the game thereafter.<br><br>If you want to start up the game at any point in the recording, then perhaps you could save the entire state at regular intervals (of the order of minutes, not seconds!) So save at 5 mins. Then if you want to resume at 6 mins, load the 5 mins state and then process 1 min worth of actions. As you won't be drawing the game you can usually go through this in a couple of seconds. <br><br></td></tr></table><br>
<a name="1027059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this some multi-player online sort of thing?  If so, I would think a server could be used to keep it all in memory.  If not, then that makes it even easier.<br><br>I still don't see the need to writing this stuff to files.<br><br>Unless you are trying to do multiplayer writing files instead of using a server.  And if so, you should reconsider and house all of that data at a server and not use files until opportune moments to save the replays, like when you are done with a race. <br><br></td></tr></table><br>
<a name="1027066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see how this could work. Either you race a ghost of yourself that you cannot interact with, or you race AI. The only option if you want to be able to interact with old versions of your plays, is to switch the ghost from recorded play to AI as soon as you have hit it... unless the collision does not alter the course of the recorded version.<br><br>Serialisation is definitely the fastest and most efficient way. This can be done without reflection although it is a bit more effort. Reflection may be plenty fast enough depending what you are doing. Usually you would just record user input, then run the game with this recorded input instead of straight user interaction. Assuming your game is purely deterministic, this will recreate the whole game. Even 'random' elements can be recreated by reusing that same random seed from the original game. <br><br></td></tr></table><br>
<a name="1027171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Herbert Filby</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have a tutorial on this "reflection" and serialization John Galt mentions? I've seen those words used on the forums while I've been reading up on this, but don't have a clear perception on what they are. Thanks :)<br><br>EDIT: also, it's not multiplayer so all data needs to be stored on the local machine for later retrieval if the user quits the game or wants to take a break. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
