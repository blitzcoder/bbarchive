<!DOCTYPE html><html lang="en" ><head ><title >The best way to preserve the backbuffer?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >The best way to preserve the backbuffer?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >The best way to preserve the backbuffer?</a><br><br>
<a name="1279643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Juiceter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'm new to Blitzmax, and got a shock coming from blitz 2d in that the backbuffer does not preserve what was written to it previously (something to do with gfxcards all being different, I suppose). <br><br>Is there any fast way to do this, as it seems obvious not to waste time redrawing everything again if nothing changes and you are just adding to what was there already after every flip?<br><br>I've tried grabbing the backbuffer to an image and redrawing it to the backbuffer after a flip before adding to it, but this method is just too slow (@ 1280x1024).<br><br>Perhaps someone has written a snippet of code that can be included to work as the blitz 2d method did? <br><br></td></tr></table><br>
<a name="1279646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Juiceter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Note: I need to use fullscreen. The buffer does seem to be preserved if you use windowed mode, though. <br><br></td></tr></table><br>
<a name="1279650"></a>

<a name="1279651"></a>

<a name="1279652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> as it seems obvious not to waste time redrawing everything again if nothing changes <br></div><br><br>Does it?<br><br>Your application needs to be written so that it doesn't drop frames even under the highest expected load. That means that, considered on its own, a frame where <i>stuff happpens</i> and then <i>also it gets drawn</i> needs to complete within a fixed allowable amount of time.<br><br>If the above, which is demanding in two places, can happen quickly enough to fit within a single frame's millisecond budget, then it stands to reason that a different frame where <i>nothing happens</i> and <i>also it gets drawn</i> will almost always be safely under budget as well, since the cost is the same in the latter part but significantly less in the former part.<br><br>In other words, barring radically unusual program design, this optimization isn't worth making because it only affects parts of your program that <i>don't need optimization</i>. What you really need is to ensure that redrawing your entire scene is still fast enough to be under time budget even when things actually did happen; if you can do that, everything else will work perfectly. <br><br></td></tr></table><br>
<a name="1279686"></a>

<a name="1279691"></a>

<a name="1279693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Juiceter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> To me it does! I don't really understand why there isn't a mechanism to prevent the backbuffer from being trashed (either built-in or 3rd party). <br><br>It's just a simple line demo where I'm drawing a diamond to the screen, progressively thickening it each frame, whilst also displaying a small logo at the bottom of the screen. Why have to redraw the logo repeatedly after every flip? It just doesn't make sense.<br><br>It's just a difficult concept to grasp having used blitz 2d for so many years; something that was as easy as pie in 2d. <br><br></td></tr></table><br>
<a name="1279707"></a>

<a name="1279708"></a>

<a name="1279709"></a>

<a name="1279710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Juiceter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Further - in windowed mode the demo works fine and is very fast. But I don't want windowed mode. If there isn't an easier way to do it then it looks like I will just have to:<br><br>1.  flip &amp; cls after saving the previous diamond image via grabimage, redisplay it &amp; the logo and update rather than<br><br>2. just drawing the lines update to the backbuffer and flipping it (which windowed mode seems to be fine with, at least on my machine).<br><br>I read somewhere that openGL preserves the backbuffer. Is this true? <br><br></td></tr></table><br>
<a name="1279711"></a>

<a name="1279726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Well, I'm new to Blitzmax, and got a shock coming from blitz 2d in that the backbuffer does not preserve what was written to it previously (something to do with gfxcards all being different, I suppose).  <br></div><br><br>FWIW, this is not a limitation of Blitz itself: both the OpenGL spec and the DirectX Direct3D specs specifically mention that you cannot count on the backbuffer remaining in place -- after a flip, the contents will be undefined. On some cards it remains, on some of them it's gone, and on some of them it alternates between 2,3 or even 4 backbuffers so after a flip the contents of the backbuffer may 'rewind' one of more frames.<br><br>Grabbing a copy of the image before drawing it to the screen is the only way to guarantee the outcome on all machines, unfortunate as it may be.<br><br>(Blitz 2D maty behave different, but that's because the videocard itself handles 2D different than 3D -- and even though you may be dealing with 2D style data in bltizmax, it's still 2D-in-3D, and the card uses its 3D environment to render everything. The adcvantage of that is that you essentially get 'free' blending, scaling, and rotation, which is extremely resource intensive to do in 2D blitz.) <br><br></td></tr></table><br>
<a name="1279716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Juiceter</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks to both of you for your replies. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
