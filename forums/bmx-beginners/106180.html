<!DOCTYPE html><html lang="en" ><head ><title >How can i display cpu effort..?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How can i display cpu effort..?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >How can i display cpu effort..?</a><br><br>
<a name="1304466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi..  I would like to display cpu effort as percentage. <br>How can i do so? <br><br>Tnx <br><br></td></tr></table><br>
<a name="1304479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Under windows, it's tricky -- I don't believe there's a Win32 API call, you'll most likely have to query Window's WMI subsystem somehow. <br><br></td></tr></table><br>
<a name="1304482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RustyKristi</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> found a blog post with examples in C# and C++ also so maybe this will get you started. It is shown by thread id and its percentage.<br><br><a href="http://www.philosophicalgeek.com/2009/01/03/determine-cpu-usage-of-current-process-c-and-c/" target="_blank">http://www.philosophicalgeek.com/2009/01/03/determine-cpu-usage-of-current-process-c-and-c/</a><br><br>Example binaries and sources also in post. It can be converted into a mod but of course with some changes and to your needs. <br><br></td></tr></table><br>
<a name="1304487"></a>

<a name="1304504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh.  I expected it to be simpler<br>Tnx <br><br></td></tr></table><br>
<a name="1304770"></a>

<a name="1304771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hardcoal, there is a very useful Freeware utility I have been using for all iterations of Windows called, "Process Explorer."<br><br>With it you can track and trace every single process in Windows including seeing a small icon of your current CPU usage.<br><br>I find it invaluable as any time it peaks, I check to see what is using up my CPU. You can also designate individual programs to have higher or lesser priority.<br><br>You can find and download it from Microsoft HERE:<br><br><a href="https://technet.microsoft.com/en-us/sysinternals/processexplorer.aspx" target="_blank">https://technet.microsoft.com/en-us/sysinternals/processexplorer.aspx</a> <br><br></td></tr></table><br>
<a name="1304777"></a>

<a name="1304795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tnx dw..<br><br>Im trying to implant on my editor something that indicates how much my editor while running is consuming.<br>So i need a blitzmax command..<br><br>But since its not in my most urgent priorities atm, i delay it for now..<br><br>But tnx Mate <br><br></td></tr></table><br>
<a name="1305124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fielder</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Type CPUMonitor

	' References...
	
	' <a href="http://www.codeproject.com/Articles/9113/Get-CPU-Usage-with-GetSystemTimes" target="_blank">http://www.codeproject.com/Articles/9113/Get-CPU-Usage-with-GetSystemTimes</a>
	' <a href="http://www.purebasic.fr/english/viewtopic.php?t=26200&amp;start=3" target="_blank">http://www.purebasic.fr/english/viewtopic.php?t=26200&amp;start=3</a>
	' <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724400%28v=vs.85%29.aspx" target="_blank">http://msdn.microsoft.com/en-us/library/windows/desktop/ms724400%28v=vs.85%29.aspx</a>

	Const SAMPLES:Int = 3

	Field cpu_sample:Int [SAMPLES]
	
	Field idle:Win32FileTime = New Win32FileTime
	Field kern:Win32FileTime = New Win32FileTime
	Field user:Win32FileTime = New Win32FileTime
	
	Field last_idle:Win32FileTime = New Win32FileTime
	Field last_kern:Win32FileTime = New Win32FileTime
	Field last_user:Win32FileTime = New Win32FileTime

	' Pass False for realtime value, though result will fluctuate a lot more...

	Method Usage:Int (average:Int = True)
	
		GetSystemTimes idle, kern, user
		
		' Apparently only need the 'low' part of the FILETIME structure...
		
		Local idl:Int = idle.lo - last_idle.lo
		Local krn:Int = kern.lo - last_kern.lo
		Local usr:Int = user.lo - last_user.lo
	
		last_idle.lo = idle.lo
		last_kern.lo = kern.lo
		last_user.lo = user.lo
	
		Local sys:Int = krn + usr
		
		Local cpu:Int
		
		If sys
			cpu = Int ((sys - idl) * 100 / sys)
		Else
			cpu = 0
		EndIf
	
		If average
		
			Local avg_cpu:Int = 0
			
			For Local loop:Int = 0 Until SAMPLES - 1
				cpu_sample [loop] = cpu_sample [loop + 1]
				'Print "cpu_sample [" + loop + "] = " + cpu_sample [loop]
				avg_cpu = avg_cpu + cpu_sample [loop]
			Next
			
			cpu_sample [SAMPLES - 1] = cpu
		
			avg_cpu = avg_cpu + cpu_sample [SAMPLES - 1]
			
			avg_cpu = avg_cpu / SAMPLES
			
			' Print "Current sample: " + cpu + " (Average of last three samples: " + avg_cpu + ")"
		
			If avg_cpu &lt; 0 Then avg_cpu = 0
			
			Return avg_cpu
			
		Else
		
			If cpu &lt; 0 Then cpu = 0
			
			Return cpu
			
		EndIf
		
	End Method
	
End Type
</pre><br><br>Global cpuuse:CPUMonitor = New CPUMonitor<br><br>valueofcpuusage=cpuuse.Usage (); <br><br></td></tr></table><br>
<a name="1305138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> That one seems to miss some pieces... Here's a working one, based on Blitzsupport's posting here: <a href="http://www.blitzbasic.com/Community/post.php?topic=103567&amp;post=1248083" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=103567&amp;post=1248083</a><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

Extern "win32"
	Function GetSystemTimes (lpIdleTime:Byte Ptr, lpKernelTime:Byte Ptr, lpUserTime:Byte Ptr)
End Extern

Type Win32FileTime
	Field lo:Int
	Field hi:Int
End Type

Type CPUMonitor

	' References...
	
	' &lt;a href="http://www.codeproject.com/Articles/9113/Get-CPU-Usage-with-GetSystemTimes" target="_blank"&gt;http://www.codeproject.com/Articles/9113/Get-CPU-Usage-with-GetSystemTimes&lt;/a&gt;
	' &lt;a href="http://www.purebasic.fr/english/viewtopic.php?t=26200&amp;start=3" target="_blank"&gt;http://www.purebasic.fr/english/viewtopic.php?t=26200&amp;start=3&lt;/a&gt;
	' &lt;a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms724400%28v=vs.85%29.aspx" target="_blank"&gt;http://msdn.microsoft.com/en-us/library/windows/desktop/ms724400%28v=vs.85%29.aspx&lt;/a&gt;

	Const SAMPLES:Int = 3
	Field cpu_sample:Int[SAMPLES]
	
	Field idle:Win32FileTime = New Win32FileTime
	Field kern:Win32FileTime = New Win32FileTime
	Field user:Win32FileTime = New Win32FileTime
	
	Field last_idle:Win32FileTime = New Win32FileTime
	Field last_kern:Win32FileTime = New Win32FileTime
	Field last_user:Win32FileTime = New Win32FileTime

	' Pass False for realtime value, though result will fluctuate a lot more...

	Method Usage:Int (average:Int = True)
	
		GetSystemTimes idle, kern, user
		
		' Apparently only need the 'low' part of the FILETIME structure...
		
		Local idl:Int = idle.lo - last_idle.lo
		Local krn:Int = kern.lo - last_kern.lo
		Local usr:Int = user.lo - last_user.lo
	
		last_idle.lo = idle.lo
		last_kern.lo = kern.lo
		last_user.lo = user.lo
	
		Local sys:Int = krn + usr
		
		Local cpu:Int
		
		If sys
			cpu = Int ((sys - idl) * 100 / sys)
		Else
			cpu = 0
		EndIf
	
		If average
		
			Local avg_cpu:Int = 0
			
			For Local loop:Int = 0 Until SAMPLES - 1
				cpu_sample[loop] = cpu_sample[loop + 1]
				'Print "cpu_sample[" + loop + "] = " + cpu_sample[loop]
				avg_cpu = avg_cpu + cpu_sample[loop]
			Next
			
			cpu_sample[SAMPLES - 1] = cpu
		
			avg_cpu = avg_cpu + cpu_sample[SAMPLES - 1]
			
			avg_cpu = avg_cpu / SAMPLES
			
			' Must sample more than once per second! Values of 1000 or more below return false results.
			' Don't know why...
		
			If avg_cpu &lt; 0 Then avg_cpu = 0
			
			Return avg_cpu
			
		Else
		
			If cpu &lt; 0 Then cpu = 0
			
			Return cpu
			
		EndIf
		
	End Method
	
End Type

Local cpu:CPUMonitor = New CPUMonitor
Local cpubyte:Byte

Repeat
	cpubyte = Byte (cpu.Usage (True))
	Print cpubyte
	Delay 100
Until KeyHit (KEY_ESCAPE)
End
</textarea> <br><br></td></tr></table><br>
<a name="1305139"></a>

<a name="1305221"></a>

<a name="1305222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Geees..  Tnx man for the effort.. <br>Ill check it soon <br><br>I love this community<br><br>You too xlsior <br><br></td></tr></table><br>
<a name="1305225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Now My real need is to display the effort of my Editor.. <br>how can I display how much power only it takes? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
