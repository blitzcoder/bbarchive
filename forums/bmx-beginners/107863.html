<!DOCTYPE html><html lang="en" ><head ><title >Bitmap\alphamap? over layer?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Bitmap\alphamap? over layer?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Bitmap\alphamap? over layer?</a><br><br>
<a name="1337690"></a>

<a name="1337691"></a>

<a name="1337692"></a>

<a name="1337693"></a>

<a name="1337694"></a>

<a name="1337719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caton</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> how would this work in blitzmax?<br>loading two images together.<br><br><a href="https://drive.google.com/open?id=0B8SxXaDSGTlXRk9OdUozWkdhVjg" target="_blank">https://drive.google.com/open?id=0B8SxXaDSGTlXRk9OdUozWkdhVjg</a><br><a href="https://drive.google.com/open?id=0B8SxXaDSGTlXZEFuMmw5UjBCREk" target="_blank">https://drive.google.com/open?id=0B8SxXaDSGTlXZEFuMmw5UjBCREk</a> <br><br></td></tr></table><br>
<a name="1337733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caton</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please help?! I looked and nothing came up for blitzmax doing sprites with bitmap and alphamap. <br><br></td></tr></table><br>
<a name="1337740"></a>

<a name="1337741"></a>

<a name="1337742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trinosis</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm assuming you want to combine the two images into one.<br><br>The image needs to be in a format that supports an Alpha channel.<br><br>32bit Png and Tga formats are two that spring to mind.<br><br>32 bit (4 bytes) is needed to support, the red, green, blue and alpha channels.<br><br>You would load the first image into an art package that supports images with alpha channels, say Photoshop.<br>Add an alpha channel.<br>Load the second image and copy and paste it into the alpha channel of the first image.<br>Then save the first image with the alpha channel in a 32bit format of your choosing. Png or Tga.<br><br>And when drawing the image you would want to use Alphablend mode for the image to render using the alpha channel.<br><br>setblend(ALPHABLEND) <br><br></td></tr></table><br>
<a name="1337748"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caton</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to load bitmap and alphamap into a image file one with alpha map and one with a color map how do I do this? <br><br></td></tr></table><br>
<a name="1337754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it sufficient to do this outside of BlitzMax, then use the result later in your app? Or do you need to combine both pictures not until they are in BlitzMax? <br><br></td></tr></table><br>
<a name="1337766"></a>

<a name="1337767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> He is talking abut eg. a jpeg containing the sprite...and eg. a 256 grayscales / 1 channel alpha map.... Like a "mask".<br><br>With default blitzmax commands you cannot achieve that (at least I think so). Means you will have to preprocess them during loading.<br><br>Load the image<br>Load the mask<br><br>Create another image with dims of the mask<br>Clear the pixmap of this image<br><br>Run over every pixel of the mask. Read the pixel of the source image at the corresponding image. Adjust the alpha of this srcPixel according to srcPixelAlpha multiplied with maskPixelAlpha. Store this in targetPixelAlpha.<br><br><br>Last time I have seen such a thing was with the popcap-game-engine (or whatever "Zuma" used).<br><br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1337836"></a>

<a name="1337837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Caton</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know how do that. with using pix with three maps normal\bum map,bitmap,alphamap. should I use c++ then? <br><br></td></tr></table><br>
<a name="1337876"></a>

<a name="1337877"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You want normal maps learn OpenGL good luck. <br><br></td></tr></table><br>
<a name="1337889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can scan both pixmaps with READPIXEL() to get two ARGB values of a corresponding pixel. Then combine the A--- value of the first pixmap with -RGB value of the second pixmap and store it back into another new Pixmap with WRITEPIXEL()<br><br>ARGB is a 32bit integer with 8bit for each color-part Alpha-Red-Green-Blue.<br><br>Here is a code snipplet:<br><br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2236" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2236</a><br><br>p.s.<br>does anyone know, why the BlitzBasix.Com search engine is still disabled? <br><br></td></tr></table><br>
<a name="1337994"></a>

<a name="1337995"></a>

<a name="1337996"></a>

<a name="1337997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trinosis</td><td align="right"><font class=tiny>(Posted April)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Caton<br><br>I see from your other post you might still be having trouble coding a solution. <br>So i decided to have a go myself.<br>And here is the code you need if you haven't solved the problem yet.<br><br>Its takes two 24bit rgb images and copies the second, into the first as an alpha channel and saves the result as a new image.<br><br>The second image used as the alpha channel needs to be the same size as the first image and only the red channel is used for the alpha level.<br>All three rgb channels should be the same ( ie white or shades of grey ).<br><br><pre class=code>

'Both Image Images Need To Be The Same Size

Strict


Global screen_size_x = 1024
Global screen_size_y = 768
Global screen_centre_x = screen_size_x / 2
Global screen_centre_y = screen_size_y / 2

Graphics(screen_size_x , screen_size_y , 0 , 60) ' Window





AutoImageFlags(MASKEDIMAGE|FILTEREDIMAGE|MIPMAPPEDIMAGE)
AutoMidHandle(True) ' image origin = image centre and not top left
SetMaskColor(0 , 0 , 0) ' black not drawn
SeedRnd MilliSecs()






Global pixmap_1:TPixmap = LoadPixmap("24bit rgb.bmp") 'Image 1 = 24bit RGB Color Image

Global pixmap_width = PixmapWidth(pixmap_1)
Global pixmap_height = PixmapHeight(pixmap_1)

Global pixmap_2:TPixmap = LoadPixmap("24bit alpha.bmp") 'Image 2 = 24bit RGB Color Image ( Used As The Alpha Layer )

'Arrays To Hold The RGB Values For Each Image
Global pixmap_1_red_array[pixmap_width , pixmap_height]
Global pixmap_1_green_array[pixmap_width , pixmap_height]
Global pixmap_1_blue_array[pixmap_width , pixmap_height]
Global pixmap_1_alpha_array[pixmap_width , pixmap_height]

Global pixmap_2_red_array[pixmap_width , pixmap_height]
Global pixmap_2_green_array[pixmap_width , pixmap_height]
Global pixmap_2_blue_array[pixmap_width , pixmap_height]

'Create Final Pixmap In RGBA Format
Global final_pixmap:TPixmap = CreatePixmap(pixmap_width , pixmap_height , PF_RGBA8888)
ClearPixels(final_pixmap , 0)






SetColor(255 , 255 , 255)
SetScale(1 , 1)
SetRotation(0)
SetAlpha(1)

Cls
DrawText("Processing Image ..." , 0 , 0)
Flip

set_pixmap_arrays()

copy_alpha_into_array()

update_and_save_pixmap_1()



While KeyDown(KEY_ESCAPE) = False

  Cls

  DrawPixmap(final_pixmap , screen_centre_x - (pixmap_width / 2), screen_centre_y - (pixmap_height / 2))

  SetColor(0 , 255 , 0)
  DrawText("Finished" , 0 , 0)

  SetColor(255 , 255 , 255)
  DrawText("Press Escape To Exit" , 0 , 30)

  Flip

Wend

End










'Get Alpha From ARGB
Function argb_alpha(argb)
 Return (argb Shr 24) &amp; $ff
End Function

'Get Red From ARGB
Function argb_red(argb)
  Return (argb Shr 16) &amp; $ff
End Function

'Get Green From ARGB
Function argb_green(argb)
  Return (argb Shr 8) &amp; $ff
End Function

'Get Blue From ARGB
Function argb_blue(argb)
 Return (argb &amp; $ff) 
End Function


'Get ARGB From Alpha , Red , Green , Blue
Function argb_color(alpha , red , green , blue)
 Return ( (alpha * $1000000) + (red * $10000) + (green * $100) + (blue) )
End Function








Function set_pixmap_arrays()

  Local x_loop
  Local y_loop
  Local argb
  Local red
  Local green
  Local blue


  'Pixmap 1
  For y_loop = 0 To pixmap_height - 1

    For x_loop = 0 To pixmap_width - 1

      argb = ReadPixel(pixmap_1 , x_loop , y_loop)

      red = argb_red(argb)
      green = argb_green(argb)
      blue = argb_blue(argb)

      pixmap_1_red_array[x_loop , y_loop] = red
      pixmap_1_green_array[x_loop , y_loop] = green
      pixmap_1_blue_array[x_loop , y_loop] = blue

      pixmap_1_alpha_array[x_loop , y_loop] = 0

    Next

  Next




  'Pixmap 2
  For y_loop = 0 To pixmap_height - 1

    For x_loop = 0 To pixmap_width - 1

      argb = ReadPixel(pixmap_2 , x_loop , y_loop)

      red = argb_red(argb)
      green = argb_green(argb)
      blue = argb_blue(argb)

      pixmap_2_red_array[x_loop , y_loop] = red
      pixmap_2_green_array[x_loop , y_loop] = green
      pixmap_2_blue_array[x_loop , y_loop] = blue

    Next

  Next

End Function








Function copy_alpha_into_array()

  Local x_loop
  Local y_loop


  For y_loop = 0 To pixmap_height - 1

    For x_loop = 0 To pixmap_width - 1

      'Pixmap 2 RGB Values Should All be The Same ( So Just Reading The Red Channel Here )
      pixmap_1_alpha_array[x_loop , y_loop] = pixmap_2_red_array[x_loop , y_loop]

    Next

  Next

End Function






Function update_and_save_pixmap_1()

  Local x_loop
  Local y_loop
  Local red
  Local green
  Local blue
  Local alpha
  Local argb

  For y_loop = 0 To pixmap_height - 1

    For x_loop = 0 To pixmap_width - 1

      red = pixmap_1_red_array[x_loop , y_loop]
      green = pixmap_1_green_array[x_loop , y_loop]
      blue = pixmap_1_blue_array[x_loop , y_loop]
      alpha = pixmap_1_alpha_array[x_loop , y_loop]

      argb = argb_color(alpha , red , green , blue)

      WritePixel(final_pixmap , x_loop , y_loop , argb)

    Next

  Next


  SavePixmapPNG(final_pixmap , "final_image.png" , 0)


End Function


</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
