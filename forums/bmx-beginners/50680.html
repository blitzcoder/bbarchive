<!DOCTYPE html><html lang="en" ><head ><title >Streaming OGGs?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Streaming OGGs?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Streaming OGGs?</a><br><br>
<a name="564365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone!<br><br>First time I post, although I have been working with blitzmax for some time x)<br><br>I have an issue regarding loadtimes in my game... I'd like to play large OGGs; the problem is... the only way is to load the entire OGG first. When talking about 15 min long music it becomes a loadtime of... about 25-30 secs on my AMD Duron 800. I can't afford that in terms of speed and/or memory, as I need to dynamically load and play music :/<br><br>The question: isn't there a way to play an OGG streaming it / loading it on the fly? I'm aware of the FMOD wrapper, but I'd like to think of another solution before that.<br><br>Any ideas?<br><br>Thanks,<br>Ferminho <br><br></td></tr></table><br>
<a name="564408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was about to post the same question. There's a Blitz3d version in the archives by King Dave but because we don't have the playmusic command it's impossible to emulate.<br><br>I too would like to see a way of streaming sounds. Any idea, boffins? <br><br></td></tr></table><br>
<a name="564542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DannyD</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not a solution but a suggestion: Split your 15min long ogg into 3 or 5 segments and load them when needed ? <br><br></td></tr></table><br>
<a name="564585"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mystik</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've not found a cross platform way to do this other than by using fmod.<br><br>Would be really interested though if someone does find a way that does not need an expensive license.<br><br>Steve. <br><br></td></tr></table><br>
<a name="564593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JaviCervera</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> OpenAL allows to do streaming. <br><br></td></tr></table><br>
<a name="564595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> First, thanks for the replies<br><br>@DannyD <br>I'm afraid that won't work. Game would be paralised for a moment (maybe some seconds...) when a new segment is loaded :/ if done in small enough chunks so that stop cannot be appreciated... but well, that's going back to streaming x)<br><br>I've been thinking for a while, and *maybe* I could try to do it. Is there a way to do a LoadSound from memory? i.e., from a pointer to a stream or a byte ptr or something like that...? <br><br></td></tr></table><br>
<a name="564687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  if done in small enough chunks so that stop cannot be appreciated... but well, that's going back to streaming x) <br></div><br>That's essentially manual streaming =] It's entirely possible, but very fiddly.  It may be your best option.<br><br>The shame here, is that the audio system in Max sets up a thread for itself (the audio system is allowed a thread, but not anything else!), the loading of .oggs should be moved there...<br><br><div class="quote"> Is there a way to do a LoadSound from memory? <br></div><br>I think so.  I think all the loading functions are stream based now, so they should be able to load from anywhere...  hmm...  if LoadSound streams in an ogg from an http: address, does it wait until the entire sound is loaded, or does it continue program execution?  When can playback of the sound commence?  One would hope that LoadSound would stream properly, but I don't think it does...  yet... <br><br></td></tr></table><br>
<a name="564723"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not 100% sure, but I think it waits until the whole thing is loaded (streamed)... <br><br></td></tr></table><br>
<a name="564750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> LoadSound does, but not OpenStream... so here is my crazy idea.<br><br>I've been having a look at the ogg specs... I could try to code some type of manual StreamOgg. Read the full ogg in a stream; copy the ogg header to a new stream...<br>Now each "streaming" pass, create a new stream, copy the headers into it, copy some audio packets (an ogg page) from the main stream, and loadsound+playsound. Timing is hard to do without threads but I've come up with a way to do it (I think)<br><br>However the ogg format is very complex, and I'm not very sure... but I think the same file headers can be "recycled" for each of these "chunks".<br><br>Taken from <a href="http://www.xiph.org/ogg/vorbis/doc/Vorbis_I_spec.html" target="_blank">http://www.xiph.org/ogg/vorbis/doc/Vorbis_I_spec.html</a> :<br>&lt;&lt;Note: Vorbis can initiate decode at any arbitrary packet within a bitstream so long as the codec has been initialized/setup with the setup headers.&gt;&gt;<br><br>I guess I'd need only to identify an ogg page (that's easy as they're marked with the string 'OggS') and copy n of them to the new chunk...<br><br>I don't know how will it work in terms of performance though. Could try to use TCStreams and do it under C++ ...<br><br>What do you think? Shall I try it? or shall I stop dreaming? <br><br></td></tr></table><br>
<a name="565102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll finally started to code it; I guess it's not so easy. If I miss any ogg page when copying to a new stream LoadSound returns null. I'll have to look more into it, but I think it's because he checks the Page sequence number, an 8 byte array each page has. If he misses 1... no ogg loaded :/ (in fact, that's only my guess)<br><br>More advances (I hope) soon <br><br></td></tr></table><br>
<a name="565425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm at a dead end at the moment :/ although in theory ogg vorbis can be cropped and played from any ogg page start (provided the header pages are loaded) still doesn't work. I do this under bmax (each [] means an "ogg page" of variable size):<br><br>I load:<br><br>OGG1: [header1][header2][header3][a1][a2][a3][a4][a5]...[a15]<br><br>Then I make 2 streams and copy the data this way:<br><br>OGG2: [header1][header2][header3][a1][a2]...[a5]<br>OGG3: [header1][header2][header3][a6][a7]...[a10]<br><br>OGG2 is loaded and played OK. <br>Then OGG3 hangs up the app when doing LoadSound. I tried copying page headers from a1 to a6, a2 to a7 etc (things as the page sequence number, granulate position...) to see if LoadSound was checking the correct order of ogg pages... but same result.<br><br>If anyone knows the format / how the ogg loader works... any clue of what could be wrong? <br><br>PD: btw this has become more an advanced than a beginner question. doh! x) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
