<!DOCTYPE html><html lang="en" ><head ><title >millisecs on pc/mac</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >millisecs on pc/mac</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >millisecs on pc/mac</a><br><br>
<a name="703454"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kemi</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use the following loop for timing the animation of a sprite:<br><br>if millisecs()&gt;oldms+50<br>oldms=millisecs()<br>frame=frame+1<br>end if<br><br>and so on.<br>Somehow, the animation is correct on Mac, but veeeery slow on Win.<br>It's not that the game runs to slow, it's just this animation that runs slow.<br>Isn't millisecs() safe or the same on different systems? <br><br></td></tr></table><br>
<a name="703458"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its the same for all systems.<br>but as 50 isn't even divideable through 16.66 I might ask a different question:<br><br>Any chance, VSync is off on your Mac but enabled on your windows machine? (it is default enabled. this means you have to use flip 0 / flip false if you want to have your graphics app run without "waiting for sync")<br><br>A different thing is that Apple uses OpenGL but Windows DX at default. You might try it with OpenGL there as well using SetGraphicsDriver GLMax2DDriver() before calling graphics.<br><br>Its definitely no millisecs issue <br><br></td></tr></table><br>
<a name="703471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also what are you doing when it fails?<br><br>ie You havent actaly shown a loop, but just an conditional that we assume is within a loop for example<br><br>do<br>If milli&gt;old+50 then .... stuff<br>? Win<br>Delay 1000<br>?<br>Loop<br><br>(I realise you havent done this, but you might be doing something else that could cause the delay) <br><br></td></tr></table><br>
<a name="703480"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> While I can't imagine it makes any difference, try:<pre class=code>	newms=MilliSecs()
If Abs (oldms-newms) &gt; 50
	Print "!"
	oldms = newms
EndIf
</pre>This does two things. It uses discrete delta values, preventing the game from hanging when MilliSecs() rollover occurs, secondly it assures that the number of millisecs elapsed is the same both times it has been used. Not that I think it makes a difference from what you describe, but without more code to go by, it's the best I can do. <br><br></td></tr></table><br>
<a name="705669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BadJim</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> This line is wrong:<br>oldms = millisecs()<br><br> It should read:<br>oldms=oldms+50<br><br>This is the main reason why your timing is out.<br><br>You also should use While instead of If. This avoids slowdown if the players framerate drops below 20fps. Also, remember to initialise oldms to millisecs() or you will skip an absurd number of frames <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
