<!DOCTYPE html><html lang="en" ><head ><title >Modal window , unmovable and centered at parent.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Modal window , unmovable and centered at parent.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Modal window , unmovable and centered at parent.</a><br><br>
<a name="1142141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello ,<br><br>I would like to ask how to make some window be modal (not allows all other windows around to be selected and make it unmovable)<br><br>If I remove the WINDOW_TITLEBAR from window creation the window is unmovable because there is no title bar to handle and move it.<br><br>Is it possible and this window to be centered on the parent window , the main application window.<br><br>WINDOW_CENTER centers the window according to the screen.<br><br>Thank you :) <br><br></td></tr></table><br>
<a name="1142142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, you're after the equivalent of an MDI child form in C# etc?  Don't think it's possible. <br><br></td></tr></table><br>
<a name="1142147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If WINDOW_CENTER doesn't work make your own function (use GadgetX(), GadgetWidth() etc.) and then use ModifyGadget to set it's position. So you could just reset the position to the middle of the screen whenever the user tries to move the window.<br><br>Just remember to stick with conventions on your platform. <br><br></td></tr></table><br>
<a name="1142149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Disable all other windows:<br>DisableGadget(MainWindow)<br><br>Either create the modal window or set the shape:<br>SetGadgetShape( WindowOnTop:TGadget, GadgetX(MainWindow)+GadgetWidth(MainWindow)/2 -GadgetWidth(WindowOnTop)/2, GadgetY(MainWindow)+GadgetHeight(MainWindow)/2 -GadgetHeight(WindowOnTop)/2,w,h )<br>to center the new window on top of the MainWindow<br><br>Show the window you want if not yet visible or hidden underneath under windows:<br>ShowGadget(WindowOnTop)<br><br>But having said that, do use modal dialogs only if absolute needed, most of the time it is not.<br>If I do use a program it often happens that I want to look up something while the dialog is open and I can't and I really hate that and probably all other user as well... <br><br></td></tr></table><br>
<a name="1142150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to add minimize button to the main window and the maximize button be disabled and only the window will be restored? <br><br></td></tr></table><br>
<a name="1142155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> JSP your function does the work , but you can move (drag) the window and then the window returns to the center position of the parent window.<br><br>But the window is still able to be dragged , but return to center when dropped.<br><br>If we assume this is not bad. I will remove the caption bar so the window will not able to be moved or not even dragged at all.<br><br>I discover and another one problem.<br>If you select the application from the taskbar , you are loosing the focus of the new window and the parent window the main window covers the window on top. And the parent window is disabled so then you have one disabled window and the application stucks , because the on top window is hidden from the task bar , because is a WINDOW_TOOL.<br><br>How do I know if the focus of the window on top was lost to re activate it? <br><br></td></tr></table><br>
<a name="1142158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can't you just create 2 windows, then set the parent on the second one as the first one? Just use the API call SetWindowParent.<br><br>If I remember well, you could also use Win32 API call ShowWindow(hWnd,SW_MODAL) to make the modal window you want.<br><br>(This is only on Windows, so you're asking something for MacOS or Linux, I have no idea if its even possible) <br><br></td></tr></table><br>
<a name="1142160"></a>

<a name="1142162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If you select the application from the taskbar , you are loosing the focus of the new window and the parent window the main window covers the window on top. And the parent window is disabled so then you have one disabled window and the application stucks , because the on top window is hidden from the task bar , because is a WINDOW_TOOL. <br></div><br><br>Your window create function is wrong.<br>You need to refer to the main window as parent like this:<br>CreateWindow:TGadget(name$,x,y,w,h, <b>MainWindow:TGadget</b> ,style)<br>Having done this your tool window will always stay on top.<br><br>Why it is important that the user is not allowed to drag your dialog window?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1142168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is it possible to add minimize button to the main window and the maximize button be disabled and only the window will be restored?  <br></div><br><br>SetMaxWindowSize( window:TGadget,w,h )<br>Calling this function will disable the Maximize button window hint on Windows, and will limit the window zoom size on Mac OS X. <br><br></td></tr></table><br>
<a name="1142170"></a>

<a name="1142176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The dialog window must be static , for cosmetic purpose only :P<br><br>This dialog window opens my door creation tool for my dungeon.<br>If you move it , you see trails in the parent window and the trails disappears with to release the mouse.<br><br>And if you select the main application window from the task bar , the application window comes in front and covers the dialog window in back.<br><br><br><pre class=code>
main_window = CreateWindow(AppTitle, 0, 0, 1018, 700, Null, WINDOW_TITLEBAR | WINDOW_CENTER | WINDOW_MENU)
</pre><br><br>Is this wrong?<br><br>Ahaa I got it.<br><br>The correct code on the dialog window<br><br>The main window creation<br><pre class=code>
main_window = CreateWindow(AppTitle, 0, 0, 1018, 700, Null, WINDOW_TITLEBAR | WINDOW_CENTER | WINDOW_MENU)
</pre><br><br><br>The dialog creation<br><pre class=code>
door_options_window = CreateWindow("Door Creation", 100, 100, 500, 200, main_window, WINDOW_TITLEBAR | WINDOW_CENTER | WINDOW_TOOL)
</pre><br><br>As a group gadget instead of null I put main_window.<br><br>This keeps my dialog window in front without the main_window hides the door_options_window.<br><br>The only thing is to make it not movable , I will make it as canvas gadget like the main window.<br><br>Or I will remove the caption bar to make it not movable.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1142174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is this wrong?  <br></div><br>No, the mainwindow has Null as parent, so that's ok.<br>Just use the Mainwindow as parent for the dialog window.<br><br><div class="quote"> If you move it , you see trails in the parent window and the trails disappears with to release the mouse. <br></div><br>If you see trails then the canvas is not redrawn.<br>I think you had a hook function, when redrawing on windowmove event this would not happen.<br>Just check that your redraw does not hang up again. <br><br></td></tr></table><br>
<a name="1142178"></a>

<a name="1142179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I uploaded the new version to see the effect:<br><br><a href="https://www.box.com/s/99c823d46963aa2e6b67" target="_blank">https://www.box.com/s/99c823d46963aa2e6b67</a><br><br>How to add canvas redraw during window dragging?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1142197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Put this in your init routine:<br><br>AddHook EmitEventHook , MyHook<br><br>And this function just as it is comfortable:<br><br>[bbcode]Function MyHook:Object(iId:Int,tData:Object,tContext:Object)<br>	Local Event:TEvent=TEvent(tData)<br><br>	If event=Null Return Null<br><br>	If (Event.ID = EVENT_WINDOWSIZE) Or (Event.ID = EVENT_WINDOWMOVE) Or (Event.ID = Event_APPRESUME) Then <br>		Redraw() '&lt;---- your redraw routine should go here<br>	End If<br>	<br>	Return tData<br>End Function<br>[/bbcode]<br><br>This should trigger a redraw when a window is resized (your editor is not??) , a window is moved (as your tool window on top) and when the application is resumed (and thus was may covered by some other window). <br><br></td></tr></table><br>
<a name="1142215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where do I put the<br><br>AddHook EmitEventHook , MyHook<br><br>I put the function in the main loop and the program lags when I am moving the window.<br>I put the function just before the main loop and nothing happens.<br><br>I put the function AddHook EmitEventHook , MyHook in EVENT_WINDOWMOVE and the progam seems to addhooks and become slow. <br><br><br><pre class=code>
	If EventID() = EVENT_WINDOWMOVE Then
		
		
		If editor.door_options_open = 1 Then
		
			If EventSource() = door_options_window
			
			ActivateGadget(main_window)
			AddHook EmitEventHook, MyHook
			SetGadgetShape( door_options_window, GadgetX(main_window)+GadgetWidth(main_window)/2 -GadgetWidth(door_options_window)/2, GadgetY(main_window)+GadgetHeight(main_window)/2 -GadgetHeight(door_options_window)/2,500,200 )
			
			End If
		EndIf
		
	End If
</pre><br><br><br>If I put in Redraw() area the<br><br><pre class=code>
SetGadgetShape(door_options_window, GadgetX(main_window) + GadgetWidth(main_window) / 2 - GadgetWidth(door_options_window) / 2, GadgetY(main_window) + GadgetHeight(main_window) / 2 - GadgetHeight(door_options_window) / 2, 500, 200)
</pre><br><br>I am very near to make the window not movable.<br><br>The Idea might be when I will drag the window the mouse button will be released and not allows the window be moved.<br><br>Also I put removehook <br><br><pre class=code>
	If EventID() = EVENT_WINDOWMOVE Then
		
		
		If editor.door_options_open = 1 Then
		
			If EventSource() = door_options_window
			
			ActivateGadget(main_window)
			AddHook EmitEventHook, MyHook
			SetGadgetShape( door_options_window, GadgetX(main_window)+GadgetWidth(main_window)/2 -GadgetWidth(door_options_window)/2, GadgetY(main_window)+GadgetHeight(main_window)/2 -GadgetHeight(door_options_window)/2,500,200 )
			RemoveHook EmitEventHook, MyHook
			End If
		EndIf
		
	End If
</pre><br><br><br>Because add hooks and the becomes slow.<br><br>I updated my file:<br><br><a href="https://www.box.com/s/99c823d46963aa2e6b67" target="_blank">https://www.box.com/s/99c823d46963aa2e6b67</a><br><br>Source code included.<br><br>If I will remode the <br><br><pre class=code>
SetGadgetShape(door_options_window, GadgetX(main_window) + GadgetWidth(main_window) / 2 - GadgetWidth(door_options_window) / 2, GadgetY(main_window) + GadgetHeight(main_window) / 2 - GadgetHeight(door_options_window) / 2, 500, 200)
</pre><br><br>From the hook , the window appears well , but I am near to make it not moving. <br><br></td></tr></table><br>
<a name="1142221"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Put the AddHook EmitEventHook , MyHook<br>just somewhere at the start of the program.<br><br>It should only run once!, not under an event where it adds more and more hooks, you need only one hook.<br><br>The SetGadgetShape is normally not meant to sit in a redraw function, because then it will be called every time you update your display, but you show the door options window only very seldom...<br>Best to have a canvas redraw routine doing nothing else then take care about the canvas. Also best not to mix logic and render functions, although it works it is a hell to maintain. <br><br>A bit too late for today I may have time tomorrow to have a look at the source. <br><br></td></tr></table><br>
<a name="1142226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you very very much , I see you tomorrow. <br><br></td></tr></table><br>
<a name="1142340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had a look and sorry to be a pain in the ass, but you should do some more changes to your structure.<br><br>I know the program is working for you as it is now, but again it will be very difficult to maintain the stuff while you add additional code.<br><br>Some advice, ignore as you like:<br>Try to have different modules in your program<br><br>An init part where you initialize all stuff needed (load fonts, pictures, set variables, define constants and so on)<br><br>Then have a logic part and do only logic things here (if mouse clicked then store position (don't draw here), if var door = open then ... )<br><br>Then have one draw routine (Function) which does draw everything needed to update your canvas (don't do any logic here, only like if door=open then drawdoor() and so on)<br><br>In an application the WaitEvent() Loop is more or less the logic part, every logic is called upon event. The user pressed the left mouse button, you got an event and the logic behind processes it and for example store the mouse position. Whenever your display changes call the draw routine or do it again via an event or if you use animations via a timertick event.<br>When doing the draw routine just ask for the position of the mouse (stored during the logic step) and draw your mouse frame for example and so on.<br><br>So why do I not just come up with a solution and you are done?<br>The problem is, in the current structure the hook can't be implemented just easy, because there is no redraw function alone but a mixed thing.<br> <br>It is thus serious that there is an endless loop in your code!<br><br>Please put directly after the WaitEvent() command this:<br>Print CurrentEvent.ToString() 'for testing only of course<br>You will see a constant GADGETPAINT Loop, this happens because you call a RedrawGadget(graphics_canvas) inside your GADGETPAINT routine.<br>Actually it is very very seldom needed to redraw a certain gadget. The trick is to just call the draw function which updates the canvas.<br><br>First you should fix the endless loop and then it will be much easier to implement new stuff.<br><br>So again, ignore me if this all too much, but it would help you in the long run.<br>And for the moment just remove all references to the hook, we may can come back to it later. <br><br></td></tr></table><br>
<a name="1142377"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> You shouldn't keep a user from moving a window.  It is very irritating.  Also, keeping it from showing on the task bar is irritating. <br><br></td></tr></table><br>
<a name="1142511"></a>

<a name="1142517"></a>

<a name="1142518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I changed to unmovable window<br>And not shows in the taskbar.<br><br><br>JSP , I am not ignore you and I listen what you say , because you have helped a lot.<br><br>As I have understand so far , the GADGETPAINT redraws all canvases.<br>Infact the flip command updates the graphics of the canvases.<br><br>What kind of endless loop do I have?<br>In the main loop are the events of my game.<br><br>The EVENT_MOUSEMOVE events , is in the main loop and I am checking the EventX() and EventY() and I know the courdinates of the pixels in the graphics canvas gadget as you have said to have only one canvas. I have map and my mouse x,y and I update my mouse x and y for every canvas and opened window.<br><br>The EVENT_MENUACTION event is on the main game loop to control my menus.<br><br>I have the SetGraphics CanvasGraphics() in the game loop to update my canvases.<br><br>The type editor.<br><br>editor.door_options_open = 1<br>editor.map_options_open = 1<br>editor.save_adventure_options_open = 1<br>editor.adventure_properties_open = 1<br><br>These variables takes values from 0 to 1.<br>Only one of them take 1 and other take value 0.<br><br>I use these variables in type editor to know which of options is open in the program.<br><br>These options are in the main game loop too.<br><br>Each of these options change my graphics canvas to avoid show all options in the main window. Everything in the main window appears in the main canvas , each window or dialog box have only one canvas.<br><br>If my Adventure Properties are open the variable editor.save_adventure_options_open takes value=1 and I know if the user opened the Adventure Properties the same with other variables.<br>:)<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1142523"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> As I have understand so far , the GADGETPAINT redraws all canvases. <br></div><br><br>No, not really. The GADGETPAINT event will be generated when the canvas <b>wanted</b> to be updated. <br>For example you opened another window and that window was covering the canvas, when you now move or close the window on top the canvas generated that event to tell YOU to update the canvas with whatever you wanted to show.<br>To make it short you should call your canvas redraw function when this event occurs.<br>And it is normally wise to call here a function and not to put all draw commands directly, because it will for you easier if you need to call that function yourself.<br><br>For example create a redraw function (for every canvas one)<br>[bbcode]<br>Function Redraw()<br>	SetGraphics CanvasGraphics(graphics_canvas)<br>	SetViewport 0, 0, GadgetWidth(graphics_canvas), GadgetHeight(graphics_canvas)<br>	<br>	'CLS only if needed<br>	'Draw Background (Picture or tiles...)<br>	'If whatever draw on top for example mouseframe<br>	'...<br><br>	Flip<br>End Function<br>[/bbcode]<br>At the moment you set several times SetGraphics CanvasGraphics(graphics_canvas), but you need it actually only once in this function. The same for the Flip. One Flip and only in that function. Try to keep it simple and don't spread Flips somewhere else.<br><br><div class="quote"> What kind of endless loop do I have? <br></div><br>As said before put the:<br>Print CurrentEvent.ToString()<br>underneath the Waitevent()<br>The output of the print is the event WaitEvent() just received and is now being processed in your loop.<br><br>What you will see immediately is that the GADGETPAINT event will be generated without stopping.<br>This happens because you have RedrawGadget(graphics_canvas) underneath the GADGETPAINT event in the code. So the event says, please redraw me and while doing this you say plase redraw the gadget which will issue another event to inform you to redraw the canvas.<br><br>The point here is that when you rem out the RedrawGadget command then your program does not work correctly because you mixed logic and render.<br>It's not that bad, you have all the code, it just need to be restructured.<br><br>I think, start with a new and fresh Redraw() function and take out step by step all RedrawGadget commands and put this function under the GADGETPAINT event, that would be a good start. <br>Where you need to update the canvas call only this function. <br><br></td></tr></table><br>
<a name="1142730"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I will make a lots of changes , but I would like to ask,<br><br>The hook function does meke the redraw of all gadgets?<br><br>Or if I will put the flip and RedrawGadget functions in the hook?<br><br>I have one new test code to see if you like the source structure.<br><br><a href="https://www.box.com/s/48f338c439d4bfa66371" target="_blank">https://www.box.com/s/48f338c439d4bfa66371</a> <br><br></td></tr></table><br>
<a name="1142820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The hook function does meke the redraw of all gadgets? <br></div><br>No, your own redraw function will draw everything and on flip the canvas will be updated with what you have drawn during the last flip.<br>So if you need a redraw for whatever reason, call your own function to do it.<br><br>The hook function does have a completely other role. And there are different ones like FlipHook, EmitEventHook (this one we use as seen in the example above).<br>When an event occurs in the system it is given to all functions who hooked into it via the EmitEventHook ID.<br>One of those hook functions is also used by BlitzMax itself to build the WaitEvent queue.<br><br>That means using a hook functions is a more direct access to an event then using the WaitEvent queue.<br>But that does not mean that a hook is better, because the WaitEvent queue filters automatically double entries for certain event types (timertick or gadgetaction for example) and helps you not to flood your application with it. Additionally you have some nice commands to use the event queue yourself.<br><br>So when using a hook add it only once to the program, normally at the start or program init phase.<br>And inside the hook check for those events you want a direct response to your program. If you act on a WINDOWMOVE which may distorted the canvas content with trails then call here again your own redraw function. The drawback of this is of course, when your draw function takes very long your program again hangs for some time, because no double event is filtered and every event need to be processed.<br><br>I looked into your testcode and it is already much cleaner and you use now Strict (you could even use Superstrict).<br><br>Now add step by step what you need inside the event loop.<br>Add the GADGETPAINT Event again and put the Redraw() underneath, for the moment it is called on every event.<br><br>Update all things you want to draw to your redraw function, start with the background and then other stuff on top to keep the z-order.<br><br>If a certain event forces you to update the canvas just call the redraw() function (or post a GADGETPAINT event yourself). <br><br></td></tr></table><br>
<a name="1142826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is a difference between Strict and Superstrict. What Strict command does?<br><br>I saw , all kinds of Strict commands not allows you Goto command in your code. Why , some time I was needed the goto command to bypass something and I wasn't allowed and I removed the Strict command completely.<br><br>When I will have some small update I will send a new version.<br>Is it possible to send the updates in your e-mail? <br><br></td></tr></table><br>
<a name="1142830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> SuperStrict means that variables and functions have an explicit type.<br>Also Integer variables have to be defined.<br>It's only very little more typing, but saves you a lot of headache during debugging or that some nasty problems don't even happen.<br><br>If this is too much use at least Strict, don't go without, your code will also run slightly faster.<br>The "strictness" also don't allow Goto, because it would result in spaghetti code.<br>As probably 95% of the user here use Strict or Superstrict you can be sure you don't need a Goto. If you think you need, then the code needs some redesign.<br><br>You can send stuff to my email, but it should not be that huge, keep it as small as possible.<br>You could always send me the download link if you don't want to post it here. <br><br></td></tr></table><br>
<a name="1142834"></a>

<a name="1142836"></a>

<a name="1142837"></a>

<a name="1142838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would like to ask and about toolbars.<br><br>Today I tried to make some toolbar.<br>I have one image (long image) with the button icons.<br><br>What is the difference between this:<br><br><pre class=code>
Toolbar = MaxGUI_Driver.CreateGadget(GADGET_TOOLBAR,"",x,y,w,h,group,Style)
</pre><br><br><br>And this:<br><br><pre class=code>
toolbar= CreateToolbar(sourceObject,x,y,w,h,group,style)
</pre><br><br>As I understood with experiments the source object is one long image with icons which will be the visible buttons.<br><br>I created one long image with the graphics of the buttons.<br><br><br><pre class=code>
toolbar= CreateToolbar("Toolbar.png",0,0,24,24,main_window,0)
</pre><br><br>Then I understood each of the images the createtoolbar function create the button according to the width and height of the image.<br><br>I have 10 icons in the long image and the button index of the toolbars is from 0 to 9<br><br>Then I used this code:<br><br><pre class=code>
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 0, "Wall Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 1, "Door Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 2, "Wall Decoration Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 3, "Fake Wall Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 4, "Secret Button Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 5, "Stairs UP Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 6, "Stairs DOWN Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 7, "Keylock Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 8, "Switch Tool"
	AddGadgetItem toolbar, "", GADGETITEM_TOGGLE, 9, "Alcove Tool"
</pre><br><br>The option GADGETITEM_TOGGLE make each of the buttons remains down.<br><br>when I am pressing some of the buttons the icon of the button change and becomes the graphic of the next icon.<br><br>And how to make each of the toggled buttons restore (untoggle) when you pressing one other button from toolbar?<br><br>And how to change the image to other image when the button is toggled.<br><br>As you have seen some of my code , each selected button becomes green.<br><br>This will save some code and I will have less graphics on the graphics canvas.<br><br>In the demos you have seen , I used the toolbar as graphical images on the canvas , now is a real toolbar.<br><br>I think is time to use the smart buttons I have purchased but I don't have made a research yet.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1142841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> MaxGUI_Driver.CreateGadget(GADGET_TOOLBAR,"",x,y,w,h,group,Style) <br></div><br>You won't normally use this one, but as difference it specifies the namespace. Only important if you wanted to write your own function with the same name.<br><br><div class="quote"> CreateToolbar("Toolbar.png",0,0,24,24,main_window,0) <br></div><br>Use this function<br><br><div class="quote"> The option GADGETITEM_TOGGLE make each of the buttons remains down.<br>when I am pressing some of the buttons the icon of the button change and becomes the graphic of the next icon. <br></div><br>If you specify GADGETITEM_TOGGLE for a certain icon, it needs two(!) graphics. The first is normally shown and the second when pressed down. Those images can be different or use just twice the same.<br><br><div class="quote"> And how to make each of the toggled buttons restore (untoggle) when you pressing one other button from toolbar? <br></div><br>The toolbar is not a radio button thing. If you want that behavior you have to write it yourself.<br>Normally every button can be clicked or toggled independently. <br><br></td></tr></table><br>
<a name="1143013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I made it. <br><br></td></tr></table><br>
<a name="1143617"></a>

<a name="1143642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takis76</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> JSP , do you have some idea how to use smart buttons?<br><br><br>And something else , sometimes when I am moving some window on top of the main window the window leave trails and sometimes the window don't leave trails.<br>Why this happens?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1143644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jsp</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> JSP , do you have some idea how to use smart buttons? <br></div><br>SmartButtons are made for Logic Gui so the best method would be to use the tools provided. Although you could create them manually it would take you far more time.<br><br>First you could create them with the SmartButton Editor and when done, put them just into the SmartButton folder of Logic Gui. They will be available in the Gadget-TreeView then and can be added to the form like any other gadget.<br>When added to the form, Logic Gui will produce all needed source code for you.<br>If you don't create your program in Logic Gui, you can just copy the code you need over.<br><br>The SmartButton module itself has complete help available, but first use the manual (version 1.3) for the editor, that should be easier and also the Logic Gui user manual Chapter 7.17<br><br><div class="quote"> some window on top of the main window the window leave trails and sometimes the window don't leave trails. <br></div><br>If a window leaves trails depends if the movement does generate events you could act on and of course that you act on. For example your own floating window on top generates events and thus you redraw the canvas, but a system requester (loading a file) will not and thus produce trails. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
