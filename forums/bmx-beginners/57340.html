<!DOCTYPE html><html lang="en" ><head ><title >Return value from Var must be matching type</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Return value from Var must be matching type</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Return value from Var must be matching type</a><br><br>
<a name="637577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> GetViewport(ThisSprite.ViewportX#, ThisSprite.ViewportY#, ThisSprite.ViewportWidth#, ThisSprite.ViewportHeight#)<br><br>This won't work.<br><br>How do I work around this, without crating four new variables which are ints just for the sake of getting the values back from the function, and then assigning them to by floats?<br><br>If you're wondering why I use floats, it's because it makes sense to.  If you want to increase the size of a viewport over time, then you may want to add fractional bits to the size each frame, and why should you have to store those somewhere else?  That's silly.<br><br>I suppose I could access some type in Max directly to get the values without using intermediate vairables, but that's a bit rediculous, not not neccessarily safe.<br><br>Unless someone has a clever solution here, I guess you can chalk this up as another reason Var is a sucky concept. <br><br></td></tr></table><br>
<a name="637582"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >assari</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> if your type is TThisSprite then you can do this<br><br><pre class=code>
GetViewPort(s:TThisSprite)
  s.ViewPortX#=...
  s.ViewPortY#=...
end function
</pre> <br><br></td></tr></table><br>
<a name="637583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> There does not seem to be a solution as BM somehow refuses to implicitely cast it.<br><br>Nor works int( ... ), var int( ... ), varptr int( ... ) and others.<br>Var is no sucky concept just not fully implemented as other ideas mark borrowed from C#, Eiffel and Java. <br><br></td></tr></table><br>
<a name="637591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Isn't it the setviewport command you have to change in max2d module? <br><br></td></tr></table><br>
<a name="637594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> He wants to get the values, I assume on startup to set them to the actual value. <br><br></td></tr></table><br>
<a name="637597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Haramanai</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't forget that BMax it's Open Source for it's users.<br>Open the Max2D.BMX file.<br>In there you will find a Type TMax2DGraphics<br>delete the Private in Line 61.<br>Make the Mods. <br>Then you will have the gc Type that it is TMax2dGraphics Type. you can get the values from the fields of the gc don't change them directly but only throu the functions. <br><br></td></tr></table><br>
<a name="637598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> So it's the not the definition of the viewport that needs changing just the type of variable returned?<br>SSwift, and you don't want to write a simple function out of principle?<br><pre class=code>
Function getviewport_float(x# Var,y# Var, w# Var,h# Var)
  GetViewport(x1,y1,w1,h1)
  x#=Float(x1)
  y#=Float(y1)
  w#=Float(w1)
  h#=Float(h1)
End Function

</pre> <br><br></td></tr></table><br>
<a name="637599"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> The type in Max2D is private by default too?  Man this sucks. <br><br>Changing it isn't an option.  Then anyone who uses this system would have to change it, and if I ever reinstall max, my code breaks.<br><br>I guess I have no choice but to do the retarded thing and create temporary variables to hold the data so I can convert it to float after.  The only other option is to give up using floats for the viewport.<br><br>Why the hell did they have to go and make that private? <br><br></td></tr></table><br>
<a name="637600"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> "SSwift, and you don't want to write a simple function out of principle?"<br><br>I know I can do that.  I just think it's dumb I should have to.  I'm not going to bother making a wrapper funciton like that though, that's overkill.  I'm just gonna make some temporary local vars in the function I need to get the values in I guess.<br><br>But I guess you could say yes, it's the principle of the thing.<br><br>What would be really great is if they'd fix var so that you can cast the return value to different types.  It's absurd that you can't stick an int into a float. <br><br></td></tr></table><br>
<a name="637602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sadly we have not all sources, otherwise we could shorten the languages list of incapabilities *starting with VAR problems, strong typed ENUMs and the like*. The modules themself are only seldom the problem ... <br><br></td></tr></table><br>
<a name="637605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Haramanai</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is very easy to put some functions inside the Max2D file like the functions MouseX() and MouseY() and get what you wand.<br>Just look at the funtion GetOrigin inside the Max2D <br><br></td></tr></table><br>
<a name="637611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> sswift, GetViewPort returns nothing.  What is happening here is that you are passing GetViewPort pointers to memory where your variables are stored.  Then GetViewPort modifies the variables directly through the pointers.  GetViewPort expects those pointers to point to Ints.  If it tried to modify anything else, then the results would end up corrupt.  Might even corrupt other memory if the pointer points to less memory than the function expects.<br>The only solution would be for Mark to write a function for every possible type that someone would want to pass.  That would be a waste of time and space when 99.9% of the programmers out there only want Ints.<br>This is not a Blitz only thing either.  All languages behave this way when passing pointers. <br><br></td></tr></table><br>
<a name="637622"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not really. Numerics are implicitely casted or can be casted at all to be accepted by Ref. But it seems like in BM its not possible, even if you use varptr ( int ( somefloat#)) it fails although it should work theoretically. <br><br></td></tr></table><br>
<a name="637631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm not going to bother making a wrapper funciton like that though, that's overkill.  <br></div><br>except you can add it to a 'doitmyway.mod' and make it part of your standard BlitzMax command set. <br><br></td></tr></table><br>
<a name="637653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora.  No, it shouldn't work.  When you cast a variable like int(somefloat#), it's not the variable being converted, but rather the value inside the variable.  You can't create a reference to that value since the value isn't stored anywhere.<br>Now if you were to do<br><pre class=code>
local SomeInt:Int = Int(SomeFloat)
Local SomePtr:Int Ptr = Varptr SomeInt
</pre><br>That would work because now the converted value is being stored somewhere that can be referenced.<br>Some languages, such as c++, do allow you to cast pointers of one type to pointers of another. For instance<br><pre class=code>
Float *Float_ptr;

DoSomething((int *)Float_ptr);
</pre><br>However, if the function DoSomething writes to the area pointed to, it will be as an Int and not a Float.  The results will be corrupted.  Typically type pointers will be cast when a function deals with the raw data and not with actual values. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
