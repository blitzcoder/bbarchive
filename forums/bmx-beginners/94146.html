<!DOCTYPE html><html lang="en" ><head ><title >exception_access_violation using SavePixmap</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >exception_access_violation using SavePixmap</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >exception_access_violation using SavePixmap</a><br><br>
<a name="1079080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >4mat</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>  I'm making a video using BlitzMax to save consecutive frames. But when I use the SavePixmap commands eventually I'll get an "EXCEPTION_ACCESS_VIOLATION".  (usually around 540 frames into the recording)   At a wild guess I'm assuming it's continually creating new frames and running out of memory or something?<br><br>  Having used Image buffers in the old versions of Blitz I was assuming there'd be some way to just free the Pixmap with a command after saving it.   All I'm doing is:<br><br><pre class=code>
		image = GrabPixmap(0,0,1280,720)
		SavePixmapJPeg image,pic$
		image = Null
</pre><br><br>  I tried putting GCCollect() in and using the GCSuspend() and GCResume() from some forum posts, but obviously I'm misunderstanding what Pixmap is actually doing in the first place. :)   Any ideas?<br><br>thanks. 4mat. <br><br></td></tr></table><br>
<a name="1079145"></a>

<a name="1079146"></a>

<a name="1079147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> deleted<br><br><font class="tiny">Last edited 2011</font><br><br>I originaly posted use "Clearpixels", but now Im thinking, just dont bother with the Image = null thing<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1079151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Too many file handles open?<br>Or, some reference hanging around somewhere...<br><br>If you were using a Mac, you could run it through the leak checker that comes with XCode, and it would tell you exactly what object was leaking (if anything). <br><br></td></tr></table><br>
<a name="1079158"></a>

<a name="1079167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >4mat</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for the suggestions, unfortunately I'm on PC.   Using GCMemAlloced() it looks like some garbage collection is going on. (edit: with GCCollect() I can see it's adding about 1k to the internal memory alloc per frame) <br><br>I removed the 'null' line but still have the same problem, it's definately in the line:<br><br><pre class=code>
image = GrabPixmap(0,0,1280,720)
</pre><br><br>So is the GrabPixmap just allocating another bitmap each time do you think?  Would a StaticPixmap fix that?<br><br>As an alternative I wrote a quick .bmp writer and then realised it can't do the old blitz ReadPixel off the backbuffer. :)   (unless I'm missing something)<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1079178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is the leak checker and how does it work? <br><br></td></tr></table><br>
<a name="1079182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >4mat</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ah, I seem to have fixed it a bit with:<br><br><pre class=code>
Release(image)
</pre> <br><br></td></tr></table><br>
<a name="1079372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is Image a TPixmap?  You shouldn't need to release it if it is. From your description, I'm getting the impression you are allocating memory for the pixmap, then calling GrabPixmap, but GrabPixmap allocates it's own memory so Image no longer points to your buffer and therefor never gets collected by the GC. <br>Be sure and put Superstrict at the top of the program to catch those type of errors. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
