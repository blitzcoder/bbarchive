<!DOCTYPE html><html lang="en" ><head ><title >GetWindowModuleFileName and EnumWindows Being Odd</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >GetWindowModuleFileName and EnumWindows Being Odd</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >GetWindowModuleFileName and EnumWindows Being Odd</a><br><br>
<a name="603692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, apparently I'm having even more problems with WinAPI programming. Nothing seems to work as advertised.<br><br>GetWindowModuleFileName is just wrong most of the time. It says it returns the EXE but it doesn't. For example, FireFox instances return the name of MYPROGRAM.exe ( IE: the name of the BMax program which is querying this information. And the process id's are all the same too. Now ok, FireFox has tabbed windows, so I'm ok with it return the same process id for each window, but it really shouldn't be returning the same process id for my blitzmax program and firefox. And some other stuff too.<br><br>GetWindowThreadProcessId is the same as above really. As I mentioned, the process id's are not unique, nor close.<br><br>EnumWindows is supposed to return only top level windows but it returns a huge number of windows. Is this really right?<br><br>I've spent hours googling for this stuff, but all I can find is numerous pages offering the same explanations and people describing how it does exactly what I want in each case. Except that none of it does. <br><br></td></tr></table><br>
<a name="603694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using win2k/winNT/(XP?) - http://support.microsoft.com/default.aspx?scid=kb;en-us;228469 <br><br></td></tr></table><br>
<a name="603969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok thanks, now that I've got OS detection working correctly, I can look into that.<br><br>And I've figured out why the thread id's were the same. I was looking at some code for B3d where someone was returning thread id's as int's and just assumed that was correct, but it's not. Thread ID's are, in fact, 64 bit numbers and need to be returned as Long's. When I do that, they're all different, except that multiple instances of FireFox return the same Process ID, which is the desired behaviour.<br><br>Getting somewhere, at last, I think. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
