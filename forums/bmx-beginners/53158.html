<!DOCTYPE html><html lang="en" ><head ><title >Events / Hooks and Stuff</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Events / Hooks and Stuff</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Events / Hooks and Stuff</a><br><br>
<a name="594139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know this is a broad question..but can someone help me in simple terms what these are used for and how they are implemented in a practical application.<br><br>I remember way back when , when I couldn't understand "TYPES" now they are second nature. <br><br>GUI based stuff is really new to me.<br><br>Thanks in advance for any help.<br>Eric <br><br></td></tr></table><br>
<a name="594260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space_guy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes an event and hook tutorial would be great! <br><br></td></tr></table><br>
<a name="594299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warpy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> shagwana posted some great code yesterday, but it's a bit obscure...<br><br>ah, here it is! <a href="http://www.blitzbasic.com/Community/posts.php?topic=53153" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=53153</a> <br><br></td></tr></table><br>
<a name="594346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep I saw that and that is what prompted my question. <br><br></td></tr></table><br>
<a name="594602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have tried the MaxGUI demo, it's pretty nice, but I am not really using it for anything right now. However I probably can explain what events and hooks are, in general. If this doesn't totally pertain to MaxGUI, forgive me.<br><br>To start with, any GUI system that is a native part of the operating system, is largely handled by the operating system itself. The o/s deals with drawing the windows, buttons, sliders, all the rest of it. Because the o/s is handling that stuff, it also handles the user input. So when you are doing stuff with the mouse, clicking on buttons, moving sliders, etc, the o/s is handling all that, drawing the slider controls, moving windows around, etc. For the most part that can all be controlled without having to involve the underlying application whatseover. It's just a `front end` for your application which is separately managed by the operating system, not by your application. It's kind of like your application says, okay, I would like you to draw a window for me, and the o/s draws it and then the o/s manages it too. The o/s deals with any basic updating that needs to be done as a result of a window moving over the top of another, or to show that buttons are being clicked on, etc. Of course it then has to communicate with your application to tell you that something important happened. Normally your application is blind to these `events` so that's why you then need to have an `event handler`.<br><br>So you have a list of events that stream in to your application through a doorway that allows the o/s to tell you what the user is doing with the GUI. These little messages arrive and then BlitzMax will process them for you and make them available to your program in a way that you can make use of them.<br><br>Sometimes all you might want to do in your program, then, is to say "wait for an event to happen" , and when an event does happen, you then interpret the event ie figure out what type of event it is, and then act accordingly. So you might be waiting for an event, the user clicks a button, the o/s handles animating the button click, it passes an event code to your application behind the scenes, the BlitzMax event system puts it in the queue, then it feeds into the `wait event` command (i guess there is one?). So then control is in the hands of your program, you can then get the event code and decide what it means to you. Like if they clicked a certain button, you can say ok, make a new window open, or play a sound, or whatever functionality. <br><br>Waiting for events is the simplest way of getting communication from the o/s. Usually it is a little inconvenient for you, in your programming design, however, to have just one place in your `main loop` where you wait for events. You might want to be getting on with doing some other stuff and it might not be practical to wait for the events in only on point in the program. This is where hooks come in.<br><br>A hook, or a call-back routine, is a way of getting the external o/s system to call specific functions as and when an event actually occurs, as if they were wired directly into the GUI itself. In other words, rather than you waiting for an event, the o/s triggers an event, handles the GUI and calls the piece of your program that you've told it is a hook. They call it a hook because it allowing you to `hook into` the o/s's GUI management and be a more integrated part of it. These are also sometimes called call-back routines. So it's like taking a little chunk of your blitz code and `uploading it` to the separate o/s-managed GUI system, yet it still being able to inter-operate with the rest of your program. You then don't have to wait for the events to happen or to check for them, as soon as they happen the hooked function gets executed. Since it gets called right there and then, it probably interrupts whatever else is happening at the time (i guess?). There may be some multitasking involved, I don't know how they have it working in BlitzMax.<br><br>So a hook is basically a way of putting some of your code on the other side of the fence, in the o/s realm of control rather than on this side where you are blind to what's going on. The o/s can trigger specific routines in your program when they need to be called. It makes the GUI more responsive because things happen as and when they are clicked rather than when your program happens to get to it.<br>The GUI becomes responsive and events are handled in a more `object oriented` way. Ie, you have separate little functions that get called for each type of event, rather than one `centralized` event handling procedure. You are basically hardwiring your program into the GUI manager so that it already knows ahead of time what routine goes with what action, and can call that routine.<br><br>Normally when the program flow is in the GUI-management code, you don't have any control over what happens and you can't get access to it. With a hook in there, you can get the o/s to call a little piece of program according to your will. So maybe you have a slider bar which the o/s is handling, and the user is clicking it and sliding it around, but you don't want it to just be some dumb slider hanging around in mid air. You want it to do something WHILE the user is still controlling it, like scroll a page of text or make a value increase or a color change. So by telling it what your hook program is, you can have it `tie in` (be hooked into) your program and do something real-time responsive while the user is still controlling things. So as you slide the slider bar, your little `scroll the canvas` routine might be called, or your `cycle the colors` or whatever else you want to happen. It needs to be in there as a hook because while the user is still controlling the GUI, the CPU's program flow is locked into the GUI program, separate from your application. You want to be getting some feedback from what's going on in realtime while still allowing the o/s to handle what the user is doing, so you sort of `share` the program flow by telling it to call your hook program every time there is a change (ie user moves the mouse on a slider etc).<br><br>There are many other examples I'm sure, that's basically how I understand it. So when you are wanting the o/s to tell you what events are happening you need them to come to you in order of clicking, etc, so you have an event queue. You can read it yourself or tell the o/s what pieces of your program to execute for which events. It's kind of a way to add some multitasking to your program as well, since your regular program is probably pre-empted/interrupted while the hook program is run (AFAIK).<br><br>I hope this helps. <br><br></td></tr></table><br>
<a name="594617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Angel...Wow Thanks for that answer it really helped. Now I just need to grasp the commands that make this happen.<br><br>Again Thanks.<br><br>Eric <br><br></td></tr></table><br>
<a name="594658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Takuan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very nice explanation.<br>Mr.S should hire you to write Docs:) <br><br></td></tr></table><br>
<a name="594660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Mr.S should hire you to write Docs:) <br></div>You must not have used Miranda. :o&gt;<br><br>Although in his defense I must say he has gotten better. <br><br></td></tr></table><br>
<a name="594674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you mean Mildred? I would agree those docs were somewhat shabby ;-D <br><br></td></tr></table><br>
<a name="594727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >REDi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eric have a look at the "maxgui_overview" tutorial in the "doc/maxtuts" folder of your install, in there you'll find a section called "Event Hook based Rendering".<br><br>Hope that helps <br><br></td></tr></table><br>
<a name="594740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Papa,<br><br>I read that I am trying to understand how <br><br><pre class=code>AddHook EmitEventHook,eventhook,Self</pre><br><br>And <br><pre class=code>Function eventhook:Object (id,data:Object,context:Object)
		Local	event:TEvent
		Local	app:TApplet
		event=TEvent(data)
		app=TApplet(context)
		app.OnEvent event	
End Function</pre><br><br>Correlate to one another but I'll figure it out. I never thought this GUI stuff would be confusing to me. <br><br></td></tr></table><br>
<a name="595001"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Most confusing thing is especially that the example in the help does not work without GUI (the addhook FlipHook, MyHook results in a FlipHook not found) <br><br></td></tr></table><br>
<a name="595005"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wiebo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't understand one damned thing of that code example Eric just posted... There is no explaining comment in the spinningapplet demo at all!! argh. <br><br></td></tr></table><br>
<a name="595094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is confusing isn't it?<br><br>I was playing around with that code and I still don't understand. <br>If we can hook events to functions how do you distinguish which event hooks what function. <br><br></td></tr></table><br>
<a name="597379"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >René</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi there,<br><br>I don't know whether this topic is still active but maybe this example is helpfull: a slider which immediately moves a panel when the slider moves.<br><br><pre class=code>
Global window:TGadget = CreateWindow("Main", 0,0,800,600)
Global slider:TGadget = CreateSlider(5,50,500,20, window, SLIDER_HORIZONTAL|SLIDER_SCROLLBAR)
Global panel:TGadget = CreatePanel(50,100,20,20, window, PANEL_BORDER)

SetSliderRange(slider, 0,100)
SetSliderValue(slider, 50)

AddHook EmitEventHook,myFunc


While Not KeyHit(KEY_ESCAPE)	
Wend
End


Function myFunc:Object(id, data:Object, context:Object)
	Local event:TEvent = TEvent(data)
	
	Select event.source
		Case slider
			SetGadgetShape(panel,event.data,GadgetY(panel), GadgetWidth(panel), GadgetHeight(panel))
	End Select
	
	Select event.id
		Case EVENT_WINDOWCLOSE
			End
	EndSelect
End Function
</pre> <br><br></td></tr></table><br>
<a name="597412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If we can hook events to functions how do you distinguish which event hooks what function.  <br></div><br><br>Exactly what I'm wondering.<br><br><br>And while I appreciate the effort to assist, Rene's example just leaves me more confused. You're not using AllocHookID so it still looks to me as though MyFunc is executed on every single event, and then you just parse to see what event it was. That doesn't seem to fit the stated purpose of hooks at all. Instead of having one action tied to an event, you end up slowing things down parsing every possible event on every single occasion. In other words, with 10 events to parse and 10 possible outcomes, you end up checking 100 different possibilities.<br><br>If that's really how hooks are supposed to work, isn't it being unecessarily slow? <br><br></td></tr></table><br>
<a name="597426"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless you are doing something advanced the only time you will want to use an event Hook is in the following example:<br><pre class=code>
' standard main loop

window=CreateWindow("test",20,20,200,200)

While True
	WaitEvent()
	Select EventID()
		Case EVENT_WINDOWCLOSE
			End
	End Select
Wend
</pre><pre class=code>
' an event handler based program

Function EventHandler:Object(id, data:Object, context:Object)
	Select EventID()
		Case EVENT_WINDOWCLOSE
			End
	End Select
End Function

window=CreateWindow("test",20,20,200,200)

AddHook EmitEventHook,EventHandler

While True
	WaitEvent()
Wend
</pre>These two programs may look the same but the fact the the system is calling the EventHandler function in the second example means that when systems such as Windows enters a "modal loop" such as during window sizing, scrollbar dragging and menu activation your application can continue to support event handling.<br><br>The first example using the traditional eventloop which will only allow you to process events once the user has released the mouse and the system exits such modal loops as mentioned. <br><br></td></tr></table><br>
<a name="597449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smokey</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> the code <br><br><pre class=code>
' an event handler based program

Function EventHandler()
	Select EventID()
		Case EVENT_WINDOWCLOSE
			End
	End Select
End Function

window=CreateWindow("test",20,20,200,200)

AddHook EmitEventHook,EventHandler

While True
	WaitEvent()
Wend

</pre><br><br>does't work for me it give me an error<br><br>"Unable to convert from Int() to Object(int,Object,Object) ? <br><br></td></tr></table><br>
<a name="597451"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> oops. <br><br></td></tr></table><br>
<a name="597479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> so:<br><div class="quote"> AddHook EmitEventHook,EventHandler <br></div><br>means that "EmitEventHook" is like "react on everything which happens to my window/program", and it calls the given function when this event fires (ie. "EventHandler")? <br><br></td></tr></table><br>
<a name="597518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >René</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe the SetGadgetTarget command is the one you're/we're loking for. Does somebody have an example of SetGadgetTarget and this SendMessage stuff? <br><br></td></tr></table><br>
<a name="597521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I will post a tutorial tomorrow with a new implementation, the SetGadgetTarget command documented actually got ripped out just before release. <br><br></td></tr></table><br>
<a name="598504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Skid are you still planning a small tutorial? <br><br></td></tr></table><br>
<a name="598537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, it will help! I'm very confused at the moment... <br><br></td></tr></table><br>
<a name="598635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>My attempt at a hook example:<br><pre class=code>
Strict

Function MyEventHook:Object( id,data:Object,context:Object )

	Local ev:TEvent=TEvent(data)
	
	If ev Print "Event="+ev.ToString()
	
	Return data
	
End Function

AddHook EmitEventHook,MyEventHook

window=CreateWindow( "A window!",0,0,640,480 )

While WaitEvent()&lt;&gt;EVENT_WINDOWCLOSE
Wend
</pre><br><br>A couple of points:<br><br>* The 'MyEventHook' function is the 'hook' and gets called *every time* an event occurs (from within WaitEvent - or more precisely, WaitSystem, which is called by WaitEvent).<br><br>* Hooks should check the 'data' param to make sure it's valid. In this example it always will be, but it's a good idea in general.<br><br>* Hooks should generally return the 'data' param they are passed - this is so other hooks can look at the data too. So if you want to 'block' other hooks, return Null.<br><br>Both polled input (KeyDown, KeyHit etc) and the event queue are built on top of hooks - check out the source code to really confuse yourselves!<br><br>Why use hooks? Why not just stick with WaitEvent? Well, hooks are mainly useful for dealing with 'modal actions' - actions which involve the user holding down the mouse and doing something, like resizing a window or dragging a scroller.<br><br>When the user is performing a modal action, the OS goes into a loop and notifies your app of events via a 'callback function'. Hooks are really just a generalization of such callback functions.<br><br>BlitzPlus got around this using a complex system of mirrors and pulleys, but I was nervous about using the same trick on multiple platforms, much to skid's disappointment.<br><br>Hope this helps a bit! <br><br></td></tr></table><br>
<a name="598715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Hope this helps a bit!  <br></div><br>It certainly helped me, thanks :)<br><br>I managed to put together this test, hopefully people can get some idea from it.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

AppTitle = "Control Test"

Global Quit:Int = False
Global desk:TGadget = Desktop()

Global mainWindow:TGadget = CreateWindow("Main Window", (GadgetWidth(desk)/2) - 320,(GadgetHeight(desk)/2) - 240,640,480,Null, WINDOW_TITLEBAR | WINDOW_RESIZABLE | WINDOW_MENU | WINDOW_STATUS | WINDOW_ACCEPTFILES)
	SetMinWindowSize(mainWindow, 300,120)
	
Global testControl:TSimpleControl = CreateSimpleControl(0,0,ClientWidth(mainWindow), ClientHeight(mainWindow), mainWindow)


'MAIN
While Not Quit
	WaitEvent()
	Select EventID()
		Case EVENT_WINDOWCLOSE, EVENT_APPTERMINATE
			If Confirm("Quit the application?") Then quit = True
		Case EVENT_WINDOWMOVE
			Print "Window Moved"
		Case EVENT_APPRESUME
			Print "Resumed"
		Case EVENT_APPSUSPEND
			Print "suspend"
	End Select
Wend

End



Type TSimpleControl
	Field Canvas:TGadget
	Field X:Int
	Field Y:Int
	Field Width:Int
	Field Height:Int

	
	Method OnEvent:Object(event:TEvent)
		Select Event.ID
			Case EVENT_GADGETPAINT
				Resize() 'kludge to get around not being able to detect maximize events
				Draw()
			Case EVENT_WINDOWSIZE
				Resize()
		End Select
	End Method
	
	
	Method Draw()
		SetGraphics CanvasGraphics(Canvas)
		SetViewport 0, 0, Width, Height 'set the viewport to the control's dimensions
		SetClsColor 110,0,0
		Cls
		SetColor(0,110,0)
		DrawRect 10, 10, Width - 20, Height - 20
		SetColor(255,255,255)
		DrawText ("X: " + X + " Y: " + Y + " Width: " + Width + " Height: " + Height, 20,20)
		Flip
	End Method
	
	
	Function Create:TSimpleControl(X:Int, Y:Int, Width:Int, Height:Int, group:TGadget)
		Local tempSimpleControl:TSimpleControl = New TSimpleControl 'create a temporary version of the control
			tempSimpleControl.X = X
			tempSimpleControl.Y = Y
			tempSimpleControl.Width = Width
			tempSimpleControl.Height = Height
			tempSimpleControl.Canvas = CreateCanvas(X, Y, Width, Height, group) 'initialize the canvas field
			
			AddHook EmitEventHook, SimpleControlEventHook, tempSimpleControl 'add the function SimpleControlEventHook to the EmitEventHook
		Return tempSimpleControl
	End Function


	Function SimpleControlEventHook:Object(id:Int,data:Object,context:Object)
		'cast the context as a TSimpleControl and the pass it the data cast as a TEvent to the OnEvent method
		TSimpleControl(context).OnEvent(TEvent(data))
		Return data 'allow other event hooks to be processed
	End Function


	Method resize()
		SetGadgetLayout(canvas,1,1,1,1) 'resize the canvas to the client area's edges
		'set the new width and height so that our fields are properly updated
		Width = Canvas.Width
		Height = Canvas.Height
	End Method
	
End Type


Function CreateSimpleControl:TSimpleControl(x:Int, y:Int, w:Int, h:Int ,group:TGadget)
	Return TSimpleControl.Create(x,y,w,h,group)
End Function
</textarea> <br><br></td></tr></table><br>
<a name="599662"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wiebo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, that makes things a lot clearer. I also notice from Perturbatio's example that we no longer have to re-create a canvas when we want to resize it?? nice. It would be cool if we could compile a list of gadget-behaviour changes from b+ <br><br></td></tr></table><br>
<a name="600193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, really dumb question time.<br><br>I assume you can just use the event queue stuff (along with timers triggering custom events) even if you're not using the GUI stuff?<br><br>I'm thinking along the lines of using timers this way to trigger updating animations/scrolling, etc.  Rather than relying on the vblank for timing stuff.<br><br>Muttley <br><br></td></tr></table><br>
<a name="600268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I assume you can just use the event queue stuff (along with timers triggering custom events) even if you're not using the GUI stuff? <br></div><br>Yes, you can. <br><br></td></tr></table><br>
<a name="600338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yay!  :D<br><br>Muttley <br><br></td></tr></table><br>
<a name="678982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ziltch</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> The example that Mark posted here would be a better example to   <br>use in the help files. <br><br></td></tr></table><br>
<a name="808449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >peltazoid</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Perturbatio<br><br>your example I don't get it as from reading the code I would expect it to display the window size as you are resizing it.<br><br>When run it only updates the window sizes in the canvas when you release the mouse button! If this is how it is ment to work what it the point? As thats how the resize gadget works anyhow.<br><br>I'm trying to get my head around event hooks :D<br><br>Cheers. <br><br></td></tr></table><br>
<a name="808450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >peltazoid</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> some more eventhook questions<br><br>the hook function, when it is called by an event taking place data contains the last event data.<br><br>what does context contain?<br><br>and you only return the data from the hook function if you want another hook function to work on the same event?<br><br>I don't have time at present to test this. I may have more questions as well. :)<br><br>Cheers. <br><br></td></tr></table><br>
<a name="808593"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >assari</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have you gone thru this?<br><a href="http://www.2dgamecreators.com/maxgui/T15-Eventhooks.html" target="_blank">http://www.2dgamecreators.com/maxgui/T15-Eventhooks.html</a> <br><br></td></tr></table><br>
<a name="808691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >peltazoid</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes I have and it was very helpful but does not answer the questions above.<br><br>plus the examples on my system do not cause a trial of windows to occour in the non event hook example.<br><br>I'm running 1.24 with latest sync.<br><br>Cheers <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
