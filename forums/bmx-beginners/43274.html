<!DOCTYPE html><html lang="en" ><head ><title >flickering stuff if you dont Cls</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >flickering stuff if you dont Cls</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >flickering stuff if you dont Cls</a><br><br>
<a name="483631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have this chain simulator, which uses the usual cls+flip routine to draw the chain. If I avoid the Cls, it should leave the trace of the chain of course. however it looks that if the chain is moving fast enough, it leavesa "flickering" trace. Do you know about this-how can I fix it? <br><br></td></tr></table><br>
<a name="483633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> to guarantee removal, you would probably have to flip/draw/flip/draw then update.<br><br>*EDIT*<br>Not that I can see a reason why you would want to do this. <br><br></td></tr></table><br>
<a name="483655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can avoid it by copying the backbuffer to the frontbuffer instead of Flipping (or just write to the frontbuffer only - no Flipping or Cls).  Not sure if you can do this in Max tho. <br><br></td></tr></table><br>
<a name="483660"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> no you probably misunderstood: try running this on MAX<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">




vecchiotempo=0
cycles=0
r=1

raggiofalso=r*3

numballs=500

iteraz=200

g#=0.3


Global angle#[numballs+1]
Global rv# [numballs+1]
Global x# [numballs+1]
Global y# [numballs+1]
Global z# [numballs+1]
Global xv#[numballs+1]
Global yv#[numballs+1]
Global oldx# [numballs+1]
Global oldy#[numballs+1]
Global yspeed#[numballs+1]
Global xspeed#[numballs+1]
Global unicol[3+1]
Global col[numballs+1,3+1]
Global adder[3+1]


Global forzax1#[numballs+1]
Global forzay1#[numballs+1]
Global forzax0#[numballs+1]
Global forzay0#[numballs+1]

Global dist#[numballs+1]

Global m#[numballs+1]



For i=1 To 3
adder(i)=1
Next

For i=1To numballs

x(i)=i

For j=1 To 3
col(i,j)=Rnd(255)

Next
Next

grabbed=0
grabx#=0
graby#=0

x(1)=400
y(1)=300

xwin=640'1024
ywin=480'768

xwin=1024
ywin=768

Graphics xwin, ywin





Repeat

'Cls

For i=1 To numballs
oldx(i)=x(i)
oldy(i)=y(i)
Next 




If  MouseDown(1)&lt;&gt;1

grabbed=0
End If

If (grabbed=0) &amp; (MouseDown(1)=1)

For i=1 To numballs

If ((MouseX()&gt;x(i)) &amp; (MouseX()&lt;x(i)+2*raggiofalso)  &amp; (MouseY()&gt;y(i)) &amp; (MouseY()&lt;y(i)+2*raggiofalso)) Then
grabbed=i

grabx=MouseX()-x(i)
graby=MouseY()-y(i)


End If

Next

End If

'grabbed=1


For i=1To numballs

m(i)=1
Next

'm(numballs)=10

'm(1)=10



If (grabbed&gt;0)

m(grabbed)=1000000000


x(grabbed)=MouseX()-grabx
y(grabbed)=-graby+MouseY()
xv(grabbed)=0
yv(grabbed)=0
End If





'applica le forze alla velocita' vecchia



For i=1 To numballs


yv(i)=yv(i)+g

x(i)=x(i)+xv(i)
y(i)=y(i)+yv(i)





Next



For l=1 To iteraz'!!!!!

For i=2 To numballs



dist(i)=sqr((x(i)-x(i-1))*(x(i)-x(i-1))+(y(i)-y(i-1))*(y(i)-y(i-1)))-2*r

If (1=2)
angle(i)=ATan2(-y(i)+y(i-1),x(i)-x(i-1))
forzax1(i-1)=dist(i)/(1+m(i-1)/m(i))*Cos(angle(i))
forzay1(i-1)=-dist(i)/(1+m(i-1)/m(i))*Sin(angle(i))


forzax0(i)=-dist(i)/(1+m(i)/m(i-1))*Cos(angle(i))
forzay0(i)=dist(i)/(1+m(i)/m(i-1))*Sin(angle(i))
End If

If (1=1)
forzax1(i-1)=dist(i)/(1+m(i-1)/m(i))* ( (x(i)-x(i-1) )/ ( dist(i)+2*r ) )

forzay1(i-1)=dist(i)/(1+m(i-1)/m(i))*( (y(i)-y(i-1) )/ ( dist(i)+2*r ) )


forzax0(i)=-dist(i)/(1+m(i)/m(i-1))*( (x(i)-x(i-1) )/ ( dist(i)+2*r ) )
forzay0(i)=-dist(i)/(1+m(i)/m(i-1))*( (y(i)-y(i-1) )/ ( dist(i)+2*r ) )
End If

Next


For i=1 To numballs

x(i)=x(i)+forzax0(i)+forzax1(i)
y(i)=y(i)+forzay0(i)+forzay1(i)

Next

Next



For i=1 To numballs




xv(i)=x(i)-oldx(i)
yv(i)=y(i)-oldy(i)

If (x(i)&gt;xwin -2*r)
x(i)=xwin-2*r
xv(i)=-xv(i)
End If
If (x(i)&lt;0) 
x(i)=0
xv(i)=-xv(i)
End If
If (y(i)&gt;ywin-2*r) 
y(i)=ywin-2*r
yv(i)=-yv(i)
xv(i)=0.9*xv(i)
End If
If (y(i)&lt;0) 
y(i)=0
yv(i)=-yv(i)
End If


Next





For i=1 To 3
If (Rnd(0,1000)&gt;990)
adder(i)=-adder(i)
End If

unicol(i)=unicol(i)+adder(i)
If (unicol(i)&gt;254) Then adder(i)=-1
If (unicol(i)&lt;1) Then adder(i)=1

Next

If (1=1)
For i=1 To numballs

SetColor unicol(1),unicol(2),unicol(3)

'Color col(i,1),col(i,2),col(i,3)

DrawOval x(i),y(i),2*raggiofalso,2*raggiofalso
Next

End If

If (1=2)
For i=1 To numballs-1

SetColor unicol(1),unicol(2),unicol(3)

'Color col(i,1),col(i,2),col(i,3)

DrawLine x(i),y(i),x(i+1),y(i+1)
Next
End If

	DrawText fps+"   "+grabbed+"   "+MouseDown(1), 20, 40


FlushMem

	Flip
	
	
cycles=cycles+1
If (MilliSecs()-vecchiotempo&gt;1000)
vecchiotempo=MilliSecs()
fps=cycles
cycles=0
End If
	
		
Until KeyDown (KEY_ESCAPE)
	
End

</textarea><br><br>as you can see Cls is commented (on purpose), and the stuff flickers. why is that? (after running this version, try uncommenting Cls, you'll see that I just draw a string)<br><br>PS: you can grab the string with the mouse <br><br></td></tr></table><br>
<a name="483661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see any flicker with that code, runs as smooth as wet stuff off a smooth sloped thing. <br><br></td></tr></table><br>
<a name="483663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> then probably theres a bug, because on my computer, the lines drawn in the previous frames, that are still there since I have not called Cls, flicker a LOT.<br><br>This in the version where I DONT call Cls, while in the version where I call it, no problem <br><br></td></tr></table><br>
<a name="483667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dangerdave</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get 'flicker' as well without CLS.<br>(with CLS, it works fine.)<br><br>So Pertubatio,<br>you don't see multiple lines when it runs?<br>(don't move the mouse and let the 'chain' fall down to the bottom of the screen.<br>You don't see mulitple lines on the entire screen without CLS?<br><br><br>Hmmmm, is it another nvidia vs ati thing? <br><br></td></tr></table><br>
<a name="483670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have ATI too <br><br></td></tr></table><br>
<a name="483671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Of course I see multiple lines (as in each render displays over the top of the previous which is to be expected when you don't clear the screen), I just don't see flicker. <br><br></td></tr></table><br>
<a name="483685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep the "multiple lines" flicker on my screen, which is wierd since they arent touched by the code <br><br></td></tr></table><br>
<a name="483688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, *major* flickering -- as if only displayed every other frame (ATI Radeon 9600Pro).<br><br>It looks like the screen is in interlace mode or something, except the line that got added in the last update doesn't flicker.<br><br>Noticed the same thing with my own programs too -- unless I either do a CLS or redraw the entire screen each frame, things will flicker tremendously.<br><br>Is there any way around this and 'reuse' the scame screenbuffer without needed to redraw everything all over again, but not run into this flicker issue?<br><br>Is this a bug? If so, it would be <b>extremely</b> helpful if it can be remedied.<br><br>I was doing some timing tests last night, and unfortunately noticed that I don't have much 'spare' graphics power -- if I increase the number of drawing operations per frame to about twice as many as I'm using now in a game I'm working on (I'll need some more for other operations), my framerate drops from 75 to ~30 on my Athlon 2500+ (using onboard video)<br><br>I would love to be able to cut down on the number of redraws necesary by not having to update unchanged portions of the screen... <br><br></td></tr></table><br>
<a name="483705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think there needs to be a single buffered full screen mode, I assume windowed mode is not affected? <br><br></td></tr></table><br>
<a name="483720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I assume windowed mode is not affected? <br></div><br><br>Correct. I just tried that, and in windowed mode there is no flickering, just fullscreen mode.<br><br>If I add a 'delay 100' after the flip command to see things in 'slow motion', windowed and non-windowed mode do behave differently. In windowed mode, the 'old' lines appear completely static. In full-screen mode, the background lines appear to be in continual motion, like a large color-cycled animation.<br><br>It appears that it is alternating between two different backbuffers, each of which gets copied to the front in turn.<br><br>If there is no delay, this causes flickering since 'old' information is only redrawn every second frame.<br><br>A good example is the following:<br><br><pre class=code>
Graphics 800,600,32,60
test=LoadImage ("test.jpg")

DrawImage (test,0,0)
WaitKey()
Flip
WaitKey()
Flip
WaitKey()
Flip
WaitKey()
Flip
WaitKey()
Flip
</pre><br>In windowed mode, this code shows the image continuously. In full screen mode, the screen changes between the image and a blank screen each time I press a key.<br><br>Definitely different behaviour on windowed vs. fullscreen -- is this a bug, or by design?<br><br>Some people claimed not to see any flickering in the original sample -- do they see the image disappear in full screen mode when they run the example code above? <br><br></td></tr></table><br>
<a name="483729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> After the first 'waitkey' the image is displayed constantly. This is my laptop with S3 SuperGraphics.<br>Running in both windowed and fullscreen shows the same. <br>The rope didn't flicker either. I have a PC with 9800 Pro which I can try later. <br><br></td></tr></table><br>
<a name="483820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could it be that BMax is forced to use the FrontBuffer when using windowed mode?<br>Or that the gfx card doesn't allow double buffering while in windowed mode, so that the frontbuffer and the backbuffer are actually "merged".<br><br>Using the first code example:<br>In windowed mode, the vertical space between the red lines (that are drawn first) is small, while in fullscreen mode the spacing is much bigger (if you take one frame only).<br><br>In fullscreen mode, If I would take 2 successive frames and merge them in a paint program, I would get the same result as only 1 frame in windowed mode.<br><br>So it appears that the front and backbuffer are merged on my system somehow, when using windowed mode.<br>But I cannot tell if the fault lies within BMax, or my gfx card or windows.<br><br>I didn't check the entire code, but if you're drawing only one line per game loop, it appears that, while it keeps the current frontbuffer, you're drawing one line to the backbuffer and that "flip" pastes the backbuffer over the frontbuffer, ignoring the black color (background) when using windowed mode.<br>So that it just adds the last line to the frontbuffer, instead of overwriting the entire buffer.<br><br>I hope this makes any sense. <br><br></td></tr></table><br>
<a name="483835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> In windowed mode there is still double buffering, but as you say, so long as it is supported which isn't necessarily the case. One way to know is to draw several things to the backbuffer and if they show up without a Flip there is no double buffering.<br><br>Also I agree, in double-buffering, if you are going to leave permanent results you have to draw everything to both buffers. <br><br></td></tr></table><br>
<a name="483837"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perhaps you have activated tripple buffering in your graphic drivers. But I don't think this should lead to this type of problems as DX supports flipchains with far more "backbuffers" than only one.<br><br>perhaps your gpu or their opengl drivers? <br><br></td></tr></table><br>
<a name="483848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah it looks that there is a triple buffering going on.<br><br>dont bother with my example its overly complex, stick with xlsior's, its much more to the point<br> <br><div class="quote"> I was doing some timing tests last night, and unfortunately noticed that I don't have much 'spare' graphics power -- if I increase the number of drawing operations per frame to about twice as many as I'm using now in a game I'm working on (I'll need some more for other operations), my framerate drops from 75 to ~30 on my Athlon 2500+ (using onboard video)  <br></div><br>be sure you are not using any math operations, particularly avoid "^" (but you can use x*x and sqrt(x)), that slowed my chain code 15 times<br><br>PS: how do you call window mode (in the windows beta)? <br><br></td></tr></table><br>
<a name="483850"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used this code:<br><pre class=code>
Graphics 800,600,0
test1 = LoadImage("test1.jpg")
test2 = LoadImage("test2.jpg")
test3 = LoadImage("test3.jpg")
test4 = LoadImage("test4.jpg")



DrawImage(test1, 0, 0)
DrawImage(test2, 100, 100)

WaitKey()
Flip

WaitKey()
DrawImage(test3, 200, 200)
WaitKey()
Flip
WaitKey()
DrawImage(test4, 300, 300)

WaitKey()
Flip

WaitKey()
Flip

WaitKey()
Flip
</pre><br>When the program halts on the first WaitKey(), it shows nothing.<br>Then a Flip comes (when I press a button), then it shows the first 2 images.<br>This is correct for now.<br><br>Now it waits execution on the second WaitKey().<br>After a button-press, it still shows the first 2 images.<br>At the next Flip (another button-press), the third picture (that was drawn to the backbuffer), is simply added to the frontbuffer, while keeping the first 2 images.<br><br>Now it takes another 2 button-presses to add the fourth image to the frontbuffer.<br><br>So it really appears that the backbuffer is pasted onto the frontbuffer when a Flip is executed, ignoring the background color.<br><br>Really weird. <br><br></td></tr></table><br>
<a name="483863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess that's ok: you are using window mode, and that one works. (You are not calling cls, so all the images are still there)<br><br>try this:<br><br><pre class=code>
Graphics 800,600
DrawOval 100, 100,30,30
Flip 
WaitKey() 
DrawOval 200, 200,30,30
Flip 
WaitKey() 
Flip 
WaitKey() 
Flip 
WaitKey() 
</pre><br><br>It shows that when you draw something, then flip, then  draw something else, it uses a different backbuffer to draw on, and alternates in flipping the 2 backbuffers on the screen. <br><br></td></tr></table><br>
<a name="483883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It shows that when you draw something, then flip, then draw something else, it uses a different backbuffer to draw on, and alternates in flipping the 2 backbuffers on the screen. <br></div><br><br>Yup, same thing I'm seeing. One oval, jumping around.<br><br>Clearly does show that it alternates between two backbuffers... Of course the real question is whether or not this is something that can be fixed, especially it if only applies to 'some' video cards...<br><br>But definitely something that needs to be addressed or at least people should be aware of, of code that may 'look fine' on a developers PC might be an epileptic-inducing nightmare on someone elses machine. <br><br></td></tr></table><br>
<a name="483887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've tried this on my ATI 9800 Pro @ 4.11 (6490) and there doesn't appear to be any flicker. <br><br></td></tr></table><br>
<a name="483904"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> In fullscreen mode, the 2 ovals are jumping around, but when using windowed mode (add ",0" to the graphics command), the first one stays into view.<br>The second one is just "added" to the frontbuffer. <br><br></td></tr></table><br>
<a name="483907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Graphics 800,600,0
DrawOval 100, 100,30,30
Flip 
WaitKey() 
DrawOval 200, 200,30,30
Flip 
WaitKey() 
Flip 
WaitKey() 
Flip 
WaitKey() 
</pre><br>results in...<br>the first oval being drawn, <br>press a key, <br>the second oval is drawn, <br>press a key, <br>both ovals drawn, <br>press a key, <br>both ovals are drawn. <br><br></td></tr></table><br>
<a name="483919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah thats what it SHOULD do, the problems are in fullscreen mode. <br><br></td></tr></table><br>
<a name="483991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blimey, this is like Groundhog Day...<br><pre class=code>
Graphics 800,600
DrawOval 100, 100,30,30
Flip 
WaitKey() 
DrawOval 200, 200,30,30
Flip 
WaitKey() 
Flip 
WaitKey() 
Flip 
WaitKey() 
</pre><br>results in...<br>the first oval being drawn, <br>press a key, <br>the second oval is drawn, <br>press a key, <br>both ovals drawn, <br>press a key, <br>both ovals are drawn. <br>(i.e. the same results windowed or fullscreen) <br><br></td></tr></table><br>
<a name="484012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tony, we are saying that on SOME computers (e.g. mine and xlsior's) there is this problem in FULLSCREEN mode. On some others (like yours) theres no problem, and in both window mode and fullscreen mode the right thing happens (what you described). <br><br></td></tr></table><br>
<a name="484030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>Najdorf, what machine are you using?<br><br>(ps: It's very useful for this sort of thing for people to include their system configurations in their sigs). <br><br></td></tr></table><br>
<a name="484049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> â€¢ Sony Vaio PCG-K33<br>â€¢ Processor<br>Mobile IntelÂ® PentiumÂ® 4 Processor 532 (3.06GHz, 1MB L2 Cache)1<br>â€¢ Operating System<br>MicrosoftÂ® WindowsÂ® XP Professional Edition<br>â€¢ Front Side Bus Speed<br>533MHz<br>â€¢ Chipset<br>ATI Radeonâ„¢ IGP 345M<br>â€¢ Integrated Wireless LAN<br>IEEE 802.11b/g2<br>â€¢ LCD<br>15.4â€? WXGA with XBRITEâ„¢ technology (1280x800)3<br>â€¢ Hard Drive<br>60GB (4200rpm)4<br>â€¢ Memory<br>512MB5 PC-2100 266MHz DDR (256MB x 2)(Expandable to 1GB Maximum)<br>â€¢ Graphics<br>ATI Radeonâ„¢ IGP 345M 64MB Video RAM (shared w/ Main Memory)<br>â€¢ Graphics Interface<br>VGA out<br><br><br>A very brief review of what happens follows:<br><br>If I run this code<br><br><pre class=code>
Graphics 800,600
DrawOval 100, 100,30,30
Flip 
WaitKey() 
DrawOval 200, 200,30,30
Flip 
WaitKey() 
Flip 
WaitKey() 
Flip 
WaitKey() 
</pre><br><br>it draws the first  circle, then the second one but the first one disappears (although I didnt call Cls),  then every time I "flip" one circle disappears and the other one reappears, as if it was drawing on 2 different backbuffers and displaying them alternatively.<br><br>Happens only in fullscreen mode.<br><br>Happens also to xlsior, PowerPC603 and (maybe) dangerdave <br><br></td></tr></table><br>
<a name="484065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Emmett</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Same results as Najdorf in fullscreen mode only.<br>1st flip - oval 1 only<br>2nd flip - oval 2 only<br>3rd flip - oval 1 only<br>4th flip - oval 2 only <br><br></td></tr></table><br>
<a name="484301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PowerPC603</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this code:<br><pre class=code>
Graphics 800,600

DrawOval 100, 100,30,30
Flip 
WaitKey() 

DrawOval 200, 200,30,30
Flip 
WaitKey() 

DrawOval 300, 300,30,30
Flip 
WaitKey() 

Flip 
WaitKey() 

Flip 
WaitKey()

Flip 
WaitKey() 
</pre><br>The first time, you will see the first oval.<br>The second time you will see the second one.<br>The third time, you will see the first one and the third one.<br>The fourth time you will see the second one.<br><br>When using windowed mode, each time there's an oval added to the frontbuffer.<br><br>The fullscreen mode behaviour should be happening in both cases, to my opinion.<br><br>Before the first flip, you draw an oval to the first backbuffer, which flips into view at the first flip.<br>Then the second oval is drawn to the second backbuffer (which was previously the frontbuffer) and flips into view at the second flip.<br>Now the first backbuffer is used again to add the third oval to it.<br>Flip it into view, and you see the first and third oval.<br>Another flip will flip the second backbuffer into view, which had only the second oval drawn onto it.<br><br>This is what should be happening in both cases, AFAIK. <br><br></td></tr></table><br>
<a name="484302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do people want to start adding their machine specs as Mark suggested? <br><br></td></tr></table><br>
<a name="485009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >{cYan|de}</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> thats not exactly the best way ive ever seen of drawing chain lol o_O <br><br></td></tr></table><br>
<a name="495117"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting --<br><br>As mentioned above, some video cards (including mine)appear to be alternating between *two* backbuffers instead of using just one, resulting in flickering on those systems if you draw some background items just once. (See the example of the moving ovals above)<br><br>Now, on my own computer I could address this flicker issue by drawing a (static) background twice, flipping after each draw, so both backbuffers ended up with a copy, and then leave it alone from that point forward -- the result was a stable picture, no flicker.<br><br>Now, theorethically this (drawing twice) should be stable on both systems using one, and two backbuffers...<br><br>Unfortunately I ran into another exception:<br><br>This ran OK on both my own system (which uses two backbuffers), my secondary computer (which seems to use one), but when I tested it on a 3rd machine (2.7 GHz E-Machine, some integrated onboard video controller) it was still flickering like crazy.<br><br>Now, this is very weird...<br><br>I'm not doing anything special on certain frames, each loop the exact same graphic draw functions are called. All pure blitz, no direct OpenGL stuff.<br><br>The only things I can think of: <br><br>- Maybe it uses two backbuffers, one of which automatically erases itself? (possibly a driver bug/feature?)<br><br>- Maybe it uses more than two backbuffers? (A bit unlikely I think, especially since the flickering looks like it drops every other frame. If it would draw 2/3 or so, it should appear less transparent, more 'solid'.<br><br>Hopefully I can figure out what video chipset it's using, that info that may lead to some more pointers... In the meantime, this is a bit of an unfortunate turn of events since it appears that I still can't count on graphics remaining on the screen even after drawing them twice...<br><br>It looks like I may have to look into adding a 'compatibility mode' to the game I'm working on: Give the choice betweeb drawing just twice (faster), or draw the full background each frame.<br><br>Unfortunately doing so gives me about 3/4 of the framerate I can get without redrawing the background, which can be significant on a mid range computer system<br><br>No idea how widespread of an issue this is though, maybe/hopefully it's just an isolated issue.<br><br>I also vaguely remember reading something about how some OpenGL cards never save the backbuffer information, en always require a full redraw... Is this true, or am I imagining things? :-) <br><br></td></tr></table><br>
<a name="495124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've found this for those people with ATI (like me)<br><br>Right click desktop<br>Click Properties<br>&gt;Advanced<br>&gt;3D<br>&gt;OpenGL<br>&gt;Compatibility<br><br>from here you can enable/disable triplebuffering.<br><br>Disabled = flicker<br>Enabled = No flicker. <br><br></td></tr></table><br>
<a name="495269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup, confirmed the problem:<br><br>On the e-Machine, I need to draw and flip to the backbuffer <b>three</b> times for it to be stable, otherwise it will flicker. It appears to rotate through three seperate backbuffers. (Quad-buffering?) The video adapter in question identifies itself as an 'Intel(R)  82845G/GL/GE/PE/GV Graphics Controller'<br><br>So... That's 4 machines I've tested on so far, and those included a system with one backbuffer, 2 systems with two backbuffers, and a system with three backbuffers.<br><br><i>Is there any way for a program to find out in advance how many backbuffers a card is using, so I can use the appropriate drawing routines for the system in question?</i><br><br>Many of the blitzmax samples I've seen come by in the past all appear to assume the single backbuffer, which are bound to run into problems with flickering on many computer systems once they start hitting the big masses... <br><br></td></tr></table><br>
<a name="495276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >teamonkey</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> From another thread:<br><br>The contents of a backbuffer is undefined after a Flip. It might be black, it might be left untouched or it might be full of whatever temporary data the card's decided to store in it after the Flip. You can't assume that it will keep the contents of the last draw cycle.<br><br>This is standard OpenGL behaviour. your graphics card could use single buffering, double buffering, triple buffering or something completely off the wall. If you want to keep the previous frame you should copy it to an ofscreen buffer somewhere. <br><br></td></tr></table><br>
<a name="495328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The contents of a backbuffer is undefined after a Flip. It might be black, it might be left untouched or it might be full of whatever temporary data the card's decided to store in it after the Flip. You can't assume that it will keep the contents of the last draw cycle.  <br></div><br><br>This is something that <i>really</i> should be in the docs, since it's pretty essential info and is far from obvious on many systems... And looking at many code examples posted on these forums over time, many people do assume that the contents will remain.<br><br>Anyway, that means I'll have to default to redrawing everything each frame then, if that's the only way to know for sure the contents will be there.<br><br>I guess I can build in some user-configurable settings where the user can turn off the full redraw to get a framerate boost, with a chance of it inducing flickering (or black background) on certain systems. Perhaps monitor the FPS, and only bring up the option if it looks like framerate might be an issue. <br><br></td></tr></table><br>
<a name="495410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >teamonkey</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's something that trips up loads of people coming from a software rendering background. I know it certainly tripped me up.<br><br>I can't quite remember how I got around it, but I think I used glCopyPixels, glDrawBuffer and glReadBuffer to copy the contents of one frame to an offscreen area of video memory and back. <br><br></td></tr></table><br>
<a name="495419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, in my current project the static background in question affects only about 20% of my screen, drawn as a border around a playing field...<br><br>So, considering the info above, I've made some changes to my drawing routines. I ended up just redrawing the border itself, after chopping up all four borders into several animimages sized in varying 'power-of-2' chunks as not to have too much overhead.<br><br>One strip of 64x64 pixel tiles on the top of the screen, another 32x32 pixel strip on top as well, and some 32x32 strips for the sides and bottom of the screen.<br><br>I did some tests, and found that it draws all those individual tiles in much less time than it would take to redraw the entire 800x600 background as a whole in one pass. I'll probably do some other tests to see if different subdivisions are more or less efficient.<br><br>As far as openGL textures/images are concerned: I read that internally it uses power-of-two sized textures to store them -- but does anyone know if these are stored as squares, or can they also be used as rectangles on all cards?<br>e.g. is 512x128 a valid size on all video cards, or would some of them store it as 512x512 internally? <br><br></td></tr></table><br>
<a name="495813"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >teamonkey</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> As far as openGL textures/images are concerned: I read that internally it uses power-of-two sized textures to store them -- but does anyone know if these are stored as squares, or can they also be used as rectangles on all cards? <br></div><br>Rectangles are fine, so 512x128 is a valid texture size on any OpenGL card. <br><br></td></tr></table><br>
<a name="495823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Rectangles are fine, so 512x128 is a valid texture size on any OpenGL card.  <br></div><br><br>Thanks, I ended up going with that rather than the smaller tiles for a convenience sake, although I didn't see any speed difference between using these larger textures and the tiny versions, as long as the dimensions were both in power-of-2 ranges. <br><br></td></tr></table><br>
<a name="532926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >McFox</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmpf this problem is very annoying...<br>Can it be corrected (so, is it just a bug ?)<br>That's strange... windowed mode has no problem... why the buffers are managed differently in fullscreen ? :/ <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
