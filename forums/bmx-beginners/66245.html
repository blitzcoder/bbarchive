<!DOCTYPE html><html lang="en" ><head ><title >Pixmaps - never used one before</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Pixmaps - never used one before</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Pixmaps - never used one before</a><br><br>
<a name="740167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzMax doesn't do a good job of differentiating between using images and pixmaps.<br><br>In this scenario, I need to read the color of pixel x,y on my 800x600x32 .png background image<br><br>So, looking through all the BMax commands, I assume I use LoadPixMap instead of LoadImage then use ReadPixel to find the colour ?<br><br>Is this correct ? <br><br></td></tr></table><br>
<a name="740208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you already have the image loaded, you can convert it to a pixmap with LockImage, I think. I don't use Max2D, but that's what the docs suggest. If you you don't have the image loaded already then yes, LoadPixmap. <br><br></td></tr></table><br>
<a name="740247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabriel is correct.  Use LockImage to allow pixel operations on an image.  When you're done, use UnlockImage.  I think the two commands basically move the image from VRAM into RAM and vice-versa.<br><br>If you need to do this sort of thing in real time you may need to think of an alternative way of achieving whatever it is you need to achieve, as this can be relatively slow - especially on large images. <br><br></td></tr></table><br>
<a name="740273"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actualy UnlockImage does nothing. The transfer is done on next DrawImage..<br><br>But id still use UnlockImage, cuz you never know when it WILL do something ;) <br><br></td></tr></table><br>
<a name="740309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Question: Assuming I use LoadPixMap do I still have to lock / unlock in order to ReadPixel ?<br><br>JazzieB, can you suggest alternatives, if this really is as slow as you say ? All I need is to determine the colour of a pixel on an offscreen image at position x,y ? I need to do this 4 times per frame. <br><br></td></tr></table><br>
<a name="740336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alternatives: No, readpixel is only possible on pixmaps.<br>Possibility which I don't see as alternative but the RAM intensive way: Make own sprite objects (class) which holds the image and pixmap reference. That way you can read from the pixmap but draw the image. Whenever you update the pixmap, just use obj.thatImage = loadimage(obj.thatPixmap) (or similar) to update the image data. <br><br></td></tr></table><br>
<a name="740353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> In this scenario, I need to read the color of pixel x,y on my 800x600x32 .png background image <br></div>If this was because they clicked rectangle which is a certain colour, your Rectangle type could contain a colour field. then when they click the mouse, you work out which rectangle is clicked via the coords (and see which is uppermost if they overlap) and then when you know which one, simply read the colour field.  No Pixmaps involved :-) <br><br></td></tr></table><br>
<a name="740404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Question: Assuming I use LoadPixMap do I still have to lock / unlock in order to ReadPixel ?<br><br>JazzieB, can you suggest alternatives, if this really is as slow as you say ? All I need is to determine the colour of a pixel on an offscreen image at position x,y ? I need to do this 4 times per frame. <br></div><br><br>If the image is never drawn (as your comment would seem to suggest) then you can load the image as a Pixmap, and therefore in RAM, and do your check as you are currently doing so.  4 times per frame is not much at all, especially if this is all you're doing and the image is stopping in normal RAM.  It would be a problem if it were an image that is being drawn, as then the image would need to be continually swapped between normal and video RAM.<br><br>I don't think that you would need to use LockImage on a Pixmap, although I haven't checked this.<br><br>As for alternative ways of doing things without using ReadPixel, that would depend on why you are doing these checks in the first place, so making suggestions right now would be difficult - although a couple have been mentioned above. <br><br></td></tr></table><br>
<a name="740408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I don't think that you would need to use LockImage on a Pixmap, although I haven't checked this. <br></div>You can't LockImage a PixMap. LockImage takes a TImage as a parameter, not pixmap. Besides which getting a TPixmaps related TPixmap, seems somewhat redundant. <br><br></td></tr></table><br>
<a name="740557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all.<br><br>JazzieB appears to have answered my question.<br><br>And yes, I can confirm the pixmap never gets drawn to the screen or modified in any way. Its a monochrome image used for sprite &gt; background collision detection. <br><br></td></tr></table><br>
<a name="740559"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Dax &gt;&gt; You could always use an array to do that <br><br></td></tr></table><br>
<a name="740583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> MadMax, the background image is very irregularly shaped eg. can't be saved as a series of collision rectangles.<br><br>So does that rule out what you mean ? <br><br></td></tr></table><br>
<a name="740599"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't looked into them, but I would assume that pixmaps are basically just a block of memory and a pointer to it. So they're more or less arrays anyway. <br><br></td></tr></table><br>
<a name="740656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to do the following:<br><br>Put my 800x600 png into a collision layer using the collideImage command<br><br>check my sprite for collision with background image by doing a<br><br>if collideImage...?<br><br>If this is possible, I presume I can put my 800x600 collision image into the collision layer once before my main loop (eg. I don't have to keep putting it there every frame as the background never changes) ? <br><br></td></tr></table><br>
<a name="740671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MadMax</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well you just need a 2-dimensional array, in your case<br>collision_map[800,600]<br><br>Then if you want you can create a small routine to read the png into the array.<br><br>In my "mutant turmites" post I use an array to check the background, it's easy to use and I'm quite sure it's faster and easier than this pixmax business. <br><br></td></tr></table><br>
<a name="740674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> MadMax,<br><br>Ah, sounds good - my game uses very little RAM, and I suppose a nice simple array would be very processor friendly ;-)<br><br>Gawd, I've juse found another collision function called ImagesCollide now!! Don't get me wrong I love BMax, but the docs are a PAIN!! <br><br></td></tr></table><br>
<a name="740705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Put my 800x600 png into a collision layer using the collideImage command<br><br>check my sprite for collision with background image by doing a<br><br>if collideImage...? <br></div>Not quite. But if you seperate your bsackground image into the seperate collision zones, and draw those instead that should work. <br><br></td></tr></table><br>
<a name="740783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dax Trajero</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all.<br><br>Flameduck - now I've found the command, it would seem imagescollide could also be of use. <br><br>But, because the BMax docs are so vague, I'm going to have to mock up examples using each technique and see whats best. Any pointers ? (pardon the pun)<br><br>Is it possible to put a non-monochrome image into an array, where each pixel is an RGBA value eg. FF001100 from the 800x600 .png ? <br><br></td></tr></table><br>
<a name="741014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Assaris tutorials are great to understande the collision system and its unique capabilities. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
