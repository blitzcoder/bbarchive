<!DOCTYPE html><html lang="en" ><head ><title >Linux V4L2 (webcam) access kinda working.. Help!</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Linux V4L2 (webcam) access kinda working.. Help!</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Linux V4L2 (webcam) access kinda working.. Help!</a><br><br>
<a name="1031988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jondecker76</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello<br><br>It has been several years since I've used BlitzMax. Recently, I wanted to get re-acquainted with the language.  I wanted to do some stuff with my webcam on linux.  I found an old post where there was indeed a webcam module for linux written, but it was so old it no longer worked (it used the original v4l API)<br><br>So far, I have quickly whipped together some code to access 4vl2 devices on a linux system. I am able to open the device and receive images!  The problem now lies somewhere in the color pallet.  On my webcam (Logitech Quickcam Pro 9000 using the UVC driver), the image is only returned in yuyv format, and of course I need to convert it to RGB. Does anyone have any experience in this type of conversion?<br><br><br><br>This is my first attempt to import c code into BMX, so please be easy on me :)<br><br>thanks all <br><br></td></tr></table><br>
<a name="1031997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jondecker76</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe some pictures would help....<br><br>I will show how the screenshots look using both PF_RGB888 and PF_RGBA8888.  Also, I used ClearPixels(255) so that the size of the intended pixmap will be shown colored.<br><br><br>In this first screenshot, i used PF_RGB888 with CreatePixMap()...  As you can see, the image kind of repeats over its self a few times, and obviously isn't the correct size...<br><img src="http://i229.photobucket.com/albums/ee95/jondecker76/BlitzMax/PF_RGB888.png"><br>The returned image seems to be 2/3 the size of the full image. Since the PF_RGB888 is 24 bits, it would seem to indicate that the v4l2 is returning an image that is just 2 bytes per pixel??<br><br><br>in this second screenshot, I used PF_RGBA8888 with CreatePixMap()..  As you can see this time, the image shows up repeating again (though not overlapping) in a funky color... Not the correct size either...<br><img src="http://i229.photobucket.com/albums/ee95/jondecker76/BlitzMax/PF_RGBA8888.png"><br>The return image seems to be 1/2 the size of the full image. Since the PF_RGBA8888 is 32 bits, it would also seem to indicate that v4l2 is returning an image that is just 2  bytes per pixel.  I'm not aware of any pixel format that uses 2 bytes per pixel, so if anyone has any ideas, it would greatly help!<br><br><br><br>Edit: Thank you to the moderator that edited the post to show me how to include my images! <br><br></td></tr></table><br>
<a name="1032182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jondecker76</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nevermind, I finally got it working.<br>I added a new function in c code to convert from YUYV 4:2:2 to RGB24 into a new buffer, and now its works beautifully! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
