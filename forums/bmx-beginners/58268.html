<!DOCTYPE html><html lang="en" ><head ><title >Main game loop measure = 10 ms</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Main game loop measure = 10 ms</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Main game loop measure = 10 ms</a><br><br>
<a name="648092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi !<br><br>for my 2d space game<br><br>i've measured my main game loop time. i've max 10 ms on my machine  (time ellapsed between the cls, and just after the flip, all displayed at screen)  FPS is fixed to 60. Is it good performance ? <br><br>Thanks !<br><br>My config : ATI Radeon 9200 series (128Mo), AMD2600+<br><br><img src="http://www.bayre.com/zigwigwis/capt_400.jpg"> <br><br></td></tr></table><br>
<a name="648155"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1000/60 is 16.67 - so yes, at 10ms your code is adequately fast. <br><br></td></tr></table><br>
<a name="648169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> ....for his machine.  So I'd say it's too slow, imagine it on a 1GHz PC, it would run at half the frame rate. <br><br></td></tr></table><br>
<a name="648471"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd say the graphics card affects the speed a game runs more than the speed of the processor.  That's a fairly average card he's got there so 10ms is probably about right.  I'd say about 80-90% of the total time taken between Flips (including logic) is rendering.<br><br>To gauge true performance, hub, you need to include the time taken by the logic as well.  Using my estimations, this should take the time up to no more than 12ms, which is still  enough to maintain 60FPS.<br><br>I tested this game on my iBook, which has a 1.3Ghz processor and a Radeon Mobility 9550 with 32MB VRAM and it ran just fine.  It goes without saying that it's also very smooth on my PC, but then I have a relatively high spec PC. <br><br></td></tr></table><br>
<a name="648484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for your answers.<br>i report the time after the 'flip command. Don't know if it measure the 'flip'.<br><br>pseudo code :<br><br>While<br>cls &lt;- start measure<br>compute all<br>&lt; -- display previous time here. <br>Flip<br>&lt;--- stop measure<br><br>Wend <br><br></td></tr></table><br>
<a name="648521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> stop the measure before flip unless you use flip 0 to disable the VSync. <br><br></td></tr></table><br>
<a name="648547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> As Dreamora says, you have to measure from when you start your main game loop to just before the Flip to determine how fast your game loop is, so that it includes both logic and render times.  If you include the Flip you will always get the length of a single frame, i.e. 1/60th second if your game is syncing to 60 FPS (unless of course, you're not syncing with your monitor, or your loop is longer than one frame). <br><br></td></tr></table><br>
<a name="648659"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> i use flip 0. i don't know why but it works better with this. <br><br></td></tr></table><br>
<a name="648661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> i use this code <br><br><pre class=code>
	Graphics 1024,768,32, 75

	Const CTE_LIMITATION_FPS# = 60.0
	
	Local FPS_fps:Float = CTE_LIMITATION_FPS
	Local FPS_time:Float = 1000 / FPS_fps
	Local FPS_timer:Float = MilliSecs() + FPS_time	
	Local FPS_ms:Float
	
	Local Loop_Time : Float
	Local Computed_Loop_Time : Float	
	
	While (...)
	
	    FPS_ms = MilliSecs()
	    
		If (FPS_ms &gt;= FPS_timer) Then

	    	FPS_timer = FPS_ms + FPS_time

			' code principal
			
			Cls
			
			Loop_Time = MilliSecs()			
			
			.... game code
			
			
			If bAfficherGC Then
				DrawText "GC=" + String(GCMemAlloced()), 0, GraphicsHeight() -30
				DrawText "Boucle=" + String (Computed_Loop_Time) + " ms",0, GraphicsHeight() -60
			End If			
									
			Flip 0
			
			Computed_Loop_Time = MilliSecs() - Loop_Time			
			
	    EndIf
								
	Wend			
</pre> <br><br></td></tr></table><br>
<a name="648663"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> note that i've developped the game without know something about delta timing. So it seems difficult to add this to my game now... i've some difficulties exactly to know how to update my code ! <br><br></td></tr></table><br>
<a name="649485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ashmantle</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its not really that much of a rewrite. Just add Deltatime code into the loop and multiply everything that moves with your delta variable.<br><br>instead of : player.x = player.x + Speed<br>you write  : player.x = player.x + (Speed * delta)<br><br>erm.. its been a long time since I've coded.. someone correct me :D <br><br></td></tr></table><br>
<a name="649555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good mainloop :-) You are one of the few that understood the need of timed screen refreshes to push the mainloop runs worlds higher and allow a real AI, smoother effects etc :-) (330 fps with always flip 0 to 500k-1500k with fixed 60 FPS through timed updating ;-) ) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
