<!DOCTYPE html><html lang="en" ><head ><title >BlitzMax FTP and small files</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BlitzMax FTP and small files</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >BlitzMax FTP and small files</a><br><br>
<a name="867098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hezkore</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm trying to make my program to automatically download a few files from my FTP using some code I found in the Code Archives (http://www.blitzmax.com/codearcs/codearcs.php?code=2090)<br><br>It seems to work, I can download MP3 and images and everything, but if the file is small, like a TXT file... the file just shows up empty.<br>Any ideas what's causing it? <br><br></td></tr></table><br>
<a name="867111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might need to post some code (sans-username/password), it'll make helping you easier. <br><br></td></tr></table><br>
<a name="867143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dirk Krause</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> One possible explanation is that the file doesn't exist on the server. Then the program fails, probably unnoticed (check the last line of the output) and leaves an empty file. <br><br></td></tr></table><br>
<a name="867245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> One possible explanation is that the file doesn't exist on the server.  <br></div><br><br>Or perhaps that you don't have permissions to access it <br><br></td></tr></table><br>
<a name="867254"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabhand</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could always use Wininet:-<br><br><a href="http://msdn2.microsoft.com/en-us/library/aa385483.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/aa385483.aspx</a><br><br>Baring in mind, its a windows only affair! This works really well with other Blitz languages, but havent tried using it in max yet. <br><br></td></tr></table><br>
<a name="867835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hezkore</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The code I'm using is exactly what is found in the code archive: <a href="http://www.blitzmax.com/codearcs/codearcs.php?code=2090" target="_blank">http://www.blitzmax.com/codearcs/codearcs.php?code=2090</a><br><br>Doing all the stuff that comes with the code (renaming, download MP3 etc.) works fine, small files is the only problem.<br>If I make a TXT file and write "Hello" in it and download it with BlitzMax I just get an empty file, but I can download it with any other FTP client just fine! but if I spam the TXT with "Hello" a million times making the file larger, it works with both the BlitzMax code and a normal client.<br>And it shouldn't be a permission problem or anything like that... The server itself is working fine and doesn't accept anonymous connections, so I know the login part works.<br>And the file does exist, I've created 3 files to test with Test.Mp3, Test.Png and Test.Txt they're all placed in the same place and accessed by the same user, the MP3 and PNG works fine with BlitzMax, It's just the small TXT that's the problem. I've tried making the PNG smaller and the same problem happens there, if the file is too small it will just be downloaded as an empty file.<br>There are no errors in either the Client or Server, in fact... the server tells me the file was fully downloaded!<br>And I'd like this to work on both Mac and PC. <br><br></td></tr></table><br>
<a name="867852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could be an issue with CopyStream()...<br><br>DebugStop/Log might be your friend here.<br><br>Otherwise, there are probably modules available which are designed to take the stress out of doing things like this :-) <br><br></td></tr></table><br>
<a name="867883"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see a CloseStream(Filestream) in the getDataAsFile() function.  My guess is that small files are being buffered, and then lost when the Function ends.  Technically, CloseStream should be implicitly called when FileStream loses scope, but you might want to go ahead and place an explicit CloseStream() after the CopyStream() to flush the buffer and write the contents to the HD. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
