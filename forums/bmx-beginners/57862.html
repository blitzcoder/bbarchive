<!DOCTYPE html><html lang="en" ><head ><title >Hertz and Flip</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Hertz and Flip</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Hertz and Flip</a><br><br>
<a name="643586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry if this has been asked before...<br><br>To me it seems great that I can make a full-screen action game and fix it to 60Hz and thus not bother with delta timing due to different PCs having different refresh rates.  This also means I can have totally smooth scrolling and movement.  Is setting at 60Hz not recommended though?  How reliable is it on a wide range of PCs?  Any known issues?<br><br>I realise that if I made a game with a windowed mode, that windowed mode would run at whatever frequency the desktop wsa set to, and thus delta timing is required.<br><br>OK, Flip, seems there are 3 options and the default is -1, so a standard graphics window with flip at 60Hz then? What are the advantages of 0 and 1, why would I want to use them?  Which is best on most hardware and doesn't cause any tearing or weird artifacts?<br><br>Also, whilst I'm at it, can someone explain the difference between GLGraphicsDriver, GLMax2DDriver and D3D7Max2DDriver to a noob?  Thanks in advance! :-) <br><br></td></tr></table><br>
<a name="643618"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't see how you *can* "not bother with delta timing". If I disable VSync in my drivers ( as some people do ) then there's nothing you can do to make the game play at 60hz on my machine, is there? <br><br></td></tr></table><br>
<a name="643626"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't bother with delta timing. I use fixed rate logic. It works on slow and fast pcs. <br><br></td></tr></table><br>
<a name="643630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Sorry if this has been asked before...<br><br>To me it seems great that I can make a full-screen action game and fix it to 60Hz and thus not bother with delta timing due to different PCs having different refresh rates. This also means I can have totally smooth scrolling and movement. Is setting at 60Hz not recommended though? How reliable is it on a wide range of PCs? Any known issues? <br></div><br><br>On my previous PC I had all my refreshrates fixed at 100Hz -- since my old trinitron worked great at 100 and 120Hz, but made a really high-pitched whining noise at any refreshrate lower than that. The rest of the family couldn't hear it, but I could tell hear it squeal from the other side of the house myself. Extremely annoying.<br>Anyway, to address that issue, I installed a monitor driver that told my system that the only refreshrate supported in any video mode was 100Hz -- other video modes simply weren't available.<br><br>Maybe a bit unique of a setup, but it does go to show that you can't <i>count</i> on 60Hz being universally available.<br><br>Now, before artificially locking it to 100Hz, 60Hz technically worked, but due to those squealing noises it made it unbearable to actually play anything in that mode. <br><br></td></tr></table><br>
<a name="643652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought I read *somewhere* that Max attempts to keep the Vsync to the Hz specified in Graphics (by using timing methods), even if the machine has Vsync Disabled or is running at a different refresh rate.  Anyone else hear this?<br><br>One Eyed Jack: What's Fixed rate timing?  Is it like the "retro 64" method which I currently used?<br><br>xlsior: so you are saying that even if you specify 60Hz in Max, your fresh rate is still 100Hz?  Have you tried setting it to 60Hz with graphics and then using flip -1 and then measuring the FPS.  Would it be 100 or 60 I wonder? <br><br></td></tr></table><br>
<a name="643661"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> FPS and refresh rate are independent!<br><br>flip -1 says the grahpics card not to wait for the LCD/TFT to finish updating. In that case, you will get the maximum fps your card can generate.<br><br>If you do flip true then it will run on the screens maximum.<br><br>I don't use herzt on my system at all as it is not really able to get the herzt of 60hz notebook displays at all.<br><br>Beside that: This is completely useless to make stuff on the same speed anywhere. The graphic card defines the fps in the ned, not the TFT. The TFT only says how many different pictures you can get in maximum <br><br></td></tr></table><br>
<a name="643690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, I'm not sure I got that.  The manual says <div class="quote"> If sync is -1 and the current graphics object was created with the Graphics command, then flips will occur at the graphics object's refresh rate - regardless of whether or not the graphics hardware supports such a refresh rate. <br></div> so I don't see how this would result in the "maximum".  Maybe flip 0 would. <br><br></td></tr></table><br>
<a name="643691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I believe the new Flip works like so...<br><br>Flip -1 = SOFTSYNC<br>Flip 1 = HARDSYNC<br>Flip 0 = NOSYNC <br><br></td></tr></table><br>
<a name="643695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah I get that thanks.  What I originally asked was:<br><br><div class="quote"> What are the advantages of 0 and 1, why would I want to use them? Which is best on most hardware and doesn't cause any tearing or weird artifacts? <br></div><br>Although I assume -1 is the best otherwise it wouldn't be default right?  Speaking of defaults, the graphics command has a default of 60Hz too, if this was so bad, why is it the default?  I'm just wondering if it's viable to make a 60Hz full-screen arcade game that will run on almost all systems fine.<br><br>this thread seems to just be opening up more questions than it closes! <br><br></td></tr></table><br>
<a name="643708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> yeah I get that thanks. <br></div>You clearly don't. ;o)<br><br><div class="quote"> so you are saying that even if you specify 60Hz in Max, your fresh rate is still 100Hz? Have you tried setting it to 60Hz with graphics and then using flip -1 and then measuring the FPS. Would it be 100 or 60 I wonder? <br></div>It should be 60...<br><br><pre class=code>Strict

Graphics 800, 600, 32, 15

Local x#, y#
Local xv# = Rnd(-4, 4), yv# = Rnd(-4, 4)
Local flipVar = -1
Local refreshRate = GetDeviceCaps(GetDC(PrimaryDevice.hWnd), VREFRESH)

Repeat
	x# :+ xv#
	If (x# &lt; 0) Or (x# &gt; 799)
		xv# = -xv#
		x# :+ xv#
	EndIf 
	
	y# :+ yv#
	If (y# &lt; 0) Or (y# &gt; 599)
		yv# = -yv#
		y# :+ yv#
	EndIf
	
	If KeyHit(KEY_SPACE)
		flipVar :+ 1
		If flipVar &gt; 1 Then flipVar = -1
	EndIf
	
	Cls
	DrawOval x# - 15, y# - 15, 30, 30
	
	DrawText "Flip = " + flipVar, 12, 12
	DrawText "Screen Refresh = " + refreshRate, 12, 24
	
	Flip flipVar
Until KeyHit(KEY_ESCAPE)

End</pre> <br><br></td></tr></table><br>
<a name="643715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ian: yeah sorry that question was Aimed at Xlsior who said he had his monitor fixed at 100Hz.  However you demo does show me something.  With Flipvar -1, the animation is clearly at 15Hz and my refresh is 85.  With 0, it's at full speed, and with 1, it's very smooth thus must be at 85.<br><br>So basically if you call graphics at 60Hz and use Flip -1, if the user's refresh rate is 60, they'll get a nice smooth game, and if it's different from 60, BlitzMax will still keep the Flips occuring every 60 so the gameplay will be the same speed, just not "smooth" looking due to the discrepancy between refresh rate and the 60Hz flipping that Blitz is trying to do for you independant of the refresh rate.  Does this sound correct now? <br><br></td></tr></table><br>
<a name="643729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aye!...Hence, Softsync...I probably should have made that clearer in my previous post. :o)<br><br>I used 15Hz in the demo to guarantee that it wouldn't be available and to make the difference between softsync and hardsync obvious.<br><br>The situation should be exactly the same for xlsior. He would see a 60Hz/FPS update with a 100Hz screen refresh. <br><br></td></tr></table><br>
<a name="643747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's great thanks ian.  Clears that one up at least.  Now for the other questions ... <br><br></td></tr></table><br>
<a name="643780"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm by no means an expert on this stuff but from previous threads on this, I understand that:<br><br>The smoothest method is to use a hertz value of -1 (should be default refresh at that screen res) and use a fixed logic loop, as you've been doing, with flip 1. <br><br>Delta timing with flip 0 will give you the most control over the widest range of hardware but can look a bit juddery on occasions and can suffer from tearing.<br><br>Relying on a 60hz softsync can lead to screen flicker or juddery graphics too.<br><br>So, I'd suggest you search the forums and make your own mind up as to which method to use.<br><br><br><br>AFAIK, GlGraphics and DXGraphics handle the low level screen and window set up for the relative API.<br><br>GLMax2dDriver and D3D7Max2DDriver handle all the high level Max2D graphics stuff, Drawtext, DrawImage, etc. <br><br></td></tr></table><br>
<a name="643789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, so just call Graphics 800,600,32,-1 so it runs at the native Hz for that monitor and then Flip 1 means it VSync's with the refreshrate(Hz).  Then a fixed logic loop to control the game speed.  Means scrolling and animation won't be perfectly smooth, but pretty good.  Oh well, I was just trying to figure out if I could reach my holy grail of choosing a 60Hz display and syncing the gamplay to it for perfectly smooth scrolling/animation like the old Amiga days.  I bet this would for *most* people, just not everyone sigh ...<br><br>Thanks for the info Ian. <br><br></td></tr></table><br>
<a name="643978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> so you are saying that even if you specify 60Hz in Max, your fresh rate is still 100Hz? Have you tried setting it to 60Hz with graphics and then using flip -1 and then measuring the FPS. Would it be 100 or 60 I wonder?  <br></div><br><br>Not sure, don't have that graphics card &amp; monitor anymore, so don't have those drivers set up.<br><br>It would stay at a 100Hz sync all the time, the OSD display would confirm that refresh rate... I got an LCD before I had BMax, so that issue kind of went away before I started playing with its screen updates.<br><br>I would assume that it simply wouldn't list any &lt;100Hz mode under GetGraphicsModes... <br><br></td></tr></table><br>
<a name="645320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlackSp1der</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey, can you explain how the retro64 method works? <br><br></td></tr></table><br>
<a name="645340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> This thread and article describes it well.<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=57977" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=57977</a><br><br>here's mine from Easter Bonus (Blitz Plus):<br><br><pre class=code>
	;timing vars
	Global LastTime%
	Global NumTicks#
	Global LastNumTicks#

Function InitTimingVars()
	;set a first value for LastTime (it will be used in the main loop)
	LastTime = MilliSecs()/MS
	NumTicks = 0
	LastNumTicks = 1	
End Function

	InitTimingVars()
	
	Repeat
		If DoVWait Then
			;for our purposes, a tick is based on FRAMERATE
			;get in the time and make sure at least 1 tick expired
			Repeat
				TmpMS = MilliSecs()/MS
		
				;little sanity check here in case the timer flips back to 0 :)
				If TmpMS &lt; LastTime Then LastTime = TmpMS - LastNumTicks
		
				NumTicks = TmpMS - LastTime
			Until NumTicks &gt; 0
			LastTime = TmpMS
			;account for when the user alt-tabs :)
			;If NumTicks &gt; 500 Then NumTicks = LastNumTicks
			If NumTicks &gt; 50 Then NumTicks = 50 ;LastNumTicks ;Laptop runs at 7 in windowed mode
			LastNumTicks = NumTicks		
			If NumTicks &gt; MaxTicks Then MaxTicks = NumTicks
		EndIf
		
		;now we do the logic loop ... from 1 not 0!
		;don't do ticks as it @#!*s things up
		For i = 1 To NumTicks

                     ;logic
                Next

                DrawStuff()
                Flip
	Until LoopExit &lt;&gt; 0
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
