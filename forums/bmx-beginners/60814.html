<!DOCTYPE html><html lang="en" ><head ><title >Is there a func. to find if a point is in a rect?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is there a func. to find if a point is in a rect?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Is there a func. to find if a point is in a rect?</a><br><br>
<a name="678598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know its easy to code, just wondering if its already in there. <br><br></td></tr></table><br>
<a name="678608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope <br><br></td></tr></table><br>
<a name="678613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> this one doesn't use the x,y,w,h style but the x1,y1,x2,y2 style..<br><br><pre class=code>
Function InBox:Int(x:Int,y:Int,x1:Int,y1:Int,x2:Int,y2:Int)
	If x&gt;=x1 And x&lt;=x2 And y&gt;=y1 And y&lt;=y2 Return 1 Else Return 0
End Function
</pre> <br><br></td></tr></table><br>
<a name="678648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I made my own, which is almost the same, mine is signed as a byte and returns true or false, which i find more convenient when reading code <br><br></td></tr></table><br>
<a name="678654"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> mine is signed as a byte <br></div><br><br>Byte types are slower than ints, if you plan on using it regularly in your game, you might want to consider adding an extra few bytes to your game's memory overhead by using Ints. <br><br></td></tr></table><br>
<a name="678666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really? Dang i have lots of code to change, im used to using bytes. I guess i can just search/replace byte by int. and i can still use true/false, right? <br><br></td></tr></table><br>
<a name="678683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kronholm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes <br><br></td></tr></table><br>
<a name="678709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leo Santos</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey! Speaking about it...<br>If I have a field that can have only two states,(like true/false) is :INT really the BEST type to use?... isn't there something like a "boolean" type? (I looked in the docs, and didn't find anything).<br><br>I'm asking because I'm trying to keep the memory usage as low as possible... Yeah, I know, that's so Old School... :-)<br><br>Thanks! <br><br></td></tr></table><br>
<a name="678717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dunno, test it.. benchmark!<br><br>But seriously.. memory? byte vs int differs 3 bytes per instance of that variable. In these days.. does it really matter? Typical shop-pc's come with 256mb, but most likely with 512mb mem, and some even with 1gb!<br><br>After all, we aren't using a z80 here with only 64kb to adress without bankswitching. :P <br><br></td></tr></table><br>
<a name="678752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> No there isn't anything like a boolean type and Int is definitely the best way to go (highest optimised type as current OS are 32Bit and int is faster than float) <br><br></td></tr></table><br>
<a name="678754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> While talking bytes and ints, is ReadByte from a bank also slower than ReadInt? I can imagine mass-storage of bytes in a bank, while doing the math using ints.. <br><br></td></tr></table><br>
<a name="678758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> 64kb was loads.<br><br>I would recomend wrapping an Int, as a type Bool, cos then you get the benifits of a different type, yet the speed/size of an int <br><br></td></tr></table><br>
<a name="678855"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just invented this:<br><br><pre class=code>
Function InRect:Int(X:Int,Y:Int,X1PlusHalfWidth:Int,Y1PlusHalfHeight:Int,HalfWidth:Int,HalfHeight:Int)
   If Abs(X-X1PlusHalfWidth)&lt;HalfWidth and Abs(Y-Y1PlusHalfHeight)&lt;HalfHeight Then Return True Else Return False
End Function
</pre><br>I think it should work. No idea if it's faster or not, I am thinking it should be.<br><br>Requires the width and height of your rectangle to be even numbers if you want accuracy, otherwise may be 1 pixel off.<br><br>X1PlusHalfHeight is X1 (left edge of rect) plus half the width of the rect.<br>Y1PlusHalfHeight is Y1 (top edge of rect) plus half the height of the rect.<br>Of course HalfWidth is the width of the rect/2, and HalfHeight is half the height /2.<br><br>Maybe you can pass the parameters in an array or embedded in longs or as offsets in a bank or something, to speed it up a bit more.<br><br>Also if your collision rectangle is a perfect square, you can do this:<br><pre class=code>
Function InSquare:Int(X:Int,Y:Int,X1PlusHalfSize:Int,Y1PlusHalfSize:Int,HalfSize:Int)
   If Abs(X-X1PlusHalfSize)&lt;HalfSize and Abs(Y-Y1PlusHalfSize)&lt;HalfSize Then Return True Else Return False
End Function
</pre> <br><br></td></tr></table><br>
<a name="678866"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I fail to see how it would be faster unless you already store half width/heights and x + halfwidth etc... the fact you have to compute it to pass it to function costs more, doesnt it? <br><br></td></tr></table><br>
<a name="678871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> You know you don't have to use any if's, you can just return the result. Like this:<pre class=code>Strict

Function RectsIntersect:Int(ax:Int,ay:Int,aw:Int,ah:Int,bx:Int,by:Int,bw:Int,bh:Int)

	Return (ax &lt; (bx + bw)) &amp; (ay &lt; (by + bh)) &amp; ((ax + aw) &gt; bx) &amp; ((ay + ah) &gt; by)

End Function

Function PointInRect:Int(x:Int,y:Int,bx:Int,by:Int,bw:Int,bh:Int)

	Return (x &lt; (bx + bw)) &amp; (y &lt; (by + bh)) &amp; (x &gt; bx) &amp; (y &gt; by)

End Function


'
' Beautiful test!
'

Graphics 640,480,0,0

Local x0:Int = 100
Local y0:Int = 100
Local w0:Int = 200
Local h0:Int = 150

Local x1:Int = Rand(0,540)
Local y1:Int = Rand(0,380)
Local w1:Int = 100
Local h1:Int = 100

Local sx:Int = 1
Local sy:Int = 1

Local x2:Int = MouseX()
Local y2:Int = MouseY()

While Not (KeyHit(KEY_ESCAPE) Or AppTerminate())

	x1:+sx
	y1:+sy
	
	If x1+w1&gt;640 Then sx = -1
	If x1&lt;0		 Then sx = 1
	If y1+h1&gt;480 Then sy = -1
	If y1&lt;0		 Then sy = 1

	x2 = MouseX()
	y2 = MouseY()

	Cls

	SetColor 255,0,0
	DrawRect x0,y0,w0,h0
	
	SetColor 0,255,0
	DrawRect x1,y1,w1,h1

	SetColor 255,255,0
	Plot x2,y2

	SetColor 255,255,255
	If RectsIntersect(x0,y0,w0,h0,x1,y1,w1,h1)
		DrawText "RectsIntersect",0,0
	EndIf
	If PointInRect(x2,y2,x0,y0,w0,h0)
		DrawText "PointInRect",0,20
	EndIf
	
	Flip	

Wend</pre>That's about as fast as it gets. <br><br></td></tr></table><br>
<a name="678900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice fredborg, I did wonder if you could just return a value instead of doing an If.<br><br><pre class=code>
Function InRect:Int(X:Int,Y:Int,X1PlusHalfWidth:Int,Y1PlusHalfHeight:Int,HalfWidth:Int,HalfHeight:Int)
   Return (Abs(X-X1PlusHalfWidth)&lt;HalfWidth) &amp; (Abs(Y-Y1PlusHalfHeight)&lt;HalfHeight)
End Function
</pre><br>Might be a bit faster. If for some reason you know that a big group of rects will be a given size you could just hardcode it for that size rather than passing variables.<br><br>As to your question Smurf, you'd have to have your four variables precomputed in some kind of array or something. If you need them to be dynamic in realtime then do some other method, so you can move the rects, then just do:<br><pre class=code>
Function InRect:Int(X:Int,Y:Int,X1:Int,Y1:Int,HalfWidth:Int,HalfHeight:Int)
   Return (Abs(X-(X1+HalfWidth))&lt;HalfWidth) &amp; (Abs(Y-(Y1+HalfHeight))&lt;HalfHeight)
End Function
</pre><br>I'm gunna have to test this fredborg to see which is faster ;-D <br><br></td></tr></table><br>
<a name="678952"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did a speed comparison between my final InRect() function (the flexible one), and fredborg's code.<br><br>Fredborg your code took 4518 millisecs to do 10 million calls. My code took 4662. Yours is very slightly faster. Not all the time though. Sometimes I got better numbers on mine, not sure why.<br><br>My fixed-position code is about 4620 - getting closer. Strangely my square routine is a bit slower than my rect one. lol<br><br>But anyway, yes, Fredborg, congrats, your routine is actually the fastest so far (just ;-D)<br><br>Although THIS:<br><pre class=code>
Function PointInRect:Int(x:Int,y:Int,bx:Int,by:Int,bx2:Int,by2:Int)

        Return (x &lt; bx2) &amp; (y &lt; by2) &amp; (x &gt; bx) &amp; (y &gt; by)

End Function
</pre><br><br>should be faster still. (It is, 4543 millisecs :-)<br><br>Interestingly &gt;= and &lt;= are slower than &gt; and &lt;. <br><br></td></tr></table><br>
<a name="678954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> :)<br><br>I guess by passing all the parameters as variable pointers you could speed it up ever so slightly. Otherwise every parameter is recreated as a local variable to the function, which is probably not healthy for the cpu. Try this:<pre class=code>Function RectsIntersect:Int(ax:Int Var,ay:Int Var,aw:Int Var,ah:Int Var,bx:Int Var,by:Int Var,bw:Int Var,bh:Int Var)

	Return (ax &lt; (bx + bw)) &amp; (ay &lt; (by + bh)) &amp; ((ax + aw) &gt; bx) &amp; ((ay + ah) &gt; by)

End Function

Function PointInRect:Int(x:Int Var,y:Int Var,bx:Int Var,by:Int Var,bw:Int Var,bh:Int Var)

	Return (x &lt; (bx + bw)) &amp; (y &lt; (by + bh)) &amp; (x &gt; bx) &amp; (y &gt; by)

End Function</pre>Actually, just tested it, and it seems like that was a false statement... On my machine it is ever so slightly slower.<br><br>It does however seem that logical and (And) is faster than  binary and (&amp;), so try replacing those :) <br><br></td></tr></table><br>
<a name="678977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> plus its faster if you dont use a width,height, but use an x2,y2 instead because you can remove the adds. <br><br></td></tr></table><br>
<a name="679084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would use an early out test, should be faster on average depending on how large the Rect is compared to the screen res.<br><br><pre class=code>
Function InRect:Int(x:Int,y:Int,x1:Int,y1:Int,x2:Int,y2:Int)
	If x1&gt;x Return False
	If x2&lt;x Return False
	If y1&gt;y Return False
	If y2&lt;y Return False
	Return True
End Function
</pre> <br><br></td></tr></table><br>
<a name="679091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shagwana</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not strickly bmax, but heres my fastest one for bb3d -&gt; <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=118" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=118</a><br><br>Im sure that converted to bmax would be fast :) <br><br></td></tr></table><br>
<a name="679106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yepp seems so :-)<br><br><br><pre class=code>Strict
Function DetectPointInsideRect(iPointX:Int,iPointY:Int,iXPos1:Int,iYPos1:Int,iXPos2:Int,iYPos2:Int)
	Return ((((iPointX-iXPos1) ~ (iPointX-iXPos2)) &amp; ((iPointY-iYPos1) ~ (iPointY-iYPos2))) &amp; $80000000)
End Function 

Function PointInRect:Int(x:Int,y:Int,bx:Int,by:Int,bw:Int,bh:Int)

	Return (x &lt; (bx + bw)) &amp;(y &lt; (by + bh)) &amp;(x &gt; bx) And (y &gt; by)

End Function


Graphics 640,480,0,0

Local x0:Int = 100
Local y0:Int = 100
Local w0:Int = 200
Local h0:Int = 150


Local x1:Int = x0+w0
Local y1:Int = y0+h0
Local w1:Int = 100
Local h1:Int = 100

Local sx:Int = 1
Local sy:Int = 1

Local x2:Int = Rand(0,639)
Local y2:Int = Rand(0,479)

Local t1:Int = MilliSecs()
For Local i = 1 To 10000000
	x2 = Rand(0,639)
	y2 = Rand(0,479)
	PointInRect(x2,y2,x0,y0,w0,h0)
Next

t1	= MilliSecs() - t1

Local t2:Int = MilliSecs()
For Local i = 1 To 10000000
	x2 = Rand(0,639)
	y2 = Rand(0,479)
	DetectPointInsideRect(x2,y2,x0,y0,x1,y1)
Next

t2	= MilliSecs() - t2

Print "Fredborg: " + t1
Print "Shagwana: " + t2</pre><br><br><br>Fredborg: 4205<br>Shagwana: 4178<br><br><br>What I have not tested thought is if the result is correct.<br>And fredborg: On my system, &amp; is faster than and ... <br><br></td></tr></table><br>
<a name="679123"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I find it interesting that these functions aren't really all that much different in speed. I think there must be a lot of overhead with the function call itself, passing of parameters, and the return of data.<br><br>To be honest, this one-liner piece of code is something that I would inline into my overall program, rather than having a whole function call wrapped around it. I bet that's a lot faster. <br><br></td></tr></table><br>
<a name="679135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> All these kinda practical and handy small functions should have been in the default bmax commandset, imho.. <br><br></td></tr></table><br>
<a name="679159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Angel: That indeed is an idea ... inline ... ;-)<br><br>Result: MingW 5 just is too optimized *hehe*<br><br><br><pre class=code>
Strict
Import "inrect.c"
Extern
	Function PointInRect:Int(x:Int,y:Int,bx:Int,by:Int,bw:Int,bh:Int)
	Function DetectPointInsideRect:Int(iPointX:Int,iPointY:Int,iXPos1:Int,iYPos1:Int,iXPos2:Int,iYPos2:Int)
End Extern

Function DetectPointInsideRect1(iPointX:Int,iPointY:Int,iXPos1:Int,iYPos1:Int,iXPos2:Int,iYPos2:Int)
	Return ((((iPointX-iXPos1) ~ (iPointX-iXPos2)) &amp; ((iPointY-iYPos1) ~ (iPointY-iYPos2))) &amp; $80000000)
End Function 


Function PointInRect1:Int(x:Int,y:Int,bx:Int,by:Int,bw:Int,bh:Int)

	Return (x &lt; (bx + bw)) &amp; (y &lt; (by + bh)) &amp; (x &gt; bx) &amp; (y &gt; by)

End Function




Local x0:Int = 100
Local y0:Int = 100
Local w0:Int = 200
Local h0:Int = 150


Local x1:Int = x0+w0
Local y1:Int = y0+h0
Local w1:Int = 100
Local h1:Int = 100

Local sx:Int = 1
Local sy:Int = 1

Local x2:Int = Rand(0,639)
Local y2:Int = Rand(0,479)

Local t1:Int = MilliSecs()
For Local i = 1 To 10000000
	x2 = Rand(0,639)
	y2 = Rand(0,479)
	PointInRect1(x2,y2,x0,y0,w0,h0)
Next

t1	= MilliSecs() - t1

Local t2:Int = MilliSecs()
For Local i = 1 To 10000000
	x2 = Rand(0,639)
	y2 = Rand(0,479)
	PointInRect(x2,y2,x0,y0,w0,h0)
Next

t2	= MilliSecs() - t2


Local t3:Int = MilliSecs()
For Local i = 1 To 10000000
	x2 = Rand(0,639)
	y2 = Rand(0,479)
	DetectPointInsideRect(x2,y2,x0,y0,x1,y1)
Next

t3	= MilliSecs() - t3

Local t4:Int = MilliSecs()
For Local i = 1 To 10000000
	x2 = Rand(0,639)
	y2 = Rand(0,479)
	DetectPointInsideRect1(x2,y2,x0,y0,x1,y1)
Next

t4	= MilliSecs() - t4

Print "Fredborg BM: " + t1
Print "Fredborg Inline: " + t1
Print "Shagwana Inline: " + t3
Print "Shagwana BM: " + t4</pre><br><br>with inrect.c<br><pre class=code>
inline int DetectPointInsideRect(int iPointX,int iPointY,int iXPos1,int iYPos1,int iXPos2,int iYPos2)
{
	return ((((iPointX-iXPos1) ^ (iPointX-iXPos2)) &amp; ((iPointY-iYPos1) ^ (iPointY-iYPos2))) &amp; 0x80000000);
}

inline int PointInRect(int x, int y, int bx, int by, int bw, int bh)
{
	return (x &lt; (bx + bw)) &amp; (y &lt; (by + bh)) &amp; (x &gt; bx) &amp; (y &gt; by);
}
</pre><br><br>Gives the results:<br><br>Fredborg BM: 4103<br>Fredborg Inline: 4103<br>Shagwana Inline: 4070<br>Shagwana BM: 4081<br><br>This means around 0.0004081 ms per function call.<br>Don't know, how fast can a 1.5 Ghz P-M Banias be?<br><br>But I might try it again when my new system arives which has a far better math unit (Banias were the first P-M with not a that good math unit - my new system is a 2Ghz Core Duo ... 150-200% as fast ... per core) <br><br></td></tr></table><br>
<a name="679169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very interesting thread. Fun to see the different solutions to such a small problem <br><br></td></tr></table><br>
<a name="679182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is cool figuring out optimizations, like the old days when it actually mattered to get things to be as fast and efficient as possible. People these days are spoilt and lazy ;-)<br><br>Jokin'.<br><br><br>How fast is Shambler's early-out code? <br><br></td></tr></table><br>
<a name="679265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Problem ist, most old optimations are useless today.<br>I spend 2 hours on searching different sqr optimations. Result: Even mingW 3.1 has a default sqr functionality that is faster *lol* Haven't tested with MingW 5 yet, but would assume that it is even faster<br><br><br>The early out is slower against all 4 tests I did above (200ms+)... That has to do with the fact that BM does early out as well.<br>if the (a and b and c) sees that a is false it returns false and does not parse further. As it does return true if (a or b or c) with a true. <br><br></td></tr></table><br>
<a name="679299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Haramanai</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just for the record guys.<br>I don't wand to sound like a bad guy but...<br>Collision detection it's really old and this kind of thing you are trying to do it's point in an AABB.<br>What is AABB?<br>axis aligned bounding box<br>What is this?<br>It's a box that have it's edges alinged to the axis of the coordinates space.<br>So this box never rotate and blah blah blah...<br>I just wanted to say this cause if you really wand to learn stuf like this you must know what you are searching for. And for collision detection, AABB it's the best place to start with. <br><br></td></tr></table><br>
<a name="679301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> ... which is a bit overkill if you just want to check if your mouse pointer is within a particular rectangular area. <br><br></td></tr></table><br>
<a name="679303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Haramanai</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes for sure. But the best answer for speed was posted in the third post by CS_TBL . If you wand speed and you have static boxies you better store the points of the boxies.<br>Another thing it's that sometime it's better to use circle. <br>Why? it's really faster. You have to change only one point per loop. If you have stored the square radius you way off for speed even for an old commondore. <br><br></td></tr></table><br>
<a name="679305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Another thing it's that sometime it's better to use circle.  <br></div><br>Afaik, that's what this thread has been about since the original post was answered.<br>How about providing some code so it can be stuck into the benchmark test?<br>The quickest I've found is just to move the function into the mainloop code (think somebody else mentioned it before). <br><br></td></tr></table><br>
<a name="679310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Haramanai</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well just a rough code of what i remember so don't shoot me.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function TestCircleCircle:Int( C1posX:Float , C1PosY:Float , C1Radius:Float , C2posX:Float , C2PosY:Float , C2Radius:Float)
	Local rx:Float = c1PosX - c2PosX
	Local ry:Float = c1PosY - c2PosY
	Local rRadius:Float = (c1Radius + c2Radius)
	rRadius :* rRadius
	Return rx * rx + ry * ry &lt;= rRadius
End Function

Function TestPointCircle:Int(cPosX:Float , cPosY:Float , cSqrRadius:Float , pPosX:Float , pPosY:Float)
	Local rx:Float = cPosX - pPosX
	Local ry:Float = cPosY - pPosY
	Return rx*rx + ry*ry &lt;= cSqrRadius
End Function

	

Local c1posX:Float
Local c1posY:Float
Local c1Radius:Float = 30
Local c1sqrRadius:Float = c1Radius * c1Radius

Local c2posX:Float
Local c2posY:Float
Local c2Radius:Float = 50
Local c2sqrRadius:Float = c2Radius * c2Radius

Graphics 640 , 480
While Not KeyDown(KEY_ESCAPE)
	Cls

	If MouseDown(1)
		c1PosX = MouseX() ; c1PosY = MouseY()
	End If
	If MouseDown(2)
		c2PosX = MouseX() ; c2PosY = MouseY()
	End If

	SetColor 255 , 0 , 0	
	DrawOval c1posX - c1Radius , c1PosY - c1Radius , c1Radius * 2 , c1Radius * 2
	SetColor 0 , 255 , 0
	DrawOval c2posX - c2Radius , c2PosY - c2Radius , c2Radius * 2 , c2Radius * 2
	SetColor 255 , 255 , 255
	DrawText TestCircleCircle( C1posX , c1PosY , c1Radius , c2posX , c2PosY , c2Radius) , 10 , 10
	DrawText TestPointCircle(C1posX , c1PosY , c1SqrRadius , MouseX() , MouseY()) , 10 , 30
	Flip
Wend
</textarea><br><br>I may be wrong about the speed... I am waiting for your tests. <br><br></td></tr></table><br>
<a name="679311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm, I wasn't sure I understood what you meant in the first place. <br>Testing circle/circle or point/circle isn't the same as point/rectangle so I'm not sure how they're to be compared.<br>Not sure what tests you're expecting me to carry out but taking the function code and placing it in the 'mainloop' speeds things up quite dramatically as per AngelDaniel's suggestion. <br><br></td></tr></table><br>
<a name="679367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure what you were saying about collision detection being `really old`. I don't see that it's aged at all. It's still needed now as much as it ever was. <br><br></td></tr></table><br>
<a name="679433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Haramanai</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> What  I wanted to say is that you were trying to solve an old problem and that was point in an AABB. and you had a topic without even talking about it. Someone who may want to search and read about similar things will be more lucky if he search for: AABB collision detection.<br><br>AngelDaniel saying that something it's old does not mean that it's out of use. Means that you can find information if you find the right direction. And this is what I tryed to say. <br><br></td></tr></table><br>
<a name="679495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Old can imply out of use, which it did, and not many people will know of the term AABB, only those who already know about it, and they probably don't need this thread. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
