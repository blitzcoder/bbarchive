<!DOCTYPE html><html lang="en" ><head ><title >How to do windowed mode AND limit the framerate?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to do windowed mode AND limit the framerate?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >How to do windowed mode AND limit the framerate?</a><br><br>
<a name="1042934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Crinkle</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok so i can see there is a handy little refresh rate variable now in the graphics command, but in order to get window mode you have to set this refresh rate (which is basically an fps_limiter) to 0, so theres no limit (no no, no no no no!) <br><br>so how can one stop ones program from doing as mine is and rendering between 30 and 522fps and seeming to be idling at 522fps and maxing out refreshes at a certain speed? <br><br></td></tr></table><br>
<a name="1042953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you turn off vsync then the refresh rate won't limit the fps. Generally speaking, you don't care about the drawing rate but only the update rate. If you want 20 updates per second that's 50 ms between updates. Keep track of the last time you updated and then check the current Millisecs(). If 50 or more ms has passed then reset the last update time and now run your update function. Run a draw each loop regardless.<br><br>If you look at the doc for flip you can put 1 or 0 on the end and one these may limit your fps, so check that out. <br><br></td></tr></table><br>
<a name="1042983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could also look into writing your game logic for variable timing with a tween value, or another method, so it can run above, or bellow your target frame rate and it will just make it smoother (or blockier if slower) but ins will perform at the same real world speed regardless... Can be a hassle to go back and add that in however if you're far along in development. <br><br></td></tr></table><br>
<a name="1043022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://gafferongames.com/game-physics/fix-your-timestep/" target="_blank">http://gafferongames.com/game-physics/fix-your-timestep/</a> <br><br></td></tr></table><br>
<a name="1043032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Crinkle</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh thanks for that, i found an ideal fix!<br><br>Local Lmt_FPS=60<br>Local Lmt_Frametime=1000/Lmt_Fps<br>Local Lmt_Frame_begin<br><br>[Main loop begins]<br><br>    	Lmt_Frame_begin=MilliSecs()<br><br>        [Rest of code]<br>        [Flip]<br><br>	If (MilliSecs()-Lmt_Frame_begin)&lt;Lmt_Frametime<br>		Delay Lmt_Frametime-(MilliSecs()-Lmt_frame_begin)<br>	EndIf<br><br>[End Main Loop]<br><br>The above seems to work, and locks it down, however for some reason its at 63fps in my program, never mind though, its close enough for government work! <br><br></td></tr></table><br>
<a name="1043037"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1000/60 = 16<br><br>60*16 &lt; 1000 by 2.5*16<br><br>Fps 63 <br><br></td></tr></table><br>
<a name="1043041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Crinkle</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> What?? :s <br><br></td></tr></table><br>
<a name="1043094"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> He means that you're using integer maths, but 1000/60 = 16.67<br><br>Do yourself a huge favour and start using SuperStrict right now.  You'll thank yourself later.<br><br>To apply to your own code:<br><br><pre class=code>
SuperStrict

Local Lmt_FPS:Float=60.0
Local Lmt_Frametime:Float=1000.0/Lmt_Fps
Local Lmt_Frame_begin:Float

[Main loop begins]

Lmt_Frame_begin=MilliSecs()

[Rest of code]
[Flip]

If (MilliSecs()-Lmt_Frame_begin)&lt;Lmt_Frametime
Delay Lmt_Frametime-(MilliSecs()-Lmt_frame_begin)
EndIf

[End Main Loop]
</pre> <br><br></td></tr></table><br>
<a name="1043096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you just want to limit it without doing all the time step stuff, you can do a:<br><br>Graphics 800,600,0,60<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="1043101"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Crinkle</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll stay away from superstrict i dont know what it is supposed to do but it seems to make every line an error message!<br><br>jkrankie- i found that out yeah, first used a 0 for the refresh but that makes things go stupidly fast! :p <br><br></td></tr></table><br>
<a name="1043105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does SetGraphicsDriver have a software refresh rate? (You gotta use it with Flip -1 also) <br><br></td></tr></table><br>
<a name="1043113"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'll stay away from superstrict i dont know what it is supposed to do but it seems to make every line an error message! <br></div>Because they contain errors! You need to declare each variable <i>before</i> you use it, and also the <i>type</i> of variable.<br><br><pre class=code>image = LoadImage("me.png")
DrawImage image 5, 5</pre>WRONG.<br><pre class=code>Local image:TImage = LoadImage("me.png")
DrawImage image 5, 5</pre><br>Correct.<br><br>Code with SuperStrict is faster and contains less bugs. It's off by default to make BlitzMax "easier" to learn, but this was a very bad decision by the powers above! The time it will take fixing your code is worth it. You can also use Strict as an alternative which means you don't need to specify the types of Ints (detected automatically) but still must the rest. As you've discovered, take special care when dividing with integers.<br><br>Local Lmt_FPS=60 change this to Const Lmt_FPS=60. It's a minor change but constants are a tiny bit faster.<br><br>As I stated in my first post, you need to worry about how often the game is updated a second, and not the number of times it is drawn. If you update the game and draw the game once per loop, then somebody with a higher refresh rate is going to run your game ridiculously fast. You need to make the number of updates (to player position, bullet position etc) distinct from drawing. So on 60fps you might have 1 update every 2 frames. On 120fps you would have 1 update every 4 frames. On 30fps (slower computer) you would update every frame. Then your game runs at the same speed on any computer.<br><br><div class="quote"> its close enough for government work!  <br></div>What does this mean?? <br><br></td></tr></table><br>
<a name="1043124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Crinkle</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> do you mean if i use superstrict command then there will be a big performance increase regardless of what hardwar an end user has in their PC? I dont see the point if its only going to be 1 or 2 frames per second but maybe for 10 or so i'd reconsider. <br><br>If it just means trolling through more errors for things that are just "bad programming" i can live with that. It's hard enough as is so if things can be got just to work i'll be happy at the moment.<br><br>Also, what does it matter what a persons refresh rate on their pc is? If i set the delay in the main loop then the WHOLE program is only going to update once per frame which is controlled by a framerate limiter? <br><br></td></tr></table><br>
<a name="1043125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'll stay away from superstrict i dont know what it is supposed to do but it seems to make every line an error message! <br></div><br>LOL, that's the best line of the year! <br><br>My experience with vsync is that even if its on and your doing flip(1) or flip(-1). when you move the mouse, the Vsync goes from 60 to whatever the frequency of mouse events. It may be max2dd driver dependent. <br><br></td></tr></table><br>
<a name="1043152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes there will be a performance increase on the same hardware! I never tested the speed difference as I always use Strict as a matter of course. I suggest your next program you start with it on. It makes sense if you think about it. If you make a variable to store images, why would you want it to store strings the next moment and maybe integers later? Strict prevents those mistakes as well as typos. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
