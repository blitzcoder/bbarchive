<!DOCTYPE html><html lang="en" ><head ><title >1.18 pointers</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >1.18 pointers</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >1.18 pointers</a><br><br>
<a name="642819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I want to upgrade my code to BMX 1.18, but can't work around this:<br><br>Type ...<br>  Field img:TImage[24], img2:TImage[24]<br><br>  method loadImg(imgptr:TImage Ptr)<br>    imgprt[0] = loadimage("...")<br>    ...<br><br>  method blah()<br>    loadImg(img)<br>    loadImg(img2)<br>    ...<br><br>thanks for help<br>Roman <br><br></td></tr></table><br>
<a name="642824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> BM Objects can't be casted to pointers anymore. As Ptr are only for outside communcation, where your objects can't go.<br><br>For inside communication you can go the Byte Ptr way as well but it is not the adviceable way ... it breaks the ideas behind the managed environment.<br>There is nearly always a way around the usage of pointers which does not really need much exchange.<br><br>In your case its:<br><br>method loadImg(img:TImage[])<br>... <br><br></td></tr></table><br>
<a name="654404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I wanted an instance (e.g. A Tank) of an object (e.g. TGameObject) to contain a pointer to an extended TPixmap (ETPixmap) instance associated with it.<br>I would need a pointer to Type ETPixmap wouldn’t I?<br>If not, would that mean that each TGamePiece needs to contain its own pixmap?<br><br>I.e. I want each instance of TGameObject to Point to its Graphic instance, not contain it. <br><br></td></tr></table><br>
<a name="654408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> a:ETPixmap=new ETPixmap<br>b:ETPixmap=a<br><br>Now a and b point to the same thing. All types are essentially a pointer to a struct. <br><br></td></tr></table><br>
<a name="654421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> So (for example)<br><br>Field A:ETPixmap, A would just be created as a pointer to a ETPixmap?<br><br>b:int  = A:int Creates a new Int Object, But B:ETPixmap = A:ETPixmap doesnt create a new ETPixmap? <br><br></td></tr></table><br>
<a name="654430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's right. <br>B:ETPixmap = new ETPixmap<br>would create a new pixmap object while...<br>A:ETPixmap=loadpixmap("blah.png")<br>B:ETPixmap = a<br>will create 2 pointers to the same 'Blah.png' pixmap. <br><br></td></tr></table><br>
<a name="654434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> But surly ETPixmap:New() (UnOverridden) is called on creation of any ETPixmap?<br>Does this mean that B:ETPixmap = a , does Create a new ETPixmap, which is then Gcolleceted 'cos its unrefferenced? <br><br></td></tr></table><br>
<a name="654440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Graphics 800,600
Local a:tpixmap = LoadPixmap("max.png")
local b:tpixmap = a
DrawPixmap b,100,100
Flip
WaitKey()
</pre><br>When variables a and b are out of scope the pixmap will be gcollected.<br>&lt;edit&gt;<br>Using a:tpixmap=new tpixmap probably isn't a good example with tpixmap as it will be created without surface info. <br><br></td></tr></table><br>
<a name="654444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats not intuitive though is it?<br><br>If I use the copy allocator (=) I would assume to expect a copy to be created.<br><br>Why is it not<br><br>Local a:tpixmap ptr = *LoadPixmap("max.png")<br>local b:tpixmap Ptr = a<br><br>I am a bit miffed that Ive just spent Two hours trying to do what it does by default :( <br><br></td></tr></table><br>
<a name="654450"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Because A and B are variable links (pointers) to the object<br>already. <br><br></td></tr></table><br>
<a name="654456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know that NOW.<br><br>It just doesnt seem right. I now know that I need<br><br>b:Tpixmap = CopyPixmap:TPixmap( a )<br><br>But wouldn't<br>b:TPixmap = a:TPixMap [same as b:Tpixmap = CopyPixmap:TPixmap( a )]<br>and <br>b:TPixmap ptr = a:TPixmap Ptr  [To copy pointers]<br>be more intuitive?<br><br>I realise its way to late in Blitzmax Devolopment to change it <br><br></td></tr></table><br>
<a name="654482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is a very intuitive way:<br><br>Objects can NEVER be stored by Value in BlitzMax.<br>Everytime you do something like a:TPixmap or the like, this is already a reference (managed pointer) to a TPixmap object.<br><br>Thus the = will set the reference to the same object (and do some internal stuff needed for the garbage collector).<br><br>If you want to do a b = a with a copy of the actual object a, you will have to write your own clone method to do so, that returns a copy.<br><br>Pointers are unmanaged reference and because of that reason not adviceable within BM (you will have to manually memfree ANYTHING assigned to Byte Ptr from extern or Cstring!) and there is no real reason to do so (beside a few exceptions where possible work arounds exist).<br><br>BM is not a managed environment for some funny reason ;-) It makes many many things easier (like assigning a wrong type will result in compile errors as the interfaces do not match and the like) <br><br></td></tr></table><br>
<a name="654486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> You say its intuitive, BUT I think of INT as an object, which means we have two different rules for Objects<br>a = b (if a &amp; b are Ints)<br>is different to<br>A = B (Where A &amp; B are TPixmaps) <br><br></td></tr></table><br>
<a name="654522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure what you want people to say. I find it intuitve but I can also see why you'd be frustrated if you hadn't realised.<br>Maybe the doc should say 'stores a link to the instance' but...<br>a) the doc isn't the strongest part of Bmax<br>b) there are the tutorials which make it clearer.<br>c) I haven't seen many other people querying it.<br>&lt;edit&gt;<br>P.S. I don't think of an int as an object though which, rightly or wrongly, might explain why a:int=b:int and a:TPixmap=B:Tpixmap both seem logical to me. <br><br></td></tr></table><br>
<a name="654536"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Numerics are the only exceptions to the whole thing, which is for the simple reason that numerics are NO objects but just values (you can't use them on commands wanting objects as well. You are forced to send it as a string).<br>thats most likely for pure speed reason. <br><br></td></tr></table><br>
<a name="654639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> a:int=b:int and a:TPixmap=B:TPixmap are logical to me as well. Just that I think that they should do the same thing.<br><br>I accept that they dont. I just think that system Types should behave the same as User Types.<br>(I still think its a copout not being able to extend system types) <br><br></td></tr></table><br>
<a name="654792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> System types behave the same as user types.<br><br>The problem is :int, :double :float :short :byte :long are not types. This are values.<br><br>Everything else like String, TBank, TList, TImage, TPixmap etc etc are handled exactly the same as user types.<br><br>I agree that this is not very consistent. But I'm aware as well that typed numerics would have quite an impact on mathematical operations (which are indeed extremely fast as the are done through C compiler code). It isn't an easy task to implement typed numerics that are usable for the amount of Int and Float operations that normally happen in 2D and 3D games ie that have about the same speed as direct C numerics. <br><br></td></tr></table><br>
<a name="654963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The problem is :int, :double :float :short :byte :long are not types. This are values. <br></div><br><br><br>This is from the top of the types page<br><br>"Types<br>All constants, variables, functions and expressions have an associated type. BlitzMax supports the following types:"<br><br>Where it then goes on to list byte short int etc.<br><br>The are types, so stop saying they are numbers.<br><br><div class="quote"> Not sure what you want people to say <br></div><br><br>I dont want you to say anything, I just wanted to point out that there is a difference bettween the two type of types<br>AND hope Dreamora can see the difference between easy to learn and intuitive<br><br>The Current system of pointers etc is intuitive to YOU cos youve already learnt it. It is a two rule system, one for one lot of types and one for the other <br><br></td></tr></table><br>
<a name="655058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> The docs are a thing that is often not of many uses.<br>In this case it extremely bad wording.<br><br>Type in this case only refers to the fact, that you can create a variable of this "type".<br><br>Numerics are no objects but values only (try it by giving a number to something that wants something of :object like TList.addlast if you trust the docs more than me and others here). The only possibility to get numerics into a TList is make a string out of it and reparse it to an int afterwards ... or like other do, create a Int wrapper object to use it with object based functions.<br>Another way to proof that is: Create a function that accepts a numeric value and try to modify it. It won't change outside. But it will if you use a true objects. To have this behavior you need to cast it to a reference first (by using variable:int VAR )<br><br><br>This should clearly be stated in the documentation ... but it is one of the significant flaws in the docs at the moment.<br>Sorry if this made problems to you. <br><br></td></tr></table><br>
<a name="655191"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora this is a result of Making the two types different. Saying "Look I can only do this with these", doent get away from the fact that they should be the same.<br><br>And I should be able to extend these types. I cannot do this because they are handled differently internaly. Not (as you seem to imply) because they are in essence different <br><br></td></tr></table><br>
<a name="655193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Deleted <br><br></td></tr></table><br>
<a name="655291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> They are in essence different.<br><br>numerics are not extended from Object, BMs core object from which each other existing object is extended. Only types extended from BBObject ie :Object in BM are true objects ... sad but true :-(<br><br><br>They base on a deeper and indepent structure optimized for fast calculation instead OO. This deeper structure fully depends on the C / C++ generated code for maths, which on its own is highly optimized.<br><br>I agree that this is quite bad and not really desirable and unlikely in an OO language that seems to use modern OO design rules in all other aspects.<br>Seems like this is one of the heritages of BMs C/C++ binding in the background as they are as crap in this situation.<br><br>Perhaps this will change at some point, I would really like to see that happen ...<br><br>(For a more indepth explanation: All "true" objects base on BBObject, which implements the needed core functionality like the reference counter and needed core methods like .ToString.  The numerics exist on this level as well as BBDouble and the like. But these types do not inherit BBObject ... And simply let them inherit would not solve the problem as you would need to write the whole operator handling etc as well ... I don't think this will work without altering the compiler as well) <br><br></td></tr></table><br>
<a name="656284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Arrays?<br><br>When I pass an array, its always a pointer to the array isn't it?<br><br>so In NeHe Tut6 (for example)<br>glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, TexWidth, TexHeight, 0, GL_RGBA, GL_UNSIGNED_BYTE, Checkimage)<br>(Checkimage is Global Checkimage:Byte[256,256,4])<br><br>I am definately sending a pointer to Checkimage? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
