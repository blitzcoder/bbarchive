<!DOCTYPE html><html lang="en" ><head ><title >Players start position</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Players start position</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Players start position</a><br><br>
<a name="1288904"></a>

<a name="1288909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi guys <br>I have created a 2d map editor with a play function so i can play the game in the editor.<br>The tiles are 32x32 in size.If the player start position is 132x768 how on earth do i find his start position.He always starts at 0,0.Any help will be lovely.<br><br>tnx<br><br>p.s I have a tile that places the player start. <br><br></td></tr></table><br>
<a name="1288913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> if you want player start 132 and 768 then you type<br><br>Player_X=132<br>Player_Y=768<br><br>Drawimage The_Bugger,Player_X,Player_Y<br><br>IF You using Functions then dont forget used Global for Player_X and Player_Y<br><br>Hope that help! <br><br></td></tr></table><br>
<a name="1288916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Started this in the wrong forum SORRY.can you move it to BlitzMax Programming please. <br><br></td></tr></table><br>
<a name="1288919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you want his start position as the tile coordinates?<br><br><pre class=code>
SuperStrict

Framework brl.standardio


Local x:Int = 132
Local y:Int = 768

Local tx:Int, ty:Int

ScreenToTile(x, y, tx, ty)

Print x + ", " + y + " -&gt; " + tx + ", " + ty


Rem
bbdoc: Converts screen coordinates to tile coordinates.
End Rem
Function ScreenToTile(x:Int, y:Int, tx:Int Var, ty:Int Var, offX:Int = 0, offY:Int = 0)
	tx = x / 32 + offX
	ty = y / 32 + offY
End Function
</pre> <br><br></td></tr></table><br>
<a name="1288928"></a>

<a name="1288931"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Forgot to mention i have eight way scrolling in this.Does it matter.<br><br>You say screen to til there is no size <br><br></td></tr></table><br>
<a name="1288987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. Maybe I don't understand what you are referring to when you say:<br><div class="quote"> If the player start position is 132x768 how on earth do i find his start position <br></div><br>because it doesn't really make much sense :-) <br><br></td></tr></table><br>
<a name="1289092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabhand</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I usually use bitshifting for tilemaps, so if I wanted the player to start in a specific cell of the tilemap, say, at map[10,3], I would use:-<br><br>PlayerX = 10 shl 5<br>PlayerY = 3 shl 5<br><br>Likewise, you can use 'shr' to convert actual coordinates back to tilemap friendly numbers like so:-<br><br>tile = map[playerX shr 5, playerY shr 5]<br><br>Obviously add/subtract any offset accordingly.<br><br>This is what I used for my monkey croco remake:-<br><br><a href="http://www.monkey-x.com/Apps/app.php?id=51" target="_blank">http://www.monkey-x.com/Apps/app.php?id=51</a><br><br>The bonus is since your playing with bits it becomes an instant optimisation... well, it used to be... Back in the day! :D<br><br>Dabz <br><br></td></tr></table><br>
<a name="1289252"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry dont think i explained clealy.<br>The map tiles are 32x32 pixels in size.The map size is 132 map tiles wide.<br>and 768 map tiles depth.<br>I am getting confused myself here just typing it.Ha<br><br>thanks for any help guys. <br><br></td></tr></table><br>
<a name="1289256"></a>

<a name="1289260"></a>

<a name="1289269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="1289325"></a>

<a name="1289326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>If the player start position is 132x768 how on earth do i find his start position.He always starts at 0,0.Any help will be lovely.<br> <br></div><br><br>well ... "on earth", you have to convert to polar coordinates using Greenwich as a 0 position for longitude and equator for lattitude :)<br><br>Without joking, you're really confusing.<br>your Map is defined in Tile unit. If I understand : 132,768 (in Tile coords System)<br>The position of your player is in ... pixel ? Tile unit ? something else ?<br>And you want it in Pixel ? Tile Unit ?<br><br>BTW : if whatever you set the player start at 0,0, then you should try to follow your code from the moment you set the position to the moment it is drawn on screen. You may find something that force the position to be 0,0 whatever you set.<br>If you're using a framework, maybe it use a function/method to set the player position.<br><br><br>Else : according to general map coordinates, conversion from Tile to World (in pixel) would be :<br><br><pre class=code>

' relative position to Tile (in pixel)
Function convertPixelCoordToTilePixel(pixel_coord:Int, TileSize:Int, MapOffsetInPixel:Int)
	Return pixel_coord - ( Floor ( Float(pixel_coord-MapOffsetInPixel)/TileSize ) * TileSize )
End Function

' global tile position (in Tile unit)
Function convertPixelToTileUnit:Int(pixel_coord:Int, TileSize:Int, MapOffsetInPixel:Int)
	Return Floor(Float(pixel_coord - MapOffsetInPixel)/TileSize)
End Function

' Tile Unit position to Pixel position
Function convertTileToPixel:Int(TilePos:Int, TileSize:Int, MapOffsetInPixel:Int)
	Return TilePos * TileSize + MapOffsetInPixel
End Function
</pre><br><br>"convertPixelCoordToTilePixel" transforms a global (world space) pixel coordinate to its Tile relative coordinate (ie : the number pixel from the edges of the Tile the player is on)<br><br>"convertPixelToTileUnit" transforms your pixel coordinate (world space) to tile unit (ie : the number of tile to reach the position)<br><br>"convertTileToPixel" transforms the coordinates the a Tile (in Tile Unit) to world space coordinates (in pixel)<br><br>So, if you want the player to start on the tile 4,7 (for example), you'll have to do this (with TILE_SIZE = 32 pixel and offset for the map=0)<br>Player_X = convertTileToPixel(4, TILE_SIZE, 0)<br>Player_Y = convertTileToPixel(8, TILE_SIZE, 0)<br><br>if you want the player to start in the middle of the title<br>Player_X = convertTileToPixel(4, TILE_SIZE, 0) + TILE_SIZE/2<br>Player_Y = convertTileToPixel(8, TILE_SIZE, 0) + TILE_SIZE/2<br><br>if you want to get the Tile Position of your player while its position is expressed in pixel (let's say, x=842, y=4213) :<br>Player_TileX = convertPixelToTileUnit(842, TILE_SIZE, 0)<br>Player_TileY = convertPixelToTileUnit(4213, TILE_SIZE, 0)<br><br><br>All is a matter of what unit you want to transform to what unit, and which coord system you use.<br><br><br>ps : if you're using a 2D framework, you may tell us the name, it could help. <br><br></td></tr></table><br>
<a name="1289352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just a short interruption:<br><br><pre class=code>
Floor ( Float(pixel_coord-MapOffsetInPixel)/TileSize )
</pre><br><br>isnt "int/int" already floor-truncated?<br>So if you do not "ceil()", you could just skip the whole "floor(float(int)/int)" and just return "int/int".<br><br>Also I am not sure if "Float(x)" is a wrapper to "x.ToFloat()" (aka: which one calls less things (there are others checking the resulting ASM-code...) :-).<br><br><br>Nonetheless the general post is a good one, above's question just came into my mind when scanning the code.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1289361"></a>

<a name="1289362"></a>

<a name="1289363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're right, just checked in Blitzmax : int/int is already floored.<br><br>It's just that I had never looked the result with blitzmax :)<br>In  doubt, I prefered force it to be a floor. I only know some compilers that truncate before or after 0.5 (0.5 included or not)<br><br>Whatever I'm not really sure the positioning of a single player could affect anything of the framerate, you're still right. <br><br></td></tr></table><br>
<a name="1289364"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you use the "grid to screen"-functionality (or "screen-to-grid") some "more" times per loop (had to do this in my game "Apes Banana Conquest" - written in monkey) you might see some changes.<br>I try to use the float only when wanting a "percentage" (eg covering of a tile).<br><br>Of course it might be neglectable - and your thoughts on this are like I am thinking too (better doing some "securing" than later on running into trouble). So do not feel attacked, everything is okay.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1289370"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br> So do not feel attacked, everything is okay.<br> <br></div><br>I didn't feel attacked at all :)<br>Actually I didn't know about the int/int being already a floor. <br><br></td></tr></table><br>
<a name="1289404"></a>

<a name="1289407"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is not directly a floor - it is just truncating the fractional part from the integer portion. For _me_ this is the same as "rounding down"/floor().<br><br><br>Interestingly this then truncates your function:<br><pre class=code>
' relative position to Tile (in pixel)
Function convertPixelCoordToTilePixel(pixel_coord:Int, TileSize:Int, MapOffsetInPixel:Int)
	Return pixel_coord - ( Floor ( Float(pixel_coord-MapOffsetInPixel)/TileSize ) * TileSize )
End Function
</pre><br><br>to something really short:<br><br><pre class=code>
' relative position to Tile (in pixel)
Function convertPixelCoordToTilePixel(pixel_coord:Int, TileSize:Int, MapOffsetInPixel:Int)
	'original
	'Return pixel_coord - ( Floor ( Float(pixel_coord-MapOffsetInPixel)/TileSize ) * TileSize )
	'step 1
	'Return pixel_coord - ( Floor ( (pixel_coord-MapOffsetInPixel)/TileSize ) * TileSize )
	'step 2
	'Return pixel_coord - ( (pixel_coord-MapOffsetInPixel)/TileSize * TileSize )
	'step 3
	'Return pixel_coord - ( pixel_coord-MapOffsetInPixel )
	'step 4
	'Return - ( -MapOffsetInPixel )
	'step 5
	Return MapOffsetInPixel
End Function
</pre><br><br>So if I have done everything correct, then this function is not doing what it is expected to do.<br><br>I think it should substract tile-dimensions from a given given pixel value. So isn't it a "modulo" ? <br><br>Return (pixel_coord - MapOffsetInPixel) Mod TileSize<br><br>-&gt; make pixel_coord "absolute" (subtract your offset)<br>-&gt; subtract the biggest amount of "TileSize*x" from that value<br>-&gt; remainder is the pixels of the tile you are targeting<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1289439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe it's just me, but I still don't really know what he wants to calculate! :-p <br><br></td></tr></table><br>
<a name="1289446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not you, that's why I posted different functions instead of just the one who would fit ...<br><br>But I'm pretty sure he wants some earth coordinates ^_^ <br><br></td></tr></table><br>
<a name="1289711"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for help guys<br><br>I was not taking the scrolling into consideration.In placing the player.<br><br>Thanks again <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
