<!DOCTYPE html><html lang="en" ><head ><title >Timing</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Timing</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Timing</a><br><br>
<a name="543086"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroRusty</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is the best way to do timing in BlitzMax so my game will run at the same speed on all PC's?<br><br>In Blitz3D i used a replacement function instead of using flip. The function is<br><br>Const framerate=60<br><br>Function do_flip()<br><br>	framecounter=framecounter+1<br><br>	Flip<br><br>	While Abs (MilliSecs()-timer) &lt; (1000/FRAMERATE)<br><br>	Wend<br><br>	timer=MilliSecs()<br><br>End Function<br><br>I have tried this in BlitzMax and it does work but is there a better/easier way to do this?<br><br>Thanks <br><br></td></tr></table><br>
<a name="543092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1. Precalculate the 1000/framerate and use a local variable instead. Saves quite some calculation time :-)<br><br>2. There is the way of FPS Modifier which means that you modify all movement,speed etc values with a factor that depends on your actual fps (normally 1.0/fps)<br>If you do so, you can modify your above code that only flip depends on the time passed since so you can replace the while wend with a if then endif. This way your calculation power runs at its max while the fps is still on the wished point.<br><br>I sometimes even used it to fill the rest of the frame with a delay which is needed in B3D to prevent "full cpu usage" <br><br></td></tr></table><br>
<a name="543159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought BlitzMax did all the timing stuff for you internally if you set the hertz to 0 when you call Graphics. Has this changed? <br><br></td></tr></table><br>
<a name="543166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> This timing has nothing to do with "make it the same speed on every system", this timing is only for graphics part not the mathematic calculation stuff. <br><br></td></tr></table><br>
<a name="543177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You'll only get it to run the same speed on all PC's if all PC's are fast enough to run your game within its capacity. If your game needs more juice than is available it will run slower no matter what you do. In that case, you then enter into the different area of how to adjust the place that you are at in the various animations and movements to relate to the timing of when the frame will be ready to be viewed. <br><br></td></tr></table><br>
<a name="543192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroRusty</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> My game will run on most PC's. It's a platform game with some nice effects in it. If my do_flip function will work then I will use that.<br><br>Thanks <br><br></td></tr></table><br>
<a name="543239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >The r0nin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you worried that the game might be too fast on some machines, or that it will be too fast on some and too slow on other machines?  The first is solvable by several methods (including tweening, which Mark Sibly did a good tutorial for on the message boards, or something else like a frame-rate limiter).  The second requires both a tweening-type solution as well as "throttling" of your graphics or calculations (i.e. on slower machinces you would have to use simpler graphics routines or AI calculations, etc., leading to the possibility of a different game experience on different hardware, even though you have the same game speeds), which is much harder to do. <br><br></td></tr></table><br>
<a name="543577"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroRusty</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I want is for my game to run smooth no matter what people's monitor rate is. I have some code that get's the users monitor rate and matches the games speed to that, but this doesn't work in BlitzMax.<br><br>I want my game to have smooth scrolling. I'm not going to achieve this unless I can match my game to the users monitor rate. If I set my game to run at 75fps and someone is playing it on a monitor that is set to 60fps, it's going to look nasty.<br><br>Thanks <br><br></td></tr></table><br>
<a name="543595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why do you want to match the monitor refresh?<br>this means that it will run faster for people with faster refresh rates ...<br><br>syncronize the movement to a fixed value which is scaled to the actual main loop time needed and set the refresh to -1 ...<br><br>then it does not mather how fast the monitor is, it will run at the same speed for every use. <br><br></td></tr></table><br>
<a name="543606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RetroRusty</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you have any code that show's how to do this?<br><br>Thanks <br><br></td></tr></table><br>
<a name="543611"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sure sure, no problem :-)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Strict


Graphics 800,600,0


Global fps
Local tfps,xfps
Local time, tdif:Float
' all movement values are multiplied by tdif to scale them to the actual fps
' this is not using fps as fps is constant for a second and does not reflect
' the real fps every loop

Local move_x:Float	= GraphicsWidth () / 2
Local move_y:Float	= GraphicsHeight () / 2
Local dir_x:Float	= 60			' 60 pixels per second
Local dir_y:Float	= 60			' 60 pixels per second
time				= MilliSecs ()
While Not KeyHit (key_escape)
	
	Cls
		
	move_x	:+ dir_x * tdif
	move_y	:+ dir_y * tdif
	If move_x &gt; GraphicsWidth () - 10 Or move_x &lt; 10 dir_x = - dir_x
	If move_y &gt; GraphicsHeight () - 10 Or move_y &lt; 10 dir_y = - dir_y

		
	SetColor 0,0,200
	DrawOval move_x,move_y,10,10
		
	SetColor 255,255,255
	DrawText "FPS: " + fps,0,0
	Flip
	FlushMem
	tdif		= Float(MilliSecs () - time)/1000
	time		= MilliSecs ()
	If time - tfps &gt; 999
		fps		= xfps
		xfps	= 0
		tfps	= time
	EndIf
	xfps		:+ 1
Wend</textarea> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
