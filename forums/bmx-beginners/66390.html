<!DOCTYPE html><html lang="en" ><head ><title >Remove entry from TList</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Remove entry from TList</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Remove entry from TList</a><br><br>
<a name="741832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >andre72</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I have a problem when I remove entries from a TList.<br>I try to move entries from one TList to an other using this code:<br><br><br>For Local t:trainer=EachIn trainer.ltrainers<br>	Local y:Byte=Rand(3)<br>	If y=3 Then<br>		s.AddTrainer(t)<br>		ListRemove trainer.ltrainers,t<br>	EndIf<br>Next<br><br>The matter is that the entries are only cleaned and not deleted.<br>So I have ever 30 entries in the TList and the removed ones are empty.<br>But they should really be deleted after copying them to the other list.<br><br>Thanks,<br><br>Andre <br><br></td></tr></table><br>
<a name="741859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> RemoveLink( link:TLink )<br><br>As you are already scaning though the list you shouldnt use listremove anyway, cos it also then scans thought the list. <br><br></td></tr></table><br>
<a name="741869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >andre72</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks - but I changed the source like this (is that the right way?):<br><br>If y=3 Then<br>                s.AddTrainer(t)<br>	Local l:TLink=ListFindLink(trainer.ltrainers,t)<br>	RemoveLink l<br>EndIf<br><br>The result is the same, 30 entries and the removed are empty ... <br><br></td></tr></table><br>
<a name="741920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, you're still wasting time searching for a link you could already have. The link is returned by ListAddLast, so just a field in the type for the link and store it. Then you can just use RemoveLink and skip ListFindLink. <br><br></td></tr></table><br>
<a name="742203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >andre72</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the information - I use now this way.<br>However I've still the same problem - every entry is only empty and not deleted... <br><br></td></tr></table><br>
<a name="742304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Have all the TLinks gone out of scope? <br><br></td></tr></table><br>
<a name="742310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Print more code. <br>Cos if you have removed the link, then the link shouldnt be there. If what you are saying is that the object is still there, well it should be because as you said you have moved it over to another list.<br><br>You are in fact not deleting any object, you are only deleting a link. So unless after the code the first Tlist still contains the same number of object and the new Tlist now has more objects then there isnt a problem. <br><br></td></tr></table><br>
<a name="742329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't repeat the behaviour you're experiencing, so I can only assume it's a problem with your code or your interpretation of what's happening.<br><br>Does this code behave correctly for you?<br><br><pre class=code>

SuperStrict

Type Thing
	Global List1:TList=New TList
	Global List2:TList=New TList
	Field Link:TLink
	
	Method New()
		Link=List1.AddLast(Self)
	End Method
	
	Function SwapLists()
		DebugLog "LISTS SWAPPED"
		For Local T:Thing=EachIn List1
			T.Link.Remove()
			T.Link=List2.AddLast(T)
		Next
	End Function
	
	Function PrintList1()
		Print "LIST 1"
		Local Counter:Int=0
		For Local T:Thing=EachIn List1
			Counter:+1
			Print "ENTRY "+Counter
		Next
		Print "LIST 1 DONE"
	End Function
	
	Function PrintList2()
		Print "LIST 2"
		Local Counter:Int=0
		For Local T:Thing=EachIn List2
			Counter:+1
			Print "ENTRY "+Counter
		Next
		Print "LIST 2 DONE"
	End Function
	
End Type



Local I:Thing
Local Count:Int

For Count=1 To 20
	I=New Thing
Next


Thing.PrintList1()
Thing.PrintList2()

Thing.SwapLists()

Thing.PrintList1()
Thing.PrintList2()

</pre> <br><br></td></tr></table><br>
<a name="742714"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >andre72</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Gabriel<br>Well, great - your code works well.<br>If there won't anybody point out the mistake in my one I'll try to rewrite it like this.<br><br>@H&amp;K<br>Here's a working example (only some Defdata and unimportant code is cut).<br>Hope someboy point out my mistake...<br><br><br>Type trainer<br>	Global ltrainers:TList<br>	Field ltlink:TLink,name:String<br><br>	Method New()<br>		If Not ltrainers ltrainers=CreateList()<br>		Local ltlink:TLink=ListAddLast(ltrainers,Self)<br>		Self.ltlink=ltlink<br>	End Method<br>	<br>	Function AddTrainer:trainer(name:String)<br>		Local t:trainer = New trainer<br>		t.name=name<br>		Return t<br>	End Function<br>End Type<br><br>Type stable<br>	Global lstables:TList<br>	Field name:String<br>	Field ltrainers:TList <br><br>	Function AddStable:stable(name:String)<br>		Local s:stable = New stable<br>		s.name = name<br>		Return s<br>	End Function<br>	<br>	Method New()<br>		If Not lstables lstables=CreateList()<br>		ListAddLast lstables,Self<br>		ltrainers=CreateList()<br>	End Method<br><br>	Method AddTrainer:trainer(trainers:trainer)<br>		Local t:trainer = New trainer<br>		t=trainers<br>		ListAddLast ltrainers,t<br>		Return t<br>	End Method<br>End Type<br><br>Local t:trainer<br>Local s:stable<br>Local name:String,x:Byte<br><br>For x=0 To 9<br>	ReadData name<br>	t=trainer.addtrainer(name)<br>Next<br><br>For x=0 To 2<br>	ReadData name<br>	s=stable.addstable(name)<br>	<br>	SeedRnd MilliSecs()<br>	For t=EachIn trainer.ltrainers<br>		Local y:Byte=Rand(3)<br>		If y&gt;1 Then<br>			s.AddTrainer(t)<br>			t.ltlink.Remove<br>		EndIf<br>	Next<br>Next<br><br>Print "Items: " + CountList(trainer.ltrainers)<br><br>For s=EachIn stable.lstables<br>	Print s.name<br>	For t=EachIn s.ltrainers<br>		Print "~t"+t.name<br>	Next<br>Next<br><br>For t=EachIn trainer.ltrainers<br>	Print "~tFree Trainer: " +t.name<br>Next<br><br>Print "Items: " + CountList(trainer.ltrainers)<br><br>DefData "Geli"<br>DefData "Frank"<br>DefData "Jochen"<br>DefData "Susi"<br>DefData "Doro"<br>DefData "Karl"<br>DefData "Jurgen"<br>DefData "Dieter"<br>DefData "Sigrid"<br>DefData "Babsi"<br><br>DefData "Test 1"<br>DefData "Test 2"<br>DefData "Test 3" <br><br></td></tr></table><br>
<a name="742720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>Method AddTrainer(trainers:trainer)
		
		ListAddLast Self.ltrainers,trainers
	
	End Method</pre>When you where calling Stable.AddTrainer, you were adding the NEW Trainer to the original Trainer list, then even though you removed the link to the object, you had added it agian.<br><br>Dont forget when you were adding the trainer to a stable, you where not supposed to make a NEW trainer, simply moving which list it was on. <br><br></td></tr></table><br>
<a name="742981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >andre72</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the solution. I'll have a look and try to fix this ... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
