<!DOCTYPE html><html lang="en" ><head ><title >How to save from the "Front Buffer"</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to save from the "Front Buffer"</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >How to save from the "Front Buffer"</a><br><br>
<a name="720699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Would like to add a save screenshot to my game, the player would pause the game then press "S" for example.<br><br>But I can only seem to save the backbuffer image and not from the frontbuffer meaning the player ends up with a screenshot exactly 1 frame behind the frame they wanted. <br><br></td></tr></table><br>
<a name="720733"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think if you get hDC of the window, then copy the content to a pixmap you could save it. MSDN is being a broken piece of crap so I can't provide an example right now... <br><br></td></tr></table><br>
<a name="720736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Immediately after a flip and before you draw anything else to the backbuffer your 'frontbuffer' and 'backbuffer' should be the same.... shouldn't they?<br>Use grabpixmap and savepixmappng for a screenshot. <br><br></td></tr></table><br>
<a name="720756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...If your game is 'paused' anyway, wouldn't the next frame still be identical anyway, provided you redraw it and not change anything? <br><br></td></tr></table><br>
<a name="720932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you're using OpenGL you can do glReadBuffer(GL_FRONT) and then glReadPixels() (or maybe grab pixmap).<br><br>Alternatively, if you decouple your logic from your graphics refresh, you should be able to re-render the previous frame into the backbuffer - ie when they press pause you skip doing the logic and just redraw the graphics again, then the backbuffer image will be the same as the one they saw.<br><br>Also NO, the backbuffer is totally unpredictable after a flip. It could be the same, it could be totally trash, it could be part of a chain of backbuffers which might contain images from several frames ago. <br><br></td></tr></table><br>
<a name="720994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The back buffer is undefined after a flip, it may contain the previous frame, the frame before that or random noise depending on the graphics architecture of the particular system. Always use grabpixmap just before flip, which is where I suggest you check for the user keypress. <br><br></td></tr></table><br>
<a name="721028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doesn't that mean the user will get a screenshot of the next frame rather than the one they've just looked at? <br><br></td></tr></table><br>
<a name="721031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess you could always look for the "capture screen" keypress first each loop and if pressed, redraw the screen with the same data as the previous frame, capture, update the screen with the current frame, then flip. <br><br></td></tr></table><br>
<a name="721039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless the human is a computer I suggest there will be atleast a 3 frame lag between his brain firing the neuron and their finger depressing the key so I can't quite see the relevance of the original question.<br><br>Capturing a sequence of pixmaps while the capture button is down might also be useful or at least on the keyup which I would imagine will give them a slightly faster "shutter speed". <br><br></td></tr></table><br>
<a name="721887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think the best suggestion is to redraw the whole screen to the back buffer as normal then grab it before the flip.<br><br>Just seems a strange when old BlitzBasic could save either buffer with just one command.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="721963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think that was DirectDraw, DirectX has a performance penalty warning for creating a display that is lockable (required for capturing front buffer). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
