<!DOCTYPE html><html lang="en" ><head ><title >Suggestions for image layering?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Suggestions for image layering?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Suggestions for image layering?</a><br><br>
<a name="1060421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >blackwater</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi everyone, I did some forum searches but didn't find anything on the topic. When drawing an image and using the flip command (without clearing) the new image gets drawn on top of the old image, if there is one present. <br><br>I'm building a game editor and made a fair amount of progress the last few days. I was wondering if there was a method for controlling on what layer the image is displayed? For example, image C is on top of image B and image B is on top of image A. what if I now wanted image a to be on top of B and C?<br><br>One thought I had was to simply redraw the entire screen and code a method that controls in what order the images get drawn according to whatever "layer" I assigned to them. Is that the way to go or is there a better method out there? <br><br></td></tr></table><br>
<a name="1060426"></a>

<a name="1060427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitzmax  uses only two layers; The back layer which is where everything is draw into and the front layer which is used to display. the layers are swapped  when flipped and that is why you have to use cls to clear the images on the back buffer before drawing to the layer again. if you want to stack images in alternate sequence. then you are going to have to create some type of functionality to take care of that. some programmers use a technic called z sorting. it's a technic that sorts the images by distance for display before drawing to the buffer. I assume you are using procedural programming for your editor. that would make it a bit more hard to modify than if you were using Object programming since for this to work you would have to do all of your updates and calculations for your  images, save each position and order into memory and finally display everything in the order desired.<br><br>if you have many layers in your editor I suggest drawing each layer to the screen starting from the bottom layer sequentially all the way to the top layer. if you need to change the order than you are going to have to program some logic to take care of that.<br><br>I assume quite a bit as I don't know how much you really know about programming but based on your question's I concluded that you don't know much. If it's not the case forgive me, I tend to do that a lot. Either way, the logic works the same way.<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1060438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's some *very* old and crusty code. It'll give you an idea of one way to go...<br><br><a href="/posts.php?topic=56615#630162" target="_blank"><b><u>http://blitzbasic.com/Community/posts.php?topic=56615#630162</u></b></a> <br><br></td></tr></table><br>
<a name="1060446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't rely on the backbuffer containing the frame you previously flipped. It depends entirely on the graphics driver as to whether it clears the frame for you, whether you have to clear it yourself, whether it might contain garbled scrambled data, and whether it might implement multiple framebuffers and cycle through them. On my iMac for example it does not retain the contents of the previous frame after a flip. If your system does this it's a side-effect and a coincidence you can't depend on. <br><br></td></tr></table><br>
<a name="1060479"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >blackwater</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks guys, I'm going to need "layering" at some point, I just wanted to know if there was something already in the books to handle that or if I would have to invent my own.<br><br>I suspect the route I'm going to take is write some code to handle in what order the images are drawn to the screen, with layer 1 images being drawn last (to be on top of everything else). <br><br></td></tr></table><br>
<a name="1060488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why don't you make every layer one big image itself? say if you want something to be on layer 2, you output whatever you want onto the layer 2 image.<br><br>At render time, each layer is rendered in the correct order:<pre class=code>
DrawImage Layer1,x,y
DrawImage Layer2,x,y
DrawImage Layer3,x,y
DrawImage Layer4,x,y

[...]
</pre> <br><br></td></tr></table><br>
<a name="1060503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Keep in mind: you really, really should redraw everything each frame.<br><br>After a flip, the contents of the backbuffer are undetermined. The OpenGL spec tells you not to count on any contents surviving.<br>In DirectX, different cards use a different number of backbuffers, which means that after a flip the contents of the buffer may not be identical to what it was before the flip, but all of a sudden 'rewind' one, two, or even three frames since it may cycle through up to 4 different backbuffers instead of using just one.<br>This can lead to really annoying flickering on some computers.<br><br>The only way to ensure that everything looks the way you want it to, is to redraw the entire screen after each flip.<br><br>Since you're redrawing everything anyway, it should be fairly straightforward to assign your own 'layer' to images, and organize your image drawing function to draw these layers in order of back to front. <br><br></td></tr></table><br>
<a name="1060719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> One method would be to use separate TLists for each layer.  All layer 1 objects would go into the layer 1 TList, layer 2 objects in the layer 2 TList, etc...  Then all you need to do is draw the contents of each list in order.  If an object changes layers, then all you need to do is remove it from one list and add it to the other. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
