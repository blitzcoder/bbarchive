<!DOCTYPE html><html lang="en" ><head ><title >GCMemAlloced() question</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >GCMemAlloced() question</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >GCMemAlloced() question</a><br><br>
<a name="1215292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Galdy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was testing out an image loading function with GCMemAlloced().<br>Before images are loaded i get 39936 and after i get 141694 bytes. Yet I loaded 52 megs of .png images. So what gives? I want to know what the uncompressed graphics are actually gobbling up. Apparently GCMemAlloced() does not take that into account or do you have to draw the graphics for them to be taken into account? Not understanding. <br><br></td></tr></table><br>
<a name="1215295"></a>

<a name="1215296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You probably have to draw them before they get pushed into VRam, which would explain why they didn't count for graphics memory usage, but I would expect GCMemAlloced to report the correct result regardless. If you're not drawing them, and this is only a test app, are you sure they're not being collected again? You're storing them in variables which are in scope?<br><br>That said, it's easy enough to calculate memory usage for images without using the GC. Just round up to the nearest power of two, then multiply by the number of bits (or bytes) per pixel.<br><br>EG: I have an image which is 57x53 pixels and has an alpha channel.<br><br>It'll be rounded up to 64x64 pixels (NPOT) and, with an alpha channel, it'll occupy 4 bytes per pixel. Total memory usage in kilobytes is therefore 64x64x4 / 1024. 16kb.<br><br>If you load a full set of mipmaps, multiply that by 1.333. <br><br></td></tr></table><br>
<a name="1215299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Galdy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well when you have over 370 images of varying size, long hand math is not to appealing. lol. I'll create a loop and draw them and see what happens. <br><br></td></tr></table><br>
<a name="1215303"></a>

<a name="1215304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Galdy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> After drawing them all once, I get 189,440 from GCMemAlloced. That still can't be right. I'm still looking for a batch method of determining my images memory usage. Short of writing a program to do so I guess. <br><br></td></tr></table><br>
<a name="1215306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Galdy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok. Well I wrote a quick little Vram calculator program. Wasn't to hard.I'm running at about 318 megs. I am assuming the default Graphics depth is 32bit? <br><br></td></tr></table><br>
<a name="1215323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I am assuming the default Graphics depth is 32bit?  <br></div><br><br>Yes. (Although I seem to remember that even if you force a 16-bit video mode to draw to, the images may still be stored in 32-bit format in memory) <br><br></td></tr></table><br>
<a name="1215326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Galdy</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Although I seem to remember that even if you force a 16-bit video mode to draw to, the images may still be stored in 32-bit format in memory <br></div><br><br>Oh? I was just thinking of 16 bit to reduce memory usage of the images, but maybe not uh? Would be nice to confirm that. <br><br></td></tr></table><br>
<a name="1215438"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's been a very long time since I used BlitzMax, so definitely don't take my word for it, but it was also my understanding that BlitzMax images are 32 bit internally. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
