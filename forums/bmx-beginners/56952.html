<!DOCTYPE html><html lang="en" ><head ><title >Releasing Memory</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Releasing Memory</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Releasing Memory</a><br><br>
<a name="633087"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ant</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, if I have for example the following code:<br><br>type TObject<br>  field image:Timage[10]<br>  field x,y<br>  ...etc<br>endtype<br><br>global newObject:TObject<br>newObject = new TObject<br><br>Now say I wanted to delete newObject and release the memory of the object, I have been doing the following:<br><br>newObject = Null<br><br>...and I have been assuming that any fields within the type would release their memory as well.<br><br>But I have noticed that some code examplesI have encountered would first set all the images[] to null and then set newObject to Null. <br><br>Is its best to null the elements of a type and then the type or doesnt it matter?<br>Thanks <br><br></td></tr></table><br>
<a name="633104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It doesnt realy matter, the GC should take care of any reference that goes out of scope automaticly.<br><br>You only need to set a variable to Null if you want it to be taken care of at the next GCCollect() or if there is circular references, and even then its not garantied it will be freed at the exact spot you want it to be (although it will be eventualy ;) <br><br></td></tr></table><br>
<a name="633120"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> grable: That is a very dangerous way you propose.<br><br>As a mather of facts the BM GC does NOT have root references! This means the GC can not say if an object is linked to the root of the system at all. So if you NULLify the link to a cyclic double linked list for example, the list will NOT be removed by GC!<br><br>You should always NULLify all the objects you have within your own objects. To do so, simply override the delete method and you won't have to care for that anymore.<br><br>If you do not do that, you might risk that stuff is not removed. <br><br></td></tr></table><br>
<a name="633147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Realy??.. if this is true, i have some major code restructuring on my hands :( <br><br></td></tr></table><br>
<a name="633148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Isn't it enough to add method delete() to all the classes where you nullify its subparts? (delete() is called by the GC when an object is removed, at least as long as the object is deleted before the OnEnd event which happens when you use end or a user quits it) <br><br></td></tr></table><br>
<a name="633154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm.. id think so.. <br>Usaly i have Clear() or Close() methods that i call from Delete() that cleans up any kind lists.<br><br>I did some tests by adding a counter do New() and Delete() .. so far no objects are removed at the end of my program :( <br>even when i ecplicitly call Clear() and set its ref to Null and call GCCollect() then print the numbers before the end.<br><br>I realy hope its just me, havent slept in 2 days ;) <br><br></td></tr></table><br>
<a name="633156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ant</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> If thats the case, doesnt that mean that you'd have to nullify all the fields of the type including ints. floats, strings as well as images/sounds etc? <br><br></td></tr></table><br>
<a name="633157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ant: no, the GC only deals with Object references. <br><br></td></tr></table><br>
<a name="633159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> What type of structure do your object have?<br>Perhaps its a simple back-reference issue that is causing the problem or so which can be solved by a simple "clean splitting" (ie parent starts cleaning, then calls the childs clean function and then finish its own cleaning which depended on the child beeing nullified before, for example) <br><br></td></tr></table><br>
<a name="633160"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its a LISP evaluator im working on<br><br>Type TCell<br>  Field CAR:TCell<br>  Field CDR:TCell<br>EndType<br><br>its basicly a linked list structure, eg lists in lists in lists hehe.<br><br>It could be that i have a global instance of TCell that acts as a common Nil (Null) to all TCell's.. i dunno<br><br>btw. does this mean i have manually null over arrays  too? <br><br></td></tr></table><br>
<a name="633165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just answered by own question ;)<br><br>that global instance realy did mess things up, damn.<br><br>the whole design of the evalutor is baes around that point LOL.<br><br>Thanks for letting me know Dreamora =) this might solve the speed issue ive been having as well. <br><br></td></tr></table><br>
<a name="633168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Happy that it helped :-)<br>Yeah the chance that something like this leads to speed drops is there.<br><br>There is another thing that might help: If you create a lot of objects within a function that are only needed within this function, it might help to speed up as well if you call GCCollect at the end of the function manually. <br><br></td></tr></table><br>
<a name="633177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just to bad this brakes my LISP thingy to pieces. <br>The global instances referenced itself to avoid possible errors of using NIL itself as a list. <br><br></td></tr></table><br>
<a name="633183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ant</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora - thanks for the help, grable - sorry I messed up your afternoon ;-( <br><br></td></tr></table><br>
<a name="633185"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ant:<br>hehehe.. no worries, it was a bad idea from the start. i was being lazy and now i have to pay for it ;)<br><br>EDIT: yoho.. i got it to work like it was supposed to =) .. the speed only went up a tiny fraction though :/ <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
