<!DOCTYPE html><html lang="en" ><head ><title >blitzmax much slower than blitzplus in calculation</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >blitzmax much slower than blitzplus in calculation</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >blitzmax much slower than blitzplus in calculation</a><br><br>
<a name="482916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I bought blitzmax and am playing with the windows beta, it's graphically awesome however I have a problem:<br><br>looks like max is much slower than plus in calculations !!!<br><br>take this code in both max and plus:<br><br><br>a=MilliSecs()<br>y#=0<br>For i= 1 To 1000000<br>y=y+i^0.5<br>Next<br>Print y<br>Print (MilliSecs()-a)<br><br><br><br>Max finds the answer in 3731 milliseconds<br><br>Same thing in Plus takes 190 millisecs!!<br><br>However Max is MUCH faster than plus in drawing (about 10 times?) and draws much better (no flickering at all...)<br><br>I really need speed for computationally intensive physics simulations, and I would like to compute at least as fast as in blitzplus! (which is actually almost as fast as C, in C it takes about 140 millisecs[believe me or not it took me an hour to write the C program :P])<br><br>Some ideas? <br><br></td></tr></table><br>
<a name="482919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There was a problem with the ^ operator... I believe this'll be fixed for the next release. <br><br></td></tr></table><br>
<a name="482922"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> In BlitzMax, you will find there are two places where variables can be stored, either in memory or in CPU registers. Whenever you use a regular variable or you define one as a Global, it puts it in main memory. The way you have it set up right now all your variables are working from memory. The alternative is to use the "Local" keyword which, while at the same time confines the scope of the variable to with a block of code (ie inside a function, inside a for-next loop, etc) is also puts the variables in CPU registers (or tells the compiler to create code that works that way), which is MUCH faster.<br><br>So instead, try this code in BlitzMax and see what kind of result you get:<br><br><pre class=code>
Local a=MilliSecs() 
Local y#=0 
For Local i#= 1.0 To 1000000.0 step 1.0 
   y=y+i^0.5 
Next 
Print y 
Print (MilliSecs()-a)
</pre><br>What result does this give you? (not saying I know that Max is faster, just that you need to use Locals for fastest results). Also not sure whether to go with a float or int for the loopcounter there.<br><br>[EDIT] - And as James said, there may be a bug with the ^ operation. <br><br></td></tr></table><br>
<a name="482925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> bug is relative.<br>It is bound to the actual implementation of math which always casts to double and does double maths instead of floats or even integer where possible. <br><br></td></tr></table><br>
<a name="482935"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmmm... your probably right about the ^ bug...<br><br>This:<br><br> a=MilliSecs()<br>y#=0<br>For i= 1 To 100000000<br>y=y+i*i<br>Next<br>Print y<br>Print (MilliSecs()-a)<br><br>runs 5 times faster on MAX...<br><br>but this:<br><br>a=MilliSecs()<br>y#=0<br>For i= 1 To 1000000<br>y=y+Sin(i)<br>Next<br>Print y<br>Print MilliSecs()-a<br><br>runs 3 times faster on PLUS...<br><br>So there definetely is a bug with the ^ operator (20 times faster on plus!), but also the trigonometric functions should be checked (3 times faster on plus), and thats about it (is it?), oh well since were talking about it maybe check also log and everything else...<br><br>thx,<br><br>Matteo<br><br>Edit: I checked the "if" operator and its 3 times faster in MAX <br><br></td></tr></table><br>
<a name="482939"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It is bound to the actual implementation of math which always casts to double and does double maths instead of floats or even integer where possible. <br></div>Except it isn't. <br><br></td></tr></table><br>
<a name="482978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DNielsen</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it just me or can this be considered a MAJOR bug?? <br><br></td></tr></table><br>
<a name="482981"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was mentioned to be solved, from what I get out of the fix list of 1.02 I think it might already be fixed in the "real" version :) <br><br></td></tr></table><br>
<a name="482984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flying willy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Will mark be making compiler optimisations to Blitz3D? It would be nice if he can do a few hacks to speed stuff up :) <br><br></td></tr></table><br>
<a name="483069"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Is it just me or can this be considered a MAJOR bug?? <br> <br></div><br>It is... but it's been updated in the OS X release version, 1.02. You should <i>expect</i> to find bugs in the beta versions! They'll then be fixed for the release. <br><br></td></tr></table><br>
<a name="483102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DNielsen</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @BlitzSupport<br>Of course, and I agree. A BETA does have bugs! (all final products too) And thank goodness this one was found :-) It was MASSIVE! Excellent support as usual. <br><br></td></tr></table><br>
<a name="483194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you, thank you, it was easy...<br><br>crazy thing that my simulation app. DOUBLED in speed after I replaced two x^2 with x*x... however it still has an x^0.5 that slows it down (cant avoid that one...)<br><br>Oh, I checked "log()", and its 5 times faster in PLUS... another thing to check out definetely..<br><br>Looks like many of the low level math functions have to be checked out (definetely trig. functs, ^ and log, probably others).<br><br>BTW for other stuff MAX is really fast (sums, products), and the 2D drawing routines are perfect. <br><br></td></tr></table><br>
<a name="483348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MrCredo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> sin/cos etc.. use doubles - and they are slow<br>mark fix this soon (i think) <br><br></td></tr></table><br>
<a name="483360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LeisureSuitLurie</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> however it still has an x^0.5 that slows it down (cant avoid that one...) <br> <br></div><br><br>Why not sqrt(x)? <br><br></td></tr></table><br>
<a name="483415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> sqrt() does not exist in max <br><br></td></tr></table><br>
<a name="483419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> sqr() does though <br><br></td></tr></table><br>
<a name="483430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> awesome!<br><br>I had ONE ^0.5 in my code, now that I replaced it with sqr the whole thing runs 15(!!!!!!) times faster! Looks as ^ is a terrible bottle neck. <br><br></td></tr></table><br>
<a name="483469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Looks as ^ is a terrible bottle neck. <br> <br></div><br>... or has a bug which is due to be fixed in the next release. <br><br></td></tr></table><br>
<a name="483484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Najdorf</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah, i mean CURRENTLY its a bottle neck <br><br></td></tr></table><br>
<a name="483488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >flying willy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> ^ is fairly slow anyway afaik, and using multiplication where possible will be much faster - ie distance routines. <br><br></td></tr></table><br>
<a name="483703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eole</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> All the calculation are made with Double ... Just try a simple calculation with cos are sin ...<br><br>I already post about this here :<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=41987" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=41987</a><br><br><br>This is the answer of Mark:<br>marksibly (Posted 2004-12-28 20:14:19) <br> <br>Eole, <br><br>Please be aware that this is a *beta version*!!!!! <br><br>As it turns out, there are quite a few problems with the math funcs. Many of these problem are in the process of being fixed so don't panic just yet! <br><br></td></tr></table><br>
<a name="484093"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  sin/cos etc.. use doubles - and they are slow  <br></div>No they aren't. The FPU uses a much higher accuracy for calculations, so whether you chose to cast that result to a double or a float is the same difference. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
