<!DOCTYPE html><html lang="en" ><head ><title >Using an Access Database</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Using an Access Database</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Using an Access Database</a><br><br>
<a name="753790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Am i being really dumb when searching for "database" in the help files and not finding anything?<br>I want to use Maxgui to put a frontend on an Access Database.<br>Can someone point me to the right section of the Help Files so i can read up on it?<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="753793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no built-in database access, although there are a couple of 3rd party user modules that allow you to talk to a MySQL or PostgreSQL database... There may be something for MS Access as well, but I'm not sure about that. <br><br></td></tr></table><br>
<a name="753795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> if 3rd party then where should i start looking?<br>code archives, google etc <br><br></td></tr></table><br>
<a name="753796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> surely BlitzMax has some sort of ODBC connection? <br><br></td></tr></table><br>
<a name="753797"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> have a look at what gman's done. shame he didnt get a bit more support with his database api and driver idea, very slick...<br><br>personally I'd steer away from stand alone access (.mdb) files I've had them mince data quite effectivly.<br><br>You might want to search sqlite on the forums here depending on what you want to achieve <br><br></td></tr></table><br>
<a name="753800"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> i have downloaded the SQLite wrapper and followed Assaris tutorials. I have also bookmarked the SLQite homepage.<br><br>Thanks Chris and Xlsior for replying.<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="753848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gman's MySql module works wonderfully too. Just thought I'd confirm that as I've used it some. <br><br></td></tr></table><br>
<a name="756137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> What we need is a cross-platform ODBC database module :-)<br><br>Skid !?! <br><br></td></tr></table><br>
<a name="756161"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I want to use Maxgui to put a frontend on an Access Database. <br></div>Why oh why would you want to use an Access database in the first place? If you're going to use underpowered, obscure, databases, at least use one that's useful. Like Paradox.<br><br><div class="quote"> What we need is a cross-platform ODBC database module :-) <br></div>You mean like <a href="http://www.iodbc.org/" target="_blank">iODBC</a>? Already suggested it. If memory serves, the answer was no. <br><br></td></tr></table><br>
<a name="756217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mark Tiffany</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Presumably a very simple wrapper for an open, cross-platform, C/C++ based ODBC module (which I'll hazard a guess iODBC is) wouldn't be *that* hard...and if it could be hooked up with skid's revamping of linking maxgui gadgets to "data-sources"... <br><br></td></tr></table><br>
<a name="756220"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm starting to like the sound of this..<br>I hope someone starts running with it.. :) <br><br></td></tr></table><br>
<a name="756326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have some plans for a new cross-platform database module.<br><br>Another one, you say?<br>I want prepared statements in my SQLs, and I didn't fancy back-fitting that functionality into another module.<br><br>You know, kind of like :<br><pre class=code>
	' get a new query object 
	Local query:TDatabaseQuery = TDatabaseQuery.Create(db)

	' prepare the insert statement
	' by preparing it once, the database can reuse it on succesive inserts which is more efficient.
	query.prepare("INSERT INTO person values (NULL, ?, ?)")
	
	If db.hasError() Then
		errorAndClose(db)
	End If

	' iterate round the array inserting new entries
	For Local i:Int = 0 Until names.length
		query.bindValue(0, TDBString.Set(names[i][0]))
		query.bindValue(1, TDBString.Set(names[i][1]))

		query.execute()
		
		If db.hasError() Then
			errorAndClose(db)
		End If
	Next
</pre><br><br>I think I also want "Iterator" support for result sets.. which would tie in nicely with Lists and suchlike.<br><br>The nice thing with ODBC is, that once you have it working with one driver, it should (in theory) automagically work with all drivers.<br><br>And why have database-specific modules as well as ODBC?<br>ODBC is a bridge, so it's generally not as efficient as hitting the native drivers.<br><br><br>MySQL is currently being a bit of a pain in the arse with it's bindings, but it's getting there.<br><br><div class="quote"> ...the answer was no. <br></div><br>Who said no? BRL? That's not very surprising really.<br><br>Once MySQL is working, I'll have a go with ODBC. Can't be *that* hard, as Mark says ;-) <br><br></td></tr></table><br>
<a name="756353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I amazed by the sheer amount of thing you're working on Brucey.. :)<br><br>Maybe BRL should hire you!!?! ;) <br><br></td></tr></table><br>
<a name="756382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Maybe BRL should hire you!!?! ;) <br></div>Hrmmm... <br><br></td></tr></table><br>
<a name="756603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Maybe BRL should hire you!!?! ;) <br></div><br>I doubt NZD translated into GBP translated into ZAR would go very far in these parts :-p<br><br><div class="quote"> Hrmmm... <br></div><br>I vote this one as Mr Ducks most interesting post of the year to date :-) <br><br></td></tr></table><br>
<a name="756646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Amazing how many different data types there are...<br><br>..except on SQLite (where there are about 4, all told).<br><br>Am mostly happy with the SQLite and MySQL implementations now (except for some data type issues (blobs and date/time/datetime)<br>Other than that, my tests are working for standard execution and prepare/execute on those two.<br>Next up, ODBC, I suppose.<br>Since iODBC doesn't compile on Win2k, I've decided to plug into mingw's libodbc32 stuff on Windows, and will (attempt to) use iODBC on the rest.<br>If the statements are true (from the iODBC website/docs) I shouldn't need to change anything between the two implementations - we'll see... <br><br></td></tr></table><br>
<a name="756870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>If the statements are true (from the iODBC website/docs) I shouldn't need to change anything between the two implementations<br> <br></div><br>chokes on coffee! of course it *should* work an all three in -theory- oh look its a flying pig!<br><br>I look forward to seeing your db modules :) <br><br></td></tr></table><br>
<a name="757097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bit of a key-bashing session over the weekend. ODBC on Linux is working (at least, all my standard tests are!).<br>Tested connecting to MySQL via its ODBC Connector plugin.<br>Need to give it a go on Windows to see how compatible it is, still.<br>And I've yet to test any of it on Mac - cuz I've been busy getting it working firstly :-p<br>SQLite seems to be good too. And MySQL is done but for a seg-fault on Linux when doing some binding. Me thinks I went wrong somewhere there...<br><br>I might try connecting to Oracle via ODBC if I get a chance. Would be a nice example ;-) <br><br></td></tr></table><br>
<a name="757102"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interestingly, I've just ran all my ODBC tests on Windows... and would you believe it... it works!!<br>I say... great job to the iODBC developers!!!! (for the *nix port) :-) <br><br></td></tr></table><br>
<a name="757106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> And for interests sake... I've also got it Dropping/Creating a table, Inserting and Selecting from an Access Database, through ODBC.<br><br>Some notes.<br>* Access has its own peculiar syntax.<br>* Access doesn't handle prepared statements<br>* It's pants ;-) <br><br></td></tr></table><br>
<a name="757109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> And of course, Oracle...<br><br><pre class=code>
Building untitled2
Executing:untitled2.debug.exe
DebugLog:Oracle9i Enterprise Edition Release 9.2.0.1.0 - Production
</pre><br>from this...<br><pre class=code>	Local query:TDatabaseQuery = db.execute("select * from v$version where banner like 'Oracle%'")</pre> <br><br></td></tr></table><br>
<a name="757111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> and the only data store that has garbled my data award goes to..... access.mdb (wild cheering from the crowd)<br><br>great to hear odbc is going so well, I know of a few web designers that use a mysql db with odbc so they can use access's gui query generator<br><br>I was wondering.... how difficult to make would a sql gui be do you think, you know graphical relations, drag and drop some fields and out pops a generated sql. <br><br></td></tr></table><br>
<a name="757115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ...how difficult to make would a sql gui be do you think... <br></div><br>Me thinks that is out of the scope of my db framework ;-)<br><br>However, if you know what to select from the database, all the information is in there to build such a tool.<br><br>I'm not exposing all of the ODBC api (of which there seems to be a lot) since it's a generic wrapper, so there may be more stuff you can use to get at more information. <br><br></td></tr></table><br>
<a name="757116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I was wondering.... how difficult to make would a sql gui be do you think, you know graphical relations, drag and drop some fields and out pops a generated sql. <br></div>Fairly complex. Or you could just use something like <a href="http://www.microolap.com/" target="_blank">MicroOLAP</a> Database Designer (got versions for both MySQL and Postgres). <br><br></td></tr></table><br>
<a name="757612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alas the solutions you suggest are costly and only seem to run on some toy OS I don't have<br><br>I looked at the source to kexi and doing graphical relationships and simple queries ala access actually doesnt look too much of a nightmare<br><br>I'll have a look at your wrapper when its out and have a play with a few ideas... <br><br></td></tr></table><br>
<a name="758062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> The official word from BRL:<br>Hi Glenn,<br><br>I'm pretty sure this won't be coming any time soon -- Blitz is heavily biased towards game development and Access support isn't something we've ever found in real demand from Blitz users over the years.<br><br>Sorry!<br>James/Blitz Support.<br><br><br><br><br>Glenn wrote:<br>&gt; I don't suppose it is on the BRL "to do" list?<br>&gt; I have an access database with a VB6 frontend which i want to convert <br>&gt; to BlitzGui and having to recreate the database is just an extra <br>&gt; effort i hadn't expected.<br>&gt;<br>&gt; Cheers<br>&gt; Glenn<br>&gt;<br>&gt;&gt; Hi Glenn,<br>&gt;&gt;<br>&gt;&gt; Just to confirm, there's no built-in database access in Blitz, but I <br>&gt;&gt; see from the thread that you've found a couple of the 3rd-party <br>&gt;&gt; options anyway.<br>&gt;&gt;<br>&gt;&gt; James/Blitz Support.<br>&gt;&gt;<br>&gt;&gt;<br>&gt;&gt; glenn@... wrote:<br>&gt;&gt;&gt; Hello,<br>&gt;&gt;&gt; I have just started a thread in the beginners area for how to <br>&gt;&gt;&gt; connect to an MS Access Database. Initial feedback is not promising.<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; Can i connect to an Access Database with Maxgui?<br>&gt;&gt;&gt;<br>&gt;&gt;&gt; Cheers<br>&gt;&gt;&gt; glenn<br><br>Also for Flameduck: <br>I guess like a lot of people i have grown up using MS Access. Doesn't matter whether it is good or not, it is just what i know and and familiar with.<br>Proper developers at work scoff at Access too, but when i need something done in a hurry the IT Dept doesn't have the time or resource to do it properly in SQL Server. I can query the SQL databases but i can't create anything. So i pull the data to MS Access where i can create new tables, do my queries and use the macros for the email functions.<br>It isn't the best way to do it, nor is it "technically supported" by IT, but it works and gets the job done.<br>I work in Operations with a $200 Million wage budget each year, and when i need to analyse a change to Operational Procedures, i really can't wait 6 months for IT to be free to help me.<br>And i used VB6 for a front end because thats what i grew up with too.<br><br>I LOVE using BLitzMax, although for the last few months i seem to spend more time reading these forums than actual programming. The projects i use to teach myself, other than the great tutorials to be found here, are replicating small tasks i have done in VB and MS Access, plus i have a simple little game i wrote in BlitzBasic when it was on the Amiga.<br>Well it is 8.30am here in New Zealand so i suppose i better wander off to work for another "fun filled" day, till i can check the forum again when i get home.<br><br>I hope you all have a great day and i am keen to follow Brucey's DB Framework and Chris C's modifications.<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="758075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >computercoder</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't feel estranged there Glenn. I too started with MS Access and dBase databases! I've since moved along to SQL Server, Oracle, DB2, and Informix. Yup... been all over as far as those go.  I also admit that a "down and dirty" deal can be easily done using MS Access, but I also scoff at its use for much else than personal or really quick-fix solutions (extremely temporary).<br><br>Don't fret over using VB6 or any of the VB languages with a database. Its extremely common for any business to use VB with a database. Mostly, database work doesn't demand cutting-edge speeds that C/C++ or other lower level languages offer. Working a GUI with a database should be pretty casual unless there is an explicit real-time need for the speed. Even then, you will wait on the database.<br><br>I understand the wait period for IT. I'm a professional software engineer and we have a HUGE plate filled with projects eagerly awaiting our time! <br><br></td></tr></table><br>
<a name="758118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Chris C's modifications. <br></div><br>god no!, now what have i got myself roped into, I was just gonna cobble some stuff up on top of Brucies mod once he gets done...<br><br>BTW I often used to use access as a front end to a number of database backends via ODBC, using linked tables it made a fairly reasonable gui.<br><br>I looked at it again just recently, a mates on some beta program and gets sent loads of junk from bill and access  sadly seems to be a *lot* more bloated and slow nowadays (does anyone use all that stuff! talk about feature creep!).<br><br>It would be nice to see some cross platform system to decouple RAD GUI and backend that was both flexible and light weight, after 20+ years I'm still looking...<br><br>now I think about it I remember talking to this sales guy more than ten years ago now, he said in a few years everyone would be programming from graphical blocks and drawing connecting lines, it would be so efficient and easy for the computer to optimise that even OS's would be written using it, wonder what happened to that guy... <br><br></td></tr></table><br>
<a name="758799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm just tidying up the docs - my *favourite* part (Not!).<br>Hate to release a module without reasonably full documentation - (hey, what can I say... I personally don't like downloading someone else's module and having to read the module source-code to work out how to use it!! And for those who say, "what do you want, it's free!?", I say, bollocks ;-)<br><br>Anyhoo... The ODBC module will have in the tests folder an Access test example (cuz I needed to see for myself if it would work!).<br>Spent 4-5 hours on Friday (ack!) fixing a single MySQL bug on Linux/Mac... but am happy to say it works now :-)<br>Am currently also almost finished the PostgreSQL module, but I'll probably release the others before that's done.<br>(although it depends how long it takes to get the docs finished really).<br><br>I use Oracle mostly at work. It's not as nice as Informix though (which I've learned over the weekend, spawned from the same home as Postgres!). Also use MySQL as the backend for tools/utils I make for the office.<br><br>;-) <br><br></td></tr></table><br>
<a name="758832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> i look forward to this one! another quality Brucey product and the price is right (good game, good game) :o) <br><br></td></tr></table><br>
<a name="758839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> btw, I also added the ability to retrieve records either in the traditional style:<br><pre class=code>
While query.nextRow()
	Local record:TQueryRecord = query.rowRecord()
	....
Wend
</pre><br>or the Max way:<br><pre class=code>
For Local record:TQueryRecord = EachIn query
	....
Next
</pre><br>which some people like ;-)<br><br>Will try to get most of the docs done this evening... *sigh* <br><br></td></tr></table><br>
<a name="758861"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SoggyP</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello.<br><br>Looking forward to seeing this.<br><br>MS Access as a tool is fine in what it does, provided as others have mentioned, that you're not too ambitious with it.  Using it as a front end to SQL Server it's a great tool.<br><br>Goodbye. <br><br></td></tr></table><br>
<a name="759068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay... I've uploaded the stuff to the website : <a href="http://brucey.net/programming/blitz/index.php" target="_blank">http://brucey.net/programming/blitz/index.php</a><br><br>Currently there are drivers for MySQL, ODBC, and SQLite.<br>PostgreSQL driver is still being worked on.<br><br>Included in the ODBC module is an Access test app, just to prove to myself it worked.<br><br>Have tested ODBC on Windows to Access and Oracle, and on Linux to MySQL (using MyODBC).<br>MySQL was tested on Windows, Mac and Linux.<br>SQLite was tested on Windows, Mac and Linux.<br><br>Let me know if you have any problems (with the modules!).<br>Can't help you with SQL I'm afraid. There are plenty of docs online for that ;-)<br>And... I can't help you set up ODBC stuff either. (do you really want everything handed to you on a silver platter? :-p )<br><br>Obviously, there may still be some bugs lying around. Please report if you find anything.<br><br>General comments are also appreciated.<br><br><br>PS. If you just want to mess about with it, I would say the SQLite database is the easiest, as it requires no configuration. <br><br></td></tr></table><br>
<a name="759084"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent work seems to work well overall.<br><br>Some tests need to have have "db.exceute" changed to db.executeQuery to run (SQLite samples, 1- 4) <br><br>I can't seem to compile the MySql test 1 , I get:<br><pre class=code>
C:/xxx/BlitzMax/bin/ld.exe: cannot open C:/xxx/BlitzMax/tmp/ld.tmp
-LC:/xxx/BlitzMax/mod/bah.mod/dbmysql.mod/lib/win32: Invalid argument
Build Error: Failed to link C:/xxx/BlitzMax/mod/bah.mod/dbmysql.mod/tests/test_01.debug.exe
</pre> <br><br></td></tr></table><br>
<a name="759091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh... yeah...  ho hum<br><br>My fault ;-)<br>(my fault for hacking stuff so much)<br><br>That uses a currently unreleased fix to bmk which allows linking outside of BlitzMax/lib. (there's a page in Module Tweaks that shows the actual change)<br><br>For now, I guess you can copy the "libmysql.a" file (that is in lib/win32) to your BlitzMax/lib folder and comment out that Import "-L..." line.<br><br>Sorry :-/<br><br>... coding on Linux/Mac is *so* much easier ;-) <br><br></td></tr></table><br>
<a name="759092"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Some tests need to have have "db.exceute" changde to db.executeQuery to run (SQLite samles, 1- 4)  <br></div><br>I thought I'd gone over all of them and fixed that.<br><br>Someone needs to write a Refactoring tool for the IDE :-p <br><br></td></tr></table><br>
<a name="759500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> The new Windows DBMySQL module (on the site) now expects libmysql.a to be in the BlitzMax/lib folder, which will need to be copied there from the module lib/win32 folder.<br><br><br>Finally got the PostgreSQL driver running on both Windows and Linux. Again, a .a file will need placing in the lib folder for that one. Works very well, now that I've worked out how to enable TCP/IP on the server ;-)<br>Need to try out some Mac tests this evening...<br><br>Am also interested in adding a <a href="http://www.firebirdsql.org/" target="_blank">Firebird</a> driver, but there's an issue with BMK (yes, again...) which stops me dead in my tracks at the moment.<br>Well, I've amended my bmk, and the library compiles now, but it's a bit of a pain...<br><br>Apart from those, I can't think of any other databases that would be good to have drivers for.<br>(Yeah, there's Oracle, but for now I'm happy with the ODBC to talk to that. For now... ;-) <br><br></td></tr></table><br>
<a name="759501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> If someone can give a report on any success connecting to Access databases, it would be much appreciated.<br><br>Will I really need to add documentation to the ODBC module to explain how to configure DSNs? <br><br></td></tr></table><br>
<a name="760406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry guys, I am a newbie to using someone elses modules. I have copied the bah.mod folder to the blitzmax mod folder. When i tried to use the ODBC (access) test1 file it gives me an error of :<br>Building test_01<br>Compiling:test_01.bmx<br>Compile Error: Can't find interface for module 'bah.database'<br>[C:/Program Files/BlitzMax/mod/bah.mod/dbodbc.mod/dbodbc.release.win32.x86.i;10;1]<br>Build Error: failed to compile C:/Program Files/BlitzMax/mod/bah.mod/dbodbc.mod/tests/test_01.bmx<br>Process complete<br><br>Unfortunately i have no idea what this means...<br><br>Any help appreciated<br>Glenn <br><br></td></tr></table><br>
<a name="760408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> figured it out...<br>I often hear you all talking about rebuilding modules, so i clicked on it.<br>That told me that bah.database wasn't available.<br>Whan i checked i found i hadn't copied that folder across. All i had moved was the bah.dbodbc folder. so i moved the other 3 folders and recompiled the modules. The test works now.<br><br>On a side note, i syncmod every few days. do i need to rebuild modules after this? i saw heaps (1/3 of files) needed to be compiled.<br>is this expected? i don't really know anything about this.<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="760533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzplotter</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Glenn, interesting thread, I'm just about to submit an (access) relational database college assignment in two days.  My weeks pretty full but I'll look forward to giving this code a whirl this weekend.<br><br>I to am getting to be a forum addict - it's all too easy to be sidetracked from finishing the hum drum stuff.  Regards - Mark. <br><br></td></tr></table><br>
<a name="760587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Brucey i still need a little help.<br>I have copied your modules to the mod folder.<br>I have moved the DSN (maxtest) to my default dsn folder (C:\Program Files\Common Files\ODBC\Data Sources) and done a reboot.<br>When i run Test1 i get the following error:<br><br>Building test_01<br>Compiling:test_01.bmx<br>flat assembler  version 1.66<br>3 passes, 7134 bytes.<br>Linking:test_01.debug.exe<br>Executing:test_01.debug.exe<br>DebugLog:(2) Error opening connection : [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified : <br><br>Process complete<br><br>I am familiar with DSNs from using Visual Basic.<br>I have done things like creating my own DSN (file DSN), creating my own database and putting in extra debuglog lines just to confirm where the error is, but i still get this error.<br><br>I know it will be something really simple but i can't see it. Can you help?<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="760597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Difference</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> I got the access test running by editing the enclosed DSN file in a text editor. I just changed the path to fit where the files are located on my computer. <br><br></td></tr></table><br>
<a name="760617"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is my LoadDatabase line:<br><br>Local db:TDBConnection = LoadDatabase("ODBC", "Glenn", Null, Null, Null, Null, "GlennDSN")<br><br>where Glenn is a database (access 2003) saved as c:\Glenn.mdb<br><br>GlennDSN is the DSN entry, as below:<br><br>[ODBC]<br>DRIVER=Microsoft Access Driver (*.mdb)<br>UID=admin<br>UserCommitSync=Yes<br>Threads=3<br>SafeTransactions=0<br>PageTimeout=5<br>MaxScanRows=8<br>MaxBufferSize=2048<br>FIL=MS Access<br>DriverId=25<br>DefaultDir=C:\<br>DBQ=C:\Glenn.mdb<br><br>This is the default data and i haven't modified it in any way.<br>I am using Test_01 from the odbc folder<br>Here are the first few lines<br><br>SuperStrict<br><br>Framework BaH.DBODBC<br><br><br>'                                             database                                   dsn name<br>Local db:TDBConnection = LoadDatabase("ODBC", "Glenn", Null, Null, Null, Null, "GlennDSN")<br><br>If Not db Then<br>	DebugLog("Didn't work...")<br>	End<br>End If<br><br>If db.hasError() Then<br>	errorAndClose(db)<br>End If<br>DebugLog( "Database Loaded")<br><br><br>I keep getting db.hasError().<br><br>Any ideas appreciated.<br><br>Regards<br>Glenn <br><br></td></tr></table><br>
<a name="760688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Glenn.<br><br>As you know there are several ways to create a DSN.<br>The Access example I provided uses the FileDSN method, which requires a full path to the .dsn file.<br><br>The other method requires the ODBC data source to be configured through the system.<br>To do this on my win2k box, I go to Control Panel, Administrative Tools, and open Data Sources (ODBC).<br>On the UserDSN tab, I click Add, choose Microsoft Access Driver, and give it a Data Source Name of GlenDSN.<br>I then Select the .mdb file, and finish up by hitting OK.<br><br>This adds an internal DSN to my installation. I had a look in C:\Program Files\Common Files\ODBC\Data Sources, but that folder is empty on my box, so I guess it puts it somewhere else. (perhaps that is a SystemDSN?)<br><br>Anyhoo... changing the Access test prog from:<br><pre class=code>Local db:TDBConnection = LoadDatabase("ODBC", "maxtest", Null, Null, "brucey", "brucey", CurrentDir() + "/maxtest.dsn")</pre><br>to<br>[/code]Local db:TDBConnection = LoadDatabase("ODBC", "maxtest", Null, Null, "brucey", "brucey", "GlenDSN")[/code]<br>it still works.<br><br>Remember, if you specifically want to access a .dsn file, you will need to provide a full path to it.<br>Otherwise, I believe configuring it through the proper application is the best way.<br><br>Of course, I could be talking complete nonsense ;-)<br>(but my tests on all three platforms have worked best when I've configured things through the appropriate GUIs)<br><br>:o) <br><br></td></tr></table><br>
<a name="760703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well that was simple. I changed from FileDSN to UserDSN and i don't get that same error.<br>I was originally going to use this but once i had copied your maxtest dsn file to the specified directory i saw it show up on the File DSN menu, not User DSN.<br><br>Now i am getting this. I am currently trying to diagnose it...<br><br>DebugLog:(3) Error executing statement : [Microsoft][ODBC Microsoft Access Driver] Syntax error in CREATE TABLE statement. : <br><br><br>And the line it doesn't like is <br>DebugLog:CREATE TABLE person (id integer primary key AUTO_INCREMENT,  forename varchar(30), surname varchar(30) )<br><br><br>odd that it works for you but not me. again it must be something really simple i am not doing properly...<br><br>Oh well, the joy of programming...<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="760706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well i have confirmed the database is opening properly and existing tables can be seen (used test_05 for this and a table i had created).<br>I know it is dropping the table as a second call to test_05 shows the table is gone.<br>It is now reporting a error with an error number. I am checking for what this means...<br><br>Building test_01<br>Compiling:test_01.bmx<br>flat assembler  version 1.66<br>3 passes, 9658 bytes.<br>Linking:test_01.debug.exe<br>Executing:test_01.debug.exe<br>DebugLog:Database Loaded<br>DebugLog:Database is Opened<br>DebugLog:what tables exist<br>DebugLog:   1.   person<br>DebugLog:   2.   tblTest<br>DebugLog:Table Dropped<br>DebugLog:what tables exist after dropping Person<br>DebugLog:   1.   tblTest<br>DebugLog:s = CREATE TABLE person (id integer primary key AUTO_INCREMENT,  forename varchar(30), surname varchar(30) )<br>DebugLog:Tried to Execute Query<br>DebugLog:(3) Error executing statement : [Microsoft][ODBC Microsoft Access Driver] Syntax error in CREATE TABLE statement. (-3551)  : <br><br>Process complete <br><br></td></tr></table><br>
<a name="760721"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem seems to be AUTO_INCREMENT.<br>Take this word out and the table is created.<br><br>of course the next section of code tries to pass NULL to an auto-incrementing value and fails, because i took auto-increment out...<br><br>So i have 2 sets of Debug:<br>1::: Auto_increment IN<br>Building test_01<br>Compiling:test_01.bmx<br>flat assembler  version 1.66<br>3 passes, 7804 bytes.<br>Linking:test_01.debug.exe<br>Executing:test_01.debug.exe<br>DebugLog:Database Loaded<br>DebugLog:Database is Opened<br>DebugLog:Table Dropped<br>DebugLog:s = CREATE TABLE person (id integer primary key AUTO_INCREMENT,  forename varchar(30), surname varchar(30) )<br>DebugLog:Tried to Execute Query<br>DebugLog:(3) Error executing statement : [Microsoft][ODBC Microsoft Access Driver] Syntax error in CREATE TABLE statement. (-3551)  : <br><br>Process complete<br><br><br>2::: Auto_increment OUT<br>Building test_01<br>Compiling:test_01.bmx<br>flat assembler  version 1.66<br>3 passes, 7776 bytes.<br>Linking:test_01.debug.exe<br>Executing:test_01.debug.exe<br>DebugLog:Database Loaded<br>DebugLog:Database is Opened<br>DebugLog:Table Dropped<br>DebugLog:s = CREATE TABLE person (id integer primary key,  forename varchar(30), surname varchar(30) )<br>DebugLog:Tried to Execute Query<br>DebugLog:No Error creating the table<br>DebugLog:(3) Error executing statement : [Microsoft][ODBC Microsoft Access Driver] Index or primary key cannot contain a Null value. (-1053)  : <br><br>Process complete<br><br>Not quite sure where i go to now. i guess i start looking at the modules for a keyword listing?<br>According the MS Access 2003 help the value should be PRIMARY KEY | UNIQUE | NOT NULL <br><br><br>Hmmm.<br>Just entered the above and got passed the auto_increment problem BUT now have<br><br>Building test_01<br>Compiling:test_01.bmx<br>flat assembler  version 1.66<br>3 passes, 7808 bytes.<br>Linking:test_01.debug.exe<br>Executing:test_01.debug.exe<br>DebugLog:Database Loaded<br>DebugLog:Database is Opened<br>DebugLog:Table Dropped<br>DebugLog:s = CREATE TABLE person (id integer PRIMARY KEY UNIQUE NOT NULL ,  forename varchar(30), surname varchar(30) )<br>DebugLog:Tried to Execute Query<br>DebugLog:No Error creating the table<br>DebugLog:(3) Error executing statement : [Microsoft][ODBC Microsoft Access Driver] The field 'person.id' cannot contain a Null value because the Required property for this field is set to True.  Enter a value in this field. : <br><br>Process complete<br><br>so now i guess the line:<br>		db.executeQuery("INSERT INTO person values (NULL, '" + names[i][0] + "', '" + names[i][1] + "')")<br><br>is a problem.<br><br>No rest for the wicked... <br><br></td></tr></table><br>
<a name="760745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh... wondered if you'd pick up on those issues.<br><br>The SQL you use for ODBC is *generally* cross-database safe - that is, if you use ANSI-standard SQL.<br><br>However, many databases, like Access, use non-standard syntax. Which is the problem you have come across ;-)<br><br>The actual tests for the ODBC module are assuming an ODBC connection to a MySQL database.<br>So, they'd need to be "tweaked" to work on Access.<br><br>To create the auto incrementing column in my example, I used:<br><pre class=code>id counter constraint pk primary key</pre><br>I guess, "counter" is the important bit. Remember, this won't work for say, MySQL.<br><br>(In Access,) To insert into a table where one field is auto-incrementing, you need to leave out the field as part of the insert. In MySQL you can pass Null. In Postgres, I think you've to pass 0. (Well, it's 0 in Oracle...)<br><br>Thus, to insert into person, the easiest way is to show what fields you intend inserting into :<br><pre class=code>
INSERT INTO person ( forename, surname )
VALUES ('brucey', 'bonus');
</pre><br>Which would cause the missing "id" field to be populated with the "next" value in its sequence.<br><br><br>I suggest you try reading the Access syntax documentation. Alas, as I've discovered, it's close to the worst documentation I've read when trying to find something specific. (it took me about 20 mins to find out I had to use  "counter" for an auto-incrementing column).<br><br>I suggest you look at the access example to get an idea of the difference between the SQL Access needs and what MySQL requires.<br><br>btw, the reason I didn't do *all* the tests in Access, is because I haven't the time to work it out myself... since my Win32 time is relegated to the work PC.<br><br>:o) <br><br></td></tr></table><br>
<a name="760746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh.. and if you don't want it to auto-increment (the id field), you'll need to keep track of it yourself...<br><pre class=code>SELECT max(id) from person</pre><br>and then add one to that value when you insert...<br><br>Using an automatic counter is less hassle :-) <br><br></td></tr></table><br>
<a name="760838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks Brucey.<br>I should have picked up the "don't use NULL for autonumber fields" myself (because thats what i do in VB) but i have been off work for the last 2 days due to being sick, pretty much the only reason i have had the time to play...<br><br>Your modules are fantastic and i am sure heaps of people will find them very useful.<br>I wonder if BRL will incorporate them? I don't seem to have been the only person wanting database support.<br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="760961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CreativeBrain</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just wanted to say thanks for the work and I am one of those heaps of people who find this useful ;) <br><br></td></tr></table><br>
<a name="760963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pleasure as ever :-) <br><br></td></tr></table><br>
<a name="762790"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Glenn Dodd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought i would add this test code for any Microsoft Access users wanting to use Bruceys module.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

Framework BaH.DBODBC
' Don't mind all the debuglog statements. It took me ages to get this working properly so i have left them in for any other people
' I created a blank MS Access database on my C: drive called Glenn.mdb
' The DSN name points to this database
'                                             database                          dsn name
Local db:TDBConnection = LoadDatabase("ODBC", "Glenn", Null, Null, Null, Null, "GlennDSN")

If Not db Then
	DebugLog("Didn't work...")
	End
End If

If db.hasError() Then
	errorAndClose(db)
End If
DebugLog( "Database Loaded")

If db.isOpen() Then
	DebugLog ("Database is Opened")
	' we don't care if the drop table fails, since it might not exist yet...
	db.executeQuery("DROP TABLE person")
	DebugLog ("Table Dropped")
	Local s:String = "CREATE TABLE person (id counter PRIMARY KEY UNIQUE NOT NULL , forename varchar(30), surname varchar(30))"
	DebugLog ("s = " + s)
	db.executeQuery(s)
	DebugLog ("Tried to Execute Query")

	If db.hasError() Then
		errorAndClose(db)
	End If
	DebugLog ("No Error creating the table")

	Local names:String[][] = [ ..
	[ "Alfred", "Aho" ],   ..
	[ "Brian", "Kernighan" ], ..
	[ "Peter", "Weinberger" ] ]

	For Local i:Int = 0 Until names.length
		Local s:String = "INSERT INTO person ( forename, surname ) VALUES ('brucey','bonus')"
		DebugLog ("s = " + s)
		db.executeQuery(s)
		If db.hasError() Then
			errorAndClose(db)
		End If
	Next
	DebugLog ("First Insert SUCCEEDED")
	Local query:TDatabaseQuery = db.executeQuery("SELECT * from person")
	If db.hasError() Then
		errorAndClose(db)
	End If

	DebugLog ("Now read the records")
	While query.nextRow()
		Local record:TQueryRecord = query.rowRecord()
		DebugLog("Name = " + TDBString(record.value(1)).value + " " + TDBString(record.value(2)).value)
	Wend

' Now use the INSERT command to add some new values
	For Local i:Int = 0 Until names.length
		Local s:String = "INSERT INTO person ( forename, surname ) VALUES ('" + names[i][0] + "', '" + names[i][1] + "')"
		DebugLog ("s = " + s)
		db.executeQuery(s)
		If db.hasError() Then
			errorAndClose(db)
		End If
	Next
	DebugLog ("Second Insert SUCCEEDED")
	Local query1:TDatabaseQuery = db.executeQuery("SELECT * from person")
	If db.hasError() Then
		errorAndClose(db)
	End If

	DebugLog ("Now read the records")
	While query1.nextRow()
		Local record:TQueryRecord = query1.rowRecord()
		DebugLog("Name = " + TDBString(record.value(1)).value + " " + TDBString(record.value(2)).value)
	Wend
	
	DebugLog ("and finally CLOSE the database")
	db.close()
	
End If

Function errorAndClose(db:TDBConnection)
	DebugLog(db.error().toString())
	db.close()
	End
End Function
</textarea><br><br>and here is the final output:<br><br>Building Bruceys-MS-Access-Module_Test<br>Compiling:Bruceys-MS-Access-Module_Test.bmx<br>flat assembler  version 1.66<br>3 passes, 11118 bytes.<br>Linking:Bruceys-MS-Access-Module_Test.debug.exe<br>Executing:Bruceys-MS-Access-Module_Test.debug.exe<br>DebugLog:Database Loaded<br>DebugLog:Database is Opened<br>DebugLog:Table Dropped<br>DebugLog:s = CREATE TABLE person (id counter PRIMARY KEY UNIQUE NOT NULL , forename varchar(30), surname varchar(30))<br>DebugLog:Tried to Execute Query<br>DebugLog:No Error creating the table<br>DebugLog:s = INSERT INTO person ( forename, surname ) VALUES ('brucey','bonus')<br>DebugLog:s = INSERT INTO person ( forename, surname ) VALUES ('brucey','bonus')<br>DebugLog:s = INSERT INTO person ( forename, surname ) VALUES ('brucey','bonus')<br>DebugLog:First Insert SUCCEEDED<br>DebugLog:Now read the records<br>DebugLog:Name = brucey bonus<br>DebugLog:Name = brucey bonus<br>DebugLog:Name = brucey bonus<br>DebugLog:s = INSERT INTO person ( forename, surname ) VALUES ('Alfred', 'Aho')<br>DebugLog:s = INSERT INTO person ( forename, surname ) VALUES ('Brian', 'Kernighan')<br>DebugLog:s = INSERT INTO person ( forename, surname ) VALUES ('Peter', 'Weinberger')<br>DebugLog:Second Insert SUCCEEDED<br>DebugLog:Now read the records<br>DebugLog:Name = brucey bonus<br>DebugLog:Name = brucey bonus<br>DebugLog:Name = brucey bonus<br>DebugLog:Name = Alfred Aho<br>DebugLog:Name = Brian Kernighan<br>DebugLog:Name = Peter Weinberger<br>DebugLog:and finally CLOSE the database<br><br>Process complete<br><br><br>Cheers<br>Glenn <br><br></td></tr></table><br>
<a name="762818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad you've sorted it all out at last :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
