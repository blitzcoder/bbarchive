<!DOCTYPE html><html lang="en" ><head ><title >API declaring and Extern statement questions</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >API declaring and Extern statement questions</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >API declaring and Extern statement questions</a><br><br>
<a name="543465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> All, I have some question that puzzles me quite a lot.<br><br>1)<br>What does Extern clause means ? What do I include with this sentence:<br><pre class=code>
Extern "Win32"
.
End Extern
</pre>Do I refer to the Win32.DLL API here ? Or what else ?<br><br><br>---------------------------------------<br>2) Why this code:<br><pre class=code>
Extern "Win32"

	Function WinExec (lpCmdLine:Byte Ptr,nCmdShow=10)

End Extern

WinExec ("calc.exe")
</pre>works, even if WinExec is not contained in Win32.DLL, rather in the Kernel32.DLL ? WinExec is also not declared in Kernel.bmx .<br><br><br>---------------------------------------<br>3) In the Win32.bmx the SendMessage function is declared, but if I call it from within a bmx program, it does not work. If I declare, instead, a SendMessageA function, and call it, then works. So why SendMessage has been declared, and not SendMessageA instead ?<br><br>So, how should I declare an API function to be used in my .bmx sources ? I'm quite confused here, any help would be appreciated.<br><br>Sergio. <br><br></td></tr></table><br>
<a name="543467"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> as I understand it the "Win32" bit is the calling convention<br>you should use extern "C" for code included from your C routines, could be wrong, its not documented (at all) like other advanced topics - still I suppose that will come with time <br><br></td></tr></table><br>
<a name="543477"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well there are two ways of doing this,<br><br><b>First</b>: you can add the right winapi commands in the win32.mod folder and compile then have fun.<br><br><b>Second</b>: this one is much better,<br><br>Extern "Win32" is good for releasing a open-source or other program so that people can just use it straight away and is faster for the developer to work with rather than having to put all the api commands in win32.mod folder and compiling each time.<br><br>Extern "Win32" ' which calls the right win32 lib file which can be located in "BlitzMax\Lib" not "win32.dll", if you have trouble with the win32 lib file being called then you can do,<br><pre class=code>
Import "-ladvapi32" ' this will call advapi32.a from the lib folder then you can do

Extern "Win32"
      Function RegCloseKey( hKey:Int ) = "RegCloseKey@4"
End Extern

Local key:int

RegCloseKey( key )
</pre><br>If you have SendMessage in user32.mod you can also use SendMessageA which is the same thing as SendMessage, most win32 commands need <br>ex: Function SendMessage( hWnd,MSG,wParam,lParam ) = "SendMessage@4"<br><br>that is not a working example but you will get the idea, the debugger will tell you the correct "SendMessage@".<br><br>well i hope that cleared it all up for you. <br><br></td></tr></table><br>
<a name="543568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >semar</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> That cleared a bit, thank you, but I must admit, I'm still confused..<br><br>If I have, for example, a function inside MyDll.DLL, how can I access to it ?<br><br>I would then write:<br>Extern "MyDll.DLL"<br>function myfunction(etc. etc.)<br>End Extern<br><br>I guess this is not the way.. but if so, where is the WinExec declared, for example ? It's not in the Win32.BMX file, and neither in the included files..<br><br>??<br><br>Sergio. <br><br></td></tr></table><br>
<a name="543575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> abstract from mikmod player for bmax<br><br>Global mikmod=LoadLibraryA( "mikmak" )<br>Global MikMod_RegisterAllDrivers()"win32"=getprocaddress(mikmod,"MikMod_RegisterAllDrivers")<br>Global Voice_RealVolume:Short(voice:Byte)=getprocaddress(mikmod,"Voice_RealVolume")<br><br>you'll need the pub.win32 module for getprocaddress and loadlibraryA<br><br>the dll being used here is mikmak.dll <br><br></td></tr></table><br>
<a name="543579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I guess this is not the way.. but if so, where is the WinExec declared, for example ? It's not in the Win32.BMX file, and neither in the included files.. <br></div><br>Well the win32.mod is not completed yet, it is missing alot of functions. I guess they will finish it when the gui mod is released.<br><br>So for now all we can do is Extern the missing commands until its finished. <br><br></td></tr></table><br>
<a name="543594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> check out the samples, birdie, mods, twin32 <br><br></td></tr></table><br>
<a name="543604"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup i know but half dont even work, i had to put most the refrences ect. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
