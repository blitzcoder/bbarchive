<!DOCTYPE html><html lang="en" ><head ><title >Writing to a binary file</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Writing to a binary file</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Writing to a binary file</a><br><br>
<a name="1068596"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've looked and can't find the answer :(<br><br>When writing to a binary file, I know about WriteFloat, Write Int etc.<br><br>But when reading them back, you really need to know how long a string is.<br><br>Can you define a String as being a fixed length?  I'm sure I've seen it done in a tutorial but for the life of me I can't find it.  Without this it's impossible to save a string into a binary file is it not? <br><br></td></tr></table><br>
<a name="1068597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> write an int first, which denotes the length of the string, then the string itself. <br><br></td></tr></table><br>
<a name="1068607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alternatively, use <i>WriteLine</i>/<i>ReadLine</i>. <br><br></td></tr></table><br>
<a name="1068612"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm pretty sure that a string has a termination character in a binary file -- perhaps chr$(0) ? <br><br></td></tr></table><br>
<a name="1068627"></a>

<a name="1068628"></a>

<a name="1068629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's new line/null terminated if you use <i>WriteLine</i>/<i>ReadLine</i>, but not if you use <i>WriteString</i>/<i>ReadString</i> which needs to know the strings length. Hence my suggestion.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1068739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Read/WriteLine is the easiest way. <br><br></td></tr></table><br>
<a name="1068895"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks.  I'll have a play around with both suggestions (using an int to show string length) and also writeline/readline.  <br><br>My other preferred option is using an Access Database (yes I know) or SQL lite Database.  I've read a bit about both of these - requires a Brucey MOD? but most of it currently goes right over my head. <br><br></td></tr></table><br>
<a name="1068897"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried SQL once but it was more trouble than it's worth. If it's just for general game data files, XML is very good. Easy to program, design and also edit by hand if needed.<br><br>&lt;level num="1"&gt; &lt;player num="1" name="Bob" lives="3" ammo="10" /&gt; &lt;/level&gt;<br>Whatever! <br><br></td></tr></table><br>
<a name="1068901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's actually for a cricket game I'm trying to write.  A database really is the best approach since there could be hundreds of players in the database and it would be useful to have sort capabilities on several different columns.<br><br>I know you can do this with XML, just a matter of reading the file and grabbing what you want etc, but if I remember my SQL correctly (and I probably don't), it allows you to easily do something like:<br><br>SELECT * FROM PlayerTable WHERE HighScore =&gt; 100 SORT BY ASC HighScore;<br><br>It's just a matter of stepping through the resulting rows and displaying the data etc. <br><br></td></tr></table><br>
<a name="1068912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I recommend you take a look at SQLite -- there are several SQLite modules for blitzmax, that allow you to easily store data and run queries like that from a single flat file, without the need of any other installed database engines or the likes.<br><br>Brucey's bah.sqlite module is pretty easy to use, no idea about how well the others work. <br><br></td></tr></table><br>
<a name="1068915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's some Purebasic code that I use for writing and reading Blitz3D style strings consisting of a length header followed by the string data. It's heavily commented, so it should be possible to convert it to BlitzMax code.<br><br>Note that in Purebasic the @ character is used to return the memory location of the string it is placed in front of.<br><br><pre class=code>Procedure WriteDataString( file, data_string.s )
	; NOTES: Writes out the string data in the 'data_string.s' parameter with an integer length header at the start.
	; The file should already be opened for writing with its file ID specified in the 'file' parameter.
	Protected size ; Set local variables.
	size = Len( data_string.s ) ; Obtain the size of the string to use as the length header.
	WriteLong( file, size ) ; Write out the length header.
	WriteData( file, @data_string.s, size ) ; Write out the main string data.
EndProcedure

Procedure.s ReadDataString( file )
	; NOTES: Reads in string data which has an integer length header at the start.
	; The string data should have been written out using 'WriteDataString()'.
	; The file should already be opened for reading with its file ID specified in the 'file' parameter.
	Protected size, data_string.s ; Set local variables.
	size = ReadLong( file ) ; Read in the length header.
	data_string.s = Space( size ) ; Create a string filled with the specified number of space characters.
	ReadData( file, @data_string.s, size ) ; Read in the main string data.
	ProcedureReturn data_string.s ; Return the string that was read in.
EndProcedure</pre> <br><br></td></tr></table><br>
<a name="1068976"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Bill.  I'll try and take a look at the code you posted tonight.<br><br>I've already downloaded SQLite and had a very quick play - I've forgotten so much of the SQL I learnt 20+ years ago, will have to find a good tutorial site on SQL - Do you know of any?  The SQLite site has command reference, but I learn better from tutorials that I can try out.  <br><br>Don't need anything too complex, just creating tables, running fairly basic queries.<br><br>Without going into your code or Brucey's MODs - from what I've seen you can just make your database with SQLite and then call it from a command line.  I'm guessing you just pipe the results to a text file and read it from there?<br><br>Downloading MySQL now also to have a quick look, but I think it's possibly more than I need.  But they do seem to have a GUI available which I find easier (like MS-Access I assume) rather than having to type all of the create table commands etc. <br><br></td></tr></table><br>
<a name="1069007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Without going into your code or Brucey's MODs - from what I've seen you can just make your database with SQLite and then call it from a command line. I'm guessing you just pipe the results to a text file and read it from there? <br></div><br><br>No, you can call the SQLite statements straight from your code, and it will populate a string or array with the results.<br><br>You can do it all stright from within blitzmax: create a table, modify a table, store data, and run semi-complex SQL queries on the stored data.<br><br>Here's one of Brucey's SQLite sample files:<br><br><pre class=code>
SuperStrict

Framework BaH.DBSQLite
Import BRL.filesystem

DeleteFile("maxtest.db")

Local db:TDBConnection = LoadDatabase("SQLITE", "maxtest.db")

If Not db Then
	DebugLog("Didn't work...")
	End
End If

Local names:String[][] = [ ..
	[ "Alfred", "Aho" ],   ..
	[ "Brian", "Kernighan" ], ..
	[ "Peter", "Weinberger" ] ]

If db.isOpen() Then

	Local s:String = "CREATE TABLE person (id integer primary key AUTOINCREMENT, " + ..
	  " forename varchar(30)," + ..
	  " surname varchar(30) )"

	db.executeQuery(s)

	If db.hasError() Then
		errorAndClose(db)
	End If
	
	' transaction test :-)
	db.StartTransaction()

	If db.hasError() Then
		errorAndClose(db)
	End If

	For Local i:Int = 0 Until names.length
		db.executeQuery("INSERT INTO person values (NULL, '" + names[i][0] + "', '" + names[i][1] + "')")
		If db.hasError() Then
			errorAndClose(db)
		End If
		
	Next
	
	' commit our changes :-)
	db.Commit()

	If db.hasError() Then
		errorAndClose(db)
	End If

	Local query:TDatabaseQuery = db.executeQuery("SELECT * from person")
	If db.hasError() Then
		errorAndClose(db)
	End If

	While query.nextRow()
		Local record:TQueryRecord = query.rowRecord()
		
		DebugLog("Name = " + TDBString(record.value(1)).value + " " + TDBString(record.value(2)).value)
	Wend
	
			
	db.close()
	
End If

Function errorAndClose(db:TDBConnection)
	DebugLog(db.error().toString())
	db.close()
	End
End Function
</pre><br><br>It creates a database file, creates a table, populates it with some records, and run a query against the database to return the results.<br><br>If you already have an existing SQLite database you can interface with that as well, but it's possible to do the entire thing from within blitz. <br><br></td></tr></table><br>
<a name="1069032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I tried SQL once but it was more trouble than it's worth. <br></div><br>Heh! To learn, or to use?<br><br>If you have lots of stats data, it's much easier to retrieve it interactively from a database. Imagine you are displaying a table with header. Clicking on a particular column header you can re-retrieve the data simply by changing the "ORDER BY" column of the SQL. Coding by hand would require considerably more effort.<br><br>For very large, growing datasets, it is probably better to use a database than your own custom file storage - if not least so that you don't have to worry about having to iron out bugs in it. Productions databases have had many thousands of man-hours devoted to making them work...<br><br>For a game, SQLite is probably better than MySQL, although there's no reason you can't develop using MySQL and migrate the data later to SQLite.<br>My database framework makes this as relatively/moderately painless as possible. (for basic ANSI standard queries, it might only involve a simple change of the driver, for example).<br><br><div class="quote"> from what I've seen you can just make your database with SQLite and then call it from a command line. I'm guessing you just pipe the results to a text file and read it from there?<br> <br></div><br>As xlsior points out, it's much easier to access the database directly via code than relying on external files and pipes.<br><br><div class="quote"> they do seem to have a GUI available which I find easier  <br></div><br>There's also a GUI for SQLite, called SQLiteBrowser, which is open source. There may be others too... <br><br></td></tr></table><br>
<a name="1069033"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks xlsior.<br><br>I'm in the process now of installing Brucey's mod for SQLite, MinGW etc.<br><br>I've downloaded the SQLiteMod and Database Mod files as instructed by his webite.  I've made a directory off blitzmax/mod called BaH.mod and unzipped the files in there.<br><br>I downloaded and installed MinGW as per the instructions in a thread by Ziggy.<br><br>I've rebuilt the docs and now have access to them in MaxIDE.  The "Build Modules" option is now available to me.  When I click on it, I get :<br><br><br>Building Modules<br>Compiling:blitz_app.c<br>Build Error: failed to compile C:/BlitzMax/mod/brl.mod/blitz.mod/blitz_app.c<br>Process complete<br><br><br>Any ideas what I'm doing wrong? <br><br></td></tr></table><br>
<a name="1069040"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Your MinGW is not configure properly.<br><br>Make sure you also add the MinGW path to the environment.<br>You can check this by opening cmd.exe and typing gcc at the prompt. eg.<br><pre class=code>
C:\BlitzMax\bin&gt;gcc
gcc: no input files
</pre><br>If it reports that gcc doesn't exist, your PATH is incomplete. <br><br></td></tr></table><br>
<a name="1069041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers Brucey, I found some SQLite GUI's.  Just trying to get your mods working and I'll download one and then start playing with code to retrieve data from the SQLite DB <br><br></td></tr></table><br>
<a name="1069042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Part 3 in Ziggy's little guide :<br><div class="quote"> <br>3.- In the 'System Variables' box, scroll down until you see the variables Path. Click on it and click the edit button. In the 'Variable Value' box, move your curser to the end of text, ADD A SEMI COLON, and put the path to your MinGW\bin directory. eg, c:\MinGW\Bin. Click ok and ok again and if you are using windows XP, you are ready to go...<br> <br></div> <br><br></td></tr></table><br>
<a name="1069043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Your MinGW is not configure properly.<br><br>Make sure you also add the MinGW path to the environment.<br>You can check this by opening cmd.exe and typing gcc at the prompt. eg.<br>C:\BlitzMax\bin&gt;gcc<br>gcc: no input files<br><br>If it reports that gcc doesn't exist, your PATH is incomplete. <br> <br></div><br><br>I've looked in C:\blitzmax\bin and there is no GCC.EXE.  I take it I download this and put it in the bin directory?  I'm on the GCC.GNU.ORG site and not exactly sure what I'm supposed to download/install :S <br><br></td></tr></table><br>
<a name="1069044"></a>

<a name="1069045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, done part 3 successfully already Brucey.<br><br>Using Win 7 if that makes any difference - I did follow the steps in Ziggy's thread - I might just go back in and double checking spelling etc.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069048"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I've looked in C:\blitzmax\bin and there is no GCC.EXE. I take it I download this and put it in the bin directory? <br></div><br>No. Everything you need is installed with MinGW (compiler, headers, libs, etc).<br>If your environment is correct, running "gcc" from a command line should work. If it is not found, your path is wrong. <br><br></td></tr></table><br>
<a name="1069049"></a>

<a name="1069050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the help Brucey.  My stupid mistake.<br><br>I didn't look closely enough when unRar'ing the MinGW file.  It's already packaged inside of a folder called "MinGW" and I told it to unRar to "c:\MinGW" which of course put it into "c:\minGW\minGW\"<br><br>Just rebuilt the modules and all went okay.  Going to have a quick play with your example files now :)<br><br>Thanks.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried the first test_01.bmx file with the SQLite mod and it works :)  Will have a bit of a read of the code tonight to make sure I know what is going on :)  Will have to spend some time on the weekend re-educating myself on SQL syntax :)<br><br>Thanks for the help :D <br><br></td></tr></table><br>
<a name="1069053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Glad you finally got it sorted!<br><br>:-) <br><br></td></tr></table><br>
<a name="1069055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arabia</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> First time I've tried installing one of your mods Brucey.  I'll look at more of them now that I'm less scared about the installation process :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
