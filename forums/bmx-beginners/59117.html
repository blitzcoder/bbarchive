<!DOCTYPE html><html lang="en" ><head ><title >Avoiding using globals..</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Avoiding using globals..</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Avoiding using globals..</a><br><br>
<a name="658427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >po</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I keep hearing globals are bad because they are not as fast as locals, but I've been trying to rewrite Paratrooper Plunge in Max, but I just can't figure out how to not use tons of globals. The way I structure is like this:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

...

Load all the images

...

game_state=1

while not game_state=0

if game_state=1 then MainMenu()
if game_state=2 then PlayGame()
if game_state=3 then DeathMenu()

wend

function MainMenu()

*use some images that were loaded above*

*use some variables that were set above*

end function
</textarea><br><br>So because I structure my code all functions like that, doesn't that mean I need lots on globals? Anyone have suggestions as to how I should structure my code and such to use more locals? <br><br></td></tr></table><br>
<a name="658432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WendellM</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If there aren't too many, you could pass the images and variables used to MainMenu().<br><br>Or you might consider creating a "Type TMainMenu", setting up only the images and variables that it needs as fields within it, then creating functions within it to use those fields (or an instance of it with methods that use them).  That's how I write my larger programs: each "set of functionality" (Input, Output, Networking, AI, etc.) has a type with fields that contain the variables/data that it uses, and I create an instance of each.  I don't have a single global in my set of types (except within functions/methods that need to retain values between calls, but those are really "static locals").<br><br>However, the main reason that I do this isn't for speed, but to separate each set of functionality.  Since each set is a type instance and only deals with the fields contained within, there's no chance of "contamination" - of one set of functionality accidentally influencing another (which can happen when globals are shared).  The only way that the different sets communicate is by passing parameters to each other, so it's easy to see how they share information.<br><br>This does lead to some data duplication (such as the AI, Input, and Output type instances all having specialized versions of the map data), but I consider this a worthwhile trade-off.  This slows things down a little since the map data needs to be passed among the various type instances, but because this must be done explicitly, I can see exactly what each instance is dealing with and there's no way for one type to change another type's set of data.<br><br>But maybe that's just me... hope this isn't more confusing than helpful, otherwise just ignore it. :) <br><br></td></tr></table><br>
<a name="658476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> good vs bad is usually a poor way of thinking about these things<br><br>locals and global both have there uses but in different senarios<br><br>as for global being "slow" well I really wouldnt let that influence you too much, thay aint *that* slow! just a bit slower than locals<br><br>I'd rather have 1 global than 6 versions of the same value floating about - nightmare <br><br></td></tr></table><br>
<a name="658921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >po</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> A lot of info there Wendell, a lot of it over my head =)<br><br>Chris, I guess you're right. My games aren't exactly large scale so it really doesn't matter what I use.. <br><br></td></tr></table><br>
<a name="658923"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Locals can and should be quite a bit faster than Globals because they are cpu registers, not memory addresses.<br><br>Use locals where you can. <br><br></td></tr></table><br>
<a name="658937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Locals make sense in loops. Every variable in a list of types is gonna have the impact of a type anyway, so don't worry about it.<br><br>If you're paranoid, benchmark your game, then when you reach a loop, put the global inside a local in that loop if you can. You won't see much difference...<br><br>For in-loop calculations you want locals, and all temp vars should be locals. <br><br></td></tr></table><br>
<a name="659066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> po: if you need a lot of gfx, then why not put all your gamegfx in one big type, called TMediapool orso. Then you don't have hundreds of globals, just one orso (the mediapool instance), and even the mediapool could be part of a TGame orso.. reducing the amount of globals.. in fact, just describe it as a local in your main!<br><br>The problem with globals comes not so much with unique names but more when you're using a typical variable name. You don't want to have x,y,t,i,a,b,mx,my,dx,dy,sx,sy,w,h etc. global, typical forloop-variables they are..<br>Also, you don't want stuff like enemyx, enemyy, enemylife etc. global, if you ever need another set o' these then you can't, as globals are meant for one 'user'.<br><br>An extreme example would be a pinballgame in a window of 320x800. If you make everything global, then a single window it stays. But! If you make everything local, the whole game, then you can simply create another instance of the Pinball type, et voila: 2-player-mode. And all you need to do is create another instance (with different coordinates), and that's all! Usage of locals is essential if you don't know what you'll be doing in the future. Globals are for a dark future only.. <br><br></td></tr></table><br>
<a name="659082"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thing is, types aren't strictly "local" anyway are they? They still have to fetch fresh stuff from memory per object. these are the lines you ought be thinking on... <br><br></td></tr></table><br>
<a name="659483"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >po</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmmm.. The choices... I like how organized the type idea is, but then there's the speed thing too... <br><br></td></tr></table><br>
<a name="659484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the speed thing is your worry, you will never ship. Simply code for the correct purpose. Don't mess up your program design for the sake of 5fps. <br><br></td></tr></table><br>
<a name="659493"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >po</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
