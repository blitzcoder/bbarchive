<!DOCTYPE html><html lang="en" ><head ><title >how to code 'Scramble' missiles</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >how to code 'Scramble' missiles</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >how to code 'Scramble' missiles</a><br><br>
<a name="646999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi !<br>i want add to my game some missiles like the old classic game Scramble. Missile is launched when player is near it.<br><br>What's the better method and what is the formulae to determine that player (px, py) is inside the view zone (see picture) ?<br><br>1) linepick ?<br>2) cone ?<br>3) 'oriented' rectangle<br>4) classic rectangle<br><br><img src="http://www.bayre.com/zigwigwis/capture_1.gif"><br><br>for info and your pseudo code have this :<br><br>type tMissile <br>field x<br>field y<br>field Angle<br>end type<br><br>Many thanks for your help <br><br></td></tr></table><br>
<a name="647013"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> If theres minimal obstacles, you could use an image drawn as a cone, and check for collision with the player? <br><br></td></tr></table><br>
<a name="647017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The cone image is a good idea, but i've already a lot of images collisions tests into my game.<br><br><img src="http://www.bayre.com/zigwigwis/capt_101.jpg"> <br><br></td></tr></table><br>
<a name="647020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a math formulae to check if a point is inside a cone ? <br><br></td></tr></table><br>
<a name="647073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> A 2D cone?<br><br>You need to find the angle one point is at (the player) relative to another point (the small end of the cone) and then detrmine if it is between angles (lookdirection-conefov/2) and (lookdirection+conefov/2).<br><br>I'm sure there's code in the code archives to find the angle of one point relative to the other.  I think it involves Atan or Atan2. <br><br></td></tr></table><br>
<a name="647105"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RiK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://www.olpin.net/blitz/TanAngle.png"><br><br>a= Atan2(dx,dy) <br><br></td></tr></table><br>
<a name="647164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep atan2 and a "cone" (flat 2d code=triangle) has my vote!<br><br>atan2 I wonder if this one command has the most uses out of all the functions of just about any language <br><br></td></tr></table><br>
<a name="647184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, i'm trying to transform your explanations into code. Here a code that draw some cones and try to do the job ! But not work...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Graphics 800,600

Global List_cones : TList = CreateList()

Type TCone

	Field x
	Field y
	Field Angle
	Field Rotation
	Field Length 
	
	Function Create:TCone (x:Int, y:Int, Angle : Int, Rotation : Int, Length : Int= 200)
	
		Local c:TCone = New TCone
		
		c.x = x
		c.y = y
		c.Angle = (Angle + 360) Mod 360
		c.Rotation = (Rotation + 360) Mod 360
		c.Length = Length
		
		ListAddLast List_cones, c
		
		Return c
		
	End Function
	
	Function Show_all ()
	
		For Local c:TCone = EachIn List_cones
		
			SetColor 255,0,0
			DrawOval c.x-2,c.y-2,4,4
			
			SetColor 255,0,0
			SetRotation (c.Rotation)
			DrawLine c.x, c.y, c.x , c.y - c.Length
			
			SetColor 0,255,0
			SetRotation (c.Rotation + c.Angle)
			DrawLine c.x, c.y, c.x, c.y - c.Length

			SetRotation (c.Rotation - c.Angle)
			DrawLine c.x, c.y, c.x, c.y - c.Length
						
			SetRotation 0
			

		Next
	
	End Function
	
	Function Check_in_view ()
	
		Local d, dx, dy, angle, angleinf, anglesup
	
		For Local c:TCone = EachIn List_cones
		
			' ... need help to write code here ;-)
			
			dx = Abs (px - c.x)
			dy = Abs (py - c.y)
			
			angle = ATan2(dx,dy) 
			angle = (angle + 360) Mod 360
			
			angleinf = c.Rotation- c.angle  
			anglesup = c.Rotation + c.angle  
			
			angleinf = (angleinf + 360) Mod 360
			anglesup = (anglesup + 360) Mod 360
			
			d = Int (Sqr ((px - c.x) * (px - c.x) + (py - c.y) * (py - c.y)))			
			
			SetColor 255,255,255
			DrawText "anglesup = " + String (anglesup), c.x, c.y - 10
			DrawText "angleinf = " + String (angleinf), c.x, c.y + 10
			DrawText "playerangle = " + String (angle), c.x, c.y + 30
			DrawText "dist= " + String (d), c.x, c.y + 50
						
			If angle&gt; c.Rotation And angle &lt; anglesup And d &lt;= c.Length Then
			
				SetColor 255,0,0
				DrawText "inside", c.x , c.y
			End If
			
			If angle &lt; c.Rotation And angle &gt; angleinf And d &lt;= c.Length Then
			
				SetColor 255,0,0
				DrawText "inside2", c.x , c.y
			End If
			
		
		Next
	
	End Function
	
End Type

Global px = MouseX()
Global py = MouseY()

TCone.Create (100,200,25, 0)

TCone.Create (400,300,25, 0)
TCone.Create (200,300,25, 0)

TCone.Create (100,400,25, 0)



While Not KeyDown (KEY_ESCAPE)

	Cls
	
	px = MouseX()
	py = MouseY()
	
	TCone.Show_all()
	TCone.Check_in_view()
	
	SetColor 0,255,0
	DrawOval px-2, py-2,4,4
	Flip
	
Wend
	
</textarea> <br><br></td></tr></table><br>
<a name="647286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> 'ere try this, always remember its atan2(Y,X) not X,Y and the sign of x &amp; y is important!<br><br>you also need an extra test to allow for "cones" that span the zero angle...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

Strict

Graphics 800,600

Global List_cones : TList = CreateList()

Type TCone

	Field x
	Field y
	Field Angle
	Field Rotation
	Field Length 
	
	Function Create:TCone (x:Int, y:Int, Angle : Int, Rotation : Int, Length : Int= 200)
	
		Local c:TCone = New TCone
		
		c.x = x
		c.y = y
		c.Angle = (Angle + 360) Mod 360
		c.Rotation = (Rotation + 360) Mod 360
		c.Length = Length

		
		ListAddLast List_cones, c
		
		Return c
		
	End Function
	
	Function Show_all ()
	
		For Local c:TCone = EachIn List_cones
		
			SetColor 255,0,0
			DrawOval c.x-2,c.y-2,4,4
			
			SetColor 255,0,0
			SetRotation (c.Rotation)
			DrawLine c.x, c.y, c.x + c.Length, c.y
			
			SetColor 0,255,0
			SetRotation (c.Rotation + c.Angle)
			DrawLine c.x, c.y, c.x + c.Length, c.y

			SetRotation (c.Rotation - c.Angle)
			DrawLine c.x, c.y, c.x + c.Length, c.y
						
			SetRotation 0
			c.rotation:+1
			c.rotation = (c.rotation + 360) Mod 360			

		Next
	
	End Function
	
	Function Check_in_view ()
	
		Local d, dx, dy, angle, angleinf, anglesup
	
		For Local c:TCone = EachIn List_cones
		
			' ... need help to write code here ;-)
			
			dx = (px - c.x)
			dy = (py - c.y)
			angle = ATan2(dy,dx) 
			'angle = (angle + 360) Mod 360
			If angle&lt;0 Then angle:+360
			
			
			angleinf = c.Rotation - c.angle  
			anglesup = c.Rotation + c.angle  
			
			'angleinf = (angleinf + 360) Mod 360
			'anglesup = (anglesup + 360) Mod 360
			If angleinf&lt;0 Then angleinf:+360
			

			
			
			d = Int (Sqr ((px - c.x) * (px - c.x) + (py - c.y) * (py - c.y)))			
			
			SetColor 255,255,255
			DrawText "anglesup = " + String (anglesup), c.x, c.y - 10
			DrawText "angleinf = " + String (angleinf), c.x, c.y + 10
			DrawText "playerangle = " + String (angle), c.x, c.y + 30
			DrawText "dist= " + String (d), c.x, c.y + 50
						
			If (angle)&gt; angleinf And (angle) &lt; anglesup And d &lt;= c.Length Then
			
				SetColor 255,0,0
				DrawText "inside", c.x , c.y
			End If
			
			If angleinf&gt;anglesup Then
				If angle&lt;anglesup Or angle&gt;angleinf Then
					SetColor 255,0,0
					DrawText "inside2", c.x , c.y	
				EndIf			
			EndIf
		
		Next
	
	End Function
	
End Type

Global px = MouseX()
Global py = MouseY()

TCone.Create (100,200,25, -45)

TCone.Create (400,300,25, 0)
TCone.Create (200,300,25, 180)

TCone.Create (100,400,25, 45)



While Not KeyDown (KEY_ESCAPE)

	Cls
	
	px = MouseX()
	py = MouseY()
	
	TCone.Show_all()
	TCone.Check_in_view()
	
	SetColor 0,255,0
	DrawOval px-2, py-2,4,4
	Flip
	
Wend
	
	
	
</textarea> <br><br></td></tr></table><br>
<a name="647290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks Chris, i've spent two hours to search what was wrong inside my previous code !!! <br><br></td></tr></table><br>
<a name="647419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah - an sometimes you're just to close to the forest to see the trees <br><br></td></tr></table><br>
<a name="647441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldn't you have to be far from the forest not to be able to see the individual trees?  Or be unable to see the forest because you're so close all you can see is trees? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
