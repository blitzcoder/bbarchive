<!DOCTYPE html><html lang="en" ><head ><title >Event Driven Framework</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Event Driven Framework</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Event Driven Framework</a><br><br>
<a name="1089762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redspark</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm looking for a Game Framework that minimizes on CPU usage by being event driven and not polling but using sleep or wait between events.  Events can be immediate or timed.  Is there such a thing?  Thanks. <br><br></td></tr></table><br>
<a name="1089846"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is your application really that cpu intensive? Normally it should be enough if restrict your game loop with a timer.<br>I don't know of such a framework btw. <br><br></td></tr></table><br>
<a name="1089860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redspark</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> My current framework is quite old now.  It eats a full CPU core at 100% because it is just a constant loop.<br><br>I'll investigate the timer method.  Thanks. <br><br></td></tr></table><br>
<a name="1089873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >shinkiro1</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can also simply limit the hertz by setting it with the Graphics command (at the beginning):<br><pre class=code>
Graphics width, height, depth, hertz, flags
</pre><br>So you could do:<br><pre class=code>
Graphics 800,600,0,60
</pre> <br><br></td></tr></table><br>
<a name="1089877"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Put a Delay 1 at the end of your main game loop. It will give control back to the OS. Works best with limiting the frame rate also. <br><br></td></tr></table><br>
<a name="1089886"></a>

<a name="1089888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use a Event loop framework, which uses my timer function <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1721" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1721</a> and a (optional, but most times) full screen boarder-less window with a message loop for the GUI.<br><br>The question is why do you want less than 100% cpu use?<br><br>If it is because your game isn't fast enough so you want more than 100% speed (if you know what I mean) then I don't think event driven would be any faster. <br><br>The main point of event driven is so that the computer OS can run other things, that is your game logic and screen update would still be as slow or fast, and most ppl tend to "Over imagine" what their "Game needs" and tend to be pushing the limit of whatever machine they are using.<br><br>(Not everyone, and I would say the main exceptions to this are the people who actually finish games quite regularly)<br><br>If you do simply want your OS to have some time then as Czar said just a Delay 1 would be enough.<br><br>EDit. The link example does run at 100%, but that's just cos its an example<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1089889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use a Event loop framework, which uses my timer function <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1721" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1721</a> and a (optional, but most times) full screen boarder-less window with a message loop for the GUI.<br><br>The question is why do you want less than 100% cpu use?<br><br>If it is because your game isn't fast enough so you want more than 100% speed (if you know what I mean) then I don't think event driven would be any faster. <br><br>The main point of event driven is so that the computer OS can run other things, that is your game logic and screen update would still be as slow or fast, and most ppl tend to "Over imagine" what their "Game needs" and tend to be pushing the limit of whatever machine they are using.<br><br>(Not everyone, and I would say the main exceptions to this are the people who actually finish games quite regularly)<br><br>If you do simply want your OS to have some time then as Czar said just a Delay 1 would be enough.<br><br>EDit. Removed<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1089919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redspark</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's more of a personal experiment.  It isn't about speed or letting my OS have its share of the CPU but reduction in energy consumption and heat generation.  It is a known fact that the CPU is the largest consumer of energy on a laptop and a large generator of heat (GPU as well).  If you can code a game in such a way that it reduces the amount of CPU use, then it will impact battery life.  Thus, the game can be played longer for laptop users.<br><br>I would just like to see if an Event Driven program will reduce the amount of CPU use to a degree that it would be worthwhile.  If you could reduce the amount of drawing and only use CPU when necessary, I think it might be worth it.  After all, why should the CPU be at 100% when you have the game on pause because the phone rang or nature is calling.  <br><br>Of course, certain genres would be impossible to reduce consumption but I think a lot of casual games do not need to keep the CPU so high all of the time.  I thought it might be a good experiment to find out though. <br><br></td></tr></table><br>
<a name="1090560"></a>

<a name="1090561"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> By giving the CPU back to the OS, it can realize there is nothing else going on and idle it. Otherwise your exe will constantly take 100% processor time in task manager. It might reduce the energy consumption of the processor.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1090832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Checkout BRL.EventQueue. You should be able to easily build what you need. <br><br></td></tr></table><br>
<a name="1090889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redspark</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wrote a small app that simply clears the screen and draws a rectangle where the mouse is.  With a standard game loop and no VSync, my CPU sits at a constant 75%.  With VSync it falls to a constant 3.5%.  <br><br>With an Event Driven approach that waits for events and only draws when something has changed, the CPU fluctuated between 2 and 3%.  When the game was at rest it was at 2% and when the mouse was moving it was 3%.  Of course, once you add particles and more complex game logic, that CPU will raise.  However, I think with this approach it will allow the CPU to have lots of breathing room to cool down and conserve energy.  <br><br>At the same time, it does complicate the game programming.  It would be interesting to see if there would be more or less savings than the VSync method when the game logic gets more complicated. <br><br></td></tr></table><br>
<a name="1090892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't really understand this.<br><br>First of all, what game has such a static screen that it's worth this effort? Won't the screen be changing all the time? If nothing is going on, who wants to play it?<br><br>Secondly, CPU and GPU are different things. Drawing uses up GPU, updating uses CPU. If nothing is drawing, a lot of stuff could still be updating and so you won't save any CPU, although you might save some GPU.<br><br>You want to sleep between events, but where are these events coming from? Something has to be generating them and updating the game. It's easier and probably better to update with a fixed update rate, such as 20 frames per second. If a frame is updated in 25 milliseconds, then you can idle the CPU for the remaining milliseconds until you reach the 50 point. <br><br></td></tr></table><br>
<a name="1091010"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redspark</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your game was not on a fixed rate logic, how many times do you think it would execute the game loop and nothing really changes from the game's perspective?  The CPU would be at 90 - 100% executing nothing really useful.  Using a fixed rate logic works but I'm just curious if there might be a way to achieve the same thing but have a logic loop that only executes when needed.<br><br>Events are generated by the game loop and by the system.  So there is always some CPU eaten as I wrote in my prior post.  But the idea is to keep the CPU resting as often as is possible.  As I stated before, this idea wont matter to certain games such as action games.  The only time it would matter in those cases would be when you pause the game for a bio break.  Then the CPU would fall to something like 5% since it doesn't have much to do and your machine would start to cool off some but probably not enough to be useful.  <br><br>However, casual games such as in hidden object, there is no need to waste CPU or GPU when you don't have to.  Those types of games should not wear your system out by depleting the battery and generating so much heat.  Like I said, this is just an experimental idea and I may be completely wasting my time but it's my time to waste. ;)  Besides, I will learn something one way or the other. :) <br><br></td></tr></table><br>
<a name="1091014"></a>

<a name="1091015"></a>

<a name="1091016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Red, just point to a game such as "Freecell" or "minesweeper".<br>These I think make your point exactly, <br>You dont want freecell running at 100% cos lets face it most ppl (well me) only play it when they are waiting for something else to finish.<br><br>I would say tho that with multiple cores, and with the fake multitasking PC had/have a low priority possibly is enough. But, its why I do it.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1091041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok for those games it's an interesting prospect!<br><br>As for pausing an action game, I would have thought there was CPU reduction as less things are being updated. <br><br></td></tr></table><br>
<a name="1091062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Redspark</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> H&amp;K exactly.  Those kind of games don't need constant CPU use and don't because they are purely event driven.  I think other games (casual games in particular) would benefit from a similar structure.  I've played too many casual games that my Mac is smoking hot afterwards and I can't believe that something like a hidden object would cause that.  World of Warcraft, I expect that kind of thing.  Where is Waldo? ... No. :)<br><br>Czar, you're right that pausing should reduce the CPU quite a bit because it isn't really doing anything -- especially with fix rate logic.  But I think if your pause screen has no animation to it, the CPU/GPU should only have to execute the draw once and never change it again until there is input from the user or a system issued redraw.  That would allow the CPU and GPU to cool down much faster.  Of course, that part can be done without an Even Driven framework.  You could implement that in any framework to save your GPU some work. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
