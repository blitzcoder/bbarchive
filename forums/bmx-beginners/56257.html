<!DOCTYPE html><html lang="en" ><head ><title >STD 2D platform game- Following a hills heigt?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >STD 2D platform game- Following a hills heigt?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >STD 2D platform game- Following a hills heigt?</a><br><br>
<a name="625537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all!<br><br>I've had Blitzmax since pretty much day one.<br><br>Since ive moved into a flat ive decided to go back to Max and play aronud a bit just to keep me busy for a bit instead of my larger projects-<br><br>Heres the question:<br><br>How can I make the player/enemy sprites follow the ramp of a platform?<br><br>In Blitz3D i could quickly just do a readpixelfast from layer 1 and find the top of the platform.<br><br>How would I do it in Max? There are no image buffers, so I cant render the level three times, check height, then merge the images. (Or, not in the way I'm used to?)<br><br>It's a standard array-tilemap based platformer, built in 3 Layers- Layer 1 is the collision layer, Layer 2+ are just background images.<br>What i'd normally do is align the player to be *above* the current Y tile, then pixel-pick down until either more than the height of a tile has passed, or, a pixel has been hit.<br><br>So How can I perform this in Max? I'm probrably missing some important features ;)<br><br>I'm quite knowledged in the standard techniques involved in 2D tilemap based games- and have written many- but the angle used from blitzmax is a bit different from what i'm used to ;)<br><br>Any help apreciated!<br><br>[edit]<br><br>I have absolutely no clue what a "heigt" is. <br><br></td></tr></table><br>
<a name="625540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Duckstab[o]</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might be able to read readpixels from collision layers 1 to 31<br><br>CollideImage<br>CollideRect<br><br>readup on those functions<br><br>Collide rect can be used for pixelperfect <br><br></td></tr></table><br>
<a name="625551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive used these- they work for block&gt;block collisions.<br><br>But I fail to see how to use it to do what i'm after- The collideimage and colliderect commands seem to cause a huge speed-drop, something I shouldnt get from a 2ghz computer ;)<br><br>Of course I will try these again just to see if i can speed any of it up- The slowness i believe is  in checking a 30x30 set of images every frame.<br><br>Any more ideas? <br><br></td></tr></table><br>
<a name="625561"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SoggyP</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello.<br><br>I experienced huge slowdown problems with collisions with lists - until I remembered to use flushmem.  It's a thought.<br><br>Goodbye. <br><br></td></tr></table><br>
<a name="625564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Flushmem no longer exists ;)<br>[edit]<br><br>However there still might be a similar issue.<br><br><a href="http://www.blitzwiki.org/index.php/GCSetMode" target="_blank">http://www.blitzwiki.org/index.php/GCSetMode</a><br><br>Thanks :D <br><br></td></tr></table><br>
<a name="625573"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eric</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also ResetCollisions() Is over looked a lot <br><br></td></tr></table><br>
<a name="625575"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> hehe, I fell for that. Fixed it before I posted here though- It was still slow after :(<br><br>Good advice so far guys. <br><br></td></tr></table><br>
<a name="625591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think you use a 2 color mask for your collision layer. <br><br>Then convert it to a pixmap, read each pixel and save true or false to an array.<br>Now you only need to check for the highest position in that array, what is a lot faster than reading a pixmap or doing a collide image. <br><br></td></tr></table><br>
<a name="625607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ew.... :P <br><br>Thats a ton of work just to get a pixel :P<br><br>I'm going to go tinker- Cheers for your help- Anyone get any more ideas let me know :D <br><br></td></tr></table><br>
<a name="625673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SSS</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> It sounds like your making a platform game, or something similar. In that case, I'd be inclined not to reset collisions on your tile layer (so you only draw it once) but only to your player layer. This should speed up collisions. <br><br></td></tr></table><br>
<a name="625677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its a full on scrolling platform game, the levels are rather large and need to be redrawn each frame, I'm afraid. <br><br>For now i've overcome the problem using maths related to each tile- a function returns the height of the tile depending on where along the local X axis the player is standing :) <br><br></td></tr></table><br>
<a name="626763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was going to say you could just store a heightmap relating to individual map tiles. This would be something done in your level editor, rather than computed during the game.<br><br>If your tiles are 32 pixels wide then you store 32 values representing the height of the topmost collision point relating to each column within the tile. Either your level editor can compute this from the actual drawn pixels in the tile, or you can manually edit. This way, you can have the player dip down into tall grass, or float above a particular area, corresponding to an obstacle not actually drawn as part of the tilemap.<br><br>In-game, you wouldn't need to bother with slow collision checks, you just need to compare the player's x coordinate with the appropriate column in the current tile.<br><br>This would use up a fair amount of filespace, but you could pack the heightmap data in one of 2 ways:<br><br>1) Assuming tiles are 32x32, heigtmap data fits into 5 bits which you could then stuff together into 20 bytes of data (rather than 32).<br><br>2) Store the start height of the left-most column within the tile as an absolute value and then only relative heights for the rest of the columns. 3 bits per column should be enough for general platform gaming (would allow a 1:3 positive or negative gradient maximum, plus a spare setting which could mean "treat next 5 bits as absolute" if you needed to, a bit like rice encoding I suppose!).<br><br>**EDIT** I've gone and assumed you're using a tilemapped level. Stupid me :) <br><br></td></tr></table><br>
<a name="626768"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VP</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyhoo, storing a heightmap could still apply to a freeform level. CPU power being what it is these days, you could probably even approximate a per-pixel heightmap with vectors or splines and have the position calculated in your playerupdate loop/method/thing.<br><br>I'm tired.<br><br>Going to bed. <br><br></td></tr></table><br>
<a name="627304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, vinylpusher, It is a tilemapped level ;)<br><br>Ive used a similar method to the above anyway, just having a start height and an end height for each tile, and just make a ratio out of the X position. Pretty quick and runs way quicker than pixel scanning :)<br><br>Thanks for the help. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
