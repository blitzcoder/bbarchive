<!DOCTYPE html><html lang="en" ><head ><title >Releasing LoadImage memory under MAX 1.14</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Releasing LoadImage memory under MAX 1.14</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Releasing LoadImage memory under MAX 1.14</a><br><br>
<a name="604690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sin of Nature</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Under BlitzMax 1.14, I had to add <b>:TImage</b> to the line to load an image.  However, now my Release command no longer works.  The error message is "Subexpression for release must be an integer variable"<br><br><pre class=code>
	Local MyImage:TImage=LoadImage("MyPicture.bmp")
	Release MyImage
</pre><br><br>Now, I know that BlitzMax has its own memory cleanup no but how do I free up the memory correctly now (without BlitzMax own cleanup)?<br><br>Sin <br><br></td></tr></table><br>
<a name="604694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> When using release, you weren't freeing the image but the "pointer" to the TImage (that has to be freed using release, when you use an INT to reference an object like TImage. When you use a TImage there's no need to use release)<br><br>The image was freed up by BMax's Garbage Collector, and so will be now. When MyImage goes out of scope or is referencing Null or another image, MyPicture will be freed up. <br><br></td></tr></table><br>
<a name="604716"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> In other words, don't try releasing objects and let BMax worry about managing resources. After all, that's the whole point of having automatic garbage collection. <br><br></td></tr></table><br>
<a name="605004"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sin of Nature</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks.  Thats what I thought, but wanted to make sure (as otherwise it would be a memory leak).  Hmmm, not sure I like  relaying on automatic memory handling though.  <br><br>Cheers.<br><br>Sin <br><br></td></tr></table><br>
<a name="605015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can always "Use GCSetMode to enable/disable automatic GC. To perform a manual GC, use GCCollect".<br>(taken from releasenotes.doc) or  force a collect <br>using GCCollect. <br><br></td></tr></table><br>
<a name="605028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You can always "Use GCSetMode to enable/disable automatic GC. To perform a manual GC, use GCCollect".<br>(taken from releasenotes.doc) or force a collect<br>using GCCollect.<br> <br></div><br>(after NULLing the object) <br><br></td></tr></table><br>
<a name="605472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> This doesn't change anything. You still don't free it manually. The GCCollect is just the command to force the garbage collector to collect unused ressources. Its still not freed but pooled for further usage. <br><br></td></tr></table><br>
<a name="605478"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Its still not freed but pooled for further usage. <br> <br></div><br>Hmmm.. Are we sure this happens? <br>If so, running GCMemalloced should only show increasing or stable mem usage unless you mean BlitzMax keeps the pool seperate to the application.<br>If *that* is true then I don't see how the .exe also shows lowering memusage.<br>You'll notice that it reports lower usage in this example <a href="/posts.php?topic=54160&amp;hl=gccollect" target="_blank"> gcmemalloced </a><br>as if memory *IS* being freed.<br>&lt;edit&gt; I reserve the right to have completely misunderstood. <br><br></td></tr></table><br>
<a name="605504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the GC just continued to horde memory, what would be the point of it's existence?<br><br>Also, does it still collect garbage when no one is around? <br><br></td></tr></table><br>
<a name="605531"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I understand you correctly, in auto mode, it does<br><br>I won't continue to horde memory if you don't, because already allocated memory will be used next time you call your loadimage -or whatever-.<br><br>Tonyg, have you checked the app with an external memory usage monitor (like taskmgr in Windows 2K/XP)? just to be sure if it really frees memory or allocates it somewhere else or something.<br>(I'd do it but I'm at work now) <br><br></td></tr></table><br>
<a name="605556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm.. taskmanager reports a higher, stable figure. <br>I guess BlitzMax does have a 'memory currently in use' (gcmemalloced) and memory 'stored' for use (figure shown in taskmanager). <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
