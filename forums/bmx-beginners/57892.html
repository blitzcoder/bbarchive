<!DOCTYPE html><html lang="en" ><head ><title >Need a test with this...</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Need a test with this...</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=101" >BlitzMax Beginners Area</a>/<a href="#bottom" >Need a test with this...</a><br><br>
<a name="643856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b>[EDIT]<br>I've modified the code to use the Dreamora/ GeoffTheGyratingGiraffe DrawImageArea function<br>to correct the bug on old machine, so<br>so could you test this :<br><a href="http://www.bayre.com/zigwigwis/test_griffe_2.exe" target="_blank">http://www.bayre.com/zigwigwis/test_griffe_2.exe</a><br><br>Many thanks <br><br>[/EDIT]<br></b><br><br><br>Hi !<br>i need to know if it works fine for you. <br>you should have this. ie nothing inside the red square ! <br><br><img src="http://www.bayre.com/zigwigwis/capt_200.jpg"><br><br>Here the link :<br><a href="http://www.bayre.com/zigwigwis/test_griffe.exe" target="_blank">http://www.bayre.com/zigwigwis/test_griffe.exe</a><br><br>Many thanks for you help !!! Please post also you config.<br><br>if someone could also test this with an old pc configuration (geforce 2) it should be interesting for me to know it there is a bug or not ! <br><br></td></tr></table><br>
<a name="643857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> works fine here. <br><br></td></tr></table><br>
<a name="643913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tried it on an old Windows 2000 laptop (750Mhz, 256MB RAM, 11MB Onboard Graphics) and the red square is visible but there is no image behind it at all. Was it included in the EXE? I.e. IncBin <br><br></td></tr></table><br>
<a name="643926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >WendellM</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks like screenshot above on my AMD XP 3000+ with Win XP Pro SP2 and Radeon 9600 Pro.  Animated "blue blades" extend and retract while image inside red square remains unchanged. <br><br></td></tr></table><br>
<a name="643960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Booticus</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Same as Wendell, works fine here. Animation and everything. Good stuff! <br><br></td></tr></table><br>
<a name="644129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the tests !<br><br>@seb : its confirms that this code using classic bmax viewport to simulate the blitzbasic drawimagerect doesn't work on old machines. Yes graphics images are include into the exe. i suppose that this function doesn't work too on your old pc :<br><br><pre class=code>
Function DrawImageRectClip(image:TImage, x#, y#, rx#, ry#, rw#, rh#, frame=0)
	Local vx, vy, vw, vh, hx#, hy#
	
	hx# = image.handle_x
	hy# = image.handle_y
	SetImageHandle image, 0, 0
	GetViewport(vx, vy, vw, vh)
	SetViewport x#, y#, rx# + rw#, ry# + rh#
	
	DrawImage image, x# - rx#, y# - ry#, frame
	
	SetViewport vx, vy, vw, vh
	SetImageHandle image, hx#, hy#
End Function
</pre> <br><br></td></tr></table><br>
<a name="644415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >undomiel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Didn't work here, the up-down spikies would go into the red box while the side-side spikies would be clipped by the red box.  So that definitely confirms your bug!<br><br>P3 933 XP SP2 768 MB RAM GeForce 2 GTS w/ 32 MB <br><br></td></tr></table><br>
<a name="644420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> There are enough functions in the code archives that use the correct way to draw image rects like old Blitz did (by using UV coords that are reset to the right values before the function is left)<br><br>Using viewport is a strange and unlogical hack ... <br><br></td></tr></table><br>
<a name="644439"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> BMAX viewports are just clipping rects, they will do the job but it's not the most elegant and does involve overhead you could do without. <br><br></td></tr></table><br>
<a name="644741"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> He was already offered a UV routine but wanted a solution that *only* used the standard Max2D commands!<br><br>[edit]<br>Edited to satisfy Dreamora's pedantic side. ;oP<br>[/edit] <br><br></td></tr></table><br>
<a name="644742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok<br><br>Although UV only uses Max2D commands as well, but only OOP commands and not procedural commands.<br>You don't need to modify the module to get the desired results. <br><br></td></tr></table><br>
<a name="644870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks for your tests. it's true that i prefer use standard max2d commands ;-) GeoffTheGyratingGiraffe <br>have posted a link to dreamora code ( <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1422" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1422</a> ) in another topic. Is Dreamora code works with mac, windows and linux ? i don't understand too how to use it with my project (you know... i don't use framework !) <br><br></td></tr></table><br>
<a name="644878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blitzer101</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> &gt;Didn't work here, the up-down spikies would go into &gt;the red box while the side-side spikies would be &gt;clipped by the red box. So that definitely confirms your &gt;bug!<br><br>Does exactly the same here, but I also found the I could not close the window after trying it and had to resort to Ctrl+alt+del and force it to it as a task.<br><br>Comp Spec...<br><br>Win98se, 800mhz AMD Athlon, 256mb ram, GeForce gfx, Soundblaster snd card. HTH. <br><br></td></tr></table><br>
<a name="644879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I updated the code with a little commented description on what the parameters mean.<br><br>You only need to put the code into a bmx and include it or even just put it into one of your existing BMX files. <br><br></td></tr></table><br>
<a name="644884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @dreamora : i paste your code into my bmx file. and i've an error : "identifier 'TDX7ImageFrame not found" <br><br></td></tr></table><br>
<a name="644890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I updated the code. Some BM stuff changed.<br><br>Added the possibility to specify the drawing size of the image part as well.<br><br>Hope the description is understandable. <br><br></td></tr></table><br>
<a name="644896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Dreamora. You should also translate this into english :<br><br>	Assert l &lt; image.width Else "l muss kleiner als die Bildbreite sein"<br>	Assert t &lt; image.height Else "t muss kleiner als die Bildhöhe sein"<br><br>i'll test your code tomorrow. <br><br></td></tr></table><br>
<a name="644898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> good input <br><br></td></tr></table><br>
<a name="644900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >undomiel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Assert l &lt; image.width Else "l must be less than the image's width"<br>Assert t &lt; image.height Else "t must be less than the image's height"<br><br>Unless my german is too rusty. <br><br></td></tr></table><br>
<a name="644907"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes that would be right. But I removed it so you can now even create repeating structures and mirrored repeating structures. <br><br></td></tr></table><br>
<a name="645106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi !<br>with Dreamora function... the image auto scale to the drawrect size ? How to not deform the image ?<br>Thanks<br>(note i invert some params into the dreamora function declaration)<br><br><img src="http://www.bayre.com/zigwigwis/griffe.png"><br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict 

Graphics 800,600

Global hImage:Timage = LoadImage ("griffe.png")
SetImageHandle hImage, 0,0

Rem
	image: handle of the image you want to draw
	x , y: Position at which you want to draw the imagerect
	w,h: width and height of the imagerect you want to draw
	l,t: top left position on the image you want to start drawing (in pixels)
	dw,dh: Drawing height and width of the image part you want do draw.
End Rem

Function drawimagearea (image:TImage, x#, y#, w#, h#, l#, t#,dw#,dh#,  frame:Int=0)
	Local origin_x#,origin_y#
	GetOrigin (origin_x,origin_y)
	Local l1#	= l + w
	Local h1#	= t + h
	Local x0#=-image.handle_x,x1#=x0+w
	Local y0#=-image.handle_y,y1#=y0+h

	If l1 &gt; image.width
		x1 = x0 + w + image.width - l1
		l1 = image.width
	EndIf 
	If h1 &gt; image.height
		y1 = y0 + h + image.height - h1
		h1 = image.height
	EndIf

	If TGLImageFrame (image.frame(frame))
		Local frame:TGLImageFrame 	= TGLImageFrame (image.frame(frame))
								
		frame.u0 = l / image.width
		frame.v0 = t / image.height
		frame.u1 = (l1) / image.width
		frame.v1 = (h1) / image.height
		frame.Draw x0,y0,x0+dw,y0+dh,x+origin_x,y+origin_y
		
		frame.u0	= 0
		frame.v0	= 0
		frame.u1	= 1
		frame.v1	= 1
	Else
		Local frame:TD3D7ImageFrame	= TD3D7ImageFrame(image.frame(frame))
		frame.setUV (l/image.width, t/image.height, (l1) / image.width, (h1) / image.height)
		frame.Draw x0,y0,x0+dw,y0+dh,x+origin_x,y+origin_y
		frame.setUV (0,0,1,1)
	EndIf
	
End Function

Rem
	image: handle of the image you want to draw
	x , y: Position at which you want to draw the imagerect
	w,h: width and height of the imagerect you want to draw
	l,t: top left position on the image you want to start drawing (in pixels)
	dw,dh: Drawing height and width of the image part you want do draw.
End Rem


While Not KeyDown (KEY_ESCAPE)

	Cls
	
	SetColor  255, 255,255
	
	DrawRect 300,100,200,150
	DrawImage hImage, 250,100
	
	DrawRect 300,300,200,150
	DrawImagearea hImage, 300,300,200,150,50,0,200, 250
	Flip

Wend
</textarea> <br><br></td></tr></table><br>
<a name="645118"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dreamora's routine doesn't seem to take power of two texture rescaling into account?<br><br>I've fixed the scaling thing, pulled out the dx and dy as they seemed a bit pointless to me, renamed the variables and slapped in some compiler directives for good measure...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

Graphics 800,600

Global hImage:Timage = LoadImage ("griffe.png")
SetImageHandle hImage, 0,0

While Not KeyDown (KEY_ESCAPE)
  Cls
  
  SetColor  255, 255,255
  
  DrawRect 300,100,200,150
  DrawImage hImage, 250,100
  
  DrawRect 300,300,200,150
  DrawImageArea hImage, 300,300, 50, 0, 200, 150
  
  Flip
Wend

End


Function DrawImageArea(image:TImage, x#, y#, rx#, ry#, rw#, rh#, frame=0)
  Local origin_x#, origin_y# ; GetOrigin (origin_x, origin_y)
  Local tw = Pow2Size(image.width)
  Local th = Pow2Size(image.height)
  Local rw1#  = rx + rw
  Local rh1#  = ry + rh
  Local x0# = -image.handle_x, x1# = x0 + rw
  Local y0# = -image.handle_y, y1# = y0 + rh
  
  If rw1 &gt; image.width
    x1 = x0 + rw + image.width - rw1
    rw1 = image.width
  EndIf
   
  If rh1 &gt; image.height
    y1 = y0 + rh + image.height - rh1
    rh1 = image.height
  EndIf
?Win32
  If TD3D7ImageFrame(image.frame(frame))
    Local frame:TD3D7ImageFrame = TD3D7ImageFrame(image.frame(frame))
    
    frame.setUV(rx / tw, ry / th, rw1 / tw, rh1 / th)
    frame.Draw x0, y0, x1, y1, x + origin_x, y + origin_y
    frame.setUV(0, 0, image.width / Float(tw), image.height / Float(th))
  Else
?
    Local frame:TGLImageFrame = TGLImageFrame (image.frame(frame))
                
    frame.u0 = rx / tw
    frame.v0 = ry / th
    frame.u1 = rw1 / tw
    frame.v1 = rh1 / th
    
    frame.Draw x0, y0, x1, y1, x + origin_x, y + origin_y
    
    frame.u0 = 0
    frame.v0 = 0
    frame.u1 = image.width / Float(tw)
    frame.v1 = image.height / Float(th)
?Win32
  EndIf
?
  
  Function Pow2Size(n)
    Local ry = 1
    
    While ry &lt; n
      ry :* 2
    Wend
    
    Return ry
  End Function
End Function</textarea> <br><br></td></tr></table><br>
<a name="645132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> the dw, dh had a reason:<br><br>l,t and h,w define the rect on the image you want to draw.<br><br>x,y defines the position for the rect<br>dw,dh define the size of the image when you draw it.<br><br>The reason I added those: What if you have a 512x512 image you split up to 128x128 subimages. But for some reason you want to draw them in 80x60 or something similar? Without dw and dh, you can't do that. That's why I added them. If you want to draw it in 1:1 scale, you can still set w,h and dw,dh to the same value.<br><br>And the power of two: why should this be of interest? You don't need power of two if you draw subparts of a texture. There is no reason to enforce it. (the image will be as whole within VRAM and thus be power of 2 as it was loaded through BMs routines) <br><br></td></tr></table><br>
<a name="645136"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I can read code thanks...I was probably a bit harsh when I said pointless, just not used that often generally and I was thinking more about compatibility with classic Blitz commands. It'd be easy enough to add them back and setting them to default to rw and rh.<br><br><div class="quote"> the image will be as whole within VRAM and thus be power of 2 as it was loaded through BMs routines <br></div>Precisely! The UV settings have to take that into account, where as Image.width and Image.height do not. <br><br></td></tr></table><br>
<a name="645138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why should the UV have to take that into account?<br>There is no reason for it.<br>I did not create a DrawImageArea function to be forced to power of 2 subimages once again. That would be totally pointless! If you want that, you could have used loadanimimage which already does work that way and would be faster as image frames are seperate images.<br><br>The target of the function is to draw any arbitary subimage of an image to any arbitary area on the screen. For everything else, BM has the needed functionality as part of Max2D <br><br></td></tr></table><br>
<a name="645144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh dear...Have you even tried your own code?...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

Graphics 800, 600, 32

Local img:TImage = LoadImage("bmlogo.png", 0)' A 257x257 image

SetClsColor 0, 0, 200

Cls

DrawImage img, 0, 12
DrawImageAreaMe img, 260, 12, 0, 0, 128, 128
DrawImageAreaDream img, 520, 12, 128, 128, 0, 0, 128, 128 

DrawText "Full", 12, 0
DrawText "My Quarter", 270, 0
DrawText "Dreamora's Quarter", 520, 0   

Flip

WaitKey()

End


Function DrawImageAreaMe(image:TImage, x#, y#, rx#, ry#, rw#, rh#, frame:Int=0)
	Local origin_x#, origin_y# ; GetOrigin (origin_x, origin_y)
	Local tw = Pow2Size(image.width)
	Local th = Pow2Size(image.height)
	Local rw1#	= rx + rw
	Local rh1#	= ry + rh
	Local x0# = -image.handle_x, x1# = x0 + rw
	Local y0# = -image.handle_y, y1# = y0 + rh
	
	If rw1 &gt; image.width
		x1 = x0 + rw + image.width - rw1
		rw1 = image.width
	EndIf
	 
	If rh1 &gt; image.height
		y1 = y0 + rh + image.height - rh1
		rh1 = image.height
	EndIf
?Win32
	If TD3D7ImageFrame(image.frame(frame))
		Local frame:TD3D7ImageFrame	= TD3D7ImageFrame(image.frame(frame))
		
		frame.setUV(rx / tw, ry / th, rw1 / tw, rh1 / th)
		frame.Draw x0, y0, x1, y1, x + origin_x, y + origin_y
		frame.setUV(0, 0, image.width / Float(tw), image.height / Float(th))
	Else
?
		Local frame:TGLImageFrame = TGLImageFrame (image.frame(frame))
								
		frame.u0 = rx / tw
		frame.v0 = ry / th
		frame.u1 = rw1 / tw
		frame.v1 = rh1 / th
		
		frame.Draw x0, y0, x1, y1, x + origin_x, y + origin_y
		
		frame.u0 = 0
		frame.v0 = 0
		frame.u1 = image.width / Float(tw)
		frame.v1 = image.height / Float(th)
?Win32
	EndIf
?
	
	Function Pow2Size(n)
		Local ry = 1
		
		While ry &lt; n
			ry :* 2
		Wend
		
		Return ry
	End Function
End Function

Function DrawImageAreaDream(image:TImage, x#, y#, dw#, dh#, l#, t#, w#, h#, frame:Int=0)
	Local origin_x#,origin_y#
	GetOrigin (origin_x,origin_y)
	Local l1#	= l + w
	Local h1#	= t + h
	Local x0#=-image.handle_x,x1#=x0+w
	Local y0#=-image.handle_y,y1#=y0+h

	If l1 &gt; image.width
		x1 = x0 + w + image.width - l1
		l1 = image.width
	EndIf 
	If h1 &gt; image.height
		y1 = y0 + h + image.height - h1
		h1 = image.height
	EndIf

	If TGLImageFrame (image.frame(frame))
		Local frame:TGLImageFrame 	= TGLImageFrame (image.frame(frame))
								
		frame.u0 = l / image.width
		frame.v0 = t / image.height
		frame.u1 = (l1) / image.width
		frame.v1 = (h1) / image.height
		frame.Draw x0,y0,x0+dw,y0+dh,x+origin_x,y+origin_y
		
		frame.u0	= 0
		frame.v0	= 0
		frame.u1	= 1
		frame.v1	= 1
	Else
		Local frame:TD3D7ImageFrame	= TD3D7ImageFrame(image.frame(frame))
		frame.setUV (l/image.width, t/image.height, (l1) / image.width, (h1) / image.height)
		frame.Draw x0,y0,x0+dw,y0+dh,x+origin_x,y+origin_y
		frame.setUV (0,0,1,1)
	EndIf
	
End Function</textarea><br>Using <a href="http://homepage.ntlworld.com/mollymole/storage/bmlogo.png" target="_blank"><b>this image</b></a>, I get <a href="http://homepage.ntlworld.com/mollymole/storage/screen.jpg" target="_blank"><b>this</b></a>. <br><br></td></tr></table><br>
<a name="645147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok. in that case its really needed. .width / .height don't work as they should, they don't have the real image width/height saved of the image that is held in VRAM ... thats plain crap but ok.<br><br>Thanks for mentioning that. Never realized that BM saves incorrect informations in its internal structure (or if the internal handling changed since BM 1.06 for which this function was written)<br><br>I thought you meant powerof2 for the subimagerect you want to draw, not for the width/height of the original image. Thats why I didn't understand its use. sorry.<br><br>Is it ok, if I add that to my code? <br><br></td></tr></table><br>
<a name="645149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> ok. in that case its really needed. .width / .height don't work as they should, they don't have the real image width/height saved of the image that is held in VRAM ... thats plain crap but ok. <br></div>Remember, Max2D is trying to act like a 2D system, so it stands to reason that the texture resizing should be hidden from the user. It would be nice if the real texture size was stored somewhere though (Unless it is and I've missed it?).<br><br><div class="quote"> or if the internal handling changed since BM 1.06 for which this function was written <br></div>It's always been that way.<br><br><div class="quote"> Is it ok, if I add that to my code? <br></div>Of course you can.<br><br><br>[edit]<br>Apologies to hub for the thread hi-jack...<br>[/edit] <br><br></td></tr></table><br>
<a name="645150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Never spoted it because I only use PowerOf2 textures (as others have a VRAM overhead).<br>Updated the code <br><br></td></tr></table><br>
<a name="645214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've modified the code to use the Dreamora/ GeoffTheGyratingGiraffe DrawImageArea function<br>to correct the bug on old machine, so<br>so could you test this :<br><a href="http://www.bayre.com/zigwigwis/test_griffe_2.exe" target="_blank">http://www.bayre.com/zigwigwis/test_griffe_2.exe</a><br><br>Many thanks !!!! <br><br></td></tr></table><br>
<a name="645310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >undomiel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, works as expected now. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
