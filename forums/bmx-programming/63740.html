<!DOCTYPE html><html lang="en" ><head ><title >Optimising use of large quantities of objects</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Optimising use of large quantities of objects</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Optimising use of large quantities of objects</a><br><br>
<a name="711496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi All,<br><br>I was wondering if you guys had any ideas regarding this:<br><br>I have a large number of objects, upwards of say 20,000. Currently they are in a list. The list has to be checked sometimes 10 times a logic loop.<br><br>I need a way to optimise this:<br><br>My objects are in 3D space and can have any coordinate in 3D space.<br><br>What I would like to do is find a way to itterate only blocks near the camera, so that if there are only 30 on screen then only 30 objects get checked without having to go through the 20,000 objects.<br><br>Im also concerned that Lists are too slow for this use. Are there any alternative methods and techniques to do this efficiently?<br><br>One way I have thought of is to do one check of each item in the list, and create a secondary list at this point containing only objects on screen, and then operate on this.<br><br>Any thoughts on this appreciated! <br><br></td></tr></table><br>
<a name="711503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Whenever I need to go through a list again, I try to find any way possible to carry out whatever operation it is while going through the list at the same time as the list is being checked elsewhere, it makes for messy code, but I'd rather my code was functional than readable<br><br>If you really HAVE to check the list 10 times per loop, the secondary list suggestion would seem the way to go to me<br><br>If it helps, I beleive checking Arrays is quicker, simply for the fact that you dont have to run through everything every time, and I have also had some success using Maps <br><br></td></tr></table><br>
<a name="711504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Before I had finished reading the whole post, I had come to the same anwser that you had , (that is a second list), this doent mean that we are right. Just that if its wrong we would both be doing it. <br><br>Possibly it would be better to make the second tlist an array, (But thats just academic)<br><br>If you could order them when you go thru the first Tlist, it might make a difference. Maybe <br><br></td></tr></table><br>
<a name="711505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> i can cut down on the 10 per loop but it will always happen a number of times. I would like to do it all in one itteration but the system can't work that way :(<br><br>I'll try my secondary list idea later.<br><br>Arrays would take alot of work to convert to, but I will look into the speed difference later :)<br><br>Thanks. <br><br></td></tr></table><br>
<a name="711507"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> H&amp;K,<br><br>I would do it all as an array if I could.<br><br>What I think im going to do is change all code that currently uses the large list to use a once-per-loop "Active" list, and see how that fares.<br><br>Thanks :)<br><br>[edit]<br><br>Yup, thinking about it, i can render all objects but only have the maths go on around blocks within a certain distance of *the point the camera is looking at* or *the point the mouse is over*. this should reduce the math from 20,000 checks per list use to no more than say, 1000. (selections can contain many objects)<br><br>Not a bad idea, and now im quite excited to implement it :)<br><br><br>And next? Well, after the CPU requirement of 20,000 blocks drops, i have to sort out the GPU requirement haha. <br><br></td></tr></table><br>
<a name="711509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I would do it all as an array if I could <br></div><br><br>Dont forget that an array is only better is you are not manipulating the array itself. The reason I sudgested an array for the second Tlist, was your implication that it would be Recreated each time, and,  (and this is important), <i>I dont mean an array of the objects</i>, I mean an array of the Tlinks to the objects in the main list. (Or a Tlist of Tlinks to the first list) <br><br></td></tr></table><br>
<a name="711510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I dont mean an array of the objects, I mean an array of the Tlinks to the objects in the main list <br> <br></div><br><br>hmm! an interesting idea there H&amp;K. Thanks for the thought! <br><br></td></tr></table><br>
<a name="711556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AlexO</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Yup, thinking about it, i can render all objects but only have the maths go on around blocks within a certain distance of *the point the camera is looking at* or *the point the mouse is over*. this should reduce the math from 20,000 checks per list use to no more than say, 1000. (selections can contain many objects)<br> <br></div><br><br>not sure how your objects are setup but another way to cut out checks is visibility. Shoot a ray (or a few rays) from you're camera's position to each object inside that 'smaller' list that you already cut out. any object that doesn't have a clear line of sight you could ignore for this iteration, further cutting down on any computation you need to do. <br><br></td></tr></table><br>
<a name="711567"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> good tip Alex, but the visibility changes over a frame so this wont work- useful for others though!<br><br>i just got home, going to start on the list programming. <br><br></td></tr></table><br>
<a name="711633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> first off, your object that you store should also have a TLink field that you use for reference.  with that you can traverse the list however you want.<br><br>here is a small extension to TList that allows you to start and any TLink and continue for a number or until the end.<br><a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1807" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1807</a> <br><br></td></tr></table><br>
<a name="711644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, interesting Dmaz.<br><br>Our objects could appear anywhere in the list though as they are all dynamically placed by the user. <br><br>Thanks for all your comments :) <br><br></td></tr></table><br>
<a name="712466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, just an update on this,<br><br>The "create a localised list once a frame and work from that" idea worked wonderfully resulting in a 600-800% increase in speed :)) <br><br></td></tr></table><br>
<a name="712502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/codearcs.php?code=1586" target="_blank">*cough*</a> <br><br></td></tr></table><br>
<a name="712514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Eh yes, Pert! I saw this a while back.<br><br>I'll look into it :) <br><br></td></tr></table><br>
<a name="712745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd look into using octrees to partition your 3D space into workable chunks. I don't know a lot about them myself or else this post would be more insightful :), but it seems like they'd be the tool for the job. <br><br></td></tr></table><br>
<a name="712749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> that could help with the FPS walkthrough mode, again, its something i can look into. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
