<!DOCTYPE html><html lang="en" ><head ><title >Lua: Pushing a Object onto the Stack</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Lua: Pushing a Object onto the Stack</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Lua: Pushing a Object onto the Stack</a><br><br>
<a name="690677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ragz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to push an object from a blitz type onto the stack so that later on lua can pass it to blitz? Right now I'm keeping all the objects in an array and passing the index to lua. <br><br></td></tr></table><br>
<a name="690679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >taxlerendiosk</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm writing an alternative Blitz Lua module at the moment, this is a bit from it that should help you out. It passes the Blitz object as a Lua variable of type "light userdata", which is basically like a "Byte Ptr" or "void *".<br><br>Warning: It's your responsibility to make sure that this pointer is still pointing to something later on when you want to pop it back out using lua_toblitzobject, since Blitz's garbage collector will not know that a reference exists inside Lua and will happily collect the object if no reference exists in your Blitz program. (I've got a plan to stop this &amp; have objects which will not be collected until both the Blitz *and* Lua garbage collectors want rid of it, but I haven't put it into action yet.) So you will still need those arrays of all your objects, even if you don't appear to actually be using them.<br><br><pre class=code>
Extern
	Function lua_pushblitzobject( lua_state:Byte Ptr, blitzobject:Object )="lua_pushlightuserdata"

	Function lua_toblitzobject:Object( lua_state:Byte Ptr, index:Int )="lua_touserdata"
End Extern
</pre> <br><br></td></tr></table><br>
<a name="690684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ragz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I was planning to replace the arrays with lists, and then push the TLinks to Lua, that should work right?<br><br>Those functions are good to go, or do I need to modify them to my needs in any way? <br><br></td></tr></table><br>
<a name="690687"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >taxlerendiosk</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure why you'd want to pass TLinks instead of the actual object itself, which should work just as well, but sure.<br><br>You should be able to just drop that block into some code that imports axe's module, and use them for any Blitz object at all. Just remember to make sure something in Blitz "knows" about your object, like a list or an array. <br><br></td></tr></table><br>
<a name="690692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ragz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah right, you are right about Objects making more sense, not sure why I wanted to pass TLinks either :P<br><br>Well thanks for the help, should be very useful :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
