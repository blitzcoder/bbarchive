<!DOCTYPE html><html lang="en" ><head ><title >Creating a DPaint clone in BMax</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Creating a DPaint clone in BMax</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Creating a DPaint clone in BMax</a><br><br>
<a name="806734"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >QuickSilva</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What would be the best way to go about making a pixel pushing paint program (say that ten times fast ;) in BMax? Is it a relatively simple task or would it be quite hard? I`m asking as I would like to try and make one but have never done anything other than games programming before. I`m not really sure as to how to go about it to tell the truth so any help would be great.<br><br>Jason. <br><br></td></tr></table><br>
<a name="806742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It won't be fast.<br><br>Pixel operations in BM have to be done on pixmaps.<br>Those are either drawn to backbuffer (-&gt; pixel per pixel copy) or have to be made an image which means texture generation and upload<br><br>In both cases, not fast enough to be "ten times faster" than anything done yet.<br><br>if you need it to be faster, check out shaders and do it as pixel shader for example. <br><br></td></tr></table><br>
<a name="806743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or even easier, use DirectDraw surfaces, and keep it all 2D &amp; still fast ;) <br><br></td></tr></table><br>
<a name="806744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> say that ten times fast <br></div><br>I think he meant the alliteration :-p<br><br>A pixel-editor should be relatively easy to do in blitzmax. There are functions that can read/modify specific pixels in a pixmap, which is all you need.<br>The rest is up to you to implement how you wish :-) <br><br></td></tr></table><br>
<a name="806745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Even with the limitations of Blitz pixel pushing, speed will not be an issue. If by DPaint you mean deluxe paint on the Amiga (the last paint program I ever enjoyed using), 10x as fast will be easy. <br><br></td></tr></table><br>
<a name="806791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, these days with the GPU-accelerated drawing and fast CPU's you shouldn't have much problem at all making a relatively fast graphics app.<br><br>I say go with OpenGL since DX is Windows only. I think if it were me I would write my own routines accessing pixmaps in main memory to do all the drawing, since that lets you have precice control over what is drawn and can make much larger bitmaps bigger than the screen. Then you can do things like flood fills where you'll need to READ the image. It's not so efficient to read the backbuffer and the backbuffer can only be the size of the screen resolution.<br><br>I would write the routines using pointers to access the individual pixels in the pixmap. Writing a paint program usually means writing quite a large number of small-ish specialized routines so it can be quite a bit of coding, but it's a good project. You need to ask yourself what you want it to be able to do in terms of sizes of bitmaps, resolution, color depth/palettes, etc... and also you've got to give consideration to how to do a GUI. <br><br></td></tr></table><br>
<a name="807650"></a>

<a name="807655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yah, Amiga had lots of good paint software. Deluxe Paint, Brilliance, Personal Paint, TV Paint, Spectrapaint, etc etc <br><br></td></tr></table><br>
<a name="807747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >klepto2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a small additon about fast pixmap manipulating and displaying. It is much faster for pixeloperations than the standard LockImage() or DrawPixmap stuff.<br><br>I think I have more time to explain it tomorrow.<br><br><pre class=code>
SetGraphicsDriver(GLMax2DDriver())

Graphics 800,600,0,-1

Local Pix:TPixmap = CreatePixmap(512,512,PF_RGBA8888)
ClearPixels(Pix,$ffffffff)
Local Image:TImage = LoadImage(Pix)
Local Pix2:TPixmap 

'SetClsColor (255,255,255)
Local Mode:Int = 0
Local Radius:Int = 4
Local UpdateTime:Int = 0

Local fps:Int = 0
Local fpstime:Int = MilliSecs()
Local fps2:Int = 0
Local angle:Float = 0


While Not KeyHit(KEY_EScape)
	Cls
		SetColor 255,0,0
		DrawRect 0,0,516,516
		SetColor 255,255,255
		UpdateTime = MilliSecs()
		SetRotation Angle
		DrawImage Image,2,2
		UpdateTime = MilliSecs()-UpdateTime

		
		If KeyHit(Key_Space) Then 
			If Mode = 2 Then 
				Mode = 0 
			Else
				Mode = 1 - Mode
			EndIf
			Angle = 0
			SetHandle 0,0

		EndIf
		
		If KeyHit(KEY_Enter) Then 
			angle = 0
			Mode = 2
			SetHandle 256,256
		EndIf
		If KeyHit(Key_Up) Then Radius:+1
		If KeyHit(Key_Down) Then Radius:-1
		If Radius &lt; 1 Then Radius = 1
		Local MX:Int = MouseX()
		Local MY:Int = MouseY()
		
		Local XX = Min(Max(2,MX),514)
		Local YY = Min(Max(2,MY),514)


		If Mode &lt;&gt; 2 Then 
		If MouseDown(1) = True Then
			If MX &gt; 2 And MX &lt; 512
				If MY &gt; 2 And MY &lt; 512
				If Mode = 1 Then
					Pix = LockImage(Image)
				 EndIf
					For Local Xi:Int = 0 To radius
						For Local yi:Int = 0 To radius
						 
							Local X = Min(Max(2,MX+xi),512)
							Local Y = Min(Max(2,MY+yi),512)

							WritePixel Pix,X-2,Y-2,$ff000000
							
						Next
					Next
					
					If Mode = 0 Then
						UploadPixToImg(Image,Pix,XX-2,YY-2,radius+2,radius+2)
					EndIf
					
				EndIf
			EndIf
		EndIf
			Else
			Angle:+0.2	
		EndIf
		
		SetRotation 0.0
		
		DrawText "Mode       : " + Mode,20,515
		DrawText "Radius     : " + Radius,20,535
		DrawText "UpdateTime : " + UpdateTime,20,555
		DrawText "FPS        : " + FPS,532,20
		DrawText "Space       -&gt; Change Mode (0 = Fast,1 = LockImage)",532,40
		DrawText "Up and Down -&gt; Change Radius",532,60
		DrawText "Color      :  $" + Hex(ReadPixel(Pix,Min(Max(0,MouseX()-2),511),Min(Max(0,MouseY()-2),511))),20,575
		
		fps2:+1
		
		
		If MilliSecs()-fpstime &gt;= 1000 Then
			fps = fps2
			fpstime = MilliSecs()
			fps2 = 0
		EndIf
		
		If KeyHit(KEY_F1) Then SavePixmapPNG(Pix,"test.png")

	Flip 0
Wend




Function UploadPixtoImg(tex:TImage,Pixmap:TPixmap,x:Int = -1,y:Int=-1,w:Int=-1,h:Int=-1)
	Local ImgF:TGLImageFrame = TGLImageframe(tex.frame(0))
	Local mip_level:Int = 0

		If ImgF &lt;&gt; Null Then
			glBindtexture GL_TEXTURE_2D,ImgF.name
			glPixelStorei GL_UNPACK_ROW_LENGTH,pixmap.pitch/BytesPerPixel[pixmap.format]
			If X &lt;&gt; -1 And y &lt;&gt; -1 And w &lt;&gt; -1 And h &lt;&gt; -1 Then
				glTexSubImage2D GL_TEXTURE_2D,mip_level,X,y,W,H,GL_RGBA,GL_UNSIGNED_BYTE,pixmap.pixelptr(X,Y)
				
			Else
				glTexSubImage2D GL_TEXTURE_2D,mip_level,0,0,pixmap.width,pixmap.height,GL_RGBA,GL_UNSIGNED_BYTE,pixmap.pixels
			EndIf
			glPixelStorei GL_UNPACK_ROW_LENGTH,0
			glBindtexture GL_TEXTURE_2D,0
		EndIf
		
	DrawText " ",-20,-20
End Function
</pre> <br><br></td></tr></table><br>
<a name="807930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sebas76</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi all,<br><br>Tvpaint has been ported to PC.<br>You can try Aura from Newtek or Tvpaint or Mirage.<br>These 3 soft are Tvpaint version.<br>They are the best paint software for amiga lovers... <br><br></td></tr></table><br>
<a name="1288172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rno</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> maybe interesting:<br><br>With the permission of Electronic Arts, Inc. the Computer History Museum makes available, for non-commercial use, the source code to the 1986 version I of DeluxePaint. There are 89 files of C language source:<br><br><a href="http://www.computerhistory.org/atchm/electronic-arts-deluxepaint-early-source-code/" target="_blank">http://www.computerhistory.org/atchm/electronic-arts-deluxepaint-early-source-code/</a> <br><br></td></tr></table><br>
<a name="1288177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >coffeedotbean</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> many a good hour I spent making animations in DPaint on my Amiga, mostly just planes spinning in and out due to that automated feature it had to scale and move. <br><br></td></tr></table><br>
<a name="1288192"></a>

<a name="1288196"></a>

<a name="1288197"></a>

<a name="1288198"></a>

<a name="1288199"></a>

<a name="1288200"></a>

<a name="1288201"></a>

<a name="1288203"></a>

<a name="1288204"></a>

<a name="1288205"></a>

<a name="1288251"></a>

<a name="1288364"></a>

<a name="1288365"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice code, Klepto2 !<br><br>I think he is not necessarily saying that he wants the code to go 10x fast, but to say the PHRASE, "pixel pushing paint program" 10x fast, as it is definitely a tongue-twister. And no, I can't do that. Not without another cup of coffee. :)<br><br>Here is my code on the issue, Jason:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
'    ___________________________________________
'   //                                        //
'  //    "Pixel Pushing Paint Program" v0.2  //
' //    Written by David W (dw817) 01/06/16 //
'//________________________________________//

Strict
SetGraphicsDriver(GLMax2DDriver()) ' no graphic problems
Graphics 640,480
SetLineWidth 4 ' give our lines some thickness
Local t$,mx,my,x,y,lx,ly,i

Repeat
  Cls
  lx=0 ' reset our last positions
  ly=0
  For i=1 To Len(t$) Step 4 ' coordinates are stored 4-characters each
    x=fncw(t$,i) ' extract X-coordinates
    y=fncw(t$,i+2) ' extract y-coordinates
    If Abs(x-lx)&lt;10 And Abs(y-ly)&lt;10 Then DrawLine x,y,lx,ly ' draw a line between coordinates if they are close to each other
    lx=x ' record last plotted position
    ly=y
  Next
  mx=MouseX() ' get mouse X
  my=MouseY() ' get mouse y
  If MouseDown(1) And(mx&lt;&gt;lx Or my&lt;&gt;ly) ' mouse down AND moved from last plot
    t$:+Chr$(mx/256)+Chr$(mx Mod 256)+Chr$(my/256)+Chr$(my Mod 256) ' add coordinates
  EndIf
  If KeyDown(8) ' if BACKSPACE held
    t$=Left$(t$,Len(t$)-4) ' yank out the last xy coordinates
    If t$&gt;"" Then MoveVirtualMouse fncw(Right$(t$,4),1),fncw(Right$(t$,2),1) ' if not first point, move mouse to matching location
  EndIf
  DrawText "("+Len(t$)+") ",0,0 ' Show how many bytes we're using
  Flip
Until KeyDown(27) ' ESCAPE key exits

Function fncw(a$,b)
  Return Asc(Mid$(a$,b))*256+Asc(Mid$(a$,b+1)) ' Generate number from 0-65535 from 2-string characters and b is position in string
EndFunction
</textarea><br><br><img src="http://www.writerscafe.org/uploads/rte/70bbe8e2828dd5738410a795a2888e69.png"><br><br>To doodle, put the mouse anywhere and hold down the mouse button. To erase, hold down the BACKSPACE key. To exit press the ESCAPE key. You can definitely see this is a pixel pusher program. <br><br></td></tr></table><br>
<a name="1288206"></a>

<a name="1288207"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is an <b>eight-year-old</b> thread. The author has most likely long moved on (I'm saying this because you mentioned his name as if referring to him directly).<br>He won't read your post.<br><br>I've been meaning to tell you; if you want to help grow the codebase of something in need of contributors like you, the MonkeyX-2 project is ideal:<br><a href="http://www.monkey-x.com/Community/topics.php?forum=230" target="_blank">http://www.monkey-x.com/Community/topics.php?forum=230</a><br><br>It's the latest language by the maker of BMax, but it's obscure to the general public and needs code examples.<br>It's free to make an account there and start posting. If you want to cause a positive impact, that is the place. <br><br></td></tr></table><br>
<a name="1288211"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> As I've mentioned before, Kryzon, my code is for everyone to see and learn from. He MAY read it. There are no absolutes in life. Don't be so negative. :)<br><br>RNO is certainly optimistic and I applaud that.<br><br>Now I tried a little Monkey-X a few weeks back. While the EXE runtime seems fine, it staggers considerably in the Firefox browser. I would like to know what is causing that first before I dedicate any serious time to it.<br><br>Now I HAVE written FLASH in the past for Online usage and it certainly runs smoother than Monkey-X.<br><br>As you know, there is considerable support for BlitzBASIC, but I chose BlitzMAX primarily for the flip() command which ensures smooth graphics and low CPU usage always.<br><br>Those to me are key. <br><br></td></tr></table><br>
<a name="1288266"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> One point about paint programs that may not seem obvious to game programmers is the fact that you don't need to do full-screen updates, or even have a regular frame tick on the canvas area-- instead your ticks only happen when the user actually does something. <br><br></td></tr></table><br>
<a name="1288308"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Endive, the problem with this is, suppose you want to have background images run while you are navigating menus ?<br><br>If you don't clear the screen every machine cycle and redraw everything, you will have graphic elements lock up while you are involved in some other loop.<br><br>That S3 engine bit I uploaded earlier, you notice that absolutely nothing slows it down once it's going. You can navigate menus or anything else and all elements continue to run in background at the exact speed and timing they are supposed to.<br><br>The secret ? Clear the screen to BLACK and redraw absolutely every single element that is needed - every single cycle.<br><br>Now your method =WILL= work if you use a series of overlaying grids only of image data with no transparency effects. And that will be considerably faster too.<br><br>But Truetype Fonts, most of them, are not monospace, so that method is out for them. Also if you have some graphic elements bigger or smaller than the grids you use, or you want to have some elements appear through partially transparent frames.<br><br>So far the CPU is at 18% with my current 2016 engine. My envelope is 25%, and this a 64-bit quad core computer.<br><br>At that point I need to start writing faster and more intelligent code, however and whatever it takes to do so. <br><br></td></tr></table><br>
<a name="1288344"></a>

<a name="1288345"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also did want to add, I have written MANY functions for Monkey-X. I tried a game this morning found on NewGrounds written with it, and the graphics are smooth with little CPU usage - so - I will give it another go.<br><br>What I especially need right now is the code to draw pixels, to read them, and to read raw keystrokes, and to read and write data directly from the Internet (as runtimes are stored there). Also whatever command is used to prematurely end a runtime in the middle of the code so I can do some debugging.<br><br>With those things I can start to write demos, games, and utilities in it.<br><br>Here are the functions I've written thus far that are NOT found in Monkey-X's command set.<br><br>val(), asc(), mid$(), len(), fnc$(), fno$(), fnz$(), upper$(), lower$(), firstcap$(), trim$(), instr().<br><br>I'm current working on writing chr$(), bound(), wrap(), and rinstr() ATM, which are also not part of Monkey-X's command set. <br><br></td></tr></table><br>
<a name="1288349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a whole other forum devoted to chatting about Monkey - <a href="http://www.monkey-x.com/Community/_index_.php" target="_blank">http://www.monkey-x.com/Community/_index_.php</a><br><br>This is the BlitzMax forum. <br><br></td></tr></table><br>
<a name="1288361"></a>

<a name="1288362"></a>

<a name="1288363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I know Brucey, but Kryzon brought it up so I thought I would reply proper. In any case, I can check there and see what is happening.<br><br>I will wander between both and certainly produce more BlitzMAX code to answer questions posed. So - you won't get rid of me that easily. :) <br><br></td></tr></table><br>
<a name="1288370"></a>

<a name="1288371"></a>

<a name="1290250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a great idea, adding BASIC commands to the Monkey API. You need to share those in some way, so I suggest setting up a GitHub account.<br><br><div class="quote"> What I especially need right now is the code to draw pixels, to read them <br></div><br>The graphics modules of Monkey, BlitzMax and other modern engines use GPU textures, instead of memory buffers as it was done with older technologies.<br>If you want pixel manipulation, you need to learn how texturing works in OpenGL.<br><br>The most likely end result will be that you keep a local copy of the texture as a memory buffer, make changes to it and then upload it to the GPU (by means of special OpenGL functions).<br>The GPU is not designed to get things back and forth efficiently between system RAM and video RAM. <br>It's meant for you to do something once, upload it to the GPU memory (so the asset lies in that fast internal memory) and draw it from there. <br><br></td></tr></table><br>
<a name="1288373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is GitHub ? Certainly I can just post the source code in the "http://www.monkey-x.com/Community/_index_.php"<br><br>Yes, my main engine (BlitzMAX) is using a 'texture' to create the screen. I'm - not very comfortable with it, but it does work now the way I want it to.<br><br>I honestly don't know what DarkBASIC is doing or if they are even in business anymore. But I do know that they focused on full-screen graphics for the programmer, ultimately. And that was a plus in my book at the time.<br><br>I never have been comfortable with programming languages that force texturing down your throat - or object orienting.<br><br>I'm old-school, that should be apparent, and I like my graphic screens to be easily accessible, fast, black, and full size, and my programs to plot individual pixels as-fast-as-humanly-possible where I can control the speed and CPU usage additionally. <br><br></td></tr></table><br>
<a name="1288400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Endive, the problem with this is, suppose you want to have background images run while you are navigating menus ?<br><br>If you don't clear the screen every machine cycle and redraw everything, you will have graphic elements lock up while you are involved in some other loop. <br></div><br>Dirtyrects.  A dirtyrects algorithm keeps track of the areas of the screen that need to be redrawn (divide it up into 32x32 tiles, say) and then redraws only those.<br><br>In a paint program, you don't need to redraw your whole screen every tick.  Only the areas that have actually changed.  If you are working in lower resolution (eg for a pixel art program) this may not matter because of the lower resolution but even for 4x4 pixels on a 1600x1000 grid you will start seeing slowdown if you are trying to update every tick.<br><br>Also since your paint program is not doing anything animated there should be no reason to update every tick.  <br><br>Basically all windowing systems used dirtyrect repaints at least until fairly recently with compositing happening on the GPU. <br><br></td></tr></table><br>
<a name="1288406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Redraws only areas of the screen that need to be redrawn, Endive ? Hmm ... I have yet to see easy code on how to draw directly to a TIMAGE or TPIXMAP, and by that I mean not one pixel at a time but using drawline(), drawrect(), and any other normal graphic commands - as if it were the graphics screen.<br><br>As I mentioned earlier, in GFA, it's:<pre class=code>newdc=memdc(_dc(1))
bmpdc=createbmp(1024,768)
setbmp newdc,bmpdc
setdc newdc</pre>Where _dc(1) is the standard display. Using this method above, you can create a virtual 'screen' and save it to pointer newdc. Anytime you want to plot invisibly, just have your dc set to newdc<br><br>to copy this hidden screen to the normal screen it's:<pre class=code>bitblt newdc,0,0,1024,768,_dc(1),0,0,SRCCOPY</pre>Pretty straight-forward, and not too many commands to invoke. This is what I am looking for in BlitzMAX.<br><br>I think there is a command like GFA's SETDC where you can change the Display Channel to write directly to a tpixmap or timage, I'm just not sure how to do it.<br><br>With easy code for that, Dirtyrects() might be something interesting I could make use of - and not until. <br><br></td></tr></table><br>
<a name="1288407"></a>

<a name="1288408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Redraws only areas of the screen that need to be redrawn, Endive ? Hmm ... I have yet to see easy code on how to draw directly to a TIMAGE or TPIXMAP, and by that I mean not one pixel at a time but using drawline(), drawrect(), and any other normal graphic commands - as if it were the graphics screen. <br></div><br>It may or may not exist but it would take you 20 minutes to write drawline and drawrect up from writepixel.  See the bresenham line drawing routine I posted in my rasterizer (pretty sure that's from here originally).  <br><br>You could also do it with grabimage of modified areas into tiles, then when you do redraws, just redraw the tiles.  There isn't a native Blitz command to draw directly to TImages but you certainly can draw to the screen, then grabimage from that into a TImage.  <br><br>Grabimage is sort of slow though so you aren't going to be able to do a whole lot of those.<br><br>You could also roll your own RGB array and then do pixel draws out of that, but there you're back to writing your own draw primitives.<br><br>If you are serious about writing a paint program you are probably going to want to do the above anyway.  It could have a CLUT table, palettes, etc. <br><br></td></tr></table><br>
<a name="1288410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, I've already written a paint program, if you want to call it that. It's TileMaster, a reincarnation of the original from Commodore Amiga. It's quite powerful, works directly with tiles of any size up or down and essentially uses every single key on the keyboard for editing, archiving, assembling, and manipulation. Ahh - I think it's just for me to use. :)<br><br>I wrote it in BlitzMAX about 5-years ago. It works great, but it would've been a lot easier to build if I could just draw directly to a tpixmap or timage as a virtual screen. <br><br></td></tr></table><br>
<a name="1288412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I wrote it in BlitzMAX about 5-years ago. It works great, but it would've been a lot easier to build if I could just draw directly to a tpixmap or timage as a virtual screen. <br></div><br>Once again you would need some sort of intermediary object wrapper. <br><br></td></tr></table><br>
<a name="1288424"></a>

<a name="1288425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm working on something involving the same issues so here is a pixmap drawline and plottopixmap.  You should be able to write drawrect in two minutes given drawlinetopixmap.<br><br>Notice that the drawline routine gets its colors from setcolor and setalpha and performs the hex conversion itself.<br><br><pre class=code>
Function DrawLinetoPixmap(inpixmap:TPixmap,X1:Int,Y1:Int,X2:Int,Y2:Int)
	'Draws a line of individual pixels from X1,Y1 to X2,Y2 at any angle
	Local r%,g%,b%,alpha#
	GetColor(r,g,b) ' getcolor uses var so we are setting r,g,b to whatever setcolor is using
	a=GetAlpha()
	Local col:Int = (r | g Shl 8 | b Shl 16 | a Shl 24 )  '  &lt;&lt; NOTE THIS, converts int rgb to hex
 	Local Steep:Int=Abs(Y2-Y1) &gt; Abs(X2-X1)			'Boolean
	If Steep
		Local Temp:Int=X1; X1=Y1; Y1=Temp		'Swap X1,Y1
		Temp=X2; X2=Y2; Y2=Temp		'Swap X2,Y2
	EndIf
	Local DeltaX:Int=Abs(X2-X1)		'X Difference
	Local DeltaY:Int=Abs(Y2-Y1)		'Y Difference
	Local Error:Int=0		'Overflow counter
	Local DeltaError:Int=DeltaY		'Counter adder
	Local X:Int=X1		'Start at X1,Y1
	Local Y:Int=Y1		
	Local XStep:Int
	Local YStep:Int
	If X1&lt;X2 Then XStep=1 Else XStep=-1	'Direction
	If Y1&lt;Y2 Then YStep=1 Else YStep=-1	'Direction
	If Steep Then Plottopixmap(inpixmap,Y,X,col) Else Plottopixmap(inpixmap,X,Y,col)		'Draw
	While X&lt;&gt;X2
		X:+XStep		'Move in X
		Error:+DeltaError		'Add to counter
		If (Error Shl 1)&gt;DeltaX		'Would it overflow?
			Y:+YStep		'Move in Y
			Error=Error-DeltaX		'Overflow/wrap the counter
		EndIf
		If Steep Then Plottopixmap(inpixmap,Y,X,col) Else Plottopixmap(inpixmap,X,Y,col)		'Draw
	Wend
End Function

Function plottopixmap(p:TPixmap,x#,y#,col%)
	p.WritePixel(x,y,col)
End Function
</pre> <br><br></td></tr></table><br>
<a name="1288433"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is nice code you've written, Endive - and while I can certainly go this route, to write all my own graphics routines a pixel at a time. I still would prefer to have a way of "poking" BlitzMAX so I can change the regular display to write directly to an open pixmap or timage, especially since my way of handling screen updates are done with commands like this:<pre class=code>              If i=0
                setcolr 4,4,4
                SetBlend alphablend
                SetAlpha 1
                DrawImage img_frame[c,0],kk*16,j*16
              ElseIf i=1
                wht              
                SetBlend lightblend
                SetAlpha .5
                DrawImage img_frame[c,1],kk*16,j*16
              ElseIf i=2
                blk
                SetBlend alphablend
                SetAlpha .5
                DrawImage img_frame[c,2],kk*16,j*16
              ElseIf i=3
                SetColor rr,gg,bb
                SetBlend alphablend
                SetAlpha 1
                DrawImage img_frame[c,3],kk*16,j*16
                wht
              EndIf</pre>I think you mentioned it, why rewrite what already works - unless there is a way of transferring one pixmap piece or whole to another pixmap's piece or whole WITHOUT using For/Next, no, where it is an existing command in BlitzMAX.<pre class=code>CopyPixmapPiece sourcepix,pixsourceh,pixsourcev,pixsourcex,pixsourcey,destpix,pixdesth,pixdestv,pixdestx,pixdesty,type</pre>Where Type could be any of your usual copy methods of MASKEDIMAGE, FILTEREDIMAGE, MIPMAPPEDIMAGE, and DYNAMICIMAGE. <br><br></td></tr></table><br>
<a name="1288469"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's the point, to my knowledge it doesn't exist.  The TImage/TPixmap interface has always been a little bit rough. <br><br></td></tr></table><br>
<a name="1288487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, it does, the part of being able to write normal graphics directly to a pixmap, Casaber did it ... retrieving link:<br><br><a href="http://www.blitzbasic.com/Community/post.php?topic=105546&amp;post=1287365" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=105546&amp;post=1287365</a><br><br>Pretty neat stuff, but the code all around it is a bit much. Should be a way of trimming it down. <br><br></td></tr></table><br>
<a name="1288524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> That code is OGL only ... dig the forums, there is also code for DX - you "just" need to make both conform and "blitzmax-driver"-like, so the correct thing is used automatically (or use some wrapper).<br><br>Without ... your r2t code just works on certain platforms / setups - some users of my game TVTower reported problems with OGL, they would then not be able to run your app.<br><br><br>@refresh each frame<br>A real "GUI"-paint-program wont need to do this, as it gets informed whether its content needs a RePaint (or more detailed: the corresponding GUI widget - most likely the canvas - gets the event for a repaint/refresh).<br><br>The whole screen content is already managed by the OS, so they take care of what was hidden by a cursor, another application ...<br><br><br>Dirty Rects: code should be available in the forums, but it is not running flawless on every computer as the content might get garbled / destroyed by the GPU). I once was able to use some kind of dirty rects on my old SIS 631 GPU (2004 or so ?) but it did not work on the Radon 9600 Pro anymore :-)<br><br><br>So what does this mean for your GUI program: you get the repaint / refresh event and handle it: you update your canvas-content. If you now use some kind of "render to texture" you are easily able to offload some processing to the gpu.<br><br>Another approach is to use Max2D ... <br><pre class=code>
SetGraphics CanvasGraphics(self.canvas)
SetBlend AlphaBlend
SetViewport( 0,0,self.showDimension.getX(),self.showDimension.getY() )
SetClsColor 255,255,255
Cls
[...]
</pre><br><br>So you "blitzmax-like-draw" on request of the OS instead of intervals (refresh rate, timers...).<br><br>Just think of it to behave similar to "gui buttons". Methods:<br><br>a) check in each loop if button.clicked &gt; 0.<br>b) react on "onButtonClicked" (with your event handler attached)<br><br><br>For your canvas this is<br>a) render it again on each "loop"<br>b) wait for the OS to say it is needing a new "canvas content"<br><br>There might be the need to update the canvas regardless of "got dirty"-events: if you are eg. showing drying colors (you paint with water colors and it smears, tears down ...). This is the exception, but this could then handled with timers, and skipped redraws if there was no change on the canvas (remember: drawing something to the screen is "cpu expensive").<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1288547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Endive</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Dirty Rects: code should be available in the forums, but it is not running flawless on every computer as the content might get garbled / destroyed by the GPU). I once was able to use some kind of dirty rects on my old SIS 631 GPU (2004 or so ?) but it did not work on the Radon 9600 Pro anymore :-)<br> <br></div><br>I would just ghetto it up using a screenful of 32x32 tiles and wrapped draw calls that notify a tile when it's been written to. <br><br></td></tr></table><br>
<a name="1288565"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Derron, I'm getting an error on your code: "Identifier "CanvasGraphics" not found.<br><br>Endive, I can write a dirtyrects routine myself I imagine and it would be flawless (or pretty close to it). :)<br><br>But I'm missing something, doesn't BlitzMAX already handle this sort of thing ? Drawing to the screen all your changes when you use flip() ?<br><br>Also, this gives problems I found, the fault lies in "SetGraphicsDriver(GLMax2DDriver())"<br><br><pre class=code>
SetGraphicsDriver(GLMax2DDriver())
graphics 640,480
repeat
  cls
  drawoval 320-16,240-16,32,32
  flip
  flip
until keydown(27)
</pre><br><br>without the SetGraphicsDriver() command, it works fine. Is there a way to have this not flicker but still use the SetGraphicsDriver() command ? I normally use flip and flip when seeing final code to see if in those it runs at "normal" speed and save using only one flip for faster debugging. <br><br></td></tr></table><br>
<a name="1288645"></a>

<a name="1288646"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> My code was just a snippet of my spritepacker gui...something using MaxGUI.<br><br>@dirtyrectS<br>The problem is not the "what is clean..and what is dirty"-logic but the backbuffer. You think it is kept valid but the system might throw it away..leaving valid pixels...and overwritten ones. So you do not have a warranty of seeing the same content after the next flip.<br><br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1288661"></a>

<a name="1288666"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is a paint program in blitz not bmax,with source.May help may not,never used it.<br><br>written by Angus Arthur 2001.<br><br>before ppl complain its in code archive,or gallery ppl give away there code in the gallery.<br><br><a href="http://www.filedropper.com/bpaint742002" target="_blank">http://www.filedropper.com/bpaint742002</a> <br><br></td></tr></table><br>
<a name="1288667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitzman, WOW, reading the variables in the beginning. That's a BUNCH !<br><br>I know when I was working on early S3, it was a nightmare to code all that in. So - I didn't !<br><br>Instead I wrote a program in BM that was a bit like a database, I told it what BlitzMAX code to generate to initialize and load all the variables for my engine correctly, and it would generate a text file I later called, "MERGE." because you can merge external files in your BlitzMAX code. As I used it:<pre class=code>' / / / / / / / / / /
Include "merge.bmx"
' / / / / / / / / / /</pre><br><br>Doing this kept my main sourcecode clean.<br><br>Any chance of getting the EXE of Angus's paint program so I can see it proper ?<br><br>Derron, using the 'virtual screen' method, that might make it a lot easier to maintain and keep a 100% accurate dirtyrects. <br><br></td></tr></table><br>
<a name="1288668"></a>

<a name="1288671"></a>

<a name="1288672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Download the free Blitz3D,and run the code in that. dw817 <br><br></td></tr></table><br>
<a name="1288690"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzMan, here is the page to download:<br><br><img src="http://www.writerscafe.org/uploads/rte/0851cbc388c2e551480c8cff70af3b4a.png"><br><br>If this is not the right area, could you post direct URL, please ? <br><br></td></tr></table><br>
<a name="1288898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> I could post a copy of the Blitz3D program,being open source,and such but im not sure i am aloud to.If not try Ploppy`s Hybrid version. <br><br></td></tr></table><br>
<a name="1288910"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Go to your Account page, then click on "Register Product".  Follow the instructions...<br><br>Once you've registered, go to the "Product Updates" page and you should see it listed in the downloads next to the BlitzMax ones. <br><br></td></tr></table><br>
<a name="1288927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's okay, BlitzMAX. PM me about the Hybrid version tho, curious.<br><br>Got B3D up and going, thanks Brucey. Tried the paint program. Err ... ?? Yeah, mine's a bit better than that, not to toot my own horn.<br><br>I downloaded IDEAL which is a marvel of an IDE, but I can't get it to compile anything. Did they ever make an IDE with as much if not more ability for BlitzMAX ? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
