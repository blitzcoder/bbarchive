<!DOCTYPE html><html lang="en" ><head ><title >Flip</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Flip</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Flip</a><br><br>
<a name="713134"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I need to rig up a replacement for the Flip command that will just copy the back buffer to the front without modifying whats on the back buffer at all<br><br>Unfortunatly I cant find a way to directly affect the front buffer at all, and this is hampering my efforts<br><br>Any help would be apreciated <br><br></td></tr></table><br>
<a name="713137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't.<br>BlitzMax is 3D only and 3d needs switch of buffers.<br><br>The only way to "can so" would be writting direct api functions to do so, ie not BM commands or something the like. <br><br></td></tr></table><br>
<a name="713138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> What you can do, is fake tripple buffer. Copy the backbuffer to an image before flip, then flip, then copy the image back to the new backbuffer <br><br></td></tr></table><br>
<a name="713140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right'o<br><br>I had that before as a temporery fix but if thats the only way to do it then I guess I'll stick with it <br><br></td></tr></table><br>
<a name="713147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, this simply isnt working<br><br>I swapped my engine over to only redrawing what was new from the last update yesterday in order to increase performance to an acceptable level<br><br>This works fine in windowed mode, where as far as I can tell the back buffer isnt affected by Flip, however in Full Screen mode it is<br><br>I implimented the image solution, and asked here before testing it in full screen mode, I just did that and it makes the whole thing run like treacle, even on my reasonably powered PC<br><br>How on earth do you impliment this solution without the immense slowdown of grabbing and drawing the entire screen as an image everytime anything on the screen needs to update? <br><br></td></tr></table><br>
<a name="713149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats the way it is Im afraid. <br>When you flip you cannot be sure that the backbuffers are going to be in the same place, so you normaly do a CLS, if you are doing my sudgestion, then you dont need a cls, which will speed it a bit.<br><br>But I would expect at min you to be able to do 2000 of these draws each second, on a good modern system <br><br></td></tr></table><br>
<a name="713152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've implemented a system like this for BMAX (on all platforms in windowed and fullscreen, openGL and DirectX), it only Flips the areas of the screen that changed since the last Flip. It was developed for my software render module but does provide a nifty little speed up for other games where there is not too much happening at once. Just don't expect it to increase your FPS when more than 50% of the screen needs constant updates.<br><br>Email me if you want the code but beware that I have neither the time or the inclination to support it.<br><br>Tim. <br><br></td></tr></table><br>
<a name="713154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> *sigh* Where oh where did gaming go so wrong?<br><br>I dont care about fluffy 3D effects, I want a game that plays well, even with a system that offers such immense programming power and "speed" I'm still stuck with putting up with gameplay crippeling crap for a few useless graphical tweaks<br><br>I dont allow the tools I use to affect the shape of my work, they do not determine the finished product, if the tools offer resistance I simply beat them until they produce exactly the shape I want, it is and always will be my will alone that affects the shape of my work regardless of the tool<br><br>Thus I will find a new way of doing this with as little affect on speed as possible<br><br>Of course, since I know how to do it in windowed mode, I could simply sacrifice full screen and go with it, but I invisioned my work in full screen and throwing it away would be allowing the tools to affect the shape of the work, none the less I would be doing that if worst comes to worst<br><br>Indepeth: That sounds like a good place to start, ty for the offer <br><br></td></tr></table><br>
<a name="713157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well...... I use windowed mode, but my window has no boarders and is ingame calculated to be the same size as the screen. With a full canvas on top. In essence you dont realise that is a window. It looks that a fullscreen <br><br></td></tr></table><br>
<a name="713164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Indepath I cant find your E-Mail address<br><br>If you could either post it here, or throw me an E-Mail at &lt;removed&gt; I can get the address that way <br><br></td></tr></table><br>
<a name="713182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> sent email, you might want to remove your email now. <br><br></td></tr></table><br>
<a name="713187"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> done<br><br>thanks in advance <br><br></td></tr></table><br>
<a name="713188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually you can grab the code here (in unoptimised form) : <a href="http://modules.indiepath.com/forum/viewtopic.php?t=40" target="_blank">http://modules.indiepath.com/forum/viewtopic.php?t=40</a> <br><br></td></tr></table><br>
<a name="713197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> You don't have to use the standard form of Flip(), you can do the timing yourself (except perhaps the vertical blank sync) and then do something like glCopyPixels() to copy from the backbuffer to the front buffer without EVER actually flipping buffers at all. Without vsync you may notice tearing, though, and this may not always work on all platforms. Reason being that on some computers with certain o/s versions or certain GL drivers, the understanding of what is the front buffer and what is the back buffer becomes totally confused and beyond access from BlitzMax to figure it out. On my old iBook for example this is the case - you can't tell opengl to use the backbuffer, or the front buffer, because the o/s seems to have its own idea about which is which, whether they are swapped, or what is being viewed. The only thing you can be sure of is that drawing starts with the backbuffer before any flips occur. After that it's anyone's game. But that said, this wouldn't matter if you never do an official flip and just do a copypixels.<br><br>Also to clarify, the reason for doublebuffering has nothing to do with whether the display is 3d or not. It's simply to hide drawing process until the frame is complete so the user doesn't see things being drawn while the graphics card is showing the pixels. It doesn't matter if you're doing 2d or 3d. <br><br></td></tr></table><br>
<a name="713215"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> glCopyPixels?<br><br>So there IS an alternative then, but I'm guessing the "gl" part means that it wont work in DX mode<br><br>I had a brainwave while eating dinner just now for another method of my own, but the problems you stated with GL drivers probably mean it wont work in GL mode<br><br>Thus, it seems that I have been presented with 2 seperate methods for the 2 seperate systems<br><br>Heres what I thought of for DX mode<br><br>Instead of having DirtyRects, one has "DirtyObjects", you need 2 things for this:<br>1) Everything that can be displayed on the screen has an int variable asociated with it, lets call it Updt for now<br>2) A global int, lets call it UpdtAll<br><br>Everytime your program decides that an objects status on the screen needs updating, it sets the Updt int to a value of 2<br>Every time you clear the screen, or otherwise need everything drawn for whatever reason, you set UpdtAll to 2<br><br>As your drawing routines check each object, they do not draw it if its Updt is zero, and after drawing they reduce Updt by 1, unless UpdtAll is above zero in which case it draws everything<br><br>At the end of the draw routines, if UpdtAll is above zero, 1 is subtracted from its value<br><br>This gives everything that could update a memory of 2 updates, thus when you flip the screen and the old unupdated screen comes back, all past updates are repeated and everything should thus be happy and fast<br><br>What do you guys think? <br><br></td></tr></table><br>
<a name="713340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> IT won't work :(<br><br>The reason for using Rects is so that we can identify what regions of the screen need updating as a result of an object changing the display. What your idea fails to account for is that when object 1 intersects object 2 then both will need updating. Now consider that object 2 also intersects objects 3,4 &amp; 5 - will you update these also? How will your system identify them? <br><br></td></tr></table><br>
<a name="713387"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> In my own engine, this is thankfuly quite possible as everything is drawn on a background of 32*32 pixel tiles so:<br><br>Object 1 needs to update<br>It detects what tiles are underneith it (because the objects all work on the same co-ord system the tiles do, and remember their size) and those tiles are told to draw as well<br>All other objects that use those tiles also have to redraw<br><br>I have the systems for detecting all this stuff optimised already, so it seems like the best solution, but outside of that I can see that the solution would be quite limited<br><br>I would simply go with the rectangle solution, however it would probably take me days to understand the code and this way I get to develop something new that might help out quite a few people <br><br></td></tr></table><br>
<a name="713401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yah glCopyPixels() is OpenGL only. Surely there is something similar to copy between buffers in DX. <br><br></td></tr></table><br>
<a name="713415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> How does one use glCopyPixels()? There doesnt seem to be any documentation for it, and although I found the source code for it, it confuses me a lot<br><br>Also, I implimented my DX solution and it works like a charm, first time I tested it I went right through the stress testing routine I scripted and didnt even realise that Debug Mode was on, I just hope it works on comps other than my own, but my Alpha Testing Team will be seeing to that tonight <br><br></td></tr></table><br>
<a name="713417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> glCopyPixels is an OpenGL function not a BM one so you will need to read the OpenGL documentations <br><br></td></tr></table><br>
<a name="713425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, I will go have a look, thanks <br><br></td></tr></table><br>
<a name="713434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Certainly not tested : <br><pre class=code>
Graphics 640,480
image:TImage=LoadImage("max.png")
DrawImage image,0,0
tg_flip(0,0,100,100)
WaitKey()
Function tg_flip(sx:Int,sy:Int,ex:Int,ey:Int)
	Local src[]=[sx,sy,ex,ey]
	Local dest[]=[sx,sy,ex,ey]
	primarydevice.PrimarySurface.Blt dest,primarydevice.BackBuffer,src,0,Null
End Function
</pre><br>&lt;edit&gt; for DX obviously. <br><br></td></tr></table><br>
<a name="713506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mordax_Praetorian</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I implimented my method into my engine and sent a test build to my alpha testers<br><br>Reports indicate that the system runs flawlessly, and uber-quickly on pretty much all windows systems<br><br>Not had any linux testers get back to me yet <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
