<!DOCTYPE html><html lang="en" ><head ><title >pantson.Theora v2.0</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >pantson.Theora v2.0</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >pantson.Theora v2.0</a><br><br>
<a name="881380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good news and bad news...<br><br>Bad news<br>Still no sound. I've tried and tried and cannot get sound working.<br><br>Good news<br>A lot of internal improvements have happened.<br>- Update Theora lib to beta3<br>- Added better internal timers. On slow machines, the movie never played.. now the movie output is forced to screen.<br>- New command set thats makes it easier to integrate into peoples frameworks. (Problem noticed on GreyAliens framework, but now fixed)<br><br>Download links in signature.<br>Have fun... <br><br></td></tr></table><br>
<a name="881529"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks! <br><br></td></tr></table><br>
<a name="888459"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I copied pantson.mod/theora.mod to my mod folder. Building modules fails -- I get errors that files in libogg and libtheora can't be found. e.g. ogg/config_types.h.<br>Checking manually, the libogg and libtheora folders are there, but there is no ogg folder for example. Does there need to be some kind of preprocessing of libogg and libtheora before building in blitzmax?<br><br>I'm on OS X<br><br>First few lines of build result is below<br><br>Building Modules<br>Compiling:apiwrapper.c<br>In file included from /Users/pss143/dev/BlitzMax/mod/pantson.mod/theora.mod/libogg-1.1.3/include/ogg/ogg.h:24,<br>                 from /Users/pss143/dev/BlitzMax/mod/pantson.mod/theora.mod/libtheora-1.0beta3/lib/dec/apiwrapper.h:20,<br>                 from /Users/pss143/dev/BlitzMax/mod/pantson.mod/theora.mod/libtheora-1.0beta3/lib/dec/apiwrapper.c:21:<br>/Users/pss143/dev/BlitzMax/mod/pantson.mod/theora.mod/libogg-1.1.3/include/ogg/os_types.h:123:32: error: ogg/config_types.h: No such file or directory<br><br>The contents of the libogg folder:<br>AUTHORS*               config.sub*            ltmain.sh*<br>CHANGES*               configure*             macos/<br>COPYING*               configure.in*          macosx/<br>Makefile.am*           debian/                missing*<br>Makefile.in*           depcomp*               ogg-uninstalled.pc.in*<br>README*                doc/                   ogg.m4*<br>aclocal.m4*            include/               ogg.pc.in*<br>compile*               install-sh*            src/<br>config.guess*          libogg.spec*           win32/<br>config.h.in*           libogg.spec.in* <br><br></td></tr></table><br>
<a name="888486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> i'll check the archibe.<br>OGG lib is required (maybe I gorgot to put it in the archive) <br><br></td></tr></table><br>
<a name="888487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> it aint detected the OS.<br><br>os_types.h<br><pre class=code>
..
#else

#  include &lt;sys/types.h&gt;
#  include &lt;ogg/config_types.h&gt;

#endif
</pre><br>yet in theora.bmx it should add the complier flags if on macos<br><pre class=code>
?macos
ModuleInfo "CC_OPTS: -D__MACOSX__"
?
</pre><br>unless your OS doesn't detect ?macos when compiling.<br>What do you usually use? <br><br></td></tr></table><br>
<a name="888489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> robw, what version of BlitzMax are you using?<br>You'll need at least 1.26 for those "ModuleInfo" options to work. <br><br></td></tr></table><br>
<a name="888490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> you could always try to remove the OS query from the above line of theora.bmx<br><pre class=code>
ModuleInfo "CC_OPTS: -D__MACOSX__"
</pre><br>this would force the lib to be MAC compiled. <br><br></td></tr></table><br>
<a name="888498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using 1.26 on Intel mac<br>I found the OS query in theora.bmx and removed it but I still see the same build error.<br><br>So is blitzmax meant to run config/make in order to create config_types.h ? <br><br></td></tr></table><br>
<a name="888515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Apologies. You need to be running at *least* 1.28 for CC_OPTS to be used, or else download and install the Tweaked BMK mentioned <a href="http://code.google.com/p/wxmax/wiki/WhatToDoWithBmk" target="_blank">HERE</a>.<br><br>The changes to BMK allow custom compile options and things to be used for modules. <br><br></td></tr></table><br>
<a name="888528"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, that was it. Thanks for your help.<br><br>And thanks pantson for this fine module! <br><br></td></tr></table><br>
<a name="888540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> A question for pantson<br><br>I'm playing a movie using the technique in project/main.bmx, using ProcessTheora, which checks for updates and draws if necessary<br><br>I need to use  looping animation, which this technique allows. The first time through the loop, the animation is sharp and clear. Howevr, the second and later loops show some ghosting. The ghosting is constant, ie it doesn't get worse and worse. I've tried clearing the pixmap before DrawTheoraPixmap, but this doesn't change anything. <br><br>If I turn autoloop off, play the movie once (looks clear), then m.start(0), and play again, I see the same ghosting on the second play <br><br></td></tr></table><br>
<a name="888761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks Brucey (again)<br><br>Not sure why it would ghost on the second play... I will look into this this weekend. <br><br></td></tr></table><br>
<a name="888783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't test teh code at the moment.. but looking through it can you change the OpenTheora function to the following to see if it fixes the problem.<br><pre class=code>
Rem
bbdoc: Opens a Theora file ready for drawing.
returns: A handle to the Theora movie. NULL if the file doesn't exist
End Rem
Function OpenTheora:Ttheora(filename:String,buffersize:Int=4096)
	Local t:Ttheora
	
	If LOOKUP = 0 Then 
		' init YUV variables
		_TYUVinit()

		LOOKUP = 1
	EndIf
	
	t = New Ttheora
	t.color = True 'False
	t.decoder = _initdecoder()
	_opentheora(t.decoder,filename)
	_theoraheader(t.decoder)
	t.headerlength = 0
	t.width = TheoraWidth(t)
	t.height = TheoraHeight(t)
	t.fps = _theorafps(t.decoder)
	t.buffer = CreateBank(buffersize)
	t.buffersize = buffersize
	
	t.filename = filename
	t.movie = LittleEndianStream(OpenStream(t.filename,True,False))
	
	t.sync = True
	StartTheora(t)
		
	Return t
End Function
</pre><br>You will need to recompile it to see the changes <br><br></td></tr></table><br>
<a name="888815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >robw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I appreciate you investigating this.<br>OK, with this change to theora.bmx, main.bmx in the project folder crashes sometime after the first call to ProcessTheora and sometime before completing DrawTheoraPixmap<br>Rob<br><pre class=code>
' loop
While Not KeyDown(key_escape)
	' basic fps equation
	fps = (ticks*1000)/Max(1,(MilliSecs()-start))
	
	' process all theoras and check for update
	If ProcessTheora()
		Print ticks
		' if an update occoured, draw movie.
		DrawTheoraPixmap(m,p) 
		Print ticks       ' CRASHES WITHOUT PRINTING THIS LINE
		
		' draw pixap
		DrawPixmap p,0,0
		Print ticks	
		
		' display FPS
		DrawText fps,20,20
		
		ticks:+1
		Flip
	EndIf
Wend
</pre> <br><br></td></tr></table><br>
<a name="889418"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok.. i can see the problem now and I kinda know why its happening.<br>I haven't got a fix for it yet, but am still working on it. <br><br></td></tr></table><br>
<a name="892503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> many apologies..<br>I've started a new job recenetly and its keeping my very busy. (its nice to be busy for a change). Becuase of the new job I haven't had the energy to do any programming when I get home.<br>When I get some time, I will fix the ghosting in pantson.Theora<br><br>many thanks for your patience. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
