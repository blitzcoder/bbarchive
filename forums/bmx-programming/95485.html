<!DOCTYPE html><html lang="en" ><head ><title >240.0 + 0.01 = 240.009995 ???</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >240.0 + 0.01 = 240.009995 ???</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >240.0 + 0.01 = 240.009995 ???</a><br><br>
<a name="1100001"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wookie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this simple program:<br><br>print 240.0 + 0.01<br><br>and the result is 240.009995<br><br><br><br>Could someone tell me what am I doing wrong? <br><br></td></tr></table><br>
<a name="1100002"></a>

<a name="1100003"></a>

<a name="1100005"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats the way computers work, Change variable type in the hope of moving the inaccuracy further down the decimals<br><br>Try doubles if you need it, there is a mod somewhere that exchanges memory of number for accuracy, BUT its bet to try an afford those sort of things speed wise<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1100006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Stupid edit system<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1100007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wookie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is another strange example:<br><br>Local n# = 0.01<br>Print n<br><br>result: 0.00999999978 <br><br></td></tr></table><br>
<a name="1100009"></a>

<a name="1100010"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its not strange, its how computers work and you will get similar results in any language.<br><br>As already mentioned you could use Doubles instead of Floats but that only lessens the effect - it doesn't eradicate it.  Before you say "pah, how much accuracy is needed for 0.01?", try this:<br><pre class=code>Local n:Float
Print n
</pre><br><i>Result: 0.00000000000</i><br><br>You'd expect "0", right?  A floating point number is always treated as such no matter how big (or small) the variable contents are.  If you need 100% accuracy, don't use Floats.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1100012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The inaccuracy looks worse than it is. For example, if you are making a game with physics for a bouncing ball and its mathematically correct speed is 20.4393, but the computer calculates it as 20.4394 instead, this tiny difference will have no noticable effect on your game. 1.000 coming out as 0.9999 looks bad written in our number system, but the difference to your game isn't going to be noticable.<br><br>It only matters in two cases. First, you are making a super-accurate physics simulation. Second, you are making some kind of maths game. Eg divide these numbers and the player must enter the correct result. In that case, look into arbitrary precision maths library.<br><br><a href="http://code.google.com/p/maxmods/wiki/MapmModule" target="_blank">http://code.google.com/p/maxmods/wiki/MapmModule</a><br><br>These kinds of libraries are very SLOW so don't use them for a regular game. Let your ball bounce with the floats! <br><br></td></tr></table><br>
<a name="1100018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wookie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for explaining it<br><br>Must say that I didn't notice this behavior programming in VB .NET 2005. <br>I will look a this more closely :) <br><br></td></tr></table><br>
<a name="1100019"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >wookie</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Czar Flavius: of course 0.9999 or 1.000 isn't big deal but what when i try to compare these. Will these be equal to blitzmax? <br><br></td></tr></table><br>
<a name="1100025"></a>

<a name="1100026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It won't. Checking for equality with floats is a big no-no in any language.<br><br>You can try something like this. The lower the accuracy parameter, the higher the accuracy. This doesn't mean the results will be more correct - if the accuracy in this example is 0.00001 it gives the wrong result as the inaccuracy in the float is detected. Experiment with it.<br><br><pre class=code>Local a:Float = 240.0, b:Float = 240.0

b = b + 0.01
b = b + 0.01
b = b + 0.01
b = b + 0.01
b = b + 0.01

b = b - 0.05

Print a
Print b

Print Abs(a-b) 

If FloatCompare(a, b)
	Print "Equal"
Else
	Print "Not equal"
End If

Local c:Double = 240.0, d:Double = 240.0

d = d + 0.01
d = d + 0.01
d = d + 0.01
d = d + 0.01
d = d + 0.01

d = d - 0.05

Print c
Print d

Print Abs(c-d) 

If DoubleCompare(c, b)
	Print "Equal"
Else
	Print "Not equal"
End If

Function FloatCompare(a:Float, b:Float, accuracy:Float = 0.0001)
	Return Abs(a-b) &lt;= accuracy
End Function

Function DoubleCompare(a:Double, b:Double, accuracy:Double = 0.0001:Double)
	Return Abs(a-b) &lt;= accuracy
End Function
</pre><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1100075"></a>

<a name="1100077"></a>

<a name="1100079"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or to put it another way, floats are imperial not metric.<br><br>Consider using integer when designing metric system where the smallest value 1 represents the smallest unit in a calculation such as millimieters or microseconds.<br><br>Or change all your print statements to uses a human readable rounded version of a float. <br><br>The reason BlitzMax produces such unrounded output is that when that format is read back from storage it will always match that exact negative power of 2 representation that are the bits in the computers internal registers.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1100285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Could someone make a really obvious sticky post which says clearly, float point numbers do not store accurate numbers, cus this has been asked a hundred times. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
