<!DOCTYPE html><html lang="en" ><head ><title >Appropriate Data Structure for a TreeView?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Appropriate Data Structure for a TreeView?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Appropriate Data Structure for a TreeView?</a><br><br>
<a name="711683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> What would be the appropriate data structure in which to store the contents of a TreeView?<br><br>I'm thinking of a TMap with the key being composed of each "branch" of the tree, delimited with another character of some kind.<br><br>But I've never used TreeViews before, and this is one of the more complex data structures I've dealt with in general. So I'd appreciate opinions from more experienced programmers on the best way to store this. <br><br></td></tr></table><br>
<a name="711685"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> To be honest, apart from tree structures, I dont see the point of Tmap. Obviously my lack of experiance showing ;)<br>So I wont comment further, and will let the <i>experts</i> give a real answer.<br><br>(However knowing this site, you will probably get two or three contraditory answers) <br><br></td></tr></table><br>
<a name="711689"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> (However knowing this site, you will probably get two or three contraditory answers)  <br></div><br>Heh, for sure. And at least one person telling me that my entire methodology is wrong if I even use a TreeView.<br><br>I haven't used TMaps much before. Just for things where I need quick random access, but an array isn't suitable ( something where the number of elements goes up and down a lot. )<br><br>Kinda seemed like they would suit a treeview, but like I say, this is new ground for me. <br><br></td></tr></table><br>
<a name="711692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> And at least one person telling me that my entire methodology is wrong if I even use a TreeView. <br></div><br>And at least one person telling you that you could have used it before Mark changed it. But now it breaks some IEE standard laid down in 1972, and you need to roll back to Bmax 1.16 (and you should use a different version of the assembler) <br><br></td></tr></table><br>
<a name="711747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gabrial: The appropriate structure would be an own tree structure which saves all childs as linked list.<br><br>A TMap or binary tree is useless for a treeview as each node can have more than 2 children ... <br><br></td></tr></table><br>
<a name="711763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Gabrial: The appropriate structure would be an own tree structure which saves all childs as linked list. <br></div><br>This is certainly something I've considered. I was just concerned about speed.<br><br><div class="quote"> A TMap or binary tree is useless for a treeview as each node can have more than 2 children ...  <br></div><br>Well it's restrictive, I'll give you that, but if I "encode" the branches of the tree into the key, then when it comes to parsing them out into the treeview gadget, I can simply iterate through the entire map, stripping the branches back out with a simple string parser.<br><br>You see, I really need the speed when it comes to pulling objects out, but don't care the least about the speed of filling the treeview gadget.<br><br>I guess a tree datastructure with TMap's for each node with just leaves and no further branches could be fast enough, but I'm not sure. I still have to negotiate my tree structure before I go there. Although in fairness, this makes searching the map faster as the maps are shorter. <br><br></td></tr></table><br>
<a name="711772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> That indeed would be a potential way as well. Doing the "dictionary way". Each treeview node is a typeinstance. This typeh as a "childs" list which uses TMap ...<br>But this depends on the amount of childs there normally are. if log2(childs) isn't significantly smaller than childs (number of childs) then it doesn't make that much sense to use a TMap.<br><br>but if you have 10+ childs on each treeview node it will start to make a significant difference when jumping down the tree.<br><br><br>Another way is just 1 TMap ... and put all nodes in there with their node text as key.<br>Thats very fast as well.<br><br><br>don't know if the "encoding" would make it faster than one of the above solutions as decoding needs time as well <br><br></td></tr></table><br>
<a name="711774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> what you want is an exponential tree... for a simple listbox I just would use tmaps in tmaps. <br><br></td></tr></table><br>
<a name="711891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, well I tried searching for information and implementation guides for exponential trees and came up with next to nothing, apart from a little diagram which basically confirmed what you already told me, that it's suitable for a TreeView.<br><br>So, being completely clueless on the subject, I decided to hack something together and open myself up to public humiliation in the hope of learning how I messed up.<br><br>Here's what I've got. I've only tested adding a few categories and a couple of entries ( a category is a node on a treeview which has child nodes and an entry is a node with no children. In the context I'm using them, there is a clear distinction and I will never need to treat them the same. )<br><br>It seems to work ok in the little test, but there could well still be bugs, because I've only given it a cursory test since hacking it together. There is definitely no error checking. Well some, but not enough. That comes later. No sense making it bulletproof if it's a bad implementation and needs binning.<br><br>I'm predominantly interested in speed. How does this look to the more experienced programmers?<br><br>It's a module ( seemed best. )<br><br><pre class=code>
Module glimmer.treemap

ModuleInfo "Framework: Tree-Based Map Data Structure"
ModuleInfo "Copyright: Glimmer Games"
ModuleInfo "Author: Phil Ings"
ModuleInfo "Version: 1.0"

Import brl.map

SuperStrict


' THIS IS YOUR TREE

Type tTreeMap
	
	Field Root:tTreeMapNode
	
	Method New()
		Root=New tTreeMapNode
	End Method
	
	Method Delete()
		Clear()
	End Method
	
	Method Clear()
		Root.Clear()
	End Method
	
	Method InsertEntry(TreePath:String,Entry:String,Value:Object)
		Local NewParent:tTreeMapNode=Root.FindPath(TreePath)
		If NewParent&lt;&gt;Null
			NewParent.InsertEntry(Entry,Value)
		End If
	End Method
	
	Method InsertCategory:tTreeMapNode(TreePath:String,Category:String)
		Local NewParent:tTreeMapNode=Root.FindPath(TreePath)
		If NewParent&lt;&gt;Null
			Return NewParent.InsertCategory(Category)
		End If
	End Method
	
	Method RemoveEntry(TreePath:String,Entry:String)
		Local NewParent:tTreeMapNode=Root.FindPath(TreePath)
		If NewParent&lt;&gt;Null
			NewParent.RemoveEntry(Entry)
		End If
	End Method
	
	Method RemoveCategory(TreePath:String,Category:String)
		Local NewParent:tTreeMapNode=Root.FindPath(TreePath)
		If NewParent&lt;&gt;Null
			NewParent.RemoveCategory(Category)
		End If
	End Method
	
	Method FindEntry:Object(TreePath:String,Entry:String)
		Local KeyParent:tTreeMapNode=Root.FindPath(TreePath)
		If KeyParent=Null
			Return Null
		Else
			Return KeyParent.FindEntry(Entry)
		End If
	End Method
	
	Method FindCategory:tTreeMapNode(TreePath:String)
		Return Root.FindPath(TreePath)
	End Method
	
End Type


' NODES - THESE ARE YOUR CATEGORIES. THEY CONTAIN YOUR ACTUAL ENTRIES

Type tTreeMapNode
		
	Field Children:tMap ' BINARY TREE OF ALL CHILD NODES - THESE ARE OTHER CATEGORIES
	Field Leaves:TMap ' BINARY TREE OF ALL LEAF NODES - THESE ARE ENTRIES
	
	Method Clear()
		If Leaves&lt;&gt;Null
			Leaves.Clear()
		End If
		For Local Node:tTreeMapNode=EachIn Children.Keys()
			Node.Clear()
		Next
	End Method
	
	Method InsertEntry(Entry:String,Value:Object)
		If Leaves=Null
			Leaves=New TMap
		End If
		Leaves.Insert(Entry,Value)
	End Method
	
	Method InsertCategory:tTreeMapNode(Category:String)
		Local CategoryNode:tTreeMapNode=New tTreeMapNode
		If Children=Null
			Children=New TMap
		End If
		Children.Insert(Category,CategoryNode)
		Return CategoryNode
	End Method
	
	Method RemoveEntry(Entry:String)
		Leaves.Remove(Entry)
	End Method
	
	Method RemoveCategory(Category:String)
		Local Node:tTreeMapNode=tTreeMapNode(Children.ValueForKey(Category))
		Children.Remove(Category)
		Node.Clear()
	End Method
	
	Method FindEntry:Object(Entry:String)
		Return Leaves.ValueForKey(Entry)
	End Method
	
	Method FindPath:tTreeMapNode(Path:String)
		Local NextNodeOnPath:tTreeMapNode
		Local SlashPos:Int= Path.Find("\")
		If SlashPos=-1
			If Path&lt;&gt;""
				If Children=Null
					Return Null
				Else
					Return tTreeMapNode(Children.ValueForKey(Path))
				End If
			Else
				Return Self
			End If
		Else
			If SlashPos=Path.Length-1 ' IF THE SLASH IS ON THE END OF THE PATH, REMOVE IT AND DO AS ABOVE
				Return tTreeMapNode(Children.ValueForKey(Path[..SlashPos-1]))
			Else
				NextNodeOnPath=tTreeMapNode(Children.ValueForKey(Path[..SlashPos]))
				If NextNodeOnPath=Null
					Return Null
				Else
					Return NextNodeOnPath.FindPath(Path[SlashPos+1..])
				End If
			End If
		End If
	End Method
	
End Type
</pre> <br><br></td></tr></table><br>
<a name="711927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah, I don't know why I told you that.. it's really not a good choice anyway. <br><br></td></tr></table><br>
<a name="712070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone have any thoughts on this module then? <br><br></td></tr></table><br>
<a name="712170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> looks good to me... do you have a test program?  I'd play with it a little then. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
