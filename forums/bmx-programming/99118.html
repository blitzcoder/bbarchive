<!DOCTYPE html><html lang="en" ><head ><title >Streaming playback / loading of incbin'd ogg</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Streaming playback / loading of incbin'd ogg</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Streaming playback / loading of incbin'd ogg</a><br><br>
<a name="1161960"></a>

<a name="1161965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi there,<br><br>can I stream the playback of an incbin'd ogg file, or at the very least stream the loading of an incbin'd ogg file ready for it to be played?<br><br>Ta!<br>-Chris<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1161962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I do with MaxMod2 (which is three years out of date now but still works if you get a version of MinGW it'll play nice with), is load the OGG file into a bank, and stream it from there.  That way there's no ongoing hard drive access, and the only resources you use are a bank the size of the OGG file, plus a little extra for the playback buffer.<br><br>I'm sure MaxMod2 does allow you to play a streamed OGG direct with incbin, but the above method is much more sensible. <br><br></td></tr></table><br>
<a name="1161968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Gfk, so does that mean... let's say you have 5 ogg tracks. You load them all in to banks at the start and then play them when required?<br><br>Is that much different from me just loading all 5 tracks with LoadSound at the start and then just accessing them as required? <br><br></td></tr></table><br>
<a name="1162032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> IIRC using LoadSound will decompress the .ogg into memory while it's loaded, which takes up -significantly-more RAM plus it will freeze the program while it decompresses the entire file all at once. <br><br></td></tr></table><br>
<a name="1162041"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got ya, thank you :) <br><br></td></tr></table><br>
<a name="1162046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Because I am building a blitzmax app from Monkey generated code, I would ideally not include other modules at this time but...<br><br>I've loaded the ogg files in to banks and I now want to call LoadSound() by supplying the bank. Is that possible?<br><br>Kinda like...<br><br><pre class=code>
Global BankedTrack1:TBank = LoadBank("inc::data/music/1.ogg")

Function PlayTrack1()
    PlaySample(LoadSound(GET_BANK_CONTENTS), MUSIC_CHANNEL, flags)
EndFunction
</pre> <br><br></td></tr></table><br>
<a name="1162049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just pass the bank handle to LoadSound().<br><br><pre class=code>mySound:TSound = LoadSound(bankedTack1)</pre> <br><br></td></tr></table><br>
<a name="1162051"></a>

<a name="1162052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh good, I was doing the right thing.<br><br>I'm still getting around a 2 second pause as LoadSound is called, which I wasn't expecting really seeing as the sound should be getting loaded from memory (instead of accessing the EXE on the hard drive).<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1162053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You will, Loadsound loads and decompresses the entire file so the bigger it is, the longer it takes.  It's the decompression that takes the time, not the actual loading of the file. <br><br></td></tr></table><br>
<a name="1162054"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got ya, cheers GfK, so basically to avoid the load pause, I need to either load all oggs as TSounds in to memory, or use MaxMod to stream the ogg files directly. <br><br></td></tr></table><br>
<a name="1162055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> (p.s. how do YOU stream an ogg from a bank? ;) <br><br></td></tr></table><br>
<a name="1162057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use MaxMod2 which (without looking at my code) I think has a PlayMusic(bankHandle) function which does it automagically.  Don't get me wrong, MaxMod2 is great, it just doesn't seem to like certain versions of MinGW (build 8 from nuwen.net is fine with it).<br><br><a href="http://code.google.com/p/maxmod/" target="_blank">http://code.google.com/p/maxmod/</a> <br><br></td></tr></table><br>
<a name="1162058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Woop! Just got the very same thing sorted.<br><br>To get MaxMod2 working I had to...<br><br>copy MinGW/lib/libdsound.a to BlitzMax/lib/<br><br>and add the line <br><br><pre class=code>#include &lt;stdio.h&gt;</pre><br><br>to the very top of blitzmax\mod\maxmod2.mod\maxmod2.mod\code<br><br>Sorted! :D <br><br></td></tr></table><br>
<a name="1162262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Danny</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I do is right after loading a sound is: set the volume to zero, play the sound and stop it immediately -on the next line!<br><br>Using this I can force all the loading (AND decompression!) time to the start (loading) stage of my app - and so prevent it freezing at whatever point I might actually want to play a given sound..<br><br>Danny. <br><br></td></tr></table><br>
<a name="1162263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why? All of the decompression is done during LoadSound anyway so by playing then stopping the sound, you're not actually achieving anything. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
