<!DOCTYPE html><html lang="en" ><head ><title >ODD2d.mod - DrawImagePoly</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ODD2d.mod - DrawImagePoly</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >ODD2d.mod - DrawImagePoly</a><br><br>
<a name="1163015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to use DrawImagePoly with a repeating tile? That is, the supplied is repeated to extend over the whole polygon?<br><br>Thanks :)<br>Chris <br><br></td></tr></table><br>
<a name="1163016"></a>

<a name="1163019"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've just looked at the comments on the ODD2d code and I get how it works now.<br><br>Basically I'm going to have to stencil the image over the polygon multiple times.<br><br>Luckily doesn't need to be run in real time as I'm just creating the images during level load.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1163018"></a>

<a name="1163020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually no, that won't work because each time I call drawimagepoly, it draws the whole polygon regardless of image size, hmmm. <br><br>Edit: It looks like it just extends the boundaries of the image out to fill the remaining space.<br><br>What I get:<br><img src="http://chrismingay.co.uk/got.png"><br><br>What I hoped for:<br><img src="http://chrismingay.co.uk/wanted.png"><br><br>Source:<br><a href="http://chrismingay.co.uk/PolyTest.zip" target="_blank">http://chrismingay.co.uk/PolyTest.zip</a><br><br>Any ideas?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1163030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> The polygon functions in Odd2D use the textures as provided by Max2D. Max2D does not store the textures as repeatable and even blends the edges to fill the rest of the texture. This means drawing a polygon with a repeating TImage is not possible with the way Max2D is set up.<br><br>I did look into adding an image flag for repeating textures, but abandoned the idea as it was too impractical to shoehorn it into the existing Max2D image framework. <br><br></td></tr></table><br>
<a name="1163031"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh ok, never mind!<br><br>I've seen some other posts regarding "SetTextureRepeat" and I think Armitage has got textured polygons working, so I'll have a look around.<br><br>Failing that, I will just briefly make a massive Image that fills the whole level and "mask" it from that. <br><br></td></tr></table><br>
<a name="1163240"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alberto-Diablo</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> [offtop]<br><br>2 Oddball<br><br>In your module Aspect.mod have some bugs, with viewport and offsets.<br><br>[/offtop] <br><br></td></tr></table><br>
<a name="1163265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've not looked at aspect.mod in a long time as odd2d.mod does all that and more. What is the issue with aspect.mod? Do you have a small example of the problem? <br><br></td></tr></table><br>
<a name="1163285"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Alberto-Diablo</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Given it was ... then I decided to challenge yourself.<br><br><pre class=code>
Rem
bbdoc: Set drawing viewport
about: Use in place of #SetViewport
End Rem
'Function SetAspectViewport( x:Int, y:Int, width:Int, height:Int )
'	Local x2:Float = Min(x + width, _xoffset + _vwidth)
'	Local y2:Float = Min(y + height, _yoffset + _vheight)
'	x = Max(x, _xoffset)
'	y = Max(y, _yoffset)
'	SetViewport(x, y, x2 - x, y2 - y)
'End Function

Function SetAspectViewport(x:Int, y:Int, width:Int, height:Int)
	Local x2:Float = Min(x + width + _xoffset, _xoffset + _vwidth)
	Local y2:Float = Min(y + height + _yoffset, _yoffset + _vheight)
	x = Max(x + _xoffset, _xoffset)
	y = Max(y + _yoffset, _yoffset)
	SetViewport(x, y, x2 - x, y2 - y)
End Function
</pre><br><br>There is also a problem with the displacement of one pixel on the screen.<br><br>When I draw the image in the coordinates 0.0,0.0. Visually, it seems to be rendered in the coordinates 1.0,0.0 <br><br></td></tr></table><br>
<a name="1163388"></a>

<a name="1163390"></a>

<a name="1163391"></a>

<a name="1163392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I remember having a complete example of my textured polygon on the Code Archives but it has been deleted as well as every other code in the repository.<br>Unfortunately I can't find that example anymore on my disks :(<br><br>But you can read these 2 entries and even reuse the code on one of them as a start : <br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=97065" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=97065</a><br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=96133" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=96133</a><br><br>In a nutshell all I did was decompose an array of polygon vertex in triangles and then using the DrawImagePoly() from Odd with a texture clamped to repeat.<br>So basically you need Odd2D.mod and a texture wrapping code.<br><br>I think I borrowed and adapted that code from Ian Duff in order to make texture wrapping easier under OpenGL.<br>(I leaved the DirectX version as comments, just in case, but the original code may be better)<br><br>[bbcode]<br>Const TEXTURECLAMP:Int = 0<br>Const TEXTUREWRAP:Int = 1<br>Const TEXTUREHWRAPONLY:Int = 2<br>Const TEXTUREVWRAPONLY:Int = 3<br><br>Function SetTextureRepeat(image:TImage, rep:Int = TEXTUREWRAP)<br><br>	If Not (image.width = Pow2Size(image.width) And image.Height = Pow2Size(image.Height))<br>		'Put your own assert code here ;)<br>	EndIf<br>	<br>'	?Win32<br>'	Local D3D7Driver:TD3D7Max2DDriver = TD3D7Max2DDriver(_max2dDriver)<br>'	?<br>	<br>	Local n:Int = image.seqs.Length<br>	Repeat<br>		n:-1<br>	<br>		Select rep<br>		<br>			Case TEXTURECLAMP<br>'			?Win32<br>'			If D3D7Driver<br>'				'DX<br>'				D3D7Driver.device.SetTextureStageState 0, D3DTSS_ADDRESS, D3DTADDRESS_CLAMP<br>'			Else<br>'			?<br>				'GL<br>				glBindTexture GL_TEXTURE_2D, TOGLImageFrame(image.Frame(n)).glif.name<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE<br>'			?Win32<br>'			EndIf<br>'			?<br><br>			Case TEXTUREVWRAPONLY<br>'			?Win32<br>'			If D3D7Driver<br>'				'DX<br>'				D3D7Driver.device.SetTextureStageState 0, D3DTSS_ADDRESS, D3DTADDRESS_CLAMP<br>'			Else<br>'			?<br>				'GL<br>				glBindTexture GL_TEXTURE_2D, TOGLImageFrame(image.Frame(n)).glif.name<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT<br>'			?Win32<br>'			EndIf<br>'			?<br><br>			Case TEXTUREHWRAPONLY<br>'			?Win32<br>'			If D3D7Driver<br>'				'DX<br>'				D3D7Driver.device.SetTextureStageState 0, D3DTSS_ADDRESS, D3DTADDRESS_CLAMP<br>'			Else<br>'			?<br>				'GL<br>				glBindTexture GL_TEXTURE_2D, TOGLImageFrame(image.Frame(n)).glif.name<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE<br>'			?Win32<br>'			EndIf<br>'			?<br><br>			Case TEXTUREWRAP<br>'			?Win32<br>'			If D3D7Driver<br>'				'DX<br>'				D3D7Driver.device.SetTextureStageState 0, D3DTSS_ADDRESS, D3DTADDRESS_WRAP<br>'			Else<br>'			?<br>				'GL		<br>				glBindTexture GL_TEXTURE_2D, TOGLImageFrame(image.Frame(n)).glif.name<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT<br>				glTexParameteri GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT<br>'			?Win32<br>'			EndIf<br>'			?<br>			<br>		End Select<br>		<br>	Until n &lt; 1<br>End Function<br><br><br>Function Pow2Size:Int(n:Int)<br>	Local t:Int = 1<br>	While t &lt; n<br>		t :* 2<br>	Wend<br>	Return t<br>End Function<br>[/bbcode]<br><br>Hope this helps.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1163400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Armitage, thanks for that!<br><br>For what it's worth I think I found your code archive code which is now not being linked to (though still exists) and have been using that and it's doing exactly what I require :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
