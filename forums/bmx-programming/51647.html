<!DOCTYPE html><html lang="en" ><head ><title >New function: Single Surface Drawing.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >New function: Single Surface Drawing.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >New function: Single Surface Drawing.</a><br><br>
<a name="576571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was noted that the LoadAnimImage actually creates a new image for each frame (SHOCK). I developed a new Type that allows you to load and draw animated images without the system creating a shed load of new surfaces - Hence Single Surface Drawing.<br><br>Stats :-<br><br>DirectX - 40% Less Video Ram 28% speed increase<br>OpenGL - 42% Less Video Ram 28% speed increase AND 57% faster than DirectX (nVidia Fx5200)<br><br>[EDIT]This code no longer has any dependencies.<br><br>The New Type:<br><pre class=code>
Type TAnimImage
	
	Field Image		:TImage
	Field width		:Int
	Field height		:Int
	Field u0			:Float[]
	Field v0			:Float[]
	Field u1			:Float[]
	Field v1			:Float[] 

        Function         Load:TAnimImage(url:Object,cell_width:Float,cell_height:Float,start:Int,frames:Int,flags=-1)
		Local t:TAnimImage = New TAnimImage
		Local tx:Float
		Local ty:Float
		Local x_Cells:Int
		t.u0		= New Float[frames]
		t.v0		= New Float[frames]
		t.u1		= New Float[frames]
		t.v1		= New Float[frames]
		t.Image 	= LoadImage(url,flags)
		Local xDelta:Float = t.Image.Width / Pow2Size(t.image.width)		
		Local yDelta:Float = t.Image.Height / Pow2Size(t.image.height)
		x_cells	= t.Image.Width  / cell_width
		For Local f = start To frames - 1
			tx = (f Mod x_cells * cell_width) * xdelta
			ty 	= (f / x_cells * cell_Height) * ydelta
			t.u0[f]	= Float(tx) / Float(t.Image.Width)
			t.v0[f] 	= Float(ty) / Float(t.Image.Height)
			t.u1[f]	= Float(tx + cell_width * xdelta)  / Float(t.Image.Width)
			t.v1[f]	= Float(ty + cell_Height * ydelta) / Float(t.Image.Height)
		Next
		Return t		
	End Function
	
	Function  Pow2Size:Float( n )
		Local t=1
		While t&lt;n
			t:*2
		Wend
		Return t
	End Function

	
	Function Free(t:TAnimImage)
		t.Image = Null
		t = Null
		FlushMem()
	End Function
	
	Method Draw(x:Float,y:Float,width:Float,height:Float,frame:Int=0)
		Local DXFrame:TDX7ImageFrame = TDX7ImageFrame (image.frame(0))
		If DXFrame
                   DXFrame.setUV(u0[frame],v0[frame],u1[frame],v1[frame])
                Else
                    Local GLFrame:TGLImageFrame = TGLImageFrame(image.frame(0))
                    GLFrame.u0 = u0[frame]
                    GLFrame.u1 = u1[frame]
                    GLFrame.v0 = v0[frame]
                    GLFrame.v1 = v1[frame]
                EndIf
		DrawImageRect(Self.Image,x,y,width,height)
	End Method
End Type</pre><br>Example:<br><pre class=code>Graphics 640,480,0,NOSYNC

Print "Start Memory " + MemAlloced()

Local now:Int = MilliSecs()

Local blob:TAnimImage = TAnimImage.Load("gfx/stoneset0.png",32,64,0,32,FILTEREDIMAGE)
'Local blob:TImage = LoadAnimImage("gfx/stoneset0.png",32,64,0,32,FILTEREDIMAGE)

For Local a = 1 To 100
	Cls
	For Local b = 1 To 10000
		blob.Draw(Rand(0,640),Rand(0,480),20,40,Rand(0,31))
		'DrawImageRect(blob,Rand(0,640),Rand(0,480),20,40,Rand(0,31))
	Next
	Flip
Next

Print "End Memory " + MemAlloced()
Local time:Int = MilliSecs()-now
Print "Time Taken " + time

WaitKey()</pre><br><br>To Set Image Handles Use:<br><pre class=code>SetImageHandle(MyTAnimImage.Image,x,y)</pre> <br><br></td></tr></table><br>
<a name="576597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Who was John Galt?</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow nice on mate -thanks for sharing that. <br><br></td></tr></table><br>
<a name="576610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferminho</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's a great help, I think I'll be using it right away. Thanks a lot! <br><br></td></tr></table><br>
<a name="576629"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems to draw some frames 'offset' from their intended start point.<br>Image file 32*32*5 shows a problem but 32*32*4 does not. <br><br></td></tr></table><br>
<a name="576635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry tonyg, what do you mean? <br><br></td></tr></table><br>
<a name="576642"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should have added some code...<br><pre class=code>
Graphics 640,480,0,NOSYNC
SeedRnd MilliSecs()
Local blob:TAnimImage = TAnimImage.Load("animstrip5.png",32,32,0,5,FILTEREDIMAGE)
Local blob1:TAnimImage = TAnimImage.Load("animstrip4.png",32,32,0,4,FILTEREDIMAGE)
'Local blob:TImage = LoadAnimImage("animstrip.png",32,64,0,10,FILTEREDIMAGE)
While Not KeyHit(key_escape)
	Cls
	blob.Draw(0,0,32,32,Rand(0,4))
	blob1.draw(0,50,32,32,Rand(0,3))
'	DrawImage blob,0,0,Rand(0,9)
	DrawText MouseX() + " " + MouseY(),0,100

	Flip
	FlushMem
	Delay 500
Wend
</pre><br>animstrip5.png is 32*32*5<br>animstrip4.png is 32*32*4 <br><br></td></tr></table><br>
<a name="576643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Probably my dodgy coding. I've only tested with texture sizes ^2 and not strips. <br><br></td></tr></table><br>
<a name="576652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't see anything wrong with the UV parms when I outpit them. <br>May I've put SetUv in the wrong place. <br>Which driver.bmx file should it be added to?<br>I have it as a method of TImageFrame. <br><br></td></tr></table><br>
<a name="576656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it compiles then you've got it in the right place &gt; it's in the max2d.mod directory.<br><br>Is this the Method you added to TImageFrame?<br><pre class=code>	Method SetUV(u0#,v0#,u1#,v1#)
		xyzuv[3]=u0
		xyzuv[4]=v0
		xyzuv[8]=u1
		xyzuv[9]=v0
		xyzuv[13]=u0
		xyzuv[14]=v1
		xyzuv[18]=u1
		xyzuv[19]=v1
	End Method</pre> <br><br></td></tr></table><br>
<a name="576674"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Errr, no.<br>I added...<br><pre class=code>
Method SetUV(u0#,v0#,u1#,v1#) Abstract
</pre><br>I can't get that new method to build as <br>'Identifier xyzvu not found.<br>&lt;edit&gt; although that's the method I have in d3d7max2d.bmx <br><br></td></tr></table><br>
<a name="576676"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ignore me..... So what I originally said to do. I got my wires crossed. <br><br></td></tr></table><br>
<a name="576760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steve Elliott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> This sounds fantastic!  Thanks!  I've wondered exactly how LoadAnimImage works - does it create 1 surface - or a surface for each frame?<br><br>One thing preventing me using it though, it requires messing about with the official modules.  I don't want to do this for fear of upsetting max and thus causing a debugging nightmare - having forgot a couple of lines in a particular module have been added.  Plus the fact official updates would over-write any changes anyway.<br><br>Could Mark please integrate this into the next update? <br><br></td></tr></table><br>
<a name="576761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Could Mark please integrate this into the next update?  <br></div><br>Ha HA ha ha ha HA ha ha haaaaa.<br><br>There is a way around using my SetUV function : <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=1422" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=1422</a> <br><br></td></tr></table><br>
<a name="576782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> LoadAnimImage creates a single TImage but seperate pixmaps for each frame. I believe each pixmap is a seperate surface but I could be wrong. <br>Huge numbers or animations and/or loading your tileset with loadanimimage (especially if the frames are odd size) might create lots of surfaces. <br>There's also this...<br><a href="/codearcs.php?code=1241" target="_blank"> DrawImageBlock </a><br>but it's OGL only.<br>BTW ; Anybody got DrawImageArea or DrawImageBlock to work? If so, how? <br><br></td></tr></table><br>
<a name="576796"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> See this:-<br><pre class=code>device.SetTexture 0,frame.surface</pre><br>That is the command that switches the texture according to the frame, I think it is safe to assume that seperate surfaces are used for each frame.<br><br>The DrawImageBlock code works the same way as my code does, it sets the UV. <br><br></td></tr></table><br>
<a name="576799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> This code now runs straight outta the box. Get it from the top thread. <br><br></td></tr></table><br>
<a name="576811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steve Elliott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>This code now runs straight outta the box<br> <br></div><br><br>SetUV? <br><br></td></tr></table><br>
<a name="576819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Suco-X</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br>Can i use the imagescollide functions with TAnimImage?<br>Mfg Suco <br><br></td></tr></table><br>
<a name="576821"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> You still need the SetUV from the link you had previously. <br>I added debug statements for the UV parms which all seem OK but it's still offset for anim frames &gt; 4 <br><br></td></tr></table><br>
<a name="576917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, that SetUV Function is the one already in Blitz, I just did not know how to access it directly. Now I know and so do you. <br><br></td></tr></table><br>
<a name="576938"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are we using different systems?<br>Running the example *without* the changes you suggested to add SetUV produces...<br>"Identifier setUV not found" <br><br></td></tr></table><br>
<a name="576969"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmn, Okay you win I changed the code again. BUT this is DX7 only now. <br><br></td></tr></table><br>
<a name="576985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> This should work with GL too...<br><pre class=code>Method Draw(x:Float,y:Float,width:Float,height:Float,frame:Int=0)
  Local DXFrame:TDX7ImageFrame = TDX7ImageFrame(image.frame(0))
  If DXFrame
    DXFrame.setUV(u0[frame],v0[frame],u1[frame],v1[frame])
  Else
    Local GLFrame:TGLImageFrame = TGLImageFrame(image.frame(0))
    GLFrame.u0 = u0[frame]
    GLFrame.u1 = u1[frame]
    GLFrame.v0 = v0[frame]
    GLFrame.v1 = v1[frame]
  EndIf
			
  DrawImageRect(Self.Image,x,y,width,height)
End Method</pre> <br><br></td></tr></table><br>
<a name="577007"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated. <br><br></td></tr></table><br>
<a name="577028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> They both 'work' fine now. <br>However, does anybody else have a problem when the animation file has &gt; 4 frames?<br>&lt;edit&gt; it seems the problem occurs with odd numbers of frames. <br><br></td></tr></table><br>
<a name="577039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tonyg, the files I am using with this at the moment consist of 32 frames. I don't have any issue at all (32x64x32). <br><br></td></tr></table><br>
<a name="577050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> tonyg, does this work for you (you should see 16 coloured blocks)?...<br><pre class=code>img$ = String(getenv_("BMXPath")) + "\samples\birdie\games\tiledrop\media\blocks.png"
 
Graphics 640,480,0

Local blob:TAnimImage = TAnimImage.Load(img$, 32, 32, 0, 16, FILTEREDIMAGE)

For Local b=0 To 15
	blob.Draw(5 + (b * 40), 200, 30, 30, b)
Next

Flip

WaitKey()
End</pre> <br><br></td></tr></table><br>
<a name="577056"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep that works but it's an even number of frames (might have missed my previous edit)<br>Try this...<br><pre class=code>
Type TAnimImage
	
	Field Image		:TImage
	Field width		:Int
	Field height		:Int
	Field u0			:Float[]
	Field v0			:Float[]
	Field u1			:Float[]
	Field v1			:Float[] 
	
	Function Load:TAnimImage(url:Object,cell_width,cell_height,start:Int,frames:Int,flags=-1)
		Local t:TAnimImage = New TAnimImage
		Local tx:Int
		Local ty:Int
		Local x_Cells:Int
		t.u0		= New Float[frames]
		t.v0		= New Float[frames]
		t.u1		= New Float[frames]
		t.v1		= New Float[frames]
		t.Image 	= LoadImage(url,flags)
		x_cells	= t.Image.Width  / cell_width
		For Local f = start To frames - 1
			tx	= f Mod x_cells * cell_width
			ty 	= (f / x_cells * cell_Height)
			t.u0[f]	= Float(tx) / Float(t.Image.Width)
			t.v0[f] 	= Float(ty) / Float(t.Image.Height)
			t.u1[f]	= Float(tx + cell_width)  / Float(t.Image.Width)
			t.v1[f]	= Float(ty + cell_Height) / Float(t.Image.Height)
		Next
		Return t		
	End Function
	
	Function Free(t:TAnimImage)
		t.Image = Null
		t = Null
		FlushMem()
	End Function
Method Draw(x:Float,y:Float,width:Float,height:Float,frame:Int=0)
  Local DXFrame:TDX7ImageFrame = TDX7ImageFrame(image.frame(0))
  If DXFrame
    DXFrame.setUV(u0[frame],v0[frame],u1[frame],v1[frame])
  Else
    Local GLFrame:TGLImageFrame = TGLImageFrame(image.frame(0))
    GLFrame.u0 = u0[frame]
    GLFrame.u1 = u1[frame]
    GLFrame.v0 = v0[frame]
    GLFrame.v1 = v1[frame]
  EndIf
			
  DrawImageRect(Self.Image,x,y,width,height)
End Method	
End Type

'img$ = String(getenv_("BMXPath")) + "\samples\birdie\games\tiledrop\media\blocks.png"
img$ = String(getenv_("BMXPath")) + "\samples\breakout\media\tiles.png"
Graphics 640,480,0

Local blob:TAnimImage = TAnimImage.Load(img$, 32, 20, 0, 5, FILTEREDIMAGE)

For Local b=0 To 4
	blob.Draw(5 + (b * 40), 200, 30, 30, b)
       DrawText b,5+(b*40),200
Next

Flip

WaitKey()
End
</pre> <br><br></td></tr></table><br>
<a name="577068"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> ohh, thats not good. The problem seems to be with the code for calculating the x and y positions of each image in the strip. <br><br></td></tr></table><br>
<a name="577073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought so but debuglogging the UV coords used and they look 'ok' to my untrained eye. <br><br></td></tr></table><br>
<a name="577074"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm about 50% of the way to sorting it.. Fingers crossed. <br><br></td></tr></table><br>
<a name="577079"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> The UV's are coming out correctly?!?!?<br><br>So why is it not drawing correctly?!?!<br><br><pre class=code>
x-cells : 1
y-cells : 5
tx :0
ty :0
u0 :0.000000000
v0 :0.000000000
u1 :1.00000000
v1 :0.200000003
tx :0
ty :20
u0 :0.000000000
v0 :0.200000003
u1 :1.00000000
v1 :0.400000006
tx :0
ty :40
u0 :0.000000000
v0 :0.400000006
u1 :1.00000000
v1 :0.600000024
tx :0
ty :60
u0 :0.000000000
v0 :0.600000024
u1 :1.00000000
v1 :0.800000012
tx :0
ty :80
u0 :0.000000000
v0 :0.800000012
u1 :1.00000000
v1 :1.00000000
</pre> <br><br></td></tr></table><br>
<a name="577088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep... it's very weird. <br>Here's the output for an 'even' number...<br><pre class=code>
0.000000000 0.000000000 0.250000000 0.312500000
0.250000000 0.312500000 0.500000000 0.625000000
0.500000000 0.625000000 0.750000000 0.937500000
0.750000000 0.000000000 1.00000000 0.312500000
</pre><br>Is it at all possible the float inaccuracy has anything to do with it? (notice these are all n.n00000)<br>If the uvs are limited to 4dec places what happens. I'll try it here but it might take a while. <br><br></td></tr></table><br>
<a name="577089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warren</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is the texture that you're loading a power of two in each dimension?  That can mess with texture coordinates if it isn't. <br><br></td></tr></table><br>
<a name="577098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah Warren hit the nail on the head - I think<br><br>Bmax must be resizing the texture by padding it some way.<br><br>If you make the image 32x128 and then change the dimensions of  each frame accordingly it works.<br><br>now to fix it. <br><br></td></tr></table><br>
<a name="577112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Should work now. Updated First Post.<br><br>Someone please break it for me :( <br><br></td></tr></table><br>
<a name="577141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks good here.... <br><br></td></tr></table><br>
<a name="577352"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've got 189+ tiles here and the wrong image frames are being drawn. Looks to be one or two tiles off in all instances.<br><br><pre class=code>
'imgTiles:TImage = LoadAnimImage("gfx/tiles/" + tmpPath$, 16, 16, 0, 189 * tmpFrames, MASKEDIMAGE|FILTEREDIMAGE)
imgTiles:TAnimImage = TAnimImage.Load("gfx/tiles/" + tmpPath$, 16, 16, 0, 189 * tmpFrames, MASKEDIMAGE|FILTEREDIMAGE)

If map(x, y, 1) &lt;&gt; -1 Then imgTiles.Draw Int((a * 24) - scrollX), Int(b * 16), 16, 16, map(x, y, 1)
'DrawImage imgTiles, Int((a * 16) - scrollX), Int(b * 24), map(x, y, 1)
</pre>My tile image is 144x336<br>Edit: You also left off the Type and field info in your first post. <br><br></td></tr></table><br>
<a name="577374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> When you say wrong frames do you mean frames are being drawn in error or not at all? <br><br></td></tr></table><br>
<a name="577396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> They're being drawn correctly, only it's showing a different frame than it should be. <br><br></td></tr></table><br>
<a name="577402"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you see any obvious errors in my code? <br><br></td></tr></table><br>
<a name="578060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm. I think I found the problem...<br><pre class=code>
tx = (f Mod x_cells * cell_width) 
</pre><br>should be<br><pre class=code>
tx = (f Mod x_cells * cell_width) * xdelta
</pre><br>...and, famous last words, haven't broken it yet. <br><br></td></tr></table><br>
<a name="578063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah, i tested for height only... I need to employ some full time bug testers :D <br><br></td></tr></table><br>
<a name="578170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very good work. Please consider adding to the next update Mark. <br><br></td></tr></table><br>
<a name="578181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated first post. <br><br></td></tr></table><br>
<a name="578190"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Steve Elliott</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> A typo there Indiepath - should read...<br><br>tx  = (f Mod x_cells * cell_width) * xdelta<br><br>One Eyed Jack, Indiepath laughed at me for suggesting that - you hold him and I'll hit him.  ;-) <br><br></td></tr></table><br>
<a name="578209"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> And it can go faster : <a href="http://www.blitzbasic.com/Community/posts.php?topic=51795" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=51795</a> <br><br></td></tr></table><br>
<a name="578223"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> And now, for the lazy coders version.<br><br>Here, you just load an image specifying how many frames are contained within. Then draw the image using whatever frame you desire. No need to worry about cell sizes.<br><br>The include:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Rem
     TAnimImage
     ----------
     LoadAnim(url,frames[,flags])   -  Load image (animation strip)
     DrawAnim xpos,ypos[,frame]     -  Draw image frame at xpos,ypos
End Rem


Type TAnimImage

	Field Image:TImage
	Field width:Int
	Field height:Int
	Field cell_width:Float
	Field cell_height:Float
	Field u0:Float[]
	Field v0:Float[]
	Field u1:Float[]
	Field v1:Float[] 
	
	Function LoadAnim:TAnimImage(url:Object,frames:Int,flags=-1)
		Local t:TAnimImage = New TAnimImage
		Local tx:Float
		Local ty:Float
		Local x_Cells:Float
		t.u0= New Float[frames]
		t.v0= New Float[frames]
		t.u1= New Float[frames]
		t.v1= New Float[frames]
		t.Image = LoadImage(url,flags)
		t.cell_width=Float(t.Image.Width) / Float(frames)
		t.cell_height=t.Image.Height
		Local xDelta:Float = t.Image.Width / Pow2Size(t.image.width)
		Local yDelta:Float = t.Image.Height / Pow2Size(t.image.height)
		x_cells= Float(t.Image.Width)  / t.cell_width
		For Local f = 0 Until frames
			tx = (f Mod x_cells * t.cell_width) * xdelta
			ty = (f / Int(x_cells) * t.cell_Height) * ydelta
			t.u0[f]= Float(tx) / Float(t.Image.Width)
			t.v0[f] = Float(ty) / Float(t.Image.Height)
			t.u1[f]= Float(tx + t.cell_width * xdelta)  / Float(t.Image.Width)
			t.v1[f]= Float(ty + t.cell_Height * ydelta) / Float(t.Image.Height)
		Next
		Return t
	End Function

	Method DrawAnim(xpos:Float,ypos:Float,frame:Int=0)
		Local DXFrame:TDX7ImageFrame = TDX7ImageFrame (image.frame(0))
		If DXFrame
			DXFrame.setUV(u0[frame],v0[frame],u1[frame],v1[frame])
	   Else
			Local GLFrame:TGLImageFrame = TGLImageFrame(image.frame(0))
			GLFrame.u0 = u0[frame]
			GLFrame.u1 = u1[frame]
			GLFrame.v0 = v0[frame]
			GLFrame.v1 = v1[frame]
		EndIf
		DrawImageRect Self.Image,xpos,ypos,Self.cell_width,Self.cell_height
	End Method
	
	Function  Pow2Size:Float( n% )
		Local t%=1
		While t&lt;n ; t:*2 ; Wend
		Return t
	End Function
	
	Function Free(t:TAnimImage)
		t.Image = Null
		t = Null
		FlushMem()
	End Function

End Type</textarea><br><br>Test Program:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SetGraphicsDriver GLMax2DDriver()
'SetGraphicsDriver D3D7Max2DDriver()
Graphics 640,480,0,SOFTSYNC|50

Include "TAnimImage.bmx"

Const numframes=12
Const animfile$="runnerstrip2.png"

Local runner:TAnimImage = TAnimImage.LoadAnim(animfile$,numframes,FILTEREDIMAGE)

Local frm%,count%

Repeat
	Cls
	count:+1
	If (count Mod 6)=0
		frm:+1 ; If frm=numframes frm=0
	EndIf
	runner.DrawAnim MouseX(),MouseY(),frm
	DrawText (frm+1)+" of "+numframes , 10,10
	Flip
Until KeyHit(KEY_ESCAPE)

End

</textarea><br>The 'runner' animstrip is <a href="http://homepage.ntlworld.com/config/img/runnerstrip2.png" target="_blank">here</a><br><br>Currently, the above only works with a strip of images layed out in a horizontal fashion.<br><br>I'm not sure if the old limitation still exists where trying to handle images larger than the graphics display causes issues(?)<br>When I tried loading the runner animation strip using an image width of 2280 the anim failed to show under DX and played at odd frame positions under GL.<br>I'll see if I can track down any bugs in the LoadAnim method. <br><br></td></tr></table><br>
<a name="578229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm not sure if the old limitation still exists where trying to handle images larger than the graphics display causes issues(?) <br></div><br>Follow the rules for textures and you can't go wrong. <br><br></td></tr></table><br>
<a name="578284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Eikon</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works great now except that some tiles have a strange border around them. I'm loading the TAnimImage as MASKEDIMAGE|FILTEREDIMAGE, and also Drawing at Int() positions only.<br><pre class=code>DrawImageRect(Self.Image, Int(x), Int(y), Int(width), Int(height))</pre>Example:<br>Tiles are sopposed to be dark gray all around, with no light gray edges.<br><img src="http://s93151849.onlinehome.us/ex.png"><br>I really want to use this since it gives my program a nice speed boost. Anyone know what the problem could be? <br><br></td></tr></table><br>
<a name="578290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> The issue may be the small inaccurcies of using UV co-ordinates. If your image conforms to rules for textures ie ^ 2 then there should be no issues. <br><br></td></tr></table><br>
<a name="793647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is anyone using this anymore? Is it stable? <br><br></td></tr></table><br>
<a name="793648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tested it quite a bit when Tim posted it and it worked well after a few teething problems. It doesn't use anything non-standard so, effectively, you have all the source. <br><br></td></tr></table><br>
<a name="793655"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really ought to get round to using this.  Now all I need is a way to make a "mesh" by drawing those textures joined properly so I can scroll a tilemap at non-integer coords without seeing the joins between the tiles (which you get if you draw all the tiles separately). <br><br></td></tr></table><br>
<a name="793658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Old B3D code but the priciples are there<br><br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=1178" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=1178</a><br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=1377" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=1377</a> <br><br></td></tr></table><br>
<a name="793667"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> "...so I can scroll a tilemap at non-integer coords without seeing the joins between the tiles (which you get if you draw all the tiles separately)."<br><br>Hi GA, do you have an .exe demo showing this? I'm not getting any lines and I'm just drawing tiles next to each other. <br><br></td></tr></table><br>
<a name="793672"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Tim.  Will study (when time) but I'm not an expert on DX regretably.<br><br>MGE Dev: <a href="http://www.greyaliengames.com/framework.php" target="_blank">http://www.greyaliengames.com/framework.php</a> scroll down and get "make me happy".  Depending on the type of tile the issue is worse.  It only happens at floating point coords of course because the edge is anti-aliased.  If it was drawn at integer coords to a giant texture of many tiles and then the big texture was drawn at floating point coords, you wouldn't get the issue. <br><br></td></tr></table><br>
<a name="793699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> GA - checked out the Make Me Happy demo (nice!), didn't see any lines between tiles. Was I supposed to? <br><br></td></tr></table><br>
<a name="793736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah you can see if you look carefully.  Well you can on a CRT; if you have a TFT try it in windowed mode so there is no interpolation by your screen.  Also try Speed Run then.  there are slight sorta flickery lines between the titles as they slide from one int coord to another via floating point due to the anti-aliasing.<br><br>btw make me happy took 8 hours (inc. crappy graphics) with my framework :-)  Speed run took less time I think. <br><br></td></tr></table><br>
<a name="793752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm... here's a screen grab from windowed mode on my crt. Where are the lines???? The fact that you see lines on your end, makes me shrug again at the fact that already in 2 days I'm seeing more potential Max2d compatibility issues.<br><br><img src="http://jgoware.com/mge/misc/makemehappy1.jpg"> <br><br></td></tr></table><br>
<a name="793772"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HrdNutz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> Guys, the lines you MAY be experiencing are most likely due to texture filtering (if you see discolored lines between tiles). Try disabling filtering, and there should be no lines in between tiles. Also  try setting texture wrapping mode to CLAMP and see if that helps.  The geometry will always jump from pixel to pixel, even at subpixel accuracy. (no subpixels on monitors) This is specially evident on LCD monitors. <br><br></td></tr></table><br>
<a name="793782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> What lines? (Sorry for repeating...) Perhaps it's gpu related and not a stable 2DMax issue? <br><br></td></tr></table><br>
<a name="793810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The fact that you see lines on your end, makes me shrug again at the fact that already in 2 days I'm seeing more potential Max2d compatibility issues <br></div><br><br>As suggested any issue is likely to be a video card 'oddity' rather than Max2D issue.<br><br>Out of interest, what are the other potential Max2d compatbility issues you have seen? <br><br></td></tr></table><br>
<a name="793815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> In my try to convert to Tanimimage I have to say that  - I only converted some mainsprites. the memory usage increased from 70 to 80MB, the fps-count stays the same (in ogl and also in dx7, dx9 fuzzles the sprites...garbage like).<br><br><br>bye<br>MB <br><br></td></tr></table><br>
<a name="793828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> MGE Developer: perhaps I should have been clearer.  You can only see it as stuff is moving.  Go into that game again and press D for debug mode then L for sLow motion.  Now move across and watch the edges of the grey tiles, they all flicker in an unappealing way because each one is having it's edge filtered.  You can't really notice it on the earth tiles.  The sky is a static image so that doesn't count.  If I do as HrdNutz suggests and turn off filtering when I load in the tiles, then they all get drawn at integer coords, which of course removes the problem, but then it doesn't look as smooth when it's scrolling.<br><br>If you take a static screenshot, it looks fine.  The problem is the edges are different from frame to frame.<br><br>It should happen on all PCs because all that's happening is each tile is drawn individually so it's edges are anti-aliased (filtered) to "nothing" whereas if they were all drawn to a texture first and then displayed, the edges would anti-alias to the adjoining tiles and it would look better.  That's uh my theory anyway.   In fact I tested it by moving a larger tile made up of several smaller ones and the flickery joins were not present.<br><br>Sometimes this sort of issue can be improved by adding a 1 pixel blank border round each sprite but it didn't help much with this tile problem. <br><br></td></tr></table><br>
<a name="793831"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm actually very familiar with the line issue because my older engine suffered from it and I had to add a 1 pixel border around each tile in the texture. So, with that in mind, your demo has no line artifacting on my Intel 82845G driver. ;) It may happen on other GPU's, but it ain't happening on this one. lol.. <br><br></td></tr></table><br>
<a name="793848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, weird. There should be *some* line weirdness esp. as I'm NOT adding the one pixel border in that demo. <br><br></td></tr></table><br>
<a name="793853"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HrdNutz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey is right about the rendering scene to texture and then to screen - that would appear much smoother.  You can see this line flickering very clearly if you draw a filled rect without a texture - the edge will flicker from 1 pixel to the other instead of smoothly gliding in between a single pixel.  Subpixels are achieved through texture filtering - monitors can't really display stuff in between pixels.<br><br>There is another possible 'line issue' that could display a slight portion of the neighbouring texture cell due to texture filtering - this is a different issue than subpixel 'inaccuracy'.  This is related to some driver/card implementations and texture clamping. <br><br></td></tr></table><br>
<a name="794115"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't know about the second line issue. <br><br></td></tr></table><br>
<a name="794820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> As a fix for Greys stuff the following might help<br><pre class=code>
Function setwrap()
	D3D7GraphicsDriver().Direct3DDevice7().SetTextureStageState( 0, D3DTSS_ADDRESS,	D3DTADDRESS_WRAP);
End Function

Function setnowrap()
	D3D7GraphicsDriver().Direct3DDevice7().SetTextureStageState( 0 , D3DTSS_ADDRESS , 	D3DTADDRESS_CLAMP) ; 
End Function
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
