<!DOCTYPE html><html lang="en" ><head ><title >Combobox dropdown height</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Combobox dropdown height</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=117" >MaxGUI Module</a>/<a href="#bottom" >Combobox dropdown height</a><br><br>
<a name="723073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any way to adjust the height of the drop-down list of a combobox?  It's not very easy to navigate a tiny little drop-down box if you have a lot of items stored in it. <br><br></td></tr></table><br>
<a name="723083"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> try this:<br><br><pre class=code>
Local combohwnd=SendMessageA(QueryGadget(combobox,QUERY_HWND),CBEM_GETCOMBOCONTROL,0,0 );
SetWindowPos combohwnd,0,0,0,120,400,SWP_NOMOVE|SWP_NOZORDER|SWP_NOREDRAW|SWP_NOACTIVATE

</pre> <br><br></td></tr></table><br>
<a name="723114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works, thank you. <br><br></td></tr></table><br>
<a name="802532"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DavidDC</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where does SendMessageA live? I'm trying skid's code above in OSX without success.<br><br>I hope it's not windows only?<br><br>thanks<br><br>David <br><br></td></tr></table><br>
<a name="802535"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yea, its Windows <br><br></td></tr></table><br>
<a name="802619"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ha and I thought I was the only one missing such a command/ flag for the combobox. <br><br></td></tr></table><br>
<a name="802694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DavidDC</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm. Is this on our update wishlist then? <br><br>Seems like it would  only be a small change to the MaxGUI code, as they are already setting the default height somewhere?<br><br>It's a fairly big deal for me as I'm midway through a very GUI-driven app; which was meant to be cross-platform (the  reason I selected BlitzMax in the first place) and the current combo height on OSX will make navigation too painful for users - and yet there seems no alternate gadget I can use given my space requirements. <br><br>I'd say it's close to a disaster for me actually. What's the chance of this changing I wonder?<br><br>Thanks<br><br>David <br><br></td></tr></table><br>
<a name="821665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DavidDC</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've attempted the following to allow you to set combo box height in OS X. It seems to work, but testing is appreciated as this is my first real foray under the bonnet.<br><br>in cocoa.macos.m insert towards the end (I placed it after int NSClientWidth(nsgadget *gadget){..})<br><pre class=code>
void NSSetComboBoxDropDownHeight(nsgadget *gadget, int num_rows){
	if(gadget &amp;&amp; num_rows &gt; 0){
		NSComboBox		*combo;
		combo=(NSComboBox*)gadget-&gt;handle;
		if(combo) [combo setNumberOfVisibleItems:num_rows];
	}
}
</pre><br>In cocoagui.bmx Insert at the end of the Extern section (I placed it after Function NSRun$(gadget:TNSGadget,script$))<br><pre class=code>
'combo
Function NSSetComboBoxDropDownHeight(gadget:TNSGadget,num_rows:Int)
</pre><br>Further down the same page insert (I placed it after Method SetTabs(tabs))<br><pre class=code>
	Method SetComboBoxDropDownHeight(height_in_rows:Int)
		Return NSSetComboBoxDropDownHeight(Self,height_in_rows)
	End Method
</pre><br>In BRL.maxgui.mod/gadget.bmx Insert near the end of the TGadget type declaration just before End Type:<br><pre class=code>
'combobox
?macos
	Method SetComboBoxDropDownHeight(num_rows)
	End Method
?macos
</pre><br>And finally at the end of the TProxyGadget Type, just before the End Type Insert<br><pre class=code>
' combo box
?macos
	Method SetComboBoxDropDownHeight(num_rows:Int)
		Return proxy.SetComboBoxDropDownHeight(num_rows)
	End Method
?macos
</pre><br><br>I'm not sure if the proxy gadget insert was needed. Anyone?<br><br>To use - in this instance setting display to 20 rows:<br><br><pre class=code>
		Local ComboBox:TGadget
	
		'	Create the ComboBox
		ComboBox = CreateComboBox(_rect.x,_rect.y,_rect.w,_rect.h,_parent_gadget,_style)

		'	ComboBox ok?
		If ComboBox = Null Throw "ComboBox::Create:TComboBox - NULL ComboBox"
				
		ComboBox.SetComboBoxDropDownHeight(20)	

</pre><br><br>Note setting a height of 20 rows won't actually display a box 20 high unless you have 20+ items in it!<br><br>[Woops! just realised this probably belongs in ModuleTweaks]<br><br>- David <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
