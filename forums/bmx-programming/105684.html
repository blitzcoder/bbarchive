<!DOCTYPE html><html lang="en" ><head ><title >DirectX 1920 x 1200 Fullscreen = Hang?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >DirectX 1920 x 1200 Fullscreen = Hang?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >DirectX 1920 x 1200 Fullscreen = Hang?</a><br><br>
<a name="1291304"></a>

<a name="1291305"></a>

<a name="1291306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi All,<br><br>One of my customers is having issues running Chef Solitaire on his PC:<br><pre class=code>Windows 7 64bit
2 x ATI HD 5980's
ASUS P6X58D-E Motherboard.
Intel CPU i7 X 980 @ 3.33 GHz 
6.00 Gb RAM</pre><br>I've knocked up a simple app to test:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict

Extern "win32"
	Function GetDeviceCaps:Int(hdc:Int, nIndex:Int)
	Function GetActiveWindow:Int()
End Extern

Global dWidth:Int = DesktopWidth()
Global dHeight:Int = DesktopHeight()
Global hertz:Int = 60
Global desktopRefreshRate:Int = 60
Global gameRefreshRate:Int = -1
Global cGraphicsModes:Int = CountGraphicsModes()

For Local mode:TGraphicsMode = EachIn GraphicsModes()
	Print(mode.width + "," + mode.height + "," + mode.depth + "," + mode.hertz)
Next

Global driver:Int
Global dxVersion:Int

Const DX:Int = 0
Const OPENGL:Int = 1
Const DX7:Int = 0
Const DX9:Int = 1

If D3D9Max2DDriver() Then
	Print "Using DX9..."
	SetGraphicsDriver D3D9Max2DDriver()
	driver = DX
	dxVersion = DX9
ElseIf D3D7Max2DDriver() Then
	Print "Using DX7..."
	SetGraphicsDriver D3D7Max2DDriver()
	driver = DX
	dxVersion = DX7
Else If GLMax2DDriver() Then
	Print "Using OpenGL..."
	SetGraphicsDriver GLMax2DDriver()
	driver = OPENGL
Else
	End
End If



Graphics(dWidth, dHeight, 32, hertz)

If D3D7Max2DDriver() Or D3D9Max2DDriver() Then
	desktopRefreshRate = GetDeviceCaps(GetDC(GetActiveWindowSafe()), VREFRESH)
End If

While Not KeyHit(KEY_ESCAPE)
	Cls
		Local c:TTextCursor = New TTextCursor
		c.Init()
		
		c.Output("Hello... ESCAPE to quit")
		c.Output("DesktopWidth  = " + dWidth)
		c.Output("DesktopHeight = " + dHeight)
		c.Output("GraphicsModes = " + cGraphicsModes)
		c.Output("Hertz Hz      = " + hertz)
		c.Output("Desktop Hz    = " + desktopRefreshRate)
		c.Output("Game Hz       = " + gameRefreshRate)
			
		If driver = DX
			c.Output("Driver = DIRECTX")
			If dxVersion = DX7
				c.Output("DIRECTX7")
			Else If dxVersion = DX9
				c.Output("DIRECTX9")
			End If
		Else If driver = OPENGL
			c.Output("Driver = OPENGL")
		End If
		
		Local cc:TTextCursor = New TTextCursor
		cc.Init(300)
		Local i:Int = 0
		For Local mode:TGraphicsMode = EachIn GraphicsModes()
			cc.Output(mode.width + "," + mode.height + "," + mode.depth + "," + mode.hertz)
			i:+1
			If i &gt; 40 Exit
		Next
		
		Local cc1:TTextCursor = New TTextCursor
		cc1.Init(700)
		i = 0
		For Local mode:TGraphicsMode = EachIn GraphicsModes()
			i:+1
			If i &gt; 40 cc1.Output(mode.width + "," + mode.height + "," + mode.depth + "," + mode.hertz)
		Next
		
	Flip(1)
Wend

EndGraphics
While Not AppTerminate()

Wend

Function GetActiveWindowSafe:Int()
	'For Win32 DiredtX only.
	'GetActiveWindow() 'This old method is sometimes unreliable! (e.g. if another window gets focused when this one is being created.)
	'Use new more reliable method.
	?Win32
	Print "GetActiveWindowSafe"
	If driver = DX Then
		Local my_driver:TD3D7GraphicsDriver = D3D7GraphicsDriver()
		Local my_graphics:TD3D7Graphics = my_driver.Graphics()
		'If the my_graphics is null, use DX 9 driver instead.
		If my_graphics &lt;&gt; Null Then
			Print "GetActiveWindowSafe - DX7"
			Return my_graphics._hwnd
		Else
			Print "GetActiveWindowSafe - DX9"

			Local my_driver:TD3D9GraphicsDriver = D3D9GraphicsDriver()
		
			Local my_graphics:TD3D9Graphics = my_driver.Graphics()
		    Return my_graphics._hwnd
		EndIf
	Else
		'Use unreliable method in OpenGL until I get better code.
		Return GetActiveWindow()
	EndIf
	?
End Function
	
Type TTextCursor
	Field x:Int = 0
	Field y:Int = 0
	Field linegap:Int = 20
		
	Method Init(ix:Int = 0, iy:Int = 0, ilinegap:Int = 20)
		x = ix
		y = iy
		linegap = ilinegap
	End Method

	Method NewLine()
		y = y + linegap
	EndMethod
	
	Method Output(text:String)
		DrawText(text, x, y)
		NewLine()
	EndMethod
End Type</textarea><br><br><a href="https://www.dropbox.com/s/1sii58vq9gncfbb/test.exe?dl=0" target="_blank">https://www.dropbox.com/s/1sii58vq9gncfbb/test.exe?dl=0</a><br><br>Does this work for anyone with that resolution?<br><br>Cheers,<br>Steve <br><br></td></tr></table><br>
<a name="1291307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ow ow my eyes ! Ok, I'm at 1920x1080 to try and help, highest res I can go. Tried to run your program, got an error on line 120.<pre class=code>Local my_graphics:TD3D9Graphics = my_driver.Graphics()</pre><br><br><b>Compile Error - Identifier 'Graphics' not found [OK]</b> <br><br></td></tr></table><br>
<a name="1291308"></a>

<a name="1291309"></a>

<a name="1291310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mee to, it seems like the Graphics() method was never implemented for D3D9, it is for D3D7 though.<br>Thankfully you can just disable that part and use the old GetActiveWindow(), its just a test afterall :)<br><br>EDIT: This test shouldnt fail though, unless DesktopXXX() somehow reports wrong results. <br><br></td></tr></table><br>
<a name="1291311"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you get the code running I'll try again ? <br><br></td></tr></table><br>
<a name="1291315"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry guys, I'd forgotten I added it d3d9graphics.bmx. You can quickly add it to TD3D9GraphicsDriver class:<br><br><pre class=code>Method Graphics:TD3D9Graphics()
	Return _graphics
End Method</pre> <br><br></td></tr></table><br>
<a name="1291321"></a>

<a name="1291323"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just commented out everything but<pre class=code>Return GetActiveWindow()</pre>in that function.<br><br>But sadly i dont have a 1920x1200 monitor, so the test worked as expected.<br><br>I would rather expect something else than your code being the culprit honestly.<br>The monitor could run at below 60Hhz.<br>Or it could be like on my netbook, only 1 dx application can be running at the same time.<br>Though that wouldnt account for opengl. <br><br></td></tr></table><br>
<a name="1291324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've sent the customer this test app, waiting for him to get back (he's in the UK and went to bed at 3am over there... hopefully see what he says his tomorrow). <br><br></td></tr></table><br>
<a name="1291329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your framework used some potential debug statements /logging - I would enable it (so you see the position of the crash).<br><br>I assume that it has to do with the hertz value - some screens run at 59 hertz. But it also depends what you see as "crash": the nonexistence of your graphics context or a segfault.<br><br><br>Instead of relying to set the fixed render engine I use the approach to try the first - if that fails, the second, if that fails the third...<br><br>The Windows-part (Linux/Mac only have the OGL ones)<br><a href="https://github.com/GWRon/Dig/blob/master/base.util.graphicsmanager.win32.bmx" target="_blank">https://github.com/GWRon/Dig/blob/master/base.util.graphicsmanager.win32.bmx</a><br><br>So if one had issues with DX it would fall back to OGL. Maybe you could try something similar<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291330"></a>

<a name="1291332"></a>

<a name="1291340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Appears to work OK for me.<br><br>Graphics opens screen at 2560x1440 resolution, and prints text there.<br><br><div class="quote"> <br>Desktop Width = 2560<br>Desktop Height = 1440<br>Graphics Modes = 45<br>Hertz Hz = 60<br>Desktop Hz = 60 <br>Game Hz = -1<br>Driver = DirectX<br>DirectX 9<br><br>640,480,32,75<br>640,480,32,72<br>640,480,32,67<br>640,480,32,60<br>640,480,32,59<br>720,480,32,75<br>720,480,32,72<br>720,480,32,60<br>720,480,32,56<br>720,576,32,75<br>720,576,32,72<br>720,576,32,60<br>720,576,32,56<br>800,600,32,75<br>800,600,32,72<br>800,600,32,60<br>800,600,32,56<br>1024,768,32,75<br>1024,768,32,70<br>1024,768,32,60<br>1152,648,32,50<br>1152,864,32,75<br>1152,864,32,60<br>1280,720,32,59<br>1280,720,32,60<br>1280,720,32,50<br>1280,768,32,60<br>1280,800,32,60<br>1280,960,32,75<br>1280,960,32,60<br>1280,1024,32,75<br>1280,1024,32,60<br>1440,900,32,60<br>1600,900,32,60<br>1600,1200,32,60<br>1680,1050,32,60<br>1776,1000,32,50<br>1792,1344,32,60<br>1800,1440,32,60<br>1856,1392,32,60<br>1920,1080,32,59<br>1920,1080,32,60<br>1920,1080,32,50<br>1920,1200,32,60<br>2560,1440,32,60<br>Using DX9...<br>GetActiveWindowSafe<br>GetActiveWindowSafe - DX9<br> <br></div><br><br>The 2560x1440 your program starts in is the native res of my current monitor (32" LCD), my previous monitor was 1920x1200 and never ran into issues running blitzmax at that resolution either as far as I recall. <br><br></td></tr></table><br>
<a name="1291335"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested explicitly opening a 1920,1200,32,60 screen on my PC, and did notice something odd:<br><br>1) Using SetGraphicsDriver D3D7Max2DDriver() , opening the screen, doing a drawtext and flipping, the contents are visible.<br><br>2) Using SetGraphicsDriver D3D9Max2DDriver() , opening the screen, doing a drawtext and flipping, the text is visible for a split second, and the screen then turns black and stays that way until I draw or print something else -- any subsequent drawing operation DO show up and remain, as you'd expect. In order for it to immediately show what I wanted it to, I had to throw one or two flip statements immediately after the graphics command first. <br><br></td></tr></table><br>
<a name="1291464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Xlsior.<br><br><div class="quote">  Using SetGraphicsDriver D3D9Max2DDriver() , opening the screen, doing a drawtext and flipping, the text is visible for a split second, and the screen then turns black and stays that way until I draw or print something else -- any subsequent drawing operation DO show up and remain, as you'd expect. In order for it to immediately show what I wanted it to, I had to throw one or two flip statements immediately after the graphics command first.  <br></div><br><br>That sounds strange... could you post the code you needed to do to get it to draw correctly? <br><br></td></tr></table><br>
<a name="1291466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>That sounds strange... could you post the code you needed to do to get it to draw correctly? <br> <br></div><br><br>This just flashes the text and ended up with a blank screen until the next drawing/flip operation:<br><br><pre class=code>SetGraphicsDriver D3D9Max2DDriver()
Graphics 1920,1200,32,60
DrawText ("TEST",100,100)
Flip
WaitKey()</pre><br><br>While this left the text on the screen as expected:<br><pre class=code>SetGraphicsDriver D3D9Max2DDriver()
Graphics 1920,1200,32,60
Flip
DrawText ("TEST",100,100)
Flip
WaitKey()</pre><br><br>Of course you'd typically have an on-going draw loop so it shouldn't be an issue with a real life program, it's still a bit odd. <br><br></td></tr></table><br>
<a name="1291499"></a>

<a name="1291500"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well the customer got back and can see the text fine in full screen mode... back to the drawing board.<br><br><pre class=code>Hello.. ESCAPE to quit
DesktopWidth = 1920
Desktopheight = 1200
GraphicsModes = 34
Hertz Hz = 60
Desktop Hz = 60
Game Hz = -1
Driver = DIRECTX
DIRECTX9</pre><br><br>He didnt want to type out all the resolutions :)<br><br>Maybe something with the virtual resolution... <br><br></td></tr></table><br>
<a name="1291504"></a>

<a name="1291508"></a>

<a name="1291510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay next test:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict

' -----------------------------------------------------------------------------
' USAGE: Note that the order is important!
' -----------------------------------------------------------------------------

' 1) Call InitVirtualGraphics before anything else;
' 2) Call Graphics as normal to create display;
' 3) Call SetVirtualGraphics to set virtual display size.

' The optional 'monitor_stretch' parameter of SetVirtualGraphics is there
' because some monitors have the option to stretch non-native ratios to native
' ratios, and you cannot detect this programmatically.

' For instance, my monitor's native resolution is 1920 x 1080, and if I set the
' Graphics mode to 1024, 768, it defaults to stretching that to fill the screen,
' meaning the image is stretched horizontally, so a square will appear non-
' square; however, it also provides an option to scale to the correct aspect
' ratio. Since this is set on the monitor, there's no way to detect or correct
' it other than by offering the option to the user. Leave it off if unsure...

' -----------------------------------------------------------------------------
' Copy this...
' -----------------------------------------------------------------------------

Type VirtualGfx
	Global width:Float
	Global height:Float


	Global VG:VirtualGfx
	
	Global DTInitComplete:Int = False
	Global DTW:Int
	Global DTH:Int

	Field vwidth:Int
	Field vheight:Int

	Field vxoff:Float
	Field vyoff:Float

	Field vscale:Float
	
	Function CreateVG:VirtualGfx (width:Int, height:Int)
		VG = New VirtualGfx
		VG.vwidth = width
		VG.vheight = height
	End Function
	
	Function SetVirtualGraphics (vwidth:Int, vheight:Int, monitor_stretch:Int = False)

		' InitVirtualGraphics has been called...
		
		If VirtualGfx.DTInitComplete
		
			' Graphics has been called...
			
			If GraphicsWidth () = 0 Or GraphicsHeight () = 0
				Notify "Programmer error! Must call Graphics before SetVirtualGraphics", True; End
			EndIf
			
		Else
			EndGraphics; Notify "Programmer error! Call InitVirtualGraphics before Graphics!", True; End
		EndIf

		' Reset of display needed when re-calculating virtual graphics stuff/clearing borders...
			
		SetVirtualResolution GraphicsWidth (), GraphicsHeight ()
		SetViewport 0, 0, GraphicsWidth (), GraphicsHeight ()
		SetOrigin 0, 0

		' Store current Cls colours...
		
		Local clsr:Int, clsg:Int, clsb:Int
		GetClsColor clsr, clsg, clsb
		
		' Set to black...
		
		SetClsColor 0, 0, 0
		
		' Got to clear both front AND back buffers or it flickers if new display area is smaller...
		
		Cls
		Flip

		Cls
		Flip
		
		Cls
		Flip
		
		' EDIT, 10 Nov 2011: I had a 3rd Cls/Flip here in case triple-buffering was enabled, but have finally
		' tested this and it wasn't needed. (Tested on NVIDIA GTX 260, Windows 7, with driver
		' version 275.33.)

		' EDIT 2, 30 Dec 2011: Reinstated 3rd Cls/Flip for triple-buffering; see first thread comment!

		' Put back Cls colours...

		SetClsColor clsr, clsg, clsb
		
		' Create new (global) virtual display object...
		
		VirtualGfx.CreateVG (vwidth, vheight)
		
		' Real Graphics width/height...
		
		Local gwidth:Int
		Local gheight:Int
		
		' If monitor is correcting aspect ratio IN FULL-SCREEN MODE, use desktop size, otherwise use
		' specified Graphics size. NB. This assumes user's desktop is using native monitor resolution,
		' as most laptops would be by default...
		
		If monitor_stretch And GraphicsDepth ()

			' Pretend real Graphics mode is desktop width/height...

			gwidth = DTW
			gheight = DTH
			
			width = gameWidth
			height = gameHeight

		Else

			' Use real Graphics width/height...

			gwidth = GraphicsWidth ()
			gheight = GraphicsHeight ()

			width = gameWidth
			height = gameHeight

		EndIf
		
		' Width/height ratios...
		
		Local graphicsratio:Float = Float (gwidth) / Float (gheight)
		Local virtualratio:Float = Float (VirtualGfx.VG.vwidth) / Float (VirtualGfx.VG.vheight)
		
		' Ratio-to-ratio. Don't even know what you'd call this, but hours of trial and error
		' provided the right numbers in the end...
		
		Local gtovratio:Float = graphicsratio / virtualratio
		Local vtogratio:Float = virtualratio / graphicsratio
		
		' Compare ratios...

		If graphicsratio =&gt; virtualratio
			
			' Graphics ratio wider than (or same as) virtual graphics ratio...

			VirtualGfx.VG.vscale = Float (gheight) / Float (VirtualGfx.VG.vheight)
			
			' Now go crazy with trial-and-error... ooh, it works! This tiny bit of code took FOREVER.
			
			Local pixels:Float = Float (VirtualGfx.VG.vwidth) / (1.0 / VirtualGfx.VG.vscale) ' Width after scaling
			Local half_scale:Float = (1.0 / VirtualGfx.VG.vscale) / 2.0

			width = VirtualGfx.VG.vwidth * gtovratio
			height = gameHeight
			
			SetVirtualResolution VirtualGfx.VG.vwidth * gtovratio, VirtualGfx.VG.vheight

			' Offset into 'real' display area...
			
			VirtualGfx.VG.vxoff = (gwidth - pixels) * half_scale
			VirtualGfx.VG.vyoff = 0
		
			' Set up virtual graphics area...
			
			SetViewport VirtualGfx.VG.vxoff, VirtualGfx.VG.vyoff, VirtualGfx.VG.vwidth, VirtualGfx.VG.vheight
			SetOrigin VirtualGfx.VG.vxoff, VirtualGfx.VG.vyoff
			
		Else
			
			' Graphics ratio narrower...
		
			VirtualGfx.VG.vscale = Float (gwidth) / Float (VirtualGfx.VG.vwidth)
			
			Local pixels:Float = Float (VirtualGfx.VG.vheight) / (1.0 / VirtualGfx.VG.vscale) ' Height after scaling
			Local half_scale:Float = (1.0 / VirtualGfx.VG.vscale) / 2.0
			
			width = gameWidth
			height = VirtualGfx.VG.vheight * vtogratio

			SetVirtualResolution VirtualGfx.VG.vwidth, VirtualGfx.VG.vheight * vtogratio
		
			VirtualGfx.VG.vxoff = 0
			VirtualGfx.VG.vyoff = (gheight - pixels) * half_scale
		
			SetViewport VirtualGfx.VG.vxoff, VirtualGfx.VG.vyoff, VirtualGfx.VG.vwidth, VirtualGfx.VG.vheight
			SetOrigin VirtualGfx.VG.vxoff, VirtualGfx.VG.vyoff
			
		EndIf
	
	End Function

	Method VMouseX:Float ()
		Local mx:Float = VirtualMouseX () - vxoff
		If mx &lt; 0 Then mx = 0 Else If mx &gt; vwidth - 1 Then mx = vwidth - 1
		Return mx
	End Method
	
	Method VMouseY:Float ()
		Local my:Float = VirtualMouseY () - vyoff
		If my &lt; 0 Then my = 0 Else If my &gt; vheight - 1 Then my = vheight - 1
		Return my
	End Method
	
	Method VirtualWidth:Int ()
		Return vwidth
	End Method

	Method VirtualHeight:Int ()
		Return vheight
	End Method
	
End Type

' -----------------------------------------------------------------------------
' ... and these helper functions (required)...
' -----------------------------------------------------------------------------

Function InitVirtualGraphics ()

	' There must be a smarter way to check if Graphics has been called...
	
	If GraphicsWidth () &gt; 0 Or GraphicsHeight () &gt; 0 Then EndGraphics; Notify "Programmer error! Call InitVirtualGraphics BEFORE Graphics!", True; End

	VirtualGfx.DTW = DesktopWidth ()
	VirtualGfx.DTH = DesktopHeight ()

	' This only checks once... best to call InitVirtualGraphics again before any further Graphics calls (if you call EndGraphics at all)...
	
	VirtualGfx.DTInitComplete = True

End Function

Function SetVirtualGraphics (vwidth:Int, vheight:Int, monitor_stretch:Int = False)
	VirtualGfx.SetVirtualGraphics (vwidth, vheight, monitor_stretch)
End Function

Function VMouseX:Float ()
	Return VirtualGfx.VG.VMouseX ()
End Function

Function VMouseY:Float ()
	Return VirtualGfx.VG.VMouseY ()
End Function

' Don't need VirtualMouseXSpeed/YSpeed replacements!

Function VirtualWidth:Int ()
	Return VirtualGfx.VG.VirtualWidth ()
End Function

Function VirtualHeight:Int ()
	Return VirtualGfx.VG.VirtualHeight ()
End Function

' -----------------------------------------------------------------------------
' Don't copy after this...
' -----------------------------------------------------------------------------






' -----------------------------------------------------------------------------
' D E M O . . .
' -----------------------------------------------------------------------------
SetGraphicsDriver D3D9Max2DDriver()
' REQUIRED! BEFORE Graphics!

Global gameWidth:Float = 1366
Global gameHeight:Float = 768

InitVirtualGraphics

' Toggle for demo's windowed/full-screen switching...

Local FULLSCREEN_TOGGLE:Int =1

' Change this if your monitor doesn't support it!

Local fullscreenwidth:Int = DesktopWidth()
Local fullscreenheight:Int = DesktopHeight()
Local fullscreendepth:Int = 32

Local windowedwidth:Int = gameWidth
Local windowedheight:Int = gameHeight
Local windoweddepth:Int = 0

Global steam:Int = True

If FULLSCREEN_TOGGLE
	Graphics fullscreenwidth, fullscreenheight, fullscreendepth
Else
	Graphics windowedwidth, windowedheight, windoweddepth
EndIf

' If user's monitor is set to stretch to its native resolution, this needs to be set to True. I
' would recommend making this a selectable option in your game's configuration as there's no way
' to check this from any program...

Local monitor_adjusting:Int = True

' REQUIRED! AFTER InitVirtualGraphics!

SetVirtualGraphics windowedwidth, windowedheight, monitor_adjusting

SetClsColor 64, 96, 128
SetMaskColor 255, 0, 255

' Some boxes...

Type Box
	Field x:Float, y:Float
	Field xs:Float, ys:Float
	Field size:Int
	Field r:Int, g:Int, b:Int
End Type

Local boxes:TList = CreateList ()

For Local loop:Int = 0 Until 100
	Local b:Box = New Box
	b.size = Rand (32)
	b.x = Rnd (VirtualWidth () - b.size)
	b.y = Rnd (VirtualHeight () - b.size)
	b.xs = Rnd (-4.0, 4.0)
	b.ys = Rnd (-4.0, 4.0)
	b.r = Rand (100, 255)
	b.g = Rand (100, 255)
	b.b = Rand (100, 255)
	ListAddLast boxes, b
Next

Repeat

	If FULLSCREEN_TOGGLE And KeyHit (KEY_RETURN)

		monitor_adjusting = 1 - monitor_adjusting
		SetVirtualGraphics windowedwidth, windowedheight, monitor_adjusting

	EndIf
	
	If KeyHit(KEY_F1)
		steam = Not steam
	EndIf
	
	If KeyHit (KEY_SPACE)

		FULLSCREEN_TOGGLE = 1 - FULLSCREEN_TOGGLE

		' Demo of how to change graphics mode...

		EndGraphics
		
		' I recommend calling this on the off-chance that the user's desktop size has changed...
		
		InitVirtualGraphics
		
		' Windowed/full-screen...
		
		If FULLSCREEN_TOGGLE
			Graphics fullscreenwidth, fullscreenheight, fullscreendepth
			SetVirtualGraphics windowedwidth, windowedheight, monitor_adjusting
		Else
			Graphics windowedwidth, windowedheight, windoweddepth
			SetVirtualGraphics windowedwidth, windowedheight
		EndIf
		
		' These get reset when exiting graphics mode...
		
		SetClsColor 64, 96, 128
		SetMaskColor 255, 0, 255
		
	EndIf
	
	Cls
	
	SetScale 1, 1

	For Local b:Box = EachIn boxes
		b.x = b.x + b.xs
		b.y = b.y + b.ys
		If b.x &lt; 0 Or (b.x + b.size) &gt; VirtualWidth () Then b.xs = -b.xs; b.x = b.x + b.xs
		If b.y &lt; 0 Or (b.y + b.size) &gt; VirtualHeight () Then b.ys = -b.ys; b.y = b.y + b.ys
		SetColor b.r, b.g, b.b
		DrawRect b.x, b.y, b.size, b.size
	Next
	
	SetColor 255, 0, 0
	DrawRect 0, 0, 16, 16
	DrawRect 0, VirtualHeight () - 16, 16, 16
	DrawRect VirtualWidth () - 16, 0, 16, 16
	DrawRect VirtualWidth () - 16, VirtualHeight () - 16, 16, 16
	
	SetColor 0, 0, 255
	DrawRect VMouseX () - 16, VMouseY () - 16, 32, 32
	
	SetScale 3, 3
	SetColor 255, 255, 255
	
	Local c:TTextCursor = New TTextCursor
	c.Init()
	
	c.Output("SPACE: Toggle Windowed/full-screen")
	If FULLSCREEN_TOGGLE Then c.Output("ENTER: Toggle Monitor stretch correction")
	c.Output("Strtch Correction  = " + monitor_adjusting)
	c.Output("Full Screen        = " + FULLSCREEN_TOGGLE)
	c.Output("Desktop Resolution = " + fullscreenwidth + "x"+ fullscreenheight)
	c.Output("Virtual Resolution = " + windowedwidth+ "x"+ windowedheight)
	c.Output("F1 - Steam CLS     = " + steam)

	Flip
	
Until KeyHit (KEY_ESCAPE)

End

Type TTextCursor
	Field x:Int = 0
	Field y:Int = 0
	Field linegap:Int = 40
		
	Method Init(ix:Int = 0, iy:Int = 0, ilinegap:Int = 40)
		x = ix
		y = iy
		linegap = ilinegap
	End Method

	Method NewLine()
		y = y + linegap
	EndMethod
	
	Method Output(text:String)
		DrawText(text, x, y)
		NewLine()
	EndMethod
End Type

Function Cls()
	If steam
		Local clsr:Int, clsg:Int, clsb:Int
		Local r:Int, g:Int, b:Int
		
		GetClsColor clsr, clsg, clsb
		GetColor r, g, b
		
		SetVirtualResolution GraphicsWidth (), GraphicsHeight ()
		SetViewport 0, 0, GraphicsWidth (), GraphicsHeight ()
		SetOrigin 0, 0
		SetClsColor 0, 0, 0
		brl.max2d.Cls()
		
		SetVirtualResolution VirtualGfx.width, VirtualGfx.height
		SetViewport VirtualGfx.VG.vxoff, VirtualGfx.VG.vyoff, VirtualGfx.VG.vwidth, VirtualGfx.VG.vheight
		SetOrigin VirtualGfx.VG.vxoff, VirtualGfx.VG.vyoff
		SetClsColor clsr, clsg, clsb
		SetColor r, g, b
		brl.max2d.Cls()
	Else
		brl.max2d.Cls()
	EndIf
End Function</textarea><br><br><a href="https://www.dropbox.com/s/hq8wg5jzcri87ao/virtual_res_text.exe?dl=0" target="_blank">https://www.dropbox.com/s/hq8wg5jzcri87ao/virtual_res_text.exe?dl=0</a> <br><br></td></tr></table><br>
<a name="1291647"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tried your code as is, screen went black and THEN my keyboard locked (couldn't do Alt-Tab), finally had to do hit ALT TAB to shut down the EXE manually. It may just be me but I really don't like hardware snap resolutions.<br><br>The only safe SNAP I have seen that is pretty well used universally for full-screen games is 800x600.<br><br>I'm guessing if it crashed here, that might be why the client had problems.<br><br>I see you're using virtual resolution. Maybe I'm not reading enough into this. Here's some very safe code.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict
Local i,j
Graphics DesktopWidth(),DesktopHeight()
SetBlend alphablend
SetVirtualResolution 800,620 ' note it's 20+ compensates for taskbar
DrawRect 0,0,800,600 ' yet we can draw to full 800x600 now with no problem
SetColor 0,0,0
DrawRect 1,1,798,598 ' hollow out rectangle to show it really fits perfect
SetColor 0,0,255
DrawLine 50,50,200,200 ' simple line
SetLineWidth 1
SetColor 255,0,0
DrawOval 400,200,50,50 ' simple circle
Flip
WaitKey</textarea><br><br>This can be optimized for speed, but you get the idea. You can have a nice virtual screen that matches anyone's resolution with this method that resizes all pixels to the correct scale.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' simple example showing virtual resolution
Strict
SetGraphicsDriver GLMax2DDriver(),0
Global maxx=DesktopWidth(),maxy=DesktopHeight()
Global scrn:TImage=CreateImage(800,600)
Local i,j

Graphics maxx,maxy

Repeat ' {* MAIN *}

Cls
For i=0 To 599 ' your standard 800x600 screen
  For j=0 To 799
    SetColor Rand(0,255),Rand(0,255),Rand(0,255)
    Plot j,i ' test image
  Next
Next
SetColor 255,255,255 ' need to set white color back
GrabImage scrn,0,0 ' already sized for 800x600, grab it for plotting
DrawImageRect scrn,0,0,maxx,maxy,0 ' str-ret-tch the 800x600 screen to host's own full screen
glflush ' update the screen

Until KeyDown(27) ' {* END OF MAIN *}
</textarea> <br><br></td></tr></table><br>
<a name="1291648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @therevills<br>Works here - with all the known flaws of vanilla BlitzMax Max2D. I have two screens here (extended view)  - your app is drawn in the center of both screens.<br>when manually overriding to use the desktop-size of one single screen both screens (both 19" screens) show the app (like in "cloning mode"). Maybe that special behavior is specific to my linux environment/setup.<br><br>Brucey once mentioned, that his SDL wrapper has the benefit of better incorporation of multi-screen-setups.<br><br><br>Nonetheless: it seems to work and does not "stall".<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> The 'next test' one works perfectly fine on my PC as well, no problems at all.. 2560x1440 resolution, 1366x768 virtual res. <br><br></td></tr></table><br>
<a name="1291669"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> @dw817 - Thanks for testing, but sorry what do you mean by SNAP?<br><br>@Ron and xlsior - again thanks for testing...<br><br>The customer has also tested this app with this comment "Nice one. I've paid money for worse games than that lol." LOL!<br><br>Okay there must be something deep in the framework work which is not quite working for some reason...<br><br>The hunt begins... <br><br></td></tr></table><br>
<a name="1291673"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Therevills. By SNAP I mean your monitor goes solid black like the power went off, then your monitor has a conniption as it tries to SNAP into a hardware resolution mode that's not the regular resolution you operate your PC in, such as 640x480 or 800x600.<br><br>Really anything less than 1024x768 I call a SNAP resolution. It may be great for games and stuff, I'm just worried it'll damage my monitor. That's why first convenience I bring up config and say WINDOWED mode.<br><br>I have this OTHER program, a nice Freeware one, that takes any windows app and stretches the screen so the game plays the way I like, full-screen, no snap, and I can see the clock to see what time it is.<br><br>That's important to me ! :) <br><br></td></tr></table><br>
<a name="1291674"></a>

<a name="1291676"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please hand the customer 3 versions when you send him the next "test":<br><br>- enforced DX9 (this is what is used by default in your setup)<br>- enforced DX7<br>- enforced OpenGL<br>(-enforced BufferedOpenGL if you have that module running)<br><br>In my framework I have also an automatic order but I also had people having trouble with the DX9-renderer, so I added app-arguments and config-file-options to override Renderer and SoundEngine (having users with Linux distributions _not_ providing PulseAudio preinstalled).<br><br><br>While your current app does not seem to be troublesome, special circumstance might bug out the whole thing (big images/sprite-atlases, non-power-of-two-thingies, ...).<br><br>Do you use threading?<br><br>If that customer is a bit more experienced you might hand him the debugbuild and he could run it via the Gnu Debugger (gdb) and the backtrace might be of help (if you'd compiled with NG you would then even get the corresponding code line number and even more).<br><br><br>Could you elaborate on what the customer experiences? Crash after startup - or within the game?<br><br>You might have to fill a big logfile in your game so you could see how things go on his computer ("[08:15:12] PlaySound(xyz)"). Instead of logging "Update()" you log all extraordinary things ("CollapseBlocks" "GiveScore" ... think you know what I am talking about).<br><br>Maybe this helps to track down things.<br><br><br>Is your code "superstrict" ?<br>Do you use Bruceys TList-variant (in debugbuild it notifies you if your code modifys a list concurrently) ? <br><br>I had trouble with "concurrent list modification" in my game - not everytime but everyonce. So while iterating over a list I removed "dead" entries. This should be avoided:<br>a) two loops, 1st updates and adds toDelete to an array, 2nd over the array deleting from the list<br>b) one loop over a list.copy() so it is save to modify the original one<br><br>So if you are not sure: use Bruceys TList-variant, compile and run a debug-build of your game. Play around a bit and check if it "stops" you somewhere in the code.<br><br>This is the change to the linkedList.mod:<br><a href="https://github.com/bmx-ng/brl.mod/commit/01fb9f0ffd53cef697e1febc48c7cd2965f3e53d" target="_blank">https://github.com/bmx-ng/brl.mod/commit/01fb9f0ffd53cef697e1febc48c7cd2965f3e53d</a><br><br>Similar was done to Map.mod (if you use maps).<br><br><br>Maybe this helps.<br><br><br><br>EDIT:<br>@DW<br>I think what you are talking about (without seeing the clock while playing) is similar to a "windowed fullscreen mode" or "borderless fullscreen mode".<br>On linux this is often used to allow seamless task switching (eg. WarCraft III on wine crashed when alt-tabbing from real fullscreen mode).<br><br>http://pcgamingwiki.com/wiki/Glossary:Borderless_fullscreen_windowed<br><br>The problem with taskbars is, that their size is individual - so you cannot just decrease height without adding black bars at the left and right (which is what TVirtualGFX does allow you to do).<br><br>To avoid "snapping" you must use the original desktop resolution (and depth) as this avoids a mode switch. <br>More important, if you have eg. VirtualBox running next to your app, the contained OS wont get resized if you use another resolution than the one running currently. <br> <br>On the other side, "snapping" allows to save GPU power. As then it is up to the monitor/screen to do the scaling. Of course GPUs might do better scaling then screens. Also it is important whether your GPU/drivers allow letterboxing or if they stretch everything to the hardware given resolution. Same thoughts for the screen (older screens had trouble with 4:3 on 16:10 screens - they stretched the content).<br><br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> dw817: So just normal behavior for a monitor then. Trust me, it wont brake  unless its a REALLY old CRT. <br><br></td></tr></table><br>
<a name="1291693"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've strip back to the simplest framework example:<br><br><a href="https://www.dropbox.com/s/u13lubnc9lvbhp7/Test.zip?dl=0" target="_blank">https://www.dropbox.com/s/u13lubnc9lvbhp7/Test.zip?dl=0</a><br><br>@Ron - Thanks for the ideas. All my code is SuperStrict :) <br><br></td></tr></table><br>
<a name="1291707"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well ... *scratches chin* I dunno, It's all so ATARI to force a lower resolution is the way I see it. And there is some great code out there to give you a full-screen, frameless, no snap, with your taskbar easily viewed below.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' Example of perfect Frameless window
Strict
Import maxgui.drivers ' necessary for frameless window
Local deskrect[4],i,j
GetDesktopArea(deskrect) '&lt;- Get Desktop size
SetGraphicsDriver GLMax2DDriver(),0 ' zero forces front buffer
Local a=deskrect[0],b=deskrect[1],c=deskrect[2],d=deskrect[3]
Local zvideo:tgadget=CreateWindow("",a,b,c,d,,0) ' special graphics
Local zframe:tgadget=CreateCanvas(a,b,c,d,zvideo,0) ' is frameless
SetGraphics CanvasGraphics(zframe) ' set new graphics
ActivateGadget zframe ' necessary so it's active
SetBlend alphablend ' good graphic blending
EnablePolledInput() ' necessary for normal input
DrawRect 0,0,c,d
SetColor 0,0,0
DrawRect 1,1,c-2,d-2 ' draw a hollow box around frame edges
SetColor 255,255,255
For i=b+2 To d-2 Step 2
  For j=a+2 To c-2 Step 2 ' test screen with dots
    Plot j,i
  Next
Next
glflush
WaitKey

' &gt;&gt; GET DESKTOP AREA MINUS TASKBAR
' original code by DAN UPRIGHT
Function getdesktoparea(lprect:Int Ptr)
  systemparametersinfoa(spi_getworkarea,0,lprect,0)
End Function
Extern "Win32"
  Function SystemParametersInfoA:Int(action:Int, param:Int, param2:Byte Ptr, winini:Int)
EndExtern
</textarea> <br><br></td></tr></table><br>
<a name="1291708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @dw817<br>Not cross-platform (limited renderer + windows calls). Even when fixing your code (needs gtkmaxgui on my box) this then not work as intended (see your snow-thread).<br><br><br>@Therevills<br>Before searching through thousand lines of code it might be a time saver to use the "modded tlist/tmap" and check if a debug build blames something. Maybe only a little chance - but at least a chance.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291738"></a>

<a name="1291739"></a>

<a name="1291740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Customer has tested the newest test app:<br><br><pre class=code>Well yeah that one just did the exact same thing as it did at first with the driver 0 on the game.

Total blackscreen. Blue working icon just spinning.

Couldn't even get the process up to kill it. Just went back to the game screen locked up every time I tried to start task manager.
Though it did seem to be advancing half a frame each time. Because the kitchen display came up after 10 or so attempts. Frozen. But there.

Managed to shut the comp down from the ctrl+alt+delete screen to reboot. Log to follow in serarate post.</pre><br><br>Hmmmm.... sounds like an infinite loop somewhere... but why would it work in window mode (DX) and OpenGL fullscreen... <br><br></td></tr></table><br>
<a name="1291756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Therevills, your drop box demo works here. Minju, it takes like 4-seconds for the screen to appear.<br><br>Then I tried something. I moved the cursor all the way to the right and clicked there, the regular Windows screen appeared w the taskbar but your program kept running in the background. I had to task kill it as it wouldn't die on its own. <br><br></td></tr></table><br>
<a name="1291775"></a>

<a name="1291777"></a>

<a name="1291778"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> If rendermodes decide whether something runs or not - I would look at the implementations / modules.<br><br>I did not really find something within d3d9max2d.mod (loop wise)...<br><br>I assume OGL windowed would work too and only DX fullscreen is troublesome? Did you ask him about his monitor setup (dual screen, attached TV via HDMI, ...) maybe this causes trouble. I do not assume the customer is using such a setup, but better put it on your list of Q than not.<br><br>Did it crash for both DX variants (7 and 9)?<br><br><br>@not being able to kill app<br>I think the infinite loop did not process events meanwhile, so app wont respond and if it eats the cpu task killing could become tedious.<br> <br><br>@"kitchen display"<br>I do not know what your test app does, but if this is one of the first things to display to the user, then you already narrowed things down to:<br>- startup logic<br>- used modules code<br><br>So:<br>If it is within startup - does it already bork when drawing a "developed by x" screen, or when reaching the start screen?<br>This might help to narrow it down even more (hope you do not understand my phrases as If I am talking to a "newbie" - but sometimes one just does not see the obvious things)<br><br>Maybe on DX9 the user has trouble of creating so many 2048x2048 sized textures (power-of-two from 1920x1200) - depending on whether you use fullscreen backdrops.<br><br><br>Kind of checklist:<br>- checked if media (images) got loaded in a corrupted way?<br>- checked if media (audio) is troublesome (eg.  oggvorbis.mod/oggdecoder.c contains a bug which in rare situations results in an infinite loop, but this would bork up the game for all players I think)?<br>- check if audio playback is creating trouble (just disable it for test purposes - if it gets used right at the startscreen, but then: why should that happen only in fullscreen mode)<br><br>- fullscreen: your code uses 32bit colordepth, in windowed mode the colordepth of the desktop is used, checked?<br><br><br>Regardless of your response: once you find out _what_ the reason was, please tell us about, I am always interested in avoiding obstacles in my projects then :-p<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've sent him another build we more logging... hope he doesnt get sick of running these tests for me.<br><br>The test app, all it does is set up a player profile (in ProgramData folders - works fine), displays a loading bar (although due to the switch to full screen, I cant see it) and displays the "TitleScreen" class which show an image of a kitchen from the game.<br><br>The app doesnt have any sound, but uses virtual resolution to display a 1366x768 game resolution on the users desktop resolution.<br><br>I'll ask about his monitor setup. Havent tested DX7 yet.<br><br>OGL works fine full screen and windowed.<br><br>Thanks for the ideas!<br><br>Cheers,<br>Steve <br><br></td></tr></table><br>
<a name="1291784"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Loading Bar ... <br>Does this use SetViewport or a custom variant (didn't there exist issues with SetViewport - which is why GreyAlien did a ccSetViewport() then)<br><br>So if you do so, it might be a "black screen" because of some broken viewport things (or you forgot the virtualGFX-offsets in a call)  - but this does not explain the lock up ... hmm.<br><br><br><br>@Title-Screen class<br>This does prepare, update and render (and other things) - so this is surely a good point for logging.<br><br>@DX / OGL<br>Might be useless information but - DX and OGL might differ on whether they immediately do the GPU transfer (on DrawImage) or whether they do it with the flip(). So issues with the GPU (driver problems) might happen on "flip()" instead on "DrawImage()". <br>But I assume it is hidden somewhere in your code (or Blitzmax' modules) and not a driver issue on the customer computer.<br><br><br>@"2 x ATI HD 5980's"<br>Hmm, I do only use 1 GPU ... how about you, are you using crossfire? Maybe there is a problem there ... hmm even this sounds like the last thread of hope :-)<br><br><br>Sorry for bombing you with my posts. Good Luck with the customer (and if he agrees, mention him in the update of your game ... people like such things).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291798"></a>

<a name="1291799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you got the "next test" running ?<br><br>That's really strange ... you shouldn't ^^<br>-&gt; You replaced the cls function and call it in the VirtualGfx.SetVirtualGraphics function before creating the VG instance.<br>As your overriden Cls function call VirtualGfx.VG for the SetViewport, you should run an unhandled exception.<br><br>This kind of error does not appear in release mode, but as it's the third time in the month I'm the only one running an exception on such a code that only generate errors with debugmode (like array index out of bounds),<br>Am I really the only one running apps with debug enabled with Blitzmax ?<br><br>I fill alone :)<br><br>BTW, you can fix the error just by calling the full path for Cls as you have done later on the Cls overriden function.<br><br><pre class=code>
Function SetVirtualGraphics (vwidth:Int, vheight:Int, monitor_stretch:Int = False)
[...]
SetClsColor 0, 0, 0
		
		' Got to clear both front AND back buffers or it flickers if new display area is smaller...
		
		' Set to black...
		
		SetClsColor 0, 0, 0
		
		' Got to clear both front AND back buffers or it flickers if new display area is smaller...
		
		brl.max2d.Cls()
		'Cls
		Flip

		brl.max2d.Cls()
		'Cls
		Flip
		
		brl.max2d.Cls()
		'Cls
		Flip
</pre> <br><br></td></tr></table><br>
<a name="1291806"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Boby<br>That test works in release mode, running in debug resulted in two black screens, the cursor went "greenish/dark" on the second screen when moving.<br><br>Alt+Tab was not possible (I think because MaxIDE already displayed the error notification window).<br><br>Had to move to another console and "killall untitled1.debug" ...<br><br><br>You are right, we should run things in debug mode (but MaxIDE is just... you cannot work with it as even "undo" is flawed and removes the wrong lines). I just fire up MaxIDE to run already written code, rest is done via Geany + my plugin to compile (no debugger support).<br><br><br>Instead of "brl.max2d.Cls()" you could call the superscoped ".Cls()". This allows an easier replacement of "brl.max2d" with something else, also providing a Cls() Function. Dunno if this is better (at least brl.max2d.cls() is easier to distinguish from "cls()") - but I was using this in my framework when accessing virtual graphics.<br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suppose I understand the problem.<br>1/ I use Blide, the stack trace works fine on it.<br>2/ I also always remove any FullScreen mode when I test a code from some users before going further.<br>-&gt; To be honest, I hate having to debug something fullscreened ...<br>On old computers, I had to reboot several times due to graphic drivers issues on non-supported modes or neverending loops that consumed 100% CPU and never be abled to get back to the desktop for some reason.<br>And for sure, there are some people that publish very crappy codes ... It's a bit hazardous to run it without a bit of precaution ^_^<br><br>So, here too, I removed the fullscreen for testing the stability of the code ... And as it failed on Cls without other issue related to a black screen related to the fullscreen mode (as I wasn't in fullscreen) I could notice the Cls bug.<br><br>for the superscoped cls method, that's true, but when you come to use some function naming that already exists, you reach very fastly the point when you don't remember what is called from what and from where it is called ...<br>At least with full module path, it's not very nice but it's explicit. <br><br></td></tr></table><br>
<a name="1291911"></a>

<a name="1291912"></a>

<a name="1291913"></a>

<a name="1291914"></a>

<a name="1291915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Bobysait - I am overloading Cls for a reason and it works fine on many PCs. Does it fail on yours? Which post are you talking about too?<br><br>I've got a trace log from the customer:<br><br><pre class=code>15:30:48: Entering main loop...
15:30:48: Before repeat
15:30:48: FixedRateLogic.NumTicks = 0.20000000000000001 0.00000000000000000
15:30:48: remainder = 0.200000003
15:30:48: FixedRateLogic.NumTicks = 2.6000000000000001 2.0000000000000000
15:30:48: remainder = 0.600000024
15:30:48: FixedRateLogic.NumTicks = 2.7999999999999998 2.0000000000000000</pre><br><br><pre class=code>15:31:01: remainder = 0.600000024
15:31:01: FixedRateLogic.NumTicks = 0.59999999999999998 0.00000000000000000
15:31:01: remainder = 0.600000024
15:31:01: FixedRateLogic.NumTicks = 0.59999999999999998 0.00000000000000000
15:31:01: remainder = 0.600000024</pre><br><br><br>Notice the second value on the FixedRateLogic.NumTicks line, that is the Floored value of the first value:<br><pre class=code>		DebugLog "FixedRateLogic.NumTicks = "+FixedRateLogic.NumTicks + " " + Floor(FixedRateLogic.NumTicks)

		For Local i% = 1 To Floor(FixedRateLogic.NumTicks)
			FixedRateLogic.SetDelta(1)
			If LogicWrapper() = -1 Then Return -1
		Next</pre><br><br>So the code is trying to do a FOR loop from 1 to 0.... <br><br>Just below that code the reminder is calculated:<br><pre class=code>		'Is there a remaining bit in the Numticks float?
		Local remainder# = FixedRateLogic.NumTicks Mod 1
		DebugLog  "remainder = "+remainder
		If remainder &gt; 0 Then
			FixedRateLogic.SetDelta(remainder)
			If LogicWrapper() = -1 Then Return -1
		EndIf	</pre><br><br>So the logic should still run, but very slowly...<br><br>And his monitor is the Samsung T240 model. <br><br></td></tr></table><br>
<a name="1291919"></a>

<a name="1291921"></a>

<a name="1291922"></a>

<a name="1291923"></a>

<a name="1291924"></a>

<a name="1291925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> He was talking about post #14 (which crashed here too - when running the debug-variant).<br><br><br>@for loop<br>You could replace it with a while and a "ticksToGo"-counter which you decrease. Wend is then on "ticksToGo &lt;= 0"<br><br>For i = 1 to 0<br>'...<br>Next<br>Ist just doing nothing. So the problem might be in your case that "FixedRateLogic.SetDelta(1)" was not called when it reached the code after "next" for the first time (so calling SetDelta(value &lt; 1)).<br><br>What I do not understand is why you do this:<br>1) run FixedRateLogic.SetDelta(1) for every "integer"of your numticks<br>2) run FixedRateLogic.SetDelta(remainder) for the fraction part of numticks<br>So for numticks 2.56 you run 2 times SetDelta(1) and 1 time SetDelta(0.56).<br>Is this correct?<br><br>If so, you just could have one while loop and subtract "1" until the "ticksToGo" is &lt; 0<br><pre class=code>
		DebugLog "FixedRateLogic.NumTicks = "+FixedRateLogic.NumTicks + " " + Floor(FixedRateLogic.NumTicks)

		Local ticksToGo# = FixedRateLogic.NumTicks
		while ticksToGo &gt; 0
			'Min(...) =&gt; use ticksToGo if &lt; 1.0 - or else use 1.0
			FixedRateLogic.SetDelta( Min(1.0, ticksToGo) )
			ticksToGo :- 1
			If LogicWrapper() = -1 Then Return -1
		Wend
</pre><br>Feel free to skip above (especially if you do not like others "reviewing" your code).<br><br><br>@FixedRateLogic.SetDelta() and LogicWrapper()<br>Both do not struggle with the first call to it being with a delta value &lt; 1.0 ?<br><br>Else I cannot see problems in the code you posted, maybe Bobysait has eagle eyes again.<br>As the trace log seems to continue slowly but steadily (like you commented too) the problem should then be somewhere in that SetDelta(&lt;1.0) or LogicWrapper().<br><br>Even more problematic is, that the log continues to grow, so it is not stalled at all (it is just not showing something).<br>If it is not showing something, the problem might be some fader or whatever adjusts visibility (color fader, alphafader, position of the images...)<br><br><br>@monitor<br>So a single-monitor-setup... <br>Do you use Sli/Crossfire (more than 1 gpu simultaneously)? Maybe the dual-gpu-solution creates trouble with some textures and Max2D.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1291966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> He was talking about post #14 (which crashed here too - when running the debug-variant). <br></div><br><br>Ah, fair enough... yeah I see the issue. The game framework does do it differently.<br><br><div class="quote"> What I do not understand is why you do this:<br>1) run FixedRateLogic.SetDelta(1) for every "integer"of your numticks<br>2) run FixedRateLogic.SetDelta(remainder) for the fraction part of numticks<br>So for numticks 2.56 you run 2 times SetDelta(1) and 1 time SetDelta(0.56).<br>Is this correct? <br></div><br><br>Yeah... not my code part of the GAF.<br><br><div class="quote"> Do you use Sli/Crossfire (more than 1 gpu simultaneously)? <br></div><br>Sorry I didnt answer this before - no I dont have SLI/Xfire (never seen the need for it really).<br><br>If I run the test app with the log enabled it does display more logging like: Logic Titlescreen and Draw Titlescreen, which the user doesnt get at all.<br><br>I'm going to do another build and put heaps of tracing in.... <br><br></td></tr></table><br>
<a name="1291998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> @sli/crossfire<br>This was just something to see if that could be an issue (like said I doubt that and am thinking the bug/issue is due to your code/logic).<br><br><br>If neither "Logic" nor "Draw" is output at all - but follow up entries are printed, then this means this screen is never activated / assigned as current - assume your screen works similar to "diddy" (btw: your footer still links to code.google.com instead of github).<br><br>Maybe you should have included such "custom things" in the vgfx-testapp too (as next step).<br><br>Reading your replies sounds, as if you corner the bug/issue :-)<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1292423"></a>

<a name="1292424"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Got a new log from the user:<br><br><pre class=code>13:58:01: Init: NOT UsingSteam
13:58:01: GraphicsCreate - Trying WindowWidth = 1366
13:58:01: GraphicsCreate - Trying WindowHeight = 768
13:58:01: GraphicsCreate - FullScreen = true
13:58:01: GraphicsCreate - WideScreen = true
13:58:01: GraphicsCreate - AspectRatioMode = true
13:58:01: CountGraphicsModes() = 34
13:58:01: Driver = 0
13:58:01: Driver=0 Trying DirectX 9...
13:58:01: DirectXVersion = 9.0c
13:58:01: DebugInt= 113
13:58:01: DesktopRefreshRate = 60
13:58:01: DriverDX9 = 1
13:58:01: Driver = 0
13:58:01: comparison = 1920x1200
13:58:01: comparisonWidth is greater than or equal to WindowWidth
13:58:01: comparisonHeight is greater than or equal to WindowHeight
13:58:01: NOT resExists
13:58:01: TRUE
13:58:01: in comparsion loop...
13:58:01: Window = 1366x768 WideScreen = 1
13:58:01: resExists = 1
13:58:01: resToTest = 3
13:58:01: GraphicsCreate - Final WindowWidth = 1366
13:58:01: GraphicsCreate - Final WindowHeight = 768
13:58:01: GraphicsCreate - Final Widescreen = 1
13:58:01: GraphicsCreate - WideScreenOffSetX = 171.000000
13:58:01: Trying full screen at 1920x1200 32bits...
13:58:42: DoSetVirtualResolution - Start
13:58:42: GetActiveWindowSafe
13:58:42: DX9...
13:58:42: GetActiveWindowSafe
13:58:42: DX9...
13:58:42: SpecialLoad- TLoadingScreen
13:58:42: Init - TLoading Bar
13:58:42: no of steps found in xml resources files: 0
13:58:42: No of images &gt;2
13:58:42: moveBar images&gt;0
13:58:42: finished xml...
13:58:42: mouse pointer
13:58:42: Loading Titlescreen...
13:58:42: MoveBar
13:58:42: Logic - Progress
13:58:42: Setting current screen to loading screen
13:58:42: Entering main loop...
13:58:42: Game.NoTiming = 0
13:58:42: Before repeat
13:58:43: Logic - LoadingScreen
13:58:43: TGameFade - Init
13:59:08: TGameFade - Finish
13:59:08: GameFade - GetDone - DONE!
13:59:08: Loading Titlescreen...
13:59:08: Start Titlescreen...
13:59:08: TGameFade - Init
13:59:32: TerminateFunction
13:59:32: TGameFade - Init
13:59:32: TerminateFunction
13:59:32: TGameFade - Init
13:59:45: TerminateFunction
13:59:45: TGameFade - Init
13:59:46: TerminateFunction
13:59:46: TGameFade - Init
13:59:54: TGameFade - Finish
13:59:54: GameFade - GetDone - DONE!</pre><br><br>Notice the large gap with these lines:<br><pre class=code>13:58:01: Trying full screen at 1920x1200 32bits...
13:58:42: DoSetVirtualResolution - Start</pre><br><br>On my PC it doesnt even take a second...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">		If FullScreen Then
			DebugLog "Trying full screen at " + WindowWidth + "x" + WindowHeight + " 32bits..."
			If GraphicsModeExists(WindowWidth, WindowHeight, 32) Then
				OK = Graphics(WindowWidth, WindowHeight, 32, Hertz)
			EndIf
			'Was 32 bit set OK?
			If OK=Null Then
				DebugLog "Trying full screen at " + WindowWidth + "x" + WindowHeight + " 24bits..."
				If GraphicsModeExists(WindowWidth, WindowHeight, 24) Then
					OK = Graphics (WindowWidth, WindowHeight, 24, Hertz)
				EndIf
				'Was 24 bit set OK?
				If OK=Null Then
					DebugLog "Trying full screen at " + WindowWidth + "x" + WindowHeight + " 16bits..."
					If GraphicsModeExists(WindowWidth, WindowHeight, 16) Then
						OK = Graphics (WindowWidth, WindowHeight, 16, Hertz)
					EndIf
					
					'Was 16 bit set OK?
					If OK = Null Then
						DebugLog "None found, forcing window mode..."
						FullScreen = 0
					EndIf					
				EndIf
			EndIf
			If FullScreen Then
				DoSetVirtualResolution()
			EndIf
		EndIf
</textarea><br><pre class=code>	Method DoSetVirtualResolution()
		DebugLog "DoSetVirtualResolution - Start"
			Local sw:Int
			Local sh:Int
			GetResolution(sw, sh)

</pre><br><br>Hmmm.....<br><br>And the Fade is taking far too long:<br><pre class=code>13:58:43: TGameFade - Init
13:59:08: TGameFade - Finish</pre> <br><br></td></tr></table><br>
<a name="1292472"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bobysait</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>13:58:01: Trying full screen at 1920x1200 32bits...<br>13:58:42: DoSetVirtualResolution - Start<br> <br></div><br>If it changes the desktop resolution ( due to any different value for size, depth or hertz ), it may take time to switch.<br>Maybe your config has identical parameters in fullscreen mode as your desktop, so it switches very fast. <br><br></td></tr></table><br>
<a name="1292530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> it may take time to switch. <br></div><br><br>Maybe, but using OpenGL its nearly instant for the user...<br><br>DirectX9 Log:<br><pre class=code>17:32:12: Driver=0 Trying DirectX 9...
17:32:12: 1 Trying full screen at 1920x1200 32bits... 60Hz
17:32:12: 1 Before Graphics...
17:33:02: 1 OK
17:33:02: Before DoSetVirtualResolution..
17:33:02: DoSetVirtualResolution - Start</pre><br><br>And the OpenGL Log:<br><pre class=code>17:36:54: Driver&lt;&gt;0 Setting OpenGL...
17:36:54: 1 Trying full screen at 1920x1200 32bits... 60Hz
17:36:54: 1 Before Graphics...
17:36:55: 1 OK
17:36:55: Before DoSetVirtualResolution..
17:36:55: DoSetVirtualResolution - Start</pre> <br><br></td></tr></table><br>
<a name="1292566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe there are issues with 2 GPUs being present?<br><br>Someone here using 2 GPUs?<br>Another possibility are "tools" which intercept such calls to optimized things (never used it - just saw these when doing setups for other user's computers).<br><br>@Fade<br>This of course does not explain the long fading-time. I assume there might be multiple issues coming together - with the fading being a logical (aka "in your code") error.<br><br>I asked for the way you use the fader / screen setup - is it done similar to "Diddy" ? Maybe there are potential issues. You are surely splitting "Update" and "Render". Sometimes you do some logical things in "Render" (especially in the frame of the switch from old-to-new-screen).  <br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1292584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, it might be the multiple GPUs which are causing the slowness with the Graphics command.<br><br>I've done a new build which uses Dave's (col) DirectX10/11 Driver and sent that to the user to see if it works any differently.<br><br>Regarding the fade, yeah Diddy's screen framework is similar to GAF - but why would OpenGL work and not DirectX. Also this has worked for thousands of PCs... <br><br></td></tr></table><br>
<a name="1292610"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> New log using the DirectX10/11:<br><br><pre class=code>02:05:49: Driver=0 Trying DirectX 11...
02:05:49: 1 Trying full screen at 1920x1200 32bits... 60Hz
02:05:49: 1 Before Graphics...
02:05:50: 1 OK</pre><br><br>And it works... <br><br></td></tr></table><br>
<a name="1292625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> You mean..and it does show the startscreen?<br><br>Uf so..there is either an issue with the dx9 mod... or a problem with 2*gpu and dx 9 / the dx9 mod.<br><br>Maybe we should ask the same question in a new thread ("dx9 and dual gpu") to attract people having such an setup.<br><br>Maybe Col (who wrote the dx9 wrapper?) has some answers..<br><br><br>Now..if startscreen was working...I think we are more safe to declare the screen-code to do what it's expected to do.<br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1292857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, the startscreen is shown correctly and the amount of time it takes to initialize the graphics is good too:<br><pre class=code>02:05:49: Driver=0 Trying DirectX 11...
02:05:49: 1 Trying full screen at 1920x1200 32bits... 60Hz
02:05:49: 1 Before Graphics...
02:05:50: 1 OK
02:05:50: Before DoSetVirtualResolution..
02:05:50: DoSetVirtualResolution - Start</pre><br><br><div class="quote"> Maybe Col (who wrote the dx9 wrapper?) has some answers.. <br></div><br>I thought Col only wrote the DX10/11 wrapper and that DX9 wrapper was officially from BRL?<br><br><div class="quote"> Now..if startscreen was working...I think we are more safe to declare the screen-code to do what it's expected to do. <br></div><br>Sorry I'm not sure what you mean? <br><br></td></tr></table><br>
<a name="1292867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> I meant: if the "app specific" code is working, then we should no longer search for bugs in there (I mean the screen-logic, the deltatiming...).<br><br>@dx9<br>DStastny was the one <a href="/posts.php?topic=67633" target="_blank">bringing dx9</a> to blitzmax. So sorry Col, no light cone of fame for you this time :-).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1292887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> :D<br><br>Yeah, I can't claim any fame for Dx9. The current Dx9 driver is developed by BRL, and as Derron says DStastny made the original one.<br><br>On topic. Am I right...<br>1. The problem is isolated to 1 user and 1 pc?<br>2. Just one gpu resolution ie 1920x1200?<br>3. Only Dx9?<br><br>I know you going hate me for suggesting this but it does sound like a driver or gpu setting issue local to that pc, maybe the monitor driver even?<br>40 seconds to switch to full screen? Something's clearly not right there somewhere. If nothing is found then it may even be worth raising an issue to AMD/ATI about the specifics? <br><br></td></tr></table><br>
<a name="1292892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am still throwing in "crossfire" as potential fault...it is the only "special" thing popping out.<br><br>Bye<br>Ron <br><br></td></tr></table><br>
<a name="1292893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> It could be that too, I agree.<br>Can that option be turned off or disabled? just for the sake of proving the point? <br><br></td></tr></table><br>
<a name="1292899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> 1. The problem is isolated to 1 user and 1 pc? <br></div><br>I've had two users complaining about similar issues. The user with crossfire has been really helpful.<br><br><div class="quote"> 2. Just one gpu resolution ie 1920x1200? <br></div><br>One GPU? I've never used SLi/Crossfire - so you can set the GPUs to different resolutions? I know if you have multiple monitors you can set those to different resolutions....<br><br><div class="quote"> 3. Only Dx9? <br></div><br>I didnt get him to test DX7. OpenGL works fine.... and DX11 works too ;) <br><br></td></tr></table><br>
<a name="1292901"></a>

<a name="1292902"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ahh ok, do you have any hardware/software information reference the other users pc?<br><br><div class="quote"> 2. Just one gpu resolution ie 1920x1200? <br></div><br>Sorry, re-phrase that to<br>2. Just one resolution ie 1920x1200? <br><br></td></tr></table><br>
<a name="1292903"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry I totally forgot that the other user did inform me of they PC specs:<br><pre class=code>mobo- Asus IV Rampage extreme
cpu- intel core i7 3960X
Graphics- (2) 980 Titan X 12 GB in SLI
windows 7 ultimate 64 bit.</pre><br>So another multi-GPU setup... Never told me his resolution...<br><div class="quote"> Just one resolution ie 1920x1200?  <br></div><br>Yeah, in window mode 1366x768 it works fine. <br><br></td></tr></table><br>
<a name="1292947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> At this stage I agree with Derron that sli is the likely potential candidate.<br><br>Can you ask them to diasble sli just for testing? or would that be a bit much? <br><br></td></tr></table><br>
<a name="1292953"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interestingly the one dual gpu-user has an AMD card, the other one NVIDIA. So it is most likely not an issue of the GPU drivers, but of either DX9 itself or the dx9 module of BlitzMax.<br><br>Maybe we could ask the forum first -- if there is someone out there using dual-gpu and Windows 7 (64bit) without trouble (regarding BlitzMax DX9).<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
