<!DOCTYPE html><html lang="en" ><head ><title >Maths issues from 1.24 to 1.39 :'(</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Maths issues from 1.24 to 1.39 :'(</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Maths issues from 1.24 to 1.39 :'(</a><br><br>
<a name="1041291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> [Solved - Post #10 and #11]<br><br>Hi there! I've been coding in BlitzMax 1.24 because technical issues prevented me from upgrading further (1.26 made my projects glitch hard and 1.30 couldn't support MaxGui no matter how hard I tried)<br><br>I've coded a whole game in Blitzmax 1.24 . It supports a nice replay system that allow you to record yourself so you can watch what you exactly did during your game.<br><br>But now I decided to attempt upgrading again and guess what, i'm up to date with version 1.39 without a problem.<br><br>This is where the true problem arise, however... My replay system means the code have to be run again with the exact same conditions and results each time. This however isn't possible with the following example:<br><br><pre class=code>
value=30

a=4
b=1

value=value-  3*(a-b)^2

Print value
</pre><br><br>Blitzmax 1.39 returns 3. But 1.24 returns 2! <br><br>That's because Blitzmax 1.24 finds 27.000000000000004 for 3*(a-b)^2. the final value end up being slightly lower than 3... and truncated to 2. &gt;_&lt;<br><br>So my question is: Is there a way for to recode this "mistake" in order to resync my replays?<br><br>Thanks for reading. I hope you don't need to reinstall a 1.24 to answer this =(<br><br>I hope I was clear. <br><br></td></tr></table><br>
<a name="1041305"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Floats are not guaranteed to be the same between different computers, ever, so using them to store deterministic replays is a bad idea. You should use ints wherever possible and possibly look into an arbitrary precision maths module for when you must use decimals.<br><br>I hope you are using Strict! <br><br></td></tr></table><br>
<a name="1041307"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's not a game I plan to sell, I just want to make it accessible. I can't sell, anyway, because it's an accurate remake of a copyrighted game. The lead developper told me it was fine to have it available for free.<br><br>If you are curious:<br>Original game:http://www.youtube.com/watch?v=L737X5lbQ04 (actual game recording)<br>My remake:http://www.youtube.com/watch?v=UvgOPuB2q4Y (replay data recording)<br><br>That's the only game i forgot to use strict... But I always do well without that anyway, after all, I started on Blitz Basic when I was 7 years old and it didn't have a such feature.<br><br>---<br>A first version of the game was released two months ago, and everyone who played it are still waiting for an update. It would be wise to build using BMAX 1.39 but I can't because it would make the replays out of sync. :( <br><br></td></tr></table><br>
<a name="1041309"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> why don't you just add the error to the equation:<br><pre class=code>
value=value-  3*((a-b)^2 + 0.000000000000001!)
</pre><br>this should not make a noticeable difference in any computer.<br><br>I don't understand why you would want the error in the replay calculations if there is not in your actual game play calculations. <br><br></td></tr></table><br>
<a name="1041314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Quote: "I don't understand why you would want the error in the replay calculations if there is not in your actual game play calculations."<br><br>^ It's a question of hard logic, i agree : <br>the problem is: the replays are built from thoses errors. If Blitzmax 1.39 doesn't get the errors, then, naturally, it won't end up with the same results, ending up generating a different level. ;)<br><br>^ adding the error :<br>I wish it was a constant error :'( Not only it isn't (the error vary from -0.000000000000005 to +0.000000000000005 and i don't have any clue about what makes it vary. worse: I also need to know weither or not BMax 1.24 can still be correct: you get 2 if you started with 30, but you would still get 33 if you started with 60!!! <br><br></td></tr></table><br>
<a name="1041320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tell your customers that their old replays are not compatible with the new version of the software. <br><br></td></tr></table><br>
<a name="1041326"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Corum</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or consider to embed a silent conversion procedure, in order to keep old replays up to date. ;) <br><br></td></tr></table><br>
<a name="1041329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> guess what, i'm up to date with version 1.39 without a problem <br></div><br><br>...Except the latest version is 1.41. :-? <br><br></td></tr></table><br>
<a name="1041331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The lead developper told me it was fine to have it available for free. <br></div> Is he also a lawyer? You cannot copyright a game mechanic, only a particular implementation of that mechanic (the code) and any artistic works.<br><br>In other words, you can make a game with the exact same game mechanics, but just uses your own original artwork (graphics, music, etc) and storyline.<br><br>If you are using the graphics etc from the original game, then it most certainly isn't fine. Who cares what the lead developer says, it's what the company which owns the copyright thinks that matters. Have they given you formal written permission to use their artwork? If your program can load and use their artwork, but doesn't come bundled with it itself, (ie a player needs to own the original game and then puts your program only into its folder which then loads the artwork already there) then that might be ok. I'm not too sure about that situation.<br><br>On the other hand, if you use your own original artistic content and storyline, go ahead and sell it. Don't let some other guy keep you out of money to reduce the competition.<br><br><a href="http://www.out-law.com/page-7896" target="_blank">http://www.out-law.com/page-7896</a><br><br>Disclaimer: I am not a lawyer and I take no responsibility for any consequences of following the above advice. <br><br></td></tr></table><br>
<a name="1041342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi GC, nice remake btw!<br><br>I suspect your problem is the pow function. I compared blitz_cclib.c with a diff tool (1.24 with 1.40) and it showed only one change (see below). So try copying blitz_cclib.c 1.24 over blitz_cclib.c 1.39 and then from cmd do "bmk makemods -a brl.blitz" and see if that works.<br><br>blitz_cclib.diff<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">--- blitz_cclib124.c	2010-08-12 20:04:16.000000000 +0100
+++ blitz_cclib.c	2010-07-13 03:55:01.000000000 +0100
@@ -28,17 +28,7 @@
 	return x==0 ? 0 : (x&gt;0 ? 1 : -1);
 }
 double bbFloatPow( double x,double y ){
-	double r;
-	static const BBInt64 Nan64=0xfff8000000000000LL;
-	if( x&gt;0 ) return exp( y * log(x) );
-	if( x==0 ){
-		if( y&gt;0 ) return 0;
-		if( y==0 ) return 1;
-		return 1.0/0.0;
-	}
-	if( floor(y)!=ceil(y) ) return *((double*)&amp;Nan64);	
-	r=exp( y * log(-x) );
-	return ((BBInt64)floor(y) &amp; 1) ? -r : r;
+	return pow(x,y);
 }
 double bbFloatMod( double x,double y ){
 	return fmod( x,y );
</textarea> <br><br></td></tr></table><br>
<a name="1041372"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I didn't even realise I could access the pow function from here! I don't want to replace the file with another one that was giving me mistakes though. lol<br><br>Instead I just looked at the function and came up with<br><br><pre class=code>
Function sq124:Double(x)
	If x&gt;0 Return Exp(2*Log(x))
	If x=0 Return 0
	Return Exp(2*Log(-x))
End Function
</pre><br><br>That return x to the power of 2.<br><br>Using it in the code<br><br><pre class=code>
value=30

a=4
b=1

value=value-  3*sq124(a-b)

print value
</pre><br><br>I get 2! yay, never been so much happy to get a wrong result :D<br><br>I tried in the game and I got it working! My most important replay finally successfully replayed until the end without a problem. Thanks you so much!<br><br><br>---------------<br><br><br><div class="quote"> ...Except the latest version is 1.41. :-?  <br></div><br>Almost up to date then...? sorry, i don't check for updates so often :$<br><br>---------------<br><br><div class="quote"> <br>Is he also a lawyer? You cannot copyright a game mechanic, only a particular implementation of that mechanic (the code) and any artistic works.<br><br>In other words, you can make a game with the exact same game mechanics, but just uses your own original artwork (graphics, music, etc) and storyline.<br><br>If you are using the graphics etc from the original game, then it most certainly isn't fine. Who cares what the lead developer says, it's what the company which owns the copyright thinks that matters. Have they given you formal written permission to use their artwork? If your program can load and use their artwork, but doesn't come bundled with it itself, (ie a player needs to own the original game and then puts your program only into its folder which then loads the artwork already there) then that might be ok. I'm not too sure about that situation.<br> <br></div><br><br>I know what's i'm doing.<br><br><div class="quote"> <br>On the other hand, if you use your own original artistic content and storyline, go ahead and sell it. Don't let some other guy keep you out of money to reduce the competition.<br> <br></div><br><br>I have no artistic skill, and severely lack imaginative skills. I'm also inefficient at teamworking, so basically, I work alone, spend thousands of hours alone in my projects with absolutly no aim to make any profit out of it. It's called passion. :P <br><br></td></tr></table><br>
<a name="1041385"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Combine passion with profit and there's no going back :) <br><br></td></tr></table><br>
<a name="1041434"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzProg</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> If only it was that easy X_X 90% of my creations are private personnal remakes I banned from public releases because it was containing copyrighted content.<br><br>the other 10% was released quietly with audio i didn't own as free download to a few internet friends. <br><br>Basically this game is the only exeption because it's way more popular than anything I created. <br><br></td></tr></table><br>
<a name="1041513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Make or hire someone to make new graphics for them and then release your remakes :D <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
