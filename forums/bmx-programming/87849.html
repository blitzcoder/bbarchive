<!DOCTYPE html><html lang="en" ><head ><title >Virtual resolution BMax1.35 and aspect ratio ?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Virtual resolution BMax1.35 and aspect ratio ?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Virtual resolution BMax1.35 and aspect ratio ?</a><br><br>
<a name="996579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>Since I don't want to be too off-topic I create this one so I can post 2 pictures and ask a question.<br><br>In this picture you can see both virtual resolution and real resolution of 1024x768.<br>This is exactly how it should appear :<br><img src="http://img19.imageshack.us/img19/7337/metagolf000.png"><br><br>Now I stick to a virtual resolution of 1024x768 but rendering my game in 640x480 :<br><img src="http://img25.imageshack.us/img25/6456/metagolf002.png"><br><br>You can see that black borders of every 'camera' viewport are shifted by 1 or 2 pixels but also some of my tiles are now rendered with gap (look at the grass floating in the middle tiny screen). I suppose it's due to the resolution reduction, viewport cannot precisely draw itself at the exact desired position/size and draw functions are affected in some way.<br><br>This also happen while I try higher virtual resolution :-(<br><br>Do the currently missing aspect ratio for virtual resolution has something to do with that or is there something I can do ?<br>I could eventually only allow 640x480, 800x600 ,1024x768 and 1280x1024 resolution for the missing ratio but the above problem will persist...<br>Any help ?<br><br>Thanks <br><br></td></tr></table><br>
<a name="996698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds bit like what Grey Alien and ImaginaryHuman was talking about in this post:<br><br><a href="http://blitzmax.com/Community/posts.php?topic=84098" target="_blank">http://blitzmax.com/Community/posts.php?topic=84098</a> <br><br></td></tr></table><br>
<a name="996738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the link Therevills.<br>I have roughly read the whole thread.<br>Does appear to have connection with this problem although I still need to consider the proposed solutions (seems hardly feasible at this stage).<br>I need to dig this out. <br><br></td></tr></table><br>
<a name="996771"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If the virtual resolution is adjusting the projection matrix, then the only change is in the calculation that converts game-world coordinates into window coordinates. If you are rendering to integer pixel coordinates, maybe this translation causes some rounding errors that result in the gaps? <br><br></td></tr></table><br>
<a name="997116"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>I'm using float values everywhere but it's definitely caused by rounding errors.<br><br>In fact the viewport is in pixel coordinates and cannot be correctly rounded.<br>I try to move camera with the mouse and it appear to render correctly on certain position (no more gap).<br><br>Depend on the size of that viewport (eg 320x240) the last Y and X pixel is invisible too (no black border for the same reasons).<br><br>I "simply" need to round my camera size and find the correct position to avoid that bug.<br>Hope it won't be a problem at higher resolution or ugly somewhere. <br><br></td></tr></table><br>
<a name="997137"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The viewport is defined with whole integer coordinates, because it's `window coordinates`, not game coordinates. The window is made of whole pixels. <br><br></td></tr></table><br>
<a name="997163"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I still need to understand the magic numbers behind this because :<br><br>Virtual Resolution <b>1024x768</b><br>Real Resolution <b>640x480</b><br><br>For a nearest viewport of <b>320 x 240</b> correctly rendered in cender of the screen I need to :<br>Resize viewport to <b>317</b> x <b>237</b><br>Position it to X:<b>349.0</b>, Y:<b>261.0</b><br><br>Any ~8 pixels size and/or position around will corrupt my rendering scene.<br><br>My scale ratio is <b>1.6</b> (Virtual Resolution / Real Resolution) so those numbers are a bit strange.<br><br>I need to understand this because if I set a real resolution of 800x600 then those numbers aren't correct anymore and gap appears again :-(<br>I need to add something in relation with the <b>1.6 ratio</b> somewhere in my camera code but what... <br><br></td></tr></table><br>
<a name="997184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I notice that:<br><br>1024/320 = 3.2<br>768/240=3.2<br><br>And I notice that 317 is 320-3 (approx), and 237 is 240-3, approx.<br><br>Is that the math you need? ie X=320-(VirtualWidth/ViewportWidth), and Y=240-(VirtualHeight/VirewportHeight)?<br><br>I've no idea if that works out at other resolutions, I Just noticed that you have a difference of about 3 pixels. <br><br></td></tr></table><br>
<a name="997226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since position (0,0) is always the same at any resolution I use that coordinates to find a correct viewport size.<br>Unfortunately with the above solution I still miss 1 vertical and 1 horizontal line of pixels.<br><br>One truly compatible size in every common resolution is <b>(0,0,250,141)</b><br><br>but virtual resolution of 1024x768 to real resolution of <b>640x480</b> (ratio <b>1.6</b>) <b>800x600</b> (ratio <b>1.28</b>) and <b>1280x1024</b> (ratio <b>0.8</b>) give :<br><br>250/<b>1.6</b>=156.25<br>250/<b>1.25</b>=195.3125<br>250/<b>0.8</b>=312.5<br><br>141/<b>1.6</b>=88.125<br>141/<b>1.25</b>=112.8<br>141/<b>0.8</b>=176.25<br><br>It's non-sense to me.<br>Maybe I am not taking the problem correctly ... <br><br></td></tr></table><br>
<a name="997237"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wrote a little program that nearly reproduce that problem : <a href="http://blitzmax.com/Community/posts.php?topic=87819#997236" target="_blank">http://blitzmax.com/Community/posts.php?topic=87819#997236</a><br><br><b>250x141</b> are useless values since only working at (0,0) and nowhere else.<br><br>True headache :-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
