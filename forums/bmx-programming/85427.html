<!DOCTYPE html><html lang="en" ><head ><title >chiken invader beam</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >chiken invader beam</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >chiken invader beam</a><br><br>
<a name="966336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://games-mix.com/chicken-invaders-3-christmas-edition/screenshot-2.jpg"><br><br>hi !<br>i need some ideas to code a laser beam like this one ! Animstrip or just plain code ? Hope it's easy to code with bmax ! <br><br></td></tr></table><br>
<a name="966340"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very easy. Anim strips with a few frames of animation. Calculate the center point between start and destination, rotate, scale, wala...instant lightning bolt.<br><br>Granted you could also use sprite "segments" that look light jointed sections of the lightning bolt, but that takes more sprites, more code, etc. I would just use the anim strip rotated, scaled, etc. <br><br>Using the xscale, yscale parameters you could also mirror the bolts in real time too for diversity. ;) <br><br></td></tr></table><br>
<a name="966344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just done this myself.  I have two points - a start, and an end.  I also have some lightning images which are loaded as Pixmaps.<br><br>After I determine the distance between point A and point B, I use LoadImage/PixmapWindow to grab three random sections of pixmap of the right size.<br><br>To draw them, I use ATan2 to figure out the correct angle between the two points, then simply draw the image (one of the three grabbed images, picked at random).  Finally I use a lightblended soft 'glow' effect to hide the joints, where needed.<br><br>The result is this:<br><img src="http://gfk.syntaxbomb.com/mv/mvparty.jpg"><br>(BTW: That pic is scaled to 200% of its original size, but I can't remember why) <br><br></td></tr></table><br>
<a name="966350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ked</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> (BTW: That pic is scaled to 200% of its original size, but I can't remember why) <br></div><br>I think you want it to be kept a surprise until your project is released.<br><div class="quote"> here's a cryptic image from one of the nine minigames/bonus levels <br></div><br>That is a pure guess though, because I have no idea what you mean by a "cryptic image." <br><br></td></tr></table><br>
<a name="966355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I think you want it to be kept a surprise until your project is released. <br></div>Ah yeah, that's right.  I just found the pic on my webspace and forgot why it was there. :) <br><br></td></tr></table><br>
<a name="966402"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks !<br><br>@gfk : So you don't scale the image. Very interesting this pixmapwindow function. Into my game i use a lot of 'images' against pixmaps. As i consider pixmaps operations and display are slow...<br><br>could you explain more how you did your lighting image ? (size, graphics software used, ...).<br><br>Perhaps you could post some samples or pseudo code to help me to start with this : 'I use LoadImage/PixmapWindow to grab three random sections of pixmap of the right size' ? i've always some difficulties to correctly use pixmap functions ! <br><br></td></tr></table><br>
<a name="966435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> As i consider pixmaps operations and display are slow... <br></div>They are slow, but they're there to be used.  You can get away with sensibly sized pixmap operations on the fly, provided you don't overdo it, and only use pixmap manipulation where its absolutely necessary.<br><br>This tutorial should get you going in the right direction: <a href="http://www.photoshopcafe.com/tutorials/lightning/lightning.htm" target="_blank">http://www.photoshopcafe.com/tutorials/lightning/lightning.htm</a><br><br>In the end, I drew mine by hand.  Basically a zig-zag line with an outer glow effect in PS, and a couple of thinner, feint zig-zag lines behind it.<br><br>I have a pool of three 800x32 pixmaps containing lightning.  Could use less, or more, depending on your needs.  I wanted my lightning to look very random and non-repetitive.<br><br>What you will basically do is keep these pixmaps in memory all the time, as PixmapWindow only returns a reference to the existing pixmap - it doesn't copy it.<br><br>Code:<br><pre class=code>lightning:TPixmap = LoadPixmap("800x32lightning.png")</pre><br>...then...<br><pre class=code>myImage:TImage = LoadImage(PixmapWindow(lightning,x,0,width,32))</pre><br>...and finally...<br><pre class=code>SetImageHandle myImage,0,16 'put the image handle at the left edge of the resulting image, and half way down</pre><br><br>That last step is very important.  Once you know the start and end points of the lightning bolt, and have determined the angle between the two points with ATan2(), all you need to do is use SetRotation with that angle, and draw the image at the start point.  It will automatically align to point towards the end point.<br><br>A final note - you *could* use a fixed lightning image and stretch/squash it.  But I've seen it done this way before and it generally looks very poor with longer or shorter lightning bolts that are too far away from the bolt's original size.  I'd only use that method if I was very concerned about video RAM usage and wasn't bothered about it looking a bit rubbish. <br><br></td></tr></table><br>
<a name="966441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks gfk for these explanations ! <br><br></td></tr></table><br>
<a name="966511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here my first try :<br><br><a href="http://www.zigwigwis.com/david/test_ligne1.png" target="_blank">Download the image file here</a><br><br><pre class=code>

Strict

Global start_x, width
Global x1, y1, x2, y2:Float

Global lightning:TPixmap = LoadPixmap("test_ligne1.png")


Graphics 800, 600


x1 = GraphicsWidth() / 2
y1 = GraphicsHeight() / 2


While Not KeyDown (KEY_ESCAPE)

	x2 = MouseX()
	y2 = MouseY()
	  
	Cls
	SetColor 255, 0, 0
	DrawOval x1 - 3, y1 - 3, 6, 6
	DrawOval x2 - 3, y2 - 3, 6, 6
	SetColor 255, 255, 255

	If MouseDown(1) Then
	
			Local myImage:TImage 
		 	Local Angle
			
			Angle = ATan2 ((y2 - y1), (x2 - x1))
			width = Sqr ((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1))
			If width &gt; PixmapWidth(lightning) Then
				width = PixmapWidth(lightning)
			End If
			start_x = Rand (0, PixmapWidth (lightning) - width)
			myImage = LoadImage(PixmapWindow(lightning, start_x, 0, width, 32))
		 	SetImageHandle myImage, 0, 16
			
			SetRotation Angle
			SetBlend ALPHABLEND
			DrawImage myImage, x1, y1
			SetBlend LIGHTBLEND
			DrawImage myImage, x1, y1
			SetRotation 0.0
			myImage = Null
	Else
	
		DrawLine x1, y1, x2, y2
		
	End If
		
	Flip

Wend
</pre> <br><br></td></tr></table><br>
<a name="966528"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Easy when you know how. :)<br><br>A note of caution though - you'll need to ensure that the size of the image you're trying to grab from the pixmap, doesn't exceed the size of the pixmap itself.  With the code above, move X1,Y1 to 0,0, and click on the bottom-right corner of the screen - you'll get a pixmap out of bounds error. <br><br></td></tr></table><br>
<a name="966554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TommyH</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that great explanation and sample, GfK and hub!<br><br>I always wondered how to do that in a simple way.<br><br>Should be added to the code archive ;-) <br><br></td></tr></table><br>
<a name="966639"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> i've updated the sample code and produce a new gfx file more interesting to show the effect. <br><br></td></tr></table><br>
<a name="966648"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> note that it should be a good thing to find a way to replace the sqr call inside the previous code (sqr function is slow) <br><br></td></tr></table><br>
<a name="966650"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the code example hub :)<br><br>You could use a look up table to speed up sqr:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

Global start_x:Int, width:Int
Global x1:Int, y1:Int, x2:Int, y2:Float

Global lightning:TPixmap = LoadPixmap("test_ligne1.png")


Graphics 800, 600

x1 = GraphicsWidth() / 2
y1 = GraphicsHeight() / 2

'sqr look up table
Local sqr_look_up:Float[3000001]
For Local i:Int = 0 To 3000000
	sqr_look_up[i] = Sqr(i)
Next


While Not KeyDown (KEY_ESCAPE)

	x2 = MouseX()
	y2 = MouseY()
	  
	Cls
	SetColor 255, 0, 0
	DrawOval x1 - 3, y1 - 3, 6, 6
	DrawOval x2 - 3, y2 - 3, 6, 6
	SetColor 255, 255, 255

	If MouseDown(1) Then
	
			Local myImage:TImage 
		 	Local Angle:Int
			
			Angle = ATan2 ((y2 - y1), (x2 - x1))
			width = sqr_look_up[((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1))]
			If width &gt; PixmapWidth(lightning) Then
				width = PixmapWidth(lightning)
			End If
			start_x = Rand (0, PixmapWidth (lightning) - width)
			myImage = LoadImage(PixmapWindow(lightning, start_x, 0, width, 32))
		 	SetImageHandle myImage, 0, 16
			
			SetRotation Angle
			SetBlend ALPHABLEND
			DrawImage myImage, x1, y1
			SetBlend LIGHTBLEND
			DrawImage myImage, x1, y1
			SetRotation 0.0
			myImage = Null
	Else

		DrawLine x1, y1, x2, y2
		
	End If

	Flip

Wend

</textarea> <br><br></td></tr></table><br>
<a name="966668"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hub</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good idea therevills ! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
