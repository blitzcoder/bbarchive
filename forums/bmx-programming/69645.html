<!DOCTYPE html><html lang="en" ><head ><title >Leadwerks Engine BlitzxMax module - test 2</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Leadwerks Engine BlitzxMax module - test 2</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Leadwerks Engine BlitzxMax module - test 2</a><br><br>
<a name="779333"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is the second BlitzMax module test.  The engine has been completely rewritten over the last two weeks.<br><br><a href="http://www.leadwerks.com/ccount/click.php?id=44" target="_blank">http://www.leadwerks.com/ccount/click.php?id=44</a> (5.43 mb)<br><br>Features include:<br>-Super-fast rendering with mesh instancing can handle 1,000,000+ polygons.<br>-Blitz3D-like command set, including mesh and surface contruction commands.<br>-Dynamic lights, projectors, and shadows.<br>-Z-sorting for transparent objects.<br>-Fast terrain decorations for grass, rocks, etc., can handle tens of thousands of instances.<br>-Complete command set for rigid bodies, joints, and ropes.<br>-Easy-to-use command set for creating vehicles with arbitrary number of wheels.<br>-Load DDS compressed textures (more than ten times faster than loading textures from image formats).<br>-Store media in package files (.zip or .pk3).<br>-Extendable particle emitter entity.<br>-Built-in corona entity for light halos.<br>-Extendable mesh loader type to add support for more file formats.<br><br><img src="http://www.leadwerks.com/post/bmx2-1.jpg"><br><br><img src="http://www.leadwerks.com/post/bmx2-2.jpg"><br><br><img src="http://www.leadwerks.com/post/bmx2-3.png"> <br><br></td></tr></table><br>
<a name="779338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> downloading now!!!<br><br>[edit]<br>Marvellous!<br><br>Can you explain 'better' how culling works in your examples? Sometime 'pieces' of world disappears without a logic reason. There's culling - portal zone hidden in the world?<br><br>Great job...any ETA for the final version? <br><br></td></tr></table><br>
<a name="779346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking great. Very exciting stuff going on here! <br><br></td></tr></table><br>
<a name="779347"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's currently a bug whereby particle emitters get overculled.  Did you notice anything else?<br><br>Culling works by frustum culling, occluders, and portalzones.  Occluders and Portalzones are not demonstrated in this package, but I will have more info on them later.<br><br>Portal and occlusion culling honestly aren't that important, because under most circumstances it is fastest just to chuck everything in the frustum at the graphics card, especially on newer cards.  You have to use portals carefully, because they will only make a big difference in certain conditions.<br><br>This is pretty near-final.  It's definitely usable, and there is a lot more functionality I didn't take the time to make examples for.  You can write a lightmapper, for example, or add your own a skeletal animation system, or write a .b3d loader.  If it's in the documentation, it works.<br><br>Of course I have more features I intend to add like shaders and a built-in animation system, but there's no reason you can't get started now.  The demo module times out after 60 seconds, so just order Leadwerks Engine from my site and you'll get the unrestricted module. <br><br></td></tr></table><br>
<a name="779353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mongia2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks!!!! <br><br></td></tr></table><br>
<a name="779357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks great, does the blitz like commands work exactly the same as blitz3d ie turnentity, rotateentity, deltayaw, tformvector etc?<br>Those commands are priceless to me and i would definitely buy this if they work the same as in blitz3d. <br><br></td></tr></table><br>
<a name="779359"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, I originally wrote the positioning commands by trying to duplicate the results Blitz3D gave.  That was probably the hardest part of this whole process.  There is currently a problem with scaling parented entities...the results might not come out right if you scale an entity and then parent it.  But other than that, everything works perfectly.<br><br>The engine uses quaternion rotations, so you can smoothly interpolate rotations.  Animation is not presently supported, but when I do add it, animations will appear correctly because it is using quaternions.<br><br>Take a look at this demo.  It shows some pretty complex transformations in action:<br>www.leadwerks.com/post/quat.zip <br><br></td></tr></table><br>
<a name="779374"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LarsG</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> is this going cross-platform, Leadwerks? <br><br></td></tr></table><br>
<a name="779376"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mongia2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> in you demo test 1<br><br>i write entitycolor mesh,255,0,255,0<br><br>but mesh is  a grey!<br><br>thanks for addition quad! <br><br></td></tr></table><br>
<a name="779380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> My engine relies more on the materials system rather than the Blitz3D surface/brush convention.  EntityColor only has an effect on certain entities like lights or projectors.  Because objects are rendered in batches (and in the case of bspbrushes, collapsed) it doesn't make sense to allow a color per object.  Coloring objects would be a simple way to control visuals, but it doesn't jive well with the lighting I have implemented, and even less so with shaders.<br><br>Likewise, you only use vertex colors in my engine for static mesh lighting.  The Blitz3D approach was almost a wrapper for DirectX settings, and it didn't handle things like lighting very well.  I've taken steps so that you don't have to write your own lighting and other systems, but it may require you to get used to a slightly different approach than Blitz3D. <br><br></td></tr></table><br>
<a name="779383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Knotz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does it load b3d files, or have I to write my own loader? <br><br></td></tr></table><br>
<a name="779385"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Doesn't load .b3d files ATM.  I think I have some old Blitz3D code to manually load .b3d files, so if I can find it I will plug it in. <br><br></td></tr></table><br>
<a name="779395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds better all the time, i hope the speed of the animations can be changed while they're running, unlike blitz where you have to do them all with updateworld and not each individual animation. <br><br></td></tr></table><br>
<a name="779424"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AdrianT</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, this is pretty good :), you've come a long way in the last couple of years. <br><br></td></tr></table><br>
<a name="779427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks good. <br><br></td></tr></table><br>
<a name="779432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I created a .b3d mesh loader.  It doesn't handle materials yet, but this shows how you can add support for additional formats.  Most of this is Mark's original .b3d parser code.  Just put this in the engine directory and run it.  Change the name of the .b3d file to load, since I didn't include the jeep b3d in the package.<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Framework leadwerks.engine

AppTitle=StripAll(AppFile)
SetGraphicsDriver GLGraphicsDriver()
Graphics 1024,768,0,60,2

'A world must be created or loaded before you do anything:
CreateWorld()

'Create a mesh:
mesh:TMesh=LoadMesh("meshes\vehicles\jeep.b3d")

'Create a camera
camera:TCamera=CreateCamera()
CameraClsColor camera,0,0,255
MoveEntity camera,0,0,-400

'Create a light
light:TLight=CreateLight()
RotateEntity light,45,45,0

'Main loop
While Not KeyHit(KEY_ESCAPE)
	
	TurnEntity mesh,0,AppSpeed(),0

	UpdateWorld()
	RenderWorld()

	GLDrawText "UPS: "+UPS(),0,0
	GLDrawText TrisRendered()+" triangles",0,20

	Flip False	
Wend
End

'==========================================================
'B3D Mesh loader class
'
'To create a new mesh loader, declare the type, 
'indicate the supported file extensions, and write the Load() method.
'You can then use the standard LoadMesh() command to load the file format.
'
'==========================================================
Type B3DMeshLoader Extends TMeshLoader
	Global loader:TMeshLoader=New B3DMeshLoader
	
	Method New()
		extensions.addlast "b3d"
	EndMethod
	
	Method Load:TMesh(stream:TStream)
		b3dSetFile(stream)
		If b3dReadChunk$()&lt;&gt;"BB3D"
			DebugLog "Invalid b3d file."
			Return Null
		EndIf
		If b3dReadInt()/100&gt;0
			DebugLog "Invalid b3d file version."
			Return Null
		EndIf
		root:TMesh=ReadChunks()
		b3dExitChunk()
		Return root
	EndMethod
	
	Function ReadChunks:TMesh( tab$="" )
		
		Global entity:TEntity
		Global root:TMesh
		Global vertexlist#[,]
		Global normallist#[,]
		Global texcoordList#[,,]
		Global colorList#[,]
		
		Global x_pos#
		Global y_pos#
		Global z_pos#
		Global x_scl#
		Global y_scl#
		Global z_scl#
		Global w_rot#
		Global x_rot#
		Global y_rot#
		Global z_rot#
		
		tt$=tab$
		tab$=tab$+"  "
		While b3dChunkSize()
			chunk$=b3dReadChunk$()
			DebugLog tt$+"Chunk:"+chunk$+" (size="+b3dChunkSize()+")"
			Select chunk$
			Rem
			Case "ANIM"
				flags=b3dReadInt()
				n_frames=b3dReadInt()
				fps=b3dReadFloat()
				DebugLog tab$+flags+" "+n_frames+" "+fps
			EndRem
			Rem	
			Case "KEYS"
				flags=b3dReadInt()
				sz=4
				If flags And 1 sz=sz+12
				If flags And 2 sz=sz+12
				If flags And 4 sz=sz+16
				n_keys=b3dChunkSize()/sz
				If n_keys*sz=b3dChunkSize() 
					DebugLog tab$+n_keys+" keys"
					'read all keys in chunk
					While b3dChunkSize()
						frame=b3dReadInt()
						If flags And 1
							key_px#=b3dReadFloat()
							key_py#=b3dReadFloat()
							key_pz#=b3dReadFloat()
						EndIf
						If flags And 2
							key_sx#=b3dReadFloat()
							key_sy#=b3dReadFloat()
							key_sz#=b3dReadFloat()
						EndIf
						If flags And 4
							key_rw#=b3dReadFloat()
							key_rx#=b3dReadFloat()
							key_ry#=b3dReadFloat()
							key_rz#=b3dReadFloat()
						EndIf
					Wend
				Else
					DebugLog tab$+"***** Illegal number of keys *****"
				EndIf
			EndRem
			Case "TEXS"
				While b3dChunkSize()
					name$=b3dReadString$()
					flags=b3dReadInt()
					blend=b3dReadInt()
					x_pos#=b3dReadFloat()
					y_pos#=b3dReadFloat()
					x_scl#=b3dReadFloat()
					y_scl#=b3dReadFloat()
					rot#=b3dReadFloat()
					DebugLog tab$+name$
				Wend
				'ReadChunks( tab$ )	'dump any subchunks
			Case "BRUS"
				n_texs=b3dReadInt()
				'read all brushes in chunk...
				While b3dChunkSize()
					name$=b3dReadString$()
					r#=b3dReadFloat()
					g#=b3dReadFloat()
					b#=b3dReadFloat()
					alp#=b3dReadFloat()
					shi#=b3dReadFloat()
					blend=b3dReadInt()
					fx=b3dReadInt()
					For k=0 To n_texs-1
						tex_id=b3dReadInt()
					Next
					DebugLog tab$+name$
				Wend
				'ReadChunks( tab$ )	'dump any subchunks
			Case "VRTS"
				flags=b3dReadInt()
				tc_sets=b3dReadInt()
				tc_size=b3dReadInt()
				sz=12+tc_sets*tc_size*4
				If (1 &amp; flags) sz=sz+12
				If (2 &amp; flags) sz=sz+16

				n_verts=b3dChunkSize()/sz
	
				Local verts#[n_verts,3]
				vertexlist=verts
				Local norms#[n_verts,3]
				normallist=norms
				tsize=tc_size
				If tsize&lt;2 tsize=2
				tsets=tc_sets
				If tsets&lt;2 tsets=2
				Local texcoords#[n_verts,tsize,tsets]
				texcoordList=texcoords
				
				If n_verts*sz=b3dChunkSize()
				
					DebugLog tab$+n_verts+" vertices"
					'read all verts in chunk
					n=0
					While b3dChunkSize()&gt;0
						x#=b3dReadFloat()
						y#=b3dReadFloat()
						z#=b3dReadFloat()
						
						vertexlist[n,0]=x
						vertexlist[n,1]=y
						vertexlist[n,2]=z
						DebugLog x+", "+y+", "+z
						
						If (1 &amp; flags)
							nx#=b3dReadFloat()
							ny#=b3dReadFloat()
							nz#=b3dReadFloat()
							normallist[n,0]=nx
							normallist[n,1]=ny
							normallist[n,2]=nz
						EndIf
						If (2 &amp; flags)
							r#=b3dReadFloat()
							g#=b3dReadFloat()
							b#=b3dReadFloat()
							lfa#=b3dReadFloat()
						EndIf
						'read tex coords...
						For set=0 To tc_sets-1
							For coord=0 To tc_size-1
								texcoordList[n,coord,set]=b3dReadFloat()
							Next
						Next
						n:+1
					Wend
				Else
					DebugLog tab$+"***** Illegal number of vertices *****"
				EndIf
				'ReadChunks( tab$ )	'dump any subchunks
			Case "TRIS"
				brush_id=b3dReadInt()
				sz=12
				n_tris=b3dChunkSize()/sz

				If n_tris*sz=b3dChunkSize()
					'DebugLog tab$+n_tris+" triangles"
					'read all tris in chunk
					n=0
					
					surf:TSurface=CreateSurface(TMesh(entity))
					
					While b3dChunkSize()
						v0=b3dReadInt()
						v1=b3dReadInt()
						v2=b3dReadInt()
						
						DebugLog v0+", "+v1+", "+v2
						x0#=vertexlist[v0,0]
						y0#=vertexlist[v0,1]
						z0#=vertexlist[v0,2]
						x1#=vertexlist[v1,0]
						y1#=vertexlist[v1,1]
						z1#=vertexlist[v1,2]
						x2#=vertexlist[v2,0]
						y2#=vertexlist[v2,1]
						z2#=vertexlist[v2,2]
						nx0#=normallist[v0,0]
						ny0#=normallist[v0,1]
						nz0#=normallist[v0,2]
						nx1#=normallist[v1,0]
						ny1#=normallist[v1,1]
						nz1#=normallist[v1,2]
						nx2#=normallist[v2,0]
						ny2#=normallist[v2,1]
						nz2#=normallist[v2,2]
						u00#=texcoordlist[v0,0,0]
						v00#=texcoordlist[v0,1,0]
						u01#=texcoordlist[v0,0,1]
						v01#=texcoordlist[v0,1,1]
						u10#=texcoordlist[v1,0,0]
						v10#=texcoordlist[v1,1,0]
						u11#=texcoordlist[v1,0,1]
						v11#=texcoordlist[v1,1,1]
						u20#=texcoordlist[v2,0,0]
						v20#=texcoordlist[v2,1,0]
						u21#=texcoordlist[v2,0,1]
						v21#=texcoordlist[v2,1,1]
						v0=surf.findvertex(x0,y0,z0,nx0,ny0,nz0,u00,v00,u01,v01)
						v1=surf.findvertex(x1,y1,z1,nx1,ny1,nz1,u10,v10,u11,v11)
						v2=surf.findvertex(x2,y2,z2,nx2,ny2,nz2,u20,v20,u21,v21)
						surf.addtriangle(v0,v1,v2,True)
						
						'indicelist[n,0]=v0
						'indicelist[n,1]=v1
						'indicelist[n,2]=v2
						
						n:+1
					Wend
				Else
					DebugLog tab$+"***** Illegal number of triangles *****"
				EndIf
				'ReadChunks( tab$ )	'dump any subchunks
				
			Case "MESH"
				brush_id=b3dReadInt()
				
				entity=CreateMesh(entity)
				SetEntityProperty entity,"name",name$
				PositionEntity entity,x_pos,y_pos,z_pos
				ScaleEntity entity,x_scl,y_scl,z_scl
				EntityQuaternion entity,x_rot,y_rot,z_rot,w_rot
				reverttoparent=True
				
				'DebugLog tab$+"brush="+brush_id
			Rem
			Case "BONE"
				sz=8
				n_weights=b3dChunkSize()/sz
				If n_weights*sz=b3dChunkSize()
					DebugLog tab$+n_weights+" weights"
					'read all weights
					While b3dChunkSize()
						vertex_id=b3dReadInt()
						weight#=b3dReadFloat()
					Wend
				Else
					DebugLog tab$+"***** Illegal number of bone weights *****"
				EndIf
			EndRem
				ReadChunks( tab$ )	'dump any subchunks
			
			Case "NODE"
				name$=b3dReadString$()
				x_pos#=b3dReadFloat()
				y_pos#=b3dReadFloat()
				z_pos#=b3dReadFloat()
				x_scl#=b3dReadFloat()
				y_scl#=b3dReadFloat()
				z_scl#=b3dReadFloat()
				w_rot#=b3dReadFloat()
				x_rot#=b3dReadFloat()
				y_rot#=b3dReadFloat()
				z_rot#=b3dReadFloat()
				'DebugLog tab$+"name="+name$
				
				ReadChunks( tab$ )	'dump any subchunks
							
			EndSelect
			
			b3dExitChunk()		'Exit this chunk
			If root:TMesh=Null root=TMesh(entity)
			If reverttoparent
				If entity entity=entity.parent
			EndIf
		Wend
		Return root
	EndFunction
	
	'
	'b3d file utils To be included
	'
	Global b3d_stack[100]
	Global b3d_file:TStream,b3d_tos
	
	Function b3dSetFile( file:TStream )
		b3d_tos=0
		b3d_file=file
	End Function
	
	'***** functions For reading from B3D files *****
	
	Function b3dReadByte()
		Return ReadByte( b3d_file )
	End Function
	
	Function b3dReadInt()
		Return ReadInt( b3d_file )
	End Function
	
	Function b3dReadFloat#()
		Return ReadFloat( b3d_file )
	End Function
	
	Function b3dReadString$()
		Repeat
			ch=b3dReadByte()
			If ch=0 Return t$
			t$=t$+Chr$(ch)
		Forever
	End Function
	
	Function b3dReadChunk$()
		For k=1 To 4
			tag$=tag$+Chr$(b3dReadByte())
		Next
		sz=ReadInt( b3d_file )
		b3d_tos=b3d_tos+1
		b3d_stack[b3d_tos]=StreamPos( b3d_file )+sz
		Return tag$
	End Function
	
	Function b3dExitChunk()
		SeekStream b3d_file,b3d_stack[b3d_tos]
		b3d_tos=b3d_tos-1
	End Function
	
	Function b3dChunkSize()
		Return b3d_stack[b3d_tos]-StreamPos( b3d_file )
	End Function
	
	'***** Functions For writing To B3D files *****
	
	Function b3dWriteByte( n )
		WriteByte( b3d_file,n )
	End Function
	
	Function b3dWriteInt( n )
		WriteInt( b3d_file,n )
	End Function
	
	Function b3dWriteFloat( n# )
		WriteFloat( b3d_file,n )
	End Function
	
	Function b3dWriteString( t$ )
		For k=1 To Len( t$ )
			ch=Asc(Mid$(t$,k,1))
			b3dWriteByte(ch)
			If ch=0 Return
		Next
		b3dWriteByte( 0 )
	End Function
	
	Function b3dBeginChunk( tag$ )
		b3d_tos=b3d_tos+1
		For k=1 To 4
			b3dWriteByte(Asc(Mid$( tag$,k,1 )))
		Next
		b3dWriteInt( 0 )
		b3d_stack[b3d_tos]=StreamPos( b3d_file )
	End Function
	
	Function b3dEndChunk()
		n=StreamPos( b3d_file )
		SeekStream b3d_file,b3d_stack[b3d_tos]-4
		b3dWriteInt( n-b3d_stack[b3d_tos] )
		SeekStream b3d_file,n
		b3d_tos=b3d_tos-1
	End Function

EndType</textarea> <br><br></td></tr></table><br>
<a name="779513"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just spent a lot of time going back and forth between 3ds max, Blitz3D, and my engine.  I forgot that .b3d files use a nonstandard quaternion.  My rotation code was working fine, but I had to convert the b3d quaternions to standard ones. <br><br></td></tr></table><br>
<a name="779517"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Silly questions:<br>1. Is there somewhere a help/list of command supported? I've downloaded the SDK, but some commands are non recognized - I though there were 'differences' between the two product (SDK and Engine Module), but I tried. [edit]After crawling in you forum I found this <a href="http://www.leadwerks.com/files/ProgrammingGuide.chm" target="_blank">http://www.leadwerks.com/files/ProgrammingGuide.chm</a> I suppose THIS is the right help guide, right? But I think it still miss something...<br>2. I see the game supports shadows (shadow map I suppose) for the moving-object (car, crate &amp; so on...). In future will there be other shadow type (as volume shadow) or the implementation is left to the programmer?<br><br>Thanks <br><br></td></tr></table><br>
<a name="779531"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CodeGit</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I really like the way this is heading. Nice :) <br><br></td></tr></table><br>
<a name="779541"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> shadow drop sadly still bugged.<br><br>on the sample scene shown above if you go with the buggy right to the walls on 2 of 4 of them it will cast a quadratic shadow echo. No idea wherefrom this comes but if you are driving next to the wall it will show up. <br><br></td></tr></table><br>
<a name="779625"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> The docs are in a state of flux right now.  Most commands work just like B3D.  The old .chm file is documentation for the scripted engine, and is outdated.  The commands are listed in the BlitzMax help docs, but very few are documented.<br><br>I'm still doing some thing to improve the projected shadows.<br><br>I don't have any definite plans for additional shadow techniques.  I chose projected shadows because they are pretty fast, look good, and can be used in an actual shipping product.  There are some other techniques, but they significantly limit the size of the world you can display. <br><br></td></tr></table><br>
<a name="779679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ian Thompson</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I quite like the current projected shadows, my only gripe is that some see to be getting projected from above an object... but for from speed to quality ratio... there more than acceptable.. <br><br></td></tr></table><br>
<a name="779697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> The shadow issue is being addressed.  I could do a quick fix, but it would slow down performance.  I'm talking to Julio about a way to eliminate those faces from the calculated BSP.<br><br>I also changed it so a shadow will render all a mesh's children.  Now I have a single shadow for the whole car, instead of separate shadows for each limb.  (That was why the wheels looked darker when they overlapped the chassis shadow.)  This will work the same for animated characters. <br><br></td></tr></table><br>
<a name="779725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking amazing, especially like the vehicle test :)<br><br>Doesnt run on my laptop but im not amazed by that <br><br></td></tr></table><br>
<a name="779739"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> good news :-) <br><br></td></tr></table><br>
<a name="779759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Added decolayer animation, so the grass sways.  Also added some new sprite view modes that will just rotate the sprite around one axis to face the camera.  This can be used for tesslas, lighting, or as shown here, headlight beams:<br><img src="http://www.leadwerks.com/post/car5.jpg"> <br><br></td></tr></table><br>
<a name="779774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I could see looked fine, but Example06, Example07 and Example08 (executables) loaded, displayed 1 frame and then exited so I don't know what is in there.  I don't have a copy of BlitzMax so can't test the .bmx files.  <br><br>My laptop specs are:<br><br>Asus A4K, AMD64 3500+ (2Ghz), 512 MB System RAM, ATI Mobility Radeon 9700 64MB VRAM, WinXP Pro<br><br>Am I doing something wrong? <br><br></td></tr></table><br>
<a name="779819"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I've tested on a portable (Pentium M 2.13Ghz, 1gb ram, WinXp pro, Ati Mobility FireGL V3200, Directx 9.0c) but I've problem running (and compiling) example 6,7,8.<br>Any clue about the possibile problem?<br>(The mesh instancing runs at the incredible speed &lt;1FPS!, but it runs!) <br><br></td></tr></table><br>
<a name="779847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> All examples run fine on my PC (Intel Core 2 Duo, 2GB RAM, Vista Ultimate, nVidia 7600GT) however, I noticed that in the car samples, when driving under the ramp the shadow appears on top of the ramp :-S<br><br>Really nice module though! Well-done! <br><br></td></tr></table><br>
<a name="779888"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KimoTech</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Really nice project u got there! Is it shadowmapping or soft-stencilshadows u use there? :D <br><br></td></tr></table><br>
<a name="780257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jkrankie</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> This new version runs better than the last one for me, but still not perfectly. The demos 6,7 and 8 don't work at all (they flash up a frame for a window then exit before anything is drawn in the middle), and the other demos look a bit like this:<br><br>www.charliesgames.com/ledpic.jpg<br><br>It's running on an Intel GMA chip BTW.<br><br>I hope you can get compatibility improved, because i really like the module.<br><br>Cheers<br>Charlie <br><br></td></tr></table><br>
<a name="780281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll get it figured out.<br><br>The shadows are projected textures, like what HL2 and Unreal 3 use. <br><br></td></tr></table><br>
<a name="780293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> What version of OpenGL does your engine need, and what extensions? <br><br></td></tr></table><br>
<a name="780328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> It requires 3 texture units and the VBO extension.  I can probably do without the VBO requirement, but if a card doesn't support VBO it almost definitely doesn't allow 3 tex units.<br><br>3 tex units are required for proper rendering of terrain.  Each layer has a separate texture, lightmap, and alpha map.  My artists have been begging me for months to allow a separate lightmap and alphamap, and in a situation where backwards compatibility holds up progress, I think it is best to move on. <br><br></td></tr></table><br>
<a name="780332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> I set up an animation keyframe system.  It uses a binary search to determine the two closest keyframes to any time value between 0.0 and 1.0, and interpolates them.  I also added 3 loop modes that can be used to loop or extrapolate the animation.<br><br>You create an animation sequence:<br><pre class=code>animseq:TAnimSeq=CreateAnimSeq(frames=0)</pre><br>Then add keyframes:<br><pre class=code>AddKeyFrame animseq,frame,x#,y#,z#,pitch#,yaw#,roll#</pre><br>Then you call Animate:<br><pre class=code>Animate entity:TEntity,animseq:TAnimSeq,time#,loopmode=0,rate#=1.0</pre><br>Animate does not do any continual updating at this point.  It just interpolates a keyframe for time# and orients the entity to match that position and rotation.  The rate# value will interpolate between the current orientation and the specified one, so you can use this to blend animations together:<br><pre class=code>Animate entity , runseq, time#, 0, 1.0 'set the entity orientation to the exact "run" sequence
Animate entity , lookseq, time#, 0, 0.5 'set the entity orientation halfway between the current orientation and the "look" sequence.</pre><br>I think this method requires a little more work than just animating the entity once and letting the engine update it, but it gives you a lot of direct control over how the animation works.  Also, once you start doing anything interesting, you'll find you need to continually switch animations anyways, so you might as well do it from the start.  Finally, this avoids the need to attach an animation to an entity in any way, so that means less spaghetti for me to sift through.<br><br>I always had difficulty with Blitz3D's animation system, and I think pure stop animation with a lot of control might be the way to go. <br><br></td></tr></table><br>
<a name="780400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a demo:<br><a href="http://www.leadwerks.com/post/anim.zip" target="_blank">http://www.leadwerks.com/post/anim.zip</a><br><br>I was a little worried at first, because the animation (especially skin weighting) is pretty CPU-intensive, but I am getting 1000 FPS now, so hopefully it is fast enough it can display enough actors without choking.<br><br><img src="http://www.leadwerks.com/post/anim.jpg"> <br><br></td></tr></table><br>
<a name="780422"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mongia2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks for animation<br><br>in my test is:<br><br>bmax 500-450 frames!<br><br>blitz3d 500-498 frames! <br><br></td></tr></table><br>
<a name="780524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Blitz3D seems slightly faster.  I'm not sure why, unless it's using some DirectX thing that transforms the vertices on the graphics card.<br><br>I tried some cyclic updating stuff that only updates a set number of verts each frame, and gained a 33% increase in speed that way, with no noticable glitches.  However, I think the proper way to do this is to write a vertex shader that transforms the verts on the GPU.  For now I will just use the CPU transformations, and we'll see about adding a faster method later. <br><br></td></tr></table><br>
<a name="780564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stu_ovine</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looking nice....<br><br>It is taking quite a long time to load the initial screen - but runs fine once its loaded.<br><br>Are you still planning shader support ? <br><br></td></tr></table><br>
<a name="780568"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I have a good bumpmap/cubemap shader written, and shaders are actually implemented right now (CreateShader(), ShaderSource(), CompileShader()), but I want to get the rendering base down first.<br><br>I am adding support for .smd files right now.  It's the uncompiled HL2 model format, and it is very widely supported, and I think it makes animation very easy. <br><br></td></tr></table><br>
<a name="780751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a full-res HL2 model.  It takes a while to load because it is optimizing the mesh and smoothing the loop, but it works:<br><a href="http://www.leadwerks.com/post/anim2.zip" target="_blank">http://www.leadwerks.com/post/anim2.zip</a><br><br>The engine will allow up to 4 bone attachments per vertex.  I added a function that will loop an animation, and used it to fix some jerkiness in this animation's loop.  I may even write a new vertex-weighting prog like my old "Character Shop".<br><br>I'm pretty happy with the speed, because you normally would use low-res LOD models for further away characters.  The engine runs so fast with everything else, and I figure characters are going to be one bottleneck where I spend all those saved frames.  My guess is this would run at about 80-120 FPS if I loaded a complete scene behind it.<br><br><img src="http://www.leadwerks.com/post/anim2.jpg"> <br><br></td></tr></table><br>
<a name="781264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >z4g0</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> WOW!<br>the framerate il quite hight, but the animation look a bit 'fragmented' (seems there's no interpolation, showing only the keyframes, or something like it).<br><br>For the .b3D importer, there are some updates? I'm really curious to see some .b3d static mesh with materials in your engine!<br><br>Thx! <br><br></td></tr></table><br>
<a name="781281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> It runs very smooth.<br>@Leadwerks: can you create a example with 'many' HL2 model running at the same time to see how it works? <br><br></td></tr></table><br>
<a name="781310"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >smilertoo</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats looking very good so far. Any chance of a fast 3d skinned format other than .b3d? (its a pain to make them unless you have 3dsmax). <br><br></td></tr></table><br>
<a name="781334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's what .smd is for.  It's an ideal format for skinned meshes. <br><br></td></tr></table><br>
<a name="781349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >smilertoo</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> your smd example is 10x slower than the b3d sample on my system. <br><br></td></tr></table><br>
<a name="781357"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's because it's processing ten times as many vertices.<br><br>To handle a load like this, it needs to be done with a vertex shader.  Older games that performed the weighting on the CPU used much lower polycounts. <br><br></td></tr></table><br>
<a name="781389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) sinu</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> good idea with the smd file choice. There's a milliion tutorials, tools and convertors for that format and models people can use as placeholders etc. <br><br></td></tr></table><br>
<a name="781393"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >smilertoo</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> cant opengl access hardware skinning? <br><br></td></tr></table><br>
<a name="781404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> cant opengl access hardware skinning? <br></div><br>Yes, it can. <br><br></td></tr></table><br>
<a name="781548"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mongia2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> please write a manipolation texture<br><br>es:<br>blitz 3d<br>texture buffer()!!<br><br>thanks! <br><br></td></tr></table><br>
<a name="781553"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can do this:<br><br>pixmap:TPixmap=LockTexture(texture:TTexture)<br>'Draw stuff on the pixmap here<br>UnlockTexture()'updates the texture<br><br>I also have some FBO stuff implemented internally, and I can use this to render a camera to a texture.  This is useful for post-processing effects like bloom and other full-screen shaders. <br><br></td></tr></table><br>
<a name="781624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mongia2</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> thanks!!<br><br>i use for point_entity:<br><br>for example camera<br><br>Function Point_Entity_camera(entity:tcamera,x#,y#,z#)<br>   Local xdiff# = EntityX(entity)-x#<br>   Local ydiff# = EntityY(entity)-y#<br>   Local zdiff# = EntityZ(entity)-z#<br>   Local dista#=Sqr((xdiff#*xdiff#)+(zdiff#*zdiff#))<br><br>   Local pitch# = ATan2(ydiff#,dista#)<br>   Local yaw#   = ATan2(xdiff#,-zdiff#)<br>   RotateEntity entity,pitch#,yaw#,0<br>End Function<br><br>add in your engine!!! <br><br></td></tr></table><br>
<a name="783132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >siread</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried the sample demos but I get "Unhandled Exception: Unhandled Memory Exception error" when it hits RenderWorld. This is on my laptop with it's crappy SiS m760gx onboard card. I'll give it a try on my main PC. :) <br><br></td></tr></table><br>
<a name="783153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ninjarat</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, most of them didn't work, but I've got an extremely old graphics card, NVidia GeForce2 MX/MX 400.  I'll try again once I've upgraded. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
