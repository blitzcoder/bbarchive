<!DOCTYPE html><html lang="en" ><head ><title >Fastest way to get angle between two points</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Fastest way to get angle between two points</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Fastest way to get angle between two points</a><br><br>
<a name="1060360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was just experimenting a bit and wondering how to get the angle between two points fast, e.g. when two spheres are checking for collision.<br><br>I'm familiar with code like this:<br><pre class=code>
Function GetAngle2D:Float(X1:Float,Y1:Float,X2:Float,Y2:Float)
         local dx# = x2 - x1
         local dy# = y2 - y1
         Return ATAN2(dy#,dx#)+360) MOD 360
End Function
</pre><br><br>But I'm wondering if there is a faster way without the Atan2 which I presume is slow?<br><br>So I thought of this..<br><br>Precalculate a lookup table which is basically in the shape of a hollow square - ie two sides, top and bottom. It'll represent a square of fixed size, preferably bigger than your objects. You can make it as detailed as you like with as much precision as is necessary.<br><br>Then let's say you have a circle centered in the middle of the square (object A), and another circle about to collide with it (object B). Both are inside the lookup table `box`.<br><br>To find the angle from the center of A to B, you'd a) find out how much distance there is between object B and the edge of the lookup box (separately for X and Y), b) Figure out what portion of the half-height/half-width of the box that distance represents (without doing a divide?), c) multiply the distance between the circles by that amount to basically extend the line from object A, through object B, and collide with the lookup box, d) read the value at that position in the lookup table - that's your angle.<br><br>I haven't written it in code but I believe it would work in theory... just not sure how you'd find out how much to scale/extend the line by without using a divide. Also not sure if it'd be faster than Atan2 or not. But it's an idea. <br><br></td></tr></table><br>
<a name="1060366"></a>

<a name="1060367"></a>

<a name="1060368"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds interesting.. but what is ATAN2 doing?<br><br>[Edit]<br>Oops - seems like the standard bmx ATan2 is calling into maths.h. Now I do not know details about the C atan2 implementation, but i'd assume it is *very* fast and highly optimized .. do you need a special deal of performance, or are you proposing your concept just out of interest?<br><br><font class="tiny">Last edited 2010</font><br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1060447"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just out of interest. I don't really need it for anything. Just wondered if it'd help others, if it works better. <br><br></td></tr></table><br>
<a name="1060618"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >thalamus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds like a perfect candidate for the proposed monthly programming challenge... :) <br><br></td></tr></table><br>
<a name="1060727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> One way to speed it up is to change the way you view the angle.  Seems that game programmers have gotten into the habit of viewing 0 degrees as pointing up and going to 360 degrees as you turn clockwise.<br><br>In math, 0 degrees points along the positive x axis, which is toward the right of the screen.  Positive degrees moves toward the positive y axis, which is clockwise on the screen, and negative degrees move toward the negative y axis, or counter-clockwise.  The range is -180 to 180 degrees.<br><br>ATan2() is a mathematical function and therefore returns angles with that standard.  If we program games the same way, then there is no need to shift the returned angle into what we are using.  So you can get rid of the +360 Mod 360 portion of the function.<br><br>Even though the docs say that SetRotation accepts an integer from 0 to 360, it will also accept -180 to 180 range as well and still work properly as long as you use that system throughout.  Only problem is that GetAngle will not return the proper angle any more, but I tend to store the angle in a separate variable anyway.<br><br>At first, it might seem odd, or even wrong to do things that way; but like learning hexadecimal, if you force yourself to do it that way, you eventually see the logic in it and prefer it in certain conditions.<br><br>Also, if you are wondering exactly what ATan2(y,x) does, it is returning the arctangent of y/x, but eliminates the possibility of a divide by zero (if x = 0) as well as correcting for quadrant (Atan(y/x) only returns valid if both x and y are positive or both x and y are negative). <br><br></td></tr></table><br>
<a name="1060793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds fine, but the thread is really about how to get rid of Atan2 entirely. <br><br></td></tr></table><br>
<a name="1060857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I was just experimenting a bit and wondering how to get the angle between two points fast, e.g. when two spheres are checking for collision. <br></div><br><br>Why would you need the angle to check sphere collision? Just get the radius of each one, and if the distance from the center of each is lower than the sum of both radius, you have a collision. <br><br></td></tr></table><br>
<a name="1060897"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not specific to collision detection, that was just an example. <br><br></td></tr></table><br>
<a name="1060983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Make the points constant, then the angle will never change.<br><br><br>If anyone thinks I'm being facetious, I'm not, but I'd prefer not to explain my answer unless it's truly necessary. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
