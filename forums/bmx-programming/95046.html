<!DOCTYPE html><html lang="en" ><head ><title >Secret BlitzMax optimization I found</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Secret BlitzMax optimization I found</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Secret BlitzMax optimization I found</a><br><br>
<a name="1093161"></a>

<a name="1093162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had wanted to make this post better and with code samples and the assembly output to show the optimization in action, but I've been very busy and won't have enough time for quite a while so I'm just going to put it out there and see what happens.<br><br>BlitzMax methods are implemented in a similar way to C++ virtual functions, but if you never override the method in an extended type, you are wasting time on the virtual function overhead when a simple function would do.<br><br>I've noticed that if you mark a type which doesn't extend from any other types, as Final, all its methods in the output assembly code will be coded as regular non-virtual functions! And you will not suffer the virtual overhead unnecessarily.<br><br>I've not tested more specific examples. Eg if you mark a method as final which is introduced for the first time and so doesn't override an existing method, whether it comes out as virtual or not. And I have limited understanding of assembly so my observations could be wrong.<br><br>The TLDR is if you have a simple type which you never extend, marking it as final will give a very tiny but non-zero speed improvement to calling its methods.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1093172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1) I once did some speed tests on this (no longer have the code and it was a few years ago) and found that types marked final were slightly slower.<br><br>2) Virtual function overhead is in the order of a few microseconds per million calls <br>http://stackoverflow.com/search?q=virtual+function+overhead <br><br></td></tr></table><br>
<a name="1093175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1. Without the code for me to try, that statement is meaningless.<br><br>2. Never said it was a major difference. <br><br></td></tr></table><br>
<a name="1093224"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> On a similar (But again lost listing) note.<br>All member functions of a type where faster if they returned a value, EVEN is that value was un-allocated to anything.<br><br>It was a petty differance if I remember correctly, and made it harder to follow the code.<br><br>This if true however is quite useful, but I think Id still be tempted to say that unless the speed is major I would rather keep the "Final" keyword for use when the function is, as they say, final <br><br></td></tr></table><br>
<a name="1093334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've used it for things such as a TVec type which has just 2/3 numbers and a few methods to add it to other vectors and so on. I'm never going to extend that.<br><br>I would like these claims of random things being faster to be backed up before being made. Why would it be slower not to return a value? It's an operation less. On strict mode, all functions and methods implicitly return an int of 0. How did you measure it, what settings?? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
