<!DOCTYPE html><html lang="en" ><head ><title >LuaJIT module</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >LuaJIT module</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >LuaJIT module</a><br><br>
<a name="1012506"></a>

<a name="1104549"></a>

<a name="1104552"></a>

<a name="1104553"></a>

<a name="1105394"></a>

<a name="1118300"></a>

<a name="1118301"></a>

<a name="1118302"></a>

<a name="1118304"></a>

<a name="1118317"></a>

<a name="1118318"></a>

<a name="1139192"></a>

<a name="1161069"></a>

<a name="1165178"></a>

<a name="1180587"></a>

<a name="1180588"></a>

<a name="1180589"></a>

<a name="1180590"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Download LuaJIT 1.1.8 and LuaJIT 2.0.1 (latest stable) version:<br><br><a href="http://byrathon.com/omat/zeke_luajit.zip" target="_blank">Zeke_LuaJIT 1 &amp; 2</a><br><br>There are 2 lua examples, mandelbrot and sieve. (LuaJIT 2 includes also some FFI tests)<br><br>My results(updated):<br>-Mandelbrot:<br>pub.lua - 57 seconds<br>luaJIT - 7 seconds<br><b>LuaJIT-2 time: 2secs</b><br><br>-Sieve:<br>pub.lua - 13.218 seconds<br>luaJIT -4.933 seconds<br><b>LuaJIT-2 time: 0.5secs</b><br><br>EDIT: Updated LuaJIT 2.0.1 stable version <br><br></td></tr></table><br>
<a name="1012509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't get pub.lua to work on Linux (complains about dlsym, dlopen, etc.), but here are the times for luaJIT:<br>Mandelbrot: 10 seconds<br>Sieve: 6.06 seconds <br><br></td></tr></table><br>
<a name="1012511"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kenshin</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine here.<br><br>Mandelbrot<br>pub - 26 secs<br>jit - 3 secs<br><br>Sieve<br>pub - 5.969<br>jit - 2.157<br><br>Thanks for sharing.  It's a huge speed improvement. <br><br></td></tr></table><br>
<a name="1012551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does it compile to exe or some kind of bytecode type of thing? Cross platform? <br><br></td></tr></table><br>
<a name="1012566"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does it compile to exe or some kind of bytecode type of thing? <br></div>As far as I know it's all in memory.<br><br><div class="quote"> Cross platform? <br></div>Yes.<br><br>I noticed the wrapper is using version 1.1.5 of luaJIT.. might want to try 2.0 (I also noticed some compilation warnings under Linux). <br><br></td></tr></table><br>
<a name="1012597"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sweet! <br><br></td></tr></table><br>
<a name="1012602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I should've asked is does it compile to machine-code opcodes which can be directly executed by the CPU or is there some interpretation still? <br><br></td></tr></table><br>
<a name="1012605"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What I should've asked is does it compile to machine-code opcodes which can be directly executed by the CPU or is there some interpretation still? <br></div>It has its own VM (see <a href="http://luajit.org/luajit.html" target="_blank">here</a> for more info).<br><br>EDIT: Also, according to that page, LuaJIT was completely rewritten and optimized in version 2.0, so it may be even faster than the benchmarks we're getting now. <br><br></td></tr></table><br>
<a name="1012614"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tommo</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's X86 so far, there is a X64 version in development. <br>I've been using LJ1 for a while. It's about 4x fast as normal lua.<br>Coroutine support of LJ1 under windows is not very good, but this seems have been improved in LJ2. <br><br></td></tr></table><br>
<a name="1013857"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am very surprised.  I was able to just change pub.lua to your module, compile my engine, run my editor, and everything seems to work fine.  No speed tests yet, but this is very interesting. <br><br></td></tr></table><br>
<a name="1013893"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a way to toggle JIT/interpretation when a new state is created, instead of recompiling the app? <br><br></td></tr></table><br>
<a name="1015966"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, there is a new LuaJIT 2 module (latest 2.0.0-beta3).. NOTE, that this is only for testing purposes only(windows only).I didin't get this work with source code. so i made .dll and this module use that. but this works and ITS MUCH faster than LuaJIT 1.1.5.<br>if you want to test: **EDIT LINK REMOVED** use first post link.<br><br>AND you need to copy 'lua51.dll' to your project directory (or copy to C:\windows/system32)<br><br>Leadwerks you can toggle JIT compiler on/off.. using 'jit.on()' or 'jit.off()' in lua script<br><br>some Results:<br>Sieve:<br>LuaJIT-2 time: <b>0.5secs</b><br>(same code but added 'jit.off()' in the first line of 'sieve.lua') time: <b>4.33 sec</b> <br><br></td></tr></table><br>
<a name="1015972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> awesome! can't wait to try it out. <br><br></td></tr></table><br>
<a name="1022063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> wow. i got LuaJIT 2.0 beta 4 working without .dll... and speed is still same as in my first post.. i will give you guide how i made (and replaced old pub.lua) luajit2 module to working.. but maybe tomorrow.. because im now too drunk.. HAHA :D<br>but here is my test..<br>**EDIT LINK REMOVED** use first post link. <br><br></td></tr></table><br>
<a name="1022073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mic_pringle</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> .. i will give you guide how i made (and replaced old pub.lua) luajit2 module to working.. but maybe tomorrow..  <br></div><br>Please do as I would really like to get this up and running on a Mac, and a guide to how you achieved it on Windows would go a long way to help out.<br><br>Thanks<br><br>-Mic <br><br></td></tr></table><br>
<a name="1022100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sounds very interesting. I don't have MinGW or any such thing installed here and I can never get it and Max to live in harmony anyhow. Are you planning to release a pre-compiled module version? I would love to plaay around with this one<br><br>I want to learn the basics of LUA + Max but don't know where to begin<br>Some initial questions:<br><br>1) Who syntax-checks the Lua script? You (via BlitzMax) or the Lua module? E.g,<br><pre class=code>function MoveMyShip(x,y,speed=1.0       &lt;-- missing end bracket</pre><br><br>2) Can you register commands which have optional parameters? (thus allowing the script optional ways of using one command?)  E.g,<br><pre class=code>function MoveMyShip(x,y,speed=1.0)</pre> <br><br></td></tr></table><br>
<a name="1022163"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1) You have to tell it to, but Lua can debug the code. You can get it to print out errors to the output window or a debug file or wherever you want.<br><br>2) Yes Lua is very forgiving with the number of params. passed to functions. You can even pass too many, the extra are ignored, and have multiple return values.<br><br>Disclaimer: I'm fairly new to Lua myself so my advice may not be the best. <br><br></td></tr></table><br>
<a name="1022169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll ignore 1 because that's an odd question to ask.<br><br>On the second question, you can have optional parameters, but they'll just be nil if you don't provide a value.  You cannot have default values for arguments like in your example, it won't work.<br><br>For more information, <b><a href="http://www.lua.org/manual/5.1/manual.html" target="_blank">read the manual</a>.</b>  Really, it's a very good manual, I don't know why some people don't read it. <br><br></td></tr></table><br>
<a name="1022218"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, here is this latest luajit 'hack': **EDIT LINK REMOVED** use first post link.<br><br>backup pub.lua, delete original pub.lua, copy my mod to pub.lua, copy libluajit.a to Blitzmax/lib folder, build pub.lua module.. test..<br><br>and here is guide how i made this:<br>download latest luajit sources. and extract to LuaJIT-2.0.0 folder<br>use: 'mingw32-make' to build sources.<br>use: 'ar rcs libluajit.a *.o' in src folder to get libluajit.a<br>copy libluajit.a to blitzmax\lib<br>lua.bmx changes:<br>delete ALL Imports<br>add:<br>Import "-lluajit"<br>Import "-lmingw32"<br>Import "-lgcc"<br>then build pub.lua module: 'bmk makemods -a pub.lua' (and -h for threaded)<br>and build other modules that use pub.lua (brl.maxlua) (yea. you get errors, because in lua_object.c, include point to original lua folder, so change that to '#include &lt;pub.mod/lua.mod/LuaJIT-2.0.0/src/lua.h&gt;', then build)<br><br>^^ i said this i 'hack' solution.. so if some c/c++ guru can make this easier, feel to free tell us. :D <br><br></td></tr></table><br>
<a name="1022219"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lua is good at catching compile errors.  If the return value of dofile() or pcall() returns non-zero, I think lua_tostring(-1) will give you the error message.<br><br>For actual crashes, you can use try/catch and actually get the debug info from Lua after your program has crashed using the Lua function debug.trace().  I posted an example of this recently.<br><br>With Lugi, all default parameters are 0/nil.  This is because BlitzMax doesn't support default values in reflection.  LuaBind for C++ does support default values.  You could do it with BlitzMax, but you would have to parse source code files instead of using reflection, which is more error-prone.  I have used all the code interfaces for BlitzMax and Lua, and I would not use anything except Noel's Lugi module.<br><br><div class="quote"> wow. i got LuaJIT 2.0 beta 4 working without .dll... and speed is still same as in my first post.. i will give you guide how i made (and replaced old pub.lua) luajit2 module to working.. but maybe tomorrow.. because im now too drunk <br></div><br>That's funny, you were drunk when you emailed me the other night, too.  Well, if it gets the code done... <br><br></td></tr></table><br>
<a name="1022665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Please do not name your modules to replace the official pub or brl modules.  It is not acceptable to make my users replace their modules, and it will be easily overwritten by an update. <br><br></td></tr></table><br>
<a name="1022807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, i know that, but that was only for testing.. But good news here.<br><br>here is a new zip, this contains BOTH LuaJIT modules (LuaJIT 1.1.6 and LuaJIT 2.0.0-beta4) AND they are now in zeke.mod folder.<br><br><a href="http://www.byrathon.com/luajit_mods.zip" target="_blank">http://www.byrathon.com/luajit_mods.zip</a><br><br>also good news is that you dont need to copy libluajit.a to Bmax\lib folder anymore, <br><br>so when there is new LuaJIT update, you just need to do:<br><br>1. download lastest LuaJIT sources from <a href="http://luajit.org/" target="_blank">http://luajit.org/</a> and extract to somewhere<br>2. Delete all files+folders from 'zeke.mod/luajit2.mod/LuaJIT-2.0.0'<br>3. Copy #1 extracted files+folders to ^^ folder<br>4. Open console, go to ^^ LuaJIT-2.0.0/src folder and type: 'mingw32-make' (this will build luajit)<br>5. then type to console 'ar rcs libluajit.a *.o' (this will build libluajit.a to src folder)<br>6. build luajit2 module. <br><br></td></tr></table><br>
<a name="1022872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is working great Zeke and I am having fun learning Lua<br><br>One neat way of experimenting/learning Lua is to "Lock Build" a file which launches a demo script. The demo script can be loaded into the BlitzMax IDE for editing (use extension .lua to prevent the IDE from changing commands)<br>Hitting F5 then launches the locked main executable, which in turn runs your script<br><br>For example, this is my "Locked" Blitzmax file<br><b>LuaDemo1 Run.bmx</b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">SuperStrict
Framework zeke.luajit2	
Import brl.standardio

Global l:Byte Ptr = luaL_newstate()
luaL_openlibs(l)

If luaL_dofile(l , "Demo1.lua") Then 
	Print lua_tostring(l , - 1)
EndIf</textarea><br><br><br>Some random Lua script which I have loaded into the Max IDE for playing around with ...<br><br><b>Demo1.lua</b><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">-- Lua testing

jit.off()

-- STRINGS
-- ========================================================================
mystring="Lua testing"
print("\"" .. mystring .. "\" is " .. #mystring .. " chars long")

-- FOR NEXT
-- ========================================================================
for i=1,5 do
    io.write(i .. "&gt; Hello world, using ",_VERSION,"!\n")
end

-- PRINT
-- ========================================================================
print()  -- empty line
print("Hello (one method)")
io.write("Hello (another method) \n")

-- IF THEN ELSE   note "==" for comparison
-- ========================================================================
local v=43
if v==42 then print "v is 42" else print "v is not 42" end

-- MULTI-LINE COMMENTS
-- ========================================================================
--[[ 
Multi-line strings &amp; comments
with double square brackets
Prefix opening comment block with additional '-' to un-comment block
--]]

-- FUNCTIONS
-- ========================================================================
function factorial(n)
  if n == 1 or n == 0 then
    return 1
  else
    return n * factorial(n - 1)
  end
end

function factorial2(n)             
  return n == 0 and 1 or n * factorial2(n - 1)
end

-- FUNCTION OVERLOADING
-- ========================================================================
do
  local currprint = print		-- Store current print function
  function print(s)			-- Redefine print function
    if s == "" then currprint("???") else currprint(s) end
  end
end

print("")

-- TABLES
-- ========================================================================
point = { x = 10, y = 20 }   -- Create new table
print("table -&gt; point x=" .. point.x)	-- alternatively, print(point["x"])



-- ARRAYS
-- ========================================================================
arr = { "a", "b", "c", "d" }	-- Indices are assigned automatically.
print("arr2=" .. arr[2])		-- Prints "b". Automatic indexing in Lua starts at 1.
print("arr length=" .. #arr)	-- Prints 4.  # is the length operator for tables and strings
</textarea> <br><br></td></tr></table><br>
<a name="1022975"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >theHand</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thank you sir!  I am very happy with the results.  Nicely wrapped!<br>The Mandelbrot was ~39 seconds with pub.lua, and ~5 seconds with your wrapped version of LuaJIT. <br><strike>Assembly sure is fast, isn't it... :D</strike> (I think it might just be specific ways of optimizing for x86 chips)<br><br>I'm gonna stick with LuaJIT 1.1.6 so that I get less headaches. <br><br></td></tr></table><br>
<a name="1023057"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seems to work great.  Thanks again. <br><br></td></tr></table><br>
<a name="1023143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fellow Lua coders,<br><br>Is there a way to change Lua global variables from within BlitzMax?<br>For example, the script here has global width and height variables<br>I register SetSize() and have a Max lSetSize() function to handle the values passed<br>Then, I want to change the width and height parameters in Lua<br><br>LuaScript.lua<br><pre class=code>
global width
global height

SetSize(128,64)
print("Width:" .. width .. " and Height:" .. height)
</pre><br><br><br>BlitzMax code snippet<br><pre class=code>
Function lSetSize:Int(L:Byte Ptr)
	local w:Int = lua_tonumber( L, 1 )
	local w:Int = lua_tonumber( L, 2 )

	' manipulation of w and h done

	' now, how do you set the Lua's global width and height
	' to the new values in w and h ?


	lua_???(lua_state,width)
	lua_???(lua_state,height)

	Return 2  ' what should be returned? the number of params?
End Function
</pre> <br><br></td></tr></table><br>
<a name="1023164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Did you read the manual?  (I'm not really fond of giving answers to simple questions, so there's your hint that you should read the manual.) <br><br></td></tr></table><br>
<a name="1023173"></a>

<a name="1254726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes:<br><a href="http://www.lua.org/manual/5.1/manual.html" target="_blank">http://www.lua.org/manual/5.1/manual.html</a> <br><br></td></tr></table><br>
<a name="1023176"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's not the manual, that's a book.  This is the manual: <a href="http://www.lua.org/manual/5.1/manual.html" target="_blank">http://www.lua.org/manual/5.1/manual.html</a>  Notice that it says 'manual' in the title. <br><br></td></tr></table><br>
<a name="1023178"></a>

<a name="1254727"></a>

<a name="1254728"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> The lua_getglobal() is about as close as I can guess to being the appropriate function<br>I don't know how to change the value so that the script also sees the change though. <br><br></td></tr></table><br>
<a name="1023229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's how I usually do things:<br><pre class=code>		Local size:Int=StackSize()
		lua_pushinteger(L,i)
		lua_setglobal(L,name)
		SetStackSize(size)</pre><br><br>No worries about the stack size, just restore it to the original size when you are done.<br><br>Some helper functions:<br><pre class=code>	Method StackSize:Int()
		Return lua_gettop(L)
	EndMethod

	Method SetStackSize(size:Int) {hidden}
		Local currentsize:Int=StackSize()
		If size&lt;currentsize
			lua_pop(L,currentsize-size)
		EndIf
	EndMethod</pre> <br><br></td></tr></table><br>
<a name="1023249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Great help Josh. The running script now reports the changed values <br><br></td></tr></table><br>
<a name="1024584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Zeke, would it be possible to recompile LuaJit with the following change:<br><br>At line 99 of luaconf.h change this:<br>#define LUA_IDSIZE	60<br><br>to this:<br>#define LUA_IDSIZE	1024<br><br>This will fix it so error messages won't cut off the name of the file an error occurs in.  Thanks. <br><br></td></tr></table><br>
<a name="1024725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Changed LUA_IDSIZE to 1024 in both modules. download link is in first post. <br><br></td></tr></table><br>
<a name="1024918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> Zeke,<br>Did you manage to take a look at this one I posted in your zeke.mod thread?<br><br>-----------------------------------------------------------------------<br>Can you implement the <b>luaL_error()</b> function ?<br>If not, are there other ways to push an error into lua?<br>----------------------------------------------------------------------- <br><br></td></tr></table><br>
<a name="1024919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Push a string and call lua_error.  luaL_error is a convenience function, does roughly the same thing as running snprintf, pushing the result, and calling lua_error.  There's also no good way to port it without it being different from the C API, since BlitzMax doesn't support variadic functions. <br><br></td></tr></table><br>
<a name="1024936"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> That works fine. Thanks Nilium<br>Do you know how to get the offending line number causing the error?<br>What I have is a registered function. When the Blitz function is called a check is made to ensure the correct number of parameters are passed. If not I now push the error out<br><br>Example:<br><br><pre class=code>Function MoveObject(L:Byte Ptr)
	Local numParams:Int = lua_gettop(L)
	If numParams&lt;3
		lua_pushstring(L,"MoveObject - Expecting 3 parameters")
		lua_error(L)
	EndIf
End Function
</pre><br><br><br>(This function could be used anywhere in the Lua script) <br><br></td></tr></table><br>
<a name="1024946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry Jim i forgot to post.. but just what Noel said that no support for variadic functions..<br><br>and about your test. using debug.traceback you can get line number where error occurs:<br><pre class=code>Function MoveObject(L:Byte Ptr)
	Local numParams:Int = lua_gettop(L)
	If numParams &lt; 3
		lua_getfield(l , LUA_GLOBALSINDEX , "debug")
		lua_getfield(l , - 1 , "traceback")
		lua_remove(l , - 2)
		Print "Error: Expecting 3 parameters"
		If lua_pcall(l , 0 , 1 , 0) &lt;&gt; 0 Then lua_pushstring(l , lua_tostring(L,-1) )
		lua_error(L)
	EndIf
End Function</pre> <br><br></td></tr></table><br>
<a name="1024948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Do you know how to get the offending line number causing the error? <br></div>You should use the lua_Debug structure and lua_getinfo.  Bear in mind that line info is not always available.  You'll probably have to write a quick bit of C to allocate and release a lua_Debug structure, and you'll have to access its contents via pointer fiddling (or you could write auxiliary functions to get the data for you).<br><br>I don't recommend using Zeke's way for two reasons: 1) it's a lot more work than is needed and 2) the state of the global table may not be consistent with the state of the VM itself (meaning it's probably not the safest thing to do).  Edit: Whether or not #2 can happen or not, I'm not sure, but I'd rather just pull the data straight from the VM. <br><br></td></tr></table><br>
<a name="1024990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >EOF</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks both. I have lots to learn <br><br></td></tr></table><br>
<a name="1025482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the fix, Zeke!<br><br>This is my method for error handling:<br><pre class=code>	Method DoString:Int(source:String)
		Local result:Int
		Local dummy:Object
		
		Try
			result=luaL_dostring(L,source)
		Catch dummy:Object
			HandleException()
		EndTry
		If result=0
			Return True
		Else
			Return False
		EndIf
	EndMethod
	
	Method HandleException() {hidden}
		Local debugsuccess:Int
		Local err:String="No Lua debugger found."
		
		lua_getglobal(L,"debug")
		If lua_istable(L,-1)
			lua_getfield(L,-1,"traceback")
			If lua_isfunction(L,-1)
				If lua_pcall(L,0,1,0)=0
					If lua_isstring(L,-1)
						err=lua_tostring(L,-1)
					EndIf
				EndIf
			EndIf
		EndIf
		Print err
		If Not silentexception
			Notify err,1
		EndIf
		End
	EndMethod</pre> <br><br></td></tr></table><br>
<a name="1025538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#42">[#42]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried using your new luajit2 module with ID_SIZE changed to 1024, but I still get the error messages cut off.  Are you sure you recompiled that one?<br><br>Luajit1 seems to work correctly. <br><br></td></tr></table><br>
<a name="1025556"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#43">[#43]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm.. i tested both. and that worked fine, and i used this code to test:<br><pre class=code>Framework zeke.luajit2 'pub.lua
Import brl.standardio

Global l:Byte Ptr = luaL_newstate()

Local file$ = "c:\Lua_mega_long_filename_changed idsize from 60 to 1024 testing script file blaah blaah.lua"

Print file.length

If luaL_dofile(l , file)
	Print lua_tostring(l , - 1)
	End
EndIf</pre><br>but now i also changed luajit2.bmx(and luajit1.bmx) debug type to the correct fields (1024 bytes reserved to short_src msg). and added a new function <b>luaJIT_setmode()</b>(only in luaJIT2). download from 1st post link. <br><br></td></tr></table><br>
<a name="1025588"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#44">[#44]</a></td></tr></table></td></tr><tr ><td class="posttext"> This example illustrates the problem:<br><pre class=code>Framework zeke.luajit2 'pub.lua
Import brl.standardio

Global l:Byte Ptr = luaL_newstate()

Local cs:Byte Ptr

Local file$ = "c:\Lua_mega_long_filename_changed idsize from 60 to 1024 testing script file blaah blaah.lua"

Local source:String="a.f=8"

cs=source.ToCString()

luaL_loadbuffer(l,cs,source.length,file)

If lua_pcall(l , 0,0,0)
	Print lua_tostring(l , - 1)
	End
EndIf</pre> <br><br></td></tr></table><br>
<a name="1025592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#45">[#45]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>[string "c:\Lua_mega_long_filename_changed idsize from 60 to 1024 testing script file blaah blaah.lua"]:1: attempt to index global 'a' (a nil value)</pre><br>this is what i get.<br>make sure that you are downloading a NEW version.. and not that "cached" version.. &lt;= im not sure how to delete old "cached files.. but...<br>i hope you can get this woking. <br><br></td></tr></table><br>
<a name="1025627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#46">[#46]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just downloaded from the link at the top of the thread and ran my example program.  Here is the output:<br><pre class=code>Building test
Compiling:test.bmx
flat assembler  version 1.68  (1572863 kilobytes memory)
3 passes, 1288 bytes.
Linking:test.exe
Executing:test.exe
[string "c:\Lua_mega_long_filename_changed idsize from..."]:1: attempt to index global 'a' (a nil value)

Process complete</pre><br><br>Using LuaJIT1 it works:<br><pre class=code>Building test
Compiling:test.bmx
flat assembler  version 1.68  (1572863 kilobytes memory)
3 passes, 1288 bytes.
Linking:test.exe
Executing:test.exe
[string "c:\Lua_mega_long_filename_changed idsize from 60 to 1024 testing script file blaah blaah.lua"]:1: attempt to index global 'a' (a nil value)

Process complete</pre><br><br>So I think you forgot to recompile LuaJIT2.  ;) <br><br></td></tr></table><br>
<a name="1025918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#47">[#47]</a></td></tr></table></td></tr><tr ><td class="posttext"> **EDIT** removed old text. and here is the fix.<br><br>HMM.. do you have that 'libluajit.a' file in bmax/lib folder?? if it exists then maybe bmax first check that lib file and use it instead luajit2/src/libluajit.a file. (delete that bmax\lib\luaji.a)&lt;= i think this will fix this problem.<br><br>Yes. i just tested. and i put old libluajit.a file to that folder and then i get that "old" error also.. but when you delete that file it should run fine. (My fault, sorry) <br><br></td></tr></table><br>
<a name="1026011"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#48">[#48]</a></td></tr></table></td></tr><tr ><td class="posttext"> It works, thank you again.  :) <br><br></td></tr></table><br>
<a name="1104550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#49">[#49]</a></td></tr></table></td></tr><tr ><td class="posttext"> updated modules. <br><br></td></tr></table><br>
<a name="1105336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >mpmxyz</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#50">[#50]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't download the modules but get 404 errors instead. :-/<br>Fix it! :-) <br><br></td></tr></table><br>
<a name="1105395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#51">[#51]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry. fixed. <br><br></td></tr></table><br>
<a name="1118303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#52">[#52]</a></td></tr></table></td></tr><tr ><td class="posttext"> Updated to LuaJIT 2.0 beta 9 <br><br></td></tr></table><br>
<a name="1118353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#53">[#53]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yay! <br><br></td></tr></table><br>
<a name="1125642"></a>

<a name="1125645"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#54">[#54]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anyone been able to compile any of the examples? <br>All of my attempts fail with: <br><pre class=code>
C:/Dev/BlitzMax/lib/libgcc.a(unwind-sjlj.o): undefined reference to `__mingwthr_key_dtor'
C:/Dev/BlitzMax/lib/libgcc.a(unwind-sjlj.o): undefined reference to `_CRT_MT'
Build Error: Failed to link C:/Dev/BlitzMax/mod/zeke.mod/luajit2.mod/Benchmark/Sieve test.exe
</pre><br>I've tried the latest Bmax/mingw 1.46 and the older 1.39/mingw. Same error for both.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#55">[#55]</a></td></tr></table></td></tr><tr ><td class="posttext"> its working fine here. are you using original bmk or bruceys bmk(ng)?<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=84925#960166" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=84925#960166</a> there was same errors what you got. <br><br></td></tr></table><br>
<a name="1125760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#56">[#56]</a></td></tr></table></td></tr><tr ><td class="posttext"> Original bmk.<br>My version of bmax 1.46 is on a new computer (win 7). I just installed bmax, the 'nuwen' mingw package and setup the env variables. <br>I can build the luajit2 module with bmk and no errors. Is there something else I need in addition to a vanilla install of bmax?<br>btw, I can build and run a lot of Brucey modules without a problem. <br>Any help is appreciated <br><br></td></tr></table><br>
<a name="1125986"></a>

<a name="1125987"></a>

<a name="1125988"></a>

<a name="1125990"></a>

<a name="1125992"></a>

<a name="1125995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#57">[#57]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm.. 1.46 is Mac Lion only, but i think windows side is not changed(1.45) my mingw is not nuwen, but downloaded from the original mingw download page.. <a href="http://sourceforge.net/projects/mingw/files/Installer/mingw-get-inst/" target="_blank">http://sourceforge.net/projects/mingw/files/Installer/mingw-get-inst/</a><br><br>and im runninw win 7 32-bit<br><br>and just tested, that i renamed my current luajit2 module to luajit22 and then downloaded this module again.. and extracted luajit2 and opened sieve test.bmx and hit build and run. and it works.<br><br>(i have rebuilded all modules with latest mingw build and using original bmk)<br><br>hmm.. GO to DOS console, and then to Blitzmax/mod/zeke.mod/luajit2.mod/luajit-2.0/ directory<br>then type mingw32-make&lt;enter&gt; and it start to compile luajit code...<br><br>after that rebuild luajit2 module and try examples...<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1125999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#58">[#58]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm.. yeah.. i think that all you need is to download module and "re-compile" luajit source using that ("mingw32-make") &lt;in win32&gt;<br>and then rebuild luajit2 module.. and then it should work.. <br><br></td></tr></table><br>
<a name="1126063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#59">[#59]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the response. I downloaded the mod and rebuilt the object files with mingw, bmk'd the mod, but the error persists. Unless someone else independently gets the same error, I can only assume this error is local to me. Perhaps I'll try the rebuilt DLL in order to use the FFI in the meantime. <br>Thanks for looking into the problem, and let me know if any other possible solutions come to mind.<br>thanks! <br><br></td></tr></table><br>
<a name="1139178"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AnniXa</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#60">[#60]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, that link is not working anymore :(<br><br>anyone got a working link? <br><br></td></tr></table><br>
<a name="1139181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#61">[#61]</a></td></tr></table></td></tr><tr ><td class="posttext"> sorry. webmaster upgraded host, so there is some downtime.. <br><br></td></tr></table><br>
<a name="1139182"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#62">[#62]</a></td></tr></table></td></tr><tr ><td class="posttext"> The gain in performances are incredible !<br>I'm always very tempted to include script abilities in my games but always fear a major slow down when I see disastrous implementation like TorqueScript or some other.<br><br>But for some slow paced script this can be very interesting.<br>Hope for an uptime soon or later :) <br><br></td></tr></table><br>
<a name="1139191"></a>

<a name="1139193"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#63">[#63]</a></td></tr></table></td></tr><tr ><td class="posttext"> Link fixed. and also updated to LuaJIT 1.1.8 and LuaJIT 2.0.0 beta 10<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1139221"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#64">[#64]</a></td></tr></table></td></tr><tr ><td class="posttext"> Mandelbrot<br>pub.lua - 33s<br>LuaJIT - 3s<br><b>LuaJIT 2.0.0-b10</b> - 1s<br><br>Sieve<br>pub.lua - 5.619s<br>LuaJIT - 1.807s<br><b>LuaJIT 2.0.0-b10</b> - 0.147s<br><br><br>I think the numbers talk for themself :)<br>Thanks for this update!<br><br>I wonder how fast it is compared to BriskVM 2. BVM2 is no more updated but maybe because it's a complete product. <br><br></td></tr></table><br>
<a name="1149944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#65">[#65]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm confused about a couple of things and was hoping someone could shed some light.<br><br>1. Where is the additional speed coming from?  If LuaJIT is not running pre-compiled scripts, doesn't that mean it still has to interpret and then run them - just like maxlua?<br><br>2. If I'm not importing pub.lua explicitly, how do I replace it with zeke.luajit?  I'm a little confused as to what the "standard modules" are and where they get included. <br><br></td></tr></table><br>
<a name="1149945"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#66">[#66]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Where is the additional speed coming from? <br></div><br><br>JIT = Just In Time, referring to when the program is compiled. As contrasted with Ahead Of Time, used by your Max code. The Lua is compiled into x86 instructions as and when they're needed when the code is about to run, directly in memory. <br><br></td></tr></table><br>
<a name="1149949"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#67">[#67]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the quick reply!  I am familiar with the term.  I just don't see how that differs from what regular Lua is doing. <br><br></td></tr></table><br>
<a name="1149955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#68">[#68]</a></td></tr></table></td></tr><tr ><td class="posttext"> Regular Lua compiles to LuaVM instructions, which are interpreted in software. It's a very clean and efficient VM design and instruction set, but even the best such are still an order of magnitude slower than running on the metal. <br><br></td></tr></table><br>
<a name="1149964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#69">[#69]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, so it's efficiency.  I don't suppose there is a way to compile into byte code and execute later? <br><br></td></tr></table><br>
<a name="1150053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#70">[#70]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, there actually is.  See Luac, I think. <br><br></td></tr></table><br>
<a name="1150132"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#71">[#71]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I will definitely look into that!<br><br>One other question - has anyone out there found a way to get compiled Lua to use StandardIOStream?  I have it implemented in my engine and would like to redirect Lua Print commands to my console, but strangely, it seems to ignore the usual redirect StandardIOStream = ??.<br><br>Just wondering if anyone else had encountered this problem? <br><br></td></tr></table><br>
<a name="1150140"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#72">[#72]</a></td></tr></table></td></tr><tr ><td class="posttext"> I always found print() a little unpredictable.  You can just set print() to nil and add your own print function. <br><br></td></tr></table><br>
<a name="1150154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#73">[#73]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since I don't know how to get a variable list of arguments inside BMax, I made a Lua print() replacement that calls a Blitz version.  It works, but it's not as elegant as I'd hoped.<br><br>Thanks for your response, though. <br><br></td></tr></table><br>
<a name="1150194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#74">[#74]</a></td></tr></table></td></tr><tr ><td class="posttext"> Josh, I was trying out your method for Lua error handling and noticed that it only seems to work in debug mode.  Was that your result, as well?<br><br>What if you want to make a stand-alone app that compiles and runs Lua scripts, but doesn't end on Lua errors? <br><br></td></tr></table><br>
<a name="1150196"></a>

<a name="1150197"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#75">[#75]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Josh, I was trying out your method for Lua error handling and noticed that it only seems to work in debug mode. Was that your result, as well?<br><br>What if you want to make a stand-alone app that compiles and runs Lua scripts, but doesn't end on Lua errors?  <br></div><br>I've run across other undocumented behavior where Lua does not call debug hooks unless the DEBUG macro is defined.  So it would not surprise me if what you describe is true.<br><br>I just discovered today, I think LuaJIT never calls the Lua HOOK_LINE function, but that's a very advanced feature.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1150311"></a>

<a name="1150320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#76">[#76]</a></td></tr></table></td></tr><tr ><td class="posttext"> What you meant wasn't immediately obvious to me, but I seem to have the problem fixed.  I know this is a luajit thread, but I was still using maxlua because of an unknown module conflict that I had yet to track down.  Maxlua, if I'm not mistaken, doesn't define the DEBUG macro when Blitz is not in debug mode.  Luajit does, so it was a matter of finding the conflict that was preventing me from using it.<br><br>Now that I'm actually using luajit - problem solved!  Anyway, thanks for the advice.  :)<br><br>EDIT: One caveat is that my print function replacement no longer works.  It seems the hidden 'arg' table is not available in luajit.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1151302"></a>

<a name="1151303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#77">[#77]</a></td></tr></table></td></tr><tr ><td class="posttext"> ..<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1151973"></a>

<a name="1151974"></a>

<a name="1151975"></a>

<a name="1151976"></a>

<a name="1151977"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pineapple</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#78">[#78]</a></td></tr></table></td></tr><tr ><td class="posttext"> When attempting to compile my game using zeke.LuaJIT2 instead of pub.lua I get the build error:<br><br>C:/BlitzMax/lib/libgcc.a(unwind-sjlj.o): undefined reference to `__mingwthr_key_dtor'<br>C:/BlitzMax/lib/libgcc.a(unwind-sjlj.o): undefined reference to `_CRT_MT'<br><br>what?<br><br><br>edit: I tried recompiling jit and then rebuilding the module, as GW did. I got this build error:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Compiling:lapi.c
Compiling:lauxlib.c
Compiling:lbaselib.c
Compiling:lcoco.c
Compiling:lcode.c
Compiling:ldblib.c
Compiling:ldebug.c
Compiling:ldo.c
Compiling:ldump.c
Compiling:lfunc.c
Compiling:lgc.c
Compiling:linit.c
Compiling:liolib.c
Compiling:ljit_backend.c
Compiling:ljit_core.c
Compiling:ljit_dasm.c
Compiling:ljit_mem.c
Compiling:ljitlib.c
Compiling:llex.c
Compiling:lmathlib.c
Compiling:lmem.c
Compiling:loadlib.c
Compiling:lobject.c
Compiling:lopcodes.c
Compiling:loslib.c
Compiling:lparser.c
Compiling:lstate.c
Compiling:lstring.c
Compiling:lstrlib.c
Compiling:ltable.c
Compiling:ltablib.c
Compiling:ltm.c
Compiling:lua.c
Compiling:lundump.c
Compiling:lvm.c
Compiling:lzio.c
Compiling:print.c
Compiling:luajit1.bmx
flat assembler  version 1.68  (1427009 kilobytes memory)
3 passes, 20200 bytes.
Archiving:luajit1.debug.win32.x86.a
ar: creating C:/BlitzMax/mod/zeke.mod/luajit1.mod/luajit1.debug.win32.x86.a
Compiling:ljamalg.c
In file included from C:/BlitzMax/mod/zeke.mod/luajit2.mod/LuaJIT-2.0/src/ljamalg.c:58:
C:/BlitzMax/mod/zeke.mod/luajit2.mod/LuaJIT-2.0/src/lj_cparse.c: In function `cp_get_bs':
C:/BlitzMax/mod/zeke.mod/luajit2.mod/LuaJIT-2.0/src/lj_cparse.c:59: sorry, unimplemented: inlining failed in call to 'cp_get': function body not available
C:/BlitzMax/mod/zeke.mod/luajit2.mod/LuaJIT-2.0/src/lj_cparse.c:76: sorry, unimplemented: called from here
Build Error: failed to compile C:/BlitzMax/mod/zeke.mod/luajit2.mod/LuaJIT-2.0/src/ljamalg.c
Process complete</textarea><br><br>and the problem persists<br><br>edit2: jit1 works without consequence, but it would certainly be nice to also have the option of jit2<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1154510"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#79">[#79]</a></td></tr></table></td></tr><tr ><td class="posttext"> Running a for loop in Lua 100000 times and calling a single 'do nothing' function takes 100 times longer than doing the same thing in Blitz.<br><br>Is that the result I should expect?  Seems slower than I thought..  :( <br><br></td></tr></table><br>
<a name="1154591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BladeRunner</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#80">[#80]</a></td></tr></table></td></tr><tr ><td class="posttext"> As Lua is interpreted you can expect it to be lots slower than compiled code. Still Lua is one of the fastest interpreted scripting languages in existance. Did you try LuaJIT? <br><br></td></tr></table><br>
<a name="1154594"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#81">[#81]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is that the result I should expect? Seems slower than I thought.. :(  <br></div><br><br>That is actually pretty slow. Are you doing something like recompiling each time? Most professional-quality interpreters - which Lua is - are significantly faster than that (the number should be more like 3-10 depending on how complex the code is). <br><br></td></tr></table><br>
<a name="1154608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#82">[#82]</a></td></tr></table></td></tr><tr ><td class="posttext"> <textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

Framework brl.blitz
Import brl.standardio

Import pub.lua
'Import zeke.luajit1
'Import zeke.luajit2

Global l:Byte Ptr=luaL_newstate()
luaL_openlibs(l)

Local s:String="function callme() end~n~n"+..
"local t=os.clock()~n"+..
"for i=0,100000 do~n"+..
"	callme()~n"+..
"end~n"+..
"print(~qlua time= ~q..((os.clock()-t)*1000)..~qms~q)~n"

Print "lua script:~n"
Print s
Print "results:~n"

'lua test:
If luaL_dostring(l,s) Then
	Print "Error: "+lua_tostring(l,-1)
	End
EndIf


'bmx test:
Local t:Int=MilliSecs()
For Local i:Int=0 To 100000
	callme()
Next
Print "bmx time= "+(MilliSecs()-t)+"ms"

Function callme()
End Function
</textarea><br>Results:<br>[bbcode]<br>'pub.lua:<br>lua time = 15ms<br>bmx time = 0ms<br><br>'luajit1:<br>lua time = 2ms<br>bmx time = 1ms<br><br>'luajit2:<br>lua time = 0ms<br>bmx time = 0ms[/bbcode] <br><br></td></tr></table><br>
<a name="1154652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#83">[#83]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might want to crank up the number of iterations to at least a hundred million to get useful test results. Those times are too short to be statistically meaningful (for purposes other than "this is actually pretty fast"), both because the error margin for timing operations that way is a good deal higher than 15ms, and because too much detail is being truncated.<br><br>Doing that, I get:<br><br><pre class=code>'pub.lua
lua time= 12265ms
bmx time= 635ms

'luajit1
lua time= 3641ms
bmx time= 505ms

'luajit2
lua time= 110ms
bmx time= 506ms</pre><br><br>Now, that suddenly got interesting. <br><br></td></tr></table><br>
<a name="1154682"></a>

<a name="1154692"></a>

<a name="1154694"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#84">[#84]</a></td></tr></table></td></tr><tr ><td class="posttext"> My test was admittedly non-scientific.  I should be more specific about what I'm doing.  By the way, I'm not comparing pub to luajit1 to luajit2 (but I realize that's how this thread started).<br><br>I am using luajit2 and a slightly modified luGI to add luascript capability to my 3d engine.  My test was to call a function over and over, which is apparently slow in the LuGI lookup, then do the same in Blitz.  I did another where I assigned the function to a local first and that sped things up quite a bit (x5).  I am still a bit surprised by the initial result, though.<br><br>@Yasha - Recompiling each time?  Perhaps, but I'm not sure how to avoid that.  I didn't think we had any control over when luajit2 decides to do it.  I was looking into luac, but I haven't been able to find the right one (with byte code in the same format).<br><br>Thanks for all the responses!<br><br><font class="tiny">Last edited 2012</font><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1154956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#85">[#85]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Zeke - Which version of Luac should be compatible with luajit2, please? <br><br></td></tr></table><br>
<a name="1154992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#86">[#86]</a></td></tr></table></td></tr><tr ><td class="posttext"> use luajit.exe to generate byte code.<br><br>[bbcode]luajit -b source.lua dest.out[/bbcode]<br><br>Also you need to copy LuaJIT-2.0/lib folder to LuaJIT-2.0/src/ and rename lib to jit. <br><br></td></tr></table><br>
<a name="1155026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#87">[#87]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, it works!  Is all of that distributable?  In a commercial project?  Guess it would have to be called through the shell. <br><br></td></tr></table><br>
<a name="1161070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#88">[#88]</a></td></tr></table></td></tr><tr ><td class="posttext"> LuaJIT 2 updated to beta 11 <br><br></td></tr></table><br>
<a name="1161151"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#89">[#89]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks! <br><br></td></tr></table><br>
<a name="1165179"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#90">[#90]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya.. LuaJIT 2.0.0 Stable version released. links (first post) updated. <br><br></td></tr></table><br>
<a name="1180591"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#91">[#91]</a></td></tr></table></td></tr><tr ><td class="posttext"> And LuaJIT 2.0.1 version. (Hotfix #1 included). <br><br></td></tr></table><br>
<a name="1181975"></a>

<a name="1181976"></a>

<a name="1181979"></a>

<a name="1181980"></a>

<a name="1181981"></a>

<a name="1181982"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PriorBlue</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#92">[#92]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Zeke - Thank you for the frequent updates, it makes my programs faster every time (I use a lot of Lua Script :D)<br><br>But I found a weird memory leak with "on the fly" Blitzmax Types since luajit 2 and I have no Idea how to solve it.<br><br><b>Sample Code:</b><br>[bbcode]<br>Framework Brl.MaxLua<br>Import Brl.StandardIO<br><br>SuperStrict<br><br>Type TObject<br>	Method createObject2:TObject2()<br>		Return New TObject2<br>	End Method<br>End Type<br><br>Type TObject2<br>	Method printCount:String(cnt:Int)<br>		Print "cnt: " + cnt<br>	End Method<br>End Type<br><br>Local obj:TObject = New TObject<br>LuaRegisterObject obj, "Object"<br><br>'works with luajit 1 &amp; 2 (Workaround)<br>Local source$="cnt = 0 object2 = {} function printCount() object2[cnt] = Object.createObject2() object2[cnt].printCount(cnt) cnt = cnt + 1 end"<br><br>'works only with luajit 1 (luajit 2 has a memory leak after ~150 Runs)<br>'Local source$="cnt = 0 function printCount() object2 = Object.createObject2() object2.printCount(cnt) cnt = cnt + 1 end"<br><br>Local class:TLuaClass=TLuaClass.Create(source)<br>Local instance:TLuaObject=TLuaObject.Create(class,Null)<br><br>For Local i:Int = 0 To 99999<br>	instance.Invoke("printCount", Null)<br>Next<br>[/bbcode]<br><br><b>Explanation:</b><br><br>When I create a "Blitzmax Type" with lua and overwrite it with an other, my code gets a memory leak and crash after x runs, so I can't use the same variable over and over again.<br>I know there are workarounds like an permanent increased array of Types, but I hope there is a better solution.<br><br>PS: a "Threaded Build" is working a long time for me, before the memory leak appears. <br><br></td></tr></table><br>
<a name="1185746"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wiebo</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#93">[#93]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am trying to use the make command on the luajit2 src but I get the following error:<br><br>HOSTLINK  host/minilua<br>host/minilua.o: file not recognized: File format not recognized<br>collect2: error: ld returned 1 exit status<br>make: *** [host/minilua] Error 1<br><br>make on the luajit1 module works just fine. I am using Ubuntu 13.04 btw. Does anyone know how to overcome this? <br><br></td></tr></table><br>
<a name="1223873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PhotonTom</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#94">[#94]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry to revive this old thread but if you are looking for a working link then please see: <a href="http://www.blitzmax.com/Community/posts.php?topic=100728" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=100728</a> <br><br></td></tr></table><br>
<a name="1232518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#95">[#95]</a></td></tr></table></td></tr><tr ><td class="posttext"> The link is broken and the version of PhotonTom's link is the 2.0.0 beta 4, has anyone built a newer version with FFI? (FFI was released with beta 6) <br><br></td></tr></table><br>
<a name="1232592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#96">[#96]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've compiled LuaJIT 2.0.3 on Windows and then I placed it on the mod folder.<br><br><pre class=code>
Import "-Lmod/zeke.mod/luajit2.mod/LuaJIT-2.0.3/src"
Import "-lluajit"
</pre><br><br>It works when I build it, but when I try to build a program that uses this module I get this.<br><pre class=code>
Building execute
Compiling:execute.bmx
flat assembler  version 1.69.14  (1009141 kilobytes memory)
3 passes, 1635 bytes.
Linking:execute.exe
E:/Programas/BlitzMax/bin/ld.exe: cannot find -lluajit
Build Error: Failed to link D:/Escritorio/LuaJIT/execute.exe
Process complete
</pre><br><br>Does anyone know how to solve it? <br><br></td></tr></table><br>
<a name="1232630"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#97">[#97]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, before anyone else breaks his head trying to figure out how to get the newest LuaJIT working on BlitzMax. I had to place the LuaJIT-2.0.3 folder on BlitzMax/mod/zeke.mod/luajit2.mod/, and change the imports to these:<br><pre class=code>
Import "LuaJIT-2.0.3/src/lib_aux.c"
Import "LuaJIT-2.0.3/src/lib_base.c"
Import "LuaJIT-2.0.3/src/lib_bit.c"
Import "LuaJIT-2.0.3/src/lib_debug.c"
Import "LuaJIT-2.0.3/src/lib_ffi.c"
Import "LuaJIT-2.0.3/src/lib_init.c"
Import "LuaJIT-2.0.3/src/lib_io.c"
Import "LuaJIT-2.0.3/src/lib_jit.c"
Import "LuaJIT-2.0.3/src/lib_math.c"
Import "LuaJIT-2.0.3/src/lib_os.c"
Import "LuaJIT-2.0.3/src/lib_package.c"
Import "LuaJIT-2.0.3/src/lib_string.c"
Import "LuaJIT-2.0.3/src/lib_table.c"
Import "LuaJIT-2.0.3/src/lj_alloc.c"
Import "LuaJIT-2.0.3/src/lj_api.c"
Import "LuaJIT-2.0.3/src/lj_asm.c"
Import "LuaJIT-2.0.3/src/lj_bc.c"
Import "LuaJIT-2.0.3/src/lj_bcread.c"
Import "LuaJIT-2.0.3/src/lj_bcwrite.c"
Import "LuaJIT-2.0.3/src/lj_carith.c"
Import "LuaJIT-2.0.3/src/lj_ccall.c"
Import "LuaJIT-2.0.3/src/lj_ccallback.c"
Import "LuaJIT-2.0.3/src/lj_cconv.c"
Import "LuaJIT-2.0.3/src/lj_cdata.c"
Import "LuaJIT-2.0.3/src/lj_char.c"
Import "LuaJIT-2.0.3/src/lj_clib.c"
Import "LuaJIT-2.0.3/src/lj_cparse.c"
Import "LuaJIT-2.0.3/src/lj_crecord.c"
Import "LuaJIT-2.0.3/src/lj_ctype.c"
Import "LuaJIT-2.0.3/src/lj_debug.c"
Import "LuaJIT-2.0.3/src/lj_dispatch.c"
Import "LuaJIT-2.0.3/src/lj_err.c"
Import "LuaJIT-2.0.3/src/lj_ffrecord.c"
Import "LuaJIT-2.0.3/src/lj_func.c"
Import "LuaJIT-2.0.3/src/lj_gc.c"
Import "LuaJIT-2.0.3/src/lj_gdbjit.c"
Import "LuaJIT-2.0.3/src/lj_ir.c"
Import "LuaJIT-2.0.3/src/lj_lex.c"
Import "LuaJIT-2.0.3/src/lj_lib.c"
Import "LuaJIT-2.0.3/src/lj_load.c"
Import "LuaJIT-2.0.3/src/lj_mcode.c"
Import "LuaJIT-2.0.3/src/lj_meta.c"
Import "LuaJIT-2.0.3/src/lj_obj.c"
Import "LuaJIT-2.0.3/src/lj_opt_dce.c"
Import "LuaJIT-2.0.3/src/lj_opt_fold.c"
Import "LuaJIT-2.0.3/src/lj_opt_loop.c"
Import "LuaJIT-2.0.3/src/lj_opt_mem.c"
Import "LuaJIT-2.0.3/src/lj_opt_narrow.c"
Import "LuaJIT-2.0.3/src/lj_opt_sink.c"
Import "LuaJIT-2.0.3/src/lj_opt_split.c"
Import "LuaJIT-2.0.3/src/lj_parse.c"
Import "LuaJIT-2.0.3/src/lj_record.c"
Import "LuaJIT-2.0.3/src/lj_snap.c"
Import "LuaJIT-2.0.3/src/lj_state.c"
Import "LuaJIT-2.0.3/src/lj_str.c"
Import "LuaJIT-2.0.3/src/lj_strscan.c"
Import "LuaJIT-2.0.3/src/lj_tab.c"
Import "LuaJIT-2.0.3/src/lj_trace.c"
Import "LuaJIT-2.0.3/src/lj_udata.c"
Import "LuaJIT-2.0.3/src/lj_vm.o"
Import "LuaJIT-2.0.3/src/lj_vmevent.c"
Import "LuaJIT-2.0.3/src/lj_vmmath.c"
Import "LuaJIT-2.0.3/src/ljamalg.c"
Import "LuaJIT-2.0.3/src/luajit.c"
</pre><br>It seems to work fine. <br><br></td></tr></table><br>
<a name="1232635"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#98">[#98]</a></td></tr></table></td></tr><tr ><td class="posttext"> The simplest and most cross-platform way to handle it is to just replace the import lines with one import "LuaJIT-2.0.3/src/libluajit.a", having run Make as per the LuaJIT documentation (which should mostly be "make CC=gcc -m32"). That way you don't need to import .o or .c files from Max, which is simpler and leaves less up to Max's compiler. Importing .c files from Max means that BlitzMax calls GCC itself rather than using prebuilt binaries, which can be simpler, or it can potentially be messy.<br><br><br><div class="quote"> It works when I build it, but when I try to build a program that uses this module I get this. <br></div><br><br>The sneaky problem here is that it didn't actually work when you built it. When you just build modules (i.e. .o files), the compiler doesn't care if it can't find symbols because it assumes they'll be provided at program link time. Therefore if Import directives are wrong, it won't always notice. <br><br></td></tr></table><br>
<a name="1239391"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferret</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#99">[#99]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm new to Lua and have some questions.<br><br>How do i expose mi own BlitzMax functions, types and variables to Lua?<br>Is it possible to extend BlitzMax types in Lua? <br><br></td></tr></table><br>
<a name="1239395"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PhotonTom</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#100">[#100]</a></td></tr></table></td></tr><tr ><td class="posttext"> I recommend you use <a href="https://github.com/nilium/lugi.mod" target="_blank">https://github.com/nilium/lugi.mod</a> <br>This allows you to use your own blitzmax types in lua and before you call a lua function in blitzmax you can also send blitzmax objects/variables to your lua function. <br>This code although badly commented should help:<br>lua.bmx<br><pre class=code>
Framework BRL.StandardIO
Import BRL.FileSystem
Import BRL.Blitz
Import BRL.System
Import LuGI.Core
Include "glue.bmx"

'Import LuGI.Generator
'GenerateGlueCode("glue.bmx")
'End

Global testing:TDemo

Type TDemo {expose}

	Field name:String 
	Field oldname:String
	Field mylist:TList

	Method SayHello$( name$ )
		Self.name = name:String 
		Return "Hello "+name+"! Peace be with you..."
	End Method
	
	Method addtolist(text:String)
	
		If mylist=Null Then 
			mylist=CreateList()
		EndIf 
		ListAddLast(mylist,text)
	
	End Method
	
	Method GetSelf:TDemo()
		Return Self
	End Method

End Type

Local source:String = openSource("test.lua")

Local state:Byte Ptr = luaL_newstate()
InitLuGI(state)

luaL_openlibs(state)

'Load our code/compile
Local Result:Int = luaL_loadstring(state,source)
If (Result &lt;&gt; 0) Then
  	' ERROR!!!
	Print "error!"
	lua_close(state) ' just to be complete
 	End
End If

'Call this after loading in lua code, not sure exactly why but you must do it 
lua_pcall(state,1,-1,-1)

'load a type
demo2:Tdemo = New TDemo
demo2.oldname = "oh dear"

'put function onto stack
lua_getfield(state, LUA_GLOBALSINDEX, "test")
'put object onto stack
lua_pushbmaxobject( state, demo2 )
'call function that returns a blitzmax object and takes demo2 object as input
lua_call(state, 1, 1) ' 2nd variable is number of inputs to function, 3rd variable is number of outputs returned to lua stack

'get returned object from stack
obj:Object = lua_tobmaxobject( state, 1 )
demo:TDemo = TDemo(obj)

'clean up stack by removing our returned object from stack
lua_pop(state,1)

Print demo.name
Print demo.oldname

lua_close(state)

Print "list"
For text:String = EachIn demo.mylist
	Print text
Next

Function openSource:String(File:String)
	Local line:String
	Local source:String
	Local luasource:TStream = ReadFile(File)
	Repeat
		line = ReadLine(luasource) 
		source = source + line +"~n~r"
		If Eof(luasource) Then Exit 	
	Forever
	Return source
End Function  
</pre><br><br>text.lua<br><pre class=code>
function test(demo)
	print( demo:SayHello( 'Fredborg' ) )
	demo:addtolist("hello")
	demo:addtolist("hello2")
	return demo
end
</pre><br><br>Note that to generate the glue.bmx file you must uncomment the following lines <br><pre class=code>
'Import LuGI.Generator
'GenerateGlueCode("glue.bmx")
'End
</pre><br>and comment the following line<br><pre class=code>
Include "glue.bmx"
</pre><br><br>For more info on how to use lugi see here <a href="https://github.com/nilium/lugi.mod/wiki" target="_blank">https://github.com/nilium/lugi.mod/wiki</a> <br><br></td></tr></table><br>
<a name="1239420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ferret</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#101">[#101]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thx, its always nice to have a working example. <br><br></td></tr></table><br>
<a name="1252317"></a>

<a name="1252318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#102">[#102]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Yasha: would've done it, the problem is that Zeke's LuaJIT version is outdated and it doesn't have FFI. I got the latest one from LuaJIT's website, it doesn't have libluajit.a, I don't know how to compile that. It's working on windows, but now that I'm trying to compile my program for Linux I found out that for some reason it fails to compile lj_vm.o.<br><br>Can anyone help me on that, please? <br><br></td></tr></table><br>
<a name="1252334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#103">[#103]</a></td></tr></table></td></tr><tr ><td class="posttext"> Zekes module absolutely has ffi. I've used it for years and the module comes with examples using the ffi. <br><br></td></tr></table><br>
<a name="1252405"></a>

<a name="1252406"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#104">[#104]</a></td></tr></table></td></tr><tr ><td class="posttext"> @GW: Are you sure? I tried to get FFI working but it just told that the module was missing or something like that. But anyways, with that version I'm getting about 15GHz of speed, I get 20GHz with the newer one. I just need to make it run on Linux, for that it might be necessary to compile a new libluajit.a which is what I don't know how to do. <br><br></td></tr></table><br>
<a name="1252619"></a>

<a name="1252620"></a>

<a name="1252624"></a>

<a name="1252664"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2014)</font>&nbsp;<a href="#105">[#105]</a></td></tr></table></td></tr><tr ><td class="posttext"> Alright I've managed to compile LuaJIT until a point where the command<br><pre class=code>
ar rcs libluajit.a *.o
</pre><br>prints<br><pre class=code>
ar: *.o: Invalid argument
</pre><br>How should I get libluajit.a if this command does not work?<br><br>Edit: I had to compile one by one, each one of the .o files. I got libluajit.a with a size of 540kbs (making sure to tell because I could've missed some file). Compiling Zeke's LuaJIT works until I run my program with the module, after that I'm getting this error:<br>E:/Programas/BlitzMax/lib/libluajit.a(lib_os.o):lib_os.c:(.text+0x12e): undefined reference to `_difftime64'<br><br>What should I do?<br><br>Edit2: Finally I got a working libluajit.a for Windows, but for some reason this method does not work on Linux because the BlitzMax linux does not recognize the .a file, I don't know what to do now because it doesn't import .o files. <br><br></td></tr></table><br>
<a name="1253437"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Schlachtwerk</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#106">[#106]</a></td></tr></table></td></tr><tr ><td class="posttext"> The Webseite is Offline, no luajit Download :( <br><br></td></tr></table><br>
<a name="1253474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#107">[#107]</a></td></tr></table></td></tr><tr ><td class="posttext"> I put up a copy of the latest version of the zeke.luajit mod that I could find. <a href="http://www.gutterbox.com/download/zeke.mod.zip" target="_blank">http://www.gutterbox.com/download/zeke.mod.zip</a> <br><br></td></tr></table><br>
<a name="1253484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#108">[#108]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> How should I get libluajit.a if this command does not work? <br></div><br><br>Why aren't you using LuaJIT's build process?<br><br>As above, you should not be compiling these files by hand. Nobody can guess where this stuff is going wrong if you have a non-standard build, because the chances are all sorts of parameters have been set incorrectly as a result of compiling separately. Just use the makefile and libluajit.a will appear in the src folder. <br><br></td></tr></table><br>
<a name="1254462"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#109">[#109]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had to do magic in order to build it, but at least it works for Linux and Windows (I haven't compiled it on MacOS yet).<br><br><a href="http://www.mediafire.com/download/9anu685vphaqyw5/luajit.zip" target="_blank">http://www.mediafire.com/download/9anu685vphaqyw5/luajit.zip</a><br>I added some other modules I needed as LuaSocket, Extension Proposal, Lua File System, LuaLanes and MD5.<br><br>If you ever decide to use one of these, you may call the functions this way.<br><pre class=code>
luaopen_socket_core(L) ' LuaSocket
luaopen_mime_core(L) ' Mime is included in LuaSocket
luaopen_md5_core(L) ' MD5
luaL_requiref(L, "ex", luaopen_ex, 0) ' Extension Proposal
luaL_requiref(L, "lfs", luaopen_lfs, 0) ' Lua File System
luaL_requiref(L, "lanes.core", luaopen_lanes_core, 0) ' Lanes core (it requires lanes.lua)
</pre><br><br>@Yasha: I did not understand a single word. <br><br></td></tr></table><br>
<a name="1254473"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#110">[#110]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @Yasha: I did not understand a single word. <br></div><br><br>To build LuaJIT, you open a command prompt and type `make`. That's <i>literally all</i>, on every OS. There should be no need to make it more complicated than that.<br><br>I'm therefore wondering what obstacle you are encountering that's making it impossible to use the normal method? <br><br></td></tr></table><br>
<a name="1254634"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Starkkz</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#111">[#111]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Yasha: the "make" method just generates .o files, I've got to make the libluajit.a by myself. MinGW's ar does not work for this, I had to use BlitzMax's ar. When I load libluajit.a from BlitzMax on Windows it misses some clock functions, basically loading every .c file and lj_vm.o works better for me. Actually it's the only way that works for me and I prefer not to change it rather than breaking something. <br><br></td></tr></table><br>
<a name="1254638"></a>

<a name="1255060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#112">[#112]</a></td></tr></table></td></tr><tr ><td class="posttext"> Make would be rather useless if all it could do was generate .o files...<br><br>OK so apparently you need to use the secondary makefile for Windows targets. It <i>does</i> generate libraries; if it doesn't, something is broken on your system. You might need to change BUILDMODE from mixed to static, can't tell from here.<br><br><br>I still recommend that you do change it, because your build <i>is already broken</i>, that much is clear; and hand-crafting this stuff is hardly a future-proof option. This issue is even <a href="http://luajit.org/install.html" target="_blank">called out in the documentation</a>:<br><br><div class="quote"> If you're a package maintainer for a distribution, please make use of these features and avoid patching, subverting, autotoolizing or messing up the build system in unspeakable ways.<br><br>There should be absolutely no need to patch luaconf.h or any of the Makefiles. And please do not hand-pick files for your packages  simply use whatever make install creates. There's a reason for all of the files and directories it creates. <br></div> <br><br></td></tr></table><br>
<a name="1255175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hummelpups</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#113">[#113]</a></td></tr></table></td></tr><tr ><td class="posttext"> anyone that uses this module on mac?<br><br>i dont know the exact error yet because im at work<br><br>there seems to be something missing for ld.exe?<br>Import "-lmingw32"<br>Import "-lgcc"<br><br>i will post the rror in a few hours and edit that <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
