<!DOCTYPE html><html lang="en" ><head ><title >Running the Main Loop inside New()</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Running the Main Loop inside New()</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Running the Main Loop inside New()</a><br><br>
<a name="1061908"></a>

<a name="1061909"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey,<br><br>I'd like to know whether it is a bad choice architecture-wise to run the main loop inside the "constructor" of a type.<br><br>On my part, I just found it cool to do this:<br><pre class=code>
Global game:MyGame = New MyGame
</pre><br>.. whereas the rest happens in MyGame::New<br><br>Thanks for your replies!<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1061913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leon Drake</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see nothing wrong with that if that is how you want to do it. <br><br></td></tr></table><br>
<a name="1061920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ProfJake</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> But when the rest happens in New, why do you assign it to a Global?<br><br>My opinion: It's not that clean to my mind, since when I read this code I would not expect the game to be run already. <br><br></td></tr></table><br>
<a name="1061924"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would create a separate method or function within the type for running your singleton. I do the following in one of my projects.<pre class=code>New app.Run</pre>Where app is the singleton type and Run is a method of that type with the main app loop inside. In fact that line above is the only code in the program that isn't a type. Doing it this way means that your object gets fully created before then running the main method/function. <br><br></td></tr></table><br>
<a name="1061941"></a>

<a name="1061942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> In fact that line above is the only code in the program that isn't a type. <br></div><br><br>Yea, that was exactly my aim too. I tried moving the global into type scope, but there is an <a href="/posts.php?topic=89648" target="_blank">issue</a> with using reflection inside the constructor of an object assigned to a global declared in type scope, that made me doing otherwise.<br><br><div class="quote"> New app.Run <br></div><br>Awesome idea, Thanks!<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1061943"></a>

<a name="1061944"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why do you need to use reflection on your game type???<br><br>I find this works well enough.<br><br><pre class=code>Local game:TGame = New TGame
game.Load()
game.Run()
End</pre><br><br>I personally would not put main game code inside the New method, as the method is "meant" for start-up code to initialize an object. From the computer's point of view, I don't think there is any problem (though you might want to make your type Final).<br><br><font class="tiny">Last edited 2010</font> <br><br></td></tr></table><br>
<a name="1061947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suspect this falls into the category of what C++ calls "undefined behaviour". Roughly translated into Blitz-speak, it means "I can't think of any bad consequences right now, but Mark has every right to change or add something which will cause your application to explode hideously, and you won't have any comeback because you did something you weren't technically supposed to do."<br><br>In practice, I believe Mark does everything a constructor needs to do internally before he calls your New method, and it's highly unlikely that he would change that behaviour because it's in his interest to make this a user-friendly language which lets you do things you shouldn't do. Still, I would (and did) use the same technique that Oddball demonstrates. <br><br></td></tr></table><br>
<a name="1061956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Why do you need to use reflection on your game type??? <br></div><br>Calm down man.. alright: Just one example: In my game type, I mark certain methods as callable from the console by appending metadata to them. I then reflect on the game type and iterate through the methods, to find and register the "public" ones. Just one example.<br><br>But back on topic, I am Oddbals' solutions' biggest fan, I must admit :} <br><br></td></tr></table><br>
<a name="1061972"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's one way to make a menu I guess!<br><br>Have you considered Lua? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
