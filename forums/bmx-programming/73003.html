<!DOCTYPE html><html lang="en" ><head ><title >No File/Foldername Unicode support at all?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >No File/Foldername Unicode support at all?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >No File/Foldername Unicode support at all?</a><br><br>
<a name="815956"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I got a email from a person who want to translate my application to russia, but I have ran into big troubles.<br><br>It seen no file commands can read any of Cyrillic chars in files and folder names. I have not looked it does this on Linux, but it does these quicks in Windows.<br><br>All it does it just translate any letter to ?<br><br>I'm use Vista can fine can see the chars I got from that email. <br><br></td></tr></table><br>
<a name="815997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> bwt this code does not work and still shot the same dir as the first:<br><br><pre class=code>
ChangeDir("D:\Musik\temp")
Print CurrentDir$()
ChangeDir("D:\Musik\temp\Предыдущая")
Print CurrentDir$()
</pre><br><br>Look like BlitzMax filesystem do not work with unicode at all? Why do it so support unicode strings? <br><br></td></tr></table><br>
<a name="816006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>No, there is no filesystem level unicode support and none is planned. <br><br></td></tr></table><br>
<a name="816008"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> :-(. My App is not been arviable to translate to this language.<br><br>The problem is I have created a Mp3 jukebox application with not needing to use ID3 tags (which I by now even wont passable with same reason). <br><br></td></tr></table><br>
<a name="816286"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does this mean if I allow a player to enter their name using Unicode, then I save their profile using that name, it won't work? <br><br></td></tr></table><br>
<a name="816291"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BladeRunner</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Does this mean if I allow a player to enter their name using Unicode, then I save their profile using that name, it won't work? <br></div><br>Seems to be exact what qould happen. <br><br></td></tr></table><br>
<a name="816292"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >popcade</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grey:<br><br>This was mentioned in another thread about safe file name characters, some of them just won't work and don't throw error out, but the file won't be actually saved if the name contains some special characters. <br><br></td></tr></table><br>
<a name="816293"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK thanks, looks like I'll have to rethink how my profile saving code works... <br><br></td></tr></table><br>
<a name="816367"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem is quite simple here:<br><br>BM supports stone age windows (Win98 / ME)<br>Good thing many might think.<br>Bad thing here is that both only support Unicode through an extra patch and Win98 even only if you had the SE or updated to it. As both are abandonned you can't get this patch any further.<br><br>Without that, unicode aware software just bombs out. (experience from Torque, annoying and hard to overcome. Either you have UC or you don't have it, point)<br><br><br>If BM was simply put up to Windows 2000 minimum requirements (heck it asks for OSX 10.3 which would mean WinXP on the Windows side), adding unicode would be less of a problem. <br><br></td></tr></table><br>
<a name="816683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> It could been checking which OS and testing if unicode is in system or not? Example Vista seen to been support unicode in the box, while XP need to install addiation lanuage in most chase.<br><br>This is simple because it might used for example music files, which they typically used thier own language. I have instead in my own software support romanization, so you can translate latin letters to a other alphabet.<br><br>For data files, this should never been happen. I of course never use unicode letters to make sure it work on all machines.<br><br>But it something other when I have created a jukebox application (MultiJuke) with language support.<br><br>And what about Linux. I have not tested on this chase, how it does. <br><br></td></tr></table><br>
<a name="816684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey Alien:<br>You cant save unicode based filenames, so if they do it, it wont work. even requestDir didden't work with unicode.....<br><br>So use number as savegame files, or use md5 or such hash based code to change the string into a latin filename freidly file using latin letters. <br><br></td></tr></table><br>
<a name="816715"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, yeah I'm going to have to swap to using a number and then reading them all in and reading the player names to fill up my profile list. <br><br></td></tr></table><br>
<a name="816836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a dll to support unicode on win98: unicows.dll<br><br>So I hope I see a day to support unicode filenames, so my app can use the same way as Media Player and Winamp (which both nothing have anything problems with them).<br><br>Reading Unicode (UTF-8) text files is not a problem. There is code for it on this forum. <br><br></td></tr></table><br>
<a name="816841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Once again, its not the OS that is the problem.<br>BM does not support it in low level and it is not planned to come as you can see above in Marks post.<br><br>Since first Win2k Release, Windows has had Unicode Support but Blitz never got any further than supporting unicode at String level. Something not happening in the last 6 years won't happen now just out of the nowhere. <br><br></td></tr></table><br>
<a name="816870"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it anyway to change the codepage than the standard one (I remember Latin use 437)?<br><br>Example if you are in an russia codepage, the english chars are not available, and if you are in an english codepage, then the russia will not be available. <br><br></td></tr></table><br>
<a name="816896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >popcade</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Space Fractal<br><br>Did you tried Win32API like SetCurrentDirectoryW()?<br>However it'll become non-cross-platform. <br><br></td></tr></table><br>
<a name="817022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> No Not yet. MultiJuke was ported to Linux, so I might hold it cross platform. But I guess I got a workaround, but I wait for the report on the work from the email.<br><br>It seen the Russia Windows actually used ascii table on filename with this charset used: <a href="http://www.ascii.ca/cp1251.htm" target="_blank">http://www.ascii.ca/cp1251.htm</a><br><br>Hence I have copy paste from the page (not source code) over to notepad (which seen support unicode in Vista) and save it as UTF-8.<br><br>Then I used the table to convert the ascii filenames to unicode, so it show the currect codes:<br><br><pre class=code>
Type TCodebase
	Field Alphabet$
	Field Char:String[]=New String[256]
	Global List:TList=New TList
	Global Count=0
	Global current:String[]=New String[256]
	Global currentAlphabet$
	Function Init()
		Local files$[]
		Local Path$=CurrentDir()+"/alphabet/"
		files=LoadDir(Path$, True)
		For Local t$ = EachIn files
			Local in:TTextStream=TextFileReader.CreateStream(path$+T$)
			If in&lt;&gt;Null
				Local s:TCodebase = New TCodebase
				While Eof(In)=0
					Local TXT$=ReadLine(in)
					If Left$(TXT$,2).toInt()&gt;0
						Local Number=Left$(TXT$,3).toInt()
						TXT$=Right$(TXT$,Len(TXT$)-6)
						If Left$(TXT$,1)=" " Then TXT$=Right$(TXT$,Len(TXT$)-1)
						TXT$=Trim$(TXT$)
						Local Letter$=Left$(TXT$,2)
						Letter$=Trim$(Letter$)
						If Number&gt;32
							s.Char$[Number]=Letter$
						Else
							s.Char$[Number]=" "
						EndIf
					EndIf
				EndWhile
				s.Alphabet$=StripAll$(t$)
				Count:+1
				List.AddLast(s)
			EndIf
		Next
	EndFunction

	Function Set:Int(Alphabet$)
		currentAlphabet$=""
		current:String=New String[256]
		For Local s:TCodebase = EachIn List
			If Alphabet$=s.Alphabet$ 
				For Local i=0 To 255
					current[i]=s.Char[i]
				Next
				currentAlphabet$=s.Alphabet$
				Return 1
			EndIf
		Next
	EndFunction

	Function Name$(Number)
		If Number=&gt;CountList(List) Then Return ""
		Return TCodebase(List.ValueAtIndex(Number)).Alphabet$
	EndFunction

	Function Translate$(txt$)
		Local Result$=""
		For Local i=1 To Len(Txt$)
			Local char:Int=Asc(Mid$(Txt$, i,1))
			Result$=Result$+Current[char]
		Next
		Return Result$
	EndFunction
EndType
</pre><br><br>I hope that one works.<br><br>For hiscore and general translating, I recommered to UTF-8 based text files and no not use unicode filename (this make sure it work on all OS when moving). There are a code on this forum to read them correctly (or use readtext() and savetext()). <br><br></td></tr></table><br>
<a name="822362"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I finally got some unicode file level support to work with using Pure Basic commands for files and send it to BlitzMax.<br><br>Pure Basic seen to support unicode, but was a bit hidden and need to been enabled first and it stated in help it diddent support it and in other place it state fully supported.<br><br>Otherwice I use some thing like this to get the dll to work when created:<br><br><pre class=code>
Global WRAPPER_DLL
WRAPPER_DLL=LoadLibraryA("purebasicdll.dll")

Global ReadUnicodeDir$w(dir:Byte Ptr) "Win32" = GetProcAddress(WRAPPER_DLL,"ReadDir")
Global CheckFile:Int(dir$w) "Win32" = GetProcAddress(WRAPPER_DLL,"CheckFile")
</pre><br><br>Make sure to use the orignal blitz max commands when using Linux, since the above might break combatible.<br>.....<br><br>Now I need to see I can get blitzmax to read files from memory using a pointer, returned from Pure Basic (might been only that way to get streams to work when it using unicode files). Here I might create a new thread. <br><br>Lock this thread, if you wich. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
