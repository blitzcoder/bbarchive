<!DOCTYPE html><html lang="en" ><head ><title >Conio module (WIN32)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Conio module (WIN32)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Conio module (WIN32)</a><br><br>
<a name="757727"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heres a module wrapper for the Conio library (Console IO) for <b>WIN32</b>.<br><br>Functions to print colored text anywhere in a console window.<br><br>The library just wraps the relevant Win32API calls but its a much nicer interface ;)<br><br>I also added some handy utility functions.<br><br>Enjoy!<br><br>EDIT: updated, added functions to resize the window &amp; buffer<br><br><a href="http://grable0.googlepages.com/grb.conio.mod.rar" target="_blank">Download</a> <br><br></td></tr></table><br>
<a name="758073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heres screenshot for the lazy.. hehe<br><img src="http://grable0.googlepages.com/conio_bmx.png"> <br><br></td></tr></table><br>
<a name="758074"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think people might show more/any interest if they knew what it was/what its useful for. <br><br></td></tr></table><br>
<a name="758080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm.. i suppose your right, although its realy nothing special.<br><br>Its just some functions that allows you to print colored text anywhere in a console/terminal.<br><br>With a few helper functions for making boxes,lists,etc and convert an attributed string into something that can be printed<br><br>example:<br><pre class=code>
' $00-15 = background color
' #00-15 = foreground color
PutString( 1,1, "$09#14Press any key to exit...")
</pre><br>I needed this for a console based vm debugger im working on,<br>and i thought others might have use for it as well. <br><br></td></tr></table><br>
<a name="758096"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LAB[au]</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks! I don't know if I will do something with it but anyhow it's cool ;) <br><br></td></tr></table><br>
<a name="758135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Triforce Guardian</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a bug. Running Windows Vista Home Basic, fully updated. <img src="http://img186.imageshack.us/img186/4087/buggt5.png"> <br><br></td></tr></table><br>
<a name="758142"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm.. thats wierd, seems like vista is using a font that doesnt handle extended characters properly. <br>It could also be your language set (if any) that has rearranged the table (unlikely).<br><br>Open the console properties and check the font tab, and post what font its using.<br><br>And could you post a screen of the <b>chartab.exe</b> example also?<br>It should be similar to the screenshot i posted above.<br><br>Also test the included example exe's to see if they do this too.<br><br>Sorry i dont have vista to test myself :/ <br><br></td></tr></table><br>
<a name="758143"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Triforce Guardian</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, I'll try to work out a fix for you. It doesn't seem to be a big issue.<br>EDIT: Ran chartab.exe and there does seem to be missing characters. I changed the font and same result. I'll see what I can do to patch this. <br><br></td></tr></table><br>
<a name="758145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, much appreciated =) <br><br></td></tr></table><br>
<a name="758167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I added 2 new functions to resize the console window and set its buffer (removes the ugly scrollbars ;)<br><br>Its done automatically by <b>InitConio() &amp; FreeConio()</b> (they just handle common start/end stuff you can do manually if needed) <br><br></td></tr></table><br>
<a name="758173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm..useless except for a ZZT clone or a BBS. LOL <br><br></td></tr></table><br>
<a name="758229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Hmm..useless except for a ZZT clone or a BBS. LOL <br></div><br>Heh, most of the things i code are in console mode. So i wouldn't call it useless. <br><br></td></tr></table><br>
<a name="758276"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm sorry, it is probably very useful for other things too. I remember once I made a complete GUI system with ASCII characters. <br><br></td></tr></table><br>
<a name="758802"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> This is very cool :-)<br><br>A lot of people/companies still use console mode for their UIs (generally it's much faster to navigate a text-only UI than it is to move the mouse and click stuff)<br><br>Reminds me of curses and stuff on Unix...  (now.. there's an idea.....) <br><br></td></tr></table><br>
<a name="869524"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Panno</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> remember me on a old powerbasic gui<br>cool <br><br></td></tr></table><br>
<a name="869525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dabhand</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I suppose it would be handy for some stuff... When I did a fruit machine simulator it all started out on a console, mostly running millions of spins and seeing if the odds were running correctly when lines would drop in.<br><br>Using this would of tarted it up nicely! :D <br><br></td></tr></table><br>
<a name="879346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there anyway to get this working when run from the IDE? <br><br></td></tr></table><br>
<a name="879363"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >deps</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess not. The IDE is not a console terminal. <br><br></td></tr></table><br>
<a name="879412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Looks great.  Who's going to write the first BlitzMax Dwarf Fortress clone with it then? :) <br><br></td></tr></table><br>
<a name="879514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm doing a small roguelike. <br>The best choice for the interface would be <a href="http://jice.nospam.googlepages.com/thedoryenlibrary" target="_blank"> this C library</a>   <br><br>But sadly, my C skills are not enough to create the interface.<br>Without a reliable curses lib for Bmax, i'm writing my own. <br><br></td></tr></table><br>
<a name="898186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone know how to clear the keyboard buffer in grb.conio.mod? <br><br></td></tr></table><br>
<a name="898260"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Anyone know how to clear the keyboard buffer in grb.conio.mod? <br></div><br>I dont know if blitz uses the right security bits, but this should work:<br><pre class=code>
Extern "Win32"
	Const STD_INPUT_HANDLE:Int = -10
	Const STD_OUTPUT_HANDLE:Int = -11
	Const STD_ERROR_HANDLE:Int = -12
	Function GetStdHandle:Int( stdh:Int)
	Function FlushConsoleInputBuffer:Int( console:Int)
EndExtern

Function FlushInput()
	FlushConsoleInputBuffer( GetStdHandle( STD_INPUT_HANDLE))
EndFunction
</pre> <br><br></td></tr></table><br>
<a name="898525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sledge</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers, I'll give that a go.<br><br>EDIT: Looks good! I had a little Millisecs() based hack in place that has been duly relegated to a fallback.<br><pre class=code>Const FLUSHKEYS_WITH_GRABLE_CODE:Int = True</pre> :D <br><br></td></tr></table><br>
<a name="901998"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >iamdaman13</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows changes so much that I finally decided to make my roguelikes cross compatible by making all my characters and extended characters tiled images that look like text :) <br><br></td></tr></table><br>
<a name="912624"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >impixi</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, resurrecting an old topic, and posting a slightly OT response...<br><br>For those with MaxGui, you could probably create a decent cross-platform technique based on the HTML gadget, for use in Roguelike games. Eg: <br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

Framework MaxGUI.Drivers
Import BRL.Timer
Import BRL.Retro

SeedRnd MilliSecs()

Global Terminal:THTMLTerm = THTMLTerm.Create("Roguelike Experiment", -1, -1, 800, 600, 60, 20)

AddHook EmitEventHook, ProcessEvent

Repeat

	WaitSystem

Forever


End


Function ProcessEvent:Object(id:Int, data:Object, context:Object)

	Local ev:TEvent = TEvent(data)

	Return Terminal.CheckEvent(ev)

EndFunction


Type THTMLTerm


	Function Create:THTMLTerm(title:String = Null, x:Int = -1, y:Int = -1, ..
		w:Int = 640, h:Int = 400, ccols:Int = 70, crows:Int = 25)
	
		Local term:THTMLTerm = New THTMLTerm

		If Not title Then title = AppArgs[0]

		Local flags:Int = WINDOW_TITLEBAR | WINDOW_RESIZABLE
		If x &lt; 0 And y &lt; 0 Then flags = WINDOW_TITLEBAR | WINDOW_CENTER | WINDOW_RESIZABLE

		term.Window = CreateWindow(title, x, y, w, h, Null, flags)
		term.HTMLView = CreateHTMLView(0, 0, ClientWidth(term.Window), ClientHeight(term.Window), ..
			term.Window, HTMLVIEW_NOCONTEXTMENU | HTMLVIEW_NONAVIGATE)
		term.Panel = CreatePanel(0, 0, ClientWidth(term.Window), ClientHeight(term.Window), ..
			term.Window, PANEL_ACTIVE)
		term.Timer = CreateTimer(60)

		HideGadget term.panel
		
		term.URL = AppDir + "/temp.html"
		
		term.CharTable = TCharTable.Create(ccols, crows)
				
		term.CharTable.exportHTML term.URL

		HtmlViewGo term.HTMLView, term.URL
		
		Return term
	
	EndFunction


	Field URL:String

	Field Window:TGadget
	Field HTMLView:TGadget
	Field Panel:TGadget
	Field Timer:TTimer
	
	Field CharTable:TCharTable
	
	
	Method CheckEvent:TEvent(ev:TEvent)
	
		Select ev.id
	
			Case EVENT_TIMERTICK
				If ev.Source = Timer Then ActivateGadget Panel
	
			Case EVENT_KEYDOWN
				If ev.Source = Panel
				
					Select ev.data
					
						Case KEY_ESCAPE 
							EmitEvent CreateEvent(EVENT_APPTERMINATE)
							
						Case KEY_SPACE
							CharTable.test URL
							HtmlViewRun HTMLView, "window.location.reload();"
							
					EndSelect
				EndIf
	
			Case EVENT_WINDOWSIZE
				resize
	
			Case EVENT_WINDOWCLOSE
				If ev.Source = Window Then EmitEvent CreateEvent(EVENT_APPTERMINATE)

			Case EVENT_APPTERMINATE
				End

		EndSelect
		
		Return ev
	
	EndMethod

	
	Method resize()
	
		SetGadgetShape HTMLView, 0, 0, ClientWidth(Window), ClientHeight(Window)
		SetGadgetShape Panel, 0, 0, ClientWidth(Window), ClientHeight(Window)
	
	EndMethod
	

EndType


Const STYLE_NORMAL:Byte = 0
Const STYLE_ITALIC:Byte = 1
Const STYLE_OBLIQUE:Byte = 2
	
Const WEIGHT_NORMAL:Byte = 0
Const WEIGHT_BOLD:Byte = 1

Const DECOR_NONE:Byte = 0
Const DECOR_UNDERLINE:Byte = 1
Const DECOR_OVERLINE:Byte = 2
Const DECOR_LINETHROUGH:Byte = 3


Type TCharTable


	Field FFamily:String			'Any valid CSS text applicable to "font-family"
	Field FSize:String				'Any valid CSS text applicable to "font-size"
	Field BodyBGColor:String			'Any valid CSS text applicable to "background-color"
	
	Field Cells:TCharCell[,]
	Field Cols:Int, Rows:Int
	
	
	Function Create:TCharTable(cs:Int, rs:Int, url:String = "temp.html")
	
		Local tbl:TCharTable = New TCharTable
	
		tbl.Cols = cs
		tbl.Rows = rs
		
		tbl.Cells = New TCharCell[tbl.Cols, tbl.Rows]
		
		For Local r:Int = 0 To tbl.Rows - 1
			For Local c:Int = 0 To tbl.Cols - 1
				tbl.Cells[c, r] = New TCharCell
			Next
		Next
			
		tbl.setCSSFont "courier, monospace", "1.5em"

		tbl.setBodyBGColor $000000, True
		
		'tbl.initAllCells Asc("."), $FFFFFF, $000000, STYLE_NORMAL, WEIGHT_NORMAL, DECOR_NONE

		tbl.test url

		'tbl.exportHTML url

		Return tbl
	
	EndFunction


	Method setCSSFont(family:String = "courier, monospace", size:String = "1em")
	
		FFamily = family
		FSize = size
		
	EndMethod


	Method setBodyBGColor(color:Int, allchars:Int = False)
	
		BodyBGColor = "#" + Right(Hex(color), 6) + ";"
		
		If allchars
			For Local c:Int = 0 To Cols - 1
				For Local r:Int= 0 To Rows - 1
					Cells[c, r].setBGColor color
				Next
			Next
		EndIf
	
	EndMethod


	Method setCellChar(col:Int, row:Int, ch:Int)
	
		Cells[col, row].setChar ch	
	
	EndMethod


	Method setCellFGColor(col:Int, row:Int, fgc:Int)
	
		Cells[col, row].setFGColor fgc	
	
	EndMethod

	
	Method setCellBGColor(col:Int, row:Int, bgc:Int)
	
		Cells[col, row].setBGColor bgc	
	
	EndMethod

	
	Method setCellWeight(col:Int, row:Int, wgt:Int)
	
		Cells[col, row].setWeight wgt	
	
	EndMethod
	
	
	Method setCellStyle(col:Int, row:Int, styl:Int)
	
		Cells[col, row].setStyle styl	
	
	EndMethod

	
	Method setCellDecor(col:Int, row:Int, dec:Int)
	
		Cells[col, row].setDecor dec	
	
	EndMethod
	
	
	Method initAllCells(ch:Byte, bgc:Int= $000000, fgc:Int= $FFFFFF, ..
		styl:Byte = STYLE_NORMAL, wgt:Byte = WEIGHT_NORMAL, dec:Byte = DECOR_NONE)
	
		For Local c:Int = 0 To Cols - 1
			For Local r:Int = 0 To Rows - 1
				Cells[c, r].setBGColor bgc
				Cells[c, r].setFGColor fgc
				Cells[c, r].setChar ch
				Cells[c, r].setStyle styl
				Cells[c, r].setWeight wgt
				Cells[c, r].setDecor dec
			Next
		Next
	
	EndMethod


	Method writeText(txt:String, col:Int, row:Int, bgc:Int = $000000, fgc:Int = $FFFFFF)

		For Local n:Int = 0 To txt.length - 1
			If (col + n) &lt; Cols
				setCellChar col + n, row, txt[n]
				setCellBGColor col + n, row, bgc
				setCellFGColor col + n, row, fgc
			EndIf
		Next
		
	EndMethod
	

	Method exportHTML(url:String)
	
		If Not CreateFile(url) 
			Notify "Could not create HTML file."
			End
		EndIf
		
		Local fh:TStream = OpenFile(url)
		
		WriteLine fh, "&lt;!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01//EN' 'http://www.w3.org/TR/html4/Strict.dtd'&gt;"
		
		WriteLine fh, "&lt;html&gt;&lt;head&gt;&lt;style type='text/css'&gt;body{background-color: " + BodyBGColor + ..
			"; font-family: " + FFamily + "; font-size: " + FSize + ";} " + ..
			"}&lt;/style&gt;&lt;title&gt;Roguelike Experiment&lt;/title&gt;&lt;/head&gt;&lt;body&gt;" + .. 
			"&lt;code&gt;"
				
		For Local r:Int = 0 To Rows - 1
			Local row:String = ""
			For Local c:Int = 0 To Cols - 1
				row :+ Cells[c, r].getCSS()
			Next
			WriteLine fh, (row + "&lt;br&gt;")
		Next

		WriteLine fh, "&lt;/code&gt;&lt;/body&gt;&lt;/html&gt;"

		CloseFile fh
	
	EndMethod


'***************** DEBUG ************************

	Method test(URL:String)
	
		Local ch:Int = Rand(32, 255)
		
		For Local r:Int = 0 To Rows - 1
			For Local c:Int = 0 To Cols - 1
				
				setCellChar c, r, ch
				
				setCellFGColor c, r, Int((Rand(0, 255) Shl 16) | (Rand(0, 255) Shl 8) | Rand(0, 255)) 
				
				If Not Rand(0, 32)
					setCellBGColor c, r, Int((Rand(0, 255) Shl 16) | (Rand(0, 255) Shl 8) | Rand(0, 255)) 
				Else
					setCellBGColor c, r, $000000
				EndIf
					
				If Not Rand(0, 32)	
					setCellWeight c, r, Rand(WEIGHT_NORMAL, WEIGHT_BOLD)
					setCellDecor c, r, Rand(DECOR_NONE, DECOR_LINETHROUGH)
					setCellStyle c, r, Rand(STYLE_NORMAL, STYLE_OBLIQUE)
				EndIf
				
			Next
		Next

		exportHTML URL

	EndMethod


'************************************************


EndType


Type TCharCell


	Function Create:TCharCell()
		
		Local cell:TCharCell = New TCharCell
		
		cell.Char = 32
		cell.FGColor = $FFFFFF
		cell.BGColor = $000000
		cell.Style = STYLE_NORMAL
		cell.Weight = WEIGHT_NORMAL
		cell.Decor = DECOR_NONE
				
		Return cell
		
	EndFunction


	'###### FIELDS ######

	Field Char:Byte
	Field FGColor:Int, BGColor:Int
	Field Style:Byte, Weight:Byte, Decor:Byte


	'###### SETTERS ######

	Method setChar(ch:Byte)
	
		Char = ch
		
	EndMethod
	
	Method setFGColor(clr:Int)
	
		FGColor = clr
		
	EndMethod

	Method setFGColorRGB(r:Byte, g:Byte, b:Byte)
	
		FGColor = Int((r Shl 16) | (g Shl 8) | b)
		
	EndMethod

	Method setBGColor(clr:Int)
	
		BGColor = clr
		
	EndMethod

	Method setBGColorRGB(r:Byte, g:Byte, b:Byte)
	
		BGColor = Int((r Shl 16) | (g Shl 8) | b)
		
	EndMethod

	Method setStyle(styl:Byte)
	
		Style = styl	
	
	EndMethod
	
	Method setWeight(wgt:Byte)
	
		Weight = wgt	
	
	EndMethod
	
	Method setDecor(dec:Byte)
	
		Decor = dec	
	
	EndMethod


	'###### GETTERS ######

	Method getCSS:String()

		Local str:String

		str :+ "&lt;span style='background-color:#" + Right(Hex(BGColor), 6) + ..
		"; color:#" + Right(Hex(FGColor), 6) + "; "
				
		Select Style
									
			Case STYLE_NORMAL
				str :+ "font-style: normal; "
					
			Case STYLE_ITALIC
				str :+ "font-style: italic; "
					
			Case STYLE_OBLIQUE
				str :+ "font-style: oblique; "

		EndSelect
				
		If Weight = WEIGHT_NORMAL Then str :+ "font-weight: normal;" Else ..
			str :+ "font-weight: bold;"

		Select Decor
				
			Case DECOR_NONE
				str :+ "text-decoration: none; "	
					
			Case DECOR_UNDERLINE
				str:+ "text-decoration: underline; "	

			Case DECOR_OVERLINE
				str:+ "text-decoration: overline; "	

			Case DECOR_LINETHROUGH
				str:+ "text-decoration: line-through; "
						
		EndSelect

		str :+ "'&gt;" 
		
		If Char = 32 Then str :+ "&amp;ensp;" Else str :+ Chr(Char)
		
		str :+ "&lt;/span&gt;"

		Return str
		
	EndMethod

	
EndType

</textarea><br><br>Seems to work okay on WindowsXP and Mac OS10.5.4.. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
