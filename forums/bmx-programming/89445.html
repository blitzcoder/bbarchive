<!DOCTYPE html><html lang="en" ><head ><title >Purge images/textures from VRAM?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Purge images/textures from VRAM?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Purge images/textures from VRAM?</a><br><br>
<a name="1015753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is this possible?  Nulling TImages does not seem to release VRAM. <br><br></td></tr></table><br>
<a name="1015759"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Isn't there a DeleteImage() command?<br><br>in GL you'd need to deallocate the texture handle like glFreeTextures() or something. <br><br></td></tr></table><br>
<a name="1015761"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Isn't there a DeleteImage() command? <br></div>Nope.<br><br><div class="quote"> in GL you'd need to deallocate the texture handle like glFreeTextures() or something. <br></div>I'm using DX9. <br><br></td></tr></table><br>
<a name="1015767"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe when you CloseGraphics()? <br><br></td></tr></table><br>
<a name="1015804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's no CloseGraphics() command either?<br><br>Assuming you meant EndGraphics, I don't want to do that.  I just don't want my VRAM to get chock-full of redundant data as it appears to be doing, as there is apparently no way of flushing it out properly. <br><br></td></tr></table><br>
<a name="1015810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matibee</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I actually had to tackle this when running a game on my mac that has only 32mb of vram.  The game in question used transition fades and story boards that involved many 800 x 600 bitmaps (which I assume occupy as much vram as a 1024x1024 because of the power-of-two requirements).  Without clearing them out we'd eventually see white images where new stuff failed to load.<br><br>Null'ing them and forcing a gccollect() did work and eliminated the problem entirely.  Are you sure you don't have any references to the TImage hanging anywhere else? <br><br></td></tr></table><br>
<a name="1015811"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope.  Classes are created and destroyed from a single function, and all images are contained within those classes.  I'm not currently using GCCollect() as I'm just leaving GC to take care of that as and when.<br><br>I'll give GCCollect() a try in the morn. :)<br><br>[edit]<br><br>Just done some basic test code which repeatedly loads a large image, draws it then nulls it.<br><br>Without GCCollect, resources rockets up to over 400MB in just a few seconds.<br><br>With GCCollect, its consistently below 30MB.<br><br>So, think I'll be sticking that in my game tomorrow.  Thanks for the tip. :D <br><br></td></tr></table><br>
<a name="1015838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hm isn't that something a garbage collector is meant to do on its own? :S <br><br></td></tr></table><br>
<a name="1015850"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've noticed similar actions with the garbage collector in the past, at this point I leave the GC on auto but them pepper my loading/unloading code with GCCollect() to clean up the bits that auto misses as well as to force cleanup when I want it so it won't happen during more important times like when actually playing. It also cleans up junk created in loading/preping so there's more memory available for the next item to be loaded/preped. Not a big deal most of the time, but if you have to push memory limits you don't want your ceiling artificially lowered by leftovers that should be gone already. Seems especially important when there's mallocs in C in some modules...<br><br>I think auto cleans "as needed", and a manual collect cleans everything available to be cleaned... but I haven't gone digging to find out if this is true or just appearance. <br><br></td></tr></table><br>
<a name="1015861"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> the gc is meant to clean up memory when needed.<br>if 70% of the ram are empty then its meant to not clean it.<br><br>this has all no impact on the vram though as the gc handles the managed memory thats the ram stuff.<br>the vram is managed by dx in dx and in opengl its not managed at all, newer stuff just overwrites older stuff (this no management is the root why there is no reliable way to define how much vram you used and whats free on opengl) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
