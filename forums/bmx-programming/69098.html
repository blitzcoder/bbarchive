<!DOCTYPE html><html lang="en" ><head ><title >Function Returns a Function?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Function Returns a Function?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Function Returns a Function?</a><br><br>
<a name="772409"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to have a function return a function? I mean we have function pointers which we can store in a standard variable, so it stands to reason that at one point you're going to fancy filling that variable from a function, but I can't find a way to define it such that BlitzMax doesn't complain. Passing back a Byte Ptr just isn't as userfriendly somehow. <br><br></td></tr></table><br>
<a name="772410"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, you can pass a function in a  function.  Just leave the parenthesis off.  I have done it.<br><br>I would post an example, but I do not have any of my code with me, I left my removeable hard drive at home this morning with my BlitzMax install and all of my code on it. <br><br></td></tr></table><br>
<a name="772412"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Function fun:Int()()
	Function sub:Int()
		Return 1
	EndFunction	
	Return sub
EndFunction

Local f:Int() = fun()
Print f()
print fun()()
</pre> ;) <br><br></td></tr></table><br>
<a name="772415"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> What kind of purposes is this handy for? <br><br></td></tr></table><br>
<a name="772419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grable, thanks, that works, but only if the function prototypes match. What happens if Fun takes no parameters ( as in your example ) but Sub should take three floats? <br><br></td></tr></table><br>
<a name="772425"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> No gab, when you pass a funtion pointer you are under the same restriction as if you wanted to return an ordinary type. That is if you declare the function as INT it returns INT, if you say return AFUNC:fn(Int,Int)() then it needs to return FN(int,int)<br>You deal with this exactly the way you would deal with wnating to return different types. (ie pass a pointer to a TLink for example) <br><br></td></tr></table><br>
<a name="772440"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> H&amp;K, I think you're confusing the functions. I'm talking about the function which returns a function. It should not require the same parameters as the function it's returning. <br><br></td></tr></table><br>
<a name="772441"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm talking about the function which returns a function. It should not require the same parameters as the function it's returning. <br></div>Yep. Sorry to have missunderstood you. Your right. <br><br>What I was saying was that all the returned functions need to have the same footprint <br><br></td></tr></table><br>
<a name="772444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, it's precisely that requirement that I'm trying to enforce, rather than having loose Byte Ptr's floating around in my functions. <br><br></td></tr></table><br>
<a name="772448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>What happens if Fun takes no parameters ( as in your example ) but Sub should take three floats? <br> <br></div><br><br><pre class=code>
Strict

Function fun:Int( x,y,z) ()
	Function sub:Int( x,y,z )
		Return x+y+z
	EndFunction	
	Return sub
EndFunction

Local f:Int( x,y,z ) = fun()
Print f( 1,2,3 )
print fun()( 4,5,6 )
</pre> <br><br></td></tr></table><br>
<a name="772627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aha, thanks Mark. That's just what I needed. <br><br></td></tr></table><br>
<a name="772653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> but...<br><i>What kind of purposes is this handy for? </i><br><br>I know what functionpointers are for, and *Mark* give us method pointers plz!, but what's a typical use of a function returning a functions (preferably in context of apps)? <br><br></td></tr></table><br>
<a name="772658"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What kind of purposes is this handy for?<br> <br></div><br>Oh yes, sorry.<br><br>When you need to get a function pointer. Normally you would just make it a variable assignment but like anything, if you use the same chunk of code in several areas of your program, it's sensible to make it into a function. I need to do this in many places, so it made more sense to make it a function, then if it ever has to be changed, it only has to be changed once. <br><br></td></tr></table><br>
<a name="772670"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can see it being more useful if there were lambda functions like in Python. <br><br></td></tr></table><br>
<a name="772671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use it so as to get the Function that I want the timer hook to errr... hook. Then as I want the main hook to call the sub hooks, I have an array of pointers that are called at times. These obviously can (and in fact are ), pre defined, and so I have functions that return which are to be  called when.<br><br>At some point during my main timing cycle (1 sec normaly), I precalculate which Functions are going to be called and how often, so need function pointers to be returned.<br><br>(To be honest its a fudge, and Id much rather multiprocess, which is really what Im faking)<br><br>PS, Its probably not the best way to do it, but its working, so I dont mess with it) <br><br></td></tr></table><br>
<a name="772710"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I used it to make a button class.  I pass the button the function it should call when it gets clicked.  Works great. <br><br></td></tr></table><br>
<a name="772719"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> o_O Wouldn't it be more elegant to have that function listening to an event sent by that button? <br><br></td></tr></table><br>
<a name="772745"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> More elegant?  Not sure about that.<br><br>I create a Function Button_Clicked() then give that function to the button, when it is clicked, the function gets called.  No worrying about looping looking for events. <br><br></td></tr></table><br>
<a name="772807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Isn't that basically a callback? Atleast what you've described doesn't sound like a function returning a function pointer. <br><br></td></tr></table><br>
<a name="772818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blueapples</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I can see it being more useful if there were lambda functions like in Python. <br> <br></div><br><br>I think you mean <a href="http://en.wikipedia.org/wiki/Lisp_%28programming_language%29#Lambda_expressions" target="_blank">like in LISP (Lambda expressions)</a>. ;-) <br><br></td></tr></table><br>
<a name="772847"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Lua has them too, I knew someone would bring up lisp though. <br><br></td></tr></table><br>
<a name="772849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> o_O Wouldn't it be more elegant to have that function listening to an event sent by that button? <br></div><br>Not really.  This way, you can assign the function to different buttons and have them all handled accordingly, instead of writing a function to look for specific buttons.  Overall, it makes the code less complicated in one way and more complicated in another.  Depends on what you want, obviously. <br><br></td></tr></table><br>
<a name="772852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Not sure if function pointers would be the wisest decision to use in event handling as function points still are not the best idea when it comes to "keep the code fast" ... normally I would say use function templates instead but BM sadly does not have them nor delegates/agents ... <br><br></td></tr></table><br>
<a name="772861"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here is how I am currently using the original posters question.<br><br>This function creates a stack of cards.  The final three parameters are what functions the stack will call if the user drops on or drags from  or dblclicks on the stack.<br><br>Discard=TCards.NewStack(110,10,4,1,Null,TopDrag, DblCLick)<br><br>So, when a player tries to drag cards from the Discard stack, TopDrag is called and returns a true or false of whether or not the player can drag that particular card. <br><br></td></tr></table><br>
<a name="772862"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> normally I would say use function templates instead but BM sadly does not have them nor delegates/agents <br></div>LoL <br><br><br>(@dream, just made me laugh, not having a go at you) <br><br></td></tr></table><br>
<a name="772890"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> For a simple Game GUI I think function pointers are perfect. Readable and clean, easy to implement. I wouldn't use it for a complex app-style GUI, but for a few buttons and widgets in a game, I think they're ideal. <br><br></td></tr></table><br>
<a name="772892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Picklesworth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> What's wrong with them in a complex GUI?<br><br>Done right, function pointers are a fantastic way to achieve event-oriented programming, which (when done right, eg: Not Flash / Actionscript), is quite a pleasant interface.<br><br>Of course, judging by my recent "discoveries," I still have a lot to learn :) <br><br></td></tr></table><br>
<a name="772896"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nothing is wrong with them, I just wouldn't use them in a complex GUI. Personal preference. If I was writing a complex GUI, I'd either do it the MaxGUI way, or possibly script it. I have a GUI pretty much complete now, but I think if I was starting again from scratch, I'd probably go with XML and Lua, for layout and events respectively. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
