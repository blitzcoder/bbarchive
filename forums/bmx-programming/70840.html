<!DOCTYPE html><html lang="en" ><head ><title >INIFileHandler Module</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >INIFileHandler Module</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >INIFileHandler Module</a><br><br>
<a name="791882"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi All,<br><br>I've finally finished off my free INIFileHandler module.<br><br>It allows you to create and manipulate data stored in INI-style configuration files.  Not all features of the INI file "standards" are supported, but almost all of the more useful ones are.<br><br>At the moment there is only one simple example program, but I will be adding a few more over the next couple of weeks.<br><br><a href="http://www.muttleyville.org/index.php?option=com_content&amp;task=blogsection&amp;id=7&amp;Itemid=47" target="_blank">Details Here</a><br><br>Hope it comes in useful for somebody and let me know if you find any problems with it or have any questions.<br><br>Cheers<br><br>Muttley <br><br></td></tr></table><br>
<a name="791921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Long live .ini/.pref files!<br><br>(Death to the super-behemoth bloat monger Windows Registry!)<br><br>Russell <br><br></td></tr></table><br>
<a name="791934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hehe.<br><br>I mainly wrote it as I found XML configs too confusing to design.  ;) <br><br></td></tr></table><br>
<a name="791954"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Big&amp;</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice little mod Muttley :)<br><br>(Came across it on YakYak first, totally missed in on here!) <br><br></td></tr></table><br>
<a name="792135"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cheers Big&amp;.<br><br>What's your nick over at YakYak then?  There seems to be a lot of love for Blitz over at YakYak.<br><br>Gonna re-launch my Log File Handler next I think.  :) <br><br></td></tr></table><br>
<a name="792188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Big&amp;</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I dont post there at all. 100% lurker :) <br><br></td></tr></table><br>
<a name="793703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just took a look at this.  One hting you might want to add to your get functions is a default.<br><br>So it would be like this:<br><br>Local width:Int = configFile.GetIntValue( "Graphics", "ScreenX", 800)<br><br>This way, when you are loading your parameters, if they don't exist, you get the default returned.  Makes it much easier on the programmer using the ini file.  Instead of checking that I got values and if not, setting the variable to a default value, you just get a defauklt returned if it does not exist. <br><br></td></tr></table><br>
<a name="793873"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see what you mean.<br><br>Would you want the section/parameter and value created on the fly if it doesn't exist as well then?<br><br>Muttley <br><br></td></tr></table><br>
<a name="793901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, I don't think so, since it is the default, no reason for it to be in the ini file at all...<br><br>And, the next time the ini file gets written, the parameter would be written anyway. <br><br></td></tr></table><br>
<a name="793915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> But if it's not in the INI file, then when the INI file is rewritten it will be left out.  You (as a programmer) would never know it wasn't in the INI file as if you'd requested a parameter with a default and that default is returned you'd only know that you'd got a value correctly, not that the parameter/value didn't actually exist.  So you wouldn't know to add it manually, IYSWIM. <br><br></td></tr></table><br>
<a name="793947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I see what you mean, but if it is just the default, then it doesn't really need to be in the INI file.<br><br>I generally write the whole INI file when I save it anyway. Not just the pieces that change.  Much easier to just call one function and write it all than to try and remember what has changed and needs to be written. <br><br></td></tr></table><br>
<a name="794124"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The whole INI file is rewritten when saved, which is why I would need to add the section/paramater with the default value if it doesn't exist. <br><br></td></tr></table><br>
<a name="794245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, but if it is the default, it does not need to exist.<br><br>And if it changes, the programmer should be writing it.<br><br>Does that make sense? <br><br></td></tr></table><br>
<a name="794327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, try this one.<br><br>If the default is returned because it doesn't exist.  How does the programmer know it doesn't exist to re-add it (say, for example, the user has accidently deleted a line in the INI file)? <br><br></td></tr></table><br>
<a name="794334"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Every time my program reads the INI, it will get the default for any parameter that does not exist.  Which is fine, it just means the user has not changed it.  If the user changes it, then the new value will get written.<br><br>If it is set to the default, then it does not matter whether it exists or not.<br><br>No different than if you play with the registry, some values don't exist because the system is using the default.  If you want to change it, then you add the parameter.  If you want the default back, you can just delete the parameter. <br><br></td></tr></table><br>
<a name="794360"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK, I get what you mean now.  I prefer to have everything in the INI file from the start TBH, but maybe I can add that as an option  :) <br><br></td></tr></table><br>
<a name="794383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah, if you are planning to have an INI file that you want the user to edit by hand (possibly), then you would want all of the options there.  But, if the INI file is only for your program, then non-default items are not necessary.<br><br>You and I were looking at it from different aspects.<br><br>I guess you could always make the default an optional parameter. <br><br></td></tr></table><br>
<a name="796633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've just released version 1.03.<br><br>You can now pass default values to the Get* methods which is used if the Parameter doesn't currently exist in the INI file.  Optionally you can also now use the CreateMissingEntries() method to have those default values automatically added to the INI file if required (along with any required Sections) which can then be saved out.<br><br>Thanks to TaskMaster for the idea.<br><br>Details and download link <a href="http://www.muttleyville.org/index.php?option=com_content&amp;task=blogsection&amp;id=7&amp;Itemid=47" target="_blank">here</a> <br><br></td></tr></table><br>
<a name="796699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice.  Thanks for making the addition.  I have already started using it.  :) <br><br></td></tr></table><br>
<a name="796984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> NP.  If you come with any other suggestions, just let me know.  :) <br><br></td></tr></table><br>
<a name="799242"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice one :) Will be nice to use a proper system instead of bodging something myself! ta! <br><br></td></tr></table><br>
<a name="930492"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Version 1.1.0 now released.<br><br>This is mainly a bug-fix and code tidy-up release, although I have also added lots of unit tests using Brucey's fantastic bah.maxunit module.<br><br>Download from: <a href="http://code.google.com/p/muttmod/downloads/list" target="_blank">http://code.google.com/p/muttmod/downloads/list</a> <br><br></td></tr></table><br>
<a name="930518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Excellent. Thanks Muttley! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
