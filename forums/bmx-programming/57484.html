<!DOCTYPE html><html lang="en" ><head ><title >Float-Int conversion problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Float-Int conversion problem</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Float-Int conversion problem</a><br><br>
<a name="639239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzMax seems to always round down when converting a float to an integer:<br><br>Notify Int(1.9)<br><br>This has far-reaching consequences that create a lot of hard-to-find problems.  For example, when doing a power-of-two test on textures, my fixed width was 511.99987, which got rounded to 511.<br><br>Why has this method of float conversion been chosen? <br><br></td></tr></table><br>
<a name="639249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Because thats how C does and the math stuff is handled by it :-) (GCC has one of the most optimized math code you could use, so it wouldn't be an intelligent idea to work around that just for "niceness" reasons)<br><br><br>The simple fix is Int(val# + 0.5), if you want the old Blitz behavior :-) <br><br></td></tr></table><br>
<a name="639319"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's the way most languages work.  When converting from Float to Int, the decimal gets dropped regardless of value.  Blitz3D is the first programming language that I've used that rounded the numbers.  For games, the BMax version is actually prefered.   Suppose you have a play area divided into cells where each cell is 32x32 pixels.  How can you tell what cell your mouse is pointing to?<br><pre class=code>
CellX = MouseX() / 32
CellY = MouseY() / 32
</pre><br>That would give incorrect results if the numbers were rounded.  for example, if MouseX() were to return 15, then MouseX() / 32 would be 0.46875 which would be rounded down to 0, but if MouseX were to return 17, then MouseX()/32 would be  0.53125 which would round up to 1.  Except that the mouse would still be pointing at the same cell.  The next cell does not start until pixel 32.<br>If you actually need the decimal rounded instead of just dropped, use Dreamora's suggestion. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
