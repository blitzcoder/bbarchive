<!DOCTYPE html><html lang="en" ><head ><title >Fast way to find the lowest set bit in a mask?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Fast way to find the lowest set bit in a mask?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Fast way to find the lowest set bit in a mask?</a><br><br>
<a name="812740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have 1 integer containing a bit mask. Various random bits will be set in the integer. It doesn't matter what the overall value of the integer is, the bits are set and cleared individually to indicate various things.<br><br>For example it might be %01101010001010010100101001000010. Bit number 0 is on the right (lowest bit), 31 is the upper bit (left).<br><br>What is a fast way, using some kind of math or binary operations and NOT a per-bit iterative search, to find the number of the lowest bit which is set (ie return 1 for the second bit and then 6 for the 7th bit etc)?<br><br>I currently do bit-tests for all bits in a while-wend loop from 0 to 31, or until a bit is found, and keep a counter of which bit number. This is obviously not a very clever algorithm. Is there some combination of and/or/not/xor/whatever which will return the lowest set bit quickly and in the same amount of time no matter how many bits there are? <br><br></td></tr></table><br>
<a name="812752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something like <br><pre class=code>Function BitGet:Int(value:Int, bit:Int)
	Return value&amp;(1 Shl bit)
EndFunction</pre><br><br>It returns non-zero if the bit is set otherwise zero<br><br>Edit: Nvm, I thought you were asking to check a bit at a certain position. <br><br></td></tr></table><br>
<a name="812905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, I can to do that already. But to find which is the lowest number bit set, you'd have to test every bit until you find one. That's not efficient. There must be some binary arithmetic type of way to `process` the integer so that it ends up with a bit number. <br><br></td></tr></table><br>
<a name="812916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
Strict

Function F( n )
	Global t[]=[..
		0, 1, 28, 2, 29, 14, 24, 3, 30, 22, 20, 15, 25, 17, 4, 8,..
		31, 27, 13, 23, 21, 19, 16, 7, 26, 12, 18, 6, 11, 5, 10, 9 ]
	Return t[ (n &amp; -n) * $77cb531 Shr 27 ]
End Function

For Local i=0 Until 32
	Print F( (Rand(65535)|1) Shl i )
Next
</pre><br><br>Pinched from: <a href="http://graphics.stanford.edu/~seander/bithacks.html" target="_blank">http://graphics.stanford.edu/~seander/bithacks.html</a> <br><br></td></tr></table><br>
<a name="812932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey cool. You're the man! <br><br>The "n &amp; -n" is interesting, in that it shows what the lowest bit is. It's the conversion from the bit being set to the `number of the bit` which is the hard part. I couldn't figure out any better way to do it so this should be good enough, and much quicker than a loop that searches for bits.<br><br>The form:<br><pre class=code>
Local Found:Int=BitToNumber[(Mask &amp; -Mask) * $77cb531 Shr 27]
</pre><br>is good enough for me.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
