<!DOCTYPE html><html lang="en" ><head ><title >The Chess Queen Puzzle (Source Included)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >The Chess Queen Puzzle (Source Included)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >The Chess Queen Puzzle (Source Included)</a><br><br>
<a name="1293038"></a>

<a name="1293040"></a>

<a name="1293041"></a>

<a name="1293095"></a>

<a name="1293435"></a>

<a name="1293436"></a>

<a name="1293583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> TomToad wrote an article on recursion. According to what he wrote, he said it would take an inordinately large amount of time to calculate the position of eight chess Queen pieces on a board where no queen can capture another.<br><br><b>There are several ways to go about solving this problem. One way would be to put the queens on the board in some random combination, then see if that combination results in a solution. If not, then replace the queens in another, untried combination. Since there are 178,462,987,637,760 possible combinations, that will potentially take a lot of time to compute. In the worse case scenario, being there is no possible solutions, if the computer calculates 100 combinations per millisecond, then it would take over 56 years to go through all the combinations.</b><br><br>He said it's supposed to be easier with recursion.<br><br><img src="http://www.writerscafe.org/uploads/rte/83a704c677a80ec7dd8a10ec7b132bd5.png"><br><br>Well, here is my method <b>without</b> recursion and it works rather quickly.<br><br>[1] Choose a random square that is empty.<br><br>[2] check to see if can be captured by any existing queen pieces ? If yes, go back to step 1. After 50 times of this though, remove an existing queen and try again.<br><br>[3] Piece is in the clear ? Drop it down.<br><br>[4] Repeat until all 8 queens are down on board and none can capture each other.<br><br>On my computer it takes anywhere from immediate to 10-seconds to find a solution.<br><br>Note, this could actually run a LOT faster if you only updated the graphics when a piece was dropped and it was higher than the last highest count, but it's interesting to watch the pieces fight each other so I opted to show the board's progress so you can see it in action. :)<br><br>Here is the code including a neat way to draw lathed chess pieces, enjoi !<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
'     __________________________________
'    //                               //
'   // The Chess Queen Puzzle        //
'  // Version, "Chessmaster"        //
' // Written by David W - 02/01/16 //
'//_______________________________//

' Attempt to place =8= Queens on a chessboard
' that do not intersect their capture points
' Challenge accepted and met !
'
' hold down SPACEBAR to seek out solution
Strict
SeedRnd MilliSecs() ' ensure random results each time

Global img_queen:TImage=CreateImage(64,64)
Global board[8,8] ' our lovely chessboard
Global img_square1:TImage=CreateImage(83,83) ' fits the screen nicely
Global img_square2:TImage=CreateImage(83,83)
Local xp#,x,y,x2,y2,xa#,i,j,c,r,ok,n
Local vec_queen#[]=[-1.0,1.5,-2.0,2.5,-.75,-.5,-.5,1.0] ' new method of mine to make a filled vector

Local capture[]=[0,-1,1,-1,1,0,1,1,0,1,-1,1,-1,0,-1,-1] ' ways a Queen can capture a piece

SetGraphicsDriver GLMax2DDriver(),0 ' zero forces front buffer
Graphics 664,664 ' perfect size for a chessboard
SetBlend alphablend ' give proper alpha blends

' &gt;&gt; DRAW THE QUEEN CHESS PIECE
xp#=32
For i=0 To 63
  c=192+Rand(0,63) ' give it a marble effect
  For j=31 To xp# Step -1
    SetColor c*.9,c,c*.9 ' just a tinge of green
    c:-j-xp# ' shade the piece
    Plot j,i
    Plot 63-j,i ' mirror, chess piece is rounded
  Next
  If i Mod 8=0 Then xa#:+vec_queen[i/8.0] ' pull next angle every 8 pixels
  xp#:+xa# ' slope our drawing according to pulled vectors
Next
GrabImage img_queen,0,0 ' grab it

' &gt;&gt; DRAW THE CHESS SQUARES
For i=0 To 1 ' 2 cause we want light and dark squares
  xa#=160 ' color index to start
  For j=0 To 165
    r=Rand(0,23) ' give 'wooden' grooved look
    SetColor xa#+r+i*128,xa#/2+r+i*128,0 ' lightest top-left, darkest bottom-right
    DrawLine j,0,0,j ' draw thin diagonal line as part of square
    xa#:-.75 ' darken color just a bit
  Next
  If i=0
    GrabImage img_square1,0,0 ' grab dark square
  Else
    GrabImage img_square2,0,0 ' grab light square
  EndIf
Next

SetColor 255,255,255 ' reset color since we were changing it above

Repeat ' {* MAIN *}

Repeat
'  SetBlend alphablend
'  SetAlpha 1
'  SetColor 255,255,255
  Cls
  For i=0 To 7 ' redraw the board as we might be moving pieces around
    For j=0 To 7
      drawsquare j,i ' draw chess square
      If board[j,i] Then drawqueen j,i ' draw the queen piece
    Next
  Next
  ok=0
  For i=0 To 7
    For j=0 To 7
      If board[j,i] Then ok:+1 ' count # of queens on board
    Next
  Next
  If ok=8 ' if 8, victory ! End program with banner
    SetScale 2,2
    SetColor 0,0,0
    DrawText "COMPLETE",270,320
    SetColor 255,255,255
    DrawText "COMPLETE",268,318
    glflush ' update screen
    FlushKeys ' clear any held keystrokes
    WaitKey ' hit a key to exit
    End
  EndIf
  n:+1 ' count # of tries to place a piece
  Repeat
    ok=1
    x2=Rand(0,7) ; y2=Rand(0,7)
    If n=50 And board[x2,y2]=1 ' if it's been 50 tries, remove a random queen
      board[x2,y2]=0
      ok=0
      n=0
    EndIf
  Until board[x2,y2]=0 And ok=1 And n&lt;50 ' don't exit till we found a blank square
  If n&gt;=50 Then n=0 ' reset counter
  ok=0
  For i=0 To 7
    x=x2 ; y=y2 ' each time we scan, reset back to original position
    For j=0 To 7
      x:+capture[i*2] ' using capture table, scan in that direction
      y:+capture[i*2+1]
      If x&gt;=0 And y&gt;=0 And x&lt;=7 And y&lt;=7 ' must be on board
        If board[x,y] Then ok=0 ; Exit ' found a queen ? no good, exit
      EndIf
    Next
    If j&lt;8 Then Exit ' queen was found, exit
    ok:+1 ' no queen found in that direction, try another
  Next
Until ok=8 ' only exit if all 8 directions scanned and no queen found
board[x2,y2]=1 ' put a queen here
Repeat
  glflush ' update screen
  Delay 1
  If KeyDown(27) Then End ' ESCAPE key will exit
Until KeyDown(32) ' hold SPACE to keep playing

Forever ' {* END OF MAIN *}

' &gt;&gt; DRAW CHESS SQUARE
Function drawsquare(x,y)
  If (x+y) Mod 2=0
    DrawImage img_square1,x*83,y*83
  Else
    DrawImage img_square2,x*83,y*83
  EndIf
EndFunction

' &gt;&gt; DRAW QUEEN CHESS PIECE
Function drawqueen(x,y)
Local i,j
  SetColor 0,0,0
  SetAlpha .05
  For i=-4 To 4
    For j=-4 To 4
      DrawImage img_queen,83*x+9+j,83*y+9+i ' give lovely shadow to chess piece
    Next
  Next
  SetColor 255,255,255 ' return color and solidity to normal
  SetAlpha 1
  DrawImage img_queen,83*x+9,83*y+9 ' plot queen at this square
EndFunction
</textarea><br><br><img src="http://www.writerscafe.org/uploads/rte/d3243a2c5c81c3ed5c77e51ce9e4fa91.png"> <br><br></td></tr></table><br>
<a name="1293043"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Recursion is certainly not necessary, nor is guessing with random placement.<br><br>I once wrote a backtracking program to generate all possible solutions to the eight queens problem. It finished in practically no time, running on an 8-bit 1.77MHz computer. That's not even a thousandth the speed of a reasonably modern PC. <br><br></td></tr></table><br>
<a name="1293049"></a>

<a name="1293050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Cap'n !<br><br>Well, there are some things I could do to make this faster. One of which I call a Seek Random. That is, a random position is thought of, but if it doesn't match, instead of seeking a new random position, it increases the horizontal or vertical, then increases the other (if it was vertical increase horizontal or if it was horizontal then increase vertical). Do this until you wrap around the board back to your home position.<br><br>THEN for certain you know there is =NO= possible solution for that piece and you can go back a step. I think that would speed up the search considerably.<br><br>Pretty sure I'm doing this in my maze-maker when seeking out empty spaces to carve into:<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=105489" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=105489</a><br><br>Do you still have the code you wrote on the Queen puzzle ? And did you ever port it to BlitzMAX ? <br><br></td></tr></table><br>
<a name="1293058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> And - is it in BlitzMAX ?  <br></div><br>Hardly! I think I wrote that in a very nice proprietary language called Action!, on an 8-bit Atari.<br><br>Do I still have the code? Maybe. Somewhere in the crawlspace under my house there is a box with the old Atari computer, plus the external disk drive and a bunch of 5.25" floppies. If the equipment still works and the relevant disk is readable then I still have the code. I would have no way to post it short of manual retyping, unless the old dial-up modem also worked and I found some place that still offers a dial-up connection.<br><br>But I can summarize what the algorithm was like. The placement of the queens was represented by an eight element array. The array [ 3, 7, ...] for example would mean that, examining the board left to right, there is a queen on the the third  rank, seventh rank etc. That is, on squares a3, b7...<br><br>When looking for solutions lets say we have [ 2, 5, ...] so far. We try placing a third queen, successively trying positions 1,2,3 etc. In this example, using 1 for the third queen fails immediately. We move on to 2,3,4 which also fail. 5 works, so we use that and proceed to placing the fourth queen.<br><br>When we encounter a situation in which every possible placement fails we "backtrack". For example, we try to place a sixth queen and all eight attempts fail. Then there is no solution extending what we have with the first five. So we back up to the fifth queen and try higher values, placing it farther up the board.<br><br>Any consistent arrangement of eight queens is reported as a solution. We then backtrack to the seventh queen and keep looking.<br><br>Any time we have examined every placement 1..8 for the nth queen we back up to n-1 and forge ahead.<br><br>If we ever need to backtrack from the first queen then every possibility has been tried and we quit.<br><br>The idea of backtracking is pruning infeasible partial solutions. Every placement of eight queens can be considered as an eight digit number, each digit being in the range 1..8. <br><br>For example 134xxxxx would represent a large number of potential solutions beginning 134. But we don't look at them because we recognize that 134 is already inconsistent. Thus we move on to 135.<br><br>Come to think of it you might do better to by Googling eight queen backtracking rather than trying to decipher my description. <br><br></td></tr></table><br>
<a name="1293063"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  According to what he wrote, he said it would take an inordinately large amount of time to calculate the position of eight chess Queen pieces on a board where no queen can capture another - if you do not use recursive code <br></div><br>If you read the post carefully, I did not say it would take an inordinately large amount of time without recursion.  I said that the method of randomly selecting positions until one works would take an inordinately large amount of time, and that recursion is one way to make things go faster.<br><br>Since the tutorial was about using recursion and not necessarily about solving the 8 queens puzzle, I did not focus on other solutions.  However, I did post one alternative at the bottom which did not use recursion and was actually faster than my code.  However, that program was tailored specifically for the 8 queens and difficult to modify for other types of puzzles, which went out of scope for the tutorial. <br><br></td></tr></table><br>
<a name="1293065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> What I've noticed, Tom, is it seems to me that all 8 figures can be found based on the movements of a knight. Place a queen in the bottom-right-hand corner. Then spread out based entirely on movements a knight would make.<br><br>The other is a bit simpler now that I really think about it. Only 2 checks need to be made:<br><br><b>If x2=x or y2=y then placement is invalid<br>if abs(x2-x)=abs(y2-y) then this placement is also invalid</b><br><br>Done ! :)<br><br>Maybe sometime I should try my hand at writing a chess game where you play against the computer.<br><br>I did not read the recursion part. I'll look at that next. Recursion to me is still a pretty amazing thing. <br><br></td></tr></table><br>
<a name="1293066"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a small recursion-based example which is quite fast :<br><pre class=code>
SuperStrict

Framework brl.standardio

Local q:TQueensRecursion = New TQueensRecursion

q.test(0,0,0)
Print "Solutions = " + q.count


Type TQueensRecursion

	Field all:Int = 255
	Field count:Int
	Field rows:Int[8]


	' based on Martin Richards. Backtracking Algorithms in MCPL using Bit Patterns and Recursion
	' <a href="http://www.cl.cam.ac.uk/~mr10/backtrk.pdf" target="_blank">http://www.cl.cam.ac.uk/~mr10/backtrk.pdf</a>
	Method test(ld:Int, col:Int, rd:Int, row:Int = 1)
		Local poss:Int = ~(ld | col | rd) &amp; all
		While poss
			Local bit:Int = poss &amp; -poss
			poss :- bit
			rows[row-1] = bit ' record row
			test( (ld|bit)Shl 1, col|bit, (rd|bit) Shr 1, row + 1 )
		Wend
		If col = all Then ' we have a completed solution
			DumpRows()
			count :+ 1
		End If
	End Method



	' solution output stuff
	Method DumpRows()
		Print ""
		For Local i:Int = 0 Until 8
			Print Binary(rows[i])
		Next
	End Method
	
	Method Binary:String(val:Int)
		Local buf:Short[8]
		For Local k:Int=7 To 0 Step -1
			If val&amp;1 Then
				buf[k] = Asc("Q")
			Else
				buf[k] = Asc(".")
			End If
			val:Shr 1
		Next
		Return String.FromShorts( buf,8 )
	End Method

End Type
</pre> <br><br></td></tr></table><br>
<a name="1293083"></a>

<a name="1293084"></a>

<a name="1293085"></a>

<a name="1293086"></a>

<a name="1293087"></a>

<a name="1293088"></a>

<a name="1293089"></a>

<a name="1293090"></a>

<a name="1293091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Brucey. No, there's a certain satisfaction in having solved this logic puzzle myself without help from someone's else's formula. :)<br><br>Cap'n, no, the adventure was in finding a solution in my own code.<br><br>And I discovered a new drawing method on how to doodle lathed marble chess pieces effectively !<br><br><img src="http://www.writerscafe.org/uploads/rte/5d633232d7dcea525f4bafa81b26d65e.png"><br><br>Awright you guyz ! How about the, "Knight's Tour" in your own code ? No borry from other sources or formula, this one is a real brainweave !<br><br><b>http://en.wikipedia.org/wiki/Knight's_tour</b> <br><br></td></tr></table><br>
<a name="1293260"></a>

<a name="1293261"></a>

<a name="1293262"></a>

<a name="1293264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just for fun I wondered how small of coding I could do to solve the Queen problem. Here it is !<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' I'm gonna go fast so try and keep up ! :)
' The BLITZ way to solve the Queen Problem in no time flat
Strict
SeedRnd MilliSecs()

Local queen[8],i,j,r,r2,ok,c

For i=0 To 7 ' We're stepping vertically only
  r=Rand(0,7) ; r2=r ' choose horizontal place for queen
  Repeat
    r=(r+1)Mod 8 ' move to right, if hit edge, start back at far left
    ok=1 ' flag okay to go
    For j=0 To i-1
      If queen[j]=r Or Abs(i-j)=Abs(queen[j]-r) Then ok=0 ' tricky ! if queen is lined up, mark not okay
    Next
    If ok Then queen[i]=r ; Exit ' Nice ! found a place, mark it and go to next row
  Until r2=r ' scan all sides before we abort
  If r2=r Then i=0 ' aborted, retry
Next

' We've solved the board ! Now draw it.

SetGraphicsDriver GLMax2DDriver(),0 ' zero forces front buffer
Graphics 664,664 ' perfect size for chessboard
For i=0 To 7
  For j=0 To 7
    c=64+(j+i)Mod 2*32 ' neat ! changes color per square
    SetColor c,c,c ' board is simple pattern of gray
    DrawRect j*83,i*83,81,81
    If j=queen[i] Then
      SetColor 0,0,0
      DrawOval j*83+6,i*83+6,68,68
      SetColor 255,255,255
      DrawOval j*83+10,i*83+10,60,60 ' queens are simple circles
    EndIf
  Next
Next
glflush ' update screen
WaitKey ' hit a key and exit
</textarea><br><br>15-lines of code not counting remarks and display routine ! <br><br></td></tr></table><br>
<a name="1293446"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Was just thinking about a chess puzzle program I did years ago.  Posted it here <a href="http://www.blitzbasic.com/Community/posts.php?topic=80915#1293445" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=80915#1293445</a> <br><br></td></tr></table><br>
<a name="1293448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Tom. You're not posting the source. That's fine. :)<br><br>I think I decided when I finish this 750k to 64-byte compressor, I'll post the EXE but gonna keep the source for myself.<br><br>I know not all commercial programmers - especially those who write games that sell for $50 and up - are too eager about releasing their source codes to the public either.<br><br>On the line of chess, you might be interested in this:<br><br><a href="http://www.thinkfun.com/products/solitaire-chess/" target="_blank"><b>SOLITAIRE CHESS</b></a><br><br>There is also Fork My Fruit, one of my favorite chess games and puzzles on a PSP game called Chessmaster. I couldn't seem to find a decent video in Youtube, some guy horking up, not very professional.<br><br>Basically you put fruit on the screen, then a chess piece (or two), and you must navigate to zap as many fruit as you can. Unlike regular chess if there are two or more fruit that can be captured, forks leap out in those directions to 'fork' them.<br><br>I like this game so much I was thinking of maybe writing one in the future where you don't fork fruit but shoot swords at monsters and your chess pieces are rendered to look more human than wooden and walk with animation around the board. :) <br><br></td></tr></table><br>
<a name="1293597"></a>

<a name="1293598"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Awright you guyz ! How about the, "Knight's Tour" in your own code ? No borry from other sources or formula, this one is a real brainweave !<br> <br></div><br>Gave this one a try.  Wrote the code, let it go for half an hour without a solution found, aborted the run.  Optimized the code a bit, let run for another half hour without a solution.  Tried optimizing a bit more, can't optimize any further, ran for 30 minutes without a solution found.  Then thought of one more way to optimize the code.  Was shocked when it came up with the solution in only .08 seconds!  I would've been happy if it ran under 30 minutes, didn't expect less than a second. :-)<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">'''''''''''''''''''''''''''''''''''''''''''''''''''''
'
' A Knight's Tour
' Program to solve the knight's tour puzzle
' By TomToad Feb 04,2016
'
'''''''''''''''''''''''''''''''''''''''''''''''''''''
SuperStrict
'First, we will create a type to store the current position and all the tried directions.
Local StartTime:Int = MilliSecs()
Type TPosition
	Field x:Int
	Field y:Int
	Field direction:Int = 0
End Type

'Here we will place the stack of all tried position
Local Stack:TList = CreateList()
'Now an array to represent all the places the knight has already visited
Global Visited:Int[8,8]
Global ArrayX:Int[] = [-1,1,2,2,1,-1,-2,-2]
Global ArrayY:Int[] = [2,2,1,-1,-2,-2,-1,1]

Local Count:Int'Number of places already visited

Graphics 600,600 'Set the graphics mode
SetVirtualResolution 256,256

'Now to get the first postion
Local Position:TPosition = New TPosition 'Create the position object
Position.x = 0
Position.y = 0
Visited[0,0] = 1
Count = 1
Stack.AddLast(Position)

' Next we shall loop, keep moving the night, until we have a solution
Local Time:Int = MilliSecs() + 10000
Local CPSCount:Int = 0
Local DisplayBoard:Int = True
While count &lt; 64
	If KeyHit(KEY_ESCAPE) Then End
	If KeyHit(KEY_B) Then DisplayBoard = 1 - DisplayBoard
	CPSCount :+ 1
	If MilliSecs() &gt;= Time
		Print "Calculations per second = "+CPSCount/10
		CPSCount = 0
		Time :+ 10000
	End If
		'Check the next move
	If Position.Direction &lt; 8
		Local NewPosition:TPosition = New TPosition
		'-----------
		'! !0! !1! !
		'-----------
		'!7! ! ! !2!	^
		'-----------	|
		'! ! !k! ! !	Y
		'-----------	 X--&gt;
		'!6! ! ! !3!
		'-----------
		'! !5! !4! !
		'-----------
		NewPosition.x = Position.x + ArrayX[Position.Direction]
		If NewPosition.x &lt; 0 Or NewPosition.x  &gt;= 8
			Position.Direction :+ 1
			Continue
		End If			
		NewPosition.y = Position.y + ArrayY[Position.Direction]
		If NewPosition.y &lt; 0 Or NewPosition.y &gt;= 8
			Position.Direction :+ 1
			Continue
		End If			'Check if it is a valid move
		If Visited[NewPosition.x,NewPosition.y] = 0
			'We have a valid move, push this value on the stack, update the array and go on to the next move
			Stack.AddLast(NewPosition)
			Visited[NewPosition.x,NewPosition.y] = 1
			Count :+ 1
			Position = NewPosition
			If Count &lt; 63 Then Position.Direction :| Valid() 'if this leaves the board in unsolvable state, no need to check further.
		Else
			'This is not a valid move.  update the direction and try again
			position.Direction :+1
		End If
	Else 'We have tried all directions. Time to pull this spot off the stack
		Visited[Position.x,Position.y] = 0 'no longer visited
		Count :- 1 'Decrease the count
		Stack.RemoveLast() 'Remove the top item
		Position = TPosition(Stack.Last()) 'Back up Position
		If Position = Null 'We have tried all possible combinations
			Print "No solutions possible" 'Should never happen.  Solution exists
			End
		End If
		Position.Direction :+ 1
	End If
		
Wend 'The Stack List will now contain the solution.  Let's view it
Local TotalTime:Float = Float(MilliSecs() - StartTime)/1000.0

While Not KeyHit(KEY_SPACE) 'Wait for user to press SPACE for when he is ready to view the solution
	Cls
	DrawText "Solution found!",10,10
	DrawText TotalTime,10,30
	DrawText "Press SPACE To view",10,50
	Flip
Wend

Visited = New Int[8,8] 'Let's clear the array
Local OldPosition:TPosition = Null
For Local Position:TPosition = EachIn Stack 'Go through each position
	DisplayAnim(OldPosition,Position) 'move the knight
	Visited[Position.x,Position.y] = 1
	OldPosition = Position
Next
WaitKey() 'We are through

'Check to see if any squares are cut off, return 8 if any are found
Function Valid:Int()
	Global Checked:Int[64]
	MemClear(Byte Ptr(Checked),64*4)
	Local cx:Int, cy:Int, x:Int, y:Int, d:Int
	Local result:Int, finishflag:Int = 0
	For x = 0 To 7
		For y = 0 To 7
			If Not (Visited[x,y] | Checked[x+(y Shl 3)])'Check only empty cells
				result = 0
				For d = 0 To 7
					cx = x + ArrayX[d]
					cy = y + ArrayY[d]
					If cx &gt;=0 And cx &lt; 8 And cy &gt;=0 And cy &lt; 8
						checked[cx + (cy Shl 3)] = 1
						If Visited[cx,cy] = 0 Then result :+ 1
						If result &gt;= 2 Then Exit 'we only need to check for 2 empty spaces
					End If
				Next
				If result = 0 Then Return 8 'This is a blocked cell
				If result = 1 'This cell has only 1 move, 
					If finishflag = True 'There is at least 2 cells with 1 move, puzzle unsolvable
						Return 8
					Else
						finishflag = True
					End If
				End If
					
			End If
		Next
	Next
	Return 0
End Function
			

'Function to render the board and show knight animation
Function DisplayAnim(OldPosition:TPosition,Position:TPosition)
	'Our board uses standard cartesian coordinates where y points up.  So we will need to convert them in the render to screen coordinates
	Local OldTime:Int = MilliSecs()
	Local Time:Int
	Local Delta:Float
	Local KnightXEnd:Float = Position.x*32
	Local KnightYEnd:Float = (7-Position.y)*32
	Local KnightXStart:Float = KnightXEnd
	Local KnightYStart:Float = KnightYEnd
	If OldPosition
		KnightXStart = OldPosition.X*32
		KnightYStart = (7-OldPosition.y)*32
	End If
		

	Repeat
		If KeyHit(KEY_ESCAPE) Then End
		Time = MilliSecs()
		Delta = Float(Time-Oldtime)/1000.0
		Local KnightX:Float = (KnightXEnd - KnightXStart)*Delta+KnightXStart
		Local KnightY:Float = (KnightYEnd - KnightYStart)*Delta+KnightYStart
		
		Cls
		
		For Local x:Int = 0 To 7 'draw the board
			For Local y:Int = 0 To 7
				If Visited[x,y] = 1
					If (x &amp; 1) ~ (y &amp; 1) = 1
						SetColor 0,0,255
					Else
						SetColor 128,128,255
					End If
				Else
					If (x &amp; 1) ~ (y &amp; 1) = 1
						SetColor 255,0,0
					Else
						SetColor 255,128,128
					End If
				End If
				DrawRect x*32,(7-y)*32,32,32
			Next
		Next
		
		'Draw the knight
		SetColor 0,0,0
		DrawOval KnightX,KnightY,32,32
		SetColor 255,255,255
		DrawOval KnightX+2,KnightY+2,28,28
		Flip 0
	Until Delta &gt;= 1.0 Or OldPosition = Null
End Function
</textarea> <br><br></td></tr></table><br>
<a name="1293624"></a>

<a name="1293631"></a>

<a name="1293632"></a>

<a name="1293633"></a>

<a name="1293649"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wholly Smacks, Tom ! That is some real BB code there ! Beyond beautiful !<br><br>I thought about the puzzle myself and I =THINK= this particular one is considerably more difficult than the Queens. Not that it would be easy, can you have it start from any position on the board ?<br><br>You can change this code:<pre class=code>If (x &amp; 1) ~ (y &amp; 1) = 1</pre>to<pre class=code>If(x+y)Mod 2</pre> if you like and you will still get a beautifully colored chessboard.<br><br>Still ... very nice coding ! <br><br></td></tr></table><br>
<a name="1293823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, I could've done (x~y)&amp;1<br><br>That probably would've been the fastest way. <br><br></td></tr></table><br>
<a name="1293838"></a>

<a name="1293905"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> For those who want it, <a href="http://www.tomtoad.com/BlitzMax/mit_src.7z" target="_blank">Source code for Mate in Two</a> <br><br></td></tr></table><br>
<a name="1293898"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does ~ mean NOT or XOR in BMax? <br><br>If it means NOT  then (x+y) &amp; 1 would be fastest. because NOT has drawback in speed (you could use XOR allbits to fake NOT but then you have one uneeded instruction instead).<br><br>If it means XOR then both (x~y)&amp;1 and (x+y)&amp;1 would be equally fast.<br><br>I´m amazed at all the code here. Really nice.<br>Both graphicswise, and the algoritms it looks MARBLE-less.<br><br>I would like to dig up my Suduoko code and convert it into Bmax now. <br><br></td></tr></table><br>
<a name="1293914"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi Casaber. Glad I know something for a change. :)<br><br>Yes, the tilde "~" means XOR. You can see it in heavy use for encryption HERE:<br><br><a href="/post.php?topic=105767&amp;post=1293912" target="_blank">http://www.blitzbasic.com/Community/post.php?topic=105767&amp;post=1293912</a> <br><br></td></tr></table><br>
<a name="1293917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> if there is only 1 parameter, it means NOT (a = ~x -&gt; a = NOT x)<br>If there are 2 parameters, it means XOR(a = x ~ y -&gt; a = x XOR y)<br><br>After doing a benchmark, I was surprised that + was twice as fast as ~, I'd think worse case scenario would be the same speed. <br><br></td></tr></table><br>
<a name="1293920"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Good to know, TomToad ! It means NOT you don't have a variable on the left. I need to commit that to memory. I could find that useful later. <br><br></td></tr></table><br>
<a name="1293930"></a>

<a name="1293938"></a>

<a name="1293939"></a>

<a name="1293941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> What am I doing wrong here? Or, is Bmax optimizing after all? <br>I don´t know what else to believe because I get the same time time on all? 700+-1<br><br>EDIT OOPS loop overhead. Take away one zero of the loop and do 10 of anything instead inside the loop and it gets tenfold faster. This was a bad benchmark of me. The loop code got all the time.<br><br>EDIT Still the same zero difference between them though. I need to check the assembler source. Got curious. I´m doing something very wrong.<br><br><pre class=code>
a=0 ; x=10 ; y=20

starttime = MilliSecs()
For temp = 1 To 1000000000

a = x + y   ' ADD	704
' a = x - y ' SUB		704
' a = -x    ' NEG		700
' a = ~x    ' NOT		705
' a = x ~ y ' XOR	695

Next
endtime = MilliSecs()

Print endtime-starttime
WaitKey
</pre> <br><br></td></tr></table><br>
<a name="1293942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I think my difference is to CPU optimizations.   I wrote a test program that would perform ~ a bunch of times, then + a bunch of times and print the results.  + was coming out twice as fast.  If I swap the order of the tests, then ~ is twice as fast.  I think that the CPU sees that the test program is doing a ton of calculations really quick and after a while, tasks more of the CPU to the program, causing whatever tests later to run much faster. <br><br></td></tr></table><br>
<a name="1293946"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually that's correct here. 4000+ is about 4-seconds.<br><br>Or if you are getting a different result, please post the total you are receiving, Casaber. <br><br></td></tr></table><br>
<a name="1293947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeup, that is what's happening.  Just ran task manager and watched as CPU usage was ramped up from about 20% to over 30%.  That will make profiling much more difficult to achieve. <br><br></td></tr></table><br>
<a name="1293957"></a>

<a name="1293958"></a>

<a name="1293961"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, Casaber, I think what you want to do to determine which command is at what speed. Try this code and see if it gives you better information:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict
Local a=0,x=10,y=20,typ,c,starttime

typ=0

starttime = MilliSecs()
Repeat
  If typ=0 Then a=x+y ' 108766
  If typ=1 Then a=x-y ' 108458
  If typ=2 Then a=-x  ' 109020
  If typ=3 Then a=~x  ' 116643
  If typ=4 Then a=x~y ' 110742
  c:+1
Until MilliSecs()-starttime&gt;=10
Print c
WaitKey
</textarea><br><br>As far as I can tell, I think these commands are pretty well and evenly matched. <br><br></td></tr></table><br>
<a name="1293964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I´m going crazy trying to understand where to find the assembler source on OSX here.<br><br>With Blitz3D and Windows you could create a file like so, easy peasy:<br><br>Compile.bat<br><pre class=code>
blitzcc -a -c name.bmax name.asm
</pre> <br><br></td></tr></table><br>
<a name="1293967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you wanting to run a BAT file in BlitzMAX ? That can be done. <br><br></td></tr></table><br>
<a name="1293968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don´t think OSX has bat files? Is there a way to tell Bmax to leave the assembler files intact and not throw them away on Macs? <br><br></td></tr></table><br>
<a name="1293974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't even know if BlitzMAX can do assembly. I =THINK= it can do C but I'm not certain.<br><br>OSX is for the Macintosh ? <br><br></td></tr></table><br>
<a name="1293981"></a>

<a name="1293982"></a>

<a name="1293989"></a>

<a name="1293990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya Bmax executables is created using FASM on all platforms. And I read in the latest info that now it allows FASM optimations.<br><br>BMax I think is able to IMPORT "filename.s" even,  but you cannot inline assembler code.<br><br>EDIT<br>Monkey for example keeps all the sourcefiles readily after you've pushed the run button, which is nice. But BMax throws everything away, and keeps only the <br>final executable. I would love to check that temporarily created asm file now. I cannot come up with a easy way. Right now the easiest way would be to deassemble and look carefully for a few hours haha.<br><br>I know, It's probably easiest thing in the world when you've finally learned it, but right now I´m getting gray hair here :s <br><br></td></tr></table><br>
<a name="1293991"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya Bmax executables is created using FASM on all platforms. And I read in the latest info that now it allows FASM optimations.<br><br>BMax I think is able to IMPORT "filename.s" even,  but you cannot inline assembler code.<br><br>EDIT<br>Monkey for example keeps all the sourcefiles readily after you've pushed the run button, which is nice. But BMax throws everything away, and keeps only the <br>final executable. I would love to check that temporarily created asm file now. I cannot come up with a easy way. Right now the easiest way would be to deassemble and look carefully for a few hours haha.<br><br>I know, It's probably easiest thing in the world when you've finally learned it, but right now I´m getting gray hair here :s <br><br></td></tr></table><br>
<a name="1293992"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya Bmax executables is created using FASM on all platforms. And I read in the latest info that now it allows FASM optimations.<br><br>BMax I think is able to IMPORT "filename.s" even,  but you cannot inline assembler code.<br><br>EDIT<br>Monkey for example keeps all the sourcefiles readily after you've pushed the run button, which is nice. But BMax throws everything away, and keeps only the <br>final executable. I would love to check that temporarily created asm file now. I cannot come up with a easy way. Right now the easiest way would be to deassemble and look carefully for a few hours haha.<br><br>I know, It's probably easiest thing in the world when you've finally learned it, but right now I´m getting gray hair here :s <br><br></td></tr></table><br>
<a name="1293996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> Three gray hairs to be precise. :) Looks like the forum triple-posted you. It's done that to me a few times.<br><br>Casaber, as this post is primarily about chess, you might make a new post about what you are asking. You'll have fresh faces and new ideas sent to you.<br><br>Because I think if someone sees that there is a new post in the Chess Queen Puzzle and they may not be looking for someone asking for help with assembly.<br><br>You may get it here, I hope you find the answer you're looking for. <br><br></td></tr></table><br>
<a name="1294000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> BTW, Casaber, you mentioned you are looking for assembly code ? I found if you go inside the directory, <b>".bmx"</b> which is located outside the compiled EXE, there are two types of files there.<br><br>One has an "o" extension. I think you would be interested in the "s" extension which, from viewing in Notepad, appears to be the raw assembly code of what you just compiled. <br><br></td></tr></table><br>
<a name="1294006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldn't you know it?  Since<b> a</b> never gets used, the math is never performed.  The compiler just optimizes it right out of the code. It just loops several times, prints the resulting times, then ends.<br><br>By adding  the result of <b>a</b> to the Print statement after the loop, the math is kept in the code.  Both take exactly the same amount of time.<br><b>Print a+" "+(EndTime - StartTime)</b> <br><br></td></tr></table><br>
<a name="1294014"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Dw817 I htough t i saw that somewhere !! I guess it's different on Windows and I saw it over there, On Mac you cannot see tha but yu of course I might start a thread later about that. <br><br>Sorry for the subjectchange, good call. <br><br></td></tr></table><br>
<a name="1294018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, that's fine, we're all learning here, Casaber. Truly I thought operands operated at a different speed, but maybe not. It's an interesting point you brought up:<br><br>Here is another model:<br><br>Now you would THINK this one to be very accurate as it determines the average value of cycles per 1% of a second in a total of 100 times.<br><br>I'm also not just calculating the same number each time but adding it the total so you are guaranteed to have work on each type.<br><br>I'm also doing a time out in the beginning to ensure there is nothing to mess up the timing.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
' Determine speed of operands
' Conclusion ? I don't think these can be tested accurately
Strict
Local a=0,x=10,y=20,typ,c,starttime,i

typ=0

starttime=MilliSecs()
Repeat
Until MilliSecs()-starttime&gt;=50 ' time out for a bit

For i=0 To 99 ' loop for 100 times
  starttime = MilliSecs()
  Repeat
    If typ=0 Then a:+x+y ' 116382
    If typ=1 Then a:+x-y ' 115648
    If typ=2 Then a:+-x  ' 115667
    If typ=3 Then a:+~x  ' 115950
    If typ=4 Then a:+x~y ' 116108
    c:+1
  Until MilliSecs()-starttime&gt;=10 ' keep looping until 1% of a second has elapsed
Next
Print "Managed "+c/100+" cycles."
WaitKey
</textarea> <br><br></td></tr></table><br>
<a name="1294047"></a>

<a name="1294050"></a>

<a name="1294052"></a>

<a name="1294054"></a>

<a name="1294055"></a>

<a name="1294056"></a>

<a name="1294057"></a>

<a name="1294059"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Casaber</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just one last about code (I got my hands on the PC)<br>It was tough to get it to keep variables, if you don´t end up using something, it just won´t compile anything. So it's kind of good that way.<br><br>EDIT<br>So it's very sloppy optimizing. It manages the not needed part. An add for instance wouldnt hurt and most of all, it would be easy as cake to see it in the source and take away manually if it where a catastrophy in speed.<br><br>Then it plumps on all kinds things CALL, branches etc. I would call this code. Non-optimized. <br>Technically it is optimized, but on the wrong things. It´s okay though. I know Assembler all to well to appriciate BASIC ;)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics 800,600
Repeat
a=5
Plot a,a
a=a+1
Delay 1
Flip 1
Until MouseDown(2)

Becomes in assembly code:

	format	MS COFF
	extrn	___bb_appstub_appstub
	extrn	___bb_audio_audio
	extrn	___bb_bank_bank
	extrn	___bb_bankstream_bankstream
	extrn	___bb_basic_basic
	extrn	___bb_blitz_blitz
	extrn	___bb_bmploader_bmploader
	extrn	___bb_d3d7max2d_d3d7max2d
	extrn	___bb_d3d9max2d_d3d9max2d
	extrn	___bb_data_data
	extrn	___bb_directsoundaudio_directsoundaudio
	extrn	___bb_eventqueue_eventqueue
	extrn	___bb_freeaudioaudio_freeaudioaudio
	extrn	___bb_freejoy_freejoy
	extrn	___bb_freeprocess_freeprocess
	extrn	___bb_freetypefont_freetypefont
	extrn	___bb_glew_glew
	extrn	___bb_gnet_gnet
	extrn	___bb_jpgloader_jpgloader
	extrn	___bb_macos_macos
	extrn	___bb_map_map
	extrn	___bb_maxlua_maxlua
	extrn	___bb_maxutil_maxutil
	extrn	___bb_oggloader_oggloader
	extrn	___bb_openalaudio_openalaudio
	extrn	___bb_pngloader_pngloader
	extrn	___bb_retro_retro
	extrn	___bb_tgaloader_tgaloader
	extrn	___bb_threads_threads
	extrn	___bb_timer_timer
	extrn	___bb_wavloader_wavloader
	extrn	_bbDelay
	extrn	_brl_graphics_Flip
	extrn	_brl_graphics_Graphics
	extrn	_brl_max2d_Plot
	extrn	_brl_polledinput_MouseDown
	public	__bb_main
	section	"code" code
__bb_main:
	push	ebp
	mov	ebp,esp
	sub	esp,4
	cmp	dword [_28],0
	je	_29
	mov	eax,0
	mov	esp,ebp
	pop	ebp
	ret
_29:
	mov	dword [_28],1
	call	___bb_blitz_blitz
	call	___bb_appstub_appstub
	call	___bb_audio_audio
	call	___bb_bank_bank
	call	___bb_bankstream_bankstream
	call	___bb_basic_basic
	call	___bb_bmploader_bmploader
	call	___bb_d3d7max2d_d3d7max2d
	call	___bb_d3d9max2d_d3d9max2d
	call	___bb_data_data
	call	___bb_directsoundaudio_directsoundaudio
	call	___bb_eventqueue_eventqueue
	call	___bb_freeaudioaudio_freeaudioaudio
	call	___bb_freetypefont_freetypefont
	call	___bb_gnet_gnet
	call	___bb_jpgloader_jpgloader
	call	___bb_map_map
	call	___bb_maxlua_maxlua
	call	___bb_maxutil_maxutil
	call	___bb_oggloader_oggloader
	call	___bb_openalaudio_openalaudio
	call	___bb_pngloader_pngloader
	call	___bb_retro_retro
	call	___bb_tgaloader_tgaloader
	call	___bb_threads_threads
	call	___bb_timer_timer
	call	___bb_wavloader_wavloader
	call	___bb_freejoy_freejoy
	call	___bb_freeprocess_freeprocess
	call	___bb_glew_glew
	call	___bb_macos_macos
	push	0
	push	60
	push	0
	push	600
	push	800
	call	_brl_graphics_Graphics
	add	esp,20
_24:
	mov	eax,5
	mov	dword [ebp+-4],eax
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	mov	dword [ebp+-4],eax
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	call	_brl_max2d_Plot
	add	esp,8
	push	1
	call	_bbDelay
	add	esp,4
	push	1
	call	_brl_graphics_Flip
	add	esp,4
_22:
	push	2
	call	_brl_polledinput_MouseDown
	add	esp,4
	cmp	eax,0
	je	_24
_23:
	mov	eax,0
	jmp	_25
_25:
	mov	esp,ebp
	pop	ebp
	ret
	section	"data" data writeable align 8
	align	4
_28:
	dd	0

</textarea><br><br>And the test becomes<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

' Determine speed of operands
' Conclusion ? I don't think these can be tested accurately
Strict
Local a=0,x=10,y=20,typ,c,starttime,i

typ=0

starttime=MilliSecs()
Repeat
Until MilliSecs()-starttime&gt;=50 ' time out for a bit

For i=0 To 99 ' loop for 100 times
  starttime = MilliSecs()
  Repeat
    If typ=0 Then a:+x+y ' 116382
    If typ=1 Then a:+x-y ' 115648
    If typ=2 Then a:+-x  ' 115667
    If typ=3 Then a:+~x  ' 115950
    If typ=4 Then a:+x~y ' 116108
    c:+1
  Until MilliSecs()-starttime&gt;=10 ' keep looping until 1% of a second has elapsed
Next
Print "Managed "+c/100+" cycles."
WaitKey

becomes assembley code

	format	MS COFF
	extrn	___bb_appstub_appstub
	extrn	___bb_audio_audio
	extrn	___bb_bank_bank
	extrn	___bb_bankstream_bankstream
	extrn	___bb_basic_basic
	extrn	___bb_blitz_blitz
	extrn	___bb_bmploader_bmploader
	extrn	___bb_d3d7max2d_d3d7max2d
	extrn	___bb_d3d9max2d_d3d9max2d
	extrn	___bb_data_data
	extrn	___bb_directsoundaudio_directsoundaudio
	extrn	___bb_eventqueue_eventqueue
	extrn	___bb_freeaudioaudio_freeaudioaudio
	extrn	___bb_freejoy_freejoy
	extrn	___bb_freeprocess_freeprocess
	extrn	___bb_freetypefont_freetypefont
	extrn	___bb_glew_glew
	extrn	___bb_gnet_gnet
	extrn	___bb_jpgloader_jpgloader
	extrn	___bb_macos_macos
	extrn	___bb_map_map
	extrn	___bb_maxlua_maxlua
	extrn	___bb_maxutil_maxutil
	extrn	___bb_oggloader_oggloader
	extrn	___bb_openalaudio_openalaudio
	extrn	___bb_pngloader_pngloader
	extrn	___bb_retro_retro
	extrn	___bb_tgaloader_tgaloader
	extrn	___bb_threads_threads
	extrn	___bb_timer_timer
	extrn	___bb_wavloader_wavloader
	extrn	_bbMilliSecs
	extrn	_bbStringClass
	extrn	_bbStringConcat
	extrn	_bbStringFromInt
	extrn	_brl_polledinput_WaitKey
	extrn	_brl_standardio_Print
	public	__bb_main
	section	"code" code
__bb_main:
	push	ebp
	mov	ebp,esp
	sub	esp,16
	push	ebx
	push	esi
	push	edi
	cmp	dword [_48],0
	je	_49
	mov	eax,0
	pop	edi
	pop	esi
	pop	ebx
	mov	esp,ebp
	pop	ebp
	ret
_49:
	mov	dword [_48],1
	call	___bb_blitz_blitz
	call	___bb_appstub_appstub
	call	___bb_audio_audio
	call	___bb_bank_bank
	call	___bb_bankstream_bankstream
	call	___bb_basic_basic
	call	___bb_bmploader_bmploader
	call	___bb_d3d7max2d_d3d7max2d
	call	___bb_d3d9max2d_d3d9max2d
	call	___bb_data_data
	call	___bb_directsoundaudio_directsoundaudio
	call	___bb_eventqueue_eventqueue
	call	___bb_freeaudioaudio_freeaudioaudio
	call	___bb_freetypefont_freetypefont
	call	___bb_gnet_gnet
	call	___bb_jpgloader_jpgloader
	call	___bb_map_map
	call	___bb_maxlua_maxlua
	call	___bb_maxutil_maxutil
	call	___bb_oggloader_oggloader
	call	___bb_openalaudio_openalaudio
	call	___bb_pngloader_pngloader
	call	___bb_retro_retro
	call	___bb_tgaloader_tgaloader
	call	___bb_threads_threads
	call	___bb_timer_timer
	call	___bb_wavloader_wavloader
	call	___bb_freejoy_freejoy
	call	___bb_freeprocess_freeprocess
	call	___bb_glew_glew
	call	___bb_macos_macos
	mov	esi,0
	mov	ebx,10
	mov	dword [ebp-4],20
	mov	dword [ebp-8],0
	mov	edi,0
	call	_bbMilliSecs
	mov	dword [ebp-12],eax
_24:
_22:
	call	_bbMilliSecs
	sub	eax,dword [ebp-12]
	cmp	eax,50
	jl	_24
_23:
	mov	dword [ebp-16],0
	jmp	_42
_27:
	call	_bbMilliSecs
	mov	dword [ebp-12],eax
_30:
	cmp	edi,0
	jne	_43
	mov	eax,ebx
	add	eax,dword [ebp-4]
	add	esi,eax
_43:
	cmp	edi,1
	jne	_44
	mov	eax,ebx
	sub	eax,dword [ebp-4]
	add	esi,eax
_44:
	cmp	edi,2
	jne	_45
	mov	eax,ebx
	neg	eax
	add	esi,eax
_45:
	cmp	edi,3
	jne	_46
	mov	eax,ebx
	not	eax
	add	esi,eax
_46:
	cmp	edi,4
	jne	_47
	mov	eax,ebx
	xor	eax,dword [ebp-4]
	add	esi,eax
_47:
	add	dword [ebp-8],1
_28:
	call	_bbMilliSecs
	sub	eax,dword [ebp-12]
	cmp	eax,10
	jl	_30
_29:
_25:
	add	dword [ebp-16],1
_42:
	cmp	dword [ebp-16],99
	jle	_27
_26:
	push	_32
	mov	ecx,100
	mov	eax,dword [ebp-8]
	cdq
	idiv	ecx
	push	eax
	call	_bbStringFromInt
	add	esp,4
	push	eax
	push	_31
	call	_bbStringConcat
	add	esp,8
	push	eax
	call	_bbStringConcat
	add	esp,8
	push	eax
	call	_brl_standardio_Print
	add	esp,4
	call	_brl_polledinput_WaitKey
	mov	eax,0
	jmp	_33
_33:
	pop	edi
	pop	esi
	pop	ebx
	mov	esp,ebp
	pop	ebp
	ret
	section	"data" data writeable align 8
	align	4
_48:
	dd	0
	align	4
_32:
	dd	_bbStringClass
	dd	2147483647
	dd	8
	dw	32,99,121,99,108,101,115,46
	align	4
_31:
	dd	_bbStringClass
	dd	2147483647
	dd	8
	dw	77,97,110,97,103,101,100,32
</textarea><br><br>An open closeup on the simpler example<br>EDIT the code stays like this when defining a as integer.<br>EDIT it optimized out !! the add It came to me.. If you force in a PLOT A,A after the add, it compiles the add. It skipped it, that FPU code is nothing related to an add. Im not sure what it does in there.<br><br><pre class=code>
Repeat
a=5
Plot a,a
a=a+1
Delay 1
Flip 1
Until MouseDown(2)

Becomes

_24:        ' REPEAT'

' A = 5'
mov	eax,5

' A = A + 1 ' (ODD ADD MULTILINER COMING UP)

	mov	dword [ebp+-4],eax
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	mov	dword [ebp+-4],eax
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]

' PLOT'
	call	_brl_max2d_Plot

	add	esp,8
' DELAY 1'
	push	1
	call	_bbDelay

	add	esp,4
' FLIP 1'
	push	1
	call	_brl_graphics_Flip

	add	esp,4
_22:
	push	2
	call	_brl_polledinput_MouseDown ' READ MOUSEDOWN'
	add	esp,4
	cmp	eax,0 ' = 0 ?
	je	_24   ' UNTIL (JUMP IF MOUSEDOWN = 0)
' END'
..
</pre><br><br>for completeness this is how it looks when you add a PLOT A,A right after the add. It then compiles the add. (if not its clever not to compile the add).<br>It seem like that FPU code is for the PLOT?  Converting integer to float? I´m not sure what else it could be about. Ya it's conversion in action.<br> <br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
	format	MS COFF
	extrn	___bb_appstub_appstub
	extrn	___bb_audio_audio
	extrn	___bb_bank_bank
	extrn	___bb_bankstream_bankstream
	extrn	___bb_basic_basic
	extrn	___bb_blitz_blitz
	extrn	___bb_bmploader_bmploader
	extrn	___bb_d3d7max2d_d3d7max2d
	extrn	___bb_d3d9max2d_d3d9max2d
	extrn	___bb_data_data
	extrn	___bb_directsoundaudio_directsoundaudio
	extrn	___bb_eventqueue_eventqueue
	extrn	___bb_freeaudioaudio_freeaudioaudio
	extrn	___bb_freejoy_freejoy
	extrn	___bb_freeprocess_freeprocess
	extrn	___bb_freetypefont_freetypefont
	extrn	___bb_glew_glew
	extrn	___bb_gnet_gnet
	extrn	___bb_jpgloader_jpgloader
	extrn	___bb_macos_macos
	extrn	___bb_map_map
	extrn	___bb_maxlua_maxlua
	extrn	___bb_maxutil_maxutil
	extrn	___bb_oggloader_oggloader
	extrn	___bb_openalaudio_openalaudio
	extrn	___bb_pngloader_pngloader
	extrn	___bb_retro_retro
	extrn	___bb_tgaloader_tgaloader
	extrn	___bb_threads_threads
	extrn	___bb_timer_timer
	extrn	___bb_wavloader_wavloader
	extrn	_bbDelay
	extrn	_brl_graphics_Flip
	extrn	_brl_graphics_Graphics
	extrn	_brl_max2d_Plot
	extrn	_brl_polledinput_MouseDown
	public	__bb_main
	section	"code" code
__bb_main:
	push	ebp
	mov	ebp,esp
	sub	esp,4
	push	ebx
	cmp	dword [_28],0
	je	_29
	mov	eax,0
	pop	ebx
	mov	esp,ebp
	pop	ebp
	ret
_29:
	mov	dword [_28],1
	call	___bb_blitz_blitz
	call	___bb_appstub_appstub
	call	___bb_audio_audio
	call	___bb_bank_bank
	call	___bb_bankstream_bankstream
	call	___bb_basic_basic
	call	___bb_bmploader_bmploader
	call	___bb_d3d7max2d_d3d7max2d
	call	___bb_d3d9max2d_d3d9max2d
	call	___bb_data_data
	call	___bb_directsoundaudio_directsoundaudio
	call	___bb_eventqueue_eventqueue
	call	___bb_freeaudioaudio_freeaudioaudio
	call	___bb_freetypefont_freetypefont
	call	___bb_gnet_gnet
	call	___bb_jpgloader_jpgloader
	call	___bb_map_map
	call	___bb_maxlua_maxlua
	call	___bb_maxutil_maxutil
	call	___bb_oggloader_oggloader
	call	___bb_openalaudio_openalaudio
	call	___bb_pngloader_pngloader
	call	___bb_retro_retro
	call	___bb_tgaloader_tgaloader
	call	___bb_threads_threads
	call	___bb_timer_timer
	call	___bb_wavloader_wavloader
	call	___bb_freejoy_freejoy
	call	___bb_freeprocess_freeprocess
	call	___bb_glew_glew
	call	___bb_macos_macos
	push	0
	push	60
	push	0
	push	600
	push	800
	call	_brl_graphics_Graphics
	add	esp,20
_24:
	mov	ebx,5
	mov	dword [ebp+-4],ebx
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	mov	dword [ebp+-4],ebx
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	call	_brl_max2d_Plot
	add	esp,8
	add	ebx,1
	mov	dword [ebp+-4],ebx
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	mov	dword [ebp+-4],ebx
	fild	dword [ebp+-4]
	sub	esp,4
	fstp	dword [esp]
	call	_brl_max2d_Plot
	add	esp,8
	push	1
	call	_bbDelay
	add	esp,4
	push	1
	call	_brl_graphics_Flip
	add	esp,4
_22:
	push	2
	call	_brl_polledinput_MouseDown
	add	esp,4
	cmp	eax,0
	je	_24
_23:
	mov	eax,0
	jmp	_25
_25:
	pop	ebx
	mov	esp,ebp
	pop	ebp
	ret
	section	"data" data writeable align 8
	align	4
_28:
	dd	0
</textarea> <br><br></td></tr></table><br>
<a name="1294053"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted 2016)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Casaber, you have the repeat before the a = 5. You might swap places and then the line will draw. :)<br><br>In addition to that, if you use Framework your machine code might get smaller and using GlMax2DDriver(),0 will make it plot a lot faster than without.<br><br><pre class=code>Strict
Framework brl.glmax2d ' standard Graphics
Local a
SetGraphicsDriver GLMax2DDriver(),0
Graphics 800,600
a=5
Repeat
Plot a,a
a=a+1
Delay 1
Flip 1
Until MouseDown(2)</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
