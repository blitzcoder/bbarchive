<!DOCTYPE html><html lang="en" ><head ><title >How many locals?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How many locals?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >How many locals?</a><br><br>
<a name="629234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> On today's modern CPU's, how many `Local` variables can I define and be fairly sure that they will all be allocated to CPU registers, rather than begin to spill over as memory variables? Ie how many can be in use simultaneously and still be efficient? <br><br></td></tr></table><br>
<a name="629235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> does BMX even put variables in registers if it can? if so i think it just depends on how many registers you have. <br><br></td></tr></table><br>
<a name="629237"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes locals are given to the cpu<br><br>Angel: Don't worry about that. If you have too many of them, they will end in the second level cache and then in the regular RAM, its not like in ASM where it must reside in CPU. Beside that: Don't think you will fill up 512kbyte that easy ;-) (thats the minimum actual have like AMD64 - AMD does not need them that much their connection too ram beats Intel to death - and goes up to 2MB of second level cache) <br><br></td></tr></table><br>
<a name="629258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Obviously I want to keep as many variables in cpu registers as possible. I know I don't have to worry about how Max handles the situation when there aren't enough to go around. What I want to know is a ballpark figure for how many Locals I can assume will be in registers. Then I can design my code to be more efficient. I know the memory these days is pretty fast but still not as fast. Speed is important.<br><br>I thought PowerPC had like 32 registers or something? Same for AMD/Intel? <br><br></td></tr></table><br>
<a name="629263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Defoc8</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your worrying about register usage - i think you must have<br>your head screwed on backwards...yes speed is important,<br>but you cannot equate the number of locals stored in <br>registers to the speed of the resulting machine code..anyway <br>goodluck. <br><br> - If your really concerned about it..im pretty sure bmax<br> - outputs assembly files as part of its compiler operation.<br> - personaly i think this is waste of time.. <br><br></td></tr></table><br>
<a name="629342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chris C</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> the whole idea of compilers is to release you from this kind of maddness, 10 times out of 10 if somthing seems to be taking too long its your algorithm not how many local registers you're using... <br><br></td></tr></table><br>
<a name="629343"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Leiden</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The original AMD's only had 16 registers, 8 general purpose, and 8 XMM registers. The AMD64 series increased to 32 registers, 16 general, and 16 XMM. Risc processors still have more though, <br><br></td></tr></table><br>
<a name="629350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> On today's modern CPU's, how many `Local` variables can I define and be fairly sure that they will all be allocated to CPU registers, rather than begin to spill over as memory variables? <br></div>None. <br><br></td></tr></table><br>
<a name="629355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> None.  <br></div><br><br>Since you're running on a multi-tasking operating system, there is no telling what the OS chooses to swap where and when. <br><br></td></tr></table><br>
<a name="629427"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> PPC has 32 regular registers and 32 floating point registers and besides the other ones such as link register, condition register. Obviously some of those are gonna be used, but im sure you don't really have to worry about this, its not going to make much of a differenence. Like Chris C said, the reason higher level languages were developed is so you didnt have to worry about all this stuff when programming in assembly. <br><br></td></tr></table><br>
<a name="629435"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> what's going into the cache (say, the 512k dreamore mentinoed) ? the actual vars, or only a reference to those vars?<br><br>e.g. does a local array of 2*512*512 bytes cost me 512k or 4 bytes? <br><br></td></tr></table><br>
<a name="629453"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> The question of whether there is a point to it or whether it is useful in the modern era or whether there is any worth `worrying` about it is entirely subjective opinion. I wasn't asking for everyone's judgements of the validity of the question, I just wanted to know the number. Flameduck's response is interesting but a worst case scenario for sure. It's good to know that 16 registers is about a reasonable minimum. Thanks for all your observations. <br><br></td></tr></table><br>
<a name="629536"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> what's going into the cache (say, the 512k dreamore mentinoed) ? the actual vars, or only a reference to those vars? <br></div>It depends. The data cache stores variables (actual data from memory) the instruction cache stores decoded opcodes for expensive operations. You'll rarely actually have 512K of data cache available at any given time. Also note that a value stored in the cache will take up more space than a value stored in memory.<br><br><div class="quote"> e.g. does a local array of 2*512*512 bytes cost me 512k or 4 bytes? <br></div>It costs you a lot more. Depending on the cache used it would probably cost you 3 bytes of cache to store a 1 byte value (1 for the value, 2 for the address/association).<br><br><div class="quote"> It's good to know that 16 registers is about a reasonable minimum. <br></div>All local variables are allocated on the stack, thus there is no way to allocate them directly as registers, particularly since this would limit the compilers ability to optimize and rearrange opcodes. Remember, some processors still only have 4 general purpose registers, and the runtime is going to need at least one at any time, which in a best case scenario means that you can have three variables in play at any given time, before you need to switch in and out of registers. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
