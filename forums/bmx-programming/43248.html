<!DOCTYPE html><html lang="en" ><head ><title >2D particles engine</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >2D particles engine</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >2D particles engine</a><br><br>
<a name="483338"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a 2D particles engine module for win32.<br>Some parameters missing, but I'm still working on it.<br><a href="http://projetblitz.free.fr/Ressources/PartEngineDistrib05.zip" target="_blank">PartEngine Beta 0.5</a> <br><br></td></tr></table><br>
<a name="483442"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> How come only for win32? <br><br></td></tr></table><br>
<a name="483444"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> [ERROR]: c:\blitzmaxbeta101\bin\ld: cannot find c:/blitzmaxbeta101/mod/ftbass.mod/ftbass.mod/ftbass.a <br><br></td></tr></table><br>
<a name="483480"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ftbass: It's not a module if it isn't classified as one in the source code.<br><br>Pert: You have to build it after classifying it as a module (putting 'Module ftbass.ftparticle' at the top of the file then sticking it in a folder that represents the module structure). <br><br></td></tr></table><br>
<a name="483485"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @AngelDaniel : <br>I built it on Windows, and didn't test it on other OS.<br>I think I have to built it again for Linux, and Mac.<br><br>@Noel Cower : <br>In the source code, there is :<br><pre class=code>
Module ftbass.partengine

ModuleInfo "Name: PartEngine"
ModuleInfo "Description: Moteur de particules 2D"
ModuleInfo "Auteur: ftbass"

Import BRL.LinkedList
Import BRL.System
Import BRL.Random
Import BRL.Max2D
</pre><br>so I think it's classified as a module.<br><br>It works fine on my PC, and another one too...<br><br>Does it work anywhere else than on these 2 PC ??? Or maybe can anyone tell me what is missing ?<br><br>thx <br><br></td></tr></table><br>
<a name="483486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hm, seems mine didn't download entirely.  Weird, but you are right- it is there (well, it is after downloading it a second time).<br><br>My apologies. <br><br></td></tr></table><br>
<a name="483487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> np :) <br><br></td></tr></table><br>
<a name="513328"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ftbass<br>Doesn't work here - I get a Compile Error: "Identifier 'TEmetteur' not found" when BMax is trying to compile it.<br>Tried it with Demo and with Tutorial7<br>There is no .bmx file in the ftbass.mod folder - just another folder "partengine.mod" with 2 files (partengine.a and partengine.i) and a .bmx folder - is that right? <br><br></td></tr></table><br>
<a name="513431"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I get the same error as RaGR ok here are the files in the "PartEngine.mod"<br><br>1. Folder = .bmx<br>2.  File = partengine.a<br>3.  File = partengine.i<br><br>you cannot compile it or import it because you have missing files. <br><br></td></tr></table><br>
<a name="513432"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh and can you create a english version. <br><br></td></tr></table><br>
<a name="513587"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oops... sorry I am really late :/<br>here is a version of the module built with BlitzMax 1.06.<br>I hope this will solve problems.<br><br><a href="http://projetblitz.free.fr/Ressources/PartEngineDistrib06.zip" target="_blank">PartEngine Beta 0.6</a><br><br>Some parameters missing, but still working on it :)<br><br>Please let me know if it works (or not).<br>some friends of mine tested it, and there was no matter.<br><br>Many thanks :) <br><br></td></tr></table><br>
<a name="513702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works now - possibly it was okay before, too<br><br>But I made the mistake to put ftbass.mod into the pub.mod folder (had somehow in mind that there are Blitz Research Mods - brl.mod and public mods - pub.mod - so I expected your module has to go into the public one...)<br><br>Okay now I have copied it direct into the mod folder and its okay<br><br>Thank you <br><br></td></tr></table><br>
<a name="513899"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KamaShin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> "Identifier 'TEmetteur' not found" (tested it on a Mac) <br><br></td></tr></table><br>
<a name="513904"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tried it very nice. You still have a problem with the mods the compiler is trying to find Debug version while you have the Release version. <br><br></td></tr></table><br>
<a name="513932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Kamashin : this module was compiled with Windows, so it can't work on Mac.<br>I'll try to find a way to compile it on Mac.<br><br>@Sarge : here's a new version correctly built (I hope :))<br><br><a href="http://projetblitz.free.fr/Ressources/PartEngineDistrib06.zip" target="_blank">PartEngine Beta 0.6</a><br><br>Thanks for feed back :) <br><br></td></tr></table><br>
<a name="513963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diordna</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Send me the source and I'll see what I can do, ftbass. Just tell me what you did to compile yours (I have no experience with modules); it probably just requires me doing the same thing on the Mac, unless it's in C++ or something.<br><br>Actually, you really should just distribute the source. It would be easier on everyone that way. <br><br></td></tr></table><br>
<a name="513964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KamaShin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> if it's just about compiling, I could do it if I had the source... But I guess you don't want to make the source public... (d ailleurs t es francais non??? vu ke toute la doc et les commentaires du .bmx de test sont en francais :)<br>hop, un compatriote :) ) <br><br></td></tr></table><br>
<a name="514055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well... I decided to post the source code of PartEngine.<br>You can do whatever you want of it. Just share your improvements if you're doing some.<br>And please let me know if you use this engine in some prod ;)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
	'######################################################################'
	'#	PartEngine Beta v0.6.1
	'#	
	'#	par Julien COIGNET aka ftbass
	'#	email : breddabasse@...
	'######################################################################'

	' A FAIRE :
	' - 
	'----------------------------

Rem
################################################################
# Pour en faire un module, enlever les commentaires d'ici...

Strict


Module ftbass.partengine

ModuleInfo "Name: PartEngine"
ModuleInfo "Description: Moteur de particules 2D"
ModuleInfo "Auteur: ftbass"

Import BRL.LinkedList
Import BRL.System
Import BRL.Random
Import BRL.Max2D

# ... a ici.
################################################################
EndRem


Global P2D_ListeEmet:TList = New TList		' Liste des émetteurs


'################################################################
' Type Emetteur
'################################################################
Type TEmetteur

	Field listePart:TList			' Liste des particules creees par cet emetteur
	
	Field image					' Image affichée par les particules
	Field x:Float, y:Float			' Position de l'emetteur
	Field ecartX:Float			' Ecart de la position en Y des particules a la creation
	Field ecartY:Float			' Ecart de la position en Y des particules a la creation
	Field dx:Float, dy:Float		' Vitesse
	Field accX:Float, accY:Float	' Accélération
	Field age:Int					' Age de l'emetteur
	Field heureCreation:Int		' Heure de creation de l'emetteur
	Field longevite:Int			' Duree apres laquel l'emetteur sera supprime
	Field angle:Float				' Angle d'emission des particules
	Field nbPartFrame:Float		' Nb de particules créé par frame
	Field nbFramePourEmt:Float		' Nb de frames entre chaque emission de particules (si nbPartFrame &lt; 0)
	Field nbFrameRestant:Int		' Nb de frames avant emission (si nbPartFrame &lt; 0)
	Field nbPartCourant:Int		' Nb de particules actuellement en activité
	Field echelleXIni:Float		' Scale X initial
	Field echelleYIni:Float		' Scale Y initial
	Field ecartEchelleXIni:Float	' Ecar(t en X du scale initial
	Field ecartEchelleYIni:Float	' Ecar(t en Y du scale initial
	Field dEchelleX:Float			' Modification du scale X
	Field dEchelleY:Float			' Modification du scale Y
	Field alphaIni:Float			' Alpha initial
	Field ecartAlpha:Float			' Ecart alpha initial
	Field dAlpha:Float			' Evolution de l'alpha
	Field ecartDAlpha:Float		' Ecart dans l'evolution de l'alpha
	Field typeEmt:String			' Type de l'emetteur : alpha / light
	Field viePart:Int				' Duree de vie d'une particule
	Field ecartViePart:Int			' Ecart pour la durée de vie des particules
	
	Field etat:String				' Etat de l'emetteur : actif / supprime
	
	'-----------------------------------------------------------
	' Mise à jour de l'emetteur
	'-----------------------------------------------------------
	Method Update()
	
		Local i:Int
		Local p:TParticule = New TParticule
	
		If longevite = -1 Then
			Select etat
				Case "actif"
					' On met à jour l'age de l'emetteur
					age = (MilliSecs() - heureCreation) / 1000
					If nbPartFrame &gt;= 1 Then
						For i = 1 To nbPartFrame
							p = P2D_CreatePart(Self, image, x, y, rnd(ecartX) - (ecartX / 2), rnd(ecartY) - (ecartY / 2))', 0, -1, 0, 0)
							p.ReglerEchelle(echelleXIni + (rnd(ecartEchelleXIni) - (ecartEchelleXIni/2)), echelleYIni + (rnd(ecartEchelleYIni) - (ecartEchelleYIni/2)), dEchelleX:Float, dEchelleY:Float)
							p.ReglerAlpha(alphaIni + (rnd(ecartAlpha)  - (ecartAlpha / 2)), dAlpha + (rnd(ecartDAlpha) - (ecartDAlpha /2)))
							p.ReglerVelocite(dx, dy, accX, accY)
							p.ReglerVie(viePart, ecartViePart)
						Next
					Else
						If nbFrameRestant &lt; 0 Then
							p = P2D_CreatePart(Self, image, x, y, rnd(ecartX) - (ecartX / 2), rnd(ecartY) - (ecartY / 2))', 0, -1, 0, 0)
							p.ReglerEchelle(echelleXIni + (rnd(ecartEchelleXIni) - (ecartEchelleXIni/2)), echelleYIni + (rnd(ecartEchelleYIni) - (ecartEchelleYIni/2)), dEchelleX:Float, dEchelleY:Float)
							p.ReglerAlpha(alphaIni + (rnd(ecartAlpha)  - (ecartAlpha / 2)), dAlpha + (rnd(ecartDAlpha) - (ecartDAlpha /2)))
							p.ReglerVelocite(dx, dy, accX, accY)
							p.ReglerVie(viePart, ecartViePart)
							
							nbFrameRestant = nbFramePourEmt
						Else
							nbFrameRestant = nbFrameRestant - 1
						End If
					End If

				Case "supprime"
					If CountList(listePart) = 0 Then
						ListRemove(P2D_listeEmet, Self)
					End If
			End Select
		Else
			Select etat
				Case "actif"
					' On met à jour l'age de l'emetteur
					age = (MilliSecs() - heureCreation) / 1000
					'On compare l'age à la longevite 
					If age =&gt; longevite Then
						' Si il a fait son temps, on le supprime
						If CountList(listePart) = 0 Then
							ListRemove(P2D_listeEmet, Self)
						End If
					Else
						' Sinon, on genere les particules
						If nbPartFrame &gt;= 1 Then
							For i = 1 To nbPartFrame
								p = P2D_CreatePart(Self, image, x, y, rnd(ecartX) - (ecartX / 2), rnd(ecartY) - (ecartY / 2))', 0, -1, 0, 0)
								p.ReglerEchelle(echelleXIni + (rnd(ecartEchelleXIni) - (ecartEchelleXIni/2)), echelleYIni + (rnd(ecartEchelleYIni) - (ecartEchelleYIni/2)), dEchelleX:Float, dEchelleY:Float)
								p.ReglerAlpha(alphaIni + (rnd(ecartAlpha)  - (ecartAlpha / 2)), dAlpha + (rnd(ecartDAlpha) - (ecartDAlpha /2)))
								p.ReglerVelocite(dx, dy, accX, accY)
								p.ReglerVie(viePart, ecartViePart)
							Next
						Else
							If nbFrameRestant &lt; 0 Then
								p = P2D_CreatePart(Self, image, x, y, rnd(ecartX) - (ecartX / 2), rnd(ecartY) - (ecartY / 2))', 0, -1, 0, 0)
								p.ReglerEchelle(echelleXIni + (rnd(ecartEchelleXIni) - (ecartEchelleXIni/2)), echelleYIni + (rnd(ecartEchelleYIni) - (ecartEchelleYIni/2)), dEchelleX:Float, dEchelleY:Float)
								p.ReglerAlpha(alphaIni + (rnd(ecartAlpha)  - (ecartAlpha / 2)), dAlpha + (rnd(ecartDAlpha) - (ecartDAlpha /2)))
								p.ReglerVelocite(dx, dy, accX, accY)
								p.ReglerVie(viePart, ecartViePart)
								
								nbFrameRestant = nbFramePourEmt
							Else
								nbFrameRestant = nbFrameRestant - 1
							End If
						End If
					End If
				Case "supprime"
				
			End Select		
		End If

	End Method
	
	'-----------------------------------------------------------
	' Suppression d'un emetteur
	'-----------------------------------------------------------
	Method Supprimer(flag:Int = 0)
		
		Local p:TParticule = New TParticule
		
		Select flag
			Case 0
				etat = "supprime"
			Case 1
				etat = "supprime"
				For p=EachIn listePart
					ListRemove(listePart, p)
				Next
				ListRemove(P2D_listeEmet, Self)
		End Select
	
	End Method
	
	'-----------------------------------------------------------
	' Positionnement d'un emmetteur en x y
	'-----------------------------------------------------------
	Method SetPosition(x:Int, y:Int)
		
		Self.x = x
		Self.y = y
		
	End Method
	
	'-----------------------------------------------------------
	' Reglage de l'echelle
	'-----------------------------------------------------------
	Method ReglerEchelle(echelleXIni:Float, echelleYIni:Float, ecartEchelleXIni:Float, ecartEchelleYIni:Float, dEchelleX:Float, dEchelleY:Float)
		
		Self.echelleXIni = echelleXIni
		Self.echelleYIni = echelleYIni
		Self.ecartEchelleXIni = ecartEchelleXIni
		Self.ecartEchelleYIni = ecartEchelleYIni
		Self.dEchelleX = dEchelleX
		Self.dEchelleY = dEchelleY
		
	End Method
	
	
	'-----------------------------------------------------------
	' Reglage de la velocite
	'-----------------------------------------------------------
	Method ReglerVelocite(dx:Float, dy:Float, accX:Float, accY:Float)
	
		Self.dx = dx
		Self.dy = dy
		Self.accX = accX
		Self.accY = accY
		
	End Method
	
	'-----------------------------------------------------------
	' Reglage de l'alpha
	'-----------------------------------------------------------
	Method ReglerAlpha(alphaIni:Float, ecartAlpha:Float, dAlpha:Float, ecartDAlpha:Float)
		
		Self.alphaIni = alphaIni
		Self.ecartAlpha = ecartAlpha
		Self.dAlpha = dAlpha
		Self.ecartDAlpha = ecartDAlpha
		
	End Method
	
	
	'-----------------------------------------------------------
	' Reglage de la duree de vie des particules
	'-----------------------------------------------------------
	Method ReglerVie(viePart:Int, ecartViePart:Int)
		
		Self.viePart = viePart
		Self.ecartViePart = ecartViePart 
		
	End Method


End Type


'################################################################
' Type Particule
'################################################################
Type TParticule

	Field pere:TEmetteur				' Emetteur à l'origine de la particule
	Field image
	Field x:Float, y:Float				' Position
	Field ecartX:Float, ecartY:Float
	Field dx:Float, dy:Float			' Vitesse
	Field accX:Float, accY:Float		' Accélération
	Field EchelleX:Float
	Field EchelleY:Float
	Field dEchelleX:Float				' Modification du scale X
	Field dEchelleY:Float				' Modification du scale Y
	Field Alpha:Float					'
	Field dAlpha:Float
	Field heureCreation:Int			' Heure de cration de la particule
	Field age:Int						' Age de la particule
	Field vie:Int						' Duree de vie de la particule
	
	'-----------------------------------------------------------
	' Mise à jour des particules
	'-----------------------------------------------------------
	Method Update()
	
		dx = dx + accX
		dy = dy + accY
		x = x + dx
		y = y + dy
		echelleX :+ dEchelleX
		echelleY :+ dEchelleY
		
		' Si la particule n'est plus visible, on la supprime
		If (echelleX &lt; 0) Or (echelleY &lt; 0) Then
			ListRemove(pere.listePart, Self)
			pere.nbPartCourant :- 1
		End If
		
		' Si la particule a fait son temps, on la supprime
		If (heureCreation + vie) &lt; MilliSecs() Then
			ListRemove(pere.listePart, Self)
			pere.nbPartCourant :- 1
		End If
		
		
		Select pere.typeEmt
			' Mise à jour de l'alpha
			Case "alpha"
				alpha = alpha + dAlpha
				If dAlpha &lt; 0
					If alpha &lt; .0000 Then
						ListRemove(pere.listePart, Self)
						pere.nbPartCourant :- 1
					End If
				Else
					If dAlpha &gt; 0 Then
						If alpha &gt; 1 Then
							alpha = 1
						End If
					End If
				End If
			Case "light"
				alpha = alpha + dAlpha
				If dAlpha &lt; 0
					If alpha &lt; .0000 Then
						ListRemove(pere.listePart, Self)
						pere.nbPartCourant :- 1
					End If
				Else
					If dAlpha &gt; 0 Then
						If alpha &gt; 1 Then
							alpha = 1
						End If
					End If
				End If
		End Select
		
	End Method
	
	'-----------------------------------------------------------
	' Affichage de la particule
	'-----------------------------------------------------------
	Method Draw()

		Select pere.typeEmt
			Case "alpha"
				SetBlend ALPHABLEND
				SetAlpha(alpha)
			Case "light"
				SetBlend LIGHTBLEND
				SetAlpha(alpha)
		End Select
		
		SetScale(echelleX, echelleY)
		DrawImage image, x, y
		SetScale(1, 1)
		SetAlpha(1)
		SetBlend MASKBLEND
		
	End Method
	
	'-----------------------------------------------------------
	' Reglage de l'echelle
	'-----------------------------------------------------------
	Method ReglerEchelle(echelleXIni:Float, echelleYIni:Float, dEchelleX:Float, dEchelleY:Float)
		
		Self.echelleX = echelleXIni
		Self.echelleY = echelleYIni
		Self.dEchelleX = dEchelleX
		Self.dEchelleY = dEchelleY
		
	End Method
	
	'-----------------------------------------------------------
	' Reglage de l'alpha
	'-----------------------------------------------------------
	Method ReglerAlpha(alpha:Float, dAlpha:Float)
		
		Self.alpha = alpha
		Self.dAlpha = dAlpha
		
	End Method
	
	
	'-----------------------------------------------------------
	' Reglage de la duree de vie des particules
	'-----------------------------------------------------------
	Method ReglerVie(viePart:Int, ecartViePart:Int)
		
		Self.vie = viePart + (Rand(ecartViePart) - (ecartViePart / 2))
		Self.heureCreation = MilliSecs()
		
	End Method
	
	
	'-----------------------------------------------------------
	' Reglage de la velocite
	'-----------------------------------------------------------
	Method ReglerVelocite(dx:Float, dy:Float, accX:Float, accY:Float)
	
		Self.dx = dx
		Self.dy = dy
		Self.accX = accX
		Self.accY = accY
		
	End Method

	
End Type


'----------------------------------------------------------------
' Creation d'une particule
'----------------------------------------------------------------
Function P2D_CreatePart:TParticule(pere:TEmetteur, image, x#, y#, ecartX%, ecartY%)', dx#, dy#, accX#, accY#)

	Local p:TParticule = New TParticule

	pere.nbPartCourant :+ 1

	p.pere = pere
	p.image = image
	MidHandleImage(p.image)
	p.x = x + (rnd(ecartX) - (ecartX/2))
	p.y = y + (rnd(ecartY) - (ecartY/2))
	ListAddFirst pere.listePart, p

	Return p

End Function
	


'----------------------------------------------------------------
' Creation d'un emetteur
'----------------------------------------------------------------
Function P2D_CreateEmetteur:TEmetteur(image, longevite:Int, x:Float, y:Float, ecartX:Float, ecartY:Float, angle:Float, nbPartFrame:Float, typeEmt:String = "light")
	
	Local e:TEmetteur = New TEmetteur

	e.image = image
	e.longevite = longevite
	e.heureCreation = MilliSecs()
	e.x = x
	e.y = y
	e.ecartX = ecartX
	e.ecartY = ecartY
	e.angle = angle
	e.nbPartFrame = nbPartFrame
	If e.nbPartFrame &lt; 1 Then
		e.nbFramePourEmt = 1 / nbPartFrame		' Nb de frames entre chaque emission de particules (si nbPartFrame &lt; 0)
		e.nbFrameRestant = 0
	End If
	e.typeEmt = typeEmt
	e.etat = "actif"
	e.listePart:TList = New TList
	ListAddFirst P2D_ListeEmet, e
	
	Return e
	
End Function

'----------------------------------------------------------------
' Mise à jour de l'ensemble des particules / emetteurs
'----------------------------------------------------------------
Function P2D_Update()

	Local e:TEmetteur = New TEmetteur
	Local p:TParticule = New TParticule
	
	For e=EachIn P2D_ListeEmet
		e.Update()
		For p=EachIn e.listePart
			p.Update()
		Next
	Next

End Function


'----------------------------------------------------------------
' Affichage de l'ensemble des particules
'----------------------------------------------------------------
Function P2D_Afficher()

	Local e:TEmetteur = New TEmetteur
	Local p:TParticule = New TParticule
	
	For e=EachIn P2D_ListeEmet
		For p=EachIn e.ListePart
			p.Draw()
		Next
	Next

End Function


'----------------------------------------------------------------
' Positionnement d'un emetteur en x y
'----------------------------------------------------------------
Function P2D_ReglerPosition(e:TEmetteur, x:Int, y:Int)
	
	e.x = x
	e.y = y
	
End Function


'-----------------------------------------------------------
' Reglage de l'echelle
'-----------------------------------------------------------
Function P2D_ReglerEchelle(e:TEmetteur, echelleXIni:Float, echelleYIni:Float, ecartEchelleXIni:Float, ecartEchelleYIni:Float, dEchelleX:Float, dEchelleY:Float)
	
	e.echelleXIni = echelleXIni
	e.echelleYIni = echelleYIni
	e.ecartEchelleXIni = ecartEchelleXIni
	e.ecartEchelleYIni = ecartEchelleYIni
	e.dEchelleX = dEchelleX
	e.dEchelleY = dEchelleY
		
End Function


'-----------------------------------------------------------
' Reglage de l'alpha
'-----------------------------------------------------------
Function P2D_ReglerAlpha(e:TEmetteur, alphaIni:Float, ecartAlpha:Float, dAlpha:Float, ecartDAlpha:Float)
		
	e.alphaIni = alphaIni
	e.ecartAlpha = ecartAlpha
	e.dAlpha = dAlpha
	e.ecartDAlpha = ecartDAlpha
	
End Function


'-----------------------------------------------------------
' Reglage de la velocite
'-----------------------------------------------------------
Function P2D_ReglerVelocite(e:TEmetteur, dx:Float, dy:Float, accX:Float, accY:Float)
		
	e.dx = dx
	e.dy = dy
	e.accX = accX
	e.accY = accY
	
End Function


'-----------------------------------------------------------
' Reglage de la vie des particules
'-----------------------------------------------------------
Function P2D_ReglerVie(e:TEmetteur, viePart:Int, ecartViePart:Int)
		
		e.viePart = viePart
		e.ecartViePart = ecartViePart 
		
End Function



'----------------------------------------------------------------
' Suppression d'un emetteur
'----------------------------------------------------------------
Function P2D_SupprEmt(e:TEmetteur, flag:Int = 0)

	Local p:TParticule = New TParticule
		
	Select flag
		Case 0
			e.etat = "supprime"
		Case 1
			e.etat = "supprime"
			For p=EachIn e.listePart
				ListRemove(e.listePart, p)
			Next
			ListRemove(P2D_listeEmet, e)
	End Select

End Function
</textarea><br><br>see ya :)<br><br>ps: a wysiwyg editor coming as soon as the BlitzMax release is available :) <br><br></td></tr></table><br>
<a name="514125"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nice idea, ftbass<br>I have made a quick change to the Demo and your Tutorial.<br>Try this and add it if you think it looks better, too<br><b>Edited</b> I was not shure what would be the better solution: Globals or Typefields<br>If BotShips (random / not steered by user) are on screen maybe Typefields would be better.<br><br>Some Lines added in DemoPartEngine05.bmx<pre class=code>' Type TJoueur hérité du type TVaisseau
Type TJoueur Extends TVaisseau

	Method Update()
		RelativeFlag=1	'This Line for Demo usage - could be made a Functionparameter
		RelativeX=0		'To place the particles relative to the ship movement
		RelativeY=0
		If KeyDown(KEY_LEFT) And X &gt;= -10 Then
			X = X - 3 * Vitesse
			If RelativeFlag&lt;&gt;0 RelativeX = -3*Vitesse
		EndIf
		If KeyDown(KEY_RIGHT) And X &lt;= (LARGEUR - 112) Then
			X = X + 3 * Vitesse
			If RelativeFlag&lt;&gt;0 RelativeX = 3*Vitesse
		EndIf
		If KeyHit(KEY_UP) And Not(KeyDown(KEY_DOWN))
			DirV = "haut"
			NumImage = 11
			Timer = MilliSecs()
		End If
		If KeyDown(KEY_UP)
			If Y &gt;= -40 Then
				Y = Y - 3 * Vitesse
				If RelativeFlag&lt;&gt;0 RelativeY= -3 * Vitesse
			End If
			If (Timer + Tempo &lt; MilliSecs()) And (NumImage &lt; 21) Then
				NumImage = NumImage + 1
				Timer = MilliSecs()
			End If
		EndIf
		If KeyHit(KEY_DOWN) And Not(KeyDown(KEY_UP))
			DirV = "bas"
			NumImage = 0
			Timer = MilliSecs()
		End If
		If KeyDown(KEY_DOWN)
			If Y &lt;= 680 Then
				Y = Y + 3 * Vitesse
				If RelativeFlag&lt;&gt;0 RelativeY = 3*Vitesse
			End If
			If (Timer + Tempo &lt; MilliSecs()) And (NumImage &lt; 10) Then
				NumImage = NumImage + 1
				Timer = MilliSecs()
			End If
		EndIf
		If Not(KeyDown(KEY_DOWN) Or KeyDown(KEY_UP))
			Select DirV
				Case "haut"
					If (Timer + Tempo &lt; MilliSecs()) And (NumImage &gt; 11) Then
						NumImage = NumImage - 1
						Timer = MilliSecs()
					ElseIf NumImage = 11 Then
						DirV = "null"
					End If
				Case "bas"
					If (Timer + Tempo &lt; MilliSecs()) And (NumImage &gt; 0) Then
						NumImage = NumImage - 1
						Timer = MilliSecs()
					ElseIf NumImage = 0 Then
						DirV = "null"
					End If
			End Select
		End If
	End Method
	
End Type</pre><br>This at top of "former Module" now an IncludeFile "ftbass_ParticleEngine.bmx" (makes quicker changes possible)<pre class=code>Global RelativeFlag, RelativeX , RelativeY</pre><br>And change the 2 Lines in <pre class=code>Type TParticule</pre><br><pre class=code>	'-----------------------------------------------------------
	' Mise à jour des particules
	'-----------------------------------------------------------
	Method Update()
	
		dx = dx + accX
		dy = dy + accY
		x = x + dx + RelativeX		'Line changed
		y = y + dy + RelativeY		'Line changed
		echelleX :+ dEchelleX
		echelleY :+ dEchelleY</pre><br><br>In the Tutorial instead of too many Ifs<pre class=code>Function NumImage:Int(Char:String)
	If ( Char &gt;= "a" And Char &lt;= "z" ) Or ( Char &gt;= "A" And Char &lt;= "Z" ) Return (Asc(char) &amp; 95)-65
	If ( Char &gt;= "0" And Char &lt;= "9" ) Return Asc(Char)-16
	Local Posit=Instr("'.,-!?",Char)
	If Posit&gt;0 Return Posit+25
	If char=" " Return 42
End Function</pre><br>Hope you can use it :-) <br><br></td></tr></table><br>
<a name="514684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KamaShin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> @ftbass:<br>j ai compilé ton mod pour Mac et j ai le plaisir d annoncer ke ca marche impec :)<br>donc si t'as un mail a me filer, j peux t envoyer le mod compilé en version debug et release...<br>le 1er test tourne dans les 20 fps et le second dans les 30 (1 ou 2 emetteurs ca change rien), mais bon... j ai une vieille brouette comme machine :) <br><br></td></tr></table><br>
<a name="514921"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> @RaGR:<br>Thx for suggestions. I'll try that later :)<br><br>@KamaShin:<br>The code is now available, so I don't think I have to distribute the modules. Peoples who want to use this code <br>can make a module theirself, of simpler, use it as an include.<br><br>ps: Kamashin, this is the official forum, so I think we have to try to speak english (even if my english is really <br>bad)... If you want to speak french, you can vist the french community at www.blitz3dfr.com you'll be welcome :) <br><br></td></tr></table><br>
<a name="514990"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >KamaShin</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol... I guess you re right :) no need for distributing the mod if anyone can compile it... Anyway, it does work fine on Mac :) <br><br></td></tr></table><br>
<a name="514997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> version 0.6.1 of PartEngine now available<br><br>- Bug fixed in the LIGHTBLEND mode rendering<br>- Can now create less than 1 particle per frame <br><br></td></tr></table><br>
<a name="524643"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool :) <br><br></td></tr></table><br>
<a name="590476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drnmr</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=43248#514990" target="_blank">HI</a> <br><br></td></tr></table><br>
<a name="590489"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> because? <br><br></td></tr></table><br>
<a name="590499"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >drnmr</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> ftbass-is there a english mode to your site? <br><br></td></tr></table><br>
<a name="591277"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ftbass</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> no sorry, there is no english mod for the moment. It's a quite confidential site actually.<br>Do you want to have some informations about a precise subject ? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
