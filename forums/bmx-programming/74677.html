<!DOCTYPE html><html lang="en" ><head ><title >Diablo inventory</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Diablo inventory</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Diablo inventory</a><br><br>
<a name="834509"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anyone ever tried creating a Diablo style inventory?  I'm going to tackle this soon, just wanted to know if anyone has already made a start, or finish?<br><br>As in you click on an object and drag it to the inventory and  you can only drop it in if there is the space, i.e. every object uses a certain number of spaces.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="834515"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> What is your current skill level? Do you know how to drag and drop objects, or is it just this problem-specific you need help with? <br><br></td></tr></table><br>
<a name="834518"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah that part of it isn't going to bother me, I've been programming a while, it's the detecting the boxes with the weapon box area, that kind of stuff, I'll tackle it during the week, I just wanted to see if anyone had already made a start on it. <br><br></td></tr></table><br>
<a name="834540"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> should be a cake o' peace.. <br><br></td></tr></table><br>
<a name="834546"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Find out the starting and ending x and y coordinate of the box, and see if the mouse pointer is within that area. <br><br></td></tr></table><br>
<a name="834703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> cake o' peace LOL! probably will be.<br><br>It's more the object being dragged that needs to do the detecting, not the cursor. <br><br></td></tr></table><br>
<a name="834725"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> One of the most known design methods: seperate user interaction, visualization and implementation. What you need to have is just inventory *technically*, and some methods to compare another object and see how it fits. You should be comparing that by just using methods.. without gfx or mouse input. Later on, when it all works, you'll be sending mouse events to such methods, and you'll display your inventory. <br><br></td></tr></table><br>
<a name="834753"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah sounds like a good plan, just started working on it now. <br><br></td></tr></table><br>
<a name="834783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd use an array of a type.  The type would be called something like TInvSlot (Inventory Slot).  Make a field with the img, x, y, width, height, and type pointer TItem type.  If the TItem pointer is null then it can recieve an item.  If mouse is within the TInvSlot x,y,w,h and mousehit(1) then swap the item pointer from the TInveSlot type to the MousePointer containter type.  Or you can just attach an TInvSlot to the mouse pointer by updating the TInvSlot's x,y to MouseX() and MouseY() so the Item Image moves along with the mouse pointer.<br><br><pre class=code>
Type TInvSlot
   Field x:Int, y:Int, w:Int, h:Int
   Field item:TItem

   Method Draw()
      If self.item &lt;&gt; Null
         DrawImage item.image, self.x, self.y
      Endif
   End Method
End Type

Type TItem
   Field image:TImage

   Method Draw(x:Int, y:Int)
      DrawImage self.image, x, y
   End Method
End Type

Function MouseOver:Int(x%,y%,w%,h%)
   If MouseX() &gt; x And MouseX() &lt; x + w
      If MouseY() &gt; y And MouseY() &lt; y + h
         Return True
      Endif
   Endif
End Function
</pre>You would only draw the little item graphic image if it was in a slot.  Either the inventory or the mouse slot.  That way you don't need xy fields for the TItem.<br><br>Then in the loop see if the mouse is over a slot like this:<br><pre class=code>
If MouseOver(slot.x, slot.y, slot.w, slot.h) = True
</pre><br>Then if the mouse slot is unoccupied transfer the item from the inventory slot to the mouse slot:<br><pre class=code>
If MouseHit(1)
   If invSlot.item &lt;&gt; Null
      If mouseSlot.item = Null
         mouseSlot.item = invSlot.item
         invSlot.item = Null
      Endif
   Endif
Endif
</pre><br>I think the inventory is a major part of an rpg and should really be tightly coded and speedy.  If it takes me a couple of clicks to get an item to transfer or if the inventory is laggy, I'll just stop playing the game.  It's a major pet peeve of mine.<br><br>Hope this gives you some ideas! <br><br></td></tr></table><br>
<a name="834808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ckob</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> let me see if I can dig up some of my old rpg code. <br><br></td></tr></table><br>
<a name="834809"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah great, your mouseover function worked fairly well, I've been stuck on it!  Only problem is it's only picking the item up from the top left corner?  I'm drawing the slots as you would tiles, so the slots for the inventory are drawn like this:<br><pre class=code>
For Local x:Int = 0 Until m_slotColumns;
			For Local y:Int = 0 Until m_slotRows;
			
				If (m_selected) 
					If (x+m_slotX) &gt;=0 And (x+m_slotX) &lt;= (m_slotColumns) And (y+m_slotY) &gt;=0 And (y+m_slotY) &lt;= (m_slotRows) Then 
						DrawImage item_slot_image, (x*m_slotWidth)+MouseX(), (y*m_slotHeight)+MouseY();
					EndIf
				Else
					If (x+m_slotX) &gt;=0 And (x+m_slotX) &lt;= (m_slotColumns) And (y+m_slotY) &gt;=0 And (y+m_slotY) &lt;= (m_slotRows) Then 
						DrawImage item_slot_image, (x*m_slotWidth)+m_posX, (y*m_slotHeight)+m_posY;
					EndIf
				EndIf
				
			Next
		Next
</pre><br>and for the mouse over I'm doing it in a similar way, but it's only grabbing it in the very top left?<br><pre class=code>
For Local x:Int = 0 Until m_slotColumns;
			For Local y:Int = 0 Until m_slotRows;
				
					If MouseOver(m_posX, m_posY, m_slotWidth, m_slotHeight) = True Then
					m_selected = True;

				EndIf
			Next
		Next
</pre> <br><br></td></tr></table><br>
<a name="834823"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay done that, I forgot to * the m_slotWidth and Height by the Rows and Columns, I'm just having problem with the when you release the mouse button, need to lay it down now. <br><br></td></tr></table><br>
<a name="834825"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Diablo had an inventory system where items had size, like a bow might take up 6 slots: a matrix 2 across, and 3 down.<br><br>So, what he would need to do is know the dimensions of the item, then find the inventory location he is trying to put the item in, by finding what slot the top left corner of the item is in, then check the inventory for that matrix of slots and see if they are all empty.  Then, if they are, allow the item to be dropped and it will take up those slots. <br><br></td></tr></table><br>
<a name="834879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a working sample for ya Verfum.  Just use any 32x32 PNG image you have where it loads the .png<br><br><pre class=code>
'Diablo Style Inventory System
'by Chroma
'Dec 17, 2007

Graphics 800,600

Local mainInventory:TInventory = New TInventory
mainInventory.SetParam(4,2,32)	'Set the inventory to be 4 across and 2 high and 32x32 in size
mainInventory.SetPos(300,200)

Local mouseSlot:TSlot = New TSlot
mouseSlot.item = New TItem
mouseSlot.item.image = LoadImage("sword001.png")	'Load any 32x32 PNG image here

Local mx:Int, my:Int
Local LMH:Int

MoveMouse 400,300

While KeyDown(KEY_ESCAPE)=False And AppTerminate()=False
Cls

	'Get Mouse Info
	mx = MouseX()
	my = MouseY()
	LMH = MouseHit(1)

	'Hide the cursor if player is moving an item
	If mouseSlot.item &lt;&gt; Null
		HideMouse 
	Else
		ShowMouse
	EndIf
	
	If LMH = True
		Local slot:TSlot
		For slot = EachIn mainInventory.SlotList
			If MouseOver(mainInventory.x+slot.x, mainInventory.y+slot.y, slot.w, slot.h) = True
				'Transfering from Mouse Slot to Inventory Slot
				If mouseSlot.item &lt;&gt; Null
					If slot.item = Null
						slot.item = mouseSlot.item
						mouseSlot.item = Null
					EndIf
				Else
				'Transferring from Inventory Slot to Mouse Slot
					If slot.item &lt;&gt; Null
						mouseSlot.item = slot.item
						slot.item = Null
					EndIf
				EndIf
			EndIf
		Next
	EndIf

	mainInventory.Render()
	mouseSlot.Render(mx,my)

Flip
Wend
End


Type TInventory
	Field x:Int, y:Int, size:Int
	Field SlotList:TList = New TList
	
	Method SetPos(x%,y%)
		self.x = x
		self.y = y
	End Method
	
	Method SetParam(x%,y%,s%)
		Local a%, b%
		For b = 0 To y-1
			For a = 0 To x-1
				Local slot:TSlot = New TSlot
				slot.x = a*s
				slot.y = b*s
				slot.w = s
				slot.h = s
				slot.border = True	'so you can see the slot boundary temporary
				self.SlotList.AddLast(slot)
			Next	
		Next
	
	End Method
	
	Method Logic()
	
	End Method
	
	Method Render()
		Local slot:TSlot
		For slot = EachIn self.SlotList
			slot.Render(self.x, self.y)
		Next
	End Method
	
End Type

Type TSlot
	Field x:Int, y:Int, w:Int, h:Int
	Field item:TItem
	Field border:Int
	
	Method Render(xorigin%, yorigin%)
		If self.border = True
			Local xp% = xorigin + self.x
			Local yp% = yorigin + self.y
			DrawLine xp, yp, xp+self.w, yp
			DrawLine xp+self.w, yp, xp+self.w, yp+self.h
			DrawLine xp+self.w, yp+self.h, xp, yp+self.h
			DrawLine xp, yp+self.h, xp, yp		
		EndIf
		If self.item &lt;&gt; Null
			DrawImage self.item.image, xorigin + self.x, yorigin + self.y
		EndIf
	End Method
End Type

Type TItem
	Field image:TImage
End Type


Function MouseOver:Int(x%, y%, w%, h%)
	If MouseX() &gt; x And MouseX() &lt; x + w
		If MouseY() &gt; y And MouseY() &lt; y + h
			Return True
		EndIf
	EndIf
End Function
</pre> <br><br></td></tr></table><br>
<a name="835047"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >verfum</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, that's excellent, you beat me too it :(  I'll adapt that code into mine, thanks for your help! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
