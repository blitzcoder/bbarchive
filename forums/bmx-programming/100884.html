<!DOCTYPE html><html lang="en" ><head ><title >Optimizations\Speed Tests</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Optimizations\Speed Tests</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Optimizations\Speed Tests</a><br><br>
<a name="1194633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BLaBZ</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there a detailed post displaying the fastest ways to perform operations in BlitzMAX?<br><br>For example, list vs map vs array?<br><br>Or the quickest way to assign a boolean value?<br><br>Thanks! <br><br></td></tr></table><br>
<a name="1194635"></a>

<a name="1194636"></a>

<a name="1194637"></a>

<a name="1194638"></a>

<a name="1194639"></a>

<a name="1194640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> list vs map vs array <br></div><br><br>These have different performance <i>characteristics</i>. Lists are fastest for iterating over, arrays are fastest for choosing an element by random index, maps are fastest for choosing an element by noninteger key (among other things). They can all substitute for each other, but they aren't the same thing, and depending on how you want to use the collection, one might be better than another. So this is very context-specific.<br><br><br><div class="quote"> the quickest way to assign a boolean value <br></div><br><br>I probably misunderstand, but if there was a faster way than = surely = would use it..?<br><br><br>Anyway, microoptimisations are usually totally unimportant and won't speed up your program. The only real performance wins are in <i>algorithmic</i> optimisations, i.e. restructuring code that's cache-hostile or retreads the same problem space into something tightly organised. There aren't really any magic machine instructions that can take already well-structured code and make it dozens of times faster - BlitzMax already uses the ones it knows about (there are a small number of exceptions, but to get them you'd need to write in C or assembly anyway).<br><br>Some ideas for structural optimisations:<br><br>-- rewrite widely-branching code to a memoizing or accumulating form (e.g. the classic naive Fibonacci function with two recursions retreads the same problem search for the second subvalue: using an accumulating loop can take <i>trillions</i> of operations off the computation for large values)<br><br>-- design operations on memory to favour cache lines (e.g. the old For x ... For y... over an image should probably be reversed to For y ... For x, so that accessed pixels fall in the same locality and don't force a cache miss - BlitzMax might fix this automatically, haven't tried)<br><br>-- <a href="http://stackoverflow.com/questions/11227809/why-is-processing-a-sorted-array-faster-than-an-unsorted-array" target="_blank">loop over sorted rather than unsorted collections where possible</a> to be friendly to the branch predictor, or where possible replace If constructs with a pure arithmetic version that doesn't jump (just don't <a href="http://stackoverflow.com/questions/14023988/why-is-processing-a-sorted-array-slower-than-an-unsorted-array" target="_blank">take this too far or you can slow it down again</a>)<br><br><br>But local microoptimisations - e.g. rewriting code that takes five machine instructions and two indirections to use three instructions and one indirection ... will have pretty much no effect at all on modern systems. Especially in general app code. It's usually best to focus on writing <i>clear</i> code (that's more or less the specific thing BlitzMax was designed for), and if you really need fast number-crunching later on <i>having established the clear version is too slow</i>, farm the hard parts out to C or LuaJIT. <br><br></td></tr></table><br>
<a name="1194652"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> the quickest way to assign a boolean value  <br></div><br><br>Per BRL, the fastest datatype in Blitzmax is INT, so the fastest way to deal with a boolean is to simply stick it in an int and call it good... Rather than trying to address individual bits in a byte or some other 'optimization'. <br><br></td></tr></table><br>
<a name="1194824"></a>

<a name="1194825"></a>

<a name="1194828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >zzz</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pretty much what Yasha said.<br><br>Blitzmax's compiler is pretty "flat", it wont do much optimizing for you. On the other hand things usually carry through well to assembly. <br><br>The one microoptimisation that are worth mentioning is getting rid of division and power operators in time-critical blitzmax code since it wont try and get rid of them by itself. Inverse values and bitwise operators will be much faster if you can make use of them. The tradeback is obviously less readable code, and i completely agree with the suggestion of doing this code in some other language instead.<br><br>edit: just wanted to point out that yashas example of x/y loop order is correct, and a pretty good example of how slow non-linear memory access can be compared to linear access.<br><br>edit2:<br><br><div class="quote"> <br>loop over sorted rather than unsorted collections where possible to be friendly to the branch predictor, or where possible replace If constructs with a pure arithmetic version that doesn't jump (just don't take this too far or you can slow it down again)<br> <br></div><br><br>Just a note here, branching is only bad if its unpredictable. Im gonna go out on a limb and say that the default behaviour is considering a branch to miss since this is how the compiler assembly is usually laid out. Putting in some pseudocode for clarification. Execution could of course continue after the if statement even if the branch were taken, but the important thing is that because of how modern cpus work, they need to know ahead of time which code that will be executed next to run efficiently.<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
if condition then
    branch taken, execution continues here
endif
branch not taken, execution continues here
</textarea> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
