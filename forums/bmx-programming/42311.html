<!DOCTYPE html><html lang="en" ><head ><title >Socket Programing</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Socket Programing</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Socket Programing</a><br><br>
<a name="474108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RexRhino</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am wondering how to create a TCP server in Blitzmax?<br><br>I noticed the TSocketStream class, but not sure how it works. It uses TStream, so I assume once the connections are set up it works like a stream, but I am not sure how to set up connections.<br><br>There is a function CreateClient(server, port), which seems self explainitory enough... except how do we know if the connection fails? How do we know when the connection is broken? Does the function block until it recieves the data it needs?<br><br>Also, for creating a server, there is Create(socket), but how does this work? Normally, you would have a seperate server socket object, and you would then call a function that would return a socket object if there was a connection request.<br><br>The source code is there, but without proper documentation it seems pretty difficult to do anything with sockets. <br><br></td></tr></table><br>
<a name="474177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would just consider it WIP for now. I am sure there will be many more additions in the category of networking. <br><br></td></tr></table><br>
<a name="474353"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >AntonyWells</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree with rex's angst.. Would it have killed mark to comment these socket functions with their meaning at least? It's too confusing atm even trying to work out network stuff(On the surface at least, without docs..), which is a shame..(And that's an understatement. Considering my current game is primarly supposed to be network based..fat chance of that happening atm.) <br><br></td></tr></table><br>
<a name="474465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhague</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have created a TCP client in BM, but not a server.  You can use TSocketStream (there's an httpstream module which uses TSocketStream, and I used it as an example).  I found TSocketStream to be a bit ugly, so I pulled out the lower-level calls from it and just use those.  It's still only a couple of lines to set-up a socket.<br><br>I think you can use the lower-level calls to set-up a server, but I haven't tried it. <br><br></td></tr></table><br>
<a name="474488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tibit</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wish Bmax will support Networking similar to B3d or better. We have threads now so if anyone manages to do sever-client with low level commands it would be fun to test =)<br><br>Junkster would you like to post your TCP client code? And the server, did you happen to do it in B3D/Bplus? <br><br></td></tr></table><br>
<a name="474522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> one way around this would be for someone to write a Python Wrapper and then we can use Twisted Matrix.<br><a href="http://www.python.org" target="_blank">http://www.python.org</a><br><a href="http://twistedmatrix.com/" target="_blank">http://twistedmatrix.com/</a><br><br>Twisted currently supports the following protocols, all implemented in pure Python, most of them as both servers and clients: <br><br>Jabber<br>SIP<br>FTP<br>SSH, SFTP<br>IMAP<br>HTTP<br>NNTP<br>SOCKSv4 (server only)<br>SMTP<br>IRC<br>telnet<br>POP3<br>AOL's instant messaging TOC<br>OSCAR, used by AIM as well as ICQ (client only)<br>DNS<br>MouseMan<br>finger<br>Echo, discard, chargen and friends<br>Twisted Perspective Broker<br><br><br>Why reinvent the Wheel?<br><br>(that said,<br>there will still be a need for peer-to-peer networking code built in to BMAX) <br><br></td></tr></table><br>
<a name="474561"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dirk Krause</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> A python wrapper would be a _very_ nice thing. <br><br></td></tr></table><br>
<a name="474584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm looking forward to seeing some nice networking functionality built into BlitzMax. I definitely need to consider how to make my software designed to work well and take advantage of a network. So far all I've been able to do is read various articles here and there about general network/internet programming, TCP/UDP, lag, cheating in net-games and so on.... all okay on the theory but it'd be useful to have the code to put behind it now so that I can structure my app appropriately internally. <br><br></td></tr></table><br>
<a name="474644"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeroen</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Bradford6, GOOD idea. <br><br></td></tr></table><br>
<a name="474671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kanati</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> lack of networking is the only reason I don't use ibp very much...  I too was pretty disappointed to see that only the basest of networking calls were included with bmax at launch. <br><br></td></tr></table><br>
<a name="474789"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >jhague</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's a very thin layer over the low-level socket functions for writing TCP clients:<br><pre class=code>
Function Connect(server$, port)
	Local addr_type, addr_len
	Local addrs:Byte Ptr Ptr = gethostbyname_(server, addr_type, addr_len)
	If addrs = Byte Ptr Ptr(0) Return 
	If addr_type &lt;&gt; AF_INET_ Return -1
	
	Local sock = socket_(addr_type, SOCK_STREAM_, 0)
	If sock &lt; 0 Return sock
	
	If connect_(sock,addrs[0], addr_type, addr_len, port) &lt; 0
		closesocket_ sock
		Return -1
	EndIf

	Return sock
End Function

Function ReadSocket(socket, buf:Byte Ptr, count)
	Return recv_(socket, buf, count, 0) 
End Function

Function WriteSocket(socket, buf:Byte Ptr, count)
	Return send_(socket, buf, count, 0)
End Function

Function CloseSocket(socket)
	If socket closesocket_(socket)
End Function
</pre>You open a socket like this:<br><pre class=code>
Global Socket = Connect("localhost", Port)

If Socket &lt; 0 Then
	Print "Didn't work."
	CloseSocket(Socket)
	End
EndIf
</pre>Once the socket is open, you read from it with ReadSocket.  That function waits until either data is received or the socket is closed.<br><br>You can also use TSocketStream and do this in essentially one line, but I like seeing what's going on behind the scenes in this case.<br><br>Hope this helps! <br><br></td></tr></table><br>
<a name="474793"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jeremy Alessi</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>We have threads now so if anyone manages to do sever-client with low level commands it would be fun to test =) <br> <br></div><br><br>Huh?<br><br>Oh I see ... Ant added a thread module ;)  Good stuff! <br><br></td></tr></table><br>
<a name="491225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dirk Krause</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> TsocketStream example, runs fine with the Twisted simpleserver.<br><pre class=code>
Strict

Local stream:TStream=TSocketStream.CreateClient( "localhost",8000 )

stream.WriteLine "This is a test~n"

local buffer:String
While Not Eof( stream )
  buffer = stream.ReadLine()
  Print buffer
  If Not buffer Exit
Wend


CloseStream stream</pre> <br><br></td></tr></table><br>
<a name="491569"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vertex</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi!<br><a href="http://blitzbasic.com/Community/posts.php?topic=43533" target="_blank">http://blitzbasic.com/Community/posts.php?topic=43533</a><br>Has the same functionality as BlitzClassic with all udp and tcp commands.<br>cu olli <br><br></td></tr></table><br>
<a name="512713"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >QuietBloke</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have been looking into trying my hand at something like this. I just want to write a simple chat server. Ive seen loads of examples written in C but Im having trouble writing any sort of code in BMax to do it. <br>In some other thread about non-blocking accepts it was mentioned to use Select_ with zero timeout. But looking at that it expects 4 params 3 of which are pointers to sets of sockets. I cant for the life of me get my head round how I can create these socket sets to use it.<br>So... has anyone got an example(s) they wouldnt mind sharing or... is there another way... or... will BMax implement something simpler in the near future that I can wait for. <br><br></td></tr></table><br>
<a name="512732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Vertex<br>please if you post a link can you use www.blitzbasic.com instead of blitzbasic.com - don't know if its only here but I get an "Internal Error" Message<br>If I copy and paste and put www. in front then IE reacts fine <br><br></td></tr></table><br>
<a name="512760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=43533" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=43533</a> <br><br></td></tr></table><br>
<a name="512780"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >RGR</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Beaker ... although I really don't know why you did that ... as you could read, I followed that link with Copy and Paste in a new IE-Window anyway.<br><br>The reason why I asked Vertex to use www. is: he is the only one who doesn't use www. and ALL his Links I have seen on other pages I could not follow with one click ...<br>Maybe others don't get that error with their browsers?<br>But if - then it is not useful to place links you cannot follow.<br><br>So, Beaker, what was your intention? Are you adding links that work to all of his Posts now? Was it the typical "Help" as I often see in these forums? You had to react, right? And feel so satisfied now? <br><br></td></tr></table><br>
<a name="512845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >QuietBloke</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> My mistake.. I tried the link supplied but I just got an internal error and I assumed the post had been deleted or something.  I even put the www prefix in and it still returned an internal error but when I changed the blitzbasic to blitzmax I can now see the thread. &lt;shrug&gt;.<br>Anyway.. Now things are looking much clearer. Thanx Vertex. I havent had time to look over your NetWork library in detail yet and Im a complete Newbie when it comes to this stuff but it looks like what you have done will make my life a LOT easier.. I might even understand it now :) <br><br></td></tr></table><br>
<a name="512849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look in pub.Stdc in stcd.c you will see all the connect, listen, accept, bind ect <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
