<!DOCTYPE html><html lang="en" ><head ><title >Purebasic DLL with strings as parameters</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Purebasic DLL with strings as parameters</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Purebasic DLL with strings as parameters</a><br><br>
<a name="939022"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, guys.<br><br>I guess I'm a little stuck here. I have this DLL I've made, no big deal and it has these functions:<br><br><pre class=code>
ProcedureDLL comInit()
ProcedureDLL.l comCreate(name.s, progID.s)
</pre><br><br>I'm trying to make myself a little mod with it (I have .LIB file) so I'm doing it like this:<br><br><pre class=code>
Module byo.com

Import "mfxCom.lib"

Extern
	Function comInit() "win32"
	Function comCreate:Int(name:String, progId:String) "win32"
End Extern
</pre><br><br>No matter what I do, I can't make the ComCreate function return anything other than 0. It should return 1 for success and 0 for error. The DLL works in Purebasic and in Visual C++ like this:<br><br><pre class=code>
comCreate("byo", "Word.Application")
</pre><br><br>Somehow I think there's something wrong with the strings being passed as parameters? Could you guys see what I'm doing wrong. I'd appreciate very much as this is taking me more than one day to understand.<br><br>Thanks a lot. :) <br><br></td></tr></table><br>
<a name="939024"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are those really strings or char * (on the purebasic side)?<br><br>If they are really std::string or something similar you are going to have issues. Otherwise, you should be able to either convert your BlitzMax String to a CString or define the parameters as $z.<br><br>eg :<br><pre class=code>
	Function comCreate:Int(name$z, progId$z) "win32"
</pre><br>or if they are wide (unicode) strings... use $w instead. <br><br></td></tr></table><br>
<a name="939025"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the fast reply.<br>It turns out I had checked the "Create unicode executable" under the Purebasic's options. Adding the "$w" worked perfectly.<br><br>Is there a ":String" alternative to "$w" or "$z". I like strongly typing my variables wiith var:String.<br><br>*offers beer* <br><br></td></tr></table><br>
<a name="939032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is there a ":String" alternative to "$w" or "$z". I like strongly typing my variables wiith var:String. <br></div>I hear that!<br><br>Sadly, I do not think there are :( <br><br></td></tr></table><br>
<a name="939042"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >byo</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, good to know anyway. Thanks. :)<br>I'll get used to it, it's no big deal. <br><br></td></tr></table><br>
<a name="939205"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zethrax</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Something else to bear in mind when returning strings from a Purebasic dll, is that the returned strings should be global in scope. If you return them from a variable that is local to a function, the string may no longer exist at the point when it gets returned. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
