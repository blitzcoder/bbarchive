<!DOCTYPE html><html lang="en" ><head ><title >DXERROR err=SURFACELOST</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >DXERROR err=SURFACELOST</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >DXERROR err=SURFACELOST</a><br><br>
<a name="1070161"></a>

<a name="1070162"></a>

<a name="1070163"></a>

<a name="1070164"></a>

<a name="1070165"></a>

<a name="1070169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Firstly, sorry I if missed something in the past year or so about this issue, but I tried searching and couldn't find anything conclusive.<br><br>Basically, when I first made my framework I was sure that I made it so that full-screen games could alt+tab and withstand control+alt+del without crashing or coming back to a blank screen.  But now my games crash when I restore them after minimizing them.  Specifically they crash with DXERROR err=SURFACELOST in the BlitzMax console.<br><br>Note that my games use DX7 and the crash can be duplicated by running the following code and alt+tabbing out/in.  If you comment out the line that sets the driver, it works fine!<br><br><pre class=code>
SetGraphicsDriver D3D7Max2DDriver()
Graphics 800,600,32

Local counter:Int=0

While Not KeyHit(key_escape)
	Cls
	DrawText counter,0,0
	counter:+1
	Flip 1
Wend
</pre><br><br>The plot thickens, because I went back and tested some of my old compiles from around the time I was sure I had this working, and they don't crash when you restore them BUT I do see a black screen. They haven't frozen because I can hear mouse over sounds and keys work.  Since I wrote those old builds I have changed my video card so I don't know if that is having an effect for some reason.  I could swear this stuff used to work fine. Am I going mad?<br><br>Portals won't accept a game that fails alt+tab, so it may be I have to convert over to DX9, but what happened to DX7? (or perhaps it's my video card which is an NVidia Geforce GTX 275)<br><br>If you can test the code above and tell me if it works/crashes on your machine that would be great thanks!<br><br>Does anyone have any further information about this?  Many thanks in advance!<br><br>[edit]I'm running BMax 1.41 on DX 9.0c on XP SP3.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1070166"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BladeRunner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine here, without any crash.<br>GF 9700GTM, BMax 1.37 (oops, I should run a update.) <br><br></td></tr></table><br>
<a name="1070170"></a>

<a name="1070171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting.  Well if it still works after the update then it's my video card.  Perhaps it's just not built for DX7 support.  I wonder how many other cards have the issue and if we should be looking to support them with a tweak to the BMax DX7 code?<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1070183"></a>

<a name="1070186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine on my machine (specs in my sig)...<br><br>Also Pirate Solitaire uses GAF v1.11 (which uses DX7 driver) and BlitzMax v1.41 - and Im sure BFG would have picked up something in their testing...<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1070188"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks.  It must be my video card then.  So I guess the question is, what % of modern cards does it crash on?<br><br>Can anyone else test? <br><br></td></tr></table><br>
<a name="1070192"></a>

<a name="1070193"></a>

<a name="1070194"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Matthew Smith</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Jake,<br><br>Works fine on both my laptop and desktop - see sigs for info.<br><br>Oh - latest version of BlitzMax.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1070202"></a>

<a name="1070203"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Works fine on my laptop - Intel GMA965, 2GB RAM, Windows 7, DX11.<br><br>BTW: I have an 8500GT I can test on but I'm going out for a while now - will give it a go when I get back.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1070208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless you have a big limitation, offer users a choice of driver and in your readme/troubleshoot explain it is a fix. <br><br></td></tr></table><br>
<a name="1070215"></a>

<a name="1070229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> offer users a choice of driver and in your readme/troubleshoot explain it is a fix. <br></div>In casual games, advanced options like that are a big no-no.<br><br>just checked on my 8500GT (Windows 7, DX11, 2GB RAM) - works fine.<br><br>[edit] Oh yeah - I'm using Blitzmax 1.41.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1070225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HrdNutz</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Reloading the graphics from file or pixmaps should refresh the device textures, not sure how to reload the built-in image font.<br><br>Alternatively, calling Graphics() and recreating the window should force an internal texture refresh.  As far as I know, bmax keeps parallel pixmaps to all the TImage data.<br><br>I haven't personally tried this, just speculating. <br><br></td></tr></table><br>
<a name="1070226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> No error here either on ATI X1300. But I didn't update blitzmax in ages :P~ <br><br></td></tr></table><br>
<a name="1070274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> In casual games, advanced options like that are a big no-no. <br></div><br>That's why you hide it, or dress it up as some kind of "safe mode" option or something. You don't need to include a book on it! <br><br></td></tr></table><br>
<a name="1070281"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for testing everyone.  Hmm, well at least it's rare (only my PC), that's reassuring.  Not sure how easy a fix is to be honest.  May try recreating graphics. <br><br></td></tr></table><br>
<a name="1161139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I finally fixed this by testing if the driver is DX7 and the game is fullscreen and it is being returned to from an alt+tab (I'm testing for the game being unsuspended).  All I do is call Graphics() again as per HrdNutz's suggestion and it works fine!  <br><br>Probably wasn't worth adding this fix as most people will be using the DX9 driver (which is fine) but my framework falls back to DX7 if DX9 is not available and I didn't want it to crash on some graphics cards.  It's possible some casual players may have similar setups as some of my games have over 1 Million demo downloads. <br><br></td></tr></table><br>
<a name="1161152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Tbh being in the casual game market means you have to support every conceivable version of dx from 7 and up. This being the case maybe posting the fix somewhere so others dont fall into the trap might help other blitzers.<br><br>Its a very good point tho and one that we will have to keep a very close eye on as to when driver manufacturers stop supporting legacy direct x versions seeing as its four revisions over 7 now? <br><br></td></tr></table><br>
<a name="1161158"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> The fix is entwined quite deeply into my framework so isn't easy to extract and post.  But basically you check for EVENT_APPRESUME and then you call Graphics again instead of doing nothing.  You only do this when the BMax DX7 Driver is being used and the game is full-screen. <br><br></td></tr></table><br>
<a name="1161192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matibee</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> (with some help) I came up with this a couple of years ago...<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=88279#1002201" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=88279#1002201</a><br><br>and added it to my framework as a separate module because of its depedency on MaxGUI (which at the time wasn't free).<br><br>As you'll see, it is calling endgraphics() graphics() when the user moves away from full screen.  I can't recall if I got it to handle Alt+tabbing in and out in the same way tho. <br><br></td></tr></table><br>
<a name="1161229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Jake, mind if you share your GAF change?<br><br>I guess its in Commontypes:<br><br><pre class=code>	Method DoPeekEvent()
		While PeekEvent()
...
			Case EVENT_APPRESUME
			  	SuspendedEvent = 0
			End Select
		Wend 	
</pre><br><br>So what do we do in EVENT_APPRESUME? <br><br></td></tr></table><br>
<a name="1161295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sure thing.  It's in CheckWindow() after then main else:<br><br><pre class=code>
			If Suspended = True
				'To avoid a hang on some graphics cards with DX7, we should recreate the graphics.
				If DriverDX7 And FullScreen Then
					GraphicsCreate()
				EndIf
</pre> <br><br></td></tr></table><br>
<a name="1161296"></a>

<a name="1161298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> btw I also updated SetDXDriver to avoid it using DX9 before testing for it.  You may not be using a ForceDX7 flag.  I only really added that for testing and perhaps to set on older games if I don't want to update them to DX9 and add in custom cursor toggle etc.<br><br><pre class=code>
	Method SetDXDriver(ForceDX7:Int)
		?Win32
		If ForceDX7 Then
			DriverDX7 = 1
			DriverDX9 = 0
			SetGraphicsDriver D3D7Max2DDriver()
		Else
			'Double check DX9 is available.
			If D3D9Max2DDriver()			
				DriverDX7 = 0
				DriverDX9 = 1
				SetGraphicsDriver D3D9Max2DDriver()
			Else
				DriverDX7 = 1
				DriverDX9 = 0
  				SetGraphicsDriver(D3D7Max2DDriver())
				'This may mean that DoSetVirtualResolution() fails due to DX7, but the small netbooks it is required on are all DX9 anyway.
			EndIf
		EndIf
		?
	End Method
</pre><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1161300"></a>

<a name="1161620"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also added in more direct versions based on a wikipedia article to ccGetDirectXVersion in PublicDomain.bmx.  I basically realised there were some versions missing from the list and was worried it could mean the game would choose the wrong driver or something.<br><br><pre class=code>
Function ccCheckDirectXVersionUpTo9$()
	Local strVersion:String = ""

	?win32
	Local hbank:TBank = CreateBank(4)
	RegOpenKey(HKEY_LOCAL_MACHINE,"SOFTWARE\Microsoft\DirectX",BankBuf(hbank))
	Local hKey% = PeekInt(hbank,0)
	
	Local value_bank:TBank = CreateBank(100)
	Local value_bank_size:TBank = CreateBank(4)
	Local type_bank:TBank = CreateBank(4)
	
	PokeInt(type_bank,0,0)
	PokeInt(value_bank_size,0,100)
	   
	RegQueryValueEx(hKey,"Version",0,BankBuf(type_bank),BankBuf(value_bank),BankBuf(value_bank_size))
	
	Local dx_version:String = ""
	For Local char%=0 To PeekInt(value_bank_size,0)-1
		If PeekByte(value_bank,char)=0 Then Exit
		dx_version = dx_version + Chr(PeekByte(value_bank,char))
	Next
	
	RegCloseKey(hKey)
	
	Select dx_version
	    Case "4.02.0095"
	        strVersion = "1.0"
	    Case "4.03.00.1096"
	        strVersion = "2.0a"
	    Case "4.04.00.0068"
	        strVersion = "3.0"
	    Case "4.04.00.0069"
	        strVersion = "3.0"
	    Case "4.04.00.0070"
	        strVersion = "3.0a"
	    Case "4.05.00.0155"
	        strVersion = "5.0"
	    Case "4.05.01.1600"
	        strVersion = "5.0"
	    Case "4.05.01.1998"
	        strVersion = "5.2"
	    Case "4.06.02.0436"
	        strVersion = "6.1"
	    Case "4.06.03.0518"
	        strVersion = "6.1a"
	    Case "4.07.00.0700"
	        strVersion = "7.0"
	    Case "4.07.00.0716"
	        strVersion = "7.0a"
	    Case "4.07.01.3000"
	        strVersion = "7.1"
	    Case "4.08.00.0400"
	        strVersion = "8.0"
	    Case "4.08.01.0810"
	        strVersion = "8.1"
	    Case "4.08.01.0881"
	        strVersion = "8.1"
	    Case "4.08.01.0901"
	        strVersion = "8.1a"
	    Case "4.08.02.0134"
	        strVersion = "8.2"
	    Case "4.09.0000.0900"
	        strVersion = "9.0"
	    Case "4.09.00.0900"
	        strVersion = "9.0"
	    Case "4.09.0000.0901"
	        strVersion = "9.0a"
	    Case "4.09.00.0901"
	        strVersion = "9.0a"
	    Case "4.09.0000.0902"
	        strVersion = "9.0b"
	    Case "4.09.00.0902"
	        strVersion = "9.0b"
	    Case "4.09.00.0903"
	        strVersion = "9.0c"
	    Case "4.09.0000.0903"
	        strVersion = "9.0c"
	    Case "4.09.00.0904"
	        strVersion = "9.0c"
	    Case "4.09.0000.0904"
	        strVersion = "9.0c"
	End Select
	?
	
	Return strVersion
End Function
</pre><br><br>I also updated ccDirectXVersionIsValid() in CommonCode to take into account the updated GetDirectXVersion as follows (it only checks first digit now):<br><br><pre class=code>
' -----------------------------------------------------------------------------
' ccDirectXVersionIsValid: Returns 1 if DirectX Version is &gt;=7 (which is required for BlitzMax)
' -----------------------------------------------------------------------------
Function ccDirectXVersionIsValid%()
	Local v$ = ccGetDirectXVersion()
	v$ = ccFirstStringToSub(v$,".")
	Local valid%=1
	'There is no 4.0!
	If v$ = "1" Or v$="2" Or v$="3" Or v$="5" Or v$="6" Then 'There was no version 4.
		valid=0
	EndIf
	Return valid
End Function
</pre><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1161301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> Plus I updated ccGetVersionString in publicdomain.bmx to take windows 8 into account (untested)<br><br><pre class=code>
Function ccGetVersionString:String()
	Const VER_PLATFORM_WIN32s% = 0
	Const VER_PLATFORM_WIN32_WINDOWS% = 1
	Const VER_PLATFORM_WIN32_NT% = 2

	Local versionName:String

	?win32
	Local VersionInfo:TOSVersionInfoEx=New TOSVersionInfoEx
	VersionInfo.dwOSVersionInfoSize=SizeOf(VersionInfo)
	
	GetVersionExA(VersionInfo)
	Select versionInfo.dwPlatformID
		Case VER_PLATFORM_WIN32s; VersionName = "Win32s"
		Case VER_PLATFORM_WIN32_NT; VersionName = "Windows NT"
	         
		Select versionInfo.dwVerMajor
			Case 4; VersionName = "Windows NT"
			Case 5;
				Select versionInfo.dwVerMinor
					Case 0; VersionName = "Windows 2000"
					Case 1; VersionName = "Windows XP"
					Case 2; VersionName = "Windows XP" '64-bit, but returns just "Windows XP" to be compatible with TGame.Init()
				End Select
			Case 6;
				Select versionInfo.dwVerMinor
					Case 0; VersionName = "Windows Vista"
					Case 1; VersionName = "Windows 7"
					Case 2; VersionName = "Windows 8"
				End Select 
		End Select
	                  
		Case VER_PLATFORM_WIN32_WINDOWS
			Select versionInfo.dwVerMinor
				Case 0; VersionName = "Windows 95"
				Case 90; VersionName = "Windows ME"
				Case 10; VersionName = "Windows 98"
			End Select
	End Select
	?
	Return VersionName
End Function
</pre> <br><br></td></tr></table><br>
<a name="1161381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks a lot Jake :)<br><br>I'll be adding that lot to my version for sure! <br><br></td></tr></table><br>
<a name="1161621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @therevills: just realised that ccDirectXVersionIsValid has a bug, change the v$ = mid(V$,1,1) to	v$ = ccFirstStringToSub(v$,".")<br><br>So that it works for DX10+<br><br>Edited above post with fix. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
