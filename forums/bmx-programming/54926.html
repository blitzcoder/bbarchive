<!DOCTYPE html><html lang="en" ><head ><title >Subtracting unsigned 64bit numbers</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Subtracting unsigned 64bit numbers</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Subtracting unsigned 64bit numbers</a><br><br>
<a name="611805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have code working that adds two unsigned 64-bit numbers together, by splitting them into two separate 32-bit numbers (stored in two Longs each), adding those split parts, adding any overflow from the lower part to the upper part, and then combinging them (or).<br><br>I am trying to do the same thing with subtracting the two numbers but it's proving a bit difficult.<br><br>Both numbers are 64-bit unsigned and must remain so. One number is subtracted from the other, and then there are actions to take based on the result. If the result would be &lt;0, 2^64 should be added to the value to `wrap it`, or in another case, if the number is &lt;0 it becomes zero (easy enough). I achieve this I don't want a whole bunch of If statements, it should be done using shifts, and's, or's, etc.<br><br>I just cant quite figure out the combination to split the data up, do the subtraction and preserve the sign, then combine it all back together properly. The end result has to be written out to memory.<br><br>So I just thought I'd throw it out there, maybe someone can suggest a technique? I also have to do the same thing to accomodate 63-bit numbers.<br><br>Thanks <br><br></td></tr></table><br>
<a name="611824"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any particular reason you can't just subtract them from each other using the minus operator? <br><br></td></tr></table><br>
<a name="611997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>b = 100
c = 5

Print b - c 
Print b + (~c + 1)</pre> <br><br></td></tr></table><br>
<a name="612099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> What does ~ do?<br><br>The reason you can't subtract them is because if the number being subtracted is bigger than the number being subtracted from, it would make a negative number, the data would suddenly be stored with the 64th bit set and in the format for negative numbers. This would corrupt the data. I can't have it changing the 64th bit. I need to subtract two UNSIGNED 64-bit numbers, which use ALL 64 bits, not 63.<br><br>ie I have a number stored, let's say it could be 2^64-1 ... technically if that number is stored in a Long, it will not read as the unsigned value 2^64-1, it will read as minus something because the uppermost bit is set. That messes up the math.<br><br>I have numbers ranging from 0 to 2^64-1, unsigned. They are stored in 64 bits of data. They happen to be read in from memory into a Long. Obviously interpreting the Long with regular math will read it wrong. I need to treat the whole thing as an unsigned value, subtract it from another similar number, take some steps based on whether the number is &lt;0, and then write out the unsigned result - which could be 2^64-1, using a Long.<br><br>So how do I do that? <br><br></td></tr></table><br>
<a name="612107"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Stuart Morgan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What does ~ do? <br></div><br>Bitwise exclusive or <br><br></td></tr></table><br>
<a name="612111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'll give it a try. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
