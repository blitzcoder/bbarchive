<!DOCTYPE html><html lang="en" ><head ><title >Shortest difference between two quaternions</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Shortest difference between two quaternions</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Shortest difference between two quaternions</a><br><br>
<a name="932064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> The difference between two quaternions can be found like this:<br><br>diff=(q0.inverse()).times(q1)<br><br>There are two possible solutions, because you can rotate one way or another to make q1 match q0.  Is there a way to find the shortest difference between two quaternions? <br><br></td></tr></table><br>
<a name="932079"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The w component is Cosine of half the angle. This will be negative if and only if the angle is greater than 180. In that case you want to replace the angle with angle-360. That has the effect of negating Cos(angle/2), i.e. w becomes -w.<br><br>You want the positive w. So compute the difference quaternion any way you like, then replace w with Abs(w). <br><br></td></tr></table><br>
<a name="932139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well that was superficial. It just dawned on me that the axis must also be flipped.<br><br>For example, if w = -0.5 then the angle is 2*ACos(-0.5) = 240 degrees. In that case we want 120, but going "the other way around".<br><br>Changing w to +0.5 makes the angle 120 as desired, but we must also make the axis point the other way, thus reversing the direction of the turn.<br><br>So the technique is to compute qDiff. If w&lt;0 then replace qDiff with -qDiff. This negates all of w,x,y,z.<br><br>That's what I get for doing this "on paper" and not actually running any code. <br><br></td></tr></table><br>
<a name="932225"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> From what I gather, you are saying find the difference using the method I first said, and then do this:<br><br>if q.w&lt;0.0<br>q.x:*-1.0<br>q.y:*-1.0<br>q.z:*-1.0<br>endif<br><br>Because this:<br><br>q.x<br>q.y<br>q,z<br>q.w<br><br>is the same angle as this:<br><br>-q.x<br>-q.y<br>-q.z<br>-q.w <br><br></td></tr></table><br>
<a name="932229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> It appears to work as I posted above.  Thanks!:<br><a href="http://www.leadwerks.com/post/omega4.wmv" target="_blank">http://www.leadwerks.com/post/omega4.wmv</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
