<!DOCTYPE html><html lang="en" ><head ><title >FMC - Comments and Discussion</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >FMC - Comments and Discussion</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >FMC - Comments and Discussion</a><br><br>
<a name="774973"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>a while ago I started to develop modules for a new module scope, the FMC. This scope contains some helper modules making the development of BlitzMax applications easier. Since I think these modules could be useful for you, I'm now publishing them.<br><br>However, these modules are still in development (all versions are below 1.00) and need some improvements and surely also bugfixes. Therefore I'd like you, if you want to, to test my modules and post comments about them telling what you'd like to improve. Improvements and bugfixes can be discussed here.<br><br><b>Some features:</b><br>Every module contains documentation describing the features in that module.<br>Here's a small list of the most important ones:<br><br>* Abstract classes helping you to structure an application<br>* Simple multi-threading support<br>* Stream classes for asynchronous access<br>* A BASIC-like ImageBuffer/ImageGraphics function to draw to images<br>* Allows launching external executables and easy communication with them<br>* Fixes some bugs in the official BlitzMax modules<br>* Additional gadgets: Splitter, SliderPanel, DragAndDrop<br>* Non-blocking requesters (allows to create multiple requesters at the same time)<br>* Sending an icon to the Windows System Tray<br>* Cutting parts out of a MaxGUI gadget<br>* Working on multiple desktops<br><br><b>How to get these modules:</b><br>The modules can be downloaded using the BlitzMax syncmods tool, which is present in every BlitzMax installation. To make the syncmods tool synchronizing with the server where the modules are located you need to add the following line to the "cfg/modservers.cfg" file in your BlitzMax installation directory:<pre class=code>webspace100.we.funpic.de/root/mod</pre>Each server in the modservers.cfg-file needs to be on a separate line.<br>If you've got an IDE accepting additional module scopes, you can now just add the "fmc" scope to the IDE's list and synchonize modules. The modules should download automatically and are on Windows directly usable. On other platforms you need to "Build modules" before using them. The documentation is included in the modules and should be visible in the navigation tree view on the right under Help/Modules. If you don't have such an IDE (for example the IDE coming with 1.24 doesn't accept additional modules) you can download a Windows version here, see below for the download.<br>If you don't have such an IDE and don't want to download one, you can call the syncmods tool from the command line typing:<pre class=code>syncmods fmc</pre>You might have to prepend the path to the "bin" directory in your BlitzMax installation directory depending on whether you've added this path to the "PATH" variable or not.<br><br><b>IDE Download:</b><br>You also can download an alternative IDE for synchronizing the modules: <a href="http://webspace100.we.funpic.de/root/programs/MaxIDE.exe" target="_blank">MaxIDE.exe</a> (if you're interested in seeing the source code: it can be found <a href="http://webspace100.we.funpic.de/root/programs/MaxIDE.bmx" target="_blank">here</a>) - Just replace the new MaxIDE.exe with the old one in your BlitzMax installation directory; then you need to download <a href="http://webspace100.we.funpic.de/root/programs/xsyncmods.exe" target="_blank">xsyncmods.exe</a> (source is <a href="http://webspace100.we.funpic.de/root/programs/xsyncmods.bmx" target="_blank">here</a>) and place it into the "bin" directory of your BlitzMax installation.<br><br>In order to recompile the modules you currently have to install <a href="http://webspace100.we.funpic.de/root/programs/Bacoreap.exe" target="_blank">Bacoreap</a> over your BlitzMax installation. If you just want to use them, you don't need to install anything.<br><br>Most of the modules are mainly developed for Windows; however, some can also be used platform independent. Sadly I couldn't test these modules which should be platform independent on other platforms than Windows, since I don't have access to a Linux or MacOS system.<br>I'm hoping this will work and you'll have fun in general using these modules.<br>If you've got any question, just ask. <br><br></td></tr></table><br>
<a name="774986"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wait a second.. how are you hosting your own modserver?  Also, can people trust you not to be logging passwords and the like? <br><br></td></tr></table><br>
<a name="774988"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> The modserver is using PHP scripts to imitate the behaviour of the official BlitzMax server. I can post you the PHP source code if you want, it's really simple.<br><br>You can be sure that this server doesn't log passwords, and doesn't log user names. However, if you don't trust, you can do the command line thing instead of synchronizing with the IDE; on command line, you don't need to specify a password or user name, since my server is for open access (you don't need to register or such) <br><br></td></tr></table><br>
<a name="774989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd appreciate being able to host my own, so if you don't mind sending me the code that'd be great.<br><br>Anyhow, will go ahead and try synchronizing anyway.  I figure if people notice me suddenly acting odd that'll be a good sign to change their passwords. ;) <br><br></td></tr></table><br>
<a name="774996"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, instead of sending you the information via email, I decided to post it <a href="/codearcs.php?code=2009" target="_blank">here</a>, just to avoid someone else asking the same thing again ;-) <br><br></td></tr></table><br>
<a name="775239"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>to make it easier to update modules while considering to specify the correct password for different servers, I wrote a new SyncMods requester for the MaxIDE.<br>This allows you to specify different usernames and passwords for different servers:<br><img src="http://webspace100.we.funpic.de/root/forums/XSyncMods.jpg"><br>Every module server takes one line in the SyncMods requester. In the example above you would specify your password and username only for the official BMX server - the german modserver (btbn.de/ModServer) and the FMC-modserver won't receive a password.<br>Using this extended syncmods requester you can also specify different proxy servers and module scopes, if you need, for each modserver individually.<br><br>I updated my first post in this thread, see the "IDE Download" section to download this IDE. <br><br></td></tr></table><br>
<a name="775388"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Very Nice! <br><br></td></tr></table><br>
<a name="781226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks!<br><br>Just to give you an overview about what I'm currently doing:<br>I'm now playing around with network stuff, and created fmc.SocketEx - however currently it doesn't work at all, it actually should be a mix of a normal TSocket and a TWin32Stream, this should have the advance that you can use them in bridges and pass them to called processes.<br>I need this because I'm currently working on an application which remotely executes other processes and connects their outputs directly in a socket... <br><br></td></tr></table><br>
<a name="781229"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> So this is a Windows-only framework ? <br><br></td></tr></table><br>
<a name="781230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, that means as far as I know about 2/3 is Windows-only, 1/3 is cross-platform or at least is available for the other platforms, too. <br><br></td></tr></table><br>
<a name="781234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is the multithreading part working on multicore machines or killing BM as any other module so far did? (ie do your modules replace the GC or not. If not, BM can't be run in true MT, just single processor *HT does not mather, it adds no real second thread, just a virtual one*) <br><br></td></tr></table><br>
<a name="781240"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tested and compiled the modules on a dualcore pc. So I guess it works with multicore in general. However, you should notice that it isn't possible to use the debugger or GC (although they are present) from any thread except the main thread. I could write a redirection for the debugger which makes it simply ignoring debugging commands from any thread different to the main thread. However, I couldn't do this for the GC; that means that you can call the GC directly or indirectly from all threads, however, this might cause the application to crash. So when writing the code which will be executed in the secondary threads, you need to be really careful, since the GC is used very often (eg concating two string objects is a GC operation since the resulting string is stored in a newly created object, and creating objects means registering their memory to the GC -&gt; would cause a crash).<br><br>All in all you can see that it wouldn't make sense to write the main part of code of a project in a secondary thread - instead it's better to write most in the main thread and use the other threads as helper threads. For example the Bridge class implements a secondary thread which just does a simple task, nothing more than moving stream contents around.<br><br>As for why I couldn't rewrite debugger and/or GC for multi-threading:<br>The debugger does some string output to the ide, and since working with strings often includes concating them, it would need a working GC.<br>So about the GC: The problem about the current GC is that not all references are counted in the object's reference counter - Local variables aren't counted. This is a problem for multithreading since you can't now about the stack and registers of another thread. That means no thread could have a complete overview about the object references, so no thread could be securely handling garbage collecting.<br>Though a big part of the GC is in the modules, there's still something hard-coded into the compiler. Therefore I can't change the GC, though I could write a module replacing the current GC - it wouldn't be compatible with this bcc internal structures which I can't touch. <br><br></td></tr></table><br>
<a name="792749"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >errno!</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> is this a bug?<br><br>Import fmc.ProcessStream<br><br><br><pre class=code>
Local ps:TStream

ps = CreateProcessStream("t","ffmpeg.exe")

While True
	Local lin:String =  ReadLine(ps)
	If lin&lt;&gt;""
		Print lin
	EndIf
	Delay 5
Wend
</pre><br><br>The result is as if i never passed a commandline. (I've double checked by running it in the actual windows commandline)<br><br>Any idea of a work around i can use to pass a parameter to the process? <br><br></td></tr></table><br>
<a name="794987"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry, I don't know about ffmpeg very well, but I think I can guess where the problem comes from:<br>Many windows applications especially those written using the c-libs are cutting off the first white space separated token from the command line - this is because they *think* the first white space separated token would always be the program's executable path. However if you call the CreateProcessStream function this is no longer the case: the actual command line is "t" and not "&lt;program_path&gt;&lt;space&gt;t" like the application might expect it. So it cuts away the first token and gets an empty string, since there is only one token.<br><br>To solve this I suggest you to write this:<pre class=code>ps = CreateProcessStream("ffmpeg.exe t","ffmpeg.exe")</pre>or, more easier:<pre class=code>ps = CreateProcessStream("ffmpeg.exe t")</pre>The second way is possible because if the second parameter is omitted, windows automatically takes the first white space separated token as the executable file name. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
