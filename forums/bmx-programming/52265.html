<!DOCTYPE html><html lang="en" ><head ><title >CreateProcess:TStream(Path$)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >CreateProcess:TStream(Path$)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >CreateProcess:TStream(Path$)</a><br><br>
<a name="583602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> In BP there is the function CreateProcess(Path$).<br>Is in BMX anything like that, too?<br>If not, I'll try to write a module containing it myself. <br><br></td></tr></table><br>
<a name="583631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did write some functions to do it, but there was an unexplainable memory exception so I gave up after 110 hours of trying to find why... Good luck :D <br><br></td></tr></table><br>
<a name="583677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No. <br><br></td></tr></table><br>
<a name="583747"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Rimmsy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a function to execute a file. Here you go, <a href="http://www.blitzwiki.org/index.php/System_Commands" target="_blank">http://www.blitzwiki.org/index.php/System_Commands</a><br><br>Hope that helps. It's not the same thing but it might help. <br><br></td></tr></table><br>
<a name="583782"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes it is, system_ is CreateProcess. <br><br></td></tr></table><br>
<a name="583838"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> No it isn't. System_ waits for the file executed to finish before proceeding with your program. Now if the file you want executed is a server program (like for instance Apache) that "never" finished, your program is going to hang indefinitely.<br><br>More importantly tho', if your program is ended (for instance by someone killing it in Taskmanager, or an overzealous windows task scheduler that reckons your program "stopped responding") it's going to take the program you've executed with it.<br><br>It is not, by the most broad definition, the same as CreateProcess, which actually launched the program in question in a seperate process. Except on Linux, but that's thanks largely to the OS. <br><br></td></tr></table><br>
<a name="583887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sarge</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here you go, a simple fix i just made.<br> <a href="/posts.php?topic=52292" target="_blank">Link</a> <br><br></td></tr></table><br>
<a name="587887"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>
'First of all, thanks a lot to all of you!
'It really helps!

'Sorry for late answering but I found some functions which may help:
Extern "Win32"
'Sorry only usable on win32
  Function WinExec ( Cmd:Byte Ptr , Show )
  Function ShellExecuteA ( Wnd , Cmd:Byte Ptr , File:Byte Ptr , Params:Byte Ptr , Dir:Byte Ptr , Show )
  Function CreateProcessA ( App:Byte Ptr , Cmd:Byte Ptr , PrAt , ThAt , InHandels , Flags , Env:Byte Ptr , Dir:Byte Ptr , S , P )
EndExtern
'The last of them is very intressting but not easy not understand ( as I think ).
'ShellExecuteA(...) seems to be equal to ExecFile(Path$) in BB.
</pre> <br><br></td></tr></table><br>
<a name="588394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Fabian.</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I started working on function doing this.<br>It's not finished, but it'll later so.<br><br>CreateProcess.c:<br><pre class=code>
#include &lt;windows.h&gt;

int WinGetStartupInfo ( void * Info )
{
  GetStartupInfo ( Info ) ;
  return 0 ;
}

</pre><br>CreateProcess.bmx:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict

Import "CreateProcess.c"

Local Stream:TStream = CreateProcess ( "calc.exe" )

Delay 10000
While Not Eof ( Stream )
  Print ReadLine ( Stream )
Wend

Function CreateProcess:TStream ( Cmd$ )
?Win32
  Local Stream:TProcessStream = New TProcessStream

  Stream.ProcInfo = New TProcInfo
  Stream.StartInfo = New TStartInfo
'  Stream.StartInfo.Size = SizeOf Stream.StartInfo
DebugStop
  Print WinGetStartupInfo ( Stream.StartInfo )
  Print WinCreatePipe ( Varptr Stream.In , Varptr Stream.StartInfo.StdOutput , Null , 0 )
  Print WinCreatePipe ( Varptr Stream.StartInfo.StdInput , Varptr Stream.Out , Null , 0 )
  Stream.StartInfo.StdError = Stream.StartInfo.StdOutput
  Print WinCreateProcess ( "".ToCString ( ) , Cmd.ToCString ( ) , Null , Null , False , 0 , Null , Null , Stream.StartInfo , Stream.ProcInfo )
  Return Stream

  Type TProcInfo
    Field Process
    Field Thread
    Field ProcessId
    Field ThreadId
  EndType

  Type TStartInfo
    Field Size
    Field Reserved1
    Field Desktop
    Field Title
    Field X
    Field Y
    Field XSize
    Field YSize
    Field XCountChars
    Field YCountChars
    Field FillAttribute
    Field Flags
    Field ShowWindow:Short
    Field Reserved2:Short
    Field Reserved3:Byte
    Field StdInput
    Field StdOutput
    Field StdError
Field Test:Long
  EndType

  Type TProcessStream Extends TStream
    Field In
    Field Out
    Field StartInfo:TStartInfo
    Field ProcInfo:TProcInfo

    Method Eof ( )
    EndMethod
  EndType

  Extern "C"
    Function WinGetStartupInfo ( StartInfo:TStartInfo )
  EndExtern

  Extern "Win32"
    Function WinCreatePipe ( ReadPipe Ptr , WritePipe Ptr , PipeAttributes:Byte Ptr , Size ) = "CreatePipe@16"
    Function WinCreateProcess ( App:Byte Ptr , Cmd:Byte Ptr , PrAt:Byte Ptr , ThAt:Byte Ptr , IH , Flags , Env:Byte Ptr , Dir:Byte Ptr , S:TStartInfo , P:TProcInfo ) = "CreateProcessA@40"
    Function WinReadFile ( File , Buffer:Byte Ptr , ReadLen , BytesRead Ptr , Overlapped:Byte Ptr ) = "ReadFile"
    Function WinWriteFile ( File , Buffer:Byte Ptr , WriteLen , BytesWritten Ptr , Overlapped:Byte Ptr ) = "WriteFile"
    Function WinCloseHandle ( Handle , abc ) = "CloseHandle"
  EndExtern
?
  system_ Cmd
EndFunction
</textarea><br>I've some problems with GetStartupInfo(...) function.<br>The program stops in debug mode by clicking any button. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
