<!DOCTYPE html><html lang="en" ><head ><title >Compiling a module from C++</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Compiling a module from C++</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Compiling a module from C++</a><br><br>
<a name="695034"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a library of C code I would like to use with BlitzMax.  It's very big and complicated.  I don't know too much about C programming.<br><br>Can this just be compiled straight into a BlitzMax module?  How do I go about figuring this out?  I don't really have a clue where to start.<br><br>I have a bunch of .h and .lib files.  I mostly just need to get the constants and types into BlitzMax, so that I can call the commands in the dll and have BlitzMax know all the types and constants I need to use.<br><br>Who is the best BlitzMax/C++ programmer to talk to about this? <br><br></td></tr></table><br>
<a name="695036"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="695038"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> i think you can just import them like:<br><br>import "csource.c"<br>' etc<br><br>and then just extern any stuff you need like:<br><br>extern <br>somefunction1 % ()<br>'etc<br>end extern<br><br>at lest thats what i gather.<br><br>I think bmax will then complie the c files for you. <br><br></td></tr></table><br>
<a name="695039"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >DStastny</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think he said he had headers *.h and libs.  Now that can still be done but depends on what compiler was used to generate the libs?  If it was MS Visual C++ and C++ objects no way is it going to work as BMax uses GCC and the way classes are stored in the object files are different between compilers.  Now if the libs are straight C Functins then he "might" be able to link to libs.<br><br>Got to love tall the maybes and mights but based upon what was posted cant really tell much.  Much easier to do if you have the source then its mostly structuring the imports as Diablo stated.<br><br>Doug Stastny <br><br></td></tr></table><br>
<a name="695073"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >VIP3R</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Budman is right, the .lib files are normally generated by the MS Visual C++ compiler, which won't work with BlitzMax.<br><br>The equivalent of a '.lib' library file for MinGW (BlitzMax) would be a '.a' library. If you have the full source it may be possible to either build the .a library from that, or try compiling the full source directly in BMax.<br><br>There may already be a MinGW compatible version of the library available, you should check that out before proceeding IMO. <br><br></td></tr></table><br>
<a name="695081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it were just straight functions, you could generate the .a files that GCC needs from the GCC command line tools, but MSVC++ mangles class names such that this won't work. <br><br></td></tr></table><br>
<a name="695088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Who is the best BlitzMax/C++ programmer to talk to about this?  <br></div><br><br>I'm up for such a challenge. May require a small fee if it's not for public consumption. <br><br></td></tr></table><br>
<a name="695103"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Best thing you can do (and what I would suggest) is using the lib and create a DLL out of it and bind to that one, as BM can use DLLs without "hacking around"<br><br>If you can't do that for some reason (Nuclear Glory Collision C++ License is one of those), then there are tools that allow you to make the lib usable by GCC as well.<br><br>But yes, the most optimal thing would naturally be C source files to include. <br><br></td></tr></table><br>
<a name="695119"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simon, I am emailing you now.<br><br>I checked on Messenger, but it doesn't look like you are on. <br><br></td></tr></table><br>
<a name="695146"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >gman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> it depends on how the the exports are in the lib.  newton game dynamics for example distributes a lib file usable in MSVC and MingW.  <br><pre class=code>
Import "Newton.lib"
</pre><br>i would setup a quick example first and just try to import a lib and call a single function from it to see if the libs of your library will work.  if not, there are ways to try and convert a lib to .a format.  ive had minimal success with that process though.<br><br>something else if the libs dont work, you can also try and create the needed .a file directly from the DLLs.  ive had pretty good success with this method.<br><br>if your libs do work, then its just a matter of defining all your function exports in BMAX (thats where the .h files come in handy). <br><br></td></tr></table><br>
<a name="695303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >kfprimm</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> the make a .a file from a dll, go to the command prompt and type, <pre class=code>pexports mydll.dll &gt;mydll.def</pre> then, <pre class=code>dlltool -d mydll.def -l libmydll.a</pre> then put libmydll.a into the lib folder in your BlitzMax directory and import it with <pre class=code>Import "-lmydll"</pre> <br><br></td></tr></table><br>
<a name="695324"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Simon, I sent a follow-up email.  I'm not sure if it went through, because I am not at home, and I was using a webmail page.  Please let me know if you haven't received it. <br><br></td></tr></table><br>
<a name="705732"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> any chance to see how to use .lib or .a file with bmax ? <br><br></td></tr></table><br>
<a name="705756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look here filax:<br><br><a href="http://blitzmax.com/Community/posts.php?topic=58369#649501" target="_blank">http://blitzmax.com/Community/posts.php?topic=58369#649501</a> <br><br></td></tr></table><br>
<a name="705763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Filax</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Many thanks :) i have try the process with : Bass.a but the<br>compiler return :<br><br>C:/Filou/.bmx/test.bmx.gui.release.win32.x86.o(code+0xb9): undefined reference to `BASS_Init@8'<br>C:/Filou/.bmx/test.bmx.gui.release.win32.x86.o(code+0xc1): undefined reference to `BASS_GetVersion@8'<br>Build Error: Failed to link C:/Filou/test.exe<br><br>You can download my test at :<br><a href="http://www.blitz3dfr.com/tempo/bass.rar" target="_blank">http://www.blitz3dfr.com/tempo/bass.rar</a> <br><br></td></tr></table><br>
<a name="705766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Diablo</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would love to help but I cant atm ( at college ).<br><br>Im sure someone will be able to figure this out if not I'll take a look later. <br><br></td></tr></table><br>
<a name="705776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Error on the definition, should be:<br><br>[code]<br>Extern<br>	Function BASS_GetCPU()="BASS_GetCPU@0"<br>	Function BASS_GetVersion:Int()="BASS_GetVersion@0"<br>	Function BASS_Init(device:Int, freq:Int, flags:Int, hwnd:Int, dsguid:Byte Ptr)="BASS_Init@20"<br>End Extern[/quote]<br><br>As you don't send anything to GetCPU or GetVersion and 5x 4 bytes to Init <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
