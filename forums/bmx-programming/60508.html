<!DOCTYPE html><html lang="en" ><head ><title >How to get a random number with 'weight'?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How to get a random number with 'weight'?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >How to get a random number with 'weight'?</a><br><br>
<a name="674885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, the famous balls in the sack example (no pun intented):<br><br>I have 20 balls, 15 are red, 3 are black and 2 are blue<br><br>I take one in the sack, the odds are i'll get a red one more often that a black or blue one.<br><br>Now lets say i have 3 objects in an array<br><br>Array[0].Name = RedBall<br>Array[0].Weight = 15<br><br>Array[1].Name = BlackBall<br>Array[1].Weight = 3<br><br>Array[2].Name = BlueBall<br>Array[2].Weight = 2<br><br>OccurenceTotal = 20<br><br>how do i randomize a number from 0 to 2 that takes into account the Weight?<br><br>The idea being this: imaging a tetris that once in a while has a special piece instead of the normal ones. The 7 basic tetris pieces would have the same weight, and the specials pieces would have a much smaller weight..<br><br>Thanks for the help,<br><br>Smurftra (not makign a tetris, just thought it was a clear example) <br><br></td></tr></table><br>
<a name="674886"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well there are many ways to do this.<br><br>1) Use a wieghted SQL query (that don't help here)<br>2) Fill an array with the possibilities and choose at random from the array, for example.<br><br>Lets assume:<br><br>Red ball = 1 (weight 15)<br>Black ball = 2 (weight 3)<br>Blue Ball = 3 (Wieght 2)<br><br>So our array of numbers is :<br>[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3]<br><br>Choose a random position from the array and select the correct ball :)<br><br>This method is used widely. <br><br></td></tr></table><br>
<a name="674889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you want the `heavier` weighted ones to show up more often? You could just set them all the same weight and then add more instances of the heavier ones <br><br></td></tr></table><br>
<a name="674891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> a=rnd (20)<br>if a &lt;= NumberRed <br>red<br>else if a&lt;= NumberRed+NumberBlack<br>Black<br>else if a&lt;= NumberRed+NumberBlack+NumberBlue<br>Blue<br>endif endif endif <br><br></td></tr></table><br>
<a name="674892"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow thanks for the quick answers. I've though of and used in the previous version of my game the method of creating such an array. The problem i wanted to solve was that i have lots of elements (and they are dynamic) and the array becomes really big and i figured some maths could save me some memory/process time.<br><br>The other way I could do it would be to have something like<br><br>Array[0].Name = RedBall<br>Array[0].WeightStart = 1<br>Array[0].WeightEnd = 15<br><br>Array[1].Name = BlackBall<br>Array[1].WeightStart = 16<br>Array[1].WeightEnd = 18<br><br>Array[2].Name = BlueBall<br>Array[2].WeightStart = 19<br>Array[2].WeightEnd = 20<br><br>OccurenceTotal = 20<br><br>randomizing a number between 1 and 20<br><br>and then going through the array to find which one's limits englobes my random number. That would save up on memory but not so sure on cpu time. <br><br></td></tr></table><br>
<a name="674915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tachyon</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> My choice:<br><br>Ball = Blue<br>X = Rand(20)<br>If X &gt; 2 then Ball = Black<br>If X &gt; 5 then Ball = Red <br><br></td></tr></table><br>
<a name="674916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=963" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=963</a> <br><br></td></tr></table><br>
<a name="674924"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Smurftra</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, i forgot to say that the list of objects to randomize from is dynamic so a IF or Case doesnt work. It has to work for all kinds of weight and object numbers.<br><br>Thanks sswift thats what i'm looking for <br><br></td></tr></table><br>
<a name="674984"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> try this<br><br>I just came up with it <br><br>(I'm pretty wiped out today but I ran it a few times and it is pretty consistent.) :)<br><br><pre class=code>
SeedRnd(MilliSecs())

For w = 1 To 20
	For x = 1 To 10000
		If WeightedRND(W) = True Then hit:+1
	Next
	Print "Weight"+W+":"+hit+" Hits"
	Hit=0
Next


Function WeightedRND(weight:Int)
	If Rand(0,weight*weight) = 1 Then Return True
End Function


</pre><br><br>the lower the weight, the more likely the function will return TRUE. just assign a high weight to the things you want to be scarce. <br><br></td></tr></table><br>
<a name="674985"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Tachyon,<br><br>Whilst yours looks smaller than mine. Yours has to go through every If statment every time, whereas mine stops going through them when the condition is satisfied.<br>(If you wish to counter argue that mine has all those additions, I would point out that so does yours, but you just havent put them in. ie you ether pre calculate the "Weights" or you dont) <br><br></td></tr></table><br>
<a name="674989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >bradford6</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> here si a graphical example:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Graphics 1024,768,16

Type Ball
	Field image:timage
	Field r:Int , g:Int , b:Int
	Field weight:Int
	Field Drawn:Int
	
	Method draw()
		SetColor r , g , b
		DrawOval (Rand(0 , GraphicsWidth() ) , Rand(0 , GraphicsHeight() ) , 25 , 25)
		drawn:+1
	End Method	
End Type

Local redball:Ball = New Ball
redball.weight = 4
redball.r = 255

Local blueball:Ball = New Ball
blueball.weight = 16
blueball.b = 255


Local yellowball:Ball = New Ball
yellowball.weight = 33
yellowball.r = 255
yellowBall.g = 255

SetBlend ALPHABLEND
SetAlpha 0.25
SeedRnd(MilliSecs())

	While balls&lt;100000
	
		If WeightedRND(redball.weight) = True Then redball.draw
		If WeightedRND(blueball.weight) = True Then blueball.draw
		If WeightedRND(yellowball.weight) = True Then yellowball.draw
		
		balls:+1
	
	Wend
Local scale:Float = 3
SetScale 3 , 3
SetAlpha 1
SetColor 255,255,200
DrawText "Red:" + redball.Drawn , GraphicsWidth()/2 ,  GraphicsHeight()/2
DrawText "Blue:" + blueball.Drawn , GraphicsWidth()/2 , scale*(TextHeight("X"))+GraphicsHeight()/2
DrawText "Yellow:"+ yellowball.Drawn,GraphicsWidth()/2 , scale*(TextHeight("X")*2)+GraphicsHeight()/2

Flip

WaitKey
	
	
	
	
Function WeightedRND(weight:Int)
	If Rand(0,weight*weight) = 1 Then Return True
End Function


</textarea> <br><br></td></tr></table><br>
<a name="675045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I did the array method for my Bonus games to determine which bonuses can appear. <br><br></td></tr></table><br>
<a name="675049"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> At least with the array method you can guarantee that 20 balls will always be delivered and 15 will be red etc. etc. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
