<!DOCTYPE html><html lang="en" ><head ><title >How many Backbuffers?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How many Backbuffers?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >How many Backbuffers?</a><br><br>
<a name="646595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, in windowed mode, it seems there is only one backbuffer (this was the case in BlitzPlus as well).  So if you draw an image, flip, the current backbuffer isn't blank, it's the exact one you just drew.<br><br>However, in full-screen mode there are two backbuffers, so if you call flip, the current backbuffer is blank, call flip again and you return back to the original one you drew. When I say blank, I'm just talking about the first time the app/game is run, not later on when you've drawn on both buffers.<br><br>Is this correct?<br><br>So, the GrabImage example in the doc has this line:<br><br><pre class=code>Graphics 800,600,0'640,480,32</pre> inferring you can run the code in full-screen mode.  But you jsut get a black screen because Flip is called before GrabImage thus Grab Image is getting a blank backbuffer (the 2nd backbuffer). <br><br></td></tr></table><br>
<a name="646631"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's probably down to the OpenGL/DirectX driver as to whether it keeps the front buffer when you flip it or whether it trashes it. You can't rely on it being always preserved, it's not meant to be. When you flip the backbuffer to the front the front is lost. You have to physically draw stuff on the backbuffer before you can grab it and before you flip it. Flip=Trash the buffer. <br><br></td></tr></table><br>
<a name="646633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> that's what I thought (generally), which is why the grabimage example is weird, as if grabs AFTER the flip.<br><br>Mind you my Bonus games reply on the backbuffer not being trashed each frame for the dirty rects system to work, and it does work perfectly. <br><br></td></tr></table><br>
<a name="646750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> According to the OpenGL docs you can't ever expect the flipped front buffer to be preserved. It could be trashed entirely by other graphics or a totally new unrelated backbuffer could be allocated in a different memory space for the next frame. If you are getting it to be preserved at the moment, it also doesn't mean it will work that way for all people because there are differences across the various OpenGL drivers. It's more of an exception than the rule.<br><br>You would be better of probably just redrawing the whole display - that's more of the mindset of modern game construction, although the old-school ways are cool. <br><br></td></tr></table><br>
<a name="646752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well my Xmas Bonus games were in BlitzPLus which was DirectX not OpenGL so that must be why it worked.  Origianlly I did redraw the whole screen, but then I realised this was too slow for some PCs, thus implemented the old-school Amiga-style dirty rects system, then the game worked on 300MHz PCs :-) <br><br></td></tr></table><br>
<a name="646901"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> However, in full-screen mode there are two backbuffers, so if you call flip, the current backbuffer is blank, call flip again and you return back to the original one you drew. When I say blank, I'm just talking about the first time the app/game is run, not later on when you've drawn on both buffers.<br><br>Is this correct? <br></div><br><br>Worse.<br><br>It's dependend on your video adapter and/or drivers -- I have three computers and a laptop, and found that one of them uses one backbuffer, two of them use two backbuffers, and the last one uses *three* backbuffers.<br><br>There was a thread about this a year ago: <a href="http://blitzbasic.com/Community/posts.php?topic=43274&amp;hl=three%20backbuffers" target="_blank">http://blitzbasic.com/Community/posts.php?topic=43274&amp;hl=three%20backbuffers</a><br><br>Bottom line: you can never count on what's on your backbuffer. Depending on what it is you're changing, you can end up with flickering on some systems. <br><br></td></tr></table><br>
<a name="646927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, well lucky I won't be using that method anymore.  But noone has reported back problems with my Bonus game.  However, now I think on it, I have seen some weird things on some old test machines like some cards with only one buffer in full-screen mode, perhaps.  I also used the method of drawing the same thing on two buffers to matain a static image too, but this would look crap on a 3 buffer system, according to that thread.  Also as I assumed windowed mode has only one buffer, I hope that's correct, otherwise some players may be having graphical anomalies, bummer.  It's a bummer really, I assumed what happened on my system happened on ALL systems, how naive :-( <br><br></td></tr></table><br>
<a name="646933"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It's a bummer really, I assumed what happened on my system happened on ALL systems, how naive :-(  <br></div><br><br>Heh. I'm sure that indiepath can tell you all about graphics anomalies on varying systems. he had some code floating around that was supposed to draw things in black and white -- worked great on some systems, but went horribly wrong in all kind of interesting ways on others. <br><br></td></tr></table><br>
<a name="646943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> DX: Up to 8 Backbuffers in FlipChain<br>OpenGL: Up to 2 Backbuffers in FlipChain if activated in the driver (At least on ATIs) <br><br></td></tr></table><br>
<a name="661781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know this is an old thread but it's intersting, as I'm having some troubles with detecting whether the display actually flips (ie if it is single-buffered), and maybe the presence of extra backbuffers has something to do with it. A test for double buffering seems to work in fullscreen mode, maybe because there are triple buffers, but fails in window mode (double?). <br><br></td></tr></table><br>
<a name="661799"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> My experience on my PC at least (in BlitzPlus) was only one buffer in windowed mode and two in full-screen mode.  I had to change my dirty rects system accordingly.  Only much later I found this varied on other systems, great... <br><br></td></tr></table><br>
<a name="661804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm. We'll it's all good stuff to know. I didn't realize there were so many `issues` on modern computers, back in the Amiga days things were straightforward. Now we have to take care of all this tearing, flipping, buffer availability, backbuffers, driver support, cross-platform malarky. <br><br></td></tr></table><br>
<a name="661809"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Read the source, the Fullscreen backbuffer count is 1.<br><br><pre class=code>		ddsd=New DDSURFACEDESC2
		ddsd.dwSize=SizeOf(ddsd)
		fullscreen=state&amp;DX7FULLSCREEN
		flipflags=DDFLIP_WAIT
		If fullscreen
			ddsd.dwFlags=DDSD_CAPS|DDSD_BACKBUFFERCOUNT
			ddsd.ddsCaps=DDSCAPS_PRIMARYSURFACE|DDSCAPS_FLIP|DDSCAPS_COMPLEX|DDSCAPS_3DDEVICE
			ddsd.dwBackBufferCount=1
		Else
			ddsd.dwFlags=DDSD_CAPS
			ddsd.ddsCaps=DDSCAPS_PRIMARYSURFACE|DDSCAPS_3DDEVICE
		EndIf</pre> <br><br></td></tr></table><br>
<a name="661822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> That applies to directx, maybe not opengl <br><br></td></tr></table><br>
<a name="661841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> All the modes are double buffered and from what I can glean from the source there is only 1 backbuffer in OGL or DX or Windowed or Fullscreen. <br><br></td></tr></table><br>
<a name="661856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I seem to be able to open a single-buffered display in OpenGL no problem, no backbuffer. Drawing to the back draws to the front. <br><br></td></tr></table><br>
<a name="661859"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> EVen in Max on my PC there is only one buffer in windowed mode and two in full-screen.  You can see this by drawing a shape, the calling flip, no clsm then another shape then flip  Are there two or one on screen?  I get two in windowed mode and one in full-screen mode. <br><br></td></tr></table><br>
<a name="661983"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I seem to be able to open a single-buffered display in OpenGL no problem, no backbuffer. Drawing to the back draws to the front. <br></div><br>Are you telling me that you can see your drawing results without a flip?<br><br>-----------------------------------------------<br><br>I think that there is some confusion here about how all this flipping works.<br><br><b>Windowed Mode</b><br>Blits Backbuffer to Primary Surface (No Flipping) - Backbuffer remains as backbuffer<br><br><b>FullScreen Mode</b><br>Flips BackBuffer with Primary Surface - BackBuffer becomes primary and primary becomes BackBuffer.<br><br>So in fullscreen when you draw shape 1 it gets drawn to the Backbuffer, you flip, shape 1 is now in the primary buffer, you draw shape 2 and it's now drawn to the new backbuffer (old primary), do a flip and you draw shape 3 and it will be in the same buffer as shape 1.<br><br>Make sense? <br><br></td></tr></table><br>
<a name="661999"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep that's what I said... <br><br></td></tr></table><br>
<a name="662006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> You said there are two backbuffers, that is not correct. <br><br></td></tr></table><br>
<a name="662015"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK bad terminolgy :-p  Two "screens" you are drawing to in full-screen mode (they alternate on flip), only one in windowed mode. <br><br></td></tr></table><br>
<a name="662040"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> In fullscreen you can have more. DX flipchain length depends on the GPUs speed ... the faster, the further it renders ahead (-&gt; mouse lag) <br><br></td></tr></table><br>
<a name="662077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yah in OpenGL if  you ask for a singlebuffered display you can see the drawing results immediately without a flip.<br><br>I didn't realize, though, that in window mode the backbuffers stays being the backbuffer. That would account for some of my problems. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
