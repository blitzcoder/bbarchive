<!DOCTYPE html><html lang="en" ><head ><title >Multiple graphics windows</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Multiple graphics windows</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Multiple graphics windows</a><br><br>
<a name="645302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Punksmurf</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello all,<br><br>At first, I'm sorry if a similar topic already showed up, but I didn't find any so I hereby give it a try.<br><br>I've been hacking around a bit to create more than one graphics window. I do not use (or own, for that matter) the GUI-module.<br><br>This is my code:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict

SetGraphicsDriver GLMax2DDriver() 'this doesn't work with DirectX-drivers

AppTitle = "window a"
Local a:TGraphics = CreateGraphics (320,240,0,0,GRAPHICS_BACKBUFFER)

AppTitle = "window b"
Local b:TGraphics = CreateGraphics (240,320,0,0,GRAPHICS_BACKBUFFER)

EnablePolledInput() 'Manually enable polled input

While Not AppTerminate() Or Not Confirm( "Terminate?" )

	SetGraphics(a)
	SetColor (Rand(0,255),Rand(0,255),Rand(0,255))
	Plot (Rand(0,319),Rand(0,239))
	Flip

	Print "a - x: " + MouseX() + ", y: " + MouseY()

	SetGraphics(b)
	SetColor (Rand(0,255),Rand(0,255),Rand(0,255))
	DrawLine (Rand(0,239),Rand(0,319),Rand(0,239),Rand(0,319))
	Flip
	
	Print "b - x: " + MouseX() + ", y: " + MouseY()
	
Wend
</textarea><br><br>As you can see, it is possible to render graphics to more than one window, altough it crashes when using more than one DirectX-window (it should be possible even to use different drivers for each window, as SetGraphics would change the driver accordingly, but I haven't tried that).<br><br>However, it doesn't seem possible to differentiate the input generated by each window. MouseX() and MouseY() just depend on over which window the mouse is.<br><br>I tried looking up EnablePolledInput:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Rem
Currently only called by Graphics/bglCreateContext.
Private for now, as it really needs a source:object parameter.
End Rem
Function EnablePolledInput( source:Object=Null )
	If enabled Return
	inputSource=source
	FlushKeys
	FlushMouse
	AddHook EmitEventHook,Hook,Null,0
	enabled=True
End Function
</textarea><br><br>It says it requires an object, yet the 'Graphics' function doesn't pass an object - in contrary to what the comment here says. I tried to 'EnablePolledInput(a)', hoping that it then only would return input from 'window a', but that doesn't work.<br><br>Does any of you have a clue how I can differentiate the input from the two windows? <br><br></td></tr></table><br>
<a name="645304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Only by using event based programming. In this case you could use EventSource() (or currentevent.source <br><br></td></tr></table><br>
<a name="645329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Punksmurf</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for your answer, bud sadly enough, it doesn't work out..<br><br>I removed the EnablePulledInput and the 'print mousex()' stuff and added the following:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function Hook:Object(id:Int,data:Object,context:Object)

	Local ev:TEvent=TEvent(data)
	If Not ev Return data
	Print ev.id
	If ev.source Print "event has a source" Else Print "event didn't have a source"
	
	Return data	

End Function

AddHook EmitEventHook,Hook,Null,0
</textarea><br>As it turns out, the events show up nicely but the events don't have a source. This is also why the 'EnablePolledInput(a)' doesn't work, see in polledinput.bmx:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Function Hook:Object( id,data:Object,context:Object )

	Local ev:TEvent=TEvent(data)
	If Not ev Return data
	
	If inputSource And inputSource&lt;&gt;ev.source Return data

	'more stuff
End Function
</textarea><br><br>InputSource is set to 'source' object in the EnablePolledInput(source:Object) function, so in my example it'd be 'a:TGraphics', but since the EventSource is empty, the function quits.<br><br>I'm sorry if I'm not clear enough, I find these things hard to explain in Human. <br><br></td></tr></table><br>
<a name="645539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Punksmurf</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Some other funny thing: if you close one window, the graphics meant for the closed window will be drawn on the remaining window. I guessed this is because the TGraphics object would be destroyed as the window closes and that setGraphics won't switch to a non-existing TGraphics object. This, however, is not true - the object still exists (even if both windows are closed). <br><br></td></tr></table><br>
<a name="650298"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Punksmurf</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have a clue? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
