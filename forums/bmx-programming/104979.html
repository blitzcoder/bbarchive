<!DOCTYPE html><html lang="en" ><head ><title >Puzzling about Import</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Puzzling about Import</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Puzzling about Import</a><br><br>
<a name="1275656"></a>

<a name="1275657"></a>

<a name="1275671"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> So I was recently reading some threads on <b>Import</b> vs <b>Include</b>; having learned most of my habits from Blitz3D and classic Blitz BASIC (and still in the process of unlearning said habits, I might add), I've still been using <b>Include</b> in my project headers to pull all my other code files in.<br><br>Learning the concepts of object-oriented programming has done a great deal of good for me; where once my code would've been an inter-dependent mess, nowadays my list of <b>Includes</b> is simply arranged in alphabetical order, because I no longer initialize anything in mainspace save for a few "essential" Globals which are all in their own file of shame. I thought I was doing pretty well with this, and it's certainly a big step forward from my old practices, but experimenting with <b>Import</b> recently has brought to my attention that I'm still a long way from skilled.<br><br>Here's my current ponder: let's say we create a custom sprite type in its own import file, like:<br><br><pre class=code>---file sprites.bmx---

Type TSprite
	Field image:TImage
	
	Method draw(x:Int,y:Int,frame:Int)
		DrawImage image,x,y,frame
	End Method
	'... Other properties and stuff, methods, etc
End Type</pre><br><br>Now we have a type that holds sprites as images with their own properties, methods for animating and drawing, etc. But now we need a way to <i>use</i> those sprites, i.e. we need some "actors" on the screen, which will call the sprites to be drawn at various locations, frames of animation, etc.<br><br><pre class=code>---file actors.bmx---

Type TActor
	Field x:Int,y:Int
	Field frame:Int
	
	Field sprite:TSprite ' The handle of the actual sprite to draw
	
	Method draw()
		sprite.draw(x,y,frame)
	End Method
	' ... Other code and such
End Type</pre><br><br>This is where I fall flat with OO and <b>Import</b>. Because <b>Import</b> compiles everything separately before building (correct term I think?), the <b>TSprite</b> type doesn't exist as far as <b>actors.bmx</b> is concerned. Now, if <b>actors.bmx</b> is the only file that uses <b>TSprite</b>, then you could just move all the <b>TSprite</b> code into that file and call it a day. But what if you also want to use <b>TSprite</b> for other things, like map tiles, title logo, HUD elements, and so on?<br><br>Obviously you wouldn't want to copy the code into multiple files, so I figure one of two things is happening here: either I'm not thinking the sprite-to-game structure through enough, or there are OO-related ways to access types from imported files that I just don't know about.<br><br>This entire post is probably a mess of bad assumptions and miseducated ramblings, anyone care to lend some perspective? <br><br></td></tr></table><br>
<a name="1275662"></a>

<a name="1275663"></a>

<a name="1275664"></a>

<a name="1275665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You're only missing one minor thing, which is that since Import does something slightly different from Include, you also use it in a slightly different way.<br><br>Include is a blind copy and paste, as you already know. Among other things this means that you never normally want to use it twice on the same file (I think if you do use it twice Blitz actually just helpfully ignores the second call, although this limits your options for C-style silliness), since you don't want two copies of the same class definitions pasted into your program's toplevel.<br><br>Import, however, <i>doesn't paste anything</i> and doesn't work like a copy-and-paste either. All it does is make the <i>names</i> declared at the toplevel visible in another translation unit (translation unit = "thing being compiled right now", result of pasted-together files or w/e), but the code of that TU stays exactly as it looks in the file as-written. The compiler is simply <i>aware</i> that a given set of names is available, and can be compiled against and referenced from this TU, but it doesn't need to copy the code or connect to it right now; the code behind those names has been previously built in a different TU just needs to be enqueued for use in the main program as well. Import provides information, to the tune of "yes this exists", but has no mechanical effect on the code being generated (beyond enabling it to <i>be</i> generated).<br><br>This means: Import can be used to refer to the same file multiple times in the same program, if it's done from separate translation units. This doesn't create multiple copies, but just indicates that multiple units depend on the same piece of code. So Actor can import Sprite, and Program can import Actor <i>and</i> Sprite, and this won't cause a duplicated definition of Sprite in Program, because neither Import statement actually caused any code to be generated: there's only one definition of Sprite off in its own TU, <i>referenced</i> in two other TUs. It will be linked together with the rest of them when the time comes to build a complete program object, now that the compiler knows there are other units that require the named things within it. <br><br></td></tr></table><br>
<a name="1275672"></a>

<a name="1275673"></a>

<a name="1275675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Adam Novagen</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <b><i>OH</i></b>. That makes much more sense; so if I understand this correctly, every file used in a project can (and should) import any files it uses as dependencies, and then the header - rather than being a unified list of every file used in the project - can simply import the top-level files.<br><br>So like, for my example, <b>actors.bmx</b> would import <b>sprites.bmx</b>, and <b>map tiles.bmx</b> would <i>also</i> import <b>sprites.bmx</b>. <b>header.bmx</b> would then import both <b>actors.bmx</b> and <b>map tiles.bmx</b>, and finally <b>main.bmx</b> would import (include?) <b>header.bmx</b>. Am I getting this correctly? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
