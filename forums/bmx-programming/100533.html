<!DOCTYPE html><html lang="en" ><head ><title >Memory Management: Limit Length of String?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Memory Management: Limit Length of String?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Memory Management: Limit Length of String?</a><br><br>
<a name="1187840"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi there,<br><br>is it possible to limit the maximum length of a string variable (e.g. 12 chars) in order to save some ram? <br>Or does BMX allocate the string size dynamically (depending on the usage)? <br><br>Thanks!<br>Grisu <br><br></td></tr></table><br>
<a name="1187848"></a>

<a name="1187849"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Since you can create strings that are hundreds of megabytes or more depending on free memory, they must be created dynamically.<br><br>IIRC string size is 1 byte for each character, plus 4 bytes overhead.<br><br>(so a 100 character string should take 100+4=104 bytes) <br><br></td></tr></table><br>
<a name="1187850"></a>

<a name="1187851"></a>

<a name="1187852"></a>

<a name="1187853"></a>

<a name="1187854"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yasha</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can view the implementation of strings in mod/brl.mod/blitz.mod/blitz_string.h (and .c).<br><br>Strings are allocated dynamically and sized to the exact number of characters (so they don't have any special buffering treatment within the string class). Characters appear to be fixed-width two-byte wchars, so the size of a string is two times the length, plus <i>twelve</i> bytes of object header, rounded up to the nearest 16 (if I understand the GC correctly, which I probably don't).<br><br><br>If you really care about saving every last byte, and you know how many strings you have and that they're all the same size in advance, you could conceivably allocate them as arrays of raw character data in an untyped memory block instead? This isn't going to be worth your time in the majority of cases though. <br><br></td></tr></table><br>
<a name="1188253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then I have to find other ways to reduce my apps memory consumption.<br><br>"Int vs Byte" declaration, would such a change make some difference? <br>Or does BMX convert a variable to Int anyway? <br><br></td></tr></table><br>
<a name="1188255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> "Int vs Byte" declaration, would such a change make some difference?  <br></div><br>Good grief!?! How much memory does your PC have?<br>Int/Byte isn't likely to make a huge difference unless you have thousands upon thousands of values you are storing in large arrays.<br><br>Fields in types tend to pad out to 32-bit alignment.<br>Field order can make a little difference, but it only matters if you have lots and lots and lots of types.<br>For example, having Byte, Int, Byte, Int, Byte, Byte Fields will take up more space than if all the Bytes are grouped together.<br>But again, unless you are using a significant number of types, you won't see much difference. <br><br></td></tr></table><br>
<a name="1188257"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> why do you think, the strings are your problem? Normally they do not matter in memory consuption.<br><br>Make a short research thru your file and tell us:<br><br>1.<br>How much Bytes do all aour resources have together? <br><br>2.<br>How many image files?<br>How big are the biggest ten?<br>How many pixels width height has the biggest one?<br><br>3.<br>How many audio files?<br>How big are the biggest ten?<br>How many seconds playing time has the biggest one?<br><br>4.<br>How many text/data files?<br>How big are the biggest ten? <br><br></td></tr></table><br>
<a name="1188258"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for the explanation Brucey. <br><br>My PC has enough memory, I'm just trying to optimise my code where possible. As more and more stations make it into my database I want to keep it light-weight.<br><br>I regrouped and shrinked the number of my variables to: <br>Field name$,filename$,genre:Byte,rating:Byte,fav:Byte,recent:Byte<br><br>This seems to work just fine. <br><br></td></tr></table><br>
<a name="1188283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can you use compression at all?<br><br>Bytes will save you 75% of memory over its, possibly, depending how they're stored by the system... but they aren't faster. <br><br></td></tr></table><br>
<a name="1188284"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You might also consider bitfields, using 1 bit to represent a status and store 32 of them together. <br><br></td></tr></table><br>
<a name="1188287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think, I'm now quite near the limit. For the memory savings I would get the amount of work is not "worth" it. <br><br>With 1.700+ small data files (zips) I need some overhead structure in order to reduce HDD access though. <br><br></td></tr></table><br>
<a name="1188290"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> are these 1700+ zips READ ONLY? Or do the contents change often? I asked, because if you pack them together in bigger files it would reduce the HDD use and rise the speed of reading all... <br><br></td></tr></table><br>
<a name="1188331"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> They are changed frequently and the user can edit them as well. On top of that there are logo files that come with most of the zips. That's why I keep a fraction of the data in memory in order to create list views etc.<br><br>The only thing that might decrease the loading speed a bit is to mutithread the whole sequence via Bah.Libcurl. <br><br>If you like you may check out the <a href="http://www.softpedia.com/get/Internet/Internet-Radio-TV-Player/Pocket-Radio-Player.shtml" target="_blank">app</a> to see what it does: <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
