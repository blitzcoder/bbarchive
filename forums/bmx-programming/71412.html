<!DOCTYPE html><html lang="en" ><head ><title >Communication between programs?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Communication between programs?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Communication between programs?</a><br><br>
<a name="798521"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm currently writing an application that needs to be associated with a particular file extension -- but more importantly, I only want a single copy of the program running to deal with multiple files.<br><br>Is there an 'easy' way to handle this?<br><br>I know how to check the list of running processes upon application launch so the app can find out if there is already another copy running -- but how can one pass the name of the file to the already running application and trigger it into opening the file instead?<br><br>Or is the above going at it all wrong? <br><br></td></tr></table><br>
<a name="798529"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You want CreateMutex from Kernel32. Lots of documentation about it on the MSDN, of course, but something like this :<br><br><pre class=code>
Extern "Win32" 
   Function GetLastError:Int() = "GetLastError"
   Function CreateMutex:Int(lpMutexAttributes:Int,bInitialOwner:Int,lpName$z)
End Extern

Const ERROR_ALREADY_EXISTS:Int=183

CreateMutex(0,1,"My Program Instance")

If GetLastError() = ERROR_ALREADY_EXISTS Then
	' PROGRAM IS ALREADY RUNNING - SHUTDOWN
Else
	' PROGRAM IS NOT RUNNING, GO AHEAD
EndIf
</pre><br><br>That's off the top of my head, so it might not be 100 percent.<br><br>EDIT: You may have to make some minor modifications to get the CreateMutex function to link properly, but the site won't let me post them. Sorry about that. <br><br></td></tr></table><br>
<a name="798530"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have no idea why the code I posted above is being censored by the security measures. Perhaps someone from BRL can tell me why.<br><br>As I said, you need CreateMutex, but since apparently any code sample sends the site censor into a fit, you should probably check the MSDN for an explanation. <br><br></td></tr></table><br>
<a name="798542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, but that only deals with the program detecting whether it is the first instance or if another one already exists -- I could do that already (although the code above is definitely a lot cleaner than mine was, so thanks for that!)<br><br>The real question is how the 2nd instance can pass on its parameters to the 1st instance, so it can handle the file(s) I'm trying to open. Is there some way to trigger an event in the 1st program that passes the info along? <br><br></td></tr></table><br>
<a name="798545"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oh sorry, I got so caught up in the forum messing with my code that I clean forgot the second part. Just grab the process ( as I guess you already are ) and send it a message with SendMessage ( also in the WinAPI.) <br><br>I believe the correct message to send is WM_COPYDATA.<br><br>I can't find anything directly in BMax, but perhaps this page explains it well enough for you.<br><br><a href="http://www.codeguru.com/cpp/w-p/system/processesmodules/article.php/c5777/" target="_blank">http://www.codeguru.com/cpp/w-p/system/processesmodules/article.php/c5777/</a><br><br>Worst case, you could always open up a socket and send data that way, but I think WM_COPYDATA is probably the clean, recommended way to do it. <br><br></td></tr></table><br>
<a name="798574"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I found another thread with some further info that is somewhat related to this: <a href="http://www.blitzbasic.com/Community/posts.php?topic=48863" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=48863</a><br><br>That one sends text to an edit field in another program. Not exactly what I'm after, but it might provide a start...<br><br>(It does appear that the forum is messing with lines containing the @ symbol, so it needs a little tweaking to work.) <br><br></td></tr></table><br>
<a name="798830"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, I ended up going with Budman's <a href="/posts.php?topic=65705" target="_blank">shared memory routine</a> , which so far appears to work great.<br><br>Thanks for the pointers Gabriel, but I just couldn't get it to work. :-? <br><br></td></tr></table><br>
<a name="798889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SebHoll</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure that that is the proper way to get this behaviour, although if you're happy it works, nevermind.<br><br>The <a href="http://en.wikipedia.org/wiki/Dynamic_Data_Exchange" target="_blank">Windows shell uses DDE</a> to communicate with currently running instances of your program when you open a file in Explorer and if you can interpret and respond to these message positively, then it will not open another instance.<br><br>If you have a look at the File Type properties for commercial applications (like MS Office), they all have DDE setup so that they can acheive the effect your after. The idea is you can tell the shell to send the file path to your application instance using DDE and you can open it internally. However, I haven't tried doing this in Blitz so I can't give you much more info than that. Maybe someone who actually knows what there doing with the Windows API could help with trying to implement this - I'd be interested in getting this working too.<br><br>Edit: Here's an <a href="http://msdn2.microsoft.com/en-us/library/ms648775.aspx" target="_blank">MSDN page on <i>using DDE</i></a> and a diagram taken from that page showing data flow:<br><br><img src="http://msdn2.microsoft.com/en-us/library/ms648775.csdde_01(en-us,VS.85).gif"><br><br>I can't make much sense out of it though. :-( <br><br></td></tr></table><br>
<a name="798904"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://www.codeproject.com/cpp/avoidmultinstance.asp" target="_blank">http://www.codeproject.com/cpp/avoidmultinstance.asp</a> - this is all you need - shared memory is overkill <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
