<!DOCTYPE html><html lang="en" ><head ><title >Unzip a zip in memory and read files</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Unzip a zip in memory and read files</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Unzip a zip in memory and read files</a><br><br>
<a name="1096684"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi.<br><br>Each level in my game has a folder and a number of files, to store the terrain, scripts etc in several files within the folder. I'd like for these files to be stored in a zip archive of some kind, both to save space and to make it easier to transfer levels. All files can be modified with in-game editors so there is no need for ordinary users to see the individual files.<br><br>Does anybody know how I could do this? I don't want to extract the files to disk every time I load the level. I want to extract to "virtual" files in ram, and read them.<br><br>Thank you. <br><br></td></tr></table><br>
<a name="1096688"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seperate question, how do I use the Pub.ZLib compress function?<br><br>How big does the dest array need to be? In case it doesn't compress, it could be larger than the original array? What is the point of the dest size parameter? Can I give it 1 and get infinate compression? <br><br></td></tr></table><br>
<a name="1096691"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok I've got it to compress, but how do I know the size of the compressed data? Otherwise how do I know how much to write to a file without writing the whole block? This function is useless. <br><br></td></tr></table><br>
<a name="1096692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok the dest len paramater is passed in as a pointer, and changed to the compressed size.<br><br>There is a missing function called compressBound which returns the maximum size needed to compress the source data, in order to allocate a large enough dest buffer. <br><br></td></tr></table><br>
<a name="1096696"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warner</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use the first two functions I found in this thread:<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=44765#498146" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=44765#498146</a><br>They take a Byte array as a parameter, and handle the resizing themselves. I find them quite convenient. <br><br></td></tr></table><br>
<a name="1096702"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use Gman's Zip Engine: <a href="http://www.gprogs.com/viewtopic.php?id=28" target="_blank">http://www.gprogs.com/viewtopic.php?id=28</a><br><br>Free, cross-platform and a dedicated support. - All one should need... ;) <br><br></td></tr></table><br>
<a name="1096703"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can I use this to extract a multi-file archive into memory? <br><br></td></tr></table><br>
<a name="1096735"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Midimaster</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> if you talk about read-only-files, you could use Koriolis-ZipStream for them. The advantage is, the ZIP-File can be added as INCBIN, the files inside can be used with the normal stream-functions. So ,there is no need to think about unzipping, etc...<br><br><pre class=code>picture=LoadImage("zip::pack.zip/background.png")
'or:
incbin "pack.zip"
LoadImage("zip::incbin::pack.zip/background.png"</pre><br><br>The disadvantage is, there is no chance of any kind of writing into the zip. <br><br></td></tr></table><br>
<a name="1096807"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's for reading and writing level files which can be made with the game editor and shared between friends, so sadly I can't use that. Thanks for the suggestion! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
