<!DOCTYPE html><html lang="en" ><head ><title >Problem with projection matrix.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Problem with projection matrix.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Problem with projection matrix.</a><br><br>
<a name="998199"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sokurah</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm having a bit of problems with a projection matrix.<br>I'm using the one I found here; <a href="http://www.blitzbasic.com/codearcs/codearcs.php?code=2595" target="_blank">http://www.blitzbasic.com/codearcs/codearcs.php?code=2595</a><br><br>The projection matrix itself works just fine and scales my game to any resolution but a few days I added a couple of functions for fading the screen to black (and back up from black) but that's the thing that is giving me problems.<br><br>Things are set up like this at the top of the program;<br><br><div class="quote"> TVirtualGraphics.Set(512, 384)<br>AutoMidHandle 1<br>Global mode:TGraphicsMode<br>Global OFormat:String<br>Global Buffer:TImage = CreateImage(512, 384, 1, MASKEDIMAGE | MASKEDIMAGE) <br></div><br><br>The buffer is for fading the screen in and out.<br><br>Normally I'd do like this to draw something;<br><div class="quote"> DrawImage Level0GFX, (TVirtualGraphics.virtualWidth / 2), (TVirtualGraphics.virtualHeight / 2) <br></div><br>..and that works.<br><br>The fade function I wrote looks like this; <br><br><div class="quote"> Function FadeOut()<br>		GrabImage Buffer, 0, 0<br>		a = 255<br>		Repeat<br>			Cls<br>			SetColor a, a, a<br>			DrawImage Buffer, (TVirtualGraphics.virtualWidth / 2), (TVirtualGraphics.virtualHeight / 2)<br>			Flip<br>			WaitKey<br>			a = a - 16<br>		Until a &lt; 0<br>End Function <br></div><br><br>I draw something on the screen but don't do a flip but call the fade function instead.<br>Simple - but it works...as long as I'm not using the projection matrix or I'm only running at the game's original 512x384 resolution.<br><br>If I set the resolution to double the original - 1024x768 and call the fade I get this result.<br><br><br><img src="http://tardis.dk/retro/snowman/problem.png"><br><br>I just can't figure out why I get this zoomed quarter of what I should get.<br><br>Can anyone help telling me what I'm doing wrong? ;-) <br><br></td></tr></table><br>
<a name="998202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> GrabImage + Projection matrix = No go.<br><br>You need to set the virtual graphics res back to match the physical graphics resolution first.<br><br>I also noticed that you have <b>MASKEDIMAGE | MASKEDIMAGE</b>, which is... pointless.  Just one MASKEDIMAGE will do, won't it?<br><br>Also, as of version 1.35, Blitzmax has its own projection matrix code.<br><br>Oh, one more thing.  Instead of grabbing a large image (which is a bit wasteful), it might work out better if you create a small, solid black image, draw the original game screen, then the black image over the top with DrawImageRect, with increasing alpha.<br><br>Same trick, different method. <br><br></td></tr></table><br>
<a name="998236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sokurah</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I also noticed that you have MASKEDIMAGE | MASKEDIMAGE, which is... pointless. Just one MASKEDIMAGE will do, won't it? <br></div><br>Haha, good point. I hadn't noticed. D'oh! :D<br><br><div class="quote"> Oh, one more thing. Instead of grabbing a large image (which is a bit wasteful), it might work out better if you create a small, solid black image, draw the original game screen, then the black image over the top with DrawImageRect, with increasing alpha. <br></div><br>Not a bad idea. I'll try that.<br><br>Thanks for the help. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
