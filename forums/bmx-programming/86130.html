<!DOCTYPE html><html lang="en" ><head ><title >Is external C code slower ?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Is external C code slower ?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Is external C code slower ?</a><br><br>
<a name="975525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi<br><br>I'm using Ease Equations for every Tweening effects of my game.<br>For practical reasons every Tweening functions are store in a C file and called externally.<br><br>The most used function is a very simple Linear code :<br><br><pre class=code>double LinearTweening(double t, double b, double c, double d)
{
	return c*(t/=d) + b;
}</pre><br><br>1) Do you think it would be faster to directly convert this function to BlitzMax ?<br><br>2) Equations use Double precision numbers but most of the tweened values are Float.<br>I suppose that implicitly casting <b>from float to double</b> then <b>from double to float</b> is slow and maybe useless ?<br>I don't know if Tweening Equations really need Double precision.<br><br>What do you think ?<br><br>Thanks <br><br></td></tr></table><br>
<a name="975527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 1) No, I don't think so. The compilers are different but they both use the same linker and assembler so the only reason I can think of which would make it faster is if the BlitzMax compiler were more optimized than the GCC one. I doubt that's the case. I suspect they're both pretty similar actually. I wrote all mine in BlitzMax but I very much doubt they're faster than yours.<br><br>2) I don't see any need for double precision here, no. Even less so if you're going to be using single precision most of the rest of the time. I implement all my tweening functions with single precision, and they're fine for my purposes. Why not implement two versions and use the double precision versions only if you find a need for them later. It can't be much work to copy and paste all those functions and then run a find and replace to switch double for float. <br><br></td></tr></table><br>
<a name="975534"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Do you think it would be faster to directly convert this function to BlitzMax ? <br></div><br>Well, you might want to try it with a normal build and with the compiler optimisations ramped up to full, as well as in BlitzMax code.<br>Benchmarking will give you an idea which is better. I doubt there'd be too much difference unless you are doing a lot of math - in which case the C might optimise well for FPUs. (SSE/SSE2/etc) <br><br></td></tr></table><br>
<a name="975551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks<br>Following your advices Brucey I did a quick and rough Bench and here the result for 10.000.000 calls<br><pre class=code>
BlitzMax Double: 0.34431778340543279
BlitzMax Float: 0.17504291746576731
BlitzMax Float Casting Double: 0.34422810720356917

C Double: 0.30186210817296610
C Float: 0.18841137630620652
C Float Casting Double: 0.31622594491758033</pre><br><br>Value differs from time to time but the Float BlitzMax converted function is always faster than any others.<br>Using Double or Float to Double Casting cost is x2 but still trivial for 10 millions calls (I doubt I'm calling Tweening functions more than 5000 even with my particles engines).<br><br>I will transform my Tweening code to Float precision as you suggest Gabriel and convert my Linear Function in BlitzMax since it's a bit faster.<br><br>Thanks for your suggestion :) <br><br></td></tr></table><br>
<a name="975564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Armitage 1982</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> With QueryPerformanceCounter I see nearly no differences between a tweening engine in Float or in Double mode event by using a BlitzMax Linear function :)<br>So no real differences but good to know just in case :) <br><br></td></tr></table><br>
<a name="975835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I also noticed this when writing my physics engine, I assumed c would be faster so I put all of the maths in a c lib and compiled it and it ran much slower than it did in bmax... but maybe thats because I had to use cos, sin, atan(y/x)  and sqrt a lot <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
