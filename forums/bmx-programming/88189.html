<!DOCTYPE html><html lang="en" ><head ><title >Match-3 code</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Match-3 code</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Match-3 code</a><br><br>
<a name="1001129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tri|Ga|De</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to try an make a Match-3 game, I know is boring, but I have got a good idea for the game.<br><br>Now I ran into trouble with the match algoritme! Any one have some source to help me getting started.<br><br>I have a grid of 20x20 and want to check for match 3 og more. And I only need to match horizontally and vertically.<br><br>Anything that can get me started would be nice (sourcecode) <br><br></td></tr></table><br>
<a name="1001130"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a basic match-3 game in the BlitzMax samples. Maybe you can take a look to that source code. It is the tiledrop sample. <br><br></td></tr></table><br>
<a name="1001148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Work out a pseudo code algorithm first and then test it out, something like:<br><br>- Start in top left corner.<br>- Store the value of the current item<br>- Horizontal testing: Move right to the next tile.  If the value doesn't match, move onto the vertical testing below.  If it does match, keep going right.  When you either reach a non-matching item or the right edge, you can see if the number of matches is 3 or greater.  I used to store the matches in a separate grid array so I could explode them all at once later.<br>- Vertical testing: Move down to the next tile.  Test for a match or hitting the bottom of the grid etc.  Pretty much the same as horizontal testing.<br><br>That's it, it's pretty easy.<br><br>What is harder is testing for *possible* matches that a player could make.  That algorithm needs a lot more work.  Then when you start to introduce locked items, gaps, falling shapes, bonuses etc it gets even more complex. <br><br></td></tr></table><br>
<a name="1001156"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What is harder is testing for *possible* matches that a player could make. That algorithm needs a lot more work. Then when you start to introduce locked items, gaps, falling shapes, bonuses etc it gets even more complex. <br></div>I thought that the worst bit was getting it to check for matches and let the player take a turn and all the rest of it, when tiles are already moving/falling.<br><br>There was a thread recently where somebody was complaining along the lines of "are Match Three games all Blitzmax is capable of" - like match three games are some sort of irrelevant easy-to-write bile.  Its straightforward to write a working prototype but its difficult to get it to play <i>well</i>.<br><br>I started mine two years ago (don't ask), and up until about a month ago its had a bug that I just couldn't get to the bottom of.  I thought I'd fixed it at least half a dozen times, but then it appeared again.  One of those "once in a blue moon" bugs.  I ended up spending a day rewriting several of the major code functions and using a totally different implementation of keeping track of everything.  Its rock solid now.<br><br>&lt;/tangent&gt;<br><br>Anyway, following on from what Jake said, my code keeps track of what's moved/been moving and only check for matches where those tiles can affect things.  There's little point in checking for matches on whole sections of tiles that haven't gone anywhere. <br><br></td></tr></table><br>
<a name="1001168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have a source code for the one Qube(David Templer) did in my download's link. If you want to take a look at it. I think it's comercial quality.<br><br><a href="http://www.filefront.com/12217541/holiday-swapz-BMX-sourcem3.zip" target="_blank">http://www.filefront.com/12217541/holiday-swapz-BMX-sourcem3.zip</a> <br><br></td></tr></table><br>
<a name="1001169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Acually I hate to toot my own horn, but this would be extremely easy in TileMax..<br><br>Basically, when a piece moved all you would have to do is test to see if adjacent tiles contain like item id's and if the count is sufficient Start the fireworks!<br><br>In TileMax.. <br><br>All tiles are referenced relatively... connected in 9 directions xy (-1 to 1)+1<br>Something like...<br><br><pre class=code>
Function Match(ID:Int=ID_GREENGEM, MT:TMTile)
   Local Count=0
   For X:int=0 to 2
     For Y:int=0 to 2
        if x=1 and y=1
            ' This equates to a tiles warp point
        Else
            If MT.Nav(x,y) and MT.Nav(x,y).Actors
               if MT.Nav(x,y).Actors.First().ID=ID
                   Count:+1
               Endif
            EndIF
        Endif
     Next
     If Count&gt;2 LetTheFireworksGo()
   Next
End Function
</pre> <br><br></td></tr></table><br>
<a name="1001172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Besides the match 3 source included with BM, there have been two complete match 3 games that have had the source released and one half-assed (sorry Chroma) attempt that had the source released. <br><br></td></tr></table><br>
<a name="1001217"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> There was a thread recently where somebody was complaining along the lines of "are Match Three games all Blitzmax is capable of" - like match three games are some sort of irrelevant easy-to-write bile. Its straightforward to write a working prototype but its difficult to get it to play well. <br></div>100% agree here.  I saw that comment too.  As well as the mechanics, a commercial quality match-3 will test blitzmax out in many other ways. <br><br></td></tr></table><br>
<a name="1001222"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Amon</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> TomToads full match 3 engine with source (blitzmax).<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=70555#792829" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=70555#792829</a> <br><br></td></tr></table><br>
<a name="1001263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tri|Ga|De</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks alot guys! <br><br></td></tr></table><br>
<a name="1001272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Qube also released the source to his Christmas match-3 game <br><br></td></tr></table><br>
<a name="1001287"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Qube also released the source to his Christmas match-3 game<br> <br></div><br>really? ;) <br><br></td></tr></table><br>
<a name="1001295"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> really? ;) <br></div>Yes and it was commercial grade, ready for release.  Qube had posted it on his forums. <br><br></td></tr></table><br>
<a name="1001321"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> LOL<br>I was being sarcastic look at post #5 <br><br></td></tr></table><br>
<a name="1001336"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Qube</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Qube also released the source to his Christmas match-3 game<br> <br></div><br><br>I did? oh no, quick grab it back! :p<br><br>Before anyone asks, no, you're not getting your mitts on the vastly improved match-3 engine which accompanies the iPhone version of holiday swapz (<a href="http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=343928165&amp;mt=8" target="_blank">available in all good stockists</a>) :D <br><br></td></tr></table><br>
<a name="1001342"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Qube<br>if you don't want me to have It available I can take it of my filefront download. I just thought it might be helpful for other trying to understand the logic behind it. No harm intended. <br><br></td></tr></table><br>
<a name="1001346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Qube</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>if you don't want me to have It available I can take it of my filefront download. I just thought it might be helpful for other trying to understand the logic behind it. No harm intended.<br> <br></div><br><br>I was joking, hence the :p - The old PC version of Holiday Swapz I released as public domain so it's good there's a backup :) <br><br></td></tr></table><br>
<a name="1001350"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I was being sarcastic look at post #5 <br></div><br><br>Gotcha, I mised that one ;) <br><br></td></tr></table><br>
<a name="1002144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tri|Ga|De</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can't get it right, I mean I can find 3(or more) in a row/col, but I want to find "1" like in ex 1.<br><br>Ex 1.<br>000000000<br>000000000<br>000011100<br>000000110<br>000000000<br><br>Look at ex 1, I want to find all "1" in the grid, that touched. I try to figure it out but I can't get IT!!<br><br>Any help would be very nice. <br><br></td></tr></table><br>
<a name="1002145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> What you're asking for is the equivalent of a 'flood fill' function, which basically boils down to using recursion.<br><br>Pseudocode:<br><pre class=code>
Find the first tile in the grid (i.e 5,2)
Set its 'marked' flag to True
Call Search() function

'when you get to here, all '1' tiles will be marked

Iterate through <b>all</b> tiles
Remove any with 'marked = true'


Function Search()
  Check all four adjoining tiles
  If they're the same value (i.e. 1) AND tile.marked = False
    Set its 'marked' flag to True.
    Call Search() function.
  EndIf
EndFunction
</pre> <br><br></td></tr></table><br>
<a name="1002571"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tri|Ga|De</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks GFK it works now.<br><br>I finally got it to work, thanks everyone!<br>Heres my code if anyones interested, it proberly could be optimized but for now it should work. It checks for matching fields that touch.<br><br>Remark to code:<br>PlayField is playfield<br>CheckArray is filled with PlayField values for testing<br>Marked is to mark fields to remove<br>Nabors just checks for nabors.<br><br><pre class=code>


	Graphics 1024, 768

	Global Rows:Int = 20
	Global Cols:Int = 20	
	Global PlayField:Int[Rows, Cols]
	Global CheckArray:Int[Rows, Cols]
	Global Marked:Int[Rows, Cols]
	Global Nabors:Int[Rows, Cols]
	Global CountingYs:Int = 0
	Global ones:Int = 0

	'** Place random values in playfield
	PlaceRandomFields(50, 6, 7, 13)

	'** Fyld arrays
	FillArraysWithZero()
	'InsertDataIntoPlayField()
	CopyFromPlayFieldIntoCheckArray()

	While Not KeyHit(KEY_ESCAPE)
		Cls
		DisplayCheckArray(100, 40)
		DisplayNabors(500, 40)
		DisplayMarked(100, 420)
		DisplayPlayField(500, 420)
				
		If KeyHit(KEY_SPACE) And ones=0
			For Local ys:Int=1 To 6
				RemoveNonCheckTiles(ys)
				FindAndRemoveStandAloneTiles(ys)
				FindFirstTitle(ys)
				FindAndRemoveTwos(ys)
				RemoveFromPlayField()

				FillArraysWithZero()
				CopyFromPlayFieldIntoCheckArray()
			Next

 			ones=1
		End If

		If KeyHit(KEY_TAB)
			FillArraysWithZero()
			PlaceRandomFields(50, 6, 7, 13)
			'InsertDataIntoPlayField()
			CopyFromPlayFieldIntoCheckArray()
			ones = 0
		End If

		'** Flip
		Flip -2

	Wend
	
'*********************************************
'* Function: Remove fields not to be checked *
'*********************************************
Function RemoveNonCheckTiles(checkTile:Int)
	For Local x:Int=0 To Rows-1
		For Local y:Int= 0 To Cols-1
			If CheckArray[x, y] &lt;&gt; checkTile Then CheckArray[x,y] = 0
		Next
	Next	
	
End Function	
'****************************************************
'* Function: Fill CheckArray with PlayField         *
'****************************************************
Function CopyFromPlayFieldIntoCheckArray()
	'** Copy PlauField into CheckArray
	For Local x2:Int=0 To Rows-1
		For Local y2:Int= 0 To Cols-1
			CheckArray[x2,y2] = PlayField[x2, y2]
		Next
	Next	
End Function

'********************************************
'* Function: Fill arrays with zeros         *
'********************************************
Function FillArraysWithZero()
	For Local x:Int=0 To Rows-1
		For Local y:Int= 0 To Cols-1
			CheckArray[x,y] = 0
			Marked[x,y] = 0
			Nabors[x,y] = 0
		Next
	Next	
End Function

'********************************************
'* Function_ Find first nabor field         *
'********************************************
Function FindFirstTitle(tileType:Int)
	Local tileValue:Int
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			tileValue = CheckArray[x,y]
			If tileValue = tileType
				Marked[x,y] = 1
				SearchTiles(x,y, tileType)
			End If	
		Next
	Next	
End Function

'************************************************************************
'* Function: Loop through all fields to find who has nabors             *
'************************************************************************
Function SearchTiles(x:Int, y:Int, tileType:Int)
	If CountingYs = 0 Then
		y = y + 1
		If y &gt; Cols-1 Then
			x = x + 1
			If x &gt; Rows-1 Then x = 0
			y = 0
		End If
	End If
	If CheckArray[x,y] = tileType And checknabors(x, y) And Marked[x,y] = 0
		Marked[x,y] = 1
		SearchTiles(x,y, tileType)		
	End If
End Function

'****************************************************
'* Function: Remove all '1' in Nabors and Marked    *
'****************************************************
Function FindAndRemoveTwos(tileType:Int)
	Local naborTiles:Int
	
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			'** We found a match
			If CheckArray[x, y] = tileType
				'** Its got match from side fields
				naborTiles = checknaborsTwo(x,y)
				If naborTiles &lt;&gt; 0
					If naborTiles = 1 Or naborTiles = 2 Or naborTiles= 4 Or naborTiles = 8 Then Nabors[x,y] = 1
					If naborTiles = 3 Or naborTiles = 6 Or naborTiles = 12 Or naborTiles = 9 Or naborTiles = 10 Or naborTiles = 5 Then Nabors[x,y] = 2
					If naborTiles =7 Or naborTiles = 14 Or naborTiles= 13 Or naborTiles = 11 Then Nabors[x,y] = 3
					If naborTiles = 15 Then Nabors[x,y] = 4
				End If
			End If
		Next
	Next
	
	'** Loop through Nabors, find all '2' and make next '1' field to '2'
	Local numberTwoTiles:Int
	Local naborTilesOfOnes:Int
	
	For Local x2:Int=0 To Rows-1
		For Local y2:Int=0 To Cols-1
			numberTwoTiles = Nabors[x2, y2]		
			'** We found a double
			If numberTwoTiles = 2 Or numberTwoTiles = 3 Or numberTwoTiles = 4
				If Nabors[x2+1,y2] = 1 Then Nabors[x2+1,y2]=2
				If Nabors[x2-1,y2] = 1 Then Nabors[x2-1,y2]=2
				If Nabors[x2,y2+1] = 1 Then Nabors[x2,y2+1]=2
				If Nabors[x2,y2-1] = 1 Then Nabors[x2,y2-1]=2
			End If
		Next
	Next
	
	'** Remove all double '1' in Marked
	Local numberOneTiles:Int

	For Local x3:Int=0 To Rows-1
		For Local y3:Int=0 To Cols-1
			numberOneTiles = Nabors[x3, y3]
			If numberOneTiles = 1
				Marked[x3,y3] = 0
			End If	
		Next
	Next				 	
End Function

'*************************************************
'* Function: Remove all '1' fields in CheckArray *
'*************************************************
Function FindAndRemoveStandAloneTiles(tileType:Int)
	Local checknabor:Int
	Local tilevalue:Int
	Local in3x:Int = False
	Local in3y:Int = False

	'** Gennemgå array og fjern single tal	
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			tilevalue = CheckArray[x,y]
			If tilevalue &lt;&gt; 0 '** Onlu check if current field is different from zero
				checknabor = checknabors(x,y)
				If checknabor = False
					CheckArray[x,y] = 0
				End If
			End If
		Next
	Next
	
End Function

'********************************************
'* Function: Check next fields              *
'********************************************
Function checknabors:Int(xpos:Int, ypos:Int)
	Local zeros:Int = 0
	Local checkvalue:Int
	
	'** Checks if next x is zero
	If xpos &lt;=Rows-1 '** Only if its not the last
		checkvalue = CheckArray[xpos+1, ypos]
		If  checkvalue &lt;&gt; 0
			zeros = zeros + 1
		End If
	End If
	
	'** Check if previous x is zero
	If xpos &gt;= 1 '** Only if its not the first one
		checkvalue = CheckArray[xpos-1, ypos]
		If checkvalue &lt;&gt; 0
			zeros = zeros + 1
		End If
	End If
		
	'** Check if next y is zero
	If ypos &lt;= Cols-1 '** Only if its not the last
		checkvalue = CheckArray[xpos, ypos+1]
		If checkvalue &lt;&gt; 0
			zeros = zeros + 1
		End If
	End If

	'** Check if previous y is zero
	If ypos &gt;= 1 '** Only if its not the first one
		checkvalue = CheckArray[xpos, ypos-1]
		If checkvalue &lt;&gt; 0
			zeros = zeros + 1
		End If
	End If
	If zeros = 0
		Return False
	Else
		Return True	
	End If
End Function

'*****************************************************
'* Function: Check all next to '2' field in Nabors   *
'*****************************************************
Function checknaborsTwo:Int(xpos:Int, ypos:Int)
	Local zeros:Int = 0
	Local checkvalue:Int
	
	'** Checks if next x is zero
	If xpos &lt;=Rows-1 '** Only if its not the last
		checkvalue = CheckArray[xpos+1, ypos]
		If  checkvalue &lt;&gt; 0
			zeros = zeros + 2
		End If
	End If
	
	'** Check if previous x is zero
	If xpos &gt;= 1 '** Only if its not the first one
		checkvalue = CheckArray[xpos-1, ypos]
		If checkvalue &lt;&gt; 0
			zeros = zeros + 8
		End If
	End If
		
	'** Check if next y is zero
	If ypos &lt;= Cols-1 '** Only if its not the last
		checkvalue = CheckArray[xpos, ypos+1]
		If checkvalue &lt;&gt; 0
			zeros = zeros + 4
		End If
	End If

	'** Check if previous y is zero
	If ypos &gt;= 1 '** Only if its not the first one
		checkvalue = CheckArray[xpos, ypos-1]
		If checkvalue &lt;&gt; 0
			zeros = zeros + 1
		End If
	End If
	If zeros = 0
		Return 0
	Else
		Return zeros	
	End If
End Function

'**********************************
'* Function: Place random fields  *
'**********************************
Function PlaceRandomFields(numberOfFields:Int, maxNumber:Int, startGrid:Int, endGrid:Int)
	Local randomX:Int, randomY:Int, fieldValue:Int
	
	For Local x:Int = 1 To numberOfFields
		randomX = Rand(startGrid,endGrid)
		randomY = Rand(startGrid,endGrid)
		fieldValue = Rand(1,maxNumber)
		PlayField[randomX, randomY] = fieldValue		
		'CheckArray[randomX, randomY] = fieldValue		
	Next
End Function

'**********************************************
'* Function: Remove from PlayField via Marked *
'**********************************************
Function RemoveFromPlayField()
	For Local x:Int = 0 To Rows-1
		For Local y:Int = 0 To Cols-1
			If Marked[x, y] = 1 Then PlayField[x, y] = 0
		Next
	Next	
End Function

'****************************************
'* Function: Insert data into PlayField *
'****************************************
Function InsertDataIntoPlayField()
	PlayField[6,1] = 1
	PlayField[7,1] = 1
	PlayField[8,1] = 1

	PlayField[10,1] = 1
	
	PlayField[1,4] = 2
	PlayField[1,5] = 2
	PlayField[1,6] = 2

	PlayField[5,3] = 3
	PlayField[6,3] = 3
	PlayField[7,3] = 3
	PlayField[7,4] = 3
	PlayField[8,4] = 3
	
	PlayField[5,13] = 4
	PlayField[6,13] = 4
	PlayField[7,13] = 4
	PlayField[7,14] = 4
	PlayField[8,14] = 4

	PlayField[5,7] = 5
	PlayField[6,7] = 5
	PlayField[7,7] = 5
	PlayField[7,8] = 5
	PlayField[8,8] = 5

	PlayField[5,10] = 6
	PlayField[6,10] = 6
	PlayField[7,10] = 6
	PlayField[7,11] = 6
	PlayField[8,11] = 6

	PlayField[12,12] = 6
	PlayField[12,13] = 6
	PlayField[12,14] = 6
End Function

'********************************************
'* Function: Show CheckArray                *
'********************************************
Function DisplayCheckArray(startXPos:Int, startYPos:Int)
	DrawText "CheckArray", startXpos, startYPos-16
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			If CheckArray[x,y] &lt;&gt; 0
				DrawText CheckArray[x,y], startXPos + x * 16, startYPos + y * 16
			End If
		Next
	Next	
End Function

'********************************************
'* Function: Show PlayField                 *
'********************************************
Function DisplayPlayField(startXPos:Int, startYPos:Int)
	DrawText "PlayField", startXpos, startYPos-16
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			If PlayField[x,y] &lt;&gt; 0
				DrawText PlayField[x,y], startXPos + x * 16, startYPos + y * 16
			End If
		Next
	Next	
End Function

'********************************************
'* Function: Show Marked fields             *
'********************************************
Function DisplayMarked(startXPos:Int, startYPos:Int)
	DrawText "Marked", startXpos, startYPos-16
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			If Marked[x,y] &lt;&gt; 0
				DrawText Marked[x,y], startXPos + x * 16, startYPos + y * 16
			End If
		Next
	Next	
End Function

'********************************************
'* Function: Show Nabors fields             *
'********************************************
Function DisplayNabors(startXPos:Int, startYPos:Int)
	DrawText "Nabors", startXpos, startYPos-16
	For Local x:Int=0 To Rows-1
		For Local y:Int=0 To Cols-1
			If Nabors[x,y] &lt;&gt; 0
				DrawText Nabors[x,y], startXPos + x * 16, startYPos + y * 16
			End If
		Next
	Next	
End Function

</pre> <br><br></td></tr></table><br>
<a name="1002677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tri|Ga|De</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> I put up my final code!! <br><br></td></tr></table><br>
<a name="1004464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> @GaryV: you must not have followed that old thread fully.  It was working great and I got a lot of compliments on it.  But I got bored because Match-3 is no challenge.  And it's not commercially viable these days anyways imo.<br><br>Most people here are trying to make a game they can turn a quick profit on.  I'm more into making something unique.  I look at coding as a means of expression.  Not turning a quick buck. <br><br></td></tr></table><br>
<a name="1004465"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> @GaryV: you must not have followed that old thread fully. <br></div>I was it showed the initial promise of your game framework and quickly suffered the same fate as your game framework ;)<br><br><div class="quote"> Most people here are trying to make a game they can turn a quick profit on. I'm more into making something unique. I look at coding as a means of expression. Not turning a quick buck. <br></div>I agree 100% <br><br></td></tr></table><br>
<a name="1004468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Everyone please welcome GaryV as the newest member of the Chroma fan club! :)<br><br>And what sir have YOU finished/released?  hehe<br><br>TriGaDa:  Are you scanning through the whole lists and storing matches and popping all present matches at the same time? (Didn't look) <br><br></td></tr></table><br>
<a name="1004525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Tri|Ga|De</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> I take the play array and make an new array with the tiles I want to check.<br>Then I deletes all single tiles.<br>Then I make an new array where i put in how many nabors each tile have.<br>Compare two arrays and delete all tiles with only 1 nabor.<br><br>BUT my code has an error, it can not check border tiles.<br>So en a 20x20 grid it can only check from 2 to 19. <br><br></td></tr></table><br>
<a name="1004537"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Everyone please welcome GaryV as the newest member of the Chroma fan club! :) <br></div>I actually am, get the chip off your shoulder.  I was really looking forward to your game framework.  IMHO, it was the only one that showed promise after Gray's was pulled off the market. <br><br></td></tr></table><br>
<a name="1004564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Chroma</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah ok...sorry then.  I guess I'm a defensive product of the mostly negative attitudes around here.<br><br>I haven't been keeping up with the Blitz Community Framework.  How is that one shaping up? <br><br></td></tr></table><br>
<a name="1004608"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Pharmhaus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its running fine thank you for asking. :) <br>Why not helping the Community Framework ? it could be the challenge You are looking for... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
