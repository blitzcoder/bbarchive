<!DOCTYPE html><html lang="en" ><head ><title >Way to detect if window is dragged?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Way to detect if window is dragged?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Way to detect if window is dragged?</a><br><br>
<a name="652957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya, does anyone know a way to detect if a game in windowed mode is being dragged by the title bar?  It seems that when this occurs, the game processing carries on but the screen stops updating, so I'd prefer to detect this and pause the gameplay until the user stop dragging/repositioning.  Thank. <br><br></td></tr></table><br>
<a name="652962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, and I posted the details on this forum about 2 weeks ago. <br><br></td></tr></table><br>
<a name="652967"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> if AppSuspended() <br><br></td></tr></table><br>
<a name="652971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm, I searched seems I need to look again.  Indiepath, any idea of a useful keyword to search for? [edit] Think I found it: <a href="http://www.blitzbasic.com/Community/posts.php?topic=56194#624955" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=56194#624955</a> but that's just a module hack that prevents the user from dragging.  I don't want to prevent dragging, just find out when it's occuring (or better still when it's stopped) so I can reinitialise my Fixed Logic Timers to avoid jumping.  The same issue would occur for Delta Timing too I'm sure.<br><br>I'm already using AppSuspended.  That works if the game is minimised or the focus is lost (another window is clicked) but NOT if the window is dragged by the user! <br><br></td></tr></table><br>
<a name="653000"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah sorry Grey I can still never find stuff even though they have changed the search engine.<br><br>You could use my code to set a flag that causes your timing loops to pause. This is where it's all happening.. <br><br></td></tr></table><br>
<a name="653012"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks, I'll try that later if time.<br><br>Meanwhile anyone got any other ideas? <br><br></td></tr></table><br>
<a name="653016"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Grey, This is how you do it. <br><br></td></tr></table><br>
<a name="653017"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol, well I haven't even comprehended what your code/hack does yet and if it'll work until I try it.  In Delphi for example, you can tell if the user is moving the window and take action afterwards.  So windows does allow it to be monitored, perhaps that is what your code does, I just haven't taken it in yet. <br><br></td></tr></table><br>
<a name="653023"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm basically capturing the windows messages and acting on them.<br><br>You can probably do it by Peeking the message queue. <br><br></td></tr></table><br>
<a name="653055"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> This seems like an utterely pointless thing to pay attention to. You are so going to miss your deadlines. <br><br></td></tr></table><br>
<a name="653058"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol, I'm not looking into it right now.  I just noticed it and made a note to post on the forums in case anyone had an easy solution.  Meanwhile it's sitting on my to do as low priority.<br><br>The thing is, if someone moves your game window as it's playing, the game processing stops, yet time moves on in the real world, so when the game retains focus, the Fixed Rate Logic thinks tons of time has passed and catches it all up in a single frame causing a "jump" in gameplay.  Of course not that many people will do this or care, but it's not ideal.<br><br>In fact a bigger related issue is that, have you noticed that if you drag a Max Window slightly off screen and back on, you get a totally corrupted window with bits of the task bar and itself repeated all over it? (try moving diagonally or in a circle!)<br><br>Anyway, what I'm gradually doing is solving a whole pooload of boring technical issues with BlitzMax and Windows generally so I can have a really solid game framework to put all future games in.  Then I might also sell it to interested parties so they don't have to go through the same pain I have had to! <br><br></td></tr></table><br>
<a name="653110"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am sure your gamesplayers are gonna be dragging that window in circles instead of playing your undoubtedly fascinating game :) <br><br></td></tr></table><br>
<a name="653111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> lol, yeah OK, but it's not 100% cool.  All these little things add up to the game looking less professional. <br><br></td></tr></table><br>
<a name="654169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK so I checked out Indiepath's code and all it does is prevent the user from dragging the window in DirectX and OpenGL.  I'd like to allow users to drag and either not freeze program execution, or detect when a drag has occured and ended to reset the game timer to avoid big skips.  Anyone done this sort of thing before?<br><br>Hmm idea: could monitor the x and y coords of the window and do this before the timing loop starts and when changed reset the timer!  This still won't prevent the graphics window from "smearing" horribly as the user drags the window around.<br><br>Thanks. <br><br></td></tr></table><br>
<a name="654247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think your game processing is being halted and your timing routine is actually the problem (should reset itself if it detects it has just suffered a long pause)? eg:<br><pre class=code>
Graphics 640,480,0
t=MilliSecs()
While PollEvent()&lt;&gt;EVENT_APPTERMINATE
	SetClsColor Rnd(255),Rnd(255),Rnd(255)
	Cls
	Flip
	tt=MilliSecs()
	If tt-t&gt;200 Print "resetclock"
	t=tt
Wend
End
</pre> <br><br></td></tr></table><br>
<a name="654289"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Skidracer, it already reset it self after 500ms, but I've reduced this now.  What I was really looking for was a neat way of doing it by detecting that the window had been moved.  I also tested the code in BlitzPlus and it halts program execution too, but if you move the window off screen, it doesn't "smear" itself with the taskbar and other graphics unlike BlitzMax.<br><br>Well I just wrote a mini app in Delphi to test if program execution is halted in other languages when the tile bar is click, and it is.  Although delphi doesn't "Smear", this must be a 3D card effect I guess. <br><br></td></tr></table><br>
<a name="654306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> In the end I check the window position before the timing loop begins, and if the position has changed I reset the timing variables:<br><br><pre class=code>
Type TRect
	Field L%, T%, R%, B%
End Type

Function ccWindowPosition:TRect()
	Local hWnd% = GetActiveWindow()
	Local window:TRect= New TRect
	GetWindowRect(hWnd,window)
	Return window	
End Function

'Quickly check to see if the window has moved.
'If it has, this is because the user has dragged it and so we should
'reset the timing variables.
Local Rect:TRect = ccWindowPosition()
If Owner.WindowX &lt;&gt; Rect.L Or Owner.WindowY &lt;&gt; Rect.T Then
        Init() 'reset timing variables
	Owner.SetWindowCoords()
EndIf

</pre> <br><br></td></tr></table><br>
<a name="654369"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Robert Cummings</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> good thinking <br><br></td></tr></table><br>
<a name="654390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought so, esp. as it actually works ;-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
