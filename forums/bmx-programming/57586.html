<!DOCTYPE html><html lang="en" ><head ><title >UDP example</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >UDP example</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >UDP example</a><br><br>
<a name="640464"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have a working UDP example?<br><br>Nothing in Code archives. I searched, found nothing except people trying to get UDP to work.<br><br>Any help here?<br><br>Thanks :D <br><br></td></tr></table><br>
<a name="640484"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Moogles</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> depends on what your trying to do. i think blitmzax can only communicate with its own udp sockets rather than universal ones.<br>read my post.<br><a href="http://www.blitzmax.com/Community/posts.php?topic=57391" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=57391</a><br>its got a basic example of making udp work. but i think it can only connect to another blitzmax app and send and recieve. <br><br></td></tr></table><br>
<a name="640486"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I can receive as a server, but I cant narrow it down to what IP:port im getting it from. I cant send as server.<br><br>I can send as client, and I believe receive although I cant test receiving.<br><br>=/<br><br>Kinda odd, how theres no UDP code archives at all, nothing. <br><br></td></tr></table><br>
<a name="640498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Moogles</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use SocketRemoteIP( socket:TSocket )<br>on the socket that the client is connected to. i think thats the one. the name makes it seem the logical thing to use. although im not sure. <br><br></td></tr></table><br>
<a name="640695"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Regular K</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That only returns an IP though, can't set it.<br><br>I can send to a server, use ConnectSocket. Then just write to the socket stream.<br><br>That's not too UDP like :P Can't switch to a different IP without having to destroy the socket and stream. <br><br></td></tr></table><br>
<a name="640867"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Moogles</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> make a new connection with a new socket and stream. ;) <br><br></td></tr></table><br>
<a name="640913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't try to use socket streams with UDP sockets, it just isn't going to work.<br><br>Either use one of the freely available networking modules available (BMax includes one, well, two really as GNet is a high level mod based on the <a href="http://enet.cubik.org/" target="_blank"><b>enet</b></a> mod), or use raw sockets.<br><br>It really depends on what you're trying to do. <br><br></td></tr></table><br>
<a name="640955"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Moogles</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> or use raw sockets <br></div><br>and how would we do that sir? :) <br><br></td></tr></table><br>
<a name="640963"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vertex</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use my BNetEx <a href="http://vertex.art-fx.org/bnet/bnetex162.zip" target="_blank">http://vertex.art-fx.org/bnet/bnetex162.zip</a> (object orientated)<br>or BNet <a href="http://vertex.art-fx.org/bnet/bnet160.zip" target="_blank">http://vertex.art-fx.org/bnet/bnet160.zip</a> (BlitzBasic like)<br>Examples are includet.<br><br>You can use the code too, to understand, how udp work with BMax.<br><br>Raw Sockets are not easy to use.<br><br>cu olli <br><br></td></tr></table><br>
<a name="640994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I said 'raw sockets', I meant via the BMax sockets module as this makes things easier. I'm by no means an expert with sockets but they seem fairly straight forward, it could well be a case of 'ignorance is bliss' thought.<br><br>@Moogles - As you asked so nicely, here's simple example you may recognise... ;o)<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

Framework BRL.Basic
Import BRL.socket
Import BRL.standardio


Local socket:TSocket = CreateUDPSocket()

If socket = Null Then RuntimeError "Couldn't create UDP socket"

If ConnectSocket(socket, HostIp("83.149.87.203"), 7778) = False Then RuntimeError "Couldn't connect to server"

SWriteLine socket, "\info\"

Print DottedIP(SocketRemoteIP(socket)) + " : " + SocketRemotePort(socket)
Print

Local info$ = SRead$(socket)

Print info.length + " : " + info$

socket.Close()

End


Function SRead$(socket:TSocket)
	Local buf:Byte[1024]
	Local receivedLen = socket.Recv(buf, 1024)
	
	Return String.FromBytes(buf, receivedLen)
End Function	

Function SWriteLine(socket:TSocket, str$)
	Local buf:Byte Ptr = (str$ + "~r~n").ToCString()
	Local sent = socket.Send(buf, str.length + 2)

	MemFree buf
	
	Return sent = (str.length + 2)
End Function</textarea><br>A more 'correct' way is probably something like...<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

Framework BRL.Basic
Import BRL.socket
Import BRL.standardio

Local socket:TSocket = CreateUDPSocket()

If socket = Null Then RuntimeError "Couldn't create UDP socket"

SWriteLine(socket, "83.149.87.203", 7778, "\info\")

Local info$ = SRead$(socket, "83.149.87.203", 7778)

Print info.length + " : " + info$

socket.Close()

End


Function SRead$(socket:TSocket, host$, port, bufferSize=1024)
	Local buf:Byte[bufferSize], rip, rport  
	Local receivedLen, time = MilliSecs()
	
	Repeat
		receivedLen = 0
		Local read = socket._socket
		If socket.Connected()
			Local size = socket.ReadAvail()
			If size
				receivedLen = recvfrom_(socket._socket, buf, size, 0, rip, rport)
				If (rip = HostIp(host$)) And (rport = port) Then Exit
			EndIf
		EndIf	
	Until (MilliSecs() - time) &gt;= 30000
	
	If receivedLen &gt; 0 Then Return String.FromBytes(buf, receivedLen)
End Function	

Function SWriteLine(socket:TSocket, host$, port, str$)
	Local buf:Byte Ptr = (str$ + "~r~n").ToCString()
	Local sent = sendto_(socket._socket, buf, str.length + 2, 0, HostIp(host$), port)

	MemFree buf
	
	Return sent
End Function</textarea><br><br>If you're only going to be doing simple stuff, like above, the network libraries are overkill IMHO. If, however, you're going to be doing anything mildly useful then use one of the libraries (I haven't used BNet myself, but it seems to be very highly rated by those that have). <br><br></td></tr></table><br>
<a name="641077"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Moogles</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> ZOMG!. You made it work!! :P<br>Thanks Ernie! :) <br>Vertex I tried Bnetex too. its nice but it couldnt read that text from the server like enie's example does.<br>thanks ernie! er.. sir! :)<br>[edit] btw the way. your "proper" way doesnt work for that example. :) ill use the improper way thanks :) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
