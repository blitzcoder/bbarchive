<!DOCTYPE html><html lang="en" ><head ><title >To TileImage or Not To TileImage</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >To TileImage or Not To TileImage</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >To TileImage or Not To TileImage</a><br><br>
<a name="900189"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> ATM Im doing a parallax effect with TileImage on a 800x600 screen.<br><br>Ive got 4 images all 800x600:<br><br>Background - jpg<br>1st Mountains - png<br>2nd Mountains -png<br>Ground/Tress - png<br><br>Should I continue using tileimage or should I make the images smaller and draw multiple of them to create the effect?<br><br>Thanks! <br><br></td></tr></table><br>
<a name="900233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wouldn't use TileImage.  Its viewport dependent and you can't rely on that working on all hardware. <br><br></td></tr></table><br>
<a name="900250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for that Gfk....<br><br>I knew that you cant rely on viewports, but didnt know that about TileImage... <br><br></td></tr></table><br>
<a name="900259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, TileImage fills the current viewport with a tiled image.  As I understand it, the problem arises when you're using a viewport that is smaller than the display area, as the bounds of the viewport are ignored on some hardware.<br><br>If you're just filling the entire screen then you *might* be OK - anybody confirm this is correct (or not)?<br><br>However, just as a side-note, you may want to redesign your images so they can be split into 128x128 tiles, and draw it that way.  A lot of hardware gets all funny over non-square, non-base 2 textures.  Plus the way you've done it, is essentially four 1024x1024 textures which equates to 16MB or thereabouts of graphics memory, which is probably inefficient. <br><br></td></tr></table><br>
<a name="900272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool, thanks again Gfk.<br><br>Now does any know of a good image splitter software which keeps alpha for pngs?<br><br>EDIT: Found out the Paint Shop Pro does a nice job with its Export &gt; Image Slicer ;-)<br><br>EDIT 2: What Im I doing!?! Why dont I just load the images up in an animation and split it that way! <br><br></td></tr></table><br>
<a name="900302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Was just gonna post what GfK said about four 800x600 images = 1024x1024 x4 bytes x4 images = 16MB of VRAM. <br><br></td></tr></table><br>
<a name="900318"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What Im I doing!?! Why dont I just load the images up in an animation and split it that way! <br></div>Yep.  That's what I'm doing! ;)<br><br>However you'll soon notice (if not already) that 128 into 800 doesn't go.  Nor does 64.  Or 256.  I'd resize your image so you can divide it by 128 or whatever, then scale it slightly to fit the screen.<br><br>My next game is going to be logically based on 640x480 or 1024x678 to avoid this issue.  Although I said that last time and I still forgot. :) <br><br></td></tr></table><br>
<a name="900474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> What about "cheating" and making the images 100x100, so I have 8 columns and 6 rows? I know its still not efficient, but wont the images just round up to 128x128...<br><br>So that means I would have:<br><br>128 * 128 * 4 bytes * (( 8 * 6 ) * 4) =  12582912 = 13MB of VRAM<br><br>Hmmm... maybe I'll just have 3 layers.... 9MB.... <br><br></td></tr></table><br>
<a name="900476"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you let the API resize to 128x128 then you'll need to enable filtering when you draw or else the scaling will be ugly and pixelly. This is fine, except that you'll need mipmaps to do this, and this will use up approximately 1.5 times the normal amount of VRAM. So 13 will become ~ 20, which is more than the 16 you'd use to load the bigger images. <br><br></td></tr></table><br>
<a name="900482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im not scaling them after spliting them into 100x100 or it wouldnt fit on the 800x600 screen nicely... I just meant the image would round up in VRAM <br><br></td></tr></table><br>
<a name="900503"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Possible problem: if you scrolling using floating point coords do you get any ugly join lines where the anti-aliasing at fractional coords is occuring? <br><br></td></tr></table><br>
<a name="900525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I havent noticed any ugly join lines... yet. It seems to work quite nice.<br><br>I'll post an example tonight.... <br><br></td></tr></table><br>
<a name="900538"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Im not scaling them after spliting them into 100x100 or it wouldnt fit on the 800x600 screen nicely... I just meant the image would round up in VRAM <br></div><br>Sure you are. If you're drawing them at size 100x100 and they're actually 128x128 then either you're scaling them or the UV coordinates are adjusted. In the former case, you most definitely need mipmaps, in the latter, you may or may not, but I suspect you will because it's not a precise pixel perfect operation. <br><br></td></tr></table><br>
<a name="900550"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok... so even if the image size is 100x100 and the memory space it uses is 128x128, then Im scaling them still even though I'm not using the setscale command?<br><br>Im loading the image like this (test .pngis 800x,600):<br><br>image:TImage = loadanimimage("test.png",100,100,0,48)<br><br>and drawing like this:<br><br>Drawimage image , 100, 100, 5 <br><br></td></tr></table><br>
<a name="900552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, I'm not 100% positive what BlitzMax does, but I think it adjusts the UV coordinates to fit. So you're not really scaling, but where those UV coordinates have been adjusted - and because of floating point inaccuracy - that UV coordinate is probably not exactly on a pixel border any more. So the scale is being very slightly offset, and I don't know if it will be enough to make a difference. But if it is ugly, you'll need to load the image with mip maps included. <br><br></td></tr></table><br>
<a name="900555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats cool, thanks for the info. <br><br></td></tr></table><br>
<a name="900584"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Heres the quick example:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">

SuperStrict 

Const screenwidth:Int = 800
Const screenheight:Int = 600

Graphics screenwidth,screenheight,0


Global fighterImage:TImage = LoadImage("fighter.png")
Global bgimage:TImage = LoadAnimImage("bg.png" , 100 , 100 , 0 , 48)
Global bg1image:TImage = LoadAnimImage("bg1.png" , 100 , 100 , 0 , 48) 
Global bg2image:TImage = LoadAnimImage("bg1.jpg" , 100 , 100 , 0 , 48) 

Global bgTiles:Int[8 , 6]
Global bg1Tiles:Int[8 , 6]
Global bg2Tiles:Int[8 , 6]
Global counter:Int = 0

Global bx# = 0 , bx1# = 0, bx2# = 0
Global px# = 100 , py# = 100
Global dx# = 0 , dy# = 0


For Local j:Int = 0 To 5
	For Local i:Int = 0 To 7
		bgTiles[i , j] = counter
		bg1Tiles[i , j] = counter
		bg2Tiles[i , j] = counter
		counter:+1
	Next
Next


While KeyDown(KEY_ESCAPE) = False
	
	logic() 
	draw()
	
Wend

Function logic()
	controlFighter() 
	moveBackground()
End Function	

Function draw() 
	Cls
		drawBackgrounds() 
		drawFighter() 
	Flip	
End Function

Function controlFighter()
	Local eex:Float
	Local eey:Float
	Local ddx:Float
	Local ddy:Float
	
	Local speed:Float = 0.2
	
	eex = MouseX()
	eey = MouseY()
	
	ddx = (eex - px)
	ddy = (eey - py)
	
	Local dist:Float = Sqr(ddx * ddx + ddy * ddy)
	ddx:/dist * speed
	ddy:/dist * speed
	dx = ddx
	dy = ddy	
	
	If PointInSpot(px, py, eex, eey, 3) Then
		dx = 0; dy = 0
	End If	
	
	px:+dx
	py:+dy	
End Function

Function drawFighter() 	
	DrawImage fighterImage, px, py
End Function


Function moveBackground()
	bx:- 2
	bx1:- 1
	bx2:- 0.5	
	If bx &lt; - screenwidth bx = 0	
	If bx1 &lt; - screenwidth bx1 = 0	
	If bx2 &lt; - screenwidth bx2 = 0		
End Function

Function drawBackgrounds()

	For Local i:Int = 0 To 7
		For Local j:Int = 0 To 5
			DrawImage bg2image, bx2 + i * 100, j * 100, bgTiles[i, j]
			DrawImage bg2image, bx2 + screenwidth + i * 100, j * 100, bgTiles[i, j]			
		Next
	Next	

	For Local i:Int = 0 To 7
		For Local j:Int = 0 To 5
			DrawImage bg1image, bx1 + i * 100, j * 100, bgTiles[i, j]
			DrawImage bg1image, bx1 + screenwidth + i * 100, j * 100, bgTiles[i, j]			
		Next
	Next	


	For Local i:Int = 0 To 7
		For Local j:Int = 0 To 5
			DrawImage bgimage , bx + i * 100 , j * 100 , bgTiles[i , j]
			DrawImage bgimage, bx + screenwidth + i * 100, j * 100, bgTiles[i, j]
		Next
	Next

End Function	

Function PointInSpot:Int(x1:Float, y1:Float, x2:Float, y2:Float, radius:Float)
	Local dx:Float = x2 - x1
	Local dy:Float = y2 - y1
	Return Sqr(dx * dx + dy * dy) &lt;= radius
EndFunction
</textarea><br><br><a href="http://therevillsgames.googlepages.com/parallax.zip" target="_blank">http://therevillsgames.googlepages.com/parallax.zip</a><br><br>Its a lot smoother in GA's Framework ;-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
