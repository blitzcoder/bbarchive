<!DOCTYPE html><html lang="en" ><head ><title >Neighbor search algorithm?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Neighbor search algorithm?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Neighbor search algorithm?</a><br><br>
<a name="691791"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys,<br><br>Here is what I am working with right now:<br><br><img src="http://homepages.nyu.edu/~cwg212/tiles.jpg"><br><br>It is an array which consists of block objects. What I am trying to do is to seperate this into color coded regions, where each region consists of 3 more more touching blocks (but not diagonally). <br><br>For example, the red regions will be split up as such:<br><br>region 1:<br><br>[0, 0]  [0, 1]  [1, 0]  [1, 1]  [1, 2]  [2, 1]  [2, 2]<br><br>region 2:<br><br>[3, 0]  [4, 0]  [4, 2]  [5, 0]  [5, 1]  [5, 2]  [6, 1]<br><br>region 3:<br><br>[5, 5]  [6, 5]  [6, 6]<br><br>region 4:<br><br>[8, 9]  [8, 10], [9, 7]  [9, 8]  [9, 9]  [10, 9]  [10, 10]  [11, 9]<br><br>region 5:<br><br>[2, 12]  [3, 12]  [3, 13]  [4, 13]  [5, 13]<br><br>etc... for all of the other colors.<br><br>Anyone have any idea on how to do this? <br><br></td></tr></table><br>
<a name="691852"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> How "intelligent" would you like this to be? I can only imagine it's going to be an order of magnitude more difficult to come up with the most efficient/most intelligent algorithm compared to a more 'hack' algorithm that gets the job done but is slower and 'stupider'.<br><br>Also, are there any rules besides moving each color so that it makes a grouping of 3? Is it desirable to try and make the largest groupings possible, given that doing so takes no more moves than not doing so. Please elaborate on any further rules or desirable/undesirable behavior.<br><br>Lastly, how often is this going to need to be calculated, and how fast do you need the calculation to be? I know I'd be able to offer more help if I knew what kind of guidelines I needed to work with. <br><br>Thanks :) <br><br></td></tr></table><br>
<a name="691858"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Look for HOSHEN - Koppelman (think was written like this) algorithm<br><br>should provide you with a very performatn solution for finding regions of same neighbors <br><br></td></tr></table><br>
<a name="691915"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Aww, trying to come up with your own algorithm is where the fun's at! :)<br><br>Actually, I usually try and come up with an algorithm for any problem, and only *then* see what's out there. Not only does this get you thinking, but this also lets you see how you approach the problem and then later reflect on how you can improve your approach to problems in general. <br><br></td></tr></table><br>
<a name="691943"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kurator</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> i did this in purebasic some time ago, it is simply a recursive routine:<br><br>(srry for german variables)<br><br>VerarbeiteSpielfeld = Functionname<br>farbe = index of color<br>score = to count the amount of stones<br>entfernen = flag if selectet stones should be removed<br>hidden = flag if should be shown<br><br>i used 2 arrays - one for playing (Spielfeld[x,y] and a seconde one for showing Tips to Player (TipSpielfeld[x,y])<br><br><pre class=code>

Procedure VerarbeiteSpielfeld(x.l, y.l, farbe.b, score.l, entfernen.b, versteckt.b)

  If x&lt;0 Or x&gt;#dim_x Or y&lt;0 Or y&gt;#dim_y Or TipSpielfeld(x,y) = -1 Or Spielfeld(x,y) = -1 
      
      ProcedureReturn score.l
  
  Else

    If versteckt.b = 0
      DisplayTransparentSprite(#gfx_tip,x*16+#offset_X,y*16+#offset_y)
    EndIf
    
    TipSpielfeld(x,y) = -1
    
    If entfernen.b = 1
      Spielfeld(x,y) = -1
      ;Debug "Lösche: "+Str(x)+"/"+Str(y)
    EndIf
    
    If y&gt;0 And Spielfeld(x, y-1) = farbe And TipSpielfeld(x, y-1) &lt;&gt; -1 And Spielfeld(x,y-1) &lt;&gt; -1
      score = VerarbeiteSpielfeld(x, y-1, farbe, score+1, entfernen, versteckt.b)
    EndIf
    If x&gt;0 And Spielfeld(x-1, y) = farbe And TipSpielfeld(x-1, y) &lt;&gt; -1 And Spielfeld(x-1,y) &lt;&gt; -1
      score = VerarbeiteSpielfeld(x-1, y, farbe, score+1, entfernen, versteckt.b)
    EndIf
     If y&lt;#dim_y And Spielfeld(x, y+1) = farbe And TipSpielfeld(x, y+1) &lt;&gt; -1 And Spielfeld(x,y+1) &lt;&gt; -1
      score = VerarbeiteSpielfeld(x, y+1, farbe, score+1, entfernen, versteckt.b)
    EndIf   
    If x&lt;#dim_x And Spielfeld(x+1, y) = farbe And TipSpielfeld(x+1, y) &lt;&gt; -1 And Spielfeld(x+1,y) &lt;&gt; -1
      score = VerarbeiteSpielfeld(x+1, y, farbe, score+1, entfernen, versteckt.b)
    EndIf
    
    ProcedureReturn score.l

  EndIf

EndProcedure

</pre> <br><br></td></tr></table><br>
<a name="691948"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jake L.</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ^ Looks like a default FloodFill. Works well unless you're checking big areas. Then you could run into stack-issues. Search Wikipedia for floodfill, there are links to non recursive versions.<br><br>For my puzzle game I use this recursive FF-Algo, too. Too lazy to write a listbased FF, but if anyone has one in store... ;) <br><br></td></tr></table><br>
<a name="691952"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kurator</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> yes, recursion is nothing for big arrays :) <br><br></td></tr></table><br>
<a name="691958"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> The naive approach on that problem, if not interested in see a potential way would be:<br><br>Check all fields for their neighbors and their own "nationality" and see if they are equal.<br>If yes: See if that neighbor field is part of a region. If so, join the region. If not, declare a new region for this and that neightbor<br><br>At least from the given problem that would how I would be doing it, especially as it looks nice and "doable" with more than only 2 dimensions :-) <br><br></td></tr></table><br>
<a name="691976"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> . <br><br></td></tr></table><br>
<a name="692050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all for the info! I'll give your suggestions a try. <br><br></td></tr></table><br>
<a name="692097"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bukky</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey again.<br><br>I tried implementing the 'Flood Fill' algorithm from the Wikipedia article, and it was a lot easier than I had anticipated. Thanks for the suggestion! :)<br><br>There is one problem though....The program tends to crash when I search to the north and to the left O_o<br><br>Here is the code:<br><br><pre class=code>

Method tesRegion(a_color$, x_coord%, y_coord%, region_num%)
		If Container[x_coord, y_coord].getBlockColor$() &lt;&gt; a_color Then Return 
		
		Container[x_coord, y_coord].setRegion(region_num)
		
		If x_coord &gt; 0 Then tesRegion(a_color$, x_coord - 1, y_coord, region_num)
		If x_coord &lt; 13 Then tesRegion(a_color$, x_coord + 1, y_coord, region_num)
		If y_coord &gt; 0 Then tesRegion(a_color$, x_coord, y_coord - 1, region_num)
		If y_coord &lt; 11 Then tesRegion(a_color$, x_coord, y_coord + 1, region_num)

		Return 
		
	End Method 

</pre><br><br>Here are the calls that I made to test the code:<br><br><pre class=code>

Global blockContainer:BContainer = New BContainer

blockContainer.tesRegion(blockContainer.getContBlockColor(6,9), 6, 9, 1)

</pre><br><br>The program doesnt run until I comment out the following lines:<br><br><pre class=code>
If x_coord &gt; 0 Then tesRegion(a_color$, x_coord - 1, y_coord, region_num)

If y_coord &gt; 0 Then tesRegion(a_color$, x_coord, y_coord - 1, region_num)
</pre><br><br>Anyone have any idea regarding what may be going wrong? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
