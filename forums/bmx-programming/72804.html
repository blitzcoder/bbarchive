<!DOCTYPE html><html lang="en" ><head ><title >Getting dll function exports (win32)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Getting dll function exports (win32)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Getting dll function exports (win32)</a><br><br>
<a name="813750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>How can I find all functions stored in a DLL? I need to call some specific functions, but they may or may not have decorated function names, so getProcAddress won't work in all cases.<br><br>In purebasic it is possible to step through the different function names in the DLL (and then doing a string.Find() on the name), how can I do the same in BlitzMax? <br><br></td></tr></table><br>
<a name="813754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> How cleanly does it have to be done?<br><br>You could call pexports from the command line and then parse the .def file it creates.<br><br><pre class=code>
pexports mydll.dll &gt;mydll.def
</pre><br><br>It's not very clean though, because you're going to have a command window popup while you're doing it. I assume you need to programatically grab the function names, right? Like you're letting people write DLL's for a certain purpose and you need your base program to be able to find the names of the functions? <br><br></td></tr></table><br>
<a name="813755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >fredborg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Like you're letting people write DLL's for a certain purpose and you need your base program to be able to find the names of the functions?  <br></div>Yes, exactly. Anything self-contained will do, even simply scanning the .dll file, if someone knows how/where the names are stored. I don't like launching another program to do it. <br><br></td></tr></table><br>
<a name="813777"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> PE files can have an export section, to get at it you need to decode the PE header and read each section.<br><br>Id suggest looking at the source of pexports itself (its a part of mingw so the source is out there).<br><br>Btw, there is a good hex editor that can decode PE files and show you all sections, and their structures (if you want to figure this out yourself hehe :)<br><a href="http://www.mirkes.de/en/freeware/tinyhex.php" target="_blank">Tiny Hexer</a>. a good hex editor is invaluable! <br><br></td></tr></table><br>
<a name="813805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why not call a small PB program and pass that info to Bmax? <br><br></td></tr></table><br>
<a name="813810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="http://msdn2.microsoft.com/en-us/library/ms809762.aspx" target="_blank">http://msdn2.microsoft.com/en-us/library/ms809762.aspx</a><br><br>Take a look at that.  You should be able to get an idea of how to read the exported function table, and from that you should be able to search the exported names. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
