<!DOCTYPE html><html lang="en" ><head ><title >Move TreeViewNode?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Move TreeViewNode?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Move TreeViewNode?</a><br><br>
<a name="721330"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm looking for a way to move a TreeViewNode and all it's child nodes from one part of a TreeView to another. I can do this by recursing the TreeView from the Node on down and Adding new nodes to the new parent node. Then delete the original. That's fine, but I'm just wondering if there's a quicker, easier way to do it. Just wondering whether I can use the inner workings of TreeView's to move the TreeViewNode from one parent to another without creating and destroying the nodes.<br><br>If I remove it from the Kids list of one and add it to the kids list of another, is that sufficient? Or do I need to do more? <br><br></td></tr></table><br>
<a name="721332"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldn't it be enough to remove the node from parent .kids TList and just add it to the target treeview Kids tlist?<br><br>Because all kids etc are appended to it.<br><br>You will just need to update the gadget afterwards.<br><br>(ps: there is no no-oop way to do this) <br><br></td></tr></table><br>
<a name="721344"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep, you caught me pre-edit. I slipped and submitted before I'd added the last little question about removing from one kid list and adding it to the other. I'm just not sure if there is anything else which needs to be done, and which is going to come back to bite me later if I try to do it this way. <br><br></td></tr></table><br>
<a name="721349"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't know. The easiest way to find out is check out what the method does that actually adds the object to the kids list. if it does nothing else, then there is nothing else to do :) <br><br></td></tr></table><br>
<a name="721355"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I know, I just hate poking around in the MaxGUI source. I can never find anything. The other modules are fine, MaxGUI, I'm nowhere. As you say, there's no real alternative because just switching kids on it's own doesn't seem to work. There's no command to refresh a treeview as far as I can see, but opening and closing the nodes should do it and nothing has moved. <br><br></td></tr></table><br>
<a name="721361"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> RedrawGadget does not help?<br><br>There is the method: _setparent<br>which you could execute after you removed the node from its current parent. <br><br></td></tr></table><br>
<a name="721373"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope, RedrawGadget didn't help, nor _setparent. Maybe I made a mistake in there somewhere, but I think I'll just go ahead and do it the long way, recursing, copying and removing. <br><br></td></tr></table><br>
<a name="721385"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I spent a good day trying to fix the treeview redraw problem last week and unfortunately didn't make much progress. I think there is something obscure in windows I have overlooked so will study msdn further so we can get the things refreshing. <br><br></td></tr></table><br>
<a name="721408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kev</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @skid, not sure if this would help, do you send the WM_SETREDRAW message to the treeview. <br><br>one note though i recall reading that microsoft confirmed this to be a bug!<br><br>SYMPTOMS!<br><br><div class="quote"> <br>If a program uses the WM_SETREDRAW message to turn off updating of a TreeView control before adding items, the TreeView control can behave strangely.<br><br>For example, if the item being added to the control uses the TVI_FIRST style to insert it to the top of the tree and the top of the tree is scrolled above the top of the visible window, it may be impossible to bring the item into view.<br><br>Another possible symptom is that the TreeView control doesn't repaint itself at all. These problems occur only if the program has used the WM_SETREDRAW message to turn off updating the TreeView control.<br> <br></div><br><br>could this be the cause of the refreshing problem? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
