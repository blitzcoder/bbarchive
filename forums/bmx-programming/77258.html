<!DOCTYPE html><html lang="en" ><head ><title >image attributes</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >image attributes</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >image attributes</a><br><br>
<a name="864384"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nigel Brown</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to read an images width/height without having to load the image first? I need to load a multi-frame image with settings that can be determined from the file i.e.<br><br>LoadAnimImage("filename", width, height, 0, height/width, 0 ) <br><br></td></tr></table><br>
<a name="864389"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No its not.<br>not without writing the code for it yourself and parsing the image file header depending on the image type. <br><br></td></tr></table><br>
<a name="864421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>pixmap:TPixmap = LoadPixmap("filename")
image:TImage = LoadAnimImage(pixmap, ...ETC...)</pre><br>?? <br><br></td></tr></table><br>
<a name="864430"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> ? <br><br></td></tr></table><br>
<a name="864455"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows Explorer manages to get them from somewhere. It might be a case of a good trawl through the API or that Internet thingy.<br>&lt;edit&gt; Doesn't seem to be an API and ms forums suggest .net image.width which doesn't help. <br><br></td></tr></table><br>
<a name="864744"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nigel Brown</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks all, if the only way to find an image width / height is to load the image guess thats what I should do. <br><br></td></tr></table><br>
<a name="864765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Pretty straight forward: <a href="http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256AFB00139E67" target="_blank">http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256AFB00139E67</a><br><br>Though its only for JPG/GIF and you have yet to mention what kind of image you want to analyze.<br><br>As Dreamora noted you can parse the header to figure out stuff like this, it all depends on the type of image (you should be able to find header info on wiki). <br><br></td></tr></table><br>
<a name="864783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have made these functions and so far for all png images it seems to work, but with the jpg I have found a few images where it shows the sizes divided by 10 and I have not figured out why yet. But its a start and perhaps someone can improve on it.<br><br><pre class=code>
Local width:Int = 0
Local height:Int = 0

imageWidthHeightPNG("5.png",width,height)
Print Hex(width)+","+width
Print Hex(height)+","+height

imageWidthHeightJPG("5.jpg",width,height)
Print Hex(width)+","+width
Print Hex(height)+","+height

End

Function imageWidthHeightPNG(imagePath:String,width:Int Var, height:Int Var)
	Local file:TStream = OpenStream(imagePath)
	If ReadShort(file) &lt;&gt; $5089 Then Return False	' not a png image file
	SeekStream(file,18)
	width = ReadByte(file)*256
	width :+ ReadByte(file)
	SeekStream(file,22)
	height = ReadByte(file)*256
	height :+ ReadByte(file)
	CloseStream(file)
End Function

Function imageWidthHeightJPG(imagePath:String,width:Int Var, height:Int Var)
	Local file:TStream = OpenStream(imagePath)
	If ReadShort(file) &lt;&gt; $D8FF Then Return False	' not a jpg image file
	Local b1:Byte,b2:Byte,test:Byte=$E1
	Local jump:Int
	While Not Eof(file)
		' locate jump instructions
		Repeat
			b1 = ReadByte(file)
		Until b1 = $FF
		b2 = ReadByte(file)
		If b2 &gt; $E0 And b2 &lt; $EE Then	' jump instruction found
			jump = ReadByte(file)*256+ReadByte(file)
			SeekStream(file,StreamPos(file)+jump-2)
		End If
		If b2 = $EE Then	' no more jumps
			' find width &amp; height info
			Repeat
				b1 = ReadByte(file)
				If b1 = $FF Then b2 = ReadByte(file)
			Until (b1 = $FF And b2 = $C0) Or (b1 = $FF And b2 = $C1) Or (b1 = $FF And b2 = $C2) Or (b1 = $FF And b2 = $C3)
			' skip 3 bytes
			SeekStream(file,StreamPos(file)+3)
			height = ReadByte(file)*256
			height :+ ReadByte(file)
			width = ReadByte(file)*256
			width :+ ReadByte(file)
			CloseFile(file)
			Return
		End If
	Wend
End Function
</pre><br><br>[edit] I think that I figured out the jpg function. Some jpg files has embedded thumbnail images, and those need to be jumped past to get to the info of the actual image. So far I have not found any jpg images the above function cannot handle. <br><br></td></tr></table><br>
<a name="864822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotshot2005</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It got error saying "Unhandled Exception" and I am sure you can fixed da da bugs :) <br><br></td></tr></table><br>
<a name="864912"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Bremer</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It got error saying "Unhandled Exception" and I am sure you can fixed da da bugs :)  <br></div><br><br>You have to supply your own images to try it out. So change the paths from "5.png" in the function calls to paths of images you know exist on your system. Otherwise you will get errors ofcause since it cannot process a file which does not exist. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
