<!DOCTYPE html><html lang="en" ><head ><title >BlitzMax supporting Threads?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >BlitzMax supporting Threads?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >BlitzMax supporting Threads?</a><br><br>
<a name="924099"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trader3564</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I remember something that BM did not support threads.<br><br>Does BlitzMax support threads now? if so, since when? <br><br></td></tr></table><br>
<a name="924100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> It does, try this thread.  since when - Mark released it a couple months back.<br><br><a href="http://www.blitzbasic.com/Community/posts.php?topic=80677" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=80677</a> <br><br></td></tr></table><br>
<a name="924104"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It does support it, but I wouldn't bother until <a href="/posts.php?topic=81959" target="_blank">this</a> is fixed.<br><br>When running in threaded mode, your app will basically dump a massive log file with the same name as your executable.  There is currently no way of turning this off, unless you want/are able to dig into the C code for the garbage collector and figure it out for yourself. <br><br></td></tr></table><br>
<a name="924108"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Isn't it also still officially a beta module? <br><br></td></tr></table><br>
<a name="924111"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yep.  But it hasn't seen an update in months.  The only ones I've ever seen are for MaxGUI, which I don't use anyway. <br><br></td></tr></table><br>
<a name="924147"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trader3564</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmmm... i wonder. How are my chances making a good serverside for an online MMO game withouth threads? <br><br></td></tr></table><br>
<a name="924149"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Hmmm... i wonder. How are my chances making a good serverside for an online MMO game withouth threads?  <br></div>I don't think the overhead is worth it, unless you have a 8-16 core server with tons of memory. <br><br></td></tr></table><br>
<a name="924150"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trader3564</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> You mean, you doubt its worht it with, or without threads? <br><br></td></tr></table><br>
<a name="924152"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> With. <br><br></td></tr></table><br>
<a name="924153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trader3564</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have another one (a networking developer) claiming the oposite. He says its crucial to have multithreaded gameservers, otherwise your server is busy and all connections are waiting for it, even if its a few milisec, its redicilous, as a server must always be listening, and run its gameupdates in seperate threads.<br><br>So im confused now. <br><br></td></tr></table><br>
<a name="924157"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> He is partially correct (in my fairly uneducated networking opinion), but in Max, without 64-bit support, I would say a single-threaded server nest would be more efficient then a massively threaded single server. <br><br></td></tr></table><br>
<a name="924169"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dynaman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> if you plan on having more then a dozen(*) players online at one time, then a fully multithreaded server farm (mutliple servers with each one running a mutlithreaded server program) is a must.<br><br><br>(*) a single threaded single server can most likely handle much more then 12, but much less then 1000 players without a problem.  How much more or less I have no idea. <br><br></td></tr></table><br>
<a name="924184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> C code for the garbage collector <br></div>IIRC, threaded mode is using a third-party garbage collector.  The compiler having to deal with two different GCs certainly can't be helping matters. <br><br></td></tr></table><br>
<a name="924245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't think you can go much wrong with threads *especially* if you have at least 2 cores or cpu's in your system. <br><br></td></tr></table><br>
<a name="924301"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> IIRC, threaded mode is using a third-party garbage collector. <br></div>Yeah it does.  But even so I don't know how its been in Blitzmax for this long and nobody's noticed/mentioned/fixed the log file problem.  Because as good as the threading stuff is (and it is), its unusable simply because of that. <br><br></td></tr></table><br>
<a name="924302"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> The compiler having to deal with two different GCs certainly can't be helping matters. <br></div><br>It's not using the two GC's at the same time.<br><br><div class="quote"> ...a fully multithreaded server farm... <br></div><br>There are many libraries available which enable scaling-up of a parallel architecture of multiple machines, although to make it effective you will need a fibre-channel network etc :-) <br><br></td></tr></table><br>
<a name="924303"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Hi,<br><br>Well, as many of you will have already noticed, a new 'threaded' version of BlitzMax is now available via SVN!<br><br>This is <b>all highly experimental and will probably take some time to get right</b>, but bear with us as I think it's worth taking the leap into threads-land! If nothing else, it's kind of fun...<br> <br></div><br>(taken from <a href="http://www.blitzbasic.com/Community/posts.php?topic=80344#903246)" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=80344#903246)</a><br><br>So there could be bugs and there is a log files (such the one reported by GFK) related to the current testing approch.<br>Since the multithreading is not OFFICIAL (*) you can use it at your risk (consider that you still need to type manually <b>bmk makemods -a -h</b> to re-compile all blitzmax modules to be mt compatible...unless you dont' change MaxGUI source the handle this)<br><br>(*) = I mean there's not an official module if you install via setup.exe, a BETA-Module is something different... <br><br></td></tr></table><br>
<a name="924306"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah but the point is, it hasn't been updated for months.  BETA stuff generally gets updated/fixed/released.  For somebody who knows C its probably a ten minute job to get it usable.  And besides, its the garbage collector that's doing it - not the threading module itself. <br><br></td></tr></table><br>
<a name="924316"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>And besides, its the garbage collector that's doing it - not the threading module itself. <br> <br></div><br>I'm not a C expert, but I believe that the output log files will be removed in the final version (I think there's nothing in the license - if any - complaing about it!). If you ever have seen the blitzmax' source module there are/there were some 'debuglog ...' statements commented out - it's normal during a beta stage.<br><br><div class="quote"> <br>it hasn't been updated for months.<br> <br></div><br>Yes, you are right.<br>From the SVN log file the last updated is on 25th sept 2008. But this doesn't mean that is STOPPED or unfinished.<br>And to be honest I haven't seen to much 'bug reports or complaing or help requests' about running Multithreading code on blitzmax in the last month...<br>Probably (my own speculation!) BRL is doing some experiments WITH Max3d and Threads.mod...<br>Consider when Mark posted something in his own worklog: we have no more news about anything, but this is normal. <br><br></td></tr></table><br>
<a name="924390"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> It's not using the two GC's at the same time. <br></div>I didn't say it was using both at the same time.<br><br><div class="quote"> And besides, its the garbage collector that's doing it <br></div>Is this a bug in the GC itself or Mark's implementation of it?<br><br><div class="quote"> it hasn't been updated for months. <br></div>When the official word for support is <a href="/posts.php?topic=82038#924145" target="_blank">"figure it out for yourself"</a>.  You can't hope for bugs or issues to be addressed in a timely manner. <br><br></td></tr></table><br>
<a name="924394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Is this a bug in the GC itself <br></div><br>It's not a bug, it's just what it does.<br><br><div class="quote"> For somebody who knows C its probably a ten minute job to get it usable. <br></div><br>Probably less. <br><br></td></tr></table><br>
<a name="924400"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> When the official word for support is "figure it out for yourself". You can't hope for bugs or issues to be addressed in a timely manner. <br></div><br>That was a comment about Linux in general, not BlitzMax. <br><br></td></tr></table><br>
<a name="924448"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> And to be honest I haven't seen to much 'bug reports or complaing or help requests' about running Multithreading code on blitzmax in the last month... <br></div>Well, there's mine.  Which is definitely there, and definitely needs a looking at.<br><br><div class="quote"> Is this a bug in the GC itself or Mark's implementation of it? <br></div>No idea.<br><br><div class="quote"> It's not a bug, it's just what it does. <br></div>Why would I want an endlessly growing log file full of warnings about garbage collection?  When I compiled Magicville in threaded mode, even though I wasn't actually using any threading it still racked up a 100k log file in less than a minute.<br><br>What if somebody for some strange reason plays my game for several hours?  Full hard drive? <br><br></td></tr></table><br>
<a name="924457"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >plash</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> I agree with Brucey, its not a bug, just a *feature* that needs a toggle. <br><br></td></tr></table><br>
<a name="924586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> "months" is a bit steep... threads.c was last update Nov 9th. <br><br></td></tr></table><br>
<a name="924589"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> "months" is a bit steep... threads.c was last update Nov 9th.  <br></div>As I said earlier, its not the threading module, its the garbage collector. <br><br></td></tr></table><br>
<a name="924601"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think it's worth bearing in mind that the thread module is clearly described as "highly experimental", and only available in the SVN release, so it's hardly ideal for commercial releases anyway.<br><br>However, doing this should stop the log file being created -- it works here anyway:<br><br>1) Back up "brl.mod\blitz.mod\bdwgc\misc.c";<br>2) Open misc.c in a text editor and go to line 841;<br>3) Replace the <i>GC_write</i> function with the code below:<br><br><pre class=code>
  int GC_write(const char *buf, size_t len)
  {
  }
</pre><br><br>(Alternatively, just manually comment out everything between the outermost { and } lines within GC_write, so you can easily go back.)<br><br>Now save misc.c, open a command line and type <i>bmk makemods -h</i>. Re-run your program and there should be no more log file. <br><br></td></tr></table><br>
<a name="924606"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks James - that works perfectly. :) <br><br></td></tr></table><br>
<a name="924613"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yay! <br><br></td></tr></table><br>
<a name="924633"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> This threading stuff is the dog's wossnames.<br><br>You have to make this an official module ASAP. <br><br></td></tr></table><br>
<a name="924885"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Trader3564</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm, Its been decided that the server will be designed on the TWISTED framework in Python. This is a matured networking lib, and it supports ASYNC operations. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
