<!DOCTYPE html><html lang="en" ><head ><title >"Caching" graphics on the graphics card</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >"Caching" graphics on the graphics card</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >"Caching" graphics on the graphics card</a><br><br>
<a name="782383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya, quick one here, I'm sure I've seen or asked it before but can't remember the answer...<br><br>Basically sometimes if you load some graphics into your game and then draw them, the first frame takes a long time to draw due to the graphics being uploaded from RAM to VRAM and if you are running delta time or something you get a visible jerk as the next frame compensates and draws further on in the timescale.<br><br>So I wanted to cache my graphics before drawing the first frame but wondered the best way to do this.  I thought about:<br><br>a) Drawing all the graphics, then drawing a black rect over them (or calling CLS) then flip.  So there'd be a black screen.  Problem is what if BMax and the Graphics card optimise somehow and go "Hmm, he didn't draw anything so I won't upload any graphics".  There may even be a difference between using CLS and drawing a black rect.<br>b) OR can I just call all the DrawImages I want and then not actually call Flip?  Will that upload to the graphics card or is flip required?<br><br>Naturally I ought to check the total size of all my textures and aim for a minimum VRAM size of say 32MB or 64MB and make sure I cache only the relevent ones instead of absolutely everything.<br><br>But even that makes me think, hmm, do graphics cards try to optimise what is cached based on how often it's used or something else (like size) or will new graphics simply push out old graphics (FIFO).<br><br>Another thing I don't know is how graphics cards arrange their memory i.e. can textures all be stored linearly so they exactly fill up 32MB or whatever, OR is any space wasted due to bad tessellation i.e. a small graphic is dropped from VRAM leaving a gap but if the other graphics don't "shuffle up", this will leave a gap that may be too small for new bigger textures so the bigger texture is either split or placed entirely elsewhere (a bit like a fragmented hard drive).<br><br>I'm a bit of a gfx card noob so any advice is welcome, thanks! <br><br></td></tr></table><br>
<a name="782391"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> <a href="/posts.php?topic=65990#737534" target="_blank"> let me know when your tea needs stirring </a> <br><br></td></tr></table><br>
<a name="782392"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can change his name to Earl Grey Alien then! :D <br><br></td></tr></table><br>
<a name="782399"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Veeeerrrry good!<br>&lt;edited to for some extra eee and rrr&gt;<br>&lt;edit&gt; Some extra information. <br>Not sure about OGL but Bmax uses DX7 cache algorithim to determine which textures to replace. I did search for the exact rules but never found it. It's going to be something like oldest first.<br>&lt;edit&gt; and why single-surface is an added advantage. <br><br></td></tr></table><br>
<a name="782401"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> tonyg: Thanks for the cuppa :-)<br><br>I'll make a proper testbed and see if it works properly.<br><br>GfK: That's <a href="http://en.wikipedia.org/wiki/Norman_Birkett,_1st_Baron_Birkett" target="_blank">Baron</a> and later Lord, if my ancestors have anything to do with it.  Not quite sure where Earl fits into the hierarchy. <br><br></td></tr></table><br>
<a name="782494"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> You dont need to worry, the graphics card does not know that you're drawing black over images that you drew before, it has no intelligence about that. It just carries out your commands. You dont even need to do a flip. Just draw your images and then clear the screen, should be enough. <br><br></td></tr></table><br>
<a name="782495"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think this is just a DirectX issue, isn't it? <br><br></td></tr></table><br>
<a name="782514"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> OK thanks.  I would have thought that it would affect OpenGL too as the textures still have to be loaded into VRAM. <br><br></td></tr></table><br>
<a name="782607"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >anawiki</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> In Tom's Hen House I draw all required images (for certain stage of the game) and don't flip.<br><br>best<br>Roman <br><br></td></tr></table><br>
<a name="782618"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <pre class=code>Function CreateFrames(image:TImage)
	For Local c=0 Until image.frames.length
		image.Frame(c)
	Next
End Function</pre><br><br>[edit]<br>Blimey, that's thrice...<br><a href="/posts.php?topic=62100#704506" target="_blank"><b><u>http://www.blitzbasic.com/Community/posts.php?topic=62100#704506</u></b></a><br>;op<br>[/edit] <br><br></td></tr></table><br>
<a name="782621"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Roman thx.<br><br>Yan: OK handy function thanks (again) <br><br></td></tr></table><br>
<a name="782932"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hmm...but some graphics-cards relay on the flip-command.<br><br>You surely remember on the fact that on some computers the drawimage-commands needed some milliseconds and the flip nearly nothing - and on other computer the drawimage was done in nothing and the flip durates for some more millisecs.<br><br>If the flip takes a long time I thought this happens because with this command the gfx-card takes the memory into vram.<br><br><br>bye<br>MB <br><br></td></tr></table><br>
<a name="782960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had thought this too, but it seems that the BMax code uploads to VRam when DrawImage is called (according to Yan) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
