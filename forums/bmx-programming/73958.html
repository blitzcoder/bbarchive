<!DOCTYPE html><html lang="en" ><head ><title >Why doesn't this work?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Why doesn't this work?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Why doesn't this work?</a><br><br>
<a name="826177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> can anyone tell my why this doesn't work?<br><br><pre class=code>Graphics 800,600

Local myPic:TPixmap = LoadPixmap("spark1.png")

While Not KeyDown(KEY_ESCAPE)
	Cls()
	DrawPixmap myPic,MouseX(),MouseY()
	Flip
Wend</pre><br><br>when I run this the screen is empty.  The image is valid.  I don't get it.<br><br>The only way I've been able to get this to work is to create a new pixmap and manually copy all the pixels to the new pixmap.  Am I doing something wrong? <br><br></td></tr></table><br>
<a name="826183"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok, that's strange.<br><br>This worked...<br><pre class=code>Graphics 800,600

Local myPic:TPixmap = LoadPixmap("spark1.png")
myPic:TPixmap = myPic.convert(PF_BGRA8888)

While Not KeyDown(KEY_ESCAPE)
	Cls()
	DrawPixmap myPic,MouseX(),MouseY()
	Flip
Wend
</pre> <br><br></td></tr></table><br>
<a name="826208"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where did you get spark1.png from and what format is it in? <br><br></td></tr></table><br>
<a name="826230"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vlad</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Craig H. Nisbet<br>Your sample works fine at my system. But I've used my own picture. <br>But DrawPixmap uses obsolete drawing method BitBlt. Not supports alpha, rotation, etc. Use LoadImage/DrawImage and don't miss to set blending mode SetBlend(alphablend)<br>Also you don't attach image (spark1.png) - all troubles can be in that image. <br><br></td></tr></table><br>
<a name="826234"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Where did you get spark1.png from and what format is it in?  <br></div><br>the image is from the sample/shooter/gfx folder.<br><br><div class="quote"> Your sample works fine at my system. But I've used my own picture.<br>But DrawPixmap uses obsolete drawing method BitBlt. Not supports alpha, rotation, etc. Use LoadImage/DrawImage and don't miss to set blending mode SetBlend(alphablend)<br>Also you don't attach image (spark1.png) - all troubles can be in that image.  <br></div><br><br>So...is there way to access the pixmap from the Loadimage commands? <br><br></td></tr></table><br>
<a name="826240"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Using that image and your code works fine for me with 1.26 Bmax.<br>When you Loadimage you create a pixmap plus a texture which can be drawn to a surface using drawimage.<br>This means you can access the pixmap of the image (using lockimage) and change it. The next time you draw the image it will load the new texture into videomem <br><br></td></tr></table><br>
<a name="826265"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Craig H. Nisbet</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wow, it works for you?  Must be something with my video card or Vista. <br><br></td></tr></table><br>
<a name="826283"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Newer drivers might decide to NOT convert wrong pixel formats when uploading.<br><br>This might be the reason for the create surface problem mentioned in the Blitz3D Bugboard as well ...<br><br>the "drivers do programmers work" approach costs performance, performance NVIDIA would like to use against ATI not against itself.<br>so at best / correct way you check the pixel format and convert it if needed. <br><br></td></tr></table><br>
<a name="826329"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So...is there way to access the pixmap from the Loadimage commands?  <br></div>Call LockImage.  You'll have to unlock it when you're done using the pixmap.  This is not a good way to get it, however, since the image will be buffered again once you unlock it (you cannot draw the image while it's locked) and will require the image to be loaded as a dynamic image.  You should consider loading the pixmap separately and storing them both alongside each other if you need the pixmap.<br><br>If you plan on modifying it and reloading the image, however, you <i>should</i> load it as a dynamic image.  The documentation, poor as it is, details this at least at a basic level. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
