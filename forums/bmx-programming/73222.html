<!DOCTYPE html><html lang="en" ><head ><title >Rand() NOT work in Vista?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Rand() NOT work in Vista?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Rand() NOT work in Vista?</a><br><br>
<a name="818496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> It seen random functions does not ramdom very well in some cause (does not known, why it dosent work here):<br><br><pre class=code>
Random
32 34
Random
33 34
Random
1 34
Random
2 34
</pre><br><br>it even I allready have seeded or not. Seed dosent work at all !!<br><br>not even these lines below does not random as it should, all it does is just counting<br><br><pre class=code>
SeedRnd MilliSecs()
Print Rand(0, 10)
</pre><br><br>Other rand functions seen to do the same thing. <br><br></td></tr></table><br>
<a name="818497"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Floyd</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I would guess you are seeding the generator before every call to to Rand. Millisecs() probably hasn't changed so neither does Rand. <br><br></td></tr></table><br>
<a name="818498"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> if I dosent use seedRnd, it allways print 5 out (just using Print Rand(0, 10)).<br><br>By now I have simply needed to use a wrapper to use the Pure Basic version of it. It works a lots better.<br><br>I guess it only on Vista (using 64bit version), not on XP and Linux. Haven't testet it on Linux. <br><br></td></tr></table><br>
<a name="818501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Post the loop that generated the first output <br><br></td></tr></table><br>
<a name="818504"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> And you might have a good point: Its most likely the 64bit, not even vista at all.<br><br>XP64 already had some problems with 32bit emulation but Vista64 is an even worse thing.<br><br>Did you try to run your app with xp sp2 emulation as admin. <br><br></td></tr></table><br>
<a name="818552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Post full sample code. <br><br></td></tr></table><br>
<a name="818758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I simply just compiled the one line code as<br><br><pre class=code>
Print Rand(0, 10)
</pre><br>and press Ctrl-R to compile it.<br><br>Here it just allways output 5 (4 today) instead of random number every time I run it.<br><br>Yes it might have due with 32bit emulation, since I use Vista 64bit OS.<br><br>I use the PureBasic Random code, since it dosent seen to have effected it. I can't release it, due the politic not to release a Pure Basic command wrapper.<br><br>Emulation as XP SP2 seen not to have a effect. <br><br></td></tr></table><br>
<a name="818762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Here it just allways output 5 (4 today) instead of random number every time I run it <br></div>And?<br>If all you are doing is running that again and again, then I would expect the possibility of the same number every time<br><br>You implied that you had a loop that was giving the first posts results, can you please post that. (as youve been asked twice) <br><br></td></tr></table><br>
<a name="818763"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> And also,<br><br>what do you get when you compile *just*:<br><br><pre class=code>
SeedRnd(millisecs())
Print Rand(0, 10)
</pre> <br><br></td></tr></table><br>
<a name="818776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The real question is: What do you get when you use RND instead of RAND ... I would assume the error is there, if it isn't there, then you forgot to rebuild your modules on X64 and run into math problems on the multiplication or some similar problems due to 32Bit &lt;-&gt; 64Bit <br><br></td></tr></table><br>
<a name="818820"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Print rand( 0,10 ) will indeed print the same thing every time - you must 'seed' the generator to receive different values. See brl.random module docs.<br><br>In addition, seeding with millisecs in a tight loop wont work either, eg:<br><br>For k=1 to 100<br>...seedrnd millsecs()<br>...print rand...<br>Next<br><br>...because millisecs is unlikely to have changed within the loop. <br><br></td></tr></table><br>
<a name="818828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://imgs.xkcd.com/comics/random_number.png"> <br><br></td></tr></table><br>
<a name="818871"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried them all, but none diddent work here. I still  it a Vista only bug (and even only in 64 bit vista), NOT on XP, because I remember it diddent have any issue on that and did works as normal.<br><br>If I use SeedRND(), it just counting up by 1 to 3 numbers (about one per second), but never really random, like I shown in the first post (which was used when I tried to random my albums in my Jukebox application).<br><br>Really wierd. <br><br></td></tr></table><br>
<a name="818872"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> tried<br><br><pre class=code>
For k=1 To 100
	SeedRnd MilliSecs()
	Print Rand(1,10)
Next
</pre><br><br>got 9 on all. Do I set a delay 100 in it, it count once per second.<br><br>It more a timer than a random.<br><br>===== EDIT =====<br>If I do this:<br><br><pre class=code>
SeedRnd MilliSecs()
Print Rand(1,10)
Print Rand(1,10)
</pre><br><br>THe first print is a "clock" and next one seen do a random as it should. <br><br></td></tr></table><br>
<a name="818878"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> In addition, seeding with millisecs in a tight loop wont work either, eg:<br><br>For k=1 to 100<br>...seedrnd millsecs()<br>...print rand...<br>Next<br><br>...because millisecs is unlikely to have changed within the loop. <br> <br></div> <br><br></td></tr></table><br>
<a name="818884"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> And this?<pre class=code>SeedRnd MilliSecs()
For k=1 To 100
    Print Rand(1,10)
Next</pre> <br><br></td></tr></table><br>
<a name="818934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jake L.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Space Fractal: Why do you call SeedRnd() this often? Call it once on app's start and you're fine... <br><br></td></tr></table><br>
<a name="818940"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using Vista x64 and not having any problems with Rand() <br><br></td></tr></table><br>
<a name="818962"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> I asume, it the only first call, that react like a clock. If I call it again directly after, I got the random number....<br><br>So I just tested again normal application:<br><br>If I call RAND function twice, it works. The first call is a clock and other calls do as it should.<br><br>Strange. SeedRND above is just matter a test. Normally I only do that once per run and never per call. <br><br></td></tr></table><br>
<a name="818968"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Damien Sturdy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Can we PLEASE see the loop that is failing? not one that is like it... <br><br></td></tr></table><br>
<a name="818974"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> You should only need to be setting the seed once because further calls to Rand will also be setting it. <br><br></td></tr></table><br>
<a name="819026"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> It hard to make some code to reveke this bug, beause it seen only doing that on some machines, even using the same OS.<br><br>Normally I allways seed it once, so I just used it here as test. I now just call it twice to make sure I got the random number.<br><br>Simply:<br> SeedRnd MilliSecs()<br> Print Rand(1,10)<br> Print Rand(1,10)<br><br>(just recompile it again about once per second, as I do here)<br><br>where second rand works as it should (but I need to seed it first, otherwice it dosent work. SeedRnd is NEED to get the second value to work, so it might been something work in seedrnd function and I use a danish version?<br><br><br>Even I have seen a very simular bug in my older Arcade Music Box (BlitzPlus) when I tried to call bass.dll to change its volume. The first call did nothing, but the same call again got it to work. This is a long time ago....<br><br>The rest was seen to works fine. Strange. <br><br></td></tr></table><br>
<a name="819032"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> What does the first Rand return then? <br><br></td></tr></table><br>
<a name="819045"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Space<br>And what does this give?<pre class=code>SeedRnd MilliSecs()
For k=1 To 100
    Print Rand(1,10)
Next</pre><br><br>@Support, Ban him, just ban him <br><br></td></tr></table><br>
<a name="819114"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess I found what it really happens in the application:<br><br>I have used seedrnd in each keypress, but do NOT do that. Use it ONLY on app or in game start.<br><br>It seen it just the FIRST rand call after seedRND, that act like the clock. Rest works fine.<br><br>To make sure, I might need to just call rand() once after seedrnd where it used, after then it works as it should.<br>so it not in rand() that is a bug, but more than seedrnd(), that do not do autocall a rand() after a new clock seed.<br><br>[EDIT]<br>Examples what I did:<br><br><pre class=code>
Print ""
Print "Fist digit act a clock, rest works fine"
For i=1 To 5
	SeedRnd MilliSecs();
	a$=""
	For k=1 To 25
		a$=a$+Rand(1,9)
	Next
	Print a$
	Delay 1000
Next


Print "This works fine, but added a dummy rand"
SeedRnd MilliSecs(); dummy=Rand(1,2)
For i=1 To 5
	a$=""
	For k=1 To 25
		a$=a$+Rand(1,9)
	Next
	Print a$
	Delay 1000
Next


Print ""
Print "This works fine, but call rand() after seedrnd to jump clocking over"
For i=1 To 5
	SeedRnd MilliSecs(); dummy=Rand(1,2)
	a$=""
	For k=1 To 25
		a$=a$+Rand(1,9)
	Next
	Print a$
	Delay 1000
Next
</pre><br><br>Output:<br><pre class=code>
Fist digit act a clock, rest works fine
3565481648696481443188513
4954199397197331318681177
4333628945598261184373632
5712348694889999859965296
6291957353382849735566661
This works fine, but added a dummy rand
5795769117837795912582341
7254435942415543786394691
9525332683175128389969812
4159258634351645463736264
1398143926189446291197334

This works fine, but call rand() after seedrnd to jump clocking over
6856733737899687693388564
1743929322818185359214212
4538116815826473916138851
8425394389845772762144499
3212591874854279428969138
</pre> <br><br></td></tr></table><br>
<a name="819129"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Azathoth</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> What do you mean by acts like a clock? I don't notice anything odd. <br><br></td></tr></table><br>
<a name="819131"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right so you are saying that 3,4,4,5,6, isnt Random then.<br><br>Even though you dont know what the number is going to be before you run it, and yet 5,4,3,2,1 (the forth call to rand) you say <b>is</b>Random?<br><br>Edit: Oh, what you are saying is that the first call to Rand after a seed is always the same number as the last first number after a seed, or is One higher.<br>Well thats the way It <b>also</b> works in XP. It comes down to how the number is calculated/seeded. It <b>is</b> as ramdom as the other numbers because you simple dont know what the first value is, but if you seed a value 1000 more than last time thats what happens. Make the delay 10000, and see what happens. (Pay attention to the first two numbers)<br>Now in a real situation you wouldnt know the first milli value, and it wouldnt normaly be a "Fixed" time unit before the next call. It is im afraid just the nature of the random generator <br><br></td></tr></table><br>
<a name="819163"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> I want to hurt you so badly... &gt;_&lt; <br><br></td></tr></table><br>
<a name="819170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >altitudems</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> This thread makes me laugh and cry at the same time. <br><br></td></tr></table><br>
<a name="819173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Space Fractal</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fuck off with these spam :-(. PLEASE READ WHAT I WROTE. Thanks.<br><br>Ran again:<br><br><pre class=code>
9 896569857691251895461846
9 935716386641681637896876
1 664929377435463221977877
2 794266717585893953512798
3 824514247536342694937728
4 853751687576772435462759
5 692964668361554919543751
6 622212118422984751178771
6 752458548462434483593692
7 871715978423963234938632
8 911952428463493965454653
9 659266499257275549535654
1 779413848398625281169675
2 718659378358154923585615
3 838996718399584764929535
3 577211799184366347191537
4 617457239244796989636557
5 736694679284246721151588
6 866941119235675563586518
7 886287549285115394111449
</pre><br><br>It count appr. once per second.<br><br>It simply fixing it by dummy call rand() once after seed. It really a simple workaround fix. <br><br></td></tr></table><br>
<a name="819174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >marksibly</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thread locked, and Space Fractal gets a free holiday due to coarse language. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
