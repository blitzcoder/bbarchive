<!DOCTYPE html><html lang="en" ><head ><title >UTF8 support</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >UTF8 support</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >UTF8 support</a><br><br>
<a name="1069106"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm in the process of preparing my game for localisation (its not being done yet - just futureproofing).<br><br>I've figured out that I can't load UTF8 text via streams and have instead used LoadText().  I've loaded in some garbage Russian text to test things out and it works (I think) but I'm confused on the whole Unicode thing and not sure if what I'm getting is correct.  Some of the ASCII codes for each letter in the string are 'expected' (i.e. below 127), while the Russian ones are 1xxx etc - four digits?!<br><br>Is this correct?  I need to update my bitmap font class to cater for this so the bottom line is - how high can that number go??  2000?  10000?  A million???? <br><br></td></tr></table><br>
<a name="1069109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> UTF8 sometimes uses 2 bytes for non latin codes. So yes, four digits is expected on a UTF-8 string.<br><br>Form the wikipedia: <br><br><div class="quote"> UTF-8 encodes each of the 1,112,064 code points in the Unicode character set using one to four 8-bit bytes (termed “octets” in the Unicode Standard).  Code points with lower numerical values (i. e., earlier code positions in the Unicode character set, which tend to occur more frequently in practice) are encoded using fewer bytes,making the encoding scheme reasonably efficient.  In particular, the first 128 characters of the Unicode character set, which correspond one-to-one with ASCII, are encoded using a single octet with the same binary value as the corresponding ASCII character, making valid ASCII text valid UTF-8-encoded Unicode text as well. <br></div> <br><br></td></tr></table><br>
<a name="1069112"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> My. Technique for handling UTF8 is to treat it as a data block. I've got some methods if you'd like. You have to make matching handlers for another programming languages etc. You want to access your data from but it's pretty easy. Not at my dev system right now but if there's interest I'll post later. <br><br></td></tr></table><br>
<a name="1069139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> BlitzMax only supports up to 3-byte UTF-8... so if you need to support Chinese, you may run into issues. So the theoretical max is somewhere in the 64k area, I think.<br><br>No reason why you can't use streams. <br><br></td></tr></table><br>
<a name="1069153"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> here's what I use for UTF-8, hope it helps someone.<br><br>Not sure why it's called WString but this is what evolved from my hacking up of other things to get it working so it was probably a holdover from something it was loosely based on...<br><br><pre class=code>
' WString.bmx

SuperStrict

Function WriteWString(stream:TStream, text:String)
	Local buff:Short Ptr = text.ToWString()
	WriteInt(stream, Len(text))
	For Local onPos:Int = 0 Until Len(text)
		WriteShort(stream, buff[onPos])
	Next
	MemFree(buff)
End Function

Function ReadWString:String(stream:TStream)
	Local length:Int = ReadInt(stream)
	Local buff:Short[length + 1]
	For Local onPos:Int = 0 Until length
		buff[onPos] = ReadShort(stream)
	Next
	Local text:String = String.FromWString(buff)
	Return text
End Function
</pre> <br><br></td></tr></table><br>
<a name="1069159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> ima747, that's not UTF-8 :-)<br><br>That's UTF-16/UCS-2, a 2-byte character sequence, which is Blitzmax's native string format. <br><br></td></tr></table><br>
<a name="1069165"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well if I wasn't confused before, I sure as hell am confused now.<br><br>Maybe someone could give me an idiot's guide to supporting languages such as Russian and Japanese?  From the top... <br><br></td></tr></table><br>
<a name="1069169"></a>

<a name="1069170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess this is for Magicville? :)<br><br><div class="quote"> Russian and Japanese <br></div><br><br>I didnt to do these languages of my games, I just stuck with the (mainly) euro ones :P<br><br>Im so glad that I loaded "most" of my text from text files, it makes the process so much better - although still a pain... graphics files etc (also I missed "Options" and a few words here and there I hard coded :()<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069172"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Nope - not for Magicville.  Its for a generic class for future stuff and I'd like to support the 'weirdy' charsets as well as the western european ones! <br><br></td></tr></table><br>
<a name="1069186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, that's right, thanks Brucey! either way it gets done what I need which is to be character safe in strings that are stored (so I can store file paths, and user generated strings without it exploding if someone gets fancy, or isn't running english).<br><br>Might still be applicable to someone, it's a matter of do you need UTF-8 (I can't help) or do you need real strings (UTF-16 will cover better anyway), such as perhaps with chinese, japanese and other spooky character sets. <br><br></td></tr></table><br>
<a name="1069191"></a>

<a name="1069192"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use XML.<br>With half-decent tools (for example libxml), it takes care of conversion to/from UTF-8/BlitzMax for you, and also handles encoding of the data in the file correctly - so that you get out what you expect.<br><br>There's even a BaH.Locale module which provides an example of how one might implement transparent localisation, and happens to support 100+ locales.<br><br>Each to their own of course.<br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069204"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Nope - not for Magicville. <br></div><br><br>Sorry - I didnt read your first post fully ;) <br><br></td></tr></table><br>
<a name="1069226"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Still digging into this - is the Microsoft Multilingual User Interface pack useful for testing language versions, rather than trying to source and fathom a 'native' version of Windows for a given language? <br><br></td></tr></table><br>
<a name="1069246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I use the strings in data files that include other things like image data, maps, etc. All crunched together and intended to deter people from hacking them up.<br><br>I really should get around to implementing XML in some ways though... Would make life easier when I don't want/need a proprietary file format :0) <br><br></td></tr></table><br>
<a name="1069417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I just tried Brucey's libXML module.  Despite me being an XML virgin I got it up and running in less than five minutes by following the libXML docs that came with it. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
