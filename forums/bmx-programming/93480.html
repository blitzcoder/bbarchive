<!DOCTYPE html><html lang="en" ><head ><title >Extract icon given the file path.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Extract icon given the file path.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Extract icon given the file path.</a><br><br>
<a name="1069452"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, Its been a long time since i posted here... Anyway I was wondering if I can somehow get the image for the icon of a file if all I know is the file path.  Some things, like blitz max files, only show up as a bmx icon because their default program is blitz max but some files (executables) seem to have the icon as a seperate image (an icon file) and yet others seem to have it mysteriously embedded into them (there is no icon file)  Is there a standard simple way to extract or even display these icons via max gui or is there some format I need to know so I can program an icon extractor/displayer? <br><br></td></tr></table><br>
<a name="1069453"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Executables can have embedded resources like icons which can be contained inside the .exe. In order to view these, you'd need to look at the win32 .exe fileformat descriptions in order to analyze the .exe to find the embedded resource to extract the info from.<br>As far as I know, only executable files (.exe, .dll, scr, etc.) will have their own icon embedded in the actual file itself.<br><br>Filetype handlers are stored in the registry.<br>You can see a list of all extensions that are registered with the system in regedit, under HKEY_CLASSES_ROOT.<br><br>For example, under HKEY_CLASSES_ROOT, I show an extension for "8bf", which it defined as "photoshop.plugin".<br>Then I can look under "HKEY_CLASSES_ROOT\Photoshop.Plugin\DefaultIcon", and see a (default) that points to "C:\program files\adobe\photoshop elements 8.0\photoshopelementseditor.exe,2"<br><br>This means that a .8bf file uses the *second* included resource icon in the photoshopelementseditor.exe file.<br><br>There is code in the code archives that allows BlitzMax to read and parse the windows registry, but you're still going to have to figure out how to read the embedded resource data from the .exe's to extract the actual icon...<br><br>Good luck. :-? <br><br></td></tr></table><br>
<a name="1069456"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've been meaning to dig into this for years (also extracting image thumbnail icons that windows and macOS generate etc.). If any progress is made I'd love to see a post... seems like it could make a handy module, one that could extract the icon the OS uses for a gives file/folder/picture/application/etc. <br><br></td></tr></table><br>
<a name="1069473"></a>

<a name="1069474"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> @xlsior  Dang, that sounds complicated :P maybe there is a win api function to do it? The registry thing builds on the first part so it wont be practical until I can extract the icon from the exe already.<br><br>this looks interesting, not sure how to use it though..<br><br><a href="http://wiki.tcl.tk/17859" target="_blank">http://wiki.tcl.tk/17859</a><br><br><font class="tiny">Last edited 2011</font> <br><br></td></tr></table><br>
<a name="1069475"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's a Win32 API function called <a href="http://msdn.microsoft.com/en-us/library/ms648067(v=vs.85).aspx" target="_blank">ExtractAssociatedIcon</a> that'll get the raw icon data from any file, but getting the icon into an image you can display is another matter.<br><br>The ExtractAssociatedIcon parameters are:<br><br>· hInst - your program; pass Win32 API function GetModuleHandle with Null as parameter.<br><br>· lpIconPath - path to file from which to get icon (a pointer to a C string, so you need to pass a Varptr to a byte array containing the file name);<br><br>· lpiIcon - Varptr to an integer set to zero (or just a Byte Ptr?)<br><br>Drawing it isn't as easy (it is if you're drawing directly to a Win32 GUI element since you just call Win32's DrawIcon, but you're probably not doing that). This gives an idea as to how to get the bitmap...<br><br><a href="http://www.programmersheaven.com/mb/windows/74164/74164/converting-icon-to-bitmap-hicon---hbitmap/" target="_blank">http://www.programmersheaven.com/mb/windows/74164/74164/converting-icon-to-bitmap-hicon---hbitmap/</a> <br><br></td></tr></table><br>
<a name="1069506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Nate the Great</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> they seem to use a createcompatiblebitmap function in the second link... I dont see how that would help in bmax lol :p maybe theres a file format out there for it... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
