<!DOCTYPE html><html lang="en" ><head ><title >Game Timing &amp; Alt-Tab?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Game Timing &amp; Alt-Tab?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Game Timing &amp; Alt-Tab?</a><br><br>
<a name="785586"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sean Doherty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm using a mix of time stepping and delta time for game timing.  However, there seems to be a problem caused by Alt-Tab?  <br><br>Also, it looks like my time step code may be wrong.  Anyone have any code they would recommend?<br><br>Thanks <br><br></td></tr></table><br>
<a name="785592"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not sure what you mean by a mix of "time stepping and delta time".<br><br>Personally, I use this :<br><br><a href="http://www.gaffer.org/game-physics/fix-your-timestep/" target="_blank">http://www.gaffer.org/game-physics/fix-your-timestep/</a> <br><br></td></tr></table><br>
<a name="785595"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ninjarat</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Also, alt-tab is often used by Windows to switch apps, and if that isn't happening, then it's probably just slowing down your timestep during the call to the Windows Power Tools process. <br><br></td></tr></table><br>
<a name="785636"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> you need to put some detection into your time stepping function that says if the delay has been great than say 100ms it's probably due to someone alt-tabbing or dragging the window or some massive intrusive system task, and then just use your last sensible loop value instead. <br><br></td></tr></table><br>
<a name="785737"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sean Doherty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried pure time stepping before, but I could never seem to get the game to play smoothly.  Anyway, I implemented it again and its not very smooth.<br><br>My frame rate is 85 hz and I have 2 - 3 updates per render.<br><br>Did you implement the alpha and integrate part?  Any ideas why it would be smooth?<br><br>Thanks <br><br></td></tr></table><br>
<a name="785738"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> run this:<br><br><a href="http://www.greyaliengames.com/misc/JerktesterGraph.zip" target="_blank">http://www.greyaliengames.com/misc/JerktesterGraph.zip</a><br><br>If you get lots of peaks instead of a basically flat line then nothing will run smooth on your PC because it has too many background tasks running. <br><br></td></tr></table><br>
<a name="785743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sean Doherty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool little program!  I get an average of 11 and a peak of around 82.  The peaks kind of show up every two or three passes. <br><br></td></tr></table><br>
<a name="785758"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> If you get lots of peaks instead of a basically flat line then nothing will run smooth on your PC because it has too many background tasks running. <br></div><br>I don't know how you're deducing that statement, but I get an average of 16, a low of 4 and a high of 173, and a lot of games run very smooth, windowed and fullscreen. <br><br></td></tr></table><br>
<a name="785779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sean Doherty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've noticed Max games seem to be a lot more effected my back ground tasks than other games?  It least it seems that way?<br><br>Gabriel,<br><br>Are you willing to post your timing code? <br><br></td></tr></table><br>
<a name="785783"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CGV</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I've noticed Max games seem to be a lot more effected my back ground tasks than other games. <br></div><br><br>This is without a doubt true. According to Grey's jerktester I have a hoplessly jerky system and yet it's only Max games that I notice any jerkiness in.<br><br>I've spent the past two days trying out all the garagegames titles to pick my freebie and I've been surprised every time by the smoothness of the animation and scrolling backgrounds.<br><br>In fairness I have seen some Max games that are super smooth on my system so obviously there is a way to achieve it but apparently those who have figured it out are keeping the secret to themselves. :( <br><br></td></tr></table><br>
<a name="785792"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can't count 3D games when testing smoothness as any jerks aren't easy to see.  You need to test other 2D games, and there are plenty of jerky ones.<br><br>If you get lots of peaks on my jerk tester then you will have problems with BMax games (that use timing) and maybe others. If you only get the occasional peak then it may be OK.<br><br>BMax does seem affected by background tasks if you use delta timing or similar.  If you just lock the Hz to the screen refresh (e.g. 60Hz in full-screen) then you WILL get a smooth looking game but then the game will run at a different speed in windowed mode.  That why you HAVE to use some kind of timing (well it's one of several reasons).<br><br>Maybe at some point I should write the jerk tester in Blitz Plus to see if it's any more stable? <br><br></td></tr></table><br>
<a name="785834"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CGV</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Didn't know that about 3D games.<br><br>Grey, in your Oz game do you only use timing code in windowed mode 'cause I noticed it runs at 60 Hz in fullscreen mode so I'm guessing no timing code in fullscreen? <br><br></td></tr></table><br>
<a name="785836"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sean Doherty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Grey, do you use the integrate part of the time stepping? <br><br></td></tr></table><br>
<a name="785839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> CGV: Basically most 3D games aren't VSynced so the time from one frame to the other can vary a lot and stuff like delta timing.tweening is used to work out how to update it. If the game loses time due to a background task, you'll just run a tiny bit further forward from one frame to the next frame but the correct amount relative to time so it's not that noticeable compared to say a smooth moving object in a 2D game - that's what I think anyway.<br><br>In Oz full screen DOES use timing, the same timing code as in windowed mode which is why it runs the same speed in both modes even though the screen Hz is different.<br><br>Sean: Yeah but I interpreted it in my own way by using a delta time on the last iteration of the loop. <br><br></td></tr></table><br>
<a name="785848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess you're referring only to 2d games created with Max2D then, because I get silky-smooth performance with HGE in BlitzMax, even with hundreds of things bounding about the screen. Mind you, I get silky-smooth performance with 3d-accelerated 2d games made in B3D too. Well, I do with the good ones, not if they don't have good timing, obviously. <br><br></td></tr></table><br>
<a name="785856"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> hmm the plot thickens <br><br></td></tr></table><br>
<a name="786009"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting tool Grey Alien. How does it work? I notice the most jerks with harddrive activity. It would be more useful if it was not full screen so I could do things and observe their impact. Also the file size is quite large. Using upx I can get it to 500kb, and it could be lower if you selected frameworks. <br><br></td></tr></table><br>
<a name="786170"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sean Doherty</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a lot of talk about the fact the integrating seems to keep flickering to minimum?  Can someone explain how to go about implementing?<br><br>Thanks <br><br></td></tr></table><br>
<a name="786214"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Czar Flavius: It's just this code:<br><br><pre class=code>
'SetGraphicsDriver GLMax2DDriver()
Graphics 800,600,32
'Graphics 800,600,0

Local t1:Int
Local t2:Int
Local test: Int
Local high: Int
Local lo:Int = 200
Const MAXVALUES=800
Local values:Int[MAXVALUES]
Local counter=0
Local loops = 0
Local average = 0
Local total = 0

While Not KeyHit(KEY_ESCAPE)
	t1=MilliSecs()
	Cls
	DrawText "Current: "+test,0,0
	DrawText "High:    "+high,0,20
	DrawText "Low:     "+lo,0,40
	DrawText "Average: "+average,0,60
	DrawText "Press &lt;Space&gt; to reset High",0,80
	DrawText "Press &lt;Escape&gt; to exit",0,100
'	DrawText GCMemAlloced(),0,80
	For Local i=0 To MAXVALUES-2
		SetColor 255,255,0
		DrawLine 0,500,800,500
		SetColor 255,255,255
		DrawLine i,500-values[i],(i+1),500-values[i+1]
	Next
    Flip 1	
	t2 = MilliSecs() 
	test:Int = (t2-t1) 
	If test&gt;high Then high = test
	If test&lt;lo Then lo = test
	If KeyHit(KEY_SPACE) 
		high = 0
		lo = 200
		loops = 0
		average = 0
		total = 0
	End If
	values[counter] = test
	Counter:+1
	If counter&gt;=MAXVALUES Then counter = 0
	loops :+ 1
	total :+ test
	average = total/loops
Wend
</pre><br><br>It measures the time in millisecs between each flip and plots it.  You can change it windowed mode easily. <br><br></td></tr></table><br>
<a name="787787"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HrdNutz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Smooth animation and jitter-less timing can be tricky sometimes.  It's true - background processes will make your time jitter - and that's where the problem comes from.  <br><br>First step is obviously trying to fix the jitters.  There are a few techniques, but averaging out the delta times is probably the simplest one.  <br><br>Even fixed step loops use some type of Delta Timing as a base, to ensure the right amount of steps/second is executed.  And the Delta Time is where jitters occur.  The simple way to average Deltas is to keep adding new deltas to a buffer (removing the oldest ones) and using the average of all those as Delta Time.  The buffer can scale dynamically depending on execution rate - a .5 second to 1 second buffer works well.  There are other ways to do this, but this is the simplest and effective.<br><br>Linear interpolation for motion is also recommended (tweening), logic execution frequencies can stay low (15,30,60Hz) and motion is silky smooth, but this requires some ahead planning, and everything will have to be interpolated (positions, scales, angles, colors, ect...)<br><br>Tweening also ensures that any unused time gets translated to the next frame, independent of code frequency.<br><br>AltTabbing and Window moving can be tricky, if there is a way to know when either the application is not if focus (paused) or window being dragged, then that time can be recorded and simply subtracted from execution time so Deltas stay the same.  Also, any deltas &lt;=0 or larger than say 100ms can be completely rejected.<br>Hope this helps getting your game to run smoothly. <br><br></td></tr></table><br>
<a name="787795"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> great advice <br><br></td></tr></table><br>
<a name="787900"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> To know if your window has the focus, just use GetActiveWindow() from Windows API. if it returns a hwnd that's not the one in your program, then you don't have the focus.<br><br>Works great to "auto-pause" a game when the window looses focus ;) <br><br></td></tr></table><br>
<a name="787942"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TartanTangerine (was Indiepath)</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Also, any deltas &lt;=0 or larger than say 100ms can be completely rejected. <br></div>Like he said, if the delta is too large then ignore it and use the one from the frame before.<br><br><div class="quote"> To know if your window has the focus, just use GetActiveWindow() from Windows API. if it returns a hwnd that's not the one in your program, then you don't have the focus. <br></div>You might consider using the GetFocus() command since it is possible for a window to be Active and not have focus. <br><br></td></tr></table><br>
<a name="787947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You might consider using the GetFocus() command since it is possible for a window to be Active and not have focus. <br></div>Hmm never knew that. <br><br></td></tr></table><br>
<a name="787997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's too bad that Windows isn't like AmigaOS in the sense that your game can completely takeover the system while it's running (I think there's a seldom used Windows API function called 'CriticalCodeFollows()' or something like that. Not sure if it does the same thing) and then return control back to the OS when it's done. What do you need background tasks for anyways when you're playing a fullscreen FPS? It'd be nice if you could at least force Windows into 'safe mode' before running your game, eh? This would at least reduce the amount of nonessential crappola running in the background and stealing cycles...<br><br>Russell <br><br></td></tr></table><br>
<a name="788052"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I'd love it too.  But I guess you couldn't collect emails or download something in the background. <br><br></td></tr></table><br>
<a name="788054"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >HrdNutz</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> How about teamspeak or vent while playing?  what about custom trainers you wrote to hack Diablo 2? :P<br><br>Consoles are as good as it gets with that, but then again they aren't as flexible either.  Can alt+tab and chat in IRC/icq, download stuff in the backgrond, and have custom playlist in winamp<br><br>O.O<br><br>Cheers,<br>Dima <br><br></td></tr></table><br>
<a name="788551"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >.rIKmAN.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just ran that tool, got a low of 5 and a high of 33, and tht was with this window open, chatting to 1 person on MSN and running media player with about 12 tracks in the playlist.<br><br>All games run smooth on my system, and I play most of them in 1920x1080 (PES6, Stalker, Toca3 etc).<br><br>System: P4 3ghz, 1Gb DDR400, XFX7950GT 512mb Gfx card....<br><br>I haven`t actually tried many BMax stuff so can`t comment if it is limited to just those games or not... <br><br></td></tr></table><br>
<a name="788555"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are they all 3D games?  Probably your system would be pretty smooth anyway, your highs and lows are pretty stable. <br><br></td></tr></table><br>
<a name="788564"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >.rIKmAN.</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah those 3 I mentioned are commercial 3D games, if you wanna give me a list of some BMax stuff to try I`ll happily do it and report my results back.<br><br>If they are juddery tho, it has to be something to do with BMax as those other (resource heavy) games work flawlessly with all settings maxed out. <br><br></td></tr></table><br>
<a name="788585"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I said before that timing jerks on 3D games don't show up as obviously as 2D games with a sprite moving at a constant speed or a screen scrolling for example. <br><br></td></tr></table><br>
<a name="808916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >watusimoto</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am dealing with jerkiness on a game I am working on that uses my own timing routines.  The code is pretty minimal at this point, and if it's jerky now, I'm worried about it getting worse as things get more complex.<br><br>I don't know if it's a Blitz specific problem or not, but I suspect so.  I was wondering if someone could code the jerktester in C++ or somesuch, and see how its performance compares.   I think that would be a very interesting comparison.<br><br>Is anyone up for it?<br><br>Thanks much!! <br><br></td></tr></table><br>
<a name="809006"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yeah I had thought the same, or at least in BlitzPlus which uses DirectX1 or something whereas BMax uses DirectX 7. <br><br></td></tr></table><br>
<a name="809090"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MGE</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've done extensive testing on several Blitzmax games, demos, on several test machines. In full screen mode I don't notice anything out of the ordinary, but in windowed mode BMax apps do seem to "suffer the stutter" a tad bit more. <br><br></td></tr></table><br>
<a name="809148"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#35">[#35]</a></td></tr></table></td></tr><tr ><td class="posttext"> The stutter exists in full screen mode on plenty of PCs too. <br><br></td></tr></table><br>
<a name="809380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >watusimoto</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#36">[#36]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, let me ask this -- why would BM progs be any more or less stuttery than another app?  At the end of the day, don't they all compile down to binaries that compete for system resources on the same level? <br><br></td></tr></table><br>
<a name="809394"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#37">[#37]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What do you need background tasks for anyways when you're playing a fullscreen FPS? <br></div>So that when it crashes (which it will inevitably do) you can recover your system cleanly. <br><br></td></tr></table><br>
<a name="809408"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >watusimoto</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#38">[#38]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, here's something interesting.  On a hunch, I inserted a timer into the JerkTester code posted above.  My idea was that the jerkiness was caused by the program competing for resources with the rest of the system, and that we might see better results if the program shared a little better.  (I basically inserted the waitTimer line, and also changed the flip 1 to flip 0) The result was that I see many fewer jerks with the modified code.  Which is this:<br><br><pre class=code>
SetGraphicsDriver GLMax2DDriver()
'Graphics 800,600,32
Graphics 800,600,0

Local t1:Int
Local t2:Int
Local test: Int
Local high: Int
Local lo:Int = 200
Const MAXVALUES=800
Local values:Int[MAXVALUES]
Local counter=0
Local loops = 0
Local average = 0
Local total = 0

local timer:tTimer=createTimer(100)

While Not KeyHit(KEY_ESCAPE)
	t1=MilliSecs()
	Cls
	DrawText "Current: "+test,0,0
	DrawText "High:    "+high,0,20
	DrawText "Low:     "+lo,0,40
	DrawText "Average: "+average,0,60
	DrawText "Press &lt;Space&gt; to reset High",0,80
	DrawText "Press &lt;Escape&gt; to exit",0,100
'	DrawText GCMemAlloced(),0,80
	For Local i=0 To MAXVALUES-2
		SetColor 255,255,0
		DrawLine 0,500,800,500
		SetColor 255,255,255
		DrawLine i,500-values[i],(i+1),500-values[i+1]
	Next
    Flip 0
    waitTimer(timer)
	t2 = MilliSecs() 
	test:Int = (t2-t1) 
	If test&gt;high Then high = test
	If test&lt;lo Then lo = test
	If KeyHit(KEY_SPACE) 
		high = 0
		lo = 200
		loops = 0
		average = 0
		total = 0
	End If
	values[counter] = test
	Counter:+1
	If counter&gt;=MAXVALUES Then counter = 0
	loops :+ 1
	total :+ test
	average = total/loops
Wend
</pre> <br><br></td></tr></table><br>
<a name="809527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#39">[#39]</a></td></tr></table></td></tr><tr ><td class="posttext"> The thing is really games need to run with Flip 1 for smoothness and no vertical tearing.  I tried fiving time to the system as well, even raiing the app priority in windows but it didn't work on plenty of PCs. <br><br></td></tr></table><br>
<a name="809656"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >watusimoto</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#40">[#40]</a></td></tr></table></td></tr><tr ><td class="posttext"> So what's the resolution?  It seems the most fundamental question is whether this is a Blitz-specific problem, or whether this is a problem common to all development environments.    If it's Blitz-specific, the next question is why, and what can be done about it?<br><br>One thought I had was that with the "flip 1" statement, the system is not yielding control to Windows while it waits to do the flip, causing Windows to take control at other, less opportune times.  Maybe there is a way to let the OS do its stuff while waiting for the flip to occur, which would let the game proceed more smoothly. <br><br></td></tr></table><br>
<a name="809697"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#41">[#41]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes it could be that for sure, it could also be DX7.  Really we need a very simple jerk tester code that can be compared in BMax, BPlus and C++ and maybe something else. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
