<!DOCTYPE html><html lang="en" ><head ><title >Handle illegal characters in file paths.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Handle illegal characters in file paths.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Handle illegal characters in file paths.</a><br><br>
<a name="1031060"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Some things windows just won't allow in file/folder names that macs have no problems with, for example a trailing space, or a |. These bad names are easy to create when moving files and folders from a mac to a PC. Windows replaces them with what looks like a bullet with lots of space around it. When loading those files into my program I have no problems, however if I save the path and then try to load them again I get an access violation as it tries to access something that isn't allowed, and also isn't the right character...<br><br>I assume this is a bug in the way that blitzmax is reading the path (realpath also doesn't help) and converting it to a string. Preferably I'd like to just have this work as it should, however failing that, or in the mean time is there a way to detect bad file paths? <br><br></td></tr></table><br>
<a name="1031061"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Where/how are you saving the path?<br><br>It's possible that you are losing the "real character" values when saving the text in ASCII format... <br><br></td></tr></table><br>
<a name="1031062"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's exactly what's happening actually, just stumbled on that and came back to post it...<br><br>So, how do I do something like WriteLine with &gt; ASCII support? Is WriteString safe? <br><br></td></tr></table><br>
<a name="1031064"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Write it out as UTF8... and then read it back in as UTF8 - UTF8 is a byte-sized representation of multi-byte characters.<br>BlitzMax internally uses 16-byte characters. <br><br></td></tr></table><br>
<a name="1031065"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do I set the encoding method? <br><br>Checking the docs WriteLine is 1 byte per character which explains the ASCII limit, but I don't see a way to change encoding. WriteString says it will write each character, however it doesn't specify the character size it will use... <br><br></td></tr></table><br>
<a name="1031070"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I got it thanks to <a href="/posts.php?topic=83948#948429" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=83948#948429</a>, add "utf8::" before the file path when opening the files. Seems to work so far... <br><br></td></tr></table><br>
<a name="1031071"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is a TextStream which supports multi-byte streams... but for some reason it adds BOMs to the start of the file - each to their own, I suppose.<br><br>Or you can manage it yourself, but using the string's ToUTF8() method to get a byte-sequence that you can then write out to your stream. (remember to free the Byte Ptr!) <br><br></td></tr></table><br>
<a name="1031075"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ima747</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> TextStream is the easy option, but I am storing a lot more than just text in the stream and I don't want to get bogged down with that.<br><br>Didn't know about ToUTF8(), will make a note for future, but having to manage the ptrs sounds like a good way to get myself in trouble, especially with multithreading and all the problems I've been having with the garbage collector...<br><br>opening the files with "utf8::" prepended seems to be doing the trick nicely, and my raw data is still moving through as well. More testing will let me know if I've borked it up and need to try another approach. Thanks Brucey! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
