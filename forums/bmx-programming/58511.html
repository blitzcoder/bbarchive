<!DOCTYPE html><html lang="en" ><head ><title >ClearList is very convenient.</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >ClearList is very convenient.</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >ClearList is very convenient.</a><br><br>
<a name="650934"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's all I wanted to say! <br><br></td></tr></table><br>
<a name="650936"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >big10p</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> There's ClearList in B3D, now? Wow, I'll have to check it out... or have you got the wrong forum!? :P <br><br></td></tr></table><br>
<a name="650950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess I must have got the wrong forum. :-) <br><br></td></tr></table><br>
<a name="650989"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >OJay</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> well, <pre class=code>Delete Each myType</pre> is very convenient too ;P <br><br></td></tr></table><br>
<a name="651245"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ice9</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> if one of your fields points to an entity that must be freed then I guess you are on your own <br><br></td></tr></table><br>
<a name="651263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Or, better yet: yourList.Clear( ) <br><br></td></tr></table><br>
<a name="651420"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> yourlist = new TList <br><br></td></tr></table><br>
<a name="651436"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> ziggy: That requires that you allocate a new TList, which is obviously not going to be as fast as setting the current TList's head successor and predecessor to itself. <br><br></td></tr></table><br>
<a name="651443"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your using your 'cleared' list, this is the fastest way to send all of it's contents to the GC and leave it ready to recive new contents. Take in consideration that alocating an empty list is absolutely ultra fast. In my opinion, manipulating the header of a list is not a good practicle, it works ok, but it's not much elegant, but you know, that's only my opinion.<br><br>:D<br><br>Happy coding! <br><br></td></tr></table><br>
<a name="651449"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try this, ziggy.<br><br><pre class=code>SuperStrict

Local l:TList
Local t:Int

t = Millisecs( )
For Local i:Int = 0 To 80000
	l = New TList
Next
t = Millisecs( ) - t
Print t

t = Millisecs( )
For Local i:Int = 0 To 80000 ' Added another zero just so the results are clearer
	l.Clear( )
Next
t = Millisecs( ) - t
Print t</pre><br><br>To elaborate, creating a new list takes more time because it's making more calls to functions.<br><br>For one, it has to allocate the memory from the GC pool if needed, then it has to call the Object.New method, then the TList.New method which has to create the new head TLink which has to repeat the process of allocating the memory, calling Object.New, and then calling TLink.New.<br><br>Whereas TList.Clear is, quite simply, changing the value of some variables. <br><br></td></tr></table><br>
<a name="651466"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's another example of why just creating a new TList is bad.<br><br><pre class=code>SuperStrict

Type MyType ' 8 bytes not counting the header and super-class
    Field foo:Int
    Field bar:Int
End Type

Local k:Int = GCMemAlloced( )

Local l:TList = New TList
Print GCMemAlloced( )-k
For Local i:Int = 0 To 511
    l.AddLast( New MyType )
Next
Print GCMemAlloced( )-k

l = New TList

For Local i:Int = 0 To 256
    GCCollect( )
Next
Print GCMemAlloced( )-k</pre><br><br>Now replace <i>l = New TList</i> with <i>l.Clear( )</i> and the memory leak disappears.<br><br>Insert audible gasp here. <br><br></td></tr></table><br>
<a name="651501"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> There is no memory leak.<br>If BM would act like modern GC it would not reduce the pools size unless the RAM is filled as there is no real need for it ... reduzing the pool size just wastes performance ... <br><br></td></tr></table><br>
<a name="651505"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unfortunately, it is a leak, Dreamora.  You can't reuse the memory wasted by the still-in-use list. <br><br></td></tr></table><br>
<a name="651506"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> The strange thing is: That should not happen.<br>The delete method of TList does a clear as well.<br><br>This damned delete bugs (ie GC is still incapable of securely call the delete method on any drop!!) just let many internal data structures look bugged! <br><br></td></tr></table><br>
<a name="651602"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dmaz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Noel, does the memory not return on program completion? <br><br></td></tr></table><br>
<a name="651603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> It does, but that's irrelevant.  The thing we need to be concerned about is memory use and speed during runtime.  Creating new lists instead of clearing is not only slower but also can introduce memory leaks.  Depending on the size of the objects, the memory leak could be very, very large or 8 bytes minimum. <br><br></td></tr></table><br>
<a name="651827"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, usualy memory is not free when it's not used. BM can leave some 'overhead' memory when objects are deleted, becouse freeing and alocating memory is not much fast. Most of programing languages act like this. this not freed but unused memory is used to alocate new objects when necesary, while there is available memory on the computer. I can't ensure that BlitzMax does it this way, but it is the way it shoud work.<br><br>Anyway, there's no way to know exactly how GC manages memory unless you analize the source code of BlitzMax... and it's not an easy task to do <br><br></td></tr></table><br>
<a name="651891"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Anyway, there's no way to know exactly how GC manages memory unless you analize the source code of BlitzMax... and it's not an easy task to do <br></div><br><br>You're telling this to one of the people who did it. <br><br></td></tr></table><br>
<a name="651930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then you surely could fix the "delete call not guaranteed on deleting list from pool" error thats causing the mentioned problem ... Delete calls clear() but the delete does not seem to be called ... although there is no obvious reason for it. TLinks don't have a reference to their list so this should theoretically be deleted for sure and thus delete called. <br><br></td></tr></table><br>
<a name="651950"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >N</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm not doing BRL's job.  If you know this is in fact a bug, report it. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
