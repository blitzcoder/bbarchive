<!DOCTYPE html><html lang="en" ><head ><title >Finding the resolution of the desktop</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Finding the resolution of the desktop</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Finding the resolution of the desktop</a><br><br>
<a name="657580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How do I find the resolution (and possibly also depth and hertz) of the desktop, in a fully cross-platform compatible way, and preferably one method that works on all three platforms?<br><br>I had an idea to do it, although not very directly... <br><br>Open a window the size of the largest resolution available, acquired using CountGraphicsModes() and GraphicsModeExists() etc. The window opens on the desktop even if it is larger than the screen. Doesn't matter where it is positioned.<br><br>Next, move the mouse with MoveMouse() to 0,0. Then read the x and y mouse coords. Presumably, if the top left of the window is `off-screen`, the o/s will have cropped the mouse positioning and put it in the top left corner of the screen. The coords should tell you what `offset` you have in the top left corner.<br><br>Then position the mouse at the lower right corner of your window with MoveMouse() e.g. MoveMouse(1600,1200). Then read the x and y coords again and if they are less than the window size the o/s should have cropped the mouse's position and it should tell you how much of your window is visible.<br><br>Then close the window and open a new window with the visible size that you found. Then restore the mouse pointer to the position it was in originally.<br><br>????? I guess it would work. Any reasons why not?<br><br>I guess you'd have to take into account that at least on the Mac you can't open a window that covers the title bar, and maybe on the PC you can't open a window that covers the task bar (not sure about Linux) .... so should subtract a bit from the verticle size? Also what about window borders?<br><br>Is there a better reliable way?<br><br>Also, how to get GraphicsHertz()? Does it work in OpenGL and DirectX?<br><br>And how to get the color depth? Draw something with an 8-bit-per-component color resolution, flip the display, set the glReadBuffer() to the front buffer, grab the drawn piece into a 32-bit pixmap, look at the color resolution to see if what you drew came out in 32-bit or 16-bit? Also if it dithered, you might be able to detect some `un-pure` pixels? This would tell you if the desktop is 32-bit or 16-bit or whatever? Would it work?<br><br>Any other solutions? <br><br></td></tr></table><br>
<a name="657627"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Muttley</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Desktop().width<br>Desktop().height <br><br></td></tr></table><br>
<a name="657665"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is that a standard BlitzMax function, non-MaxGUI? <br><br></td></tr></table><br>
<a name="657706"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> GraphicsHertz() works on my Mac, but Desktop() doesn't exist. <br><br></td></tr></table><br>
<a name="657731"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Beaker</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Its a MaxGui only command. <br><br></td></tr></table><br>
<a name="657762"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> The mouse technique I mentioned does not work ---- if you position the mouse at 0,0, it still reports that it is at 0,0, even though the o/s displays the mouse at an offset. Same with the bottom right corner, it returns the size of the window rather than whether the mouse is actually in the bottom right - ie the o/s shows the mouse within the screen, but reports its position as outside the screen. Oh well.<br><br>Maybe I'll have to look into MaxGUI some more, just to get the desktop() command. <br><br></td></tr></table><br>
<a name="658050"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >d-bug</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Okay, Here is a little <a href="http://d-bug.future-coding.de/extern/DesktopExtension.rar" target="_blank">module</a>   hamZta and I once wrote to solve this problem. It only fits the resolution-part of your question, but that is the half way... :D<br><br>This one is limited to MacOS and Win32 since nobody could help me with the Linux code. I thought of waiting until the Linux part is done, but now i will provide it to help you out.<br><br>There are only two little functions in the module. DesktopWidth() and DesktopHeight(). Both return an Integer.<br><br>have fun with it ;) <br><br></td></tr></table><br>
<a name="658139"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Cool i'll give it a try. <br><br></td></tr></table><br>
<a name="658235"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> I ripped this out of my Windows screen saver code. I haven't got a clue how you'd do the Mac and Linux stuff. It's a start though. ;o)<pre class=code>Strict

Local w, h, d, r

DesktopGraphics(w, h, d, r)
Print "Desktop : " + h + "x" + w + "x" + d + "@" + r + "Hz"

End 

Function DesktopGraphics(width Var, height Var, depth Var, refresh Var)
?Win32 
	Local hdc = GetDC(GetDesktopWindow())
	If hdc = Null Then Return True
	
	width = GetDeviceCaps(hdc, HORZRES)
	height = GetDeviceCaps(hdc, VERTRES)
	
	depth = GetDeviceCaps(hdc, BITSPIXEL)	
	If depth &lt; 8
		depth = GetDeviceCaps(hdc, PLANES)
	EndIf	
	
	refresh = GetDeviceCaps(hdc, VREFRESH)
	If refresh &lt; 60 Then refresh = -1
?MacOS
	'???
?Linux
	'???
?
End Function</pre> <br><br></td></tr></table><br>
<a name="658238"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hamZta</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> @KevinTheKaleidoscopicKoala: This is exactly what d:bug's module does, plus MacOS support. <br><br></td></tr></table><br>
<a name="658259"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I was just going on d:bug's post...<br><div class="quote"> It only fits the resolution-part of your question, but that is the half way. <br></div><div class="quote"> There are only two little functions in the module. DesktopWidth() and DesktopHeight(). <br></div>I wasn't trying to step on anyone's toes. <br><br></td></tr></table><br>
<a name="658263"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well it's a start. I guess I could buy MaxGUI and just use Desktop() gadget which is known to be cross platform compatible.<br><br>I need OpenGL based version more than anything, not DX, cus I'm on a Mac. <br><br></td></tr></table><br>
<a name="658527"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >d-bug</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @AngelDaniel<br>just updated the <a href="http://d-bug.future-coding.de/extern/DesktopExtension.rar" target="_blank">archive</a>...<br><br>- Optimized the Win32 part<br>- Added DesktopBits() and DesktopHertz()<br><br>Sorry, still no Linux stuff<br><br>@KevinTheKaleidoscopicKoala<br>Hey, keep cool... You didn't step on anything. In fact, we helped each other. You showed me how to optimize my Win32 part and you can copy the MacOS part by opening the bmx file from my module, if hamZta will give you the permission to provide his macscreen.c ...<br><br>cheers <br><br></td></tr></table><br>
<a name="658533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> From memory (may be wrong) the GetGraphicsMode with index 0 will return the Linux Desktop resolution. <br><br></td></tr></table><br>
<a name="658579"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> @d:bug - Hey, no problem. There's no point having two solutions doing exactly the same thing, so I'd probably just use your mod if I need this in future. :o)<br><br>@skidracer - Would it be possible to allow GetGraphicsMode() to return the desktop info on all platforms, possibly using an index of -1 for backwards compatibility?<br><br>It'd be a very useful thing to have. <br><br></td></tr></table><br>
<a name="658637"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yah is that cross-platform feature?<br>Come to think of it probably not, eh? Cus I get the graphics modes from 0 to the number of modes-1. <br><br></td></tr></table><br>
<a name="658913"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >hamZta</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> @KevinTheKaleidoscopicKoala: Sorry, didn't want to sound that rude ;)<br>Feel free to use "macscreen.c" <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
