<!DOCTYPE html><html lang="en" ><head ><title >Making custom message boxes</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Making custom message boxes</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Making custom message boxes</a><br><br>
<a name="689516"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ryan Burnside</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm looking for some help or some ideas on how to impliment a scrollable messagebox into my game. My problem is making the text scroll and fit within the message box area. If you have done this in the past or could show me a good way to do it I would greatly appreciate it.<br><br><br>Perhaps this can explain better.<br><img src="http://img389.imageshack.us/img389/9849/helpthingcj9.png"> <br><br></td></tr></table><br>
<a name="689519"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >PantsOn</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> pseudo code....<br><br>message = "hello from me"<br>newmessage = ""<br>y = 0<br><br>***<br>search for next [space] in message<br>if there isnt one<br> word = message<br> message = ""<br>else<br> word = everything before space in message<br> remove word+[space] from message<br>endif<br><br>if fontwidth(newmessage+[space]+word) &gt; xlimit<br> print newmessage at yth line<br> newmessage = word<br> add 1 line to y<br>else<br> add [space] + word to newmessage<br>endif<br><br>repeat *** until nothing in message<br><br><br>I think. <br><br></td></tr></table><br>
<a name="689522"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's in BB but <a href="http://www.codersworkshop.com/viewpost.php?id=19328#19328" target="_blank"> this </a> might help. <br><br></td></tr></table><br>
<a name="689525"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've done something like that some weeks ago, works like a charm using maxGUI, but that's not going to stop a potential graphics-mode version.. <br><br>but first diner :P <br><br></td></tr></table><br>
<a name="689539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, exactly how should it work?<br><br>Since you're doing a game, I assume you're not using GUI I guess? But perhaps you do have the gui module for its events/eventhooks? (events so totally rock!)<br><br>Secondly, where does the text come from? From a string? From an incbin'ed textfile? <br><br></td></tr></table><br>
<a name="689675"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ryan Burnside</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Sorry I have been at work. It will take a string parameter. <br><br></td></tr></table><br>
<a name="689704"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> The string-format function is an easy one.. if you want me to make a displayer, I need to know whether or not I can use events (thus having MaxGUI).. <br><br></td></tr></table><br>
<a name="689705"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Unless I'm misunderstanding something about your approach CS_TBL, I don't know why you are concerned about MaxGUI. You don't need MaxGUI to utilize events or eventhooks in your code. <br><br></td></tr></table><br>
<a name="689708"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> uhm.. ok, not sure, I didn't have any Max until MaxGUI was released... does the standard bmax have the full eventsystem? (minus the GUI events naturally) <br><br></td></tr></table><br>
<a name="689709"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SculptureOfSoul</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yup. <br><br>At least, I don't think MaxGUI added anything besides GUI events. I've got a basic event system set up in one of my programs now, and don't have MaxGUI (...yet). <br><br></td></tr></table><br>
<a name="689752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >CS_TBL</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I don't dare go into displayers as they're way too game-dependent, but the way I've solved the text-issue means you can use a typical 2d-mapviewer to display this text.<br><br>So, the only thing this does it put a string into a bank, wordwrapped. Note that tabs, newlines and such <i>can</i> be *stored* in a bank, but not *processed*. In these cases I recommend against them, just use spaces. ;P<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
SuperStrict
Type TSimpleformattedtext

	Rem
	
		TSimpleformattedtext
		
		by CS_TBL
		
		Formats a given string into a bank, with wordwrap.
		
	EndRem

	Field columns:Int
	Field rows:Int
	Field bank:TBank=CreateBank()
	
	Method Cleanup(s$ Var)
		s=Replace(s,Chr(10),"")
		s=Replace(s,Chr(13),"")
		s=Replace(s,Chr(9),"")
	End Method
	
	Method Convert:TBank(s$,col:Int=16,clean:Int=1)
		columns=Max(col,1)
		s:+" "	
		
		If clean Cleanup s' &lt;- optional!
	
		Local word$
		Local wordlen:Int
		Local l:Int=Len(s)
		Local pointer:Int=0
		Local char$
		
		Local bankx:Int
		Local banky:Int
		
		Local adres:Int
		
		Local t:Int
		Local tt:Int
		
		
		ResizeBank bank,columns
		
		While pointer&lt;l ' do all chars..
			
			char=Mid(s,pointer+1,1)
			
			If char&lt;&gt;" "
				word:+char
				pointer:+1
			Else
			
				If word&lt;&gt;"" ' word found!
					wordlen=Len(word)
					If wordlen&lt;=columns
					
						If (bankx+wordlen)&gt;columns ' word doesn't fit line anymore?
							' wrap
							
							For tt=bankx To columns-1
								PokeByte bank,tt+(banky*columns),32
							Next
							
							ResizeBank bank,BankSize(bank)+columns ' add new line
							bankx=0
							banky:+1
							
							' add word
							For t=0 To wordlen-1
								adres=bankx+(columns*banky)
								PokeByte bank,adres,Asc( Mid(word,t+1,1) )
								bankx:+1
							Next
							
							If bankx&lt;columns-1
								PokeByte bank,bankx+(columns*banky),Asc(" ")
								bankx:+1							
							EndIf
							
						Else ' add word
						
							For t=0 To wordlen-1
								adres=bankx+(columns*banky)
								PokeByte bank,adres,Asc( Mid(word,t+1,1) )
								bankx:+1
							Next
							
							If bankx&lt;columns-1
								PokeByte bank,bankx+(columns*banky),Asc(" ")
								bankx:+1							
							EndIf
							
						EndIf
					EndIf
				
				EndIf
				word=""
				pointer:+1
			EndIf
			rows=banky
		Wend
		
		If bankx&lt;columns And bankx&gt;0
			For tt=bankx To columns-1
				PokeByte bank,tt+(banky*columns),Asc(" ")
			Next
		EndIf
		If bankx=0'-1
			For tt=bankx To columns-1
				PokeByte bank,tt+(banky*columns),Asc(" ")
			Next
		EndIf
		
		rows=(BankSize(bank)/columns)
		
		Return bank
		
	End Method	

End Type


Local b:TSimpleformattedtext=New TSimpleformattedtext
b.Convert "Hi, let's parse some text hmkay? If everything's well, this ~ntext will be wordwrapped"+..
" at a given length, And the result will go into a type with a rows field, a columns field and a bank"+..
". From all this, it's easy to make a simple map-displayer like the ones we use in games, only this time it"+..
" displays text! The size of the bank is .rows * .columns! Big words that don't fit, like these: "+..
"123456789abcdef12345678 are cancelled out",20

DebugLog b.rows
DebugLog b.columns

Showformattedtext b

b.Convert "We can use the same instance for more text!"

Showformattedtext b


End


' here's how to read out this text of ours.., transform it into your own typical 2D-mapdisplayer for scrolling/showing..
Function Showformattedtext(sft:TSimpleformattedtext)
	Local x:Int,y:Int
	Local s$=Chr(10)+Chr(10)
	For y=0 To sft.rows-1
		For x=0 To sft.columns-1
			s:+Chr(  PeekByte(sft.bank,x+y*sft.columns) )
		Next
		s:+Chr(10)
	Next
	DebugLog s
End Function
</textarea> <br><br></td></tr></table><br>
<a name="689879"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Ryan Burnside</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey, that's really cool thanks! I think I can work with this. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
