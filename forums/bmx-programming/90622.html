<!DOCTYPE html><html lang="en" ><head ><title >Realtime pixel manipulation? (Palette shifting)</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Realtime pixel manipulation? (Palette shifting)</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Realtime pixel manipulation? (Palette shifting)</a><br><br>
<a name="1030826"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mineth</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi,<br><br>I'm making a 2d game using small sprites of around 32x48 pixels each. The screen is scaled and zoomed accordingly so you can 'count the pixels' on a 800x600 screen which is really 320x240 pixels, but that's intended of this game and I'm not changing that.<br><br>I'm looking for a good way to manipulate pixels on realtime, namely palette shifting. I have a LOT of sprites using only up to 16 colors, and I want to shift colors every few frames. Recreating every sprite with different colors would take up too much memory tbh and shouldn't really be needed.<br><br>I can come up with a function like this:<br><br>for x until pixmaps.width OR screen.width<br>- for y until pixmaps.height OR screenheight<br>- - if readpixel(x,y) = color1a then writepixel(x,y,color1b)<br>- - if readpixel(x,y) = color2a then writepixel(x,y,color2b)<br>- - if readpixel(x,y) = color3a then writepixel(x,y,color3b)<br><br>But that's manipulating pixmaps (or the whole screen even) directly, and I'm not really sure if that's the fastest and best solution for this with looping that on multiple sprites (50+) every few frames.<br><br>Anyone got a nice solution to this? If anything's not clear, don't hesitate to ask. <br><br></td></tr></table><br>
<a name="1030839"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> One thing you can do is use SetColor to tint the sprite. It's basically like multiplying a value 0..255 by the value of each color component in the sprite. Normally SetColor $FF,$FF,$FF translates to multiplying by 1.0, since internally it gets converted from 0..255 to 0..1 range. But this tints the entire image. If you want to individually tint different parts of the sprite, you could have multiple sprite layers and do each separately. If you have 16-color sprites you could draw 16 layers separately?<br><br>There is no simple hardware-accelerated `remap colors` functionality. You can do it in a shader, or in a pixmap which is relatively slow.<br><br>How are you doing masking, do you use alphablending or just 1-color masking?<br><br>Here's an option. Since you only have 16-colors, copy the color `index` into the alpha channel of the sprite. You'll have alpha values of 0..15. Then use the alpha threshold/test to only draw pixels whose alpha = a given index value. Do 16 draws of the sprite with different alpha tests and color tints. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
