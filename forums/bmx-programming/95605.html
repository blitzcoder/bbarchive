<!DOCTYPE html><html lang="en" ><head ><title >Custom compiler directives</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Custom compiler directives</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Custom compiler directives</a><br><br>
<a name="1102371"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> How are people doing custom compiler directives these days? I'm at the point where I want to make different versions of my game from the same source. I'd like something along the lines of...<br><br><pre class=code>
?Demo=True

?Demo
	'Demo specific code here
?Not Demo
	'Full game specific code here
?
</pre><br><br>...but obviously this isn't possible. What are the current popular solutions for this? <br><br></td></tr></table><br>
<a name="1102378"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >computercoder</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats in the Conditional Compiling in Help.<br><br>If you look in the right pane, under Help -&gt; Language -&gt; Conditional compiling<br><br>This describes the various settings you can use.<br><br>I switch between Win32, MacOS, and Linux if I do anything with conditional compiling.<br><br>Hope this helps :) <br><br></td></tr></table><br>
<a name="1102381"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Make a const which is either true or false and use if statements. There is no way to make custom ones. <br><br></td></tr></table><br>
<a name="1102404"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Wouldn't it be possible to change the value of a Const with a hex editor?<br><br>Being able to add own conditionals would be a nice addition. <br><br></td></tr></table><br>
<a name="1102419"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Oddball</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> @computercoder: I think you've misinterpreted my query. I already use compiler directives, but I need a way to define custom compiler directives.<br><br>@Czar Flavius: As Htbaa has pointed out constants can be altered by the end user so using them isn't an option, especially if I'm using them to create the demo version of the game. I need a solution that will not compile the excluded code at all.<br><br>Has no one made a pre-compiler that does this? <br><br></td></tr></table><br>
<a name="1102421"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Make a const which is either true or false and use if statements. There is no way to make custom ones. <br></div><br>Only problem with that is BlitzMax compiles all the code regardless - potentially allowing someone to unlock the full game from the demo.  Previous versions of Blitz would omit any code that would never be executed.<br><br><div class="quote"> Wouldn't it be possible to change the value of a Const with a hex editor? <br></div><br>Not during compilation, as the reference to constants are replaced with the actual values.  Although, I'm guessing you mean as in the context above.<br><br><div class="quote"> Being able to add own conditionals would be a nice addition. <br></div><br>Yes, it would.  Or even just a demo directive would be nice.  Would save me from hacking my code to bits to produce a demo version. <br><br></td></tr></table><br>
<a name="1102424"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Htbaa</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> I guess for this top happen BlitzMax should allow preprocessing. Didn't Brucey ones experimented with it? <br><br></td></tr></table><br>
<a name="1102468"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Won't the assembly generator detected unused code? It seems strange it will still be compiled. <br><br></td></tr></table><br>
<a name="1102487"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote">  Not during compilation, as the reference to constants are replaced with the actual values.  <br></div><br><br>I don't believe this is true.  Constants are still used by reference. <br><br></td></tr></table><br>
<a name="1102488"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought integer constants are inserted into the code during compilation, and that assembly would detect a jump on a condition that never changed? <br><br></td></tr></table><br>
<a name="1102554"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JazzieB</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I don't believe this is true. Constants are still used by reference. <br></div><br>That doesn't make sense.  If they're still referenced, what's the point in using them?  I'm pretty sure that my assumption is true because it's a logical optimisation to do so.<br><br><div class="quote"> I thought integer constants are inserted into the code during compilation, and that assembly would detect a jump on a condition that never changed?  <br></div><br>I did a test some time ago by using two Print statements within an If..Then..Else clause using a constant and then checked the code in a hex editor after to see if both pieces of text were in the code.  And they were, so it looks like everything gets compiled.  It may have changed now though, as it was some time ago. <br><br></td></tr></table><br>
<a name="1102557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm pretty sure that my assumption is true because it's a logical optimisation to do so. <br></div>That's very dangerous!<br><br><div class="quote"> And they were, so it looks like everything gets compiled. <br></div>Indeed, I only thought otherwise because it seemed a logical optimisation to do so ;) <br><br></td></tr></table><br>
<a name="1102632"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GW</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> It was a few versions back, but I tested the option of using constants as compiler directives as both client and server projects pull from the same codebase for my project.  Looking at the generated assembly, constants will still used by reference.  It's an optimization that should have been done. <br><br></td></tr></table><br>
<a name="1102653"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Zeke</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What are the current popular solutions for this?  <br></div><br>use include:<br><pre class=code>
Include "full_game_code.bmx"
'Include "demo_game_code.bmx"
</pre><br>or rem/endrem:<br><pre class=code>
'full_game_code
' &lt; full game code here &gt;

Rem
 &lt; demo code here &gt;
endrem
</pre> <br><br></td></tr></table><br>
<a name="1102677"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TomToad</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just tested it myself.  The constant is replaced by the actual value any place it appears in the code.  The reference is kept when you compile in debug mode, despite not actually being used in the code, probably for the debugger.  In release mode, all references are replaced by the actual value and the constant completely disappears.<br><br><pre class=code>
SuperStrict

Const Number:Int = 5

Local Result:Int
Local Adder:Int = 25

Result = Number + Adder

Print Result
</pre><br><br>Assembler code Debug (comments added by me)<br><pre class=code>
' Local Adder:Int = 25
        mov	dword [ebp-8],25
'Some Debug Stuff
	push	_29
	call	dword [_bbOnDebugEnterStm]
	add	esp,4
'Result = Number + Adder
	mov	eax,dword [ebp-8]
	add	eax,5
	mov	dword [ebp-4],eax

</pre><br>Notice that "Adder" and "Result" are called by reference, yet "Number" was replaced by 5 in the code.<br><br>Assembler code Release<br><pre class=code>	mov	eax,25 'Adder
	add	eax,5 'Number
	push	eax
</pre><br>All references in release mode are optimized away from this simple example.<br><br>As for the OP, I tried using <b>If True</b> type thing, seems all code is still compiled regardless if in debug or release mode. <br><br></td></tr></table><br>
<a name="1102756"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >SLotman</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Solution is simple: have a demo with a separated assets. Even if someone crack the demo EXE, they will have a nice crash on their hands when the program tries to load images and sounds there aren't there.<br><br>Otherwise: different checks in different functions in different points of the game. Crackers usually just test if the game "started" - they don't play it to the end! So, a nice validation check near the end, another halfway into the game could be another solution. <br><br></td></tr></table><br>
<a name="1102841"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >computercoder</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> I like that idea SLotman :) Sounds very effective and a nice way to keep the game protected; even if someone gets passed part of the security! <br><br></td></tr></table><br>
<a name="1102919"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >H&amp;K</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ive not seen a demo in ages that wasnt simply the entire program minus some assets. (ie most levels)<br><br>Anyway to answer the question, use the community IDE (Or the uncompiled normal IE), and spend (I would guess 2 hours) adding your own ? directives.<br><br>(Im not sure, but does Blide managed builds do this already, or the community ide for that matter <br><br></td></tr></table><br>
<a name="1103046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2011)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Be very careful. What is to stop someone just downloading the full game content and putting it with their "demo" exe? If some non-demo required files are incbinned and only loaded from the incbin, that would be hard to break. But don't just load it from disk. (For the purposes of protection) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
