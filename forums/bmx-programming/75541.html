<!DOCTYPE html><html lang="en" ><head ><title >Networks behind NAT</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Networks behind NAT</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Networks behind NAT</a><br><br>
<a name="844029"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Has anyone tackled getting a connection to multiple individual machines who are behind a NAT (address translation) as part of their router or whatever? I have been reading about it a bit and about how due to a limited number of available IP addresses NAT tries to open up the network packets and replaces their IP addresses with a single address, so that it then looks like the packet came from one place so you don't know how to get a packet to come back to the correct computer... how do you get around this? I seem to recall experiencing this issue on an IRC client where it would not allow my two computers to both be on the same server a the same time. (This isn't a question about IRC, it's about how to implement networking (over UDP probably) so that you can support multiple machines in a home network? <br><br></td></tr></table><br>
<a name="844067"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Anyone? <br><br></td></tr></table><br>
<a name="844072"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Google for NAT Traversal. There are several more or less successful strategies that you may apply, depending on your specific needs. <br><br></td></tr></table><br>
<a name="844100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok thanks Mr Duck. <br><br></td></tr></table><br>
<a name="844141"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Winni</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> NAT routers keep tables, so the router knows where to send replies to.<br><br>If you want to be able to access a computer behind a NAT router/proxy, you need a) to know your public IP address and b) configure the router to assign a public IP address to a private IP and route that traffic through to the machine with that IP.<br><br>If you only have one public IP, you can use port mapping; port 6666 can point to 192.168.0.100 and port 6667 could point to 192.168.0.101, for example.<br><br>In any case, you only need this kind of routing when you want to run SERVERS on your private network that have to be accessible from the outside.<br><br>Remember, the NAT proxy/router keeps an internal table of your outgoing traffic, and it knows to which client machine it has to send the response. <br><br></td></tr></table><br>
<a name="844272"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why then do some games have support for playing on multiple machines behind a NAT while others don't? <br><br></td></tr></table><br>
<a name="844274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Becouse the server is public with static IP and is the user connecting to the server and not the other way. If there's not a game server, one of the clients has to accept connections so he needs a public known IP and port. <br><br></td></tr></table><br>
<a name="844346"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> UDP doesn't really have `connections`, though.<br><br>What if every client is also a server? <br><br></td></tr></table><br>
<a name="844576"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Wings</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> its simple<br><br>i am doing this via TCPIP. <br><br></td></tr></table><br>
<a name="844736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blueapples</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can use firewall punching, pretty sure this works for NAT&gt; Basically, both clients connect to the central server, and ask it to tell them who wants to connect to them. Each client then sends a UDP packet to the other, and viola! firewall punched.<br><br>Or anyway that's how I understand it. I've never had to do it.<br><br>"A somewhat more elaborate approach is where both hosts will start sending to each other, using multiple attempts. On a restricted Cone NAT, the first packet from the other host will be blocked. After that the NAT device has a record of having sent a packet to the other machine, and will let any packets coming from these IP address and port number through." <a href="http://en.wikipedia.org/wiki/UDP_hole_punching" target="_blank">UDP hole punching</a> <br><br></td></tr></table><br>
<a name="844754"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you get the client to send out a packet first and then it lets stuff through? <br><br></td></tr></table><br>
<a name="844822"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Blueapples</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> If they need to talk to each other directly, you get both clients to send stuff to each other using the central server to decide on a common port and figure out what ecah other's IP address is.<br><br>When each client sends packets to the other on the correct port, most NATs will see it as expected traffic and route it correctly. (A sends a packet to B on port 2000, this is blocked by B, but then B sends a packet to A on port 2000, this is accepted by A because it just sent a packet to B on that port, now A sends another packet to B and B accepts it now because it had previously sent a packet to A.)<br><br>If you only need the client to talk to the server then it should just work with NAT, provided you return packets on the same port that they sent them from (meaning you can't use 5 ports like HL2 does). This should just go right through NAT.<br><br>Now that I think about it, most firewalls will still block this, other than the built in Windows and Mac OS (I think, haven't tested it and I use Little Snitch) firewalls. Hopefully if the user has more than these permissive default firewalls installed, they will be adapt enough to configure their own firewall to let your traffic through.<br><br>I hope I'm not steering you wrong, it's been quite awhile since I had to do this kind of thing (haven't been in school for, oh what, three years? ;)<br><br>[Edited for clarity, though I doubt it's any clearer.] <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
