<!DOCTYPE html><html lang="en" ><head ><title >GNet timeout?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >GNet timeout?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >GNet timeout?</a><br><br>
<a name="1255556"></a>

<a name="1255557"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arska</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hello!<br><br>I was programming with my low end laptop and i encountered problem with gnet. Looks like server is little bit trigger happy to remove player when it takes too long to get in game and sync GNet. Any way to get around this? GNet timeout is not the case.<br><br>My game loads every entity's info from server and there might be over 1000 of these. Slow computer takes little bit more time to do this, so server kicks out. Little bit more means 1-3 seconds longer, but it's enough for gnet to throw out.<br><br>This is not happening with high-end PC:s even though FPS is same in-game with both computers. (Static 60)<br><br>Any ideas? <br><br></td></tr></table><br>
<a name="1255698"></a>

<a name="1255699"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Gnet itself does not seem to have "timeouts" set.<br><br>The only "time out" they use is in "enet_host_service()". They use "0", which means that only currently available events (enet is event driven) are returned. If you replace that 0 with 100 it will wait 100ms for incoming events. But this seems not to be the timeout you are searching.<br><br>I assume the "timeout" above is used to "gently" disconnect peers (give enough time for packets still on their travel between host/peer).<br><br><br>Ok ... let's check other timeouts:<br>pub.mod/enet.mod/enet.h: Line 175<br><pre class=code>
   ENET_PEER_TIMEOUT_LIMIT                = 32,
</pre><br><br>pub.mod/enet.mod/protocol.c is using this variable<br><pre class=code>
       if (outgoingCommand -&gt; roundTripTimeout == 0)
       {
          outgoingCommand -&gt; roundTripTimeout = peer -&gt; roundTripTime + 4 * peer -&gt; roundTripTimeVariance;
          outgoingCommand -&gt; roundTripTimeoutLimit = ENET_PEER_TIMEOUT_LIMIT * outgoingCommand -&gt; roundTripTimeout;
       }
</pre><br><br>Problematically it seems to do the calculation this way:<br>"if noOtherTimeGiven then time = ENET_PEER_TIMEOUT_LIMIT * peerRoundtriptime"<br><br>Means: the slow computer normally responds fast enough - which makes his roundtriptime low enough, now you run into your "big load loop" - roundtrip time increases above "problematic value".<br><br><br>Ok .. you have 3 options (I can think of): <br>a) increase ENET_PEER_TIMEOUT_LIMIT (Maybe adjustments to roundTripTimeout are equal in this case) - but what if the computer is even slower?<br>b) update enet/gnet while loading -&gt; after loading something, update gnet (even if no packet was received meanwhile)<br>c) use threading and do networking in a separate thread which is not blocked by resource loading<br><br><br>Just for simplicity: try variant b). It will work as long as you do not have a single resource of some gigabytes getting loaded. In that case even your resource loader must be changed to do it "chunk by chunk" and inbetween run the network update code (or a general "system update code").<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1255712"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Arska</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks for very detailed answer, Derron. I'll try that our when i get myself to slower computer. <br><br></td></tr></table><br>
<a name="1255720"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2015)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just add a "delay(xxx)" in your load-ressource to emulate that problem.<br><br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
