<!DOCTYPE html><html lang="en" ><head ><title >How does CONST compile?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >How does CONST compile?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >How does CONST compile?</a><br><br>
<a name="588779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I create a numeric CONST in BlitzMax, is that const compiled as a numeric literal?<br>I mean:<br><br>const Number1=4534<br>const Number2=5345<br>const Number3=5345<br><br>If I never use Number1 in my code, will Number1 be using memory, or just ignored by the compiler? In other words, does the compiler 'substitute' every Number1 occurence with its value or it's treatened as a variable?<br><br>In addition, what does happen with an abstract type full of const? I mean something like:<br><br>TYPE Keys abstract<br>   Const Enter = 13<br>   Const Escape = 27<br>   Const Tab = 9<br>End Type<br><br>Will this type declaration be using memory if I declare it in my code, but never use it? there aren't any methods or functions of fields, just const... <br><br></td></tr></table><br>
<a name="588848"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am guessing it puts that number into the actual code. There are CPU instructions that take `immediate data`, ie the number may actually be incorporated into the instruction code itself, or immediately followed by it. I would presume this is how constants compile down - ie the number appears at any place where it is used, stored right next to the instruction that uses it. That is, unless BlitzMax does it some other way. <br><br></td></tr></table><br>
<a name="588947"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hotcakes</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, you're right.  Any Const variables are replaced by their value at compile time, so 'Const number=5;a=6*number' is exactly the same as 'a=6*5', which in turn gets compiled as a=30.  Any mathematical operations that can be determined at compile time, are. <br><br></td></tr></table><br>
<a name="588965"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >MrCredo</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> for better understanding:<br><br>blitz put all constants after start to your memory. And it do not replace "number" to a numeric value. But number is a "pointer" to this memory-adress, so that you have all time eaqal values... <br><br></td></tr></table><br>
<a name="588995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Paul and Toby are correct. Constants do not "use memory" as they are hardcoded into your program as immediate values at compile time - that's why you can't change them at runtime.<br><br>More importantly however constants do not have to be seperately fetched from memory, but are loaded into the CPU instruction pipeline, during the initial instruction fetch.<br><br>Check the assembly output if you're in doubt. <br><br></td></tr></table><br>
<a name="589027"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Little addition: for string constants that may be very different. They have to be stored somewhere, and it's not guaranteed at all that the compiler elminates unused string constants.<br>As for the type issue, same problem: declaring the type means the implicit creation of some support code, the question being wether the compiler eliminates it if unused.<br><br>But the real question is: does that really matter? You won't be losing much memory in any case, so it's highly unlikely that it will make the slightest difference to your program. <br><br></td></tr></table><br>
<a name="589028"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Check the assembly output if you're in doubt.<br> <br></div><br>how would you go around doing that? <br><br></td></tr></table><br>
<a name="589030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> how would you go around doing that?  <br></div><br>BMax creates a .bmx folder in the same location as your source file, inside that there is a .s file, that is the assembly output. <br><br></td></tr></table><br>
<a name="589233"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> You technically can change the constants at runtime, it's called self-modifying code, which I kind of think is sometimes a good thing, but is more and more taboo these days, if not outright disallowed by the o/s. <br><br></td></tr></table><br>
<a name="589253"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >FlameDuck</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> The problem with self-modifying code (well ONE of the problems) and changing consts at runtime is that chances are you're using the same const litterally hundreds of times, and so would have to do the same when changing it - making it much slower than using variables. <br><br></td></tr></table><br>
<a name="589274"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Koriolis</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Errr, why would it be slower?<br>Either it's a type-1 const, in which case you won't be able to take it'as address and modify it in the first place, either it's a type-2 and then (provided it's stored in writable page - don't count on that) it's just a bunch of memory as any other variable.<br><br>Anyway, in any case attempting to fool the compiler and modify a const sliiiiighly defeats the purpose I dare to say... <br><br></td></tr></table><br>
<a name="589288"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Warpy</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> When I was working at a Real Games Company the programmer had something that let him recompile sections of code while the game was running. It was the coolest damn thing I've ever seen. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
