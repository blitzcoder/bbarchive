<!DOCTYPE html><html lang="en" ><head ><title >Saving data on the Exe itself..</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Saving data on the Exe itself..</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Saving data on the Exe itself..</a><br><br>
<a name="1340728"></a>

<a name="1340729"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi. lets say i have an app called Noter.exe<br>and i want to save some preset data inside the exe itself. like Page size, color, etc..<br><br>First, Is it possible?<br>Second, Is so, how do you exactly do that?<br><br>maybe its a basic question.. but Ive never done that.<br><br>I guess its something about defining some allocated memory or something.<br><br>Cheers and TY <br><br></td></tr></table><br>
<a name="1340740"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> A running .exe can't write to itself since the OS will have an exclusive lock on the file while it is running. <br><br>Realistically, you really should use the Microsoft guidelines on data storage locations to ensure it will work, and *continue* to work across future windows versions.<br><br><a href="https://blogs.msdn.microsoft.com/patricka/2010/03/18/where-should-i-store-my-data-and-configuration-files-if-i-target-multiple-os-versions/" target="_blank">https://blogs.msdn.microsoft.com/patricka/2010/03/18/where-should-i-store-my-data-and-configuration-files-if-i-target-multiple-os-versions/</a><br><br><br>But even if you could:<br><br>1) Modern Windows doesn't allow programs to write anything under the "c:\program files" folder structure post-install time<br>2) Pretty much all antivirus programs that use heuristics would/should prevent this from happening as well <br><br></td></tr></table><br>
<a name="1340742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> If it's "default" or built-in data, you can Incbin files, and load them at runtime.<br><br>If it's user-modifiable data, store it in the registry or the OS's official application storage area. <br><br></td></tr></table><br>
<a name="1340745"></a>

<a name="1340746"></a>

<a name="1340775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, you can. But it requires some trickery, and the caveats that xlsior mentioned still apply.<br><br>You have to use a second application that writes to the first one, and to make it work you have to set it up to run right before the first one exits.<br>The second application then has to wait for the first one to finish, then it can write to it.<br>And optionally the second application can then restart the first one.<br><br>Its pretty safe to append data to the end of an executable too, the EXE headers determine what is actually loaded into memory so the payload is never read by the OS loader.<br>To find the payload, either use some magic number before it and do a search. Or better, write the size of the payload after it and seek to the right offset.<br><br>If the payload size never changes, you could IncBin it and using the same method as above and overwrite the IncBined data instead.<br><br>Ive only tested this on Windows btw...<br><br><br>But honestly, id just use a config file or even the registry if i expected to land in Program Files. <br><br></td></tr></table><br>
<a name="1340751"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> the reason i asked that is because i tried to save some info on C:<br>with windows 10 by using WriteStream.. command<br>and it wouldnt allow me..<br><br>I guess due to windows restrictions.. <br><br></td></tr></table><br>
<a name="1340752"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> BaH.Volumes lets you get at the OS-specific folders with functions such as GetUserAppDir().<br>You'd normally create a subfolder in there for your app, and read/write whatever stuff you want. <br><br></td></tr></table><br>
<a name="1340755"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Then you probably should have asked about that ;)<br><br>Windows 10 does not allow writing to the root of C: and a bunch of other places unless the process has Admin rights.<br>Though any other dir you create yourself is fair game. <br><br></td></tr></table><br>
<a name="1340757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thats a  great idea brucey tnx :) <br>And yea grable good point :) <br><br>I just thought its a good idea to keep some data on the exe itself. <br>This way it never gets deleted. <br><br></td></tr></table><br>
<a name="1340765"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>I just thought its a good idea to keep some data on the exe itself. <br>This way it never gets deleted. <br> <br></div><br>Well, but if you (for any reason) delete the .exe, you lose even the data: not a very good move! <br><br></td></tr></table><br>
<a name="1340766"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> yea... sure.. Degac, its not good for anything.<br>in my case it is a simple settings data of a Text Editor. <br><br></td></tr></table><br>
<a name="1340774"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Following Microsoft's advisory seems a better idea than trying to hack your way around the limitations, because they are bound to break again down the road. <br><br></td></tr></table><br>
<a name="1340776"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >steve_ancell</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Hardcoal:<br>Just use a config file, it's a lot less hassle and you'll get your application finished quicker. ;) <br><br></td></tr></table><br>
<a name="1340778"></a>

<a name="1340779"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> If your only going to run this from NTFS and dont need to transmit over a network, you could also use Alternate Data Streams.<br>Windows itself uses it for Meta-Data attached to files/dirs, like that annoying "this file was downloaded and is insecure" popup.<br>But you can use them yourself and stick anything in there, the data will follow the file so long as it stays on an NTFS volume.<br><br>And you dont have to do anything special either, as its supported by most file level APIs, unless you want to enumerate them that is.<br><pre class=code>
Const TESTFILE:String = "c:\dump\ads.txt"
Const TESTMETA:String = TESTFILE + ":myspecialmetadata"

SaveString "test file for ads", TESTFILE
SaveString "test ads meta-data", TESTMETA

Print "contents of file -&gt; " + LoadString(TESTFILE)
Print "contents of meta-data -&gt; " + LoadString(TESTMETA)
</pre> <br><br></td></tr></table><br>
<a name="1340785"></a>

<a name="1340786"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzMan</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> BaH.Volumes lets you get at the OS-specific folders with functions such as GetUserAppDir().<br><br>system folders love it.:)<br><br>Don`t delete there C:/ drive. <br><br></td></tr></table><br>
<a name="1340808"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im going to exploit this post and ask this unrelated question.<br><br>how come there is this stupid message from microsoft "this action cant be completed because the folder or a file in it is open in another program"<br><br>how come windows cant tell you which program is using the file<br>instead of sending you to search by your self? <br><br></td></tr></table><br>
<a name="1340827"></a>

<a name="1340828"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >grable</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> Earlier Windows doesnt, but Windows 10 usually figures it out for you.<br>But it will print the program name instead of the EXE if the application has the right metadata.<br><br>As to why.. My guess is that MS is lazy, why fix something that doesnt count towards the new shiny, which is what they think sells their OS.<br>Though a lot of this changed with Windows 10 imo. <br><br></td></tr></table><br>
<a name="1340832"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Henri</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> In Windows 7 I use LockHunter to determine what process is holding the file. If the program can do it, there's nothing to stop MS from doing it, except for the reasons above.<br><br>-Henri <br><br></td></tr></table><br>
<a name="1340835"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ya Henri, Agree...<br>I can list you stupid things that microsoft is doing wrong but i will mention one more thing that bothers me.<br><br>they wont allow you to chose the User files location<br>they force you to have it in C. and thats dumb.<br>when you format your computer you loose all your stuff their. <br><br></td></tr></table><br>
<a name="1340851"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hardcoal: in a corporate environment using domain controllers you can use roaming profiles where the info get stored/synced to the network. Home users have less options. <br><br></td></tr></table><br>
<a name="1341994"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >dw817</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't know if this was answered to your satisfaction. You can certainly write to an EXE that is not being executed. For instance, if you want to create your own mini-compiler that builds single EXE w all the data you need.<br><br>This has been considered and done already, it's not that difficult. <br><br></td></tr></table><br>
<a name="1342020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grisu</td><td align="right"><font class=tiny>(Posted May)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'm all for the ini / xml solution. Static data via incbin.<br><br>Please never ever use the Windows registry! <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
