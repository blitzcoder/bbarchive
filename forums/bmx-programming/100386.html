<!DOCTYPE html><html lang="en" ><head ><title >cross platform 3d physics engine for bmax?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >cross platform 3d physics engine for bmax?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >cross platform 3d physics engine for bmax?</a><br><br>
<a name="1184810"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >UNZ</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is there any cross platform 3d physics engine for bmax?<br><br>I know there are amazing 2d physics but what about 3d?<br>I was thinking about jv-ode but this seems to be win only.<br><br>What about bullet physics? newton? an ODE that is cross platform?<br>Is there any ready-to-use wrapper? Would it possible to write one by myself for example a bullet wrapper?<br><br>thx <br><br></td></tr></table><br>
<a name="1184818"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >matibee</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's my bookmark to the latest Newton module, but I'm not sure if it's current and I've never got round to needing it (although I started using Newton in C/C++ probably 10 years ago now.)  At least Newton is cross platform and open source these days so it should be a good basis to start from.<br><br><a href="http://blitzbasic.com/Community/posts.php?topic=65656#733520" target="_blank">http://blitzbasic.com/Community/posts.php?topic=65656#733520</a><br><br>I have no knowledge of the other engines. <br><br></td></tr></table><br>
<a name="1184889"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> whats wrong with Xors3D? <br><br></td></tr></table><br>
<a name="1184916"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> whats wrong with Xors3D?<br>"I was thinking about jv-ode but this seems to be win only."<br> <br></div><br><br>Xors3D appears to sell itself as Windows/iPhone. Of course, perhaps it does more than the front page suggests. <br><br></td></tr></table><br>
<a name="1184917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Xors3D is a dead product and no longer supported. <br><br></td></tr></table><br>
<a name="1184918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> … and it may also be dead and no longer supported... <br><br></td></tr></table><br>
<a name="1184933"></a>

<a name="1184957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >UNZ</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> ok, newton it is.<br>I tried the stuff from<br><a href="http://blitzbasic.com/Community/posts.php?topic=65656#733520" target="_blank">http://blitzbasic.com/Community/posts.php?topic=65656#733520</a><br>with the stuff from<br><a href="http://www.blitzbasic.com/Community/posts.php?topic=51229#571413" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=51229#571413</a><br>in a slightly more simplified version (only one image)<br><br>The program starts and newton is initialized but the image is not moving.<br>BUT in about 3 out of 100 starts it DID move (or I hallucinate) without changing the code in any way.<br><br>Conclusion: I don't get it.<br>Here is the code:<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Strict
Framework BRL.Blitz
Import BRL.StandardIO
Import BRL.Retro
Import BRL.Max2d
Import BRL.GLMax2D
Import BRL.PNGLoader
Import PUB.Newton

Type ImageNode
	Field Image:TImage
	Field x:Int , y:Int , z:Int = 0
	Field rotX:Float , rotY:Float , rotZ:Float = 0.0
	Field mass:Float
	
	Function Create:ImageNode(ImgStr:String , tmpX:Int , tmpY:Int , tmpRot:Int)
		Local tmpN:ImageNode = New ImageNode
		tmpN.Image = LoadImage(ImgStr)
		tmpN.x = tmpX
		tmpN.y = tmpY
		tmpN.rotZ = tmpRot
		MidHandleImage tmpN.Image
		Return tmpN
	End Function
	
	Method draw()
		SetRotation rotZ
		DrawImage image , x , y
		SetRotation 0
	End Method
	
End Type



Rem '''''''''''''''''''''''''''''''''''
Max2DGetMatrix is the function to get the matrix from the Max2D Image And pass it
to an array to be used by Newton.
Max2DSetMatrix is the function to pass the Matrix from Newton to the Max2D Image 
EndRem

Function Max2DSetMatrix(NImageNode:ImageNode , NewtonMat:Float Ptr)
	DebugLog "set"
	Local Euler:Float[3]
	Euler[0] = NImageNode.rotX * (Pi / 180.0)
	Euler[1] = NImageNode.rotY * (Pi / 180.0)
	Euler[2] = NImageNode.rotZ * (Pi / 180.0)
	NewtonSetEulerAngle(VarPtr Euler[0] , VarPtr NewtonMat[0])
	Newtonmat[12] = NImageNode.X
	newtonMat[13] = NImageNode.Y
	NewtonMat[14] = NImageNode.Z	
End Function

Function Max2DGetMatrix(NImageNode:ImageNode , NewtonMat:Float Ptr)
	DebugLog "get"
	Local Euler:Float[3]
	NewtonGetEulerAngle(Varptr NewtonMat[0] , Varptr Euler[0])
	NImageNode.x = NewtonMat[12]
	NImageNode.y = NewtonMat[13]
	NImageNode.z = NewtonMat[14]
	NImageNode.rotX  =  Euler[0] * (180 / Pi)
	NImageNode.rotY  =  Euler[1] * (180 / Pi)
	NImageNode.rotZ  =  Euler[2] * (180 / Pi)
End Function
'////////////////////////////////////////////////////////// Newton
SetGraphicsDriver GLMax2DDriver()
Graphics 640 , 480 , 0 , 0

StartNewton()

Local Mat:Float[16]
Local velo:Float[3] 'velocity
Global Image1:ImageNode = ImageNode.create("brl.png" , 200 , 300 , 0)
Local nWorld:Byte Ptr = NewtonCreate(Null , Null)
Local collision:Byte Ptr = newtonCreateBox(nWorld , 100.0 , 100.0 , 100.0  ,Null)
Local NNode:Byte Ptr = NewtonCreateBody(nWorld , collision)

Max2DSetMatrix(image1 , Varptr Mat[0])
newtonBodySetMassMatrix(NNode , 10.0 , 1.0 , 1.0 , 1.0)
newtonBodySetMatrix(NNode , Varptr Mat[0])
newtonBodySetUserData(NNode , VarPtr Image1)
NewtonBodySetVelocity(NNode, VarPtr velo[0])
newtonBodySetTransformCallBack(NNode , PhysicsSetTransform)
newtonBodySetForceAndTorqueCallback(NNode , PhysicsApplyForceAndTorque)

'''/////////////	The UP VECTOR 
 'this line makes all the work to lock x , y rotation axis
'Local UpVector:Float[] = [0.0 , 0.0 , 1.0]
'newtonConstraintCreateUpVector(nWorld , Varptr UpVector[0] , NNode)
'/////////////////////
'for omega i puted rotation only to the z axis cause in 2D rotation happens only in z.
Local Omega:Float[] = [5.0 , 5.0 , 5.0]
newtonBodySetOmega(NNode , Varptr omega[0])

NewtonReleaseCollision(nWorld , collision)

'//////////////////////////////////////// Newton CallBack Functions
Function PhysicsSetTransform(tmpNNode:Byte Ptr , tmpMat:Float Ptr)
	Local tmpImageNode:ImageNode= image1
	newtonBodyGetMatrix(tmpNNode , Varptr tmpMat[0])
	Local Euler:Float[] = [0.0 , 0.0 , tmpImageNode.rotZ]
	Max2DGetMatrix(tmpImageNode , VarPtr tmpMat[0])
End Function

Function PhysicsApplyForceAndTorque(tmpNNode:Byte Ptr)
	Local Mass:Float
	Local Ixx:Float
	Local Iyy:Float
	Local Izz:Float

	newtonBodyGetMassMatrix(tmpNNode , Varptr Mass , Varptr Ixx , Varptr Iyy , Varptr Izz)
	Local force:Float[] = [1.0 , Mass * 9.8 , 2.0]
	Local torque:Float[] = [1.0 , 3.0 , 2.0]
	newtonBodySetForce(tmpNNode , VarPtr force[0])
	newtonBodySetTorque(tmpNNode , VarPtr torque[0])
End Function

'////////////////////////////////////	Main Loop
While Not KeyDown(key_Escape)
	Cls
	newtonUpdate(nWorld , FPS.Calc())
	image1.draw()
	newtonBodyGetMatrix(NNode , Varptr Mat[0])
	For Local i:Int = 0 To 15
		DrawText mat[i] , 10 , i * 10
	Next
	DrawText image1.rotZ , 10 , 200
	
	fps.display()
	Flip
Wend

StopNewton()

Type FPS
	' FPS_Counter &lt;&gt; Runs and displays the FPS
	Global Counter, Time, TFPS
	Function Calc:Float()
		Counter:+1
		If Time &lt; MilliSecs()
			TFPS = Counter '&lt;- Frames/Sec
			Time = MilliSecs() + 1000'Update
			Counter = 0
		EndIf
		Return TFPS
	EndFunction
	Function Display()
			DrawText "FPS: "+FPS.Calc(),10,220
	End Function
EndType
</textarea><br><br>EDIT:<br>oh wait! I checked the newton api of the functions I use here and discovered some differences. Updated the mod and now it does move regularly. I will play a bit with newton the next days. It's kinda interesting :) <br><br></td></tr></table><br>
<a name="1184955"></a>

<a name="1184964"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Hardcoal</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> im using xors3d and I hope even that its dead i can still use it as it is. <br><br></td></tr></table><br>
<a name="1184978"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi. Klepto2 interfaced Newton with MiniB3D. The build of Newton he uses is for Win32 only, but it's a start.<br><br>Check this: <a href="http://code.google.com/p/minib3dextended/" target="_blank">http://code.google.com/p/minib3dextended/</a><br><br>You'll want to download the beta package as well; It's an earlier version of his wrapper that includes some more functionality (but it doesn't follow the cleaner "plugin-in" approach he used in his newest extention): <a href="http://www.mediafire.com/?z1guvz9rip956at" target="_blank">http://www.mediafire.com/?z1guvz9rip956at</a> <br><br></td></tr></table><br>
<a name="1185220"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >LT</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had to mess around with Klepto's wrapper a bit to get it working, but it does work pretty well once you get it going.  It depends on what engine you're using, I suppose.<br><br>Whether or not YOU can write a Bullet wrapper is a question only you can answer, but it is certainly possible.  I may try to tackle that some time down the road, but Newton will do, for now. <br><br></td></tr></table><br>
<a name="1185282"></a>

<a name="1185339"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >UNZ</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Newton is really nice. But now I'm stuck at the same point as <br><a href="http://www.blitzbasic.com/Community/posts.php?topic=76234" target="_blank">http://www.blitzbasic.com/Community/posts.php?topic=76234</a><br>5 years ago.<br><br>EDIT:<br>Forget it. I will use the dll. Just got an idea... <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
