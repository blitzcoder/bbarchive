<!DOCTYPE html><html lang="en" ><head ><title >Import a Visual Studio static library</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Import a Visual Studio static library</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Import a Visual Studio static library</a><br><br>
<a name="1158679"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Is it possible to import a C++ Visual Studio static library?  The commands I am interested are externed as C functions.  I get a ton of linker errors when I try importing my .lib. <br><br></td></tr></table><br>
<a name="1158683"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> I believe you'll have to convert it to a .a file. There are various tools if you Google 'lib to a', though I've no idea how good they are. Here's an example:<br><br><a href="http://code.google.com/p/lib2a/" target="_blank">http://code.google.com/p/lib2a/</a> <br><br></td></tr></table><br>
<a name="1158739"></a>

<a name="1158740"></a>

<a name="1158743"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hiya<br><br>I'm using MingW gcc 4.6.2 and I can import and use the VS static .lib files straight into BMax. MingW is said to be compatible with VS .lib files nowadays, but how far this goes I'm not sure. I can get it work ok with functions but I've not tried it with classes etc.<br><br>Some keynotes:<br><br>Say the static library generated from your VS project is called 'foo.lib' then in BMax use<br><br>Import "-lfoo"<br><br>There's no need to rename the file to foo.a or libfoo.a or similar, but you can if you want to, just change the name within the quotes accordingly.<br><br>You can use Import "-L*folder_name*" where *folder_name* is a folder to include when searching for and linking library files. EDIT- This folder path CANNOT have spaces anywhere!<br><br>One last thing is the calling convention, I'm sure you already know it's imperative it is the same in your VS project and BMax. I've statically linked Microsofts own VS .lib files straight into BMax with success. I know your'e using the c++ extern"c" to prevent name-mangling but you can still set the calling convention using __stdcall or __cdecl accordingly.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1158741"></a>

<a name="1158742"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> It still requires a DLL after the .a file is generated.  Is there any way to do it without a DLL?<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1158746"></a>

<a name="1158749"></a>

<a name="1158753"></a>

<a name="1158756"></a>

<a name="1158757"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >col</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> EDITed as I was chatting gibberish.<br><br>There are 2 formats of .lib for VS. One produced when creating a static library project, and a different one produced when creating a .dll<br>The one I link to is the one created for a .dll.<br><br>I'll be quiet now.<br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="1158750"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> LIB2A wants a DLL. <br><br></td></tr></table><br>
<a name="1158775"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> LIB2A might be written especially for the situation where you have your own DLL (ie. with source) that you want to turn into a static lib. Try Googling "convert lib to a", which turns up a fair few pointers... looks like "reimp", part of MinGW, *might* be what you want.<br><br>This thread seems to agree with col's first post, though, regarding direct import of .lib files, so my pointer about converting to .a might be irrelevant now anyway:<br><br><a href="http://www.gamedev.net/topic/360137-converting-lib-to-a/" target="_blank">http://www.gamedev.net/topic/360137-converting-lib-to-a/</a><br><br>However, it might be that your particular .lib 'describes' a DLL as in col's post above, rather than replaces it.<br><br>What library are you trying to convert? <br><br></td></tr></table><br>
<a name="1158841"></a>

<a name="1158842"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2012)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> No, I have a .lib file that is self-contained.<br><br>The LIB2A .bat example uses a DLL.  From the instructions:<br><div class="quote"> How it works<br><br>The conversion process is accomplished in several steps:<br><br>    Copy your .LIB file and .DLL file into the "convert" folder.<br><br>    Edit and replace the files names in the four first lines at the LIB2A.bat.<br><br>    Run LIB2A.bat. <br><br>You can find your .A linker library into the "convert" folder.  <br></div><br><br><font class="tiny">Last edited 2012</font> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
