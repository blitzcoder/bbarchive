<!DOCTYPE html><html lang="en" ><head ><title >Alternative to grabpixmap?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Alternative to grabpixmap?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Alternative to grabpixmap?</a><br><br>
<a name="1032803"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sanctus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey guys.<br>I'm on the verge of finishing my first commercial game as a Indie. Right now I'm spending time improving there and there and trying to make it as nice as possible.<br>Anyway, when you clicked on Main Menu it just returned you there and that wasn't very nice. I thought it would be a nice idea to actually ask if that was wanted. So how else to do it besides a dialog right?<br>Now... for a dialog to work everything in the background is supposed to be frozen.<br>My plan was to take a "screen-shot" with grabpixmap and then enter a while loop where that's drawn and the dialog is drawn and updated until something has to be returned. It works very nice but I think grabpixmap is very slow. The game freezes for like a second when the dialog should appear.<br>Is there any alternative to this? Rendering everything to a texture is kind of taking it too far if I have to modify all the rendering code. <br>Thanks guys. <br><br></td></tr></table><br>
<a name="1032804"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TWH</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> You could make everything in your game freeze... Pause the game in other words and then draw your dialogue on top. But that's probably too much work.<br><br>Another option could perhaps be to lower the amount of data grabpixmap has to ...grab by rendering at a low resolution. 320x240 or something like that, and then stretch that image. It wouldn't be that pretty. <br><br></td></tr></table><br>
<a name="1032805"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sanctus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well the dialog covers like 1/4 of the screen so a smart thing would be to drab more smaller chunks and put them on the final pixmap but... not sure if that would be a good idea.<br><br>And yes... actually freezing the game is not that nice since I'm mostly an adept of "nice code" or at least try to be and this would be pretty much hard-coded. <br><br></td></tr></table><br>
<a name="1032815"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Sanctus</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I found a solution with OpenGL:<br><br>screenShot = CreatePixmap(GraphicsWidth(), GraphicsHeight(), PF_RGBA8888)<br>glReadPixels(0, 0, GraphicsWidth(), GraphicsHeight(), GL_RGBA, GL_UNSIGNED_BYTE, screenShot.pixels)<br>screenShot = YFlipPixmap(screenShot)<br><br>I'd say it's 30 times faster(I'm getting an average of 30 ms upon calling this). Now to find something for DX.<br><br>EDIT:<br>from d3d7max2D:<br><br>surf.GetDC Varptr destdc<br>BitBlt destdc,0,0,width,height,srcdc,x,y,ROP_SRCCOPY<br>surf.ReleaseDC destdc<br>renderSurf.ReleaseDC srcdc<br><br>I'm shocked. I don't know much about directx but I know that using DC and BitBlt is like milking a dead cow. There has to be a better solution to this. <br><br></td></tr></table><br>
<a name="1032863"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Jesse</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I tried your approach before and left it behind for that same reason. the way I do it now is, I have all of my program in object types. my types are separated in create, update and display. when I want to pause the program and send control to a window, my main types skip the update process and just use the draw part of the object while the new window gets full control. <br>it is fully functional on a tile map editor I am working. posted here:<br><br><a href="http://www.blitzmax.com/Community/posts.php?topic=90330" target="_blank">http://www.blitzmax.com/Community/posts.php?topic=90330</a><br><br>In your case, I suspect it might be a bit late for that. <br><br></td></tr></table><br>
<a name="1032868"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I am most shocked that you're finding GrabPixmap to be 30 times slower than your proposed OpenGl solution... because essentially GrabPixmap also calls glReadPixels(). Is it really that must faster?<br><br>An alternative which will be way faster than either, for GL, is to call glCopyTexSubImage2D() ... copies the backbuffer into an existing texture. <br><br></td></tr></table><br>
<a name="1032869"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >slenkar</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> my OpenGL max2d renderer uses glCopyTexSubImage2D()<br><a href="http://blitzbasic.com/codearcs/codearcs.php?code=2612" target="_blank">http://blitzbasic.com/codearcs/codearcs.php?code=2612</a> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
