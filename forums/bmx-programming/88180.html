<!DOCTYPE html><html lang="en" ><head ><title >OpenAL grief</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >OpenAL grief</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >OpenAL grief</a><br><br>
<a name="1001046"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> This has been mentioned in the forum before but I run into problems with it unfortunately. I've copied OpenAL32.dll (and wrap_oal.dll just in case) as specified in the other posts but the code below does not show me the OpenAL driver?<br><br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
EnableOpenALAudio()
For s:String = EachIn AudioDrivers()
	Print s
Next
</textarea><br><br>I have saved the DLL:s in the same folder as the compiled file above and the result is:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Executing:test.debug.exe
FreeAudio
FreeAudio Multimedia
FreeAudio DirectSound
DirectSound
Null
</textarea><br><br>If I install the distributable OpenAL I see it in the list, but I just want to wrap it in the game - additional installs is an absolute nono for me :)<br><br>(I'm running Windows 7 x64 by the way)<br><br>any thoughts? <br><br></td></tr></table><br>
<a name="1001061"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >theHand</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Only to provide support for both OpenAL and FreeAudio (falling back to FreeAudio if OpenAL is not installed on the user's computer).<br>Sorry. :( <br><br></td></tr></table><br>
<a name="1001078"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ouch, is it that bad? =) Thanks for the reply though! <br><br></td></tr></table><br>
<a name="1001081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's interesting, because all it does is this :<br><pre class=code>
	openAL=LoadLibrary( "OpenAL32.dll" );
</pre><br>which should work if the dll is in the same folder as the executable. <br><br></td></tr></table><br>
<a name="1001088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >markcw</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Try it in release mode. <br><br></td></tr></table><br>
<a name="1001089"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Ouch, is it that bad? <br></div>No - OpenAL works.<br><br>Are you absolutely sure you've got the DLLs in the right place?  Because what you're getting is a classic symptom of the DLL not being found.<br><br>Or do you have some funky Frameworking/Importing going on? <br><br></td></tr></table><br>
<a name="1001098"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> No framework or import and I've also tried this:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
Print EnableOpenALAudio()
For s:String = EachIn AudioDrivers()
	Print s
Next
Print FileType("OpenAL32.dll") 
</textarea><br><br>and my output is this:<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">
0
FreeAudio
FreeAudio Multimedia
FreeAudio DirectSound
DirectSound
Null
1
</textarea><br><br>If I install OpenAL it will work, but if I copy the DLL from windows\system32 to my folder where the compiled file is and then uninstall OpenAL, I get the result above. <br><br></td></tr></table><br>
<a name="1001100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Oddness.  Here's what I just did:<br><br>1. Create a folder on desktop.<br><br>2. Put OpenAL32.dll and wrap_oal.dll in it.<br><br>3. Create a new .bmx file with this code in:<pre class=code>Print EnableOpenALAudio()
For s:String = EachIn AudioDrivers()
	Print s
Next
Print FileType("OpenAL32.dll") </pre><br><br>I get this:<pre class=code>1
OpenAL Default
OpenAL Generic Software
OpenAL
FreeAudio
FreeAudio Multimedia
FreeAudio DirectSound
DirectSound
Null
1</pre><br><br>I also checked that the OpenAL DLLs were not in C:\Windows\System32.<br><br>My DLL versions:<br>OpenAL32.dll: 6.14.0357.22<br>wrap_oal.dll: 2.1.8.1<br><br>32-bit Windows 7<br>BlitzMax 1.36<br><br>[edit] Just tried with the latest version of OpenAL (6.14.0357.24 and 2.2.0.5).  Worked perfectly - same result as above. <br><br></td></tr></table><br>
<a name="1001109"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> That's so odd...<br><br>I've got OpenAL32.dll: 6.14.0357.24 and wrap_oal.dll: 2.2.0.5 and do exactly as you do with no OpenAL and EnableOpenALAudio() returns false.<br><br>64-bit Windows 7<br>BlitzMax 1.36 <br><br></td></tr></table><br>
<a name="1001138"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> On Windows Vista and 7 OpenAL will fail to initialize on some machines if you don't actually install it with the OpenAL installer.  It isn't enough just to drop the DLL in the app folder.<br><a href="http://connect.creativelabs.com/openal/Downloads/oalinst.zip" target="_blank">http://connect.creativelabs.com/openal/Downloads/oalinst.zip</a> <br><br></td></tr></table><br>
<a name="1001145"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> On Windows Vista and 7 OpenAL will fail to initialize on some machines if you don't actually install it with the OpenAL installer. It isn't enough just to drop the DLL in the app folder. <br></div>I didn't know that.  Have you experienced it first hand?  I distribute OpenAL with the exe and it's worked on all Vista and Windows 7 machines I've tried it on (and BFG's test lab). <br><br></td></tr></table><br>
<a name="1001154"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have experienced this firsthand.  See post by "trogdor" here:<br><a href="http://forum.thegamecreators.com/?m=forum_view&amp;t=136731&amp;b=2" target="_blank">http://forum.thegamecreators.com/?m=forum_view&amp;t=136731&amp;b=2</a><br><br>Looks like it is also an XP issue. <br><br></td></tr></table><br>
<a name="1001159"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> From your link:<div class="quote"> I found out you actually have to install OpenAL on Vista, you can't just include the DLL like I did. In the future, I will just include the OpenAL installer <br></div>But it isn't a global problem.  The OpenAL issue doesn't happen for me on any of my Vista PCs, or on Windows 7.<br><br>Why would this be?  The DLL is either there, or it isn't? <br><br></td></tr></table><br>
<a name="1001162"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Must be some other requirement that you don't know to account for.  Maybe a more common DLL that is included with something else? <br><br></td></tr></table><br>
<a name="1001164"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> I've done some googling and found, among other things, <a href="http://opensource.creative.com/pipermail/openal/2004-July/007655.html" target="_blank">this</a>.<br><br>Seems that there are ways to get OpenAL to not work.  Now, I know chuff-all about the intricacies of such things, so.... anybody else? <br><br></td></tr></table><br>
<a name="1001167"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> I figure the installer does something additional besides just copying the DLL.  Whatever that extra thing is, some sound drivers need it, some don't.<br><br>I would just make your game installer have an option to run the OpenAL installer after installing the game. <br><br></td></tr></table><br>
<a name="1001171"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Why would this be? The DLL is either there, or it isn't? <br></div>You do not mention what versions of Vista or 7 you are using.  <br><br>The problem is Imphenzia is not playing by the rules.  He is putting the DLL in the wrong directory for a 64 bit OS:<br><br>32 bit DLLs must be placed in C:\Windows\SysWOW64<br>Only 64 bit DLLs can be in the system32 directory. <br><br>If you want to put a 32bit DLL in the same directory as a 32bit EXE and expect it to work you need stick with 32bit versions of Vista and 7.  Otherwise, you have to play by the rules MS has set. <br><br></td></tr></table><br>
<a name="1001173"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I would just make your game installer have an option to run the OpenAL installer after installing the game. <br></div>There are a host of problems with that, though.<br><br>1. If the user becomes aware that something extra is being installed - panic.<br>2. If you install it silently and they find it later they could:<br>a: be p*ssed off about it<br>b: uninstall it without realising what it is<br><br>...and what if openAL is already installed?  What would happen?  What if the user already has a <i>newer</i> version installed?<br><br>GaryV: I'm on 32-bit Windows 7 and Vista. I'm half-tempted to install Windows 7 64-bit to test the theory but I'd be raising an eyebrow if BFG's test department didn't have a single 64-bit system to test on, and apparently they've never come across OpenAL failing. <br><br></td></tr></table><br>
<a name="1001175"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> You can load as many 32 bits dlls as you wish from a 32 bits application on windows 64 bits. Be sure to not be trying to load a 64bits dll from a 32bits exe. <br><br></td></tr></table><br>
<a name="1001180"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>The problem is Imphenzia is not playing by the rules. He is putting the DLL in the wrong directory for a 64 bit OS:<br><br>32 bit DLLs must be placed in C:\Windows\SysWOW64<br>Only 64 bit DLLs can be in the system32 directory. <br> <br></div><br><br>Well, the official OpenAL-installer is actually putting the OpenAL32.dll into c:\windows\system32 and if the installer is used BlitzMax finds OpenAL.<br><br>I'm guessing the installer just uses regsvr32 to register the DLL for windows awareness. <br><br></td></tr></table><br>
<a name="1001181"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'm half-tempted to install Windows 7 64-bit to test the theory <br></div>MSDN, I can't claim the theory ;)<br><br><div class="quote"> Well, the official OpenAL-installer is actually putting the OpenAL32.dll into c:\windows\system32 and if the installer is used BlitzMax finds OpenAL. <br></div>No, the OS recognizes it as a legacy application and uses virtualization. <br><br></td></tr></table><br>
<a name="1001184"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> 1. If the user becomes aware that something extra is being installed - panic.<br>2. If you install it silently and they find it later they could:<br>a: be p*ssed off about it<br>b: uninstall it without realising what it is <br></div><br>Unreal Tournament 3 does the same thing, if I remember right.<br><br><div class="quote"> ...and what if openAL is already installed? What would happen? What if the user already has a newer version installed? <br></div><br>There are no new versions of OpenAL.  The installer has been the same for years. <br><br></td></tr></table><br>
<a name="1001186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> After reading up on OpenAL it seems you can run the installer in silent mode, and prevent it from installing an uninstaller.  Not quite sure how UAC would take to that...<br><br>I presume the likes of InnoSetup/Installshield allow you to run external installers but to be honest I can't be bothered to look. <br><br></td></tr></table><br>
<a name="1001195"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> <br>Well, the official OpenAL-installer is actually putting the OpenAL32.dll into c:\windows\system32 and if the installer is used BlitzMax finds OpenAL. <br><br>No, the OS recognizes it as a legacy application and uses virtualization. <br> <br></div><br><br>How very correct you are :)<br><br>SOLUTION: I copied the OpenAL32.dll from C:\Windows\SysWOW64 (106kb) instead of C:\Windows\System32 (120kb virtualized file?) and it now works perfectly without OpenAL installed.<br><br>Thank you all for engaging in this thread and thanks to GaryV for pointing me to the solution. <br><br></td></tr></table><br>
<a name="1001202"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> NP, I deal with the same 32bit DLL problem quite often at work :( <br><br></td></tr></table><br>
<a name="1001216"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> So Imphenzia, where is the dll now?  In the exe folder or somewhere else? <br><br></td></tr></table><br>
<a name="1001247"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Imphenzia</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#27">[#27]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> So Imphenzia, where is the dll now? In the exe folder or somewhere else?  <br></div><br><br>Yes, in the same folder as the .exe (or .bmx when I compile).<br><br>So just be aware where you copy the file from when you distribute it with the game, if it's from x64 get it from C:\Windows\SysWOW64 as that is the "proper" dll. <br><br></td></tr></table><br>
<a name="1001250"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#28">[#28]</a></td></tr></table></td></tr><tr ><td class="posttext"> So, there are two different sets of DLLs?  Never dealt with this 'virtualisation' lark so I dunno what the actual solution is here? <br><br></td></tr></table><br>
<a name="1001271"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GaryV</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#29">[#29]</a></td></tr></table></td></tr><tr ><td class="posttext"> It is not virtualization that was the issue.  He was using the wrong DLL.  <br><br>On a Vista/7 64bit, your BlitzMax stuff runs under emulation.  Windows-on-Windows 64-bit is the emulation layer.  On a 64bit OS, SysWOW64 is where 32bit DLLs go (can be found) and System32 is where 64bit DLLs go (can be found).<br><br>Imphenzia was grabbing the wrong DLL.  ON a 64bit OS, OpenAL's installer installs 32bit and 64bit DLLs.  Imphenzia was grabbing the 64bit DLL.  <br><br>Since we started migrating to 7 64 at work, I deal with people putting 32bit DLLs in the System32 directory all day.  As noted before, on a 64bit OS, System32 is for 64bit DLLs.  <br><br>What makes it worse is some older installation programs contain trust info, but do not properly check for a 64bit OS and will install DLLs in the wrong directory.  Other older installation programs do not contain trust info and can get recognized as legacy applications and it is installed using virtual locations which is not a major issue on a 32bit OS, but can create havoc on a 64bit OS. <br><br></td></tr></table><br>
<a name="1001296"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#30">[#30]</a></td></tr></table></td></tr><tr ><td class="posttext"> Right, so the method I use of including the 32-bit dll in the folder with the exe will still work. Good to know. <br><br></td></tr></table><br>
<a name="1001304"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#31">[#31]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, there's no problem using the 32 bits dll from a 32 bits program on a 64 bits windows machine. <br><br></td></tr></table><br>
<a name="1001312"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#32">[#32]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought LoadLibraryA() would preferentially load the DLL that was in the application directory? <br><br></td></tr></table><br>
<a name="1001314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Mr. Write Errors Man</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#33">[#33]</a></td></tr></table></td></tr><tr ><td class="posttext"> Windows (since some XP SP) checks DLLs first from system folders, only then from the "folder with the exe". Even if the ones in system folders are older versions etc. <br><br></td></tr></table><br>
<a name="1001320"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2009)</font>&nbsp;<a href="#34">[#34]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Windows (since some XP SP) checks DLLs first from system folders, only then from the "folder with the exe". Even if the ones in system folders are older versions etc. <br></div><br>That is odd, because glIntercept works by dropping a dummy of OpenGL32.dll in the application directory.<br><br>So the solution is to use LoadLibraryA(appdir+"/OpenAL32.dll") to ensure your copy of the 32-bit DLL is loaded? <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
