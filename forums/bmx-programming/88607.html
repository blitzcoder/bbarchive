<!DOCTYPE html><html lang="en" ><head ><title >Compressed floats?</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Compressed floats?</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Compressed floats?</a><br><br>
<a name="1006210"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does anyone have code to convert a 32-float to a 16-bit float and back?  I would like to try this to lower my physics networking bandwidth. <br><br></td></tr></table><br>
<a name="1006227"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you sure you want to do that... the loss of accuracy would be huge.<br><br>It would almost be better to multiply the float by your intended accuracy and convert to an INT<br><br><pre class=code>
val:float=1234.23432
Send:INT=INT(val * 100000.0)
Recv:Float=Float(Send)/100000.0
</pre> <br><br></td></tr></table><br>
<a name="1006228"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ImaginaryHuman</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Such code used to be in the GNet code by Mark, but I think he took it out to revert back to 32-bit. Maybe if you look at an older version of blitzmax sourcecode? <br><br></td></tr></table><br>
<a name="1006236"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> I wonder just how much information is being sent that the difference between 32 and 16 bit floats is going to make that much difference...and there will be a cost of processing that conversion as well <br><br></td></tr></table><br>
<a name="1006237"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Skully: Except an INT is 4 bytes, so you wouldn't actually lower the # of bytes that need to be transmitted... <br><br></td></tr></table><br>
<a name="1006241"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Czar Flavius</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Maybe you could use some kind of maths or bitwise mumbo jumbo to store two 16-bit floats in one 32-bit float variable? <br><br></td></tr></table><br>
<a name="1006243"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I wonder just how much information is being sent that the difference between 32 and 16 bit floats is going to make that much difference...and there will be a cost of processing that conversion as well <br></div><br>If it works it will let me transmit twice as much physics data in the same amount of bandwidth.<br><br>I found Mark's code, thanks!<br><br><br><br>It is a bit sketchy at low velocities, but I can probably send 16-bit floats when the velocity is above a certain threshold. <br><br></td></tr></table><br>
<a name="1006246"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Networked physics with 16 bit floats... good luck man!  latency is a KILLER with networked physics, add to that a loss of accuracy... yikes!<br><br>You should keep in mind that most successful networked games actually send user input rather than specific game data...  Making the game point-in-time predictable is necessary for that of course... but that's what I have extrapolated from all the reading I've done on the topic (of networking games).<br><br>It makes a lot of sense.. Lets say your game frame rate is 60hz... if you send a packet that contains user input detected during each frame that would be 1 packet sent every 16.666 ms containing very little data... very efficient!  that versus trying to send a bucket load of data every so often and still have the problem of needing to know the point in time that the data is relevant to. <br><br></td></tr></table><br>
<a name="1006262"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's a lot easier than you might think.  I can run dozens of physics bodies at 30 updates per seconds between California and Europe, even though the ping is 200-300.  Our results so far are way better than I expected.  The way I have the interpolation set up, the movement is always smooth.  It's pretty much impossible for any jerky motion to result, and the solution was stupidly simple.  Maybe I'll write an article about it when I finish up. <br><br></td></tr></table><br>
<a name="1006314"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >beanage</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> So you would run the rigid body physics on a server, rely on some stable bandwidth, and save the client some cpu cycles.. sounds keen.. has this been done before? <br><br></td></tr></table><br>
<a name="1006327"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd definately be interested in reading it. <br><br></td></tr></table><br>
<a name="1006396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >JoshK</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually, the whole physics simulation is performed on the server.  It's not so important to save CPU cycles on the client machine, but it does two things.<br><br>-The results are consistent.  The server dictates to the clients where everything is, and there are no discrepancies.<br><br>-Because there aren't multiple interpretations of where things should be, the resulting motion is very smooth.<br><br>The only problem we have come across is latency with player movement.  Of course, I'm also testing with a 300 msecond latency, so there's no way for it not to be laggy.  At least we don't have objects jumping around and teleporting, like most networked games.  If we can get a good response time with pings around 50-90, then I will be satisfied. <br><br></td></tr></table><br>
<a name="1006781"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Retimer</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> You should keep in mind that most successful networked games actually send user input rather than specific game data <br></div><br><br>Doesn't the half-life 2 engine do something like this? <br><br></td></tr></table><br>
<a name="1006788"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I'd use a predictive algorithm for movement whereby you can set where in time it would be vs where it is... if its going at a velocity, it had a tick start time and a vector of movement.  anyway, use a tight seek between the point its at and the point it needs to be at... this will help smooth the player movement and prevent jittering...  of course, you've got all that physics overhead too <br><br></td></tr></table><br>
<a name="1006843"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xlsior</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I'd use a predictive algorithm for movement whereby you can set where in time it would be vs where it is... <br></div><br><br>That has some advantages, but also disadvantages -- e.g. the 'teleporting' mentioned above when the predicted locations and actual locations aren't the same and catch up with eachother. <br><br></td></tr></table><br>
<a name="1006845"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >_Skully</td><td align="right"><font class=tiny>(Posted 2010)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> but that is buffered by the seek point and the actual point effective tween...stops the jumping in the users eyes <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
