<!DOCTYPE html><html lang="en" ><head ><title >dodgy PNG edge</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >dodgy PNG edge</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >dodgy PNG edge</a><br><br>
<a name="703249"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> I have FILTEREDIMAGE set as default and its not just this image it happens on. Im up to date gfx driver/directx wise.<br><br>this is an image showing the transparency of a PNG I am using...<br><img src="http://www.evildrbin.com/chris/image_edge2.png"><br><br>but this is what happens when I draw it<br><img src="http://www.evildrbin.com/chris/image_edge.png"><br><br>all images x/y positions are stored as float and the above happens with varying amounts of strength which I am assuming is to do with whatever screen_x and screen_y positions im at (also floats)<br><br>anyone had similar? ta! <br><br></td></tr></table><br>
<a name="703255"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> yep.  The problem is that colour data of black is being stored with the transparent pixels.  There may be an option in your art package to not save colour data with transparent pixels or some such.  I was given art for my current game that had the same problem and I made a topic about it on the forum (can't find it at the moment).<br><br>I couldn't get the artist to see what the problem was (I didn't have the same software so couldn't explain it properly) and then someone recommended an app made by a forum member called Defringe that removes the colour data from the transparent edges.  It works brilliantly.  Try a search on defringe in the Max forums... <br><br></td></tr></table><br>
<a name="703256"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) ENAY</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Possible reasons:-<br><br>- Image is not square (ie, 64x64, 128x128)<br>This may have distorted your png when it has been resized<br><br>&gt; the above happens with varying amounts of strength<br><br>Try<br><br>DrawImage YourImageHandle, Int(Pos_x), Int(Pos_y) <br><br></td></tr></table><br>
<a name="703264"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> cheers you two :)<br><br>defringe worked perfectly, thanks! :D <br><br></td></tr></table><br>
<a name="703267"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) ENAY</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't thank me, after reading Grey's post, my reply was clearly wrong :) Of course it's pixel blackening, it's the exact outline of your image! I should've looked a bit harder. <br><br></td></tr></table><br>
<a name="703269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> granted Grey's solution sorted it, but I appreciated the fact you replied anyway ;) <br><br></td></tr></table><br>
<a name="703299"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Chris:<br>Which paint program are you using to export these to PNG?  Photoshop 7 has the same problem but it changes the alpha pixels to white so you get white fringes. <br><br></td></tr></table><br>
<a name="703348"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Chris-M: you are welcome.  The funny thing is I was getting black outlines on text sent to me by the artist and he was using photoshop too (don't know version number), not white ones. <br><br></td></tr></table><br>
<a name="703388"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Chris-M - Don't mention it...Oh, you didn't... ;op <br><br></td></tr></table><br>
<a name="703396"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> SSwift: PSP10 (which I have to admit is pretty damn good) though I didn't even consider it might be the paint package being used, I think I got the same effect with Photoshop.<br><br>I defringed all of the PNG's but Im still getting it for one of them, think I need to play a bit more. <br><br></td></tr></table><br>
<a name="703481"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> I defringed all of the PNG's but Im still getting it for one of them, think I need to play a bit more. <br></div>If you'd like to send me the image, I'll see if there are any tweaks I can make. <br><br></td></tr></table><br>
<a name="703512"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> the defringe is wicked, but if say you have a thin shadow along the edge of a graphic it may not 100% remove the crap I found, but still improves it loads.  Wish I could find a link to that other thread... <br><br></td></tr></table><br>
<a name="703533"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yan: thanks (oh and sorry, i didnt realise you made it!) :) the image is...<br><img src="http://www.evildrbin.com/chris/ROCK_HOLE.png"><br>the effect is most noticable around the bottom right section of the dark border round the hole.<br>ta! <br><br></td></tr></table><br>
<a name="703539"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> can you show it in action with the problem too?  I bet it's cos you've got black pixel data stored and it's under the "light" bit and defringe will have missed that cos it only does edges...maybe. <br><br></td></tr></table><br>
<a name="703543"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> <img src="http://www.evildrbin.com/chris/wierd_edge.jpg"> <br><br></td></tr></table><br>
<a name="703580"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Perturbatio</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> swift: <a href="http://www.devarticles.com/c/a/Photoshop/20-Things-About-Photoshop-You-Have-to-Know/6/" target="_blank">http://www.devarticles.com/c/a/Photoshop/20-Things-About-Photoshop-You-Have-to-Know/6/</a> <br><br></td></tr></table><br>
<a name="703615"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> Perturb:<br>Uh, that defringe is for a totally different issue than this one. :-)<br><br>That is for like, if you cut a character out of a background and you need to color the pixels around the edge that you missed a color which is closer to that of the image in that area. <br><br></td></tr></table><br>
<a name="703640"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> yeah that's an art error dude. <br><br></td></tr></table><br>
<a name="703850"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Don't worry about my sardonic sense of humour Chris, I don't mean anything by it. :o)<br><br>Yeah, GA's right, there's not much that DeFringe can do for that image, I'm afraid. The 'highlights' you're seeing are an unavoidable result of filtering. The dark opaque edge of the 'hole' is being blended with the translucent white of the 'light beam' which gives an opaque white(ish) line that sticks out like a sore thumb.<br><br><br>I'd try the following:<br><br>1) If the image isn't going to be scaled or rotated, disable the filtering for it. You will lose the lovely sub pixel movement though.<br><br>2) Spilt the image up into two and draw the 'hole' and 'light beam' separately. <br><br></td></tr></table><br>
<a name="703860"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> so there's nothing he can do in his art package to remove the black colour info on transparent pixels or anything? <br><br></td></tr></table><br>
<a name="703875"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think I see the problem.<br><br>Look very carefully at the image blended with the blitz background.<br><br>It looks like there is a white halo around the lower edge of the hole. <br><br>This continues into the lighted area.<br><br>Chris:<br>Did you apply any kind of a sharpening filter to this image?  Those will create highlighted edges.  What you have here is an art issue.  The hole image which you drew the light beam over has a very light highlight with alpha on the lower right edge, and that is what you're seeing in Max.<br><br>Just make a brown layer below the hole in photoshop and you'll be able to see it clear as day just like you can in Max. <br><br></td></tr></table><br>
<a name="703906"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> so there's nothing he can do in his art package to remove the black colour info on transparent pixels or anything? <br></div>I'm talking about the 'hole image' specifically. This is a slightly different situation as the pixels causing the trouble aren't entirely transparent and so can't just be recoloured (well they can, but they'd look crap ;o)).<br><br>@SSwift - I'm afraid it's not that simple. The highlight/halo only appears when the image is scaled, rotated or drawn at a non whole number boundary (if filtering is enabled) and I'm pretty sure it's a result of the process I've described above.<br><br>Try this...<br>Load the image into your art package of choice and add a dark background layer<br>...No highlight/halo...<br>Now re-sample the image using a bilinear filter (any 'averaging' filter should do it) to about 75%.<br>...Tada!...<br>This is what's happening in BMax.<br><br>[edit]<br>Just for the hell of it, try this...<pre class=code>Strict

Local image:TImage = LoadImage(LoadBank("http::www.evildrbin.com/chris/ROCK_HOLE.png"), FILTEREDIMAGE)
Assert image Else "Oops..."

Graphics 800, 600, 32

Local x#, y#

SetBlend ALPHABLEND
'SetScale 0.75, 0.75
'SetRotation 10
SetClsColor 41, 29, 28
Repeat
	If KeyHit(KEY_LEFT) Then x# :- 0.1
	If KeyHit(KEY_RIGHT) Then x# :+ 0.1
	If KeyHit(KEY_UP) Then y# :- 0.1
	If KeyHit(KEY_DOWN) Then y# :+ 0.1
	
	Cls
	DrawImage image, x#, y#
	
	Flip
Until KeyHit(KEY_ESCAPE)

End</pre>[/edit] <br><br></td></tr></table><br>
<a name="703933"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >(tu) ENAY</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> Remove the hills and draw some grass instead! :) <br><br></td></tr></table><br>
<a name="704100"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Raz</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#24">[#24]</a></td></tr></table></td></tr><tr ><td class="posttext"> cool thanks yall, ill give it another look :) <br><br></td></tr></table><br>
<a name="704186"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >sswift</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#25">[#25]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yan:<br>I see...  I understand the issue now.<br><br>The pixels in the light beam are pure white, and this pure white color is normally at 25% transparency, and blended with a brown background at that level.<br><br>But when the image is scaled, you have white pixels being blended with the brown pixels, and you end up with pixels that have a lot of white but their opacity is such that they're not blending with the background to produce the same result as the 25% white pixels in the pure beam.<br><br>There's two ways to fix this.  <br><br>The first way is to change the 3D hardware so it blends the images differently. :-)<br><br>The second way which is actually possible is to blend the white layer seperately from the image of the hole.  So make the light beam a seperate image with no brown.  That will solve the problem. <br><br></td></tr></table><br>
<a name="704211"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Grey Alien</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#26">[#26]</a></td></tr></table></td></tr><tr ><td class="posttext"> sswift: yeah Yan already said that ;-) <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
