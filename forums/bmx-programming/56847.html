<!DOCTYPE html><html lang="en" ><head ><title >Module Format Preference</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Module Format Preference</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Module Format Preference</a><br><br>
<a name="632018"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Dodgy thread subject, I know, but I can't find a better way to describe it in brief. What I'd like to know is the following..<br><br>In a user module, a lot of the functions return custom types. However, the custom types are Blitz versions of C++ Structs, so they do not automatically hold the same field values. Clearly there's an overhead involved in transferring data back and forth between struct and type. So, which would you prefer?<br><br>1) Module automatically transfers data from Struct to Type when a Struct is returned or data in one is changed, and vice versa with data from Type to Struct. <br><br>Advantages: Seamless operation. Cleaner code.<br>Disadvantages : Could occasionally be transferring data unnecessarily. Will mean a lot more work for me ( Don't count this :P )<br><br>2) Module manually transfers data from Struct to Type. You get a set of functions to do it yourself.<br><br>Advantages : Absolutely no unnecessary calls.<br>Disadvantages : Your code is a lot longer with a lot of calls to keep passing data back and forth. A single function call might end up being 3 or 4 commands instead of one.<br><br>3) Module never transfers data from Struct to Type. BMax types contain no fields, but instead have getters and setters to set and retrieve the values directly to and from the C++ struct. <br><br>Advantages : Absolutely no unnecessary calls. Will be faster than option 2 when you onlu need to get or set one or two fields in a type.<br>Disadvantages : Your code is a lot longer with a lot of calls to keep passing data back and forth. A single function call might end up being 3 or 4 commands instead of one. Will be slower than option 2 when you need to get all fields at a time.<br><br><br>Cards on the table, I think option 1 is the best. I believe the speed difference between 1 and 2/3 is negligible and the convenience and increased readability of your code is well worth it. It does mean a lot more work for me, but if I'm going to do this, I want to do it right.<br><br>Be interested to hear your preferences though. <br><br></td></tr></table><br>
<a name="632030"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> 3) This definitely reminds me of how Eiffel works with its "you have to write classes to handle anything you want to include from outside sources so it can be handled typesafely by the GC<br><br>I think this is the way that will bring the most success but from experience I can say it is the way with the by far most work as well. But it will reward you with something that is totally under your control (which would not be the case when using structs and transfering data as BM is GC controlled and C / C++ isn't) <br><br></td></tr></table><br>
<a name="632051"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Actually 3) leaves me with very little work. 1) gives me much more to do than 3)<br><br>The thing I dislike about 3) is that if you retrieve the position of an object, you then get the overhead of three extra function calls to get the x,y, and z values. If you only need one of them, that's great, but if you need all three, that's 2 unnecessary calls every time. <br><br></td></tr></table><br>
<a name="632081"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Why?<br><br>You can use<br><br>GetPosition(x:float var, y:float var, z:float var)<br><br>and then read all 3 out and assign to x,y,z :-)<br><br>Still one call :-) <br><br></td></tr></table><br>
<a name="632088"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> No you can't, because that's not what the module returns. As I said, the module returns a custom struct/type with multiple fields. So it might return a 3d vector type with x, y and z coordinates.<br><br>If I do #1, you can simply say<br><br>MyVec=GetPosition()<br>Debuglog MyVec.x<br>Debuglog MyVec.y<br>Debuglog MyVec.z<br><br>If I do #2, you'll have to do<br><br>MyVec=GetPosition()<br>MyVec.PopulateFromStruct()<br>Debuglog MyVec.x<br>Debuglog MyVec.y<br>Debuglog MyVec.z<br><br><br>If I do #3, you'll have to do<br><br>MyVec=GetPosition()<br>Debuglog MyVec.GetX()<br>Debuglog MyVec.GetY()<br>Debuglog MyVec.GetZ()<br><br>Which is three function calls, each of which calls the wrapped C++ function as well. So that's 6 calls instead of 2.<br><br>With method #1 you get 1 call and it's done for you, whether you need it or not. ( 99/100 you will need it ) abd you transfer all fields even if you only need 1 or 2.<br><br>With method #2 you get 2 calls, but you're transferring all fields even if you only need 1 or 2. <br><br></td></tr></table><br>
<a name="632091"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Dreamora</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I thought of the module as a functionality wrapper to the C / C++ source which will return something that you can use within BM in a usefull way which makes much much more sense.<br><br>Didn't think you meant that it returns this stuff.<br><br>And still you could make a method GetCoordinates(x:int var, y:int var, z:int var)<br><br>-&gt;<br><br>MyVec = GetPosition()<br>local x:int, y:int, z:int<br>MyVec.GetCoordinates(x,y,z)<br>Debuglog x<br>debuglog y<br>debuglog z <br><br></td></tr></table><br>
<a name="632095"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Gabriel</td><td align="right"><font class=tiny>(Posted 2006)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> It's an interface to a DLL which is not normally accessible from BlitzMax. The point of the exercise is to return the exact same thing you get if you use the DLL in any other language. If I change all the return values, existing code for the DLL is horribly broken and everyone has to learn my syntax instead of the engine's syntax. Besides, you need to be able to pass and return the vectors.<br><br>In the position example, suppose you want to Get the position vector, add another vector to it and then use it to set the position. That's gonna be a horrible mess in separate coordinates.<br><br>Yes, I could make a GetCoordinates method, but I'm not going  to, because option number 2 already does exactly that, albeit with a slightly modified syntax and the ability to use all the included vector operations on the return value, like dot, length, and vector maths.<br><br>The module will be open source, so if anyone wanted a GetCoordinates method, they can write it themselves. I plan on writing my own functions when it's done too. I'm talking about the pure wrap of the DLL classes. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
