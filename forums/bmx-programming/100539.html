<!DOCTYPE html><html lang="en" ><head ><title >no speakers = crash</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >no speakers = crash</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >no speakers = crash</a><br><br>
<a name="1187917"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just got report of this happening.  Its the old c++ runtime unusual termination error.<br><br>Works fine with speakers plugged in.  Unplug them and the game falls over.<br><br>A bit vague I know but im on my phone and havent started to look at it yet.<br><br>Anybody heard of this before? <br><br></td></tr></table><br>
<a name="1187918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Presumably the OS detects it and changes the current audio output to use a different driver/hardware.<br><br>Maybe the BlitzMax audio driver isn't handling the change very well. (although I'm not sure it should have to... you'd think the OS would deal with all of that) <br><br></td></tr></table><br>
<a name="1187925"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Update: I've just checked the DXDiag logs, and the system with no speakers in, is showing there is no actual soundcard present.  I'm sure that's cropped up before... <br><br></td></tr></table><br>
<a name="1187926"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ah, so USB speakers? <br><br></td></tr></table><br>
<a name="1187927"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> That may be the case.  But I've tracked the problem down, and it's...<br><br><br>*drumroll*<br><br><br>MAXMOD2!  <b>AGAIN!!</b><br><br>It fails if there is no soundcard present, whereas regular Blitzmax audio *silently* (sic) fails, i.e. without throwing a massive error.<br><br>Seriously - this thing is becoming a curse and it's getting to the point where I might pay somebody to provide an alternative that's less of a pain in the ass.<br><br>Need to find a way around this now... <br><br></td></tr></table><br>
<a name="1187929"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> Fix0r3d!<br><br><pre class=code>If SetAudioDriver("DirectSound")
	SetAudioStreamDriver("MaxMod RTAudio")
EndIf</pre> <br><br></td></tr></table><br>
<a name="1187930"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hey Dave... why do you use MaxMod in the first place? <br><br></td></tr></table><br>
<a name="1187932"></a>

<a name="1187934"></a>

<a name="1187935"></a>

<a name="1187936"></a>

<a name="1187937"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Streaming audio.  No other reason.<br><br>Seems this is only a partial fix - pulling the speaker plug out AFTER the game has started, results in the same crash...<br><br>(Again, this only affects MaxMod2 - regular Blitzmax audio takes care of itself).<br><br>[edit] I think it's time to bin MaxMod2.  What are you using for music?  LoadSound is taking 1500ms to load/decompress a music file (during which everything pauses), which is not really acceptable. <br><br></td></tr></table><br>
<a name="1187941"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >*</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> why not have a traditional loading screen :) <br><br></td></tr></table><br>
<a name="1187957"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, something is definitely wrong.  I'm testing some native audio stuff and have hit a new (but related) problem.<br><br>If I start the game with speakers plugged in, all good.  If I then unplug the speakers (with the game still running), the next time I try to play a sound, be it via PlaySound, or CueSound, I get the following error:<br><br><div class="quote"> DirectSound failed (150) <br></div><br><br>I speed-tested setting the audiodriver before every PlaySound, but each call takes around 8ms, which is unacceptably slow.<br><br>A bit stuck now... <br><br></td></tr></table><br>
<a name="1187960"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Seem to have solved it for now, thus:<br><pre class=code>		Try
			Local c:TChannel = AllocChannel()
			CueSound(snd, c)
			c.SetPaused(False)
		Catch A:String
			'nowt - we should only go here if some muppet has ragged the speakers out mid-game.
		EndTry
</pre> <br><br></td></tr></table><br>
<a name="1187971"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> ...except that doesn't work so great either.  Because in the case of game music, I am seemingly unable to stop any music that's already playing, should the speakers be removed mid-game.<br><br>This is a massive problem if the speakers are removed, then reattached, and somewhere between the two, the player has clicked into another area of the game which should have different music playing.<br><br>I need to punch something. :/ <br><br></td></tr></table><br>
<a name="1187995"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >therevills</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> What are you using for music? <br></div><br>LoadSound... each screen has a load method which displays a "Loading" text/image if needed. <br><br></td></tr></table><br>
<a name="1187997"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> I stuck with MaxMod2 for now, but I just don't set the MaxMod RTAudio Driver (for streaming audio) if the DirectSound driver fails to initialise, and grey out the in-game audio/volume controls.  This way, it starts up and runs fine whether there are speakers present or not.<br><br>If the DS driver starts up OK, then the speakers get unplugged, it will still crash with "DirectSound failed (150)" - even without MaxMod2 involved.  I tried the same with FreeAudio and got a warning in the debug window, and all audio just died but the game continued running.  With all of that said, I've sold thousands upon thousands of games and the issue of somebody unplugging their speakers causing a mid-game crash has never come up, not even once.  So that's probably going to be a non-issue.<br><br>I'm still considering alternatives, though.  Possibly irrKlang, as it's got plenty of features and decent price tag at ~£250. <br><br></td></tr></table><br>
<a name="1188001"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Kryzon</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Do you sell your games for less than £18? if so, you can get the irrKlang Pro Hobbyist which is just £57 (and has all features).<br><br><a href="http://www.ambiera.com/irrklang/irrklang_pro.html" target="_blank">http://www.ambiera.com/irrklang/irrklang_pro.html</a> <br><br></td></tr></table><br>
<a name="1188005"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Brucey</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#16">[#16]</a></td></tr></table></td></tr><tr ><td class="posttext"> The paid-for version is also static linkable, which means there's no unsightly extra dll to ship.<br><br>Let me know if you need a hand getting it working with the static library. <br><br></td></tr></table><br>
<a name="1188020"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#17">[#17]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> Do you sell your games for less than £18? if so, you can get the irrKlang Pro Hobbyist which is just £57 (and has all features). <br></div>I'm not an individual tho, I have a limited company now.<br><br>@Brucey: cheers for that! <br><br></td></tr></table><br>
<a name="1188076"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >BlitzSupport</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#18">[#18]</a></td></tr></table></td></tr><tr ><td class="posttext"> Might be worth having a look at DSASS () in <i>BlitzMax\mod\brl.mod\directsoundaudio.mod\directsoundaudio.bmx</i>:<br><br><pre class=code>
Function DSASS( n,t$="DirectSound" )
	If n&gt;=0 Return
	Throw t+" failed ("+(n &amp; 65535)+")"
End Function
</pre><br><br>Maybe see what happens without the Throw, which I assume is causing the exit after generating the message you're seeing? Or maybe try setting the sound driver to null there -- SetAudioDriver "Null"? Probably too late by that point, but I've no way to test this myself! <br><br></td></tr></table><br>
<a name="1188080"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#19">[#19]</a></td></tr></table></td></tr><tr ><td class="posttext"> Interesting.  I'll have a go at that tomorrow. <br><br></td></tr></table><br>
<a name="1188547"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#20">[#20]</a></td></tr></table></td></tr><tr ><td class="posttext"> Just had a look at the IrrKlang website ( <a href="http://www.ambiera.com/irrklang/downloads.html" target="_blank">http://www.ambiera.com/irrklang/downloads.html</a> ) and, concerning compiling with GCC 4.7+ they say:<br><div class="quote"> <br>The GCC developers made newer versions of gcc incompatible, so if you are using this new gcc version, download these irrklang binaries which will work with gcc 4.7 and newer<br> <br></div><br>Seems the GCC people have caused a lot of problems with the changes they made... Whatever happened to backwards compatibility? What is it, exactly, that they're changing that's causing these issues? C++ is C++, right?<br><br>The gcc.gnu.org website ( <a href="http://gcc.gnu.org/gcc-4.7/cxx0x_status.html" target="_blank">http://gcc.gnu.org/gcc-4.7/cxx0x_status.html</a> ) flatly proclaims:<br><div class="quote"> <br>...No attempts will be made to preserve backward compatibility with C++11 features whose semantics have changed during the course of C++11 standardization.<br> <br></div><br>Well, isn't THAT special... So C++ itself is apparently undergoing some standardization changes (to make it even MORE cryptic in its syntax, no doubt!). Great.<br><br>Short of rewriting maxmod2 (or any other program(s) that are no longer compilable under GCC 4.7+), what can be done to make it/them work? Brucey?<br><br>Russell <br><br></td></tr></table><br>
<a name="1188552"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Derron</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#21">[#21]</a></td></tr></table></td></tr><tr ><td class="posttext"> A rewrite would be nice - but I think most of us use maxmod just for streaming purposes.<br><br>And no - not every game is having "screens" or "levels". I have eg. a game in which you can move through a building - each room you enter may have a different music and/or sound effects. If I preloaded ALL music files (users could add custom ones) I would end up preloading many megabytes of compressed audio into RAM (currently 50mb compressed, but like said: moddable).<br><br>I also have had to "mod" maxmod to get it working flawlessly on pulseaudio-driven linux DE. Why? If there is already a active sound output the app would stay silent. So I had to change the order of "driver recognition"...now I can play some music and start my app afterwards without stopping sound effects to work.<br><br>So instead of "dumb/flac..."-support I just would be in need of a decent, reliable player for streamed ogg/mp3. Of course it should allow multiple streams to play simultaneously (do not know the correct term for it at the moment - multichannel is something different I think).<br><br>bye<br>Ron <br><br></td></tr></table><br>
<a name="1188583"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#22">[#22]</a></td></tr></table></td></tr><tr ><td class="posttext"> <div class="quote"> A rewrite would be nice - but I think most of us use maxmod just for streaming purposes <br></div>That's all I use it for, which does make the likes of BASS, FMOD, IrrKlang et al seem a little "overkill" for what I want to do. <br><br></td></tr></table><br>
<a name="1188603"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Russell</td><td align="right"><font class=tiny>(Posted 2013)</font>&nbsp;<a href="#23">[#23]</a></td></tr></table></td></tr><tr ><td class="posttext"> I had a good look at BASS, FMOD and IrrKlang and I think IrrKlang is the most realistic payment scheme for me. Sure, all three are free for non-commercial use, but if you then decide to release your game as a shareware the price points change quite a bit. IrrKlang works out to about $85US [as of 2013 June 4th] for unlimited platforms per title, BASS is a bit more (about $163 - But PER platform) and FMOD is a LOT more ($500 PER platform - If your budget is less than $100K... Otherwise, it could be $15,000 or more!).<br><br>The only semi-major downside I could see for the IrrKlang library is, according to the website, static linking is only available on the Windows version (Why? Who knows?) and sound effects like echo and reverb, etc are only available on DirectSound (Windows). For me, these are not deal breakers because I can just include the DLL in the distribution and I don't generally need to change echo or reverb effects 'on-the-fly', so they can be generated when the sounds are encoded (using Audiere or whatever).<br><br>So, given that MaxMod2 does not appear to work with 4.7+, I'm going to switch to IrrKlang. It also has the benefit of being commercially supported.<br><br>Russell<br><br>p.s. If you need plugin support and/or lots of effects capabilities, then maybe BASS or FMOD are for you. You'll have to weigh that decision yourself. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
