<!DOCTYPE html><html lang="en" ><head ><title >collection problem</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >collection problem</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >collection problem</a><br><br>
<a name="494232"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Im making my own collection data structure, and I set up the object enumerator and other functions needed as per the intructions in the language reference. But when I try to run a ForNext loop:<br><br>Local list:RList=Rlist.Create()<br><br>For Local link:RLink=EachIn list<br>	Print "asdf"<br>Next<br><br>End<br><br>It gives me the error:<br>Compile Error:ForEach collection expression error<br>[/Users/rich/Games/RichPrgms/list.bmx;7;1]<br>Build Error: failed to compile /Users/rich/Games/RichPrgms/list.bmx<br><br>What is wrong here? BlitzMax 1.04, Mac OS X <br><br></td></tr></table><br>
<a name="494251"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> The error is on the line that begins with the For <br><br></td></tr></table><br>
<a name="494268"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> Does Rlist extend TList ? <br><br></td></tr></table><br>
<a name="494269"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> No it is my own type of data structure that I made, and it works fine except for this. But this code gives a compile error. And btw, I changed link:Object to link:RLink which is what it should be, I had been testing if Object would work, and forgot to change it back. <br><br></td></tr></table><br>
<a name="494321"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> If I need to post the entire code I will, but its kinda long. Im just wondering why this doesn't work, considereing I effectivly copied the TList code for this. <br><br></td></tr></table><br>
<a name="494692"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> bump <br><br></td></tr></table><br>
<a name="494698"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skn3</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well I tried getting this to work by following the example in the docs, and it worked fine. So I dunno what you are doing wrong. =/ <br><br></td></tr></table><br>
<a name="494700"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> Here's my entire code:<br><pre class=code>
[edited out]
</pre> <br><br></td></tr></table><br>
<a name="494717"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >skidracer</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> sp?<br><br>	Method NextObjec:RLink()<br><br>there are other problems with your code also, but that should get you going again... <br><br></td></tr></table><br>
<a name="494726"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Shambler</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> In your RList type you have a data member pos:RLink but you do not create a new RLink you leave pos uninitialised 'Null' which is why it fails. <br><br></td></tr></table><br>
<a name="494736"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >rdodson41</td><td align="right"><font class=tiny>(Posted 2005)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> @Skidracer- Thanks that was the main problem, I should have picked up on that. I'm not a great speller cause I usually just don't pay attention to it and make simple mistakes like that.<br><br>@Shambler- pos is supposed to be null if there is no data in the list. The _head is there for the internal workings of the list and the user isn't supposed to know about it, just like you don't interact with the head in TList. Since there is no data in the list and the head is essentially invisable, pos is just set to null for now. I don't know why you would need the position if there is no data in the list.<br><br>Skidracer you said there were other problems with my code, I fixed up some basic ones I saw, but could you tell me any others?<br><br><pre class=code>
Strict

Local list:RList=RList.Create()

list.AddLast("asdf")
list.AddLast("fdsa")
list.AddLast("1234")
list.AddLast("4321")


For Local l:RLink=EachIn list
	Print String(l.value)
Next


Type RList
	Field _head:RLink
	Field pos:RLink
	Field count:Int
	
	
	Function Create:RList()
		Local _l:RList=New RList
		_l._head=New RLink
		_l._head.list=_l
		_l._head.value=_l._head
		_l._head.prec=_l._head
		_l._head.succ=_l._head
		Return _l
	EndFunction
	
	Method ObjectEnumerator:REnum()
		Return REnum.Create(_head)
	EndMethod
	
	
	Method InsertBefore:RLink(_value:Object,_l:RLink)
		If _l=Null Then RuntimeError("Invalid RLink.")
		Local _rl:RLink=New RLink
		_rl.list=Self
		_rl.value=_value
		_rl.prec=_l.prec
		_rl.succ=_l
		_rl.prec.succ=_rl
		_rl.succ.prec=_rl
		Return _rl
	EndMethod
	
	Method InsertAfter:RLink(_value:Object,_l:RLink)
		If _l=Null Then RuntimeError("Invalid RLink.")
		Local _rl:RLink=New RLink
		_rl.list=Self
		_rl.value=_value
		_rl.prec=_l
		_rl.succ=_l.succ
		_rl.prec.succ=_rl
		_rl.succ.prec=_rl
		Return _rl
	EndMethod
	
	Method AddFirst:RLink(_value:Object)
		Return InsertAfter(_value,_head)
	EndMethod
	
	Method AddLast:RLink(_value:Object)
		Return InsertBefore(_value,_head)
	EndMethod
	
	
	Method Remove:Object(_l:RLink)
		If _l=Null Then RuntimeError("Invalid RLink.")
		Return _l.Remove()
	EndMethod
	
	Method RemoveFirst:Object()
		Return Remove(First())
	EndMethod
	
	Method RemoveLast:Object()
		Return Remove(Last())
	EndMethod
	
	Method Clear()	'supposed to be fornext loop here
		If count=0 Then Return
		SetFirst()
		Repeat
			pos.Remove()
		Until pos=Null
	EndMethod
	
	
	Method First:RLink()
		If _head.succ=_head Then RuntimeError("Empty RList.")
		Return _head.succ
	EndMethod
	
	Method Last:RLink()
		If _head.prec=_head Then RuntimeError("Empty RList.")
		Return _head.prec
	EndMethod
	
	
	Method SetPos(_l:RLink)
		If _l=Null Then RuntimeError("Invalid RLink.")
		_l.SetAsPos()
	EndMethod
	
	Method SetFirst()
		SetPos(First())
	EndMethod
	
	Method SetLast()
		SetPos(Last())
	EndMethod
	
	Method NextPos()
		SetPos(pos.succ)
	EndMethod
	
	Method PrevPos()
		SetPos(pos.prec)
	EndMethod
	
	
	Method Index:Int(_l:RLink)
		If _l=Null Then RuntimeError("Invalid RLink.")
		Return _l.Index()
	EndMethod
	
	Method Link:RLink(_i:Int)	'supposed to be fornext loop here
		If count=0 Then Return
		Local _idx:Int=1
		SetFirst()
		Repeat
			If _idx=_i Then Return pos
			NextPos()
			_idx:+1
		Until _idx&gt;count
	EndMethod
EndType

Type RLink
	Field list:RList
	Field value:Object
	Field prec:RLink
	Field succ:RLink
	
	Method Remove:Object()
		If Self=list._head Then RuntimeError("Invalid RLink.")
		If Self=list.pos Then
			If succ&lt;&gt;list._head Then list.NextPos()
			If prec&lt;&gt;list._head Then list.PrevPos()
			list.pos=Null
		EndIf
		prec.succ=succ
		succ.prec=prec
		list.count:-1
		Return value
	EndMethod
	
	Method SetAsPos()
		If Self=list._head Then RuntimeError("Invalid RLink.")
	EndMethod
	
	Method Index:Int()
		If Self=list._head Then RuntimeError("Invalid RLink.")
		If prec=list._head Then Return 1
		Return prec.Index()+1
	EndMethod	
EndType

Type REnum
	Field _link:RLink
	
	Function Create:REnum(_l:RLink)
		Local _r:REnum=New REnum
		_r._link=_l
		Return _r
	EndFunction
	
	Method HasNext:Int()
		If _link.succ&lt;&gt;_link.list._head Then Return True
	EndMethod
	
	Method NextObject:RLink()
		If HasNext() Then
			_link=_link.succ
			Return _link
		EndIf
	EndMethod
EndType
</pre> <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
