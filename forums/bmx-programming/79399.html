<!DOCTYPE html><html lang="en" ><head ><title >memory usage problems</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >memory usage problems</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >memory usage problems</a><br><br>
<a name="891380"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Schragnasher</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Ok so iv got a fairly large code base for my roguelike game right now, the thing is iv got a memory problem. My engine can push and pop gamestates onto a stack, the problem arises when doing this. <br>   <br>   My understanding would be that if i push a new state onto the stack, then pop it off, my memory should conceivably go back to the amount before the push. (i.e. i push my main menu on top of the gameplaystate then pop it off to resume play) The push and pop seem to work just peachy, by my memory usage continues to climb as i push and pop the menu. Iv fixed some of it through my own diligence, but it still occurs.<br><br>   My question is whether or not there is a good way to track down this kind of thing, and whether or not my belief is correct that the memory usage is accurate using gcmemalloced() and i should go back to my previous memory state if iv cleaned up things correctly. <br><br>   Iv paired down alot of stuff i didnt need to see if i could pinpoint the problem, but its persisted, and i am to a point where the code is too interwoven to break out much more. Also iv done some reference trimming. <br><br>   My debug code shows the reference count for all the objects i could and they stay constant while popping and pushing states, so i dont have a runaway from what i can tell.<br><br>Im at a loss, as its going to be open source i have no problem sending out the code or once i get a chance to update the SVN it will be at <a href="http://www.sourceforge.net/projects/simpledungeon" target="_blank">http://www.sourceforge.net/projects/simpledungeon</a><br><br>Any help or guidance is appreciated<br>Thanks<br>Josh b. <br><br></td></tr></table><br>
<a name="891382"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >TaskMaster</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> Are you forcing a garbage collection after the pop?  It may be that the GC hasn't gotten around to cleaning up yet. <br><br></td></tr></table><br>
<a name="891383"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Schragnasher</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> iv run it with a collect in the mainloop with the same problem, continually increasing memory usage, im beginning to wonder if a module im using might be the culprit in some way. <br><br></td></tr></table><br>
<a name="891417"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >tonyg</td><td align="right"><font class=tiny>(Posted 2008)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> If you have a small recreateable scenario <a href="/codearcs.php?code=1808" target="_blank"> this </a> might help.<br>If your stack is on a list then try to run using just the list commands rather than any TLINK stuff. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
