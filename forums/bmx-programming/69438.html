<!DOCTYPE html><html lang="en" ><head ><title >Some questions on sound</title><meta name='viewport' content='width=device-width, initial-scale=0.66'><meta name='description' content='language:basic, target:desktop, category:game development'><link rel="styleSheet" href="../skins/granite/style.css" type="text/css"><style type="text/css">div.bbcode {padding: 8px;background: #E5E5E5;color: #000000;border: 1px dashed #B4B4BE;}</style></head><body ><table width=100% cellspacing=0 cellpadding=0><tr ><td class="menubarleft"></td><td class="menubar"><table cellspacing="0" cellpadding="0"><tr ><td >&nbsp;</td><td class="menuitemleft"></td><td class="menuitem"><a href="/" class="menuitem">News</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/forums.php" class="menuitem">Forums</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/codearcs.php" class="menuitem">Code</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/logs.php" class="menuitem">Logs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/gallery.php" class="menuitem">Gallery</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/sdkspecs.php" class="menuitem">Specs</a></td><td class="menuitemright"></td><td class="menuitemleft"></td><td class="menuitem"><a href="/search.php" class="menuitem">Search</a></td><td class="menuitemright"></td></tr></table></td><td class="menubarright"></td></tr></table><div class="main"><h1 >Some questions on sound</h1><a href="forums.php" >BlitzMax Forums</a>/<a href="topics.php?forum=102" >BlitzMax Programming</a>/<a href="#bottom" >Some questions on sound</a><br><br>
<a name="776897"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#1">[#1]</a></td></tr></table></td></tr><tr ><td class="posttext"> Hi, I wonder if anybody can lend a hand on this particual issue.<br><br>I need a quick way to start a sound playing from an speccific offset of millisecs() (I mean, not at the start of the sample, but in a given offset). I supose there will be a sort of playing stream in the BlitzMax internal audio engine. I would need a function to make this stream 'jump' to a speciffic location, expressed on millisecs. I don't want to install any third party library such as OpenAL, as this is something I need for a module I'm writting.<br><br>I also need a function to get the lenght of a speciffic sound in millisecs (independent from the file size, as BlitzMax can support several sound formats).<br><br>Any help on this issue will be much appreciated.<br><br>:D <br><br></td></tr></table><br>
<a name="777144"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#2">[#2]</a></td></tr></table></td></tr><tr ><td class="posttext"> No one can lend a hand? <br><br></td></tr></table><br>
<a name="777168"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >GfK</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#3">[#3]</a></td></tr></table></td></tr><tr ><td class="posttext"> To be honest, without 3rd party libraries I think you're stuck. <br><br></td></tr></table><br>
<a name="777174"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#4">[#4]</a></td></tr></table></td></tr><tr ><td class="posttext"> mmm, is it possible to statically link the OpenAL library? <br><br></td></tr></table><br>
<a name="777177"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Vertex</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#5">[#5]</a></td></tr></table></td></tr><tr ><td class="posttext"> I think its possible to link OpenAL static but you have to puplish your application under the terms of LGPL:<br><a href="http://en.wikipedia.org/wiki/OpenAL" target="_blank">http://en.wikipedia.org/wiki/OpenAL</a><br><a href="http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License" target="_blank">http://en.wikipedia.org/wiki/GNU_Lesser_General_Public_License</a><br><br>You can set the offset on OpenAL sources(^= channels) by using alSourcef with the parameter AL_SEC_OFFSET(in seconds) or AL_SAMPLE_OFFSET(in samples)<br><br>cu olli <br><br></td></tr></table><br>
<a name="777482"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#6">[#6]</a></td></tr></table></td></tr><tr ><td class="posttext"> I haven't really touched the sound system too much yet, but I think you could probably do this with some pointer shenanigans?<br><br>I'll have a play later and post any results. <br><br></td></tr></table><br>
<a name="777490"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#7">[#7]</a></td></tr></table></td></tr><tr ><td class="posttext"> Yes, I think this also, but I don't think I can have access to this pointer... <br><br></td></tr></table><br>
<a name="777496"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#8">[#8]</a></td></tr></table></td></tr><tr ><td class="posttext"> This seems to work...<br><textarea class=codebox name="code" wrap=OFF readonly="true" rows="15" cols="80">Strict

Local sample:TAudioSample = LoadAudioSample(getenv_("BMXPATH") + "\samples\digesteroids\sounds\menu.ogg")

Print "Sample length = " + GetSampleLength(sample) + "ms"

Local channel:TChannel = PlaySection(sample, 20000, 24000)

Print "Now playing 20000ms -&gt; 24000ms."

Repeat
Until ChannelPlaying(channel) = 0

StopChannel(channel)

End


Function GetSampleLength(sample:TAudioSample)
	Return (sample.length / Double(sample.hertz)) * 1000
End Function

Function PlaySection:TChannel(sample:TAudioSample, start!, stop!=Null)
	Local offSet
	
	start! = (start! / 1000!) * sample.hertz
	If start! &gt; sample.length Then Return Null
	
	Select sample.format
		Case SF_MONO16LE, SF_MONO16BE, SF_STEREO8
			offset = start! * 2
		
		Case SF_STEREO16LE, SF_STEREO16BE 
 			offset = start! * 4
		
		Default
			offset = start!
	End Select
	
	stop! = (stop! / 1000!) * sample.hertz
	If (stop! = Null) Or (stop! &gt; sample.length) Then stop! = sample.length
	
	Local newSample:TAudioSample = CreateStaticAudioSample(sample.samples + offset, (stop! - start!), sample.hertz, sample.format)
	Local soundSection:TSound = LoadSound(newSample)
	
	Return PlaySound(soundSection)
End Function</textarea><br>...You may want to check for leaks as the sound system seems to be a law unto itself when it comes to memory management. ;o) <br><br></td></tr></table><br>
<a name="777502"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#9">[#9]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks Yan. I can't test right now, but I will give it a try as soon as possible.<br><br>Are the sound samples free when no longer referenced and no longer being played? <br><br></td></tr></table><br>
<a name="777517"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Yan</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#10">[#10]</a></td></tr></table></td></tr><tr ><td class="posttext"> They should be. <br><br>I know that channels can misbehave at times, so I was just being cautious. :o) <br><br></td></tr></table><br>
<a name="777542"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >xMicky</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#11">[#11]</a></td></tr></table></td></tr><tr ><td class="posttext"> Couldn't you start the sound with volume =0, let it play offset-many seconds, pause it - and resume it with volume &gt;0, if the moment has come to use it in the scene ? <br><br></td></tr></table><br>
<a name="777549"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >degac</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#12">[#12]</a></td></tr></table></td></tr><tr ><td class="posttext"> Thanks! Very useful!<br><br>@xMicky: your solutions should work, but you are wasting cpu time doing something not useful like playing a sample at 0 volume <br><br></td></tr></table><br>
<a name="777760"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#13">[#13]</a></td></tr></table></td></tr><tr ><td class="posttext"> @xMicky: No I can't do that. I'm working in a flash-like movie generator module that syncs timeline based bitmap animations with sound, and I can't pause the movie for some seconds just to get audio and images syncronized. All the drawings and interpolation are being done in in a delta-time based style, very precise, so I think I would only need to make 'jumps' on the audio when there's a jump on the timeline. <br><br></td></tr></table><br>
<a name="777918"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >Winni</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#14">[#14]</a></td></tr></table></td></tr><tr ><td class="posttext"> Use multiple audio chunks that start at certain keyframes instead of one long audio sample. Just a thought. <br><br></td></tr></table><br>
<a name="777929"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td class="posthead"><table width=100% cellspacing=0 cellpadding=0><tr ><td >ziggy</td><td align="right"><font class=tiny>(Posted 2007)</font>&nbsp;<a href="#15">[#15]</a></td></tr></table></td></tr><tr ><td class="posttext"> Well, it is a good idea, but this module will come with a editor, where people will create their own movies and the movies will be loadable from inside games or apps. I really would like the module to not modify the media used by the module users. So, to say, if the game has background music. I would like the same TAudio object, to be usable in the animation. To avoid having a big file, and then the same big file splitted down in pieces. Not to mention all the possible sound glitches when 'pasting' parts at runtime. The engine has an adaptative FPS system that mantains animation speed, but entering sound at a speciffic point can have +/- 1 frame of time latency. <br><br></td></tr></table><br>
<a name="bottom"></a>
<table width=100% cellspacing=0 cellpadding=0><tr ><td align="right"><a href="http://monkeycoder.co.nz" target="_blank"><img src="/img/monkey2.svg" ></a> <a href="https://github.com/blitz-research" target="_blank"><img src="/img/github.svg" ></a> <a href="https://discord.gg/qJccbSp" target="_blank"><img src="/img/discord.svg" ></a></td></tr></table><br></div><br><table width="100%"><tr><td></body></html lang="en">
